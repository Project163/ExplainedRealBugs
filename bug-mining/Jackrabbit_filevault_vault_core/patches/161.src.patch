diff --git a/vault-core/bnd.bnd b/vault-core/bnd.bnd
index 5f1c8459..e6699041 100644
--- a/vault-core/bnd.bnd
+++ b/vault-core/bnd.bnd
@@ -13,10 +13,8 @@
 #  See the License for the specific language governing permissions and
 #  limitations under the License.
 
-# JR2 packages not semantically versioned
 Import-Package: org.apache.jackrabbit.spi2dav;resolution:=optional,\
                             org.apache.sling.jcr.api;resolution:=optional,\
-                            org.apache.jackrabbit.*;version=!,\
                             *
 # include complete packages (all transitive dependencies lead to Import-Package instructions)
 -conditionalpackage: org.apache.jackrabbit.jcr2spi.*
diff --git a/vault-core/max-target.bndrun b/vault-core/max-target.bndrun
new file mode 100644
index 00000000..01471f78
--- /dev/null
+++ b/vault-core/max-target.bndrun
@@ -0,0 +1,15 @@
+#  Licensed to the Apache Software Foundation (ASF) under one or more
+#  contributor license agreements.  See the NOTICE file distributed with
+#  this work for additional information regarding copyright ownership.
+#  The ASF licenses this file to You under the Apache License, Version 2.0
+#  (the "License"); you may not use this file except in compliance with
+#  the License.  You may obtain a copy of the License at
+#
+#       http://www.apache.org/licenses/LICENSE-2.0
+#
+#  Unless required by applicable law or agreed to in writing, software
+#  distributed under the License is distributed on an "AS IS" BASIS,
+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+#  See the License for the specific language governing permissions and
+#  limitations under the License.
+-include ../target-osgi-environment/max-target-osgi-environment/max-target.bndrun
\ No newline at end of file
diff --git a/vault-core/min-target.bndrun b/vault-core/min-target.bndrun
index 5359b89e..fc3c42a0 100644
--- a/vault-core/min-target.bndrun
+++ b/vault-core/min-target.bndrun
@@ -12,4 +12,4 @@
 #  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #  See the License for the specific language governing permissions and
 #  limitations under the License.
--include ../target-osgi-environment/min-target.bndrun
\ No newline at end of file
+-include ../target-osgi-environment/min-target-osgi-environment/min-target.bndrun
\ No newline at end of file
diff --git a/vault-core/pom.xml b/vault-core/pom.xml
index bd0de6e1..1af03322 100644
--- a/vault-core/pom.xml
+++ b/vault-core/pom.xml
@@ -79,6 +79,25 @@
                 <groupId>biz.aQute.bnd</groupId>
                 <artifactId>bnd-maven-plugin</artifactId>
             </plugin>
+            <!-- create OSGi repo index for target container -->
+            <plugin>
+                <groupId>biz.aQute.bnd</groupId>
+                <artifactId>bnd-indexer-maven-plugin</artifactId>
+                <version>${bnd.version}</version>
+                <executions>
+                    <execution>
+                        <id>index</id>
+                        <goals>
+                            <goal>local-index</goal>
+                        </goals>
+                        <phase>verify</phase>
+                        <configuration>
+                            <inputDir>${project.build.directory}</inputDir>
+                            <includeGzip>false</includeGzip>
+                        </configuration>
+                    </execution>
+                </executions>
+            </plugin>
             <plugin>
                 <groupId>biz.aQute.bnd</groupId>
                 <artifactId>bnd-baseline-maven-plugin</artifactId>
@@ -93,11 +112,22 @@
             <plugin>
                 <groupId>org.apache.maven.plugins</groupId>
                 <artifactId>maven-jar-plugin</artifactId>
-                <configuration>
-                    <archive>
-                        <manifestFile>${project.build.outputDirectory}/META-INF/MANIFEST.MF</manifestFile>
-                    </archive>
-                </configuration>
+                <executions>
+                    <execution>
+                        <id>default-jar</id>
+                        <configuration>
+                            <archive>
+                                <manifestFile>${project.build.outputDirectory}/META-INF/MANIFEST.MF</manifestFile>
+                            </archive>
+                        </configuration>
+                    </execution>
+                    <execution>
+                        <id>default-test-jar</id>
+                        <goals>
+                            <goal>test-jar</goal>
+                        </goals>
+                    </execution>
+                </executions>
             </plugin>
             <plugin>
                 <groupId>org.apache.sling</groupId>
@@ -289,79 +319,11 @@
             <version>3.9.0</version>
             <scope>test</scope>
         </dependency>
-        <dependency>
-            <groupId>org.apache.sling</groupId>
-            <artifactId>org.apache.sling.testing.osgi-mock</artifactId>
-            <version>2.3.10</version>
-            <scope>test</scope>
-        </dependency>
         <dependency>
             <groupId>org.apache.commons</groupId>
             <artifactId>commons-collections4</artifactId>
             <scope>test</scope>
         </dependency>
-        <dependency>
-            <groupId>org.apache.jackrabbit</groupId>
-            <artifactId>jackrabbit-core</artifactId>
-            <version>${jackrabbit.version}</version>
-            <scope>test</scope>
-        </dependency>
-        <dependency>
-            <groupId>org.apache.derby</groupId>
-            <artifactId>derby</artifactId>
-            <version>10.14.2.0</version><!-- version used in jackrabbit-core -->
-            <scope>test</scope>
-        </dependency>
-        <dependency>
-            <groupId>org.apache.jackrabbit</groupId>
-            <artifactId>oak-core</artifactId>
-            <version>${oak.version}</version>
-            <scope>test</scope>
-        </dependency>
-        <dependency>
-            <groupId>org.apache.jackrabbit</groupId>
-            <artifactId>oak-core</artifactId>
-            <version>${oak.version}</version>
-            <classifier>tests</classifier>
-            <scope>test</scope>
-        </dependency>
-        <dependency>
-            <groupId>org.apache.jackrabbit</groupId>
-            <artifactId>oak-jcr</artifactId>
-            <version>${oak.version}</version>
-            <scope>test</scope>
-        </dependency>
-        <dependency>
-            <groupId>org.apache.jackrabbit</groupId>
-            <artifactId>oak-segment-tar</artifactId>
-            <version>${oak.version}</version>
-            <scope>test</scope>
-        </dependency>
-        <!-- transitive dependency of oak-segment-tar, necessary for filedatastore (https://issues.apache.org/jira/browse/OAK-6542) -->
-        <dependency>
-            <groupId>io.dropwizard.metrics</groupId>
-            <artifactId>metrics-core</artifactId>
-            <version>3.2.3</version>
-            <scope>test</scope>
-        </dependency>
-        <dependency>
-            <groupId>org.apache.jackrabbit</groupId>
-            <artifactId>oak-authorization-principalbased</artifactId>
-            <version>${oak.version}</version>
-            <scope>test</scope>
-        </dependency>
-        <dependency>
-            <groupId>org.apache.jackrabbit</groupId>
-            <artifactId>oak-authorization-cug</artifactId>
-            <version>1.16.0</version>
-            <scope>test</scope>
-        </dependency>
-        <dependency>
-            <groupId>org.xmlunit</groupId>
-            <artifactId>xmlunit-core</artifactId>
-            <version>2.6.0</version>
-            <scope>test</scope>
-        </dependency>
         <dependency>
             <groupId>org.xmlunit</groupId>
             <artifactId>xmlunit-matchers</artifactId>
@@ -369,142 +331,10 @@
             <scope>test</scope>
         </dependency>
         <dependency>
-            <groupId>org.apache.felix</groupId>
-            <artifactId>org.apache.felix.converter</artifactId>
-            <version>1.0.14</version>
+            <groupId>org.osgi</groupId>
+            <artifactId>org.osgi.util.converter</artifactId>
+            <version>1.0.9</version>
             <scope>test</scope>
         </dependency>
     </dependencies>
-
-    <!-- ====================================================================== -->
-    <!-- P R O F I L E S                                                        -->
-    <!-- ====================================================================== -->
-    <profiles>
-        <profile>
-            <id>test-oak</id>
-            <build>
-                <plugins>
-                    <plugin>
-                        <artifactId>maven-failsafe-plugin</artifactId>
-                        <configuration>
-                            <systemPropertyVariables>
-                                <oak>true</oak>
-                            </systemPropertyVariables>
-                            <argLine>@{jacoco.command} -Xmx1024m</argLine>
-                            <reportNameSuffix>OAK</reportNameSuffix>
-                        </configuration>
-                        <executions>
-                            <execution>
-                                <id>oak</id>
-                                <goals>
-                                    <goal>integration-test</goal>
-                                </goals>
-                            </execution>
-                            <execution>
-                                <id>verify-its</id>
-                                <goals>
-                                    <goal>verify</goal>
-                                </goals>
-                            </execution>
-                        </executions>
-                    </plugin>
-                </plugins>
-            </build>
-        </profile>
-        <profile>
-            <id>test-jackrabbit</id>
-            <build>
-                <plugins>
-                    <plugin>
-                        <artifactId>maven-failsafe-plugin</artifactId>
-                        <configuration>
-                            <systemPropertyVariables>
-                                <oak>false</oak>
-                            </systemPropertyVariables>
-                            <argLine>@{jacoco.command} -Xmx1024m</argLine>
-                            <reportNameSuffix>JR</reportNameSuffix>
-                        </configuration>
-                        <executions>
-                            <execution>
-                                <id>jr</id>
-                                <goals>
-                                    <goal>integration-test</goal>
-                                </goals>
-                            </execution>
-                            <execution>
-                                <id>verify-its</id>
-                                <goals>
-                                    <goal>verify</goal>
-                                </goals>
-                            </execution>
-                        </executions>
-                    </plugin>
-                </plugins>
-            </build>
-        </profile>
-        <profile>
-            <id>test-both</id>
-            <activation>
-                <activeByDefault>true</activeByDefault>
-            </activation>
-            <build>
-                <plugins>
-                    <plugin>
-                        <artifactId>maven-failsafe-plugin</artifactId>
-                        <executions>
-                            <execution>
-                                <id>it-with-oak</id>
-                                <goals>
-                                    <goal>integration-test</goal>
-                                </goals>
-                                <configuration>
-                                    <systemPropertyVariables>
-                                        <oak>true</oak>
-                                        <repoSuffix>fork${surefire.forkNumber}</repoSuffix>
-                                        <!-- https://issues.apache.org/jira/browse/OAK-8903 -->
-                                        <oak.datastore.sharedTransient>true</oak.datastore.sharedTransient>
-                                    </systemPropertyVariables>
-                                    <argLine>@{jacoco.command} -Xmx1024m</argLine>
-                                    <reportNameSuffix>OAK</reportNameSuffix>
-                                    <forkCount>0.5C</forkCount>
-                                    <reuseForks>true</reuseForks>
-                                </configuration>
-                            </execution>
-                            <execution>
-                                <id>it-with-jr</id>
-                                <goals>
-                                    <goal>integration-test</goal>
-                                </goals>
-                                <configuration>
-                                    <systemPropertyVariables>
-                                        <oak>false</oak>
-                                        <repoSuffix>fork${surefire.forkNumber}</repoSuffix>
-                                    </systemPropertyVariables>
-                                    <reportNameSuffix>JR</reportNameSuffix>
-                                    <summaryFile>${project.build.directory}/failsafe-reports/failsafe-summary-jr.xml</summaryFile>
-                                    <forkCount>0.5C</forkCount>
-                                    <reuseForks>true</reuseForks>
-                                </configuration>
-                            </execution>
-                            <execution>
-                                <id>verify-its</id>
-                                <goals>
-                                    <goal>verify</goal>
-                                </goals>
-                                <configuration>
-                                    <summaryFiles>
-                                        <!-- in addition to default summary file used by Oak -->
-                                        <summaryFile>${project.build.directory}/failsafe-reports/failsafe-summary-jr.xml</summaryFile>
-                                    </summaryFiles>
-                                </configuration>
-                            </execution>
-                        </executions>
-                        <configuration>
-                          <reportsDirectory>target/failsafe-reports-${surefire.forkNumber}</reportsDirectory>
-                        </configuration>
-                    </plugin>
-                </plugins>
-            </build>
-        </profile>
-    </profiles>
 </project>
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/fs/api/SubPackageFilterArchiveTest.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/fs/api/SubPackageFilterArchiveTest.java
index 284178ef..1a659ca9 100644
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/fs/api/SubPackageFilterArchiveTest.java
+++ b/vault-core/src/test/java/org/apache/jackrabbit/vault/fs/api/SubPackageFilterArchiveTest.java
@@ -16,20 +16,19 @@
  */
 package org.apache.jackrabbit.vault.fs.api;
 
+import static org.junit.Assert.assertNotNull;
+import static org.junit.Assert.assertNull;
+import static org.junit.Assert.fail;
+
 import java.io.IOException;
 import java.io.InputStream;
 
 import org.apache.jackrabbit.vault.fs.impl.SubPackageFilterArchive;
 import org.apache.jackrabbit.vault.fs.io.Archive;
 import org.apache.jackrabbit.vault.fs.io.MemoryArchive;
-import org.apache.jackrabbit.vault.packaging.integration.IntegrationTestBase;
 import org.junit.Before;
 import org.junit.Test;
 
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.assertNull;
-import static org.junit.Assert.fail;
-
 /**
  * {@code SubPackageFilterArchiveTest}...
  */
@@ -43,7 +42,7 @@ public class SubPackageFilterArchiveTest {
     @Before
     public void setup() throws Exception {
         memoryArchive = new MemoryArchive(false);
-        InputStream in = IntegrationTestBase.class.getResourceAsStream("/test-packages/subtest.zip");
+        InputStream in = SubPackageFilterArchiveTest.class.getResourceAsStream("/test-packages/subtest.zip");
         memoryArchive.run(in);
         in.close();
         archive = new SubPackageFilterArchive(memoryArchive);
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/fs/impl/io/DocViewSaxFormatterIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/fs/impl/io/DocViewSaxFormatterIT.java
deleted file mode 100644
index 081bd6fd..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/fs/impl/io/DocViewSaxFormatterIT.java
+++ /dev/null
@@ -1,263 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.fs.impl.io;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertTrue;
-
-import java.io.ByteArrayOutputStream;
-import java.io.IOException;
-import java.net.URISyntaxException;
-import java.time.ZoneOffset;
-import java.util.Calendar;
-import java.util.HashMap;
-import java.util.Locale;
-import java.util.Map;
-import java.util.TimeZone;
-
-import javax.jcr.GuestCredentials;
-import javax.jcr.ItemExistsException;
-import javax.jcr.Node;
-import javax.jcr.PathNotFoundException;
-import javax.jcr.PropertyType;
-import javax.jcr.RepositoryException;
-import javax.jcr.Session;
-import javax.jcr.Value;
-import javax.jcr.lock.LockException;
-import javax.jcr.nodetype.ConstraintViolationException;
-import javax.jcr.nodetype.NoSuchNodeTypeException;
-import javax.jcr.nodetype.NodeType;
-import javax.jcr.security.AccessControlManager;
-import javax.jcr.security.Privilege;
-import javax.jcr.version.VersionException;
-
-import org.apache.jackrabbit.api.security.JackrabbitAccessControlList;
-import org.apache.jackrabbit.commons.JcrUtils;
-import org.apache.jackrabbit.commons.jackrabbit.authorization.AccessControlUtils;
-import org.apache.jackrabbit.core.security.principal.EveryonePrincipal;
-import org.apache.jackrabbit.util.ISO8601;
-import org.apache.jackrabbit.vault.fs.Mounter;
-import org.apache.jackrabbit.vault.fs.api.Aggregate;
-import org.apache.jackrabbit.vault.fs.api.PathFilterSet;
-import org.apache.jackrabbit.vault.fs.api.RepositoryAddress;
-import org.apache.jackrabbit.vault.fs.api.VaultFileSystem;
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.apache.jackrabbit.vault.packaging.integration.IntegrationTestBase;
-import org.apache.jackrabbit.vault.util.JcrConstants;
-import org.junit.Assume;
-import org.junit.Test;
-
-public class DocViewSaxFormatterIT extends IntegrationTestBase {
-
-    static String getSerializedAggregate(Session session, String rootNodePath) throws URISyntaxException, RepositoryException, IOException {
-        return getSerializedAggregate(session, rootNodePath, rootNodePath.substring(1));
-    }
-
-    static String getSerializedAggregate(Session session, String filterRootNodePath, String relAggregatePath) throws URISyntaxException, RepositoryException, IOException {
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet(filterRootNodePath));
-        RepositoryAddress addr = new RepositoryAddress("/" + session.getWorkspace().getName() + "/");
-        VaultFileSystem jcrfs = Mounter.mount(null, filter, addr, null, session);
-        Aggregate a = jcrfs.getAggregateManager().getRoot().getAggregate(relAggregatePath); //strip leading "/"
-        DocViewSerializer s = new DocViewSerializer(a);
-
-        try (ByteArrayOutputStream out = new ByteArrayOutputStream()) {
-            s.writeContent(out);
-            return out.toString("utf-8");
-        }
-    }
-
-    /**
-     * Tests if an 'empty' node serialization includes the jcr namespace. see JCRVLT-266
-     */
-    @Test
-    public void testFormatterIncludesJcrNamespace() throws Exception {
-        // rep:itemNames restrictions are only supported in oak.
-        Assume.assumeTrue(isOak());
-
-        JcrUtils.getOrCreateByPath("/testroot", NodeType.NT_UNSTRUCTURED, admin);
-        admin.save();
-
-        // setup access control
-        AccessControlManager acMgr = admin.getAccessControlManager();
-        JackrabbitAccessControlList acl = AccessControlUtils.getAccessControlList(acMgr, "/testroot");
-
-        Privilege[] privs = new Privilege[]{acMgr.privilegeFromName(Privilege.JCR_READ)};
-        Map<String, Value[]> rest = new HashMap<>();
-        rest.put("rep:itemNames", new Value[]{
-                admin.getValueFactory().createValue("jcr:mixinTypes", PropertyType.NAME),
-                admin.getValueFactory().createValue("jcr:primaryType", PropertyType.NAME)
-        });
-        acl.addEntry(EveryonePrincipal.getInstance(), privs, false, null, rest);
-        acMgr.setPolicy("/testroot", acl);
-        admin.save();
-
-        Session guest = repository.login(new GuestCredentials());
-        String serialization = getSerializedAggregate(guest, "/testroot");
-
-        assertEquals("valid xml",
-                "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
-                "<jcr:root xmlns:jcr=\"http://www.jcp.org/jcr/1.0\"/>\n", serialization);
-    }
-
-    /**
-     * Tests minimal serialization
-     */
-    @Test
-    public void testMinimalSerialization() throws Exception {
-        JcrUtils.getOrCreateByPath("/testroot", NodeType.NT_UNSTRUCTURED, admin);
-        admin.save();
-
-        String serialization = getSerializedAggregate(admin, "/testroot");
-
-        assertEquals("valid xml",
-                "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
-                "<jcr:root xmlns:jcr=\"http://www.jcp.org/jcr/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\"\n" +
-                "    jcr:primaryType=\"nt:unstructured\"/>\n", serialization);
-    }
-
-    /**
-     * Tests export of mixed case named properties serialization
-     */
-    @Test
-    public void testMixedCaseSerialization() throws Exception {
-        Node node = JcrUtils.getOrCreateByPath("/testroot", NodeType.NT_UNSTRUCTURED, admin);
-        node.setProperty("testproperty", "lowercase");
-        node.setProperty("TestProperty", "MixedCase");
-        admin.save();
-
-        String serialization = getSerializedAggregate(admin, "/testroot");
-
-        assertEquals("valid xml",
-                "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
-                "<jcr:root xmlns:jcr=\"http://www.jcp.org/jcr/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\"\n" +
-                "    jcr:primaryType=\"nt:unstructured\"\n" +
-                "    TestProperty=\"MixedCase\"\n" +
-                "    testproperty=\"lowercase\"/>\n", serialization);
-    }
-
-    @Test
-    public void testSnsNodeNames() throws RepositoryException, URISyntaxException, IOException {
-        Assume.assumeFalse(isOak()); // same-name siblings are only supported in Jackrabbit2
-        Node node = JcrUtils.getOrCreateByPath("/testroot", NodeType.NT_UNSTRUCTURED, admin);
-        node.addNode("childnode",  NodeType.NT_UNSTRUCTURED);
-        node.addNode("childnode",  NodeType.NT_UNSTRUCTURED);
-        node.addNode("childnode",  NodeType.NT_UNSTRUCTURED);
-        admin.save();
-
-        String serialization = getSerializedAggregate(admin, "/testroot");
-
-        assertEquals("valid xml",
-                "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
-                "<jcr:root xmlns:jcr=\"http://www.jcp.org/jcr/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\"\n" +
-                "    jcr:primaryType=\"nt:unstructured\">\n" +
-                "    <childnode jcr:primaryType=\"nt:unstructured\"/>\n" +
-                "    <childnode_x005b_2_x005d_ jcr:primaryType=\"nt:unstructured\"/>\n" +
-                "    <childnode_x005b_3_x005d_ jcr:primaryType=\"nt:unstructured\"/>\n" +
-                "</jcr:root>\n", serialization);
-    }
-
-    @Test
-    public void testSpecialNames() throws RepositoryException, URISyntaxException, IOException {
-        Node node = JcrUtils.getOrCreateByPath("/testroot", NodeType.NT_UNSTRUCTURED, admin);
-        node.addNode("1test",  NodeType.NT_UNSTRUCTURED);
-        Node childNode = node.addNode("test%test",  NodeType.NT_UNSTRUCTURED);
-        childNode.setProperty("_test&test", "test");
-        admin.save();
-
-        String serialization = getSerializedAggregate(admin, "/testroot");
-
-        assertEquals("valid xml",
-                "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
-                "<jcr:root xmlns:jcr=\"http://www.jcp.org/jcr/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\"\n" +
-                "    jcr:primaryType=\"nt:unstructured\">\n" +
-                "    <_x0031_test jcr:primaryType=\"nt:unstructured\"/>\n" +
-                "    <test_x0025_test\n" +
-                "        jcr:primaryType=\"nt:unstructured\"\n" +
-                "        _test_x0026_test=\"test\"/>\n" +
-                "</jcr:root>\n", serialization);
-    }
-
-    @Test
-    public void testEmptyOrderNodes() throws ItemExistsException, PathNotFoundException, NoSuchNodeTypeException, LockException, VersionException, ConstraintViolationException, RepositoryException, URISyntaxException, IOException {
-        // orderable child nodes
-        Node node = JcrUtils.getOrCreateByPath("/testroot", NodeType.NT_UNSTRUCTURED, admin);
-        node.addNode("child1", NodeType.NT_UNSTRUCTURED);
-        node.addNode("child2", NodeType.NT_UNSTRUCTURED);
-        node.addNode("child3", NodeType.NT_UNSTRUCTURED);
-        admin.save();
-
-        String serialization = getSerializedAggregate(admin, "/testroot/child2", "testroot");
-
-        assertEquals("valid xml",
-                "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
-                "<jcr:root xmlns:jcr=\"http://www.jcp.org/jcr/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\"\n" +
-                "    jcr:primaryType=\"nt:unstructured\">\n" +
-                "    <child1/>\n" +
-                "    <child2 jcr:primaryType=\"nt:unstructured\"/>\n" +
-                "    <child3/>\n" +
-                "</jcr:root>\n", serialization);
-    }
-
-    @Test
-    public void testSortedMixinValues() throws RepositoryException, URISyntaxException, IOException {
-        Node node = JcrUtils.getOrCreateByPath("/testroot", NodeType.NT_UNSTRUCTURED, admin);
-        node.addMixin(JcrConstants.MIX_LOCKABLE);
-        node.addMixin(JcrConstants.MIX_TITLE);
-        node.addMixin(JcrConstants.MIX_CREATED);
-        node.setProperty("customMv", new String[] { "value2", "value3", "value1" });
-        admin.save();
-
-        String serialization = getSerializedAggregate(admin, "/testroot");
-
-        assertEquals("valid xml",
-                "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
-                "<jcr:root xmlns:jcr=\"http://www.jcp.org/jcr/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\"\n" +
-                "    jcr:mixinTypes=\"[mix:created,mix:lockable,mix:title]\"\n" + // sort mixins alphabetically
-                "    jcr:primaryType=\"nt:unstructured\"\n" +
-                "    customMv=\"[value2,value3,value1]\"/>\n", serialization); // don't sort other mv-properties
-    }
-
-    @Test
-    public void testUnprotectedAndProtectedProperties() throws RepositoryException, URISyntaxException, IOException {
-        Node node = JcrUtils.getOrCreateByPath("/testroot", NodeType.NT_UNSTRUCTURED, admin);
-        node.addMixin(JcrConstants.MIX_LOCKABLE);
-        node.addMixin(JcrConstants.MIX_LAST_MODIFIED); // adds protected, auto-created properties jcr:lastModified (DATE) and jcr:lastModifiedBy (String)
-        node.addMixin(JcrConstants.MIX_VERSIONABLE);
-        Calendar date = Calendar.getInstance(TimeZone.getTimeZone(ZoneOffset.UTC), Locale.ROOT);
-        node.setProperty("jcr:created", date);
-        admin.save();
-
-        String serialization = getSerializedAggregate(admin, "/testroot");
-
-        assertTrue(node.hasProperty(JcrConstants.JCR_BASEVERSION));
-        // export should contain both protected and unprotected properties
-        // only the ones which have a special name and(!) are protected are excluded (like jcr:baseVersion)
-        assertEquals("valid xml",
-                "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
-                "<jcr:root xmlns:jcr=\"http://www.jcp.org/jcr/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\"\n" +
-                "    jcr:created=\"{Date}"+ ISO8601.format(date) + "\"\n" +
-                "    jcr:isCheckedOut=\"{Boolean}true\"\n" +
-                "    jcr:lastModified=\"{Date}" + ISO8601.format(node.getProperty("jcr:lastModified").getDate()) + "\"\n" +
-                "    jcr:lastModifiedBy=\"admin\"\n" +
-                "    jcr:mixinTypes=\"[mix:lastModified,mix:lockable,mix:versionable]\"\n" +
-                "    jcr:primaryType=\"nt:unstructured\"\n" +
-                "    jcr:uuid=\"" + node.getIdentifier() + "\"/>\n"
-                , serialization); 
-    }
-}
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/fs/io/ArchiveTest.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/fs/io/ArchiveTest.java
index 366c807d..777c300e 100644
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/fs/io/ArchiveTest.java
+++ b/vault-core/src/test/java/org/apache/jackrabbit/vault/fs/io/ArchiveTest.java
@@ -21,9 +21,10 @@ import static org.junit.Assert.assertNotNull;
 import static org.junit.Assert.assertTrue;
 import static org.junit.Assume.assumeTrue;
 
+import java.io.File;
 import java.io.IOException;
 import java.io.InputStream;
-import java.io.UncheckedIOException;
+import java.net.URI;
 import java.net.URISyntaxException;
 import java.nio.file.Path;
 import java.nio.file.Paths;
@@ -32,6 +33,7 @@ import java.text.SimpleDateFormat;
 import java.util.Arrays;
 import java.util.Calendar;
 import java.util.Locale;
+import java.util.Objects;
 import java.util.Properties;
 import java.util.TimeZone;
 import java.util.function.Supplier;
@@ -43,7 +45,6 @@ import org.apache.jackrabbit.vault.fs.config.DefaultMetaInf;
 import org.apache.jackrabbit.vault.fs.impl.ArchiveWrapper;
 import org.apache.jackrabbit.vault.fs.impl.SubPackageFilterArchive;
 import org.apache.jackrabbit.vault.fs.io.Archive.Entry;
-import org.apache.jackrabbit.vault.packaging.integration.IntegrationTestBase;
 import org.hamcrest.MatcherAssert;
 import org.hamcrest.Matchers;
 import org.junit.After;
@@ -70,15 +71,10 @@ public class ArchiveTest {
         Supplier<Archive> znaSupplier = () -> new ZipNioArchive(zipPath);
         Supplier<Archive> faSupplier = () -> {
                 try {
-                    return new FileArchive(IntegrationTestBase.getFile(ArchiveTest.class, "/test-packages/atomic-counter-test", () -> {
-                        try {
-                            return tempFolder.newFile();
-                        } catch (IOException e) {
-                            throw new UncheckedIOException("cannot create temp file", e);
-                        }
-                    }));
-                } catch (IOException e) {
-                    throw new UncheckedIOException("cannot create temp file", e);
+                    URI uri = Objects.requireNonNull(ArchiveTest.class.getResource("/test-packages/atomic-counter-test"),  "Could not find class resource with name '/test-packages/atomic-counter-test'").toURI();
+                    return new FileArchive(new File(uri));
+                } catch (URISyntaxException e) {
+                    throw new IllegalStateException("Cannot get URI to test resource", e);
                 }
         };
         Supplier<Archive> memArchiveSupplier = () -> { 
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/AdminPermissionCheckerIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/AdminPermissionCheckerIT.java
deleted file mode 100644
index e1e61e4a..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/AdminPermissionCheckerIT.java
+++ /dev/null
@@ -1,182 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.impl;
-
-import static org.junit.Assert.assertFalse;
-import static org.junit.Assert.assertNull;
-import static org.junit.Assert.assertTrue;
-
-import java.security.Principal;
-import java.util.Collections;
-import java.util.HashSet;
-import java.util.Set;
-
-import javax.jcr.AccessDeniedException;
-import javax.jcr.Credentials;
-import javax.jcr.GuestCredentials;
-import javax.jcr.LoginException;
-import javax.jcr.RepositoryException;
-import javax.jcr.Session;
-import javax.jcr.SimpleCredentials;
-import javax.jcr.UnsupportedRepositoryOperationException;
-
-import org.apache.jackrabbit.api.JackrabbitSession;
-import org.apache.jackrabbit.api.security.user.Authorizable;
-import org.apache.jackrabbit.api.security.user.Group;
-import org.apache.jackrabbit.api.security.user.User;
-import org.apache.jackrabbit.core.security.principal.PrincipalImpl;
-import org.apache.jackrabbit.vault.packaging.integration.IntegrationTestBase;
-import org.junit.After;
-import org.junit.Assume;
-import org.junit.Test;
-
-/**
- * Testcase for {@link AdminPermissionChecker}
- */
-public class AdminPermissionCheckerIT extends IntegrationTestBase {
-
-    private static final String TEST_USER = "testUser";
-
-    @Test
-    public void testAdminUser() throws Exception {
-        assertTrue("user admin should have admin permissions", AdminPermissionChecker.hasAdministrativePermissions(admin));
-    }
-
-    @After
-    public void after() throws RepositoryException {
-        JackrabbitSession jackrabbitSession = (JackrabbitSession) admin;
-        jackrabbitSession.refresh(false);
-        Authorizable vip = jackrabbitSession.getUserManager().getAuthorizable(TEST_USER);
-        if (vip != null) {
-            vip.remove();
-        }
-        jackrabbitSession.save();
-    }
-
-    @Test
-    public void testNotAdminUser() throws Exception {
-        JackrabbitSession jackrabbitSession = (JackrabbitSession) admin;
-        Authorizable vip = jackrabbitSession.getUserManager().getAuthorizable(TEST_USER);
-        assertNull("test user must not exist", vip);
-
-        jackrabbitSession.getUserManager().createUser(TEST_USER, TEST_USER);
-        admin.save();
-
-        Session session = repository.login(new SimpleCredentials(TEST_USER, TEST_USER.toCharArray()));
-        try {
-            assertFalse(
-                    "\"" + TEST_USER + "\" is not admin/system and doesn't belong to administrators thus shouldn't have admin permissions",
-                    AdminPermissionChecker.hasAdministrativePermissions(session));
-        } finally {
-            session.logout();
-        }
-    }
-
-    @Test
-    public void testAdminGroup() throws Exception {
-        JackrabbitSession jackrabbitSession = (JackrabbitSession) admin;
-        Authorizable admins = jackrabbitSession.getUserManager().getAuthorizable("administrators");
-        if (admins == null) {
-            admins = jackrabbitSession.getUserManager().createGroup("administrators");
-        }
-        Group adminsGroup = (Group) admins;
-        User testUser = (User) jackrabbitSession.getUserManager().getAuthorizable(TEST_USER);
-        if (testUser == null) {
-            testUser = jackrabbitSession.getUserManager().createUser(TEST_USER, TEST_USER);
-        }
-        adminsGroup.addMember(testUser);
-        admin.save();
-        Session session = repository.login(new SimpleCredentials(TEST_USER, TEST_USER.toCharArray()));
-        try {
-            assertTrue(
-                    "user \"" + TEST_USER + "\" has been added to administrators group thus should have admin permissions",
-                    AdminPermissionChecker.hasAdministrativePermissions(session));
-        } finally {
-            session.logout();
-        }
-    }
-
-    @Test
-    public void testAdditionalAdminUser() throws AccessDeniedException, UnsupportedRepositoryOperationException, RepositoryException {
-        JackrabbitSession jackrabbitSession = (JackrabbitSession) admin;
-        Authorizable vip = jackrabbitSession.getUserManager().getAuthorizable(TEST_USER);
-        assertNull("test user must not exist", vip);
-
-        jackrabbitSession.getUserManager().createUser(TEST_USER, TEST_USER);
-        admin.save();
-
-        Session session = repository.login(new SimpleCredentials(TEST_USER, TEST_USER.toCharArray()));
-        try {
-            assertTrue(
-                    "\"" + TEST_USER + "\" is additional admin/system thus should have admin permissions",
-                    AdminPermissionChecker.hasAdministrativePermissions(session, TEST_USER));
-        } finally {
-            session.logout();
-        }
-    }
-
-    @Test
-    public void testAdditionalAdminGroup() throws Exception {
-        JackrabbitSession jackrabbitSession = (JackrabbitSession) admin;
-        Authorizable admins = jackrabbitSession.getUserManager().getAuthorizable("myadmins");
-        if (admins == null) {
-            admins = jackrabbitSession.getUserManager().createGroup("myadmins");
-        }
-        Group adminsGroup = (Group) admins;
-        User testUser = (User) jackrabbitSession.getUserManager().getAuthorizable(TEST_USER);
-        if (testUser == null) {
-            testUser = jackrabbitSession.getUserManager().createUser(TEST_USER, TEST_USER);
-        }
-        adminsGroup.addMember(testUser);
-        admin.save();
-        Session session = repository.login(new SimpleCredentials(TEST_USER, TEST_USER.toCharArray()));
-        try {
-            assertTrue(
-                    "user \"" + TEST_USER + "\" has been added to additional administrators group thus should have admin permissions",
-                    AdminPermissionChecker.hasAdministrativePermissions(session, "myadmins"));
-        } finally {
-            session.logout();
-        }
-    }
-
-    @Test
-    public void testBoundPrincipalIsAdmin() throws LoginException, RepositoryException {
-        // only run test on Oak
-        Assume.assumeTrue(isOak());
-        assertFalse(AdminPermissionChecker.hasAdministrativePermissionsWithPrincipals(admin, Collections.singletonList("anonymous")));
-        assertTrue(AdminPermissionChecker.hasAdministrativePermissionsWithPrincipals(admin, Collections.singletonList("everyone")));
-        Credentials creds = new GuestCredentials();
-        Session newSession = repository.login(creds);
-        try {
-            // guest is bound to anonymous and everyone principal in Oak
-            assertTrue(AdminPermissionChecker.hasAdministrativePermissionsWithPrincipals(newSession, Collections.singletonList("anonymous")));
-            assertTrue(AdminPermissionChecker.hasAdministrativePermissionsWithPrincipals(newSession, Collections.singletonList("everyone")));
-            assertFalse(AdminPermissionChecker.hasAdministrativePermissionsWithPrincipals(newSession, Collections.singletonList("myadmin2")));
-            assertFalse(AdminPermissionChecker.hasAdministrativePermissionsWithPrincipals(newSession, Collections.singletonList("admin")));
-        } finally {
-            newSession.logout();
-        }
-    }
-
-    @Test
-    public void testIsOak140() {
-        // only run test on Jackrabbit
-        Assume.assumeTrue(isOak());
-        assertTrue(AdminPermissionChecker.isOakVersionExposingBoundPrincipals(repository));
-    }
-}
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageDefinitionImplIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageDefinitionImplIT.java
deleted file mode 100644
index 32019ae9..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageDefinitionImplIT.java
+++ /dev/null
@@ -1,71 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.impl;
-
-import java.io.IOException;
-
-import javax.jcr.ItemExistsException;
-import javax.jcr.Node;
-import javax.jcr.PathNotFoundException;
-import javax.jcr.RepositoryException;
-import javax.jcr.lock.LockException;
-import javax.jcr.nodetype.ConstraintViolationException;
-import javax.jcr.version.VersionException;
-
-import org.apache.jackrabbit.vault.fs.io.Archive;
-import org.apache.jackrabbit.vault.packaging.PackageProperties;
-import org.apache.jackrabbit.vault.packaging.integration.IntegrationTestBase;
-import org.junit.Assert;
-import org.junit.Test;
-
-
-public class JcrPackageDefinitionImplIT extends IntegrationTestBase {
-
-    @Test
-    public void testUnwrapAndComparePackageProperties() throws ItemExistsException, PathNotFoundException, VersionException, ConstraintViolationException, LockException, RepositoryException, IOException {
-        // new node
-        Node node = admin.getRootNode().addNode("packagedefinitiontest");
-        JcrPackageDefinitionImpl packageDefinition = new JcrPackageDefinitionImpl(node);
-        try (Archive archive = getFileArchive("/test-packages/principalbased.zip")) {
-            archive.open(false);
-            packageDefinition.unwrap(archive, false);
-            // now compare the package properties
-            assertPackagePropertiesEquals(archive.getMetaInf().getPackageProperties(), packageDefinition);
-            
-            Assert.assertEquals("bar", archive.getMetaInf().getPackageProperties().getProperty("foo"));
-            // custom properties are not part of the unwrapped node
-            Assert.assertNull(packageDefinition.getProperty("foo"));
-        }
-    }
-
-    void assertPackagePropertiesEquals(PackageProperties expectedProperties, PackageProperties actualProperties) {
-        // only compare dates, as JCR disregards time zone information from Calendar
-        Assert.assertEquals("lastModified is different", expectedProperties.getLastModified().getTime(), actualProperties.getLastModified().getTime());
-        Assert.assertEquals("lastModifiedBy is different", expectedProperties.getLastModifiedBy(), actualProperties.getLastModifiedBy());
-        Assert.assertEquals("created is different", expectedProperties.getCreated().getTime(), actualProperties.getCreated().getTime());
-        Assert.assertEquals("createdBy is different", expectedProperties.getCreatedBy(), actualProperties.getCreatedBy());
-        Assert.assertEquals("lastWrapped is different", expectedProperties.getLastWrapped().getTime(), actualProperties.getLastWrapped().getTime());
-        Assert.assertEquals("lastWrappedBy is different", expectedProperties.getLastWrappedBy(), actualProperties.getLastWrappedBy());
-        Assert.assertEquals("description is different", expectedProperties.getDescription(), actualProperties.getDescription());
-        Assert.assertEquals("acHandling is different", expectedProperties.getACHandling(), actualProperties.getACHandling());
-        Assert.assertEquals("id (group, name or version) is different", expectedProperties.getId(), actualProperties.getId());
-        Assert.assertArrayEquals("dependencies are different", expectedProperties.getDependencies(), actualProperties.getDependencies());
-        Assert.assertEquals("requiresRestart is different", expectedProperties.requiresRestart(), actualProperties.requiresRestart());
-        Assert.assertEquals("requiresRoot is different", expectedProperties.requiresRoot(), actualProperties.requiresRoot());
-    }
-}
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageManagerImplIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageManagerImplIT.java
deleted file mode 100644
index 0e9fda97..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageManagerImplIT.java
+++ /dev/null
@@ -1,325 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.jackrabbit.vault.packaging.impl;
-
-import java.io.IOException;
-import java.util.Collections;
-import java.util.HashSet;
-import java.util.LinkedList;
-import java.util.List;
-import java.util.Set;
-
-import javax.jcr.AccessDeniedException;
-import javax.jcr.GuestCredentials;
-import javax.jcr.Node;
-import javax.jcr.NodeIterator;
-import javax.jcr.PathNotFoundException;
-import javax.jcr.RepositoryException;
-import javax.jcr.Session;
-import javax.jcr.security.AccessControlEntry;
-import javax.jcr.security.AccessControlManager;
-
-import org.apache.jackrabbit.api.security.JackrabbitAccessControlList;
-import org.apache.jackrabbit.commons.jackrabbit.authorization.AccessControlUtils;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.JcrPackageManager;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.PackageId;
-import org.apache.jackrabbit.vault.packaging.integration.IntegrationTestBase;
-import org.junit.Ignore;
-import org.junit.Test;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertFalse;
-import static org.junit.Assert.assertNull;
-import static org.junit.Assert.assertSame;
-import static org.junit.Assert.assertTrue;
-import static org.junit.Assert.fail;
-import static org.mockito.Matchers.anyString;
-import static org.mockito.Mockito.mock;
-import static org.mockito.Mockito.when;
-
-/**
- * Test case for {@link JcrPackageManagerImpl}
- */
-public class JcrPackageManagerImplIT extends IntegrationTestBase {
-
-    private List<String> visitedPaths = new LinkedList<String>();
-
-    @Test
-    public void testMkdDirWithUnauthorizedSession() throws Exception {
-        Session session = mock(Session.class);
-        when(session.nodeExists(anyString())).thenReturn(false);
-        when(session.getWorkspace()).thenReturn(admin.getWorkspace());
-        JcrPackageManagerImpl jcrPackageManager = new JcrPackageManagerImpl(session, new String[0]);
-        String path = "/etc/packages";
-        try {
-            jcrPackageManager.mkdir(path, true);
-            fail("this should have thrown RepositoryException as the session always tells nodes don't exist");
-        }
-        catch (RepositoryException e) {
-            // everything it's ok
-        }
-
-    }
-
-    @Test
-    @Ignore("unstable results in maven")
-    public void testMkDirWithAnonymousSession() throws Exception {
-        Session session = repository.login(new GuestCredentials());
-        JcrPackageManagerImpl jcrPackageManager = new JcrPackageManagerImpl(session, new String[0]);
-        jcrPackageManager.mkdir("/something/that/is/not/going/to/be/found/anywhere/in/this/repository/even/if/searching/in/very/long/paths/like/this", false);
-        jcrPackageManager.mkdir("/something/that/is/not/going/to/be/found/anywhere/in/this/repository/even/if/searching/in/very/long/paths/like/this", false);
-        jcrPackageManager.mkdir("/something/that/is/not/going/to/be/found/anywhere/in/this/repository/even/if/searching/in/very/long/paths/like/this", false);
-    }
-
-    @Test
-    public void mkdDirStressTest() throws Exception {
-        JcrPackageManagerImpl jcrPackageManager = new JcrPackageManagerImpl(admin, new String[0]);
-        String path = admin.getRootNode().getPath();
-        while (path != null) {
-            jcrPackageManager.mkdir(path, true);
-            jcrPackageManager.mkdir(path, false);
-            path = getNextPath(path);
-        }
-    }
-
-    @Test
-    public void testGetPackageRootNoCreate() throws Exception {
-        JcrPackageManagerImpl jcrPackageManager = new JcrPackageManagerImpl(admin, new String[0]);
-
-        assertNull(jcrPackageManager.getPackageRoot(true));
-    }
-
-    @Test
-    public void testGetPackageRootWithCreate() throws Exception {
-        JcrPackageManagerImpl jcrPackageManager = new JcrPackageManagerImpl(admin, new String[0]);
-
-        Node packageNode = jcrPackageManager.getPackageRoot(false);
-        assertEquals("/etc/packages", packageNode.getPath());
-    }
-
-    @Test
-    public void testGetPackageRootTwice() throws Exception {
-        JcrPackageManagerImpl jcrPackageManager = new JcrPackageManagerImpl(admin, new String[0]);
-        Node packageNode = jcrPackageManager.getPackageRoot(false);
-        assertSame(packageNode, jcrPackageManager.getPackageRoot());
-    }
-
-    @Test
-    public void testAlternativePackageRootCreatesOnlyOneNode() throws RepositoryException {
-        JcrPackageManagerImpl jcrPackageManager = new JcrPackageManagerImpl(admin, new String[]{"/var/packages", "/etc/packages"});
-        Node packageNode = jcrPackageManager.getPackageRoot(false);
-        assertEquals("/var/packages", packageNode.getPath());
-        assertNodeMissing("/etc/packages");
-    }
-
-    @Test
-    public void testGetPackageRootWithAdminPendingChanges() throws Exception {
-        admin.getRootNode().addNode("testNode");
-
-        JcrPackageManagerImpl jcrPackageManager = new JcrPackageManagerImpl(admin, new String[0]);
-        try {
-            jcrPackageManager.getPackageRoot(false);
-            fail("transient modifications must fail the package root creation.");
-        } catch (RepositoryException e) {
-            // success
-        }
-    }
-
-    @Test
-    public void testGetPackageRootNoRootAccess() throws Exception {
-        Node packageRoot = packMgr.getPackageRoot();
-
-        // TODO: maybe rather change the setup of the test-base to not assume that everyone has full read-access
-        AccessControlManager acMgr = admin.getAccessControlManager();
-        JackrabbitAccessControlList acl = AccessControlUtils.getAccessControlList(acMgr, "/");
-        acMgr.removePolicy(acl.getPath(), acl);
-
-        AccessControlUtils.getAccessControlList(acMgr, "/etc/packages");
-        AccessControlUtils.allow(packageRoot, org.apache.jackrabbit.oak.spi.security.principal.EveryonePrincipal.NAME, javax.jcr.security.Privilege.JCR_READ);
-
-        admin.save();
-
-        Session anonymous = repository.login(new GuestCredentials());
-        try {
-            assertFalse(anonymous.nodeExists("/"));
-            assertFalse(anonymous.nodeExists("/etc"));
-            assertTrue(anonymous.nodeExists("/etc/packages"));
-
-            JcrPackageManagerImpl jcrPackageManager = new JcrPackageManagerImpl(anonymous, new String[0]);
-            jcrPackageManager.getPackageRoot(false);
-        } finally {
-            anonymous.logout();
-        }
-    }
-
-    @Test
-    public void testGetPackageRootNoCreateAccess() throws Exception {
-        // TODO: maybe rather change the setup of the test-base to not assume that everyone has full read-access
-        AccessControlManager acMgr = admin.getAccessControlManager();
-        JackrabbitAccessControlList acl = AccessControlUtils.getAccessControlList(acMgr, "/");
-        for (AccessControlEntry ace : acl.getAccessControlEntries()) {
-            acl.removeAccessControlEntry(ace);
-        }
-        acl.addEntry(AccessControlUtils.getEveryonePrincipal(admin),
-                AccessControlUtils.privilegesFromNames(admin, javax.jcr.security.Privilege.JCR_READ),
-                true,
-                Collections.singletonMap("rep:glob", admin.getValueFactory().createValue("etc/*")));
-        admin.save();
-
-        Session anonymous = repository.login(new GuestCredentials());
-        try {
-            JcrPackageManagerImpl jcrPackageManager = new JcrPackageManagerImpl(anonymous, new String[0]);
-            assertNull(jcrPackageManager.getPackageRoot(true));
-
-            try {
-                jcrPackageManager.getPackageRoot(false);
-                fail();
-            } catch (AccessDeniedException | PathNotFoundException e) {
-                // success
-            }
-        }  finally {
-            anonymous.logout();
-        }
-    }
-
-    /**
-     * test package list
-     */
-    @Test
-    public void testListPackages() throws IOException, PackageException, RepositoryException {
-        assertTrue("initially the packages set is empty", packMgr.listPackages().isEmpty());
-        packMgr.upload(getStream("/test-packages/tmp.zip"), false);
-        assertEquals("package list contains 1 element", 1, packMgr.listPackages().size());
-        JcrPackage pkg = packMgr.listPackages().get(0);
-        assertEquals("contains new package", TMP_PACKAGE_ID, pkg.getDefinition().getId());
-    }
-
-    /**
-     * test package list
-     */
-    @Test
-    public void testListPackagesWithGroup() throws IOException, PackageException, RepositoryException {
-        packMgr.upload(getStream("/test-packages/tmp.zip"), false);
-        packMgr.create("foo", "test-package");
-        assertEquals("package list contains 2 elements", 2, packMgr.listPackages().size());
-
-        JcrPackage pkg = packMgr.listPackages("my_packages", false).get(0);
-        assertEquals("contains new package", TMP_PACKAGE_ID, pkg.getDefinition().getId());
-
-        pkg = packMgr.listPackages("foo", false).get(0);
-        assertEquals("contains new package", "foo:test-package", pkg.getDefinition().getId().toString());
-
-        // don't report the not-built one
-        assertEquals("package list contains 2 elements", 0, packMgr.listPackages("foo", true).size());
-    }
-
-    /**
-     * test package list with multiple roots
-     */
-    @Test
-    public void testListPackagesMultiRoot() throws IOException, PackageException, RepositoryException {
-        assertTrue("initially the packages set is empty", packMgr.listPackages().isEmpty());
-        packMgr.upload(getStream(TEST_PACKAGE_A_10), false);
-        packMgr.upload(getStream(TEST_PACKAGE_B_10), false);
-        assertEquals("package list contains 2 elements", 2, packMgr.listPackages().size());
-
-        JcrPackageManager multiRootMgr = new JcrPackageManagerImpl(admin, new String[]{"/var/packages" , "/etc/packages"});
-        assertEquals("package list contains 2 elements", 2, multiRootMgr.listPackages().size());
-
-        // install 3rd package in /var
-        multiRootMgr.upload(getStream(TEST_PACKAGE_C_10), false);
-        List<JcrPackage> pkgs = multiRootMgr.listPackages();
-        assertEquals("packages contains 3 elements", 3, pkgs.size());
-        Set<PackageId> ids = new HashSet<PackageId>();
-        for (JcrPackage p: pkgs) {
-            ids.add(p.getDefinition().getId());
-        }
-
-        assertTrue("contains new packages", ids.contains(TEST_PACKAGE_A_10_ID));
-        assertTrue("contains new packages", ids.contains(TEST_PACKAGE_B_10_ID));
-        assertTrue("contains new packages", ids.contains(TEST_PACKAGE_C_10_ID));
-    }
-
-    /**
-     * test package list with multiple roots
-     */
-    @Test
-    public void testListPackagesMultiRootAndGroup() throws IOException, PackageException, RepositoryException {
-        assertTrue("initially the packages set is empty", packMgr.listPackages().isEmpty());
-        packMgr.upload(getStream(TEST_PACKAGE_A_10), false);
-        packMgr.upload(getStream(TEST_PACKAGE_B_10), false);
-        packMgr.create("foo", "test-package");
-        assertEquals("package list contains 3 elements", 3, packMgr.listPackages().size());
-
-        JcrPackageManager multiRootMgr = new JcrPackageManagerImpl(admin, new String[]{"/var/packages" , "/etc/packages"});
-        assertEquals("package list contains 3 elements", 3, multiRootMgr.listPackages().size());
-
-        // install 3rd package in /var
-        multiRootMgr.upload(getStream(TEST_PACKAGE_C_10), false);
-        multiRootMgr.create("foo", "var-test-package");
-
-        List<JcrPackage> pkgs = multiRootMgr.listPackages("foo", false);
-        assertEquals("packages contains 2 elements", 2, pkgs.size());
-        Set<String> ids = new HashSet<String>();
-        for (JcrPackage p: pkgs) {
-            ids.add(p.getDefinition().getId().toString());
-        }
-
-        assertTrue("contains new packages", ids.contains("foo:test-package"));
-        assertTrue("contains new packages", ids.contains("foo:var-test-package"));
-    }
-
-
-    private String getNextPath(String path) throws RepositoryException {
-        Node currentNode = admin.getNode(path);
-        if (currentNode.hasNodes()) {
-            NodeIterator nodes = currentNode.getNodes();
-            while (nodes.hasNext()) {
-                Node node = nodes.nextNode();
-                if ("jcr:system".equals(node.getName())) {
-                    continue;
-                }
-                String nodePath = node.getPath();
-                if (visitedPaths.contains(nodePath)) {
-                    continue;
-                } else {
-                    visitedPaths.add(nodePath);
-                }
-                return nodePath;
-            }
-            return getParentPath(path);
-        } else {
-            return getParentPath(path);
-        }
-    }
-
-    private String getParentPath(String path) throws RepositoryException {
-        Node currentNode = admin.getNode(path);
-        if (currentNode.getPath().equals(admin.getRootNode().getPath())) {
-            return null;
-        } else {
-            Node parent = currentNode.getParent();
-            if (parent != null) {
-                return parent.getPath();
-            } else {
-                return null;
-            }
-        }
-    }
-}
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/JcrWorkspaceFilterIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/JcrWorkspaceFilterIT.java
deleted file mode 100644
index 74d0d434..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/JcrWorkspaceFilterIT.java
+++ /dev/null
@@ -1,55 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.jackrabbit.vault.packaging.impl;
-
-import javax.jcr.Node;
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.commons.JcrUtils;
-import org.apache.jackrabbit.vault.fs.api.ImportMode;
-import org.apache.jackrabbit.vault.fs.api.PathFilterSet;
-import org.apache.jackrabbit.vault.fs.config.ConfigurationException;
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.apache.jackrabbit.vault.fs.filter.DefaultPathFilter;
-import org.apache.jackrabbit.vault.packaging.integration.IntegrationTestBase;
-import org.junit.Assert;
-import org.junit.Test;
-
-
-public class JcrWorkspaceFilterIT extends IntegrationTestBase {
-
-    @Test
-    public void testComplexFilterRoundtrip() throws RepositoryException, ConfigurationException {
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        PathFilterSet pathFilterSet = new PathFilterSet("/my/root");
-        pathFilterSet.setImportMode(ImportMode.MERGE);
-        pathFilterSet.setType("cleanup");
-        pathFilterSet.addInclude(new DefaultPathFilter("/my/root/include.*"));
-        pathFilterSet.addExclude(new DefaultPathFilter("/my/root/exclude.*"));
-        
-        PathFilterSet propertyFilterSet = new PathFilterSet("/my/root");
-        propertyFilterSet.setImportMode(ImportMode.MERGE);
-        propertyFilterSet.setType("cleanup");
-        propertyFilterSet.addInclude(new DefaultPathFilter("/my/root/myprops.*"));
-        propertyFilterSet.addExclude(new DefaultPathFilter("/my/root/notmyprops.*"));
-        filter.add(pathFilterSet, propertyFilterSet);
-        Node defNode = JcrUtils.getOrCreateByPath("/etc/packages/mypackage/jcr:content/vlt:definition", "vlt:PackageDefinition", admin);
-        JcrWorkspaceFilter.saveFilter(filter, defNode, false);
-        Assert.assertEquals(filter, JcrWorkspaceFilter.loadFilter(defNode));
-    }
-    
-}
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/PackagingImplIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/PackagingImplIT.java
deleted file mode 100644
index 4444b5d3..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/PackagingImplIT.java
+++ /dev/null
@@ -1,68 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.jackrabbit.vault.packaging.impl;
-
-import java.io.IOException;
-import java.io.InputStream;
-import java.util.Arrays;
-import java.util.HashMap;
-import java.util.Map;
-
-import org.apache.jackrabbit.vault.packaging.PackageExistsException;
-import org.apache.jackrabbit.vault.packaging.PackageId;
-import org.apache.jackrabbit.vault.packaging.integration.IntegrationTestBase;
-import org.apache.jackrabbit.vault.packaging.registry.PackageRegistry;
-import org.apache.jackrabbit.vault.packaging.registry.RegisteredPackage;
-import org.apache.jackrabbit.vault.packaging.registry.impl.JcrRegisteredPackage;
-import org.apache.jackrabbit.vault.packaging.registry.impl.MockPackageRegistry;
-import org.junit.Assert;
-import org.junit.Test;
-import org.osgi.util.converter.Converter;
-import org.osgi.util.converter.Converters;
-
-public class PackagingImplIT extends IntegrationTestBase {
-
-    @Test
-    public void testGetCompositePackageRepository() throws IOException, PackageExistsException {
-        PackagingImpl packaging = new PackagingImpl();
-        packaging.registries = Arrays.asList(new MockPackageRegistry("package1"), new MockPackageRegistry("package2"));
-        // init configuration
-        Converter c = Converters.standardConverter();
-        Map<String, String> map = new HashMap<>();
-        map.put("authIdsForHookExecution", "");
-        map.put("authIdsForRootInstallation", "");
-        packaging.config = c.convert(map).to(PackagingImpl.Config.class);
-        // add new package to MockPackageRegistry
-        PackageRegistry compositeRegistry = packaging.getCompositePackageRegistry(admin, false);
-        Assert.assertTrue(compositeRegistry.contains(PackageId.fromString("package1")));
-        Assert.assertTrue(compositeRegistry.contains(PackageId.fromString("package2")));
-        // use real package
-        try (InputStream input = getClass().getResourceAsStream("/test-packages/package_1.0.zip")) {
-            compositeRegistry.register(input, false);
-        }
-        RegisteredPackage registeredPackage = compositeRegistry.open(MockPackageRegistry.NEW_PACKAGE_ID);
-        Assert.assertNotNull(registeredPackage);
-        Assert.assertFalse(registeredPackage instanceof JcrRegisteredPackage);
-        compositeRegistry = packaging.getCompositePackageRegistry(admin, true);
-        try (InputStream input = getClass().getResourceAsStream("/test-packages/package_2.0.zip")) {
-            compositeRegistry.register(input, false);
-        }
-        registeredPackage = compositeRegistry.open(PackageId.fromString("my_packages:package:2.0"));
-        Assert.assertNotNull(registeredPackage);
-        Assert.assertTrue(registeredPackage instanceof JcrRegisteredPackage);
-    }
-}
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/ZipVaultPackageIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/ZipVaultPackageIT.java
deleted file mode 100644
index ab0fc9f7..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/ZipVaultPackageIT.java
+++ /dev/null
@@ -1,33 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.jackrabbit.vault.packaging.impl;
-
-import java.io.IOException;
-
-import org.apache.jackrabbit.vault.packaging.integration.IntegrationTestBase;
-import org.junit.Assert;
-import org.junit.Test;
-
-public class ZipVaultPackageIT extends IntegrationTestBase {
-
-    @Test
-    public void testGetClosedArchive() throws IOException {
-        ZipVaultPackage pkg = new ZipVaultPackage(getFile("/test-packages/tmp.zip"), false);
-        pkg.close();
-        Assert.assertThrows(IllegalStateException.class, () -> pkg.getArchive());
-    }
-}
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ACEsAtRootIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ACEsAtRootIT.java
deleted file mode 100644
index af4607ef..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ACEsAtRootIT.java
+++ /dev/null
@@ -1,165 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.File;
-import java.io.FileInputStream;
-import java.io.FileOutputStream;
-import java.io.IOException;
-import java.io.OutputStream;
-import java.security.Principal;
-import java.util.Properties;
-import java.util.zip.Deflater;
-
-import javax.jcr.RepositoryException;
-import javax.jcr.Session;
-import javax.jcr.SimpleCredentials;
-
-import org.apache.jackrabbit.api.JackrabbitSession;
-import org.apache.jackrabbit.api.security.user.User;
-import org.apache.jackrabbit.api.security.user.UserManager;
-import org.apache.jackrabbit.commons.jackrabbit.authorization.AccessControlUtils;
-import org.apache.jackrabbit.vault.fs.api.ImportMode;
-import org.apache.jackrabbit.vault.fs.api.PathFilterSet;
-import org.apache.jackrabbit.vault.fs.config.ConfigurationException;
-import org.apache.jackrabbit.vault.fs.config.DefaultMetaInf;
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.apache.jackrabbit.vault.fs.filter.DefaultPathFilter;
-import org.apache.jackrabbit.vault.fs.io.AccessControlHandling;
-import org.apache.jackrabbit.vault.fs.io.Archive;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.fs.io.Importer;
-import org.apache.jackrabbit.vault.fs.io.ZipStreamArchive;
-import org.apache.jackrabbit.vault.packaging.ExportOptions;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.PackageProperties;
-import org.apache.jackrabbit.vault.packaging.VaultPackage;
-import org.junit.Ignore;
-import org.junit.Test;
-
-import static org.junit.Assert.assertEquals;
-
-public class ACEsAtRootIT extends IntegrationTestBase {
-
-    @Test
-    public void export() throws RepositoryException, IOException, PackageException, ConfigurationException {
-
-        // todo: check why this is not working as expected
-
-        UserManager userManager = ((JackrabbitSession)admin).getUserManager();
-
-        // Create a test user
-
-        String userId = "user1";
-        String userPwd = "pwd1";
-        User user1 = userManager.createUser(userId, userPwd);
-        Principal principal1 = user1.getPrincipal();
-        String userPath = user1.getPath();
-        AccessControlUtils.addAccessControlEntry(admin, userPath, principal1, new String[]{"jcr:all"}, true);
-        String repPolicyPath = String.format("%s/rep:policy", userPath);
-        String profilePath = admin.getNode(userPath).addNode("profile").getPath();
-        admin.save();
-
-        assertNodeExists(userPath);
-
-        // Setup ACEs at the root path, for the user
-
-        AccessControlUtils.addAccessControlEntry(admin, null, principal1, new String[]{"jcr:namespaceManagement"}, true);
-        AccessControlUtils.addAccessControlEntry(admin, "/", principal1, new String[]{"jcr:read"}, true);
-
-        // Check the number of ACEs at the root
-
-        assertEquals(2, AccessControlUtils.getAccessControlList(admin, "/").getAccessControlEntries().length);
-        assertEquals(1, AccessControlUtils.getAccessControlList(admin, null).getAccessControlEntries().length);
-
-        // Export with the user session
-
-        ExportOptions opts = new ExportOptions();
-        DefaultMetaInf inf = new DefaultMetaInf();
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-
-//        PathFilterSet pfilterSet = new PathFilterSet("/");
-//        filter.addPropertyFilterSet(pfilterSet);
-
-        PathFilterSet userFilterSet = new PathFilterSet(userPath);
-//        userFilterSet.addInclude(new DefaultPathFilter(userPath));
-//        userFilterSet.addInclude(new DefaultPathFilter(profilePath + "(/.*)?"));
-//        userFilterSet.addInclude(new DefaultPathFilter(repPolicyPath + "(/.*)?"));
-        filter.add(userFilterSet);
-
-//        PathFilterSet profileSet = new PathFilterSet(profilePath);
-//        profileSet.addInclude(new DefaultPathFilter(profilePath));
-//        filter.add(profileSet);
-//
-//        PathFilterSet repPolicySet = new PathFilterSet(repPolicyPath);
-//        filter.add(repPolicySet);
-
-        inf.setFilter(filter);
-        Properties props = new Properties();
-        props.setProperty(VaultPackage.NAME_VERSION, "0.0.1");
-        props.setProperty(VaultPackage.NAME_GROUP, "jackrabbit/test");
-        props.setProperty(VaultPackage.NAME_NAME, "test-package");
-        props.setProperty(PackageProperties.NAME_USE_BINARY_REFERENCES, "false");
-        inf.setProperties(props);
-
-        opts.setMetaInf(inf);
-        opts.setMountPath("/");
-        opts.setRootPath("/");
-        opts.setCompressionLevel(Deflater.BEST_SPEED);
-
-        File tmpFile = File.createTempFile("vaulttest", ".zip");
-        OutputStream os = new FileOutputStream(tmpFile);
-        Session session = repository.login(new SimpleCredentials(userId, userPwd.toCharArray()));
-        packMgr.assemble(admin, opts, os);
-        os.close();
-        session.logout();
-
-        // Import with admin session
-
-        clean(userPath);
-
-        ImportOptions importOptions = new ImportOptions();
-//        importOptions.setImportMode(ImportMode.UPDATE);
-        importOptions.setAccessControlHandling(AccessControlHandling.OVERWRITE);
-        importOptions.setPatchKeepInRepo(false);
-
-//        importOptions.setAccessControlHandling(AccessControlHandling.MERGE);
-
-        Importer importer = new Importer(importOptions);
-        Archive archive = new ZipStreamArchive(new FileInputStream(tmpFile));
-        archive.open(true);
-
-
-        importer.run(archive, admin.getRootNode());
-        if (admin.hasPendingChanges()) {
-            admin.save();
-        }
-
-        archive.close();
-
-        // Check the number of ACEs at the root, the count should not have changed.
-
-        assertNodeExists(userPath);
-        assertEquals(2, AccessControlUtils.getAccessControlList(admin, "/").getAccessControlEntries().length);
-        assertEquals(1, AccessControlUtils.getAccessControlList(admin, null).getAccessControlEntries().length);
-
-        tmpFile.delete();
-
-    }
-
-}
-
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ACLAndMergeIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ACLAndMergeIT.java
deleted file mode 100644
index 90f22f24..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ACLAndMergeIT.java
+++ /dev/null
@@ -1,472 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.IOException;
-import java.util.Collections;
-import java.util.HashMap;
-import java.util.Map;
-
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.api.JackrabbitSession;
-import org.apache.jackrabbit.api.security.user.Authorizable;
-import org.apache.jackrabbit.api.security.user.UserManager;
-import org.apache.jackrabbit.vault.fs.io.AccessControlHandling;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.junit.Assume;
-import org.junit.Ignore;
-import org.junit.Test;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.assertTrue;
-
-/**
- * AC Handling and import mode tests
- */
-public class ACLAndMergeIT extends IntegrationTestBase {
-
-    private final static String NAME_TEST_USER = "testuser";
-
-    private UserManager uMgr;
-
-    @Override
-    public void setUp() throws Exception {
-        super.setUp();
-        uMgr = ((JackrabbitSession) admin).getUserManager();
-        uMgr.createUser(NAME_TEST_USER, "test");
-        admin.save();
-    }
-
-    @Override
-    public void tearDown() throws Exception {
-        // remove test node
-        if (admin.nodeExists("/testroot")) {
-            admin.getNode("/testroot").remove();
-            admin.save();
-        }
-        try {
-            Authorizable testUser = uMgr.getAuthorizable(NAME_TEST_USER);
-            testUser.remove();
-            admin.save();
-        } catch (RepositoryException e) {
-            // ignore
-        }
-        super.tearDown();
-    }
-
-    /**
-     * Installs 2 packages both with AC Handling OVERWRITE and Import Mode MERGE and tests if AC Handling wins over
-     * import mode.
-     */
-    @Test
-    public void testACAndMerge() throws RepositoryException, IOException, PackageException {
-        assertNodeMissing("/testroot");
-
-        extractVaultPackage("/test-packages/mode_ac_test_a.zip");
-
-        // test if nodes and ACLs of first package exist
-        assertNodeExists("/testroot/node_a");
-        assertPermission("/testroot/secured", false, new String[]{"jcr:all"}, "everyone", null);
-
-        extractVaultPackage("/test-packages/mode_ac_test_b.zip");
-
-        // test if nodes and ACLs of 2nd package exist
-        assertNodeExists("/testroot/node_a");
-        assertNodeExists("/testroot/node_b");
-        assertPermission("/testroot/secured", false, new String[]{"jcr:all"}, "everyone", null);
-        assertPermission("/testroot/secured", true, new String[]{"jcr:read"}, "everyone", "*/foo/*");
-
-    }
-
-    /**
-     * Installs 2 packages with the same ACL. the later packages has AC Handling MERGE and should overwrite the
-     * existing ACL.
-     */
-    @Test
-    public void testACMerge() throws RepositoryException, IOException, PackageException {
-        assertNodeMissing("/testroot");
-
-        extractVaultPackage("/test-packages/mode_ac_test_a.zip");
-
-        // test if nodes and ACLs of first package exist
-        assertNodeExists("/testroot/node_a");
-        assertPermission("/testroot/secured", false, new String[]{"jcr:all"}, "everyone", null);
-
-        extractVaultPackage("/test-packages/mode_ac_test_b_merge.zip");
-
-        // test if nodes and ACLs of 2nd package exist
-        assertNodeExists("/testroot/node_a");
-        assertNodeExists("/testroot/node_b");
-        assertPermission("/testroot/secured", false, new String[]{"jcr:all"}, "everyone", null);
-        assertPermission("/testroot/secured", true, new String[]{"jcr:read"}, "everyone", "*/foo/*");
-    }
-
-    /**
-     * Installs 2 packages with the same ACL. the later packages has a sub package with a different AC handling.
-     * See JCRVLT-107.
-     */
-    @Test
-    public void testACMergeSubpackage() throws RepositoryException, IOException, PackageException {
-        assertNodeMissing("/testroot");
-
-        extractVaultPackage("/test-packages/mode_ac_test_a.zip");
-
-        // test if nodes and ACLs of first package exist
-        assertNodeExists("/testroot/node_a");
-        assertPermission("/testroot/secured", false, new String[]{"jcr:all"}, "everyone", null);
-
-        installPackage("/test-packages/mode_ac_subpackage.zip");
-
-        // test if nodes and ACLs of 2nd package exist
-        assertNodeExists("/testroot/node_a");
-        assertNodeExists("/testroot/node_b");
-        assertPermission("/testroot/secured", false, new String[]{"jcr:all"}, "everyone", null);
-        assertPermission("/testroot/secured", true, new String[]{"jcr:read"}, "everyone", "*/foo/*");
-    }
-
-    /**
-     * Installs 2 packages with the same ACE. the later packages has AC Handling MERGE and should overwrite the
-     * existing ACL.
-     */
-    @Test
-    public void testACMerge4() throws RepositoryException, IOException, PackageException {
-        assertNodeMissing("/testroot");
-
-        extractVaultPackage("/test-packages/mode_ac_test_b2_merge.zip");
-
-        // test if nodes and ACLs of first package exist
-        assertNodeExists("/testroot/node_a");
-        assertPermission("/testroot/secured", true, new String[]{"jcr:read", "jcr:write"}, "everyone", null);
-
-        extractVaultPackage("/test-packages/mode_ac_test_b3_merge.zip");
-
-        // test if nodes and ACLs of 2nd package exist
-        assertNodeExists("/testroot/node_a");
-        assertNodeExists("/testroot/node_b");
-        assertPermission("/testroot/secured", true, new String[]{"jcr:read", "jcr:versionManagement"}, "everyone", null);
-    }
-
-    /**
-     * Installs 2 packages with ACL for different principals. the first package has an ace for 'everyone' the 2nd for
-     * 'testuser'. the later package should not corrupt the existing acl (unlike overwrite).
-     */
-    @Test
-    public void testACMerge2() throws RepositoryException, IOException, PackageException {
-        assertNodeMissing("/testroot");
-
-        extractVaultPackage("/test-packages/mode_ac_test_a.zip");
-
-        // test if nodes and ACLs of first package exist
-        assertNodeExists("/testroot/node_a");
-        assertPermission("/testroot/secured", false, new String[]{"jcr:all"}, "everyone", null);
-
-        extractVaultPackage("/test-packages/mode_ac_test_c_merge.zip");
-
-        // test if nodes and ACLs of 2nd package exist
-        assertNodeExists("/testroot/node_a");
-        assertNodeExists("/testroot/node_c");
-        assertPermission("/testroot/secured", false, new String[]{"jcr:all"}, "everyone", null);
-        assertPermission("/testroot/secured", true, new String[]{"jcr:all"}, "testuser", null);
-    }
-
-    /**
-     * Installs 2 packages with ACL for different principals. the first package has an ace for 'everyone' the 2nd for
-     * 'everyone' and 'testuser'. merge mode should overwrite the 'everyone' ACE.
-     */
-    @Test
-    public void testACMerge3() throws RepositoryException, IOException, PackageException {
-        assertNodeMissing("/testroot");
-
-        extractVaultPackage("/test-packages/mode_ac_test_a.zip");
-
-        // test if nodes and ACLs of first package exist
-        assertNodeExists("/testroot/node_a");
-        assertPermission("/testroot/secured", false, new String[]{"jcr:all"}, "everyone", null);
-
-        extractVaultPackage("/test-packages/mode_ac_test_d.zip");
-
-        // test if nodes and ACLs of 2nd package exist
-        assertNodeExists("/testroot/node_a");
-        assertNodeExists("/testroot/node_d");
-        assertPermission("/testroot/secured", true, new String[]{"jcr:all"}, "everyone", null);
-        assertPermission("/testroot/secured", true, new String[]{"jcr:all"}, "testuser", null);
-    }
-
-    /**
-     * Installs 2 packages with ACL for different principals. the first package has an ace for 'everyone' the 2nd for
-     * 'everyone' and 'testuser'. merge_preserve mode should NOT overwrite the 'everyone' ACE.
-     */
-    @Test
-    public void testACMergePreserve2() throws RepositoryException, IOException, PackageException {
-        assertNodeMissing("/testroot");
-
-        extractVaultPackage("/test-packages/mode_ac_test_a.zip");
-
-        // test if nodes and ACLs of first package exist
-        assertNodeExists("/testroot/node_a");
-        assertPermission("/testroot/secured", false, new String[]{"jcr:all"}, "everyone", null);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setAccessControlHandling(AccessControlHandling.MERGE_PRESERVE);
-        extractVaultPackage("/test-packages/mode_ac_test_d.zip", opts);
-
-        // test if nodes and ACLs of 2nd package exist
-        assertNodeExists("/testroot/node_a");
-        assertNodeExists("/testroot/node_d");
-        assertPermission("/testroot/secured", false, new String[]{"jcr:all"}, "everyone", null);
-        assertPermission("/testroot/secured", true, new String[]{"jcr:all"}, "testuser", null);
-    }
-
-
-
-    /**
-     * Installs 2 packages with the same ACL. the later packages has AC Handling MERGE_PRESERVE and should
-     * retain the existing ACL.
-     */
-    @Test
-    public void testACMergePreserve() throws RepositoryException, IOException, PackageException {
-        assertNodeMissing("/testroot");
-
-        extractVaultPackage("/test-packages/mode_ac_test_a.zip");
-
-        // test if nodes and ACLs of first package exist
-        assertNodeExists("/testroot/node_a");
-        assertPermission("/testroot/secured", false, new String[]{"jcr:all"}, "everyone", null);
-
-        extractVaultPackage("/test-packages/mode_ac_test_b_preserve.zip");
-
-        // test if nodes and ACLs of 2nd package exist
-        assertNodeExists("/testroot/node_a");
-        assertNodeExists("/testroot/node_b");
-        assertPermission("/testroot/secured", false, new String[]{"jcr:all"}, "everyone", null);
-        assertPermissionMissing("/testroot/secured", true, new String[]{"jcr:read"}, "everyone", "*/foo/*");
-
-    }
-
-    /**
-     * Installs a second package with removed mix:accesscontrolable and different nodetype but with ac merge_preserve.
-     */
-    @Test
-    public void testACMergePreserveNodeType() throws RepositoryException, IOException, PackageException {
-        assertNodeMissing("/testroot");
-
-        extractVaultPackage("/test-packages/mode_ac_test_a.zip");
-
-        // test if nodes and ACLs of first package exist
-        assertNodeExists("/testroot/node_a");
-        assertPermission("/testroot/secured", false, new String[]{"jcr:all"}, "everyone", null);
-        assertProperty("/testroot/secured/jcr:primaryType", "nt:folder");
-
-        extractVaultPackage("/test-packages/mode_ac_test_unsecured_nodetype.zip");
-
-        // test if permissions remain and pt changed
-        assertPermission("/testroot/secured", false, new String[]{"jcr:all"}, "everyone", null);
-        assertProperty("/testroot/secured/jcr:primaryType", "sling:Folder");
-    }
-
-    /**
-     * Installs a second package with removed mix:accesscontrolable and different uuid but with ac merge_preserve.
-     */
-    @Test
-    @Ignore("JCRVLT-127")
-    public void testACMergePreserveUUID() throws RepositoryException, IOException, PackageException {
-        assertNodeMissing("/testroot");
-
-        JcrPackage pack = packMgr.upload(getStream("testpackages/mode_ac_test_a_uuid.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        // test if nodes and ACLs of first package exist
-        assertNodeExists("/testroot/node_a");
-        assertPermission("/testroot/secured", false, new String[]{"jcr:all"}, "everyone", null);
-        assertProperty("/testroot/secured/jcr:uuid", "88292ab3-40da-44aa-aba2-0be0019cddc1");
-
-        pack = packMgr.upload(getStream("testpackages/mode_ac_test_unsecured_uuid.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        // test if permissions remain and uuid changed
-        assertPermission("/testroot/secured", false, new String[]{"jcr:all"}, "everyone", null);
-        assertProperty("/testroot/secured/jcr:uuid", "98292ab3-40da-44aa-aba2-0be0019cddc2");
-    }
-
-    /**
-     * Installs a package with 3 ACLs and checks if the order of the entries is still correct.
-     */
-    @Test
-    public void testACOrderOverwrite() throws Exception {
-        assertNodeMissing("/testroot");
-        doOrderTest(AccessControlHandling.OVERWRITE);
-    }
-
-    /**
-     * Installs a package with 3 ACLs and checks if the order of the entries is still correct.
-     */
-    @Test
-    public void testACOrderMerge() throws Exception {
-        assertNodeMissing("/testroot");
-        doOrderTest(AccessControlHandling.OVERWRITE);
-        doOrderTest(AccessControlHandling.MERGE);
-    }
-
-    /**
-     * Installs a package with 3 ACLs and checks if the order of the entries is still correct.
-     */
-    @Test
-    public void testACOrderMergePreserve() throws Exception {
-        assertNodeMissing("/testroot");
-        doOrderTest(AccessControlHandling.OVERWRITE);
-        doOrderTest(AccessControlHandling.MERGE_PRESERVE);
-    }
-
-    private void doOrderTest(AccessControlHandling ac) throws Exception {
-        ImportOptions opts = getDefaultOptions();
-        opts.setAccessControlHandling(ac);
-        extractVaultPackage("/test-packages/mode_ac_test_e.zip", opts);
-
-        // test if nodes and ACLs of first package exist
-        assertNodeExists("/testroot/node_e");
-        int idx0 = hasPermission("/testroot/secured", false, new String[]{"jcr:all"}, "everyone", Collections.<String, String[]>emptyMap());
-        int idx1 = hasPermission("/testroot/secured", true, new String[]{"jcr:all"}, "testuser", Collections.<String, String[]>emptyMap());
-        int idx2 = hasPermission("/testroot/secured", true, new String[]{"jcr:all"}, "testuser1", Collections.<String, String[]>emptyMap());
-
-        assertTrue("All ACEs must exist", idx0 >= 0 && idx1 >= 0 && idx2 >= 0);
-        String result = String.format("%d < %d < %d", idx0, idx1, idx2);
-        assertEquals("ACE order ", "0 < 1 < 2", result);
-    }
-
-    /**
-     * Installs a package with oak ACL content.
-     */
-    @Test
-    public void testOakContent() throws RepositoryException, IOException, PackageException {
-        Assume.assumeTrue(isOak());
-        assertNodeMissing("/testroot");
-
-        extractVaultPackage("/test-packages/oak_ac_content_test.zip");
-
-        // test if nodes and ACLs of first package exist
-        assertNodeExists("/testroot/node_a");
-        Map<String, String[]> restrictions = new HashMap<String, String[]>();
-        restrictions.put("rep:glob", new String[]{"*/foo"});
-        restrictions.put("rep:ntNames", new String[]{"nt:unstructured"});
-        restrictions.put("rep:prefixes", new String[]{"rep", "granite"});
-        assertTrue(
-                "expected permission missing",
-                hasPermission("/testroot/secured", true, new String[]{"jcr:all"}, "everyone", restrictions) >= 0
-        );
-    }
-
-    /**
-     * Installs a package with missing ACL user.
-     */
-    @Test
-    public void testMissingUser() throws RepositoryException, IOException, PackageException {
-        assertNodeMissing("/testroot");
-
-        extractVaultPackage("/test-packages/mode_ac_test_lateuser.zip");
-
-        // test if nodes and ACLs of first package exist
-        assertNodeExists("/testroot/node_d");
-        assertPermission("/testroot/secured", true, new String[]{"jcr:all"}, "missinguser", null);
-    }
-
-
-    /**
-     * Installs a package with repository level acl and then installs another that removes them again.
-     */
-    @Test
-    public void testRepoACL() throws RepositoryException, IOException, PackageException {
-        removeRepoACL();
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setAccessControlHandling(AccessControlHandling.OVERWRITE);
-        extractVaultPackage("/test-packages/repo_policy.zip", opts);
-
-        // test if nodes and ACLs of first package exist
-        assertPermission(null, false, new String[]{"jcr:all"}, "everyone", null);
-        assertPermission(null, false, new String[]{"jcr:all"}, "testuser", null);
-
-        opts = getDefaultOptions();
-        opts.setAccessControlHandling(AccessControlHandling.OVERWRITE);
-        extractVaultPackage("/test-packages/repo_no_policy.zip", opts);
-
-        assertPermissionMissing(null, false, new String[]{"jcr:all"}, "everyone", null);
-        assertPermissionMissing(null, false, new String[]{"jcr:all"}, "testuser", null);
-
-    }
-
-    /**
-     * Installs a package with repository level acl and then installs another that removes them again.
-     */
-    @Test
-    public void testRepoACLMerge() throws RepositoryException, IOException, PackageException {
-        removeRepoACL();
-        addACL(null, true, new String[]{"jcr:all"}, "testuser");
-        assertPermission(null, true, new String[]{"jcr:all"}, "testuser", null);
-        addACL(null, true, new String[]{"jcr:all"}, "testuser1");
-        assertPermission(null, true, new String[]{"jcr:all"}, "testuser1", null);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setAccessControlHandling(AccessControlHandling.MERGE);
-        extractVaultPackage("/test-packages/repo_policy.zip", opts);
-
-        // test if nodes and ACLs of first package exist
-        assertPermission(null, false, new String[]{"jcr:all"}, "everyone", null);
-        assertPermission(null, false, new String[]{"jcr:all"}, "testuser", null);
-        assertPermission(null, true, new String[]{"jcr:all"}, "testuser1", null);
-    }
-
-    /**
-     * Installs a package with repository level acl and then installs another that removes them again.
-     */
-    @Test
-    public void testRepoACLMergePreserve() throws RepositoryException, IOException, PackageException {
-        removeRepoACL();
-        addACL(null, true, new String[]{"jcr:all"}, "testuser");
-        assertPermission(null, true, new String[]{"jcr:all"}, "testuser", null);
-        addACL(null, true, new String[]{"jcr:all"}, "testuser1");
-        assertPermission(null, true, new String[]{"jcr:all"}, "testuser1", null);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setAccessControlHandling(AccessControlHandling.MERGE_PRESERVE);
-        extractVaultPackage("/test-packages/repo_policy.zip", opts);
-
-        // test if nodes and ACLs of first package exist
-        assertPermission(null, false, new String[]{"jcr:all"}, "everyone", null);
-        assertPermission(null, true, new String[]{"jcr:all"}, "testuser", null);
-        assertPermission(null, true, new String[]{"jcr:all"}, "testuser1", null);
-    }
-
-    /**
-     * Installs a package a the root level (JCRVLT-75)
-     */
-    @Test
-    public void testRootACL() throws RepositoryException, IOException, PackageException {
-        ImportOptions opts = getDefaultOptions();
-        opts.setAccessControlHandling(AccessControlHandling.OVERWRITE);
-        extractVaultPackage("/test-packages/root_policy.zip", opts);
-
-        // test if nodes and ACLs of first package exist
-        assertPermission("/", true, new String[]{"jcr:all"}, "everyone", null);
-    }
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/AceOrderIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/AceOrderIT.java
deleted file mode 100644
index f9f70c89..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/AceOrderIT.java
+++ /dev/null
@@ -1,111 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.security.Principal;
-import java.util.List;
-import javax.jcr.Node;
-import javax.jcr.ValueFactory;
-import javax.jcr.security.AccessControlEntry;
-import javax.jcr.security.AccessControlManager;
-import javax.jcr.security.Privilege;
-
-import com.google.common.collect.ImmutableList;
-import com.google.common.collect.ImmutableMap;
-import org.apache.jackrabbit.api.JackrabbitSession;
-import org.apache.jackrabbit.api.security.JackrabbitAccessControlList;
-import org.apache.jackrabbit.api.security.user.Authorizable;
-import org.apache.jackrabbit.api.security.user.User;
-import org.apache.jackrabbit.api.security.user.UserManager;
-import org.apache.jackrabbit.commons.jackrabbit.authorization.AccessControlUtils;
-import org.jetbrains.annotations.NotNull;
-import org.junit.Ignore;
-import org.junit.Test;
-
-import static org.junit.Assert.assertEquals;
-
-/**
- * Test if order of ACE is preserved upon import
- */
-public class AceOrderIT extends IntegrationTestBase {
-
-    private final static String NAME_TEST_USER = "testuser";
-
-    private UserManager uMgr;
-    private AccessControlManager acMgr;
-
-    private List<AccessControlEntry> expectedEntries;
-
-    @Override
-    public void setUp() throws Exception {
-        super.setUp();
-        uMgr = ((JackrabbitSession) admin).getUserManager();
-        User testuser = uMgr.createUser(NAME_TEST_USER, null);
-        admin.save();
-
-        acMgr = admin.getAccessControlManager();
-
-        Node tmp = admin.getRootNode().addNode("testroot").addNode("secured");
-        JackrabbitAccessControlList list = AccessControlUtils.getAccessControlList(acMgr, tmp.getPath());
-        Privilege[] writePrivilege = AccessControlUtils.privilegesFromNames(acMgr, Privilege.JCR_WRITE);
-        ValueFactory vf = admin.getValueFactory();
-        Principal everyone = ((JackrabbitSession) admin).getPrincipalManager().getEveryone();
-        list.addEntry(everyone, writePrivilege, true, ImmutableMap.of("rep:glob", vf.createValue("/foo")));
-        list.addEntry(testuser.getPrincipal(), writePrivilege, false, ImmutableMap.of("rep:glob", vf.createValue("/foo")));
-        list.addEntry(everyone, writePrivilege, true, ImmutableMap.of("rep:glob", vf.createValue("/bar")));
-        acMgr.setPolicy(tmp.getPath(), list);
-
-        expectedEntries = ImmutableList.copyOf(list.getAccessControlEntries());
-
-        admin.refresh(false);
-    }
-
-    @Override
-    public void tearDown() throws Exception {
-        try {
-            if (admin.nodeExists("/testroot")) {
-                admin.getNode("/testroot").remove();
-                admin.save();
-            }
-            Authorizable testUser = uMgr.getAuthorizable(NAME_TEST_USER);
-            if (testUser != null) {
-                testUser.remove();
-                admin.save();
-            }
-        } finally {
-            super.tearDown();
-        }
-    }
-
-    private void assertACEs(@NotNull String path) throws Exception {
-        JackrabbitAccessControlList list = AccessControlUtils.getAccessControlList(acMgr, path);
-        AccessControlEntry[] entries = list.getAccessControlEntries();
-
-        assertEquals(expectedEntries, ImmutableList.copyOf(entries));
-    }
-
-    @Test
-    public void testHandlingOverwrite() throws Exception {
-        assertNodeMissing("/testroot/secured");
-
-        extractVaultPackage("/test-packages/ace_order_overwrite.zip");
-
-        // test if nodes and ACLs of first package exist
-        assertNodeExists("/testroot/secured");
-        assertACEs("/testroot/secured");
-    }
-}
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ArchiveExtractionIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ArchiveExtractionIT.java
deleted file mode 100644
index 62e81d22..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ArchiveExtractionIT.java
+++ /dev/null
@@ -1,186 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.IOException;
-import java.util.Arrays;
-import java.util.Collection;
-import java.util.HashSet;
-import java.util.Set;
-
-import javax.jcr.ItemExistsException;
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.vault.fs.io.Archive;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.fs.io.ZipStreamArchive;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.PackageId;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.junit.runners.Parameterized;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.assertNull;
-import static org.junit.Assert.assertTrue;
-import static org.junit.Assert.fail;
-
-/**
- * Test cases for shallow package installation
- */
-@RunWith(Parameterized.class)
-public class ArchiveExtractionIT extends IntegrationTestBase {
-
-    @Parameterized.Parameters
-    public static Collection<Object[]> data() {
-        return Arrays.asList(new Object[][]{{0, false}, {1000, false}, {1024*1024, true}});
-    }
-
-    private final int streamBufferSize;
-
-    private final boolean isBuffered;
-
-    public ArchiveExtractionIT(int streamBufferSize, boolean isBuffered) {
-        this.streamBufferSize = streamBufferSize;
-        this.isBuffered = isBuffered;
-    }
-
-    @Override
-    public Archive getFileArchive(String name) throws IOException {
-        if (streamBufferSize > 0) {
-            try {
-                return super.getStreamArchive(name, streamBufferSize);
-            } catch (IOException e) {
-                throw new IllegalArgumentException(e);
-            }
-        }
-        return super.getFileArchive(name);
-    }
-
-    private void validateArchive(Archive a) {
-        if (a instanceof ZipStreamArchive) {
-            assertEquals("isBuffered", isBuffered, ((ZipStreamArchive) a).isBuffered());
-        }
-    }
-
-    @Test
-    public void testDefaultArchiveInstall() throws RepositoryException, IOException, PackageException {
-        Archive a = getFileArchive("/test-packages/tmp.zip");
-        ImportOptions opts = getDefaultOptions();
-        PackageId[] ids = packMgr.extract(a, opts, true);
-        validateArchive(a);
-        assertEquals(1, ids.length);
-        assertEquals(TMP_PACKAGE_ID, ids[0]);
-        assertNodeExists("/tmp/foo/bar/tobi");
-        assertPackageNodeExists(TMP_PACKAGE_ID);
-        // check if size is 0
-        long size = admin.getProperty(getInstallationPath(TMP_PACKAGE_ID) + "/jcr:content/jcr:data").getLength();
-        assertEquals("package binary size", 0, size);
-
-        JcrPackage pack = packMgr.open(ids[0]);
-        assertTrue("Package should be marked as installed", pack.isInstalled());
-        assertTrue("Package should be marked as empty", pack.isEmpty());
-        assertNull("Package should not have a snapshot", pack.getSnapshot());
-        assertNotNull("Package should have a definition", pack.getDefinition());
-        assertNotNull("Package should have a definition creation date", pack.getDefinition().getCreated());
-        assertNotNull("Package should have properties", pack.getPackage().getProperties());
-        assertNotNull("Package should have a properties creation date", pack.getPackage().getCreated());
-
-        try {
-            pack.install(getDefaultOptions());
-            fail("re-install of a hollow package should fail.");
-        } catch (IllegalStateException e) {
-            // ok
-        }
-    }
-
-    @Test
-    public void testDefaultArchiveInstallFailsWithoutReplace() throws RepositoryException, IOException, PackageException {
-        uploadPackage("/test-packages/tmp.zip");
-        Archive a = getFileArchive("/test-packages/tmp.zip");
-        ImportOptions opts = getDefaultOptions();
-        try {
-            packMgr.extract(a, opts, false);
-            fail("extract w/o replace should fail.");
-        } catch (ItemExistsException e) {
-            // expected
-        } catch (PackageException e) {
-            // expected
-        }
-    }
-
-    @Test
-    public void testDefaultArchiveInstallCanReplace() throws RepositoryException, IOException, PackageException {
-        uploadPackage("/test-packages/tmp.zip");
-        Archive a = getFileArchive("/test-packages/tmp.zip");
-        ImportOptions opts = getDefaultOptions();
-        PackageId[] ids = packMgr.extract(a, opts, true);
-        assertEquals(1, ids.length);
-        assertEquals(new PackageId("my_packages", "tmp", ""), ids[0]);
-    }
-
-    @Test
-    public void testNonRecursive() throws RepositoryException, IOException, PackageException {
-        Archive a = getFileArchive("/test-packages/subtest.zip");
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        opts.setNonRecursive(true);
-        PackageId[] ids = packMgr.extract(a, opts, false);
-        assertEquals(1, ids.length);
-        assertEquals(new PackageId("my_packages", "subtest", ""), ids[0]);
-
-        // check for sub packages
-        assertPackageNodeExists(PACKAGE_ID_SUB_A);
-        long size = admin.getProperty(getInstallationPath(PACKAGE_ID_SUB_A)+ "/jcr:content/jcr:data").getLength();
-        assertTrue("sub package must have data", size > 0);
-        assertNodeMissing("/tmp/a");
-
-        assertPackageNodeExists(PACKAGE_ID_SUB_B);
-        size = admin.getProperty(getInstallationPath(PACKAGE_ID_SUB_B)+ "/jcr:content/jcr:data").getLength();
-        assertTrue("sub package must have data", size > 0);
-        assertNodeMissing("/tmp/b");
-    }
-
-    @Test
-    public void testRecursive() throws RepositoryException, IOException, PackageException {
-        Archive a = getFileArchive("/test-packages/subtest.zip");
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        PackageId[] ids = packMgr.extract(a, opts, false);
-        assertEquals(3, ids.length);
-        Set<PackageId> testSet = new HashSet<>(Arrays.asList(ids));
-        assertTrue(testSet.contains(new PackageId("my_packages", "subtest", "")));
-        assertTrue(testSet.contains(PACKAGE_ID_SUB_A));
-        assertTrue(testSet.contains(PACKAGE_ID_SUB_B));
-
-        // check for sub packages
-        assertPackageNodeExists(PACKAGE_ID_SUB_A);
-        long size = admin.getProperty(getInstallationPath(PACKAGE_ID_SUB_A)+ "/jcr:content/jcr:data").getLength();
-        assertEquals("sub package must no data", 0, size);
-        assertNodeExists("/tmp/a");
-
-        assertPackageNodeExists(PACKAGE_ID_SUB_B);
-        size = admin.getProperty(getInstallationPath(PACKAGE_ID_SUB_B)+ "/jcr:content/jcr:data").getLength();
-        assertEquals("sub package must no data", 0, size);
-        assertNodeExists("/tmp/b");
-    }
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/AtomicCounterIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/AtomicCounterIT.java
deleted file mode 100644
index 54c637de..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/AtomicCounterIT.java
+++ /dev/null
@@ -1,78 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertNotNull;
-
-import java.io.IOException;
-
-import javax.jcr.Node;
-import javax.jcr.RepositoryException;
-import javax.jcr.nodetype.NodeType;
-
-import org.apache.jackrabbit.commons.JcrUtils;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.junit.Assume;
-import org.junit.Test;
-
-/**
- * {@code TestEmptyPackage}...
- */
-public class AtomicCounterIT extends IntegrationTestBase {
-
-    /**
-     * Tests if installing a package with a mix:atomicCounter works
-     */
-    @Test
-    public void installAtomicCounter() throws RepositoryException, IOException, PackageException {
-        Assume.assumeTrue(isOak());
-
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/atomic-counter-test.zip"), false);
-        assertNotNull(pack);
-        ImportOptions opts = getDefaultOptions();
-        pack.install(opts);
-
-        assertProperty("/tmp/testroot/oak:counter", "42");
-    }
-
-    /**
-     * Tests if installing a package with a mix:atomicCounter works (update)
-     */
-    @Test
-    public void updateAtomicCounter() throws RepositoryException, IOException, PackageException {
-        Assume.assumeTrue(isOak());
-
-        Node tmp = JcrUtils.getOrAddNode(admin.getRootNode(), "tmp", NodeType.NT_UNSTRUCTURED);
-        Node testroot = JcrUtils.getOrAddNode(tmp, "testroot", NodeType.NT_UNSTRUCTURED);
-        testroot.addMixin("mix:atomicCounter");
-        testroot.setProperty("oak:increment", 5);
-        admin.save();
-        assertEquals(5L, testroot.getProperty("oak:counter").getLong());
-
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/atomic-counter-test.zip"), false);
-        assertNotNull(pack);
-        ImportOptions opts = getDefaultOptions();
-        pack.install(opts);
-
-        assertProperty("/tmp/testroot/oak:counter", "42");
-    }
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/BinaryPropertiesIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/BinaryPropertiesIT.java
deleted file mode 100644
index 3559bd62..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/BinaryPropertiesIT.java
+++ /dev/null
@@ -1,300 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertFalse;
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.assertNull;
-import static org.junit.Assert.assertTrue;
-
-import java.io.File;
-import java.io.IOException;
-import java.io.InputStream;
-import java.nio.charset.StandardCharsets;
-import java.util.ArrayList;
-import java.util.List;
-import java.util.Properties;
-
-import javax.jcr.Binary;
-import javax.jcr.Node;
-import javax.jcr.Property;
-import javax.jcr.PropertyType;
-import javax.jcr.RepositoryException;
-import javax.jcr.Value;
-import javax.jcr.ValueFactory;
-import javax.jcr.ValueFormatException;
-import javax.jcr.lock.LockException;
-import javax.jcr.nodetype.ConstraintViolationException;
-import javax.jcr.version.VersionException;
-
-import org.apache.commons.io.IOUtils;
-import org.apache.jackrabbit.api.ReferenceBinary;
-import org.apache.jackrabbit.commons.JcrUtils;
-import org.apache.jackrabbit.oak.segment.file.InvalidFileStoreVersionException;
-import org.apache.jackrabbit.vault.fs.api.PathFilterSet;
-import org.apache.jackrabbit.vault.fs.config.DefaultMetaInf;
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.packaging.ExportOptions;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.PackageProperties;
-import org.apache.jackrabbit.vault.packaging.VaultPackage;
-import org.junit.Assert;
-import org.junit.Assume;
-import org.junit.Before;
-import org.junit.BeforeClass;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.rules.TemporaryFolder;
-import org.junit.runner.RunWith;
-import org.junit.runners.Parameterized;
-import org.junit.runners.Parameterized.Parameter;
-import org.junit.runners.Parameterized.Parameters;
-
-@RunWith(Parameterized.class)
-public class BinaryPropertiesIT extends IntegrationTestBase {
-
-    private final static String SMALL_TEXT = "Lorem ipsum"; // less than 16KB data is not stored in the blob store
-    private final static String SMALL_TEXT2 = "The quick brown fox";
-    private final static String BINARY_NODE_PATH = "/tmp/binaryless/node";
-    private final static String BIG_BINARY_PROPERTY = "bigbin";
-    private final static String SMALL_BINARY_PROPERTY = "smallbin";
-    private final static String BIG_BINARY_MV_PROPERTY = "bigbin-mv";
-    private final static String SMALL_BINARY_MV_PROPERTY = "smallbin-mv";
-
-    private final static String FILE_NODE_PATH = "/tmp/binaryless/file";
-
-    private final static int BIG_TEXT_LENGTH = 0x1000 * 64; // 64 KB
-    private final static String BIG_TEXT;
-    private final static String BIG_TEXT2;
-    static {
-        StringBuilder buffer = new StringBuilder(BIG_TEXT_LENGTH);
-        buffer.append("0123456789abcdef");
-        while (buffer.length() < BIG_TEXT_LENGTH) {
-            buffer.append(buffer, 0, buffer.length());
-        }
-        BIG_TEXT = buffer.toString();
-        BIG_TEXT2 = buffer.append("2").toString();
-    }
-
-    @Rule
-    public TemporaryFolder tmpFolder = new TemporaryFolder();
-
-    private Node binaryNode;
-
-    @Parameter
-    public boolean useBinaryReferences; // if true, binaries should not be part of the package (only their references)
-
-    @Parameters(name = "useBinaryReferences:{0}")
-    public static Object[] data() {
-        return new Object[] { Boolean.TRUE, Boolean.FALSE };
-    }
-
-    @BeforeClass
-    public static void initRepository() throws RepositoryException, IOException, InvalidFileStoreVersionException {
-        initRepository(isOak(), true); // always use BlobStore with Oak
-    }
-
-    @Before
-    public void setup() throws RepositoryException, PackageException, IOException {
-        // test only works for Jackrabbit 2.0 or Oak with FileDataStore (as it relies on ReferenceBinary), this is assured though by the overwritten initRepository method
-
-        binaryNode = JcrUtils.getOrCreateByPath(BINARY_NODE_PATH, "nt:unstructured", admin);
-        Property bigProperty = setBinaryProperty(binaryNode, BIG_BINARY_PROPERTY, BIG_TEXT);
-        Property smallProperty = setBinaryProperty(binaryNode, SMALL_BINARY_PROPERTY, SMALL_TEXT);
-        setBinaryMultivalueProperty(binaryNode, BIG_BINARY_MV_PROPERTY, BIG_TEXT, BIG_TEXT2);
-        setBinaryMultivalueProperty(binaryNode, SMALL_BINARY_MV_PROPERTY, SMALL_TEXT, SMALL_TEXT2);
-        
-        // some basic checks to make sure that reference binaries are enabled in the repository
-        String referenceBigBinary = ((ReferenceBinary) bigProperty.getBinary()).getReference();
-        assertNotNull(referenceBigBinary);
-        if (isOak()) {
-            // every binary is ReferenceBinary (but does return null for small binaries via ReferenceBinary.getReference())
-            assertTrue(smallProperty.getBinary() instanceof ReferenceBinary);
-        } else {
-            // only large binaries are ReferenceBinary objects in JR2
-            assertFalse(smallProperty.getBinary() instanceof ReferenceBinary);
-        }
-        JcrUtils.putFile(binaryNode.getParent(), "file", "text/plain", IOUtils.toInputStream(BIG_TEXT, StandardCharsets.UTF_8));
-        admin.save();
-    }
-
-    private Property setBinaryProperty(Node node, String name, String value) throws ValueFormatException, VersionException, LockException, ConstraintViolationException, RepositoryException {
-        Binary binary = admin.getValueFactory().createBinary(IOUtils.toInputStream(value, StandardCharsets.UTF_8));
-        try {
-            return node.setProperty(name, binary);
-        } finally {
-            binary.dispose();
-        }
-    }
-
-    private Property setBinaryMultivalueProperty(Node node, String name, String... values) throws ValueFormatException, VersionException, LockException, ConstraintViolationException, RepositoryException {
-        ValueFactory valueFactory = admin.getValueFactory();
-        List<Binary> binaries = new ArrayList<>(values.length);
-        for (String value : values) {
-            binaries.add(valueFactory.createBinary(IOUtils.toInputStream(value, StandardCharsets.UTF_8)));
-        }
-        try {
-            return node.setProperty(name, binaries.stream().map(b -> valueFactory.createValue(b)).toArray(Value[]::new), PropertyType.BINARY);
-        } finally {
-            binaries.stream().forEach(Binary::dispose);
-        }
-    }
-
-    private void assertBinaryProperty(String path, String input) throws RepositoryException, IOException {
-        assertBinaryProperty(path, -1, input);
-    }
-
-    private void assertBinaryProperty(String path, int index, String expectedInput) throws RepositoryException, IOException {
-        try (InputStream input = IOUtils.toInputStream(expectedInput, StandardCharsets.UTF_8)) {
-            assertBinaryProperty(path, index, input);
-        }
-    }
-
-    private void assertBinaryProperty(String path, int index, InputStream expectedInput) throws RepositoryException, IOException {
-        Property property = admin.getProperty(path);
-        final Value value;
-        if (index == -1) {
-            value = property.getValue();
-        } else {
-            Value[] values = property.getValues();
-            if (values.length <= index) {
-                Assert.fail("Property " + path + " does only contain " + values.length + " items");
-            }
-            value = values[index];
-        }
-        Binary binary = value.getBinary();
-        try (InputStream actualInput =  binary.getStream()) {
-            assertTrue("Content not equal", IOUtils.contentEquals(expectedInput, actualInput));
-        }
-        finally {
-            binary.dispose();
-        }
-    }
-
-    private VaultPackage assemblePackage(String rootNodePath) throws IOException, RepositoryException {
-        ExportOptions opts = new ExportOptions();
-        DefaultMetaInf inf = new DefaultMetaInf();
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet(rootNodePath));
-
-        inf.setFilter(filter);
-        Properties props = new Properties();
-        props.setProperty(VaultPackage.NAME_GROUP, "jackrabbit/test");
-        props.setProperty(VaultPackage.NAME_NAME, "test-package");
-        props.setProperty(PackageProperties.NAME_USE_BINARY_REFERENCES, Boolean.toString(useBinaryReferences));
-        inf.setProperties(props);
-        opts.setMetaInf(inf);
-        File tmpFile = tmpFolder.newFile("vaulttest.zip");
-        return packMgr.assemble(admin, opts, tmpFile);
-    }
-
-    @Test
-    public void exportBinary() throws RepositoryException, IOException, PackageException {
-        String nodePath = BINARY_NODE_PATH;
-        try (VaultPackage pkg = assemblePackage(nodePath)) {
-            if (useBinaryReferences) {
-                // make sure that only non-reference binaries are in dedicated artifacts
-                assertNull(pkg.getArchive().getEntry("jcr_root" + BINARY_NODE_PATH + "/" + BIG_BINARY_PROPERTY + ".binary"));
-                assertNull(pkg.getArchive().getEntry("jcr_root" + BINARY_NODE_PATH + "/" + BIG_BINARY_MV_PROPERTY + "[0].binary"));
-                assertNull(pkg.getArchive().getEntry("jcr_root" + BINARY_NODE_PATH + "/" + BIG_BINARY_MV_PROPERTY + "[1].binary"));
-                assertNotNull(pkg.getArchive().getEntry("jcr_root"+ BINARY_NODE_PATH + "/" + SMALL_BINARY_PROPERTY + ".binary"));
-                assertNotNull(pkg.getArchive().getEntry("jcr_root"+ BINARY_NODE_PATH + "/" + SMALL_BINARY_MV_PROPERTY + "[0].binary"));
-                assertNotNull(pkg.getArchive().getEntry("jcr_root"+ BINARY_NODE_PATH + "/" + SMALL_BINARY_MV_PROPERTY + "[1].binary"));
-            } else {
-                assertNotNull(pkg.getArchive().getEntry("jcr_root" + BINARY_NODE_PATH + "/" + BIG_BINARY_PROPERTY + ".binary"));
-                assertNotNull(pkg.getArchive().getEntry("jcr_root" + BINARY_NODE_PATH + "/" + BIG_BINARY_MV_PROPERTY + "[0].binary"));
-                assertNotNull(pkg.getArchive().getEntry("jcr_root" + BINARY_NODE_PATH + "/" + BIG_BINARY_MV_PROPERTY + "[1].binary"));
-                assertNotNull(pkg.getArchive().getEntry("jcr_root"+ BINARY_NODE_PATH + "/" + SMALL_BINARY_PROPERTY + ".binary"));
-                assertNotNull(pkg.getArchive().getEntry("jcr_root"+ BINARY_NODE_PATH + "/" + SMALL_BINARY_MV_PROPERTY + "[0].binary"));
-                assertNotNull(pkg.getArchive().getEntry("jcr_root"+ BINARY_NODE_PATH + "/" + SMALL_BINARY_MV_PROPERTY + "[1].binary"));
-            }
-            clean(nodePath);
-            pkg.extract(admin, getDefaultOptions());
-        }
-        assertNodeExists(nodePath);
-        assertBinaryProperty(nodePath + "/" + BIG_BINARY_PROPERTY, BIG_TEXT);
-        assertBinaryProperty(nodePath + "/" + BIG_BINARY_MV_PROPERTY, 0, BIG_TEXT);
-        assertBinaryProperty(nodePath + "/" + BIG_BINARY_MV_PROPERTY, 1, BIG_TEXT2);
-        assertBinaryProperty(nodePath + "/" + SMALL_BINARY_PROPERTY, SMALL_TEXT);
-        assertBinaryProperty(nodePath + "/" + SMALL_BINARY_MV_PROPERTY, 0, SMALL_TEXT);
-        assertBinaryProperty(nodePath + "/" + SMALL_BINARY_MV_PROPERTY, 1, SMALL_TEXT2);
-    }
-
-    @Test
-    public void exportMultiValueBinaryWithPotentiallyMixedReferences() throws ValueFormatException, VersionException, LockException, ConstraintViolationException, RepositoryException, IOException, PackageException {
-        setBinaryMultivalueProperty(binaryNode, "mixedMVBinary", SMALL_TEXT, BIG_TEXT);
-        if (useBinaryReferences) {
-            // short text is a non-reference binary but big text is a reference binary
-            Assert.assertThrows(ValueFormatException.class, () -> assemblePackage(binaryNode.getPath()));
-        } else {
-            String nodePath = binaryNode.getPath();
-            try (VaultPackage pkg = assemblePackage(nodePath)) {
-                clean(binaryNode.getPath());
-                pkg.extract(admin, getDefaultOptions());
-            }
-            assertNodeExists(nodePath);
-            assertBinaryProperty(nodePath + "/mixedMVBinary", 0, SMALL_TEXT);
-            assertBinaryProperty(nodePath + "/mixedMVBinary", 1, BIG_TEXT);
-        }
-    }
-
-    @Test
-    public void exportFile() throws RepositoryException, IOException, PackageException {
-        String nodePath = FILE_NODE_PATH;
-        try (VaultPackage pkg = assemblePackage(nodePath)) {
-            if (useBinaryReferences) {
-                assertTrue(pkg.getArchive().getEntry("jcr_root" + FILE_NODE_PATH).isDirectory());
-            } else {
-                assertFalse(pkg.getArchive().getEntry("jcr_root" + FILE_NODE_PATH).isDirectory());
-            }
-            clean(nodePath);
-            pkg.extract(admin, getDefaultOptions());
-        }
-        assertNodeExists(nodePath);
-        Node node = admin.getNode(nodePath);
-        try (InputStream stream = JcrUtils.readFile(node)) {
-            String actualText = IOUtils.toString(stream, "UTF-8");
-            assertEquals(BIG_TEXT, actualText);
-        }
-    }
-
-    /**
-     * Tests if the same package installed twice does not report and update. See JCRVLT-108
-     */
-    @Test
-    public void importTwice() throws RepositoryException, IOException, PackageException {
-        String nodePath = BINARY_NODE_PATH;
-
-        try (VaultPackage pkg = assemblePackage(nodePath)) {
-            clean(nodePath);
-            ImportOptions io = getDefaultOptions();
-            TrackingListener listener = new TrackingListener(null);
-            io.setListener(listener);
-            // extract
-            pkg.extract(admin, io);
-            assertEquals("A", listener.getActions().get(BINARY_NODE_PATH));
-            // and extract again
-            listener = new TrackingListener(null);
-            io.setListener(listener);
-            pkg.extract(admin, io);
-            assertEquals("U", listener.getActions().get(BINARY_NODE_PATH));
-        }
-    }
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/CompressionExportIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/CompressionExportIT.java
deleted file mode 100644
index 82d433cf..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/CompressionExportIT.java
+++ /dev/null
@@ -1,229 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.ByteArrayInputStream;
-import java.io.IOException;
-import java.io.OutputStream;
-import java.util.Arrays;
-import java.util.Properties;
-import java.util.Random;
-import java.util.zip.Deflater;
-
-import javax.jcr.Node;
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.commons.JcrUtils;
-import org.apache.jackrabbit.vault.fs.api.PathFilterSet;
-import org.apache.jackrabbit.vault.fs.config.DefaultMetaInf;
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.apache.jackrabbit.vault.packaging.ExportOptions;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.VaultPackage;
-import org.junit.After;
-import org.junit.Before;
-import org.junit.Ignore;
-import org.junit.Test;
-import org.slf4j.Logger;
-import org.slf4j.LoggerFactory;
-
-import static org.junit.Assert.assertTrue;
-
-/**
- * Test cases for custom compression level on export.
- * This test case requires a long time to run, thus it is disabled by default.
- */
-@Ignore
-public class CompressionExportIT extends IntegrationTestBase {
-
-    /**
-     * default logger
-     */
-    private static final Logger log = LoggerFactory.getLogger(CompressionExportIT.class);
-
-    private static final Random RAND = new Random();
-
-    private static final String TEST_PARENT_PATH = "/tmp/testCompressionExport";
-
-    private static final String COMPRESSIBLE_MIME_TYPE = "text/plain";
-
-    private static final String INCOMPRESSIBLE_MIME_TYPE = "image/png";
-
-    private static final String UNKNOWN_MIME_TYPE = "unkown/unknown";
-
-    private static final int NB_WARMUP_ITERATIONS = 100;
-
-    private static final int NB_TEST_ITERATIONS = 10000;
-
-    @Before
-    public void setup() throws RepositoryException, PackageException, IOException {
-        JcrUtils.getOrCreateByPath(TEST_PARENT_PATH, "nt:unstructured", admin);
-        admin.save();
-    }
-
-    @After
-    public void after() throws RepositoryException {
-        if (admin.nodeExists(TEST_PARENT_PATH)) {
-            admin.getNode(TEST_PARENT_PATH).remove();
-            admin.save();
-        }
-    }
-
-    @Test
-    public void test100KB_to_120KB() throws RepositoryException, IOException {
-        for (int size = 100 * 1024 ; size < 120 * 1024 ; size += 10 * 1024) {
-            runTestAndAssertGains(size);
-        }
-    }
-
-    @Test
-    public void test1MB() throws RepositoryException, IOException {
-        runTestAndAssertGains(1024 * 1024);
-    }
-
-    @Test
-    public void test10MB() throws RepositoryException, IOException {
-        runTestAndAssertGains(10 * 1024 * 1024);
-    }
-
-    private void runTestAndAssertGains(int size)
-            throws RepositoryException, IOException {
-        compareWithAndWithoutOptimization(storeFile(true, COMPRESSIBLE_MIME_TYPE, size));
-        compareWithAndWithoutOptimization(storeFile(false, INCOMPRESSIBLE_MIME_TYPE, size));
-        compareWithAndWithoutOptimization(storeFile(true, UNKNOWN_MIME_TYPE, size));
-        compareWithAndWithoutOptimization(storeFile(false, UNKNOWN_MIME_TYPE, size));
-    }
-
-    private void compareWithAndWithoutOptimization(String path)
-            throws IOException, RepositoryException {
-        SizeDuration noOptimization = measureExportDuration(path, Deflater.DEFAULT_COMPRESSION);
-        SizeDuration withOptimization = measureExportDuration(path, 6); // level 6 is used for the DEFAULT_COMPRESSION strategy
-        float durationGain = (noOptimization.duration - withOptimization.duration) / (float) noOptimization.duration;
-        float sizeGain = (noOptimization.size - withOptimization.size) / (float) noOptimization.size;
-        log.info("Path {} duration gain: {}, size gain: {}", new Object[]{path, durationGain, sizeGain});
-        // assert the optimization does not imply a decrease of throughput larger than 3%
-        assertTrue(noOptimization.duration * 1.03f > withOptimization.duration);
-    }
-
-    private SizeDuration measureExportDuration(String nodePath, int level)
-            throws IOException, RepositoryException {
-        ExportOptions opts = buildExportOptions(nodePath, level);
-        log.info("Warmup for path {} and compression level {}",
-                new Object[]{nodePath, level});
-        exportMultipleTimes(opts, NB_WARMUP_ITERATIONS);
-        log.info("Run for path {} and compression level {}",
-                new Object[]{nodePath, level});
-        long start = System.nanoTime();
-        long size = exportMultipleTimes(opts, NB_TEST_ITERATIONS);
-        long stop = System.nanoTime();
-        SizeDuration sd = new SizeDuration(size, stop - start);
-        float rate = (sd.size / (float)sd.duration * 1000);
-        log.info("Ran for path {} and compression level {} in {} ns produced {} B ({} MB/s)",
-                new Object[]{nodePath, level, sd.duration, sd.size, rate});
-        return sd;
-    }
-
-    private long exportMultipleTimes(ExportOptions opts, int times)
-            throws IOException, RepositoryException {
-        long size = 0;
-        for (int i = 0 ; i < times ; i++) {
-            WriteCountOutputStream outputStream = new WriteCountOutputStream();
-            packMgr.assemble(admin, opts, outputStream);
-            size += outputStream.size();
-        }
-        return size;
-    }
-
-    private ExportOptions buildExportOptions(String nodePath, int level) {
-        ExportOptions opts = new ExportOptions();
-        opts.setCompressionLevel(level);
-        DefaultMetaInf inf = new DefaultMetaInf();
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet(nodePath));
-        inf.setFilter(filter);
-        Properties props = new Properties();
-        props.setProperty(VaultPackage.NAME_GROUP, "jackrabbit/test");
-        props.setProperty(VaultPackage.NAME_NAME, "test-compression-package");
-        inf.setProperties(props);
-        opts.setMetaInf(inf);
-        return opts;
-    }
-
-
-    private String storeFile(boolean compressible, String mimeType, int size)
-            throws RepositoryException {
-        String path = String.format("%s/%s", TEST_PARENT_PATH, fileName(compressible, mimeType, size));
-        Node node = JcrUtils.getOrCreateByPath(path, "nt:unstructured", admin);
-        byte[] data = compressible ? compressibleData(size) : incompressibleData(size);
-        JcrUtils.putFile(node, "file", mimeType, new ByteArrayInputStream(data));
-        admin.save();
-        return node.getPath();
-    }
-
-    private String fileName(boolean compressible, String mimeType, int size) {
-        return String.format("%s_%s_%s", mimeType, size, compressible ? "compressible" : "incompressible");
-    }
-
-    private byte[] compressibleData(int length) {
-        byte[] data = new byte[length];
-        Arrays.fill(data, (byte)42); // low entropy data
-        return data;
-    }
-
-    private byte[] incompressibleData(int length) {
-        byte[] data = new byte[length];
-        RAND.nextBytes(data); // high entropy data
-        return data;
-    }
-
-    public class WriteCountOutputStream extends OutputStream {
-
-        long size = 0;
-
-        @Override
-        public void write(int b) throws IOException {
-            size++;
-        }
-
-        @Override
-        public void write(byte[] b) throws IOException {
-            size += b.length;
-        }
-
-        @Override
-        public void write(byte[] b, int off, int len) throws IOException {
-            size += len;
-        }
-
-        public long size() {
-            return size;
-        }
-    }
-
-    private class SizeDuration {
-
-        long size;
-
-        long duration;
-
-        SizeDuration(long size, long duration) {
-            this.duration = duration;
-            this.size = size;
-        }
-    }
-
-}
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/CrossRegistryDependenciesIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/CrossRegistryDependenciesIT.java
deleted file mode 100644
index e20707bd..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/CrossRegistryDependenciesIT.java
+++ /dev/null
@@ -1,72 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.File;
-
-import org.apache.commons.io.FileUtils;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.packaging.DependencyHandling;
-import org.apache.jackrabbit.vault.packaging.PackageId;
-import org.apache.jackrabbit.vault.packaging.registry.impl.FSPackageRegistry;
-import org.junit.Before;
-import org.junit.Test;
-
-/**
- * Test dependencies of JCR Packages on packages registered in FS Package registry
- */
-public class CrossRegistryDependenciesIT extends IntegrationTestBase {
-
-    private static final File DIR_REGISTRY_HOME = new File("target/fspackageregistry-" + System.getProperty("repoSuffix", "fork1"));
-
-    private FSPackageRegistry fsregistry;
-
-    @Override
-    @Before
-    public void setUp() throws Exception {
-        super.setUp();
-        if (DIR_REGISTRY_HOME.exists()) {
-            FileUtils.cleanDirectory(DIR_REGISTRY_HOME);
-        } else {
-            DIR_REGISTRY_HOME.mkdir();
-        }
-        fsregistry = new FSPackageRegistry(DIR_REGISTRY_HOME);
-        packMgr.getInternalRegistry().setBaseRegistry(fsregistry);
-
-        PackageId idB = fsregistry.register(getStream(TEST_PACKAGE_B_10), false);
-        PackageId idC = fsregistry.register(getStream(TEST_PACKAGE_C_10), false);
-        
-        ImportOptions opts = new ImportOptions();
-        opts.setDependencyHandling(DependencyHandling.STRICT);
-
-        fsregistry.installPackage(admin, fsregistry.open(idB), opts, true);
-        fsregistry.installPackage(admin, fsregistry.open(idC), opts, true);
-
-
-    }
-    
-    @Test
-    public void testCrossDependency() throws Exception {
-        PackageId idA = packMgr.getInternalRegistry().register(getStream(TEST_PACKAGE_A_10), false);
-        ImportOptions opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.STRICT);
-        packMgr.open(idA).install(opts);
-
-    }
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/CugHandlingTest.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/CugHandlingTest.java
deleted file mode 100644
index 4064ce26..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/CugHandlingTest.java
+++ /dev/null
@@ -1,291 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import org.apache.jackrabbit.api.JackrabbitRepository;
-import org.apache.jackrabbit.api.JackrabbitSession;
-import org.apache.jackrabbit.api.security.user.UserManager;
-import org.apache.jackrabbit.oak.jcr.Jcr;
-import org.apache.jackrabbit.oak.query.QueryEngineSettings;
-import org.apache.jackrabbit.oak.security.internal.SecurityProviderBuilder;
-import org.apache.jackrabbit.oak.security.internal.SecurityProviderHelper;
-import org.apache.jackrabbit.oak.spi.security.ConfigurationParameters;
-import org.apache.jackrabbit.oak.spi.security.SecurityProvider;
-import org.apache.jackrabbit.oak.spi.security.authorization.AuthorizationConfiguration;
-import org.apache.jackrabbit.oak.spi.security.authorization.cug.impl.CugConfiguration;
-import org.apache.jackrabbit.oak.spi.security.user.UserConstants;
-import org.apache.jackrabbit.vault.fs.io.AccessControlHandling;
-import org.apache.jackrabbit.vault.fs.io.Archive;
-import org.apache.jackrabbit.vault.fs.io.FileArchive;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.fs.io.ZipArchive;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.VaultPackage;
-import org.apache.jackrabbit.vault.packaging.impl.ZipVaultPackage;
-
-import javax.jcr.Node;
-import javax.jcr.Repository;
-import javax.jcr.RepositoryException;
-import javax.jcr.Session;
-import javax.jcr.SimpleCredentials;
-import javax.jcr.Value;
-import java.io.File;
-import java.io.IOException;
-import java.net.URL;
-import java.util.Arrays;
-import java.util.HashSet;
-import java.util.Set;
-import java.util.TreeSet;
-
-import org.junit.After;
-import org.junit.Before;
-import org.junit.Test;
-
-import static org.apache.jackrabbit.vault.fs.io.AccessControlHandling.IGNORE;
-import static org.apache.jackrabbit.vault.fs.io.AccessControlHandling.MERGE;
-import static org.apache.jackrabbit.vault.fs.io.AccessControlHandling.OVERWRITE;
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertFalse;
-import static org.junit.Assert.assertTrue;
-import static org.junit.Assert.fail;
-
-/** This is more an IT but isn't derived from IntegrationTestBase, therefore doesn't need parametrization */
-public final class CugHandlingTest {
-
-    private static final String TEST_ROOT = "/testroot";
-
-    /**
-     * contains cugPolicy with rep:principalNames=[principal-1,principal-2]
-     */
-    private static final String CUG_PACKAGE_1 = "/test-packages/cug-test-1.zip";
-
-    /**
-     * contains cugPolicy with rep:principalNames=[principal-2,principal-3]
-     */
-    private static final String CUG_PACKAGE_2 = "/test-packages/cug-test-2.zip";
-
-    private Repository repository;
-
-    private Session adminSession;
-
-    /**
-     * When cugHandling is set to IGNORE, rep:cugPolicy node should not be created.
-     */
-    @Test
-    public void testCugIgnore() throws Exception {
-       extractVaultPackage(CUG_PACKAGE_1, IGNORE);
-       Node testRoot = adminSession.getNode(TEST_ROOT);
-       assertNodeExists(testRoot, "node_with_cug");
-       Node nodeWithCug = testRoot.getNode("node_with_cug");
-       assertProperty(nodeWithCug, "jcr:mixinTypes", asSet("rep:CugMixin"));
-       assertNodeMissing(nodeWithCug, "rep:cugPolicy");
-    }
-
-    /**
-     * When cugHandling is set to MERGE, existing principals should be combined with installed principals
-     */
-    @Test
-    public void testCugMerge() throws Exception {
-        extractVaultPackage(CUG_PACKAGE_2, OVERWRITE);
-        extractVaultPackage(CUG_PACKAGE_1, MERGE);
-        Node testRoot = adminSession.getNode(TEST_ROOT);
-        assertNodeExists(testRoot, "node_with_cug");
-        Node nodeWithCug = testRoot.getNode("node_with_cug");
-        assertProperty(nodeWithCug, "jcr:mixinTypes", asSet("rep:CugMixin"));
-        assertNodeExists(nodeWithCug, "rep:cugPolicy");
-        Node cugNode = nodeWithCug.getNode("rep:cugPolicy");
-        assertProperty(cugNode, "jcr:primaryType", "rep:CugPolicy");
-        assertProperty(cugNode,"rep:principalNames", asSet("principal-1", "principal-2", "principal-3"));
-    }
-
-    /**
-     * When cugHandling is set to MERGE_PRESERVE, existing principals should be combined with installed principals
-     * same behavior as with MERGE
-     */
-    @Test
-    public void testCugMergePreserve() throws Exception {
-        extractVaultPackage(CUG_PACKAGE_2, OVERWRITE);
-        extractVaultPackage(CUG_PACKAGE_1, AccessControlHandling.MERGE_PRESERVE);
-        Node testRoot = adminSession.getNode(TEST_ROOT);
-        assertNodeExists(testRoot, "node_with_cug");
-        Node nodeWithCug = testRoot.getNode("node_with_cug");
-        assertProperty(nodeWithCug, "jcr:mixinTypes", asSet("rep:CugMixin"));
-        assertNodeExists(nodeWithCug, "rep:cugPolicy");
-        Node cugNode = nodeWithCug.getNode("rep:cugPolicy");
-        assertProperty(cugNode, "jcr:primaryType", "rep:CugPolicy");
-        assertProperty(cugNode,"rep:principalNames", asSet("principal-1", "principal-2", "principal-3"));
-    }
-
-    /**
-     * When cugHandling is set to OVERWRITE installed principals should completely owerwrite existing ones.
-     */
-    @Test
-    public void testCugOverwrite() throws Exception {
-        extractVaultPackage(CUG_PACKAGE_1, OVERWRITE);
-        extractVaultPackage(CUG_PACKAGE_2, OVERWRITE);
-        Node testRoot = adminSession.getNode(TEST_ROOT);
-        assertNodeExists(testRoot, "node_with_cug");
-        Node nodeWithCug = testRoot.getNode("node_with_cug");
-        assertProperty(nodeWithCug, "jcr:mixinTypes", asSet("rep:CugMixin"));
-        assertNodeExists(nodeWithCug, "rep:cugPolicy");
-        Node cugNode = nodeWithCug.getNode("rep:cugPolicy");
-        assertProperty(cugNode, "jcr:primaryType", "rep:CugPolicy");
-        assertProperty(cugNode,"rep:principalNames", asSet("principal-2", "principal-3"));
-    }
-
-    /**
-     * When cugHandling is not set (or set to <code>null</code>), cugHandling should be governed by aclHandling
-     */
-    @Test
-    public void testCugSameAsAclByDefault() throws Exception {
-        extractVaultPackage(CUG_PACKAGE_1, OVERWRITE);
-        ImportOptions opts = new ImportOptions();
-        opts.setAccessControlHandling(MERGE);
-        extractVaultPackage(CUG_PACKAGE_2, opts);
-        Node testRoot = adminSession.getNode(TEST_ROOT);
-        assertNodeExists(testRoot, "node_with_cug");
-        Node nodeWithCug = testRoot.getNode("node_with_cug");
-        assertProperty(nodeWithCug, "jcr:mixinTypes", asSet("rep:CugMixin"));
-        assertNodeExists(nodeWithCug, "rep:cugPolicy");
-        Node cugNode = nodeWithCug.getNode("rep:cugPolicy");
-        assertProperty(cugNode, "jcr:primaryType", "rep:CugPolicy");
-        assertProperty(cugNode,"rep:principalNames", asSet("principal-1", "principal-2", "principal-3"));
-    }
-
-    //*********************************************
-    // Custom assertions
-    //*********************************************
-
-    private static void assertHasProperty(Node node, String propName) throws RepositoryException {
-        if (!node.hasProperty(propName)) {
-            fail("Node [" + node.getPath() + "] doesn't have property [" + propName + "]");
-        }
-    }
-
-    private static void assertProperty(Node node, String propName, String value) throws RepositoryException {
-        assertHasProperty(node, propName);
-        assertEquals(node.getPath() + "/" + propName + " should contain " + value, value, node.getProperty(propName).getString());
-    }
-
-    public static void assertProperty(Node node, String name, Set<String> values) throws RepositoryException {
-        Set<String> strings = new HashSet();
-        for (Value v: node.getProperty(name).getValues()) {
-            strings.add(v.getString());
-        }
-        assertEquals(node.getPath() + "/" + name + " should contain " + values, values, strings);
-    }
-
-    public static void assertNodeExists(Node parent, String relPath) throws RepositoryException {
-        assertTrue(parent.getPath() + "/" + relPath + " should exist", parent.hasNode(relPath));
-    }
-
-    public static void assertNodeMissing(Node parent, String relPath) throws RepositoryException {
-        assertFalse(parent.getPath() + "/" + relPath + " should not exist", parent.hasNode(relPath));
-    }
-    
-    //*********************************************
-    // Helpers
-    //*********************************************
-
-    private Archive getFileArchive(String name) {
-        final URL packageURL = getClass().getResource(name);
-        final String filename = packageURL.getFile();
-        final File file = new File(filename);
-        if (file.isDirectory()) {
-            return new FileArchive(file);
-        } else {
-            return new ZipArchive(file);
-        }
-    }
-
-    private void extractVaultPackage(String name, AccessControlHandling cugHandling) throws PackageException, RepositoryException, IOException {
-        ImportOptions opts = new ImportOptions();
-        opts.setCugHandling(cugHandling);
-        extractVaultPackage(name, opts);
-    }
-
-    private void extractVaultPackage(String name, ImportOptions opts) throws PackageException, RepositoryException, IOException {
-        VaultPackage pack = new ZipVaultPackage(getFileArchive(name), true);
-        pack.extract(adminSession, opts);
-    }
-
-    private static Set<String> asSet(String ... values) {
-        return new TreeSet<>(Arrays.asList(values));
-    }
-
-    //*********************************************
-    // setUp/tearDown
-    //*********************************************
-
-    @Before
-    public void setUp() throws Exception {
-        repository = createRepository();
-        adminSession = repository.login(new SimpleCredentials(UserConstants.DEFAULT_ADMIN_ID, UserConstants.DEFAULT_ADMIN_ID.toCharArray()));
-        createUsers(adminSession);
-        adminSession.save();
-    }
-
-    @After
-    public void tearDown() throws Exception {
-        try {
-            adminSession.refresh(false);
-            if (adminSession.nodeExists(TEST_ROOT)) {
-                adminSession.getNode(TEST_ROOT).remove();
-            }
-            adminSession.save();
-        } finally {
-            adminSession.logout();
-            if (repository instanceof JackrabbitRepository) {
-                ((JackrabbitRepository) repository).shutdown();
-            }
-            repository = null;
-        }
-    }
-
-    private static SecurityProvider createSecirityProvider() {
-        ConfigurationParameters params = ConfigurationParameters.of(
-                "cugSupportedPaths", TEST_ROOT,
-                "cugEnabled", true
-        );
-        CugConfiguration cugConfiguration = new CugConfiguration();
-        cugConfiguration.setParameters(params);
-        SecurityProvider result = SecurityProviderBuilder.newBuilder()
-                                                         .with(ConfigurationParameters.of(params))
-                                                         .build();
-        SecurityProviderHelper.updateConfig(result, cugConfiguration, AuthorizationConfiguration.class);
-        return result;
-    }
-
-    private static void createUsers(Session session) throws RepositoryException {
-        UserManager userManager = ((JackrabbitSession) session).getUserManager();
-        userManager.createUser("principal-1", "pwd-1");
-        userManager.createUser("principal-2", "pwd-2");
-        userManager.createUser("principal-3", "pwd-3");
-    }
-
-    private static Repository createRepository() {
-        SecurityProvider securityProvider = createSecirityProvider();
-        QueryEngineSettings queryEngineSettings = new QueryEngineSettings();
-        queryEngineSettings.setFailTraversal(true);
-        Jcr jcr = new Jcr();
-        jcr.with(securityProvider);
-        jcr.with(queryEngineSettings);
-        return jcr.createRepository();
-    }
-
-}
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/CustomPrivilegesIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/CustomPrivilegesIT.java
deleted file mode 100644
index 25ae6e9c..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/CustomPrivilegesIT.java
+++ /dev/null
@@ -1,57 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.IOException;
-
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.api.JackrabbitWorkspace;
-import org.apache.jackrabbit.api.security.authorization.PrivilegeManager;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.junit.Test;
-
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.fail;
-
-/**
- * Test cases for packages with custom privileges
- */
-public class CustomPrivilegesIT extends IntegrationTestBase {
-
-    /**
-     * Installs a package that contains a custom privilege and then checks if it was installed.
-     */
-    @Test
-    public void installWithPrivs() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/privileges.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        // check if privilege was installed
-        PrivilegeManager mgr = ((JackrabbitWorkspace) admin.getWorkspace()).getPrivilegeManager();
-        try {
-            mgr.getPrivilege("testns:testpriv");
-        } catch (RepositoryException e) {
-            fail("testns:testpriv privilege not registered.");
-        }
-    }
-
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/DumpCoverageIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/DumpCoverageIT.java
deleted file mode 100644
index 96be76dd..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/DumpCoverageIT.java
+++ /dev/null
@@ -1,164 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import static org.junit.Assert.assertEquals;
-
-import java.io.IOException;
-import java.util.ArrayList;
-import java.util.Arrays;
-import java.util.Collections;
-import java.util.LinkedList;
-import java.util.List;
-
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.commons.JcrUtils;
-import org.apache.jackrabbit.util.Text;
-import org.apache.jackrabbit.vault.fs.api.PathFilterSet;
-import org.apache.jackrabbit.vault.fs.api.ProgressTrackerListener;
-import org.apache.jackrabbit.vault.fs.config.ConfigurationException;
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.junit.Before;
-import org.junit.Test;
-
-
-/**
- * Tests of coverage dump functionality.
- */
-public class DumpCoverageIT extends IntegrationTestBase {
-
-    public static final String TEST_ROOT = "/testroot";
-
-    public static final List<String> ENGLISH_PAGES = Arrays.asList(TEST_ROOT + "/content/en", TEST_ROOT + "/content/en/foo",
-            TEST_ROOT + "/content/en/bar");
-
-    public static final List<String> FRENCH_PAGES = Arrays.asList(TEST_ROOT + "/content/fr", TEST_ROOT + "/content/fr/foo");
-
-    public static final List<String> LANGUAGE_PAGES;
-    static {
-        LANGUAGE_PAGES = new ArrayList<>();
-        LANGUAGE_PAGES.addAll(ENGLISH_PAGES);
-        LANGUAGE_PAGES.addAll(FRENCH_PAGES);
-    }
-
-    public static final List<String> ALL_PAGES;
-    static {
-        ALL_PAGES = new ArrayList<>();
-        ALL_PAGES.add(TEST_ROOT + "/content");
-        ALL_PAGES.addAll(LANGUAGE_PAGES);
-    }
-
-    public static List<String> ALL_PATHS;
-    static {
-        ALL_PATHS = new ArrayList<>();
-        for (String page : ALL_PAGES) {
-            ALL_PATHS.add(page);
-            ALL_PATHS.add(page + "/jcr:content");
-        }
-    }
-
-    @Before
-    public void init() throws RepositoryException {
-        clean(TEST_ROOT);
-
-        JcrUtils.getOrCreateByPath(TEST_ROOT, "nt:folder", admin);
-        for (String path: ALL_PAGES) {
-            JcrUtils.getOrCreateByPath(path, "nt:folder", admin);
-            JcrUtils.getOrCreateByPath(path + "/jcr:content", "nt:folder", admin);
-        }
-    }
-
-    @Test
-    public void testFullCoverage() throws IOException, RepositoryException, ConfigurationException {
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        PathFilterSet set1 = new PathFilterSet(TEST_ROOT + "/content");
-        filter.add(set1);
-        Collector listener = new Collector();
-        filter.dumpCoverage(admin, listener, false);
-        checkResults("Full coverage needs to include all paths", ALL_PATHS, listener.paths);
-    }
-
-    @Test
-    public void testNoJcrContentCoverage() throws IOException, RepositoryException, ConfigurationException {
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        PathFilterSet set1 = new PathFilterSet(TEST_ROOT + "/content");
-        filter.add(set1);
-        Collector listener = new Collector();
-        filter.dumpCoverage(admin, listener, true);
-        checkResults("Partial coverage needs to include all pages", ALL_PAGES, listener.paths);
-    }
-
-
-    @Test
-    public void testSplitRootsCoverage() throws IOException, RepositoryException, ConfigurationException {
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        PathFilterSet set1 = new PathFilterSet(TEST_ROOT + "/content/en");
-        PathFilterSet set2 = new PathFilterSet(TEST_ROOT + "/content/fr");
-        filter.add(set1);
-        filter.add(set2);
-        Collector listener = new Collector();
-        filter.dumpCoverage(admin, listener, true);
-        checkResults("Split roots", LANGUAGE_PAGES, listener.paths);
-    }
-
-    @Test
-    public void testNestedRootsCoverage() throws IOException, RepositoryException, ConfigurationException {
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        PathFilterSet set1 = new PathFilterSet(TEST_ROOT + "/content/en/foo");
-        PathFilterSet set2 = new PathFilterSet(TEST_ROOT + "/content/fr");
-        PathFilterSet set3 = new PathFilterSet(TEST_ROOT + "/content/en");
-        filter.add(set1);
-        filter.add(set2);
-        filter.add(set3);
-        Collector listener = new Collector();
-        filter.dumpCoverage(admin, listener, true);
-        checkResults("nested roots", LANGUAGE_PAGES, listener.paths);
-    }
-
-    @Test
-    public void testMissingRootsCoverage() throws IOException, RepositoryException, ConfigurationException {
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        PathFilterSet set1 = new PathFilterSet(TEST_ROOT + "/content/f");
-        PathFilterSet set2 = new PathFilterSet(TEST_ROOT + "/content/en");
-        filter.add(set1);
-        filter.add(set2);
-        Collector listener = new Collector();
-        filter.dumpCoverage(admin, listener, true);
-        checkResults("missing roots", ENGLISH_PAGES, listener.paths);
-    }
-
-    private static class Collector implements ProgressTrackerListener {
-        private final List<String> paths = new LinkedList<String>();
-
-        public void onMessage(Mode mode, String action, String path) {
-            paths.add(path);
-        }
-
-        public void onError(Mode mode, String path, Exception e) {
-        }
-    }
-
-    public static void checkResults(String msg, List<String> expected, List<String> result) {
-        Collections.sort(expected);
-        Collections.sort(result);
-        String left = Text.implode(expected.toArray(new String[0]), "\n");
-        String right = Text.implode(result.toArray(new String[0]), "\n");
-        assertEquals(msg, left, right);
-    }
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/EmptyPackageIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/EmptyPackageIT.java
deleted file mode 100644
index 2c5545da..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/EmptyPackageIT.java
+++ /dev/null
@@ -1,240 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.ByteArrayInputStream;
-import java.io.IOException;
-import java.io.InputStream;
-
-import javax.jcr.Node;
-import javax.jcr.RepositoryException;
-import javax.jcr.nodetype.NodeType;
-
-import org.apache.jackrabbit.commons.JcrUtils;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.junit.Test;
-
-import static org.junit.Assert.assertNotNull;
-
-public class EmptyPackageIT extends IntegrationTestBase {
-
-    /**
-     * Installs a package that contains /tmp/foo/bar/tobi and then installs one
-     * that is empty but contains a filter for '/tmp'. expect /tmp to be removed.
-     */
-    @Test
-    public void installEmptyLevel1() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-        assertNodeExists("/tmp/foo/bar/tobi");
-
-        // now install the empty package
-        pack = packMgr.upload(getStream("/test-packages/empty_tmp.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-        assertNodeMissing("/tmp");
-    }
-
-    /**
-     * Installs a package that contains /tmp/foo/bar/tobi and then installs one
-     * that is empty but contains a filter for '/tmp/foo'. expect /tmp/foo to be removed.
-     */
-    @Test
-    public void installEmptyLevel2() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-        assertNodeExists("/tmp/foo/bar/tobi");
-
-        // now install the empty package
-        pack = packMgr.upload(getStream("/test-packages/empty_tmp_foo.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-        assertNodeExists("/tmp");
-        assertNodeMissing("/tmp/foo");
-    }
-
-    /**
-     * Installs a package that contains /tmp/foo/bar/tobi and then installs one
-     * that is empty but contains a filter for '/tmp/foo/bar'. expect /tmp/foo/bar to be removed.
-     */
-    @Test
-    public void installEmptyLevel3() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-        assertNodeExists("/tmp/foo/bar/tobi");
-
-        // now install the empty package
-        pack = packMgr.upload(getStream("/test-packages/empty_tmp_foo_bar.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-        assertNodeExists("/tmp/foo");
-        assertNodeMissing("/tmp/foo/bar");
-    }
-
-    /**
-     * Installs a package that contains /tmp/test/content/foo/foo.jsp and then creates a new node
-     * /tmp/test/content/bar/bar.jsp. Tests if after reinstall the new node was deleted.
-     */
-    @Test
-    public void installEmptyFolder() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_test_folders.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-        assertNodeExists("/tmp/test/content/foo/foo.jsp");
-
-        // create new node
-        Node content = admin.getNode("/tmp/test/content");
-        Node bar = content.addNode("bar", NodeType.NT_FOLDER);
-        InputStream is = new ByteArrayInputStream("hello, world.".getBytes());
-        JcrUtils.putFile(bar, "bar.jsp", "text/plain", is);
-        admin.save();
-
-        // now re-install package
-        pack.install(getDefaultOptions());
-
-        assertNodeMissing("/tmp/test/content/bar");
-        assertNodeMissing("/tmp/test/content/bar/bar.jsp");
-    }
-
-    /**
-     * Installs a package that contains /tmp and then uninstalls it.
-     */
-    @Test
-    public void installUninstallLevel1() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-        assertNodeExists("/tmp/foo/bar/tobi");
-
-        pack.uninstall(getDefaultOptions());
-        assertNodeMissing("/tmp");
-    }
-
-    /**
-     * Installs a package that contains /tmp/foo and then uninstalls it.
-     * expect the intermediate node /tmp remains.
-     */
-    @Test
-    public void installUninstallLevel2() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_foo.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-        assertNodeExists("/tmp/foo/bar/tobi");
-
-        pack.uninstall(getDefaultOptions());
-        assertNodeExists("/tmp");
-        assertNodeMissing("/tmp/foo");
-    }
-
-    /**
-     * Installs a package that contains /tmp/foo/bar and then unnstalls it.
-     * expect the intermediate node /tmp/foo remains.
-     */
-    @Test
-    public void installUninstallLevel3() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_foo_bar.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-        assertNodeExists("/tmp/foo/bar/tobi");
-
-        pack.uninstall(getDefaultOptions());
-        assertNodeExists("/tmp/foo");
-        assertNodeMissing("/tmp/foo/bar");
-    }
-
-
-    /**
-     * Installs a package that contains /tmp, then and empty one, then unnstalls it.
-     * expect the original /tmp/foo/bar/tobi remaining.
-     */
-    @Test
-    public void installUninstallSubsequent() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-        assertNodeExists("/tmp/foo/bar/tobi");
-
-        // now install the empty package
-        JcrPackage pack2 = packMgr.upload(getStream("/test-packages/empty_tmp_foo_bar.zip"), false);
-        assertNotNull(pack2);
-        pack2.install(getDefaultOptions());
-
-        assertNodeExists("/tmp/foo");
-        assertNodeMissing("/tmp/foo/bar");
-
-        pack2.uninstall(getDefaultOptions());
-        assertNodeExists("/tmp/foo/bar/tobi");
-    }
-
-    /**
-     * Installs a package that contains /tmp/foo/bar/test.txt and then uninstalls it.
-     */
-    @Test
-    public void installUninstallFile() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_foo_bar_test.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-        assertNodeExists("/tmp/foo/bar/test.txt");
-
-        pack.uninstall(getDefaultOptions());
-        assertNodeExists("/tmp/foo/bar");
-        assertNodeMissing("/tmp/foo/bar/test.txt");
-    }
-
-
-    /**
-     * Installs a package that contains /tmp/foo/bar/test.txt but no filter for it.
-     */
-    @Test
-    public void installInstallNoFilter() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_foo_bar_test_nofilter.zip"), false);
-        assertNotNull(pack);
-        ImportOptions opts = getDefaultOptions();
-        opts.setStrict(false);
-        pack.install(opts);
-        assertNodeExists("/tmp/foo/bar/test.txt");
-
-        pack.uninstall(opts);
-        assertNodeExists("/tmp/foo/bar/test.txt");
-    }
-
-
-    /**
-     * Installs a package that contains no filter and no .content.xml files.
-     */
-    @Test
-    public void installInstallMinimal() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_foo_bar_test_minimal.zip"), false);
-        assertNotNull(pack);
-        ImportOptions opts = getDefaultOptions();
-        opts.setStrict(false);
-        pack.install(opts);
-        
-        assertNodeExists("/tmp/foo/bar/test.txt");
-
-        pack.uninstall(opts);
-        assertNodeExists("/tmp/foo/bar/test.txt");
-    }
-
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/EnforcedDependenciesIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/EnforcedDependenciesIT.java
deleted file mode 100644
index 84247e90..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/EnforcedDependenciesIT.java
+++ /dev/null
@@ -1,460 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.IOException;
-
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.packaging.CyclicDependencyException;
-import org.apache.jackrabbit.vault.packaging.Dependency;
-import org.apache.jackrabbit.vault.packaging.DependencyException;
-import org.apache.jackrabbit.vault.packaging.DependencyHandling;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.PackageId;
-import org.junit.Test;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.fail;
-
-/**
- * Tests that cover installation and uninstallation with enforced dependency checks.
- */
-public class EnforcedDependenciesIT extends IntegrationTestBase {
-
-    /**
-     * Test package A-1.0. Depends on B and C-1.X
-     */
-    private static String TEST_PACKAGE_A_10 = "/test-packages/test_a-1.0.zip";
-
-    /**
-     * Test package A-2.0. Depends on B and C-2.X
-     */
-    private static String TEST_PACKAGE_A_20 = "/test-packages/test_a-2.0.zip";
-
-    /**
-     * Test package B-1.0. Depends on C
-     */
-    private static String TEST_PACKAGE_B_10 = "/test-packages/test_b-1.0.zip";
-
-    /**
-     * Test package C-1.0
-     */
-    private static String TEST_PACKAGE_C_10 = "/test-packages/test_c-1.0.zip";
-
-    /**
-     * Test package C-1.1
-     */
-    private static String TEST_PACKAGE_C_11 = "/test-packages/test_c-1.1.zip";
-
-    /**
-     * Test package C-2.0
-     */
-    private static String TEST_PACKAGE_C_20 = "/test-packages/test_c-2.0.zip";
-
-    /**
-     * Test package D-1.0. Depends on B and E
-     */
-    private static String TEST_PACKAGE_D_10 = "/test-packages/test_d-1.0.zip";
-
-    /**
-     * Test package E-1.0. Depends on D
-     */
-    private static String TEST_PACKAGE_E_10 = "/test-packages/test_e-1.0.zip";
-
-    /**
-     * Tests if dependencies are ignored by default
-     */
-    @Test
-    public void testIgnoredDependencies() throws RepositoryException, IOException, PackageException {
-        JcrPackage a1 = installPackage(TEST_PACKAGE_A_10);
-        assertProperty("/tmp/a/version", "1.0");
-        JcrPackage a2= installPackage(TEST_PACKAGE_A_20);
-        assertProperty("/tmp/a/version", "2.0");
-        JcrPackage b1 = installPackage(TEST_PACKAGE_B_10);
-        assertProperty("/tmp/b/version", "1.0");
-        JcrPackage c1 = installPackage(TEST_PACKAGE_C_10);
-        assertProperty("/tmp/c/version", "1.0");
-
-        c1.uninstall(getDefaultOptions());
-        assertNodeMissing("/tmp/c");
-
-        b1.uninstall(getDefaultOptions());
-        assertNodeMissing("/tmp/b");
-
-        a2.uninstall(getDefaultOptions());
-        assertProperty("/tmp/a/version", "1.0");
-
-        a1.uninstall(getDefaultOptions());
-        assertNodeMissing("/tmp/a");
-    }
-
-    /**
-     * Test unresolved calculation
-     */
-    @Test
-    public void testUnresolved() throws IOException, RepositoryException {
-        JcrPackage a1 = uploadPackage(TEST_PACKAGE_A_10);
-        Dependency[] deps = a1.getUnresolvedDependencies();
-        assertEquals("package must report unresolved dependencies", "my_packages:test_b,my_packages:test_c:[1.0,2.0)", Dependency.toString(deps));
-    }
-
-    /**
-     * Test if installing B fails if C is missing.
-     */
-    @Test
-    public void testInstallDepMissing() throws IOException, RepositoryException, PackageException {
-        JcrPackage b1 = uploadPackage(TEST_PACKAGE_B_10);
-        ImportOptions opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.STRICT);
-        try {
-            b1.install(opts);
-            fail("Installing with missing dependency must fail.");
-        } catch (DependencyException e) {
-            // expected
-        }
-    }
-
-    /**
-     * Test if installing A fails if C is missing.
-     */
-    @Test
-    public void testInstallDepMissingRequired() throws IOException, RepositoryException, PackageException {
-        uploadPackage(TEST_PACKAGE_B_10);
-        JcrPackage a1 = uploadPackage(TEST_PACKAGE_A_10);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.REQUIRED);
-        try {
-            a1.install(opts);
-            fail("Installing with missing dependency must fail.");
-        } catch (DependencyException e) {
-            // expected
-        }
-    }
-
-    /**
-     * Test if installing B fails if C is loaded but not installed
-     */
-    @Test
-    public void testInstallDepUninstalled() throws IOException, RepositoryException, PackageException {
-        uploadPackage(TEST_PACKAGE_C_10);
-        assertNodeMissing("/tmp/c/");
-        JcrPackage b1 = uploadPackage(TEST_PACKAGE_B_10);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.STRICT);
-
-        try {
-            b1.install(opts);
-            fail("Installing with uninstalled dependency must fail.");
-        } catch (DependencyException e) {
-            // expected
-        }
-    }
-
-    /**
-     * Test if installing B automatically installs C
-     */
-    @Test
-    public void testInstallDepInstallsRequired() throws IOException, RepositoryException, PackageException {
-        uploadPackage(TEST_PACKAGE_C_10);
-        assertNodeMissing("/tmp/c/");
-        JcrPackage b1 = uploadPackage(TEST_PACKAGE_B_10);
-        assertNotNull(b1);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.REQUIRED);
-
-        b1.install(opts);
-        assertProperty("/tmp/b/version", "1.0");
-        assertProperty("/tmp/c/version", "1.0");
-    }
-
-    /**
-     * Test if installing A-2.0 automatically installs B and C-2.0
-     */
-    @Test
-    public void testInstallDepInstallsAll() throws IOException, RepositoryException, PackageException {
-        uploadPackage(TEST_PACKAGE_C_10);
-        uploadPackage(TEST_PACKAGE_C_11);
-        uploadPackage(TEST_PACKAGE_C_20);
-        uploadPackage(TEST_PACKAGE_B_10);
-        assertNodeMissing("/tmp/b/");
-        assertNodeMissing("/tmp/c/");
-        JcrPackage a2 = uploadPackage(TEST_PACKAGE_A_20);
-        assertNotNull(a2);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.REQUIRED);
-
-        a2.install(opts);
-        assertProperty("/tmp/a/version", "2.0");
-        assertProperty("/tmp/b/version", "1.0");
-        assertProperty("/tmp/c/version", "2.0");
-    }
-
-    /**
-     * Test if installing D automatically installs B and C
-     */
-    @Test
-    public void testInstallDeep() throws IOException, RepositoryException, PackageException {
-        uploadPackage(TEST_PACKAGE_C_10);
-        uploadPackage(TEST_PACKAGE_B_10);
-        assertNodeMissing("/tmp/b/");
-        assertNodeMissing("/tmp/c/");
-        JcrPackage d1 = uploadPackage(TEST_PACKAGE_D_10);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.BEST_EFFORT);
-
-        d1.install(opts);
-        assertProperty("/tmp/d/version", "1.0");
-        assertProperty("/tmp/b/version", "1.0");
-        assertProperty("/tmp/c/version", "1.0");
-    }
-
-    /**
-     * Test if installing D with E causes cyclic error for REQUIRED
-     */
-    @Test
-    public void testInstallCyclicFails() throws IOException, RepositoryException, PackageException {
-        uploadPackage(TEST_PACKAGE_B_10);
-        uploadPackage(TEST_PACKAGE_C_10);
-        uploadPackage(TEST_PACKAGE_E_10);
-        JcrPackage d1 = uploadPackage(TEST_PACKAGE_D_10);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.REQUIRED);
-
-        try {
-            d1.install(opts);
-            fail("installing D -> E -> D should cause cyclic dependency exception.");
-        } catch (CyclicDependencyException e) {
-            // ok
-        }
-    }
-
-    /**
-     * Test if installing D with E does not cause cyclic error for BEST_EFFORT
-     */
-    @Test
-    public void testInstallCyclicSucceeds() throws IOException, RepositoryException, PackageException {
-        uploadPackage(TEST_PACKAGE_B_10);
-        uploadPackage(TEST_PACKAGE_C_10);
-        uploadPackage(TEST_PACKAGE_E_10);
-        JcrPackage d1 = uploadPackage(TEST_PACKAGE_D_10);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.BEST_EFFORT);
-
-        d1.install(opts);
-        assertProperty("/tmp/b/version", "1.0");
-        assertProperty("/tmp/c/version", "1.0");
-        assertProperty("/tmp/d/version", "1.0");
-        assertProperty("/tmp/e/version", "1.0");
-    }
-
-    /**
-     * Test if installing A-1.0 automatically installs B and C-1.1
-     */
-    @Test
-    public void testInstallDepInstallsCorrectVersion() throws IOException, RepositoryException, PackageException {
-        uploadPackage(TEST_PACKAGE_C_10);
-        uploadPackage(TEST_PACKAGE_C_11);
-        uploadPackage(TEST_PACKAGE_C_20);
-        uploadPackage(TEST_PACKAGE_B_10);
-        assertNodeMissing("/tmp/b/");
-        assertNodeMissing("/tmp/c/");
-        JcrPackage a1 = uploadPackage(TEST_PACKAGE_A_10);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.REQUIRED);
-
-        a1.install(opts);
-        assertProperty("/tmp/a/version", "1.0");
-        assertProperty("/tmp/b/version", "1.0");
-        assertProperty("/tmp/c/version", "1.1");
-    }
-
-    /**
-     * Test if installing besteffort works
-     */
-    @Test
-    public void testInstallDepInstallsBestEffort() throws IOException, RepositoryException, PackageException {
-        uploadPackage(TEST_PACKAGE_C_10);
-        assertNodeMissing("/tmp/c/");
-        JcrPackage a1 = uploadPackage(TEST_PACKAGE_A_10);
-        assertNotNull(a1);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.BEST_EFFORT);
-
-        a1.install(opts);
-        assertProperty("/tmp/a/version", "1.0");
-        assertProperty("/tmp/c/version", "1.0");
-    }
-
-    /**
-     * Test if installing B succeeds if C is installed
-     */
-    @Test
-    public void testInstallDepInstalled() throws IOException, RepositoryException, PackageException {
-        installPackage(TEST_PACKAGE_C_10);
-        assertProperty("/tmp/c/version", "1.0");
-        JcrPackage b1 = uploadPackage(TEST_PACKAGE_B_10);
-        assertNotNull(b1);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.STRICT);
-        b1.install(opts);
-        assertProperty("/tmp/b/version", "1.0");
-    }
-
-    /**
-     * Test if installing A fails if C has the wrong version
-     */
-    @Test
-    public void testInstallWrongVersion() throws IOException, RepositoryException, PackageException {
-        installPackage(TEST_PACKAGE_C_10);
-        assertProperty("/tmp/c/version", "1.0");
-
-        JcrPackage a2 = uploadPackage(TEST_PACKAGE_A_20);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.STRICT);
-
-        try {
-            a2.install(opts);
-            fail("Installing with wrong installed version dependency must fail.");
-        } catch (DependencyException e) {
-            // expected
-        }
-    }
-
-    /**
-     * Test if installing A succeeds if C has correct version
-     */
-    @Test
-    public void testInstallCorrectVersion() throws IOException, RepositoryException, PackageException {
-        installPackage(TEST_PACKAGE_B_10);
-        assertProperty("/tmp/b/version", "1.0");
-        installPackage(TEST_PACKAGE_C_11);
-        assertProperty("/tmp/c/version", "1.1");
-
-        JcrPackage a1 = uploadPackage(TEST_PACKAGE_A_10);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.STRICT);
-
-        a1.install(opts);
-        assertProperty("/tmp/a/version", "1.0");
-    }
-
-    /**
-     * Test if un-installing C fails if B is still installed
-     */
-    @Test
-    public void testUninstallStrict() throws IOException, RepositoryException, PackageException {
-        JcrPackage c1 = installPackage(TEST_PACKAGE_C_10);
-        assertProperty("/tmp/c/version", "1.0");
-        installPackage(TEST_PACKAGE_B_10);
-        assertProperty("/tmp/b/version", "1.0");
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.STRICT);
-
-        try {
-            c1.uninstall(opts);
-            fail("Uninstalling must fail if another package still requires it.");
-        } catch (DependencyException e) {
-            // expected
-        }
-    }
-
-    /**
-     * Test if un-installing C auto-uninstalls A and B for BEST_EFFORT
-     */
-    @Test
-    public void testUninstallBestEffort() throws IOException, RepositoryException, PackageException {
-        installPackage(TEST_PACKAGE_A_10);
-        installPackage(TEST_PACKAGE_B_10);
-        JcrPackage c1 = installPackage(TEST_PACKAGE_C_10);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.BEST_EFFORT);
-
-        c1.uninstall(opts);
-        assertNodeMissing("/tmp/a");
-        assertNodeMissing("/tmp/b");
-        assertNodeMissing("/tmp/c");
-    }
-
-    /**
-     * Test if un-installing C auto-uninstalls A and B for REQUIRED
-     */
-    @Test
-    public void testUninstallRequired() throws IOException, RepositoryException, PackageException {
-        installPackage(TEST_PACKAGE_A_10);
-        installPackage(TEST_PACKAGE_B_10);
-        JcrPackage c1 = installPackage(TEST_PACKAGE_C_10);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.REQUIRED);
-
-        c1.uninstall(opts);
-        assertNodeMissing("/tmp/a");
-        assertNodeMissing("/tmp/b");
-        assertNodeMissing("/tmp/c");
-    }
-
-    /**
-     * Test if uninstalling D with E does not causes cyclic error
-     */
-    @Test
-    public void testUnInstallCyclicSucceeds() throws IOException, RepositoryException, PackageException {
-        installPackage(TEST_PACKAGE_D_10);
-        JcrPackage e1 = installPackage(TEST_PACKAGE_E_10);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.REQUIRED);
-
-        e1.uninstall(opts);
-        assertNodeMissing("/tmp/e");
-        assertNodeMissing("/tmp/d");
-    }
-
-
-    /**
-     * Tests package manager usage method
-     */
-    @Test
-    public void testUsage() throws RepositoryException, IOException, PackageException {
-        installPackage(TEST_PACKAGE_A_20);
-        installPackage(TEST_PACKAGE_B_10);
-        JcrPackage c1 = installPackage(TEST_PACKAGE_C_20);
-
-        PackageId[] usage = packMgr.usage(c1.getDefinition().getId());
-        assertEquals("correct usage", "my_packages:test_a:2.0,my_packages:test_b:1.0", PackageId.toString(usage));
-    }
-
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/EscapedExportIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/EscapedExportIT.java
deleted file mode 100644
index b6ffbf51..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/EscapedExportIT.java
+++ /dev/null
@@ -1,142 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.ByteArrayInputStream;
-import java.io.File;
-import java.io.IOException;
-import java.util.Properties;
-
-import javax.jcr.Node;
-import javax.jcr.RepositoryException;
-import javax.jcr.nodetype.NodeType;
-
-import org.apache.jackrabbit.commons.JcrUtils;
-import org.apache.jackrabbit.vault.fs.api.PathFilterSet;
-import org.apache.jackrabbit.vault.fs.config.DefaultMetaInf;
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.apache.jackrabbit.vault.packaging.ExportOptions;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.VaultPackage;
-import org.junit.Before;
-import org.junit.Test;
-
-/**
- * Test export / import of specially escaped node names.
- */
-public class EscapedExportIT extends IntegrationTestBase {
-
-    private final static String[] FILE_NAMES = {
-            "_jcr_myfile.data",
-            "jcr:myfile.data",
-            ".data",
-            "Spr16_PR_T_001_x0009_VS_R1.data"
-    };
-
-    @Before
-    public void setUp() throws Exception {
-        super.setUp();
-    }
-
-    @Test
-    public void unicodeEscapedFilesExportAndImportOk() throws IOException, RepositoryException, PackageException {
-        String data = "Hello, World.";
-        Node tmp = admin.getRootNode().addNode("tmp", NodeType.NT_FOLDER);
-        for (String fileName: FILE_NAMES) {
-            JcrUtils.putFile(tmp, fileName, "text/plain", new ByteArrayInputStream(data.getBytes()));
-        }
-        admin.save();
-
-        assembleAndReinstallPackage();
-
-        // validate the extracted content
-        for (String fileName: FILE_NAMES) {
-            assertProperty("/tmp/" + fileName + "/jcr:content/jcr:data", data);
-        }
-
-    }
-
-    @Test
-    public void unicodeEscapedNodesExportAndImportOk() throws IOException, RepositoryException, PackageException {
-        Node tmp = admin.getRootNode().addNode("tmp", NodeType.NT_FOLDER);
-        Node test = tmp.addNode("test", NodeType.NT_FILE);
-        test.addMixin("vlt:FullCoverage");
-        Node content = test.addNode(Node.JCR_CONTENT, NodeType.NT_UNSTRUCTURED);
-        for (String fileName: FILE_NAMES) {
-            content.addNode(fileName);
-        }
-        admin.save();
-
-        assembleAndReinstallPackage();
-
-        // validate the extracted content
-        for (String fileName: FILE_NAMES) {
-            assertNodeExists("/tmp/test/jcr:content/" + fileName);
-        }
-
-    }
-
-    @Test
-    public void unicodeEscapedPropertiesExportAndImportOk() throws IOException, RepositoryException, PackageException {
-        String data = "Hello, World.";
-        Node tmp = admin.getRootNode().addNode("tmp", NodeType.NT_FOLDER);
-        Node test = tmp.addNode("test", NodeType.NT_FILE);
-        test.addMixin("vlt:FullCoverage");
-        Node content = test.addNode(Node.JCR_CONTENT, NodeType.NT_UNSTRUCTURED);
-        for (String fileName: FILE_NAMES) {
-            content.setProperty(fileName, data);
-        }
-        admin.save();
-
-        assembleAndReinstallPackage();
-
-        // validate the extracted content
-        for (String fileName: FILE_NAMES) {
-            assertProperty("/tmp/test/jcr:content/" + fileName, data);
-        }
-
-    }
-
-    private void assembleAndReinstallPackage() throws IOException, PackageException, RepositoryException {
-        File pkgFile = File.createTempFile("vaulttest", ".zip");
-
-        try {
-            ExportOptions options = new ExportOptions();
-            DefaultMetaInf meta = new DefaultMetaInf();
-            DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-            filter.add(new PathFilterSet("/tmp"));
-            meta.setFilter(filter);
-
-            Properties props = new Properties();
-            props.setProperty(VaultPackage.NAME_GROUP, "jackrabbit/test");
-            props.setProperty(VaultPackage.NAME_NAME, "filtered-export-package");
-            meta.setProperties(props);
-            options.setMetaInf(meta);
-
-            packMgr.assemble(admin, options, pkgFile).close();
-
-            clean("/tmp");
-            try (VaultPackage vp = packMgr.open(pkgFile)) {
-                vp.extract(admin, getDefaultOptions());
-            }
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ExecutionPlanIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ExecutionPlanIT.java
deleted file mode 100644
index 2a0cba27..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ExecutionPlanIT.java
+++ /dev/null
@@ -1,366 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.ByteArrayInputStream;
-import java.io.ByteArrayOutputStream;
-import java.io.IOException;
-
-import org.apache.jackrabbit.vault.packaging.CyclicDependencyException;
-import org.apache.jackrabbit.vault.packaging.DependencyException;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.PackageId;
-import org.apache.jackrabbit.vault.packaging.registry.ExecutionPlan;
-import org.apache.jackrabbit.vault.packaging.registry.ExecutionPlanBuilder;
-import org.apache.jackrabbit.vault.packaging.registry.PackageRegistry;
-import org.apache.jackrabbit.vault.packaging.registry.PackageTask;
-import org.apache.jackrabbit.vault.packaging.registry.impl.JcrPackageRegistry;
-import org.junit.Before;
-import org.junit.Test;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertFalse;
-import static org.junit.Assert.assertTrue;
-import static org.junit.Assert.fail;
-
-/**
- * Test the Package registry interface
- */
-public class ExecutionPlanIT extends IntegrationTestBase {
-
-    private static final PackageId TMP_PACKAGE_ID = new PackageId("my_packages", "tmp", "");
-
-    /**
-     * Test package A-1.0. Depends on B and C-1.X
-     */
-    private static String TEST_PACKAGE_A_10 = "/test-packages/test_a-1.0.zip";
-    private static PackageId TEST_PACKAGE_ID_A_10 = PackageId.fromString("my_packages:test_a:1.0");
-
-    /**
-     * Test package B-1.0. Depends on C
-     */
-    private static String TEST_PACKAGE_B_10 = "/test-packages/test_b-1.0.zip";
-    private static PackageId TEST_PACKAGE_ID_B_10 = PackageId.fromString("my_packages:test_b:1.0");
-
-    /**
-     * Test package C-1.0
-     */
-    private static String TEST_PACKAGE_C_10 = "/test-packages/test_c-1.0.zip";
-    private static PackageId TEST_PACKAGE_ID_C_10 = PackageId.fromString("my_packages:test_c:1.0");
-
-    /**
-     * Test package D-1.0. Depends on B and E
-     */
-    private static String TEST_PACKAGE_D_10 = "/test-packages/test_d-1.0.zip";
-
-    /**
-     * Test package E-1.0. Depends on D
-     */
-    private static String TEST_PACKAGE_E_10 = "/test-packages/test_e-1.0.zip";
-
-
-    private PackageRegistry registry;
-
-    @Override
-    @Before
-    public void setUp() throws Exception {
-        super.setUp();
-
-        registry = new JcrPackageRegistry(admin);
-    }
-
-    /**
-     * test execution plan serialization
-     */
-    @Test
-    public void testSerialization() throws IOException, PackageException {
-        PackageId idC = registry.register(getStream(TEST_PACKAGE_C_10), false);
-        PackageId idB = registry.register(getStream(TEST_PACKAGE_B_10), false);
-        ByteArrayOutputStream out = new ByteArrayOutputStream();
-        ExecutionPlanBuilder builder = registry.createExecutionPlan();
-        builder
-                .addTask().with(idB).with(PackageTask.Type.EXTRACT)
-                .addTask().with(idC).with(PackageTask.Type.INSTALL)
-                .addTask().with(idC).with(PackageTask.Type.REMOVE)
-                .addTask().with(idC).with(PackageTask.Type.UNINSTALL)
-                .save(out);
-
-        String expected =
-                "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
-                        "<executionPlan version=\"1.0\">\n" +
-                        "    <task cmd=\"uninstall\" packageId=\"my_packages:test_c:1.0\"/>\n" +
-                        "    <task cmd=\"remove\" packageId=\"my_packages:test_c:1.0\"/>\n" +
-                        "    <task cmd=\"install\" packageId=\"my_packages:test_c:1.0\"/>\n" +
-                        "    <task cmd=\"extract\" packageId=\"my_packages:test_b:1.0\"/>\n" +
-                        "</executionPlan>\n";
-
-        String result = out.toString("utf-8");
-        assertEquals(expected, result);
-
-        out = new ByteArrayOutputStream();
-        registry.createExecutionPlan().load(new ByteArrayInputStream(expected.getBytes("utf-8"))).save(out);
-        result = out.toString("utf-8");
-        assertEquals(expected, result);
-    }
-
-    /**
-     * Tests if validation fails of the task don't have the required properties
-     */
-    @Test
-    public void testValidationFailsForNoIdOrType() throws IOException, PackageException {
-        try {
-            ExecutionPlanBuilder builder = registry.createExecutionPlan();
-            builder.addTask().with(PackageTask.Type.UNINSTALL);
-            builder.validate();
-            fail("task with no id must not validate");
-        } catch (PackageException e) {
-            // expected
-        }
-
-        try {
-            ExecutionPlanBuilder builder = registry.createExecutionPlan();
-            builder.addTask().with(TMP_PACKAGE_ID);
-            builder.validate();
-            fail("task with no type must not validate");
-        } catch (PackageException e) {
-            // expected
-        }
-    }
-
-    @Test
-    public void testInstallTask() throws IOException, PackageException {
-        PackageId idA = registry.register(getStream(TEST_PACKAGE_A_10), false);
-        PackageId idB = registry.register(getStream(TEST_PACKAGE_B_10), false);
-        PackageId idC = registry.register(getStream(TEST_PACKAGE_C_10), false);
-        assertFalse("package A is not installed", registry.open(idA).isInstalled());
-        assertFalse("package B is not installed", registry.open(idB).isInstalled());
-        assertFalse("package C is not installed", registry.open(idC).isInstalled());
-
-        ExecutionPlan plan = registry.createExecutionPlan()
-                .addTask().with(idA).with(PackageTask.Type.INSTALL)
-                .with(admin)
-                .with(getDefaultOptions().getListener())
-                .execute();
-        assertTrue("plan is finished", plan.isExecuted());
-        assertFalse("plan has no errors", plan.hasErrors());
-
-        assertTrue("package A is installed", registry.open(idA).isInstalled());
-        assertTrue("package B is installed", registry.open(idB).isInstalled());
-        assertTrue("package C is installed", registry.open(idC).isInstalled());
-    }
-
-    @Test
-    public void testInstallTask2() throws IOException, PackageException {
-        PackageId idA = registry.register(getStream(TEST_PACKAGE_A_10), false);
-        PackageId idB = registry.register(getStream(TEST_PACKAGE_B_10), false);
-        PackageId idC = registry.register(getStream(TEST_PACKAGE_C_10), false);
-        assertFalse("package A is not installed", registry.open(idA).isInstalled());
-        assertFalse("package B is not installed", registry.open(idB).isInstalled());
-        assertFalse("package C is not installed", registry.open(idC).isInstalled());
-
-        ExecutionPlan plan = registry.createExecutionPlan()
-                .addTask().with(idC).with(PackageTask.Type.INSTALL)
-                .addTask().with(idA).with(PackageTask.Type.INSTALL)
-                .with(admin)
-                .with(getDefaultOptions().getListener())
-                .execute();
-        assertTrue("plan is finished", plan.isExecuted());
-        assertFalse("plan has no errors", plan.hasErrors());
-
-        assertTrue("package A is installed", registry.open(idA).isInstalled());
-        assertTrue("package B is installed", registry.open(idB).isInstalled());
-        assertTrue("package C is installed", registry.open(idC).isInstalled());
-    }
-
-    @Test
-    public void testValidateCyclicTaskFails() throws IOException, PackageException {
-        PackageId idB = registry.register(getStream(TEST_PACKAGE_B_10), false);
-        PackageId idC = registry.register(getStream(TEST_PACKAGE_C_10), false);
-        PackageId idD = registry.register(getStream(TEST_PACKAGE_D_10), false);
-        PackageId idE = registry.register(getStream(TEST_PACKAGE_E_10), false);
-        assertFalse("package B is not installed", registry.open(idB).isInstalled());
-        assertFalse("package C is not installed", registry.open(idD).isInstalled());
-        assertFalse("package D is not installed", registry.open(idC).isInstalled());
-        assertFalse("package E is not installed", registry.open(idE).isInstalled());
-
-        try {
-            registry.createExecutionPlan()
-                    .addTask().with(idD).with(PackageTask.Type.INSTALL)
-                    .with(admin)
-                    .with(getDefaultOptions().getListener())
-                    .validate();
-            fail("plan should fail with CyclicDependencyException");
-        } catch (CyclicDependencyException e) {
-            // expected
-        }
-    }
-
-    @Test
-    public void testMissingDependencyFails() throws IOException, PackageException {
-        PackageId idB = registry.register(getStream(TEST_PACKAGE_B_10), false);
-        assertFalse("package B is not installed", registry.open(idB).isInstalled());
-
-        try {
-            registry.createExecutionPlan()
-                    .addTask().with(idB).with(PackageTask.Type.INSTALL)
-                    .with(admin)
-                    .with(getDefaultOptions().getListener())
-                    .validate();
-            fail("plan should fail with DependencyException");
-        } catch (DependencyException e) {
-            // expected
-        }
-    }
-
-    @Test
-    public void testValidateMissingFails() throws IOException {
-        for (PackageTask.Type type: PackageTask.Type.values()) {
-            try {
-                registry.createExecutionPlan().addTask().with(TEST_PACKAGE_ID_A_10).with(type).validate();
-                fail(type + " task with missing package must not validate");
-            } catch (PackageException e) {
-                // ok
-            }
-        }
-    }
-
-    @Test
-    public void testUninstallTask() throws IOException, PackageException {
-        testInstallTask();
-
-        ExecutionPlan plan = registry.createExecutionPlan()
-                .addTask().with(TEST_PACKAGE_ID_A_10).with(PackageTask.Type.UNINSTALL)
-                .with(admin)
-                .with(getDefaultOptions().getListener())
-                .execute();
-        assertTrue("plan is finished", plan.isExecuted());
-        assertFalse("plan has no errors", plan.hasErrors());
-
-        assertFalse("package A is not installed", registry.open(TEST_PACKAGE_ID_A_10).isInstalled());
-    }
-
-    @Test
-    public void testUninstallAutomaticDependenciesTask() throws IOException, PackageException {
-        testInstallTask();
-
-        ExecutionPlan plan = registry.createExecutionPlan()
-                .addTask().with(TEST_PACKAGE_ID_C_10).with(PackageTask.Type.UNINSTALL)
-                .with(admin)
-                .with(getDefaultOptions().getListener())
-                .execute();
-        assertTrue("plan is finished", plan.isExecuted());
-        assertFalse("plan has no errors", plan.hasErrors());
-
-        assertFalse("package A is not installed", registry.open(TEST_PACKAGE_ID_A_10).isInstalled());
-        assertFalse("package B is not installed", registry.open(TEST_PACKAGE_ID_B_10).isInstalled());
-        assertFalse("package C is not installed", registry.open(TEST_PACKAGE_ID_C_10).isInstalled());
-    }
-
-    @Test
-    public void testRemoveTask() throws IOException, PackageException {
-        PackageId idA = registry.register(getStream(TEST_PACKAGE_A_10), false);
-        assertTrue("package A is registered", registry.contains(idA));
-
-        ExecutionPlan plan = registry.createExecutionPlan()
-                .addTask().with(idA).with(PackageTask.Type.REMOVE)
-                .with(admin)
-                .with(getDefaultOptions().getListener())
-                .execute();
-        assertTrue("plan is finished", plan.isExecuted());
-        assertFalse("plan has no errors", plan.hasErrors());
-        assertFalse("package A is removed", registry.contains(idA));
-    }
-
-    @Test
-    public void testRemoveInstalledTask() throws IOException, PackageException {
-        testInstallTask();
-
-        ExecutionPlan plan = registry.createExecutionPlan()
-                .addTask().with(TEST_PACKAGE_ID_C_10).with(PackageTask.Type.REMOVE)
-                .with(admin)
-                .with(getDefaultOptions().getListener())
-                .execute();
-        assertTrue("plan is finished", plan.isExecuted());
-        assertTrue("plan has errors", plan.hasErrors());
-        assertTrue("package A is not removed", registry.contains(TEST_PACKAGE_ID_C_10));
-    }
-
-    @Test
-    public void testExtractTask() throws IOException, PackageException {
-        PackageId idA = registry.register(getStream(TEST_PACKAGE_A_10), false);
-        PackageId idB = registry.register(getStream(TEST_PACKAGE_B_10), false);
-        PackageId idC = registry.register(getStream(TEST_PACKAGE_C_10), false);
-        assertFalse("package A is not installed", registry.open(idA).isInstalled());
-        assertFalse("package B is not installed", registry.open(idB).isInstalled());
-        assertFalse("package C is not installed", registry.open(idC).isInstalled());
-
-        ExecutionPlan plan = registry.createExecutionPlan()
-                .addTask().with(idA).with(PackageTask.Type.EXTRACT)
-                .with(admin)
-                .with(getDefaultOptions().getListener())
-                .execute();
-        assertTrue("plan is finished", plan.isExecuted());
-        assertFalse("plan has no errors", plan.hasErrors());
-
-        assertTrue("package A is installed", registry.open(idA).isInstalled());
-        assertTrue("package B is installed", registry.open(idB).isInstalled());
-        assertTrue("package C is installed", registry.open(idC).isInstalled());
-    }
-
-    @Test
-    public void testStackedExecutionPlans() throws IOException, PackageException {
-        PackageId idA = registry.register(getStream(TEST_PACKAGE_A_10), false);
-        PackageId idB = registry.register(getStream(TEST_PACKAGE_B_10), false);
-        PackageId idC = registry.register(getStream(TEST_PACKAGE_C_10), false);
-        
-        assertFalse("package A is not installed", registry.open(idA).isInstalled());
-        assertFalse("package B is not installed", registry.open(idB).isInstalled());
-        assertFalse("package C is not installed", registry.open(idC).isInstalled());
-
-        ExecutionPlanBuilder builder1 = registry.createExecutionPlan()
-                .addTask().with(idB).with(PackageTask.Type.EXTRACT)
-                .addTask().with(idC).with(PackageTask.Type.EXTRACT)
-                .with(admin)
-                .with(getDefaultOptions().getListener());
-        
-        
-        // create new executionPlanBuilder for package A
-        ExecutionPlanBuilder builder2 = registry.createExecutionPlan()
-                .addTask().with(idA).with(PackageTask.Type.EXTRACT)
-                .with(admin)
-                .with(getDefaultOptions().getListener());
-        assertEquals("builder2 contains all packageTasks", 3, builder2.preview().size());
-        
-        // If calculatedIds of builder1 are declared external idB & idC should be removed
-        builder2.with(builder1.preview());
-        assertEquals("builder2 only contains 1 PackageTask", 1, builder2.preview().size());
-        assertEquals("builder2 handles only idA", builder2.preview().iterator().next(), idA);
-        
-        ExecutionPlan plan = builder2.execute();
-        assertTrue("builder2 should fail before builder1 is executed.",plan.hasErrors());
-        
-        builder1.execute();
-        
-        // revalidate builder2 to reset error state (calculate implicitly validates)
-        assertEquals("builder2 only contains 1 PackageTask", 1, builder2.preview().size());
-        
-        ExecutionPlan plan2 = builder2.execute();
-        assertFalse("builder2 should succeed after builder1 has been executed.", plan2.hasErrors());
-        
-    }
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ExportWithQuotedPatternIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ExportWithQuotedPatternIT.java
deleted file mode 100644
index 255e7a61..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ExportWithQuotedPatternIT.java
+++ /dev/null
@@ -1,116 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.File;
-import java.io.IOException;
-import java.util.Properties;
-import java.util.regex.Pattern;
-
-import javax.jcr.Node;
-import javax.jcr.RepositoryException;
-import javax.jcr.Session;
-
-import org.apache.jackrabbit.vault.fs.api.PathFilterSet;
-import org.apache.jackrabbit.vault.fs.api.WorkspaceFilter;
-import org.apache.jackrabbit.vault.fs.config.ConfigurationException;
-import org.apache.jackrabbit.vault.fs.config.DefaultMetaInf;
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.apache.jackrabbit.vault.fs.filter.DefaultPathFilter;
-import org.apache.jackrabbit.vault.packaging.ExportOptions;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.VaultPackage;
-import org.junit.Before;
-import org.junit.Test;
-
-import static org.junit.Assert.assertFalse;
-import static org.junit.Assert.assertTrue;
-
-public class ExportWithQuotedPatternIT extends IntegrationTestBase {
-
-    @Before
-    public void setUp() throws Exception {
-        super.setUp();
-        setupContent(admin);
-        admin.save();
-    }
-
-    private static final String NAME = "f(o";
-
-    @Test
-    public void quotedPattern() throws IOException, RepositoryException, PackageException, ConfigurationException {
-        String path = "/tmp/" + NAME;
-
-        PathFilterSet nodes = new PathFilterSet(path);
-        nodes.addInclude(new DefaultPathFilter(Pattern.quote(path)));
-
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(nodes);
-
-        // export and extract
-        File pkgFile = assemblePackage(filter);
-
-        clean(path);
-        try (VaultPackage vp = packMgr.open(pkgFile)) {
-            vp.extract(admin, getDefaultOptions());
-            // validate the extracted content
-            assertNodeExists(path);
-            assertNodeMissing(path + "/foo");
-            assertNodeMissing(path + "/bar");
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-    private File assemblePackage(WorkspaceFilter filter)
-            throws IOException, RepositoryException {
-
-        File tmpFile = File.createTempFile("vaulttest", ".zip");
-
-        ExportOptions options = new ExportOptions();
-        DefaultMetaInf meta = new DefaultMetaInf();
-        meta.setFilter(filter);
-
-        Properties props = new Properties();
-        props.setProperty(VaultPackage.NAME_GROUP, "jackrabbit/test");
-        props.setProperty(VaultPackage.NAME_NAME, "quoted-pattern-export-package");
-        meta.setProperties(props);
-
-        options.setMetaInf(meta);
-
-        packMgr.assemble(admin, options, tmpFile).close();
-        return tmpFile;
-    }
-
-    private void setupContent(Session session)
-            throws RepositoryException {
-
-        Node root = session.getRootNode();
-        Node tmp = root.addNode("tmp", "nt:folder");
-        Node foo = tmp.addNode(NAME, "nt:folder");
-        Node bar = foo.addNode("bar", "nt:folder");
-        Node zoo = foo.addNode("zoo", "nt:folder");
-    }
-
-    public void assertNodeExists(String path) throws RepositoryException {
-        assertTrue(path + " should exist", admin.nodeExists(path));
-    }
-
-    public void assertNodeMissing(String path) throws RepositoryException {
-        assertFalse(path + " should not exist", admin.nodeExists(path));
-    }
-}
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ExternalTestHook1.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ExternalTestHook1.java
deleted file mode 100644
index 9ba1ab85..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ExternalTestHook1.java
+++ /dev/null
@@ -1,39 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.vault.packaging.InstallContext;
-import org.apache.jackrabbit.vault.packaging.InstallHook;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-
-/**
- * {@code ExternalTestHook} that is called by the external_hook package.
- */
-public class ExternalTestHook1 implements InstallHook {
-
-    public void execute(InstallContext context) throws PackageException {
-        try {
-            context.getSession().getNode("/testroot").setProperty("TestHook1", context.getPhase().toString());
-            context.getSession().save();
-        } catch (RepositoryException e) {
-            throw new PackageException(e);
-        }
-    }
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ExternalTestHook2.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ExternalTestHook2.java
deleted file mode 100644
index 3019438c..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ExternalTestHook2.java
+++ /dev/null
@@ -1,39 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.vault.packaging.InstallContext;
-import org.apache.jackrabbit.vault.packaging.InstallHook;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-
-/**
- * {@code ExternalTestHook} that is called by the external_hook package.
- */
-public class ExternalTestHook2 implements InstallHook {
-
-    public void execute(InstallContext context) throws PackageException {
-        try {
-            context.getSession().getNode("/testroot").setProperty("TestHook2", context.getPhase().toString());
-            context.getSession().save();
-        } catch (RepositoryException e) {
-            throw new PackageException(e);
-        }
-    }
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ExternalTestHookFailingInPhaseInstalled.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ExternalTestHookFailingInPhaseInstalled.java
deleted file mode 100644
index 314a745b..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ExternalTestHookFailingInPhaseInstalled.java
+++ /dev/null
@@ -1,35 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import org.apache.jackrabbit.vault.packaging.InstallContext;
-import org.apache.jackrabbit.vault.packaging.InstallContext.Phase;
-import org.apache.jackrabbit.vault.packaging.InstallHook;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-
-/**
- * Test hook which is used in an IT
- */
-public class ExternalTestHookFailingInPhaseInstalled implements InstallHook {
-
-    public void execute(InstallContext context) throws PackageException {
-        if (context.getPhase() == Phase.INSTALLED) {
-            throw new PackageException("Some explicitly triggered exception!");
-        }
-    }
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/FilteredPropertiesIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/FilteredPropertiesIT.java
deleted file mode 100644
index 23190b42..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/FilteredPropertiesIT.java
+++ /dev/null
@@ -1,569 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import static org.junit.Assert.assertNotNull;
-
-import java.io.ByteArrayInputStream;
-import java.io.File;
-import java.io.IOException;
-import java.nio.charset.StandardCharsets;
-import java.util.Properties;
-
-import javax.jcr.Node;
-import javax.jcr.Property;
-import javax.jcr.RepositoryException;
-import javax.jcr.Session;
-
-import org.apache.jackrabbit.vault.fs.api.PathFilterSet;
-import org.apache.jackrabbit.vault.fs.api.WorkspaceFilter;
-import org.apache.jackrabbit.vault.fs.config.ConfigurationException;
-import org.apache.jackrabbit.vault.fs.config.DefaultMetaInf;
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.apache.jackrabbit.vault.fs.filter.DefaultPathFilter;
-import org.apache.jackrabbit.vault.packaging.ExportOptions;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.VaultPackage;
-import org.apache.jackrabbit.vault.util.JcrConstants;
-import org.jetbrains.annotations.NotNull;
-import org.junit.Before;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.rules.TemporaryFolder;
-
-/**
- * Covers testing the filtering of properties both during export and import
- */
-public class FilteredPropertiesIT extends IntegrationTestBase {
-
-    @Rule
-    public TemporaryFolder folder= new TemporaryFolder();
-
-    @Before
-    public void setUp() throws Exception {
-        super.setUp();
-        setupTmpFooBarWithProperties(admin);
-        admin.save();
-    }
-
-    @Test
-    public void noPropertyFiltered_deprecated() throws IOException, RepositoryException, PackageException {
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/tmp"));
-        filter.addPropertyFilterSet(new PathFilterSet("/tmp"));
-        // export and extract
-        File pkgFile = assemblePackage(filter);
-        clean("/tmp");
-        try (VaultPackage vp = packMgr.open(pkgFile)) {
-            vp.extract(admin, getDefaultOptions());
-            // validate the extracted content
-            assertPropertiesExist("/tmp", "p1", "p2", "p3");
-            assertPropertiesExist("/tmp/foo", "p1", "p2", "p3");
-            assertPropertiesExist("/tmp/foo/bar", "p1", "p2", "p3");
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-    @Test
-    public void noPropertyFiltered() throws IOException, RepositoryException, PackageException {
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/tmp"));
-
-        // export and extract
-        File pkgFile = assemblePackage(filter);
-        clean("/tmp");
-        try (VaultPackage vp = packMgr.open(pkgFile)) {
-            vp.extract(admin, getDefaultOptions());
-            // validate the extracted content
-            assertPropertiesExist("/tmp", "p1", "p2", "p3");
-            assertPropertiesExist("/tmp/foo", "p1", "p2", "p3");
-            assertPropertiesExist("/tmp/foo/bar", "p1", "p2", "p3");
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-    @Test
-    public void filterPropertyP1OnFoo_deprecated() throws IOException, RepositoryException, PackageException, ConfigurationException {
-        PathFilterSet properties = new PathFilterSet("/tmp");
-        properties.addExclude(new DefaultPathFilter("/tmp/foo/p1"));
-
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/tmp"), properties);
-
-        // export and extract
-        File pkgFile = assemblePackage(filter);
-        clean("/tmp");
-        try (VaultPackage vp = packMgr.open(pkgFile)) {
-            vp.extract(admin, getDefaultOptions());
-            // validate the extracted content
-            assertPropertiesExist("/tmp", "p1", "p2", "p3");
-            assertPropertiesExist("/tmp/foo", "p2", "p3");
-            assertPropertiesMissg("/tmp/foo", "p1");
-            assertPropertiesExist("/tmp/foo/bar", "p1", "p2", "p3");
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-    @Test
-    public void filterPropertyP1OnFoo() throws IOException, RepositoryException, PackageException, ConfigurationException {
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/tmp"));
-
-        PathFilterSet properties = new PathFilterSet("/tmp");
-        properties.addExclude(new DefaultPathFilter("/tmp/foo/p1"));
-        filter.addPropertyFilterSet(properties);
-        // export and extract
-        File pkgFile = assemblePackage(filter);
-        clean("/tmp");
-        try (VaultPackage vp = packMgr.open(pkgFile)) {
-            vp.extract(admin, getDefaultOptions());
-            // validate the extracted content
-            assertPropertiesExist("/tmp", "p1", "p2", "p3");
-            assertPropertiesExist("/tmp/foo", "p2", "p3");
-            assertPropertiesMissg("/tmp/foo", "p1");
-            assertPropertiesExist("/tmp/foo/bar", "p1", "p2", "p3");
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-    @Test
-    public void filterPropertyPxOnFoo_deprecated() throws IOException, RepositoryException, PackageException, ConfigurationException {
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/tmp"));
-
-        PathFilterSet properties = new PathFilterSet("/tmp");
-        properties.addExclude(new DefaultPathFilter("/tmp/foo/p.*"));
-        filter.addPropertyFilterSet(properties);
-        // export and extract
-        File pkgFile = assemblePackage(filter);
-        clean("/tmp");
-        try (VaultPackage vp = packMgr.open(pkgFile)) {
-            vp.extract(admin, getDefaultOptions());
-            // validate the extracted content
-            assertPropertiesExist("/tmp", "p1", "p2", "p3");
-            assertPropertiesMissg("/tmp/foo", "p1", "p2", "p3");
-            assertPropertiesExist("/tmp/foo/bar", "p1", "p2", "p3");
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-    @Test
-    public void filterPropertyPxOnFoo() throws IOException, RepositoryException, PackageException, ConfigurationException {
-
-        PathFilterSet properties = new PathFilterSet("/tmp");
-        properties.addExclude(new DefaultPathFilter("/tmp/foo/p.*"));
-
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/tmp"), properties);
-
-        // export and extract
-        File pkgFile = assemblePackage(filter);
-        clean("/tmp");
-        try (VaultPackage vp = packMgr.open(pkgFile)) {
-            vp.extract(admin, getDefaultOptions());
-            // validate the extracted content
-            assertPropertiesExist("/tmp", "p1", "p2", "p3");
-            assertPropertiesMissg("/tmp/foo", "p1", "p2", "p3");
-            assertPropertiesExist("/tmp/foo/bar", "p1", "p2", "p3");
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-    @Test
-    public void filterPropertyWithTwoRoots() throws IOException, RepositoryException, PackageException, ConfigurationException {
-        PathFilterSet properties = new PathFilterSet("/tmp");
-        properties.addExclude(new DefaultPathFilter("/tmp/foo/p.*"));
-
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/foo"));
-        filter.add(new PathFilterSet("/tmp"), properties);
-
-        // export and extract
-        File pkgFile = assemblePackage(filter);
-        clean("/tmp");
-        try (VaultPackage vp = packMgr.open(pkgFile)) {
-            vp.extract(admin, getDefaultOptions());
-            // validate the extracted content
-            assertPropertiesExist("/tmp", "p1", "p2", "p3");
-            assertPropertiesMissg("/tmp/foo", "p1", "p2", "p3");
-            assertPropertiesExist("/tmp/foo/bar", "p1", "p2", "p3");
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-    @Test
-    public void filterPropertyWithTwoRoots_deprecated() throws IOException, RepositoryException, PackageException, ConfigurationException {
-
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/foo"));
-        filter.addPropertyFilterSet(new PathFilterSet("/foo"));
-        filter.add(new PathFilterSet("/tmp"));
-
-        PathFilterSet properties = new PathFilterSet("/tmp");
-        properties.addExclude(new DefaultPathFilter("/tmp/foo/p.*"));
-        filter.addPropertyFilterSet(properties);
-
-        // export and extract
-        File pkgFile = assemblePackage(filter);
-        clean("/tmp");
-        try (VaultPackage vp = packMgr.open(pkgFile)) {
-            vp.extract(admin, getDefaultOptions());
-            // validate the extracted content
-            assertPropertiesExist("/tmp", "p1", "p2", "p3");
-            assertPropertiesMissg("/tmp/foo", "p1", "p2", "p3");
-            assertPropertiesExist("/tmp/foo/bar", "p1", "p2", "p3");
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-    @Test
-    public void filterPropertyFromSource() throws IOException, RepositoryException, PackageException, ConfigurationException {
-        String src = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
-                "<workspaceFilter version=\"1.0\">\n" +
-                "    <filter root=\"/foo\"/>\n" +
-                "    <filter root=\"/tmp\">\n" +
-                "        <exclude pattern=\"/tmp/foo/p.*\" matchProperties=\"true\"/>\n" +
-                "    </filter>\n" +
-                "</workspaceFilter>";
-
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.load(new ByteArrayInputStream(src.getBytes("utf-8")));
-
-        // export and extract
-        File pkgFile = assemblePackage(filter);
-        clean("/tmp");
-        try (VaultPackage vp = packMgr.open(pkgFile)) {
-            vp.extract(admin, getDefaultOptions());
-            // validate the extracted content
-            assertPropertiesExist("/tmp", "p1", "p2", "p3");
-            assertPropertiesMissg("/tmp/foo", "p1", "p2", "p3");
-            assertPropertiesExist("/tmp/foo/bar", "p1", "p2", "p3");
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-    @Test
-    public void filterPropertyFromSourceWithRelativePropertyFilter() throws IOException, RepositoryException, PackageException, ConfigurationException {
-        String src = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
-                "<workspaceFilter version=\"1.0\">\n" +
-                "    <filter root=\"/tmp/foo\">\n" +
-                "        <exclude pattern=\".*/p1\" matchProperties=\"true\"/>\n" +
-                "    </filter>\n" +
-                "</workspaceFilter>";
-
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.load(new ByteArrayInputStream(src.getBytes("utf-8")));
-
-        // export and extract
-        File pkgFile = assemblePackage(filter);
-        // do not clean but modify a property
-        admin.getNode("/tmp/foo").setProperty("p1", "newv1");
-        assertProperty("/tmp/foo/p1", "newv1");
-        admin.save();
-        try (VaultPackage vp = packMgr.open(pkgFile)) {
-            vp.extract(admin, getDefaultOptions());
-            // validate the extracted content has not overwritten p1
-            assertProperty("/tmp/foo/p1", "newv1");
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-    @Test
-    public void filterRelativeProperties_deprecated() throws IOException, RepositoryException, PackageException, ConfigurationException {
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/tmp"));
-
-        PathFilterSet properties = new PathFilterSet("/tmp");
-        properties.addExclude(new DefaultPathFilter(".*/p1"));
-        filter.addPropertyFilterSet(properties);
-        // export and extract
-        File pkgFile = assemblePackage(filter);
-        clean("/tmp");
-        try (VaultPackage vp = packMgr.open(pkgFile)) {
-            vp.extract(admin, getDefaultOptions());
-            // validate the extracted content
-            assertPropertiesExist("/tmp", "p2", "p3");
-            assertPropertiesMissg("/tmp", "p1");
-            assertPropertiesExist("/tmp/foo", "p2", "p3");
-            assertPropertiesMissg("/tmp/foo", "p1");
-            assertPropertiesExist("/tmp/foo/bar", "p2", "p3");
-            assertPropertiesMissg("/tmp/foo/bar", "p1");
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-    @Test
-    public void filterRelativeProperties() throws IOException, RepositoryException, PackageException, ConfigurationException {
-        PathFilterSet properties = new PathFilterSet("/tmp");
-        properties.addExclude(new DefaultPathFilter(".*/p1"));
-
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/tmp"), properties);
-
-        // export and extract
-        File pkgFile = assemblePackage(filter);
-        clean("/tmp");
-        try (VaultPackage vp = packMgr.open(pkgFile)) {
-            vp.extract(admin, getDefaultOptions());
-            // validate the extracted content
-            assertPropertiesExist("/tmp", "p2", "p3");
-            assertPropertiesMissg("/tmp", "p1");
-            assertPropertiesExist("/tmp/foo", "p2", "p3");
-            assertPropertiesMissg("/tmp/foo", "p1");
-            assertPropertiesExist("/tmp/foo/bar", "p2", "p3");
-            assertPropertiesMissg("/tmp/foo/bar", "p1");
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-    @Test
-    public void filterRelativePropertiesDeepNoPropertyFilter() throws IOException, RepositoryException, PackageException {
-        PathFilterSet props = new PathFilterSet("/tmp");
-        PathFilterSet nodes = new PathFilterSet("/tmp");
-
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(nodes, props);
-
-        File pkgFile = assemblePackage(filter);
-        clean("/tmp");
-        try (VaultPackage vp = packMgr.open(pkgFile)) {
-            vp.extract(admin, getDefaultOptions());
-            // validate the extracted content
-            assertPropertiesExist("/tmp", "p1", "p2", "p3");
-            assertPropertiesExist("/tmp/foo", "p1", "p2", "p3");
-            assertPropertiesExist("/tmp/foo/bar", "p1", "p2", "p3");
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-    @Test
-    public void filterRelativePropertiesShallowNoPropertyFilter() throws IOException, RepositoryException, PackageException, ConfigurationException {
-        PathFilterSet nodes = new PathFilterSet("/tmp");
-        nodes.addInclude(new DefaultPathFilter("/tmp"));
-
-        PathFilterSet props = new PathFilterSet("/tmp");
-
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(nodes, props);
-        File pkgFile = assemblePackage(filter);
-        clean("/tmp");
-        try (VaultPackage vp = packMgr.open(pkgFile)) {
-            vp.extract(admin, getDefaultOptions());
-            // validate the extracted content
-            assertPropertiesExist("/tmp", "p1", "p2", "p3");
-            assertNodeMissing("/tmp/foo");
-            assertNodeMissing("/tmp/foo/bar");
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-    @Test
-    public void filterRelativePropertiesShallowWithPropertyFilter() throws IOException, RepositoryException, PackageException, ConfigurationException {
-        PathFilterSet props = new PathFilterSet("/tmp");
-        props.addExclude(new DefaultPathFilter(".*/p1"));
-
-        PathFilterSet nodes = new PathFilterSet("/tmp");
-        nodes.addInclude(new DefaultPathFilter("/tmp"));
-
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(nodes, props);
-        File pkgFile = assemblePackage(filter);
-        clean("/tmp");
-        try (VaultPackage vp = packMgr.open(pkgFile)) {
-            vp.extract(admin, getDefaultOptions());
-            // validate the extracted content
-            assertPropertiesExist("/tmp", "p2", "p3");
-            assertPropertiesMissg("/tmp", "p1");
-            assertNodeMissing("/tmp/foo");
-            assertNodeMissing("/tmp/foo/bar");
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-    @Test
-    public void filterRelativePropertiesSingleSet_NotDeep_no_propertyFilter_addNodes() throws IOException, RepositoryException, PackageException, ConfigurationException {
-        PathFilterSet nodes = new PathFilterSet("/tmp");
-
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        nodes.addInclude(new DefaultPathFilter("/tmp"));
-
-        filter.add(nodes);
-
-        // export and extract
-        File pkgFile = assemblePackage(filter);
-        clean("/tmp");
-        try (VaultPackage vp = packMgr.open(pkgFile)) {
-            vp.extract(admin, getDefaultOptions());
-            // validate the extracted content
-            assertPropertiesExist("/tmp", "p1", "p2", "p3");
-            assertNodeMissing("/tmp/foo");
-            assertNodeMissing("/tmp/foo/bar");
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-    @Test
-    public void filterRelativePropertiesSingleSet_NotDeep_with_xml() throws IOException, RepositoryException, PackageException, ConfigurationException {
-        String src = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
-                "<workspaceFilter version=\"1.0\">\n" +
-                "    <filter root=\"/tmp\">\n" +
-                "        <include pattern=\"/tmp\"/>\n" +
-                "    </filter>\n" +
-                "</workspaceFilter>\n";
-
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.load(new ByteArrayInputStream(src.getBytes("utf-8")));
-
-        // export and extract
-        File pkgFile = assemblePackage(filter);
-        clean("/tmp");
-        try (VaultPackage vp = packMgr.open(pkgFile)) {
-            vp.extract(admin, getDefaultOptions());
-            // validate the extracted content
-            assertPropertiesExist("/tmp", "p1", "p2", "p3");
-            assertNodeMissing("/tmp/foo");
-            assertNodeMissing("/tmp/foo/bar");
-        } finally {
-            pkgFile.delete();
-        }
-    }
-
-    @Test
-    public void importWithExcludedPropertiesContainedInSerializationNew() throws IOException, PackageException, RepositoryException, ConfigurationException {
-        clean("/testroot2");
-        clean("/testroot3");
-        
-        // the package itself contains more properties than are supposed to be installed during import
-        String filterSrc = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
-                "<workspaceFilter version=\"1.0\">\n" +
-                "    <filter root=\"/testroot3\">\n" +
-                "        <exclude pattern=\"/testroot3/jcr:mixinTypes\" matchProperties=\"true\"/>\n" +
-                "        <exclude pattern=\"/testroot3/jcr:lastModified.*\" matchProperties=\"true\"/>\n" +
-                "        <exclude pattern=\"/testroot3/jcr:title\" matchProperties=\"true\"/>\n" +
-                "        <exclude pattern=\"/testroot3/someUnprotectedStringProperty\" matchProperties=\"true\"/>\n" +
-                "    </filter>\n" +
-                "</workspaceFilter>";
-
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.load(new ByteArrayInputStream(filterSrc.getBytes(StandardCharsets.UTF_8)));
-        File tmpFile = folder.newFile();
-        try (VaultPackage pkg = loadVaultPackage("/test-packages/protected_properties.zip")) {
-            try (VaultPackage pkgWithAdjustedFilter = packMgr.rewrap(createExportOptions(filter), pkg, tmpFile)) {
-                try (JcrPackage uploadedPackage = packMgr.upload(tmpFile, false, true, null)) {
-                    assertNotNull(uploadedPackage);
-                    uploadedPackage.install(getDefaultOptions());
-                    admin.save();
-                    assertProperty("/testroot3/someUnprotectedStringProperty2", "foo");
-                    assertPropertyMissing("/testroot3/jcr:mixinTypes");
-                    assertPropertyMissing("/testroot3/someUnprotectedStringProperty");
-                    assertPropertyMissing("/testroot3/jcr:title");
-                    // some protected properties are never imported, independent of their excludes
-                    // assertProperty("/testroot3/someProtectedBooleanProperty");
-
-                    // now test update on existing node
-                    Node node = admin.getNode("/testroot3");
-                    // modify some properties
-                    node.addMixin(JcrConstants.MIX_LAST_MODIFIED);
-                    node.setProperty(JcrConstants.JCR_TITLE, "title");
-                    admin.save();
-                    // install again
-                    uploadedPackage.install(getDefaultOptions());
-                    // make sure excluded properties are not extended or overwritten
-                    assertProperty("/testroot3/jcr:mixinTypes", new String[] { JcrConstants.MIX_LAST_MODIFIED } );
-                    assertProperty("/testroot3/jcr:title", "title");
-                }
-            }
-        }
-    }
-
-    
-    /**
-     * Setup the path /tmp/foo/bar with properties set at each level
-     */
-    private void setupTmpFooBarWithProperties(Session session)
-            throws RepositoryException {
-        Node root = session.getRootNode();
-        Node tmp = setupProperties(root.addNode("tmp"));
-        Node foo = setupProperties(tmp.addNode("foo"));
-        setupProperties(foo.addNode("bar"));
-    }
-
-    private Node setupProperties(Node node)
-            throws RepositoryException {
-        node.setProperty("p1", "v1");
-        node.setProperty("p2", "v2");
-        node.setProperty("p3", "v3");
-        return node;
-    }
-
-    private File assemblePackage(WorkspaceFilter filter)
-            throws IOException, RepositoryException {
-
-        File tmpFile = File.createTempFile("vaulttest", ".zip");
-        packMgr.assemble(admin, createExportOptions(filter), tmpFile).close();
-        return tmpFile;
-    }
-
-    private static @NotNull ExportOptions createExportOptions(WorkspaceFilter filter) {
-        ExportOptions options = new ExportOptions();
-        DefaultMetaInf meta = new DefaultMetaInf();
-        meta.setFilter(filter);
-
-        Properties props = new Properties();
-        props.setProperty(VaultPackage.NAME_GROUP, "jackrabbit/test");
-        props.setProperty(VaultPackage.NAME_NAME, "filtered-export-package");
-        meta.setProperties(props);
-
-        options.setMetaInf(meta);
-        return options;
-    }
-
-    private void assertPropertiesExist(String rootPath, String... propNames)
-            throws RepositoryException {
-        for (String propName : propNames) {
-            String propPath = String.format("%s/%s", rootPath, propName);
-            assertPropertyExists(propPath);
-        }
-    }
-
-    private void assertPropertiesMissg(String rootPath, String... propNames)
-            throws RepositoryException {
-        for (String propName : propNames) {
-            String propPath = String.format("%s/%s", rootPath, propName);
-            assertPropertyMissing(propPath);
-        }
-    }
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/FolderArtifactHandlerIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/FolderArtifactHandlerIT.java
deleted file mode 100644
index be167c73..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/FolderArtifactHandlerIT.java
+++ /dev/null
@@ -1,135 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import static org.junit.Assert.assertEquals;
-
-import java.io.IOException;
-import java.io.InputStreamReader;
-import java.io.Reader;
-import java.nio.charset.StandardCharsets;
-
-import javax.jcr.Node;
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.commons.cnd.CndImporter;
-import org.apache.jackrabbit.commons.cnd.ParseException;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.VaultPackage;
-import org.junit.Test;
-
-public class FolderArtifactHandlerIT extends IntegrationTestBase {
-
-    /* JCRVLT-415 */
-    @Test
-    public void testModifyingContainedNodeNonNtFolderPrimaryType() throws RepositoryException, IOException, PackageException {
-        // create node "/testroot/foo" with node type "nt:unstructured"
-        Node rootNode = admin.getRootNode();
-        Node testNode = rootNode.addNode("testroot", "nt:unstructured");
-        Node fooNode = testNode.addNode("foo", "nt:unstructured");
-        fooNode.setProperty("testProperty", "test");
-        admin.save();
-        try (VaultPackage vltPackage = extractVaultPackageStrict("/test-packages/folder-without-docview-element.zip")) {
-            // make sure the primary type from "/test/foo" got overwritten!
-            assertPropertyMissing("/testroot/foo/testProperty");
-            assertNodeHasPrimaryType("/testroot/foo", "nt:folder");
-        }
-    }
-
-    @Test
-    public void testNotModifyingContainedNodeNtFolderPrimaryType() throws RepositoryException, IOException, PackageException {
-        // create node "/testroot/foo" with node type "nt:unstructured"
-        Node rootNode = admin.getRootNode();
-        Node testNode = rootNode.addNode("testroot", "nt:unstructured");
-        Node fooNode = testNode.addNode("foo", "nt:folder");
-        String oldId = fooNode.getIdentifier();
-        admin.save();
-        try (VaultPackage vltPackage = extractVaultPackageStrict("/test-packages/folder-without-docview-element.zip")) {
-            assertNodeHasPrimaryType("/testroot/foo", "nt:folder");
-            assertPropertyMissing("/testroot/value");
-            assertEquals(oldId, admin.getNode("/testroot/foo").getIdentifier());
-        }
-    }
-
-    @Test
-    public void testNotModifyingIntermediateNodePrimaryType() throws RepositoryException, IOException, PackageException {
-        // create node "/var/foo" with node type "nt:unstructured"
-        Node rootNode = admin.getRootNode();
-        Node testNode = rootNode.addNode("var", "nt:unstructured");
-        Node fooNode = testNode.addNode("foo", "nt:unstructured");
-        assertNodeHasPrimaryType("/var/foo", "nt:unstructured");
-        fooNode.setProperty("testProperty", "test");
-        admin.save();
-        try (VaultPackage vltPackage = extractVaultPackageStrict("/test-packages/folder-without-docview-element.zip")) {
-            assertNodeHasPrimaryType("/var/foo", "nt:unstructured");
-            assertProperty("/var/foo/testProperty", "test");
-        }
-    }
-
-    @Test
-    public void testCreatingIntermediateNodesWithDefaultType() throws RepositoryException, IOException, PackageException {
-        // create node "/var/foo" with node type "nt:unstructured"
-        Node rootNode = admin.getRootNode();
-        rootNode.addNode("var", "nt:unstructured");
-        admin.save();
-        try (VaultPackage vltPackage = extractVaultPackageStrict("/test-packages/folder-without-docview-element.zip")) {
-            assertNodeHasPrimaryType("/var/foo", "nt:unstructured");
-        }
-    }
-
-    @Test
-    public void testCreatingIntermediateNodesWithFallbackType() throws RepositoryException, IOException, PackageException {
-        // create node "/var/foo" with node type "nt:unstructured"
-        Node rootNode = admin.getRootNode();
-        rootNode.addNode("var", "nt:folder");
-        admin.save();
-        assertNodeHasPrimaryType("/var", "nt:folder");
-        try (VaultPackage vltPackage = extractVaultPackage("/test-packages/folder-without-docview-element.zip")) {
-            assertNodeHasPrimaryType("/var", "nt:folder");
-            assertNodeHasPrimaryType("/var/foo", "nt:folder");
-        }
-    }
-
-    // https://issues.apache.org/jira/browse/JCRVLT-542
-    @Test
-    public void testRootTypeOnMerge() throws RepositoryException, IOException, PackageException {
-        Node rootNode = admin.getRootNode();
-        Node homeNode = rootNode.getNode("home");
-        homeNode.addNode("groups", "rep:AuthorizableFolder");
-        admin.save();
-        assertNodeHasPrimaryType("/home", "rep:AuthorizableFolder");
-        assertNodeHasPrimaryType("/home/groups", "rep:AuthorizableFolder");
-        // /home/groups is being installed w/o any nodetype but filter is on mode=merge so no change expected
-        try (VaultPackage vltPackage = extractVaultPackage("/test-packages/test_nodetype_on_merge.zip")) {
-            assertNodeHasPrimaryType("/home", "rep:AuthorizableFolder");
-            assertNodeHasPrimaryType("/home/groups", "rep:AuthorizableFolder");
-        }
-    }
-
-    // https://issues.apache.org/jira/browse/JCRVLT-544
-    @Test
-    public void testFallbackToNtFolderForRestrictedDefaultNodeType() throws IOException, PackageException, RepositoryException, ParseException {
-        try (Reader reader = new InputStreamReader(getStream("cqComponent.cnd"), StandardCharsets.US_ASCII)) {
-            CndImporter.registerNodeTypes(reader, admin);
-        }
-        admin.getRootNode().addNode("testroot", "cq:Component"); // this has nt:base as default child node type
-        try (VaultPackage vltPackage = extractVaultPackage("/test-packages/intermediate_folders.zip")) {
-            assertNodeHasPrimaryType("/testroot/myfolder", "nt:folder");
-        }
-    }
-}
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/GroupMergePackageIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/GroupMergePackageIT.java
deleted file mode 100644
index 69d43a11..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/GroupMergePackageIT.java
+++ /dev/null
@@ -1,199 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.IOException;
-
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.api.JackrabbitSession;
-import org.apache.jackrabbit.api.security.user.Group;
-import org.apache.jackrabbit.api.security.user.User;
-import org.apache.jackrabbit.api.security.user.UserManager;
-import org.apache.jackrabbit.vault.fs.api.ImportMode;
-import org.apache.jackrabbit.vault.fs.api.PathFilterSet;
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.junit.Test;
-
-import static junit.framework.Assert.assertFalse;
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.assertNull;
-import static org.junit.Assert.assertTrue;
-
-public class GroupMergePackageIT extends IntegrationTestBase {
-
-    @Override
-    public void tearDown() throws Exception {
-        // remove test authorizables
-        UserManager mgr = ((JackrabbitSession) admin).getUserManager();
-        removeAuthorizable(mgr, "test-group");
-        removeAuthorizable(mgr, "test-user-a");
-        removeAuthorizable(mgr, "test-user-b");
-        removeAuthorizable(mgr, "test-user-c");
-        admin.save();
-        super.tearDown();
-    }
-
-    /**
-     * Installs a package that contains a "test-group" and a "test-user-a" as member of the group.
-     */
-    @Test
-    public void installGroupA() throws RepositoryException, IOException, PackageException {
-        UserManager mgr = ((JackrabbitSession) admin).getUserManager();
-        assertNull("test-group must not exist", mgr.getAuthorizable("test-group"));
-        assertNull("test-user-a must not exist", mgr.getAuthorizable("test-user-a"));
-
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/group_with_a.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        // check if group exists
-        Group grp = (Group) mgr.getAuthorizable("test-group");
-        assertNotNull("test-group must exist", grp);
-        User userA = (User) mgr.getAuthorizable("test-user-a");
-        assertNotNull("test-user-a must exist", userA);
-        assertTrue("test-user-a is member of test-group", grp.isMember(userA));
-    }
-
-    /**
-     * Installs 2 packages with "test-group" that contain test-user-a and test-user-b,test-user-c respectively.
-     * since the import mode is merge, the memberships should be merged.
-     */
-    @Test
-    public void installGroupABC() throws RepositoryException, IOException, PackageException {
-        // ensure that test users don't exist yet (proper setup)
-        UserManager mgr = ((JackrabbitSession) admin).getUserManager();
-        assertNull("test-group must not exist", mgr.getAuthorizable("test-group"));
-        assertNull("test-user-a must not exist", mgr.getAuthorizable("test-user-a"));
-        assertNull("test-user-b must not exist", mgr.getAuthorizable("test-user-b"));
-        assertNull("test-user-c must not exist", mgr.getAuthorizable("test-user-c"));
-
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/group_with_a.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        pack = packMgr.upload(getStream("/test-packages/group_with_bc.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-        assertABC(mgr);
-    }
-
-    /**
-     * Installs 2 packages with "test-group" that contain test-user-a and test-user-b,test-user-c respectively.
-     * since the import mode is merge, the memberships should be merged. this variant uses a renamed authorizable node name
-     */
-    @Test
-    public void installGroupABC_renamed() throws RepositoryException, IOException, PackageException {
-        // ensure that test users don't exist yet (proper setup)
-        UserManager mgr = ((JackrabbitSession) admin).getUserManager();
-        assertNull("test-group must not exist", mgr.getAuthorizable("test-group"));
-        assertNull("test-user-a must not exist", mgr.getAuthorizable("test-user-a"));
-        assertNull("test-user-b must not exist", mgr.getAuthorizable("test-user-b"));
-        assertNull("test-user-c must not exist", mgr.getAuthorizable("test-user-c"));
-
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/group_with_bc.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        pack = packMgr.upload(getStream("/test-packages/group_with_a_moved.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-        assertABC(mgr);
-    }
-
-
-    private void assertABC(UserManager mgr) throws RepositoryException {
-        // check if group exists
-        Group grp = (Group) mgr.getAuthorizable("test-group");
-        assertNotNull("test-group must exist", grp);
-        User userA = (User) mgr.getAuthorizable("test-user-a");
-        User userB = (User) mgr.getAuthorizable("test-user-b");
-        User userC = (User) mgr.getAuthorizable("test-user-c");
-        assertNotNull("test-user-a must exist", userA);
-        assertNotNull("test-user-b must exist", userB);
-        assertNotNull("test-user-c must exist", userC);
-
-        assertTrue("test-user-a is member of test-group", grp.isMember(userA));
-        assertTrue("test-user-b is member of test-group", grp.isMember(userB));
-        assertTrue("test-user-c is member of test-group", grp.isMember(userC));
-    }
-
-
-    /**
-     * Installs a package that contains a "test-group" and a "test-user-a" as member of the group.
-     */
-    @Test
-    public void installGroup101() throws RepositoryException, IOException, PackageException {
-        UserManager mgr = ((JackrabbitSession) admin).getUserManager();
-        assertNull("test-group must not exist", mgr.getAuthorizable("test-group"));
-
-        // check if group exists
-        Group grp = mgr.createGroup("test-group");
-
-        User firstUser = mgr.createUser("test-user-0", "123");
-        grp.addMember(firstUser);
-
-        for (int i=1; i<100; i++) {
-            User user = mgr.createUser("test-user-"+i, "123");
-            grp.addMember(user);
-        }
-
-        User lastUser = mgr.createUser("test-user-101", "123");
-        grp.addMember(lastUser);
-
-        User user1 = (User) mgr.getAuthorizable("test-user-1");
-
-        grp.removeMember(firstUser);
-
-        admin.save();
-
-        assertFalse("test-user-0 is not member of test-group", grp.isMember(firstUser));
-        assertTrue("test-user-1 is member of test-group", grp.isMember(user1));
-        assertTrue("test-user-101 is member of test-group", grp.isMember(lastUser));
-
-        JcrPackage pack = packMgr.create("foo", "test-101-users");
-
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet(grp.getPath()));
-        pack.getDefinition().setFilter(filter, true);
-
-        packMgr.assemble(pack, null);
-
-        grp.remove();
-
-        admin.save();
-
-        assertNull("test-group must not exist", mgr.getAuthorizable("test-group"));
-
-        ImportOptions options = new ImportOptions();
-        options.setImportMode(ImportMode.UPDATE);
-        pack.install(options);
-
-        assertNotNull("test-group must exist", mgr.getAuthorizable("test-group"));
-
-        grp = (Group) mgr.getAuthorizable("test-group");
-
-        assertFalse("test-user-0 is not member of test-group", grp.isMember(firstUser));
-        assertTrue("test-user-1 is member of test-group", grp.isMember(user1));
-        assertTrue("test-user-101 is member of test-group", grp.isMember(lastUser));
-
-    }
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ImportIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ImportIT.java
deleted file mode 100644
index 3ca7b36b..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ImportIT.java
+++ /dev/null
@@ -1,446 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertFalse;
-
-import java.io.IOException;
-import java.security.Principal;
-
-import javax.jcr.AccessDeniedException;
-import javax.jcr.InvalidItemStateException;
-import javax.jcr.ItemExistsException;
-import javax.jcr.Node;
-import javax.jcr.ReferentialIntegrityException;
-import javax.jcr.Repository;
-import javax.jcr.RepositoryException;
-import javax.jcr.Session;
-import javax.jcr.SimpleCredentials;
-import javax.jcr.lock.LockException;
-import javax.jcr.nodetype.ConstraintViolationException;
-import javax.jcr.nodetype.NoSuchNodeTypeException;
-import javax.jcr.nodetype.NodeType;
-import javax.jcr.version.VersionException;
-
-import org.apache.commons.lang3.exception.ExceptionUtils;
-import org.apache.jackrabbit.api.JackrabbitSession;
-import org.apache.jackrabbit.api.security.user.User;
-import org.apache.jackrabbit.api.security.user.UserManager;
-import org.apache.jackrabbit.commons.jackrabbit.authorization.AccessControlUtils;
-import org.apache.jackrabbit.vault.fs.api.PathFilterSet;
-import org.apache.jackrabbit.vault.fs.api.WorkspaceFilter;
-import org.apache.jackrabbit.vault.fs.config.ConfigurationException;
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.apache.jackrabbit.vault.fs.io.Archive;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.fs.io.Importer;
-import org.apache.jackrabbit.vault.fs.io.JcrArchive;
-import org.apache.jackrabbit.vault.fs.io.ZipArchive;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.util.JcrConstants;
-import org.junit.Assert;
-import org.junit.Assume;
-import org.junit.Before;
-import org.junit.Test;
-
-/**
- * {@code ImportTests}...
- */
-public class ImportIT extends IntegrationTestBase {
-
-    public static final String TEST_ROOT = "/testroot";
-
-    public static final String ARCHIVE_ROOT = "/archiveroot";
-
-    @Before
-    public void init() {
-        clean(TEST_ROOT);
-        clean(ARCHIVE_ROOT);
-    }
-
-    @Test
-    public void testImport() throws IOException, RepositoryException, ConfigurationException {
-        try (Archive archive = getFileArchive("/test-packages/tmp.zip")) {
-            archive.open(true);
-            Node rootNode = admin.getRootNode();
-            ImportOptions opts = getDefaultOptions();
-            Importer importer = new Importer(opts);
-            importer.run(archive, rootNode);
-
-            assertNodeExists("/tmp/foo/bar/tobi");
-        }
-    }
-
-    @Test
-    public void testReimportLess() throws IOException, RepositoryException, ConfigurationException {
-        Node rootNode = admin.getRootNode();
-        ImportOptions opts = getDefaultOptions();
-        Importer importer = new Importer(opts);
-        try (Archive archive = getFileArchive("/test-packages/tmp.zip")) {
-            archive.open(true);
-            importer.run(archive, rootNode);
-
-            assertNodeExists("/tmp/foo/bar/tobi");
-        }
-        
-        try (Archive archive = getFileArchive("/test-packages/tmp_less.zip")) {
-            archive.open(true);
-            importer.run(archive, rootNode);
-
-            assertNodeMissing("/tmp/foo/bar/tobi");
-        }
-    }
-
-    @Test
-    public void testFilteredImport() throws IOException, RepositoryException, ConfigurationException {
-        try (Archive archive = getFileArchive("/test-packages/filtered_package.zip")) {
-            archive.open(true);
-            Node rootNode = admin.getRootNode();
-            ImportOptions opts = getDefaultOptions();
-
-            Importer importer = new Importer(opts);
-            importer.run(archive, rootNode);
-
-            assertNodeExists("/tmp");
-            assertNodeExists("/tmp/foo");
-            assertNodeExists("/tmp/foo/bar");
-            assertNodeExists("/tmp/foo/bar/tobi");
-            assertNodeMissing("/tmp/foo/bar/tom");
-        }
-    }
-
-    @Test
-    public void testUnFilteredImport() throws IOException, RepositoryException, ConfigurationException {
-        try (Archive archive = getFileArchive("/test-packages/unfiltered_package.zip")) {
-            archive.open(true);
-            Node rootNode = admin.getRootNode();
-            ImportOptions opts = getDefaultOptions();
-
-            Importer importer = new Importer(opts);
-            importer.run(archive, rootNode);
-
-            assertNodeExists("/tmp");
-            assertNodeExists("/tmp/foo");
-            assertNodeExists("/tmp/foo/bar");
-            assertNodeExists("/tmp/foo/bar/tobi");
-            assertNodeExists("/tmp/foo/bar/tom");
-        }
-    }
-
-    @Test
-    public void testRelativeImport() throws IOException, RepositoryException, ConfigurationException {
-        try (Archive archive = getFileArchive("/test-packages/tmp.zip")) {
-            admin.getRootNode().addNode(TEST_ROOT.substring(1, TEST_ROOT.length()));
-            admin.save();
-
-            archive.open(true);
-            Node rootNode = admin.getNode(TEST_ROOT);
-            ImportOptions opts = getDefaultOptions();
-            // manually creating filterPaths with correct coverage
-            WorkspaceFilter filter = archive.getMetaInf().getFilter();
-            for (PathFilterSet pathFilterSet : filter.getFilterSets()) {
-                pathFilterSet.setRoot(TEST_ROOT + pathFilterSet.getRoot());
-            }
-            opts.setFilter(filter);
-            Importer importer = new Importer(opts);
-            importer.run(archive, rootNode);
-
-            assertNodeExists(TEST_ROOT + "/tmp/foo/bar/tobi");
-        }
-    }
-
-    /**
-     * Imports an empty package with a filter "/testnode" relative to "/testnode". Since this is a relative import,
-     * the "/testnode" would map to "/testnode/testnode". So the import should not remove "/testnode".
-     */
-    @Test
-    public void testRelativeEmptyImport() throws IOException, RepositoryException, ConfigurationException {
-        try (Archive archive = getFileArchive("/test-packages/empty_testnode.zip")) {
-            admin.getRootNode().addNode(TEST_ROOT.substring(1, TEST_ROOT.length()));
-            admin.save();
-
-            archive.open(true);
-            Node rootNode = admin.getNode(TEST_ROOT);
-            ImportOptions opts = getDefaultOptions();
-            Importer importer = new Importer(opts);
-            importer.run(archive, rootNode);
-
-            assertNodeExists(TEST_ROOT);
-        }
-    }
-
-    /**
-     * Creates an jcr archive at /archiveroot mapped to /testroot and imports it.
-     */
-    @Test
-    public void testJcrArchiveImport() throws IOException, RepositoryException, ConfigurationException {
-        // create Jcr Archive
-        Node archiveNode = admin.getRootNode().addNode(ARCHIVE_ROOT.substring(1, ARCHIVE_ROOT.length()));
-        admin.save();
-        createNodes(archiveNode, 2, 4);
-        admin.save();
-        assertNodeExists(ARCHIVE_ROOT + "/n3/n3/n3");
-        try (JcrArchive archive = new JcrArchive(archiveNode, TEST_ROOT)) {
-            Node testRoot = admin.getRootNode().addNode(TEST_ROOT.substring(1, TEST_ROOT.length()));
-            testRoot.addNode("dummy", "nt:folder");
-            admin.save();
-
-            archive.open(true);
-            Node rootNode = admin.getNode(TEST_ROOT);
-            ImportOptions opts = getDefaultOptions();
-            //opts.setListener(new DefaultProgressListener());
-            Importer importer = new Importer(opts);
-            importer.run(archive, rootNode);
-            admin.save();
-
-            assertNodeExists(TEST_ROOT + "/n3/n3/n3");
-            assertNodeMissing(TEST_ROOT + "dummy");
-        }
-    }
-
-    @Test
-    public void testConcurrentModificationHandling() throws IOException, RepositoryException, PackageException, ConfigurationException {
-        try (Archive archive = getFileArchive("/test-packages/tags.zip")) {
-            archive.open(true);
-            Node rootNode = admin.getRootNode();
-            ImportOptions opts = getDefaultOptions();
-            opts.setAutoSaveThreshold(7);
-            Importer importer = new Importer(opts);
-            importer.setDebugFailAfterSave(2);
-            importer.run(archive, rootNode);
-            admin.save();
-
-            // count nodes
-            assertNodeExists("/etc/tags");
-            Node tags = admin.getNode("/etc/tags");
-            int numNodes = countNodes(tags);
-            assertEquals("Number of tags installed", 487, numNodes);
-        }
-    }
-
-    @Test
-    public void testSNSImport() throws IOException, RepositoryException, ConfigurationException {
-        try (Archive archive = getFileArchive("/test-packages/test_sns.zip")) {
-            archive.open(true);
-            Node rootNode = admin.getRootNode();
-            ImportOptions opts = getDefaultOptions();
-            Importer importer = new Importer(opts);
-            importer.run(archive, rootNode);
-
-            assertNodeExists("/tmp/testroot");
-            assertNodeExists("/tmp/testroot/foo");
-            assertProperty("/tmp/testroot/foo/name", "foo1");
-
-            // only check for SNS nodes if SNS supported
-            if (admin.getRepository().getDescriptorValue(Repository.NODE_TYPE_MANAGEMENT_SAME_NAME_SIBLINGS_SUPPORTED).getBoolean()) {
-                assertNodeExists("/tmp/testroot/foo[2]");
-                assertNodeExists("/tmp/testroot/foo[3]");
-                assertProperty("/tmp/testroot/foo[2]/name", "foo2");
-                assertProperty("/tmp/testroot/foo[3]/name", "foo3");
-            } else {
-                // otherwise nodes must not exist
-                assertNodeMissing("/tmp/testroot/foo[2]");
-                assertNodeMissing("/tmp/testroot/foo[3]");
-            }
-        }
-    }
-
-
-    @Test
-    public void testSubArchiveExtract() throws IOException, RepositoryException, ConfigurationException {
-        try (Archive archive = getFileArchive("/test-packages/tmp_with_thumbnail.zip")) {
-            archive.open(true);
-            Node rootNode = admin.getRootNode();
-            Node tmpNode = rootNode.addNode("tmp");
-            Node fileNode = tmpNode.addNode("package.zip", "nt:file");
-            Node contentNode = fileNode.addNode("jcr:content", "nt:resource");
-            contentNode.setProperty("jcr:data", "");
-            contentNode.setProperty("jcr:lastModified", 0);
-            contentNode.addMixin("vlt:Package");
-            Node defNode = contentNode.addNode("vlt:definition", "vlt:PackageDefinition");
-
-            ImportOptions opts = getDefaultOptions();
-            Archive subArchive =  archive.getSubArchive("META-INF/vault/definition", true);
-
-            DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-            filter.add(new PathFilterSet(defNode.getPath()));
-
-            Importer importer = new Importer(opts);
-            importer.getOptions().setAutoSaveThreshold(Integer.MAX_VALUE);
-            importer.getOptions().setFilter(filter);
-            importer.run(subArchive, defNode);
-            admin.save();
-            
-            assertFalse("Importer must not have any errors", importer.hasErrors());
-            assertNodeExists("/tmp/package.zip/jcr:content/vlt:definition/thumbnail.png");
-        }
-    }
-
-    @Test
-    public void testImportWithoutRootAccess() throws IOException, RepositoryException, ConfigurationException {
-        Assume.assumeTrue(!isOak());
-
-        // Create test user
-        UserManager userManager = ((JackrabbitSession)admin).getUserManager();
-        String userId = "user1";
-        String userPwd = "pwd1";
-        User user1 = userManager.createUser(userId, userPwd);
-        Principal principal1 = user1.getPrincipal();
-
-        // Create /tmp folder
-        admin.getRootNode().addNode("tmp");
-        admin.save();
-
-        // Setup test user ACLs such that the
-        // root node is not accessible
-        AccessControlUtils.addAccessControlEntry(admin, null, principal1, new String[]{"jcr:namespaceManagement","jcr:nodeTypeDefinitionManagement"}, true);
-        AccessControlUtils.addAccessControlEntry(admin, "/", principal1, new String[]{"jcr:all"}, false);
-        AccessControlUtils.addAccessControlEntry(admin, "/tmp", principal1, new String[]{"jcr:all"}, true);
-        admin.save();
-
-        // Import with a session associated to the test user
-        Session session = repository.login(new SimpleCredentials(userId, userPwd.toCharArray()));
-        ZipArchive archive = new ZipArchive(getFile("/test-packages/tmp.zip"));
-        archive.open(true);
-        ImportOptions opts = getDefaultOptions();
-        opts.setStrict(false);
-        Importer importer = new Importer(opts);
-        importer.run(archive, session, "/");
-        session.logout();
-
-        assertNodeExists("/tmp/foo/bar/tobi");
-    }
-
-    @Test
-    public void testImportWithoutRootAndTmpAccess() throws IOException, RepositoryException, ConfigurationException {
-        Assume.assumeTrue(!isOak());
-
-        // Create test user
-        UserManager userManager = ((JackrabbitSession)admin).getUserManager();
-        String userId = "user1";
-        String userPwd = "pwd1";
-        User user1 = userManager.createUser(userId, userPwd);
-        Principal principal1 = user1.getPrincipal();
-
-        // Create /tmp folder
-        admin.getRootNode().addNode("tmp").addNode("foo");
-        admin.save();
-
-        // Setup test user ACLs such that the
-        // root node is not accessible
-        AccessControlUtils.addAccessControlEntry(admin, null, principal1, new String[]{"jcr:namespaceManagement","jcr:nodeTypeDefinitionManagement"}, true);
-        AccessControlUtils.addAccessControlEntry(admin, "/", principal1, new String[]{"jcr:all"}, false);
-        AccessControlUtils.addAccessControlEntry(admin, "/tmp/foo", principal1, new String[]{"jcr:all"}, true);
-        admin.save();
-
-        // Import with a session associated to the test user
-        Session session = repository.login(new SimpleCredentials(userId, userPwd.toCharArray()));
-        ZipArchive archive = new ZipArchive(getFile("/test-packages/tmp_foo.zip"));
-        archive.open(true);
-        ImportOptions opts = getDefaultOptions();
-        opts.setStrict(false);
-        Importer importer = new Importer(opts);
-        importer.run(archive, session, "/");
-        session.logout();
-
-        assertNodeExists("/tmp/foo/bar/tobi");
-    }
-
-    @Test
-    public void testImportProtectedProperties() throws IOException, RepositoryException, ConfigurationException {
-        try (Archive archive = getFileArchive("/test-packages/protected_properties.zip")) {
-            Node rootNode = admin.getRootNode();
-            ImportOptions opts = getDefaultOptions();
-            Importer importer = new Importer(opts);
-            archive.open(true);
-            importer.run(archive, rootNode);
-        }
-        admin.save();
-        assertProperty("/testroot/jcr:createdBy", "admin"); // must have a different value than in the .content.xml as it is protected and set automatically
-        assertPropertyMissing("/testroot/someProtectedBooleanProperty"); // is protected and skipped in the import
-        assertProperty("/testroot/someUnprotectedStringProperty", "foo"); // is not protected and must be there
-        assertProperty("/testroot/someUnprotectedStringMvProperty", new String[0]);
-    }
-
-    @Test
-    @SuppressWarnings("java:S5783")
-    public void testImportWithPropertyConstraintViolation() throws IOException, RepositoryException, ConfigurationException {
-        try (Archive archive = getFileArchive("/test-packages/property_constraint_violation.zip")) {
-            Node rootNode = admin.getRootNode();
-            ImportOptions opts = getDefaultOptions();
-            Importer importer = new Importer(opts);
-            archive.open(true);
-            // we don't care whether constraint is immediately enforced or only on save() as both is valid according to JCR spec
-            RepositoryException e = Assert.assertThrows(RepositoryException.class, () -> { importer.run(archive, rootNode); admin.save(); });
-            assertEquals(ConstraintViolationException.class, ExceptionUtils.getRootCause(e).getClass());
-        }
-    }
-
-    @Test
-    // JCRVLT-557
-    public void testKeepNodeTypeForFolderAggregate() throws IOException, RepositoryException, ConfigurationException {
-        // create nodes which are covered by a folder aggregate with type nt:unstructured
-        Node rootNode = admin.getRootNode();
-        Node testrootNode = rootNode.addNode("testroot", NodeType.NT_UNSTRUCTURED);
-        testrootNode.addNode("myfolder", NodeType.NT_UNSTRUCTURED);
-        admin.save();
-        // first try a regular installation (which should fail)
-        ImportOptions opts = getDefaultOptions();
-        Importer importer = new Importer(opts);
-        try (Archive archive = getFileArchive("/test-packages/test_nt_unstructured_below_folder_aggregate.zip")) {
-            archive.open(true);
-            importer.run(archive, rootNode);
-           // admin.save();
-            Assert.fail("Installing the package should fail as it tries to install an nt:unstructured node below an nt:folder node");
-        } catch (RepositoryException e) {
-            // expected
-        }
-        admin.refresh(false);
-        // restore type of /testroot/myfolder
-        testrootNode.getNode("myfolder").setPrimaryType(JcrConstants.NT_UNSTRUCTURED/*NodeType.NT_UNSTRUCTURED*/); // TODO: somehow expanded names do not work in Oak (see https://issues.apache.org/jira/browse/OAK-9616)
-        admin.save();
-        // don't overwrite node types for folder aggregates (i.e. keep nt:unstructured instead of converting to nt:folder)
-        opts.setOverwritePrimaryTypesOfFolders(false);
-        importer = new Importer(opts);
-        // now installation should succeed
-        try (Archive archive = getFileArchive("/test-packages/test_nt_unstructured_below_folder_aggregate.zip")) {
-            archive.open(true);
-            importer.run(archive, rootNode);
-        }
-        admin.save();
-        // Checking for node types
-        // Behavior in 3.4.0: myfolder's node type covered by package folder aggregate is not touched
-        assertNodeHasPrimaryType("/testroot/myfolder", JcrConstants.NT_UNSTRUCTURED);
-        assertNodeHasPrimaryType("/testroot/myfolder/mychild", JcrConstants.NT_UNSTRUCTURED);
-    }
-
-    @Test
-    public void testEnhancedFileAggregatePackageWithIntermediateSaves() throws IOException, ConfigurationException, AccessDeniedException, ItemExistsException, ReferentialIntegrityException, ConstraintViolationException, InvalidItemStateException, VersionException, LockException, NoSuchNodeTypeException, RepositoryException {
-        ImportOptions opts = getDefaultOptions();
-        opts.setAutoSaveThreshold(1); // auto-save after each deserialized aggregator
-        Importer importer = new Importer(opts);
-        try (Archive archive = getFileArchive("/test-packages/enhanced_file_aggregate.zip")) {
-            archive.open(true);
-            importer.run(archive, admin.getRootNode());
-            admin.save();
-        }
-        assertPropertyExists("/testroot/tika/config.xml/jcr:content/jcr:data");
-        assertProperty("/testroot/tika/config.xml/jcr:content/jcr:mimeType", "text/xml");
-    }
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ImportModeIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ImportModeIT.java
deleted file mode 100644
index a3b59851..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ImportModeIT.java
+++ /dev/null
@@ -1,334 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.ByteArrayInputStream;
-import java.io.IOException;
-import java.nio.charset.StandardCharsets;
-import java.util.Calendar;
-
-import javax.jcr.Node;
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.commons.JcrUtils;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.util.MimeTypes;
-import org.junit.Test;
-
-/**
- * {@code TestPackageInstall}...
- */
-public class ImportModeIT extends IntegrationTestBase {
-
-    /**
-     * Installs a package with the filter: "/tmp/foo", mode="replace"
-     */
-    @Test
-    public void testReplace() throws RepositoryException, IOException, PackageException {
-        Node tmp = admin.getRootNode().addNode("tmp");
-        Node foo = tmp.addNode("foo");
-        foo.addNode("old");
-        admin.save();
-        assertNodeExists("/tmp/foo/old");
-        assertNodeMissing("/tmp/foo/bar");
-
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_mode_replace.zip"), false);
-        pack.extract(getDefaultOptions());
-
-        assertNodeMissing("/tmp/foo/old");
-        assertNodeExists("/tmp/foo/bar");
-        assertProperty("/tmp/foo/bar/testProperty", "new");
-    }
-
-    /**
-     * Installs a package with the filter: "/tmp/foo", mode="merge"
-     */
-    @Test
-    public void testMerge() throws RepositoryException, IOException, PackageException {
-        Node tmp = admin.getRootNode().addNode("tmp");
-        Node foo = tmp.addNode("foo");
-        foo.addNode("old");
-        Node bar = foo.addNode("bar");
-        bar.setProperty("testProperty", "old");
-        admin.save();
-        assertNodeExists("/tmp/foo/old");
-        assertNodeMissing("/tmp/foo/new");
-
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_mode_merge.zip"), false);
-        pack.extract(getDefaultOptions());
-
-        assertNodeExists("/tmp/foo/old");
-        assertNodeExists("/tmp/foo/bar");
-        assertNodeExists("/tmp/foo/new");
-        assertProperty("/tmp/foo/bar/testProperty", "old");
-    }
-
-    /**
-     * Installs a package with the filter: "/tmp/foo", mode="update"
-     */
-    @Test
-    public void testUpdate() throws RepositoryException, IOException, PackageException {
-        Node tmp = admin.getRootNode().addNode("tmp");
-        Node foo = tmp.addNode("foo");
-        foo.addNode("old");
-        Node bar = foo.addNode("bar");
-        bar.setProperty("testProperty", "old");
-        admin.save();
-        assertNodeExists("/tmp/foo/old");
-        assertNodeMissing("/tmp/foo/new");
-
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_mode_update.zip"), false);
-        pack.extract(getDefaultOptions());
-
-        assertNodeExists("/tmp/foo/old");
-        assertNodeExists("/tmp/foo/bar");
-        assertNodeExists("/tmp/foo/new");
-        assertProperty("/tmp/foo/bar/testProperty", "new");
-    }
-
-    @Test
-    public void testAllImportModesWithGenericArtifactHandler() throws RepositoryException, IOException, PackageException {
-        // initial state
-        Node parent = admin.getRootNode().addNode("testroot");
-        setUpNode(parent, "replace");
-        setUpNode(parent, "merge");
-        setUpNode(parent, "update");
-        setUpNode(parent, "merge_properties");
-        setUpNode(parent, "update_properties");
-        admin.save();
-        
-        assertProperty("/testroot/replace/propertyold", "old");
-        assertProperty("/testroot/replace/propertyupdate", "old");
-        assertNodeExists("/testroot/replace/old");
-        assertProperty("/testroot/replace/existing/propertyold", "old");
-        
-        extractVaultPackage("/test-packages/import_modes_test_generichandler_docview.zip");
-        
-        // test update, creation and deletion of properties and nodes
-        // Replace
-        assertProperty("/testroot/replace/propertyupdate", "new");
-        assertProperty("/testroot/replace/propertynew", "new");
-        assertPropertyMissing("/testroot/replace/propertyold");
-        assertProperty("/testroot/replace/existing/propertynew", "new");
-        assertPropertyMissing("/testroot/replace/existing/propertyold");
-        assertNodeExists("/testroot/replace/new");
-        assertNodeMissing("/testroot/replace/old");
-
-        // Update (neither delete existing nodes nor properties)
-        assertProperty("/testroot/update/propertyupdate", "new");
-        assertProperty("/testroot/update/propertynew", "new");
-        assertProperty("/testroot/update/propertyold", "old");
-        assertProperty("/testroot/update/existing/propertynew", "new");
-        assertProperty("/testroot/update/existing/propertyold", "old");
-        assertNodeExists("/testroot/update/new");
-        assertNodeExists("/testroot/update/old");
-
-        // Merge (don't touch existing nodes, except for adding new children)
-        assertProperty("/testroot/merge/propertyupdate", "old");
-        assertProperty("/testroot/merge/propertynew", "new");
-        assertProperty("/testroot/merge/propertyold", "old");
-        assertProperty("/testroot/merge/existing/propertynew", "new");
-        assertProperty("/testroot/merge/existing/propertyold", "old");
-        assertNodeExists("/testroot/merge/new"); // works, because import mode for testroot (docview root level) is REPLACE
-        assertNodeExists("/testroot/merge/old");
-
-        // Property Update (neither delete existing nodes nor properties, but update them and add new properties/nodes)
-        assertProperty("/testroot/update_properties/propertyupdate", "new");
-        assertProperty("/testroot/update_properties/propertynew", "new");
-        assertProperty("/testroot/update_properties/propertyold", "old");
-        assertProperty("/testroot/update_properties/existing/propertynew", "new");
-        assertProperty("/testroot/update_properties/existing/propertyold", "old");
-        assertNodeExists("/testroot/update_properties/new");
-        assertNodeExists("/testroot/update_properties/old");
-        
-        // Property Merge (don't touch existing nodes nor properties, only add new properties/nodes)
-        assertProperty("/testroot/merge_properties/propertyupdate", "old");
-        assertProperty("/testroot/merge_properties/propertynew", "new");
-        assertProperty("/testroot/merge_properties/propertyold", "old");
-        assertProperty("/testroot/merge_properties/existing/propertynew", "new");
-        assertProperty("/testroot/merge_properties/existing/propertyold", "old");
-        assertNodeExists("/testroot/merge_properties/new");
-        assertNodeExists("/testroot/merge_properties/old");
-    }
-
-    @Test
-    public void testAllImportModesFullCoverageWithGenericArtifactHandler() throws RepositoryException, IOException, PackageException {
-        // initial state
-        Node parent = admin.getRootNode().addNode("testroot");
-        setUpNode(parent, "replace");
-        setUpNode(parent, "merge");
-        setUpNode(parent, "update");
-        setUpNode(parent, "merge_properties");
-        setUpNode(parent, "update_properties");
-        admin.save();
-        
-        assertProperty("/testroot/replace/propertyold", "old");
-        assertProperty("/testroot/replace/propertyupdate", "old");
-        assertNodeExists("/testroot/replace/old");
-        assertProperty("/testroot/replace/existing/propertyold", "old");
-        
-        // full coverage nodes on another level
-        extractVaultPackage("/test-packages/import_modes_test_generichandler2_docview.zip");
-        
-        // test update, creation and deletion of properties and nodes
-        // Replace
-        assertProperty("/testroot/replace/propertyupdate", "new");
-        assertProperty("/testroot/replace/propertynew", "new");
-        assertPropertyMissing("/testroot/replace/propertyold");
-        assertProperty("/testroot/replace/existing/propertynew", "new");
-        assertPropertyMissing("/testroot/replace/existing/propertyold");
-        assertNodeExists("/testroot/replace/new");
-        assertNodeMissing("/testroot/replace/old");
-
-        // Update (neither delete existing nodes nor properties)
-        assertProperty("/testroot/update/propertyupdate", "new");
-        assertProperty("/testroot/update/propertynew", "new");
-        assertProperty("/testroot/update/propertyold", "old");
-        assertProperty("/testroot/update/existing/propertynew", "new");
-        assertProperty("/testroot/update/existing/propertyold", "old");
-        assertNodeExists("/testroot/update/new");
-        assertNodeExists("/testroot/update/old");
-
-        // Merge (don't touch existing nodes, except for adding new children)
-        assertProperty("/testroot/merge/propertyupdate", "old");
-        assertPropertyMissing("/testroot/merge/propertynew"); // not imported as whole docview is skipped
-        assertProperty("/testroot/merge/propertyold", "old");
-        assertPropertyMissing("/testroot/merge/existing/propertynew"); // not imported as whole docview is skipped
-        assertProperty("/testroot/merge/existing/propertyold", "old");
-        assertNodeMissing("/testroot/merge/new"); // not imported as whole docview is skipped
-        assertNodeExists("/testroot/merge/old");
-
-        // Property Update (neither delete existing nodes nor properties, but update them and add new properties/nodes)
-        assertProperty("/testroot/update_properties/propertyupdate", "new");
-        assertProperty("/testroot/update_properties/propertynew", "new");
-        assertProperty("/testroot/update_properties/propertyold", "old");
-        assertProperty("/testroot/update_properties/existing/propertynew", "new");
-        assertProperty("/testroot/update_properties/existing/propertyold", "old");
-        assertNodeExists("/testroot/update_properties/new");
-        assertNodeExists("/testroot/update_properties/old");
-        
-        // Property Merge (don't touch existing nodes nor properties, only add new properties/nodes)
-        assertProperty("/testroot/merge_properties/propertyupdate", "old");
-        assertProperty("/testroot/merge_properties/propertynew", "new");
-        assertProperty("/testroot/merge_properties/propertyold", "old");
-        assertProperty("/testroot/merge_properties/existing/propertynew", "new");
-        assertProperty("/testroot/merge_properties/existing/propertyold", "old");
-        assertNodeExists("/testroot/merge_properties/new");
-        assertNodeExists("/testroot/merge_properties/old");
-    }
-
-    @Test
-    public void testAllImportModesWithFileArtifactHandler() throws RepositoryException, IOException, PackageException {
-     // initial state
-        Node parent = admin.getRootNode().addNode("testroot");
-        setUpFileNode(parent, "replace");
-        setUpFileNode(parent, "merge");
-        setUpFileNode(parent, "update");
-        setUpFileNode(parent, "merge_properties");
-        setUpFileNode(parent, "update_properties");
-        admin.save();
-        
-        assertProperty("/testroot/replace/jcr:content/jcr:data", "test");
-        
-        extractVaultPackage("/test-packages/import_modes_test_filehandler.zip");
-        
-        // test update, creation and deletion of properties and nodes
-        // Replace
-        assertProperty("/testroot/replace/jcr:content/jcr:data", "new");
-
-        // Update (neither delete existing nodes nor properties)
-        assertProperty("/testroot/update/jcr:content/jcr:data", "new");
-
-        // Merge (don't touch existing nodes, except for adding new children)
-        assertProperty("/testroot/merge/jcr:content/jcr:data", "test");
-
-        // Property Update (neither delete existing nodes nor properties, but update them and add new properties/nodes)
-        assertProperty("/testroot/update_properties/jcr:content/jcr:data", "new");
-        
-        // Property Merge (don't touch existing nodes nor properties, only add new properties/nodes)
-        assertProperty("/testroot/merge_properties/jcr:content/jcr:data", "test");
-    }
-
-    @Test
-    public void testMergingUpdatingNewRestrictedProperties() throws RepositoryException, IOException, PackageException {
-        // initial state
-        Node parent = admin.getRootNode().addNode("testroot");
-        // existing nodes are heavily restricted (nt:file)
-        setUpFileNode(parent, "replace");
-        setUpFileNode(parent, "merge_properties");
-        setUpFileNode(parent, "update_properties");
-        admin.save();
-        
-        extractVaultPackageStrict("/test-packages/import_modes_test_generichandler_docview.zip");
-
-        // Replace
-        assertProperty("/testroot/replace/propertyupdate", "new");
-        assertProperty("/testroot/replace/propertynew", "new");
-        assertPropertyMissing("/testroot/replace/propertyold");
-        assertProperty("/testroot/replace/existing/propertynew", "new");
-        assertPropertyMissing("/testroot/replace/existing/propertyold");
-        assertNodeExists("/testroot/replace/new");
-        assertNodeMissing("/testroot/replace/old");
-
-        // Property Update (skip adding new properties and child nodes as incompatible with existing primary type)
-        assertPropertyMissing("/testroot/update_properties/propertynew");
-        assertPropertyExists("/testroot/update_properties/jcr:content/jcr:data");
-        assertNodeExists("/testroot/update_properties/jcr:content");
-
-        // Property Merge (skip adding new properties and child nodes as incompatible with existing primary type)
-        assertPropertyMissing("/testroot/merge_properties/propertynew");
-        assertPropertyExists("/testroot/merge_properties/jcr:content/jcr:data");
-        assertNodeExists("/testroot/merge_properties/jcr:content");
-    }
-
-    @Test
-    public void testExistingNodesNotCoveredByArtifact() throws RepositoryException, IOException, PackageException {
-        Node parent = admin.getRootNode().addNode("testroot");
-        setUpNode(parent, "replace");
-        setUpNode(parent, "merge");
-        setUpNode(parent, "update");
-        setUpNode(parent, "merge_properties");
-        setUpNode(parent, "update_properties");
-        
-        admin.save();
-        extractVaultPackageStrict("/test-packages/import_modes_test_missing_artifacts.zip");
-        // node in repo removed with replace, not removed for all other import modes
-        assertNodeMissing("/testroot/replace");
-        assertNodeExists("/testroot/merge");
-        assertNodeExists("/testroot/update");
-        assertNodeExists("/testroot/merge_properties");
-        assertNodeExists("/testroot/update_properties");
-    }
-
-    private void setUpNode(Node parent, String name) throws RepositoryException {
-        Node node = parent.addNode(name);
-        node.setProperty("propertyold", "old");
-        node.setProperty("propertyupdate", "old");
-        node.addNode("old");
-        Node existing = node.addNode("existing");
-        existing.setProperty("propertyold", "old");
-    }
-
-    private void setUpFileNode(Node parent, String name) throws RepositoryException, IOException {
-        try (ByteArrayInputStream input = new ByteArrayInputStream("test".getBytes(StandardCharsets.US_ASCII))) {
-            JcrUtils.putFile(parent, name, MimeTypes.APPLICATION_OCTET_STREAM, input, Calendar.getInstance());
-        }
-    }
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/IntegrationTestBase.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/IntegrationTestBase.java
deleted file mode 100644
index b03a02b3..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/IntegrationTestBase.java
+++ /dev/null
@@ -1,828 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import static org.junit.Assert.assertArrayEquals;
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertFalse;
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.assertTrue;
-import static org.junit.Assert.fail;
-
-import java.io.File;
-import java.io.IOException;
-import java.io.InputStream;
-import java.io.UncheckedIOException;
-import java.net.URI;
-import java.net.URISyntaxException;
-import java.nio.file.Files;
-import java.nio.file.StandardCopyOption;
-import java.util.ArrayList;
-import java.util.Arrays;
-import java.util.Collections;
-import java.util.HashMap;
-import java.util.HashSet;
-import java.util.Iterator;
-import java.util.List;
-import java.util.Map;
-import java.util.Objects;
-import java.util.Properties;
-import java.util.Set;
-import java.util.function.Supplier;
-import java.util.jar.JarFile;
-
-import javax.jcr.Node;
-import javax.jcr.NodeIterator;
-import javax.jcr.PathNotFoundException;
-import javax.jcr.Property;
-import javax.jcr.PropertyType;
-import javax.jcr.Repository;
-import javax.jcr.RepositoryException;
-import javax.jcr.Session;
-import javax.jcr.SimpleCredentials;
-import javax.jcr.Value;
-import javax.jcr.security.AccessControlEntry;
-import javax.jcr.security.AccessControlPolicy;
-import javax.jcr.security.AccessControlPolicyIterator;
-import javax.jcr.security.Privilege;
-
-import org.apache.commons.io.FileUtils;
-import org.apache.commons.lang3.SystemUtils;
-import org.apache.jackrabbit.api.JackrabbitSession;
-import org.apache.jackrabbit.api.security.JackrabbitAccessControlEntry;
-import org.apache.jackrabbit.api.security.JackrabbitAccessControlList;
-import org.apache.jackrabbit.api.security.user.Authorizable;
-import org.apache.jackrabbit.api.security.user.UserManager;
-import org.apache.jackrabbit.commons.jackrabbit.authorization.AccessControlUtils;
-import org.apache.jackrabbit.core.RepositoryImpl;
-import org.apache.jackrabbit.core.config.RepositoryConfig;
-import org.apache.jackrabbit.core.data.FileDataStore;
-import org.apache.jackrabbit.core.security.principal.EveryonePrincipal;
-import org.apache.jackrabbit.core.security.principal.PrincipalImpl;
-import org.apache.jackrabbit.oak.jcr.Jcr;
-import org.apache.jackrabbit.oak.plugins.blob.datastore.DataStoreBlobStore;
-import org.apache.jackrabbit.oak.plugins.tree.impl.RootProviderService;
-import org.apache.jackrabbit.oak.plugins.tree.impl.TreeProviderService;
-import org.apache.jackrabbit.oak.security.internal.SecurityProviderBuilder;
-import org.apache.jackrabbit.oak.security.user.RandomAuthorizableNodeName;
-import org.apache.jackrabbit.oak.segment.SegmentNodeStore;
-import org.apache.jackrabbit.oak.segment.SegmentNodeStoreBuilders;
-import org.apache.jackrabbit.oak.segment.file.FileStore;
-import org.apache.jackrabbit.oak.segment.file.FileStoreBuilder;
-import org.apache.jackrabbit.oak.segment.file.InvalidFileStoreVersionException;
-import org.apache.jackrabbit.oak.spi.blob.BlobStore;
-import org.apache.jackrabbit.oak.spi.security.ConfigurationParameters;
-import org.apache.jackrabbit.oak.spi.security.SecurityProvider;
-import org.apache.jackrabbit.oak.spi.security.authorization.AuthorizationConfiguration;
-import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeConstants;
-import org.apache.jackrabbit.oak.spi.security.user.AuthorizableNodeName;
-import org.apache.jackrabbit.oak.spi.security.user.UserConfiguration;
-import org.apache.jackrabbit.oak.spi.security.user.UserConstants;
-import org.apache.jackrabbit.oak.spi.security.user.action.AccessControlAction;
-import org.apache.jackrabbit.oak.spi.xml.ImportBehavior;
-import org.apache.jackrabbit.oak.spi.xml.ProtectedItemImporter;
-import org.apache.jackrabbit.util.Text;
-import org.apache.jackrabbit.vault.fs.api.ProgressTrackerListener;
-import org.apache.jackrabbit.vault.fs.io.Archive;
-import org.apache.jackrabbit.vault.fs.io.FileArchive;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.fs.io.ZipArchive;
-import org.apache.jackrabbit.vault.fs.io.ZipStreamArchive;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.PackageId;
-import org.apache.jackrabbit.vault.packaging.VaultPackage;
-import org.apache.jackrabbit.vault.packaging.events.impl.PackageEventDispatcherImpl;
-import org.apache.jackrabbit.vault.packaging.impl.ActivityLog;
-import org.apache.jackrabbit.vault.packaging.impl.JcrPackageManagerImpl;
-import org.apache.jackrabbit.vault.packaging.impl.ZipVaultPackage;
-import org.apache.jackrabbit.vault.packaging.registry.impl.JcrPackageRegistry;
-import org.junit.After;
-import org.junit.AfterClass;
-import org.junit.Before;
-import org.junit.BeforeClass;
-import org.junit.ClassRule;
-import org.junit.rules.TemporaryFolder;
-import org.slf4j.Logger;
-import org.slf4j.LoggerFactory;
-
-/**
- * {@code IntegrationTestBase}...
- */
-public class IntegrationTestBase  {
-
-    /**
-     * default logger
-     */
-    private static final Logger log = LoggerFactory.getLogger(IntegrationTestBase.class);
-
-    
-    private static final File DIR_JR2_REPO_HOME = new File("target", "repository-jr2-" + System.getProperty("repoSuffix", "fork1"));
-    private static final File DIR_OAK_REPO_HOME = new File("target", "repository-oak-" + System.getProperty("repoSuffix", "fork1"));
-
-    private static final File DIR_OAK_FILE_STORE = new File(DIR_OAK_REPO_HOME, "filestore");
-    private static final File DIR_OAK_BLOB_STORE = new File(DIR_OAK_FILE_STORE, "blobstore");
-
-    public static final PackageId TMP_PACKAGE_ID = new PackageId("my_packages", "tmp", "");
-
-    public static final PackageId TMP_SNAPSHOT_PACKAGE_ID = PackageId.fromString("my_packages/.snapshot:tmp");
-
-    public static final PackageId TEST_PACKAGE_A_10_ID = new PackageId("my_packages", "test_a", "1.0");
-
-    public static final PackageId TEST_PACKAGE_B_10_ID = new PackageId("my_packages", "test_b", "1.0");
-
-    public static final PackageId TEST_PACKAGE_C_10_ID = new PackageId("my_packages", "test_c", "1.0");
-
-    public static final PackageId PACKAGE_ID_SUB_A = PackageId.fromString("my_packages:sub_a");
-
-    public static final PackageId PACKAGE_ID_SUB_B = PackageId.fromString("my_packages:sub_b");
-
-    /**
-     * Test package A-1.0. Depends on B and C-1.X
-     */
-    public static String TEST_PACKAGE_A_10 = "/test-packages/test_a-1.0.zip";
-
-    /**
-     * Test package B-1.0. Depends on C
-     */
-    public static String TEST_PACKAGE_B_10 = "/test-packages/test_b-1.0.zip";
-
-    /**
-     * Test package C-1.0
-     */
-    public static String TEST_PACKAGE_C_10 = "/test-packages/test_c-1.0.zip";
-
-
-    @ClassRule
-    public static TemporaryFolder tempFolder = new TemporaryFolder();
-
-    private static FileStore fileStore = null;
-
-    protected static Repository repository;
-
-    protected Session admin;
-
-    protected JcrPackageManagerImpl packMgr;
-
-    protected Set<String> preTestAuthorizables;
-
-    @BeforeClass
-    public static void initRepository() throws RepositoryException, IOException, InvalidFileStoreVersionException {
-        initRepository(isOak(), useFileStore());
-    }
-
-    /**
-     * 
-     * @param isOak {@code true} in case IT should run against Oak, otherwise runs again JR2
-     * @param useFileStore only evaluated for Oak. Optionally uses a dedicated BlobStore with Oak
-     * @throws RepositoryException
-     * @throws IOException
-     * @throws InvalidFileStoreVersionException
-     */
-    public static void initRepository(boolean isOak, boolean useFileStore) throws RepositoryException, IOException, InvalidFileStoreVersionException {
-        if (isOak) {
-            Jcr jcr;
-            if (useFileStore) {
-                BlobStore blobStore = createBlobStore();
-                DIR_OAK_FILE_STORE.mkdirs();
-                fileStore = FileStoreBuilder.fileStoreBuilder(DIR_OAK_FILE_STORE)
-                        .withBlobStore(blobStore)
-                        .build();
-                SegmentNodeStore nodeStore = SegmentNodeStoreBuilders.builder(fileStore).build();
-                jcr = new Jcr(nodeStore);
-            } else {
-                // in-memory repo
-                jcr = new Jcr();
-            }
-
-            repository = jcr
-                    .with(createSecurityProvider())
-                    .withAtomicCounter()
-                    .createRepository();
-
-            // setup default read ACL for everyone
-            Session admin = repository.login(new SimpleCredentials("admin", "admin".toCharArray()));
-            AccessControlUtils.addAccessControlEntry(admin, "/", EveryonePrincipal.getInstance(), new String[]{"jcr:read"}, true);
-            admin.save();
-            admin.logout();
-        } else {
-            try (InputStream in = IntegrationTestBase.class.getResourceAsStream("repository.xml")) {
-                RepositoryConfig cfg = RepositoryConfig.create(in, DIR_JR2_REPO_HOME.getPath());
-                repository = RepositoryImpl.create(cfg);
-            }
-        }
-        log.info("repository created: {} {}",
-                repository.getDescriptor(Repository.REP_NAME_DESC),
-                repository.getDescriptor(Repository.REP_VERSION_DESC));
-    }
-
-    public static ConfigurationParameters getSecurityConfigurationParameters() {
-        Properties userProps = new Properties();
-        AuthorizableNodeName nameGenerator = new RandomAuthorizableNodeName();
-
-        userProps.put(UserConstants.PARAM_USER_PATH, "/home/users");
-        userProps.put(UserConstants.PARAM_GROUP_PATH, "/home/groups");
-        userProps.put(AccessControlAction.USER_PRIVILEGE_NAMES, new String[] {PrivilegeConstants.JCR_ALL});
-        userProps.put(AccessControlAction.GROUP_PRIVILEGE_NAMES, new String[] {PrivilegeConstants.JCR_READ});
-        userProps.put(ProtectedItemImporter.PARAM_IMPORT_BEHAVIOR, ImportBehavior.NAME_BESTEFFORT);
-        userProps.put(UserConstants.PARAM_AUTHORIZABLE_NODE_NAME, nameGenerator);
-        userProps.put("cacheExpiration", 3600*1000);
-        Properties authzProps = new Properties();
-        authzProps.put(ProtectedItemImporter.PARAM_IMPORT_BEHAVIOR, ImportBehavior.NAME_BESTEFFORT);
-        return ConfigurationParameters.of(
-                UserConfiguration.NAME, ConfigurationParameters.of(userProps),
-                AuthorizationConfiguration.NAME, ConfigurationParameters.of(authzProps));
-    }
-
-    public static SecurityProvider createSecurityProvider() {
-        SecurityProvider securityProvider = SecurityProviderBuilder.newBuilder()
-                .with(getSecurityConfigurationParameters())
-                .withRootProvider(new RootProviderService())
-                .withTreeProvider(new TreeProviderService()).build();
-        return securityProvider;
-    }
-
-    public static boolean useFileStore() {
-        // don't use by default because it is slower and pollutes the log
-        return Boolean.parseBoolean(System.getProperty("fds", "false"));
-    }
-
-    private static BlobStore createBlobStore() throws IOException {
-        DIR_OAK_BLOB_STORE.mkdirs();
-        FileDataStore fds = new FileDataStore();
-        fds.setMinRecordLength(4092);
-        fds.setPath(DIR_OAK_BLOB_STORE.getAbsolutePath());
-        fds.init(DIR_OAK_REPO_HOME.getAbsolutePath());
-        return new DataStoreBlobStore(fds);
-    }
-
-    private static void deleteDirectory(File directory) throws IOException {
-        try {
-            FileUtils.deleteDirectory(directory);
-        } catch (IOException ioe) {
-            // retry after wait on Windows, as it may release file locks in a deferred manner
-            if (SystemUtils.IS_OS_WINDOWS) {
-                try {
-                    Thread.sleep(100);
-                } catch (InterruptedException ie) {
-                    Thread.currentThread().interrupt();
-                    IOException wrappedIOException = new IOException("Initially failed with IOException and waiting was interrupted", ioe);
-                    wrappedIOException.addSuppressed(ie);
-                }
-                FileUtils.deleteDirectory(directory);
-            } else {
-                throw ioe;
-            }
-        }
-    }
-
-    @AfterClass
-    public static void shutdownRepository() throws IOException {
-        if (repository instanceof RepositoryImpl) {
-            ((RepositoryImpl) repository).shutdown();
-            deleteDirectory(DIR_JR2_REPO_HOME);
-        } else if (repository instanceof org.apache.jackrabbit.oak.jcr.repository.RepositoryImpl) {
-            ((org.apache.jackrabbit.oak.jcr.repository.RepositoryImpl) repository).shutdown();
-            if (fileStore != null) {
-                fileStore.close();
-                fileStore = null;
-            }
-            deleteDirectory(DIR_OAK_REPO_HOME);
-        }
-        repository = null;
-    }
-
-    @Before
-    public void setUp() throws Exception {
-        admin = repository.login(new SimpleCredentials("admin", "admin".toCharArray()));
-
-        // ensure not packages or tmp
-        clean("/etc");
-        clean("/var");
-        clean("/tmp");
-        clean("/testroot");
-
-        packMgr = new JcrPackageManagerImpl(admin, new String[0]);
-
-        PackageEventDispatcherImpl dispatcher = new PackageEventDispatcherImpl();
-        dispatcher.bindPackageEventListener(new ActivityLog(), Collections.singletonMap("component.id", (Object) "1234"));
-        packMgr.setDispatcher(dispatcher);
-
-        preTestAuthorizables = getAllAuthorizableIds();
-    }
-
-    @After
-    public void tearDown() throws Exception {
-        // remove test authorizables
-        admin.refresh(false);
-        UserManager mgr = ((JackrabbitSession) admin).getUserManager();
-        for (String id: getAllAuthorizableIds()) {
-            if (!preTestAuthorizables.remove(id)) {
-                removeAuthorizable(mgr, id);
-            }
-        }
-        admin.save();
-
-        packMgr = null;
-        if (admin != null) {
-            admin.logout();
-            admin = null;
-        }
-    }
-
-    public static boolean isOak() {
-        return Boolean.parseBoolean(System.getProperty("oak", "true"));
-    }
-
-    public void clean(String path) {
-        try {
-            admin.getNode(path).remove();
-            admin.save();
-        } catch (RepositoryException e) {
-            // ignore
-        }
-    }
-
-    public final Set<String> getAllAuthorizableIds() throws RepositoryException {
-        Set<String> ret = new HashSet<String>();
-        UserManager mgr = ((JackrabbitSession) admin).getUserManager();
-        Iterator<Authorizable> auths = mgr.findAuthorizables("rep:principalName", null);
-        while (auths.hasNext()) {
-            ret.add(auths.next().getID());
-        }
-        return ret;
-    }
-
-    public final void removeAuthorizable(UserManager mgr, String name) throws RepositoryException {
-        Authorizable a = mgr.getAuthorizable(name);
-        if (a != null) {
-            a.remove();
-        }
-    }
-
-    public InputStream getStream(String name) {
-        return getStream(getClass(), name);
-    }
-
-    public static InputStream getStream(Class<?> clazz, String name) {
-        return Objects.requireNonNull(clazz.getResourceAsStream(name), "Could not find class resource with name '" + name + "'");
-    }
-
-    /**
-     * 
-     * @param name
-     * @return either a new tmp file (deleted automatically at the end of the unit test) or the original file name if not encapsulated in a JAR
-     * @throws IOException
-     */
-    public File getFile(String name) throws IOException {
-        return getFile(getClass(), name, () -> {
-            try {
-                return tempFolder.newFile();
-            } catch (IOException e) {
-                throw new UncheckedIOException("cannot create temp file", e);
-            }
-        });
-    }
-
-    public static File getFile(Class<?> clazz, String name, Supplier<File> tmpFileSupplier) throws IOException {
-        URI uri;
-        try {
-            uri = Objects.requireNonNull(clazz.getResource(name),  "Could not find class resource with name '" + name + "'").toURI();
-        } catch (URISyntaxException e) {
-            throw new IOException("Could not convert class resource URL to URI", e);
-        }
-        if (uri.isOpaque()) { // non hierarchical URIs (for resources in a JAR)  can not use classical file operations
-            File tmpFile = tmpFileSupplier.get();
-            try (InputStream in = getStream(clazz, name)) {
-                Files.copy(in, tmpFile.toPath(), StandardCopyOption.REPLACE_EXISTING);
-            }
-            return tmpFile;
-        } else {
-            return new File(uri);
-        }
-    }
-    public Archive getFileArchive(String name) throws IOException {
-        final File file = getFile(name);
-        if (file.isDirectory()) {
-            return new FileArchive(file);
-        } else {
-            return new ZipArchive(file);
-        }
-    }
-
-    public Archive getStreamArchive(String name, int size) throws IOException {
-        final File file = getFile(name);
-        if (file.isDirectory()) {
-            throw new IllegalArgumentException("Can't create stream archive from directory");
-        } else {
-            return new ZipStreamArchive(FileUtils.openInputStream(file), size);
-        }
-    }
-
-    /**
-     * Returns a ZipVaultPackage from either a directory (exploded package) or a package zip file
-     * @param name
-     * @return VaultPackage
-     * @throws IOException
-     */
-    public VaultPackage loadVaultPackage(String name) throws IOException {
-        return new ZipVaultPackage(getFileArchive(name), true);
-    }
-
-    /**
-     * Returns an ZipVaultPackage which has been extracted in the repository.
-     * 
-     * @param name either the name of a zip file or the name of a directory which contains an exploded package
-     * @return an extracted vault package
-     * @throws IOException
-     * @throws PackageException
-     * @throws RepositoryException
-     */
-    public VaultPackage extractVaultPackage(String name) throws IOException, PackageException, RepositoryException {
-        return extractVaultPackage(name, null);
-    }
-
-    /**
-     * Returns an ZipVaultPackage which has been extracted in the repository.
-     * 
-     * @param name either the name of a zip file or the name of a directory which contains an exploded package
-     * @return an extracted vault package
-     * @throws IOException
-     * @throws PackageException
-     * @throws RepositoryException
-     */
-    public VaultPackage extractVaultPackageStrict(String name) throws IOException, PackageException, RepositoryException {
-        ImportOptions  opts = getDefaultOptions();
-        return extractVaultPackage(name, opts);
-    }
-
-    public VaultPackage extractVaultPackage(String name, ImportOptions opts) throws IOException, PackageException, RepositoryException {
-        if (opts == null) {
-            opts = getDefaultOptions();
-        }
-        VaultPackage pack = loadVaultPackage(name);
-        pack.extract(admin, opts);
-        return pack;
-    }
-
-    /**
-     * Uploads, closes, and reopens the package
-     */
-    public JcrPackage uploadPackage(String name) throws RepositoryException, IOException {
-        JcrPackage jcrPackage = packMgr.upload(getStream(name), false);
-        assertNotNull(jcrPackage);
-        PackageId pid = jcrPackage.getDefinition().getId();
-        jcrPackage.close();
-        jcrPackage = packMgr.open(pid);
-        assertNotNull(jcrPackage);
-        return jcrPackage;
-    }
-
-    public JcrPackage installPackage(String name) throws IOException, RepositoryException, PackageException {
-        return installPackage(name, null);
-    }
-
-    public JcrPackage installPackage(String name, ImportOptions opts) throws IOException, RepositoryException, PackageException {
-        if (opts == null) {
-            opts = getDefaultOptions();
-        }
-        JcrPackage pack = packMgr.upload(getStream(name), false);
-        assertNotNull(pack);
-        pack.install(opts);
-        return pack;
-    }
-
-    public ImportOptions getDefaultOptions() {
-        ImportOptions opts = new ImportOptions();
-        opts.setListener(getLoggingProgressTrackerListener());
-        opts.setStrict(true);
-        return opts;
-    }
-
-    public ProgressTrackerListener getLoggingProgressTrackerListener() {
-        return new ProgressTrackerListener() {
-            public void onMessage(Mode mode, String action, String path) {
-                log.info("{} {}", action, path);
-            }
-
-            public void onError(Mode mode, String path, Exception e) {
-                log.info("E {} {}", path, e.toString());
-            }
-        };
-    }
-
-    /**
-     * Returns the installation path of the package including the ".zip" extension.
-     * @param id the package id
-     * @return the path
-     */
-    public String getInstallationPath(PackageId id) {
-        // make sure we use the one from the test parameter
-        return ((JcrPackageRegistry)packMgr.getRegistry()).getInstallationPath(id) + ".zip";
-    }
-
-    public void assertPackageNodeExists(PackageId id) throws RepositoryException {
-        assertNodeExists(getInstallationPath(id));
-    }
-
-    public void assertPackageNodeMissing(PackageId id) throws RepositoryException {
-        assertNodeMissing(getInstallationPath(id));
-    }
-
-    public void assertNodeExists(String path) throws RepositoryException {
-        assertTrue(path + " should exist", admin.nodeExists(path));
-    }
-
-    public void assertNodeMissing(String path) throws RepositoryException {
-        assertFalse(path + " should not exist", admin.nodeExists(path));
-    }
-
-    public void assertProperty(String path, String value) throws RepositoryException {
-        assertEquals(path + " should contain " + value, value, admin.getProperty(path).getString());
-    }
-
-    public void assertProperty(String path,  boolean value) throws RepositoryException {
-        Property property = admin.getProperty(path);
-        assertEquals(path + " is no boolean property", PropertyType.BOOLEAN, property.getType());
-        assertEquals(path + " should contain boolean value " + value, property.getBoolean(), value);
-    }
- 
-    public void assertPropertyExists(String path) throws RepositoryException {
-        assertTrue(path + " should exist", admin.propertyExists(path));
-    }
-
-
-    public void assertProperty(String path, String[] values) throws RepositoryException {
-        ArrayList<String> strings = new ArrayList<String>();
-        for (Value v: admin.getProperty(path).getValues()) {
-            strings.add(v.getString());
-        }
-        assertArrayEquals(path + " should contain " + values, values, strings.toArray(new String[strings.size()]));
-    }
-
-    public void assertPropertyMissing(String path) throws RepositoryException {
-        assertFalse(path + " should not exist", admin.propertyExists(path));
-    }
-
-    public void assertPropertyMissingOrEmpty(String path) throws RepositoryException {
-        if (!admin.propertyExists(path)) {
-            return;
-        }
-        Property p = admin.getProperty(path);
-        if (p.isMultiple()) {
-            assertTrue(path + " should not exist or be empty", p.getValues().length == 0);
-        } else {
-            assertTrue(path + " should not exist or be empty", p.getString().length() == 0);
-        }
-    }
-
-    public void assertNodeHasPrimaryType(String path, String primaryType) throws PathNotFoundException, RepositoryException {
-        Node node = admin.getNode(path);
-        assertNotNull("Node at '" + path + "' must exist", node);
-        assertEquals("Node at '" + path + "' does not have the expected node type", primaryType, node.getPrimaryNodeType().getName());
-    }
-
-    public void createNodes(Node parent, int maxDepth, int nodesPerFolder) throws RepositoryException {
-        for (int i=0; i<nodesPerFolder; i++) {
-            Node n = parent.addNode("n" + i, "nt:folder");
-            if (maxDepth > 0) {
-                createNodes(n, maxDepth - 1, nodesPerFolder);
-            }
-        }
-    }
-
-    public int countNodes(Node parent) throws RepositoryException {
-        int total = 1;
-        NodeIterator iter = parent.getNodes();
-        while (iter.hasNext()) {
-            total += countNodes(iter.nextNode());
-        }
-        return total;
-    }
-
-    public void assertPermissionMissing(String path, boolean allow, String[] privs, String name, String globRest)
-            throws RepositoryException {
-        Map<String, String[]> restrictions = new HashMap<String, String[]>();
-        if (globRest != null) {
-            restrictions.put("rep:glob", new String[]{globRest});
-        }
-        if (hasPermission(path, allow, privs, name, restrictions) >= 0) {
-            fail("Expected permission should not exist on path " + path + ". Actual permissions: " + dumpPermissions(path));
-        }
-    }
-
-    public void assertPermission(String path, boolean allow, String[] privs, String name, String globRest)
-            throws RepositoryException {
-        Map<String, String[]> restrictions = new HashMap<String, String[]>();
-        if (globRest != null) {
-            restrictions.put("rep:glob", new String[]{globRest});
-        }
-        if (hasPermission(path, allow, privs, name, restrictions) < 0) {
-            fail("Expected permission missing on path " + path + ". Actual permissions: " + dumpPermissions(path));
-        }
-    }
-
-    public String dumpPermissions(String path) throws RepositoryException {
-        StringBuilder ret = new StringBuilder();
-        AccessControlPolicy[] ap = admin.getAccessControlManager().getPolicies(path);
-        for (AccessControlPolicy p: ap) {
-            if (p instanceof JackrabbitAccessControlList) {
-                JackrabbitAccessControlList acl = (JackrabbitAccessControlList) p;
-                for (AccessControlEntry ac: acl.getAccessControlEntries()) {
-                    if (ac instanceof JackrabbitAccessControlEntry) {
-                        JackrabbitAccessControlEntry ace = (JackrabbitAccessControlEntry) ac;
-                        ret.append(ace.isAllow() ? "\n- allow " : "deny ");
-                        ret.append(ace.getPrincipal().getName());
-                        char delim = '[';
-                        for (Privilege priv: ace.getPrivileges()) {
-                            ret.append(delim).append(priv.getName());
-                            delim=',';
-                        }
-                        ret.append(']');
-                        for (String restName: ace.getRestrictionNames()) {
-                            Value[] values;
-                            if ("rep:glob".equals(restName)) {
-                                values = new Value[]{ace.getRestriction(restName)};
-                            } else {
-                                values = ace.getRestrictions(restName);
-                            }
-                            for (Value value : values) {
-                                ret.append(" rest=").append(value.getString());
-                            }
-                        }
-                    }
-                }
-            }
-        }
-        return ret.toString();
-    }
-
-    public int hasPermission(String path, boolean allow, String[] privs, String name, Map<String, String[]> restrictions)
-            throws RepositoryException {
-        AccessControlPolicy[] ap = admin.getAccessControlManager().getPolicies(path);
-        int idx = 0;
-        for (AccessControlPolicy p: ap) {
-            if (p instanceof JackrabbitAccessControlList) {
-                JackrabbitAccessControlList acl = (JackrabbitAccessControlList) p;
-                for (AccessControlEntry ac: acl.getAccessControlEntries()) {
-                    if (ac instanceof JackrabbitAccessControlEntry) {
-                        idx++;
-                        JackrabbitAccessControlEntry ace = (JackrabbitAccessControlEntry) ac;
-                        if (ace.isAllow() != allow) {
-                            continue;
-                        }
-                        if (!ace.getPrincipal().getName().equals(name)) {
-                            continue;
-                        }
-                        Set<String> expectedPrivs = new HashSet<String>(Arrays.asList(privs));
-                        for (Privilege priv: ace.getPrivileges()) {
-                            if (!expectedPrivs.remove(priv.getName())) {
-                                expectedPrivs.add("dummy");
-                                break;
-                            }
-                        }
-                        if (!expectedPrivs.isEmpty()) {
-                            continue;
-                        }
-                        Map<String, String[]> rests = new HashMap<String, String[]>(restrictions);
-                        boolean restrictionExpected = true;
-                        for (String restName: ace.getRestrictionNames()) {
-                            String[] expected = rests.remove(restName);
-                            if (expected == null) {
-                                continue;
-                            }
-                            Value[] values;
-                            if ("rep:glob".equals(restName)) {
-                                values = new Value[]{ace.getRestriction(restName)};
-                            } else {
-                                values = ace.getRestrictions(restName);
-                            }
-                            String[] actual = new String[values.length];
-                            for (int i=0; i<actual.length; i++) {
-                                actual[i] = values[i].getString();
-                            }
-                            Arrays.sort(expected);
-                            Arrays.sort(actual);
-                            if (!Arrays.equals(expected, actual)) {
-                                restrictionExpected = false;
-                                break;
-                            }
-                        }
-                        if (!restrictionExpected || !rests.isEmpty()) {
-                            continue;
-                        }
-                        return idx-1;
-                    }
-                }
-            }
-        }
-        return -1;
-    }
-
-    public void removeRepoACL() throws RepositoryException {
-        AccessControlPolicy[] ap = admin.getAccessControlManager().getPolicies(null);
-        for (AccessControlPolicy p: ap) {
-            if (p instanceof JackrabbitAccessControlList) {
-                JackrabbitAccessControlList acl = (JackrabbitAccessControlList) p;
-                for (AccessControlEntry ac: acl.getAccessControlEntries()) {
-                    if (ac instanceof JackrabbitAccessControlEntry) {
-                        acl.removeAccessControlEntry(ac);
-                    }
-                }
-            }
-        }
-        admin.save();
-    }
-
-    public void addACL(String path, boolean allow, String[] privs, String principal) throws RepositoryException {
-        JackrabbitAccessControlList acl = null;
-        for (AccessControlPolicy p: admin.getAccessControlManager().getPolicies(path)) {
-            if (p instanceof JackrabbitAccessControlList) {
-                acl = (JackrabbitAccessControlList) p;
-                break;
-            }
-        }
-        if (acl == null) {
-            AccessControlPolicyIterator iter =  admin.getAccessControlManager().getApplicablePolicies(path);
-            while (iter.hasNext()) {
-                AccessControlPolicy p = iter.nextAccessControlPolicy();
-                if (p instanceof JackrabbitAccessControlList) {
-                    acl = (JackrabbitAccessControlList) p;
-                    break;
-                }
-            }
-        }
-        assertNotNull(acl);
-
-        Privilege[] ps = new Privilege[privs.length];
-        for (int i=0; i<privs.length; i++) {
-            ps[i] = admin.getAccessControlManager().privilegeFromName(privs[i]);
-        }
-        acl.addEntry(new PrincipalImpl(principal), ps, allow);
-        admin.getAccessControlManager().setPolicy(path, acl);
-        admin.save();
-    }
-
-    public static class TrackingListener implements ProgressTrackerListener {
-
-        private final ProgressTrackerListener delegate;
-
-        private final Map<String, String> actions = new HashMap<String, String>();
-
-        public TrackingListener(ProgressTrackerListener delegate) {
-            this.delegate = delegate;
-        }
-
-        public Map<String, String> getActions() {
-            return actions;
-        }
-
-        @Override
-        public void onMessage(Mode mode, String action, String path) {
-            if (delegate != null) {
-                delegate.onMessage(mode, action, path);
-            }
-            actions.put(path, action);
-        }
-
-        @Override
-        public void onError(Mode mode, String path, Exception e) {
-            if (delegate != null) {
-                delegate.onError(mode, path, e);
-            }
-            actions.put(path, "E");
-        }
-    }
-
-    void verifyManifest(File testPackageFile, Set<String> ignoredEntries, String expected) throws IOException {
-        try (JarFile jar = new JarFile(testPackageFile)) {
-            List<String> entries = new ArrayList<String>();
-            for (Map.Entry<Object, Object> e: jar.getManifest().getMainAttributes().entrySet()) {
-                String key = e.getKey().toString();
-                if (ignoredEntries.contains(key)) {
-                    continue;
-                }
-                entries.add(e.getKey() + ":" + e.getValue());
-            }
-            Collections.sort(entries);
-            String result = Text.implode(entries.toArray(new String[entries.size()]),"\n");
-            assertEquals("Manifest", expected, result);
-        }
-    }
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/MandatoryNodeIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/MandatoryNodeIT.java
deleted file mode 100644
index 559e7bfc..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/MandatoryNodeIT.java
+++ /dev/null
@@ -1,100 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.IOException;
-
-import javax.jcr.ItemExistsException;
-import javax.jcr.Node;
-import javax.jcr.PathNotFoundException;
-import javax.jcr.RepositoryException;
-import javax.jcr.lock.LockException;
-import javax.jcr.nodetype.ConstraintViolationException;
-import javax.jcr.nodetype.NoSuchNodeTypeException;
-import javax.jcr.nodetype.NodeType;
-import javax.jcr.version.VersionException;
-
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.junit.Assert;
-import org.junit.Test;
-
-
-public class MandatoryNodeIT extends IntegrationTestBase {
- 
-    @Test
-    public void testMandatoryResidualChildNodesReplace()
-            throws RepositoryException, IOException, PackageException {
-
-        // some node types use both residual (name constraint = "*") and mandatory child nodes but according to
-        // JCR 2.0 (https://s.apache.org/jcr-2.0-spec/2.0/3_Repository_Model.html#3.7.2.4%20Mandatory)
-        // this is not allowed and is subsequently not enforced
-
-        // package set ups folder structure with mandatory child nodes
-        extractVaultPackage("/test-packages/wcm-rollout-config-1.zip");
-
-        assertNodeExists("/libs/msm/wcm/rolloutconfigs/activate/targetActivate");
-
-        assertNodeExists("/libs/msm/wcm/rolloutconfigs/deactivate/targetDeactivate");
-
-        assertNodeExists("/libs/msm/wcm/rolloutconfigs/default/contentUpdate");
-        assertNodeExists("/libs/msm/wcm/rolloutconfigs/default/contentCopy");
-        assertNodeExists("/libs/msm/wcm/rolloutconfigs/default/contentDelete");
-
-        // packages removes/replaces some mandatory child nodes
-        extractVaultPackage("/test-packages/wcm-rollout-config-2.zip");
-
-        // check if older nodes are replaced
-        assertNodeMissing("/libs/msm/wcm/rolloutconfigs/default/contentUpdate");
-        assertNodeMissing("/libs/msm/wcm/rolloutconfigs/default/contentDelete");
-        // check if newly added node exist
-        assertNodeExists("/libs/msm/wcm/rolloutconfigs/default/activate");
-        assertNodeExists("/libs/msm/wcm/rolloutconfigs/default/contentCopy");
-
-        // check if the only node is replaced
-        assertNodeMissing("/libs/msm/wcm/rolloutconfigs/activate/targetActivate");
-        assertNodeExists("/libs/msm/wcm/rolloutconfigs/activate/targetNewActivate");
-
-        // check if the only node is removed
-        assertNodeMissing("/libs/msm/wcm/rolloutconfigs/deactivate/targetDeactivate");
-    }
-
-    @Test
-    public void testMandatoryNonResidualChildNodesReplace() throws ItemExistsException, PathNotFoundException, NoSuchNodeTypeException, LockException, VersionException, ConstraintViolationException, RepositoryException, IOException, PackageException {
-        Node testnode = admin.getRootNode().addNode("testroot", NodeType.NT_FILE); // mandatory child node: jcr:content
-        try {
-            admin.save();
-            Assert.fail("Saving a node with a missing mandatory (but non-residual) child node must fail");
-        } catch (ConstraintViolationException e) {
-            // expected
-        }
-        testnode.addNode("jcr:content", "nt:unstructured"); 
-        admin.save();
-        
-        assertNodeExists("/testroot/jcr:content");
-        
-        // package tries to delete mandatory child node
-        try {
-            extractVaultPackage("/test-packages/mandatory-non-residual-childnode.zip");
-            Assert.fail("Deleting mandatory (but non-residual) child node must fail");
-        } catch (ConstraintViolationException e) {
-            // expected
-            admin.refresh(false);
-        }
-        assertNodeExists("/testroot/jcr:content");
-    }
-}
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ManifestCreationExportIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ManifestCreationExportIT.java
deleted file mode 100644
index 70764181..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ManifestCreationExportIT.java
+++ /dev/null
@@ -1,76 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.File;
-import java.io.IOException;
-import java.util.Collections;
-import java.util.Properties;
-
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.vault.fs.api.PathFilterSet;
-import org.apache.jackrabbit.vault.fs.config.DefaultMetaInf;
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.apache.jackrabbit.vault.packaging.ExportOptions;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.VaultPackage;
-import org.junit.Test;
-
-import static org.junit.Assert.assertNotNull;
-
-public class ManifestCreationExportIT extends IntegrationTestBase {
-
-    @Test
-    public void exportPackageCreatesManifest() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_foo_bar_test.zip"), false);
-        assertNotNull(pack);
-        pack.extract(getDefaultOptions());
-        assertNodeExists("/tmp/foo/bar/test.txt");
-
-        ExportOptions opts = new ExportOptions();
-        DefaultMetaInf inf = new DefaultMetaInf();
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/tmp/foo/bar"));
-        filter.add(new PathFilterSet("/tmp/foo/zoo"));
-        inf.setFilter(filter);
-        Properties props = new Properties();
-        props.setProperty(VaultPackage.NAME_GROUP, "jackrabbit/test");
-        props.setProperty(VaultPackage.NAME_NAME, "test-package");
-        props.setProperty(VaultPackage.NAME_DESCRIPTION, "This is a test package.");
-        props.setProperty(VaultPackage.NAME_DEPENDENCIES, "foo:bar:[1.0,2.0)");
-        inf.setProperties(props);
-
-        opts.setMetaInf(inf);
-        File tmpFile = File.createTempFile("e-vaulttest", ".zip");
-        try (VaultPackage pkg = packMgr.assemble(admin, opts, tmpFile)) {
-            String expected =
-                    "Content-Package-Dependencies:foo:bar:[1.0,2.0)\n" +
-                    "Content-Package-Description:This is a test package.\n" +
-                    "Content-Package-Id:jackrabbit/test:test-package\n" +
-                    "Content-Package-Roots:/tmp/foo/bar,/tmp/foo/zoo\n" +
-                    "Content-Package-Type:content\n" +
-                    "Manifest-Version:1.0";
-            verifyManifest(tmpFile, Collections.<String>emptySet(), expected);
-        } finally {
-            tmpFile.delete();
-        }
-    }
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/MappedExportIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/MappedExportIT.java
deleted file mode 100644
index c06b8fdc..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/MappedExportIT.java
+++ /dev/null
@@ -1,72 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.File;
-import java.io.IOException;
-import java.util.Properties;
-
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.vault.fs.api.PathFilterSet;
-import org.apache.jackrabbit.vault.fs.api.WorkspaceFilter;
-import org.apache.jackrabbit.vault.fs.config.DefaultMetaInf;
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.apache.jackrabbit.vault.packaging.ExportOptions;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.VaultPackage;
-import org.junit.Test;
-
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.assertTrue;
-
-public class MappedExportIT extends IntegrationTestBase {
-
-    @Test
-    public void exportMapped() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_foo_bar_test.zip"), false);
-        assertNotNull(pack);
-        pack.extract(getDefaultOptions());
-        assertNodeExists("/tmp/foo/bar/test.txt");
-
-        ExportOptions opts = new ExportOptions();
-        DefaultMetaInf inf = new DefaultMetaInf();
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/tmp/foo/bar"));
-        inf.setFilter(filter);
-        Properties props = new Properties();
-        props.setProperty(VaultPackage.NAME_GROUP, "jackrabbit/test");
-        props.setProperty(VaultPackage.NAME_NAME, "test-package");
-        inf.setProperties(props);
-
-        opts.setMetaInf(inf);
-        opts.setMountPath("/tmp/foo");
-        opts.setRootPath("/content/geometrixx");
-        File tmpFile = File.createTempFile("vaulttest", "zip");
-        VaultPackage pkg = packMgr.assemble(admin, opts, tmpFile);
-
-        // check if entries are present
-        WorkspaceFilter newFilter = pkg.getMetaInf().getFilter();
-        assertTrue(newFilter.contains("/content/geometrixx/bar/test.txt"));
-        assertNotNull(pkg.getArchive().getEntry("jcr_root/content/geometrixx/bar/test.txt"));
-        pkg.close();
-        tmpFile.delete();
-    }
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/MappedImportIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/MappedImportIT.java
deleted file mode 100644
index 8e6a81f7..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/MappedImportIT.java
+++ /dev/null
@@ -1,207 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.IOException;
-
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.vault.fs.api.MultiPathMapping;
-import org.apache.jackrabbit.vault.fs.api.RegexpPathMapping;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.PackageId;
-import org.junit.Ignore;
-import org.junit.Test;
-
-import static org.junit.Assert.assertNotNull;
-
-/**
- */
-public class MappedImportIT extends IntegrationTestBase {
-
-    @Test
-    public void testSimple() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_foo.zip"), false);
-        ImportOptions opts = getDefaultOptions();
-
-        MultiPathMapping mapping = new MultiPathMapping();
-        mapping.link("/tmp/foo", "/tmp/mapped");
-        opts.setPathMapping(mapping);
-        pack.extract(opts);
-
-        assertNodeMissing("/tmp/foo");
-        assertNodeExists("/tmp/mapped");
-    }
-
-    /**
-     * Tests if uninstalling a remapped package works
-     */
-    @Ignore("JCRVLT-80")
-    @Test
-    public void testSimpleUninstall() throws RepositoryException, IOException, PackageException {
-        assertNodeMissing("/tmp/foo");
-        assertNodeMissing("/tmp/mapped");
-
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_foo.zip"), false);
-        PackageId id = pack.getDefinition().getId();
-        ImportOptions opts = getDefaultOptions();
-
-        MultiPathMapping mapping = new MultiPathMapping();
-        mapping.link("/tmp/foo", "/tmp/mapped");
-        opts.setPathMapping(mapping);
-        pack.install(opts);
-        pack.close();
-
-        assertNodeMissing("/tmp/foo");
-        assertNodeExists("/tmp/mapped");
-
-        pack = packMgr.open(id);
-        pack.uninstall(getDefaultOptions());
-        assertNodeMissing("/tmp/foo");
-        assertNodeMissing("/tmp/mapped");
-    }
-
-    /**
-     * Tests if installing the same package at multiple places works
-     */
-    @Test
-    public void testMultiInstall() throws RepositoryException, IOException, PackageException {
-        assertNodeMissing("/tmp/foo");
-        assertNodeMissing("/tmp/mapped0");
-        assertNodeMissing("/tmp/mapped1");
-
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_foo.zip"), false);
-        PackageId id = pack.getDefinition().getId();
-        ImportOptions opts = getDefaultOptions();
-
-        MultiPathMapping mapping = new MultiPathMapping();
-        mapping.link("/tmp/foo", "/tmp/mapped0");
-        opts.setPathMapping(mapping);
-        pack.install(opts);
-        pack.close();
-
-        assertNodeMissing("/tmp/foo");
-        assertNodeExists("/tmp/mapped0");
-
-        pack = packMgr.open(id);
-        opts = getDefaultOptions();
-        mapping = new MultiPathMapping();
-        mapping.link("/tmp/foo", "/tmp/mapped1");
-        opts.setPathMapping(mapping);
-        pack.install(opts);
-        pack.close();
-
-        assertNodeMissing("/tmp/foo");
-        assertNodeExists("/tmp/mapped1");
-
-    }
-
-    @Test
-    public void testSimpleDelete() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_foo.zip"), false);
-        ImportOptions opts = getDefaultOptions();
-
-        MultiPathMapping mapping = new MultiPathMapping();
-        mapping.link("/tmp/foo", "/tmp/mapped");
-        opts.setPathMapping(mapping);
-        pack.extract(opts);
-
-        assertNodeMissing("/tmp/foo");
-        assertNodeExists("/tmp/mapped");
-
-        pack = packMgr.upload(getStream("/test-packages/empty_tmp_foo.zip"), false);
-        pack.extract(opts);
-
-        assertNodeMissing("/tmp/mapped");
-    }
-
-    /**
-     * Tests if remapping within a generic artifact works.
-     * This is currently not implemented.
-     */
-    @Ignore("JCRVLT-79")
-    @Test
-    public void testGenericArtifact() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/fullcoverage.zip"), false);
-        ImportOptions opts = getDefaultOptions();
-
-        MultiPathMapping mapping = new MultiPathMapping();
-        mapping.link("/tmp/fullcoverage/a", "/tmp/fullcoverage/mapped");
-        opts.setPathMapping(mapping);
-        pack.extract(opts);
-
-        assertNodeMissing("/tmp/fullcoverage/a");
-        assertNodeExists("/tmp/fullcoverage/mapped");
-    }
-
-    @Test
-    public void testNested() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_foo.zip"), false);
-        ImportOptions opts = getDefaultOptions();
-
-        MultiPathMapping mapping = new MultiPathMapping();
-        mapping.link("/tmp/foo", "/tmp/mapped");
-        mapping.link("/tmp/mapped/bar/tobi", "/tmp/mapped/bar/roby");
-        opts.setPathMapping(mapping);
-        pack.extract(opts);
-
-        assertNodeMissing("/tmp/mapped/bar/tobi");
-        assertNodeExists("/tmp/mapped/bar/roby");
-    }
-
-    /**
-     * Tests if a non-trivial rename remapping works.
-     * This is currently not supported
-     */
-    @Test
-    public void testNonRename() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_foo.zip"), false);
-        ImportOptions opts = getDefaultOptions();
-
-        MultiPathMapping mapping = new MultiPathMapping();
-        mapping.link("/tmp/foo", "/libs/foo");
-        opts.setPathMapping(mapping);
-        pack.extract(opts);
-
-        assertNodeMissing("/tmp/foo");
-        assertNodeExists("/libs/foo");
-    }
-
-    /**
-     * Tests if regexp remap works
-     */
-    @Test
-    public void  testInstallWithRegexp() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_version.zip"), false);
-        assertNotNull(pack);
-
-        ImportOptions opts = getDefaultOptions();
-        RegexpPathMapping pathMapping = new RegexpPathMapping();
-        pathMapping.addMapping("/testroot/(.*)", "/root/$1");
-        opts.setPathMapping(pathMapping);
-
-        pack.install(opts);
-
-        assertNodeExists("/root/a");
-        assertNodeMissing("/testroot/a");
-    }
-
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/NamespaceImportIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/NamespaceImportIT.java
deleted file mode 100644
index 8a52e268..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/NamespaceImportIT.java
+++ /dev/null
@@ -1,234 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertNotEquals;
-import static org.junit.Assert.assertNotNull;
-
-import java.io.File;
-import java.io.IOException;
-import java.util.Properties;
-
-import javax.jcr.NamespaceException;
-import javax.jcr.NamespaceRegistry;
-import javax.jcr.Node;
-import javax.jcr.Repository;
-import javax.jcr.RepositoryException;
-import javax.jcr.Session;
-import javax.jcr.SimpleCredentials;
-
-import org.apache.jackrabbit.api.JackrabbitRepository;
-import org.apache.jackrabbit.oak.jcr.Jcr;
-import org.apache.jackrabbit.vault.fs.api.PathFilterSet;
-import org.apache.jackrabbit.vault.fs.config.DefaultMetaInf;
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.apache.jackrabbit.vault.fs.io.Archive;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.packaging.ExportOptions;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.VaultPackage;
-import org.apache.jackrabbit.vault.packaging.impl.JcrPackageManagerImpl;
-import org.junit.After;
-import org.junit.Before;
-import org.junit.Test;
-
-/**
- * Tests namespace aware node/property imports
- */
-public class NamespaceImportIT extends IntegrationTestBase {
-
-    private final static String PREFIX = "prefix";
-
-    private final static String URI1 = "http://one.namespace.io";
-
-    private final static String URI2 = "http://two.namespace.io";
-
-    private Instance sourceOakRepository;
-
-    @Before
-    public void setUp() throws Exception {
-        sourceOakRepository = new Instance(); // source instance
-
-        // Register namespaces with same prefix but different URIs
-        // on different instances
-        sourceOakRepository.registerNamespace(PREFIX, URI1);
-        super.setUp();
-        NamespaceRegistry nsRegistry = admin.getWorkspace().getNamespaceRegistry();
-        try {
-            if (URI1.equals(nsRegistry.getURI(PREFIX))) {
-                throw new IllegalStateException("prefix already registered for a different uri");
-            }
-        } catch (NamespaceException e) {
-            nsRegistry.registerNamespace(PREFIX, URI2);
-        }
-    }
-
-    @After
-    public void tearDown() throws Exception {
-        sourceOakRepository.admin.logout();
-        if (sourceOakRepository.repository instanceof JackrabbitRepository) {
-            JackrabbitRepository.class.cast(sourceOakRepository.repository).shutdown();
-        }
-        super.tearDown();
-    }
-
-    @Test
-    public void importClashingNamespace() throws RepositoryException, IOException, PackageException {
-
-        // Set a property with the namespace prefix on instance i1
-        sourceOakRepository.getRootNode().addNode("tmp").setProperty("{" + URI1 + "}prop1", "value1");
-        sourceOakRepository.admin.save();
-
-        // Export the property from instance i1 in a content package archive
-
-        ExportOptions opts = new ExportOptions();
-        DefaultMetaInf inf = new DefaultMetaInf();
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/tmp"));
-        inf.setFilter(filter);
-        Properties props = new Properties();
-        props.setProperty(VaultPackage.NAME_GROUP, "jackrabbit/test");
-        props.setProperty(VaultPackage.NAME_NAME, "test-package");
-        inf.setProperties(props);
-        opts.setMetaInf(inf);
-
-        File tmpFile = File.createTempFile("vaulttest", "zip");
-        try (VaultPackage pkg = sourceOakRepository.packMgr.assemble(sourceOakRepository.admin, opts, tmpFile)) {
-            Archive archive = pkg.getArchive();
-
-            // Import the archive in the target repo, with strict mode enabled
-            ImportOptions io = new ImportOptions();
-            io.setStrict(true);
-            packMgr.extract(archive, io, true);
-
-            assertEquals(admin.getRootNode().getNode("tmp").getProperty("{" + URI1 + "}prop1").getString(), "value1");
-        } finally {
-            tmpFile.delete();
-        }
-    }
-
-    @Test
-    public void importClashingNamespaceOnPath() throws RepositoryException, IOException, PackageException {
-
-        // Set a property with the namespace prefix on instance i1
-        sourceOakRepository.getRootNode().addNode("tmp").addNode("{" + URI1 + "}node1").setProperty("test", "value1");
-        sourceOakRepository.admin.save();
-
-        // Export the property from instance i1 in a content package archive
-
-        ExportOptions opts = new ExportOptions();
-        DefaultMetaInf inf = new DefaultMetaInf();
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/tmp"));
-        inf.setFilter(filter);
-        Properties props = new Properties();
-        props.setProperty(VaultPackage.NAME_GROUP, "jackrabbit/test");
-        props.setProperty(VaultPackage.NAME_NAME, "test-package");
-        inf.setProperties(props);
-        opts.setMetaInf(inf);
-
-        File tmpFile = File.createTempFile("vaulttest", "zip");
-        try (VaultPackage pkg = sourceOakRepository.packMgr.assemble(sourceOakRepository.admin, opts, tmpFile)) {
-            Archive archive = pkg.getArchive();
-
-            // Import the archive in another instance with strict mode enabled
-            ImportOptions io = new ImportOptions();
-            io.setStrict(true);
-            packMgr.extract(archive, io, true);
-
-            assertEquals(admin.getRootNode().getProperty("tmp/{" + URI1 + "}node1/test").getString(), "value1");
-
-            Session admin2 = repository.login(new SimpleCredentials("admin", "admin".toCharArray()));
-            assertNotEquals(PREFIX, admin2.getNamespacePrefix(URI1));
-            admin2.logout();
-        } finally {
-            tmpFile.delete();
-        }
-    }
-
-    @Test
-    public void importUndeclaredNamespaceOnDocViewPath() throws IOException, PackageException, RepositoryException {
-        // namespace declared in package but not in affected docview file
-        try (VaultPackage pkg = extractVaultPackageStrict("/test-packages/namespace.zip")) {
-            assertNotNull(pkg);
-        }
-    }
-
-    @Test
-    public void testBadNamespaceNames() throws RepositoryException, IOException, PackageException {
-        extractVaultPackageStrict("/test-packages/badnamespacenames.zip");
-
-        // Check that after the import, the session used for the import has
-        // namepace mapping for the namespaced items being imported
-        String prefixFoo = admin.getNamespacePrefix("name_foo");
-        assertNotNull(prefixFoo);
-        String prefixBar = admin.getNamespacePrefix("name_bar");
-        assertNotNull(prefixBar);
-        String prefixQux = admin.getNamespacePrefix("name_qux");
-        assertNotNull(prefixQux);
-
-        // assert node were created, checking the qualified name syntax
-        assertNodeExists("/tmp/badnamespacenames/" + prefixFoo + ":child");
-        assertNodeExists("/tmp/badnamespacenames/" + prefixFoo + ":child/" + prefixBar + ":child");
-        assertProperty("/tmp/badnamespacenames/" + prefixFoo + ":child/" + prefixBar + ":child/" + prefixQux + ":someproperty", "xyz");
-
-        // retry with a fresh session and explicitly set namespace mappings
-        Session secondSession = admin.impersonate(new SimpleCredentials("admin", "admin".toCharArray()));
-        try {
-            secondSession.setNamespacePrefix("t_foo", "name_foo");
-            secondSession.setNamespacePrefix("t_bar", "name_bar");
-            secondSession.setNamespacePrefix("t_qux", "name_qux");
-
-            Node n1 = secondSession.getNode("/tmp/badnamespacenames/t_foo:child");
-            Node n2 = n1.getNode("t_bar:child");
-            n2.getProperty("t_qux:someproperty");
-        }
-        finally {
-            secondSession.logout();
-        }
-    }
-
-    /** Simple Oak repository wrapper */
-    private static final class Instance {
-
-        final Repository repository;
-
-        Session admin;
-
-        final JcrPackageManagerImpl packMgr;
-
-        private Instance()
-                throws RepositoryException {
-            repository = new Jcr().createRepository();
-            admin = repository.login(new SimpleCredentials("admin", "admin".toCharArray()));
-            packMgr = new JcrPackageManagerImpl(admin, new String[0]);
-        }
-
-        Node getRootNode()
-                throws RepositoryException {
-            return admin.getRootNode();
-        }
-
-        void registerNamespace(String prefix, String uri)
-                throws RepositoryException {
-            admin.getWorkspace().getNamespaceRegistry().registerNamespace(prefix, uri);
-        }
-
-    }
-
-}
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/NoRootAccessExportIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/NoRootAccessExportIT.java
deleted file mode 100644
index 90717f32..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/NoRootAccessExportIT.java
+++ /dev/null
@@ -1,77 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.IOException;
-
-import javax.jcr.GuestCredentials;
-import javax.jcr.Node;
-import javax.jcr.RepositoryException;
-import javax.jcr.Session;
-import javax.jcr.security.AccessControlManager;
-import javax.jcr.security.Privilege;
-
-import org.apache.jackrabbit.api.security.JackrabbitAccessControlList;
-import org.apache.jackrabbit.commons.jackrabbit.authorization.AccessControlUtils;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.PackageId;
-import org.apache.jackrabbit.vault.packaging.impl.JcrPackageManagerImpl;
-import org.junit.Ignore;
-import org.junit.Test;
-
-import static org.junit.Assert.assertNotNull;
-
-/**
- * Test export w/o read access to the root node
- */
-public class NoRootAccessExportIT extends IntegrationTestBase {
-
-    @Test
-    @Ignore("JCRVLT-100")
-    public void exportNoRootAccess() throws RepositoryException, IOException, PackageException {
-        // setup access control
-        Node packageRoot = new JcrPackageManagerImpl(admin, new String[0]).getPackageRoot();
-        AccessControlManager acMgr = admin.getAccessControlManager();
-        JackrabbitAccessControlList acl = AccessControlUtils.getAccessControlList(acMgr, "/");
-        acMgr.removePolicy(acl.getPath(), acl);
-
-        AccessControlUtils.getAccessControlList(acMgr, packageRoot.getPath());
-        AccessControlUtils.allow(packageRoot, org.apache.jackrabbit.oak.spi.security.principal.EveryonePrincipal.NAME, Privilege.JCR_ALL);
-
-        Node tmpNode = new JcrPackageManagerImpl(admin, new String[0]).getPackageRoot();
-        AccessControlUtils.getAccessControlList(acMgr, tmpNode.getPath());
-        AccessControlUtils.allow(tmpNode, org.apache.jackrabbit.oak.spi.security.principal.EveryonePrincipal.NAME, Privilege.JCR_ALL);
-
-        admin.save();
-
-        // import existing package
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_foo_bar_test.zip"), false);
-        PackageId id = pack.getDefinition().getId();
-        assertNotNull(pack);
-        pack.extract(getDefaultOptions());
-        assertNodeExists("/tmp/foo/bar/test.txt");
-
-        // login as guest an
-        Session anonymous = repository.login(new GuestCredentials());
-        JcrPackageManagerImpl jcrPackageManager = new JcrPackageManagerImpl(anonymous, new String[0]);
-        pack = jcrPackageManager.open(id);
-        jcrPackageManager.assemble(pack, null);
-    }
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/NodeStashingIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/NodeStashingIT.java
deleted file mode 100644
index 1b7d0292..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/NodeStashingIT.java
+++ /dev/null
@@ -1,107 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import static org.junit.Assert.assertNotEquals;
-import static org.junit.Assert.assertTrue;
-import static org.junit.Assume.assumeTrue;
-
-import java.io.IOException;
-import java.util.LinkedList;
-import java.util.List;
-
-import javax.jcr.Node;
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.vault.fs.api.ImportMode;
-import org.apache.jackrabbit.vault.fs.api.ProgressTrackerListener;
-import org.apache.jackrabbit.vault.fs.api.ProgressTrackerListener.Mode;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.junit.Test;
-
-public class NodeStashingIT extends IntegrationTestBase {
-
-    private static final String TESTNS = "https://issues.apache.org/jira/browse/JCRVLT-684";
-
-    @Test
-    public void testStashMixinMandatoryChildNodeModeReplace() throws RepositoryException, IOException, PackageException {
-        testStashMixinMandatoryChildNode(ImportMode.REPLACE);
-    }
-
-    @Test
-    public void testStashMixinMandatoryChildNodeModeMergeProperties() throws RepositoryException, IOException, PackageException {
-        testStashMixinMandatoryChildNode(ImportMode.MERGE_PROPERTIES);
-    }
-
-    private void testStashMixinMandatoryChildNode(ImportMode mode) throws RepositoryException, IOException, PackageException {
-
-        assumeTrue(isOak());
-
-        ImportOptions options = getDefaultOptions();
-        options.setImportMode(mode);
-
-        // import test structure from package
-        extractVaultPackage("/test-packages/stashing/create.zip", options);
-
-        assertNodeExists("/tmp/stash");
-        assertNodeExists("/tmp/stash/{" + TESTNS + "}mandatoryChildNode");
-
-        Node node1 = admin.getNode("/tmp/stash");
-        String id1 = node1.getIdentifier();
-        assertTrue(node1.isNodeType("{" + TESTNS + "}noChildNodes"));
-        assertTrue(node1.isNodeType("{" + TESTNS + "}hasMandatoryChildNode"));
-
-        // update same path but without mixin allowing child nodes and different
-        // UUID so that node stashing kicks in
-        Collector col = new Collector();
-        options.setListener(col);
-
-        extractVaultPackage("/test-packages/stashing/update.zip", options);
-
-        // child node should be retained
-        assertNodeExists("/tmp/stash");
-        assertNodeExists("/tmp/stash/{" + TESTNS + "}mandatoryChildNode");
-
-        Node node2 = admin.getNode("/tmp/stash");
-        String id2 = node2.getIdentifier();
-
-        // make sure it's really the new node
-        assertNotEquals("imported node should have different identifier", id1, id2);
-
-        // make sure mixin type was restored
-        assertTrue(node2.isNodeType("{" + TESTNS + "}hasMandatoryChildNode"));
-
-        // before JCRVLT-697, this would have been only one node
-        String expected = "saving approx 3 nodes...";
-        assertTrue("Expected message '" + expected + "' not seen in: " + col.actions, col.actions.contains(expected));
-    }
-
-    private static class Collector implements ProgressTrackerListener {
-        private final List<String> actions = new LinkedList<>();
-
-        public void onMessage(Mode mode, String action, String path) {
-            if (Mode.PATHS == mode) {
-                actions.add(action);
-            }
-        }
-
-        public void onError(Mode mode, String path, Exception e) {
-        }
-    }
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/NotWellFormedDocViewXmlsIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/NotWellFormedDocViewXmlsIT.java
deleted file mode 100644
index 896a4648..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/NotWellFormedDocViewXmlsIT.java
+++ /dev/null
@@ -1,98 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertTrue;
-
-import java.util.HashMap;
-import java.util.Map;
-import java.util.Map.Entry;
-
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.vault.fs.api.ProgressTrackerListener;
-import org.apache.jackrabbit.vault.fs.io.DocViewParser.XmlParseException;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.junit.Test;
-
-/**
- * Tests how importing not well-formed DocView XMLs behaves
- */
-public class NotWellFormedDocViewXmlsIT extends IntegrationTestBase {
-
-    @Override
-    public void tearDown() throws Exception {
-        try {
-            if (admin.nodeExists("/testroot")) {
-                admin.getNode("/testroot").remove();
-                admin.save();
-            }
-        } finally {
-            super.tearDown();
-        }
-    }
-
-    @Test
-    public void testHandlingTruncatedContentXMLWithNonStrictMode() throws Exception {
-        assertNodeMissing("/testroot");
-        ImportOptions options = getDefaultOptions();
-        options.setStrict(false);
-        CapturingProgressTrackerListener listener = new CapturingProgressTrackerListener();
-        options.setListener(listener);
-        extractVaultPackage("/test-packages/xml-nwf-truncated.zip", options);
-        assertNodeExists("/testroot");
-        assertEquals(1, listener.getErrorMap().size());
-        Entry<String, Exception> firstEntry = listener.getErrorMap().entrySet().iterator().next();
-        assertTrue(firstEntry.getValue() instanceof XmlParseException);
-        assertEquals("/", firstEntry.getKey());
-    }
-
-    static final class CapturingProgressTrackerListener implements ProgressTrackerListener {
-
-        private final Map<String, Exception> errorMap;
-        public CapturingProgressTrackerListener() {
-            errorMap = new HashMap<>();
-        }
-        @Override
-        public void onMessage(Mode mode, String action, String path) {
-            // ignore regular messages
-        }
-
-        @Override
-        public void onError(Mode mode, String path, Exception e) {
-            errorMap.put(path, e);
-        }
-
-        public Map<String, Exception> getErrorMap() {
-            return errorMap;
-        }
-    }
-
-    @Test
-    public void testHandlingTruncatedContentXMLWithStrictMode() throws Exception {
-        assertNodeMissing("/testroot");
-        try {
-            ImportOptions options = getDefaultOptions();
-            options.setStrict(true);
-            extractVaultPackage("/test-packages/xml-nwf-truncated.zip", options);
-        } catch (RepositoryException expected) {
-            // expected
-        }
-        assertNodeMissing("/testroot");
-    }
-}
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/PackageCreationIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/PackageCreationIT.java
deleted file mode 100644
index be199ceb..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/PackageCreationIT.java
+++ /dev/null
@@ -1,108 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.IOException;
-
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.PackageId;
-import org.junit.Test;
-
-import static org.junit.Assert.fail;
-
-public class PackageCreationIT extends IntegrationTestBase {
-
-    public static String[] GROUP_NAMES = {"foo", "foo-zoo", "foo.zoo", "jcr:foo", "foo/zoo"};
-    public static String[] ILLEGAL_GROUP_NAMES = {"foo ", " foo", ":foo"};
-
-    public static String[] PACKAGE_NAMES = {"bar", "bar.zar", "bar-zar", "jcr:bar"};
-    public static String[] ILLEGAL_PACKAGE_NAMES = {"bar ", " bar", ":bar", "jcr/bar"};
-
-    public static String[] ILLEGAL_VERSION_NAMES = {"1.0 ", " 1.0", ":1.0", "jcr:1.0", "1/0"};
-
-    @Test
-    public void testCreateGroup() throws RepositoryException, IOException, PackageException {
-        for (String name: GROUP_NAMES) {
-            packMgr.create(name, "bar");
-            assertPackageNodeExists(new PackageId(name, "bar", ""));
-        }
-    }
-
-    @Test
-    public void testCreate() throws RepositoryException, IOException, PackageException {
-        for (String name: PACKAGE_NAMES) {
-            packMgr.create("foo", name);
-            assertPackageNodeExists(new PackageId("foo", name, ""));
-        }
-    }
-
-    @Test
-    public void testCreateWithVersion() throws RepositoryException, IOException, PackageException {
-        packMgr.create("foo", "bar", "3.1.2");
-        assertPackageNodeExists(new PackageId("foo", "bar", "3.1.2"));
-    }
-
-    @Test
-    public void testCreateIllegalGroup() throws RepositoryException, IOException, PackageException {
-        for (String name: ILLEGAL_GROUP_NAMES) {
-            try {
-                packMgr.create(name, "bar", "3.1.2");
-                fail("Illegal group name must fail: " + name);
-            } catch (RepositoryException e) {
-                // ok
-            }
-        }
-    }
-
-    @Test
-    public void testCreateIllegalName() throws RepositoryException, IOException, PackageException {
-        for (String name: ILLEGAL_PACKAGE_NAMES) {
-            try {
-                packMgr.create("foo", name, "3.1.2");
-                fail("Illegal package name must fail: " + name);
-            } catch (RepositoryException e) {
-                // ok
-            }
-        }
-    }
-
-    @Test
-    public void testCreateIllegalVersions() throws RepositoryException, IOException, PackageException {
-        for (String name: ILLEGAL_VERSION_NAMES) {
-            try {
-                packMgr.create("foo", "bar", name);
-                fail("Illegal version must fail: " + name);
-            } catch (RepositoryException e) {
-                // ok
-            }
-        }
-    }
-
-    @Test
-    public void testUploadIllegal() throws RepositoryException, IOException, PackageException {
-        try {
-            packMgr.upload(getStream("/test-packages/tmp_illegal.zip"), false);
-            fail("Uploading a package with an illegal name must fail.");
-        } catch (RepositoryException e) {
-            // ok
-        }
-    }
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/PackageInstallIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/PackageInstallIT.java
deleted file mode 100644
index 99306f1f..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/PackageInstallIT.java
+++ /dev/null
@@ -1,884 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import static org.apache.jackrabbit.vault.packaging.JcrPackageDefinition.PN_DEPENDENCIES;
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertFalse;
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.assertTrue;
-import static org.junit.Assert.fail;
-
-import java.io.File;
-import java.io.IOException;
-import java.security.Principal;
-import java.util.Collections;
-import java.util.Properties;
-
-import javax.jcr.NodeIterator;
-import javax.jcr.Property;
-import javax.jcr.PropertyType;
-import javax.jcr.RepositoryException;
-import javax.jcr.Session;
-import javax.jcr.SimpleCredentials;
-import javax.jcr.Value;
-import javax.jcr.nodetype.NodeType;
-
-import org.apache.commons.io.IOUtils;
-import org.apache.jackrabbit.api.JackrabbitSession;
-import org.apache.jackrabbit.api.security.user.User;
-import org.apache.jackrabbit.api.security.user.UserManager;
-import org.apache.jackrabbit.commons.jackrabbit.authorization.AccessControlUtils;
-import org.apache.jackrabbit.vault.fs.api.IdConflictPolicy;
-import org.apache.jackrabbit.vault.fs.config.ConfigurationException;
-import org.apache.jackrabbit.vault.fs.config.DefaultMetaInf;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.packaging.Dependency;
-import org.apache.jackrabbit.vault.packaging.ExportOptions;
-import org.apache.jackrabbit.vault.packaging.InstallContext;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.PackageId;
-import org.apache.jackrabbit.vault.packaging.VaultPackage;
-import org.apache.jackrabbit.vault.packaging.events.impl.PackageEventDispatcherImpl;
-import org.apache.jackrabbit.vault.packaging.impl.ActivityLog;
-import org.apache.jackrabbit.vault.packaging.impl.JcrPackageManagerImpl;
-import org.apache.jackrabbit.vault.packaging.registry.impl.JcrPackageRegistry;
-import org.apache.jackrabbit.vault.packaging.registry.impl.JcrRegisteredPackage;
-import org.junit.Assume;
-import org.junit.Ignore;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.rules.ExpectedException;
-
-/**
- * {@code PackageInstallIT}...
- */
-public class PackageInstallIT extends IntegrationTestBase {
-
-    @Rule
-    public ExpectedException thrown = ExpectedException.none();
-
-    /**
-     * Installs a package that contains and checks if everything is correct.
-     */
-    @Test
-    public void testUpload() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp.zip"), false);
-        assertNotNull(pack);
-        assertPackageNodeExists(TMP_PACKAGE_ID);
-
-        // upload already unwraps it, so check if definition is ok
-        assertNodeExists(getInstallationPath(TMP_PACKAGE_ID) + "/jcr:content/vlt:definition");
-
-        // todo: check definition props
-
-    }
-
-    /**
-     * Test if rewrap of a small package works
-     */
-    @Test
-    public void testRewrap() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp.zip"), false);
-        assertNotNull(pack);
-
-        ImportOptions opts = getDefaultOptions();
-        pack.install(opts);
-
-        packMgr.rewrap(pack, opts.getListener());
-    }
-
-    /**
-     * Test if rewrap on a folder-based package works
-     */
-    @Test
-    public void testRewrapOnNonZipBasedArchive() throws RepositoryException, IOException, PackageException {
-        try (VaultPackage pack = loadVaultPackage("/test-packages/tmp.zip")) {
-            ExportOptions opts = new ExportOptions();
-            DefaultMetaInf meta = new DefaultMetaInf();
-            Properties props = new Properties();
-            props.setProperty(VaultPackage.NAME_GROUP, "jackrabbit/test");
-            props.setProperty(VaultPackage.NAME_NAME, "rewrapped-package");
-            meta.setProperties(props);
-            opts.setMetaInf(meta);
-            try (VaultPackage rewrappedPack = packMgr.rewrap(opts, pack, (File)null)) {
-                assertNotNull(rewrappedPack);
-            }
-        }
-    }
-
-    /**
-     * Tests if uploading an already installed package preserves the status
-     */
-    @Test
-    public void testUploadPreserveInstallStatus() throws RepositoryException, IOException, PackageException {
-
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp.zip"), true, true);
-        assertNotNull(pack);
-        assertTrue(pack.isValid());
-        assertPackageNodeExists(TMP_PACKAGE_ID);
-        pack.install(getDefaultOptions());
-        assertNodeExists("/tmp/foo");
-
-        long lastUnpacked = pack.getDefinition().getLastUnpacked().getTimeInMillis();
-        assertTrue(lastUnpacked > 0);
-
-        // now upload again, but don't install
-        pack = packMgr.upload(getStream("/test-packages/tmp.zip"), true, true);
-        assertNotNull(pack);
-        PackageId pkgId = pack.getDefinition().getId();
-        assertTrue(pack.isValid());
-        // installation status must be kept
-        assertTrue(pack.isInstalled());
-        assertEquals(lastUnpacked, pack.getDefinition().getLastUnpacked().getTimeInMillis());
-
-        // now re-acquire package and test again
-        pack = packMgr.open(pkgId);
-        assertTrue(pack.isValid());
-        assertTrue(pack.isInstalled());
-        assertEquals(lastUnpacked, pack.getDefinition().getLastUnpacked().getTimeInMillis());
-
-        // a package with a different created date should not preserve the status!
-        pack = packMgr.upload(getStream("/test-packages/tmp_with_modified_created_date.zip"), true, true);
-        assertNotNull(pack);
-        assertTrue(pack.isValid());
-        assertFalse(pack.isInstalled());
-    }
-
-    /**
-     * Tests if uploading an already installed SNAPSHOT version package drops the status
-     */
-    @Test
-    public void testUploadDropInstallStatusForSnapshots() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/simple-snapshot-version.zip"), true, true);
-        assertNotNull(pack);
-        assertTrue(pack.isValid());
-        pack.install(getDefaultOptions());
-        assertTrue(pack.isInstalled());
-        long lastUnpacked = pack.getDefinition().getLastUnpacked().getTimeInMillis();
-        assertTrue(lastUnpacked > 0);
-
-        // now upload again, but don't install
-        pack = packMgr.upload(getStream("/test-packages/simple-snapshot-version.zip"), true, true);
-        assertNotNull(pack);
-        assertTrue(pack.isValid());
-        // installation status must not be kept
-        assertFalse(pack.isInstalled());
-    }
-
-    /**
-     * Installs a package that contains and checks if everything is correct.
-     */
-    @Test
-    public void testUploadWithThumbnail() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_with_thumbnail.zip"), false);
-        assertNotNull(pack);
-        assertPackageNodeExists(TMP_PACKAGE_ID);
-
-        // upload already unrwapps it, so check if definition is ok
-        assertNodeExists(getInstallationPath(TMP_PACKAGE_ID) + "/jcr:content/vlt:definition/thumbnail.png");
-    }
-
-    /**
-     * Installs a package that contains /tmp/fullcoverage/a/aa using a vlt:FullCoverage mixin.
-     * check if the package manager installs that node type although not present in the package.
-     */
-    @Test
-    public void testFullCoverageNT() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/fullcoverage.zip"), false);
-        assertNotNull(pack);
-
-        // just extract - no snapshots
-        pack.extract(getDefaultOptions());
-        assertNodeExists("/tmp/fullcoverage/a/aa");
-
-        admin.getWorkspace().getNodeTypeManager().getNodeType("vlt:FullCoverage");
-    }
-
-    /**
-     * Installs a package that contains a folder below a jcr:resource which is augmented by a
-     * mixin that should allow a sub folder.
-     */
-    @Test
-    public void testDeepMixin() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/deepmixintest.zip"), false);
-        assertNotNull(pack);
-
-        // just extract - no snapshots
-        pack.extract(getDefaultOptions());
-        assertNodeExists("/etc/designs/apache/images/backgroundImage.png/jcr:content/dam:thumbnails/dam:thumbnail_48.png");
-    }
-
-    /**
-     * Installs a package that contains a folder a filter to a jcr:content[nt:unstructured] node.
-     * See bug #42562
-     */
-    @Test
-    public void testJcrContent() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_testpage_jcr_content.zip"), false);
-        assertNotNull(pack);
-
-        // just extract - no snapshots
-        pack.extract(getDefaultOptions());
-        assertNodeExists("/tmp/testpage/jcr:content/foo");
-    }
-
-    /**
-     * Installs a package that just adds a property to the root node.
-     */
-    @Test
-    public void testRootImport() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/testrootimport.zip"), false);
-        assertNotNull(pack);
-
-        // just extract - no snapshots
-        pack.extract(getDefaultOptions());
-        assertProperty("/testproperty", "hello");
-    }
-
-    /**
-     * Installs a package with an install hook
-     */
-    @Test
-    public void testHook() throws RepositoryException, IOException, PackageException {
-        if (admin.nodeExists("/testroot")) {
-            admin.getNode("/testroot").remove();
-        }
-        admin.getRootNode().addNode("testroot", "nt:unstructured").addNode("testnode", "nt:unstructured");
-        admin.save();
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_hook.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-        assertTrue(admin.propertyExists("/testroot/hook-example"));
-    }
-
-    /**
-     * Installs a package with an install hook and a not allowed user
-     */
-    @Test
-    public void testHookWithNotAllowedNonAdminUser() throws RepositoryException, IOException, PackageException {
-        if (admin.nodeExists("/testroot")) {
-            admin.getNode("/testroot").remove();
-        }
-        admin.getRootNode().addNode("testroot", "nt:unstructured").addNode("testnode", "nt:unstructured");
-        admin.save();
-        
-        // Create test user
-        UserManager userManager = ((JackrabbitSession)admin).getUserManager();
-        String userId = "user1";
-        String userPwd = "pwd1";
-        User user1 = userManager.createUser(userId, userPwd);
-        Principal principal1 = user1.getPrincipal();
-        
-        // Setup test user ACLs that there are no restrictions
-        AccessControlUtils.addAccessControlEntry(admin, null, principal1, new String[]{"jcr:namespaceManagement","jcr:nodeTypeDefinitionManagement"}, true);
-        AccessControlUtils.addAccessControlEntry(admin, "/", principal1, new String[]{"jcr:all"}, true);
-        admin.save();
-        
-        Session userSession = repository.login(new SimpleCredentials(userId, userPwd.toCharArray()));
-        try {
-            packMgr = new JcrPackageManagerImpl(userSession, new String[0]);
-    
-            PackageEventDispatcherImpl dispatcher = new PackageEventDispatcherImpl();
-            dispatcher.bindPackageEventListener(new ActivityLog(), Collections.singletonMap("component.id", (Object) "1234"));
-            packMgr.setDispatcher(dispatcher);
-            
-            JcrPackage pack = packMgr.upload(getStream("/test-packages/test_hook.zip"), false);
-            assertNotNull(pack);
-            thrown.expect(PackageException.class);
-            thrown.expectMessage("Package extraction requires admin session as it has a hook");
-            packMgr.getInternalRegistry().installPackage(userSession, new JcrRegisteredPackage(pack), getDefaultOptions(), true);
-            
-        
-        } finally {
-            userSession.logout();
-        }
-    }
-
-    /**
-     * Installs a package with an install hook and an explicitly allowed user
-     */
-    @Test
-    public void testHookWithAllowedNonAdminUser() throws RepositoryException, IOException, PackageException {
-        if (admin.nodeExists("/testroot")) {
-            admin.getNode("/testroot").remove();
-        }
-        admin.getRootNode().addNode("testroot", "nt:unstructured").addNode("testnode", "nt:unstructured");
-        admin.save();
-        
-        // Create test user
-        UserManager userManager = ((JackrabbitSession)admin).getUserManager();
-        String userId = "user1";
-        String userPwd = "pwd1";
-        User user1 = userManager.createUser(userId, userPwd);
-        Principal principal1 = user1.getPrincipal();
-        
-        // Setup test user ACLs that there are no restrictions
-        AccessControlUtils.addAccessControlEntry(admin, null, principal1, new String[]{"jcr:namespaceManagement","jcr:nodeTypeDefinitionManagement"}, true);
-        AccessControlUtils.addAccessControlEntry(admin, "/", principal1, new String[]{"jcr:all"}, true);
-        admin.save();
-        
-        Session userSession = repository.login(new SimpleCredentials(userId, userPwd.toCharArray()));
-        try {
-            packMgr = new JcrPackageManagerImpl(userSession, new String[0], new String[] {"user1"}, null, false, true, IdConflictPolicy.FAIL);
-    
-            PackageEventDispatcherImpl dispatcher = new PackageEventDispatcherImpl();
-            dispatcher.bindPackageEventListener(new ActivityLog(), Collections.singletonMap("component.id", (Object) "1234"));
-            packMgr.setDispatcher(dispatcher);
-            
-            JcrPackage pack = packMgr.upload(getStream("/test-packages/test_hook.zip"), false);
-            assertNotNull(pack);
-            packMgr.getInternalRegistry().installPackage(userSession, new JcrRegisteredPackage(pack), getDefaultOptions(), true);
-            assertTrue(admin.propertyExists("/testroot/hook-example"));
-            
-        } finally {
-            userSession.logout();
-        }
-    }
-
-    /**
-     * Installs a package with an install hook
-     */
-    @Test
-    public void testHookFail() throws RepositoryException, IOException, PackageException {
-        if (admin.nodeExists("/testroot")) {
-            admin.getNode("/testroot").remove();
-        }
-        admin.save();
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_hook.zip"), false);
-        assertNotNull(pack);
-        try {
-            pack.install(getDefaultOptions());
-            fail("installing failing hook should fail");
-        } catch (PackageException e) {
-            // ok
-        }
-    }
-
-    /**
-     * Installs a package with an invalid hook
-     */
-    @Test
-    public void testInvalidHook() throws RepositoryException, IOException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/invalid_hook.zip"), false);
-        assertNotNull(pack);
-
-        try {
-            pack.install(getDefaultOptions());
-            fail("Package install should fail.");
-        } catch (PackageException e) {
-            // ok
-        }
-    }
-
-    /**
-     * Installs a package with an external hook
-     */
-    @Test
-    public void testExternalHook() throws RepositoryException, IOException, PackageException {
-        if (!admin.nodeExists("/testroot")) {
-            admin.getRootNode().addNode("testroot", "nt:unstructured");
-            admin.save();
-        }
-
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/external_hook.zip"), false);
-        assertNotNull(pack);
-
-        pack.install(getDefaultOptions());
-
-        assertProperty("/testroot/TestHook1", InstallContext.Phase.END.toString());
-        assertProperty("/testroot/TestHook2", InstallContext.Phase.END.toString());
-    }
-
-    /**
-     * Installs a package with an external hook which throws an exception in the INSTALLED phase
-     */
-    @Test
-    public void testExternalHookFailsInInstalledPhase() throws RepositoryException, IOException, PackageException {
-        try {
-            extractVaultPackage("/test-packages/external_hook_failing_in_installed_phase.zip");
-            fail("Package install should fail due to installhook exception.");
-        } catch (PackageException e) {
-            // ok
-        }
-        // although there was some exception, this has only been triggered after the package has been extracted!
-        assertNodeExists("/testroot");
-    }
-
-    /**
-     * Installs a package with no properties
-     */
-    @Test
-    public void testNoProperties() throws RepositoryException, IOException, PackageException {
-        try (JcrPackage pack = packMgr.upload(getFile("/test-packages/tmp_no_properties.zip"), false, true, "tmp_no_properties",
-                false)) {
-            assertNotNull(pack);
-            pack.install(getDefaultOptions());
-        }
-    }
-
-    /**
-     * Installs a package with non-child filter doesn't remove the root.
-     *
-     * <pre>
-     *   <workspaceFilter version="1.0">
-     *   <filter root="/etc">
-     *     <include pattern="/etc"/>
-     *     <include pattern="/etc/clientlibs"/>
-     *     <include pattern="/etc/clientlibs/granite"/>
-     *     <include pattern="/etc/clientlibs/granite/test(/.*)?"/>
-     *   </filter>
-     *  </workspaceFilter>
-     */
-    @Test
-    public void testNoChildFilter() throws RepositoryException, IOException, PackageException {
-        try (JcrPackage pack = packMgr.upload(getFile("/test-packages/test-package-with-etc.zip"), false, true,
-                "test-package-with-etc", false)) {
-            assertNodeExists("/etc");
-            admin.getNode("/etc").addNode("foo", NodeType.NT_FOLDER);
-            admin.save();
-            pack.install(getDefaultOptions());
-            assertNodeExists("/etc/foo");
-        }
-    }
-
-    @Test
-    public void testDeepContentImport() throws IOException, RepositoryException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_test_deep.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        assertNodeExists("/tmp/test/content/foo/jcr:content/a/b/foo.jsp/jcr:content");
-        assertNodeExists("/tmp/test/content/foo/jcr:content/a/c/resource");
-        assertNodeExists("/tmp/test/content/foo/jcr:content/a/d");
-        assertNodeExists("/tmp/test/content/foo/jcr:content/a/folder/file.txt/jcr:content");
-    }
-
-    /**
-     * installs a package that contains a node with childnode ordering and full-coverage sub nodes.
-     * see JCRVLT-24
-     */
-    @Test
-    public void testChildNodeOrder() throws IOException, RepositoryException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_childnodeorder.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        assertNodeExists("/tmp/ordertest/test/rail/items/modes/items");
-        NodeIterator iter = admin.getNode("/tmp/ordertest/test/rail/items/modes/items").getNodes();
-        StringBuilder names = new StringBuilder();
-        while (iter.hasNext()) {
-            names.append(iter.nextNode().getName()).append(",");
-        }
-        assertEquals("child order", "a,d,b,c,", names.toString());
-    }
-
-    /**
-     * installs a package that contains a node with childnode ordering and full-coverage sub nodes.
-     * see JCRVLT-44
-     */
-    @Test
-    public void testChildNodeOrder2() throws IOException, RepositoryException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_childnodeorder2.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        assertNodeExists("/tmp/test/en");
-        NodeIterator iter = admin.getNode("/tmp/test/en").getNodes();
-        StringBuilder names = new StringBuilder();
-        while (iter.hasNext()) {
-            names.append(iter.nextNode().getName()).append(",");
-        }
-        assertEquals("child order", "jcr:content,toolbar,products,services,company,events,support,community,blog,", names.toString());
-    }
-
-    /**
-     * Installs a package that and checks if snapshot is created
-     */
-    @Test
-    public void testSnapshotExists() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        assertPackageNodeExists(TMP_SNAPSHOT_PACKAGE_ID);
-        assertNodeExists("/tmp/foo/bar/tobi");
-    }
-
-    /**
-     * Installs and uninstalls a package that and checks if the content is reverted.
-     */
-    @Test
-    public void testUninstall() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-        assertNodeExists("/tmp/foo/bar/tobi");
-
-        pack.uninstall(getDefaultOptions());
-        assertNodeMissing("/tmp/foo/bar/tobi");
-    }
-
-    /**
-     * Uninstalls a package that has no snapshot (JCRVLT-89)
-     */
-    @Test
-    public void testUninstallNoSnapshot() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp.zip"), false);
-        assertNotNull(pack);
-
-        // extract should not generate snapshots
-        ImportOptions opts = getDefaultOptions();
-        opts.setStrict(false);
-        
-        pack.extract(opts);
-        assertNodeExists("/tmp/foo/bar/tobi");
-        assertPackageNodeMissing(TMP_SNAPSHOT_PACKAGE_ID);
-
-        pack.uninstall(opts);
-        assertNodeExists("/tmp/foo/bar/tobi");
-    }
-
-    /**
-     * Checks if uninstalling a package in strict mode with no snapshot fails (JCRVLT-89).
-     */
-    @Test
-    public void testUninstallNoSnapshotStrict() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp.zip"), false);
-        assertNotNull(pack);
-
-        // extract should not generate snapshots
-        pack.extract(getDefaultOptions());
-        assertNodeExists("/tmp/foo/bar/tobi");
-        assertPackageNodeMissing(TMP_SNAPSHOT_PACKAGE_ID);
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setStrict(true);
-        try {
-            pack.uninstall(opts);
-            fail("uninstalling a package with no snapshot should fail in strict mode.");
-        } catch (PackageException e) {
-            // ok
-        }
-    }
-
-    /**
-     * Installs a binary properties.
-     */
-    @Test
-    public void testBinaryProperties() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_binary.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        Property p = admin.getProperty("/tmp/binary/test/jcr:data");
-        assertEquals(PropertyType.BINARY, p.getType());
-
-        StringBuilder buffer = new StringBuilder(8192);
-        while (buffer.length() < 8192) {
-            buffer.append("0123456789abcdef");
-        }
-        String result = IOUtils.toString(p.getBinary().getStream());
-
-        assertEquals(buffer.toString(), result);
-    }
-
-    /**
-     * Installs a binary properties twice to check if it doesn't report an update.
-     * TODO: this is not implemented yet. see JCRVLT-110
-     */
-    @Test
-    @Ignore
-    public void testBinaryPropertyTwice() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_binary.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        Property p = admin.getProperty("/tmp/binary/test/jcr:data");
-        assertEquals(PropertyType.BINARY, p.getType());
-
-        StringBuilder buffer = new StringBuilder(8192);
-        while (buffer.length() < 8192) {
-            buffer.append("0123456789abcdef");
-        }
-        String result = IOUtils.toString(p.getBinary().getStream());
-
-        assertEquals(buffer.toString(), result);
-
-        // install again to check if binary data is not updated
-        ImportOptions opts = getDefaultOptions();
-        TrackingListener listener = new TrackingListener(opts.getListener());
-        opts.setListener(listener);
-
-        pack.install(opts);
-
-        //TODO: assertEquals("-", listener.getActions().get("/tmp/binary/test"));
-        assertEquals("U", listener.getActions().get("/tmp/binary/test"));
-    }
-
-    /**
-     * Test is binaries outside the filter are not imported (JCRVLT-126)
-     */
-    @Test
-    public void testBinaryPropertiesOutsideFilter() throws RepositoryException, IOException, PackageException {
-        // first install the package once to create the intermediate nodes
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_filter_binary.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-        assertProperty("/tmp/test", "123");
-
-        // delete the binary properties
-        if (admin.itemExists("/root-binary-property")) {
-            admin.removeItem("/root-binary-property");
-        }
-
-        admin.removeItem("/tmp/tmp-binary-property");
-        admin.removeItem("/tmp/test");
-        admin.removeItem("/tmp/test-project");
-        admin.save();
-
-        assertPropertyMissing("/root-binary-property");
-        assertPropertyMissing("/tmp/tmp-binary-property");
-
-        // now install again and check if the properties are still missing
-        pack.install(getDefaultOptions());
-        assertPropertyMissing("/tmp/test");
-        assertPropertyMissing("/root-binary-property");
-        assertPropertyMissing("/tmp/tmp-binary-property");
-    }
-
-    /**
-     * Installs a package with a different node type
-     */
-    @Test
-    public void testNodeTypeChange() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp.zip"), false);
-        assertNotNull(pack);
-        assertPackageNodeExists(TMP_PACKAGE_ID);
-
-        ImportOptions opts = getDefaultOptions();
-        pack.install(opts);
-
-        assertNodeExists("/tmp/foo");
-        assertEquals(admin.getNode("/tmp").getPrimaryNodeType().getName(), "sling:OrderedFolder");
-
-        pack = packMgr.upload(getStream("/test-packages/tmp_nt_folder.zip"), false);
-        assertNotNull(pack);
-        assertPackageNodeExists(TMP_PACKAGE_ID);
-
-        pack.install(opts);
-
-        assertNodeExists("/tmp/foo");
-        assertEquals(admin.getNode("/tmp").getPrimaryNodeType().getName(), "nt:folder");
-    }
-
-    /**
-     * Installs a package with versioned nodes
-     */
-    @Test
-    public void testVersionInstall() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_version.zip"), false);
-        assertNotNull(pack);
-
-        ImportOptions opts = getDefaultOptions();
-        pack.install(opts);
-
-        assertProperty("/testroot/a/test", "123");
-        assertProperty("/testroot/a/jcr:isCheckedOut", "false");
-
-        // modify
-        admin.getWorkspace().getVersionManager().checkout("/testroot/a");
-        admin.getProperty("/testroot/a/test").setValue("test");
-        admin.save();
-        admin.getWorkspace().getVersionManager().checkin("/testroot/a");
-
-        // install a 2nd time
-        opts = getDefaultOptions();
-        pack.install(opts);
-
-        assertProperty("/testroot/a/test", "123");
-        assertProperty("/testroot/a/jcr:isCheckedOut", "false");
-
-    }
-
-
-    /**
-     * Installs a package with versions retains checked out state
-     */
-    @Test
-    public void testVersionInstallCheckedOut() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_version.zip"), false);
-        assertNotNull(pack);
-
-        ImportOptions opts = getDefaultOptions();
-        pack.install(opts);
-
-        assertProperty("/testroot/a/test", "123");
-        assertProperty("/testroot/a/jcr:isCheckedOut", "false");
-
-        // modify
-        admin.getWorkspace().getVersionManager().checkout("/testroot/a");
-        admin.getProperty("/testroot/a/test").setValue("test");
-        admin.save();
-
-        // install a 2nd time
-        opts = getDefaultOptions();
-        pack.install(opts);
-
-        assertProperty("/testroot/a/test", "123");
-        assertProperty("/testroot/a/jcr:isCheckedOut", "false");
-    }
-
-    /**
-     * Installs a package with invalid dependency strings. see JCRVLT-265
-     */
-    @Test
-    public void testInvalidDependenciesInProperties() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/null-dependency-test.zip"), false);
-        assertNotNull(pack);
-        for (Dependency dep: pack.getDefinition().getDependencies()) {
-            assertNotNull("dependency element", dep);
-        }
-    }
-
-    /**
-     * Creates a package definition with invalid dependencies. see JCRVLT-265
-     */
-    @Test
-    public void testInvalidDependenciesInDefinition() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/null-dependency-test.zip"), false);
-        assertNotNull(pack);
-        Dependency[] deps = {new Dependency(TMP_PACKAGE_ID), null};
-        pack.getDefinition().setDependencies(deps, true);
-        for (Dependency dep: pack.getDefinition().getDependencies()) {
-            assertNotNull("dependency element", dep);
-        }
-
-        Value[] values = {admin.getValueFactory().createValue("")};
-        pack.getDefNode().setProperty(PN_DEPENDENCIES, values);
-        admin.save();
-
-        pack = packMgr.open(pack.getDefinition().getId());
-        for (Dependency dep: pack.getDefinition().getDependencies()) {
-            assertNotNull("dependency element", dep);
-        }
-    }
-
-    /**
-     * Tests if package installation works w/o RW access to / and /tmp.
-     * this currently fails, due to the creation of the snapshot.
-     * also see {@link NoRootAccessExportIT#exportNoRootAccess()}
-     */
-    @Test
-    @Ignore("JCRVLT-100")
-    public void testInstallWithoutRootAndTmpAccess() throws IOException, RepositoryException, ConfigurationException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_foo.zip"), true, true);
-        assertNotNull(pack);
-        assertTrue(pack.isValid());
-        PackageId id = pack.getPackage().getId();
-        pack.close();
-
-        // Create test user
-        UserManager userManager = ((JackrabbitSession)admin).getUserManager();
-        String userId = "user1";
-        String userPwd = "pwd1";
-        User user1 = userManager.createUser(userId, userPwd);
-        Principal principal1 = user1.getPrincipal();
-
-        // Create /tmp folder
-        admin.getRootNode().addNode("tmp").addNode("foo");
-        admin.save();
-
-        // Setup test user ACLs such that the
-        // root node is not accessible
-        AccessControlUtils.addAccessControlEntry(admin, null, principal1, new String[]{"jcr:namespaceManagement","jcr:nodeTypeDefinitionManagement"}, true);
-        AccessControlUtils.addAccessControlEntry(admin, "/", principal1, new String[]{"jcr:all"}, false);
-        AccessControlUtils.addAccessControlEntry(admin, ((JcrPackageRegistry)packMgr.getRegistry()).getPackRootPaths()[0], principal1, new String[]{"jcr:all"}, true);
-        AccessControlUtils.addAccessControlEntry(admin, "/tmp/foo", principal1, new String[]{"jcr:all"}, true);
-        admin.save();
-
-        Session session = repository.login(new SimpleCredentials(userId, userPwd.toCharArray()));
-        JcrPackageManagerImpl userPackMgr = new JcrPackageManagerImpl(session, new String[0]);
-        pack = userPackMgr.open(id);
-        ImportOptions opts = getDefaultOptions();
-        pack.install(opts);
-        pack.close();
-        session.logout();
-
-        assertNodeExists("/tmp/foo/bar/tobi");
-    }
-
-    /**
-     * Test if package extraction works w/o RW access to / and /tmp.
-     */
-    @Test
-    public void testExtractWithoutRootAndTmpAccess() throws IOException, RepositoryException, ConfigurationException, PackageException {
-        Assume.assumeTrue(!isOak());
-
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/tmp_foo.zip"), true, true);
-        assertNotNull(pack);
-        assertTrue(pack.isValid());
-        PackageId id = pack.getPackage().getId();
-        pack.close();
-
-        // Create test user
-        UserManager userManager = ((JackrabbitSession)admin).getUserManager();
-        String userId = "user1";
-        String userPwd = "pwd1";
-        User user1 = userManager.createUser(userId, userPwd);
-        Principal principal1 = user1.getPrincipal();
-
-        // Create /tmp folder
-        admin.getRootNode().addNode("tmp").addNode("foo");
-        admin.save();
-
-        // Setup test user ACLs such that the
-        // root node is not accessible
-        AccessControlUtils.addAccessControlEntry(admin, null, principal1, new String[]{"jcr:namespaceManagement","jcr:nodeTypeDefinitionManagement"}, true);
-        AccessControlUtils.addAccessControlEntry(admin, "/", principal1, new String[]{"jcr:all"}, false);
-        AccessControlUtils.addAccessControlEntry(admin, ((JcrPackageRegistry)packMgr.getRegistry()).getPackRootPaths()[0], principal1, new String[]{"jcr:all"}, true);
-        AccessControlUtils.addAccessControlEntry(admin, "/tmp/foo", principal1, new String[]{"jcr:all"}, true);
-        admin.save();
-
-        Session session = repository.login(new SimpleCredentials(userId, userPwd.toCharArray()));
-        JcrPackageManagerImpl userPackMgr = new JcrPackageManagerImpl(session, new String[0]);
-        pack = userPackMgr.open(id);
-        ImportOptions opts = getDefaultOptions();
-        opts.setStrict(false);
-        pack.extract(opts);
-        pack.close();
-        session.logout();
-
-        assertNodeExists("/tmp/foo/bar/tobi");
-    }
-
-    /**
-     * Tests if installing a package with a 0-mtime entry works with java9.
-     * see http://bugs.java.com/view_bug.do?bug_id=JDK-8184940
-     */
-    @Test
-    public void testPackageInstallWith0MtimeZipEntry() throws IOException, RepositoryException, NoSuchFieldException, IllegalAccessException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/properties-with-0mtime.zip"), true, true);
-        assertEquals("packageid", TMP_PACKAGE_ID, pack.getDefinition().getId());
-    }
-
-    // todo: upload with version
-    // todo: rename
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/PackageRegistryIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/PackageRegistryIT.java
deleted file mode 100644
index cb10668d..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/PackageRegistryIT.java
+++ /dev/null
@@ -1,381 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.File;
-import java.io.IOException;
-import java.util.List;
-
-import javax.jcr.Node;
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.vault.packaging.Dependency;
-import org.apache.jackrabbit.vault.packaging.NoSuchPackageException;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.PackageExistsException;
-import org.apache.jackrabbit.vault.packaging.PackageId;
-import org.apache.jackrabbit.vault.packaging.registry.DependencyReport;
-import org.apache.jackrabbit.vault.packaging.registry.PackageRegistry;
-import org.apache.jackrabbit.vault.packaging.registry.RegisteredPackage;
-import org.apache.jackrabbit.vault.packaging.registry.impl.JcrPackageRegistry;
-import org.apache.jackrabbit.vault.packaging.registry.impl.JcrRegisteredPackage;
-import org.junit.Before;
-import org.junit.Test;
-import org.mockito.Mockito;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertFalse;
-import static org.junit.Assert.assertNull;
-import static org.junit.Assert.assertTrue;
-import static org.junit.Assert.fail;
-
-/**
- * Test the Package registry interface
- */
-public class PackageRegistryIT extends IntegrationTestBase {
-
-    private JcrPackageRegistry registry;
-
-    @Override
-    @Before
-    public void setUp() throws Exception {
-        super.setUp();
-
-        registry = new JcrPackageRegistry(admin);
-    }
-
-    /**
-     * checks is a non existent package is really not there
-     */
-    @Test
-    public void testOpenNonExistentPackage() throws IOException, PackageException {
-        assertFalse("package must not exist", registry.contains(TMP_PACKAGE_ID));
-        assertNull("package must not exist", registry.open(TMP_PACKAGE_ID));
-    }
-
-    /**
-     * registers a package via stream
-     */
-    @Test
-    public void testRegisterStream() throws IOException, PackageException {
-        PackageId id = registry.register(getStream("/test-packages/tmp.zip"), false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-
-        try (RegisteredPackage pkg = registry.open(id)) {
-            assertEquals("package id of registered is correct", TMP_PACKAGE_ID, pkg.getId());
-            assertFalse("Package is not installed", pkg.isInstalled());
-        }
-    }
-
-    /**
-     * registers a package twice via stream (replace = false)
-     */
-    @Test
-    public void testRegisterStreamTwiceFails() throws IOException, PackageException {
-        PackageId id = registry.register(getStream("/test-packages/tmp.zip"), false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-
-        try {
-            registry.register(getStream("/test-packages/tmp.zip"), false);
-            fail("registering the package twice should fail");
-        } catch (PackageExistsException e) {
-            // expected
-            assertEquals("colliding pid must be correct", id, e.getId());
-        }
-    }
-
-    /**
-     * registers a package twice via stream (replace = true)
-     */
-    @Test
-    public void testRegisterStreamTwiceSucceeds() throws IOException, PackageException {
-        PackageId id = registry.register(getStream("/test-packages/tmp.zip"), false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-        registry.register(getStream("/test-packages/tmp.zip"), true);
-    }
-
-    /**
-     * registers a package twice via a file
-     */
-    @Test
-    public void testRegisterFileTwiceFails() throws IOException, PackageException {
-        File file = getFile("/test-packages/tmp.zip");
-        PackageId id = registry.register(file, false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-        assertTrue("file should still exist", file.exists());
-
-        try (RegisteredPackage pkg = registry.open(id)) {
-            assertEquals("package id of registered is correct", TMP_PACKAGE_ID, pkg.getId());
-            assertFalse("Package is not installed", pkg.isInstalled());
-        }
-
-        try {
-            registry.register(file, false);
-            fail("registering the package twice should fail");
-        } catch (PackageExistsException e) {
-            // expected
-            assertEquals("colliding pid must be correct", id, e.getId());
-        }
-    }
-
-    /**
-     * registers a package twice via a temp file file
-     */
-    @Test
-    public void testRegisterTempFileTwiceFails() throws IOException, PackageException {
-        File file = getFile("/test-packages/tmp.zip");
-        PackageId id = registry.register(file, false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-
-        try (RegisteredPackage pkg = registry.open(id)) {
-            assertEquals("package id of registered is correct", TMP_PACKAGE_ID, pkg.getId());
-            assertFalse("Package is not installed", pkg.isInstalled());
-        }
-
-        file = getFile("/test-packages/tmp.zip");
-        try {
-            registry.register(file, false);
-            fail("registering the package twice should fail");
-        } catch (PackageExistsException e) {
-            // expected
-            assertEquals("colliding pid must be correct", id, e.getId());
-        }
-    }
-
-    /**
-     * registers a package twice via file (replace = true)
-     */
-    @Test
-    public void testRegisterFileTwiceSucceeds() throws IOException, PackageException {
-        File file = getFile("/test-packages/tmp.zip");
-        PackageId id = registry.register(file, false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-        assertTrue("file should still exist", file.exists());
-        registry.register(file, true);
-    }
-
-    /**
-     * test if package removal works
-     */
-    @Test
-    public void testRemovePackage() throws IOException, PackageException {
-        PackageId id = registry.register(getStream("/test-packages/tmp.zip"), false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-
-        registry.remove(id);
-        assertFalse("package must not exist", registry.contains(TMP_PACKAGE_ID));
-        assertNull("package must not exist", registry.open(TMP_PACKAGE_ID));
-    }
-
-    @Test
-    public void testRemovePackageCallsClose() throws IOException, PackageException {
-        PackageId id = registry.register(getStream("/test-packages/tmp.zip"), false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-
-        PackageRegistry testReg = Mockito.spy(registry);
-        JcrRegisteredPackage pack = Mockito.spy((JcrRegisteredPackage) registry.open(TMP_PACKAGE_ID));
-        Mockito.doReturn(pack).when(testReg).open(TMP_PACKAGE_ID);
-        testReg.remove(id);
-
-        Mockito.verify(pack, Mockito.times(1)).close();
-    }
-
-    /**
-     * test packages set
-     */
-    @Test
-    public void testPackages() throws IOException, PackageException {
-        assertTrue("initially the packages set is empty", registry.packages().isEmpty());
-        registry.register(getStream("/test-packages/tmp.zip"), false);
-        assertEquals("packages contains 1 element", 1, registry.packages().size());
-        assertTrue("contains new package", registry.packages().contains(TMP_PACKAGE_ID));
-    }
-
-    /**
-     * test packages set with multiple roots
-     */
-    @Test
-    public void testPackagesMultiRoot() throws IOException, PackageException, RepositoryException {
-        assertTrue("initially the packages set is empty", registry.packages().isEmpty());
-        registry.register(getStream(TEST_PACKAGE_A_10), false);
-        registry.register(getStream(TEST_PACKAGE_B_10), false);
-        assertEquals("packages contains 2 elements", 2, registry.packages().size());
-        JcrPackageRegistry multiReg = new JcrPackageRegistry(admin, "/var/packages" , "/etc/packages");
-        assertEquals("packages contains 2 elements", 2, multiReg.packages().size());
-
-        // install 3rd package in /var
-        registry.register(getStream(TEST_PACKAGE_C_10), false);
-        assertEquals("packages contains 3 elements", 3, multiReg.packages().size());
-
-        assertTrue("contains new packages", multiReg.packages().contains(TEST_PACKAGE_A_10_ID));
-        assertTrue("contains new packages", multiReg.packages().contains(TEST_PACKAGE_B_10_ID));
-        assertTrue("contains new packages", multiReg.packages().contains(TEST_PACKAGE_C_10_ID));
-    }
-
-    /**
-     * test if remove non existing should fail
-     */
-    @Test
-    public void testRemoveNonExistingPackage() throws IOException, PackageException {
-        try {
-            registry.remove(TMP_PACKAGE_ID);
-            fail("remove non existing should fail");
-        } catch (NoSuchPackageException e) {
-            assertEquals("exception should contain correct package id", TMP_PACKAGE_ID, e.getId());
-        }
-    }
-
-    /**
-     * test if analyze dependencies fails for non existing package
-     */
-    @Test
-    public void testAnalyzeDependenciesFailsForNonExisting() throws IOException {
-        try {
-            registry.analyzeDependencies(TMP_PACKAGE_ID, false);
-            fail("usage report should fail for non existing package.");
-        } catch (NoSuchPackageException e) {
-            assertEquals("exception should contain correct package id", TMP_PACKAGE_ID, e.getId());
-        }
-    }
-
-    /**
-     * test if analyze dependencies is correct for non installed packages
-     */
-    @Test
-    public void testAnalyzeDependencies() throws IOException, PackageException {
-        // a depends on b and c
-        PackageId idA = registry.register(getStream(TEST_PACKAGE_A_10), false);
-
-        DependencyReport report = registry.analyzeDependencies(idA, false);
-        assertEquals("resolved dependencies", "", PackageId.toString(report.getResolvedDependencies()));
-        assertEquals("unresolved dependencies", "my_packages:test_b,my_packages:test_c:[1.0,2.0)", Dependency.toString(report.getUnresolvedDependencies()));
-
-        // b depends on c
-        registry.register(getStream(TEST_PACKAGE_B_10), false);
-        report = registry.analyzeDependencies(idA, false);
-        assertEquals("resolved dependencies", "my_packages:test_b:1.0", PackageId.toString(report.getResolvedDependencies()));
-        assertEquals("unresolved dependencies", "my_packages:test_c:[1.0,2.0)", Dependency.toString(report.getUnresolvedDependencies()));
-
-        registry.register(getStream(TEST_PACKAGE_C_10), false);
-        report = registry.analyzeDependencies(idA, false);
-        assertEquals("resolved dependencies", "my_packages:test_b:1.0,my_packages:test_c:1.0", PackageId.toString(report.getResolvedDependencies()));
-        assertEquals("unresolved dependencies", "", Dependency.toString(report.getUnresolvedDependencies()));
-
-    }
-
-    /**
-     * test if analyze dependencies is correct for non installed packages
-     */
-    @Test
-    public void testAnalyzeInstalledDependencies() throws IOException, PackageException, RepositoryException {
-        // a depends on b and c
-        PackageId idA = registry.register(getStream(TEST_PACKAGE_A_10), false);
-
-        DependencyReport report = registry.analyzeDependencies(idA, true);
-        assertEquals("resolved dependencies", "", PackageId.toString(report.getResolvedDependencies()));
-        assertEquals("unresolved dependencies", "my_packages:test_b,my_packages:test_c:[1.0,2.0)", Dependency.toString(report.getUnresolvedDependencies()));
-
-        // b depends on c
-        PackageId idB = registry.register(getStream(TEST_PACKAGE_B_10), false);
-        report = registry.analyzeDependencies(idA, true);
-        assertEquals("resolved dependencies", "", PackageId.toString(report.getResolvedDependencies()));
-        assertEquals("unresolved dependencies", "my_packages:test_b,my_packages:test_c:[1.0,2.0)", Dependency.toString(report.getUnresolvedDependencies()));
-
-        // install B
-        packMgr.open(idB).install(getDefaultOptions());
-
-        report = registry.analyzeDependencies(idA, true);
-        assertEquals("resolved dependencies", "my_packages:test_b:1.0", PackageId.toString(report.getResolvedDependencies()));
-        assertEquals("unresolved dependencies", "my_packages:test_c:[1.0,2.0)", Dependency.toString(report.getUnresolvedDependencies()));
-    }
-
-    @Test
-    public void testUsages() throws Exception {
-        PackageId idB = registry.register(getStream(TEST_PACKAGE_B_10), false);
-        PackageId idC = registry.register(getStream(TEST_PACKAGE_C_10), false);
-
-        assertEquals("usage", "", PackageId.toString(registry.usage(idC)));
-
-        packMgr.open(idB).install(getDefaultOptions());
-        packMgr.open(idC).install(getDefaultOptions());
-
-        assertEquals("usage", "my_packages:test_b:1.0", PackageId.toString(registry.usage(idC)));
-    }
-
-    @Test
-    public void testAlternativeRoot() throws IOException, PackageException, RepositoryException {
-        JcrPackageRegistry reg = new JcrPackageRegistry(admin, "/var/packages" , "/etc/packages");
-        File file = getFile("/test-packages/tmp.zip");
-        PackageId id = reg.register(file, false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-
-        assertNodeExists("/var/packages/my_packages/tmp.zip");
-    }
-
-    @Test
-    public void testAlternativeRootBackwardCompat() throws IOException, PackageException, RepositoryException {
-        // install with default registry
-        PackageId idB = registry.register(getStream(TEST_PACKAGE_B_10), false);
-        assertNodeExists("/etc/packages/my_packages/test_b-1.0.zip");
-
-        JcrPackageRegistry reg = new JcrPackageRegistry(admin, "/var/packages", "/etc/packages");
-        PackageId id = reg.register(getStream("/test-packages/tmp.zip"), false);
-
-        assertNodeExists("/var/packages/my_packages/tmp.zip");
-
-        assertTrue("alternative registry must find packages on old location", reg.contains(idB));
-        assertFalse("old registry must not find packages at new location", registry.contains(id));
-    }
-
-    @Test
-    public void testPackageRootNoCreate() throws RepositoryException {
-        assertTrue("no nodes, no roots", registry.getPackageRoots().isEmpty());
-    }
-
-    @Test
-    public void testPrimaryPackageRootNoCreate() throws RepositoryException {
-        assertNull("no node, no root", registry.getPrimaryPackageRoot(false));
-    }
-
-    @Test
-    public void testPrimaryPackageRootCreatesLegacy() throws RepositoryException {
-        Node root = registry.getPrimaryPackageRoot(true);
-        assertEquals("root has legacy path", "/etc/packages", root.getPath());
-    }
-
-    @Test
-    public void testAlternativePackageRootCreatesOnlyOneNode() throws RepositoryException {
-        JcrPackageRegistry reg = new JcrPackageRegistry(admin, "/var/packages", "/etc/packages");
-        Node root = reg.getPrimaryPackageRoot(true);
-        assertEquals("root has correct path", "/var/packages", root.getPath());
-        List<Node> roots = reg.getPackageRoots();
-        assertEquals("Has 1 package root", 1, roots.size());
-    }
-
-    @Test
-    public void testAlternativePackageRootReportsBothNodes() throws RepositoryException {
-        registry.getPrimaryPackageRoot(true); // create legacy path
-        JcrPackageRegistry reg = new JcrPackageRegistry(admin, "/var/packages", "/etc/packages");
-        reg.getPrimaryPackageRoot(true); // create new path
-        List<Node> roots = reg.getPackageRoots();
-        assertEquals("Has 2 package root", 2, roots.size());
-        assertEquals("primary root has correct path", "/var/packages", roots.get(0).getPath());
-        assertEquals("secondary root has legacy path", "/etc/packages", roots.get(1).getPath());
-    }
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/PackageScopedInstallIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/PackageScopedInstallIT.java
deleted file mode 100644
index 93b9eb57..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/PackageScopedInstallIT.java
+++ /dev/null
@@ -1,104 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.IOException;
-
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.ScopedWorkspaceFilter;
-import org.junit.Before;
-import org.junit.Test;
-
-import static org.junit.Assert.assertNotNull;
-
-public class PackageScopedInstallIT extends IntegrationTestBase {
-
-    @Before
-    public void beforeEach() {
-        clean("/libs");
-        clean("/tmp");
-    }
-
-    /**
-     * Installs a package that contains mixed content
-     */
-    @Test
-    public void testMixedContent() throws RepositoryException, IOException, PackageException {
-        assertNodeMissing("/libs/foo");
-        assertNodeMissing("/tmp/foo");
-
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/mixed_package.zip"), false);
-        assertNotNull(pack);
-
-        // just extract - no snapshots
-        ImportOptions opts = getDefaultOptions();
-        pack.extract(opts);
-        assertNodeExists("/tmp/foo");
-        assertNodeExists("/libs/foo");
-    }
-
-    /**
-     * Installs a package that contains mixed content but filtered for apps
-     */
-    @Test
-    public void testApplication() throws RepositoryException, IOException, PackageException {
-        assertNodeMissing("/libs/foo");
-        assertNodeMissing("/tmp/foo");
-
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/mixed_package.zip"), false);
-        assertNotNull(pack);
-
-        // just extract - no snapshots
-        ScopedWorkspaceFilter filter = ScopedWorkspaceFilter.createApplicationScoped(
-                (DefaultWorkspaceFilter) pack.getDefinition().getMetaInf().getFilter());
-
-        ImportOptions opts = getDefaultOptions();
-        opts.setFilter(filter);
-        pack.extract(opts);
-        assertNodeMissing("/tmp/foo");
-        assertNodeExists("/libs/foo");
-    }
-
-    /**
-     * Installs a package that contains mixed content but filtered for content
-     */
-    @Test
-    public void testContent() throws RepositoryException, IOException, PackageException {
-        assertNodeMissing("/libs/foo");
-        assertNodeMissing("/tmp/foo");
-
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/mixed_package.zip"), false);
-        assertNotNull(pack);
-
-        // just extract - no snapshots
-        ScopedWorkspaceFilter filter = ScopedWorkspaceFilter.createContentScoped((
-                DefaultWorkspaceFilter) pack.getDefinition().getMetaInf().getFilter());
-        ImportOptions opts = getDefaultOptions();
-        opts.setFilter(filter);
-        pack.extract(opts);
-        assertNodeExists("/tmp/foo");
-        assertNodeMissing("/libs/foo");
-    }
-
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/PackageTypesIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/PackageTypesIT.java
deleted file mode 100644
index b96dafe6..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/PackageTypesIT.java
+++ /dev/null
@@ -1,162 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.File;
-import java.io.IOException;
-import java.util.Properties;
-
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.vault.fs.api.PathFilterSet;
-import org.apache.jackrabbit.vault.fs.api.WorkspaceFilter;
-import org.apache.jackrabbit.vault.fs.config.DefaultMetaInf;
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.apache.jackrabbit.vault.packaging.ExportOptions;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.PackageExistsException;
-import org.apache.jackrabbit.vault.packaging.PackageId;
-import org.apache.jackrabbit.vault.packaging.PackageType;
-import org.apache.jackrabbit.vault.packaging.VaultPackage;
-import org.apache.jackrabbit.vault.packaging.registry.PackageRegistry;
-import org.apache.jackrabbit.vault.packaging.registry.RegisteredPackage;
-import org.apache.jackrabbit.vault.packaging.registry.impl.JcrPackageRegistry;
-import org.junit.Before;
-import org.junit.Test;
-
-import static org.junit.Assert.assertEquals;
-
-public class PackageTypesIT extends IntegrationTestBase {
-
-    private PackageRegistry registry;
-
-    @Override
-    @Before
-    public void setUp() throws Exception {
-        super.setUp();
-
-        registry = new JcrPackageRegistry(admin);
-    }
-
-    private void verifyViaRegistry(String type) throws IOException, PackageExistsException {
-        PackageId id = registry.register(getStream("/test-packages/packagetype/" + type + "-pkg.zip"), false);
-        RegisteredPackage pkg = registry.open(id);
-        PackageType result  = pkg.getPackage().getProperties().getPackageType();
-        PackageType expected = "notype".equals(type)
-                ? null
-                : PackageType.valueOf(type.toUpperCase());
-        assertEquals("Package type", expected, result);
-    }
-
-    private void verifyPackageTypeViaPackageCreation(WorkspaceFilter filter, PackageType expected)
-            throws IOException, RepositoryException {
-
-        ExportOptions options = new ExportOptions();
-        DefaultMetaInf meta = new DefaultMetaInf();
-        meta.setFilter(filter);
-
-        Properties props = new Properties();
-        props.setProperty(VaultPackage.NAME_GROUP, "jackrabbit/test");
-        props.setProperty(VaultPackage.NAME_NAME, "package-types-export-package");
-        meta.setProperties(props);
-
-        options.setMetaInf(meta);
-
-        File tmpFile = File.createTempFile("vaulttest", "zip");
-        try (VaultPackage pkg = packMgr.assemble(admin, options, tmpFile)) {
-            PackageType result = pkg.getProperties().getPackageType();
-            assertEquals("Package type", expected, result);
-        } finally {
-            tmpFile.delete();
-        }
-    }
-
-
-    /**
-     * checks if 'application' package type is correct read from package using the registry.
-     */
-    @Test
-    public void test_type_application_via_registry() throws IOException, PackageException {
-        verifyViaRegistry("application");
-    }
-
-    /**
-     * checks if 'content' package type is correct read from package using the registry.
-     */
-    @Test
-    public void test_type_content_via_registry() throws IOException, PackageException {
-        verifyViaRegistry("content");
-    }
-
-    /**
-     * checks if 'container' package type is correct read from package using the registry.
-     */
-    @Test
-    public void test_type_container_via_registry() throws IOException, PackageException {
-        verifyViaRegistry("container");
-    }
-
-    /**
-     * checks if 'mixed' package type is correct read from package using the registry.
-     */
-    @Test
-    public void test_type_mixed_via_registry() throws IOException, PackageException {
-        verifyViaRegistry("mixed");
-    }
-
-    /**
-     * checks if missing package type is correct read from package using the registry.
-     */
-    @Test
-    public void test_missing_type_via_registry() throws IOException, PackageException {
-        verifyViaRegistry("notype");
-    }
-
-    /**
-     * checks if assembling an "application" package adds the correct package type to the properties.
-     */
-    @Test
-    public void test_export_application() throws IOException, RepositoryException {
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/libs/foo"));
-        filter.add(new PathFilterSet("/apps/foo"));
-        verifyPackageTypeViaPackageCreation(filter, PackageType.APPLICATION);
-    }
-
-    /**
-     * checks if assembling a "content" package adds the correct package type to the properties.
-     */
-    @Test
-    public void test_export_content() throws IOException, RepositoryException {
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/content/foo"));
-        filter.add(new PathFilterSet("/cont/foo"));
-        verifyPackageTypeViaPackageCreation(filter, PackageType.CONTENT);
-    }
-
-    /**
-     * checks if assembling a "mixed" package adds the correct package type to the properties.
-     */
-    @Test
-    public void test_export_mixed() throws IOException, RepositoryException {
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/content/foo"));
-        filter.add(new PathFilterSet("/libs/foo"));
-        verifyPackageTypeViaPackageCreation(filter, PackageType.MIXED);
-    }
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/PrincipalBasedIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/PrincipalBasedIT.java
deleted file mode 100644
index 50d56380..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/PrincipalBasedIT.java
+++ /dev/null
@@ -1,347 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import com.google.common.collect.ImmutableList;
-import com.google.common.collect.ImmutableMap;
-import com.google.common.collect.ImmutableSet;
-import com.google.common.collect.Lists;
-import org.apache.jackrabbit.JcrConstants;
-import org.apache.jackrabbit.api.JackrabbitSession;
-import org.apache.jackrabbit.api.security.JackrabbitAccessControlManager;
-import org.apache.jackrabbit.api.security.authorization.PrincipalAccessControlList;
-import org.apache.jackrabbit.api.security.user.User;
-import org.apache.jackrabbit.api.security.user.UserManager;
-import org.apache.jackrabbit.commons.jackrabbit.authorization.AccessControlUtils;
-import org.apache.jackrabbit.oak.commons.PathUtils;
-import org.apache.jackrabbit.oak.jcr.Jcr;
-import org.apache.jackrabbit.oak.security.internal.SecurityProviderHelper;
-import org.apache.jackrabbit.oak.spi.mount.Mounts;
-import org.apache.jackrabbit.oak.spi.security.ConfigurationParameters;
-import org.apache.jackrabbit.oak.spi.security.SecurityProvider;
-import org.apache.jackrabbit.oak.spi.security.authorization.AuthorizationConfiguration;
-import org.apache.jackrabbit.oak.spi.security.authorization.accesscontrol.AccessControlConstants;
-import org.apache.jackrabbit.oak.spi.security.authorization.principalbased.FilterProvider;
-import org.apache.jackrabbit.oak.spi.security.authorization.principalbased.impl.FilterProviderImpl;
-import org.apache.jackrabbit.oak.spi.security.authorization.principalbased.impl.PrincipalBasedAuthorizationConfiguration;
-import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeConstants;
-import org.apache.jackrabbit.oak.spi.security.user.UserConfiguration;
-import org.apache.jackrabbit.oak.spi.security.user.UserConstants;
-import org.apache.jackrabbit.vault.fs.api.ImportMode;
-import org.apache.jackrabbit.vault.fs.io.AccessControlHandling;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.sling.testing.mock.osgi.junit.OsgiContext;
-import org.jetbrains.annotations.NotNull;
-import org.junit.After;
-import org.junit.Before;
-import org.junit.BeforeClass;
-import org.junit.ClassRule;
-import org.junit.Ignore;
-import org.junit.Test;
-
-import javax.jcr.PropertyType;
-import javax.jcr.RepositoryException;
-import javax.jcr.Value;
-import javax.jcr.ValueFactory;
-import javax.jcr.security.AccessControlEntry;
-import javax.jcr.security.AccessControlPolicy;
-import javax.jcr.security.Privilege;
-import java.security.Principal;
-import java.util.List;
-import java.util.Map;
-
-import static org.junit.Assert.assertArrayEquals;
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertTrue;
-import static org.junit.Assert.fail;
-import static org.junit.Assume.assumeTrue;
-
-public class PrincipalBasedIT extends IntegrationTestBase {
-
-    private static final String INTERMEDIATE_PATH = "intermediate";
-    private static final String EFFECTIVE_PATH = "/testroot/secured";
-    private static final String SYSTEM_USER_ID = "testSystemUser";
-    private static String SERVICE_USER_PATH;
-    static {
-        String usersPath = getSecurityConfigurationParameters().getConfigValue(UserConfiguration.NAME, ConfigurationParameters.EMPTY).getConfigValue(UserConstants.PARAM_USER_PATH, UserConstants.DEFAULT_USER_PATH);
-        SERVICE_USER_PATH = PathUtils.concat(usersPath, UserConstants.DEFAULT_SYSTEM_RELATIVE_PATH, INTERMEDIATE_PATH);
-    }
-    @ClassRule
-    public static final OsgiContext context = new OsgiContext();
-
-    private UserManager userManager;
-    private User testUser;
-
-    private JackrabbitAccessControlManager acMgr;
-    private AccessControlEntry[] existingEntries;
-    private AccessControlEntry[] packageEntries;
-
-    @Override
-    @Before
-    public void setUp() throws Exception {
-        super.setUp();
-
-        userManager = ((JackrabbitSession) admin).getUserManager();
-        testUser = userManager.createSystemUser(SYSTEM_USER_ID, SERVICE_USER_PATH);
-        admin.save();
-
-        ValueFactory vf = admin.getValueFactory();
-
-        acMgr = (JackrabbitAccessControlManager) admin.getAccessControlManager();
-        for (AccessControlPolicy policy : acMgr.getApplicablePolicies(testUser.getPrincipal())) {
-            if (policy instanceof PrincipalAccessControlList) {
-                PrincipalAccessControlList pacl = (PrincipalAccessControlList) policy;
-                Map<String, Value[]> mvRestrictions = ImmutableMap.of(AccessControlConstants.REP_ITEM_NAMES, new Value[]{vf.createValue(JcrConstants.JCR_CONTENT, PropertyType.NAME)});
-                pacl.addEntry(EFFECTIVE_PATH, AccessControlUtils.privilegesFromNames(acMgr, Privilege.JCR_READ), ImmutableMap.<String, Value>of(), mvRestrictions);
-                pacl.addEntry(null, AccessControlUtils.privilegesFromNames(acMgr, PrivilegeConstants.JCR_NAMESPACE_MANAGEMENT));
-                existingEntries = pacl.getAccessControlEntries();
-                acMgr.setPolicy(pacl.getPath(), pacl);
-                break;
-            }
-        }
-        admin.save();
-
-        User testUser2 = userManager.createSystemUser(SYSTEM_USER_ID+"_2", SERVICE_USER_PATH);
-        for (AccessControlPolicy policy : acMgr.getApplicablePolicies(testUser2.getPrincipal())) {
-            if (policy instanceof PrincipalAccessControlList) {
-                PrincipalAccessControlList pacl = (PrincipalAccessControlList) policy;
-
-                pacl.addEntry(EFFECTIVE_PATH, AccessControlUtils.privilegesFromNames(acMgr, Privilege.JCR_WRITE), ImmutableMap.of("rep:glob", vf.createValue("*")), ImmutableMap.<String, Value[]>of());
-                pacl.addEntry(EFFECTIVE_PATH, AccessControlUtils.privilegesFromNames(acMgr, Privilege.JCR_LOCK_MANAGEMENT), ImmutableMap.of("rep:glob", vf.createValue("*/foo")), ImmutableMap.of("rep:itemNames", new Value[] {vf.createValue("jcr:content", PropertyType.NAME), vf.createValue("jcr:data", PropertyType.NAME)}));
-                pacl.addEntry("/content", AccessControlUtils.privilegesFromNames(acMgr, Privilege.JCR_READ), ImmutableMap.<String, Value>of(), ImmutableMap.<String, Value[]>of());
-                pacl.addEntry(null, AccessControlUtils.privilegesFromNames(acMgr, PrivilegeConstants.JCR_WORKSPACE_MANAGEMENT, PrivilegeConstants.JCR_NAMESPACE_MANAGEMENT));
-                packageEntries = pacl.getAccessControlEntries();
-                break;
-            }
-        }
-        admin.refresh(false);
-    }
-
-    @Override
-    @After
-    public void tearDown() throws Exception {
-        try {
-            User u = userManager.getAuthorizable(SYSTEM_USER_ID, User.class);
-            if (u != null) {
-                u.remove();
-                admin.save();
-            }
-        } finally {
-            super.tearDown();
-            shutdownRepository();
-            initRepository();
-        }
-    }
-
-    @BeforeClass
-    public static void initRepository() {
-        repository = new Jcr()
-                .with(createSecurityProvider())
-                .withAtomicCounter()
-                .createRepository();
-    }
-
-    public static SecurityProvider createSecurityProvider() {
-        SecurityProvider securityProvider = IntegrationTestBase.createSecurityProvider();
-
-        FilterProvider fp = new FilterProviderImpl();
-        // trigger activate method
-        context.registerInjectActivateService(fp, ImmutableMap.of("path", SERVICE_USER_PATH));
-
-        PrincipalBasedAuthorizationConfiguration principalBasedAuthorizationConfiguration = new PrincipalBasedAuthorizationConfiguration();
-        principalBasedAuthorizationConfiguration.bindFilterProvider(fp);
-        principalBasedAuthorizationConfiguration.bindMountInfoProvider(Mounts.defaultMountInfoProvider());
-        SecurityProviderHelper.updateConfig(securityProvider, principalBasedAuthorizationConfiguration, AuthorizationConfiguration.class);
-        return securityProvider;
-    }
-
-    private void assertPolicy(@NotNull Principal principal, @NotNull AccessControlEntry... expectedEntries) throws RepositoryException {
-        for (AccessControlPolicy policy : acMgr.getPolicies(principal)) {
-            if (policy instanceof PrincipalAccessControlList) {
-                PrincipalAccessControlList pacl = (PrincipalAccessControlList) policy;
-                AccessControlEntry[] aces = pacl.getAccessControlEntries();
-                assertEquals(expectedEntries.length, aces.length);
-
-                for (int i = 0; i < expectedEntries.length; i++) {
-                    assertTrue(expectedEntries[i] instanceof PrincipalAccessControlList.Entry);
-                    assertTrue(aces[i] instanceof PrincipalAccessControlList.Entry);
-
-
-                    PrincipalAccessControlList.Entry entry = (PrincipalAccessControlList.Entry) aces[i];
-                    PrincipalAccessControlList.Entry expected = (PrincipalAccessControlList.Entry) expectedEntries[i];
-
-                    assertEquals(expected.getEffectivePath(), entry.getEffectivePath());
-                    assertEquals(ImmutableSet.copyOf(expected.getPrivileges()), ImmutableSet.copyOf(entry.getPrivileges()));
-                    assertEquals(ImmutableSet.copyOf(expected.getRestrictionNames()), ImmutableSet.copyOf(entry.getRestrictionNames()));
-                    for (String rName : expected.getRestrictionNames()) {
-                        if (pacl.isMultiValueRestriction(rName)) {
-                            assertArrayEquals(expected.getRestrictions(rName), entry.getRestrictions(rName));
-                        } else {
-                            assertEquals(expected.getRestriction(rName), entry.getRestriction(rName));
-                        }
-                    }
-                }
-                return;
-            }
-        }
-        fail("expected PrincipalAccessControlList for principal " + principal.getName());
-    }
-
-    @Test
-    public void testHandlingIgnoreModeUpdate() throws Exception {
-        assumeTrue(isOak());
-        ImportOptions opts = getDefaultOptions();
-        opts.setAccessControlHandling(AccessControlHandling.IGNORE);
-        opts.setImportMode(ImportMode.UPDATE);
-
-        extractVaultPackage("/test-packages/principalbased.zip", opts);
-        assertPolicy(testUser.getPrincipal(), existingEntries);
-    }
-
-    @Test
-    public void testHandlingIgnoreModeMerge() throws Exception {
-        assumeTrue(isOak());
-        ImportOptions opts = getDefaultOptions();
-        opts.setAccessControlHandling(AccessControlHandling.IGNORE);
-        opts.setImportMode(ImportMode.MERGE);
-
-        extractVaultPackage("/test-packages/principalbased.zip", opts);
-        assertPolicy(testUser.getPrincipal(), existingEntries);
-    }
-
-    @Test
-    public void testHandlingIgnoreModeReplace() throws Exception {
-        assumeTrue(isOak());
-        ImportOptions opts = getDefaultOptions();
-        opts.setAccessControlHandling(AccessControlHandling.IGNORE);
-        opts.setImportMode(ImportMode.REPLACE);
-
-        extractVaultPackage("/test-packages/principalbased.zip", opts);
-        // user may have been moved due to 'replace' mode -> need to retrieve again
-        Principal p = userManager.getAuthorizable(SYSTEM_USER_ID).getPrincipal();
-        assertEquals(0, acMgr.getPolicies(p).length);
-    }
-
-    @Test
-    public void testHandlingOverwriteModeUpdate() throws Exception {
-        assumeTrue(isOak());
-        ImportOptions opts = getDefaultOptions();
-        opts.setAccessControlHandling(AccessControlHandling.OVERWRITE);
-        opts.setImportMode(ImportMode.UPDATE);
-
-        extractVaultPackage("/test-packages/principalbased.zip");
-        assertPolicy(testUser.getPrincipal(), packageEntries);
-    }
-
-    @Test
-    public void testHandlingOverwriteModeMerge() throws Exception {
-        assumeTrue(isOak());
-        ImportOptions opts = getDefaultOptions();
-        opts.setAccessControlHandling(AccessControlHandling.OVERWRITE);
-        opts.setImportMode(ImportMode.MERGE);
-
-        extractVaultPackage("/test-packages/principalbased.zip");
-        assertPolicy(testUser.getPrincipal(), packageEntries);
-    }
-
-    @Test
-    public void testHandlingOverwriteModeReplace() throws Exception {
-        assumeTrue(isOak());
-        ImportOptions opts = getDefaultOptions();
-        opts.setAccessControlHandling(AccessControlHandling.OVERWRITE);
-        opts.setImportMode(ImportMode.REPLACE);
-
-        extractVaultPackage("/test-packages/principalbased.zip");
-        assertPolicy(testUser.getPrincipal(), packageEntries);
-    }
-
-    @Test
-    public void testHandlingMergeModeUpdate() throws Exception {
-        assumeTrue(isOak());
-        ImportOptions opts = getDefaultOptions();
-        opts.setAccessControlHandling(AccessControlHandling.MERGE);
-        opts.setImportMode(ImportMode.UPDATE);
-
-        extractVaultPackage("/test-packages/principalbased.zip", opts);
-
-        List<AccessControlEntry> expected = Lists.newArrayList(existingEntries);
-        expected.addAll(ImmutableList.copyOf(packageEntries));
-        assertPolicy(testUser.getPrincipal(), expected.toArray(new AccessControlEntry[0]));
-    }
-
-    @Test
-    public void testHandlingMergeModeMerge() throws Exception {
-        assumeTrue(isOak());
-        ImportOptions opts = getDefaultOptions();
-        opts.setAccessControlHandling(AccessControlHandling.MERGE);
-        opts.setImportMode(ImportMode.MERGE);
-
-        extractVaultPackage("/test-packages/principalbased.zip", opts);
-
-        List<AccessControlEntry> expected = Lists.newArrayList(existingEntries);
-        expected.addAll(ImmutableList.copyOf(packageEntries));
-        assertPolicy(testUser.getPrincipal(), expected.toArray(new AccessControlEntry[0]));
-    }
-
-    @Test
-    public void testHandlingMergeModeReplace() throws Exception {
-        assumeTrue(isOak());
-        ImportOptions opts = getDefaultOptions();
-        opts.setAccessControlHandling(AccessControlHandling.MERGE);
-        opts.setImportMode(ImportMode.REPLACE);
-
-        extractVaultPackage("/test-packages/principalbased.zip", opts);
-
-        // user may have been moved due to 'replace' mode -> need to retrieve again
-        assertPolicy(userManager.getAuthorizable(SYSTEM_USER_ID).getPrincipal(), packageEntries);
-    }
-
-    @Test
-    public void testHandlingMergePreserveModeUpdate() throws Exception {
-        assumeTrue(isOak());
-        ImportOptions opts = getDefaultOptions();
-        opts.setAccessControlHandling(AccessControlHandling.MERGE_PRESERVE);
-        opts.setImportMode(ImportMode.UPDATE);
-
-        extractVaultPackage("/test-packages/principalbased.zip", opts);
-        assertPolicy(testUser.getPrincipal(), existingEntries);
-    }
-
-    @Test
-    public void testHandlingMergePreserveModeMerge() throws Exception {
-        assumeTrue(isOak());
-        ImportOptions opts = getDefaultOptions();
-        opts.setAccessControlHandling(AccessControlHandling.MERGE_PRESERVE);
-        opts.setImportMode(ImportMode.MERGE);
-
-        extractVaultPackage("/test-packages/principalbased.zip", opts);
-        assertPolicy(testUser.getPrincipal(), existingEntries);
-    }
-
-    @Test
-    public void testHandlingMergePreserveModeReplace() throws Exception {
-        assumeTrue(isOak());
-        ImportOptions opts = getDefaultOptions();
-        opts.setAccessControlHandling(AccessControlHandling.MERGE_PRESERVE);
-        opts.setImportMode(ImportMode.REPLACE);
-
-        extractVaultPackage("/test-packages/principalbased.zip", opts);
-        // user may have been moved due to 'replace' mode -> need to retrieve again
-        Principal p = userManager.getAuthorizable(SYSTEM_USER_ID).getPrincipal();
-        assertEquals(0, acMgr.getPolicies(p).length);
-    }
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ReferenceableIdentifiersImportIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ReferenceableIdentifiersImportIT.java
deleted file mode 100644
index 0cf5e2dc..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ReferenceableIdentifiersImportIT.java
+++ /dev/null
@@ -1,418 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertNotEquals;
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.assertNull;
-import static org.junit.Assert.assertThrows;
-import static org.junit.Assert.assertTrue;
-import static org.junit.Assert.fail;
-
-import java.io.IOException;
-import java.util.Arrays;
-import java.util.HashSet;
-import java.util.Set;
-
-import javax.jcr.Node;
-import javax.jcr.PathNotFoundException;
-import javax.jcr.PropertyIterator;
-import javax.jcr.ReferentialIntegrityException;
-import javax.jcr.RepositoryException;
-
-import org.apache.commons.lang3.exception.ExceptionUtils;
-import org.apache.jackrabbit.JcrConstants;
-import org.apache.jackrabbit.commons.JcrUtils;
-import org.apache.jackrabbit.vault.fs.api.IdConflictPolicy;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.junit.Assert;
-import org.junit.Test;
-
-/**
- * Installs a package with the filter: "/tmp/referenceable", mode="replace"
- * The package contains two referenceable nodes:
- * {@code /tmp/referenceable} and
- * {@code /tmp/referenceable/child-referenceable}.
- * Both are setting property {@code someproperty="somevalue"}.
- */
-public class ReferenceableIdentifiersImportIT extends IntegrationTestBase {
-    
-    private static final String PROPERTY_NAME = "someproperty";
-    private static final String PROPERTY_VALUE = "somevalue";
-    private static final String UUID_REFERENCEABLE = "352c89a4-304f-4b87-9bed-e09275597df1";
-    private static final String UUID_REFERENCEABLE_CHILD = "a201bd6b-25b9-4255-b7db-6fc4c3ddb32d";
-
-    @Test
-    public void testOverwriteIdentifierOfReplacedNode() throws RepositoryException, IOException, PackageException {
-        // create referenceable node manually 
-        Node referenceableNode = JcrUtils.getOrCreateByPath("/tmp/referenceable", null, JcrConstants.NT_UNSTRUCTURED, admin, true);
-        referenceableNode.addMixin(JcrConstants.MIX_REFERENCEABLE);
-        
-        // create (non-referenceable) child node
-        JcrUtils.getOrCreateByPath("/tmp/referenceable/child", null, JcrConstants.NT_UNSTRUCTURED, admin, true);
-        admin.save();
-        
-        // check UUID prior package installation
-        assertNotEquals(UUID_REFERENCEABLE, referenceableNode.getIdentifier());
-        
-        // overwrite with new referenceable node (different UUID)
-        extractVaultPackageStrict("/test-packages/referenceable.zip");
-
-        assertNodeExists("/tmp/referenceable");
-        assertProperty("/tmp/referenceable/" + PROPERTY_NAME, PROPERTY_VALUE);
-        // check its UUID
-        Node node = admin.getNode("/tmp/referenceable");
-        //assertEquals(UUID_REFERENCEABLE, node.getIdentifier());
-        node = admin.getNode("/tmp/referenceable/child");
-        assertEquals(UUID_REFERENCEABLE_CHILD, node.getIdentifier());
-    }
-
-    @Test
-    public void testIdentifierCollisionOutsideFilter() throws RepositoryException, IOException, PackageException {
-        extractVaultPackageStrict("/test-packages/referenceable.zip");
-
-        assertNodeExists("/tmp/referenceable");
-        // check its UUID
-        Node node = admin.getNode("/tmp/referenceable");
-        assertEquals(UUID_REFERENCEABLE, node.getIdentifier());
-
-        // now move node (it keeps its old ID)
-        admin.move("/tmp/referenceable", "/tmp/referenceable-old");
-        admin.save();
-
-        // install package again (with default policy IdConflictPolicy.FAIL)
-        Exception e = assertThrows(Exception.class, () -> { extractVaultPackageStrict("/test-packages/referenceable.zip"); });
-        assertEquals(ReferentialIntegrityException.class, ExceptionUtils.getRootCause(e).getClass());
-        admin.refresh(false);
-
-        // now try to remove the referenced node (with policy IdConflictPolicy.CREATE_NEW_ID)
-        ImportOptions options = getDefaultOptions();
-        options.setStrict(true);
-        options.setIdConflictPolicy(IdConflictPolicy.CREATE_NEW_ID);
-        extractVaultPackage("/test-packages/referenceable.zip", options);
-        // check its UUID
-        node = admin.getNode("/tmp/referenceable");
-        assertNotEquals(UUID_REFERENCEABLE, node.getIdentifier());
-
-        // now try to remove the referenced node (with default policy IdConflictPolicy.FORCE_REMOVE_CONFLICTING_ID)
-        options.setIdConflictPolicy(IdConflictPolicy.FORCE_REMOVE_CONFLICTING_ID);
-        extractVaultPackage("/test-packages/referenceable.zip", options);
-    }
-
-    @Test
-    public void testIdentifierCollisionInsideFilter() throws RepositoryException, IOException, PackageException {
-        extractVaultPackageStrict("/test-packages/referenceable.zip");
-
-        assertNodeExists("/tmp/referenceable");
-        // check its UUID
-        Node node = admin.getNode("/tmp/referenceable/child");
-        assertEquals(UUID_REFERENCEABLE_CHILD, node.getIdentifier());
-
-        // now move node (it keeps its old ID)
-        admin.move("/tmp/referenceable/child", "/tmp/referenceable/collision");
-        admin.save();
-
-        // now add a reference to the node (which is covered by the filter)
-        Node referenceNode = JcrUtils.getOrCreateByPath("/tmp/referenceable/reference", JcrConstants.NT_UNSTRUCTURED, admin);
-        Node referenceableNode = admin.getNode("/tmp/referenceable/collision");
-        referenceNode.setProperty(PROPERTY_NAME, referenceableNode);
-        admin.save();
-        assertProperty("/tmp/referenceable/reference/" + PROPERTY_NAME, UUID_REFERENCEABLE_CHILD);
-
-        PropertyIterator propIter = referenceableNode.getReferences();
-        assertTrue(propIter.hasNext());
-
-        // install package again (with default policy IdConflictPolicy.FAIL)
-        extractVaultPackageStrict("/test-packages/referenceable.zip");
-        assertNodeExists("/tmp/referenceable");
-        // check its UUID
-        node = admin.getNode("/tmp/referenceable/child");
-        assertEquals(UUID_REFERENCEABLE_CHILD, node.getIdentifier());
-        // now move node (it keeps its old ID)
-        admin.move("/tmp/referenceable/child", "/tmp/referenceable/collision");
-        admin.save();
-
-        // now try to remove the referenced node (with policy IdConflictPolicy.CREATE_NEW_ID)
-        ImportOptions options = getDefaultOptions();
-        options.setStrict(true);
-        options.setIdConflictPolicy(IdConflictPolicy.CREATE_NEW_ID);
-        extractVaultPackage("/test-packages/referenceable.zip", options);
-        // check its UUID
-        node = admin.getNode("/tmp/referenceable/child");
-        assertNotEquals(UUID_REFERENCEABLE_CHILD, node.getIdentifier()); // is a new id
-        // now move node (it keeps its old ID)
-        admin.move("/tmp/referenceable/child", "/tmp/referenceable/collision");
-        admin.save();
-
-        // now try to remove the referenced node (with default policy IdConflictPolicy.FORCE_REMOVE_CONFLICTING_ID)
-        options.setIdConflictPolicy(IdConflictPolicy.FORCE_REMOVE_CONFLICTING_ID);
-        extractVaultPackage("/test-packages/referenceable.zip", options);
-        // check its UUID
-        node = admin.getNode("/tmp/referenceable/child");
-        assertEquals(UUID_REFERENCEABLE_CHILD, node.getIdentifier());
-    }
-
-    @Test
-    public void testIdentifierCollisionInsideFilterWithReferencesOutsideFilter() throws RepositoryException, IOException, PackageException {
-        // initial installation
-        extractVaultPackageStrict("/test-packages/referenceable.zip");
-
-        assertNodeExists("/tmp/referenceable");
-        // check its UUID
-        Node node = admin.getNode("/tmp/referenceable/child");
-        assertEquals(UUID_REFERENCEABLE_CHILD, node.getIdentifier());
-
-        // now move node (it keeps its old ID)
-        admin.move("/tmp/referenceable/child", "/tmp/referenceable/collision");
-        admin.save();
-        
-        // now add a reference to the node (which is not covered by the filter)
-        Node referenceNode = JcrUtils.getOrCreateByPath("/tmp/reference", JcrConstants.NT_UNSTRUCTURED, admin);
-        Node referenceableNode = admin.getNode("/tmp/referenceable/collision");
-        referenceNode.setProperty(PROPERTY_NAME, referenceableNode);
-        admin.save();
-        assertProperty("/tmp/reference/" + PROPERTY_NAME, UUID_REFERENCEABLE_CHILD);
-
-        // install package again (with default policy IdConflictPolicy.FAIL)
-        Exception e = assertThrows(Exception.class, () -> { extractVaultPackageStrict("/test-packages/referenceable.zip"); } );
-        assertEquals(ReferentialIntegrityException.class, e.getClass());
-        admin.refresh(false);
-        assertProperty("/tmp/reference/" + PROPERTY_NAME, UUID_REFERENCEABLE_CHILD);
-        referenceableNode = admin.getNode("/tmp/reference").getProperty(PROPERTY_NAME).getNode();
-        assertEquals("/tmp/referenceable/collision", referenceableNode.getPath());
-
-        // now try to remove the referenced node (with policy IdConflictPolicy.CREATE_NEW_ID)
-        ImportOptions options = getDefaultOptions();
-        options.setStrict(true);
-        options.setIdConflictPolicy(IdConflictPolicy.CREATE_NEW_ID);
-        e = assertThrows(Exception.class, () -> { extractVaultPackage("/test-packages/referenceable.zip", options);});
-        assertEquals(ReferentialIntegrityException.class, e.getClass());
-        admin.refresh(false);
-        assertProperty("/tmp/reference/" + PROPERTY_NAME, UUID_REFERENCEABLE_CHILD);
-        referenceableNode = admin.getNode("/tmp/reference").getProperty(PROPERTY_NAME).getNode();
-        assertEquals("/tmp/referenceable/collision", referenceableNode.getPath());
-
-        // now try to remove the referenced node (with default policy IdConflictPolicy.FORCE_REMOVE_CONFLICTING_ID)
-        options.setIdConflictPolicy(IdConflictPolicy.FORCE_REMOVE_CONFLICTING_ID);
-        extractVaultPackage("/test-packages/referenceable.zip", options);
-        // make sure that reference does still exist but now again points to the original path
-        assertProperty("/tmp/reference/" + PROPERTY_NAME, UUID_REFERENCEABLE_CHILD);
-        referenceableNode = admin.getNode("/tmp/reference").getProperty(PROPERTY_NAME).getNode();
-        assertEquals("/tmp/referenceable/child", referenceableNode.getPath());
-    }
-
-    @Test
-    public void testReplaceReferencedNonConflictingIdentifier() throws RepositoryException, IOException, PackageException {
-        // create referenceable node manually (other identifier)
-        Node referenceableNode = JcrUtils.getOrCreateByPath("/tmp/referenceable", JcrConstants.NT_UNSTRUCTURED, admin);
-        referenceableNode.addMixin(JcrConstants.MIX_REFERENCEABLE);
-        admin.save();
-        String identifier = referenceableNode.getIdentifier();
-
-        // now create REFERENCE property towards referenceable node
-        Node referenceNode = JcrUtils.getOrCreateByPath("/tmp/reference", JcrConstants.NT_UNSTRUCTURED, admin);
-        referenceNode.setProperty(PROPERTY_NAME, referenceableNode);
-        assertProperty("/tmp/reference/" + PROPERTY_NAME, identifier);
-        admin.save();
-
-        // now try to remove the referenced node (with default policy IdConflictPolicy.FAIL)
-        Exception e = assertThrows(Exception.class, () -> { extractVaultPackageStrict("/test-packages/referenceable.zip");});
-        assertEquals(ReferentialIntegrityException.class, ExceptionUtils.getRootCause(e).getClass());
-        admin.refresh(false);
-
-        // now try to remove the referenced node (with policy IdConflictPolicy.CREATE_NEW_ID)
-        ImportOptions options = getDefaultOptions();
-        options.setStrict(true);
-        options.setIdConflictPolicy(IdConflictPolicy.CREATE_NEW_ID);
-        e = assertThrows(Exception.class, () -> { extractVaultPackage("/test-packages/referenceable.zip", options);});
-        assertEquals(ReferentialIntegrityException.class, ExceptionUtils.getRootCause(e).getClass());
-        admin.refresh(false);
-
-        // now try to remove the referenced node (with default policy IdConflictPolicy.FORCE_REMOVE_CONFLICTING_ID)
-        options.setIdConflictPolicy(IdConflictPolicy.FORCE_REMOVE_CONFLICTING_ID);
-        extractVaultPackage("/test-packages/referenceable.zip", options);
-    }
-
-    @Test
-    public void testOverwriteSameReferencedIdentifier() throws RepositoryException, IOException, PackageException {
-        extractVaultPackageStrict("/test-packages/referenceable.zip");
-
-        assertNodeExists("/tmp/referenceable");
-        Node node = admin.getNode("/tmp/referenceable");
-
-        // now create REFERENCE property towards referenceable node
-        Node referenceNode = JcrUtils.getOrCreateByPath("/tmp/reference", JcrConstants.NT_UNSTRUCTURED, admin);
-        referenceNode.setProperty(PROPERTY_NAME, node);
-        assertProperty("/tmp/reference/" + PROPERTY_NAME, UUID_REFERENCEABLE);
-        admin.save();
-
-        // now import again (with default policy IdConflictPolicy.FAIL)
-        extractVaultPackageStrict("/test-packages/referenceable.zip");
-
-        // now try to remove the referenced node (with policy IdConflictPolicy.CREATE_NEW_ID)
-        ImportOptions options = getDefaultOptions();
-        options.setStrict(true);
-        options.setIdConflictPolicy(IdConflictPolicy.CREATE_NEW_ID);
-        extractVaultPackage("/test-packages/referenceable.zip", options);
-
-        // now try to remove the referenced node (with default policy IdConflictPolicy.FORCE_REMOVE_CONFLICTING_ID)
-        options.setIdConflictPolicy(IdConflictPolicy.FORCE_REMOVE_CONFLICTING_ID);
-        extractVaultPackage("/test-packages/referenceable.zip", options);
-    }
-
-    @Test
-    public void testReferentialIntegrity() throws RepositoryException {
-        // create referenceable node manually
-        Node referenceableNode = JcrUtils.getOrCreateByPath("/tmp/referenceable", JcrConstants.NT_UNSTRUCTURED, admin);
-        referenceableNode.addMixin(JcrConstants.MIX_REFERENCEABLE);
-        admin.save();
-        String identifier = referenceableNode.getIdentifier();
-
-        // now create REFERENCE property towards referenceable node
-        Node referenceNode = JcrUtils.getOrCreateByPath("/tmp/reference", JcrConstants.NT_UNSTRUCTURED, admin);
-        referenceNode.setProperty(PROPERTY_NAME, referenceableNode);
-        assertProperty("/tmp/reference/" + PROPERTY_NAME, identifier);
-        admin.save();
-
-        // try to remove referenceable node -> fails with RIE
-        Assert.assertThrows(ReferentialIntegrityException.class, () -> { referenceableNode.remove();  admin.save();});
-    }
-
-    // tests that import the variant referenceable-dup, which contains a
-    // duplicate node "duplicate" with the same jcr:uuid as "referenceable"
-
-    @Test
-    public void testImportDupPolicyFail() throws RepositoryException, IOException, PackageException {
-        // TODO: this is supposed to fail the installation
-        testImportDup(IdConflictPolicy.FAIL);
-        Node referenceableNode = getNodeOrNull("/tmp/differentparentconflicts/referenceable/child");
-        Node duplicateNode = getNodeOrNull("/tmp/differentparentconflicts/duplicate/child");
-        if (duplicateNode == null && referenceableNode != null) {
-            assertTrue(referenceableNode.isNodeType(JcrConstants.MIX_REFERENCEABLE));
-            assertEquals(referenceableNode.getIdentifier(), UUID_REFERENCEABLE_CHILD);
-        } else if (duplicateNode != null && referenceableNode == null) {
-            assertTrue(duplicateNode.isNodeType(JcrConstants.MIX_REFERENCEABLE));
-            assertEquals(duplicateNode.getIdentifier(), UUID_REFERENCEABLE_CHILD);
-        } else {
-            fail("both nodes imported");
-        }
-    }
-
-    @Test
-    public void testImportDupPolicyCreateNewId() throws RepositoryException, IOException, PackageException {
-        testImportDup(IdConflictPolicy.CREATE_NEW_ID);
-        Node referenceableNode = getNodeOrNull("/tmp/differentparentconflicts/referenceable/child");
-        Node duplicateNode = getNodeOrNull("/tmp/differentparentconflicts/duplicate/child");
-        assertNotNull("'duplicate' not imported", duplicateNode);
-        assertNotNull("'referencable' not imported", referenceableNode);
-        assertTrue(referenceableNode.isNodeType(JcrConstants.MIX_REFERENCEABLE));
-        String refref = referenceableNode.getIdentifier();
-        assertTrue(duplicateNode.isNodeType(JcrConstants.MIX_REFERENCEABLE));
-        String dupref = duplicateNode.getIdentifier();
-        assertNotEquals("identifiers should be different", refref, dupref);
-
-        // For this test, Jackrabbit and Oak behave differently; for now, we
-        // just observe the behavior (and the test ensures, that it doesn't
-        // change without us noticing)
-        if (isOak()) {
-            assertTrue("identifiers should be new", !UUID_REFERENCEABLE_CHILD.equals(refref) && !UUID_REFERENCEABLE_CHILD.equals(dupref));
-        } else {
-            int newUUIDs = 0;
-            if (!UUID_REFERENCEABLE_CHILD.equals(refref)) {
-                newUUIDs += 1;
-            }
-            if (!UUID_REFERENCEABLE_CHILD.equals(dupref)) {
-                newUUIDs += 1;
-            }
-            assertEquals("for Jackrabbit classic, exactly one changed UUID was expected", 1, newUUIDs);
-        }
-    }
-
-    @Test
-    public void testImportDupPolicyForceRemove() throws RepositoryException, IOException, PackageException {
-        testImportDup(IdConflictPolicy.FORCE_REMOVE_CONFLICTING_ID);
-        Node referenceableNode = getNodeOrNull("/tmp/differentparentconflicts/referenceable/child");
-        Node duplicateNode = getNodeOrNull("/tmp/differentparentconflicts/duplicate/child");
-        if (duplicateNode == null && referenceableNode != null) {
-            assertTrue(referenceableNode.isNodeType(JcrConstants.MIX_REFERENCEABLE));
-            assertEquals(UUID_REFERENCEABLE_CHILD, referenceableNode.getIdentifier());
-        } else if (duplicateNode != null && referenceableNode == null) {
-            assertTrue(duplicateNode.isNodeType(JcrConstants.MIX_REFERENCEABLE));
-            assertEquals(UUID_REFERENCEABLE_CHILD, duplicateNode.getIdentifier());
-        } else {
-            fail("both nodes imported");
-        }
-    }
-
-    @Test
-    public void testImportDupPolicyLegacy() throws RepositoryException, IOException, PackageException {
-        testImportDup(IdConflictPolicy.LEGACY);
-        // behaviour for same parent conflicts: remove the conflicting one (i.e. the first one) with the new one (references point to new one afterwards)
-        Node referenceableNode = getNodeOrNull("/tmp/sameparentconflicts/referenceable");
-        Node duplicateNode = getNodeOrNull("/tmp/sameparentconflicts/duplicate");
-        if (duplicateNode == null && referenceableNode != null) {
-            assertTrue(referenceableNode.isNodeType(JcrConstants.MIX_REFERENCEABLE));
-            assertEquals(UUID_REFERENCEABLE, referenceableNode.getIdentifier());
-            admin.move(referenceableNode.getPath(), "/tmp/sameparentconflicts/referenceable-outsidepackage");
-        } else if (duplicateNode != null && referenceableNode == null) {
-            assertTrue(duplicateNode.isNodeType(JcrConstants.MIX_REFERENCEABLE));
-            assertEquals(UUID_REFERENCEABLE, duplicateNode.getIdentifier());
-            admin.move(duplicateNode.getPath(), "/tmp/sameparentconflicts/referenceable-outsidepackage");
-        } else {
-            fail("both nodes imported");
-        }
-        // behaviour for non-sibling conflicts: assign the new one a new UUID
-        referenceableNode = getNodeOrNull("/tmp/differentparentconflicts/referenceable/child");
-        duplicateNode = getNodeOrNull("/tmp/differentparentconflicts/duplicate/child");
-        assertNotNull(referenceableNode);
-        assertNotNull(duplicateNode);
-        assertTrue(referenceableNode.isNodeType(JcrConstants.MIX_REFERENCEABLE));
-        Set<String> uuids = new HashSet<>(Arrays.asList(referenceableNode.getIdentifier(), duplicateNode.getIdentifier()));
-        assertTrue(uuids.contains(UUID_REFERENCEABLE_CHILD)); // one must have kept the old id
-        assertEquals(2, uuids.size());
-
-        // create a reference towards an identifier used by the package (but used now outside the packag filter)
-        referenceableNode = admin.getNode("/tmp/sameparentconflicts/referenceable-outsidepackage");
-        Node referenceNode = JcrUtils.getOrCreateByPath("/tmp/reference", JcrConstants.NT_UNSTRUCTURED, admin);
-        referenceNode.setProperty(PROPERTY_NAME, referenceableNode);
-
-        // now reinstall
-        testImportDup(IdConflictPolicy.LEGACY);
-        referenceableNode = getNodeOrNull("/tmp/sameparentconflicts/referenceable");
-        duplicateNode = getNodeOrNull("/tmp/sameparentconflicts/duplicate");
-        assertNull(referenceableNode); // package must not contain new conflicting nodes
-        assertNull(duplicateNode);
-    }
-
-    private Node getNodeOrNull(String path) throws RepositoryException {
-        try {
-            return admin.getNode(path);
-        } catch (PathNotFoundException ex) {
-            return null;
-        }
-    }
-
-    private void testImportDup(IdConflictPolicy policy) throws IOException, PackageException, RepositoryException {
-        ImportOptions options = getDefaultOptions();
-        options.setStrict(true);
-        options.setIdConflictPolicy(policy);
-        extractVaultPackage("/test-packages/referenceable-dup.zip", options);
-    }
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ResolveDependencyIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ResolveDependencyIT.java
deleted file mode 100644
index 4f74dc27..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ResolveDependencyIT.java
+++ /dev/null
@@ -1,84 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.IOException;
-
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.vault.packaging.Dependency;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.PackageId;
-import org.junit.Test;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertNotNull;
-
-public class ResolveDependencyIT extends IntegrationTestBase {
-
-    /**
-     * Installs some packages and tests the resolve method
-     */
-    @Test
-    public void testResolve() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/package_1.0.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        pack = packMgr.upload(getStream("/test-packages/package_2.0.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        pack = packMgr.upload(getStream("/test-packages/empty_tmp.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        PackageId id = packMgr.resolve(Dependency.fromString("my_packages:package:[1.0,2.0]"), true);
-        assertEquals(PackageId.fromString("my_packages:package:2.0"), id);
-
-        id = packMgr.resolve(Dependency.fromString("my_packages:package:[1.0,2.0)"), true);
-        assertEquals(PackageId.fromString("my_packages:package:1.0"), id);
-    }
-
-    /**
-     * uploads and installs some packages and tests the resolve method
-     */
-    @Test
-    public void testResolvePartial() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/package_1.0.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        pack = packMgr.upload(getStream("/test-packages/package_2.0.zip"), false);
-        assertNotNull(pack);
-        // do NOT install
-        //pack.install(getDefaultOptions());
-
-        pack = packMgr.upload(getStream("/test-packages/empty_tmp.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        PackageId id = packMgr.resolve(Dependency.fromString("my_packages:package:[1.0,2.0]"), true);
-        assertEquals(PackageId.fromString("my_packages:package:1.0"), id);
-
-        id = packMgr.resolve(Dependency.fromString("my_packages:package:[1.0,2.0]"), false);
-        assertEquals(PackageId.fromString("my_packages:package:2.0"), id);
-
-    }
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/SerializationIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/SerializationIT.java
deleted file mode 100644
index 85d86055..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/SerializationIT.java
+++ /dev/null
@@ -1,136 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.assertTrue;
-
-import java.io.File;
-import java.io.IOException;
-import java.util.Properties;
-
-import javax.jcr.Node;
-import javax.jcr.RepositoryException;
-import javax.jcr.nodetype.NodeType;
-
-import org.apache.commons.io.IOUtils;
-import org.apache.jackrabbit.util.ISO9075;
-import org.apache.jackrabbit.vault.fs.api.PathFilterSet;
-import org.apache.jackrabbit.vault.fs.config.DefaultMetaInf;
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.apache.jackrabbit.vault.fs.io.Archive;
-import org.apache.jackrabbit.vault.packaging.ExportOptions;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.VaultPackage;
-import org.junit.Test;
-
-public class SerializationIT extends IntegrationTestBase {
-
-    @Test
-    public void exportJcrXmlTest() throws RepositoryException, IOException, PackageException {
-        Node testRoot = admin.getRootNode().addNode("testroot", NodeType.NT_UNSTRUCTURED);
-        Node nodeA = testRoot.addNode("a", NodeType.NT_UNSTRUCTURED);
-        Node xmlText = nodeA.addNode("jcr:xmltext", NodeType.NT_UNSTRUCTURED);
-        xmlText.setProperty("jcr:xmlcharacters", "Hello, World.");
-        admin.save();
-
-        ExportOptions opts = new ExportOptions();
-        DefaultMetaInf inf = new DefaultMetaInf();
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/testroot/a"));
-        inf.setFilter(filter);
-        Properties props = new Properties();
-        props.setProperty(VaultPackage.NAME_GROUP, "jackrabbit/test");
-        props.setProperty(VaultPackage.NAME_NAME, "test-package");
-        inf.setProperties(props);
-
-        opts.setMetaInf(inf);
-        File tmpFile = File.createTempFile("vaulttest", "zip");
-        VaultPackage pkg = packMgr.assemble(admin, opts, tmpFile);
-
-        // check if entries are present
-        Archive.Entry e = pkg.getArchive().getEntry("/jcr_root/testroot/.content.xml");
-        assertNotNull("entry should exist", e);
-        String src = IOUtils.toString(pkg.getArchive().getInputSource(e).getByteStream(), "utf-8");
-        String expected =
-                "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
-                        "<jcr:root xmlns:jcr=\"http://www.jcp.org/jcr/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\"\n" +
-                        "    jcr:primaryType=\"nt:unstructured\">\n" +
-                        "    <a jcr:primaryType=\"nt:unstructured\">\n" +
-                        "        <jcr:xmltext\n" +
-                        "            jcr:primaryType=\"nt:unstructured\"\n" +
-                        "            jcr:xmlcharacters=\"Hello, World.\"/>\n" +
-                        "    </a>\n" +
-                        "</jcr:root>\n";
-        assertEquals("content.xml must be correct", expected, src);
-        pkg.close();
-        tmpFile.delete();
-    }
-
-    @Test
-    public void exportProblematicWhitespaceTest() throws RepositoryException, IOException, PackageException {
-        // name containing non-ASCII whitespace character; disallowed in
-        // Jackrabbit Classic, allowed in Jackrabbit Oak
-        String testName = "x\u200ay";
-        try {
-            Node testRoot = admin.getRootNode().addNode("testroot", NodeType.NT_UNSTRUCTURED);
-            testRoot.addNode(testName, NodeType.NT_UNSTRUCTURED);
-            admin.save();
-        }
-        catch (RepositoryException ex) {
-            // if we can't add that node, there's nothing to test
-            return;
-        }
-
-        String encodedName = ISO9075.encode(testName);
-        ExportOptions opts = new ExportOptions();
-        DefaultMetaInf inf = new DefaultMetaInf();
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        filter.add(new PathFilterSet("/testroot/a"));
-        inf.setFilter(filter);
-        Properties props = new Properties();
-        props.setProperty(VaultPackage.NAME_GROUP, "jackrabbit/test");
-        props.setProperty(VaultPackage.NAME_NAME, "test-package");
-        inf.setProperties(props);
-
-        opts.setMetaInf(inf);
-        File tmpFile = File.createTempFile("vaulttest", "zip");
-        try {
-            VaultPackage pkg = packMgr.assemble(admin, opts, tmpFile);
-
-            // check if entries are present
-            Archive.Entry e = pkg.getArchive().getEntry("/jcr_root/testroot/.content.xml");
-            assertNotNull("entry should exist", e);
-            String src = IOUtils.toString(pkg.getArchive().getInputSource(e).getByteStream(), "utf-8");
-            String expected =
-                    "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
-                            "<jcr:root xmlns:jcr=\"http://www.jcp.org/jcr/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\"\n" +
-                            "    jcr:primaryType=\"nt:unstructured\">\n" +
-                            "    <" + encodedName + "/>\n" +
-                            "</jcr:root>\n";
-            assertEquals("content.xml must be correct, containing '" + encodedName + "'", expected, src);
-            pkg.close();
-        } catch (RepositoryException ex) {
-            // expected until JCRVLT-700 is resolved
-            assertTrue(ex.getMessage().contains("not allowed in name"));
-        }
-
-        tmpFile.delete();
-    }
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/SimpleFileAggregateInPackageIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/SimpleFileAggregateInPackageIT.java
deleted file mode 100644
index 3d60fc8f..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/SimpleFileAggregateInPackageIT.java
+++ /dev/null
@@ -1,47 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.IOException;
-
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.junit.Test;
-
-public class SimpleFileAggregateInPackageIT extends IntegrationTestBase {
-
-    @Test
-    public void testSimpleFileAggregateOverwritesChildNodes()
-            throws RepositoryException, IOException, PackageException {
-        assertNodeMissing("/testroot");
-
-        extractVaultPackage("/test-packages/simple_file_aggregate_with_children.zip");
-
-        // test if nodes exist
-        assertNodeExists("/testroot/thumbnail.png");
-        assertNodeExists("/testroot/thumbnail.png/jcr:content/dam:thumbnails/dam:thumbnail_48.png");
-
-        extractVaultPackage("/test-packages/simple_file_aggregate_without_children.zip");
-
-        assertNodeExists("/testroot/thumbnail.png");
-        assertNodeMissing("/testroot/thumbnail.png/jcr:content/dam:thumbnails");
-
-    }
-
-}
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/SpecialDoublePropertiesIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/SpecialDoublePropertiesIT.java
deleted file mode 100644
index 7e3c2fda..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/SpecialDoublePropertiesIT.java
+++ /dev/null
@@ -1,103 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.File;
-import java.io.IOException;
-import java.io.InputStreamReader;
-import java.io.Reader;
-import java.util.Properties;
-
-import javax.jcr.Node;
-import javax.jcr.RepositoryException;
-
-import org.apache.commons.io.IOUtils;
-import org.apache.jackrabbit.vault.fs.api.PathFilterSet;
-import org.apache.jackrabbit.vault.fs.config.DefaultMetaInf;
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.apache.jackrabbit.vault.fs.io.Archive;
-import org.apache.jackrabbit.vault.packaging.ExportOptions;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.VaultPackage;
-import org.junit.Test;
-import org.xml.sax.InputSource;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertNotNull;
-
-public class SpecialDoublePropertiesIT extends IntegrationTestBase {
-
-    @Test
-    public void exportDoubles() throws RepositoryException, IOException, PackageException {
-        Node tmp = admin.getRootNode().addNode("tmp", "nt:unstructured");
-        Node content = tmp.addNode("jcr:content", "nt:unstructured");
-        content.setProperty("double_nan", Double.NaN);
-        content.setProperty("double_pos_inf", Double.POSITIVE_INFINITY);
-        content.setProperty("double_neg_inf", Double.NEGATIVE_INFINITY);
-        admin.save();
-
-        ExportOptions opts = new ExportOptions();
-        DefaultMetaInf inf = new DefaultMetaInf();
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        PathFilterSet set1 = new PathFilterSet("/tmp");
-        filter.add(set1);
-        inf.setFilter(filter);
-        Properties props = new Properties();
-        props.setProperty(VaultPackage.NAME_GROUP, "apache/test");
-        props.setProperty(VaultPackage.NAME_NAME, "test-package");
-        inf.setProperties(props);
-
-        opts.setMetaInf(inf);
-        File tmpFile = File.createTempFile("vaulttest", ".zip");
-        VaultPackage pkg = packMgr.assemble(admin, opts, tmpFile);
-
-        Archive.Entry e = pkg.getArchive().getEntry("jcr_root/tmp/.content.xml");
-        InputSource is = pkg.getArchive().getInputSource(e);
-        try (Reader r = new InputStreamReader(is.getByteStream(), "utf-8")) {
-            String contentXml = IOUtils.toString(r);
-
-            assertEquals("Serialized content",
-                    "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
-                            "<jcr:root xmlns:jcr=\"http://www.jcp.org/jcr/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\"\n" +
-                            "    jcr:primaryType=\"nt:unstructured\">\n" +
-                            "    <jcr:content\n" +
-                            "        jcr:primaryType=\"nt:unstructured\"\n" +
-                            "        double_nan=\"{Double}NaN\"\n" +
-                            "        double_neg_inf=\"{Double}-Infinity\"\n" +
-                            "        double_pos_inf=\"{Double}Infinity\"/>\n" +
-                            "</jcr:root>\n",
-                    contentXml);
-        }
-        pkg.close();
-        tmpFile.delete();
-    }
-
-    @Test
-    public void importDoubles() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/double_properties.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        Node tmp = admin.getNode("/tmp/jcr:content");
-        assertEquals(Double.NaN, tmp.getProperty("double_nan").getDouble(), 0.0);
-        assertEquals(Double.POSITIVE_INFINITY, tmp.getProperty("double_pos_inf").getDouble(), 0.0);
-        assertEquals(Double.NEGATIVE_INFINITY, tmp.getProperty("double_neg_inf").getDouble(), 0.0);
-    }
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/SubPackagesIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/SubPackagesIT.java
deleted file mode 100644
index 05de84a8..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/SubPackagesIT.java
+++ /dev/null
@@ -1,763 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertFalse;
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.assertTrue;
-
-import java.io.IOException;
-import java.util.ArrayList;
-import java.util.Arrays;
-import java.util.Collection;
-import java.util.Collections;
-import java.util.List;
-import java.util.zip.ZipEntry;
-import java.util.zip.ZipInputStream;
-
-import javax.jcr.PathNotFoundException;
-import javax.jcr.RepositoryException;
-
-import org.apache.commons.io.IOUtils;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.packaging.Dependency;
-import org.apache.jackrabbit.vault.packaging.DependencyHandling;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.PackageId;
-import org.apache.jackrabbit.vault.packaging.impl.JcrPackageManagerImpl;
-import org.apache.jackrabbit.vault.packaging.registry.impl.JcrPackageRegistry;
-import org.junit.Before;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.junit.runners.Parameterized;
-
-/**
- * Tests that covers sub packages. the package "my_packages:subtest" contains 2 sub packages
- * "my_packages:sub_a" and "my_packages:sub_b" which each contain 1 node /tmp/a and /tmp/b respectively.
- */
-@RunWith(Parameterized.class)
-public class SubPackagesIT extends IntegrationTestBase {
-
-    @Parameterized.Parameters
-    public static Collection<Object[]> data() {
-        return Arrays.asList(new Object[][]{
-                {new String[]{"/etc/packages"}, false},
-                {new String[]{"/var/packages"}, false},
-                {new String[]{"/var/packages", "/etc/packages"}, false},
-                {new String[]{"/var/packages/deep/path"}, false}
-        });
-    }
-
-    private static final PackageId PACKAGE_ID_SUB_TEST = PackageId.fromString("my_packages:subtest");
-    private static final PackageId PACKAGE_ID_SUB_A_SNAPSHOT = PackageId.fromString("my_packages/.snapshot:sub_a");
-    private static final PackageId PACKAGE_ID_SUB_B_SNAPSHOT = PackageId.fromString("my_packages/.snapshot:sub_b");
-    private static final PackageId PACKAGE_ID_SUB_TEST_10 = PackageId.fromString("my_packages:subtest_test_version:1.0");
-    private static final PackageId PACKAGE_ID_SUB_TEST_101 = PackageId.fromString("my_packages:subtest_test_version:1.0.1");
-
-    private final String[] packageRoots;
-
-    public SubPackagesIT(String[] packageRoots, boolean dummy) {
-        this.packageRoots = packageRoots;
-    }
-
-    @Before
-    public void setUp() throws Exception {
-        super.setUp();
-
-        // overwrite package manager with special root path
-        packMgr = new JcrPackageManagerImpl(admin, packageRoots);
-    }
-
-    /**
-     * Returns the installation path of the package including the ".zip" extension.
-     * @param id the package id
-     * @return the path
-     */
-    public String getInstallationPath(PackageId id) {
-        // make sure we use the one from the test parameter
-        return packageRoots[0] + "/" + ((JcrPackageRegistry)packMgr.getRegistry()).getRelativeInstallationPath(id) + ".zip";
-    }
-
-    /**
-     * Installs a package that contains sub packages non recursive
-     */
-    @Test
-    public void testNonRecursive() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/subtest.zip"), false);
-        assertNotNull(pack);
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        opts.setNonRecursive(true);
-        pack.install(opts);
-
-        // check for sub packages. should be installed below the primary package root
-        assertPackageNodeExists(PACKAGE_ID_SUB_A);
-        assertPackageNodeExists(PACKAGE_ID_SUB_B);
-
-        // check for snapshots
-        assertPackageNodeMissing(PACKAGE_ID_SUB_A_SNAPSHOT);
-        assertPackageNodeMissing(PACKAGE_ID_SUB_B_SNAPSHOT);
-
-        assertNodeMissing("/tmp/a");
-        assertNodeMissing("/tmp/b");
-
-        // check for sub packages dependency
-        String expected = new Dependency(pack.getDefinition().getId()).toString();
-
-        JcrPackage p1 = packMgr.open(PACKAGE_ID_SUB_A);
-        assertEquals("has 1 dependency", 1, p1.getDefinition().getDependencies().length);
-        assertEquals("has dependency to parent package", expected, p1.getDefinition().getDependencies()[0].toString());
-        JcrPackage p2 = packMgr.open(PACKAGE_ID_SUB_B);
-        assertEquals("has 1 dependency", 1, p2.getDefinition().getDependencies().length);
-        assertEquals("has dependency to parent package", expected, p2.getDefinition().getDependencies()[0].toString());
-
-    }
-
-    /**
-     * Installs a package that contains sub packages recursive but has a sub package handling that ignores A
-     */
-    @Test
-    public void testRecursiveIgnoreA() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/subtest_ignore_a.zip"), false);
-        assertNotNull(pack);
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        opts.setNonRecursive(false);
-        pack.install(opts);
-
-        // check for sub packages
-        assertPackageNodeExists(PACKAGE_ID_SUB_A); // todo: ignore should ignore A completely
-        assertPackageNodeExists(PACKAGE_ID_SUB_B);
-
-        assertNodeMissing("/tmp/a");
-        assertNodeExists("/tmp/b");
-    }
-
-    /**
-     * Installs a package that contains sub packages recursive but has a sub package handling that only adds A
-     */
-    @Test
-    public void testRecursiveAddA() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/subtest_add_a.zip"), false);
-        assertNotNull(pack);
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        opts.setNonRecursive(false);
-        pack.install(opts);
-
-        // check for sub packages
-        assertPackageNodeExists(PACKAGE_ID_SUB_A);
-        assertPackageNodeExists(PACKAGE_ID_SUB_B);
-
-        assertNodeMissing("/tmp/a");
-        assertNodeExists("/tmp/b");
-    }
-
-    /**
-     * Installs a package that contains sub packages recursive but has a sub package handling that only extracts A
-     */
-    @Test
-    public void testRecursiveExtractA() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/subtest_extract_a.zip"), false);
-        assertNotNull(pack);
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        opts.setNonRecursive(false);
-        pack.install(opts);
-
-        // check for sub packages
-        assertPackageNodeExists(PACKAGE_ID_SUB_A);
-        assertPackageNodeExists(PACKAGE_ID_SUB_B);
-
-        // check for snapshots
-        assertPackageNodeMissing(PACKAGE_ID_SUB_A_SNAPSHOT);
-        assertPackageNodeExists(PACKAGE_ID_SUB_B_SNAPSHOT);
-
-        assertNodeExists("/tmp/a");
-        assertNodeExists("/tmp/b");
-    }
-
-
-    /**
-     * Installs a package that contains sub packages recursive
-     */
-    @Test
-    public void testRecursive() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/subtest.zip"), false);
-        assertNotNull(pack);
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        opts.setNonRecursive(false);
-        pack.install(opts);
-
-        // check for sub packages
-        assertPackageNodeExists(PACKAGE_ID_SUB_A);
-        assertPackageNodeExists(PACKAGE_ID_SUB_B);
-
-        // check for snapshots
-        assertPackageNodeExists(PACKAGE_ID_SUB_A_SNAPSHOT);
-        assertPackageNodeExists(PACKAGE_ID_SUB_B_SNAPSHOT);
-
-        assertNodeExists("/tmp/a");
-        assertNodeExists("/tmp/b");
-    }
-
-
-    /**
-     * Uninstalls a package that contains sub packages non recursive
-     */
-    @Test
-    public void testUninstallNonRecursive() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/subtest.zip"), false);
-        assertNotNull(pack);
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        opts.setNonRecursive(false);
-        pack.install(opts);
-
-        assertNodeExists("/tmp/a");
-        assertNodeExists("/tmp/b");
-
-        // uninstall
-        opts.setNonRecursive(true);
-        pack.uninstall(opts);
-
-        assertPackageNodeMissing(PACKAGE_ID_SUB_A);
-        assertPackageNodeMissing(PACKAGE_ID_SUB_B);
-        assertNodeExists("/tmp/a");
-        assertNodeExists("/tmp/b");
-
-    }
-
-    /**
-     * Uninstalls a package that contains sub packages recursive
-     */
-    @Test
-    public void testUninstallRecursive() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/subtest.zip"), false);
-        assertNotNull(pack);
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        opts.setNonRecursive(false);
-        pack.install(opts);
-
-        assertNodeExists("/tmp/a");
-        assertNodeExists("/tmp/b");
-
-        // uninstall
-        opts.setNonRecursive(false);
-        pack.uninstall(opts);
-
-        assertPackageNodeMissing(PACKAGE_ID_SUB_A);
-        assertPackageNodeMissing(PACKAGE_ID_SUB_B);
-        assertNodeMissing("/tmp/a");
-        assertNodeMissing("/tmp/b");
-
-    }
-
-    /**
-     * Tests if non-recursive extraction clears the installed state (JCRVLT-114)
-     */
-    @Test
-    public void testNonRecursiveClearsInstalledState() throws RepositoryException, IOException, PackageException {
-        JcrPackage packNewer = packMgr.upload(getStream("/test-packages/subtest_extract_contains_newer_version.zip"), false);
-        assertNotNull(packNewer);
-
-        // extract the sub packages, but don't install them.
-        ImportOptions opts = getDefaultOptions();
-        opts.setNonRecursive(true);
-        packNewer.install(opts);
-
-        // check for sub packages version 1.0.1 exists but not installed
-        assertNodeMissing("/tmp/a");
-        assertPackageNodeExists(PACKAGE_ID_SUB_TEST_101);
-        assertFalse(packMgr.open(admin.getNode(getInstallationPath(PACKAGE_ID_SUB_TEST_101))).isInstalled());
-    }
-
-    /**
-     * Uninstalls a package that contains sub packages where a snapshot of a sub package was deleted
-     */
-    @Test
-    public void testUninstallMissingSnapshot() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/subtest.zip"), false);
-        assertNotNull(pack);
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        opts.setNonRecursive(false);
-        pack.install(opts);
-
-        assertNodeExists("/tmp/a");
-        assertNodeExists("/tmp/b");
-
-        admin.getNode(getInstallationPath(PACKAGE_ID_SUB_A_SNAPSHOT)).remove();
-        admin.save();
-
-        // uninstall
-        opts.setNonRecursive(false);
-        pack.uninstall(opts);
-
-        assertPackageNodeMissing(PACKAGE_ID_SUB_A);
-        assertPackageNodeMissing(PACKAGE_ID_SUB_B);
-        assertNodeExists("/tmp/a");
-        assertNodeMissing("/tmp/b");
-
-    }
-
-    /**
-     * Installs 2 packages that contains same sub packages with different version
-     */
-    @Test
-    public void testSkipOlderVersionInstallation() throws RepositoryException, IOException, PackageException {
-        JcrPackage packNewer = packMgr.upload(getStream("/test-packages/subtest_extract_contains_newer_version.zip"), false);
-        assertNotNull(packNewer);
-
-        // install package that contains newer version of the sub package first
-        ImportOptions opts = getDefaultOptions();
-        opts.setNonRecursive(false);
-        packNewer.install(opts);
-
-        // check for sub packages version 1.0.1 exists
-        assertPackageNodeExists(PACKAGE_ID_SUB_TEST_101);
-        assertTrue(packMgr.open(admin.getNode(getInstallationPath(PACKAGE_ID_SUB_TEST_101))).isInstalled());
-        assertNodeExists("/tmp/b");
-
-        opts = getDefaultOptions();
-        opts.setNonRecursive(false);
-        JcrPackage packOlder = packMgr.upload(getStream("/test-packages/subtest_extract_contains_older_version.zip"), false);
-        packOlder.install(opts);
-        assertPackageNodeExists(PACKAGE_ID_SUB_TEST_10);
-        assertFalse(packMgr.open(admin.getNode(getInstallationPath(PACKAGE_ID_SUB_TEST_10))).isInstalled());
-        assertNodeMissing("/tmp/a");
-
-    }
-
-    /**
-     * Tests if skipping sub packages only works for installed packages
-     */
-    @Test
-    public void testNotSkipOlderVersionInstallation() throws RepositoryException, IOException, PackageException {
-        JcrPackage packNewer = packMgr.upload(getStream("/test-packages/subtest_extract_contains_newer_version.zip"), false);
-        assertNotNull(packNewer);
-
-        // extract the sub packages, but don't install them.
-        ImportOptions opts = getDefaultOptions();
-        opts.setNonRecursive(true);
-        packNewer.install(opts);
-
-        // check for sub packages version 1.0.1 exists but not installed
-        assertNodeMissing("/tmp/a");
-        assertPackageNodeExists(PACKAGE_ID_SUB_TEST_101);
-        assertFalse(packMgr.open(admin.getNode(getInstallationPath(PACKAGE_ID_SUB_TEST_101))).isInstalled());
-
-        opts = getDefaultOptions();
-        opts.setNonRecursive(false);
-        JcrPackage packOlder = packMgr.upload(getStream("/test-packages/subtest_extract_contains_older_version.zip"), false);
-        packOlder.install(opts);
-        assertPackageNodeExists(PACKAGE_ID_SUB_TEST_10);
-        assertTrue(packMgr.open(admin.getNode(getInstallationPath(PACKAGE_ID_SUB_TEST_10))).isInstalled());
-        assertNodeExists("/tmp/a");
-    }
-
-    @Test
-    public void testDowngradeInstallationOfSubpackages() throws PathNotFoundException, RepositoryException, IOException, PackageException {
-        try (JcrPackage packNewer = packMgr.upload(getStream("/test-packages/subtest_extract_contains_newer_version.zip"), false)) {
-            assertNotNull(packNewer);
-    
-            // install package that contains newer version of the sub package first
-            ImportOptions opts = getDefaultOptions();
-            packNewer.install(opts);
-        }
-        // check for sub packages version 1.0.1 exists
-        assertPackageNodeExists(PACKAGE_ID_SUB_TEST_101);
-        try (JcrPackage subPackage = packMgr.open(admin.getNode(getInstallationPath(PACKAGE_ID_SUB_TEST_101)))) {
-            assertTrue(subPackage.isInstalled());
-        }
-        assertNodeExists("/tmp/b");
-        
-        // now install package which is supposed to downgrade
-        try (JcrPackage packOlder = packMgr.upload(getStream("/test-packages/subtest_extract_contains_older_version_force_downgrade.zip"), false)) {
-            assertNotNull(packOlder);
-            packOlder.install(getDefaultOptions());
-        }
-        assertPackageNodeExists(PACKAGE_ID_SUB_TEST_10);
-        try (JcrPackage subPackage = packMgr.open(admin.getNode(getInstallationPath(PACKAGE_ID_SUB_TEST_10)))) {
-            assertTrue("Older Subpackage is not installed, although it is explicitly requested to downgrade", subPackage.isInstalled());
-        }
-        assertNodeExists("/tmp/a");
-    }
-
-    /**
-     * Test if subpackage extraction works
-     */
-    @Test
-    public void testPackageExtract() throws IOException, RepositoryException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/subtest.zip"), false);
-        assertNotNull(pack);
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        PackageId[] ids = pack.extractSubpackages(opts);
-
-        // check for sub packages
-        assertPackageNodeExists(PACKAGE_ID_SUB_A);
-        assertPackageNodeExists(PACKAGE_ID_SUB_B);
-
-        assertEquals("Package Id", ids[0], PACKAGE_ID_SUB_A);
-        assertEquals("Package Id", ids[1], PACKAGE_ID_SUB_B);
-    }
-
-    /**
-     * Test if subpackage extraction works twice
-     */
-    @Test
-    public void testPackageExtractTwice() throws IOException, RepositoryException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/subtest.zip"), false);
-        assertNotNull(pack);
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        PackageId[] ids = pack.extractSubpackages(opts);
-        PackageId pid = ids[0];
-        JcrPackage subPackage = packMgr.open(pid);
-        subPackage.install(opts);
-        assertTrue("Package is installed", subPackage.isInstalled());
-
-        ids = pack.extractSubpackages(opts);
-        assertEquals("Package Id", ids[0], PACKAGE_ID_SUB_A);
-        assertEquals("Package Id", ids[1], PACKAGE_ID_SUB_B);
-
-        subPackage = packMgr.open(pid);
-        subPackage.install(opts);
-        assertTrue("Package is still installed", subPackage.isInstalled());
-    }
-
-    /**
-     * Test if extracted sub-packages have their parent package as dependency, even if not specified in their properties.
-     * but not, if the parent package has no content or no nodetypes.
-     */
-    @Test
-    public void testSubPackageDependency() throws IOException, RepositoryException, PackageException {
-        // install other package that provides sling node type
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_a-1.0.zip"), false);
-        ImportOptions opts = getDefaultOptions();
-        pack.install(opts);
-        assertTrue(admin.getWorkspace().getNodeTypeManager().hasNodeType("sling:Folder"));
-
-        pack = packMgr.upload(getStream("/test-packages/subtest.zip"), false);
-        assertNotNull(pack);
-
-        // install
-        opts = getDefaultOptions();
-        pack.extractSubpackages(opts);
-
-        JcrPackage p1 = packMgr.open(admin.getNode(getInstallationPath(PACKAGE_ID_SUB_A)));
-        assertEquals("has 0 dependency", 0, p1.getDefinition().getDependencies().length);
-
-        JcrPackage p2 = packMgr.open(admin.getNode(getInstallationPath(PACKAGE_ID_SUB_B)));
-        assertEquals("has 0 dependency", 0, p2.getDefinition().getDependencies().length);
-
-        // parent package should node be be installed.
-        assertEquals("Parent package with not content should be marked as installed.", true, pack.isInstalled());
-    }
-
-    /**
-     * Test if extracted sub-packages inherit the dependencies of their parent packages.
-     */
-    @Test
-    public void testSubPackageInheritDependency() throws IOException, RepositoryException, PackageException {
-        // install other package that provides sling node type
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_a-1.0.zip"), false);
-        ImportOptions opts = getDefaultOptions();
-        pack.install(opts);
-        assertTrue(admin.getWorkspace().getNodeTypeManager().hasNodeType("sling:Folder"));
-
-        pack = packMgr.upload(getStream("/test-packages/subtest_inherit_dep.zip"), false);
-        assertNotNull(pack);
-
-        // install
-        opts = getDefaultOptions();
-        pack.extractSubpackages(opts);
-
-        // check for sub packages dependency
-        String expected = "testGroup:testName:[1.0,2.0]";
-
-        JcrPackage p1 = packMgr.open(PACKAGE_ID_SUB_A);
-        assertEquals("has 1 dependency", 1, p1.getDefinition().getDependencies().length);
-        assertEquals("has dep inherited from parent", expected, p1.getDefinition().getDependencies()[0].toString());
-
-        JcrPackage p2 = packMgr.open(PACKAGE_ID_SUB_B);
-        assertEquals("has 1 dependency", 1, p2.getDefinition().getDependencies().length);
-        assertEquals("has dep inherited from parent", expected, p2.getDefinition().getDependencies()[0].toString());
-
-        // parent package should node be be installed.
-        assertEquals("Parent package with not content should be marked as installed.", true, pack.isInstalled());
-    }
-
-    /**
-     * Test if extracted sub-packages have their parent package as dependency, even if not specified in their properties.
-     * but only if the parent package has content
-     */
-    @Test
-    public void testSubPackageWithContentDependency() throws IOException, RepositoryException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/subtest_with_content.zip"), false);
-        assertNotNull(pack);
-        PackageId pId = pack.getDefinition().getId();
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        pack.extractSubpackages(opts);
-
-        // check for sub packages dependency
-        String expected = new Dependency(pId).toString();
-
-        JcrPackage p1 = packMgr.open(admin.getNode(getInstallationPath(PACKAGE_ID_SUB_A)));
-        assertEquals("has 1 dependency", 1, p1.getDefinition().getDependencies().length);
-        assertEquals("has dependency to parent package", expected, p1.getDefinition().getDependencies()[0].toString());
-        JcrPackage p2 = packMgr.open(admin.getNode(getInstallationPath(PACKAGE_ID_SUB_B)));
-        assertEquals("has 1 dependency", 1, p2.getDefinition().getDependencies().length);
-        assertEquals("has dependency to parent package", expected, p2.getDefinition().getDependencies()[0].toString());
-
-        // parent package should not be installed.
-        assertEquals("Parent package with content should not be marked as installed.", false, pack.isInstalled());
-    }
-
-    /**
-     * Test if extracted sub-packages have their parent package as dependency, even if not specified in their properties.
-     * but only if the parent package has nodetypes
-     */
-    @Test
-    public void testSubPackageWithNodeTypesDependency() throws IOException, RepositoryException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/subtest_with_nodetypes.zip"), false);
-        assertNotNull(pack);
-        PackageId pId = pack.getDefinition().getId();
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        pack.extractSubpackages(opts);
-
-        // check for sub packages dependency
-        String expected = new Dependency(pId).toString();
-
-        JcrPackage p1 = packMgr.open(admin.getNode(getInstallationPath(PACKAGE_ID_SUB_A)));
-        assertEquals("has 1 dependency", 1, p1.getDefinition().getDependencies().length);
-        assertEquals("has dependency to parent package", expected, p1.getDefinition().getDependencies()[0].toString());
-        JcrPackage p2 = packMgr.open(admin.getNode(getInstallationPath(PACKAGE_ID_SUB_B)));
-        assertEquals("has 1 dependency", 1, p2.getDefinition().getDependencies().length);
-        assertEquals("has dependency to parent package", expected, p2.getDefinition().getDependencies()[0].toString());
-
-        // parent package should not be installed.
-        assertEquals("Parent package with content should not be marked as installed.", false, pack.isInstalled());
-    }
-
-    /**
-     * Test if subpackage extraction works recursively
-     */
-    @Test
-    public void testRecursivePackageExtract() throws IOException, RepositoryException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/subsubtest.zip"), false);
-        assertNotNull(pack);
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        opts.setNonRecursive(false);
-        PackageId[] ids = pack.extractSubpackages(opts);
-
-        // check for sub packages
-        assertPackageNodeExists(PACKAGE_ID_SUB_TEST);
-        assertPackageNodeExists(PACKAGE_ID_SUB_A);
-        assertPackageNodeExists(PACKAGE_ID_SUB_B);
-
-        assertEquals("Package Id", ids[0], PACKAGE_ID_SUB_A);
-        assertEquals("Package Id", ids[1], PACKAGE_ID_SUB_B);
-        assertEquals("Package Id", ids[2], PACKAGE_ID_SUB_TEST);
-    }
-
-    /**
-     * Test if subpackage extraction works non-recursively
-     */
-    @Test
-    public void testNonRecursivePackageExtract() throws IOException, RepositoryException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/subsubtest.zip"), false);
-        assertNotNull(pack);
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        opts.setNonRecursive(true);
-        PackageId[] ids = pack.extractSubpackages(opts);
-
-        // check for sub packages
-        assertPackageNodeExists(PACKAGE_ID_SUB_TEST);
-        assertPackageNodeMissing(PACKAGE_ID_SUB_A);
-        assertPackageNodeMissing(PACKAGE_ID_SUB_B);
-
-        assertEquals("Package Id", ids[0], PACKAGE_ID_SUB_TEST);
-    }
-
-    @Test
-    public void testSubPackageDependency2() throws IOException, RepositoryException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/subsubtest.zip"), false);
-        assertNotNull(pack);
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        pack.extractSubpackages(opts);
-
-        JcrPackage p0 = packMgr.open(admin.getNode(getInstallationPath(PACKAGE_ID_SUB_TEST)));
-        assertEquals("has 0 dependency", 0, p0.getDefinition().getDependencies().length);
-
-        // check for sub packages dependency
-        String expected = new Dependency(p0.getDefinition().getId()).toString();
-        JcrPackage p1 = packMgr.open(admin.getNode(getInstallationPath(PACKAGE_ID_SUB_A)));
-        assertEquals("has 1 dependency", 1, p1.getDefinition().getDependencies().length);
-        assertEquals("has dependency to parent package", expected, p1.getDefinition().getDependencies()[0].toString());
-        JcrPackage p2 = packMgr.open(admin.getNode(getInstallationPath(PACKAGE_ID_SUB_B)));
-        assertEquals("has 1 dependency", 1, p2.getDefinition().getDependencies().length);
-        assertEquals("has dependency to parent package", expected, p2.getDefinition().getDependencies()[0].toString());
-    }
-
-    @Test
-    public void testInstallingSubPackagesTwice() throws IOException, RepositoryException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/subtest.zip"), true);
-        assertNotNull(pack);
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        opts.setNonRecursive(true);
-        pack.install(opts);
-
-        // install
-        opts = getDefaultOptions();
-        opts.setNonRecursive(true);
-        pack.install(opts);
-    }
-
-    /**
-     * Test if installing and re-creating a package with sub-packages on an alternative path results in the same package again.
-     */
-    @Test
-    public void testRoundTrip() throws IOException, RepositoryException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/subtest.zip"), false);
-        assertNotNull(pack);
-
-        // install
-        ImportOptions opts = getDefaultOptions();
-        opts.setNonRecursive(true);
-        pack.install(opts);
-
-        // create new package
-        JcrPackage pkg = packMgr.open(PACKAGE_ID_SUB_TEST);
-        //
-        packMgr.assemble(pkg, getLoggingProgressTrackerListener());
-
-        try (ZipInputStream in = new ZipInputStream(pkg.getData().getBinary().getStream())) {
-            ZipEntry e;
-            List<String> entries = new ArrayList<>();
-            String filter = "";
-            while ((e = in.getNextEntry()) != null) {
-                entries.add(e.getName());
-                if ("META-INF/vault/filter.xml".equals(e.getName())) {
-                    filter = IOUtils.toString(in, "utf-8");
-                }
-            }
-            Collections.sort(entries);
-            StringBuffer result = new StringBuffer();
-            for (String name: entries) {
-                // exclude some of the entries that depend on the repository setup
-                if ("jcr_root/etc/.content.xml".equals(name)
-                        || "jcr_root/etc/packages/my_packages/.content.xml".equals(name)
-                        || "jcr_root/etc/packages/.content.xml".equals(name)) {
-                    continue;
-                }
-                result.append(name).append("\n");
-            }
-        
-            assertEquals("Filter must be correct",
-                    "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
-                    "<workspaceFilter version=\"1.0\">\n" +
-                    "    <filter root=\"/etc/packages/my_packages/sub_a.zip\"/>\n" +
-                    "    <filter root=\"/etc/packages/my_packages/sub_b.zip\"/>\n" +
-                    "</workspaceFilter>\n", filter);
-    
-            assertEquals("Package must contain proper entries.",
-                    "META-INF/\n" +
-                    "META-INF/MANIFEST.MF\n" +
-                    "META-INF/vault/\n" +
-                    "META-INF/vault/config.xml\n" +
-                    "META-INF/vault/definition/\n" +
-                    "META-INF/vault/definition/.content.xml\n" +
-                    "META-INF/vault/filter.xml\n" +
-                    "META-INF/vault/nodetypes.cnd\n" +
-                    "META-INF/vault/properties.xml\n" +
-                    "jcr_root/.content.xml\n" +
-                    "jcr_root/etc/\n" +
-                    "jcr_root/etc/packages/\n" +
-                    "jcr_root/etc/packages/my_packages/\n" +
-                    "jcr_root/etc/packages/my_packages/sub_a.zip\n" +
-                    "jcr_root/etc/packages/my_packages/sub_a.zip.dir/\n" +
-                    "jcr_root/etc/packages/my_packages/sub_a.zip.dir/.content.xml\n" +
-                    "jcr_root/etc/packages/my_packages/sub_a.zip.dir/_jcr_content/\n" +
-                    "jcr_root/etc/packages/my_packages/sub_a.zip.dir/_jcr_content/_vlt_definition/\n" +
-                    "jcr_root/etc/packages/my_packages/sub_a.zip.dir/_jcr_content/_vlt_definition/.content.xml\n" +
-                    "jcr_root/etc/packages/my_packages/sub_b.zip\n" +
-                    "jcr_root/etc/packages/my_packages/sub_b.zip.dir/\n" +
-                    "jcr_root/etc/packages/my_packages/sub_b.zip.dir/.content.xml\n" +
-                    "jcr_root/etc/packages/my_packages/sub_b.zip.dir/_jcr_content/\n" +
-                    "jcr_root/etc/packages/my_packages/sub_b.zip.dir/_jcr_content/_vlt_definition/\n" +
-                    "jcr_root/etc/packages/my_packages/sub_b.zip.dir/_jcr_content/_vlt_definition/.content.xml\n", result.toString());
-        }
-    }
-
-    /**
-     * Test extracts a multipackage-a-1.0 which contains content and a subpackage. The subpackage will add a dependency
-     * on the parent package. later installs newer version multi-package-a-2.0 which will try to reinstall the subpackage,
-     * but the dependency needs to update. see JCRVLT-264
-     */
-    @Test
-    public void testMixedPackageUpdatesCorrectly() throws Exception {
-       // install 1.0
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/multipackage-a-1.0.zip"), false);
-        assertNotNull(pack);
-
-        ImportOptions opts = getDefaultOptions();
-        pack.install(opts);
-
-        assertNodeExists("/tmp/testroot/sub");
-        assertProperty("/apps/test/version","1.0");
-
-        // install 2.0
-        pack = packMgr.upload(getStream("/test-packages/multipackage-a-2.0.zip"), false);
-        assertNotNull(pack);
-        opts = getDefaultOptions();
-        opts.setDependencyHandling(DependencyHandling.REQUIRED);
-        pack.install(opts);
-
-        assertNodeExists("/tmp/testroot/sub");
-        assertProperty("/apps/test/version","2.0");
-
-    }
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/UserContentPackageIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/UserContentPackageIT.java
deleted file mode 100644
index 22e3c84d..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/UserContentPackageIT.java
+++ /dev/null
@@ -1,518 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.integration;
-
-import java.io.File;
-import java.io.IOException;
-import java.util.Properties;
-
-import javax.jcr.Node;
-import javax.jcr.Property;
-import javax.jcr.RepositoryException;
-import javax.jcr.SimpleCredentials;
-import javax.jcr.nodetype.NodeType;
-
-import org.apache.jackrabbit.api.JackrabbitSession;
-import org.apache.jackrabbit.api.security.user.Authorizable;
-import org.apache.jackrabbit.api.security.user.Group;
-import org.apache.jackrabbit.api.security.user.User;
-import org.apache.jackrabbit.api.security.user.UserManager;
-import org.apache.jackrabbit.core.security.principal.PrincipalImpl;
-import org.apache.jackrabbit.vault.fs.api.ImportMode;
-import org.apache.jackrabbit.vault.fs.api.PathFilterSet;
-import org.apache.jackrabbit.vault.fs.config.DefaultMetaInf;
-import org.apache.jackrabbit.vault.fs.config.DefaultWorkspaceFilter;
-import org.apache.jackrabbit.vault.fs.io.AccessControlHandling;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.packaging.ExportOptions;
-import org.apache.jackrabbit.vault.packaging.JcrPackage;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.VaultPackage;
-import org.apache.jackrabbit.util.Text;
-import org.junit.Assume;
-import org.junit.Test;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.assertNotSame;
-import static org.junit.Assert.assertNull;
-import static org.junit.Assert.assertTrue;
-
-public class UserContentPackageIT extends IntegrationTestBase {
-
-    private static final String PARENT_PATH_TEST_USER_A = "/home/users/test";
-    private static final String ID_TEST_USER_A = "test-user-a";
-    private static final String ID_TEST_PASSWORD = "nonce";
-    private static final String ID_TEST_GROUP_A = "test-group-a";
-    private static final String NAME_USER_PROPERTY = "userProperty";
-    private static final String NAME_PROFILE_FULLNAME = "profile/fullname";
-    private static final String NAME_PROFILE_PROPERTY = "profile/profileProperty";
-    private static final String NAME_PROFILE_NODE = "profile";
-    private static final String NAME_PROFILE_PICTURE_NODE = "profile/picture.txt";
-    private static final String NAME_PROFILE_PRIVATE_NODE = "profile_private";
-
-    @Test
-    public void installUserA() throws RepositoryException, IOException, PackageException {
-        installUserA(null, false, true);
-    }
-
-    @Test
-    public void installUserA_PkgPath() throws RepositoryException, IOException, PackageException {
-        installUserA(null, true, true);
-    }
-
-    @Test
-    public void installUserA_Merge() throws RepositoryException, IOException, PackageException {
-        installUserA(ImportMode.MERGE, false, false);
-    }
-
-    @Test
-    public void installUserA_Merge_PkgPath() throws RepositoryException, IOException, PackageException {
-        installUserA(ImportMode.MERGE, true, true);
-    }
-
-    @Test
-    public void installUserA_Update() throws RepositoryException, IOException, PackageException {
-        installUserA(ImportMode.UPDATE, false, false);
-    }
-
-    @Test
-    public void installUserA_Update_PkgPath() throws RepositoryException, IOException, PackageException {
-        installUserA(ImportMode.UPDATE, true, true);
-    }
-
-    @Test
-    public void installUserA_Replace() throws RepositoryException, IOException, PackageException {
-        installUserA(ImportMode.REPLACE, false, true);
-    }
-
-    @Test
-    public void installUserA_Replace_PkgPath() throws RepositoryException, IOException, PackageException {
-        installUserA(ImportMode.REPLACE, true, true);
-    }
-
-    @Test
-    public void installUserA_Profile() throws RepositoryException, IOException, PackageException {
-        // install default user at package path
-        User userA = installUserA(ImportMode.REPLACE, true, true);
-        String authPath = userA.getPath();
-
-        assertPropertyMissing(authPath + "/" + NAME_PROFILE_PROPERTY);
-
-        // install updated profile
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_user_a_profile.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        assertProperty(authPath + "/" + NAME_PROFILE_FULLNAME, "Test User");
-        assertProperty(authPath + "/" + NAME_PROFILE_PROPERTY, "a");
-    }
-
-    @Test
-    public void installUserA_Profile_NonExistingUser() throws RepositoryException, IOException, PackageException {
-        UserManager mgr = ((JackrabbitSession) admin).getUserManager();
-        assertNull("test-user-a must not exist", mgr.getAuthorizable(ID_TEST_USER_A));
-
-        // install profile
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_user_a_profile.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        Authorizable user = mgr.getAuthorizable(ID_TEST_USER_A);
-        assertNotNull("test-user-a must exist", user);
-
-        // profile must exist
-        assertProperty(user.getPath() + "/" + NAME_PROFILE_PROPERTY, "a");
-    }
-
-    @Test
-    public void installUserA_Profile_Moved() throws RepositoryException, IOException, PackageException {
-        // install default user at package path
-        User userA = installUserA(ImportMode.UPDATE, false, false);
-        String authPath = userA.getPath();
-
-        assertPropertyMissing(authPath + "/" + NAME_PROFILE_PROPERTY);
-
-        // install updated profile
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_user_a_profile.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        assertProperty(authPath + "/" + NAME_PROFILE_FULLNAME, "Test User");
-        assertProperty(authPath + "/" + NAME_PROFILE_PROPERTY, "a");
-    }
-
-    @Test
-    public void installUserA_Profile_Picture() throws RepositoryException, IOException, PackageException {
-        // install default user at package path
-        User userA = installUserA(ImportMode.REPLACE, true, true);
-        String authPath = userA.getPath();
-
-        assertPropertyMissing(authPath + "/" + NAME_PROFILE_PROPERTY);
-
-        // install updated profile
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_user_a_profile_picture.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        assertProperty(authPath + "/" + NAME_PROFILE_FULLNAME, "Test User");
-        assertProperty(authPath + "/" + NAME_PROFILE_PROPERTY, "a");
-        assertNodeExists(authPath + "/" + NAME_PROFILE_PICTURE_NODE);
-    }
-
-    @Test
-    public void installUserA_Profile_Picture_NonExistingUser() throws RepositoryException, IOException, PackageException {
-        UserManager mgr = ((JackrabbitSession) admin).getUserManager();
-        assertNull("test-user-a must not exist", mgr.getAuthorizable(ID_TEST_USER_A));
-
-        // install updated profile
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_user_a_profile_picture.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        Authorizable user = mgr.getAuthorizable(ID_TEST_USER_A);
-        assertNotNull("test-user-a must exist", user);
-
-        // image profile must exist
-        assertNodeExists(user.getPath() + "/" + NAME_PROFILE_PICTURE_NODE);
-    }
-
-    @Test
-    public void installUserA_Profile_Picture_Moved() throws RepositoryException, IOException, PackageException {
-        // install default user at package path
-        User userA = installUserA(ImportMode.UPDATE, false, false);
-        String authPath = userA.getPath();
-
-        assertPropertyMissing(authPath + "/" + NAME_PROFILE_PROPERTY);
-
-        // install updated profile
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_user_a_profile_picture.zip"), false);
-        assertNotNull(pack);
-        pack.install(getDefaultOptions());
-
-        assertProperty(authPath + "/" + NAME_PROFILE_FULLNAME, "Test User");
-        assertProperty(authPath + "/" + NAME_PROFILE_PROPERTY, "a");
-        assertNodeExists(authPath + "/" + NAME_PROFILE_PICTURE_NODE);
-    }
-
-    @Test
-    public void installUserA_Policy_Moved() throws RepositoryException, IOException, PackageException {
-        UserManager mgr = ((JackrabbitSession) admin).getUserManager();
-        assertNull("test-user-a must not exist", mgr.getAuthorizable(ID_TEST_USER_A));
-
-        User u = mgr.createUser(ID_TEST_USER_A, "nonce");
-        String authPath = u.getPath();
-        assertNotSame("authorizable path must be different than the one in the package", PARENT_PATH_TEST_USER_A, Text.getRelativeParent(authPath, 1));
-
-        // assert that user does not have an ACL setup
-        assertPermissionMissing(authPath, true, new String[]{"jcr:all"}, "everyone", null);
-
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_user_a_policy.zip"), false);
-        assertNotNull(pack);
-        ImportOptions opts = getDefaultOptions();
-        opts.setImportMode(ImportMode.MERGE);
-        opts.setAccessControlHandling(AccessControlHandling.MERGE_PRESERVE);
-        pack.install(opts);
-
-        // check if user exists
-        User userA = (User) mgr.getAuthorizable(ID_TEST_USER_A);
-        assertNotNull("test-user-a must exist", userA);
-        authPath = u.getPath();
-
-        // assert that user has an ACL setup
-        assertPermission(authPath, true, new String[]{"jcr:all"}, "everyone", null);
-    }
-
-    /**
-     * Tests if a package that contains 2 sibling user aggregates don't produce a concurrent modification
-     * exception, if the users are remapped. JCRVLT-76
-     */
-    @Test
-    public void install_two_moved_users() throws RepositoryException, IOException, PackageException {
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_two_moved_users.zip"), false);
-        assertNotNull(pack);
-        ImportOptions opts = getDefaultOptions();
-        opts.setImportMode(ImportMode.MERGE);
-        opts.setAccessControlHandling(AccessControlHandling.MERGE_PRESERVE);
-        pack.install(opts);
-    }
-
-
-
-    @Test
-    public void install_mv_property() throws RepositoryException, IOException, PackageException {
-        UserManager mgr = ((JackrabbitSession) admin).getUserManager();
-        User u = mgr.createUser(ID_TEST_USER_A, ID_TEST_PASSWORD);
-        Node node = admin.getNode(u.getPath());
-
-        node.setProperty("mv", new String[]{"mv1", "mv2"});
-        Property property = node.getProperty("mv");
-        assertTrue(property.isMultiple());
-        admin.save();
-
-        File tmpFile = createPackage("test", "test", u.getPath());
-        try {
-            u.remove();
-            u = (User) mgr.getAuthorizable(ID_TEST_USER_A);
-            assertNull(u);
-
-            try (JcrPackage pack = packMgr.upload(tmpFile, true, true, null)) {
-                assertNotNull(pack);
-                ImportOptions opts = getDefaultOptions();
-                pack.install(opts);
-
-                u = (User) mgr.getAuthorizable(ID_TEST_USER_A);
-                assertNotNull(u);
-
-                node = admin.getNode(u.getPath());
-                property = node.getProperty("mv");
-                assertTrue(property.isMultiple());
-            }
-        } finally {
-            tmpFile.delete();
-        }
-    }
-
-    @Test
-    public void install_single_mv_property() throws RepositoryException, IOException, PackageException {
-        UserManager mgr = ((JackrabbitSession) admin).getUserManager();
-        User u = mgr.createUser(ID_TEST_USER_A, ID_TEST_PASSWORD);
-        Node node = admin.getNode(u.getPath());
-
-        node.setProperty("mv", new String[]{"mv1"});
-        Property property = node.getProperty("mv");
-        assertTrue(property.isMultiple());
-        admin.save();
-
-        File tmpFile = createPackage("test", "test", u.getPath());
-        try {
-            u.remove();
-            u = (User)  mgr.getAuthorizable(ID_TEST_USER_A);
-            assertNull(u);
-
-            try (JcrPackage pack = packMgr.upload(tmpFile, true, true, null);) {
-                assertNotNull(pack);
-                ImportOptions opts = getDefaultOptions();
-                pack.install(opts);
-
-                u = (User) mgr.getAuthorizable(ID_TEST_USER_A);
-                assertNotNull(u);
-
-                node = admin.getNode(u.getPath());
-                property = node.getProperty("mv");
-                assertTrue(property.isMultiple());
-            }
-        } finally {
-            tmpFile.delete();
-        }
-    }
-
-    /**
-     * Tests if installing a package using {@link ImportMode#UPDATE} with a user that already exists in the repository
-     * succeeds, even if it has a rep:cache node and is on a different location (JCRVLT-128).
-     */
-    @Test
-    public void install_moved_user_with_rep_cache_update() throws RepositoryException, IOException, PackageException {
-        Assume.assumeTrue(isOak());
-        install_moved_user_with_rep_cache(ImportMode.UPDATE);
-    }
-
-    /**
-     * Tests if installing a package using {@link ImportMode#REPLACE} with a user that already exists in the repository
-     * succeeds, even if it has a rep:cache node and is on a different location (JCRVLT-128).
-     */
-    @Test
-    public void install_moved_user_with_rep_cache_replace() throws RepositoryException, IOException, PackageException {
-        Assume.assumeTrue(isOak());
-        install_moved_user_with_rep_cache(ImportMode.REPLACE);
-    }
-
-    /**
-     * Tests if installing a package using {@link ImportMode#MERGE} with a user that already exists in the repository
-     * succeeds, even if it has a rep:cache node and is on a different location (JCRVLT-128).
-     */
-    @Test
-    public void install_moved_user_with_rep_cache_merge() throws RepositoryException, IOException, PackageException {
-        Assume.assumeTrue(isOak());
-        install_moved_user_with_rep_cache(ImportMode.MERGE);
-    }
-
-    /**
-     * Tests if installing a package using {@link ImportMode#UPDATE} with a package that contains a rep:cache node
-     * and another childnode works (JCRVLT-137).
-     */
-    @Test
-    public void install_user_with_rep_cache_update() throws RepositoryException, IOException, PackageException {
-        Assume.assumeTrue(isOak());
-        install_user_with_rep_cache(ImportMode.UPDATE);
-    }
-
-    /**
-     * Tests if installing a package using {@link ImportMode#REPLACE} with a package that contains a rep:cache node
-     * and another childnode works (JCRVLT-137).
-     */
-    @Test
-    public void install_user_with_rep_cache_replace() throws RepositoryException, IOException, PackageException {
-        Assume.assumeTrue(isOak());
-        install_user_with_rep_cache(ImportMode.REPLACE);
-    }
-
-    /**
-     * Tests if installing a package using {@link ImportMode#MERGE} with a package that contains a rep:cache node
-     * and another childnode works (JCRVLT-137).
-     */
-    @Test
-    public void install_user_with_rep_cache_merge() throws RepositoryException, IOException, PackageException {
-        Assume.assumeTrue(isOak());
-        install_user_with_rep_cache(ImportMode.MERGE);
-    }
-
-    private void install_user_with_rep_cache(ImportMode mode) throws RepositoryException, IOException, PackageException {
-        UserManager mgr = ((JackrabbitSession) admin).getUserManager();
-        assertNull("test-user-a must not exist", mgr.getAuthorizable(ID_TEST_USER_A));
-
-        // install user package
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_user_with_rep_cache.zip"), false);
-        assertNotNull(pack);
-        ImportOptions opts = getDefaultOptions();
-        opts.setImportMode(mode);
-        pack.install(opts);
-
-        // check if user exists
-        User userA = (User) mgr.getAuthorizable(ID_TEST_USER_A);
-        assertNotNull("test-user-a must exist", userA);
-    }
-
-    private void install_moved_user_with_rep_cache(ImportMode mode) throws RepositoryException, IOException, PackageException {
-        UserManager mgr = ((JackrabbitSession) admin).getUserManager();
-        User u = mgr.createUser(ID_TEST_USER_A, ID_TEST_PASSWORD);
-        String newPath = u.getPath() + "_moved";
-        admin.move(u.getPath(), newPath);
-        admin.save();
-
-        Group g = mgr.createGroup(ID_TEST_GROUP_A);
-        g.addMember(u);
-        admin.save();
-
-        // login to the repository to generate some rep:cache nodes
-        repository.login(new SimpleCredentials(ID_TEST_USER_A, ID_TEST_PASSWORD.toCharArray())).logout();
-        admin.refresh(false);
-
-        // ensure that there is a rep:cache node
-        assertNodeExists(newPath + "/rep:cache");
-
-        // install user package
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_user_a.zip"), false);
-        assertNotNull(pack);
-        ImportOptions opts = getDefaultOptions();
-        opts.setImportMode(mode);
-        pack.install(opts);
-
-        // check if user exists
-        User userA = (User) mgr.getAuthorizable(ID_TEST_USER_A);
-        assertNotNull("test-user-a must exist", userA);
-    }
-
-    private User installUserA(ImportMode mode, boolean usePkgPath, boolean expectPkgPath) throws RepositoryException, IOException, PackageException {
-        UserManager mgr = ((JackrabbitSession) admin).getUserManager();
-        assertNull("test-user-a must not exist", mgr.getAuthorizable(ID_TEST_USER_A));
-
-        User u;
-        if (usePkgPath) {
-            u = mgr.createUser(ID_TEST_USER_A, ID_TEST_PASSWORD, new PrincipalImpl(ID_TEST_USER_A), PARENT_PATH_TEST_USER_A);
-        } else {
-            u = mgr.createUser(ID_TEST_USER_A, ID_TEST_PASSWORD);
-        }
-        final String authPath = u.getPath();
-        if (usePkgPath) {
-            assertEquals("authorizable path must be correct", PARENT_PATH_TEST_USER_A, Text.getRelativeParent(authPath, 1));
-        } else {
-            assertNotSame("authorizable path must be different than the one in the package", PARENT_PATH_TEST_USER_A, Text.getRelativeParent(authPath, 1));
-        }
-
-        // create test property and node
-        u.setProperty(NAME_USER_PROPERTY, admin.getValueFactory().createValue("initial"));
-        admin.getNode(u.getPath()).addNode(NAME_PROFILE_PRIVATE_NODE, NodeType.NT_UNSTRUCTURED);
-
-        admin.save();
-
-        JcrPackage pack = packMgr.upload(getStream("/test-packages/test_user_a.zip"), false);
-        assertNotNull(pack);
-        ImportOptions opts = getDefaultOptions();
-        if (mode != null) {
-            opts.setImportMode(mode);
-        }
-        pack.install(opts);
-
-        // check if user exists
-        User userA = (User) mgr.getAuthorizable(ID_TEST_USER_A);
-        assertNotNull("test-user-a must exist", userA);
-
-        // check path
-        if (expectPkgPath) {
-            assertEquals("authorizable path must be correct", PARENT_PATH_TEST_USER_A, Text.getRelativeParent(userA.getPath(), 1));
-        } else {
-            assertEquals("authorizable path must be correct", authPath, userA.getPath());
-        }
-
-        // check import mode dependent stuff
-        if (mode == null || mode == ImportMode.REPLACE) {
-            assertProperty(userA.getPath() + "/" + NAME_USER_PROPERTY, "a");
-            assertProperty(userA.getPath() + "/" + NAME_PROFILE_FULLNAME, "Test User");
-            assertNodeExists(userA.getPath() + "/" + NAME_PROFILE_NODE);
-            assertNodeMissing(userA.getPath() + "/" + NAME_PROFILE_PRIVATE_NODE);
-        } else if (mode == ImportMode.UPDATE) {
-            assertProperty(userA.getPath() + "/" + NAME_USER_PROPERTY, "a");
-            assertProperty(userA.getPath() + "/" + NAME_PROFILE_FULLNAME, "Test User");
-            assertNodeExists(userA.getPath() + "/" + NAME_PROFILE_NODE);
-            assertNodeExists(userA.getPath() + "/" + NAME_PROFILE_PRIVATE_NODE);
-        } else if (mode == ImportMode.MERGE) {
-            assertProperty(userA.getPath() + "/" + NAME_USER_PROPERTY, "initial");
-            assertProperty(userA.getPath() + "/" + NAME_PROFILE_FULLNAME, "Test User");
-            assertNodeExists(userA.getPath() + "/" + NAME_PROFILE_NODE);
-            assertNodeExists(userA.getPath() + "/" + NAME_PROFILE_PRIVATE_NODE);
-        }
-
-        return userA;
-    }
-
-    private File createPackage(String group, String name, String... paths) throws RepositoryException, IOException, PackageException {
-        ExportOptions opts = new ExportOptions();
-        DefaultMetaInf inf = new DefaultMetaInf();
-        DefaultWorkspaceFilter filter = new DefaultWorkspaceFilter();
-        for (String path : paths) {
-            filter.add(new PathFilterSet(path));
-        }
-
-        inf.setFilter(filter);
-        Properties props = new Properties();
-        props.setProperty(VaultPackage.NAME_GROUP, group);
-        props.setProperty(VaultPackage.NAME_NAME, name);
-        inf.setProperties(props);
-
-        opts.setMetaInf(inf);
-
-        File tmpFile = File.createTempFile("vaulttest", ".zip");
-        VaultPackage pkg = packMgr.assemble(admin, opts, tmpFile);
-
-        pkg.close();
-
-        return tmpFile;
-    }
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/registry/impl/FSPackageRegistryIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/registry/impl/FSPackageRegistryIT.java
deleted file mode 100644
index f6e205e1..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/registry/impl/FSPackageRegistryIT.java
+++ /dev/null
@@ -1,751 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.jackrabbit.vault.packaging.registry.impl;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertFalse;
-import static org.junit.Assert.assertNotEquals;
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.assertNull;
-import static org.junit.Assert.assertTrue;
-import static org.junit.Assert.fail;
-
-import java.io.File;
-import java.io.IOException;
-import java.util.Arrays;
-import java.util.Calendar;
-import java.util.Collections;
-import java.util.HashMap;
-import java.util.LinkedList;
-import java.util.List;
-import java.util.Map;
-import java.util.UUID;
-
-import javax.jcr.RepositoryException;
-
-import org.apache.commons.collections4.CollectionUtils;
-import org.apache.commons.io.FileUtils;
-import org.apache.jackrabbit.vault.fs.api.ProgressTrackerListener;
-import org.apache.jackrabbit.vault.fs.io.ImportOptions;
-import org.apache.jackrabbit.vault.packaging.Dependency;
-import org.apache.jackrabbit.vault.packaging.DependencyException;
-import org.apache.jackrabbit.vault.packaging.NoSuchPackageException;
-import org.apache.jackrabbit.vault.packaging.PackageException;
-import org.apache.jackrabbit.vault.packaging.PackageExistsException;
-import org.apache.jackrabbit.vault.packaging.PackageId;
-import org.apache.jackrabbit.vault.packaging.VaultPackage;
-import org.apache.jackrabbit.vault.packaging.integration.IntegrationTestBase;
-import org.apache.jackrabbit.vault.packaging.registry.DependencyReport;
-import org.apache.jackrabbit.vault.packaging.registry.ExecutionPlan;
-import org.apache.jackrabbit.vault.packaging.registry.ExecutionPlanBuilder;
-import org.apache.jackrabbit.vault.packaging.registry.PackageTask;
-import org.apache.jackrabbit.vault.packaging.registry.PackageTask.Type;
-import org.apache.jackrabbit.vault.packaging.registry.RegisteredPackage;
-import org.apache.jackrabbit.vault.packaging.registry.impl.FSPackageRegistry.Config;
-import org.junit.Before;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.rules.TemporaryFolder;
-import org.mockito.Mockito;
-import org.osgi.framework.BundleContext;
-import org.osgi.util.converter.Converter;
-import org.osgi.util.converter.Converters;
-import org.slf4j.Logger;
-import org.slf4j.LoggerFactory;
-
-/**
- * Test the Package registry interface
- */
-public class FSPackageRegistryIT extends IntegrationTestBase {
-
-    private static final File DIR_REGISTRY_HOME = new File("target/fspackageregistry-" + System.getProperty("repoSuffix", "fork1"));
-
-    private static final Logger log = LoggerFactory.getLogger(FSPackageRegistryIT.class);
-
-    public static final String[] APPLICATION_PATHS = {
-            "/libs",
-            "/libs/foo"
-    };
-    
-    public static final String[] CONTENT_PATHS = {
-            "/tmp",
-            "/tmp/foo"
-    };
-    
-    private static final PackageId TEST_PACKAGE_ID = new PackageId("test", "test-package-with-etc", "1.0");
-
-    @Rule
-    public TemporaryFolder tmpFolder = new TemporaryFolder();
-
-    private FSPackageRegistry registry;
-    private File registryHome;
-
-    @Override
-    @Before
-    public void setUp() throws Exception {
-        super.setUp();
-        if (DIR_REGISTRY_HOME.exists()) {
-            FileUtils.cleanDirectory(DIR_REGISTRY_HOME);
-        } else {
-            DIR_REGISTRY_HOME.mkdir();
-        }
-        
-        getFreshRegistry();
-    }
-    
-    /**
-     * checks is a non existent package is really not there
-     */
-    @Test
-    public void testOpenNonExistentPackage() throws IOException, PackageException {
-        assertFalse("package must not exist", registry.contains(TMP_PACKAGE_ID));
-        assertNull("package must not exist", registry.open(TMP_PACKAGE_ID));
-    }
-
-    /**
-     * registers a package via stream
-     */
-    @Test
-    public void testRegisterStream() throws IOException, PackageException {
-        PackageId id = registry.register(getStream("/test-packages/tmp.zip"), false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-
-        try (RegisteredPackage pkg = registry.open(id)) {
-            assertEquals("package id of registered is correct", TMP_PACKAGE_ID, pkg.getId());
-            assertFalse("Package is not installed", pkg.isInstalled());
-        }
-    }
-
-    /**
-     * registers a package twice via stream (replace = false)
-     */
-    @Test
-    public void testRegisterStreamTwiceFails() throws IOException, PackageException {
-        PackageId id = registry.register(getStream("/test-packages/tmp.zip"), false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-
-        try {
-            registry.register(getStream("/test-packages/tmp.zip"), false);
-            fail("registering the package twice should fail");
-        } catch (PackageExistsException e) {
-            // expected
-            assertEquals("colliding pid must be correct", id, e.getId());
-        }
-    }
-
-    /**
-     * registers a package twice via stream (replace = true)
-     */
-    @Test
-    public void testRegisterStreamTwiceSucceeds() throws IOException, PackageException {
-        PackageId id = registry.register(getStream("/test-packages/tmp.zip"), false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-        registry.register(getStream("/test-packages/tmp.zip"), true);
-    }
-
-    /**
-     * registers a package twice via a file
-     */
-    @Test
-    public void testRegisterFileTwiceFails() throws IOException, PackageException {
-        File file = getFile("/test-packages/tmp.zip");
-        PackageId id = registry.register(file, false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-        assertTrue("file should still exist", file.exists());
-
-        try (RegisteredPackage pkg = registry.open(id)) {
-            assertEquals("package id of registered is correct", TMP_PACKAGE_ID, pkg.getId());
-            assertFalse("Package is not installed", pkg.isInstalled());
-        }
-
-        try {
-            registry.register(file, false);
-            fail("registering the package twice should fail");
-        } catch (PackageExistsException e) {
-            // expected
-            assertEquals("colliding pid must be correct", id, e.getId());
-        }
-    }
-
-    /**
-     * registers a package twice via a temp file file
-     */
-    @Test
-    public void testRegisterTempFileTwiceFails() throws IOException, PackageException {
-        File file = getFile("/test-packages/tmp.zip");
-        PackageId id = registry.register(file, false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-
-        try (RegisteredPackage pkg = registry.open(id)) {
-            assertEquals("package id of registered is correct", TMP_PACKAGE_ID, pkg.getId());
-            assertFalse("Package is not installed", pkg.isInstalled());
-        }
-
-        file = getFile("/test-packages/tmp.zip");
-        try {
-            registry.register(file, false);
-            fail("registering the package twice should fail");
-        } catch (PackageExistsException e) {
-            // expected
-            assertEquals("colliding pid must be correct", id, e.getId());
-        }
-    }
-
-    /**
-     * registers a package twice via file (replace = true)
-     */
-    @Test
-    public void testRegisterFileTwiceSucceeds() throws IOException, PackageException {
-        File file = getFile("/test-packages/tmp.zip");
-        PackageId id = registry.register(file, false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-        assertTrue("file should still exist", file.exists());
-        registry.register(file, true);
-        // make sure package is still accessible after original has been deleted
-        try (RegisteredPackage registeredPackage = registry.open(id)) {
-            try (VaultPackage pack = registeredPackage.getPackage()) {
-                assertNotEquals(file, pack.getFile());
-            }
-        }
-    }
-    
-    /**
-     * registers a file as external package twice (replace = false)
-     */
-    @Test
-    public void testRegisterExternalFileTwiceFails() throws IOException, PackageException {
-        File file = getFile("/test-packages/tmp.zip");
-        PackageId id = registry.registerExternal(file, false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-
-        try (RegisteredPackage pkg = registry.open(id)) {
-            assertEquals("package id of registered is correct", TMP_PACKAGE_ID, pkg.getId());
-            assertFalse("Package is not installed", pkg.isInstalled());
-        }
-
-        file = getFile("/test-packages/tmp.zip");
-        try {
-            registry.registerExternal(file, false);
-            fail("registering the package twice should fail");
-        } catch (PackageExistsException e) {
-            // expected
-            assertEquals("colliding pid must be correct", id, e.getId());
-        }
-    }
-    
-    /**
-     * registers a file as external package twice with 
-     */
-    @SuppressWarnings("deprecation")
-    @Test
-    public void testRegisterExternalFileTwiceFailsLoadedRegistry() throws IOException, PackageException {
-        File file = getFile("/test-packages/tmp.zip");
-        PackageId id = registry.registerExternal(file, false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-
-        try (RegisteredPackage pkg = registry.open(id)) {
-            assertEquals("package id of registered is correct", TMP_PACKAGE_ID, pkg.getId());
-            assertFalse("Package is not installed", pkg.isInstalled());
-        }
-        
-        // loading registry again to force loading of metadata from files
-        registry = new FSPackageRegistry(registryHome);
-        
-        try {
-            registry.registerExternal(file, false);
-            fail("registering the package twice should fail");
-        } catch (PackageExistsException e) {
-            // expected
-            assertEquals("colliding pid must be correct", id, e.getId());
-        }
-    }
-
-
-    /**
-     * registers a file as external package twice (replace = false)
-     */
-    @Test
-    public void testRegisterExternalFileTwiceSucceeds() throws IOException, PackageException {
-        File file = getFile("/test-packages/tmp.zip");
-        PackageId id = registry.registerExternal(file, false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-        assertTrue("file should still exist", file.exists());
-        registry.registerExternal(file, true);
-    }
-    
-    /**
-     * registers a file as external package with subpackages (replace = true)
-     */
-    @Test
-    public void testRegisterExternalWithSubPackages() throws IOException, PackageException {
-        File file = getFile("/test-packages/subtest.zip");
-        registry.registerExternal(file, false);
-
-        assertTrue(registry.contains(PACKAGE_ID_SUB_A));
-        assertTrue(registry.contains(PACKAGE_ID_SUB_B));
-    }
-    
-    /**
-     * installs a file as external package with subpackages 
-     * Subpackages are only installed if either explicitly added to executionPlan or another package depends on them.
-     */
-    @Test
-    public void testInstallExternalWithSubPackages() throws IOException, PackageException {
-        File file = getFile("/test-packages/subtest.zip");
-        PackageId parentPkg = registry.registerExternal(file, false);
-        
-        ExecutionPlanBuilder builder = registry.createExecutionPlan();
-        builder.with(new ProgressTrackerListener() {
-            public void onMessage(Mode mode, String action, String path) {
-                log.info("{} {}", action, path);
-            }
-
-            public void onError(Mode mode, String path, Exception e) {
-                log.info("E {} {}", path, e.toString());
-            }
-        });
-        builder.addTask().with(parentPkg).with(Type.EXTRACT);
-        ExecutionPlan plan  = builder.with(admin).execute();
-        assertFalse(plan.hasErrors());
-        
-        assertFalse(registry.open(PACKAGE_ID_SUB_A).isInstalled());
-        assertFalse(registry.open(PACKAGE_ID_SUB_B).isInstalled());
-    }
-
-    @Test
-    public void testInstallExternalUnScoped() throws IOException, PackageException, RepositoryException, org.apache.jackrabbit.oak.segment.file.InvalidFileStoreVersionException {
-        File file = getFile("/test-packages/mixed_package.zip");
-        
-        cleanPaths(APPLICATION_PATHS);
-        cleanPaths(CONTENT_PATHS);
-        getFreshRegistry();
-
-        PackageId pkg = registry.registerExternal(file, false);
-        
-        ExecutionPlanBuilder builder = registry.createExecutionPlan();
-        Collector listener = new Collector();
-        builder.with(listener);
-        builder.addTask().with(pkg).with(Type.EXTRACT);
-        ExecutionPlan plan  = builder.with(admin).execute();
-        assertFalse(plan.hasErrors());
-        checkFiltered(APPLICATION_PATHS, new String[] {}, listener.paths);
-        checkFiltered(CONTENT_PATHS, new String[] {}, listener.paths);
-    }
-
-    @Test
-    public void testInstallExternalContentScoped() throws IOException, PackageException, RepositoryException, org.apache.jackrabbit.oak.segment.file.InvalidFileStoreVersionException {
-        File file = getFile("/test-packages/mixed_package.zip");
-
-        cleanPaths(APPLICATION_PATHS);
-        cleanPaths(CONTENT_PATHS);
-        getFreshRegistry(InstallationScope.CONTENT_SCOPED);
-        
-        PackageId pkg = registry.registerExternal(file, false);
-        
-        ExecutionPlanBuilder builder = registry.createExecutionPlan();
-        Collector listener = new Collector();
-        builder.with(listener);
-        builder.addTask().with(pkg).with(Type.EXTRACT);
-        ExecutionPlan plan  = builder.with(admin).execute();
-        assertFalse(plan.hasErrors());
-        checkFiltered(CONTENT_PATHS, APPLICATION_PATHS, listener.paths);
-    }
-
-    private void cleanPaths(String[] paths) throws IOException, RepositoryException, org.apache.jackrabbit.oak.segment.file.InvalidFileStoreVersionException  {
-        for (String path : paths) {
-            clean(path);
-        }
-    }
-
-    @Test
-    public void testInstallExternalApplicationScoped() throws IOException, PackageException, RepositoryException, org.apache.jackrabbit.oak.segment.file.InvalidFileStoreVersionException {
-        File file = getFile("/test-packages/mixed_package.zip");
-        
-        cleanPaths(APPLICATION_PATHS);
-        cleanPaths(CONTENT_PATHS);
-        getFreshRegistry(InstallationScope.APPLICATION_SCOPED);
-        
-        PackageId pkg = registry.registerExternal(file, false);
-        
-        ExecutionPlanBuilder builder = registry.createExecutionPlan();
-        Collector listener = new Collector();
-        builder.with(listener);
-        builder.addTask().with(pkg).with(Type.EXTRACT);
-        ExecutionPlan plan  = builder.with(admin).execute();
-        assertFalse(plan.hasErrors());
-        checkFiltered(APPLICATION_PATHS, CONTENT_PATHS, listener.paths);
-        
-    }
-    
-
-    /**
-     * test if package removal works
-     */
-    @Test
-    public void testRemovePackage() throws IOException, PackageException {
-        PackageId id = registry.register(getStream("/test-packages/tmp.zip"), false);
-        assertEquals("package id", TMP_PACKAGE_ID, id);
-
-        registry.remove(id);
-        assertFalse("package must not exist", registry.contains(TMP_PACKAGE_ID));
-        assertNull("package must not exist", registry.open(TMP_PACKAGE_ID));
-    }
-
-    /**
-     * test packages set
-     */
-    @Test
-    public void testPackages() throws IOException, PackageException {
-        assertTrue("initially the packages set is empty", registry.packages().isEmpty());
-        registry.register(getStream("/test-packages/tmp.zip"), false);
-        assertEquals("packages contains 1 element", 1, registry.packages().size());
-        assertTrue("contains new package", registry.packages().contains(TMP_PACKAGE_ID));
-    }
-
-    /**
-     * test if remove non existing should fail
-     */
-    @Test
-    public void testRemoveNonExistingPackage() throws IOException, PackageException {
-        try {
-            registry.remove(TMP_PACKAGE_ID);
-            fail("remove non existing should fail");
-        } catch (NoSuchPackageException e) {
-            assertEquals("exception should contain correct package id", TMP_PACKAGE_ID, e.getId());
-        }
-    }
-
-    /**
-     * test if analyze dependencies fails for non existing package
-     */
-    @Test
-    public void testAnalyzeDependenciesFailsForNonExisting() throws IOException {
-        try {
-            registry.analyzeDependencies(TMP_PACKAGE_ID, false);
-            fail("usage report should fail for non existing package.");
-        } catch (NoSuchPackageException e) {
-            assertEquals("exception should contain correct package id", TMP_PACKAGE_ID, e.getId());
-        }
-    }
-
-    /**
-     * test if analyze dependencies is correct for non installed packages
-     */
-    @Test
-    public void testAnalyzeDependencies() throws IOException, PackageException {
-        // a depends on b and c
-        PackageId idA = registry.register(getStream(TEST_PACKAGE_A_10), false);
-
-        DependencyReport report = registry.analyzeDependencies(idA, false);
-        assertEquals("resolved dependencies", "", PackageId.toString(report.getResolvedDependencies()));
-        assertEquals("unresolved dependencies", "my_packages:test_b,my_packages:test_c:[1.0,2.0)",
-                Dependency.toString(report.getUnresolvedDependencies()));
-
-        // b depends on c
-        registry.register(getStream(TEST_PACKAGE_B_10), false);
-        report = registry.analyzeDependencies(idA, false);
-        assertEquals("resolved dependencies", "my_packages:test_b:1.0",
-                PackageId.toString(report.getResolvedDependencies()));
-        assertEquals("unresolved dependencies", "my_packages:test_c:[1.0,2.0)",
-                Dependency.toString(report.getUnresolvedDependencies()));
-
-        registry.register(getStream(TEST_PACKAGE_C_10), false);
-        report = registry.analyzeDependencies(idA, false);
-        assertEquals("resolved dependencies", "my_packages:test_b:1.0,my_packages:test_c:1.0",
-                PackageId.toString(report.getResolvedDependencies()));
-        assertEquals("unresolved dependencies", "", Dependency.toString(report.getUnresolvedDependencies()));
-
-    }
-
-    @Test
-    public void testUnsupportedInstallTasks() throws IOException, PackageException, RepositoryException {
-        // a depends on b and c
-        PackageId idC = registry.register(getStream(TEST_PACKAGE_C_10), false);
-
-        ExecutionPlanBuilder builder = registry.createExecutionPlan();
-        builder.with(new ProgressTrackerListener() {
-            public void onMessage(Mode mode, String action, String path) {
-                log.info("{} {}", action, path);
-            }
-
-            public void onError(Mode mode, String path, Exception e) {
-                log.info("E {} {}", path, e.toString());
-            }
-        });
-
-        builder.addTask().with(idC).with(PackageTask.Type.INSTALL);
-        ExecutionPlan plan  = builder.with(admin).execute();
-        assertTrue(plan.hasErrors());
-        assertFalse(registry.open(idC).isInstalled());
-    }
-
-    @Test
-    public void testExecutionPlanInstallation() throws IOException, PackageException, RepositoryException {
-        // a depends on b and c
-        PackageId idA = registry.register(getStream(TEST_PACKAGE_A_10), false);
-
-        DependencyReport report = registry.analyzeDependencies(idA, false);
-        assertEquals("resolved dependencies", "", PackageId.toString(report.getResolvedDependencies()));
-        assertEquals("unresolved dependencies", "my_packages:test_b,my_packages:test_c:[1.0,2.0)",
-                Dependency.toString(report.getUnresolvedDependencies()));
-
-        // b depends on c
-        PackageId idB = registry.register(getStream(TEST_PACKAGE_B_10), false);
-        report = registry.analyzeDependencies(idB, false);
-        assertEquals("resolved dependencies", "", PackageId.toString(report.getResolvedDependencies()));
-        assertEquals("unresolved dependencies", "my_packages:test_c",
-                Dependency.toString(report.getUnresolvedDependencies()));
-
-        ExecutionPlanBuilder builder = registry.createExecutionPlan();
-        builder.with(new ProgressTrackerListener() {
-            public void onMessage(Mode mode, String action, String path) {
-                log.info("{} {}", action, path);
-            }
-
-            public void onError(Mode mode, String path, Exception e) {
-                log.info("E {} {}", path, e.toString());
-            }
-        });
-
-        builder.addTask().with(idA).with(PackageTask.Type.EXTRACT);
-        builder.addTask().with(idB).with(PackageTask.Type.EXTRACT);
-        try {
-            builder.with(admin).execute();
-            fail("registering the package with missing dependencies should fail");
-        } catch (DependencyException ex) {
-            // expected
-        }
-        PackageId idC = registry.register(getStream(TEST_PACKAGE_C_10), false);
-        report = registry.analyzeDependencies(idB, false);
-        assertEquals("resolved dependencies", "my_packages:test_c:1.0",
-                PackageId.toString(report.getResolvedDependencies()));
-        assertEquals("unresolved dependencies", "", Dependency.toString(report.getUnresolvedDependencies()));
-
-        builder.addTask().with(idC).with(PackageTask.Type.EXTRACT);
-        ExecutionPlan plan  = builder.with(admin).execute();
-        assertFalse(plan.hasErrors());
-
-        assertTrue(registry.open(idA).isInstalled());
-        assertTrue(registry.open(idB).isInstalled());
-        assertTrue(registry.open(idC).isInstalled());
-    }
-    
-    @Test
-    public void testExtractSubPackage() throws IOException, PackageException, RepositoryException {
-        registry.register(getStream("/test-packages/subtest.zip"), false);
-
-        assertTrue(registry.contains(PACKAGE_ID_SUB_A));
-        assertTrue(registry.contains(PACKAGE_ID_SUB_B));
-    }
-
-    @Test
-    public void testUsages() throws Exception {
-        PackageId idB = registry.register(getStream(TEST_PACKAGE_B_10), false);
-        PackageId idC = registry.register(getStream(TEST_PACKAGE_C_10), false);
-
-        assertEquals("usage", "", PackageId.toString(registry.usage(idC)));
-
-        ExecutionPlanBuilder builder = registry.createExecutionPlan();
-        builder.with(new ProgressTrackerListener() {
-            public void onMessage(Mode mode, String action, String path) {
-                log.info("{} {}", action, path);
-            }
-
-            public void onError(Mode mode, String path, Exception e) {
-                log.info("E {} {}", path, e.toString());
-            }
-        });
-
-        builder.addTask().with(idB).with(PackageTask.Type.EXTRACT);
-        builder.addTask().with(idC).with(PackageTask.Type.EXTRACT);
-        ExecutionPlan plan  = builder.with(admin).execute();
-        assertFalse(plan.hasErrors());
-
-        assertEquals("usage", "my_packages:test_b:1.0", PackageId.toString(registry.usage(idC)));
-    }
-    
-    @Test
-    public void testInstalledDependencies() throws Exception {
-        PackageId idB = registry.register(getStream(TEST_PACKAGE_B_10), false);
-        PackageId idC = registry.register(getStream(TEST_PACKAGE_C_10), false);
-
-        assertEquals("usage", "", PackageId.toString(registry.usage(idC)));
-
-        ExecutionPlanBuilder builder = registry.createExecutionPlan();
-        builder.with(new ProgressTrackerListener() {
-            public void onMessage(Mode mode, String action, String path) {
-                log.info("{} {}", action, path);
-            }
-
-            public void onError(Mode mode, String path, Exception e) {
-                log.info("E {} {}", path, e.toString());
-            }
-        });
-
-        builder.addTask().with(idC).with(PackageTask.Type.EXTRACT);
-        ExecutionPlan plan  = builder.with(admin).execute();
-        assertFalse(plan.hasErrors());
-
-        Dependency depB = new Dependency(idB);
-        Dependency depC = new Dependency(idC);
-        assertNull("Dependency B should not resolve", registry.resolve(depB, true));
-        assertEquals("Dependency C should resovle to package C", idC, registry.resolve(depC, true));
-    }
-    
-    
-    @Test
-    public void testInstallTime() throws Exception {
-
-        PackageId idC = registry.register(getStream(TEST_PACKAGE_C_10), false);
-
-        assertNull(registry.open(idC).getInstallationTime());
-        
-        ExecutionPlanBuilder builder = registry.createExecutionPlan();
-        builder.with(new ProgressTrackerListener() {
-            public void onMessage(Mode mode, String action, String path) {
-                log.info("{} {}", action, path);
-            }
-
-            public void onError(Mode mode, String path, Exception e) {
-                log.info("E {} {}", path, e.toString());
-            }
-        });
-
-        builder.addTask().with(idC).with(PackageTask.Type.EXTRACT);
-        Calendar before = Calendar.getInstance();
-        ExecutionPlan plan = builder.with(admin).execute();
-        Calendar after = Calendar.getInstance();
-        assertFalse(plan.hasErrors());
-
-        assertTrue("Installation time for idC too late", registry.open(idC).getInstallationTime().compareTo(after) <= 0);
-        assertTrue("Installation time for idC too early", registry.open(idC).getInstallationTime().compareTo(before) >= 0);
-
-    }
-
-    @Test
-    public void testUnsupportedUninstall() throws Exception {
-        PackageId idC = registry.register(getStream(TEST_PACKAGE_C_10), false);
-
-        assertNull(registry.open(idC).getInstallationTime());
-        
-        ExecutionPlanBuilder builder = registry.createExecutionPlan();
-        builder.with(new ProgressTrackerListener() {
-            public void onMessage(Mode mode, String action, String path) {
-                log.info("{} {}", action, path);
-            }
-
-            public void onError(Mode mode, String path, Exception e) {
-                log.info("E {} {}", path, e.toString());
-            }
-        });
-
-        builder.addTask().with(idC).with(PackageTask.Type.EXTRACT);
-        ExecutionPlan plan = builder.with(admin).execute();
-        assertFalse(plan.hasErrors());
-
-        try{
-            registry.uninstallPackage(admin, registry.open(idC), new ImportOptions());
-            fail("uninstall attempt should fail.");
-        } catch (PackageException ex) {
-            //expected
-        }
-    }
-
-    @Test
-    public void testInvalidMetaXmlFile() throws Exception {
-        getFreshRegistryWithDefaultConstructor("test-package.zip", "invalid-metadata.xml");
-        assertNull(registry.getInstallState(TEST_PACKAGE_ID));
-    }
-
-    @Test
-    public void testCacheInitializedAfterOSGiActivate() throws IOException {
-         new FSPackageRegistry();
-        getFreshRegistryWithDefaultConstructor("test-package.zip", "test-package.xml");
-        assertTrue(registry.contains(TEST_PACKAGE_ID));
-        assertEquals(Collections.singleton(TEST_PACKAGE_ID), registry.packages());
-    }
-
-    @Test
-    public void testMetadataPersistance() throws IOException, PackageException {
-        File file = getFile("/test-packages/package_1.0.zip");
-        PackageId pkg = registry.register(file, false);
-        // check metadata
-        assertEquals(FSPackageStatus.REGISTERED, registry.getInstallState(pkg).getStatus());
-        RegisteredPackage registeredPackage = registry.open(pkg);
-        assertNotNull(registeredPackage);
-        registry.installPackage(admin, registeredPackage, getDefaultOptions(), true);
-        // check metadata
-        assertEquals(FSPackageStatus.EXTRACTED, registry.getInstallState(pkg).getStatus());
-        // reload FSRegistry
-        this.registry = new FSPackageRegistry(registryHome);
-        FSInstallState installState = registry.getInstallState(pkg);
-        assertNotNull(installState);
-        // check metadata
-        assertEquals(FSPackageStatus.EXTRACTED, installState.getStatus());
-    }
-
-    private void getFreshRegistryWithDefaultConstructor(String packageName, String packageMetadataName) throws IOException {
-        if (this.registryHome != null && this.registryHome.exists()) {
-            this.registryHome.delete();
-        }
-        this.registryHome = new File(DIR_REGISTRY_HOME, UUID.randomUUID().toString());
-        FileUtils.copyInputStreamToFile(getClass().getResourceAsStream(packageName), new File(this.registryHome, "package1.zip"));
-        FileUtils.copyInputStreamToFile(getClass().getResourceAsStream(packageMetadataName), new File(this.registryHome, "package1.zip.xml"));
-        
-        BundleContext context = Mockito.mock(BundleContext.class);
-        Mockito.when(context.getProperty(FSPackageRegistry.REPOSITORY_HOME)).thenReturn(DIR_REGISTRY_HOME.toString());
-        Converter converter = Converters.standardConverter();
-        Map<String, Object> map = new HashMap<>();
-        map.put("homePath", registryHome.getName());
-        map.put("authIdsForHookExecution", new String[0]);
-        map.put("authIdsForRootInstallation", new String[0]);
-        Config config = converter.convert(map).to(Config.class);
-        registry.activate(context, config);
-    }
-
-    @SuppressWarnings("deprecation")
-    private void getFreshRegistry(InstallationScope... scope) throws IOException {
-        if (this.registryHome != null && this.registryHome.exists()) {
-            this.registryHome.delete();
-        }
-        this.registryHome = new File(DIR_REGISTRY_HOME, UUID.randomUUID().toString());
-        this.registryHome.mkdir();
-        if (scope.length > 0) {
-            this.registry = new FSPackageRegistry(registryHome, scope[0]);
-        } else {
-            this.registry = new FSPackageRegistry(registryHome);
-        }
-    }
-    
-    private static class Collector implements ProgressTrackerListener {
-        private final List<String> paths = new LinkedList<String>();
-
-        public void onMessage(Mode mode, String action, String path) {
-            paths.add(path);
-        }
-
-        public void onError(Mode mode, String path, Exception e) {
-        }
-    }
-    
-    public static void checkFiltered(String[] containing, String[] filtered, List<String> result) {
-        assertEquals("Results don't contain expected values", Collections.EMPTY_LIST, CollectionUtils.subtract(Arrays.asList(containing), result));
-        assertEquals("Results contain unexpected values", Collections.EMPTY_LIST , CollectionUtils.intersection(result, Arrays.asList(filtered)));
-    }
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/util/EffectiveNodeTypeIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/util/EffectiveNodeTypeIT.java
deleted file mode 100644
index d33e45eb..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/util/EffectiveNodeTypeIT.java
+++ /dev/null
@@ -1,121 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.jackrabbit.vault.util;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertFalse;
-import static org.junit.Assert.assertNotEquals;
-import static org.junit.Assert.assertTrue;
-
-import java.io.IOException;
-import java.io.InputStreamReader;
-import java.io.Reader;
-import java.nio.charset.StandardCharsets;
-import java.util.Optional;
-
-import javax.jcr.Node;
-import javax.jcr.PropertyType;
-import javax.jcr.RepositoryException;
-import javax.jcr.UnsupportedRepositoryOperationException;
-import javax.jcr.nodetype.InvalidNodeTypeDefinitionException;
-import javax.jcr.nodetype.NodeDefinition;
-import javax.jcr.nodetype.NodeType;
-import javax.jcr.nodetype.NodeTypeExistsException;
-import javax.jcr.nodetype.PropertyDefinition;
-
-import org.apache.jackrabbit.commons.cnd.CndImporter;
-import org.apache.jackrabbit.commons.cnd.ParseException;
-import org.apache.jackrabbit.vault.packaging.integration.IntegrationTestBase;
-import org.junit.After;
-import org.junit.Before;
-import org.junit.Test;
-
-public class EffectiveNodeTypeIT extends IntegrationTestBase {
-
-    private static final String MY_PRIMARY_TYPE = "my:Folder";
-    private static final String MY_MIXIN = "my:Mixin";
-
-    private Node node;
-
-    @Before
-    public void before() throws IOException, InvalidNodeTypeDefinitionException, NodeTypeExistsException, UnsupportedRepositoryOperationException, ParseException, RepositoryException {
-        try (Reader reader = new InputStreamReader(getStream("mynodetypes.cnd"), StandardCharsets.UTF_8)) {
-            // register cnd
-            CndImporter.registerNodeTypes(reader, admin);
-        }
-        node = admin.getRootNode().addNode("test", MY_PRIMARY_TYPE);
-    }
-
-    @After
-    public void after() {
-        clean("/test");
-    }
-
-    @Test
-    public void testGetApplicablePropertyDefinition() throws RepositoryException, ParseException, IOException {
-        node.addMixin(MY_MIXIN);
-        EffectiveNodeType effectiveNodeType = EffectiveNodeType.ofNode(node);
-
-        // this should be the named property definition from mixin type (although its definition is for multi-value)
-        Optional<PropertyDefinition> pd = effectiveNodeType.getApplicablePropertyDefinition("my:protectedProperty", false, PropertyType.BOOLEAN);
-        assertTrue(pd.isPresent());
-        assertTrue(pd.get().isProtected());
-
-        // this should be the residual property definition from primary type
-        pd = effectiveNodeType.getApplicablePropertyDefinition("my:stringProperty", false, PropertyType.STRING);
-        assertTrue(pd.isPresent());
-        assertFalse(pd.get().isMandatory());
-
-        // no matching property definition for multi value
-        pd = effectiveNodeType.getApplicablePropertyDefinition("my:stringProperty", true, PropertyType.STRING);
-        assertFalse(pd.isPresent());
-
-        // this should be inherited property definition from primary type
-        pd = effectiveNodeType.getApplicablePropertyDefinition("jcr:createdBy", false, PropertyType.STRING);
-        assertTrue(pd.isPresent());
-        assertTrue(pd.get().isProtected());
-        assertTrue(pd.get().isAutoCreated());
-    }
-
-    @Test
-    public void testGetApplicableChildNodeDefinition() throws RepositoryException, ParseException, IOException {
-        node.addMixin(MY_MIXIN);
-        EffectiveNodeType effectiveNodeType = EffectiveNodeType.ofNode(node);
-        NodeType myPrimaryType = admin.getWorkspace().getNodeTypeManager().getNodeType(MY_PRIMARY_TYPE);
-        NodeType myMixinType = admin.getWorkspace().getNodeTypeManager().getNodeType(MY_MIXIN);
-
-        // this should be the named child node definition from mixin type
-        Optional<NodeDefinition> nd = effectiveNodeType.getApplicableChildNodeDefinition("my:protectedChildNode", myPrimaryType, myMixinType);
-        assertTrue(nd.isPresent());
-        assertTrue(nd.get().isProtected());
-
-        // this should be the residual child node definition from primary type
-        nd = effectiveNodeType.getApplicableChildNodeDefinition("my:otherNode", myPrimaryType);
-        assertTrue(nd.isPresent());
-        assertTrue(nd.get().isMandatory());
-    }
-
-    @Test
-    public void testEquals() throws RepositoryException {
-        EffectiveNodeType effectiveNodeType = EffectiveNodeType.ofNode(node);
-        EffectiveNodeType otherEffectiveNodeType = EffectiveNodeType.ofNode(node);
-        assertEquals(effectiveNodeType, otherEffectiveNodeType);
-        node.addMixin(MY_MIXIN);
-        otherEffectiveNodeType = EffectiveNodeType.ofNode(node);
-        assertNotEquals(effectiveNodeType, otherEffectiveNodeType);
-    }
-}
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/util/RCPIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/util/RCPIT.java
deleted file mode 100644
index 076efa35..00000000
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/util/RCPIT.java
+++ /dev/null
@@ -1,229 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.jackrabbit.vault.util;
-
-import java.io.IOException;
-import java.util.Calendar;
-
-import javax.jcr.Node;
-import javax.jcr.Property;
-import javax.jcr.PropertyType;
-import javax.jcr.RepositoryException;
-import javax.jcr.nodetype.NodeType;
-
-import org.apache.jackrabbit.commons.JcrUtils;
-import org.apache.jackrabbit.vault.fs.config.ConfigurationException;
-import org.apache.jackrabbit.vault.packaging.integration.IntegrationTestBase;
-import org.junit.Test;
-
-/**
- * {@code RCPIT}...
- */
-public class RCPIT extends IntegrationTestBase {
-
-
-    public static final String SRC_PATH = "/testroot/src";
-
-    public static final String SRC_TEST_NODE_PATH = "/testroot/src/a";
-
-    public static final String DST_PATH = "/testroot/dst";
-
-    public static final String DST_TEST_NODE_PATH = "/testroot/dst/a";
-
-    @Test
-    public void testSimple() throws IOException, RepositoryException, ConfigurationException {
-        Node a = JcrUtils.getOrCreateByPath(SRC_TEST_NODE_PATH, NodeType.NT_UNSTRUCTURED, NodeType.NT_UNSTRUCTURED, admin, true);
-        a.setProperty("p0", "0");
-        a.setProperty("p1", "1");
-        a.setProperty("m0", new String[]{"0", "1", "2"}, PropertyType.STRING);
-        admin.save();
-
-        assertNodeExists(SRC_TEST_NODE_PATH);
-
-        RepositoryCopier rcp = new RepositoryCopier();
-        rcp.copy(admin, SRC_PATH, admin, DST_PATH, true);
-
-        assertProperty(DST_TEST_NODE_PATH + "/p0", "0");
-        assertProperty(DST_TEST_NODE_PATH + "/p1", "1");
-        assertProperty(DST_TEST_NODE_PATH + "/m0", new String[]{"0", "1", "2"});
-    }
-
-    @Test
-    public void testMixin() throws IOException, RepositoryException, ConfigurationException {
-        Node a = JcrUtils.getOrCreateByPath(SRC_TEST_NODE_PATH, NodeType.NT_FOLDER, NodeType.NT_FOLDER, admin, true);
-        RepositoryCopier rcp = new RepositoryCopier();
-        a.addMixin(NodeType.MIX_TITLE);
-        a.setProperty("jcr:title", "Hello");
-        admin.save();
-
-        rcp.copy(admin, SRC_PATH, admin, DST_PATH, true);
-        assertProperty(DST_TEST_NODE_PATH + "/jcr:title", "Hello");
-        assertProperty(DST_TEST_NODE_PATH + "/jcr:mixinTypes", new String[]{"mix:title"});
-    }
-
-    @Test
-    public void testAddMixin() throws IOException, RepositoryException, ConfigurationException {
-        Node a = JcrUtils.getOrCreateByPath(SRC_TEST_NODE_PATH, NodeType.NT_FOLDER, NodeType.NT_FOLDER, admin, true);
-        RepositoryCopier rcp = new RepositoryCopier();
-        rcp.copy(admin, SRC_PATH, admin, DST_PATH, true);
-        assertNodeExists(DST_TEST_NODE_PATH);
-        assertPropertyMissing(DST_TEST_NODE_PATH + "/jcr:title");
-
-        a.addMixin(NodeType.MIX_TITLE);
-        a.setProperty("jcr:title", "Hello");
-        admin.save();
-        assertProperty(SRC_TEST_NODE_PATH + "/jcr:title", "Hello");
-
-        rcp = new RepositoryCopier();
-        rcp.setOnlyNewer(false);
-        rcp.setUpdate(true);
-        rcp.copy(admin, SRC_PATH, admin, DST_PATH, true);
-
-        assertProperty(DST_TEST_NODE_PATH + "/jcr:title", "Hello");
-        assertProperty(DST_TEST_NODE_PATH + "/jcr:mixinTypes", new String[]{"mix:title"});
-    }
-
-    @Test
-    public void testRemoveMixin() throws IOException, RepositoryException, ConfigurationException {
-        Node a = JcrUtils.getOrCreateByPath(SRC_TEST_NODE_PATH, NodeType.NT_FOLDER, NodeType.NT_FOLDER, admin, true);
-        RepositoryCopier rcp = new RepositoryCopier();
-        a.addMixin(NodeType.MIX_TITLE);
-        a.setProperty("jcr:title", "Hello");
-        admin.save();
-
-        rcp.copy(admin, SRC_PATH, admin, DST_PATH, true);
-        assertProperty(DST_TEST_NODE_PATH + "/jcr:title", "Hello");
-        assertProperty(DST_TEST_NODE_PATH + "/jcr:mixinTypes", new String[]{"mix:title"});
-
-
-        a.removeMixin(NodeType.MIX_TITLE);
-        admin.save();
-        // removing a mixing should remove the undeclared properties
-        assertPropertyMissing(SRC_TEST_NODE_PATH + "/jcr:title");
-        assertPropertyMissingOrEmpty(SRC_TEST_NODE_PATH + "/jcr:mixinTypes");
-
-        rcp = new RepositoryCopier();
-        rcp.setOnlyNewer(false);
-        rcp.setUpdate(true);
-        rcp.copy(admin, SRC_PATH, admin, DST_PATH, true);
-
-        assertNodeExists(DST_TEST_NODE_PATH);
-        assertPropertyMissing(DST_TEST_NODE_PATH + "/jcr:title");
-        assertPropertyMissingOrEmpty(DST_TEST_NODE_PATH + "/jcr:mixinTypes");
-    }
-
-    @Test
-    public void testOnlyNewer() throws IOException, RepositoryException, ConfigurationException {
-        Calendar now = Calendar.getInstance();
-        Calendar then = Calendar.getInstance();
-        then.setTimeInMillis(now.getTimeInMillis() + 1);
-
-        // create /testroot/src/a/jcr:content with 'now' as last modified
-        Node a = JcrUtils.getOrCreateByPath(SRC_TEST_NODE_PATH, NodeType.NT_FOLDER, NodeType.NT_FILE, admin, false);
-        Node content = a.addNode(Node.JCR_CONTENT, NodeType.NT_UNSTRUCTURED);
-        content.setProperty(Property.JCR_LAST_MODIFIED, now);
-        content.setProperty("p0", "0");
-        admin.save();
-        assertProperty(SRC_TEST_NODE_PATH + "/jcr:content/p0", "0");
-
-        RepositoryCopier rcp = new RepositoryCopier();
-        rcp.setOnlyNewer(false);
-        rcp.setUpdate(true);
-        rcp.copy(admin, SRC_PATH, admin, DST_PATH, true);
-        assertProperty(DST_TEST_NODE_PATH + "/jcr:content/p0", "0");
-
-        // modify property but don't update last modified
-        content.setProperty("p0", "1");
-        admin.save();
-        rcp = new RepositoryCopier();
-        rcp.setOnlyNewer(true);
-        rcp.setUpdate(true);
-        rcp.copy(admin, SRC_PATH, admin, DST_PATH, true);
-        // property should still be the old value, since src is not "newer"
-        assertProperty(DST_TEST_NODE_PATH + "/jcr:content/p0", "0");
-
-        // now update last modified
-        content.setProperty(Property.JCR_LAST_MODIFIED, then);
-        admin.save();
-        rcp = new RepositoryCopier();
-        rcp.setOnlyNewer(true);
-        rcp.setUpdate(true);
-        rcp.copy(admin, SRC_PATH, admin, DST_PATH, true);
-        // property should now be the new value, since src is now "newer"
-        assertProperty(DST_TEST_NODE_PATH + "/jcr:content/p0", "1");
-
-    }
-
-    /**
-     * Special test where the source node is nt:file with no mixins, and the destination node is nt:file with a mixin
-     * and properties, and content is updated since it is newer (JCRVLT-87)
-     */
-    @Test
-    public void testMissingMixinWithNewer() throws IOException, RepositoryException, ConfigurationException {
-        Calendar now = Calendar.getInstance();
-        Calendar then = Calendar.getInstance();
-        then.setTimeInMillis(now.getTimeInMillis() + 1);
-
-        // create /testroot/src/a/jcr:content with 'now' as last modified
-        Node a = JcrUtils.getOrCreateByPath(SRC_TEST_NODE_PATH, NodeType.NT_FOLDER, NodeType.NT_FILE, admin, false);
-        Node content = a.addNode(Node.JCR_CONTENT, NodeType.NT_UNSTRUCTURED);
-        content.setProperty(Property.JCR_LAST_MODIFIED, now);
-        content.setProperty("p0", "0");
-        admin.save();
-        assertProperty(SRC_TEST_NODE_PATH + "/jcr:content/p0", "0");
-
-        RepositoryCopier rcp = new RepositoryCopier();
-        rcp.setOnlyNewer(false);
-        rcp.setUpdate(true);
-        rcp.copy(admin, SRC_PATH, admin, DST_PATH, true);
-        assertProperty(DST_TEST_NODE_PATH + "/jcr:content/p0", "0");
-
-        // modify source property and add mixin to destination
-        content.setProperty("p0", "1");
-        Node dst = admin.getNode(DST_TEST_NODE_PATH);
-        dst.addMixin(NodeType.MIX_TITLE);
-        dst.setProperty(Property.JCR_TITLE, "Hello");
-        admin.save();
-        assertProperty(DST_TEST_NODE_PATH + "/jcr:title", "Hello");
-        assertProperty(DST_TEST_NODE_PATH + "/jcr:mixinTypes", new String[]{"mix:title"});
-
-        // now perform copy
-        rcp = new RepositoryCopier();
-        rcp.setOnlyNewer(true);
-        rcp.setUpdate(true);
-        rcp.copy(admin, SRC_PATH, admin, DST_PATH, true);
-
-        // property should still be the old value, since src is not "newer"
-        assertProperty(DST_TEST_NODE_PATH + "/jcr:content/p0", "0");
-        // mixin should already be gone, since file does not have a lastModified.
-        assertPropertyMissingOrEmpty(DST_TEST_NODE_PATH + "/jcr:mixinTypes");
-        assertPropertyMissing(DST_TEST_NODE_PATH + "/jcr:title");
-
-        // now update last modified
-        content.setProperty(Property.JCR_LAST_MODIFIED, then);
-        admin.save();
-        rcp = new RepositoryCopier();
-        rcp.setOnlyNewer(true);
-        rcp.setUpdate(true);
-        rcp.copy(admin, SRC_PATH, admin, DST_PATH, true);
-
-        // property should now be the new value, since src is now "newer"
-        assertProperty(DST_TEST_NODE_PATH + "/jcr:content/p0", "1");
-    }
-
-
-}
\ No newline at end of file
diff --git a/vault-core/src/test/resources/auth.xml b/vault-core/src/test/resources/auth.xml
deleted file mode 100644
index ac248497..00000000
--- a/vault-core/src/test/resources/auth.xml
+++ /dev/null
@@ -1,46 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!--
-  Licensed to the Apache Software Foundation (ASF) under one or more
-  contributor license agreements.  See the NOTICE file distributed with
-  this work for additional information regarding copyright ownership.
-  The ASF licenses this file to You under the Apache License, Version 2.0
-  (the "License"); you may not use this file except in compliance with
-  the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-  Unless required by applicable law or agreed to in writing, software
-  distributed under the License is distributed on an "AS IS" BASIS,
-  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  See the License for the specific language governing permissions and
-  limitations under the License.
-  -->
-
-<!--
-  the auth.xml holds credential information
-  @attr version the version number of structure of this file
--->
-<auth version="1.0">
-  <!--
-    for each repository you connect to, the initial credentials are stored
-    in a 'repository' element.
-
-    @attr uri the connect uri to the repository
-  -->
-  <repository uri="rmi://localhost:5000/crx/crx.default">
-    <!--
-      the credentials element holds the actual credentials
-      @attr type the type of the credentials. currently only 'simple' is
-                 supported (which is the default)
-    -->
-    <credentials type="simple">
-      <!--
-        defines the user for this credentials.
-        @attr name the user name
-        @attr password the password (will by encrypted)
-      -->
-      <user name="admin" password="admin" />
-    </credentials>
-    
-  </repository>
-</auth>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/entries.xml b/vault-core/src/test/resources/entries.xml
deleted file mode 100644
index 8c15d308..00000000
--- a/vault-core/src/test/resources/entries.xml
+++ /dev/null
@@ -1,139 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!--
-  Licensed to the Apache Software Foundation (ASF) under one or more
-  contributor license agreements.  See the NOTICE file distributed with
-  this work for additional information regarding copyright ownership.
-  The ASF licenses this file to You under the Apache License, Version 2.0
-  (the "License"); you may not use this file except in compliance with
-  the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-  Unless required by applicable law or agreed to in writing, software
-  distributed under the License is distributed on an "AS IS" BASIS,
-  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  See the License for the specific language governing permissions and
-  limitations under the License.
-  -->
-
-<!--
-  the entries element holds information about the mountpoint and the relative
-  path of this vault controlled directory.
-
-  @attr uri  the mountpoint of the jcrfs
-  @attr path the path within the jcrfs
--->
-<entries uri="rmi://127.0.0.1:1234/crx/crx.default" path="/apps/test">
-  <!--
-    An entry element represents a vault controlled file (or directory) which
-    normally is also present as working copy.
-
-    @attr name  the name of the entry
-  -->
-  <entry name="myfile.txt">
-    <!--
-      The base element contains information about the original file retrieved
-      from the server. the base file.
-
-      @attr md5  the md5 checksum. the checksum is calculated when the file is
-                 retrieved from the server and always corresponds to the
-                 checksum of the physical file.
-      @attr size the file size. this size always corresponds to the one of the
-                 physical file.
-      @attr date the last modification date of the file. if the remote file did
-                 not provide a last modification date, it's initialized to the
-                 current time. please note that the last modification time of
-                 the physical base file is set to this value as well.
-      @attr contentType
-                 the content type of the file.
-    -->
-    <base md5="1234.." size="443" date="0" contentType="text/plain" />
-    <!--
-      The work element contains information about the working file.
-      The md5,size and date attributes are calculated whenever a status update
-      is performed. it may be that they can differ from the values of the
-      physical file.
-
-      @attr md5  the md5 checksum. may not correspond to the checksum of the
-                 physical file.
-      @attr size the file size. may not correspond to the size of the physical
-                 file.
-      @attr date the last modification date of the file. may not correspond to
-                 the last modification date of the physical file.
-      @attr contentType
-                 the content type of the file.
-    -->
-    <work md5="1234.." size="443" date="0" contentType="text/plain" />
-  </entry>
-
-  <!--
-    If the entry represents a directory which has just empty base and work
-    elements.
-  -->
-  <entry name="subdir">
-    <base/>
-    <work/>
-  </entry>
-  
-  <!--
-    Modifed file example.
-    After a status update the values of the work element are recalculated.
-    note that the actual status (like modified, missing, etc.) is not included
-    in the entries file.
-  -->
-  <entry name="myfile.txt">
-    <base md5="1234..0" size="443" date="0" />
-    <work md5="1234..1" size="543" date="1" />
-  </entry>
-
-  <!--
-    Added file example.
-    It only contains the information about the working file.
-  -->
-  <entry name="myfile.txt">
-    <work md5="1234..1" size="543" date="1" />
-  </entry>
-
-  <!--
-    Deleted file example.
-    It only contains the information about the base file
-  -->
-  <entry name="myfile.txt" state="deleted">
-    <base md5="1234..0" size="443" date="0" />
-  </entry>
-
-  <!--
-    Conflicted file example.
-    In case of a conflict (your modifications are not mergeable with the updated
-    file from the server) there are 3 additional files put to the working
-    directory: a copy of the base file (.base), a copy of your working file
-    (.mine) and a copy of the new remote file (.theirs). The working file then
-    contains then blocks of conflicting regions.
-  -->
-  <entry name="myfile.txt">
-    <!--
-      this represents still the original base file as present before the
-      conflicting update.
-
-      @attr name the file name of the copy in the working directory
-    -->
-    <base name="myfile.txt.base" md5="1234..0" size="443" date="0" />
-
-    <!--
-      this represents the working file but with conflict blocks.
-    -->
-    <work md5="44333" size="843" date="3" />
-
-    <!--
-      this represents the original working file as present before the
-      update.
-    -->
-    <mine name="myfile.txt.mine" md5="1234..1" size="543" date="1" />
-
-    <!--
-      this represents the updated file from the server
-    -->
-    <theirs name="myfile.txt.theirs" md5="1234..2" size="554" date="2" />
-  </entry>
-
-</entries>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/org/apache/jackrabbit/vault/packaging/integration/cqComponent.cnd b/vault-core/src/test/resources/org/apache/jackrabbit/vault/packaging/integration/cqComponent.cnd
deleted file mode 100644
index e528f067..00000000
--- a/vault-core/src/test/resources/org/apache/jackrabbit/vault/packaging/integration/cqComponent.cnd
+++ /dev/null
@@ -1,81 +0,0 @@
-/*
-  Licensed to the Apache Software Foundation (ASF) under one or more
-  contributor license agreements.  See the NOTICE file distributed with
-  this work for additional information regarding copyright ownership.
-  The ASF licenses this file to You under the Apache License, Version 2.0
-  (the "License"); you may not use this file except in compliance with
-  the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-  Unless required by applicable law or agreed to in writing, software
-  distributed under the License is distributed on an "AS IS" BASIS,
-  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  See the License for the specific language governing permissions and
-  limitations under the License.
-*/
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-<'vlt'='http://www.day.com/jcr/vault/1.0'>
-<'cq'='http://www.day.com/jcr/cq/1.0'>
-
-[sling:ResourceSuperType]
-  mixin
-  - sling:resourceSuperType (string)
-
-[sling:Folder] > nt:folder
-  - * (undefined) multiple
-  - * (undefined)
-  + * (nt:base) = sling:Folder version
-
-[cq:InplaceEditingConfig] > nt:unstructured
-  orderable
-  - editorType (string)
-  - configPath (string)
-  - active (boolean)
-  + config (nt:unstructured) = nt:unstructured
-
-[cq:EditListenersConfig]
-  - afteredit (string)
-  - aftermove (string)
-  - afterremove (string)
-  - afterinsert (string)
-  - * (undefined)
-  - afterdelete (string)
-  - * (undefined) multiple
-  - aftercreate (string)
-  + * (nt:base) = nt:base multiple version
-
-[cq:EditConfig] > nt:hierarchyNode, nt:unstructured
-  orderable
-  - cq:dialogMode (string) < 'auto', 'floating', 'inline'
-  - cq:emptyText (string)
-  - cq:layout (string) < 'editbar', 'rollover', 'auto'
-  - cq:inherit (boolean)
-  - cq:actions (string) multiple
-  + cq:inplaceEditing (cq:InplaceEditingConfig) = cq:InplaceEditingConfig
-  + cq:actionConfigs (nt:base) = nt:unstructured
-  + cq:listeners (nt:base) = cq:EditListenersConfig
-  + cq:formParameters (nt:base) = nt:unstructured
-  + cq:dropTargets (nt:base) = nt:unstructured
-
-[cq:Component] > mix:title, nt:folder, sling:ResourceSuperType
-  - dialogPath (string)
-  - cq:noDecoration (boolean)
-  - allowedChildren (string) multiple
-  - * (undefined)
-  - cq:isContainer (boolean)
-  - allowedParents (string) multiple
-  - * (undefined) multiple
-  - cq:cellName (string)
-  - componentGroup (string)
-  + dialog (nt:base) = nt:unstructured
-  + design_dialog (nt:base) = nt:unstructured
-  + cq:htmlTag (nt:base) = nt:unstructured
-  + * (nt:base) = nt:base multiple version
-  + cq:infoProviders (nt:base) = nt:unstructured
-  + cq:editConfig (cq:EditConfig) = cq:EditConfig
-  + icon.png (nt:file)
-  + cq:childEditConfig (cq:EditConfig) = cq:EditConfig
-  + thumbnail.png (nt:file)
-  + virtual (nt:base) = sling:Folder
diff --git a/vault-core/src/test/resources/org/apache/jackrabbit/vault/packaging/integration/repository.xml b/vault-core/src/test/resources/org/apache/jackrabbit/vault/packaging/integration/repository.xml
deleted file mode 100644
index c31e9423..00000000
--- a/vault-core/src/test/resources/org/apache/jackrabbit/vault/packaging/integration/repository.xml
+++ /dev/null
@@ -1,174 +0,0 @@
-<?xml version="1.0"?>
-<!--
-   Licensed to the Apache Software Foundation (ASF) under one or more
-   contributor license agreements.  See the NOTICE file distributed with
-   this work for additional information regarding copyright ownership.
-   The ASF licenses this file to You under the Apache License, Version 2.0
-   (the "License"); you may not use this file except in compliance with
-   the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-   Unless required by applicable law or agreed to in writing, software
-   distributed under the License is distributed on an "AS IS" BASIS,
-   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-   See the License for the specific language governing permissions and
-   limitations under the License.
--->
-
-<!DOCTYPE Repository
-          PUBLIC "-//The Apache Software Foundation//DTD Jackrabbit 2.0//EN"
-          "http://jackrabbit.apache.org/dtd/repository-2.0.dtd">
-
-<!-- Example Repository Configuration File
-     Used by
-     - org.apache.jackrabbit.core.config.RepositoryConfigTest.java
-     -
--->
-<Repository>
-    <!--
-        virtual file system where the repository stores global state
-        (e.g. registered namespaces, custom node types, etc.)
-    -->
-    <FileSystem class="org.apache.jackrabbit.core.fs.local.LocalFileSystem">
-        <param name="path" value="${rep.home}/repository"/>
-    </FileSystem>
-
-    <!--
-        data store configuration
-    -->
-    <DataStore class="org.apache.jackrabbit.core.data.FileDataStore"/>
-
-    <!--
-        security configuration
-    -->
-    <Security appName="Jackrabbit">
-
-        <SecurityManager class="org.apache.jackrabbit.core.UserPerWorkspaceSecurityManager">
-            <!--
-            optional user manager configuration
-            -->
-            <UserManager class="org.apache.jackrabbit.core.security.user.UserPerWorkspaceUserManager">
-                <param name="usersPath" value="/home/users"/>
-                <param name="groupsPath" value="/home/groups"/>
-            </UserManager>
-
-            <!--
-            optional workspace access manager configuration
-           -->
-        </SecurityManager>
-
-        <!--
-            access manager:
-            class: FQN of class implementing the AccessManager interface
-        -->
-        <AccessManager class="org.apache.jackrabbit.core.security.DefaultAccessManager">
-            <!-- <param name="config" value="${rep.home}/access.xml"/> -->
-        </AccessManager>
-
-        <LoginModule class="org.apache.jackrabbit.core.security.authentication.DefaultLoginModule">
-           <!-- 
-              anonymous user name ('anonymous' is the default value)
-            -->
-           <param name="anonymousId" value="anonymous"/>
-           <!--
-              administrator user id (default value if param is missing is 'admin')
-            -->
-           <param name="adminId" value="admin"/>
-        </LoginModule>
-    </Security>
-
-    <!--
-        location of workspaces root directory and name of default workspace
-    -->
-    <Workspaces rootPath="${rep.home}/workspaces" defaultWorkspace="default"/>
-    <!--
-        workspace configuration template:
-        used to create the initial workspace if there's no workspace yet
-    -->
-    <Workspace name="${wsp.name}">
-        <!--
-            virtual file system of the workspace:
-            class: FQN of class implementing the FileSystem interface
-        -->
-        <FileSystem class="org.apache.jackrabbit.core.fs.local.LocalFileSystem">
-            <param name="path" value="${wsp.home}"/>
-        </FileSystem>
-        <!--
-            persistence manager of the workspace:
-            class: FQN of class implementing the PersistenceManager interface
-        -->
-        <PersistenceManager class="org.apache.jackrabbit.core.persistence.pool.DerbyPersistenceManager">
-          <param name="url" value="jdbc:derby:${wsp.home}/db;create=true"/>
-          <param name="schemaObjectPrefix" value="${wsp.name}_"/>
-        </PersistenceManager>
-        <!--
-            Search index and the file system it uses.
-            class: FQN of class implementing the QueryHandler interface
-        -->
-        <SearchIndex class="org.apache.jackrabbit.core.query.lucene.SearchIndex">
-            <param name="path" value="${wsp.home}/index"/>
-            <param name="supportHighlighting" value="true"/>
-        </SearchIndex>
-
-        <!--
-            Workspace security configuration
-        -->
-        <WorkspaceSecurity>
-            <AccessControlProvider class="org.apache.jackrabbit.core.security.authorization.acl.ACLProvider">
-                <!-- param name="omit-default-permission" value="true"/-->
-                <param name="allow-unknown-principals" value="true"/>
-            </AccessControlProvider>
-        </WorkspaceSecurity>
-
-        <!--
-            XML Import configuration of the workspace
-        -->
-        <Import>
-            <ProtectedItemImporter class="org.apache.jackrabbit.core.xml.AccessControlImporter"/>
-            <ProtectedItemImporter class="org.apache.jackrabbit.core.security.user.UserImporter">
-                <param name="importBehavior" value="besteffort"/>
-            </ProtectedItemImporter>
-        </Import>
-    </Workspace>
-
-    <!--
-        Configures the versioning
-    -->
-    <Versioning rootPath="${rep.home}/version">
-        <!--
-            Configures the filesystem to use for versioning for the respective
-            persistence manager
-        -->
-        <FileSystem class="org.apache.jackrabbit.core.fs.local.LocalFileSystem">
-            <param name="path" value="${rep.home}/version" />
-        </FileSystem>
-
-        <!--
-            Configures the persistence manager to be used for persisting version state.
-            Please note that the current versioning implementation is based on
-            a 'normal' persistence manager, but this could change in future
-            implementations.
-        -->
-        <PersistenceManager class="org.apache.jackrabbit.core.persistence.pool.DerbyPersistenceManager">
-          <param name="url" value="jdbc:derby:${rep.home}/version/db;create=true"/>
-          <param name="schemaObjectPrefix" value="version_"/>
-        </PersistenceManager>
-    </Versioning>
-
-    <!--
-        Search index for content that is shared repository wide
-        (/jcr:system tree, contains mainly versions)
-    -->
-    <SearchIndex class="org.apache.jackrabbit.core.query.lucene.SearchIndex">
-        <param name="path" value="${rep.home}/repository/index"/>
-        <param name="supportHighlighting" value="true"/>
-    </SearchIndex>
-
-    <!--
-        Run with a cluster journal
-    -->
-    <Cluster id="node1">
-        <Journal class="org.apache.jackrabbit.core.journal.MemoryJournal"/>
-    </Cluster>
-</Repository>
diff --git a/vault-core/src/test/resources/org/apache/jackrabbit/vault/util/mynodetypes.cnd b/vault-core/src/test/resources/org/apache/jackrabbit/vault/util/mynodetypes.cnd
deleted file mode 100644
index 2f15f4fd..00000000
--- a/vault-core/src/test/resources/org/apache/jackrabbit/vault/util/mynodetypes.cnd
+++ /dev/null
@@ -1,30 +0,0 @@
-/*
-  Licensed to the Apache Software Foundation (ASF) under one or more
-  contributor license agreements.  See the NOTICE file distributed with
-  this work for additional information regarding copyright ownership.
-  The ASF licenses this file to You under the Apache License, Version 2.0
-  (the "License"); you may not use this file except in compliance with
-  the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-  Unless required by applicable law or agreed to in writing, software
-  distributed under the License is distributed on an "AS IS" BASIS,
-  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  See the License for the specific language governing permissions and
-  limitations under the License.
-*/
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-<'vlt'='http://www.day.com/jcr/vault/1.0'>
-<'my'='http://jackrabbit.apache.org/filevault/testing'>
-
-// nt:hierarchyNode is a primary type defining  "jcr:created (date) autocreated protected" and "jcr:createdBy (string) autocreated protected"
-[my:Folder] > nt:hierarchyNode 
-  - * (boolean)
-  - * (string)
-  + * (my:Folder) mandatory
-
-[my:Mixin]
-  mixin
-  - my:protectedProperty (*) multiple protected
-  + my:protectedChildNode protected
\ No newline at end of file
diff --git a/vault-core/src/test/resources/settings.xml b/vault-core/src/test/resources/settings.xml
deleted file mode 100644
index 343ad63c..00000000
--- a/vault-core/src/test/resources/settings.xml
+++ /dev/null
@@ -1,33 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!--
-  Licensed to the Apache Software Foundation (ASF) under one or more
-  contributor license agreements.  See the NOTICE file distributed with
-  this work for additional information regarding copyright ownership.
-  The ASF licenses this file to You under the Apache License, Version 2.0
-  (the "License"); you may not use this file except in compliance with
-  the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-  Unless required by applicable law or agreed to in writing, software
-  distributed under the License is distributed on an "AS IS" BASIS,
-  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  See the License for the specific language governing permissions and
-  limitations under the License.
-  -->
-
-<!--
-  the settings.xml hold user defined configuration
-  @attr version the version number of structure of this file
--->
-<vault version="1.0">
-  <!--
-    defines globally ignored files or directories that are never put under
-    vault control. the ".vlt" directory is such a ignored resource but this
-    is hardcoded. the an excluded resource is a directory it's entire subtree
-    is excluded as well.
-
-    @attr name the name of the file or directory to exclude. 
-  -->
-  <ignore name=".svn"/>
-</vault>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/META-INF/vault/definition/.content.xml b/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/META-INF/vault/definition/.content.xml
deleted file mode 100644
index 94aad319..00000000
--- a/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/META-INF/vault/definition/.content.xml
+++ /dev/null
@@ -1,49 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!--
-  ~ Licensed to the Apache Software Foundation (ASF) under one or more
-  ~ contributor license agreements.  See the NOTICE file distributed with
-  ~ this work for additional information regarding copyright ownership.
-  ~ The ASF licenses this file to You under the Apache License, Version 2.0
-  ~ (the "License"); you may not use this file except in compliance with
-  ~ the License.  You may obtain a copy of the License at
-  ~
-  ~      http://www.apache.org/licenses/LICENSE-2.0
-  ~
-  ~ Unless required by applicable law or agreed to in writing, software
-  ~ distributed under the License is distributed on an "AS IS" BASIS,
-  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  ~ See the License for the specific language governing permissions and
-  ~ limitations under the License.
-  -->
-
-<jcr:root xmlns:vlt="http://www.day.com/jcr/vault/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-    jcr:created="{Date}2018-05-17T17:41:46.815+02:00"
-    jcr:createdBy="admin"
-    jcr:description="AC Handling: OverWrite"
-    jcr:lastModified="{Date}2018-05-17T17:41:46.815+02:00"
-    jcr:lastModifiedBy="admin"
-    jcr:primaryType="vlt:PackageDefinition"
-    acHandling="overwrite"
-    buildCount="1"
-    builtWith=""
-    fixedBugs=""
-    group="support"
-    lastUnwrapped="{Date}2018-05-17T17:41:46.815+02:00"
-    lastUnwrappedBy="admin"
-    lastWrapped="{Date}2018-05-17T17:41:46.815+02:00"
-    lastWrappedBy="admin"
-    name=""
-    providerLink=""
-    providerName=""
-    providerUrl=""
-    testedWith=""
-    version="">
-    <filter jcr:primaryType="nt:unstructured">
-        <f0
-            jcr:primaryType="nt:unstructured"
-            mode="replace"
-            root="/testroot/secured"
-            rules="[]"/>
-    </filter>
-    <screenshots jcr:primaryType="nt:unstructured"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 4e195601..00000000
--- a/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,21 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!--
-  ~ Licensed to the Apache Software Foundation (ASF) under one or more
-  ~ contributor license agreements.  See the NOTICE file distributed with
-  ~ this work for additional information regarding copyright ownership.
-  ~ The ASF licenses this file to You under the Apache License, Version 2.0
-  ~ (the "License"); you may not use this file except in compliance with
-  ~ the License.  You may obtain a copy of the License at
-  ~
-  ~      http://www.apache.org/licenses/LICENSE-2.0
-  ~
-  ~ Unless required by applicable law or agreed to in writing, software
-  ~ distributed under the License is distributed on an "AS IS" BASIS,
-  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  ~ See the License for the specific language governing permissions and
-  ~ limitations under the License.
-  -->
-
-<workspaceFilter version="1.0">
-    <filter root="/testroot" mode="merge"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/META-INF/vault/properties.xml
deleted file mode 100644
index 70a8f65f..00000000
--- a/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,36 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!--
-  ~ Licensed to the Apache Software Foundation (ASF) under one or more
-  ~ contributor license agreements.  See the NOTICE file distributed with
-  ~ this work for additional information regarding copyright ownership.
-  ~ The ASF licenses this file to You under the Apache License, Version 2.0
-  ~ (the "License"); you may not use this file except in compliance with
-  ~ the License.  You may obtain a copy of the License at
-  ~
-  ~      http://www.apache.org/licenses/LICENSE-2.0
-  ~
-  ~ Unless required by applicable law or agreed to in writing, software
-  ~ distributed under the License is distributed on an "AS IS" BASIS,
-  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  ~ See the License for the specific language governing permissions and
-  ~ limitations under the License.
-  -->
-
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">mode_ac_test_a</entry>
-<entry key="lastModified">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:43:22.993+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="acHandling">overwrite</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/jcr_root/.content.xml
deleted file mode 100644
index d412a30d..00000000
--- a/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,34 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!--
-  ~ Licensed to the Apache Software Foundation (ASF) under one or more
-  ~ contributor license agreements.  See the NOTICE file distributed with
-  ~ this work for additional information regarding copyright ownership.
-  ~ The ASF licenses this file to You under the Apache License, Version 2.0
-  ~ (the "License"); you may not use this file except in compliance with
-  ~ the License.  You may obtain a copy of the License at
-  ~
-  ~      http://www.apache.org/licenses/LICENSE-2.0
-  ~
-  ~ Unless required by applicable law or agreed to in writing, software
-  ~ distributed under the License is distributed on an "AS IS" BASIS,
-  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  ~ See the License for the specific language governing permissions and
-  ~ limitations under the License.
-  -->
-
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/jcr_root/testroot/secured/.content.xml b/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/jcr_root/testroot/secured/.content.xml
deleted file mode 100644
index 1e519aa0..00000000
--- a/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/jcr_root/testroot/secured/.content.xml
+++ /dev/null
@@ -1,21 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!--
-  ~ Licensed to the Apache Software Foundation (ASF) under one or more
-  ~ contributor license agreements.  See the NOTICE file distributed with
-  ~ this work for additional information regarding copyright ownership.
-  ~ The ASF licenses this file to You under the Apache License, Version 2.0
-  ~ (the "License"); you may not use this file except in compliance with
-  ~ the License.  You may obtain a copy of the License at
-  ~
-  ~      http://www.apache.org/licenses/LICENSE-2.0
-  ~
-  ~ Unless required by applicable law or agreed to in writing, software
-  ~ distributed under the License is distributed on an "AS IS" BASIS,
-  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  ~ See the License for the specific language governing permissions and
-  ~ limitations under the License.
-  -->
-
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="nt:folder"/>
diff --git a/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/jcr_root/testroot/secured/_rep_policy.xml b/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/jcr_root/testroot/secured/_rep_policy.xml
deleted file mode 100644
index 7fed577b..00000000
--- a/vault-core/src/test/resources/test-packages/ace_order_overwrite.zip/jcr_root/testroot/secured/_rep_policy.xml
+++ /dev/null
@@ -1,45 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!--
-  ~ Licensed to the Apache Software Foundation (ASF) under one or more
-  ~ contributor license agreements.  See the NOTICE file distributed with
-  ~ this work for additional information regarding copyright ownership.
-  ~ The ASF licenses this file to You under the Apache License, Version 2.0
-  ~ (the "License"); you may not use this file except in compliance with
-  ~ the License.  You may obtain a copy of the License at
-  ~
-  ~      http://www.apache.org/licenses/LICENSE-2.0
-  ~
-  ~ Unless required by applicable law or agreed to in writing, software
-  ~ distributed under the License is distributed on an "AS IS" BASIS,
-  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  ~ See the License for the specific language governing permissions and
-  ~ limitations under the License.
-  -->
-
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="rep:ACL">
-    <allow
-        jcr:primaryType="rep:GrantACE"
-        rep:principalName="everyone"
-        rep:privileges="{Name}[jcr:write]">
-        <rep:restrictions
-            jcr:primaryType="rep:Restrictions"
-            rep:glob="/foo"/>
-    </allow>
-    <deny1
-        jcr:primaryType="rep:DenyACE"
-        rep:principalName="testuser"
-        rep:privileges="{Name}[jcr:write]">
-        <rep:restrictions
-            jcr:primaryType="rep:Restrictions"
-            rep:glob="/foo"/>
-    </deny1>
-    <allow2
-        jcr:primaryType="rep:GrantACE"
-        rep:principalName="everyone"
-        rep:privileges="{Name}[jcr:write]">
-        <rep:restrictions
-            jcr:primaryType="rep:Restrictions"
-            rep:glob="/bar"/>
-    </allow2>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/badnamespacenames.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/badnamespacenames.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 7705dc81..00000000
--- a/vault-core/src/test/resources/test-packages/badnamespacenames.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/tmp/badnamespacenames"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/badnamespacenames.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/badnamespacenames.zip/META-INF/vault/properties.xml
deleted file mode 100644
index 2494f50c..00000000
--- a/vault-core/src/test/resources/test-packages/badnamespacenames.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,18 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">test_referenceable</entry>
-<entry key="lastModified">2015-12-16T16:59:10.779+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2015-12-16T16:59:10.795+01:00</entry>
-<entry key="buildCount">5</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2015-12-16T16:59:10.779+01:00</entry>
-<entry key="group">my_packages</entry>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/badnamespacenames.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/badnamespacenames.zip/jcr_root/.content.xml
deleted file mode 100644
index 6d7a9768..00000000
--- a/vault-core/src/test/resources/test-packages/badnamespacenames.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable,rep:RepoAccessControllable]"
-    jcr:primaryType="rep:root"/>
diff --git a/vault-core/src/test/resources/test-packages/badnamespacenames.zip/jcr_root/tmp/.content.xml b/vault-core/src/test/resources/test-packages/badnamespacenames.zip/jcr_root/tmp/.content.xml
deleted file mode 100644
index fb0a629b..00000000
--- a/vault-core/src/test/resources/test-packages/badnamespacenames.zip/jcr_root/tmp/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="nt:unstructured"/>
diff --git a/vault-core/src/test/resources/test-packages/badnamespacenames.zip/jcr_root/tmp/badnamespacenames.xml b/vault-core/src/test/resources/test-packages/badnamespacenames.zip/jcr_root/tmp/badnamespacenames.xml
deleted file mode 100644
index 2ec6804e..00000000
--- a/vault-core/src/test/resources/test-packages/badnamespacenames.zip/jcr_root/tmp/badnamespacenames.xml
+++ /dev/null
@@ -1,13 +0,0 @@
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:mix="http://www.jcp.org/jcr/mix/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0" 
-    jcr:primaryType="nt:unstructured"
-    xmlns:prefix_foo="name_foo"
-    xmlns:prefix_bar="name_bar"
-    xmlns:prefix_qux="name_qux">
-    <prefix_foo:child
-        jcr:primaryType="nt:unstructured">
-        <prefix_bar:child
-            jcr:primaryType="nt:unstructured"
-            prefix_qux:someproperty="xyz">
-        </prefix_bar:child>
-    </prefix_foo:child>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/cug-test-1.zip b/vault-core/src/test/resources/test-packages/cug-test-1.zip
deleted file mode 100644
index 3d162b2c..00000000
Binary files a/vault-core/src/test/resources/test-packages/cug-test-1.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/cug-test-2.zip b/vault-core/src/test/resources/test-packages/cug-test-2.zip
deleted file mode 100644
index bad2f3c7..00000000
Binary files a/vault-core/src/test/resources/test-packages/cug-test-2.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/deepmixintest.zip b/vault-core/src/test/resources/test-packages/deepmixintest.zip
deleted file mode 100644
index 38a6306f..00000000
Binary files a/vault-core/src/test/resources/test-packages/deepmixintest.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/double_properties.zip b/vault-core/src/test/resources/test-packages/double_properties.zip
deleted file mode 100644
index ee312828..00000000
Binary files a/vault-core/src/test/resources/test-packages/double_properties.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/empty_testnode.zip b/vault-core/src/test/resources/test-packages/empty_testnode.zip
deleted file mode 100644
index 59d65387..00000000
Binary files a/vault-core/src/test/resources/test-packages/empty_testnode.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/empty_tmp.zip b/vault-core/src/test/resources/test-packages/empty_tmp.zip
deleted file mode 100644
index 78a4db57..00000000
Binary files a/vault-core/src/test/resources/test-packages/empty_tmp.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/empty_tmp_foo.zip b/vault-core/src/test/resources/test-packages/empty_tmp_foo.zip
deleted file mode 100644
index f49ef687..00000000
Binary files a/vault-core/src/test/resources/test-packages/empty_tmp_foo.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/empty_tmp_foo_bar.zip b/vault-core/src/test/resources/test-packages/empty_tmp_foo_bar.zip
deleted file mode 100644
index e83040d3..00000000
Binary files a/vault-core/src/test/resources/test-packages/empty_tmp_foo_bar.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/enhanced_file_aggregate.zip/META-INF/vault/config.xml b/vault-core/src/test/resources/test-packages/enhanced_file_aggregate.zip/META-INF/vault/config.xml
deleted file mode 100644
index 59e3a4a7..00000000
--- a/vault-core/src/test/resources/test-packages/enhanced_file_aggregate.zip/META-INF/vault/config.xml
+++ /dev/null
@@ -1,93 +0,0 @@
-<!--
-  Licensed to the Apache Software Foundation (ASF) under one or more
-  contributor license agreements.  See the NOTICE file distributed with
-  this work for additional information regarding copyright ownership.
-  The ASF licenses this file to You under the Apache License, Version 2.0
-  (the "License"); you may not use this file except in compliance with
-  the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-  Unless required by applicable law or agreed to in writing, software
-  distributed under the License is distributed on an "AS IS" BASIS,
-  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  See the License for the specific language governing permissions and
-  limitations under the License.
-  -->
-<vaultfs version="1.1">
-    <!--
-        Defines the content aggregation. The order of the defined aggregates
-        is important for finding the correct aggregator.
-    -->
-    <aggregates>
-        <!--
-            Defines an aggregate that handles nt:file and nt:resource nodes.
-        -->
-        <aggregate type="file" title="File Aggregate"/>
-
-        <!--
-            Defines an aggregate that handles file/folder like nodes. It matches
-            all nt:hierarchyNode nodes that have or define a jcr:content
-            child node and excludes child nodes that are nt:hierarchyNodes.
-        -->
-        <aggregate type="filefolder" title="File/Folder Aggregate"/>
-
-        <!--
-            Defines an aggregate that handles nt:nodeType nodes and serializes
-            them into .cnd notation.
-        -->
-        <aggregate type="nodetype" title="Node Type Aggregate" />
-
-        <!--
-            Defines an aggregate that defines full coverage for certain node
-            types that cannot be covered by the default aggregator.
-        -->
-        <aggregate type="full" title="Full Coverage Aggregate">
-            <matches>
-                <include nodeType="rep:AccessControl" respectSupertype="true" />
-                <include nodeType="cq:Widget" respectSupertype="true" />
-                <include nodeType="cq:WidgetCollection" respectSupertype="true" />
-                <include nodeType="cq:EditConfig" respectSupertype="true" />
-                <include nodeType="cq:WorkflowModel" respectSupertype="true" />
-                <include nodeType="vlt:FullCoverage" respectSupertype="true" />
-                <include nodeType="mix:language" respectSupertype="true" />
-                <include nodeType="sling:OsgiConfig" respectSupertype="true" />
-            </matches>
-        </aggregate>
-
-        <!--
-            Defines an aggregate that handles nt:folder like nodes.
-        -->
-        <aggregate type="generic" title="Folder Aggregate">
-            <matches>
-                <include nodeType="nt:folder" respectSupertype="true" />
-            </matches>
-            <contains>
-                <exclude isNode="true" />
-            </contains>
-        </aggregate>
-
-        <!--
-            Defines the default aggregate
-        -->
-        <aggregate type="generic" title="Default Aggregator" isDefault="true">
-            <contains>
-                <exclude nodeType="nt:hierarchyNode" respectSupertype="true" />
-            </contains>
-            <matches>
-                <!-- all -->
-            </matches>
-        </aggregate>
-
-    </aggregates>
-
-    <!--
-      defines the input handlers
-    -->
-    <handlers>
-        <handler type="folder"/>
-        <handler type="file"/>
-        <handler type="nodetype"/>
-        <handler type="generic"/>
-    </handlers>
-</vaultfs>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/enhanced_file_aggregate.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/enhanced_file_aggregate.zip/META-INF/vault/filter.xml
deleted file mode 100644
index bbbd616d..00000000
--- a/vault-core/src/test/resources/test-packages/enhanced_file_aggregate.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/enhanced_file_aggregate.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/enhanced_file_aggregate.zip/META-INF/vault/properties.xml
deleted file mode 100644
index f57b010d..00000000
--- a/vault-core/src/test/resources/test-packages/enhanced_file_aggregate.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,13 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<entry key="createdBy">root</entry>
-<entry key="allowIndexDefinitions">true</entry>
-<entry key="name">enhanced-file-aggregate-package</entry>
-<entry key="created">2022-05-26T10:38:55.609Z</entry>
-<entry key="version">1.0.0</entry>
-<entry key="packageType">application</entry>
-<entry key="requiresRoot">false</entry>
-<entry key="group">testpackages</entry>
-<entry key="description">test package containing enhanced file aggregate</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/enhanced_file_aggregate.zip/META-INF/vault/settings.xml b/vault-core/src/test/resources/test-packages/enhanced_file_aggregate.zip/META-INF/vault/settings.xml
deleted file mode 100644
index 61c1bea2..00000000
--- a/vault-core/src/test/resources/test-packages/enhanced_file_aggregate.zip/META-INF/vault/settings.xml
+++ /dev/null
@@ -1,21 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!--
-  Licensed to the Apache Software Foundation (ASF) under one or more
-  contributor license agreements.  See the NOTICE file distributed with
-  this work for additional information regarding copyright ownership.
-  The ASF licenses this file to You under the Apache License, Version 2.0
-  (the "License"); you may not use this file except in compliance with
-  the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-  Unless required by applicable law or agreed to in writing, software
-  distributed under the License is distributed on an "AS IS" BASIS,
-  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  See the License for the specific language governing permissions and
-  limitations under the License.
-  -->
-<vault version="1.0">
-  <ignore name=".svn"/>
-  <ignore name=".DS_Store"/>
-</vault>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/enhanced_file_aggregate.zip/jcr_root/testroot/.content.xml b/vault-core/src/test/resources/test-packages/enhanced_file_aggregate.zip/jcr_root/testroot/.content.xml
deleted file mode 100644
index 48279148..00000000
--- a/vault-core/src/test/resources/test-packages/enhanced_file_aggregate.zip/jcr_root/testroot/.content.xml
+++ /dev/null
@@ -1,9 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-          jcr:primaryType="nt:unstructured">
-    <tika jcr:primaryType="nt:unstructured">
-        <config.xml jcr:primaryType="nt:file">
-            <jcr:content jcr:primaryType="nt:resource" jcr:mimeType="text/xml"/>
-        </config.xml>
-    </tika>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/enhanced_file_aggregate.zip/jcr_root/testroot/tika/config.xml b/vault-core/src/test/resources/test-packages/enhanced_file_aggregate.zip/jcr_root/testroot/tika/config.xml
deleted file mode 100644
index b6900ba3..00000000
--- a/vault-core/src/test/resources/test-packages/enhanced_file_aggregate.zip/jcr_root/testroot/tika/config.xml
+++ /dev/null
@@ -1,11 +0,0 @@
-<properties>
-    <detectors>
-        <detector class="org.apache.tika.detect.TypeDetector"/>
-    </detectors>
-    <parsers>
-        <parser class="org.apache.tika.parser.DefaultParser">
-            <mime>text/plain</mime>
-        </parser>
-    </parsers>
-    <service-loader initializableProblemHandler="ignore" dynamic="true"/>
-</properties>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/external_hook.zip b/vault-core/src/test/resources/test-packages/external_hook.zip
deleted file mode 100644
index 1bbb7175..00000000
Binary files a/vault-core/src/test/resources/test-packages/external_hook.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/external_hook_failing_in_installed_phase.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/external_hook_failing_in_installed_phase.zip/META-INF/vault/filter.xml
deleted file mode 100644
index c3129357..00000000
--- a/vault-core/src/test/resources/test-packages/external_hook_failing_in_installed_phase.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot" mode="merge"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/external_hook_failing_in_installed_phase.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/external_hook_failing_in_installed_phase.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/external_hook_failing_in_installed_phase.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/external_hook_failing_in_installed_phase.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/external_hook_failing_in_installed_phase.zip/META-INF/vault/properties.xml
deleted file mode 100644
index beeaff16..00000000
--- a/vault-core/src/test/resources/test-packages/external_hook_failing_in_installed_phase.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,20 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">tmp</entry>
-<entry key="lastModified">2011-06-07T14:31:49.179-07:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-06-07T14:31:49.418-07:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="group">my_packages</entry>
-<entry key="lastWrapped">2011-06-07T14:31:49.179-07:00</entry>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="path">/etc/packages/my_packages/tmp</entry>
-<entry key="installhook.test1.class">org.apache.jackrabbit.vault.packaging.integration.ExternalTestHookFailingInPhaseInstalled</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/external_hook_failing_in_installed_phase.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/external_hook_failing_in_installed_phase.zip/jcr_root/.content.xml
deleted file mode 100644
index 115aa46c..00000000
--- a/vault-core/src/test/resources/test-packages/external_hook_failing_in_installed_phase.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/external_hook_failing_in_installed_phase.zip/jcr_root/testroot/.content.xml b/vault-core/src/test/resources/test-packages/external_hook_failing_in_installed_phase.zip/jcr_root/testroot/.content.xml
deleted file mode 100644
index 95cfbcb0..00000000
--- a/vault-core/src/test/resources/test-packages/external_hook_failing_in_installed_phase.zip/jcr_root/testroot/.content.xml
+++ /dev/null
@@ -1,21 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!--
-  ~ Licensed to the Apache Software Foundation (ASF) under one or more
-  ~ contributor license agreements.  See the NOTICE file distributed with
-  ~ this work for additional information regarding copyright ownership.
-  ~ The ASF licenses this file to You under the Apache License, Version 2.0
-  ~ (the "License"); you may not use this file except in compliance with
-  ~ the License.  You may obtain a copy of the License at
-  ~
-  ~      http://www.apache.org/licenses/LICENSE-2.0
-  ~
-  ~ Unless required by applicable law or agreed to in writing, software
-  ~ distributed under the License is distributed on an "AS IS" BASIS,
-  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  ~ See the License for the specific language governing permissions and
-  ~ limitations under the License.
-  -->
-
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="nt:folder">
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/filtered_package.zip b/vault-core/src/test/resources/test-packages/filtered_package.zip
deleted file mode 100644
index b9614f6c..00000000
Binary files a/vault-core/src/test/resources/test-packages/filtered_package.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/META-INF/MANIFEST.MF b/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/META-INF/MANIFEST.MF
deleted file mode 100644
index ce009370..00000000
--- a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/META-INF/MANIFEST.MF
+++ /dev/null
@@ -1,5 +0,0 @@
-Manifest-Version: 1.0
-Content-Package-Id: my_packages:test
-Content-Package-Roots: /test
-Content-Package-Type: content
-
diff --git a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/META-INF/vault/config.xml b/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/META-INF/vault/config.xml
deleted file mode 100644
index b525f1c5..00000000
--- a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/META-INF/vault/config.xml
+++ /dev/null
@@ -1,93 +0,0 @@
-<!--
-  Licensed to the Apache Software Foundation (ASF) under one or more
-  contributor license agreements.  See the NOTICE file distributed with
-  this work for additional information regarding copyright ownership.
-  The ASF licenses this file to You under the Apache License, Version 2.0
-  (the "License"); you may not use this file except in compliance with
-  the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-  Unless required by applicable law or agreed to in writing, software
-  distributed under the License is distributed on an "AS IS" BASIS,
-  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  See the License for the specific language governing permissions and
-  limitations under the License.
-  -->
-<vaultfs version="1.1">
-    <!--
-        Defines the content aggregation. The order of the defined aggregates
-        is important for finding the correct aggregator.
-    -->
-    <aggregates>
-        <!--
-            Defines an aggregate that handles nt:file and nt:resource nodes.
-        -->
-        <aggregate type="file" title="File Aggregate"/>
-
-        <!--
-            Defines an aggregate that handles file/folder like nodes. It matches
-            all nt:hierarchyNode nodes that have or define a jcr:content
-            child node and excludes child nodes that are nt:hierarchyNodes.
-        -->
-        <aggregate type="filefolder" title="File/Folder Aggregate"/>
-
-        <!--
-            Defines an aggregate that handles nt:nodeType nodes and serializes
-            them into .cnd notation.
-        -->
-        <aggregate type="nodetype" title="Node Type Aggregate" />
-
-        <!--
-            Defines an aggregate that defines full coverage for certain node
-            types that cannot be covered by the default aggregator.
-        -->
-        <aggregate type="full" title="Full Coverage Aggregate">
-            <matches>
-                <include nodeType="rep:AccessControl" respectSupertype="true" />
-                <include nodeType="rep:Policy" respectSupertype="true" />
-                <include nodeType="cq:Widget" respectSupertype="true" />
-                <include nodeType="cq:EditConfig" respectSupertype="true" />
-                <include nodeType="cq:WorkflowModel" respectSupertype="true" />
-                <include nodeType="vlt:FullCoverage" respectSupertype="true" />
-                <include nodeType="mix:language" respectSupertype="true" />
-                <include nodeType="sling:OsgiConfig" respectSupertype="true" />
-            </matches>
-        </aggregate>
-
-        <!--
-            Defines an aggregate that handles nt:folder like nodes.
-        -->
-        <aggregate type="generic" title="Folder Aggregate">
-            <matches>
-                <include nodeType="nt:folder" respectSupertype="true" />
-            </matches>
-            <contains>
-                <exclude isNode="true" />
-            </contains>
-        </aggregate>
-
-        <!--
-            Defines the default aggregate
-        -->
-        <aggregate type="generic" title="Default Aggregator" isDefault="true">
-            <matches>
-                <!-- all -->
-            </matches>
-            <contains>
-                <exclude nodeType="nt:hierarchyNode" respectSupertype="true" />
-            </contains>
-        </aggregate>
-
-    </aggregates>
-
-    <!--
-      defines the input handlers
-    -->
-    <handlers>
-        <handler type="folder"/>
-        <handler type="file"/>
-        <handler type="nodetype"/>
-        <handler type="generic"/>
-    </handlers>
-</vaultfs>
diff --git a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 365b0e01..00000000
--- a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,5 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot"/>
-    <filter root="/var/foo/bar"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index b4da1883..00000000
--- a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,17 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-<'rep'='internal'>
-
-[sling:OrderedFolder] > sling:Folder
-  orderable
-  + * (nt:base) = sling:OrderedFolder version
-
-[sling:Folder] > nt:folder
-  - * (undefined) multiple
-  - * (undefined)
-  + * (nt:base) = sling:Folder version
-
-[rep:RepoAccessControllable]
-  mixin
-  + rep:repoPolicy (rep:Policy) protected ignore
-
diff --git a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/META-INF/vault/properties.xml
deleted file mode 100644
index 3e74f568..00000000
--- a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="description"></entry>
-<entry key="packageType">content</entry>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="packageFormatVersion">2</entry>
-<entry key="group">my_packages</entry>
-<entry key="created">2020-02-24T22:42:03.819Z</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="buildCount">1</entry>
-<entry key="lastWrapped">2020-02-24T22:42:03.705Z</entry>
-<entry key="version"></entry>
-<entry key="dependencies"></entry>
-<entry key="createdBy">admin</entry>
-<entry key="name">test</entry>
-<entry key="lastModified">2020-02-24T22:42:03.705Z</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/jcr_root/testroot/.content.xml b/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/jcr_root/testroot/.content.xml
deleted file mode 100644
index b51ae1af..00000000
--- a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/jcr_root/testroot/.content.xml
+++ /dev/null
@@ -1,5 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-    jcr:primaryType="nt:unstructured">
-    <foo />
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/jcr_root/testroot/foo/bar/.content.xml b/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/jcr_root/testroot/foo/bar/.content.xml
deleted file mode 100644
index 78907058..00000000
--- a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/jcr_root/testroot/foo/bar/.content.xml
+++ /dev/null
@@ -1,5 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-    jcr:primaryType="sling:Folder">
-    
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/jcr_root/testroot/foo/bar/baz/.content.xml b/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/jcr_root/testroot/foo/bar/baz/.content.xml
deleted file mode 100644
index b5746e01..00000000
--- a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/jcr_root/testroot/foo/bar/baz/.content.xml
+++ /dev/null
@@ -1,3 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:OrderedFolder"/>
diff --git a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/jcr_root/var/.content.xml b/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/jcr_root/var/.content.xml
deleted file mode 100644
index b51ae1af..00000000
--- a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/jcr_root/var/.content.xml
+++ /dev/null
@@ -1,5 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-    jcr:primaryType="nt:unstructured">
-    <foo />
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/jcr_root/var/foo/bar/.content.xml b/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/jcr_root/var/foo/bar/.content.xml
deleted file mode 100644
index 78907058..00000000
--- a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/jcr_root/var/foo/bar/.content.xml
+++ /dev/null
@@ -1,5 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-    jcr:primaryType="sling:Folder">
-    
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/jcr_root/var/foo/bar/baz/.content.xml b/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/jcr_root/var/foo/bar/baz/.content.xml
deleted file mode 100644
index b5746e01..00000000
--- a/vault-core/src/test/resources/test-packages/folder-without-docview-element.zip/jcr_root/var/foo/bar/baz/.content.xml
+++ /dev/null
@@ -1,3 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:OrderedFolder"/>
diff --git a/vault-core/src/test/resources/test-packages/fullcoverage.zip b/vault-core/src/test/resources/test-packages/fullcoverage.zip
deleted file mode 100644
index becf0ca7..00000000
Binary files a/vault-core/src/test/resources/test-packages/fullcoverage.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/group_with_a.zip b/vault-core/src/test/resources/test-packages/group_with_a.zip
deleted file mode 100644
index ded1dc75..00000000
Binary files a/vault-core/src/test/resources/test-packages/group_with_a.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/group_with_a_moved.zip b/vault-core/src/test/resources/test-packages/group_with_a_moved.zip
deleted file mode 100644
index 7f1f035e..00000000
Binary files a/vault-core/src/test/resources/test-packages/group_with_a_moved.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/group_with_bc.zip b/vault-core/src/test/resources/test-packages/group_with_bc.zip
deleted file mode 100644
index 69dc33f5..00000000
Binary files a/vault-core/src/test/resources/test-packages/group_with_bc.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 572c30b9..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,8 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot/replace" mode="replace"/>
-    <filter root="/testroot/merge" mode="merge"/>
-    <filter root="/testroot/update" mode="update"/>
-    <filter root="/testroot/merge_properties" mode="merge_properties"/>
-    <filter root="/testroot/update_properties" mode="update_properties"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/META-INF/vault/properties.xml
deleted file mode 100644
index c606e192..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,18 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">import-modes-test</entry>
-<entry key="lastModified">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:45:14.685+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/.content.xml
deleted file mode 100644
index e546f292..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/testroot/.content.xml b/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/testroot/.content.xml
deleted file mode 100644
index 57bca0f5..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/testroot/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="sling:Folder">
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/testroot/merge b/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/testroot/merge
deleted file mode 100644
index 3e5126c4..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/testroot/merge
+++ /dev/null
@@ -1 +0,0 @@
-new
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/testroot/merge_properties b/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/testroot/merge_properties
deleted file mode 100644
index 3e5126c4..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/testroot/merge_properties
+++ /dev/null
@@ -1 +0,0 @@
-new
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/testroot/replace b/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/testroot/replace
deleted file mode 100644
index 3e5126c4..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/testroot/replace
+++ /dev/null
@@ -1 +0,0 @@
-new
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/testroot/update b/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/testroot/update
deleted file mode 100644
index 3e5126c4..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/testroot/update
+++ /dev/null
@@ -1 +0,0 @@
-new
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/testroot/update_properties b/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/testroot/update_properties
deleted file mode 100644
index 3e5126c4..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_filehandler.zip/jcr_root/testroot/update_properties
+++ /dev/null
@@ -1 +0,0 @@
-new
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 572c30b9..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,8 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot/replace" mode="replace"/>
-    <filter root="/testroot/merge" mode="merge"/>
-    <filter root="/testroot/update" mode="update"/>
-    <filter root="/testroot/merge_properties" mode="merge_properties"/>
-    <filter root="/testroot/update_properties" mode="update_properties"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/META-INF/vault/properties.xml
deleted file mode 100644
index c606e192..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,18 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">import-modes-test</entry>
-<entry key="lastModified">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:45:14.685+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/.content.xml
deleted file mode 100644
index e546f292..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/testroot/.content.xml b/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/testroot/.content.xml
deleted file mode 100644
index 57bca0f5..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/testroot/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="sling:Folder">
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/testroot/merge.xml b/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/testroot/merge.xml
deleted file mode 100644
index e9f90d89..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/testroot/merge.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="sling:Folder" propertyupdate="new" propertynew="new">
-    <existing jcr:primaryType="sling:Folder" propertynew="new" />
-    <new jcr:primaryType="sling:Folder" />
-</jcr:root>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/testroot/merge_properties.xml b/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/testroot/merge_properties.xml
deleted file mode 100644
index e9f90d89..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/testroot/merge_properties.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="sling:Folder" propertyupdate="new" propertynew="new">
-    <existing jcr:primaryType="sling:Folder" propertynew="new" />
-    <new jcr:primaryType="sling:Folder" />
-</jcr:root>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/testroot/replace.xml b/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/testroot/replace.xml
deleted file mode 100644
index e9f90d89..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/testroot/replace.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="sling:Folder" propertyupdate="new" propertynew="new">
-    <existing jcr:primaryType="sling:Folder" propertynew="new" />
-    <new jcr:primaryType="sling:Folder" />
-</jcr:root>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/testroot/update.xml b/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/testroot/update.xml
deleted file mode 100644
index e9f90d89..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/testroot/update.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="sling:Folder" propertyupdate="new" propertynew="new">
-    <existing jcr:primaryType="sling:Folder" propertynew="new" />
-    <new jcr:primaryType="sling:Folder" />
-</jcr:root>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/testroot/update_properties.xml b/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/testroot/update_properties.xml
deleted file mode 100644
index e9f90d89..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler2_docview.zip/jcr_root/testroot/update_properties.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="sling:Folder" propertyupdate="new" propertynew="new">
-    <existing jcr:primaryType="sling:Folder" propertynew="new" />
-    <new jcr:primaryType="sling:Folder" />
-</jcr:root>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler_docview.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/import_modes_test_generichandler_docview.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 572c30b9..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler_docview.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,8 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot/replace" mode="replace"/>
-    <filter root="/testroot/merge" mode="merge"/>
-    <filter root="/testroot/update" mode="update"/>
-    <filter root="/testroot/merge_properties" mode="merge_properties"/>
-    <filter root="/testroot/update_properties" mode="update_properties"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler_docview.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/import_modes_test_generichandler_docview.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler_docview.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler_docview.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/import_modes_test_generichandler_docview.zip/META-INF/vault/properties.xml
deleted file mode 100644
index c606e192..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler_docview.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,18 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">import-modes-test</entry>
-<entry key="lastModified">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:45:14.685+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler_docview.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/import_modes_test_generichandler_docview.zip/jcr_root/.content.xml
deleted file mode 100644
index e546f292..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler_docview.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler_docview.zip/jcr_root/testroot/.content.xml b/vault-core/src/test/resources/test-packages/import_modes_test_generichandler_docview.zip/jcr_root/testroot/.content.xml
deleted file mode 100644
index da0fa1cf..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_generichandler_docview.zip/jcr_root/testroot/.content.xml
+++ /dev/null
@@ -1,34 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="sling:Folder">
-    <replace jcr:primaryType="sling:Folder"
-        propertyupdate="new"
-        propertynew="new">
-        <existing jcr:primaryType="sling:Folder" propertynew="new" />
-        <new jcr:primaryType="sling:Folder" />
-    </replace>
-    <merge jcr:primaryType="sling:Folder"
-        propertyupdate="new"
-        propertynew="new">
-        <existing jcr:primaryType="sling:Folder" propertynew="new" />
-        <new jcr:primaryType="sling:Folder" />
-    </merge>
-    <update jcr:primaryType="sling:Folder"
-        propertyupdate="new"
-        propertynew="new">
-        <existing jcr:primaryType="sling:Folder" propertynew="new"/>
-        <new jcr:primaryType="sling:Folder" />
-    </update>
-    <merge_properties jcr:primaryType="sling:Folder"
-        propertyupdate="new"
-        propertynew="new">
-        <existing jcr:primaryType="sling:Folder" propertynew="new" />
-        <new jcr:primaryType="sling:Folder" />
-    </merge_properties>
-    <update_properties jcr:primaryType="sling:Folder"
-        propertyupdate="new"
-        propertynew="new">
-        <existing jcr:primaryType="sling:Folder" propertynew="new"/>
-        <new jcr:primaryType="sling:Folder" />
-    </update_properties>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_missing_artifacts.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/import_modes_test_missing_artifacts.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 572c30b9..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_missing_artifacts.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,8 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot/replace" mode="replace"/>
-    <filter root="/testroot/merge" mode="merge"/>
-    <filter root="/testroot/update" mode="update"/>
-    <filter root="/testroot/merge_properties" mode="merge_properties"/>
-    <filter root="/testroot/update_properties" mode="update_properties"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_missing_artifacts.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/import_modes_test_missing_artifacts.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_missing_artifacts.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_missing_artifacts.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/import_modes_test_missing_artifacts.zip/META-INF/vault/properties.xml
deleted file mode 100644
index c606e192..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_missing_artifacts.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,18 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">import-modes-test</entry>
-<entry key="lastModified">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:45:14.685+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_missing_artifacts.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/import_modes_test_missing_artifacts.zip/jcr_root/.content.xml
deleted file mode 100644
index e546f292..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_missing_artifacts.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/import_modes_test_missing_artifacts.zip/jcr_root/testroot/.content.xml b/vault-core/src/test/resources/test-packages/import_modes_test_missing_artifacts.zip/jcr_root/testroot/.content.xml
deleted file mode 100644
index 57bca0f5..00000000
--- a/vault-core/src/test/resources/test-packages/import_modes_test_missing_artifacts.zip/jcr_root/testroot/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="sling:Folder">
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/intermediate_folders.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/intermediate_folders.zip/META-INF/vault/filter.xml
deleted file mode 100644
index d11d3ef0..00000000
--- a/vault-core/src/test/resources/test-packages/intermediate_folders.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot/myfolder/mychild"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/intermediate_folders.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/intermediate_folders.zip/META-INF/vault/properties.xml
deleted file mode 100644
index c606e192..00000000
--- a/vault-core/src/test/resources/test-packages/intermediate_folders.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,18 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">import-modes-test</entry>
-<entry key="lastModified">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:45:14.685+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/intermediate_folders.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/intermediate_folders.zip/jcr_root/.content.xml
deleted file mode 100644
index e546f292..00000000
--- a/vault-core/src/test/resources/test-packages/intermediate_folders.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/intermediate_folders.zip/jcr_root/testroot/myfolder/mychild/.content.xml b/vault-core/src/test/resources/test-packages/intermediate_folders.zip/jcr_root/testroot/myfolder/mychild/.content.xml
deleted file mode 100644
index 909ea7a7..00000000
--- a/vault-core/src/test/resources/test-packages/intermediate_folders.zip/jcr_root/testroot/myfolder/mychild/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal" xmlns:my="http://jackrabbit.apache.org/filevault/testing"
-    jcr:primaryType="nt:folder">
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/invalid_hook.zip b/vault-core/src/test/resources/test-packages/invalid_hook.zip
deleted file mode 100644
index 3d055f77..00000000
Binary files a/vault-core/src/test/resources/test-packages/invalid_hook.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/mandatory-non-residual-childnode.zip/META-INF/MANIFEST.MF b/vault-core/src/test/resources/test-packages/mandatory-non-residual-childnode.zip/META-INF/MANIFEST.MF
deleted file mode 100644
index 60c85a6b..00000000
--- a/vault-core/src/test/resources/test-packages/mandatory-non-residual-childnode.zip/META-INF/MANIFEST.MF
+++ /dev/null
@@ -1,5 +0,0 @@
-Manifest-Version: 1.0
-Content-Package-Roots: /libs/msm/wcm
-Content-Package-Type: application
-Content-Package-Id: my_packages:wcm-rollout-config:1
-
diff --git a/vault-core/src/test/resources/test-packages/mandatory-non-residual-childnode.zip/META-INF/vault/config.xml b/vault-core/src/test/resources/test-packages/mandatory-non-residual-childnode.zip/META-INF/vault/config.xml
deleted file mode 100644
index b525f1c5..00000000
--- a/vault-core/src/test/resources/test-packages/mandatory-non-residual-childnode.zip/META-INF/vault/config.xml
+++ /dev/null
@@ -1,93 +0,0 @@
-<!--
-  Licensed to the Apache Software Foundation (ASF) under one or more
-  contributor license agreements.  See the NOTICE file distributed with
-  this work for additional information regarding copyright ownership.
-  The ASF licenses this file to You under the Apache License, Version 2.0
-  (the "License"); you may not use this file except in compliance with
-  the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-  Unless required by applicable law or agreed to in writing, software
-  distributed under the License is distributed on an "AS IS" BASIS,
-  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  See the License for the specific language governing permissions and
-  limitations under the License.
-  -->
-<vaultfs version="1.1">
-    <!--
-        Defines the content aggregation. The order of the defined aggregates
-        is important for finding the correct aggregator.
-    -->
-    <aggregates>
-        <!--
-            Defines an aggregate that handles nt:file and nt:resource nodes.
-        -->
-        <aggregate type="file" title="File Aggregate"/>
-
-        <!--
-            Defines an aggregate that handles file/folder like nodes. It matches
-            all nt:hierarchyNode nodes that have or define a jcr:content
-            child node and excludes child nodes that are nt:hierarchyNodes.
-        -->
-        <aggregate type="filefolder" title="File/Folder Aggregate"/>
-
-        <!--
-            Defines an aggregate that handles nt:nodeType nodes and serializes
-            them into .cnd notation.
-        -->
-        <aggregate type="nodetype" title="Node Type Aggregate" />
-
-        <!--
-            Defines an aggregate that defines full coverage for certain node
-            types that cannot be covered by the default aggregator.
-        -->
-        <aggregate type="full" title="Full Coverage Aggregate">
-            <matches>
-                <include nodeType="rep:AccessControl" respectSupertype="true" />
-                <include nodeType="rep:Policy" respectSupertype="true" />
-                <include nodeType="cq:Widget" respectSupertype="true" />
-                <include nodeType="cq:EditConfig" respectSupertype="true" />
-                <include nodeType="cq:WorkflowModel" respectSupertype="true" />
-                <include nodeType="vlt:FullCoverage" respectSupertype="true" />
-                <include nodeType="mix:language" respectSupertype="true" />
-                <include nodeType="sling:OsgiConfig" respectSupertype="true" />
-            </matches>
-        </aggregate>
-
-        <!--
-            Defines an aggregate that handles nt:folder like nodes.
-        -->
-        <aggregate type="generic" title="Folder Aggregate">
-            <matches>
-                <include nodeType="nt:folder" respectSupertype="true" />
-            </matches>
-            <contains>
-                <exclude isNode="true" />
-            </contains>
-        </aggregate>
-
-        <!--
-            Defines the default aggregate
-        -->
-        <aggregate type="generic" title="Default Aggregator" isDefault="true">
-            <matches>
-                <!-- all -->
-            </matches>
-            <contains>
-                <exclude nodeType="nt:hierarchyNode" respectSupertype="true" />
-            </contains>
-        </aggregate>
-
-    </aggregates>
-
-    <!--
-      defines the input handlers
-    -->
-    <handlers>
-        <handler type="folder"/>
-        <handler type="file"/>
-        <handler type="nodetype"/>
-        <handler type="generic"/>
-    </handlers>
-</vaultfs>
diff --git a/vault-core/src/test/resources/test-packages/mandatory-non-residual-childnode.zip/META-INF/vault/definition/.content.xml b/vault-core/src/test/resources/test-packages/mandatory-non-residual-childnode.zip/META-INF/vault/definition/.content.xml
deleted file mode 100644
index 9c00456c..00000000
--- a/vault-core/src/test/resources/test-packages/mandatory-non-residual-childnode.zip/META-INF/vault/definition/.content.xml
+++ /dev/null
@@ -1,24 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:vlt="http://www.day.com/jcr/vault/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-    jcr:created="{Date}2021-07-21T17:12:34.610+12:00"
-    jcr:createdBy="admin"
-    jcr:description=""
-    jcr:lastModified="{Date}2021-07-21T17:12:34.610+12:00"
-    jcr:lastModifiedBy="admin"
-    jcr:primaryType="vlt:PackageDefinition"
-    buildCount="1"
-    group="my_packages"
-    lastUnwrapped="{Date}2021-07-21T17:12:34.610+12:00"
-    lastUnwrappedBy="admin"
-    lastWrapped="{Date}2021-07-21T17:12:34.610+12:00"
-    lastWrappedBy="admin"
-    name="wcm-rollout-config"
-    version="2">
-    <filter jcr:primaryType="nt:unstructured">
-        <f0
-            jcr:primaryType="nt:unstructured"
-            mode="replace"
-            root="/libs/msm/wcm"
-            rules="[]"/>
-    </filter>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mandatory-non-residual-childnode.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/mandatory-non-residual-childnode.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 0d4f8b30..00000000
--- a/vault-core/src/test/resources/test-packages/mandatory-non-residual-childnode.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot/jcr:content"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/mandatory-non-residual-childnode.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/mandatory-non-residual-childnode.zip/META-INF/vault/properties.xml
deleted file mode 100644
index 00866f7d..00000000
--- a/vault-core/src/test/resources/test-packages/mandatory-non-residual-childnode.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">wcm-rollout-config</entry>
-<entry key="lastModified">2021-07-21T17:12:34.610+12:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2021-07-21T17:12:34.623+12:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version">2</entry>
-<entry key="packageType">application</entry>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2021-07-21T17:12:34.610+12:00</entry>
-<entry key="group">my_packages</entry>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/mandatory-non-residual-childnode.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/mandatory-non-residual-childnode.zip/jcr_root/.content.xml
deleted file mode 100644
index 8ea9f2ae..00000000
--- a/vault-core/src/test/resources/test-packages/mandatory-non-residual-childnode.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable,rep:RepoAccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html"/>
diff --git a/vault-core/src/test/resources/test-packages/mixed_package.zip b/vault-core/src/test/resources/test-packages/mixed_package.zip
deleted file mode 100644
index c6d1f112..00000000
Binary files a/vault-core/src/test/resources/test-packages/mixed_package.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_subpackage.zip b/vault-core/src/test/resources/test-packages/mode_ac_subpackage.zip
deleted file mode 100644
index f3a148e4..00000000
Binary files a/vault-core/src/test/resources/test-packages/mode_ac_subpackage.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/META-INF/vault/filter.xml
deleted file mode 100644
index c3129357..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot" mode="merge"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/META-INF/vault/properties.xml
deleted file mode 100644
index c32f9763..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">mode_ac_test_a</entry>
-<entry key="lastModified">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:43:22.993+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="acHandling">overwrite</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/jcr_root/.content.xml
deleted file mode 100644
index 115aa46c..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/jcr_root/testroot/node_a/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/jcr_root/testroot/node_a/.content.xml
deleted file mode 100644
index 61b37c82..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/jcr_root/testroot/node_a/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:Folder"
-    title="1234"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/jcr_root/testroot/secured/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/jcr_root/testroot/secured/.content.xml
deleted file mode 100644
index 792d2ead..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/jcr_root/testroot/secured/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="nt:folder"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/jcr_root/testroot/secured/_rep_policy.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/jcr_root/testroot/secured/_rep_policy.xml
deleted file mode 100644
index 8a415d58..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_a.zip/jcr_root/testroot/secured/_rep_policy.xml
+++ /dev/null
@@ -1,9 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root
-        xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="rep:ACL">
-    <deny
-        jcr:primaryType="rep:DenyACE"
-        rep:principalName="everyone"
-        rep:privileges="{Name}[jcr:all]"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_a_uuid.zip b/vault-core/src/test/resources/test-packages/mode_ac_test_a_uuid.zip
deleted file mode 100644
index 8d5e73e5..00000000
Binary files a/vault-core/src/test/resources/test-packages/mode_ac_test_a_uuid.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/META-INF/vault/filter.xml
deleted file mode 100644
index c3129357..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot" mode="merge"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/META-INF/vault/properties.xml
deleted file mode 100644
index 8d05d969..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">mode_ac_test_b</entry>
-<entry key="lastModified">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:45:14.685+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="acHandling">overwrite</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/jcr_root/.content.xml
deleted file mode 100644
index 115aa46c..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/jcr_root/testroot/node_a/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/jcr_root/testroot/node_a/.content.xml
deleted file mode 100644
index 61b37c82..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/jcr_root/testroot/node_a/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:Folder"
-    title="1234"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/jcr_root/testroot/node_b/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/jcr_root/testroot/node_b/.content.xml
deleted file mode 100644
index 93a6a159..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/jcr_root/testroot/node_b/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:Folder"
-    title="5678"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/jcr_root/testroot/secured/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/jcr_root/testroot/secured/.content.xml
deleted file mode 100644
index 792d2ead..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/jcr_root/testroot/secured/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="nt:folder"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/jcr_root/testroot/secured/_rep_policy.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/jcr_root/testroot/secured/_rep_policy.xml
deleted file mode 100644
index c2a9ba76..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b.zip/jcr_root/testroot/secured/_rep_policy.xml
+++ /dev/null
@@ -1,13 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="rep:ACL">
-    <deny
-        jcr:primaryType="rep:DenyACE"
-        rep:principalName="everyone"
-        rep:privileges="{Name}[jcr:all]"/>
-    <allow
-        jcr:primaryType="rep:GrantACE"
-        rep:glob="*/foo/*"
-        rep:principalName="everyone"
-        rep:privileges="{Name}[jcr:read]"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/META-INF/vault/filter.xml
deleted file mode 100644
index c3129357..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot" mode="merge"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/META-INF/vault/properties.xml
deleted file mode 100644
index b32cbe33..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">mode_ac_test_b2_merge</entry>
-<entry key="lastModified">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:45:14.685+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="acHandling">merge</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/jcr_root/.content.xml
deleted file mode 100644
index 115aa46c..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/jcr_root/testroot/node_a/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/jcr_root/testroot/node_a/.content.xml
deleted file mode 100644
index 61b37c82..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/jcr_root/testroot/node_a/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:Folder"
-    title="1234"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/jcr_root/testroot/node_b/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/jcr_root/testroot/node_b/.content.xml
deleted file mode 100644
index 93a6a159..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/jcr_root/testroot/node_b/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:Folder"
-    title="5678"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/jcr_root/testroot/secured/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/jcr_root/testroot/secured/.content.xml
deleted file mode 100644
index 792d2ead..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/jcr_root/testroot/secured/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="nt:folder"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/jcr_root/testroot/secured/_rep_policy.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/jcr_root/testroot/secured/_rep_policy.xml
deleted file mode 100644
index 9133e11b..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b2_merge.zip/jcr_root/testroot/secured/_rep_policy.xml
+++ /dev/null
@@ -1,8 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="rep:ACL">
-    <allow
-        jcr:primaryType="rep:GrantACE"
-        rep:principalName="everyone"
-        rep:privileges="{Name}[jcr:read,jcr:write]"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/META-INF/vault/filter.xml
deleted file mode 100644
index c3129357..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot" mode="merge"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/META-INF/vault/properties.xml
deleted file mode 100644
index 268cbf20..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">mode_ac_test_b3_merge</entry>
-<entry key="lastModified">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:45:14.685+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="acHandling">merge</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/jcr_root/.content.xml
deleted file mode 100644
index 115aa46c..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/jcr_root/testroot/node_a/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/jcr_root/testroot/node_a/.content.xml
deleted file mode 100644
index 61b37c82..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/jcr_root/testroot/node_a/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:Folder"
-    title="1234"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/jcr_root/testroot/node_b/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/jcr_root/testroot/node_b/.content.xml
deleted file mode 100644
index 93a6a159..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/jcr_root/testroot/node_b/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:Folder"
-    title="5678"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/jcr_root/testroot/secured/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/jcr_root/testroot/secured/.content.xml
deleted file mode 100644
index 792d2ead..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/jcr_root/testroot/secured/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="nt:folder"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/jcr_root/testroot/secured/_rep_policy.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/jcr_root/testroot/secured/_rep_policy.xml
deleted file mode 100644
index 118cd594..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b3_merge.zip/jcr_root/testroot/secured/_rep_policy.xml
+++ /dev/null
@@ -1,8 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="rep:ACL">
-    <allow
-        jcr:primaryType="rep:GrantACE"
-        rep:principalName="everyone"
-        rep:privileges="{Name}[jcr:read,jcr:versionManagement]"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/META-INF/vault/filter.xml
deleted file mode 100644
index c3129357..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot" mode="merge"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/META-INF/vault/properties.xml
deleted file mode 100644
index d5c47e9d..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">mode_ac_test_b_merge</entry>
-<entry key="lastModified">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:45:14.685+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="acHandling">merge</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/jcr_root/.content.xml
deleted file mode 100644
index 115aa46c..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/jcr_root/testroot/node_a/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/jcr_root/testroot/node_a/.content.xml
deleted file mode 100644
index 61b37c82..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/jcr_root/testroot/node_a/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:Folder"
-    title="1234"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/jcr_root/testroot/node_b/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/jcr_root/testroot/node_b/.content.xml
deleted file mode 100644
index 93a6a159..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/jcr_root/testroot/node_b/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:Folder"
-    title="5678"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/jcr_root/testroot/secured/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/jcr_root/testroot/secured/.content.xml
deleted file mode 100644
index 792d2ead..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/jcr_root/testroot/secured/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="nt:folder"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/jcr_root/testroot/secured/_rep_policy.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/jcr_root/testroot/secured/_rep_policy.xml
deleted file mode 100644
index c2a9ba76..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b_merge.zip/jcr_root/testroot/secured/_rep_policy.xml
+++ /dev/null
@@ -1,13 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="rep:ACL">
-    <deny
-        jcr:primaryType="rep:DenyACE"
-        rep:principalName="everyone"
-        rep:privileges="{Name}[jcr:all]"/>
-    <allow
-        jcr:primaryType="rep:GrantACE"
-        rep:glob="*/foo/*"
-        rep:principalName="everyone"
-        rep:privileges="{Name}[jcr:read]"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/META-INF/vault/filter.xml
deleted file mode 100644
index c3129357..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot" mode="merge"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/META-INF/vault/properties.xml
deleted file mode 100644
index 1613288a..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">mode_ac_test_b_preserve</entry>
-<entry key="lastModified">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:45:14.685+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="acHandling">merge_preserve</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/jcr_root/.content.xml
deleted file mode 100644
index 115aa46c..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/jcr_root/testroot/node_a/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/jcr_root/testroot/node_a/.content.xml
deleted file mode 100644
index 61b37c82..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/jcr_root/testroot/node_a/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:Folder"
-    title="1234"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/jcr_root/testroot/node_b/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/jcr_root/testroot/node_b/.content.xml
deleted file mode 100644
index 93a6a159..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/jcr_root/testroot/node_b/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:Folder"
-    title="5678"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/jcr_root/testroot/secured/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/jcr_root/testroot/secured/.content.xml
deleted file mode 100644
index 792d2ead..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/jcr_root/testroot/secured/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="nt:folder"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/jcr_root/testroot/secured/_rep_policy.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/jcr_root/testroot/secured/_rep_policy.xml
deleted file mode 100644
index c2a9ba76..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_b_preserve.zip/jcr_root/testroot/secured/_rep_policy.xml
+++ /dev/null
@@ -1,13 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="rep:ACL">
-    <deny
-        jcr:primaryType="rep:DenyACE"
-        rep:principalName="everyone"
-        rep:privileges="{Name}[jcr:all]"/>
-    <allow
-        jcr:primaryType="rep:GrantACE"
-        rep:glob="*/foo/*"
-        rep:principalName="everyone"
-        rep:privileges="{Name}[jcr:read]"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/META-INF/vault/filter.xml
deleted file mode 100644
index c3129357..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot" mode="merge"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/META-INF/vault/properties.xml
deleted file mode 100644
index 09f47f2c..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">mode_ac_test_c_merge</entry>
-<entry key="lastModified">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:43:22.993+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="acHandling">merge</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/jcr_root/.content.xml
deleted file mode 100644
index 115aa46c..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/jcr_root/testroot/node_c/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/jcr_root/testroot/node_c/.content.xml
deleted file mode 100644
index 61b37c82..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/jcr_root/testroot/node_c/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:Folder"
-    title="1234"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/jcr_root/testroot/secured/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/jcr_root/testroot/secured/.content.xml
deleted file mode 100644
index 792d2ead..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/jcr_root/testroot/secured/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="nt:folder"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/jcr_root/testroot/secured/_rep_policy.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/jcr_root/testroot/secured/_rep_policy.xml
deleted file mode 100644
index b401483b..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_c_merge.zip/jcr_root/testroot/secured/_rep_policy.xml
+++ /dev/null
@@ -1,8 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="rep:ACL">
-    <deny
-        jcr:primaryType="rep:GrantACE"
-        rep:principalName="testuser"
-        rep:privileges="{Name}[jcr:all]"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/META-INF/vault/filter.xml
deleted file mode 100644
index c3129357..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot" mode="merge"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/META-INF/vault/properties.xml
deleted file mode 100644
index 0237217e..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">mode_ac_test_d</entry>
-<entry key="lastModified">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:43:22.993+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="acHandling">merge</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/jcr_root/.content.xml
deleted file mode 100644
index 115aa46c..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/jcr_root/testroot/node_d/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/jcr_root/testroot/node_d/.content.xml
deleted file mode 100644
index 61b37c82..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/jcr_root/testroot/node_d/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:Folder"
-    title="1234"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/jcr_root/testroot/secured/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/jcr_root/testroot/secured/.content.xml
deleted file mode 100644
index 792d2ead..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/jcr_root/testroot/secured/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="nt:folder"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/jcr_root/testroot/secured/_rep_policy.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/jcr_root/testroot/secured/_rep_policy.xml
deleted file mode 100644
index 4c147790..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_d.zip/jcr_root/testroot/secured/_rep_policy.xml
+++ /dev/null
@@ -1,12 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="rep:ACL">
-    <allo
-        jcr:primaryType="rep:GrantACE"
-        rep:principalName="everyone"
-        rep:privileges="{Name}[jcr:all]"/>
-    <deny
-        jcr:primaryType="rep:GrantACE"
-        rep:principalName="testuser"
-        rep:privileges="{Name}[jcr:all]"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/META-INF/vault/filter.xml
deleted file mode 100644
index c3129357..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot" mode="merge"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/META-INF/vault/properties.xml
deleted file mode 100644
index 0237217e..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">mode_ac_test_d</entry>
-<entry key="lastModified">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:43:22.993+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="acHandling">merge</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/jcr_root/.content.xml
deleted file mode 100644
index 115aa46c..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/jcr_root/testroot/node_e/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/jcr_root/testroot/node_e/.content.xml
deleted file mode 100644
index 61b37c82..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/jcr_root/testroot/node_e/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:Folder"
-    title="1234"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/jcr_root/testroot/secured/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/jcr_root/testroot/secured/.content.xml
deleted file mode 100644
index 792d2ead..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/jcr_root/testroot/secured/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="nt:folder"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/jcr_root/testroot/secured/_rep_policy.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/jcr_root/testroot/secured/_rep_policy.xml
deleted file mode 100644
index 6efe1576..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_e.zip/jcr_root/testroot/secured/_rep_policy.xml
+++ /dev/null
@@ -1,16 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="rep:ACL">
-    <deny
-        jcr:primaryType="rep:DenyACE"
-        rep:principalName="everyone"
-        rep:privileges="{Name}[jcr:all]"/>
-    <allow
-        jcr:primaryType="rep:GrantACE"
-        rep:principalName="testuser"
-        rep:privileges="{Name}[jcr:all]"/>
-    <allow0
-        jcr:primaryType="rep:GrantACE"
-        rep:principalName="testuser1"
-        rep:privileges="{Name}[jcr:all]"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/META-INF/vault/filter.xml
deleted file mode 100644
index c3129357..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot" mode="merge"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/META-INF/vault/properties.xml
deleted file mode 100644
index daa40f17..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">mode_ac_test_lateuser</entry>
-<entry key="lastModified">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:43:22.993+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="acHandling">merge</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/jcr_root/.content.xml
deleted file mode 100644
index 115aa46c..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/jcr_root/testroot/node_d/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/jcr_root/testroot/node_d/.content.xml
deleted file mode 100644
index 61b37c82..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/jcr_root/testroot/node_d/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:Folder"
-    title="1234"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/jcr_root/testroot/secured/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/jcr_root/testroot/secured/.content.xml
deleted file mode 100644
index 792d2ead..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/jcr_root/testroot/secured/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="nt:folder"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/jcr_root/testroot/secured/_rep_policy.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/jcr_root/testroot/secured/_rep_policy.xml
deleted file mode 100644
index c998c4c4..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_lateuser.zip/jcr_root/testroot/secured/_rep_policy.xml
+++ /dev/null
@@ -1,8 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="rep:ACL">
-    <deny
-        jcr:primaryType="rep:GrantACE"
-        rep:principalName="missinguser"
-        rep:privileges="{Name}[jcr:all]"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_unsecured_nodetype.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_unsecured_nodetype.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 9cbc4f64..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_unsecured_nodetype.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,7 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot/secured" >
-	<exclude pattern="/testroot/secured/.*"/>
-    </filter>
-    <filter root="/testroot/tmpcontent" />
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_unsecured_nodetype.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/mode_ac_test_unsecured_nodetype.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_unsecured_nodetype.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_unsecured_nodetype.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_unsecured_nodetype.zip/META-INF/vault/properties.xml
deleted file mode 100644
index 5bc0689c..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_unsecured_nodetype.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">mode_ac_test_unsecured_nodetype.zip</entry>
-<entry key="lastModified">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:45:14.685+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="acHandling">merge_preserve</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_unsecured_nodetype.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_unsecured_nodetype.zip/jcr_root/.content.xml
deleted file mode 100644
index 115aa46c..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_unsecured_nodetype.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_unsecured_nodetype.zip/jcr_root/testroot/secured/.content.xml b/vault-core/src/test/resources/test-packages/mode_ac_test_unsecured_nodetype.zip/jcr_root/testroot/secured/.content.xml
deleted file mode 100644
index 491392d5..00000000
--- a/vault-core/src/test/resources/test-packages/mode_ac_test_unsecured_nodetype.zip/jcr_root/testroot/secured/.content.xml
+++ /dev/null
@@ -1,3 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:Folder"/>
diff --git a/vault-core/src/test/resources/test-packages/mode_ac_test_unsecured_uuid.zip b/vault-core/src/test/resources/test-packages/mode_ac_test_unsecured_uuid.zip
deleted file mode 100644
index 35b784b3..00000000
Binary files a/vault-core/src/test/resources/test-packages/mode_ac_test_unsecured_uuid.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/multipackage-a-1.0.zip b/vault-core/src/test/resources/test-packages/multipackage-a-1.0.zip
deleted file mode 100644
index c7518151..00000000
Binary files a/vault-core/src/test/resources/test-packages/multipackage-a-1.0.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/multipackage-a-2.0.zip b/vault-core/src/test/resources/test-packages/multipackage-a-2.0.zip
deleted file mode 100644
index d1fe5bd3..00000000
Binary files a/vault-core/src/test/resources/test-packages/multipackage-a-2.0.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/namespace.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/namespace.zip/META-INF/vault/filter.xml
deleted file mode 100644
index bbbd616d..00000000
--- a/vault-core/src/test/resources/test-packages/namespace.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/namespace.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/namespace.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 3771ba50..00000000
--- a/vault-core/src/test/resources/test-packages/namespace.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,9 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-<'cq'='http://www.day.com/jcr/cq/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/namespace.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/namespace.zip/META-INF/vault/properties.xml
deleted file mode 100644
index c606e192..00000000
--- a/vault-core/src/test/resources/test-packages/namespace.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,18 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">import-modes-test</entry>
-<entry key="lastModified">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:45:14.685+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/namespace.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/namespace.zip/jcr_root/.content.xml
deleted file mode 100644
index e546f292..00000000
--- a/vault-core/src/test/resources/test-packages/namespace.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/namespace.zip/jcr_root/testroot/.content.xml b/vault-core/src/test/resources/test-packages/namespace.zip/jcr_root/testroot/.content.xml
deleted file mode 100644
index c5cf582a..00000000
--- a/vault-core/src/test/resources/test-packages/namespace.zip/jcr_root/testroot/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal" xmlns:my="http://jackrabbit.apache.org/filevault/testing"
-    jcr:primaryType="sling:Folder">
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/namespace.zip/jcr_root/testroot/_cq_content.xml b/vault-core/src/test/resources/test-packages/namespace.zip/jcr_root/testroot/_cq_content.xml
deleted file mode 100644
index 531bf71b..00000000
--- a/vault-core/src/test/resources/test-packages/namespace.zip/jcr_root/testroot/_cq_content.xml
+++ /dev/null
@@ -1,20 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!--
-  Licensed to the Apache Software Foundation (ASF) under one or more
-  contributor license agreements.  See the NOTICE file distributed with
-  this work for additional information regarding copyright ownership.
-  The ASF licenses this file to You under the Apache License, Version 2.0
-  (the "License"); you may not use this file except in compliance with
-  the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-  Unless required by applicable law or agreed to in writing, software
-  distributed under the License is distributed on an "AS IS" BASIS,
-  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  See the License for the specific language governing permissions and
-  limitations under the License.
-  -->
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="nt:unstructured">
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/null-dependency-test.zip b/vault-core/src/test/resources/test-packages/null-dependency-test.zip
deleted file mode 100644
index 51e868a5..00000000
Binary files a/vault-core/src/test/resources/test-packages/null-dependency-test.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/META-INF/vault/filter.xml
deleted file mode 100644
index c3129357..00000000
--- a/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot" mode="merge"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/META-INF/vault/properties.xml
deleted file mode 100644
index 0b072922..00000000
--- a/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">oak_ac_content_test</entry>
-<entry key="lastModified">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:43:22.993+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="acHandling">merge</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/jcr_root/.content.xml
deleted file mode 100644
index 115aa46c..00000000
--- a/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/jcr_root/testroot/node_a/.content.xml b/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/jcr_root/testroot/node_a/.content.xml
deleted file mode 100644
index 61b37c82..00000000
--- a/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/jcr_root/testroot/node_a/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="sling:Folder"
-    title="1234"/>
diff --git a/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/jcr_root/testroot/secured/.content.xml b/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/jcr_root/testroot/secured/.content.xml
deleted file mode 100644
index 792d2ead..00000000
--- a/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/jcr_root/testroot/secured/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="nt:folder"/>
diff --git a/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/jcr_root/testroot/secured/_rep_policy.xml b/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/jcr_root/testroot/secured/_rep_policy.xml
deleted file mode 100644
index ac390e7b..00000000
--- a/vault-core/src/test/resources/test-packages/oak_ac_content_test.zip/jcr_root/testroot/secured/_rep_policy.xml
+++ /dev/null
@@ -1,14 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0" xmlns:rep="internal"
-          jcr:primaryType="rep:ACL">
-    <allow
-            jcr:primaryType="rep:GrantACE"
-            rep:principalName="everyone"
-            rep:privileges="{Name}[jcr:all]">
-        <rep:restrictions
-                jcr:primaryType="rep:Restrictions"
-                rep:glob="*/foo"
-                rep:ntNames="{Name}[nt:unstructured]"
-                rep:prefixes="[rep,granite]"/>
-    </allow>
-</jcr:root>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/package_1.0.zip b/vault-core/src/test/resources/test-packages/package_1.0.zip
deleted file mode 100644
index 1f421c81..00000000
Binary files a/vault-core/src/test/resources/test-packages/package_1.0.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/package_2.0.zip b/vault-core/src/test/resources/test-packages/package_2.0.zip
deleted file mode 100644
index f149f8e9..00000000
Binary files a/vault-core/src/test/resources/test-packages/package_2.0.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/packagetype/application-pkg.zip b/vault-core/src/test/resources/test-packages/packagetype/application-pkg.zip
deleted file mode 100644
index 1010438b..00000000
Binary files a/vault-core/src/test/resources/test-packages/packagetype/application-pkg.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/packagetype/container-pkg.zip b/vault-core/src/test/resources/test-packages/packagetype/container-pkg.zip
deleted file mode 100644
index e500fcf3..00000000
Binary files a/vault-core/src/test/resources/test-packages/packagetype/container-pkg.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/packagetype/content-pkg.zip b/vault-core/src/test/resources/test-packages/packagetype/content-pkg.zip
deleted file mode 100644
index 0346023e..00000000
Binary files a/vault-core/src/test/resources/test-packages/packagetype/content-pkg.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/packagetype/mixed-pkg.zip b/vault-core/src/test/resources/test-packages/packagetype/mixed-pkg.zip
deleted file mode 100644
index 9d1ef435..00000000
Binary files a/vault-core/src/test/resources/test-packages/packagetype/mixed-pkg.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/packagetype/notype-pkg.zip b/vault-core/src/test/resources/test-packages/packagetype/notype-pkg.zip
deleted file mode 100644
index 626d6621..00000000
Binary files a/vault-core/src/test/resources/test-packages/packagetype/notype-pkg.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/principalbased.zip/META-INF/MANIFEST.MF b/vault-core/src/test/resources/test-packages/principalbased.zip/META-INF/MANIFEST.MF
deleted file mode 100644
index b0a5f97f..00000000
--- a/vault-core/src/test/resources/test-packages/principalbased.zip/META-INF/MANIFEST.MF
+++ /dev/null
@@ -1,5 +0,0 @@
-Manifest-Version: 1.0
-Content-Package-Roots: /home/users/system/intermediate
-Content-Package-Type: content
-Content-Package-Id: my_packages:testsystemuser
-
diff --git a/vault-core/src/test/resources/test-packages/principalbased.zip/META-INF/vault/config.xml b/vault-core/src/test/resources/test-packages/principalbased.zip/META-INF/vault/config.xml
deleted file mode 100644
index b525f1c5..00000000
--- a/vault-core/src/test/resources/test-packages/principalbased.zip/META-INF/vault/config.xml
+++ /dev/null
@@ -1,93 +0,0 @@
-<!--
-  Licensed to the Apache Software Foundation (ASF) under one or more
-  contributor license agreements.  See the NOTICE file distributed with
-  this work for additional information regarding copyright ownership.
-  The ASF licenses this file to You under the Apache License, Version 2.0
-  (the "License"); you may not use this file except in compliance with
-  the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-  Unless required by applicable law or agreed to in writing, software
-  distributed under the License is distributed on an "AS IS" BASIS,
-  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  See the License for the specific language governing permissions and
-  limitations under the License.
-  -->
-<vaultfs version="1.1">
-    <!--
-        Defines the content aggregation. The order of the defined aggregates
-        is important for finding the correct aggregator.
-    -->
-    <aggregates>
-        <!--
-            Defines an aggregate that handles nt:file and nt:resource nodes.
-        -->
-        <aggregate type="file" title="File Aggregate"/>
-
-        <!--
-            Defines an aggregate that handles file/folder like nodes. It matches
-            all nt:hierarchyNode nodes that have or define a jcr:content
-            child node and excludes child nodes that are nt:hierarchyNodes.
-        -->
-        <aggregate type="filefolder" title="File/Folder Aggregate"/>
-
-        <!--
-            Defines an aggregate that handles nt:nodeType nodes and serializes
-            them into .cnd notation.
-        -->
-        <aggregate type="nodetype" title="Node Type Aggregate" />
-
-        <!--
-            Defines an aggregate that defines full coverage for certain node
-            types that cannot be covered by the default aggregator.
-        -->
-        <aggregate type="full" title="Full Coverage Aggregate">
-            <matches>
-                <include nodeType="rep:AccessControl" respectSupertype="true" />
-                <include nodeType="rep:Policy" respectSupertype="true" />
-                <include nodeType="cq:Widget" respectSupertype="true" />
-                <include nodeType="cq:EditConfig" respectSupertype="true" />
-                <include nodeType="cq:WorkflowModel" respectSupertype="true" />
-                <include nodeType="vlt:FullCoverage" respectSupertype="true" />
-                <include nodeType="mix:language" respectSupertype="true" />
-                <include nodeType="sling:OsgiConfig" respectSupertype="true" />
-            </matches>
-        </aggregate>
-
-        <!--
-            Defines an aggregate that handles nt:folder like nodes.
-        -->
-        <aggregate type="generic" title="Folder Aggregate">
-            <matches>
-                <include nodeType="nt:folder" respectSupertype="true" />
-            </matches>
-            <contains>
-                <exclude isNode="true" />
-            </contains>
-        </aggregate>
-
-        <!--
-            Defines the default aggregate
-        -->
-        <aggregate type="generic" title="Default Aggregator" isDefault="true">
-            <matches>
-                <!-- all -->
-            </matches>
-            <contains>
-                <exclude nodeType="nt:hierarchyNode" respectSupertype="true" />
-            </contains>
-        </aggregate>
-
-    </aggregates>
-
-    <!--
-      defines the input handlers
-    -->
-    <handlers>
-        <handler type="folder"/>
-        <handler type="file"/>
-        <handler type="nodetype"/>
-        <handler type="generic"/>
-    </handlers>
-</vaultfs>
diff --git a/vault-core/src/test/resources/test-packages/principalbased.zip/META-INF/vault/definition/.content.xml b/vault-core/src/test/resources/test-packages/principalbased.zip/META-INF/vault/definition/.content.xml
deleted file mode 100644
index 27822589..00000000
--- a/vault-core/src/test/resources/test-packages/principalbased.zip/META-INF/vault/definition/.content.xml
+++ /dev/null
@@ -1,32 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:vlt="http://www.day.com/jcr/vault/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-    jcr:created="{Date}2019-07-23T10:20:20.089+02:00"
-    jcr:createdBy="admin"
-    jcr:description=""
-    jcr:lastModified="{Date}2019-07-23T10:20:20.089+02:00"
-    jcr:lastModifiedBy="admin"
-    jcr:primaryType="vlt:PackageDefinition"
-    buildCount="1"
-    builtWith=""
-    fixedBugs=""
-    group="integrationtesting"
-    lastUnwrapped="{Date}2019-07-23T10:20:20.089+02:00"
-    lastUnwrappedBy="admin"
-    lastWrapped="{Date}2019-07-23T10:20:20.089+02:00"
-    lastWrappedBy="admin"
-    name="principalbased_overwrite"
-    acHandling="OVERWRITE"
-    providerLink=""
-    providerName=""
-    providerUrl=""
-    testedWith=""
-    version="">
-    <filter jcr:primaryType="nt:unstructured">
-        <f0
-            jcr:primaryType="nt:unstructured"
-            mode="replace"
-            root="/home/users/system/intermediate"
-            rules="[]"/>
-    </filter>
-    <screenshots jcr:primaryType="nt:unstructured"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/principalbased.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/principalbased.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 44bdf212..00000000
--- a/vault-core/src/test/resources/test-packages/principalbased.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/home/users/system/intermediate" mode="update"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/principalbased.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/principalbased.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 915f6991..00000000
--- a/vault-core/src/test/resources/test-packages/principalbased.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,10 +0,0 @@
-<'rep'='internal'>
-
-[rep:Password]
-  - * (undefined) protected
-  - * (undefined) protected multiple
-
-[rep:RepoAccessControllable]
-  mixin
-  + rep:repoPolicy (rep:Policy) protected ignore
-
diff --git a/vault-core/src/test/resources/test-packages/principalbased.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/principalbased.zip/META-INF/vault/properties.xml
deleted file mode 100644
index d7aaea86..00000000
--- a/vault-core/src/test/resources/test-packages/principalbased.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,22 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">principalbased_overwrite</entry>
-<entry key="lastModified">2019-07-23T10:20:20.089Z</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2019-07-23T10:20:20.170+02:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version">2</entry>
-<entry key="packageType">content</entry>
-<entry key="dependencies">depgroup:dep1:1,depgroup:dep2:2</entry>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2019-07-23T10:20:20.089+02:00</entry>
-<entry key="group">integrationtesting</entry>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="acHandling">OVERWRITE</entry>
-<entry key="requiresRoot">true</entry>
-<entry key="foo">bar</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/.content.xml
deleted file mode 100644
index 8ea9f2ae..00000000
--- a/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable,rep:RepoAccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html"/>
diff --git a/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/home/.content.xml b/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/home/.content.xml
deleted file mode 100644
index 4af0ea84..00000000
--- a/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/home/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:AuthorizableFolder"/>
diff --git a/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/home/users/.content.xml b/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/home/users/.content.xml
deleted file mode 100644
index 4af0ea84..00000000
--- a/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/home/users/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:AuthorizableFolder"/>
diff --git a/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/home/users/system/.content.xml b/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/home/users/system/.content.xml
deleted file mode 100644
index 4af0ea84..00000000
--- a/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/home/users/system/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:AuthorizableFolder"/>
diff --git a/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/home/users/system/intermediate/.content.xml b/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/home/users/system/intermediate/.content.xml
deleted file mode 100644
index 90e51b0c..00000000
--- a/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/home/users/system/intermediate/.content.xml
+++ /dev/null
@@ -1,3 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="rep:AuthorizableFolder"/>
diff --git a/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/home/users/system/intermediate/tBUjdNwIM-i9bTqCYP5D/.content.xml b/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/home/users/system/intermediate/tBUjdNwIM-i9bTqCYP5D/.content.xml
deleted file mode 100644
index 4ab01579..00000000
--- a/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/home/users/system/intermediate/tBUjdNwIM-i9bTqCYP5D/.content.xml
+++ /dev/null
@@ -1,7 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="rep:SystemUser"
-    jcr:mixinTypes="[rep:PrincipalBasedMixin]"
-    jcr:uuid="22a2d7fa-b8c4-3523-be63-1b5789e5694f"
-    rep:authorizableId="testSystemUser"
-    rep:principalName="testSystemUser"/>
diff --git a/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/home/users/system/intermediate/tBUjdNwIM-i9bTqCYP5D/_rep_principalPolicy.xml b/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/home/users/system/intermediate/tBUjdNwIM-i9bTqCYP5D/_rep_principalPolicy.xml
deleted file mode 100644
index 7d6fd53e..00000000
--- a/vault-core/src/test/resources/test-packages/principalbased.zip/jcr_root/home/users/system/intermediate/tBUjdNwIM-i9bTqCYP5D/_rep_principalPolicy.xml
+++ /dev/null
@@ -1,44 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!--
-  ~ Licensed to the Apache Software Foundation (ASF) under one or more
-  ~ contributor license agreements.  See the NOTICE file distributed with
-  ~ this work for additional information regarding copyright ownership.
-  ~ The ASF licenses this file to You under the Apache License, Version 2.0
-  ~ (the "License"); you may not use this file except in compliance with
-  ~ the License.  You may obtain a copy of the License at
-  ~
-  ~      http://www.apache.org/licenses/LICENSE-2.0
-  ~
-  ~ Unless required by applicable law or agreed to in writing, software
-  ~ distributed under the License is distributed on an "AS IS" BASIS,
-  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  ~ See the License for the specific language governing permissions and
-  ~ limitations under the License.
-  -->
-
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="rep:PrincipalPolicy"
-    rep:principalName="testSystemUser">
-    <entry1
-        jcr:primaryType="rep:PrincipalEntry"
-        rep:effectivePath="/testroot/secured"
-        rep:privileges="{Name}[jcr:write]"
-        rep:glob="*"/>
-    <entry2
-        jcr:primaryType="rep:PrincipalEntry"
-        rep:effectivePath="/testroot/secured"
-        rep:privileges="{Name}[jcr:lockManagement]">
-        <rep:restrictions
-            jcr:primaryType="rep:Restrictions"
-            rep:itemNames="{Name}[jcr:content,jcr:data]"
-            rep:glob="*/foo"/>
-    </entry2>
-    <entry3
-        jcr:primaryType="rep:PrincipalEntry"
-        rep:effectivePath="/content"
-        rep:privileges="{Name}[jcr:read]"/>
-    <entry4
-        jcr:primaryType="rep:PrincipalEntry"
-        rep:effectivePath=""
-        rep:privileges="{Name}[jcr:workspaceManagement,jcr:namespaceManagement]"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/privileges.zip b/vault-core/src/test/resources/test-packages/privileges.zip
deleted file mode 100644
index 28737078..00000000
Binary files a/vault-core/src/test/resources/test-packages/privileges.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/properties-with-0mtime.zip b/vault-core/src/test/resources/test-packages/properties-with-0mtime.zip
deleted file mode 100644
index fc43677b..00000000
Binary files a/vault-core/src/test/resources/test-packages/properties-with-0mtime.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/property_constraint_violation.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/property_constraint_violation.zip/META-INF/vault/filter.xml
deleted file mode 100644
index bbbd616d..00000000
--- a/vault-core/src/test/resources/test-packages/property_constraint_violation.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/property_constraint_violation.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/property_constraint_violation.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index a4490d4a..00000000
--- a/vault-core/src/test/resources/test-packages/property_constraint_violation.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,7 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-<'vlt'='http://www.day.com/jcr/vault/1.0'>
-<'my'='http://jackrabbit.apache.org/filevault/testing'>
-
-[my:Folder2] > nt:hierarchyNode
-  - * (name)
diff --git a/vault-core/src/test/resources/test-packages/property_constraint_violation.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/property_constraint_violation.zip/META-INF/vault/properties.xml
deleted file mode 100644
index c606e192..00000000
--- a/vault-core/src/test/resources/test-packages/property_constraint_violation.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,18 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">import-modes-test</entry>
-<entry key="lastModified">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:45:14.685+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/property_constraint_violation.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/property_constraint_violation.zip/jcr_root/.content.xml
deleted file mode 100644
index e546f292..00000000
--- a/vault-core/src/test/resources/test-packages/property_constraint_violation.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/property_constraint_violation.zip/jcr_root/testroot/.content.xml b/vault-core/src/test/resources/test-packages/property_constraint_violation.zip/jcr_root/testroot/.content.xml
deleted file mode 100644
index 539899f9..00000000
--- a/vault-core/src/test/resources/test-packages/property_constraint_violation.zip/jcr_root/testroot/.content.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal" xmlns:my="http://jackrabbit.apache.org/filevault/testing"
-    jcr:primaryType="my:Folder2"
-    jcr:createdBy="myself"
-    someNotAllowedStringProperty="{String}test">
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/protected_properties.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/protected_properties.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 09480445..00000000
--- a/vault-core/src/test/resources/test-packages/protected_properties.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,5 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot"/>
-    <filter root="/testroot2"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/protected_properties.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/protected_properties.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index f9a356be..00000000
--- a/vault-core/src/test/resources/test-packages/protected_properties.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,12 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-<'vlt'='http://www.day.com/jcr/vault/1.0'>
-<'my'='http://jackrabbit.apache.org/filevault/testing'>
-
-// some operations fail due to residual protected property type (https://issues.apache.org/jira/browse/OAK-9695)
-[my:Folder] > nt:hierarchyNode
-  - * (boolean) protected
-  - * (string)
-  - * (string) multiple
-[my:mixin]
-  MIXIN
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/protected_properties.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/protected_properties.zip/META-INF/vault/properties.xml
deleted file mode 100644
index c606e192..00000000
--- a/vault-core/src/test/resources/test-packages/protected_properties.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,18 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">import-modes-test</entry>
-<entry key="lastModified">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:45:14.685+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/protected_properties.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/protected_properties.zip/jcr_root/.content.xml
deleted file mode 100644
index e546f292..00000000
--- a/vault-core/src/test/resources/test-packages/protected_properties.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/protected_properties.zip/jcr_root/testroot/.content.xml b/vault-core/src/test/resources/test-packages/protected_properties.zip/jcr_root/testroot/.content.xml
deleted file mode 100644
index 44715fb7..00000000
--- a/vault-core/src/test/resources/test-packages/protected_properties.zip/jcr_root/testroot/.content.xml
+++ /dev/null
@@ -1,8 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal" xmlns:my="http://jackrabbit.apache.org/filevault/testing"
-    jcr:primaryType="my:Folder"
-    jcr:createdBy="myself"
-    someProtectedBooleanProperty="{Boolean}true"
-    someUnprotectedStringProperty="{String}foo"
-    someUnprotectedStringMvProperty="{String}[]">
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/protected_properties.zip/jcr_root/testroot2/.content.xml b/vault-core/src/test/resources/test-packages/protected_properties.zip/jcr_root/testroot2/.content.xml
deleted file mode 100644
index b44c743b..00000000
--- a/vault-core/src/test/resources/test-packages/protected_properties.zip/jcr_root/testroot2/.content.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal" xmlns:my="http://jackrabbit.apache.org/filevault/testing"
-    jcr:primaryType="nt:unstructured"
-    jcr:mixinTypes="my:mixin">
-    <!-- mixintype intentionally non-array as implicit conversation provokes evaluation of protected property to fail -->
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/protected_properties.zip/jcr_root/testroot3/.content.xml b/vault-core/src/test/resources/test-packages/protected_properties.zip/jcr_root/testroot3/.content.xml
deleted file mode 100644
index 784039e7..00000000
--- a/vault-core/src/test/resources/test-packages/protected_properties.zip/jcr_root/testroot3/.content.xml
+++ /dev/null
@@ -1,11 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal" xmlns:my="http://jackrabbit.apache.org/filevault/testing"
-    jcr:primaryType="my:Folder"
-    jcr:mixinTypes="mix:title"
-    jcr:title="myTitle"
-    someProtectedBooleanProperty="{Boolean}true"
-    someProtectedBooleanProperty2="{Boolean}true"
-    someUnprotectedStringProperty="{String}foo"
-    someUnprotectedStringProperty2="{String}foo"
-    >
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/META-INF/vault/config.xml b/vault-core/src/test/resources/test-packages/referenceable-dup.zip/META-INF/vault/config.xml
deleted file mode 100644
index b525f1c5..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/META-INF/vault/config.xml
+++ /dev/null
@@ -1,93 +0,0 @@
-<!--
-  Licensed to the Apache Software Foundation (ASF) under one or more
-  contributor license agreements.  See the NOTICE file distributed with
-  this work for additional information regarding copyright ownership.
-  The ASF licenses this file to You under the Apache License, Version 2.0
-  (the "License"); you may not use this file except in compliance with
-  the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-  Unless required by applicable law or agreed to in writing, software
-  distributed under the License is distributed on an "AS IS" BASIS,
-  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  See the License for the specific language governing permissions and
-  limitations under the License.
-  -->
-<vaultfs version="1.1">
-    <!--
-        Defines the content aggregation. The order of the defined aggregates
-        is important for finding the correct aggregator.
-    -->
-    <aggregates>
-        <!--
-            Defines an aggregate that handles nt:file and nt:resource nodes.
-        -->
-        <aggregate type="file" title="File Aggregate"/>
-
-        <!--
-            Defines an aggregate that handles file/folder like nodes. It matches
-            all nt:hierarchyNode nodes that have or define a jcr:content
-            child node and excludes child nodes that are nt:hierarchyNodes.
-        -->
-        <aggregate type="filefolder" title="File/Folder Aggregate"/>
-
-        <!--
-            Defines an aggregate that handles nt:nodeType nodes and serializes
-            them into .cnd notation.
-        -->
-        <aggregate type="nodetype" title="Node Type Aggregate" />
-
-        <!--
-            Defines an aggregate that defines full coverage for certain node
-            types that cannot be covered by the default aggregator.
-        -->
-        <aggregate type="full" title="Full Coverage Aggregate">
-            <matches>
-                <include nodeType="rep:AccessControl" respectSupertype="true" />
-                <include nodeType="rep:Policy" respectSupertype="true" />
-                <include nodeType="cq:Widget" respectSupertype="true" />
-                <include nodeType="cq:EditConfig" respectSupertype="true" />
-                <include nodeType="cq:WorkflowModel" respectSupertype="true" />
-                <include nodeType="vlt:FullCoverage" respectSupertype="true" />
-                <include nodeType="mix:language" respectSupertype="true" />
-                <include nodeType="sling:OsgiConfig" respectSupertype="true" />
-            </matches>
-        </aggregate>
-
-        <!--
-            Defines an aggregate that handles nt:folder like nodes.
-        -->
-        <aggregate type="generic" title="Folder Aggregate">
-            <matches>
-                <include nodeType="nt:folder" respectSupertype="true" />
-            </matches>
-            <contains>
-                <exclude isNode="true" />
-            </contains>
-        </aggregate>
-
-        <!--
-            Defines the default aggregate
-        -->
-        <aggregate type="generic" title="Default Aggregator" isDefault="true">
-            <matches>
-                <!-- all -->
-            </matches>
-            <contains>
-                <exclude nodeType="nt:hierarchyNode" respectSupertype="true" />
-            </contains>
-        </aggregate>
-
-    </aggregates>
-
-    <!--
-      defines the input handlers
-    -->
-    <handlers>
-        <handler type="folder"/>
-        <handler type="file"/>
-        <handler type="nodetype"/>
-        <handler type="generic"/>
-    </handlers>
-</vaultfs>
diff --git a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/META-INF/vault/definition/.content.xml b/vault-core/src/test/resources/test-packages/referenceable-dup.zip/META-INF/vault/definition/.content.xml
deleted file mode 100644
index c57b6a81..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/META-INF/vault/definition/.content.xml
+++ /dev/null
@@ -1,25 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:vlt="http://www.day.com/jcr/vault/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-    jcr:created="{Date}2015-12-16T16:59:10.779+01:00"
-    jcr:createdBy="admin"
-    jcr:description=""
-    jcr:lastModified="{Date}2015-12-16T16:59:10.779+01:00"
-    jcr:lastModifiedBy="admin"
-    jcr:primaryType="vlt:PackageDefinition"
-    buildCount="5"
-    builtWith="Adobe Experience Manager-6.1.0.20150507"
-    group="my_packages"
-    lastUnwrapped="{Date}2015-12-16T16:59:10.779+01:00"
-    lastUnwrappedBy="admin"
-    lastWrapped="{Date}2015-12-16T16:59:10.779+01:00"
-    lastWrappedBy="admin"
-    name="test_referenceable"
-    version="">
-    <filter jcr:primaryType="nt:unstructured">
-        <f0
-            jcr:primaryType="nt:unstructured"
-            mode="replace"
-            root="/tmp/referenceable"
-            rules="[]"/>
-    </filter>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/referenceable-dup.zip/META-INF/vault/filter.xml
deleted file mode 100644
index f3ddf87b..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,7 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/tmp/sameparentconflicts/referenceable"/>
-    <filter root="/tmp/sameparentconflicts/duplicate"/>
-    <filter root="/tmp/differentparentconflicts/referenceable"/>
-    <filter root="/tmp/differentparentconflicts/duplicate"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/referenceable-dup.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index c348e28e..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,17 +0,0 @@
-<'vlt'='http://www.day.com/jcr/vault/1.0'>
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-<'rep'='internal'>
-
-[vlt:FullCoverage]
-  mixin
-
-[sling:Folder] > nt:folder
-  - * (undefined) multiple
-  - * (undefined)
-  + * (nt:base) = sling:Folder version
-
-[rep:RepoAccessControllable]
-  mixin
-  + rep:repoPolicy (rep:Policy) protected ignore
-
diff --git a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/referenceable-dup.zip/META-INF/vault/properties.xml
deleted file mode 100644
index 2494f50c..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,18 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">test_referenceable</entry>
-<entry key="lastModified">2015-12-16T16:59:10.779+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2015-12-16T16:59:10.795+01:00</entry>
-<entry key="buildCount">5</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2015-12-16T16:59:10.779+01:00</entry>
-<entry key="group">my_packages</entry>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/.content.xml
deleted file mode 100644
index 8ea9f2ae..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable,rep:RepoAccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html"/>
diff --git a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/tmp/.content.xml b/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/tmp/.content.xml
deleted file mode 100644
index 54084a82..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/tmp/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="sling:Folder"/>
diff --git a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/tmp/differentparentconflicts/.content.xml b/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/tmp/differentparentconflicts/.content.xml
deleted file mode 100644
index 54084a82..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/tmp/differentparentconflicts/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="sling:Folder"/>
diff --git a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/tmp/differentparentconflicts/duplicate.xml b/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/tmp/differentparentconflicts/duplicate.xml
deleted file mode 100644
index 876b1a76..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/tmp/differentparentconflicts/duplicate.xml
+++ /dev/null
@@ -1,10 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:vlt="http://www.day.com/jcr/vault/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:mix="http://www.jcp.org/jcr/mix/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-    jcr:primaryType="sling:Folder"
-    someproperty="somevaluefromduplicate">
-    <child
-        jcr:mixinTypes="[mix:referenceable]"
-        jcr:primaryType="nt:unstructured"
-        jcr:uuid="a201bd6b-25b9-4255-b7db-6fc4c3ddb32d"
-        someproperty="somevaluefromduplicate"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/tmp/differentparentconflicts/referenceable.xml b/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/tmp/differentparentconflicts/referenceable.xml
deleted file mode 100644
index 99fbb46b..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/tmp/differentparentconflicts/referenceable.xml
+++ /dev/null
@@ -1,10 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:vlt="http://www.day.com/jcr/vault/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:mix="http://www.jcp.org/jcr/mix/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-    jcr:primaryType="sling:Folder"
-    someproperty="somevalue">
-    <child
-        jcr:mixinTypes="[mix:referenceable]"
-        jcr:primaryType="nt:unstructured"
-        jcr:uuid="a201bd6b-25b9-4255-b7db-6fc4c3ddb32d"
-        someproperty="somevalue"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/tmp/sameparentconflicts/duplicate.xml b/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/tmp/sameparentconflicts/duplicate.xml
deleted file mode 100644
index 451eaccd..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/tmp/sameparentconflicts/duplicate.xml
+++ /dev/null
@@ -1,7 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:vlt="http://www.day.com/jcr/vault/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:mix="http://www.jcp.org/jcr/mix/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-    jcr:mixinTypes="[mix:referenceable,vlt:FullCoverage]"
-    jcr:primaryType="sling:Folder"
-    jcr:uuid="352c89a4-304f-4b87-9bed-e09275597df1"
-    someproperty="somevaluefromduplicate">
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/tmp/sameparentconflicts/referenceable.xml b/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/tmp/sameparentconflicts/referenceable.xml
deleted file mode 100644
index 9ed6059f..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable-dup.zip/jcr_root/tmp/sameparentconflicts/referenceable.xml
+++ /dev/null
@@ -1,7 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:vlt="http://www.day.com/jcr/vault/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:mix="http://www.jcp.org/jcr/mix/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-    jcr:mixinTypes="[mix:referenceable,vlt:FullCoverage]"
-    jcr:primaryType="sling:Folder"
-    jcr:uuid="352c89a4-304f-4b87-9bed-e09275597df1"
-    someproperty="somevalue">
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/referenceable.zip/META-INF/vault/config.xml b/vault-core/src/test/resources/test-packages/referenceable.zip/META-INF/vault/config.xml
deleted file mode 100644
index b525f1c5..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable.zip/META-INF/vault/config.xml
+++ /dev/null
@@ -1,93 +0,0 @@
-<!--
-  Licensed to the Apache Software Foundation (ASF) under one or more
-  contributor license agreements.  See the NOTICE file distributed with
-  this work for additional information regarding copyright ownership.
-  The ASF licenses this file to You under the Apache License, Version 2.0
-  (the "License"); you may not use this file except in compliance with
-  the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-  Unless required by applicable law or agreed to in writing, software
-  distributed under the License is distributed on an "AS IS" BASIS,
-  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  See the License for the specific language governing permissions and
-  limitations under the License.
-  -->
-<vaultfs version="1.1">
-    <!--
-        Defines the content aggregation. The order of the defined aggregates
-        is important for finding the correct aggregator.
-    -->
-    <aggregates>
-        <!--
-            Defines an aggregate that handles nt:file and nt:resource nodes.
-        -->
-        <aggregate type="file" title="File Aggregate"/>
-
-        <!--
-            Defines an aggregate that handles file/folder like nodes. It matches
-            all nt:hierarchyNode nodes that have or define a jcr:content
-            child node and excludes child nodes that are nt:hierarchyNodes.
-        -->
-        <aggregate type="filefolder" title="File/Folder Aggregate"/>
-
-        <!--
-            Defines an aggregate that handles nt:nodeType nodes and serializes
-            them into .cnd notation.
-        -->
-        <aggregate type="nodetype" title="Node Type Aggregate" />
-
-        <!--
-            Defines an aggregate that defines full coverage for certain node
-            types that cannot be covered by the default aggregator.
-        -->
-        <aggregate type="full" title="Full Coverage Aggregate">
-            <matches>
-                <include nodeType="rep:AccessControl" respectSupertype="true" />
-                <include nodeType="rep:Policy" respectSupertype="true" />
-                <include nodeType="cq:Widget" respectSupertype="true" />
-                <include nodeType="cq:EditConfig" respectSupertype="true" />
-                <include nodeType="cq:WorkflowModel" respectSupertype="true" />
-                <include nodeType="vlt:FullCoverage" respectSupertype="true" />
-                <include nodeType="mix:language" respectSupertype="true" />
-                <include nodeType="sling:OsgiConfig" respectSupertype="true" />
-            </matches>
-        </aggregate>
-
-        <!--
-            Defines an aggregate that handles nt:folder like nodes.
-        -->
-        <aggregate type="generic" title="Folder Aggregate">
-            <matches>
-                <include nodeType="nt:folder" respectSupertype="true" />
-            </matches>
-            <contains>
-                <exclude isNode="true" />
-            </contains>
-        </aggregate>
-
-        <!--
-            Defines the default aggregate
-        -->
-        <aggregate type="generic" title="Default Aggregator" isDefault="true">
-            <matches>
-                <!-- all -->
-            </matches>
-            <contains>
-                <exclude nodeType="nt:hierarchyNode" respectSupertype="true" />
-            </contains>
-        </aggregate>
-
-    </aggregates>
-
-    <!--
-      defines the input handlers
-    -->
-    <handlers>
-        <handler type="folder"/>
-        <handler type="file"/>
-        <handler type="nodetype"/>
-        <handler type="generic"/>
-    </handlers>
-</vaultfs>
diff --git a/vault-core/src/test/resources/test-packages/referenceable.zip/META-INF/vault/definition/.content.xml b/vault-core/src/test/resources/test-packages/referenceable.zip/META-INF/vault/definition/.content.xml
deleted file mode 100644
index c57b6a81..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable.zip/META-INF/vault/definition/.content.xml
+++ /dev/null
@@ -1,25 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:vlt="http://www.day.com/jcr/vault/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-    jcr:created="{Date}2015-12-16T16:59:10.779+01:00"
-    jcr:createdBy="admin"
-    jcr:description=""
-    jcr:lastModified="{Date}2015-12-16T16:59:10.779+01:00"
-    jcr:lastModifiedBy="admin"
-    jcr:primaryType="vlt:PackageDefinition"
-    buildCount="5"
-    builtWith="Adobe Experience Manager-6.1.0.20150507"
-    group="my_packages"
-    lastUnwrapped="{Date}2015-12-16T16:59:10.779+01:00"
-    lastUnwrappedBy="admin"
-    lastWrapped="{Date}2015-12-16T16:59:10.779+01:00"
-    lastWrappedBy="admin"
-    name="test_referenceable"
-    version="">
-    <filter jcr:primaryType="nt:unstructured">
-        <f0
-            jcr:primaryType="nt:unstructured"
-            mode="replace"
-            root="/tmp/referenceable"
-            rules="[]"/>
-    </filter>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/referenceable.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/referenceable.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 5258896d..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/tmp/referenceable"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/referenceable.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/referenceable.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index c348e28e..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,17 +0,0 @@
-<'vlt'='http://www.day.com/jcr/vault/1.0'>
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-<'rep'='internal'>
-
-[vlt:FullCoverage]
-  mixin
-
-[sling:Folder] > nt:folder
-  - * (undefined) multiple
-  - * (undefined)
-  + * (nt:base) = sling:Folder version
-
-[rep:RepoAccessControllable]
-  mixin
-  + rep:repoPolicy (rep:Policy) protected ignore
-
diff --git a/vault-core/src/test/resources/test-packages/referenceable.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/referenceable.zip/META-INF/vault/properties.xml
deleted file mode 100644
index 2494f50c..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,18 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">test_referenceable</entry>
-<entry key="lastModified">2015-12-16T16:59:10.779+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2015-12-16T16:59:10.795+01:00</entry>
-<entry key="buildCount">5</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2015-12-16T16:59:10.779+01:00</entry>
-<entry key="group">my_packages</entry>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/referenceable.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/referenceable.zip/jcr_root/.content.xml
deleted file mode 100644
index 8ea9f2ae..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable,rep:RepoAccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html"/>
diff --git a/vault-core/src/test/resources/test-packages/referenceable.zip/jcr_root/tmp/.content.xml b/vault-core/src/test/resources/test-packages/referenceable.zip/jcr_root/tmp/.content.xml
deleted file mode 100644
index 54084a82..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable.zip/jcr_root/tmp/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="sling:Folder"/>
diff --git a/vault-core/src/test/resources/test-packages/referenceable.zip/jcr_root/tmp/referenceable.xml b/vault-core/src/test/resources/test-packages/referenceable.zip/jcr_root/tmp/referenceable.xml
deleted file mode 100644
index 2d1995cd..00000000
--- a/vault-core/src/test/resources/test-packages/referenceable.zip/jcr_root/tmp/referenceable.xml
+++ /dev/null
@@ -1,12 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:vlt="http://www.day.com/jcr/vault/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:mix="http://www.jcp.org/jcr/mix/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-    jcr:mixinTypes="[mix:referenceable,vlt:FullCoverage]"
-    jcr:primaryType="sling:Folder"
-    jcr:uuid="352c89a4-304f-4b87-9bed-e09275597df1"
-    someproperty="somevalue">
-    <child
-        jcr:mixinTypes="[mix:referenceable]"
-        jcr:primaryType="nt:unstructured"
-        jcr:uuid="a201bd6b-25b9-4255-b7db-6fc4c3ddb32d"
-        someproperty="somevalue"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/repo_no_policy.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/repo_no_policy.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 5057d2bc..00000000
--- a/vault-core/src/test/resources/test-packages/repo_no_policy.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/rep:repoPolicy"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/repo_no_policy.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/repo_no_policy.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index cbabc1c4..00000000
--- a/vault-core/src/test/resources/test-packages/repo_no_policy.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,19 +0,0 @@
-<'rep'='internal'>
-
-[rep:Privileges]
-  - rep:next (long) mandatory protected multiple
-  + * (rep:Privilege) = rep:Privilege protected abort
-
-[rep:Privilege]
-  - rep:isAbstract (boolean) protected
-  - rep:aggregates (name) protected multiple
-  - rep:bits (long) mandatory protected multiple
-
-[rep:Restrictions]
-  - * (undefined) protected
-  - * (undefined) protected multiple
-
-[rep:RepoAccessControllable]
-  mixin
-  + rep:repoPolicy (rep:Policy) protected ignore
-
diff --git a/vault-core/src/test/resources/test-packages/repo_no_policy.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/repo_no_policy.zip/META-INF/vault/properties.xml
deleted file mode 100644
index f774a8a6..00000000
--- a/vault-core/src/test/resources/test-packages/repo_no_policy.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,18 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">repo_policy</entry>
-<entry key="lastModified">2014-02-25T11:54:54.245-08:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2014-02-25T11:54:54.351-08:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2014-02-25T11:54:54.245-08:00</entry>
-<entry key="group">test</entry>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/repo_no_policy.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/repo_no_policy.zip/jcr_root/.content.xml
deleted file mode 100644
index 8ea9f2ae..00000000
--- a/vault-core/src/test/resources/test-packages/repo_no_policy.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable,rep:RepoAccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html"/>
diff --git a/vault-core/src/test/resources/test-packages/repo_policy.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/repo_policy.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 5057d2bc..00000000
--- a/vault-core/src/test/resources/test-packages/repo_policy.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/rep:repoPolicy"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/repo_policy.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/repo_policy.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index cbabc1c4..00000000
--- a/vault-core/src/test/resources/test-packages/repo_policy.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,19 +0,0 @@
-<'rep'='internal'>
-
-[rep:Privileges]
-  - rep:next (long) mandatory protected multiple
-  + * (rep:Privilege) = rep:Privilege protected abort
-
-[rep:Privilege]
-  - rep:isAbstract (boolean) protected
-  - rep:aggregates (name) protected multiple
-  - rep:bits (long) mandatory protected multiple
-
-[rep:Restrictions]
-  - * (undefined) protected
-  - * (undefined) protected multiple
-
-[rep:RepoAccessControllable]
-  mixin
-  + rep:repoPolicy (rep:Policy) protected ignore
-
diff --git a/vault-core/src/test/resources/test-packages/repo_policy.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/repo_policy.zip/META-INF/vault/properties.xml
deleted file mode 100644
index f774a8a6..00000000
--- a/vault-core/src/test/resources/test-packages/repo_policy.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,18 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">repo_policy</entry>
-<entry key="lastModified">2014-02-25T11:54:54.245-08:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2014-02-25T11:54:54.351-08:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2014-02-25T11:54:54.245-08:00</entry>
-<entry key="group">test</entry>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/repo_policy.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/repo_policy.zip/jcr_root/.content.xml
deleted file mode 100644
index 8ea9f2ae..00000000
--- a/vault-core/src/test/resources/test-packages/repo_policy.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable,rep:RepoAccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html"/>
diff --git a/vault-core/src/test/resources/test-packages/repo_policy.zip/jcr_root/_rep_repoPolicy.xml b/vault-core/src/test/resources/test-packages/repo_policy.zip/jcr_root/_rep_repoPolicy.xml
deleted file mode 100644
index 97340082..00000000
--- a/vault-core/src/test/resources/test-packages/repo_policy.zip/jcr_root/_rep_repoPolicy.xml
+++ /dev/null
@@ -1,12 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="rep:ACL">
-    <deny
-        jcr:primaryType="rep:DenyACE"
-        rep:principalName="everyone"
-        rep:privileges="{Name}[jcr:all]"/>
-    <deny0
-        jcr:primaryType="rep:DenyACE"
-        rep:principalName="testuser"
-        rep:privileges="{Name}[jcr:all]"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/root_policy.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/root_policy.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 81f6c0ea..00000000
--- a/vault-core/src/test/resources/test-packages/root_policy.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/rep:policy"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/root_policy.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/root_policy.zip/META-INF/vault/properties.xml
deleted file mode 100644
index afaf6b56..00000000
--- a/vault-core/src/test/resources/test-packages/root_policy.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">root_policy</entry>
-<entry key="lastModified">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:43:22.993+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="acHandling">overwrite</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/root_policy.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/root_policy.zip/jcr_root/.content.xml
deleted file mode 100644
index 108df8ac..00000000
--- a/vault-core/src/test/resources/test-packages/root_policy.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root" />
diff --git a/vault-core/src/test/resources/test-packages/root_policy.zip/jcr_root/_rep_policy.xml b/vault-core/src/test/resources/test-packages/root_policy.zip/jcr_root/_rep_policy.xml
deleted file mode 100644
index afe70bb3..00000000
--- a/vault-core/src/test/resources/test-packages/root_policy.zip/jcr_root/_rep_policy.xml
+++ /dev/null
@@ -1,8 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="rep:ACL">
-    <Allow
-        jcr:primaryType="rep:GrantACE"
-        rep:principalName="everyone"
-        rep:privileges="{Name}[jcr:all]"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/simple-snapshot-version.zip b/vault-core/src/test/resources/test-packages/simple-snapshot-version.zip
deleted file mode 100644
index ec679e8f..00000000
Binary files a/vault-core/src/test/resources/test-packages/simple-snapshot-version.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 74294aa2..00000000
--- a/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot" mode="replace"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index b8ef66db..00000000
--- a/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,13 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-<'dam'='http://www.day.com/dam/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-  
-[dam:Thumbnails]
-  mixin
-  + dam:thumbnails (nt:folder)
-
diff --git a/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/META-INF/vault/properties.xml
deleted file mode 100644
index c32f9763..00000000
--- a/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">mode_ac_test_a</entry>
-<entry key="lastModified">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:43:22.993+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="acHandling">overwrite</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/jcr_root/.content.xml
deleted file mode 100644
index 115aa46c..00000000
--- a/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/jcr_root/testroot/thumbnail.png b/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/jcr_root/testroot/thumbnail.png
deleted file mode 100644
index cdc7773f..00000000
Binary files a/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/jcr_root/testroot/thumbnail.png and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/jcr_root/testroot/thumbnail.png.dir/.content.xml b/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/jcr_root/testroot/thumbnail.png.dir/.content.xml
deleted file mode 100644
index 6e9de504..00000000
--- a/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/jcr_root/testroot/thumbnail.png.dir/.content.xml
+++ /dev/null
@@ -1,8 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:dam="http://www.day.com/dam/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-    jcr:primaryType="nt:file">
-    <jcr:content
-        jcr:lastModifiedBy="admin"
-        jcr:mixinTypes="[dam:Thumbnails]"
-        jcr:primaryType="nt:resource"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/jcr_root/testroot/thumbnail.png.dir/_jcr_content/_dam_thumbnails/_dam_thumbnail_48.png b/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/jcr_root/testroot/thumbnail.png.dir/_jcr_content/_dam_thumbnails/_dam_thumbnail_48.png
deleted file mode 100644
index a24caa11..00000000
Binary files a/vault-core/src/test/resources/test-packages/simple_file_aggregate_with_children.zip/jcr_root/testroot/thumbnail.png.dir/_jcr_content/_dam_thumbnails/_dam_thumbnail_48.png and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/simple_file_aggregate_without_children.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/simple_file_aggregate_without_children.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 74294aa2..00000000
--- a/vault-core/src/test/resources/test-packages/simple_file_aggregate_without_children.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot" mode="replace"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/simple_file_aggregate_without_children.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/simple_file_aggregate_without_children.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 5afdfb71..00000000
--- a/vault-core/src/test/resources/test-packages/simple_file_aggregate_without_children.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,8 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/simple_file_aggregate_without_children.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/simple_file_aggregate_without_children.zip/META-INF/vault/properties.xml
deleted file mode 100644
index c32f9763..00000000
--- a/vault-core/src/test/resources/test-packages/simple_file_aggregate_without_children.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">mode_ac_test_a</entry>
-<entry key="lastModified">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:43:22.993+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:43:22.972+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-<entry key="acHandling">overwrite</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/simple_file_aggregate_without_children.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/simple_file_aggregate_without_children.zip/jcr_root/.content.xml
deleted file mode 100644
index 115aa46c..00000000
--- a/vault-core/src/test/resources/test-packages/simple_file_aggregate_without_children.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/simple_file_aggregate_without_children.zip/jcr_root/testroot/thumbnail.png b/vault-core/src/test/resources/test-packages/simple_file_aggregate_without_children.zip/jcr_root/testroot/thumbnail.png
deleted file mode 100644
index cdc7773f..00000000
Binary files a/vault-core/src/test/resources/test-packages/simple_file_aggregate_without_children.zip/jcr_root/testroot/thumbnail.png and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/stashing/create.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/stashing/create.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 922561df..00000000
--- a/vault-core/src/test/resources/test-packages/stashing/create.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,3 +0,0 @@
-<workspaceFilter version="1.0">
-    <filter root="/tmp/stash"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/stashing/create.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/stashing/create.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index fef66ef3..00000000
--- a/vault-core/src/test/resources/test-packages/stashing/create.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,7 +0,0 @@
-<'teststash'='https://issues.apache.org/jira/browse/JCRVLT-684'>
-
-[teststash:noChildNodes]
-
-[teststash:hasMandatoryChildNode]
-  mixin
-  + teststash:mandatoryChildNode mandatory
diff --git a/vault-core/src/test/resources/test-packages/stashing/create.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/stashing/create.zip/META-INF/vault/properties.xml
deleted file mode 100644
index a3215d04..00000000
--- a/vault-core/src/test/resources/test-packages/stashing/create.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,18 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">test_stashing_create</entry>
-<entry key="lastModified">2015-12-16T16:59:10.779+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2015-12-16T16:59:10.795+01:00</entry>
-<entry key="buildCount">5</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2015-12-16T16:59:10.779+01:00</entry>
-<entry key="group">my_packages</entry>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/stashing/create.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/stashing/create.zip/jcr_root/.content.xml
deleted file mode 100644
index 4f8ba9aa..00000000
--- a/vault-core/src/test/resources/test-packages/stashing/create.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<jcr:root
-  xmlns:jcr="http://www.jcp.org/jcr/1.0"
-  xmlns:rep="internal"
-  jcr:primaryType="rep:root"/>
diff --git a/vault-core/src/test/resources/test-packages/stashing/create.zip/jcr_root/tmp/.content.xml b/vault-core/src/test/resources/test-packages/stashing/create.zip/jcr_root/tmp/.content.xml
deleted file mode 100644
index e4a57936..00000000
--- a/vault-core/src/test/resources/test-packages/stashing/create.zip/jcr_root/tmp/.content.xml
+++ /dev/null
@@ -1,13 +0,0 @@
-<jcr:root
-  xmlns:jcr="http://www.jcp.org/jcr/1.0"
-  xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-  xmlns:mix="http://www.jcp.org/jcr/mix/1.0"
-  xmlns:teststash="https://issues.apache.org/jira/browse/JCRVLT-684"
-  jcr:primaryType="nt:unstructured">
-  <stash
-    jcr:primaryType="teststash:noChildNodes"
-    jcr:mixinTypes="[mix:referenceable,teststash:hasMandatoryChildNode]"
-    jcr:uuid="c842f252-ab9c-11ed-9e53-00155d01040e">
-    <teststash:mandatoryChildNode jcr:primaryType="nt:unstructured"/>
-  </stash>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/stashing/update.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/stashing/update.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 922561df..00000000
--- a/vault-core/src/test/resources/test-packages/stashing/update.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,3 +0,0 @@
-<workspaceFilter version="1.0">
-    <filter root="/tmp/stash"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/stashing/update.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/stashing/update.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index fef66ef3..00000000
--- a/vault-core/src/test/resources/test-packages/stashing/update.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,7 +0,0 @@
-<'teststash'='https://issues.apache.org/jira/browse/JCRVLT-684'>
-
-[teststash:noChildNodes]
-
-[teststash:hasMandatoryChildNode]
-  mixin
-  + teststash:mandatoryChildNode mandatory
diff --git a/vault-core/src/test/resources/test-packages/stashing/update.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/stashing/update.zip/META-INF/vault/properties.xml
deleted file mode 100644
index 8373968d..00000000
--- a/vault-core/src/test/resources/test-packages/stashing/update.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,18 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">test_stashing_update</entry>
-<entry key="lastModified">2015-12-16T16:59:10.779+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2015-12-16T16:59:10.795+01:00</entry>
-<entry key="buildCount">5</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2015-12-16T16:59:10.779+01:00</entry>
-<entry key="group">my_packages</entry>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/stashing/update.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/stashing/update.zip/jcr_root/.content.xml
deleted file mode 100644
index 4f8ba9aa..00000000
--- a/vault-core/src/test/resources/test-packages/stashing/update.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<jcr:root
-  xmlns:jcr="http://www.jcp.org/jcr/1.0"
-  xmlns:rep="internal"
-  jcr:primaryType="rep:root"/>
diff --git a/vault-core/src/test/resources/test-packages/stashing/update.zip/jcr_root/tmp/.content.xml b/vault-core/src/test/resources/test-packages/stashing/update.zip/jcr_root/tmp/.content.xml
deleted file mode 100644
index 43b205e9..00000000
--- a/vault-core/src/test/resources/test-packages/stashing/update.zip/jcr_root/tmp/.content.xml
+++ /dev/null
@@ -1,12 +0,0 @@
-<jcr:root
-  xmlns:jcr="http://www.jcp.org/jcr/1.0"
-  xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-  xmlns:mix="http://www.jcp.org/jcr/mix/1.0"
-  xmlns:teststash="https://issues.apache.org/jira/browse/JCRVLT-684"
-  jcr:primaryType="nt:unstructured">
-  <stash
-    jcr:primaryType="teststash:noChildNodes"
-    jcr:mixinTypes="[mix:referenceable]"
-    jcr:uuid="c842f252-ab9c-11ed-9e53-00155d01040f">
-  </stash>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/subsubtest.zip b/vault-core/src/test/resources/test-packages/subsubtest.zip
deleted file mode 100644
index 340616fc..00000000
Binary files a/vault-core/src/test/resources/test-packages/subsubtest.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/subtest_add_a.zip b/vault-core/src/test/resources/test-packages/subtest_add_a.zip
deleted file mode 100644
index 6cae2cba..00000000
Binary files a/vault-core/src/test/resources/test-packages/subtest_add_a.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/subtest_extract_a.zip b/vault-core/src/test/resources/test-packages/subtest_extract_a.zip
deleted file mode 100644
index 49439ac9..00000000
Binary files a/vault-core/src/test/resources/test-packages/subtest_extract_a.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/subtest_extract_contains_newer_version.zip b/vault-core/src/test/resources/test-packages/subtest_extract_contains_newer_version.zip
deleted file mode 100644
index ec9bfa04..00000000
Binary files a/vault-core/src/test/resources/test-packages/subtest_extract_contains_newer_version.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/subtest_extract_contains_older_version.zip b/vault-core/src/test/resources/test-packages/subtest_extract_contains_older_version.zip
deleted file mode 100644
index 5f8f58c8..00000000
Binary files a/vault-core/src/test/resources/test-packages/subtest_extract_contains_older_version.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/subtest_extract_contains_older_version_force_downgrade.zip b/vault-core/src/test/resources/test-packages/subtest_extract_contains_older_version_force_downgrade.zip
deleted file mode 100644
index eb3e95ee..00000000
Binary files a/vault-core/src/test/resources/test-packages/subtest_extract_contains_older_version_force_downgrade.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/subtest_ignore_a.zip b/vault-core/src/test/resources/test-packages/subtest_ignore_a.zip
deleted file mode 100644
index 79646296..00000000
Binary files a/vault-core/src/test/resources/test-packages/subtest_ignore_a.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/subtest_inherit_dep.zip b/vault-core/src/test/resources/test-packages/subtest_inherit_dep.zip
deleted file mode 100644
index 954b0d0e..00000000
Binary files a/vault-core/src/test/resources/test-packages/subtest_inherit_dep.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/subtest_with_content.zip b/vault-core/src/test/resources/test-packages/subtest_with_content.zip
deleted file mode 100644
index b847bddc..00000000
Binary files a/vault-core/src/test/resources/test-packages/subtest_with_content.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/subtest_with_nodetypes.zip b/vault-core/src/test/resources/test-packages/subtest_with_nodetypes.zip
deleted file mode 100644
index e83f6e03..00000000
Binary files a/vault-core/src/test/resources/test-packages/subtest_with_nodetypes.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tags.zip b/vault-core/src/test/resources/test-packages/tags.zip
deleted file mode 100644
index 080d203a..00000000
Binary files a/vault-core/src/test/resources/test-packages/tags.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test-package-with-etc.zip b/vault-core/src/test/resources/test-packages/test-package-with-etc.zip
deleted file mode 100644
index b034af2b..00000000
Binary files a/vault-core/src/test/resources/test-packages/test-package-with-etc.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_a-1.0.zip b/vault-core/src/test/resources/test-packages/test_a-1.0.zip
deleted file mode 100644
index 08df03a4..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_a-1.0.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_a-2.0.zip b/vault-core/src/test/resources/test-packages/test_a-2.0.zip
deleted file mode 100644
index 5a402e82..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_a-2.0.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_b-1.0.zip b/vault-core/src/test/resources/test-packages/test_b-1.0.zip
deleted file mode 100644
index 85fac13a..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_b-1.0.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_c-1.0.zip b/vault-core/src/test/resources/test-packages/test_c-1.0.zip
deleted file mode 100644
index 245291ac..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_c-1.0.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_c-1.1.zip b/vault-core/src/test/resources/test-packages/test_c-1.1.zip
deleted file mode 100644
index 02f97407..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_c-1.1.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_c-2.0.zip b/vault-core/src/test/resources/test-packages/test_c-2.0.zip
deleted file mode 100644
index 0332dc5a..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_c-2.0.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_childnodeorder.zip b/vault-core/src/test/resources/test-packages/test_childnodeorder.zip
deleted file mode 100644
index 7b4669b7..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_childnodeorder.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_childnodeorder2.zip b/vault-core/src/test/resources/test-packages/test_childnodeorder2.zip
deleted file mode 100644
index a5c5c273..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_childnodeorder2.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_d-1.0.zip b/vault-core/src/test/resources/test-packages/test_d-1.0.zip
deleted file mode 100644
index 7acf3d1f..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_d-1.0.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_e-1.0.zip b/vault-core/src/test/resources/test-packages/test_e-1.0.zip
deleted file mode 100644
index 372bbb96..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_e-1.0.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_filter_binary.zip b/vault-core/src/test/resources/test-packages/test_filter_binary.zip
deleted file mode 100644
index d29ce754..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_filter_binary.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_hook.zip b/vault-core/src/test/resources/test-packages/test_hook.zip
deleted file mode 100644
index 6b4ca7b0..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_hook.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/META-INF/vault/config.xml b/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/META-INF/vault/config.xml
deleted file mode 100644
index 941af6c2..00000000
--- a/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/META-INF/vault/config.xml
+++ /dev/null
@@ -1,77 +0,0 @@
-<vaultfs version="1.1">
-    <!--
-        Defines the content aggregation. The order of the defined aggregates
-        is important for finding the correct aggregator.
-    -->
-    <aggregates>
-        <!--
-            Defines an aggregate that handles nt:file and nt:resource nodes.
-        -->
-        <aggregate type="file" title="File Aggregate"/>
-
-        <!--
-            Defines an aggregate that handles file/folder like nodes. It matches
-            all nt:hierarchyNode nodes that have or define a jcr:content
-            child node and excludes child nodes that are nt:hierarchyNodes.
-        -->
-        <aggregate type="filefolder" title="File/Folder Aggregate"/>
-
-        <!--
-            Defines an aggregate that handles nt:nodeType nodes and serializes
-            them into .cnd notation.
-        -->
-        <aggregate type="nodetype" title="Node Type Aggregate" />
-
-        <!--
-            Defines an aggregate that defines full coverage for certain node
-            types that cannot be covered by the default aggregator.
-        -->
-        <aggregate type="full" title="Full Coverage Aggregate">
-            <matches>
-                <include nodeType="rep:AccessControl" respectSupertype="true" />
-                <include nodeType="rep:Policy" respectSupertype="true" />
-                <include nodeType="cq:Widget" respectSupertype="true" />
-                <include nodeType="cq:EditConfig" respectSupertype="true" />
-                <include nodeType="cq:WorkflowModel" respectSupertype="true" />
-                <include nodeType="vlt:FullCoverage" respectSupertype="true" />
-                <include nodeType="mix:language" respectSupertype="true" />
-                <include nodeType="sling:OsgiConfig" respectSupertype="true" />
-            </matches>
-        </aggregate>
-
-        <!--
-            Defines an aggregate that handles nt:folder like nodes.
-        -->
-        <aggregate type="generic" title="Folder Aggregate">
-            <matches>
-                <include nodeType="nt:folder" respectSupertype="true" />
-            </matches>
-            <contains>
-                <exclude isNode="true" />
-            </contains>
-        </aggregate>
-
-        <!--
-            Defines the default aggregate
-        -->
-        <aggregate type="generic" title="Default Aggregator" isDefault="true">
-            <matches>
-                <!-- all -->
-            </matches>
-            <contains>
-                <exclude nodeType="nt:hierarchyNode" respectSupertype="true" />
-            </contains>
-        </aggregate>
-
-    </aggregates>
-
-    <!--
-      defines the input handlers
-    -->
-    <handlers>
-        <handler type="folder"/>
-        <handler type="file"/>
-        <handler type="nodetype"/>
-        <handler type="generic"/>
-    </handlers>
-</vaultfs>
diff --git a/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/META-INF/vault/definition/.content.xml b/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/META-INF/vault/definition/.content.xml
deleted file mode 100644
index 87746d9e..00000000
--- a/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/META-INF/vault/definition/.content.xml
+++ /dev/null
@@ -1,25 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:vlt="http://www.day.com/jcr/vault/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-    jcr:created="{Date}2011-06-07T14:32:17.432-07:00"
-    jcr:createdBy="admin"
-    jcr:description=""
-    jcr:lastModified="{Date}2011-06-07T14:32:17.432-07:00"
-    jcr:lastModifiedBy="admin"
-    jcr:primaryType="vlt:PackageDefinition"
-    buildCount="1"
-    cqVersion="5.3"
-    group="my_packages"
-    lastUnwrapped="{Date}2011-06-07T14:32:17.432-07:00"
-    lastUnwrappedBy="admin"
-    lastWrapped="{Date}2011-06-07T14:32:17.432-07:00"
-    lastWrappedBy="admin"
-    name="tmp_foo"
-    version="">
-    <filter jcr:primaryType="nt:unstructured">
-        <f0
-            jcr:primaryType="nt:unstructured"
-            mode="replace"
-            root="/tmp/foo"
-            rules="[]"/>
-    </filter>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 520dc144..00000000
--- a/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/home" mode="merge"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 56fe4200..00000000
--- a/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,12 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
-[sling:OrderedFolder] > sling:Folder
-  orderable
-  + * (nt:base) = sling:OrderedFolder version
-
diff --git a/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/META-INF/vault/properties.xml
deleted file mode 100644
index bae9fb9a..00000000
--- a/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>Testpackage for folder nodeType on filters with mode merge</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">test_nodetype_on_merge</entry>
-<entry key="lastModified">2011-06-07T14:32:17.432-07:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-06-07T14:32:17.502-07:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="group">my_packages</entry>
-<entry key="path">/etc/packages/my_packages/test_nodetype_on_merge</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/jcr_root/.content.xml
deleted file mode 100644
index c269eee3..00000000
--- a/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,16 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/welcome.html">
-    <home/>
-    <rep:policy/>
-    <jcr:system/>
-    <etc/>
-    <apps/>
-    <libs/>
-    <content/>
-    <var/>
-    <tmp/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/jcr_root/home/groups/.content.xml b/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/jcr_root/home/groups/.content.xml
deleted file mode 100644
index b74bb7e6..00000000
--- a/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/jcr_root/home/groups/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="rep:AuthorizableFolder"/>
-
diff --git a/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/jcr_root/home/groups/test/.content.xml b/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/jcr_root/home/groups/test/.content.xml
deleted file mode 100644
index b74bb7e6..00000000
--- a/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/jcr_root/home/groups/test/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:primaryType="rep:AuthorizableFolder"/>
-
diff --git a/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/jcr_root/home/groups/test/lXZzTxX_ZZkvjixvqJON/.content.xml b/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/jcr_root/home/groups/test/lXZzTxX_ZZkvjixvqJON/.content.xml
deleted file mode 100644
index 6b657a24..00000000
--- a/vault-core/src/test/resources/test-packages/test_nodetype_on_merge.zip/jcr_root/home/groups/test/lXZzTxX_ZZkvjixvqJON/.content.xml
+++ /dev/null
@@ -1,7 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:Group"
-    jcr:uuid="9628ffae-cf05-3138-8185-2cb572d50d45"
-    rep:authorizableId="testgroup"
-    rep:principalName="testgroup"/>
diff --git a/vault-core/src/test/resources/test-packages/test_nt_unstructured_below_folder_aggregate.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/test_nt_unstructured_below_folder_aggregate.zip/META-INF/vault/filter.xml
deleted file mode 100644
index c94973e8..00000000
--- a/vault-core/src/test/resources/test-packages/test_nt_unstructured_below_folder_aggregate.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot/myfolder"/>
-</workspaceFilter>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/test_nt_unstructured_below_folder_aggregate.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/test_nt_unstructured_below_folder_aggregate.zip/META-INF/vault/properties.xml
deleted file mode 100644
index b5979b69..00000000
--- a/vault-core/src/test/resources/test-packages/test_nt_unstructured_below_folder_aggregate.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,18 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Test Implicit Definitions</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">implicit-definition-test</entry>
-<entry key="lastModified">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:45:14.685+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/test_nt_unstructured_below_folder_aggregate.zip/jcr_root/testroot/myfolder/mychild/.content.xml b/vault-core/src/test/resources/test-packages/test_nt_unstructured_below_folder_aggregate.zip/jcr_root/testroot/myfolder/mychild/.content.xml
deleted file mode 100644
index d1ff8989..00000000
--- a/vault-core/src/test/resources/test-packages/test_nt_unstructured_below_folder_aggregate.zip/jcr_root/testroot/myfolder/mychild/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal" xmlns:my="http://jackrabbit.apache.org/filevault/testing"
-    jcr:primaryType="nt:unstructured">
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/test_sns.zip b/vault-core/src/test/resources/test-packages/test_sns.zip
deleted file mode 100644
index 05f5bcd8..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_sns.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_two_moved_users.zip b/vault-core/src/test/resources/test-packages/test_two_moved_users.zip
deleted file mode 100644
index 28e9eaff..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_two_moved_users.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_user_a.zip b/vault-core/src/test/resources/test-packages/test_user_a.zip
deleted file mode 100644
index 1f06a3ee..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_user_a.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_user_a_policy.zip b/vault-core/src/test/resources/test-packages/test_user_a_policy.zip
deleted file mode 100644
index d8f42c23..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_user_a_policy.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_user_a_profile.zip b/vault-core/src/test/resources/test-packages/test_user_a_profile.zip
deleted file mode 100644
index bb806041..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_user_a_profile.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_user_a_profile_picture.zip b/vault-core/src/test/resources/test-packages/test_user_a_profile_picture.zip
deleted file mode 100644
index 74983737..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_user_a_profile_picture.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_user_with_rep_cache.zip b/vault-core/src/test/resources/test-packages/test_user_with_rep_cache.zip
deleted file mode 100644
index d3ddda48..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_user_with_rep_cache.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/test_version.zip b/vault-core/src/test/resources/test-packages/test_version.zip
deleted file mode 100644
index 79d850c9..00000000
Binary files a/vault-core/src/test/resources/test-packages/test_version.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/testrootimport.zip b/vault-core/src/test/resources/test-packages/testrootimport.zip
deleted file mode 100644
index 08310a99..00000000
Binary files a/vault-core/src/test/resources/test-packages/testrootimport.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp.zip b/vault-core/src/test/resources/test-packages/tmp.zip
deleted file mode 100644
index e04dafa0..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp_binary.zip b/vault-core/src/test/resources/test-packages/tmp_binary.zip
deleted file mode 100644
index e3ab482f..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp_binary.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp_foo.zip b/vault-core/src/test/resources/test-packages/tmp_foo.zip
deleted file mode 100644
index b2e44483..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp_foo.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp_foo_bar.zip b/vault-core/src/test/resources/test-packages/tmp_foo_bar.zip
deleted file mode 100644
index 31467ca0..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp_foo_bar.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp_foo_bar_test.zip b/vault-core/src/test/resources/test-packages/tmp_foo_bar_test.zip
deleted file mode 100644
index 4305f554..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp_foo_bar_test.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp_foo_bar_test_minimal.zip b/vault-core/src/test/resources/test-packages/tmp_foo_bar_test_minimal.zip
deleted file mode 100644
index d497ba46..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp_foo_bar_test_minimal.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp_foo_bar_test_nofilter.zip b/vault-core/src/test/resources/test-packages/tmp_foo_bar_test_nofilter.zip
deleted file mode 100644
index 6a80e215..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp_foo_bar_test_nofilter.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp_illegal.zip b/vault-core/src/test/resources/test-packages/tmp_illegal.zip
deleted file mode 100644
index 6fbb1cbf..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp_illegal.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp_less.zip b/vault-core/src/test/resources/test-packages/tmp_less.zip
deleted file mode 100644
index 185e0232..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp_less.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp_mode_merge.zip b/vault-core/src/test/resources/test-packages/tmp_mode_merge.zip
deleted file mode 100644
index 464bf58e..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp_mode_merge.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp_mode_replace.zip b/vault-core/src/test/resources/test-packages/tmp_mode_replace.zip
deleted file mode 100644
index c119d486..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp_mode_replace.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp_mode_update.zip b/vault-core/src/test/resources/test-packages/tmp_mode_update.zip
deleted file mode 100644
index 6a9167c1..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp_mode_update.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp_no_properties.zip b/vault-core/src/test/resources/test-packages/tmp_no_properties.zip
deleted file mode 100644
index 24e5f2ae..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp_no_properties.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp_nt_folder.zip b/vault-core/src/test/resources/test-packages/tmp_nt_folder.zip
deleted file mode 100644
index 3ca7e1ea..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp_nt_folder.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp_test_deep.zip b/vault-core/src/test/resources/test-packages/tmp_test_deep.zip
deleted file mode 100644
index ae918b3a..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp_test_deep.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp_test_folders.zip b/vault-core/src/test/resources/test-packages/tmp_test_folders.zip
deleted file mode 100644
index 0b31d9b5..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp_test_folders.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp_testpage_jcr_content.zip b/vault-core/src/test/resources/test-packages/tmp_testpage_jcr_content.zip
deleted file mode 100644
index 3fed8936..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp_testpage_jcr_content.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp_with_modified_created_date.zip b/vault-core/src/test/resources/test-packages/tmp_with_modified_created_date.zip
deleted file mode 100644
index 32ae82a9..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp_with_modified_created_date.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/tmp_with_thumbnail.zip b/vault-core/src/test/resources/test-packages/tmp_with_thumbnail.zip
deleted file mode 100644
index e14055a4..00000000
Binary files a/vault-core/src/test/resources/test-packages/tmp_with_thumbnail.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/unfiltered_package.zip b/vault-core/src/test/resources/test-packages/unfiltered_package.zip
deleted file mode 100644
index fec37044..00000000
Binary files a/vault-core/src/test/resources/test-packages/unfiltered_package.zip and /dev/null differ
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/META-INF/MANIFEST.MF b/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/META-INF/MANIFEST.MF
deleted file mode 100644
index 60c85a6b..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/META-INF/MANIFEST.MF
+++ /dev/null
@@ -1,5 +0,0 @@
-Manifest-Version: 1.0
-Content-Package-Roots: /libs/msm/wcm
-Content-Package-Type: application
-Content-Package-Id: my_packages:wcm-rollout-config:1
-
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/META-INF/vault/config.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/META-INF/vault/config.xml
deleted file mode 100644
index b525f1c5..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/META-INF/vault/config.xml
+++ /dev/null
@@ -1,93 +0,0 @@
-<!--
-  Licensed to the Apache Software Foundation (ASF) under one or more
-  contributor license agreements.  See the NOTICE file distributed with
-  this work for additional information regarding copyright ownership.
-  The ASF licenses this file to You under the Apache License, Version 2.0
-  (the "License"); you may not use this file except in compliance with
-  the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-  Unless required by applicable law or agreed to in writing, software
-  distributed under the License is distributed on an "AS IS" BASIS,
-  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  See the License for the specific language governing permissions and
-  limitations under the License.
-  -->
-<vaultfs version="1.1">
-    <!--
-        Defines the content aggregation. The order of the defined aggregates
-        is important for finding the correct aggregator.
-    -->
-    <aggregates>
-        <!--
-            Defines an aggregate that handles nt:file and nt:resource nodes.
-        -->
-        <aggregate type="file" title="File Aggregate"/>
-
-        <!--
-            Defines an aggregate that handles file/folder like nodes. It matches
-            all nt:hierarchyNode nodes that have or define a jcr:content
-            child node and excludes child nodes that are nt:hierarchyNodes.
-        -->
-        <aggregate type="filefolder" title="File/Folder Aggregate"/>
-
-        <!--
-            Defines an aggregate that handles nt:nodeType nodes and serializes
-            them into .cnd notation.
-        -->
-        <aggregate type="nodetype" title="Node Type Aggregate" />
-
-        <!--
-            Defines an aggregate that defines full coverage for certain node
-            types that cannot be covered by the default aggregator.
-        -->
-        <aggregate type="full" title="Full Coverage Aggregate">
-            <matches>
-                <include nodeType="rep:AccessControl" respectSupertype="true" />
-                <include nodeType="rep:Policy" respectSupertype="true" />
-                <include nodeType="cq:Widget" respectSupertype="true" />
-                <include nodeType="cq:EditConfig" respectSupertype="true" />
-                <include nodeType="cq:WorkflowModel" respectSupertype="true" />
-                <include nodeType="vlt:FullCoverage" respectSupertype="true" />
-                <include nodeType="mix:language" respectSupertype="true" />
-                <include nodeType="sling:OsgiConfig" respectSupertype="true" />
-            </matches>
-        </aggregate>
-
-        <!--
-            Defines an aggregate that handles nt:folder like nodes.
-        -->
-        <aggregate type="generic" title="Folder Aggregate">
-            <matches>
-                <include nodeType="nt:folder" respectSupertype="true" />
-            </matches>
-            <contains>
-                <exclude isNode="true" />
-            </contains>
-        </aggregate>
-
-        <!--
-            Defines the default aggregate
-        -->
-        <aggregate type="generic" title="Default Aggregator" isDefault="true">
-            <matches>
-                <!-- all -->
-            </matches>
-            <contains>
-                <exclude nodeType="nt:hierarchyNode" respectSupertype="true" />
-            </contains>
-        </aggregate>
-
-    </aggregates>
-
-    <!--
-      defines the input handlers
-    -->
-    <handlers>
-        <handler type="folder"/>
-        <handler type="file"/>
-        <handler type="nodetype"/>
-        <handler type="generic"/>
-    </handlers>
-</vaultfs>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/META-INF/vault/definition/.content.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/META-INF/vault/definition/.content.xml
deleted file mode 100644
index 9c00456c..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/META-INF/vault/definition/.content.xml
+++ /dev/null
@@ -1,24 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:vlt="http://www.day.com/jcr/vault/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-    jcr:created="{Date}2021-07-21T17:12:34.610+12:00"
-    jcr:createdBy="admin"
-    jcr:description=""
-    jcr:lastModified="{Date}2021-07-21T17:12:34.610+12:00"
-    jcr:lastModifiedBy="admin"
-    jcr:primaryType="vlt:PackageDefinition"
-    buildCount="1"
-    group="my_packages"
-    lastUnwrapped="{Date}2021-07-21T17:12:34.610+12:00"
-    lastUnwrappedBy="admin"
-    lastWrapped="{Date}2021-07-21T17:12:34.610+12:00"
-    lastWrappedBy="admin"
-    name="wcm-rollout-config"
-    version="2">
-    <filter jcr:primaryType="nt:unstructured">
-        <f0
-            jcr:primaryType="nt:unstructured"
-            mode="replace"
-            root="/libs/msm/wcm"
-            rules="[]"/>
-    </filter>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 19770ed4..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/libs/msm/wcm"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 09bcebdf..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,27 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-<'cq'='http://www.day.com/jcr/cq/1.0'>
-<'mix'='http://www.jcp.org/jcr/mix/1.0'>
-<'rep'='internal'>
-
-[sling:OrderedFolder] > sling:Folder
-  orderable
-  + * (nt:base) = sling:OrderedFolder version
-
-[sling:Folder] > nt:folder
-  - * (undefined) multiple
-  - * (undefined)
-  + * (nt:base) = sling:Folder version
-
-[cq:RolloutConfig] > mix:title
-  orderable
-  - cq:trigger (string) mandatory
-  + * (cq:LiveSyncAction) mandatory
-
-[cq:LiveSyncAction] > nt:unstructured
-
-
-[rep:RepoAccessControllable]
-  mixin
-  + rep:repoPolicy (rep:Policy) protected ignore
-
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/META-INF/vault/properties.xml
deleted file mode 100644
index 00866f7d..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">wcm-rollout-config</entry>
-<entry key="lastModified">2021-07-21T17:12:34.610+12:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2021-07-21T17:12:34.623+12:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version">2</entry>
-<entry key="packageType">application</entry>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2021-07-21T17:12:34.610+12:00</entry>
-<entry key="group">my_packages</entry>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/.content.xml
deleted file mode 100644
index 8ea9f2ae..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable,rep:RepoAccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html"/>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/.content.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/.content.xml
deleted file mode 100644
index 792d2ead..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="nt:folder"/>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/msm/.content.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/msm/.content.xml
deleted file mode 100644
index 3db28fb4..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/msm/.content.xml
+++ /dev/null
@@ -1,5 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="sling:Folder"
-    jcr:title="MSM"/>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/msm/wcm/.content.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/msm/wcm/.content.xml
deleted file mode 100644
index b4b6de54..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/msm/wcm/.content.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="sling:OrderedFolder">
-    <rolloutconfigs/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/msm/wcm/rolloutconfigs/.content.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/msm/wcm/rolloutconfigs/.content.xml
deleted file mode 100644
index d12ffce6..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/msm/wcm/rolloutconfigs/.content.xml
+++ /dev/null
@@ -1,9 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="sling:OrderedFolder"
-    jcr:title="Rollout Configurations">
-    <default/>
-    <activate/>
-    <deactivate/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/msm/wcm/rolloutconfigs/activate/.content.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/msm/wcm/rolloutconfigs/activate/.content.xml
deleted file mode 100644
index d7a36aa1..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/msm/wcm/rolloutconfigs/activate/.content.xml
+++ /dev/null
@@ -1,7 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:cq="http://www.day.com/jcr/cq/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    cq:trigger="publish"
-    jcr:primaryType="cq:RolloutConfig"
-    jcr:title="Activate on Blueprint activation">
-    <targetActivate jcr:primaryType="cq:LiveSyncAction"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/msm/wcm/rolloutconfigs/deactivate/.content.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/msm/wcm/rolloutconfigs/deactivate/.content.xml
deleted file mode 100644
index 3f2bcb2f..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/msm/wcm/rolloutconfigs/deactivate/.content.xml
+++ /dev/null
@@ -1,7 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:cq="http://www.day.com/jcr/cq/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    cq:trigger="deactivate"
-    jcr:primaryType="cq:RolloutConfig"
-    jcr:title="Deactivate on Blueprint deactivation">
-    <targetDeactivate jcr:primaryType="cq:LiveSyncAction"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/msm/wcm/rolloutconfigs/default/.content.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/msm/wcm/rolloutconfigs/default/.content.xml
deleted file mode 100644
index 057cdf32..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-1.zip/jcr_root/libs/msm/wcm/rolloutconfigs/default/.content.xml
+++ /dev/null
@@ -1,11 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:cq="http://www.day.com/jcr/cq/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    cq:trigger="rollout"
-    jcr:description="Standard rollout configuration which allows to start rollout process on rollout trigger and runs actions: create, update, delete content and order children nodes."
-    jcr:primaryType="cq:RolloutConfig"
-    jcr:title="Standard rollout config">
-    <contentUpdate jcr:primaryType="cq:LiveSyncAction"/>
-    <activate jcr:primaryType="cq:LiveSyncAction"/>
-    <contentCopy jcr:primaryType="cq:LiveSyncAction"/>
-    <contentDelete jcr:primaryType="cq:LiveSyncAction"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/META-INF/MANIFEST.MF b/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/META-INF/MANIFEST.MF
deleted file mode 100644
index 60c85a6b..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/META-INF/MANIFEST.MF
+++ /dev/null
@@ -1,5 +0,0 @@
-Manifest-Version: 1.0
-Content-Package-Roots: /libs/msm/wcm
-Content-Package-Type: application
-Content-Package-Id: my_packages:wcm-rollout-config:1
-
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/META-INF/vault/config.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/META-INF/vault/config.xml
deleted file mode 100644
index b525f1c5..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/META-INF/vault/config.xml
+++ /dev/null
@@ -1,93 +0,0 @@
-<!--
-  Licensed to the Apache Software Foundation (ASF) under one or more
-  contributor license agreements.  See the NOTICE file distributed with
-  this work for additional information regarding copyright ownership.
-  The ASF licenses this file to You under the Apache License, Version 2.0
-  (the "License"); you may not use this file except in compliance with
-  the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-  Unless required by applicable law or agreed to in writing, software
-  distributed under the License is distributed on an "AS IS" BASIS,
-  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  See the License for the specific language governing permissions and
-  limitations under the License.
-  -->
-<vaultfs version="1.1">
-    <!--
-        Defines the content aggregation. The order of the defined aggregates
-        is important for finding the correct aggregator.
-    -->
-    <aggregates>
-        <!--
-            Defines an aggregate that handles nt:file and nt:resource nodes.
-        -->
-        <aggregate type="file" title="File Aggregate"/>
-
-        <!--
-            Defines an aggregate that handles file/folder like nodes. It matches
-            all nt:hierarchyNode nodes that have or define a jcr:content
-            child node and excludes child nodes that are nt:hierarchyNodes.
-        -->
-        <aggregate type="filefolder" title="File/Folder Aggregate"/>
-
-        <!--
-            Defines an aggregate that handles nt:nodeType nodes and serializes
-            them into .cnd notation.
-        -->
-        <aggregate type="nodetype" title="Node Type Aggregate" />
-
-        <!--
-            Defines an aggregate that defines full coverage for certain node
-            types that cannot be covered by the default aggregator.
-        -->
-        <aggregate type="full" title="Full Coverage Aggregate">
-            <matches>
-                <include nodeType="rep:AccessControl" respectSupertype="true" />
-                <include nodeType="rep:Policy" respectSupertype="true" />
-                <include nodeType="cq:Widget" respectSupertype="true" />
-                <include nodeType="cq:EditConfig" respectSupertype="true" />
-                <include nodeType="cq:WorkflowModel" respectSupertype="true" />
-                <include nodeType="vlt:FullCoverage" respectSupertype="true" />
-                <include nodeType="mix:language" respectSupertype="true" />
-                <include nodeType="sling:OsgiConfig" respectSupertype="true" />
-            </matches>
-        </aggregate>
-
-        <!--
-            Defines an aggregate that handles nt:folder like nodes.
-        -->
-        <aggregate type="generic" title="Folder Aggregate">
-            <matches>
-                <include nodeType="nt:folder" respectSupertype="true" />
-            </matches>
-            <contains>
-                <exclude isNode="true" />
-            </contains>
-        </aggregate>
-
-        <!--
-            Defines the default aggregate
-        -->
-        <aggregate type="generic" title="Default Aggregator" isDefault="true">
-            <matches>
-                <!-- all -->
-            </matches>
-            <contains>
-                <exclude nodeType="nt:hierarchyNode" respectSupertype="true" />
-            </contains>
-        </aggregate>
-
-    </aggregates>
-
-    <!--
-      defines the input handlers
-    -->
-    <handlers>
-        <handler type="folder"/>
-        <handler type="file"/>
-        <handler type="nodetype"/>
-        <handler type="generic"/>
-    </handlers>
-</vaultfs>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/META-INF/vault/definition/.content.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/META-INF/vault/definition/.content.xml
deleted file mode 100644
index 9c00456c..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/META-INF/vault/definition/.content.xml
+++ /dev/null
@@ -1,24 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:vlt="http://www.day.com/jcr/vault/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
-    jcr:created="{Date}2021-07-21T17:12:34.610+12:00"
-    jcr:createdBy="admin"
-    jcr:description=""
-    jcr:lastModified="{Date}2021-07-21T17:12:34.610+12:00"
-    jcr:lastModifiedBy="admin"
-    jcr:primaryType="vlt:PackageDefinition"
-    buildCount="1"
-    group="my_packages"
-    lastUnwrapped="{Date}2021-07-21T17:12:34.610+12:00"
-    lastUnwrappedBy="admin"
-    lastWrapped="{Date}2021-07-21T17:12:34.610+12:00"
-    lastWrappedBy="admin"
-    name="wcm-rollout-config"
-    version="2">
-    <filter jcr:primaryType="nt:unstructured">
-        <f0
-            jcr:primaryType="nt:unstructured"
-            mode="replace"
-            root="/libs/msm/wcm"
-            rules="[]"/>
-    </filter>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/META-INF/vault/filter.xml
deleted file mode 100644
index 19770ed4..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/libs/msm/wcm"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index ee941ee0..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,26 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-<'cq'='http://www.day.com/jcr/cq/1.0'>
-<'mix'='http://www.jcp.org/jcr/mix/1.0'>
-<'rep'='internal'>
-
-[sling:OrderedFolder] > sling:Folder
-  orderable
-  + * (nt:base) = sling:OrderedFolder version
-
-[sling:Folder] > nt:folder
-  - * (undefined) multiple
-  - * (undefined)
-  + * (nt:base) = sling:Folder version
-
-[cq:RolloutConfig] > mix:title
-  orderable
-  - cq:trigger (string) mandatory
-  + * (cq:LiveSyncAction) mandatory  
-
-[cq:LiveSyncAction] > nt:unstructured
-
-[rep:RepoAccessControllable]
-  mixin
-  + rep:repoPolicy (rep:Policy) protected ignore
-
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/META-INF/vault/properties.xml
deleted file mode 100644
index 00866f7d..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,19 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">wcm-rollout-config</entry>
-<entry key="lastModified">2021-07-21T17:12:34.610+12:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2021-07-21T17:12:34.623+12:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version">2</entry>
-<entry key="packageType">application</entry>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2021-07-21T17:12:34.610+12:00</entry>
-<entry key="group">my_packages</entry>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/.content.xml
deleted file mode 100644
index 8ea9f2ae..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable,rep:RepoAccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html"/>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/.content.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/.content.xml
deleted file mode 100644
index 792d2ead..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="nt:folder"/>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/msm/.content.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/msm/.content.xml
deleted file mode 100644
index 3db28fb4..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/msm/.content.xml
+++ /dev/null
@@ -1,5 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="sling:Folder"
-    jcr:title="MSM"/>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/msm/wcm/.content.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/msm/wcm/.content.xml
deleted file mode 100644
index b4b6de54..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/msm/wcm/.content.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="sling:OrderedFolder">
-    <rolloutconfigs/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/msm/wcm/rolloutconfigs/.content.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/msm/wcm/rolloutconfigs/.content.xml
deleted file mode 100644
index d12ffce6..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/msm/wcm/rolloutconfigs/.content.xml
+++ /dev/null
@@ -1,9 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="sling:OrderedFolder"
-    jcr:title="Rollout Configurations">
-    <default/>
-    <activate/>
-    <deactivate/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/msm/wcm/rolloutconfigs/activate/.content.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/msm/wcm/rolloutconfigs/activate/.content.xml
deleted file mode 100644
index dfefc66f..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/msm/wcm/rolloutconfigs/activate/.content.xml
+++ /dev/null
@@ -1,7 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:cq="http://www.day.com/jcr/cq/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    cq:trigger="publish"
-    jcr:primaryType="cq:RolloutConfig"
-    jcr:title="Activate on Blueprint activation">
-    <targetNewActivate jcr:primaryType="cq:LiveSyncAction"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/msm/wcm/rolloutconfigs/deactivate/.content.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/msm/wcm/rolloutconfigs/deactivate/.content.xml
deleted file mode 100644
index 5f6c6c4e..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/msm/wcm/rolloutconfigs/deactivate/.content.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:cq="http://www.day.com/jcr/cq/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    cq:trigger="deactivate"
-    jcr:primaryType="cq:RolloutConfig"
-    jcr:title="Deactivate on Blueprint deactivation">
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/msm/wcm/rolloutconfigs/default/.content.xml b/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/msm/wcm/rolloutconfigs/default/.content.xml
deleted file mode 100644
index 566e29ae..00000000
--- a/vault-core/src/test/resources/test-packages/wcm-rollout-config-2.zip/jcr_root/libs/msm/wcm/rolloutconfigs/default/.content.xml
+++ /dev/null
@@ -1,9 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:cq="http://www.day.com/jcr/cq/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    cq:trigger="rollout"
-    jcr:description="Standard rollout configuration which allows to start rollout process on rollout trigger and runs actions: create, update, delete content and order children nodes."
-    jcr:primaryType="cq:RolloutConfig"
-    jcr:title="Standard rollout config">
-    <activate jcr:primaryType="cq:LiveSyncAction"/>
-    <contentCopy jcr:primaryType="cq:LiveSyncAction"/>
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/xml-nwf-truncated.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/xml-nwf-truncated.zip/META-INF/vault/filter.xml
deleted file mode 100644
index bbbd616d..00000000
--- a/vault-core/src/test/resources/test-packages/xml-nwf-truncated.zip/META-INF/vault/filter.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<workspaceFilter version="1.0">
-    <filter root="/testroot"/>
-</workspaceFilter>
diff --git a/vault-core/src/test/resources/test-packages/xml-nwf-truncated.zip/META-INF/vault/nodetypes.cnd b/vault-core/src/test/resources/test-packages/xml-nwf-truncated.zip/META-INF/vault/nodetypes.cnd
deleted file mode 100644
index 3771ba50..00000000
--- a/vault-core/src/test/resources/test-packages/xml-nwf-truncated.zip/META-INF/vault/nodetypes.cnd
+++ /dev/null
@@ -1,9 +0,0 @@
-<'sling'='http://sling.apache.org/jcr/sling/1.0'>
-<'nt'='http://www.jcp.org/jcr/nt/1.0'>
-<'cq'='http://www.day.com/jcr/cq/1.0'>
-
-[sling:Folder] > nt:folder
-  - * (undefined)
-  - * (undefined) multiple
-  + * (nt:base) = sling:Folder version
-
diff --git a/vault-core/src/test/resources/test-packages/xml-nwf-truncated.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/xml-nwf-truncated.zip/META-INF/vault/properties.xml
deleted file mode 100644
index c606e192..00000000
--- a/vault-core/src/test/resources/test-packages/xml-nwf-truncated.zip/META-INF/vault/properties.xml
+++ /dev/null
@@ -1,18 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no"?>
-<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
-<properties>
-<comment>FileVault Package Properties</comment>
-<entry key="createdBy">admin</entry>
-<entry key="name">import-modes-test</entry>
-<entry key="lastModified">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="lastModifiedBy">admin</entry>
-<entry key="created">2011-11-15T09:45:14.685+01:00</entry>
-<entry key="buildCount">1</entry>
-<entry key="version"/>
-<entry key="dependencies"/>
-<entry key="packageFormatVersion">2</entry>
-<entry key="description"/>
-<entry key="lastWrapped">2011-11-15T09:45:14.664+01:00</entry>
-<entry key="group"/>
-<entry key="lastWrappedBy">admin</entry>
-</properties>
diff --git a/vault-core/src/test/resources/test-packages/xml-nwf-truncated.zip/jcr_root/.content.xml b/vault-core/src/test/resources/test-packages/xml-nwf-truncated.zip/jcr_root/.content.xml
deleted file mode 100644
index 1bdc10cb..00000000
--- a/vault-core/src/test/resources/test-packages/xml-nwf-truncated.zip/jcr_root/.content.xml
+++ /dev/null
@@ -1,16 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal"
-    jcr:mixinTypes="[rep:AccessControllable]"
-    jcr:primaryType="rep:root"
-    sling:resourceType="sling:redirect"
-    sling:target="/index.html">
-    <rep:policy/>
-    <jcr:system/>
-    <var/>
-    <libs/>
-    <etc/>
-    <apps/>
-    <content/>
-    <tmp/>
-    <home/>
-    <testroot/>
diff --git a/vault-core/src/test/resources/test-packages/xml-nwf-truncated.zip/jcr_root/testroot/.content.xml b/vault-core/src/test/resources/test-packages/xml-nwf-truncated.zip/jcr_root/testroot/.content.xml
deleted file mode 100644
index c5cf582a..00000000
--- a/vault-core/src/test/resources/test-packages/xml-nwf-truncated.zip/jcr_root/testroot/.content.xml
+++ /dev/null
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal" xmlns:my="http://jackrabbit.apache.org/filevault/testing"
-    jcr:primaryType="sling:Folder">
-</jcr:root>
diff --git a/vault-core/src/test/resources/test-packages/xml-nwf-truncated.zip/jcr_root/testroot/_cq_content.xml b/vault-core/src/test/resources/test-packages/xml-nwf-truncated.zip/jcr_root/testroot/_cq_content.xml
deleted file mode 100644
index 531bf71b..00000000
--- a/vault-core/src/test/resources/test-packages/xml-nwf-truncated.zip/jcr_root/testroot/_cq_content.xml
+++ /dev/null
@@ -1,20 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!--
-  Licensed to the Apache Software Foundation (ASF) under one or more
-  contributor license agreements.  See the NOTICE file distributed with
-  this work for additional information regarding copyright ownership.
-  The ASF licenses this file to You under the Apache License, Version 2.0
-  (the "License"); you may not use this file except in compliance with
-  the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-  Unless required by applicable law or agreed to in writing, software
-  distributed under the License is distributed on an "AS IS" BASIS,
-  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  See the License for the specific language governing permissions and
-  limitations under the License.
-  -->
-<jcr:root xmlns:jcr="http://www.jcp.org/jcr/1.0"
-    jcr:primaryType="nt:unstructured">
-</jcr:root>
