diff --git a/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageImpl.java b/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageImpl.java
index ff32c8a7..2c6cb7bf 100644
--- a/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageImpl.java
+++ b/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageImpl.java
@@ -370,6 +370,7 @@ public class JcrPackageImpl implements JcrPackage {
     private void extract(Set<PackageId> processed, ImportOptions options, boolean createSnapshot, boolean replaceSnapshot)
             throws RepositoryException, PackageException, IOException {
         getPackage();
+        getDefinition();
         if (def != null) {
             processed.add(def.getId());
         }
@@ -394,7 +395,6 @@ public class JcrPackageImpl implements JcrPackage {
         }
         List<String> subPackages = new ArrayList<String>();
         pack.extract(ctx, subPackages);
-        getDefinition();
         if (def != null && !opts.isDryRun()) {
             def.touchLastUnpacked(null, true);
         }
@@ -903,6 +903,7 @@ public class JcrPackageImpl implements JcrPackage {
      * {@inheritDoc}
      */
     private void uninstall(Set<PackageId> processed, ImportOptions opts) throws RepositoryException, PackageException, IOException {
+        getDefinition();
         if (def != null) {
             processed.add(def.getId());
         }
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/IntegrationTestBase.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/IntegrationTestBase.java
index a157691f..d34814dc 100644
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/IntegrationTestBase.java
+++ b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/IntegrationTestBase.java
@@ -80,6 +80,7 @@ import org.apache.jackrabbit.vault.fs.io.ImportOptions;
 import org.apache.jackrabbit.vault.packaging.JcrPackage;
 import org.apache.jackrabbit.vault.packaging.JcrPackageManager;
 import org.apache.jackrabbit.vault.packaging.PackageException;
+import org.apache.jackrabbit.vault.packaging.PackageId;
 import org.apache.jackrabbit.vault.packaging.VaultPackage;
 import org.apache.jackrabbit.vault.packaging.events.impl.PackageEventDispatcherImpl;
 import org.apache.jackrabbit.vault.packaging.impl.ActivityLog;
@@ -317,6 +318,19 @@ public class IntegrationTestBase  {
         return pack;
     }
 
+    /**
+     * Uploads, closes, and reopens the package
+     */
+    public JcrPackage uploadPackage(String name) throws RepositoryException, IOException {
+        JcrPackage jcrPackage = packMgr.upload(getStream(name), false);
+        assertNotNull(jcrPackage);
+        PackageId pid = jcrPackage.getDefinition().getId();
+        jcrPackage.close();
+        jcrPackage = packMgr.open(pid);
+        assertNotNull(jcrPackage);
+        return jcrPackage;
+    }
+
     public JcrPackage installPackage(String name) throws IOException, RepositoryException, PackageException {
         return installPackage(name, null);
     }
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/TestEnforcedDependencies.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/TestEnforcedDependencies.java
index 3f4f34eb..12c0b0e2 100644
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/TestEnforcedDependencies.java
+++ b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/TestEnforcedDependencies.java
@@ -112,11 +112,9 @@ public class TestEnforcedDependencies extends IntegrationTestBase {
      */
     @Test
     public void testUnresolved() throws IOException, RepositoryException {
-        JcrPackage a1 = packMgr.upload(getStream(TEST_PACKAGE_A_10), false);
-        assertNotNull(a1);
+        JcrPackage a1 = uploadPackage(TEST_PACKAGE_A_10);
         Dependency[] deps = a1.getUnresolvedDependencies();
         assertEquals("package must report unresolved dependencies", "my_packages:test_b,my_packages:test_c:[1.0,2.0)", Dependency.toString(deps));
-
     }
 
     /**
@@ -124,9 +122,7 @@ public class TestEnforcedDependencies extends IntegrationTestBase {
      */
     @Test
     public void testInstallDepMissing() throws IOException, RepositoryException, PackageException {
-        JcrPackage b1 = packMgr.upload(getStream(TEST_PACKAGE_B_10), false);
-        assertNotNull(b1);
-
+        JcrPackage b1 = uploadPackage(TEST_PACKAGE_B_10);
         ImportOptions opts = getDefaultOptions();
         opts.setDependencyHandling(DependencyHandling.STRICT);
         try {
@@ -142,11 +138,8 @@ public class TestEnforcedDependencies extends IntegrationTestBase {
      */
     @Test
     public void testInstallDepMissingRequired() throws IOException, RepositoryException, PackageException {
-        JcrPackage b1 = packMgr.upload(getStream(TEST_PACKAGE_B_10), false);
-        assertNotNull(b1);
-
-        JcrPackage a1 = packMgr.upload(getStream(TEST_PACKAGE_A_10), false);
-        assertNotNull(a1);
+        uploadPackage(TEST_PACKAGE_B_10);
+        JcrPackage a1 = uploadPackage(TEST_PACKAGE_A_10);
 
         ImportOptions opts = getDefaultOptions();
         opts.setDependencyHandling(DependencyHandling.REQUIRED);
@@ -163,10 +156,9 @@ public class TestEnforcedDependencies extends IntegrationTestBase {
      */
     @Test
     public void testInstallDepUninstalled() throws IOException, RepositoryException, PackageException {
-        packMgr.upload(getStream(TEST_PACKAGE_C_10), false);
+        uploadPackage(TEST_PACKAGE_C_10);
         assertNodeMissing("/tmp/c/");
-        JcrPackage b1 = packMgr.upload(getStream(TEST_PACKAGE_B_10), false);
-        assertNotNull(b1);
+        JcrPackage b1 = uploadPackage(TEST_PACKAGE_B_10);
 
         ImportOptions opts = getDefaultOptions();
         opts.setDependencyHandling(DependencyHandling.STRICT);
@@ -184,9 +176,9 @@ public class TestEnforcedDependencies extends IntegrationTestBase {
      */
     @Test
     public void testInstallDepInstallsRequired() throws IOException, RepositoryException, PackageException {
-        packMgr.upload(getStream(TEST_PACKAGE_C_10), false);
+        uploadPackage(TEST_PACKAGE_C_10);
         assertNodeMissing("/tmp/c/");
-        JcrPackage b1 = packMgr.upload(getStream(TEST_PACKAGE_B_10), false);
+        JcrPackage b1 = uploadPackage(TEST_PACKAGE_B_10);
         assertNotNull(b1);
 
         ImportOptions opts = getDefaultOptions();
@@ -202,13 +194,13 @@ public class TestEnforcedDependencies extends IntegrationTestBase {
      */
     @Test
     public void testInstallDepInstallsAll() throws IOException, RepositoryException, PackageException {
-        packMgr.upload(getStream(TEST_PACKAGE_C_10), false);
-        packMgr.upload(getStream(TEST_PACKAGE_C_11), false);
-        packMgr.upload(getStream(TEST_PACKAGE_C_20), false);
-        packMgr.upload(getStream(TEST_PACKAGE_B_10), false);
+        uploadPackage(TEST_PACKAGE_C_10);
+        uploadPackage(TEST_PACKAGE_C_11);
+        uploadPackage(TEST_PACKAGE_C_20);
+        uploadPackage(TEST_PACKAGE_B_10);
         assertNodeMissing("/tmp/b/");
         assertNodeMissing("/tmp/c/");
-        JcrPackage a2 = packMgr.upload(getStream(TEST_PACKAGE_A_20), false);
+        JcrPackage a2 = uploadPackage(TEST_PACKAGE_A_20);
         assertNotNull(a2);
 
         ImportOptions opts = getDefaultOptions();
@@ -225,12 +217,11 @@ public class TestEnforcedDependencies extends IntegrationTestBase {
      */
     @Test
     public void testInstallDeep() throws IOException, RepositoryException, PackageException {
-        packMgr.upload(getStream(TEST_PACKAGE_C_10), false);
-        packMgr.upload(getStream(TEST_PACKAGE_B_10), false);
+        uploadPackage(TEST_PACKAGE_C_10);
+        uploadPackage(TEST_PACKAGE_B_10);
         assertNodeMissing("/tmp/b/");
         assertNodeMissing("/tmp/c/");
-        JcrPackage d1 = packMgr.upload(getStream(TEST_PACKAGE_D_10), false);
-        assertNotNull(d1);
+        JcrPackage d1 = uploadPackage(TEST_PACKAGE_D_10);
 
         ImportOptions opts = getDefaultOptions();
         opts.setDependencyHandling(DependencyHandling.BEST_EFFORT);
@@ -246,11 +237,10 @@ public class TestEnforcedDependencies extends IntegrationTestBase {
      */
     @Test
     public void testInstallCyclicFails() throws IOException, RepositoryException, PackageException {
-        packMgr.upload(getStream(TEST_PACKAGE_B_10), false);
-        packMgr.upload(getStream(TEST_PACKAGE_C_10), false);
-        packMgr.upload(getStream(TEST_PACKAGE_E_10), false);
-        JcrPackage d1 = packMgr.upload(getStream(TEST_PACKAGE_D_10), false);
-        assertNotNull(d1);
+        uploadPackage(TEST_PACKAGE_B_10);
+        uploadPackage(TEST_PACKAGE_C_10);
+        uploadPackage(TEST_PACKAGE_E_10);
+        JcrPackage d1 = uploadPackage(TEST_PACKAGE_D_10);
 
         ImportOptions opts = getDefaultOptions();
         opts.setDependencyHandling(DependencyHandling.REQUIRED);
@@ -268,11 +258,10 @@ public class TestEnforcedDependencies extends IntegrationTestBase {
      */
     @Test
     public void testInstallCyclicSucceeds() throws IOException, RepositoryException, PackageException {
-        packMgr.upload(getStream(TEST_PACKAGE_B_10), false);
-        packMgr.upload(getStream(TEST_PACKAGE_C_10), false);
-        packMgr.upload(getStream(TEST_PACKAGE_E_10), false);
-        JcrPackage d1 = packMgr.upload(getStream(TEST_PACKAGE_D_10), false);
-        assertNotNull(d1);
+        uploadPackage(TEST_PACKAGE_B_10);
+        uploadPackage(TEST_PACKAGE_C_10);
+        uploadPackage(TEST_PACKAGE_E_10);
+        JcrPackage d1 = uploadPackage(TEST_PACKAGE_D_10);
 
         ImportOptions opts = getDefaultOptions();
         opts.setDependencyHandling(DependencyHandling.BEST_EFFORT);
@@ -289,19 +278,18 @@ public class TestEnforcedDependencies extends IntegrationTestBase {
      */
     @Test
     public void testInstallDepInstallsCorrectVersion() throws IOException, RepositoryException, PackageException {
-        packMgr.upload(getStream(TEST_PACKAGE_C_10), false);
-        packMgr.upload(getStream(TEST_PACKAGE_C_11), false);
-        packMgr.upload(getStream(TEST_PACKAGE_C_20), false);
-        packMgr.upload(getStream(TEST_PACKAGE_B_10), false);
+        uploadPackage(TEST_PACKAGE_C_10);
+        uploadPackage(TEST_PACKAGE_C_11);
+        uploadPackage(TEST_PACKAGE_C_20);
+        uploadPackage(TEST_PACKAGE_B_10);
         assertNodeMissing("/tmp/b/");
         assertNodeMissing("/tmp/c/");
-        JcrPackage b1 = packMgr.upload(getStream(TEST_PACKAGE_A_10), false);
-        assertNotNull(b1);
+        JcrPackage a1 = uploadPackage(TEST_PACKAGE_A_10);
 
         ImportOptions opts = getDefaultOptions();
         opts.setDependencyHandling(DependencyHandling.REQUIRED);
 
-        b1.install(opts);
+        a1.install(opts);
         assertProperty("/tmp/a/version", "1.0");
         assertProperty("/tmp/b/version", "1.0");
         assertProperty("/tmp/c/version", "1.1");
@@ -312,15 +300,15 @@ public class TestEnforcedDependencies extends IntegrationTestBase {
      */
     @Test
     public void testInstallDepInstallsBestEffort() throws IOException, RepositoryException, PackageException {
-        packMgr.upload(getStream(TEST_PACKAGE_C_10), false);
+        uploadPackage(TEST_PACKAGE_C_10);
         assertNodeMissing("/tmp/c/");
-        JcrPackage b1 = packMgr.upload(getStream(TEST_PACKAGE_A_10), false);
-        assertNotNull(b1);
+        JcrPackage a1 = uploadPackage(TEST_PACKAGE_A_10);
+        assertNotNull(a1);
 
         ImportOptions opts = getDefaultOptions();
         opts.setDependencyHandling(DependencyHandling.BEST_EFFORT);
 
-        b1.install(opts);
+        a1.install(opts);
         assertProperty("/tmp/a/version", "1.0");
         assertProperty("/tmp/c/version", "1.0");
     }
@@ -332,7 +320,7 @@ public class TestEnforcedDependencies extends IntegrationTestBase {
     public void testInstallDepInstalled() throws IOException, RepositoryException, PackageException {
         installPackage(TEST_PACKAGE_C_10);
         assertProperty("/tmp/c/version", "1.0");
-        JcrPackage b1 = packMgr.upload(getStream(TEST_PACKAGE_B_10), false);
+        JcrPackage b1 = uploadPackage(TEST_PACKAGE_B_10);
         assertNotNull(b1);
 
         ImportOptions opts = getDefaultOptions();
@@ -349,8 +337,7 @@ public class TestEnforcedDependencies extends IntegrationTestBase {
         installPackage(TEST_PACKAGE_C_10);
         assertProperty("/tmp/c/version", "1.0");
 
-        JcrPackage a2 = packMgr.upload(getStream(TEST_PACKAGE_A_20), false);
-        assertNotNull(a2);
+        JcrPackage a2 = uploadPackage(TEST_PACKAGE_A_20);
 
         ImportOptions opts = getDefaultOptions();
         opts.setDependencyHandling(DependencyHandling.STRICT);
@@ -373,8 +360,7 @@ public class TestEnforcedDependencies extends IntegrationTestBase {
         installPackage(TEST_PACKAGE_C_11);
         assertProperty("/tmp/c/version", "1.1");
 
-        JcrPackage a1 = packMgr.upload(getStream(TEST_PACKAGE_A_10), false);
-        assertNotNull(a1);
+        JcrPackage a1 = uploadPackage(TEST_PACKAGE_A_10);
 
         ImportOptions opts = getDefaultOptions();
         opts.setDependencyHandling(DependencyHandling.STRICT);
