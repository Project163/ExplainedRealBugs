diff --git a/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageImpl.java b/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageImpl.java
index f252e59f..74b2fa45 100644
--- a/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageImpl.java
+++ b/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageImpl.java
@@ -533,7 +533,13 @@ public class JcrPackageImpl implements JcrPackage {
             InputStream ins = null;
             try {
                 ins = in.getByteStream();
-                JcrPackageImpl subPackage = (JcrPackageImpl) mgr.upload(ins, false, true);
+                JcrPackageImpl subPackage;
+                try {
+                    subPackage = (JcrPackageImpl) mgr.upload(ins, true, true);
+                } catch (RepositoryException e1) {
+                    log.error("Package {}: Error while extracting subpackage {}: {}", pId, in.getSystemId());
+                    continue;
+                }
 
                 // add dependency to this package
                 Dependency[] oldDeps = subPackage.getDefinition().getDependencies();
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/TestSubPackages.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/TestSubPackages.java
index 0f6e57a2..53e1f6df 100644
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/TestSubPackages.java
+++ b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/TestSubPackages.java
@@ -348,6 +348,31 @@ public class TestSubPackages extends IntegrationTestBase {
         assertEquals("Package Id", ids[1].toString(), "my_packages:sub_b");
     }
 
+    /**
+     * Test if subpackage extraction works twice
+     */
+    @Test
+    public void testPackageExtractTwice() throws IOException, RepositoryException, PackageException {
+        JcrPackage pack = packMgr.upload(getStream("testpackages/subtest.zip"), false);
+        assertNotNull(pack);
+
+        // install
+        ImportOptions opts = getDefaultOptions();
+        PackageId[] ids = pack.extractSubpackages(opts);
+        PackageId pid = ids[0];
+        JcrPackage subPackage = packMgr.open(pid);
+        subPackage.install(opts);
+        assertTrue("Package is installed", subPackage.isInstalled());
+
+        ids = pack.extractSubpackages(opts);
+        assertEquals("Package Id", ids[0].toString(), "my_packages:sub_a");
+        assertEquals("Package Id", ids[1].toString(), "my_packages:sub_b");
+
+        subPackage = packMgr.open(pid);
+        subPackage.install(opts);
+        assertTrue("Package is still installed", subPackage.isInstalled());
+    }
+
     /**
      * Test if extracted sub-packages have their parent package as dependency, even if not specified in their properties.
      */
