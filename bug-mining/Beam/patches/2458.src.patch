diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/transforms/DoFn.java b/sdks/java/core/src/main/java/org/apache/beam/sdk/transforms/DoFn.java
index 502add97bea..47eac66c9af 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/transforms/DoFn.java
+++ b/sdks/java/core/src/main/java/org/apache/beam/sdk/transforms/DoFn.java
@@ -975,7 +975,7 @@ public abstract class DoFn<InputT extends @Nullable Object, OutputT extends @Nul
    *       options for the current pipeline.
    * </ul>
    *
-   * <p>Returns a double representing the size of the current element and restriction.
+   * <p>Returns a non-negative double representing the size of the current element and restriction.
    *
    * <p>Splittable {@link DoFn}s should only provide this method if the default {@link
    * RestrictionTracker.HasProgress} implementation within the {@link RestrictionTracker} is an
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/transforms/reflect/ByteBuddyDoFnInvokerFactory.java b/sdks/java/core/src/main/java/org/apache/beam/sdk/transforms/reflect/ByteBuddyDoFnInvokerFactory.java
index 758a95a4665..ef0449d69f3 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/transforms/reflect/ByteBuddyDoFnInvokerFactory.java
+++ b/sdks/java/core/src/main/java/org/apache/beam/sdk/transforms/reflect/ByteBuddyDoFnInvokerFactory.java
@@ -33,6 +33,7 @@ import org.apache.beam.sdk.coders.CoderRegistry;
 import org.apache.beam.sdk.state.Timer;
 import org.apache.beam.sdk.state.TimerMap;
 import org.apache.beam.sdk.transforms.DoFn;
+import org.apache.beam.sdk.transforms.DoFn.GetSize;
 import org.apache.beam.sdk.transforms.DoFn.ProcessElement;
 import org.apache.beam.sdk.transforms.DoFn.TruncateRestriction;
 import org.apache.beam.sdk.transforms.reflect.DoFnSignature.OnTimerMethod;
@@ -430,6 +431,14 @@ class ByteBuddyDoFnInvokerFactory implements DoFnInvokerFactory {
         return 1.0;
       }
     }
+
+    public static double validateSize(double size) {
+      if (size < 0) {
+        throw new IllegalArgumentException(
+            String.format("Expected size >= 0 but received %s.", size));
+      }
+      return size;
+    }
   }
 
   /** Generates a {@link DoFnInvoker} class for the given {@link DoFnSignature}. */
@@ -600,7 +609,7 @@ class ByteBuddyDoFnInvokerFactory implements DoFnInvokerFactory {
     if (signature == null) {
       return MethodDelegation.to(DefaultGetSize.class);
     } else {
-      return new DoFnMethodWithExtraParametersDelegation(doFnType, signature);
+      return new GetSizeDelegation(doFnType, signature);
     }
   }
 
@@ -1134,6 +1143,35 @@ class ByteBuddyDoFnInvokerFactory implements DoFnInvokerFactory {
     }
   }
 
+  /**
+   * Implements the invoker's {@link DoFnInvoker#invokeGetSize} method by delegating to the {@link
+   * GetSize} method.
+   */
+  private static final class GetSizeDelegation extends DoFnMethodWithExtraParametersDelegation {
+    private static final MethodDescription VALIDATE_SIZE_METHOD;
+
+    static {
+      try {
+        VALIDATE_SIZE_METHOD =
+            new MethodDescription.ForLoadedMethod(
+                DefaultGetSize.class.getMethod("validateSize", double.class));
+      } catch (NoSuchMethodException e) {
+        throw new RuntimeException("Failed to locate DefaultGetSize.validateSize()");
+      }
+    }
+
+    /** Implementation of {@link MethodDelegation} for the {@link GetSize} method. */
+    private GetSizeDelegation(TypeDescription doFnType, DoFnSignature.GetSizeMethod signature) {
+      super(doFnType, signature);
+    }
+
+    @Override
+    protected StackManipulation afterDelegation(MethodDescription instrumentedMethod) {
+      return new StackManipulation.Compound(
+          MethodInvocation.invoke(VALIDATE_SIZE_METHOD), MethodReturn.DOUBLE);
+    }
+  }
+
   private static class UserCodeMethodInvocation implements StackManipulation {
 
     private final @Nullable Integer returnVarIndex;
diff --git a/sdks/java/core/src/test/java/org/apache/beam/sdk/transforms/reflect/DoFnInvokersTest.java b/sdks/java/core/src/test/java/org/apache/beam/sdk/transforms/reflect/DoFnInvokersTest.java
index 285cab5e178..7beb9ebb092 100644
--- a/sdks/java/core/src/test/java/org/apache/beam/sdk/transforms/reflect/DoFnInvokersTest.java
+++ b/sdks/java/core/src/test/java/org/apache/beam/sdk/transforms/reflect/DoFnInvokersTest.java
@@ -26,6 +26,7 @@ import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertFalse;
 import static org.junit.Assert.assertNull;
 import static org.junit.Assert.assertSame;
+import static org.junit.Assert.assertThrows;
 import static org.junit.Assert.fail;
 import static org.mockito.ArgumentMatchers.any;
 import static org.mockito.Matchers.eq;
@@ -66,6 +67,8 @@ import org.apache.beam.sdk.transforms.reflect.testhelper.DoFnInvokersTestHelper;
 import org.apache.beam.sdk.transforms.splittabledofn.HasDefaultTracker;
 import org.apache.beam.sdk.transforms.splittabledofn.HasDefaultWatermarkEstimator;
 import org.apache.beam.sdk.transforms.splittabledofn.RestrictionTracker;
+import org.apache.beam.sdk.transforms.splittabledofn.RestrictionTracker.HasProgress;
+import org.apache.beam.sdk.transforms.splittabledofn.RestrictionTracker.Progress;
 import org.apache.beam.sdk.transforms.splittabledofn.RestrictionTracker.TruncateResult;
 import org.apache.beam.sdk.transforms.splittabledofn.SplitResult;
 import org.apache.beam.sdk.transforms.splittabledofn.WatermarkEstimator;
@@ -443,6 +446,11 @@ public class DoFnInvokersTest {
       return null;
     }
 
+    @GetSize
+    public double getSize() {
+      return 2.0;
+    }
+
     @GetRestrictionCoder
     public SomeRestrictionCoder getRestrictionCoder() {
       return null;
@@ -502,6 +510,7 @@ public class DoFnInvokersTest {
     when(fn.newTracker(restriction)).thenReturn(tracker);
     when(fn.newWatermarkEstimator(watermarkEstimatorState)).thenReturn(watermarkEstimator);
     when(fn.processElement(mockProcessContext, tracker, watermarkEstimator)).thenReturn(resume());
+    when(fn.getSize()).thenReturn(2.0);
 
     assertEquals(coder, invoker.invokeGetRestrictionCoder(CoderRegistry.createDefault()));
     assertEquals(
@@ -591,6 +600,7 @@ public class DoFnInvokersTest {
                 return watermarkEstimator;
               }
             }));
+    assertEquals(2.0, invoker.invokeGetSize(mockArgumentProvider), 0.0001);
   }
 
   private static class RestrictionWithBoundedDefaultTracker
@@ -989,6 +999,77 @@ public class DoFnInvokersTest {
     assertNull(invoker.invokeGetInitialWatermarkEstimatorState(new FakeArgumentProvider<>()));
   }
 
+  @Test
+  public void testDefaultGetSizeWithoutHasProgress() throws Exception {
+    class MockFn extends DoFn<String, String> {
+      @ProcessElement
+      public void processElement(
+          ProcessContext c,
+          RestrictionTracker<RestrictionWithBoundedDefaultTracker, Void> tracker) {}
+
+      @GetInitialRestriction
+      public RestrictionWithBoundedDefaultTracker getInitialRestriction(@Element String element) {
+        return null;
+      }
+    }
+
+    MockFn fn = mock(MockFn.class);
+    DoFnInvoker<String, String> invoker = DoFnInvokers.invokerFor(fn);
+    assertEquals(1.0, invoker.invokeGetSize(mockArgumentProvider), 0.0001);
+  }
+
+  @Test
+  public void testDefaultGetSizeWithHasProgress() throws Exception {
+    class MockFn extends DoFn<String, String> {
+      @ProcessElement
+      public void processElement(
+          ProcessContext c,
+          RestrictionTracker<RestrictionWithBoundedDefaultTracker, Void> tracker) {}
+
+      @GetInitialRestriction
+      public RestrictionWithBoundedDefaultTracker getInitialRestriction(@Element String element) {
+        return null;
+      }
+    }
+
+    abstract class HasProgressRestrictionTracker extends SomeRestrictionTracker
+        implements HasProgress {}
+    HasProgressRestrictionTracker tracker = mock(HasProgressRestrictionTracker.class);
+    when(tracker.getProgress()).thenReturn(Progress.from(3.0, 4.0));
+
+    when(mockArgumentProvider.restrictionTracker()).thenReturn((RestrictionTracker) tracker);
+
+    MockFn fn = mock(MockFn.class);
+    DoFnInvoker<String, String> invoker = DoFnInvokers.invokerFor(fn);
+    assertEquals(4.0, invoker.invokeGetSize(mockArgumentProvider), 0.0001);
+  }
+
+  @Test
+  public void testGetSize() throws Exception {
+    abstract class MockFn extends DoFn<String, String> {
+      @ProcessElement
+      public abstract void processElement(
+          ProcessContext c, RestrictionTracker<RestrictionWithBoundedDefaultTracker, Void> tracker);
+
+      @GetInitialRestriction
+      public abstract RestrictionWithBoundedDefaultTracker getInitialRestriction(
+          @Element String element);
+
+      @GetSize
+      public abstract double getSize();
+    }
+
+    MockFn fn = mock(MockFn.class);
+    when(fn.getSize()).thenReturn(5.0, -3.0);
+
+    DoFnInvoker<String, String> invoker = DoFnInvokers.invokerFor(fn);
+    assertEquals(5.0, invoker.invokeGetSize(mockArgumentProvider), 0.0001);
+    assertThrows(
+        "Expected size >= 0 but received",
+        IllegalArgumentException.class,
+        () -> invoker.invokeGetSize(mockArgumentProvider));
+  }
+
   // ---------------------------------------------------------------------------------------
   // Tests for ability to invoke @OnTimer for private, inner and anonymous classes.
   // ---------------------------------------------------------------------------------------
