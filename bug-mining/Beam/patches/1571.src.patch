diff --git a/sdks/python/apache_beam/typehints/trivial_inference.py b/sdks/python/apache_beam/typehints/trivial_inference.py
index c5502d04b44..8e4b14e6ef6 100644
--- a/sdks/python/apache_beam/typehints/trivial_inference.py
+++ b/sdks/python/apache_beam/typehints/trivial_inference.py
@@ -67,18 +67,27 @@ def instance_to_type(o):
   elif t == tuple:
     return typehints.Tuple[[instance_to_type(item) for item in o]]
   elif t == list:
-    return typehints.List[
-        typehints.Union[[instance_to_type(item) for item in o]]
-    ]
+    if len(o) > 0:
+      return typehints.List[
+          typehints.Union[[instance_to_type(item) for item in o]]
+      ]
+    else:
+      return typehints.List[typehints.Any]
   elif t == set:
-    return typehints.Set[
-        typehints.Union[[instance_to_type(item) for item in o]]
-    ]
+    if len(o) > 0:
+      return typehints.Set[
+          typehints.Union[[instance_to_type(item) for item in o]]
+      ]
+    else:
+      return typehints.Set[typehints.Any]
   elif t == dict:
-    return typehints.Dict[
-        typehints.Union[[instance_to_type(k) for k, v in o.items()]],
-        typehints.Union[[instance_to_type(v) for k, v in o.items()]],
-    ]
+    if len(o) > 0:
+      return typehints.Dict[
+          typehints.Union[[instance_to_type(k) for k, v in o.items()]],
+          typehints.Union[[instance_to_type(v) for k, v in o.items()]],
+      ]
+    else:
+      return typehints.Dict[typehints.Any, typehints.Any]
   else:
     raise TypeInferenceError('Unknown forbidden type: %s' % t)
 
diff --git a/sdks/python/apache_beam/typehints/trivial_inference_test.py b/sdks/python/apache_beam/typehints/trivial_inference_test.py
index 4fdca828198..f163520ea5c 100644
--- a/sdks/python/apache_beam/typehints/trivial_inference_test.py
+++ b/sdks/python/apache_beam/typehints/trivial_inference_test.py
@@ -22,6 +22,7 @@
 from __future__ import absolute_import
 
 import sys
+import types
 import unittest
 
 from apache_beam.typehints import trivial_inference
@@ -277,6 +278,35 @@ class TrivialInferenceTest(unittest.TestCase):
                           lambda x1, x2, _dict: fn(x1, x2, **_dict),
                           [str, float, typehints.List[int]])
 
+  def testInstanceToType(self):
+    class MyClass(object):
+      def method(self):
+        pass
+
+    test_cases = [
+        (typehints.Dict[str, int], {'a': 1}),
+        (typehints.Dict[str, typehints.Union[str, int]], {'a': 1, 'b': 'c'}),
+        (typehints.Dict[typehints.Any, typehints.Any], {}),
+        (typehints.Set[str], {'a'}),
+        (typehints.Set[typehints.Union[str, float]], {'a', 0.4}),
+        (typehints.Set[typehints.Any], set()),
+        (typehints.Tuple[int], (1, )),
+        (typehints.Tuple[int, int, str], (1, 2, '3')),
+        (typehints.Tuple[()], ()),
+        (typehints.List[int], [1]),
+        (typehints.List[typehints.Union[int, str]], [1, 'a']),
+        (typehints.List[typehints.Any], []),
+        (type(None), None),
+        (type(MyClass), MyClass),
+        (MyClass, MyClass()),
+        (type(MyClass.method), MyClass.method),
+        (types.MethodType, MyClass().method),
+    ]
+    for expected_type, instance in test_cases:
+      self.assertEqual(expected_type,
+                       trivial_inference.instance_to_type(instance),
+                       msg=instance)
+
 
 if __name__ == '__main__':
   unittest.main()
