diff --git a/CHANGES.md b/CHANGES.md
index 2bf5a6aa55d..0bd63d21eb5 100644
--- a/CHANGES.md
+++ b/CHANGES.md
@@ -99,6 +99,7 @@
 ## Known Issues
 
 * Fixed X (Java/Python) ([BEAM-X](https://issues.apache.org/jira/browse/BEAM-X)).
+* Fixed race condition in RabbitMqIO causing duplicate acks (Java) ([BEAM-6516](https://issues.apache.org/jira/browse/BEAM-6516)))
 
 # [2.31.0] - 2021-07-08
 
diff --git a/sdks/java/io/rabbitmq/src/main/java/org/apache/beam/sdk/io/rabbitmq/RabbitMqIO.java b/sdks/java/io/rabbitmq/src/main/java/org/apache/beam/sdk/io/rabbitmq/RabbitMqIO.java
index 8aed86e7b81..73d483223ab 100644
--- a/sdks/java/io/rabbitmq/src/main/java/org/apache/beam/sdk/io/rabbitmq/RabbitMqIO.java
+++ b/sdks/java/io/rabbitmq/src/main/java/org/apache/beam/sdk/io/rabbitmq/RabbitMqIO.java
@@ -35,6 +35,7 @@ import java.util.ArrayList;
 import java.util.Date;
 import java.util.List;
 import java.util.NoSuchElementException;
+import java.util.concurrent.ConcurrentLinkedQueue;
 import java.util.concurrent.TimeoutException;
 import org.apache.beam.sdk.annotations.Experimental;
 import org.apache.beam.sdk.annotations.Experimental.Kind;
@@ -416,7 +417,14 @@ public class RabbitMqIO {
       implements UnboundedSource.CheckpointMark, Serializable {
     transient Channel channel;
     Instant latestTimestamp = Instant.now();
-    final List<Long> sessionIds = new ArrayList<>();
+    transient ConcurrentLinkedQueue<Long> sessionIds = new ConcurrentLinkedQueue<>();
+
+    // this method is called after deserialization on the deserialized object
+    private Object readResolve() {
+      // (re-)initialize transient fields as required
+      this.sessionIds = new ConcurrentLinkedQueue<>();
+      return this;
+    }
 
     /**
      * Advances the watermark to the provided time, provided said time is after the current
@@ -432,12 +440,13 @@ public class RabbitMqIO {
 
     @Override
     public void finalizeCheckpoint() throws IOException {
-      for (Long sessionId : sessionIds) {
+      Long sessionId = sessionIds.poll();
+      while (sessionId != null) {
         channel.basicAck(sessionId, false);
+        sessionId = sessionIds.poll();
       }
       channel.txCommit();
       latestTimestamp = Instant.now();
-      sessionIds.clear();
     }
   }
 
