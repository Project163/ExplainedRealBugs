diff --git a/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkStreamingPortablePipelineTranslator.java b/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkStreamingPortablePipelineTranslator.java
index 2b276f404c7..d228963237c 100644
--- a/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkStreamingPortablePipelineTranslator.java
+++ b/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkStreamingPortablePipelineTranslator.java
@@ -426,10 +426,13 @@ public class FlinkStreamingPortablePipelineTranslator
       String id, RunnerApi.Pipeline pipeline, StreamingTranslationContext context) {
     RunnerApi.PTransform pTransform = pipeline.getComponents().getTransformsOrThrow(id);
 
-    ObjectMapper objectMapper = new ObjectMapper();
+    TypeInformation<WindowedValue<byte[]>> typeInfo =
+        new CoderTypeInformation<>(
+            WindowedValue.getFullCoder(ByteArrayCoder.of(), GlobalWindow.Coder.INSTANCE));
 
-    int intervalMillis;
-    int messageCount;
+    ObjectMapper objectMapper = new ObjectMapper();
+    final int intervalMillis;
+    final int messageCount;
     try {
       JsonNode config = objectMapper.readTree(pTransform.getSpec().getPayload().toByteArray());
       intervalMillis = config.path("interval_ms").asInt(100);
@@ -438,10 +441,11 @@ public class FlinkStreamingPortablePipelineTranslator
       throw new RuntimeException("Failed to parse configuration for streaming impulse", e);
     }
 
-    DataStreamSource<WindowedValue<byte[]>> source =
+    SingleOutputStreamOperator<WindowedValue<byte[]>> source =
         context
             .getExecutionEnvironment()
-            .addSource(new StreamingImpulseSource(intervalMillis, messageCount));
+            .addSource(new StreamingImpulseSource(intervalMillis, messageCount))
+            .returns(typeInfo);
 
     context.addDataStream(Iterables.getOnlyElement(pTransform.getOutputsMap().values()), source);
   }
diff --git a/runners/flink/src/main/java/org/apache/beam/runners/flink/translation/wrappers/streaming/io/StreamingImpulseSource.java b/runners/flink/src/main/java/org/apache/beam/runners/flink/translation/wrappers/streaming/io/StreamingImpulseSource.java
index b27a36924b0..89d8f78e852 100644
--- a/runners/flink/src/main/java/org/apache/beam/runners/flink/translation/wrappers/streaming/io/StreamingImpulseSource.java
+++ b/runners/flink/src/main/java/org/apache/beam/runners/flink/translation/wrappers/streaming/io/StreamingImpulseSource.java
@@ -59,7 +59,9 @@ public class StreamingImpulseSource extends RichParallelSourceFunction<WindowedV
       }
 
       try {
-        Thread.sleep(intervalMillis);
+        if (intervalMillis > 0) {
+          Thread.sleep(intervalMillis);
+        }
       } catch (InterruptedException e) {
         LOG.warn("Interrupted while sleeping", e);
       }
