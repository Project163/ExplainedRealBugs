diff --git a/runners/google-cloud-dataflow-java/worker/build.gradle b/runners/google-cloud-dataflow-java/worker/build.gradle
index c8e2795b50f..70b587a0909 100644
--- a/runners/google-cloud-dataflow-java/worker/build.gradle
+++ b/runners/google-cloud-dataflow-java/worker/build.gradle
@@ -26,39 +26,9 @@ def DATAFLOW_VERSION = "dataflow.version"
 // Get full dependency of 'com.google.apis:google-api-services-dataflow'
 def google_api_services_dataflow = project.hasProperty(DATAFLOW_VERSION) ? "com.google.apis:google-api-services-dataflow:" + getProperty(DATAFLOW_VERSION) : library.java.google_api_services_dataflow
 
-// Returns a string representing the relocated path to be used with the shadow
-// plugin when given a suffix such as "com.".
-def getWorkerRelocatedPath = { String suffix ->
-  return ("org.apache.beam.runners.dataflow.worker.repackaged."
-          + suffix)
-}
-
-// Following listed dependencies will be shaded only in fnapi worker, not legacy
-// worker
-def sdk_provided_dependencies = [
-  google_api_services_dataflow,
-  library.java.avro,
-  library.java.google_api_client,
-  library.java.google_http_client,
-  library.java.google_http_client_jackson,
-  library.java.jackson_annotations,
-  library.java.jackson_core,
-  library.java.jackson_databind,
-  library.java.joda_time,
-]
-
-def sdk_provided_project_dependencies = [
-  ":beam-runners-google-cloud-dataflow-java",
-  ":beam-sdks-java-core",
-  ":beam-sdks-java-extensions-google-cloud-platform-core",
-  ":beam-sdks-java-io-google-cloud-platform",
-]
-
-applyJavaNature(publish: false, enableFindbugs: false /* TODO(BEAM-5658): enable findbugs */, validateShadowJar: false, shadowClosure: DEFAULT_SHADOW_CLOSURE << {
-  dependencies {
-    include(project(path: ":beam-runners-google-cloud-dataflow-java-windmill", configuration: "shadow"))
-    include(dependency(".*:.*"))
-  }
+applyJavaNature(publish: false, enableFindbugs: false /* TODO(BEAM-5658): enable findbugs */, validateShadowJar: false, shadowClosure: {
+  // In the case of the Fn API worker jar we are creating an application so we rely on
+  // the shadow plugin to include all transitive dependencies to create an uber jar.
 
   // Include original source files extracted under
   // '$buildDir/original_sources_to_package' to jar
@@ -81,34 +51,33 @@ configurations {
   }
 }
 
-def common_compile_project_dependencies = [
-    ":beam-model-fn-execution",
-    ":beam-model-pipeline",
-    ":beam-runners-core-construction-java",
-    ":beam-runners-core-java",
-    ":beam-runners-java-fn-execution",
-    ":beam-sdks-java-fn-execution",
-    ":beam-runners-google-cloud-dataflow-java-windmill",
-]
-
-def common_test_compile_project_dependencies = [
-    ":beam-runners-core-java",
-    ":beam-sdks-java-core",
-    ":beam-sdks-java-extensions-google-cloud-platform-core",
-]
-
 dependencies {
-    sdk_provided_dependencies.each {
-      shadow(it)
-    }
-    sdk_provided_project_dependencies.each {
-      shadow project(path: it, configuration: "shadow")
-    }
-
-  common_compile_project_dependencies.each {
-    compile project(path: it, configuration: "shadow")
-  }
-
+  // Note that any dependency that is modified here should also be modified within
+  // runners/google-cloud-dataflow-java/worker/legacy-worker/build.gradle using the rules provided
+  // there.
+  //
+  // All main sourceset dependencies here should be listed as compile scope so that the dependencies
+  // are all packaged into a single uber jar allowing the jar to serve as an application.
+  compile project(path: ":beam-runners-google-cloud-dataflow-java", configuration: "shadow")
+  compile project(path: ":beam-sdks-java-core", configuration: "shadow")
+  compile project(path: ":beam-sdks-java-extensions-google-cloud-platform-core", configuration: "shadow")
+  compile project(path: ":beam-sdks-java-io-google-cloud-platform", configuration: "shadow")
+  compile project(path: ":beam-model-fn-execution", configuration: "shadow")
+  compile project(path: ":beam-model-pipeline", configuration: "shadow")
+  compile project(path: ":beam-runners-core-construction-java", configuration: "shadow")
+  compile project(path: ":beam-runners-core-java", configuration: "shadow")
+  compile project(path: ":beam-runners-java-fn-execution", configuration: "shadow")
+  compile project(path: ":beam-sdks-java-fn-execution", configuration: "shadow")
+  compile project(path: ":beam-runners-google-cloud-dataflow-java-windmill", configuration: "shadow")
+  compile google_api_services_dataflow
+  compile library.java.avro
+  compile library.java.google_api_client
+  compile library.java.google_http_client
+  compile library.java.google_http_client_jackson
+  compile library.java.jackson_annotations
+  compile library.java.jackson_core
+  compile library.java.jackson_databind
+  compile library.java.joda_time
   compile library.java.guava
   compile library.java.slf4j_api
   compile library.java.vendored_grpc_1_13_1
@@ -116,22 +85,20 @@ dependencies {
   compile "org.conscrypt:conscrypt-openjdk:1.1.3:linux-x86_64"
   compile "org.eclipse.jetty:jetty-server:9.2.10.v20150310"
   compile "org.eclipse.jetty:jetty-servlet:9.2.10.v20150310"
-
-  provided library.java.error_prone_annotations
-
-  runtime library.java.slf4j_jdk14
-
-  common_test_compile_project_dependencies.each {
-    testCompile project(path: it, configuration: "shadowTest")
-  }
-
-  testCompile project(path: ":beam-runners-direct-java", configuration: "shadow")
-
-  testCompile library.java.guava_testlib
-  testCompile library.java.hamcrest_core
-  testCompile library.java.hamcrest_library
-  testCompile library.java.junit
-  testCompile library.java.mockito_core
+  compile library.java.error_prone_annotations
+  compile library.java.slf4j_jdk14
+
+  // All test sourceset dependencies can be marked as shadowTest since we create an uber jar without
+  // relocating any code.
+  shadowTest project(path: ":beam-runners-core-java", configuration: "shadowTest")
+  shadowTest project(path: ":beam-sdks-java-core", configuration: "shadowTest")
+  shadowTest project(path: ":beam-sdks-java-extensions-google-cloud-platform-core", configuration: "shadowTest")
+  shadowTest project(path: ":beam-runners-direct-java", configuration: "shadow")
+  shadowTest library.java.guava_testlib
+  shadowTest library.java.hamcrest_core
+  shadowTest library.java.hamcrest_library
+  shadowTest library.java.junit
+  shadowTest library.java.mockito_core
 }
 
 //TODO(BEAM-5657): checktyle task should be enabled in the future.
diff --git a/runners/google-cloud-dataflow-java/worker/legacy-worker/build.gradle b/runners/google-cloud-dataflow-java/worker/legacy-worker/build.gradle
index 8055876124e..d88bec1f96d 100644
--- a/runners/google-cloud-dataflow-java/worker/legacy-worker/build.gradle
+++ b/runners/google-cloud-dataflow-java/worker/legacy-worker/build.gradle
@@ -52,9 +52,12 @@ def sdk_provided_dependencies = [
         library.java.jackson_core,
         library.java.jackson_databind,
         library.java.joda_time,
+        library.java.slf4j_api,
+        library.java.vendored_grpc_1_13_1,
 ]
 
 def sdk_provided_project_dependencies = [
+        ":beam-model-pipeline",
         ":beam-runners-google-cloud-dataflow-java",
         ":beam-sdks-java-core",
         ":beam-sdks-java-extensions-google-cloud-platform-core",
@@ -84,7 +87,7 @@ applyJavaNature(publish: false, enableFindbugs: false /* TODO(BEAM-5658): enable
             exclude(dependency(it))
         }
         sdk_provided_project_dependencies.each {
-            exclude(project(path: it))
+            exclude(project(path: it, configuration: "shadow"))
         }
         excluded_dependencies.each {
             exclude(dependency(it))
@@ -148,22 +151,6 @@ configurations {
     }
 }
 
-def common_compile_project_dependencies = [
-        ":beam-model-fn-execution",
-        ":beam-model-pipeline",
-        ":beam-runners-core-construction-java",
-        ":beam-runners-core-java",
-        ":beam-runners-java-fn-execution",
-        ":beam-sdks-java-fn-execution",
-        ":beam-runners-google-cloud-dataflow-java-windmill",
-]
-
-def common_test_compile_project_dependencies = [
-        ":beam-runners-core-java",
-        ":beam-sdks-java-core",
-        ":beam-sdks-java-extensions-google-cloud-platform-core",
-]
-
 evaluationDependsOn(":beam-runners-google-cloud-dataflow-java-fn-api-worker")
 
 compileJava {
@@ -175,6 +162,9 @@ compileTestJava {
 }
 
 dependencies {
+    // Note that any dependency that is modified here should also be modified within
+    // runners/google-cloud-dataflow-java/worker/build.gradle using the rules provided
+    // there.
     sdk_provided_dependencies.each {
         provided(it)
     }
@@ -182,33 +172,32 @@ dependencies {
         provided project(path: it, configuration: "shadow")
     }
 
-    common_compile_project_dependencies.each {
-        compile project(path: it, configuration: "shadow")
-    }
-
+    compile project(path: ":beam-model-fn-execution", configuration: "shadow")
+    compile project(path: ":beam-runners-core-construction-java", configuration: "shadow")
+    compile project(path: ":beam-runners-core-java", configuration: "shadow")
+    compile project(path: ":beam-runners-java-fn-execution", configuration: "shadow")
+    compile project(path: ":beam-sdks-java-fn-execution", configuration: "shadow")
+    compile project(path: ":beam-runners-google-cloud-dataflow-java-windmill", configuration: "shadow")
     compile library.java.guava
-    compile library.java.slf4j_api
-    compile library.java.vendored_grpc_1_13_1
     compile "javax.servlet:javax.servlet-api:3.1.0"
     compile "org.conscrypt:conscrypt-openjdk:1.1.3:linux-x86_64"
     compile "org.eclipse.jetty:jetty-server:9.2.10.v20150310"
     compile "org.eclipse.jetty:jetty-servlet:9.2.10.v20150310"
-
     provided library.java.error_prone_annotations
-
     runtime library.java.slf4j_jdk14
 
-    common_test_compile_project_dependencies.each {
-        testCompile project(path: it, configuration: "shadowTest")
-    }
-
-    testCompile project(path: ":beam-runners-direct-java", configuration: "shadow")
-
-    testCompile library.java.guava_testlib
-    testCompile library.java.hamcrest_core
-    testCompile library.java.hamcrest_library
-    testCompile library.java.junit
-    testCompile library.java.mockito_core
+    // Any test dependency which intersects with our relocation rules above needs to be relocated
+    // as well and placed within the testCompile configuration. Otherwise we can place it within
+    // the shadowTest configuration.
+    testCompile project(path: ":beam-runners-core-java", configuration: "shadowTest")
+    shadowTest library.java.guava_testlib
+    shadowTest project(path: ":beam-sdks-java-extensions-google-cloud-platform-core", configuration: "shadowTest")
+    shadowTest project(path: ":beam-runners-direct-java", configuration: "shadow")
+    shadowTest project(path: ":beam-sdks-java-core", configuration: "shadowTest")
+    shadowTest library.java.hamcrest_core
+    shadowTest library.java.hamcrest_library
+    shadowTest library.java.junit
+    shadowTest library.java.mockito_core
 }
 
 //TODO(BEAM-5657): checktyle task should be enabled in the future.
