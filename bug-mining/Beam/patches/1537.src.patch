diff --git a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/resources/ClasspathScanningResourcesDetector.java b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/resources/ClasspathScanningResourcesDetector.java
index 4cdf60b0c6b..889e584bb95 100644
--- a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/resources/ClasspathScanningResourcesDetector.java
+++ b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/resources/ClasspathScanningResourcesDetector.java
@@ -20,7 +20,7 @@ package org.apache.beam.runners.core.construction.resources;
 import io.github.classgraph.ClassGraph;
 import java.io.File;
 import java.util.List;
-import java.util.stream.Stream;
+import java.util.stream.Collectors;
 
 /**
  * Attempts to detect all the resources to be staged using classgraph library.
@@ -43,9 +43,9 @@ public class ClasspathScanningResourcesDetector implements PipelineResourcesDete
    * @return A list of absolute paths to the resources the class loader uses.
    */
   @Override
-  public Stream<String> detect(ClassLoader classLoader) {
+  public List<String> detect(ClassLoader classLoader) {
     List<File> classpathContents = classGraph.addClassLoader(classLoader).getClasspathFiles();
 
-    return classpathContents.stream().map(File::getAbsolutePath);
+    return classpathContents.stream().map(File::getAbsolutePath).collect(Collectors.toList());
   }
 }
diff --git a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/resources/PipelineResources.java b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/resources/PipelineResources.java
index c3ecde4fef1..dda68f10d81 100644
--- a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/resources/PipelineResources.java
+++ b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/resources/PipelineResources.java
@@ -50,11 +50,10 @@ public class PipelineResources {
       ClassLoader classLoader, PipelineOptions options) {
 
     PipelineResourcesOptions artifactsRelatedOptions = options.as(PipelineResourcesOptions.class);
-    return artifactsRelatedOptions
-        .getPipelineResourcesDetector()
-        .detect(classLoader)
-        .filter(isStageable())
-        .collect(Collectors.toList());
+    List<String> detectedResources =
+        artifactsRelatedOptions.getPipelineResourcesDetector().detect(classLoader);
+
+    return detectedResources.stream().filter(isStageable()).collect(Collectors.toList());
   }
 
   /**
diff --git a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/resources/PipelineResourcesDetector.java b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/resources/PipelineResourcesDetector.java
index f069970a9bc..103c694d2d3 100644
--- a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/resources/PipelineResourcesDetector.java
+++ b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/resources/PipelineResourcesDetector.java
@@ -18,12 +18,12 @@
 package org.apache.beam.runners.core.construction.resources;
 
 import java.io.Serializable;
-import java.util.stream.Stream;
+import java.util.List;
 
 /** Interface for an algorithm detecting classpath resources for pipelines. */
 public interface PipelineResourcesDetector extends Serializable {
 
-  Stream<String> detect(ClassLoader classLoader);
+  List<String> detect(ClassLoader classLoader);
 
   /** Provides pipeline resources detection algorithm. */
   interface Factory {
diff --git a/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/resources/ClasspathScanningResourcesDetectorTest.java b/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/resources/ClasspathScanningResourcesDetectorTest.java
index 63cea677687..5acba22fd30 100644
--- a/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/resources/ClasspathScanningResourcesDetectorTest.java
+++ b/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/resources/ClasspathScanningResourcesDetectorTest.java
@@ -33,7 +33,6 @@ import java.net.URLClassLoader;
 import java.util.List;
 import java.util.jar.JarOutputStream;
 import java.util.jar.Manifest;
-import java.util.stream.Collectors;
 import org.apache.beam.sdk.testing.RestoreSystemProperties;
 import org.junit.Before;
 import org.junit.Rule;
@@ -61,7 +60,7 @@ public class ClasspathScanningResourcesDetectorTest {
     File folder = tmpFolder.newFolder("folder1");
     classLoader = new URLClassLoader(new URL[] {folder.toURI().toURL()});
 
-    List<String> result = detector.detect(classLoader).collect(Collectors.toList());
+    List<String> result = detector.detect(classLoader);
 
     assertThat(result, hasItem(containsString(folder.getAbsolutePath())));
   }
@@ -71,7 +70,7 @@ public class ClasspathScanningResourcesDetectorTest {
     File jarFile = createTestTmpJarFile("test");
     classLoader = new URLClassLoader(new URL[] {jarFile.toURI().toURL()});
 
-    List<String> result = detector.detect(classLoader).collect(Collectors.toList());
+    List<String> result = detector.detect(classLoader);
 
     assertThat(result, hasItem(containsString(jarFile.getAbsolutePath())));
   }
@@ -87,7 +86,7 @@ public class ClasspathScanningResourcesDetectorTest {
     File textFile = tmpFolder.newFile("ordinaryTextFile.txt");
     classLoader = new URLClassLoader(new URL[] {textFile.toURI().toURL()});
 
-    List<String> result = detector.detect(classLoader).collect(Collectors.toList());
+    List<String> result = detector.detect(classLoader);
 
     assertThat(result, not(hasItem(containsString(textFile.getAbsolutePath()))));
   }
@@ -97,7 +96,7 @@ public class ClasspathScanningResourcesDetectorTest {
     String path = tmpFolder.newFolder("folder").getAbsolutePath();
     System.setProperty("java.class.path", path);
 
-    List<String> resources = detector.detect(null).collect(Collectors.toList());
+    List<String> resources = detector.detect(null);
 
     assertThat(resources, hasItems(containsString(path)));
   }
@@ -107,7 +106,7 @@ public class ClasspathScanningResourcesDetectorTest {
     String url = "http://www.google.com/all-the-secrets.jar";
     classLoader = new URLClassLoader(new URL[] {new URL(url)});
 
-    List<String> result = detector.detect(classLoader).collect(Collectors.toList());
+    List<String> result = detector.detect(classLoader);
 
     assertThat(result, not(hasItem(containsString(url))));
   }
@@ -121,8 +120,7 @@ public class ClasspathScanningResourcesDetectorTest {
   public void shouldStillDetectResourcesEvenIfClassloaderIsUseless() {
     ClassLoader uselessClassLoader = Mockito.mock(ClassLoader.class);
 
-    List<String> detectedResources =
-        detector.detect(uselessClassLoader).collect(Collectors.toList());
+    List<String> detectedResources = detector.detect(uselessClassLoader);
 
     assertFalse(detectedResources.isEmpty());
   }
