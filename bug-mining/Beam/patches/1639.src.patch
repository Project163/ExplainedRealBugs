diff --git a/sdks/python/apache_beam/runners/direct/consumer_tracking_pipeline_visitor.py b/sdks/python/apache_beam/runners/direct/consumer_tracking_pipeline_visitor.py
index 2dba02a0087..acf48d83117 100644
--- a/sdks/python/apache_beam/runners/direct/consumer_tracking_pipeline_visitor.py
+++ b/sdks/python/apache_beam/runners/direct/consumer_tracking_pipeline_visitor.py
@@ -46,10 +46,19 @@ class ConsumerTrackingPipelineVisitor(PipelineVisitor):
     self.value_to_consumers = {
     }  # type: Dict[pvalue.PValue, List[AppliedPTransform]]
     self.root_transforms = set()  # type: Set[AppliedPTransform]
-    self.views = []  # type: List[pvalue.AsSideInput]
     self.step_names = {}  # type: Dict[AppliedPTransform, str]
 
     self._num_transforms = 0
+    self._views = set()
+
+  @property
+  def views(self):
+    """Returns a list of side intputs extracted from the graph.
+
+    Returns:
+      A list of pvalue.AsSideInput.
+    """
+    return list(self._views)
 
   def visit_transform(self, applied_ptransform):
     # type: (AppliedPTransform) -> None
@@ -65,5 +74,6 @@ class ConsumerTrackingPipelineVisitor(PipelineVisitor):
       self.root_transforms.add(applied_ptransform)
     self.step_names[applied_ptransform] = 's%d' % (self._num_transforms)
     self._num_transforms += 1
+
     for side_input in applied_ptransform.side_inputs:
-      self.views.append(side_input)
+      self._views.add(side_input)
diff --git a/sdks/python/apache_beam/runners/direct/consumer_tracking_pipeline_visitor_test.py b/sdks/python/apache_beam/runners/direct/consumer_tracking_pipeline_visitor_test.py
index a3f193d8a44..aebf4527b0e 100644
--- a/sdks/python/apache_beam/runners/direct/consumer_tracking_pipeline_visitor_test.py
+++ b/sdks/python/apache_beam/runners/direct/consumer_tracking_pipeline_visitor_test.py
@@ -83,6 +83,19 @@ class ConsumerTrackingPipelineVisitorTest(unittest.TestCase):
       def process(self, element, negatives):
         yield element
 
+    def _process_numbers(pcoll, negatives):
+      first_output = (
+          pcoll
+          | 'process numbers step 1' >> ParDo(ProcessNumbersFn(), negatives))
+
+      second_output = (
+          first_output
+          | 'process numbers step 2' >> ParDo(ProcessNumbersFn(), negatives))
+
+      output_pc = ((first_output, second_output)
+                   | 'flatten results' >> beam.Flatten())
+      return output_pc
+
     root_read = beam.Impulse()
 
     result = (
@@ -90,13 +103,13 @@ class ConsumerTrackingPipelineVisitorTest(unittest.TestCase):
         | 'read' >> root_read
         | ParDo(SplitNumbersFn()).with_outputs('tag_negative', main='positive'))
     positive, negative = result
-    positive | ParDo(ProcessNumbersFn(), AsList(negative))
+    _process_numbers(positive, AsList(negative))
 
     self.pipeline.visit(self.visitor)
 
     root_transforms = [t.transform for t in self.visitor.root_transforms]
     self.assertEqual(root_transforms, [root_read])
-    self.assertEqual(len(self.visitor.step_names), 3)
+    self.assertEqual(len(self.visitor.step_names), 5)
     self.assertEqual(len(self.visitor.views), 1)
     self.assertTrue(isinstance(self.visitor.views[0], pvalue.AsList))
 
