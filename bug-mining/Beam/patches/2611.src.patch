diff --git a/sdks/go/pkg/beam/core/metrics/metrics.go b/sdks/go/pkg/beam/core/metrics/metrics.go
index 0598c7ee933..de88d8bdd39 100644
--- a/sdks/go/pkg/beam/core/metrics/metrics.go
+++ b/sdks/go/pkg/beam/core/metrics/metrics.go
@@ -136,9 +136,11 @@ func SetPTransformID(ctx context.Context, id string) context.Context {
 	// Checking for *beamCtx is an optimization, so we don't dig deeply
 	// for ids if not necessary.
 	if bctx, ok := ctx.(*beamCtx); ok {
+		bctx.store.mu.Lock()
 		if _, ok := bctx.store.stateRegistry[id]; !ok {
 			bctx.store.stateRegistry[id] = &[4]ExecutionState{}
 		}
+		bctx.store.mu.Unlock()
 		return &beamCtx{Context: bctx.Context, bundleID: bctx.bundleID, store: bctx.store, ptransformID: id}
 	}
 	// Avoid breaking if the bundle is unset in testing.
diff --git a/sdks/go/pkg/beam/core/metrics/sampler_test.go b/sdks/go/pkg/beam/core/metrics/sampler_test.go
index ccff388f924..49f4f658fad 100644
--- a/sdks/go/pkg/beam/core/metrics/sampler_test.go
+++ b/sdks/go/pkg/beam/core/metrics/sampler_test.go
@@ -140,7 +140,7 @@ func TestSampler_TwoPTransforms(t *testing.T) {
 // goarch: amd64
 // pkg: github.com/apache/beam/sdks/v2/go/pkg/beam/core/metrics
 // cpu: Intel(R) Core(TM) i7-9750H CPU @ 2.60GHz
-// BenchmarkMsec_SetPTransformState-12    	73519825	        16.52 ns/op	       0 B/op	       0 allocs/op
+// BenchmarkMsec_SetPTransformState-12    	77735638	        15.36 ns/op	       0 B/op	       0 allocs/op
 func BenchmarkMsec_SetPTransformState(b *testing.B) {
 	ctx := context.Background()
 	bctx := SetBundleID(ctx, "benchmark")
@@ -156,7 +156,7 @@ func BenchmarkMsec_SetPTransformState(b *testing.B) {
 // goarch: amd64
 // pkg: github.com/apache/beam/sdks/v2/go/pkg/beam/core/metrics
 // cpu: Intel(R) Core(TM) i7-9750H CPU @ 2.60GHz
-// BenchmarkMsec_Sample-12    	39142482	        29.60 ns/op	       0 B/op	       0 allocs/op
+// BenchmarkMsec_Sample-12    	37351743	        30.41 ns/op	       0 B/op	       0 allocs/op
 func BenchmarkMsec_Sample(b *testing.B) {
 	ctx := context.Background()
 	bctx := SetBundleID(ctx, "benchmark")
@@ -176,7 +176,7 @@ func BenchmarkMsec_Sample(b *testing.B) {
 // goarch: amd64
 // pkg: github.com/apache/beam/sdks/v2/go/pkg/beam/core/metrics
 // cpu: Intel(R) Core(TM) i7-9750H CPU @ 2.60GHz
-// BenchmarkMsec_Combined-12    	28194320	        35.86 ns/op	       0 B/op	       0 allocs/op
+// BenchmarkMsec_Combined-12    	27496028	        38.26 ns/op	       0 B/op	       0 allocs/op
 func BenchmarkMsec_Combined(b *testing.B) {
 	ctx := context.Background()
 	bctx := SetBundleID(ctx, "benchmark")
