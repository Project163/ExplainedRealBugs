diff --git a/sdks/go/pkg/beam/core/runtime/exec/pardo.go b/sdks/go/pkg/beam/core/runtime/exec/pardo.go
index 5e8421f882e..9c38a635e6d 100644
--- a/sdks/go/pkg/beam/core/runtime/exec/pardo.go
+++ b/sdks/go/pkg/beam/core/runtime/exec/pardo.go
@@ -109,7 +109,7 @@ func (n *ParDo) ProcessElement(ctx context.Context, elm FullValue, values ...ReS
 
 		// Forward direct output, if any. It is always a main output.
 		if val != nil {
-			return n.Out[0].ProcessElement(ctx, *val, values...)
+			return n.Out[0].ProcessElement(ctx, *val)
 		}
 	} else {
 		for _, w := range elm.Windows {
@@ -122,7 +122,7 @@ func (n *ParDo) ProcessElement(ctx context.Context, elm FullValue, values ...ReS
 
 			// Forward direct output, if any. It is always a main output.
 			if val != nil {
-				return n.Out[0].ProcessElement(ctx, *val, values...)
+				return n.Out[0].ProcessElement(ctx, *val)
 			}
 		}
 	}
diff --git a/sdks/go/pkg/beam/io/datastoreio/datastore.go b/sdks/go/pkg/beam/io/datastoreio/datastore.go
index 5216219e908..796b0148ae2 100644
--- a/sdks/go/pkg/beam/io/datastoreio/datastore.go
+++ b/sdks/go/pkg/beam/io/datastoreio/datastore.go
@@ -96,7 +96,7 @@ func (s *splitQueryFn) ProcessElement(ctx context.Context, _ []byte, emit func(k
 	defer client.Close()
 
 	splits := []*datastore.Key{}
-	iter := client.Run(ctx, datastore.NewQuery(s.Kind).Order(scatterPropertyName).Limit((s.Shards - 1) * 32).KeysOnly())
+	iter := client.Run(ctx, datastore.NewQuery(s.Kind).Order(scatterPropertyName).Limit((s.Shards-1)*32).KeysOnly())
 	for {
 		k, err := iter.Next(nil)
 		if err != nil {
diff --git a/sdks/go/pkg/beam/io/datastoreio/datastore_test.go b/sdks/go/pkg/beam/io/datastoreio/datastore_test.go
index e22f18f24a2..2b085418f16 100644
--- a/sdks/go/pkg/beam/io/datastoreio/datastore_test.go
+++ b/sdks/go/pkg/beam/io/datastoreio/datastore_test.go
@@ -17,6 +17,7 @@ package datastoreio
 
 import (
 	"testing"
+
 	"cloud.google.com/go/datastore"
 )
 
@@ -95,4 +96,4 @@ func Test_flatten(t *testing.T) {
 	if !(r[1].Kind == "A" && r[1].Name == "a") {
 		t.Errorf("Expected A.a in second position")
 	}
-}
\ No newline at end of file
+}
diff --git a/sdks/go/test/regression/pardo.go b/sdks/go/test/regression/pardo.go
new file mode 100644
index 00000000000..5ec1ef22991
--- /dev/null
+++ b/sdks/go/test/regression/pardo.go
@@ -0,0 +1,66 @@
+// Licensed to the Apache Software Foundation (ASF) under one or more
+// contributor license agreements.  See the NOTICE file distributed with
+// this work for additional information regarding copyright ownership.
+// The ASF licenses this file to You under the Apache License, Version 2.0
+// (the "License"); you may not use this file except in compliance with
+// the License.  You may obtain a copy of the License at
+//
+//    http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+
+// Package regression contains pipeline regression tests.
+package regression
+
+import (
+	"github.com/apache/beam/sdks/go/pkg/beam"
+	"github.com/apache/beam/sdks/go/pkg/beam/testing/passert"
+	"github.com/apache/beam/sdks/go/pkg/beam/testing/ptest"
+)
+
+func directCountFn(_ int, values func(*int) bool) (int, error) {
+	sum := 0
+	var i int
+	for values(&i) {
+		sum += i
+	}
+	return sum, nil
+}
+
+func emitCountFn(_ int, values func(*int) bool, emit func(int)) error {
+	sum := 0
+	var i int
+	for values(&i) {
+		sum += i
+	}
+	emit(sum)
+	return nil
+}
+
+// DirectParDoAfterGBK generates a pipeline with a direct-form
+// ParDo after a GBK. See: BEAM-3978 and BEAM-4175.
+func DirectParDoAfterGBK() *beam.Pipeline {
+	p, s, col := ptest.Create([]interface{}{1, 2, 3, 4})
+
+	keyed := beam.GroupByKey(s, beam.AddFixedKey(s, col))
+	sum := beam.ParDo(s, directCountFn, keyed)
+	passert.Equals(s, beam.DropKey(s, beam.AddFixedKey(s, sum)), 10)
+
+	return p
+}
+
+// EmitParDoAfterGBK generates a pipeline with a emit-form
+// ParDo after a GBK. See: BEAM-3978 and BEAM-4175.
+func EmitParDoAfterGBK() *beam.Pipeline {
+	p, s, col := ptest.Create([]interface{}{1, 2, 3, 4})
+
+	keyed := beam.GroupByKey(s, beam.AddFixedKey(s, col))
+	sum := beam.ParDo(s, emitCountFn, keyed)
+	passert.Equals(s, beam.DropKey(s, beam.AddFixedKey(s, sum)), 10)
+
+	return p
+}
diff --git a/sdks/go/test/regression/pardo_test.go b/sdks/go/test/regression/pardo_test.go
new file mode 100644
index 00000000000..423eb6e77ed
--- /dev/null
+++ b/sdks/go/test/regression/pardo_test.go
@@ -0,0 +1,34 @@
+// Licensed to the Apache Software Foundation (ASF) under one or more
+// contributor license agreements.  See the NOTICE file distributed with
+// this work for additional information regarding copyright ownership.
+// The ASF licenses this file to You under the Apache License, Version 2.0
+// (the "License"); you may not use this file except in compliance with
+// the License.  You may obtain a copy of the License at
+//
+//    http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+
+package regression
+
+import (
+	"testing"
+
+	"github.com/apache/beam/sdks/go/pkg/beam/testing/ptest"
+)
+
+func TestDirectParDoAfterGBK(t *testing.T) {
+	if err := ptest.Run(DirectParDoAfterGBK()); err != nil {
+		t.Error(err)
+	}
+}
+
+func TestEmitParDoAfterGBK(t *testing.T) {
+	if err := ptest.Run(EmitParDoAfterGBK()); err != nil {
+		t.Error(err)
+	}
+}
