diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricFiltering.java b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/metrics/MetricFiltering.java
similarity index 95%
rename from sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricFiltering.java
rename to runners/core-construction-java/src/main/java/org/apache/beam/runners/core/metrics/MetricFiltering.java
index a3e43e16a01..d469d2054f5 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricFiltering.java
+++ b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/metrics/MetricFiltering.java
@@ -16,10 +16,13 @@
  * limitations under the License.
  */
 
-package org.apache.beam.sdk.metrics;
+package org.apache.beam.runners.core.metrics;
 
 import com.google.common.base.Objects;
 import java.util.Set;
+import org.apache.beam.sdk.metrics.MetricName;
+import org.apache.beam.sdk.metrics.MetricNameFilter;
+import org.apache.beam.sdk.metrics.MetricsFilter;
 
 /**
  * Implements matching for metrics filters. Specifically, matching for metric name,
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricKey.java b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/metrics/MetricKey.java
similarity index 94%
rename from sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricKey.java
rename to runners/core-construction-java/src/main/java/org/apache/beam/runners/core/metrics/MetricKey.java
index 8706853f487..58d40553b4e 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricKey.java
+++ b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/metrics/MetricKey.java
@@ -15,12 +15,14 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.beam.sdk.metrics;
+
+package org.apache.beam.runners.core.metrics;
 
 import com.google.auto.value.AutoValue;
 import java.io.Serializable;
 import org.apache.beam.sdk.annotations.Experimental;
 import org.apache.beam.sdk.annotations.Experimental.Kind;
+import org.apache.beam.sdk.metrics.MetricName;
 
 /**
  * Metrics are keyed by the step name they are associated with and the name of the metric.
diff --git a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/metrics/package-info.java b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/metrics/package-info.java
new file mode 100644
index 00000000000..263a705ac03
--- /dev/null
+++ b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/metrics/package-info.java
@@ -0,0 +1,22 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+/**
+ * Utilities for runners to implement metrics.
+ */
+package org.apache.beam.runners.core.metrics;
diff --git a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricFilteringTest.java b/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/metrics/MetricFilteringTest.java
similarity index 96%
rename from sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricFilteringTest.java
rename to runners/core-construction-java/src/test/java/org/apache/beam/runners/core/metrics/MetricFilteringTest.java
index dc2fa0aa6e5..8953f215f1d 100644
--- a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricFilteringTest.java
+++ b/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/metrics/MetricFilteringTest.java
@@ -16,13 +16,16 @@
  * limitations under the License.
  */
 
-package org.apache.beam.sdk.metrics;
+package org.apache.beam.runners.core.metrics;
 
 import static org.junit.Assert.assertFalse;
 import static org.junit.Assert.assertTrue;
 
 import java.util.HashSet;
 import java.util.Set;
+import org.apache.beam.sdk.metrics.MetricName;
+import org.apache.beam.sdk.metrics.MetricNameFilter;
+import org.apache.beam.sdk.metrics.MetricsFilter;
 import org.junit.Test;
 import org.junit.runner.RunWith;
 import org.junit.runners.JUnit4;
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/LateDataUtils.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/LateDataUtils.java
index f7c0d31374e..732e60c6c65 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/LateDataUtils.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/LateDataUtils.java
@@ -22,7 +22,7 @@ import com.google.common.base.Predicate;
 import com.google.common.collect.FluentIterable;
 import com.google.common.collect.Iterables;
 import javax.annotation.Nullable;
-import org.apache.beam.sdk.metrics.CounterCell;
+import org.apache.beam.runners.core.metrics.CounterCell;
 import org.apache.beam.sdk.transforms.windowing.BoundedWindow;
 import org.apache.beam.sdk.util.WindowTracing;
 import org.apache.beam.sdk.util.WindowedValue;
@@ -71,7 +71,7 @@ public class LateDataUtils {
                         .isBefore(timerInternals.currentInputWatermarkTime());
                 if (expired) {
                   // The element is too late for this window.
-                  droppedDueToLateness.update(1L);
+                  droppedDueToLateness.inc();
                   WindowTracing.debug(
                       "GroupAlsoByWindow: Dropping element at {} for key: {}; "
                           + "window: {} since it is too far behind inputWatermark: {}",
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/CounterCell.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/CounterCell.java
similarity index 77%
rename from sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/CounterCell.java
rename to runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/CounterCell.java
index 4b8548f7da2..4378bb9c7b8 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/CounterCell.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/CounterCell.java
@@ -15,11 +15,14 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.beam.sdk.metrics;
+
+package org.apache.beam.runners.core.metrics;
 
 import java.util.concurrent.atomic.AtomicLong;
 import org.apache.beam.sdk.annotations.Experimental;
 import org.apache.beam.sdk.annotations.Experimental.Kind;
+import org.apache.beam.sdk.metrics.Counter;
+import org.apache.beam.sdk.metrics.MetricName;
 
 /**
  * Tracks the current value (and delta) for a Counter metric for a specific context and bundle.
@@ -30,34 +33,40 @@ import org.apache.beam.sdk.annotations.Experimental.Kind;
  * indirection.
  */
 @Experimental(Kind.METRICS)
-public class CounterCell implements MetricCell<Counter, Long> {
+public class CounterCell implements Counter, MetricCell<Long> {
 
   private final DirtyState dirty = new DirtyState();
   private final AtomicLong value = new AtomicLong();
+  private final MetricName name;
 
   /**
    * Package-visibility because all {@link CounterCell CounterCells} should be created by
-   * {@link MetricsContainer#getCounter(MetricName)}.
+   * {@link MetricsContainerImpl#getCounter(MetricName)}.
    */
-  CounterCell() {}
+  CounterCell(MetricName name) {
+    this.name = name;
+  }
 
   /**
    * Increment the counter by the given amount.
    * @param n value to increment by. Can be negative to decrement.
    */
-  public void update(long n) {
+  @Override
+  public void inc(long n) {
     value.addAndGet(n);
     dirty.afterModification();
   }
 
-  @Override
-  public void update(Long n) {
-    throw new UnsupportedOperationException("CounterCell.update(Long n) should not be used"
-    + " as it performs unnecessary boxing/unboxing. Use CounterCell.update(long n) instead.");
+  public void inc() {
+    inc(1);
   }
 
-  @Override public void update(MetricCell<Counter, Long> other) {
-    update((long) other.getCumulative());
+  public void dec() {
+    inc(-1);
+  }
+
+  public void dec(long n) {
+    inc(-1 * n);
   }
 
   @Override
@@ -69,4 +78,9 @@ public class CounterCell implements MetricCell<Counter, Long> {
   public Long getCumulative() {
     return value.get();
   }
+
+  @Override
+  public MetricName getName() {
+    return name;
+  }
 }
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/DirtyState.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/DirtyState.java
similarity index 98%
rename from sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/DirtyState.java
rename to runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/DirtyState.java
index 4e0c15cb2d6..532fc2a36f9 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/DirtyState.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/DirtyState.java
@@ -16,7 +16,7 @@
  * limitations under the License.
  */
 
-package org.apache.beam.sdk.metrics;
+package org.apache.beam.runners.core.metrics;
 
 import java.io.Serializable;
 import java.util.concurrent.atomic.AtomicReference;
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/DistributionCell.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/DistributionCell.java
similarity index 81%
rename from sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/DistributionCell.java
rename to runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/DistributionCell.java
index 93a3649d19a..5a5099a95cc 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/DistributionCell.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/DistributionCell.java
@@ -15,11 +15,14 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.beam.sdk.metrics;
+
+package org.apache.beam.runners.core.metrics;
 
 import java.util.concurrent.atomic.AtomicReference;
 import org.apache.beam.sdk.annotations.Experimental;
 import org.apache.beam.sdk.annotations.Experimental.Kind;
+import org.apache.beam.sdk.metrics.Distribution;
+import org.apache.beam.sdk.metrics.MetricName;
 
 /**
  * Tracks the current value (and delta) for a Distribution metric.
@@ -30,25 +33,28 @@ import org.apache.beam.sdk.annotations.Experimental.Kind;
  * of indirection.
  */
 @Experimental(Kind.METRICS)
-public class DistributionCell implements MetricCell<Distribution, DistributionData> {
+public class DistributionCell implements Distribution, MetricCell<DistributionData> {
 
   private final DirtyState dirty = new DirtyState();
   private final AtomicReference<DistributionData> value =
       new AtomicReference<>(DistributionData.EMPTY);
+  private final MetricName name;
 
   /**
    * Package-visibility because all {@link DistributionCell DistributionCells} should be created by
-   * {@link MetricsContainer#getDistribution(MetricName)}.
+   * {@link MetricsContainerImpl#getDistribution(MetricName)}.
    */
-  DistributionCell() {}
+  DistributionCell(MetricName name) {
+    this.name = name;
+  }
 
   /** Increment the distribution by the given amount. */
+  @Override
   public void update(long n) {
     update(DistributionData.singleton(n));
   }
 
-  @Override
-  public void update(DistributionData data) {
+  void update(DistributionData data) {
     DistributionData original;
     do {
       original = value.get();
@@ -56,11 +62,6 @@ public class DistributionCell implements MetricCell<Distribution, DistributionDa
     dirty.afterModification();
   }
 
-  @Override
-  public void update(MetricCell<Distribution, DistributionData> other) {
-    update(other.getCumulative());
-  }
-
   @Override
   public DirtyState getDirty() {
     return dirty;
@@ -70,5 +71,10 @@ public class DistributionCell implements MetricCell<Distribution, DistributionDa
   public DistributionData getCumulative() {
     return value.get();
   }
+
+  @Override
+  public MetricName getName() {
+    return name;
+  }
 }
 
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/DistributionData.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/DistributionData.java
similarity index 95%
rename from sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/DistributionData.java
rename to runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/DistributionData.java
index 8068e1b0dc6..099e63fb41c 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/DistributionData.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/DistributionData.java
@@ -15,10 +15,12 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.beam.sdk.metrics;
+
+package org.apache.beam.runners.core.metrics;
 
 import com.google.auto.value.AutoValue;
 import java.io.Serializable;
+import org.apache.beam.sdk.metrics.DistributionResult;
 
 /**
  * Data describing the the distribution. This should retain enough detail that it can be combined
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/GaugeCell.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/GaugeCell.java
similarity index 78%
rename from sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/GaugeCell.java
rename to runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/GaugeCell.java
index 0cdd5689171..795e8265e02 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/GaugeCell.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/GaugeCell.java
@@ -15,10 +15,13 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.beam.sdk.metrics;
+
+package org.apache.beam.runners.core.metrics;
 
 import java.util.concurrent.atomic.AtomicReference;
 import org.apache.beam.sdk.annotations.Experimental;
+import org.apache.beam.sdk.metrics.Gauge;
+import org.apache.beam.sdk.metrics.MetricName;
 
 /**
  * Tracks the current value (and delta) for a {@link Gauge} metric.
@@ -29,18 +32,27 @@ import org.apache.beam.sdk.annotations.Experimental;
  * of indirection.
  */
 @Experimental(Experimental.Kind.METRICS)
-public class GaugeCell implements MetricCell<Gauge, GaugeData> {
+public class GaugeCell implements Gauge, MetricCell<GaugeData> {
 
   private final DirtyState dirty = new DirtyState();
   private final AtomicReference<GaugeData> gaugeValue = new AtomicReference<>(GaugeData.empty());
+  private final MetricName name;
+
+  /**
+   * Package-visibility because all {@link GaugeCell GaugeCells} should be created by
+   * {@link MetricsContainerImpl#getGauge(MetricName)}.
+   */
+  GaugeCell(MetricName name) {
+    this.name = name;
+  }
 
   /** Set the gauge to the given value. */
+  @Override
   public void set(long value) {
     update(GaugeData.create(value));
   }
 
-  @Override
-  public void update(GaugeData data) {
+  void update(GaugeData data) {
     GaugeData original;
     do {
       original = gaugeValue.get();
@@ -48,16 +60,6 @@ public class GaugeCell implements MetricCell<Gauge, GaugeData> {
     dirty.afterModification();
   }
 
-  @Override
-  public void update(MetricCell<Gauge, GaugeData> other) {
-    GaugeData original;
-    do {
-      original = gaugeValue.get();
-    } while (!gaugeValue.compareAndSet(original, original.combine(other.getCumulative())));
-    dirty.afterModification();
-    update(other.getCumulative());
-  }
-
   @Override
   public DirtyState getDirty() {
     return dirty;
@@ -67,4 +69,10 @@ public class GaugeCell implements MetricCell<Gauge, GaugeData> {
   public GaugeData getCumulative() {
     return gaugeValue.get();
   }
+
+
+  @Override
+  public MetricName getName() {
+    return name;
+  }
 }
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/GaugeData.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/GaugeData.java
similarity index 95%
rename from sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/GaugeData.java
rename to runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/GaugeData.java
index bf3401d38b9..15a353f78e4 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/GaugeData.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/GaugeData.java
@@ -15,10 +15,12 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.beam.sdk.metrics;
+
+package org.apache.beam.runners.core.metrics;
 
 import com.google.auto.value.AutoValue;
 import java.io.Serializable;
+import org.apache.beam.sdk.metrics.GaugeResult;
 import org.joda.time.Instant;
 
 /**
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricCell.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MetricCell.java
similarity index 78%
rename from sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricCell.java
rename to runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MetricCell.java
index 403cac20831..2b773f05c4e 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricCell.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MetricCell.java
@@ -15,7 +15,8 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.beam.sdk.metrics;
+
+package org.apache.beam.runners.core.metrics;
 
 import java.io.Serializable;
 import org.apache.beam.sdk.annotations.Experimental;
@@ -25,22 +26,10 @@ import org.apache.beam.sdk.annotations.Experimental.Kind;
  * A {@link MetricCell} is used for accumulating in-memory changes to a metric. It represents a
  * specific metric name in a single context.
  *
- * @param <UserT> The type of the user interface for reporting changes to this cell.
  * @param <DataT> The type of metric data stored (and extracted) from this cell.
  */
 @Experimental(Kind.METRICS)
-public interface MetricCell<UserT extends Metric, DataT> extends Serializable {
-
-  /**
-   * Update value of this cell.
-   */
-  void update(DataT data);
-
-  /**
-   * Update value of this cell by merging the value of another cell.
-   */
-  void update(MetricCell<UserT, DataT> other);
-
+public interface MetricCell<DataT> extends Serializable {
   /**
    * Return the {@link DirtyState} tracking whether this metric cell contains uncommitted changes.
    */
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricUpdates.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MetricUpdates.java
similarity index 98%
rename from sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricUpdates.java
rename to runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MetricUpdates.java
index 9cf6a5ca2bf..eae3305bd26 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricUpdates.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MetricUpdates.java
@@ -15,7 +15,8 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.beam.sdk.metrics;
+
+package org.apache.beam.runners.core.metrics;
 
 import com.google.auto.value.AutoValue;
 import com.google.common.collect.Iterables;
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MetricsContainerImpl.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MetricsContainerImpl.java
new file mode 100644
index 00000000000..6967bf0d85b
--- /dev/null
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MetricsContainerImpl.java
@@ -0,0 +1,188 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.beam.runners.core.metrics;
+
+import static com.google.common.base.Preconditions.checkNotNull;
+
+import com.google.common.collect.ImmutableList;
+import java.io.Serializable;
+import java.util.Map;
+import org.apache.beam.runners.core.metrics.MetricUpdates.MetricUpdate;
+import org.apache.beam.sdk.annotations.Experimental;
+import org.apache.beam.sdk.annotations.Experimental.Kind;
+import org.apache.beam.sdk.metrics.Metric;
+import org.apache.beam.sdk.metrics.MetricName;
+import org.apache.beam.sdk.metrics.MetricsContainer;
+
+/**
+ * Holds the metrics for a single step and unit-of-commit (bundle).
+ *
+ * <p>This class is thread-safe. It is intended to be used with 1 (or more) threads are updating
+ * metrics and at-most 1 thread is extracting updates by calling {@link #getUpdates} and
+ * {@link #commitUpdates}. Outside of this it is still safe. Although races in the update extraction
+ * may cause updates that don't actually have any changes, it will never lose an update.
+ *
+ * <p>For consistency, all threads that update metrics should finish before getting the final
+ * cumulative values/updates.
+ */
+@Experimental(Kind.METRICS)
+public class MetricsContainerImpl implements Serializable, MetricsContainer {
+
+  private final String stepName;
+
+  private MetricsMap<MetricName, CounterCell> counters =
+      new MetricsMap<>(new MetricsMap.Factory<MetricName, CounterCell>() {
+        @Override
+        public CounterCell createInstance(MetricName name) {
+          return new CounterCell(name);
+        }
+      });
+
+  private MetricsMap<MetricName, DistributionCell> distributions =
+      new MetricsMap<>(new MetricsMap.Factory<MetricName, DistributionCell>() {
+        @Override
+        public DistributionCell createInstance(MetricName name) {
+          return new DistributionCell(name);
+        }
+      });
+
+  private MetricsMap<MetricName, GaugeCell> gauges =
+      new MetricsMap<>(new MetricsMap.Factory<MetricName, GaugeCell>() {
+        @Override
+        public GaugeCell createInstance(MetricName name) {
+          return new GaugeCell(name);
+        }
+      });
+
+  /**
+   * Create a new {@link MetricsContainerImpl} associated with the given {@code stepName}.
+   */
+  public MetricsContainerImpl(String stepName) {
+    this.stepName = stepName;
+  }
+
+  @Override
+  public CounterCell getCounter(MetricName metricName) {
+    return counters.get(metricName);
+  }
+
+  @Override
+  public DistributionCell getDistribution(MetricName metricName) {
+    return distributions.get(metricName);
+  }
+
+  @Override
+  public GaugeCell getGauge(MetricName metricName) {
+    return gauges.get(metricName);
+  }
+
+  private <UpdateT, CellT extends MetricCell<UpdateT>>
+  ImmutableList<MetricUpdate<UpdateT>> extractUpdates(MetricsMap<MetricName, CellT> cells) {
+    ImmutableList.Builder<MetricUpdate<UpdateT>> updates = ImmutableList.builder();
+    for (Map.Entry<MetricName, CellT> cell : cells.entries()) {
+      if (cell.getValue().getDirty().beforeCommit()) {
+        updates.add(MetricUpdate.create(MetricKey.create(stepName, cell.getKey()),
+            cell.getValue().getCumulative()));
+      }
+    }
+    return updates.build();
+  }
+
+  /**
+   * Return the cumulative values for any metrics that have changed since the last time updates were
+   * committed.
+   */
+  public MetricUpdates getUpdates() {
+    return MetricUpdates.create(
+        extractUpdates(counters),
+        extractUpdates(distributions),
+        extractUpdates(gauges));
+  }
+
+  private void commitUpdates(MetricsMap<MetricName, ? extends MetricCell<?>> cells) {
+    for (MetricCell<?> cell : cells.values()) {
+      cell.getDirty().afterCommit();
+    }
+  }
+
+  /**
+   * Mark all of the updates that were retrieved with the latest call to {@link #getUpdates()} as
+   * committed.
+   */
+  public void commitUpdates() {
+    commitUpdates(counters);
+    commitUpdates(distributions);
+    commitUpdates(gauges);
+  }
+
+  private <UserT extends Metric, UpdateT, CellT extends MetricCell<UpdateT>>
+  ImmutableList<MetricUpdate<UpdateT>> extractCumulatives(
+      MetricsMap<MetricName, CellT> cells) {
+    ImmutableList.Builder<MetricUpdate<UpdateT>> updates = ImmutableList.builder();
+    for (Map.Entry<MetricName, CellT> cell : cells.entries()) {
+      UpdateT update = checkNotNull(cell.getValue().getCumulative());
+      updates.add(MetricUpdate.create(MetricKey.create(stepName, cell.getKey()), update));
+    }
+    return updates.build();
+  }
+
+  /**
+   * Return the {@link MetricUpdates} representing the cumulative values of all metrics in this
+   * container.
+   */
+  public MetricUpdates getCumulative() {
+    return MetricUpdates.create(
+        extractCumulatives(counters),
+        extractCumulatives(distributions),
+        extractCumulatives(gauges));
+  }
+
+  /**
+   * Update values of this {@link MetricsContainerImpl} by merging the value of another cell.
+   */
+  public void update(MetricsContainerImpl other) {
+    updateCounters(counters, other.counters);
+    updateDistributions(distributions, other.distributions);
+    updateGauges(gauges, other.gauges);
+  }
+
+  private void updateCounters(
+      MetricsMap<MetricName, CounterCell> current,
+      MetricsMap<MetricName, CounterCell> updates) {
+    for (Map.Entry<MetricName, CounterCell> counter : updates.entries()) {
+      current.get(counter.getKey()).inc(counter.getValue().getCumulative());
+    }
+  }
+
+  private void updateDistributions(
+      MetricsMap<MetricName, DistributionCell> current,
+      MetricsMap<MetricName, DistributionCell> updates) {
+    for (Map.Entry<MetricName, DistributionCell> counter : updates.entries()) {
+      current.get(counter.getKey()).update(counter.getValue().getCumulative());
+    }
+  }
+
+  private void updateGauges(
+      MetricsMap<MetricName, GaugeCell> current,
+      MetricsMap<MetricName, GaugeCell> updates) {
+    for (Map.Entry<MetricName, GaugeCell> counter : updates.entries()) {
+      current.get(counter.getKey()).update(counter.getValue().getCumulative());
+    }
+  }
+}
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricsContainerStepMap.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MetricsContainerStepMap.java
similarity index 93%
rename from sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricsContainerStepMap.java
rename to runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MetricsContainerStepMap.java
index d01e970f728..68238e49c80 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricsContainerStepMap.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MetricsContainerStepMap.java
@@ -15,7 +15,8 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.beam.sdk.metrics;
+
+package org.apache.beam.runners.core.metrics;
 
 import com.google.common.base.Function;
 import com.google.common.base.Predicate;
@@ -24,7 +25,14 @@ import java.io.Serializable;
 import java.util.HashMap;
 import java.util.Map;
 import java.util.concurrent.ConcurrentHashMap;
-import org.apache.beam.sdk.metrics.MetricUpdates.MetricUpdate;
+import org.apache.beam.runners.core.metrics.MetricUpdates.MetricUpdate;
+import org.apache.beam.sdk.metrics.DistributionResult;
+import org.apache.beam.sdk.metrics.GaugeResult;
+import org.apache.beam.sdk.metrics.MetricName;
+import org.apache.beam.sdk.metrics.MetricQueryResults;
+import org.apache.beam.sdk.metrics.MetricResult;
+import org.apache.beam.sdk.metrics.MetricResults;
+import org.apache.beam.sdk.metrics.MetricsFilter;
 
 /**
  * Metrics containers by step.
@@ -32,7 +40,7 @@ import org.apache.beam.sdk.metrics.MetricUpdates.MetricUpdate;
  * <p>This class is not thread-safe.</p>
  */
 public class MetricsContainerStepMap implements Serializable {
-  private Map<String, MetricsContainer> metricsContainers;
+  private Map<String, MetricsContainerImpl> metricsContainers;
 
   public MetricsContainerStepMap() {
     this.metricsContainers = new ConcurrentHashMap<>();
@@ -41,9 +49,9 @@ public class MetricsContainerStepMap implements Serializable {
   /**
    * Returns the container for the given step name.
    */
-  public MetricsContainer getContainer(String stepName) {
+  public MetricsContainerImpl getContainer(String stepName) {
     if (!metricsContainers.containsKey(stepName)) {
-      metricsContainers.put(stepName, new MetricsContainer(stepName));
+      metricsContainers.put(stepName, new MetricsContainerImpl(stepName));
     }
     return metricsContainers.get(stepName);
   }
@@ -53,16 +61,16 @@ public class MetricsContainerStepMap implements Serializable {
    * {@link MetricsContainerStepMap}.
    */
   public void updateAll(MetricsContainerStepMap other) {
-    for (Map.Entry<String, MetricsContainer> container : other.metricsContainers.entrySet()) {
+    for (Map.Entry<String, MetricsContainerImpl> container : other.metricsContainers.entrySet()) {
       getContainer(container.getKey()).update(container.getValue());
     }
   }
 
   /**
-   * Update {@link MetricsContainer} for given step in this map with all values from given
-   * {@link MetricsContainer}.
+   * Update {@link MetricsContainerImpl} for given step in this map with all values from given
+   * {@link MetricsContainerImpl}.
    */
-  public void update(String step, MetricsContainer container) {
+  public void update(String step, MetricsContainerImpl container) {
     getContainer(step).update(container);
   }
 
@@ -94,7 +102,7 @@ public class MetricsContainerStepMap implements Serializable {
     return new MetricsContainerStepMapMetricResults(attemptedMetricsContainers);
   }
 
-  private Map<String, MetricsContainer> getMetricsContainers() {
+  private Map<String, MetricsContainerImpl> getMetricsContainers() {
     return metricsContainers;
   }
 
@@ -120,7 +128,7 @@ public class MetricsContainerStepMap implements Serializable {
         MetricsContainerStepMap attemptedMetricsContainers,
         MetricsContainerStepMap committedMetricsContainers,
         boolean isCommittedSupported) {
-      for (MetricsContainer container
+      for (MetricsContainerImpl container
           : attemptedMetricsContainers.getMetricsContainers().values()) {
         MetricUpdates cumulative = container.getCumulative();
         mergeCounters(counters, cumulative.counterUpdates(), attemptedCounterUpdateFn());
@@ -128,7 +136,7 @@ public class MetricsContainerStepMap implements Serializable {
             attemptedDistributionUpdateFn());
         mergeGauges(gauges, cumulative.gaugeUpdates(), attemptedGaugeUpdateFn());
       }
-      for (MetricsContainer container
+      for (MetricsContainerImpl container
           : committedMetricsContainers.getMetricsContainers().values()) {
         MetricUpdates cumulative = container.getCumulative();
         mergeCounters(counters, cumulative.counterUpdates(), committedCounterUpdateFn());
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricsMap.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MetricsMap.java
similarity index 98%
rename from sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricsMap.java
rename to runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MetricsMap.java
index 8c26f186975..9f080760148 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricsMap.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MetricsMap.java
@@ -15,7 +15,8 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.beam.sdk.metrics;
+
+package org.apache.beam.runners.core.metrics;
 
 import com.google.common.base.MoreObjects;
 import com.google.common.collect.Iterables;
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/package-info.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/package-info.java
new file mode 100644
index 00000000000..263a705ac03
--- /dev/null
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/package-info.java
@@ -0,0 +1,22 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+/**
+ * Utilities for runners to implement metrics.
+ */
+package org.apache.beam.runners.core.metrics;
diff --git a/runners/core-java/src/test/java/org/apache/beam/runners/core/LateDataDroppingDoFnRunnerTest.java b/runners/core-java/src/test/java/org/apache/beam/runners/core/LateDataDroppingDoFnRunnerTest.java
index 88c6ab6e7e1..9ee79d74ee6 100644
--- a/runners/core-java/src/test/java/org/apache/beam/runners/core/LateDataDroppingDoFnRunnerTest.java
+++ b/runners/core-java/src/test/java/org/apache/beam/runners/core/LateDataDroppingDoFnRunnerTest.java
@@ -26,8 +26,8 @@ import com.google.common.collect.ImmutableList;
 import com.google.common.collect.Iterables;
 import java.util.Arrays;
 import org.apache.beam.runners.core.LateDataDroppingDoFnRunner.LateDataFilter;
+import org.apache.beam.runners.core.metrics.MetricsContainerImpl;
 import org.apache.beam.sdk.metrics.MetricName;
-import org.apache.beam.sdk.metrics.MetricsContainer;
 import org.apache.beam.sdk.metrics.MetricsEnvironment;
 import org.apache.beam.sdk.transforms.windowing.FixedWindows;
 import org.apache.beam.sdk.transforms.windowing.PaneInfo;
@@ -58,7 +58,8 @@ public class LateDataDroppingDoFnRunnerTest {
 
   @Test
   public void testLateDataFilter() throws Exception {
-    MetricsEnvironment.setCurrentContainer(new MetricsContainer("any"));
+    MetricsContainerImpl container = new MetricsContainerImpl("any");
+    MetricsEnvironment.setCurrentContainer(container);
     when(mockTimerInternals.currentInputWatermarkTime()).thenReturn(new Instant(15L));
 
     LateDataFilter lateDataFilter = new LateDataFilter(
@@ -77,14 +78,14 @@ public class LateDataDroppingDoFnRunnerTest {
         createDatum(16, 16L),
         createDatum(18, 18L));
     assertThat(expected, containsInAnyOrder(Iterables.toArray(actual, WindowedValue.class)));
-    long droppedValues = MetricsEnvironment.getCurrentContainer().getCounter(
+    long droppedValues = container.getCounter(
         MetricName.named(LateDataDroppingDoFnRunner.class,
             LateDataDroppingDoFnRunner.DROPPED_DUE_TO_LATENESS))
         .getCumulative().longValue();
     assertEquals(1, droppedValues);
     // Ensure that reiterating returns the same results and doesn't increment the counter again.
     assertThat(expected, containsInAnyOrder(Iterables.toArray(actual, WindowedValue.class)));
-    droppedValues = MetricsEnvironment.getCurrentContainer().getCounter(
+    droppedValues = container.getCounter(
         MetricName.named(LateDataDroppingDoFnRunner.class,
             LateDataDroppingDoFnRunner.DROPPED_DUE_TO_LATENESS))
         .getCumulative().longValue();
diff --git a/runners/core-java/src/test/java/org/apache/beam/runners/core/ReduceFnRunnerTest.java b/runners/core-java/src/test/java/org/apache/beam/runners/core/ReduceFnRunnerTest.java
index 3dd98e0b7cf..9e71300fb33 100644
--- a/runners/core-java/src/test/java/org/apache/beam/runners/core/ReduceFnRunnerTest.java
+++ b/runners/core-java/src/test/java/org/apache/beam/runners/core/ReduceFnRunnerTest.java
@@ -38,10 +38,10 @@ import static org.mockito.Mockito.withSettings;
 
 import com.google.common.collect.Iterables;
 import java.util.List;
+import org.apache.beam.runners.core.metrics.MetricsContainerImpl;
 import org.apache.beam.runners.core.triggers.TriggerStateMachine;
 import org.apache.beam.sdk.coders.VarIntCoder;
 import org.apache.beam.sdk.metrics.MetricName;
-import org.apache.beam.sdk.metrics.MetricsContainer;
 import org.apache.beam.sdk.metrics.MetricsEnvironment;
 import org.apache.beam.sdk.options.PipelineOptions;
 import org.apache.beam.sdk.options.PipelineOptionsFactory;
@@ -145,7 +145,8 @@ public class ReduceFnRunnerTest {
   @Test
   public void testOnElementBufferingDiscarding() throws Exception {
     // Test basic execution of a trigger using a non-combining window set and discarding mode.
-    MetricsEnvironment.setCurrentContainer(new MetricsContainer("any"));
+    MetricsContainerImpl container = new MetricsContainerImpl("any");
+    MetricsEnvironment.setCurrentContainer(container);
     ReduceFnTester<Integer, Iterable<Integer>, IntervalWindow> tester =
         ReduceFnTester.nonCombining(FixedWindows.of(Duration.millis(10)), mockTriggerStateMachine,
             AccumulationMode.DISCARDING_FIRED_PANES, Duration.millis(100),
@@ -170,8 +171,7 @@ public class ReduceFnRunnerTest {
     // This element shouldn't be seen, because the trigger has finished
     injectElement(tester, 4);
 
-    long droppedElements = MetricsEnvironment.getCurrentContainer().getCounter(
-        MetricName.named(ReduceFnRunner.class,
+    long droppedElements = container.getCounter(MetricName.named(ReduceFnRunner.class,
             ReduceFnRunner.DROPPED_DUE_TO_CLOSED_WINDOW))
         .getCumulative().longValue();
     assertEquals(1, droppedElements);
@@ -423,7 +423,8 @@ public class ReduceFnRunnerTest {
 
   @Test
   public void testWatermarkHoldAndLateData() throws Exception {
-    MetricsEnvironment.setCurrentContainer(new MetricsContainer("any"));
+    MetricsContainerImpl container = new MetricsContainerImpl("any");
+    MetricsEnvironment.setCurrentContainer(container);
     // Test handling of late data. Specifically, ensure the watermark hold is correct.
     ReduceFnTester<Integer, Iterable<Integer>, IntervalWindow> tester =
         ReduceFnTester.nonCombining(FixedWindows.of(Duration.millis(10)), mockTriggerStateMachine,
@@ -452,7 +453,7 @@ public class ReduceFnRunnerTest {
     // Holding for the end-of-window transition.
     assertEquals(new Instant(9), tester.getWatermarkHold());
     // Nothing dropped.
-    long droppedElements = MetricsEnvironment.getCurrentContainer().getCounter(
+    long droppedElements = container.getCounter(
         MetricName.named(ReduceFnRunner.class,
             ReduceFnRunner.DROPPED_DUE_TO_CLOSED_WINDOW))
         .getCumulative().longValue();
@@ -514,7 +515,7 @@ public class ReduceFnRunnerTest {
     // Because we're about to expire the window, we output it.
     when(mockTriggerStateMachine.shouldFire(anyTriggerContext())).thenReturn(false);
     injectElement(tester, 8);
-    droppedElements = MetricsEnvironment.getCurrentContainer().getCounter(
+    droppedElements = container.getCounter(
         MetricName.named(ReduceFnRunner.class,
             ReduceFnRunner.DROPPED_DUE_TO_CLOSED_WINDOW))
         .getCumulative().longValue();
@@ -1083,7 +1084,8 @@ public class ReduceFnRunnerTest {
    */
   @Test
   public void testDropDataMultipleWindowsFinishedTrigger() throws Exception {
-    MetricsEnvironment.setCurrentContainer(new MetricsContainer("any"));
+    MetricsContainerImpl container = new MetricsContainerImpl("any");
+    MetricsEnvironment.setCurrentContainer(container);
     ReduceFnTester<Integer, Integer, IntervalWindow> tester = ReduceFnTester.combining(
         WindowingStrategy.of(
             SlidingWindows.of(Duration.millis(100)).every(Duration.millis(30)))
@@ -1097,7 +1099,7 @@ public class ReduceFnRunnerTest {
         // assigned to [-30, 70), [0, 100), [30, 130)
         TimestampedValue.of(12, new Instant(40)));
 
-    long droppedElements = MetricsEnvironment.getCurrentContainer().getCounter(
+    long droppedElements = container.getCounter(
         MetricName.named(ReduceFnRunner.class,
             ReduceFnRunner.DROPPED_DUE_TO_CLOSED_WINDOW))
         .getCumulative().longValue();
@@ -1109,7 +1111,7 @@ public class ReduceFnRunnerTest {
         // but [-30, 70) is closed by the trigger
         TimestampedValue.of(14, new Instant(60)));
 
-    droppedElements = MetricsEnvironment.getCurrentContainer().getCounter(
+    droppedElements = container.getCounter(
         MetricName.named(ReduceFnRunner.class,
             ReduceFnRunner.DROPPED_DUE_TO_CLOSED_WINDOW))
         .getCumulative().longValue();
@@ -1120,7 +1122,7 @@ public class ReduceFnRunnerTest {
     // but they are all closed
     tester.injectElements(TimestampedValue.of(16, new Instant(40)));
 
-    droppedElements = MetricsEnvironment.getCurrentContainer().getCounter(
+    droppedElements = container.getCounter(
         MetricName.named(ReduceFnRunner.class,
             ReduceFnRunner.DROPPED_DUE_TO_CLOSED_WINDOW))
         .getCumulative().longValue();
@@ -1129,7 +1131,8 @@ public class ReduceFnRunnerTest {
 
   @Test
   public void testIdempotentEmptyPanesDiscarding() throws Exception {
-    MetricsEnvironment.setCurrentContainer(new MetricsContainer("any"));
+    MetricsContainerImpl container = new MetricsContainerImpl("any");
+    MetricsEnvironment.setCurrentContainer(container);
     // Test uninteresting (empty) panes don't increment the index or otherwise
     // modify PaneInfo.
     ReduceFnTester<Integer, Iterable<Integer>, IntervalWindow> tester =
@@ -1170,7 +1173,7 @@ public class ReduceFnRunnerTest {
     assertTrue(tester.isMarkedFinished(firstWindow));
     tester.assertHasOnlyGlobalAndFinishedSetsFor(firstWindow);
 
-    long droppedElements = MetricsEnvironment.getCurrentContainer().getCounter(
+    long droppedElements = container.getCounter(
         MetricName.named(ReduceFnRunner.class,
             ReduceFnRunner.DROPPED_DUE_TO_CLOSED_WINDOW))
         .getCumulative().longValue();
@@ -1179,7 +1182,8 @@ public class ReduceFnRunnerTest {
 
   @Test
   public void testIdempotentEmptyPanesAccumulating() throws Exception {
-    MetricsEnvironment.setCurrentContainer(new MetricsContainer("any"));
+    MetricsContainerImpl container = new MetricsContainerImpl("any");
+    MetricsEnvironment.setCurrentContainer(container);
     // Test uninteresting (empty) panes don't increment the index or otherwise
     // modify PaneInfo.
     ReduceFnTester<Integer, Iterable<Integer>, IntervalWindow> tester =
@@ -1222,7 +1226,7 @@ public class ReduceFnRunnerTest {
     assertTrue(tester.isMarkedFinished(firstWindow));
     tester.assertHasOnlyGlobalAndFinishedSetsFor(firstWindow);
 
-    long droppedElements = MetricsEnvironment.getCurrentContainer().getCounter(
+    long droppedElements = container.getCounter(
         MetricName.named(ReduceFnRunner.class,
             ReduceFnRunner.DROPPED_DUE_TO_CLOSED_WINDOW))
         .getCumulative().longValue();
diff --git a/runners/core-java/src/test/java/org/apache/beam/runners/core/StatefulDoFnRunnerTest.java b/runners/core-java/src/test/java/org/apache/beam/runners/core/StatefulDoFnRunnerTest.java
index 76351e40cad..5172f433135 100644
--- a/runners/core-java/src/test/java/org/apache/beam/runners/core/StatefulDoFnRunnerTest.java
+++ b/runners/core-java/src/test/java/org/apache/beam/runners/core/StatefulDoFnRunnerTest.java
@@ -25,10 +25,10 @@ import static org.mockito.Mockito.when;
 import com.google.common.base.MoreObjects;
 import java.util.Collections;
 import org.apache.beam.runners.core.BaseExecutionContext.StepContext;
+import org.apache.beam.runners.core.metrics.MetricsContainerImpl;
 import org.apache.beam.sdk.coders.Coder;
 import org.apache.beam.sdk.coders.VarIntCoder;
 import org.apache.beam.sdk.metrics.MetricName;
-import org.apache.beam.sdk.metrics.MetricsContainer;
 import org.apache.beam.sdk.metrics.MetricsEnvironment;
 import org.apache.beam.sdk.state.StateSpec;
 import org.apache.beam.sdk.state.StateSpecs;
@@ -93,7 +93,8 @@ public class StatefulDoFnRunnerTest {
 
   @Test
   public void testLateDropping() throws Exception {
-    MetricsEnvironment.setCurrentContainer(new MetricsContainer("any"));
+    MetricsContainerImpl container = new MetricsContainerImpl("any");
+    MetricsEnvironment.setCurrentContainer(container);
 
     timerInternals.advanceInputWatermark(new Instant(BoundedWindow.TIMESTAMP_MAX_VALUE));
     timerInternals.advanceOutputWatermark(new Instant(BoundedWindow.TIMESTAMP_MAX_VALUE));
@@ -117,9 +118,8 @@ public class StatefulDoFnRunnerTest {
         WindowedValue.of(KV.of("hello", 1), timestamp, window, PaneInfo.NO_FIRING));
 
 
-    long droppedValues = MetricsEnvironment.getCurrentContainer().getCounter(
-        MetricName.named(StatefulDoFnRunner.class,
-            StatefulDoFnRunner.DROPPED_DUE_TO_LATENESS_COUNTER)).getCumulative().longValue();
+    long droppedValues = container.getCounter(MetricName.named(StatefulDoFnRunner.class,
+        StatefulDoFnRunner.DROPPED_DUE_TO_LATENESS_COUNTER)).getCumulative().longValue();
     assertEquals(1L, droppedValues);
 
     runner.finishBundle();
diff --git a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/CounterCellTest.java b/runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/CounterCellTest.java
similarity index 88%
rename from sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/CounterCellTest.java
rename to runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/CounterCellTest.java
index 26554d4bc9a..12906d988a4 100644
--- a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/CounterCellTest.java
+++ b/runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/CounterCellTest.java
@@ -16,11 +16,12 @@
  * limitations under the License.
  */
 
-package org.apache.beam.sdk.metrics;
+package org.apache.beam.runners.core.metrics;
 
 import static org.hamcrest.Matchers.equalTo;
 import static org.junit.Assert.assertThat;
 
+import org.apache.beam.sdk.metrics.MetricName;
 import org.junit.Test;
 import org.junit.runner.RunWith;
 import org.junit.runners.JUnit4;
@@ -31,12 +32,12 @@ import org.junit.runners.JUnit4;
 @RunWith(JUnit4.class)
 public class CounterCellTest {
 
-  private CounterCell cell = new CounterCell();
+  private CounterCell cell = new CounterCell(MetricName.named("hello", "world"));
 
   @Test
   public void testDeltaAndCumulative() {
-    cell.update(5);
-    cell.update(7);
+    cell.inc(5);
+    cell.inc(7);
     assertThat(cell.getCumulative(), equalTo(12L));
     assertThat("getCumulative is idempotent", cell.getCumulative(), equalTo(12L));
 
@@ -45,7 +46,7 @@ public class CounterCellTest {
     assertThat(cell.getDirty().beforeCommit(), equalTo(false));
     assertThat(cell.getCumulative(), equalTo(12L));
 
-    cell.update(30);
+    cell.inc(30);
     assertThat(cell.getCumulative(), equalTo(42L));
 
     assertThat(cell.getDirty().beforeCommit(), equalTo(true));
diff --git a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/DirtyStateTest.java b/runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/DirtyStateTest.java
similarity index 97%
rename from sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/DirtyStateTest.java
rename to runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/DirtyStateTest.java
index d00f8cd8c43..e5c88989557 100644
--- a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/DirtyStateTest.java
+++ b/runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/DirtyStateTest.java
@@ -16,7 +16,7 @@
  * limitations under the License.
  */
 
-package org.apache.beam.sdk.metrics;
+package org.apache.beam.runners.core.metrics;
 
 import static org.hamcrest.Matchers.is;
 import static org.junit.Assert.assertThat;
diff --git a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/DistributionCellTest.java b/runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/DistributionCellTest.java
similarity index 90%
rename from sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/DistributionCellTest.java
rename to runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/DistributionCellTest.java
index 07e0b266e0d..c0b045aa603 100644
--- a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/DistributionCellTest.java
+++ b/runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/DistributionCellTest.java
@@ -16,11 +16,12 @@
  * limitations under the License.
  */
 
-package org.apache.beam.sdk.metrics;
+package org.apache.beam.runners.core.metrics;
 
 import static org.hamcrest.Matchers.equalTo;
 import static org.junit.Assert.assertThat;
 
+import org.apache.beam.sdk.metrics.MetricName;
 import org.junit.Test;
 import org.junit.runner.RunWith;
 import org.junit.runners.JUnit4;
@@ -30,7 +31,7 @@ import org.junit.runners.JUnit4;
  */
 @RunWith(JUnit4.class)
 public class DistributionCellTest {
-  private DistributionCell cell = new DistributionCell();
+  private DistributionCell cell = new DistributionCell(MetricName.named("hello", "world"));
 
   @Test
   public void testDeltaAndCumulative() {
diff --git a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/GaugeCellTest.java b/runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/GaugeCellTest.java
similarity index 90%
rename from sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/GaugeCellTest.java
rename to runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/GaugeCellTest.java
index 7dbfc4ba822..cfaf92d5bd0 100644
--- a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/GaugeCellTest.java
+++ b/runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/GaugeCellTest.java
@@ -15,18 +15,20 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.beam.sdk.metrics;
+
+package org.apache.beam.runners.core.metrics;
 
 import static org.hamcrest.Matchers.equalTo;
 import static org.junit.Assert.assertThat;
 
+import org.apache.beam.sdk.metrics.MetricName;
 import org.junit.Test;
 
 /**
  * Tests for {@link GaugeCell}.
  */
 public class GaugeCellTest {
-  private GaugeCell cell = new GaugeCell();
+  private GaugeCell cell = new GaugeCell(MetricName.named("hello", "world"));
 
   @Test
   public void testDeltaAndCumulative() {
diff --git a/runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/MetricUpdateMatchers.java b/runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/MetricUpdateMatchers.java
new file mode 100644
index 00000000000..a5ee874feb9
--- /dev/null
+++ b/runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/MetricUpdateMatchers.java
@@ -0,0 +1,82 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.beam.runners.core.metrics;
+
+import java.util.Objects;
+import org.apache.beam.runners.core.metrics.MetricUpdates.MetricUpdate;
+import org.hamcrest.Description;
+import org.hamcrest.Matcher;
+import org.hamcrest.TypeSafeMatcher;
+
+/**
+ * Matchers for {@link MetricUpdate}.
+ */
+public class MetricUpdateMatchers {
+
+  /**
+   * Matches a {@link MetricUpdate} with the given name and contents.
+   *
+   * <p>Visible since it may be used in runner-specific tests.
+   */
+  public static <T> Matcher<MetricUpdate<T>> metricUpdate(final String name, final T update) {
+    return new TypeSafeMatcher<MetricUpdate<T>>() {
+      @Override
+      protected boolean matchesSafely(MetricUpdate<T> item) {
+        return Objects.equals(name, item.getKey().metricName().name())
+            && Objects.equals(update, item.getUpdate());
+      }
+
+      @Override
+      public void describeTo(Description description) {
+        description
+            .appendText("MetricUpdate{name=").appendValue(name)
+            .appendText(", update=").appendValue(update)
+            .appendText("}");
+      }
+    };
+  }
+
+  /**
+   * Matches a {@link MetricUpdate} with the given namespace, name, step and contents.
+   *
+   * <p>Visible since it may be used in runner-specific tests.
+   */
+  public static <T> Matcher<MetricUpdate<T>> metricUpdate(
+      final String namespace, final String name, final String step, final T update) {
+    return new TypeSafeMatcher<MetricUpdate<T>>() {
+      @Override
+      protected boolean matchesSafely(MetricUpdate<T> item) {
+        return Objects.equals(namespace, item.getKey().metricName().namespace())
+            && Objects.equals(name, item.getKey().metricName().name())
+            && Objects.equals(step, item.getKey().stepName())
+            && Objects.equals(update, item.getUpdate());
+      }
+
+      @Override
+      public void describeTo(Description description) {
+        description
+            .appendText("MetricUpdate{inNamespace=").appendValue(namespace)
+            .appendText(", name=").appendValue(name)
+            .appendText(", step=").appendValue(step)
+            .appendText(", update=").appendValue(update)
+            .appendText("}");
+      }
+    };
+  }
+}
diff --git a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsContainerTest.java b/runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/MetricsContainerImplTest.java
similarity index 88%
rename from sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsContainerTest.java
rename to runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/MetricsContainerImplTest.java
index 38c00d30e60..b304d3bb6f6 100644
--- a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsContainerTest.java
+++ b/runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/MetricsContainerImplTest.java
@@ -16,27 +16,28 @@
  * limitations under the License.
  */
 
-package org.apache.beam.sdk.metrics;
+package org.apache.beam.runners.core.metrics;
 
-import static org.apache.beam.sdk.metrics.MetricMatchers.metricUpdate;
+import static org.apache.beam.runners.core.metrics.MetricUpdateMatchers.metricUpdate;
 import static org.hamcrest.Matchers.contains;
 import static org.hamcrest.Matchers.emptyIterable;
 import static org.hamcrest.collection.IsIterableContainingInAnyOrder.containsInAnyOrder;
 import static org.junit.Assert.assertThat;
 
+import org.apache.beam.sdk.metrics.MetricName;
 import org.junit.Test;
 import org.junit.runner.RunWith;
 import org.junit.runners.JUnit4;
 
 /**
- * Tests for {@link MetricsContainer}.
+ * Tests for {@link MetricsContainerImpl}.
  */
 @RunWith(JUnit4.class)
-public class MetricsContainerTest {
+public class MetricsContainerImplTest {
 
   @Test
   public void testCounterDeltas() {
-    MetricsContainer container = new MetricsContainer("step1");
+    MetricsContainerImpl container = new MetricsContainerImpl("step1");
     CounterCell c1 = container.getCounter(MetricName.named("ns", "name1"));
     CounterCell c2 = container.getCounter(MetricName.named("ns", "name2"));
     assertThat("All counters should start out dirty",
@@ -47,8 +48,8 @@ public class MetricsContainerTest {
     assertThat("After commit no counters should be dirty",
         container.getUpdates().counterUpdates(), emptyIterable());
 
-    c1.update(5L);
-    c2.update(4L);
+    c1.inc(5L);
+    c2.inc(4L);
 
     assertThat(container.getUpdates().counterUpdates(), containsInAnyOrder(
         metricUpdate("name1", 5L),
@@ -63,19 +64,19 @@ public class MetricsContainerTest {
     assertThat("After commit there are no updates",
         container.getUpdates().counterUpdates(), emptyIterable());
 
-    c1.update(8L);
+    c1.inc(8L);
     assertThat(container.getUpdates().counterUpdates(), contains(
         metricUpdate("name1", 13L)));
   }
 
   @Test
   public void testCounterCumulatives() {
-    MetricsContainer container = new MetricsContainer("step1");
+    MetricsContainerImpl container = new MetricsContainerImpl("step1");
     CounterCell c1 = container.getCounter(MetricName.named("ns", "name1"));
     CounterCell c2 = container.getCounter(MetricName.named("ns", "name2"));
-    c1.update(2L);
-    c2.update(4L);
-    c1.update(3L);
+    c1.inc(2L);
+    c2.inc(4L);
+    c1.inc(3L);
 
     container.getUpdates();
     container.commitUpdates();
@@ -84,7 +85,7 @@ public class MetricsContainerTest {
         metricUpdate("name1", 5L),
         metricUpdate("name2", 4L)));
 
-    c1.update(8L);
+    c1.inc(8L);
     assertThat(container.getCumulative().counterUpdates(), containsInAnyOrder(
         metricUpdate("name1", 13L),
         metricUpdate("name2", 4L)));
@@ -92,7 +93,7 @@ public class MetricsContainerTest {
 
   @Test
   public void testDistributionDeltas() {
-    MetricsContainer container = new MetricsContainer("step1");
+    MetricsContainerImpl container = new MetricsContainerImpl("step1");
     DistributionCell c1 = container.getDistribution(MetricName.named("ns", "name1"));
     DistributionCell c2 = container.getDistribution(MetricName.named("ns", "name2"));
 
diff --git a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsContainerStepMapTest.java b/runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/MetricsContainerStepMapTest.java
similarity index 66%
rename from sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsContainerStepMapTest.java
rename to runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/MetricsContainerStepMapTest.java
index 0428ce1aa84..3074cc02326 100644
--- a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsContainerStepMapTest.java
+++ b/runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/MetricsContainerStepMapTest.java
@@ -15,16 +15,27 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.beam.sdk.metrics;
 
-import static org.apache.beam.sdk.metrics.MetricMatchers.metricsResult;
-import static org.apache.beam.sdk.metrics.MetricsContainerStepMap.asAttemptedOnlyMetricResults;
-import static org.apache.beam.sdk.metrics.MetricsContainerStepMap.asMetricResults;
+package org.apache.beam.runners.core.metrics;
+
+import static org.apache.beam.runners.core.metrics.MetricsContainerStepMap.asAttemptedOnlyMetricResults;
+import static org.apache.beam.runners.core.metrics.MetricsContainerStepMap.asMetricResults;
+import static org.apache.beam.sdk.metrics.MetricResultsMatchers.metricsResult;
 import static org.hamcrest.Matchers.hasItem;
 import static org.junit.Assert.assertThat;
 
 import java.io.Closeable;
 import java.io.IOException;
+import org.apache.beam.sdk.metrics.Counter;
+import org.apache.beam.sdk.metrics.Distribution;
+import org.apache.beam.sdk.metrics.DistributionResult;
+import org.apache.beam.sdk.metrics.Gauge;
+import org.apache.beam.sdk.metrics.GaugeResult;
+import org.apache.beam.sdk.metrics.MetricQueryResults;
+import org.apache.beam.sdk.metrics.MetricResults;
+import org.apache.beam.sdk.metrics.Metrics;
+import org.apache.beam.sdk.metrics.MetricsEnvironment;
+import org.apache.beam.sdk.metrics.MetricsFilter;
 import org.hamcrest.collection.IsIterableWithSize;
 import org.joda.time.Instant;
 import org.junit.Rule;
@@ -39,26 +50,23 @@ public class MetricsContainerStepMapTest {
   private static final String NAMESPACE = MetricsContainerStepMapTest.class.getName();
   private static final String STEP1 = "myStep1";
   private static final String STEP2 = "myStep2";
+  private static final String COUNTER_NAME = "myCounter";
+  private static final String DISTRIBUTION_NAME = "myDistribution";
+  private static final String GAUGE_NAME = "myGauge";
 
   private static final long VALUE = 100;
 
   private static final Counter counter =
-      Metrics.counter(
-          MetricsContainerStepMapTest.class,
-          "myCounter");
+      Metrics.counter(MetricsContainerStepMapTest.class, COUNTER_NAME);
   private static final Distribution distribution =
-      Metrics.distribution(
-          MetricsContainerStepMapTest.class,
-          "myDistribution");
+      Metrics.distribution(MetricsContainerStepMapTest.class, DISTRIBUTION_NAME);
   private static final Gauge gauge =
-      Metrics.gauge(
-          MetricsContainerStepMapTest.class,
-          "myGauge");
+      Metrics.gauge(MetricsContainerStepMapTest.class, GAUGE_NAME);
 
-  private static final MetricsContainer metricsContainer;
+  private static final MetricsContainerImpl metricsContainer;
 
   static {
-    metricsContainer = new MetricsContainer(null);
+    metricsContainer = new MetricsContainerImpl(null);
     try (Closeable ignored = MetricsEnvironment.scopedMetricsContainer(metricsContainer)) {
       counter.inc(VALUE);
       distribution.update(VALUE);
@@ -89,10 +97,11 @@ public class MetricsContainerStepMapTest {
     assertIterableSize(step1res.distributions(), 1);
     assertIterableSize(step1res.gauges(), 1);
 
-    assertCounter(step1res, STEP1, VALUE, false);
-    assertDistribution(step1res, STEP1, DistributionResult.create(VALUE * 3, 2, VALUE, VALUE * 2),
+    assertCounter(COUNTER_NAME, step1res, STEP1, VALUE, false);
+    assertDistribution(DISTRIBUTION_NAME,
+        step1res, STEP1, DistributionResult.create(VALUE * 3, 2, VALUE, VALUE * 2),
         false);
-    assertGauge(step1res, STEP1, GaugeResult.create(VALUE, Instant.now()), false);
+    assertGauge(GAUGE_NAME, step1res, STEP1, GaugeResult.create(VALUE, Instant.now()), false);
 
     MetricQueryResults step2res =
         metricResults.queryMetrics(MetricsFilter.builder().addStep(STEP2).build());
@@ -101,10 +110,12 @@ public class MetricsContainerStepMapTest {
     assertIterableSize(step2res.distributions(), 1);
     assertIterableSize(step2res.gauges(), 1);
 
-    assertCounter(step2res, STEP2, VALUE * 2, false);
-    assertDistribution(step2res, STEP2, DistributionResult.create(VALUE * 6, 4, VALUE, VALUE * 2),
-        false);
-    assertGauge(step2res, STEP2, GaugeResult.create(VALUE, Instant.now()), false);
+    assertCounter(COUNTER_NAME, step2res, STEP2, VALUE * 2, false);
+    assertDistribution(
+        DISTRIBUTION_NAME, step2res, STEP2,
+        DistributionResult.create(VALUE * 6, 4, VALUE, VALUE * 2), false);
+    assertGauge(
+        GAUGE_NAME, step2res, STEP2, GaugeResult.create(VALUE, Instant.now()), false);
 
     MetricQueryResults allres =
         metricResults.queryMetrics(MetricsFilter.builder().build());
@@ -127,7 +138,7 @@ public class MetricsContainerStepMapTest {
     thrown.expect(UnsupportedOperationException.class);
     thrown.expectMessage("This runner does not currently support committed metrics results.");
 
-    assertCounter(step1res, STEP1, VALUE, true);
+    assertCounter(COUNTER_NAME, step1res, STEP1, VALUE, true);
   }
 
   @Test
@@ -143,7 +154,7 @@ public class MetricsContainerStepMapTest {
     thrown.expect(UnsupportedOperationException.class);
     thrown.expectMessage("This runner does not currently support committed metrics results.");
 
-    assertDistribution(step1res, STEP1, DistributionResult.ZERO, true);
+    assertDistribution(DISTRIBUTION_NAME, step1res, STEP1, DistributionResult.ZERO, true);
   }
 
   @Test
@@ -159,7 +170,7 @@ public class MetricsContainerStepMapTest {
     thrown.expect(UnsupportedOperationException.class);
     thrown.expectMessage("This runner does not currently support committed metrics results.");
 
-    assertGauge(step1res, STEP1, GaugeResult.empty(), true);
+    assertGauge(GAUGE_NAME, step1res, STEP1, GaugeResult.empty(), true);
   }
 
   @Test
@@ -186,15 +197,16 @@ public class MetricsContainerStepMapTest {
     assertIterableSize(step1res.distributions(), 1);
     assertIterableSize(step1res.gauges(), 1);
 
-    assertCounter(step1res, STEP1, VALUE * 2, false);
-    assertDistribution(step1res, STEP1, DistributionResult.create(VALUE * 6, 4, VALUE, VALUE * 2),
-        false);
-    assertGauge(step1res, STEP1, GaugeResult.create(VALUE, Instant.now()), false);
+    assertCounter(COUNTER_NAME, step1res, STEP1, VALUE * 2, false);
+    assertDistribution(
+        DISTRIBUTION_NAME, step1res, STEP1,
+        DistributionResult.create(VALUE * 6, 4, VALUE, VALUE * 2), false);
+    assertGauge(GAUGE_NAME, step1res, STEP1, GaugeResult.create(VALUE, Instant.now()), false);
 
-    assertCounter(step1res, STEP1, VALUE, true);
-    assertDistribution(step1res, STEP1, DistributionResult.create(VALUE * 3, 2, VALUE, VALUE * 2),
-        true);
-    assertGauge(step1res, STEP1, GaugeResult.create(VALUE, Instant.now()), true);
+    assertCounter(COUNTER_NAME, step1res, STEP1, VALUE, true);
+    assertDistribution(DISTRIBUTION_NAME, step1res, STEP1,
+        DistributionResult.create(VALUE * 3, 2, VALUE, VALUE * 2), true);
+    assertGauge(GAUGE_NAME, step1res, STEP1, GaugeResult.create(VALUE, Instant.now()), true);
 
     MetricQueryResults step2res =
         metricResults.queryMetrics(MetricsFilter.builder().addStep(STEP2).build());
@@ -203,15 +215,15 @@ public class MetricsContainerStepMapTest {
     assertIterableSize(step2res.distributions(), 1);
     assertIterableSize(step2res.gauges(), 1);
 
-    assertCounter(step2res, STEP2, VALUE * 3, false);
-    assertDistribution(step2res, STEP2, DistributionResult.create(VALUE * 9, 6, VALUE, VALUE * 2),
-        false);
-    assertGauge(step2res, STEP2, GaugeResult.create(VALUE, Instant.now()), false);
+    assertCounter(COUNTER_NAME, step2res, STEP2, VALUE * 3, false);
+    assertDistribution(DISTRIBUTION_NAME, step2res, STEP2,
+        DistributionResult.create(VALUE * 9, 6, VALUE, VALUE * 2), false);
+    assertGauge(GAUGE_NAME, step2res, STEP2, GaugeResult.create(VALUE, Instant.now()), false);
 
-    assertCounter(step2res, STEP2, VALUE * 2, true);
-    assertDistribution(step2res, STEP2, DistributionResult.create(VALUE * 6, 4, VALUE, VALUE * 2),
-        true);
-    assertGauge(step2res, STEP2, GaugeResult.create(VALUE, Instant.now()), true);
+    assertCounter(COUNTER_NAME, step2res, STEP2, VALUE * 2, true);
+    assertDistribution(DISTRIBUTION_NAME, step2res, STEP2,
+        DistributionResult.create(VALUE * 6, 4, VALUE, VALUE * 2), true);
+    assertGauge(GAUGE_NAME, step2res, STEP2, GaugeResult.create(VALUE, Instant.now()), true);
 
     MetricQueryResults allres =
         metricResults.queryMetrics(MetricsFilter.builder().build());
@@ -226,33 +238,35 @@ public class MetricsContainerStepMapTest {
   }
 
   private void assertCounter(
+      String name,
       MetricQueryResults metricQueryResults,
       String step,
       Long expected,
       boolean isCommitted) {
     assertThat(
         metricQueryResults.counters(),
-        hasItem(metricsResult(NAMESPACE, counter.getName().name(), step, expected, isCommitted)));
+        hasItem(metricsResult(NAMESPACE, name, step, expected, isCommitted)));
   }
 
   private void assertDistribution(
+      String name,
       MetricQueryResults metricQueryResults,
       String step,
       DistributionResult expected,
       boolean isCommitted) {
     assertThat(
         metricQueryResults.distributions(),
-        hasItem(metricsResult(NAMESPACE, distribution.getName().name(), step, expected,
-            isCommitted)));
+        hasItem(metricsResult(NAMESPACE, name, step, expected, isCommitted)));
   }
 
   private void assertGauge(
+      String name,
       MetricQueryResults metricQueryResults,
       String step,
       GaugeResult expected,
       boolean isCommitted) {
     assertThat(
         metricQueryResults.gauges(),
-        hasItem(metricsResult(NAMESPACE, gauge.getName().name(), step, expected, isCommitted)));
+        hasItem(metricsResult(NAMESPACE, name, step, expected, isCommitted)));
   }
 }
diff --git a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsMapTest.java b/runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/MetricsMapTest.java
similarity index 98%
rename from sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsMapTest.java
rename to runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/MetricsMapTest.java
index 4104f8ddab6..96210ddb5e6 100644
--- a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsMapTest.java
+++ b/runners/core-java/src/test/java/org/apache/beam/runners/core/metrics/MetricsMapTest.java
@@ -16,7 +16,7 @@
  * limitations under the License.
  */
 
-package org.apache.beam.sdk.metrics;
+package org.apache.beam.runners.core.metrics;
 
 import static org.hamcrest.Matchers.containsInAnyOrder;
 import static org.hamcrest.Matchers.not;
diff --git a/runners/direct-java/src/main/java/org/apache/beam/runners/direct/DirectMetrics.java b/runners/direct-java/src/main/java/org/apache/beam/runners/direct/DirectMetrics.java
index b7cd6e73f07..8169332b817 100644
--- a/runners/direct-java/src/main/java/org/apache/beam/runners/direct/DirectMetrics.java
+++ b/runners/direct-java/src/main/java/org/apache/beam/runners/direct/DirectMetrics.java
@@ -32,20 +32,20 @@ import java.util.concurrent.ExecutorService;
 import java.util.concurrent.Executors;
 import java.util.concurrent.atomic.AtomicReference;
 import javax.annotation.concurrent.GuardedBy;
-import org.apache.beam.sdk.metrics.DistributionData;
+import org.apache.beam.runners.core.metrics.DistributionData;
+import org.apache.beam.runners.core.metrics.GaugeData;
+import org.apache.beam.runners.core.metrics.MetricFiltering;
+import org.apache.beam.runners.core.metrics.MetricKey;
+import org.apache.beam.runners.core.metrics.MetricUpdates;
+import org.apache.beam.runners.core.metrics.MetricUpdates.MetricUpdate;
+import org.apache.beam.runners.core.metrics.MetricsMap;
 import org.apache.beam.sdk.metrics.DistributionResult;
-import org.apache.beam.sdk.metrics.GaugeData;
 import org.apache.beam.sdk.metrics.GaugeResult;
-import org.apache.beam.sdk.metrics.MetricFiltering;
-import org.apache.beam.sdk.metrics.MetricKey;
 import org.apache.beam.sdk.metrics.MetricName;
 import org.apache.beam.sdk.metrics.MetricQueryResults;
 import org.apache.beam.sdk.metrics.MetricResult;
 import org.apache.beam.sdk.metrics.MetricResults;
-import org.apache.beam.sdk.metrics.MetricUpdates;
-import org.apache.beam.sdk.metrics.MetricUpdates.MetricUpdate;
 import org.apache.beam.sdk.metrics.MetricsFilter;
-import org.apache.beam.sdk.metrics.MetricsMap;
 
 /**
  * Implementation of {@link MetricResults} for the Direct Runner.
diff --git a/runners/direct-java/src/main/java/org/apache/beam/runners/direct/StepTransformResult.java b/runners/direct-java/src/main/java/org/apache/beam/runners/direct/StepTransformResult.java
index c7f78472f62..6efb99fa1ae 100644
--- a/runners/direct-java/src/main/java/org/apache/beam/runners/direct/StepTransformResult.java
+++ b/runners/direct-java/src/main/java/org/apache/beam/runners/direct/StepTransformResult.java
@@ -23,9 +23,9 @@ import java.util.Arrays;
 import java.util.Collection;
 import java.util.EnumSet;
 import java.util.Set;
+import org.apache.beam.runners.core.metrics.MetricUpdates;
 import org.apache.beam.runners.direct.CommittedResult.OutputType;
 import org.apache.beam.runners.direct.WatermarkManager.TimerUpdate;
-import org.apache.beam.sdk.metrics.MetricUpdates;
 import org.apache.beam.sdk.runners.AppliedPTransform;
 import org.apache.beam.sdk.transforms.windowing.BoundedWindow;
 import org.apache.beam.sdk.util.WindowedValue;
diff --git a/runners/direct-java/src/main/java/org/apache/beam/runners/direct/TransformExecutor.java b/runners/direct-java/src/main/java/org/apache/beam/runners/direct/TransformExecutor.java
index 56f8650a103..76d817b960c 100644
--- a/runners/direct-java/src/main/java/org/apache/beam/runners/direct/TransformExecutor.java
+++ b/runners/direct-java/src/main/java/org/apache/beam/runners/direct/TransformExecutor.java
@@ -21,8 +21,8 @@ import java.io.Closeable;
 import java.util.ArrayList;
 import java.util.Collection;
 import java.util.concurrent.Callable;
-import org.apache.beam.sdk.metrics.MetricUpdates;
-import org.apache.beam.sdk.metrics.MetricsContainer;
+import org.apache.beam.runners.core.metrics.MetricUpdates;
+import org.apache.beam.runners.core.metrics.MetricsContainerImpl;
 import org.apache.beam.sdk.metrics.MetricsEnvironment;
 import org.apache.beam.sdk.runners.AppliedPTransform;
 import org.apache.beam.sdk.util.WindowedValue;
@@ -92,7 +92,7 @@ class TransformExecutor<T> implements Runnable {
 
   @Override
   public void run() {
-    MetricsContainer metricsContainer = new MetricsContainer(transform.getFullName());
+    MetricsContainerImpl metricsContainer = new MetricsContainerImpl(transform.getFullName());
     try (Closeable metricsScope = MetricsEnvironment.scopedMetricsContainer(metricsContainer)) {
       Collection<ModelEnforcement<T>> enforcements = new ArrayList<>();
       for (ModelEnforcementFactory enforcementFactory : modelEnforcements) {
@@ -134,7 +134,7 @@ class TransformExecutor<T> implements Runnable {
    */
   private void processElements(
       TransformEvaluator<T> evaluator,
-      MetricsContainer metricsContainer,
+      MetricsContainerImpl metricsContainer,
       Collection<ModelEnforcement<T>> enforcements)
       throws Exception {
     if (inputBundle != null) {
@@ -167,7 +167,7 @@ class TransformExecutor<T> implements Runnable {
    *         {@link TransformEvaluator#finishBundle()}
    */
   private TransformResult<T> finishBundle(
-      TransformEvaluator<T> evaluator, MetricsContainer metricsContainer,
+      TransformEvaluator<T> evaluator, MetricsContainerImpl metricsContainer,
       Collection<ModelEnforcement<T>> enforcements)
       throws Exception {
     TransformResult<T> result =
diff --git a/runners/direct-java/src/main/java/org/apache/beam/runners/direct/TransformResult.java b/runners/direct-java/src/main/java/org/apache/beam/runners/direct/TransformResult.java
index 8d7aeda72fc..554c2d65aa4 100644
--- a/runners/direct-java/src/main/java/org/apache/beam/runners/direct/TransformResult.java
+++ b/runners/direct-java/src/main/java/org/apache/beam/runners/direct/TransformResult.java
@@ -19,9 +19,9 @@ package org.apache.beam.runners.direct;
 
 import java.util.Set;
 import javax.annotation.Nullable;
+import org.apache.beam.runners.core.metrics.MetricUpdates;
 import org.apache.beam.runners.direct.CommittedResult.OutputType;
 import org.apache.beam.runners.direct.WatermarkManager.TimerUpdate;
-import org.apache.beam.sdk.metrics.MetricUpdates;
 import org.apache.beam.sdk.runners.AppliedPTransform;
 import org.apache.beam.sdk.transforms.PTransform;
 import org.apache.beam.sdk.transforms.ParDo;
diff --git a/runners/direct-java/src/test/java/org/apache/beam/runners/direct/DirectMetricsTest.java b/runners/direct-java/src/test/java/org/apache/beam/runners/direct/DirectMetricsTest.java
index d5d0affa0ef..8cdf3239db4 100644
--- a/runners/direct-java/src/test/java/org/apache/beam/runners/direct/DirectMetricsTest.java
+++ b/runners/direct-java/src/test/java/org/apache/beam/runners/direct/DirectMetricsTest.java
@@ -18,23 +18,23 @@
 
 package org.apache.beam.runners.direct;
 
-import static org.apache.beam.sdk.metrics.MetricMatchers.attemptedMetricsResult;
-import static org.apache.beam.sdk.metrics.MetricMatchers.committedMetricsResult;
 import static org.apache.beam.sdk.metrics.MetricNameFilter.inNamespace;
+import static org.apache.beam.sdk.metrics.MetricResultsMatchers.attemptedMetricsResult;
+import static org.apache.beam.sdk.metrics.MetricResultsMatchers.committedMetricsResult;
 import static org.hamcrest.Matchers.contains;
 import static org.hamcrest.Matchers.containsInAnyOrder;
 import static org.junit.Assert.assertThat;
 
 import com.google.common.collect.ImmutableList;
-import org.apache.beam.sdk.metrics.DistributionData;
+import org.apache.beam.runners.core.metrics.DistributionData;
+import org.apache.beam.runners.core.metrics.GaugeData;
+import org.apache.beam.runners.core.metrics.MetricKey;
+import org.apache.beam.runners.core.metrics.MetricUpdates;
+import org.apache.beam.runners.core.metrics.MetricUpdates.MetricUpdate;
 import org.apache.beam.sdk.metrics.DistributionResult;
-import org.apache.beam.sdk.metrics.GaugeData;
 import org.apache.beam.sdk.metrics.GaugeResult;
-import org.apache.beam.sdk.metrics.MetricKey;
 import org.apache.beam.sdk.metrics.MetricName;
 import org.apache.beam.sdk.metrics.MetricQueryResults;
-import org.apache.beam.sdk.metrics.MetricUpdates;
-import org.apache.beam.sdk.metrics.MetricUpdates.MetricUpdate;
 import org.apache.beam.sdk.metrics.MetricsFilter;
 import org.joda.time.Instant;
 import org.junit.Before;
diff --git a/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkRunnerResult.java b/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkRunnerResult.java
index 038895ad267..b1f956db271 100644
--- a/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkRunnerResult.java
+++ b/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkRunnerResult.java
@@ -17,15 +17,15 @@
  */
 package org.apache.beam.runners.flink;
 
-import static org.apache.beam.sdk.metrics.MetricsContainerStepMap.asAttemptedOnlyMetricResults;
+import static org.apache.beam.runners.core.metrics.MetricsContainerStepMap.asAttemptedOnlyMetricResults;
 
 import java.io.IOException;
 import java.util.Collections;
 import java.util.Map;
+import org.apache.beam.runners.core.metrics.MetricsContainerStepMap;
 import org.apache.beam.runners.flink.metrics.FlinkMetricContainer;
 import org.apache.beam.sdk.PipelineResult;
 import org.apache.beam.sdk.metrics.MetricResults;
-import org.apache.beam.sdk.metrics.MetricsContainerStepMap;
 import org.joda.time.Duration;
 
 /**
diff --git a/runners/flink/src/main/java/org/apache/beam/runners/flink/metrics/DoFnRunnerWithMetricsUpdate.java b/runners/flink/src/main/java/org/apache/beam/runners/flink/metrics/DoFnRunnerWithMetricsUpdate.java
index 40191d26b0a..ccce127eeed 100644
--- a/runners/flink/src/main/java/org/apache/beam/runners/flink/metrics/DoFnRunnerWithMetricsUpdate.java
+++ b/runners/flink/src/main/java/org/apache/beam/runners/flink/metrics/DoFnRunnerWithMetricsUpdate.java
@@ -20,6 +20,7 @@ package org.apache.beam.runners.flink.metrics;
 import java.io.Closeable;
 import java.io.IOException;
 import org.apache.beam.runners.core.DoFnRunner;
+import org.apache.beam.runners.core.metrics.MetricsContainerImpl;
 import org.apache.beam.sdk.metrics.MetricsEnvironment;
 import org.apache.beam.sdk.state.TimeDomain;
 import org.apache.beam.sdk.transforms.windowing.BoundedWindow;
@@ -29,7 +30,7 @@ import org.joda.time.Instant;
 
 /**
  * {@link DoFnRunner} decorator which registers
- * {@link org.apache.beam.sdk.metrics.MetricsContainer}. It updates metrics to Flink metrics and
+ * {@link MetricsContainerImpl}. It updates metrics to Flink metrics and
  * accumulators in {@link #finishBundle()}.
  */
 public class DoFnRunnerWithMetricsUpdate<InputT, OutputT> implements DoFnRunner<InputT, OutputT> {
diff --git a/runners/flink/src/main/java/org/apache/beam/runners/flink/metrics/FlinkMetricContainer.java b/runners/flink/src/main/java/org/apache/beam/runners/flink/metrics/FlinkMetricContainer.java
index f81205e9b8c..677051e2bfa 100644
--- a/runners/flink/src/main/java/org/apache/beam/runners/flink/metrics/FlinkMetricContainer.java
+++ b/runners/flink/src/main/java/org/apache/beam/runners/flink/metrics/FlinkMetricContainer.java
@@ -17,17 +17,18 @@
  */
 package org.apache.beam.runners.flink.metrics;
 
-import static org.apache.beam.sdk.metrics.MetricsContainerStepMap.asAttemptedOnlyMetricResults;
+import static org.apache.beam.runners.core.metrics.MetricsContainerStepMap.asAttemptedOnlyMetricResults;
 
 import java.util.HashMap;
 import java.util.Map;
+import org.apache.beam.runners.core.metrics.MetricsContainerImpl;
+import org.apache.beam.runners.core.metrics.MetricsContainerStepMap;
 import org.apache.beam.sdk.metrics.DistributionResult;
 import org.apache.beam.sdk.metrics.GaugeResult;
 import org.apache.beam.sdk.metrics.MetricQueryResults;
 import org.apache.beam.sdk.metrics.MetricResult;
 import org.apache.beam.sdk.metrics.MetricResults;
 import org.apache.beam.sdk.metrics.MetricsContainer;
-import org.apache.beam.sdk.metrics.MetricsContainerStepMap;
 import org.apache.beam.sdk.metrics.MetricsFilter;
 import org.apache.flink.api.common.accumulators.Accumulator;
 import org.apache.flink.api.common.functions.RuntimeContext;
@@ -37,7 +38,7 @@ import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
 /**
- * Helper class for holding a {@link MetricsContainer} and forwarding Beam metrics to
+ * Helper class for holding a {@link MetricsContainerImpl} and forwarding Beam metrics to
  * Flink accumulators and metrics.
  */
 public class FlinkMetricContainer {
diff --git a/runners/flink/src/main/java/org/apache/beam/runners/flink/metrics/MetricsAccumulator.java b/runners/flink/src/main/java/org/apache/beam/runners/flink/metrics/MetricsAccumulator.java
index a9dc2ce92be..d8b5d2516d1 100644
--- a/runners/flink/src/main/java/org/apache/beam/runners/flink/metrics/MetricsAccumulator.java
+++ b/runners/flink/src/main/java/org/apache/beam/runners/flink/metrics/MetricsAccumulator.java
@@ -17,7 +17,7 @@
  */
 package org.apache.beam.runners.flink.metrics;
 
-import org.apache.beam.sdk.metrics.MetricsContainerStepMap;
+import org.apache.beam.runners.core.metrics.MetricsContainerStepMap;
 import org.apache.flink.api.common.accumulators.Accumulator;
 import org.apache.flink.api.common.accumulators.SimpleAccumulator;
 
diff --git a/runners/flink/src/main/java/org/apache/beam/runners/flink/metrics/ReaderInvocationUtil.java b/runners/flink/src/main/java/org/apache/beam/runners/flink/metrics/ReaderInvocationUtil.java
index 64738cce2af..85d6426218d 100644
--- a/runners/flink/src/main/java/org/apache/beam/runners/flink/metrics/ReaderInvocationUtil.java
+++ b/runners/flink/src/main/java/org/apache/beam/runners/flink/metrics/ReaderInvocationUtil.java
@@ -19,6 +19,7 @@ package org.apache.beam.runners.flink.metrics;
 
 import java.io.Closeable;
 import java.io.IOException;
+import org.apache.beam.runners.core.metrics.MetricsContainerImpl;
 import org.apache.beam.runners.flink.FlinkPipelineOptions;
 import org.apache.beam.sdk.io.Source;
 import org.apache.beam.sdk.metrics.MetricsEnvironment;
@@ -26,8 +27,8 @@ import org.apache.beam.sdk.options.PipelineOptions;
 
 /**
  * Util for invoking {@link Source.Reader} methods that might require a
- * {@link org.apache.beam.sdk.metrics.MetricsContainer} to be active.
- * Source.Reader decorator which registers {@link org.apache.beam.sdk.metrics.MetricsContainer}.
+ * {@link MetricsContainerImpl} to be active.
+ * Source.Reader decorator which registers {@link MetricsContainerImpl}.
  * It update metrics to Flink metric and accumulator in start and advance.
  */
 public class ReaderInvocationUtil<OutputT, ReaderT extends Source.Reader<OutputT>> {
diff --git a/runners/google-cloud-dataflow-java/pom.xml b/runners/google-cloud-dataflow-java/pom.xml
index 380933576cd..f6799765285 100644
--- a/runners/google-cloud-dataflow-java/pom.xml
+++ b/runners/google-cloud-dataflow-java/pom.xml
@@ -33,7 +33,7 @@
   <packaging>jar</packaging>
 
   <properties>
-    <dataflow.container_version>beam-master-20170508-pr2933</dataflow.container_version>
+    <dataflow.container_version>beam-master-20170510</dataflow.container_version>
     <dataflow.fnapi_environment_major_version>1</dataflow.fnapi_environment_major_version>
     <dataflow.legacy_environment_major_version>6</dataflow.legacy_environment_major_version>
   </properties>
diff --git a/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/DataflowMetrics.java b/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/DataflowMetrics.java
index aa80959932e..a6a6a43e3f6 100644
--- a/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/DataflowMetrics.java
+++ b/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/DataflowMetrics.java
@@ -28,10 +28,10 @@ import java.util.Collections;
 import java.util.HashMap;
 import java.util.HashSet;
 import java.util.List;
+import org.apache.beam.runners.core.metrics.MetricFiltering;
+import org.apache.beam.runners.core.metrics.MetricKey;
 import org.apache.beam.sdk.metrics.DistributionResult;
 import org.apache.beam.sdk.metrics.GaugeResult;
-import org.apache.beam.sdk.metrics.MetricFiltering;
-import org.apache.beam.sdk.metrics.MetricKey;
 import org.apache.beam.sdk.metrics.MetricName;
 import org.apache.beam.sdk.metrics.MetricQueryResults;
 import org.apache.beam.sdk.metrics.MetricResult;
diff --git a/runners/google-cloud-dataflow-java/src/test/java/org/apache/beam/runners/dataflow/DataflowMetricsTest.java b/runners/google-cloud-dataflow-java/src/test/java/org/apache/beam/runners/dataflow/DataflowMetricsTest.java
index bca3428132e..85a0979b3c6 100644
--- a/runners/google-cloud-dataflow-java/src/test/java/org/apache/beam/runners/dataflow/DataflowMetricsTest.java
+++ b/runners/google-cloud-dataflow-java/src/test/java/org/apache/beam/runners/dataflow/DataflowMetricsTest.java
@@ -17,8 +17,8 @@
  */
 package org.apache.beam.runners.dataflow;
 
-import static org.apache.beam.sdk.metrics.MetricMatchers.attemptedMetricsResult;
-import static org.apache.beam.sdk.metrics.MetricMatchers.committedMetricsResult;
+import static org.apache.beam.sdk.metrics.MetricResultsMatchers.attemptedMetricsResult;
+import static org.apache.beam.sdk.metrics.MetricResultsMatchers.committedMetricsResult;
 import static org.hamcrest.MatcherAssert.assertThat;
 import static org.hamcrest.Matchers.containsInAnyOrder;
 import static org.hamcrest.Matchers.empty;
diff --git a/runners/spark/src/main/java/org/apache/beam/runners/spark/SparkPipelineResult.java b/runners/spark/src/main/java/org/apache/beam/runners/spark/SparkPipelineResult.java
index 3986e337dd7..7fd6962f5a7 100644
--- a/runners/spark/src/main/java/org/apache/beam/runners/spark/SparkPipelineResult.java
+++ b/runners/spark/src/main/java/org/apache/beam/runners/spark/SparkPipelineResult.java
@@ -18,7 +18,7 @@
 
 package org.apache.beam.runners.spark;
 
-import static org.apache.beam.sdk.metrics.MetricsContainerStepMap.asAttemptedOnlyMetricResults;
+import static org.apache.beam.runners.core.metrics.MetricsContainerStepMap.asAttemptedOnlyMetricResults;
 
 import java.io.IOException;
 import java.util.Objects;
diff --git a/runners/spark/src/main/java/org/apache/beam/runners/spark/io/SourceRDD.java b/runners/spark/src/main/java/org/apache/beam/runners/spark/io/SourceRDD.java
index aa89c59fc4b..01cc1762413 100644
--- a/runners/spark/src/main/java/org/apache/beam/runners/spark/io/SourceRDD.java
+++ b/runners/spark/src/main/java/org/apache/beam/runners/spark/io/SourceRDD.java
@@ -28,13 +28,13 @@ import java.util.Collections;
 import java.util.Iterator;
 import java.util.List;
 import java.util.NoSuchElementException;
+import org.apache.beam.runners.core.metrics.MetricsContainerStepMap;
 import org.apache.beam.runners.spark.metrics.MetricsAccumulator;
 import org.apache.beam.runners.spark.translation.SparkRuntimeContext;
 import org.apache.beam.sdk.io.BoundedSource;
 import org.apache.beam.sdk.io.Source;
 import org.apache.beam.sdk.io.UnboundedSource;
 import org.apache.beam.sdk.metrics.MetricsContainer;
-import org.apache.beam.sdk.metrics.MetricsContainerStepMap;
 import org.apache.beam.sdk.metrics.MetricsEnvironment;
 import org.apache.beam.sdk.util.WindowedValue;
 import org.apache.spark.Accumulator;
diff --git a/runners/spark/src/main/java/org/apache/beam/runners/spark/io/SparkUnboundedSource.java b/runners/spark/src/main/java/org/apache/beam/runners/spark/io/SparkUnboundedSource.java
index 2a9de4b9846..7106c73866a 100644
--- a/runners/spark/src/main/java/org/apache/beam/runners/spark/io/SparkUnboundedSource.java
+++ b/runners/spark/src/main/java/org/apache/beam/runners/spark/io/SparkUnboundedSource.java
@@ -22,6 +22,7 @@ import java.io.Closeable;
 import java.io.IOException;
 import java.io.Serializable;
 import java.util.Collections;
+import org.apache.beam.runners.core.metrics.MetricsContainerStepMap;
 import org.apache.beam.runners.spark.SparkPipelineOptions;
 import org.apache.beam.runners.spark.coders.CoderHelpers;
 import org.apache.beam.runners.spark.metrics.MetricsAccumulator;
@@ -36,7 +37,6 @@ import org.apache.beam.sdk.io.UnboundedSource.CheckpointMark;
 import org.apache.beam.sdk.metrics.Gauge;
 import org.apache.beam.sdk.metrics.Metrics;
 import org.apache.beam.sdk.metrics.MetricsContainer;
-import org.apache.beam.sdk.metrics.MetricsContainerStepMap;
 import org.apache.beam.sdk.metrics.MetricsEnvironment;
 import org.apache.beam.sdk.transforms.windowing.BoundedWindow;
 import org.apache.beam.sdk.transforms.windowing.GlobalWindow;
diff --git a/runners/spark/src/main/java/org/apache/beam/runners/spark/metrics/MetricsAccumulator.java b/runners/spark/src/main/java/org/apache/beam/runners/spark/metrics/MetricsAccumulator.java
index 1dcfa2f11f0..03b218769e5 100644
--- a/runners/spark/src/main/java/org/apache/beam/runners/spark/metrics/MetricsAccumulator.java
+++ b/runners/spark/src/main/java/org/apache/beam/runners/spark/metrics/MetricsAccumulator.java
@@ -21,10 +21,10 @@ package org.apache.beam.runners.spark.metrics;
 import com.google.common.annotations.VisibleForTesting;
 import com.google.common.base.Optional;
 import java.io.IOException;
+import org.apache.beam.runners.core.metrics.MetricsContainerStepMap;
 import org.apache.beam.runners.spark.SparkPipelineOptions;
 import org.apache.beam.runners.spark.translation.streaming.Checkpoint;
 import org.apache.beam.runners.spark.translation.streaming.Checkpoint.CheckpointDir;
-import org.apache.beam.sdk.metrics.MetricsContainerStepMap;
 import org.apache.hadoop.fs.FileSystem;
 import org.apache.hadoop.fs.Path;
 import org.apache.spark.Accumulator;
diff --git a/runners/spark/src/main/java/org/apache/beam/runners/spark/metrics/MetricsAccumulatorParam.java b/runners/spark/src/main/java/org/apache/beam/runners/spark/metrics/MetricsAccumulatorParam.java
index dee4ebc5f82..17cf71ff31f 100644
--- a/runners/spark/src/main/java/org/apache/beam/runners/spark/metrics/MetricsAccumulatorParam.java
+++ b/runners/spark/src/main/java/org/apache/beam/runners/spark/metrics/MetricsAccumulatorParam.java
@@ -18,7 +18,7 @@
 
 package org.apache.beam.runners.spark.metrics;
 
-import org.apache.beam.sdk.metrics.MetricsContainerStepMap;
+import org.apache.beam.runners.core.metrics.MetricsContainerStepMap;
 import org.apache.spark.AccumulatorParam;
 
 
diff --git a/runners/spark/src/main/java/org/apache/beam/runners/spark/metrics/SparkBeamMetric.java b/runners/spark/src/main/java/org/apache/beam/runners/spark/metrics/SparkBeamMetric.java
index e4bd5989eb7..5e67445931a 100644
--- a/runners/spark/src/main/java/org/apache/beam/runners/spark/metrics/SparkBeamMetric.java
+++ b/runners/spark/src/main/java/org/apache/beam/runners/spark/metrics/SparkBeamMetric.java
@@ -18,19 +18,19 @@
 
 package org.apache.beam.runners.spark.metrics;
 
-import static org.apache.beam.sdk.metrics.MetricsContainerStepMap.asAttemptedOnlyMetricResults;
+import static org.apache.beam.runners.core.metrics.MetricsContainerStepMap.asAttemptedOnlyMetricResults;
 
 import com.codahale.metrics.Metric;
 import com.google.common.annotations.VisibleForTesting;
 import java.util.HashMap;
 import java.util.Map;
+import org.apache.beam.runners.core.metrics.MetricsContainerStepMap;
 import org.apache.beam.sdk.metrics.DistributionResult;
 import org.apache.beam.sdk.metrics.GaugeResult;
 import org.apache.beam.sdk.metrics.MetricName;
 import org.apache.beam.sdk.metrics.MetricQueryResults;
 import org.apache.beam.sdk.metrics.MetricResult;
 import org.apache.beam.sdk.metrics.MetricResults;
-import org.apache.beam.sdk.metrics.MetricsContainerStepMap;
 import org.apache.beam.sdk.metrics.MetricsFilter;
 
 
diff --git a/runners/spark/src/main/java/org/apache/beam/runners/spark/stateful/SparkGroupAlsoByWindowViaWindowSet.java b/runners/spark/src/main/java/org/apache/beam/runners/spark/stateful/SparkGroupAlsoByWindowViaWindowSet.java
index 37d9635ff5e..1d843f90fb2 100644
--- a/runners/spark/src/main/java/org/apache/beam/runners/spark/stateful/SparkGroupAlsoByWindowViaWindowSet.java
+++ b/runners/spark/src/main/java/org/apache/beam/runners/spark/stateful/SparkGroupAlsoByWindowViaWindowSet.java
@@ -31,6 +31,8 @@ import org.apache.beam.runners.core.SystemReduceFn;
 import org.apache.beam.runners.core.TimerInternals;
 import org.apache.beam.runners.core.UnsupportedSideInputReader;
 import org.apache.beam.runners.core.construction.Triggers;
+import org.apache.beam.runners.core.metrics.CounterCell;
+import org.apache.beam.runners.core.metrics.MetricsContainerImpl;
 import org.apache.beam.runners.core.triggers.ExecutableTriggerStateMachine;
 import org.apache.beam.runners.core.triggers.TriggerStateMachines;
 import org.apache.beam.runners.spark.SparkPipelineOptions;
@@ -43,9 +45,7 @@ import org.apache.beam.runners.spark.util.GlobalWatermarkHolder;
 import org.apache.beam.sdk.coders.Coder;
 import org.apache.beam.sdk.coders.IterableCoder;
 import org.apache.beam.sdk.coders.KvCoder;
-import org.apache.beam.sdk.metrics.CounterCell;
 import org.apache.beam.sdk.metrics.MetricName;
-import org.apache.beam.sdk.metrics.MetricsContainer;
 import org.apache.beam.sdk.transforms.windowing.BoundedWindow;
 import org.apache.beam.sdk.transforms.windowing.PaneInfo;
 import org.apache.beam.sdk.util.WindowedValue;
@@ -207,7 +207,7 @@ public class SparkGroupAlsoByWindowViaWindowSet {
             new OutputWindowedValueHolder<>();
         // use in memory Aggregators since Spark Accumulators are not resilient
         // in stateful operators, once done with this partition.
-        final MetricsContainer cellProvider = new MetricsContainer("cellProvider");
+        final MetricsContainerImpl cellProvider = new MetricsContainerImpl("cellProvider");
         final CounterCell droppedDueToClosedWindow = cellProvider.getCounter(
             MetricName.named(SparkGroupAlsoByWindowViaWindowSet.class,
             GroupAlsoByWindowsDoFn.DROPPED_DUE_TO_CLOSED_WINDOW_COUNTER));
@@ -321,12 +321,12 @@ public class SparkGroupAlsoByWindowViaWindowSet {
         long lateDropped = droppedDueToLateness.getCumulative();
         if (lateDropped > 0) {
           LOG.info(String.format("Dropped %d elements due to lateness.", lateDropped));
-          droppedDueToLateness.update(-droppedDueToLateness.getCumulative());
+          droppedDueToLateness.inc(-droppedDueToLateness.getCumulative());
         }
         long closedWindowDropped = droppedDueToClosedWindow.getCumulative();
         if (closedWindowDropped > 0) {
           LOG.info(String.format("Dropped %d elements due to closed window.", closedWindowDropped));
-          droppedDueToClosedWindow.update(-droppedDueToClosedWindow.getCumulative());
+          droppedDueToClosedWindow.inc(-droppedDueToClosedWindow.getCumulative());
         }
 
         return scala.collection.JavaConversions.asScalaIterator(outIter);
diff --git a/runners/spark/src/main/java/org/apache/beam/runners/spark/stateful/StateSpecFunctions.java b/runners/spark/src/main/java/org/apache/beam/runners/spark/stateful/StateSpecFunctions.java
index 17a3c7344bb..549bd30a11a 100644
--- a/runners/spark/src/main/java/org/apache/beam/runners/spark/stateful/StateSpecFunctions.java
+++ b/runners/spark/src/main/java/org/apache/beam/runners/spark/stateful/StateSpecFunctions.java
@@ -27,6 +27,7 @@ import java.io.Serializable;
 import java.util.ArrayList;
 import java.util.List;
 import java.util.concurrent.TimeUnit;
+import org.apache.beam.runners.core.metrics.MetricsContainerStepMap;
 import org.apache.beam.runners.spark.coders.CoderHelpers;
 import org.apache.beam.runners.spark.io.EmptyCheckpointMark;
 import org.apache.beam.runners.spark.io.MicrobatchSource;
@@ -36,7 +37,6 @@ import org.apache.beam.sdk.coders.Coder;
 import org.apache.beam.sdk.io.Source;
 import org.apache.beam.sdk.io.UnboundedSource;
 import org.apache.beam.sdk.metrics.MetricsContainer;
-import org.apache.beam.sdk.metrics.MetricsContainerStepMap;
 import org.apache.beam.sdk.metrics.MetricsEnvironment;
 import org.apache.beam.sdk.transforms.windowing.BoundedWindow;
 import org.apache.beam.sdk.transforms.windowing.GlobalWindow;
diff --git a/runners/spark/src/main/java/org/apache/beam/runners/spark/translation/DoFnRunnerWithMetrics.java b/runners/spark/src/main/java/org/apache/beam/runners/spark/translation/DoFnRunnerWithMetrics.java
index 8349b09fab1..394b80b0931 100644
--- a/runners/spark/src/main/java/org/apache/beam/runners/spark/translation/DoFnRunnerWithMetrics.java
+++ b/runners/spark/src/main/java/org/apache/beam/runners/spark/translation/DoFnRunnerWithMetrics.java
@@ -21,8 +21,9 @@ package org.apache.beam.runners.spark.translation;
 import java.io.Closeable;
 import java.io.IOException;
 import org.apache.beam.runners.core.DoFnRunner;
+import org.apache.beam.runners.core.metrics.MetricsContainerImpl;
+import org.apache.beam.runners.core.metrics.MetricsContainerStepMap;
 import org.apache.beam.sdk.metrics.MetricsContainer;
-import org.apache.beam.sdk.metrics.MetricsContainerStepMap;
 import org.apache.beam.sdk.metrics.MetricsEnvironment;
 import org.apache.beam.sdk.state.TimeDomain;
 import org.apache.beam.sdk.transforms.windowing.BoundedWindow;
@@ -32,7 +33,7 @@ import org.joda.time.Instant;
 
 
 /**
- * DoFnRunner decorator which registers {@link org.apache.beam.sdk.metrics.MetricsContainer}.
+ * DoFnRunner decorator which registers {@link MetricsContainerImpl}.
  */
 class DoFnRunnerWithMetrics<InputT, OutputT> implements DoFnRunner<InputT, OutputT> {
   private final DoFnRunner<InputT, OutputT> delegate;
diff --git a/runners/spark/src/main/java/org/apache/beam/runners/spark/translation/MultiDoFnFunction.java b/runners/spark/src/main/java/org/apache/beam/runners/spark/translation/MultiDoFnFunction.java
index ecf96b62f5a..4a665417a07 100644
--- a/runners/spark/src/main/java/org/apache/beam/runners/spark/translation/MultiDoFnFunction.java
+++ b/runners/spark/src/main/java/org/apache/beam/runners/spark/translation/MultiDoFnFunction.java
@@ -27,10 +27,10 @@ import java.util.Iterator;
 import java.util.Map;
 import org.apache.beam.runners.core.DoFnRunner;
 import org.apache.beam.runners.core.DoFnRunners;
+import org.apache.beam.runners.core.metrics.MetricsContainerStepMap;
 import org.apache.beam.runners.spark.aggregators.NamedAggregators;
 import org.apache.beam.runners.spark.util.SideInputBroadcast;
 import org.apache.beam.runners.spark.util.SparkSideInputReader;
-import org.apache.beam.sdk.metrics.MetricsContainerStepMap;
 import org.apache.beam.sdk.transforms.DoFn;
 import org.apache.beam.sdk.util.WindowedValue;
 import org.apache.beam.sdk.values.KV;
diff --git a/runners/spark/src/main/java/org/apache/beam/runners/spark/translation/TransformTranslator.java b/runners/spark/src/main/java/org/apache/beam/runners/spark/translation/TransformTranslator.java
index acbac32840d..b2ed3a9265d 100644
--- a/runners/spark/src/main/java/org/apache/beam/runners/spark/translation/TransformTranslator.java
+++ b/runners/spark/src/main/java/org/apache/beam/runners/spark/translation/TransformTranslator.java
@@ -30,6 +30,7 @@ import java.util.Collection;
 import java.util.Collections;
 import java.util.Map;
 import org.apache.beam.runners.core.SystemReduceFn;
+import org.apache.beam.runners.core.metrics.MetricsContainerStepMap;
 import org.apache.beam.runners.spark.aggregators.AggregatorsAccumulator;
 import org.apache.beam.runners.spark.aggregators.NamedAggregators;
 import org.apache.beam.runners.spark.coders.CoderHelpers;
@@ -41,7 +42,6 @@ import org.apache.beam.sdk.coders.Coder;
 import org.apache.beam.sdk.coders.KvCoder;
 import org.apache.beam.sdk.coders.StringUtf8Coder;
 import org.apache.beam.sdk.io.Read;
-import org.apache.beam.sdk.metrics.MetricsContainerStepMap;
 import org.apache.beam.sdk.transforms.Combine;
 import org.apache.beam.sdk.transforms.CombineWithContext;
 import org.apache.beam.sdk.transforms.Create;
diff --git a/runners/spark/src/main/java/org/apache/beam/runners/spark/translation/streaming/StreamingTransformTranslator.java b/runners/spark/src/main/java/org/apache/beam/runners/spark/translation/streaming/StreamingTransformTranslator.java
index f736e5305b3..acb4a02f1e9 100644
--- a/runners/spark/src/main/java/org/apache/beam/runners/spark/translation/streaming/StreamingTransformTranslator.java
+++ b/runners/spark/src/main/java/org/apache/beam/runners/spark/translation/streaming/StreamingTransformTranslator.java
@@ -32,6 +32,7 @@ import java.util.Map;
 import java.util.Queue;
 import java.util.concurrent.LinkedBlockingQueue;
 import javax.annotation.Nonnull;
+import org.apache.beam.runners.core.metrics.MetricsContainerStepMap;
 import org.apache.beam.runners.spark.aggregators.AggregatorsAccumulator;
 import org.apache.beam.runners.spark.aggregators.NamedAggregators;
 import org.apache.beam.runners.spark.coders.CoderHelpers;
@@ -58,7 +59,6 @@ import org.apache.beam.runners.spark.util.SideInputBroadcast;
 import org.apache.beam.sdk.coders.Coder;
 import org.apache.beam.sdk.coders.KvCoder;
 import org.apache.beam.sdk.io.Read;
-import org.apache.beam.sdk.metrics.MetricsContainerStepMap;
 import org.apache.beam.sdk.transforms.Combine;
 import org.apache.beam.sdk.transforms.CombineWithContext;
 import org.apache.beam.sdk.transforms.DoFn;
diff --git a/runners/spark/src/test/java/org/apache/beam/runners/spark/io/ReaderToIteratorAdapterTest.java b/runners/spark/src/test/java/org/apache/beam/runners/spark/io/ReaderToIteratorAdapterTest.java
index 86f35ba0955..5728fa04485 100644
--- a/runners/spark/src/test/java/org/apache/beam/runners/spark/io/ReaderToIteratorAdapterTest.java
+++ b/runners/spark/src/test/java/org/apache/beam/runners/spark/io/ReaderToIteratorAdapterTest.java
@@ -24,8 +24,8 @@ import static org.junit.Assert.assertThat;
 
 import java.io.IOException;
 import java.util.NoSuchElementException;
+import org.apache.beam.runners.core.metrics.MetricsContainerImpl;
 import org.apache.beam.sdk.io.Source;
-import org.apache.beam.sdk.metrics.MetricsContainer;
 import org.joda.time.Instant;
 import org.junit.Rule;
 import org.junit.Test;
@@ -91,7 +91,7 @@ public class ReaderToIteratorAdapterTest {
   private final TestReader testReader = new TestReader();
 
   private final SourceRDD.Bounded.ReaderToIteratorAdapter<Integer> readerIterator =
-      new SourceRDD.Bounded.ReaderToIteratorAdapter<>(new MetricsContainer(""), testReader);
+      new SourceRDD.Bounded.ReaderToIteratorAdapter<>(new MetricsContainerImpl(""), testReader);
 
   private void assertReaderRange(final int start, final int end) {
     for (int i = start; i < end; i++) {
diff --git a/runners/spark/src/test/java/org/apache/beam/runners/spark/translation/streaming/ResumeFromCheckpointStreamingTest.java b/runners/spark/src/test/java/org/apache/beam/runners/spark/translation/streaming/ResumeFromCheckpointStreamingTest.java
index 584edace250..254a318da8d 100644
--- a/runners/spark/src/test/java/org/apache/beam/runners/spark/translation/streaming/ResumeFromCheckpointStreamingTest.java
+++ b/runners/spark/src/test/java/org/apache/beam/runners/spark/translation/streaming/ResumeFromCheckpointStreamingTest.java
@@ -17,7 +17,7 @@
  */
 package org.apache.beam.runners.spark.translation.streaming;
 
-import static org.apache.beam.sdk.metrics.MetricMatchers.attemptedMetricsResult;
+import static org.apache.beam.sdk.metrics.MetricResultsMatchers.attemptedMetricsResult;
 import static org.hamcrest.Matchers.containsInAnyOrder;
 import static org.hamcrest.Matchers.hasItem;
 import static org.hamcrest.Matchers.is;
diff --git a/runners/spark/src/test/java/org/apache/beam/runners/spark/translation/streaming/StreamingSourceMetricsTest.java b/runners/spark/src/test/java/org/apache/beam/runners/spark/translation/streaming/StreamingSourceMetricsTest.java
index df6027cf349..cafd539f7fc 100644
--- a/runners/spark/src/test/java/org/apache/beam/runners/spark/translation/streaming/StreamingSourceMetricsTest.java
+++ b/runners/spark/src/test/java/org/apache/beam/runners/spark/translation/streaming/StreamingSourceMetricsTest.java
@@ -18,7 +18,7 @@
 
 package org.apache.beam.runners.spark.translation.streaming;
 
-import static org.apache.beam.sdk.metrics.MetricMatchers.attemptedMetricsResult;
+import static org.apache.beam.sdk.metrics.MetricResultsMatchers.attemptedMetricsResult;
 import static org.hamcrest.Matchers.hasItem;
 import static org.junit.Assert.assertThat;
 
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/DistributionResult.java b/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/DistributionResult.java
index 27c242c0991..b01ae4646b3 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/DistributionResult.java
+++ b/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/DistributionResult.java
@@ -18,10 +18,13 @@
 package org.apache.beam.sdk.metrics;
 
 import com.google.auto.value.AutoValue;
+import org.apache.beam.sdk.annotations.Experimental;
+import org.apache.beam.sdk.annotations.Experimental.Kind;
 
 /**
  * The result of a {@link Distribution} metric.
  */
+@Experimental(Kind.METRICS)
 @AutoValue
 public abstract class DistributionResult {
 
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/GaugeResult.java b/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/GaugeResult.java
index 878776a7887..f24ded213dc 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/GaugeResult.java
+++ b/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/GaugeResult.java
@@ -18,11 +18,14 @@
 package org.apache.beam.sdk.metrics;
 
 import com.google.auto.value.AutoValue;
+import org.apache.beam.sdk.annotations.Experimental;
+import org.apache.beam.sdk.annotations.Experimental.Kind;
 import org.joda.time.Instant;
 
 /**
  * The result of a {@link Gauge} metric.
  */
+@Experimental(Kind.METRICS)
 @AutoValue
 public abstract class GaugeResult {
   public abstract long value();
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/Metric.java b/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/Metric.java
index dcd8a04ec23..fdcc93cd8bc 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/Metric.java
+++ b/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/Metric.java
@@ -18,10 +18,15 @@
 
 package org.apache.beam.sdk.metrics;
 
+import java.io.Serializable;
+import org.apache.beam.sdk.annotations.Experimental;
+import org.apache.beam.sdk.annotations.Experimental.Kind;
+
 /**
  * Marker interface for all user-facing metrics.
  */
-public interface Metric {
+@Experimental(Kind.METRICS)
+public interface Metric extends Serializable {
 
   /**
    * The {@link MetricName} given to this metric.
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/Metrics.java b/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/Metrics.java
index 096d147d101..bad1f10bc34 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/Metrics.java
+++ b/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/Metrics.java
@@ -102,7 +102,7 @@ public class Metrics {
   }
 
   /** Implementation of {@link Counter} that delegates to the instance for the current context. */
-  private static class DelegatingCounter implements Counter, Serializable {
+  private static class DelegatingCounter implements Metric, Counter, Serializable {
     private final MetricName name;
 
     private DelegatingCounter(MetricName name) {
@@ -118,7 +118,7 @@ public class Metrics {
     @Override public void inc(long n) {
       MetricsContainer container = MetricsEnvironment.getCurrentContainer();
       if (container != null) {
-        container.getCounter(name).update(n);
+        container.getCounter(name).inc(n);
       }
     }
 
@@ -140,7 +140,7 @@ public class Metrics {
   /**
    * Implementation of {@link Distribution} that delegates to the instance for the current context.
    */
-  private static class DelegatingDistribution implements Distribution, Serializable {
+  private static class DelegatingDistribution implements Metric, Distribution, Serializable {
     private final MetricName name;
 
     private DelegatingDistribution(MetricName name) {
@@ -163,7 +163,7 @@ public class Metrics {
   /**
    * Implementation of {@link Gauge} that delegates to the instance for the current context.
    */
-  private static class DelegatingGauge implements Gauge, Serializable {
+  private static class DelegatingGauge implements Metric, Gauge, Serializable {
     private final MetricName name;
 
     private DelegatingGauge(MetricName name) {
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricsContainer.java b/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricsContainer.java
index 48fa3591397..62b0806906f 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricsContainer.java
+++ b/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricsContainer.java
@@ -15,164 +15,34 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.beam.sdk.metrics;
 
-import static com.google.common.base.Preconditions.checkNotNull;
+package org.apache.beam.sdk.metrics;
 
-import com.google.common.collect.ImmutableList;
 import java.io.Serializable;
-import java.util.Map;
 import org.apache.beam.sdk.annotations.Experimental;
 import org.apache.beam.sdk.annotations.Experimental.Kind;
-import org.apache.beam.sdk.metrics.MetricUpdates.MetricUpdate;
 
 /**
  * Holds the metrics for a single step and unit-of-commit (bundle).
- *
- * <p>This class is thread-safe. It is intended to be used with 1 (or more) threads are updating
- * metrics and at-most 1 thread is extracting updates by calling {@link #getUpdates} and
- * {@link #commitUpdates}. Outside of this it is still safe. Although races in the update extraction
- * may cause updates that don't actually have any changes, it will never lose an update.
- *
- * <p>For consistency, all threads that update metrics should finish before getting the final
- * cumulative values/updates.
  */
 @Experimental(Kind.METRICS)
-public class MetricsContainer implements Serializable {
-
-  private final String stepName;
-
-  private MetricsMap<MetricName, CounterCell> counters =
-      new MetricsMap<>(new MetricsMap.Factory<MetricName, CounterCell>() {
-        @Override
-        public CounterCell createInstance(MetricName unusedKey) {
-          return new CounterCell();
-        }
-      });
-
-  private MetricsMap<MetricName, DistributionCell> distributions =
-      new MetricsMap<>(new MetricsMap.Factory<MetricName, DistributionCell>() {
-        @Override
-        public DistributionCell createInstance(MetricName unusedKey) {
-          return new DistributionCell();
-        }
-      });
-
-  private MetricsMap<MetricName, GaugeCell> gauges =
-      new MetricsMap<>(new MetricsMap.Factory<MetricName, GaugeCell>() {
-        @Override
-        public GaugeCell createInstance(MetricName unusedKey) {
-          return new GaugeCell();
-        }
-      });
-
-  /**
-   * Create a new {@link MetricsContainer} associated with the given {@code stepName}.
-   */
-  public MetricsContainer(String stepName) {
-    this.stepName = stepName;
-  }
+public interface MetricsContainer extends Serializable {
 
   /**
-   * Return the {@link CounterCell} that should be used for implementing the given
+   * Return the {@link Counter} that should be used for implementing the given
    * {@code metricName} in this container.
    */
-  public CounterCell getCounter(MetricName metricName) {
-    return counters.get(metricName);
-  }
+  Counter getCounter(MetricName metricName);
 
   /**
-   * Return the {@link DistributionCell} that should be used for implementing the given
+   * Return the {@link Distribution} that should be used for implementing the given
    * {@code metricName} in this container.
    */
-  public DistributionCell getDistribution(MetricName metricName) {
-    return distributions.get(metricName);
-  }
+  Distribution getDistribution(MetricName metricName);
 
   /**
-   * Return the {@link GaugeCell} that should be used for implementing the given
+   * Return the {@link Gauge} that should be used for implementing the given
    * {@code metricName} in this container.
    */
-  public GaugeCell getGauge(MetricName metricName) {
-    return gauges.get(metricName);
-  }
-
-  private <UserT extends Metric, UpdateT, CellT extends MetricCell<UserT, UpdateT>>
-  ImmutableList<MetricUpdate<UpdateT>> extractUpdates(
-      MetricsMap<MetricName, CellT> cells) {
-    ImmutableList.Builder<MetricUpdate<UpdateT>> updates = ImmutableList.builder();
-    for (Map.Entry<MetricName, CellT> cell : cells.entries()) {
-      if (cell.getValue().getDirty().beforeCommit()) {
-        updates.add(MetricUpdate.create(MetricKey.create(stepName, cell.getKey()),
-            cell.getValue().getCumulative()));
-      }
-    }
-    return updates.build();
-  }
-
-  /**
-   * Return the cumulative values for any metrics that have changed since the last time updates were
-   * committed.
-   */
-  public MetricUpdates getUpdates() {
-    return MetricUpdates.create(
-        extractUpdates(counters),
-        extractUpdates(distributions),
-        extractUpdates(gauges));
-  }
-
-  private void commitUpdates(MetricsMap<MetricName, ? extends MetricCell<?, ?>> cells) {
-    for (MetricCell<?, ?> cell : cells.values()) {
-      cell.getDirty().afterCommit();
-    }
-  }
-
-  /**
-   * Mark all of the updates that were retrieved with the latest call to {@link #getUpdates()} as
-   * committed.
-   */
-  public void commitUpdates() {
-    commitUpdates(counters);
-    commitUpdates(distributions);
-    commitUpdates(gauges);
-  }
-
-  private <UserT extends Metric, UpdateT, CellT extends MetricCell<UserT, UpdateT>>
-  ImmutableList<MetricUpdate<UpdateT>> extractCumulatives(
-      MetricsMap<MetricName, CellT> cells) {
-    ImmutableList.Builder<MetricUpdate<UpdateT>> updates = ImmutableList.builder();
-    for (Map.Entry<MetricName, CellT> cell : cells.entries()) {
-      UpdateT update = checkNotNull(cell.getValue().getCumulative());
-      updates.add(MetricUpdate.create(MetricKey.create(stepName, cell.getKey()), update));
-    }
-    return updates.build();
-  }
-
-  /**
-   * Return the {@link MetricUpdates} representing the cumulative values of all metrics in this
-   * container.
-   */
-  public MetricUpdates getCumulative() {
-    return MetricUpdates.create(
-        extractCumulatives(counters),
-        extractCumulatives(distributions),
-        extractCumulatives(gauges));
-  }
-
-  /**
-   * Update values of this {@link MetricsContainer} by merging the value of another cell.
-   */
-  public void update(MetricsContainer other) {
-    updateCells(counters, other.counters);
-    updateCells(distributions, other.distributions);
-    updateCells(gauges, other.gauges);
-  }
-
-  private <UserT extends Metric, DataT, CellT extends MetricCell<UserT, DataT>> void updateCells(
-      MetricsMap<MetricName, CellT> current,
-      MetricsMap<MetricName, CellT> updates) {
-    for (Map.Entry<MetricName, CellT> counter : updates.entries()) {
-      current.get(counter.getKey()).update(counter.getValue());
-    }
-  }
+  Gauge getGauge(MetricName metricName);
 }
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricsEnvironment.java b/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricsEnvironment.java
index a4b311ffd43..dadec339283 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricsEnvironment.java
+++ b/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricsEnvironment.java
@@ -21,6 +21,9 @@ import java.io.Closeable;
 import java.io.IOException;
 import java.util.concurrent.atomic.AtomicBoolean;
 import javax.annotation.Nullable;
+import org.apache.beam.sdk.annotations.Experimental;
+import org.apache.beam.sdk.annotations.Experimental.Kind;
+import org.apache.beam.sdk.annotations.Internal;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
@@ -30,7 +33,7 @@ import org.slf4j.LoggerFactory;
  * <p>Users should not interact directly with this class. Instead, use {@link Metrics} and the
  * returned objects to create and modify metrics.
  *
- * <p>The runner should create {@link MetricsContainer} for each context in which metrics are
+ * <p>The runner should create a {@link MetricsContainer} for each context in which metrics are
  * reported (by step and name) and call {@link #setCurrentContainer} before invoking any code that
  * may update metrics within that step. It should call {@link #setCurrentContainer} again to restore
  * the previous container.
@@ -39,9 +42,11 @@ import org.slf4j.LoggerFactory;
  * container for the current thread and get a {@link Closeable} that will restore the previous
  * container when closed.
  */
+@Experimental(Kind.METRICS)
+@Internal
 public class MetricsEnvironment {
 
-  private static final Logger LOG = LoggerFactory.getLogger(MetricsContainer.class);
+  private static final Logger LOG = LoggerFactory.getLogger(MetricsEnvironment.class);
 
   private static final AtomicBoolean METRICS_SUPPORTED = new AtomicBoolean(false);
   private static final AtomicBoolean REPORTED_MISSING_CONTAINER = new AtomicBoolean(false);
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/SinkMetrics.java b/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/SinkMetrics.java
index f96b6aced5e..f6f00bd2503 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/SinkMetrics.java
+++ b/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/SinkMetrics.java
@@ -17,9 +17,13 @@
  */
 package org.apache.beam.sdk.metrics;
 
+import org.apache.beam.sdk.annotations.Experimental;
+import org.apache.beam.sdk.annotations.Experimental.Kind;
+
 /**
  * Standard Sink Metrics.
  */
+@Experimental(Kind.METRICS)
 public class SinkMetrics {
 
   private static final String SINK_NAMESPACE = "sink";
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/SourceMetrics.java b/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/SourceMetrics.java
index 4479f3aecd2..1adbf0c4b6b 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/SourceMetrics.java
+++ b/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/SourceMetrics.java
@@ -18,10 +18,13 @@
 package org.apache.beam.sdk.metrics;
 
 import com.google.common.base.Joiner;
+import org.apache.beam.sdk.annotations.Experimental;
+import org.apache.beam.sdk.annotations.Experimental.Kind;
 
 /**
  * Standard {@link org.apache.beam.sdk.io.Source} Metrics.
  */
+@Experimental(Kind.METRICS)
 public class SourceMetrics {
 
   private static final String SOURCE_NAMESPACE = "source";
diff --git a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricMatchers.java b/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricResultsMatchers.java
similarity index 78%
rename from sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricMatchers.java
rename to sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricResultsMatchers.java
index a0dd1195ec0..50319521595 100644
--- a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricMatchers.java
+++ b/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricResultsMatchers.java
@@ -19,66 +19,14 @@
 package org.apache.beam.sdk.metrics;
 
 import java.util.Objects;
-import org.apache.beam.sdk.metrics.MetricUpdates.MetricUpdate;
 import org.hamcrest.Description;
 import org.hamcrest.Matcher;
 import org.hamcrest.TypeSafeMatcher;
 
 /**
- * Matchers for metrics.
+ * Matchers for {@link MetricResults}.
  */
-public class MetricMatchers {
-
-  /**
-   * Matches a {@link MetricUpdate} with the given name and contents.
-   *
-   * <p>Visible since it may be used in runner-specific tests.
-   */
-  public static <T> Matcher<MetricUpdate<T>> metricUpdate(final String name, final T update) {
-    return new TypeSafeMatcher<MetricUpdate<T>>() {
-      @Override
-      protected boolean matchesSafely(MetricUpdate<T> item) {
-        return Objects.equals(name, item.getKey().metricName().name())
-            && Objects.equals(update, item.getUpdate());
-      }
-
-      @Override
-      public void describeTo(Description description) {
-        description
-            .appendText("MetricUpdate{name=").appendValue(name)
-            .appendText(", update=").appendValue(update)
-            .appendText("}");
-      }
-    };
-  }
-
-  /**
-   * Matches a {@link MetricUpdate} with the given namespace, name, step and contents.
-   *
-   * <p>Visible since it may be used in runner-specific tests.
-   */
-  public static <T> Matcher<MetricUpdate<T>> metricUpdate(
-      final String namespace, final String name, final String step, final T update) {
-    return new TypeSafeMatcher<MetricUpdate<T>>() {
-      @Override
-      protected boolean matchesSafely(MetricUpdate<T> item) {
-        return Objects.equals(namespace, item.getKey().metricName().namespace())
-            && Objects.equals(name, item.getKey().metricName().name())
-            && Objects.equals(step, item.getKey().stepName())
-            && Objects.equals(update, item.getUpdate());
-      }
-
-      @Override
-      public void describeTo(Description description) {
-        description
-            .appendText("MetricUpdate{inNamespace=").appendValue(namespace)
-            .appendText(", name=").appendValue(name)
-            .appendText(", step=").appendValue(step)
-            .appendText(", update=").appendValue(update)
-            .appendText("}");
-      }
-    };
-  }
+public class MetricResultsMatchers {
 
   /**
    * Matches a {@link MetricResult} with the given namespace, name and step, and whose value equals
@@ -164,7 +112,7 @@ public class MetricMatchers {
     return distributionMinMax(namespace, name, step, committedMin, committedMax, true);
   }
 
-  static Matcher<MetricResult<DistributionResult>> distributionMinMax(
+  public static Matcher<MetricResult<DistributionResult>> distributionMinMax(
       final String namespace, final String name, final String step,
       final Long min, final Long max, final boolean isCommitted) {
     final String metricState = isCommitted ? "committed" : "attempted";
diff --git a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsEnvironmentTest.java b/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsEnvironmentTest.java
index 0ce17b4bb9c..a29c13bdc4b 100644
--- a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsEnvironmentTest.java
+++ b/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsEnvironmentTest.java
@@ -18,15 +18,16 @@
 
 package org.apache.beam.sdk.metrics;
 
-import static org.apache.beam.sdk.metrics.MetricMatchers.metricUpdate;
-import static org.hamcrest.Matchers.contains;
 import static org.junit.Assert.assertNull;
-import static org.junit.Assert.assertThat;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.verifyNoMoreInteractions;
+import static org.mockito.Mockito.when;
 
 import org.junit.After;
 import org.junit.Test;
 import org.junit.runner.RunWith;
 import org.junit.runners.JUnit4;
+import org.mockito.Mockito;
 
 /**
  * Tests for {@link MetricsEnvironment}.
@@ -41,8 +42,13 @@ public class MetricsEnvironmentTest {
   @Test
   public void testUsesAppropriateMetricsContainer() {
     Counter counter = Metrics.counter("ns", "name");
-    MetricsContainer c1 = new MetricsContainer("step1");
-    MetricsContainer c2 = new MetricsContainer("step2");
+
+    MetricsContainer c1 = Mockito.mock(MetricsContainer.class);
+    MetricsContainer c2 = Mockito.mock(MetricsContainer.class);
+    Counter counter1 = Mockito.mock(Counter.class);
+    Counter counter2 = Mockito.mock(Counter.class);
+    when(c1.getCounter(MetricName.named("ns", "name"))).thenReturn(counter1);
+    when(c2.getCounter(MetricName.named("ns", "name"))).thenReturn(counter2);
 
     MetricsEnvironment.setCurrentContainer(c1);
     counter.inc();
@@ -50,10 +56,9 @@ public class MetricsEnvironmentTest {
     counter.dec();
     MetricsEnvironment.setCurrentContainer(null);
 
-    MetricUpdates updates1 = c1.getUpdates();
-    MetricUpdates updates2 = c2.getUpdates();
-    assertThat(updates1.counterUpdates(), contains(metricUpdate("ns", "name", "step1", 1L)));
-    assertThat(updates2.counterUpdates(), contains(metricUpdate("ns", "name", "step2", -1L)));
+    verify(counter1).inc(1L);
+    verify(counter2).inc(-1L);
+    verifyNoMoreInteractions(counter1, counter2);
   }
 
   @Test
diff --git a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsTest.java b/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsTest.java
index 084c44508a7..bc768f835e3 100644
--- a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsTest.java
+++ b/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsTest.java
@@ -18,13 +18,14 @@
 
 package org.apache.beam.sdk.metrics;
 
-import static org.apache.beam.sdk.metrics.MetricMatchers.attemptedMetricsResult;
-import static org.apache.beam.sdk.metrics.MetricMatchers.distributionMinMax;
-import static org.apache.beam.sdk.metrics.MetricMatchers.metricsResult;
-import static org.hamcrest.Matchers.equalTo;
+import static org.apache.beam.sdk.metrics.MetricResultsMatchers.attemptedMetricsResult;
+import static org.apache.beam.sdk.metrics.MetricResultsMatchers.distributionMinMax;
+import static org.apache.beam.sdk.metrics.MetricResultsMatchers.metricsResult;
 import static org.hamcrest.Matchers.hasItem;
 import static org.junit.Assert.assertNull;
 import static org.junit.Assert.assertThat;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
 
 import java.io.Serializable;
 import org.apache.beam.sdk.PipelineResult;
@@ -41,13 +42,13 @@ import org.apache.beam.sdk.transforms.DoFn;
 import org.apache.beam.sdk.transforms.ParDo;
 import org.apache.beam.sdk.values.TupleTag;
 import org.apache.beam.sdk.values.TupleTagList;
-import org.hamcrest.CoreMatchers;
 import org.joda.time.Duration;
 import org.joda.time.Instant;
 import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.experimental.categories.Category;
+import org.mockito.Mockito;
 
 /**
  * Tests for {@link Metrics}.
@@ -95,40 +96,40 @@ public class MetricsTest implements Serializable {
 
   @Test
   public void testDistributionToCell() {
-    MetricsContainer container = new MetricsContainer("step");
-    MetricsEnvironment.setCurrentContainer(container);
+    MetricsContainer mockContainer = Mockito.mock(MetricsContainer.class);
+    Distribution mockDistribution = Mockito.mock(Distribution.class);
+    when(mockContainer.getDistribution(METRIC_NAME)).thenReturn(mockDistribution);
 
     Distribution distribution = Metrics.distribution(NS, NAME);
 
+    MetricsEnvironment.setCurrentContainer(mockContainer);
     distribution.update(5L);
 
-    DistributionCell cell = container.getDistribution(METRIC_NAME);
-    assertThat(cell.getCumulative(), equalTo(DistributionData.create(5, 1, 5, 5)));
+    verify(mockDistribution).update(5L);
 
     distribution.update(36L);
-    assertThat(cell.getCumulative(), equalTo(DistributionData.create(41, 2, 5, 36)));
-
     distribution.update(1L);
-    assertThat(cell.getCumulative(), equalTo(DistributionData.create(42, 3, 1, 36)));
+    verify(mockDistribution).update(36L);
+    verify(mockDistribution).update(1L);
   }
 
   @Test
   public void testCounterToCell() {
-    MetricsContainer container = new MetricsContainer("step");
-    MetricsEnvironment.setCurrentContainer(container);
+    MetricsContainer mockContainer = Mockito.mock(MetricsContainer.class);
+    Counter mockCounter = Mockito.mock(Counter.class);
+    when(mockContainer.getCounter(METRIC_NAME)).thenReturn(mockCounter);
+
     Counter counter = Metrics.counter(NS, NAME);
-    CounterCell cell = container.getCounter(METRIC_NAME);
+
+    MetricsEnvironment.setCurrentContainer(mockContainer);
     counter.inc();
-    assertThat(cell.getCumulative(), CoreMatchers.equalTo(1L));
+    verify(mockCounter).inc(1);
 
     counter.inc(47L);
-    assertThat(cell.getCumulative(), CoreMatchers.equalTo(48L));
+    verify(mockCounter).inc(47);
 
     counter.dec(5L);
-    assertThat(cell.getCumulative(), CoreMatchers.equalTo(43L));
-
-    counter.dec();
-    assertThat(cell.getCumulative(), CoreMatchers.equalTo(42L));
+    verify(mockCounter).inc(-5);
   }
 
   @Category({ValidatesRunner.class, UsesCommittedMetrics.class, UsesCounterMetrics.class,
diff --git a/sdks/java/io/kafka/src/test/java/org/apache/beam/sdk/io/kafka/KafkaIOTest.java b/sdks/java/io/kafka/src/test/java/org/apache/beam/sdk/io/kafka/KafkaIOTest.java
index 12b7c78fd8c..691f7f4fdc4 100644
--- a/sdks/java/io/kafka/src/test/java/org/apache/beam/sdk/io/kafka/KafkaIOTest.java
+++ b/sdks/java/io/kafka/src/test/java/org/apache/beam/sdk/io/kafka/KafkaIOTest.java
@@ -17,6 +17,7 @@
  */
 package org.apache.beam.sdk.io.kafka;
 
+import static org.apache.beam.sdk.metrics.MetricResultsMatchers.attemptedMetricsResult;
 import static org.apache.beam.sdk.transforms.display.DisplayDataMatchers.hasDisplayItem;
 import static org.hamcrest.Matchers.hasItem;
 import static org.junit.Assert.assertEquals;
@@ -54,7 +55,6 @@ import org.apache.beam.sdk.io.UnboundedSource;
 import org.apache.beam.sdk.io.UnboundedSource.UnboundedReader;
 import org.apache.beam.sdk.io.kafka.serialization.InstantDeserializer;
 import org.apache.beam.sdk.metrics.GaugeResult;
-import org.apache.beam.sdk.metrics.MetricMatchers;
 import org.apache.beam.sdk.metrics.MetricName;
 import org.apache.beam.sdk.metrics.MetricNameFilter;
 import org.apache.beam.sdk.metrics.MetricQueryResults;
@@ -587,33 +587,29 @@ public class KafkaIOTest {
 
     Iterable<MetricResult<Long>> counters = metrics.counters();
 
-    assertThat(counters, hasItem(
-        MetricMatchers.attemptedMetricsResult(
-            elementsRead.namespace(),
-            elementsRead.name(),
-            readStep,
-            1000L)));
-
-    assertThat(counters, hasItem(
-        MetricMatchers.attemptedMetricsResult(
-            elementsReadBySplit.namespace(),
-            elementsReadBySplit.name(),
-            readStep,
-            1000L)));
-
-    assertThat(counters, hasItem(
-        MetricMatchers.attemptedMetricsResult(
-            bytesRead.namespace(),
-            bytesRead.name(),
-            readStep,
-            12000L)));
-
-    assertThat(counters, hasItem(
-        MetricMatchers.attemptedMetricsResult(
-            bytesReadBySplit.namespace(),
-            bytesReadBySplit.name(),
-            readStep,
-            12000L)));
+    assertThat(counters, hasItem(attemptedMetricsResult(
+        elementsRead.namespace(),
+        elementsRead.name(),
+        readStep,
+        1000L)));
+
+    assertThat(counters, hasItem(attemptedMetricsResult(
+        elementsReadBySplit.namespace(),
+        elementsReadBySplit.name(),
+        readStep,
+        1000L)));
+
+    assertThat(counters, hasItem(attemptedMetricsResult(
+        bytesRead.namespace(),
+        bytesRead.name(),
+        readStep,
+        12000L)));
+
+    assertThat(counters, hasItem(attemptedMetricsResult(
+        bytesReadBySplit.namespace(),
+        bytesReadBySplit.name(),
+        readStep,
+        12000L)));
 
     MetricQueryResults backlogElementsMetrics =
         result.metrics().queryMetrics(
@@ -912,7 +908,7 @@ public class KafkaIOTest {
 
 
       assertThat(metrics.counters(), hasItem(
-          MetricMatchers.attemptedMetricsResult(
+          attemptedMetricsResult(
               elementsWritten.namespace(),
               elementsWritten.name(),
               "writeToKafka",
