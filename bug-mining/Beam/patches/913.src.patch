diff --git a/sdks/python/apache_beam/transforms/util.py b/sdks/python/apache_beam/transforms/util.py
index 38839f57842..046be0b417c 100644
--- a/sdks/python/apache_beam/transforms/util.py
+++ b/sdks/python/apache_beam/transforms/util.py
@@ -281,6 +281,9 @@ class _BatchSizeEstimator(object):
     n = float(len(xs))
     xbar = sum(xs) / n
     ybar = sum(ys) / n
+    if [xs[0]] * len(xs) == xs:
+      # Simply use the mean if all values in xs are same.
+      return 0, ybar/xbar
     b = (sum([(x - xbar) * (y - ybar) for x, y in zip(xs, ys)])
          / sum([(x - xbar)**2 for x in xs]))
     a = ybar - b * xbar
@@ -291,13 +294,16 @@ class _BatchSizeEstimator(object):
     # pylint: disable=wrong-import-order, wrong-import-position
     import numpy as np
     from numpy import sum
+    n = len(xs)
+    if [xs[0]] * n == xs:
+      # If all values of xs are same then fallback to linear_regression_no_numpy
+      return _BatchSizeEstimator.linear_regression_no_numpy(xs, ys)
     xs = np.asarray(xs, dtype=float)
     ys = np.asarray(ys, dtype=float)
 
     # First do a simple least squares fit for y = a + bx over all points.
     b, a = np.polyfit(xs, ys, 1)
 
-    n = len(xs)
     if n < 10:
       return a, b
     else:
diff --git a/sdks/python/apache_beam/transforms/util_test.py b/sdks/python/apache_beam/transforms/util_test.py
index e592f938e17..f0296c0a0f1 100644
--- a/sdks/python/apache_beam/transforms/util_test.py
+++ b/sdks/python/apache_beam/transforms/util_test.py
@@ -18,6 +18,7 @@
 """Unit tests for the transform.util classes."""
 
 from __future__ import absolute_import
+from __future__ import division
 
 import logging
 import random
@@ -160,6 +161,13 @@ class BatchElementsTest(unittest.TestCase):
     self.assertAlmostEqual(a, 5, delta=0.01)
     self.assertAlmostEqual(b, 7, delta=0.01)
 
+    # Test repeated xs
+    xs = [1 + random.random()] * 100
+    ys = [7 * x + 5 + 0.01 * random.random() for x in xs]
+    a, b = linear_regression_fn(xs, ys)
+    self.assertAlmostEqual(a, 0, delta=0.01)
+    self.assertAlmostEqual(b, sum(ys)/(len(ys) * xs[0]), delta=0.01)
+
     if test_outliers:
       xs = [1 + random.random() for _ in range(100)]
       ys = [2*x + 1 for x in xs]
