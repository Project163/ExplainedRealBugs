diff --git a/runners/flink/build.gradle b/runners/flink/build.gradle
index 362288e0c11..133821ff59c 100644
--- a/runners/flink/build.gradle
+++ b/runners/flink/build.gradle
@@ -72,6 +72,7 @@ dependencies {
   shadowTest library.java.junit
   shadowTest library.java.mockito_core
   shadowTest library.java.google_api_services_bigquery
+  shadowTest project(path: ":sdks:java:io:google-cloud-platform", configuration: "shadow")
   shadowTest library.java.jackson_dataformat_yaml
   shadowTest "org.apache.flink:flink-core:$flink_version:tests"
   shadowTest "org.apache.flink:flink-runtime_2.11:$flink_version:tests"
diff --git a/runners/flink/pom.xml b/runners/flink/pom.xml
index cd4d8c32538..20b88618b48 100644
--- a/runners/flink/pom.xml
+++ b/runners/flink/pom.xml
@@ -340,6 +340,12 @@
       <scope>test</scope>
     </dependency>
 
+    <dependency>
+      <groupId>org.apache.beam</groupId>
+      <artifactId>beam-sdks-java-io-google-cloud-platform</artifactId>
+      <scope>test</scope>
+    </dependency>
+
     <dependency>
       <groupId>org.apache.flink</groupId>
       <artifactId>flink-streaming-java_2.11</artifactId>
diff --git a/runners/flink/src/test/java/org/apache/beam/runners/flink/ReadSourceStreamingITCase.java b/runners/flink/src/test/java/org/apache/beam/runners/flink/ReadSourceStreamingITCase.java
index 2f3842599f3..5c366b04d0d 100644
--- a/runners/flink/src/test/java/org/apache/beam/runners/flink/ReadSourceStreamingITCase.java
+++ b/runners/flink/src/test/java/org/apache/beam/runners/flink/ReadSourceStreamingITCase.java
@@ -18,6 +18,7 @@
 package org.apache.beam.runners.flink;
 
 import com.google.common.base.Joiner;
+import java.io.File;
 import org.apache.beam.sdk.Pipeline;
 import org.apache.beam.sdk.io.GenerateSequence;
 import org.apache.beam.sdk.io.TextIO;
@@ -30,6 +31,7 @@ import org.apache.flink.streaming.util.StreamingProgramTestBase;
  */
 public class ReadSourceStreamingITCase extends StreamingProgramTestBase {
 
+  protected String resultDir;
   protected String resultPath;
 
   public ReadSourceStreamingITCase() {
@@ -40,12 +42,16 @@ public class ReadSourceStreamingITCase extends StreamingProgramTestBase {
 
   @Override
   protected void preSubmit() throws Exception {
-    resultPath = getTempDirPath("result");
+    // Beam Write will add shard suffix to fileName, see ShardNameTemplate.
+    // So tempFile need have a parent to compare.
+    File resultParent = createAndRegisterTempFile("result");
+    resultDir = resultParent.toURI().toString();
+    resultPath = new File(resultParent, "file.txt").getAbsolutePath();
   }
 
   @Override
   protected void postSubmit() throws Exception {
-    compareResultsByLinesInMemory(Joiner.on('\n').join(EXPECTED_RESULT), resultPath);
+    compareResultsByLinesInMemory(Joiner.on('\n').join(EXPECTED_RESULT), resultDir);
   }
 
   @Override
diff --git a/runners/flink/src/test/java/org/apache/beam/runners/flink/streaming/TopWikipediaSessionsITCase.java b/runners/flink/src/test/java/org/apache/beam/runners/flink/streaming/TopWikipediaSessionsITCase.java
index b7b0c57ebe7..f6255a33623 100644
--- a/runners/flink/src/test/java/org/apache/beam/runners/flink/streaming/TopWikipediaSessionsITCase.java
+++ b/runners/flink/src/test/java/org/apache/beam/runners/flink/streaming/TopWikipediaSessionsITCase.java
@@ -19,6 +19,7 @@ package org.apache.beam.runners.flink.streaming;
 
 import com.google.api.services.bigquery.model.TableRow;
 import com.google.common.base.Joiner;
+import java.io.File;
 import java.io.Serializable;
 import java.util.Arrays;
 import org.apache.beam.runners.flink.FlinkTestPipeline;
@@ -40,6 +41,8 @@ import org.joda.time.Instant;
  * Session window test.
  */
 public class TopWikipediaSessionsITCase extends StreamingProgramTestBase implements Serializable {
+
+  protected String resultDir;
   protected String resultPath;
 
   public TopWikipediaSessionsITCase() {
@@ -56,12 +59,16 @@ public class TopWikipediaSessionsITCase extends StreamingProgramTestBase impleme
 
   @Override
   protected void preSubmit() throws Exception {
-    resultPath = getTempDirPath("result");
+    // Beam Write will add shard suffix to fileName, see ShardNameTemplate.
+    // So tempFile need have a parent to compare.
+    File resultParent = createAndRegisterTempFile("result");
+    resultDir = resultParent.toURI().toString();
+    resultPath = new File(resultParent, "file.txt").getAbsolutePath();
   }
 
   @Override
   protected void postSubmit() throws Exception {
-    compareResultsByLinesInMemory(Joiner.on('\n').join(EXPECTED_RESULT), resultPath);
+    compareResultsByLinesInMemory(Joiner.on('\n').join(EXPECTED_RESULT), resultDir);
   }
 
   @Override
