diff --git a/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/BatchStatefulParDoOverrides.java b/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/BatchStatefulParDoOverrides.java
index 3cdd1348ac3..d4e94857130 100644
--- a/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/BatchStatefulParDoOverrides.java
+++ b/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/BatchStatefulParDoOverrides.java
@@ -36,6 +36,7 @@ import org.apache.beam.sdk.transforms.PTransform;
 import org.apache.beam.sdk.transforms.ParDo;
 import org.apache.beam.sdk.transforms.ParDo.MultiOutput;
 import org.apache.beam.sdk.transforms.ParDo.SingleOutput;
+import org.apache.beam.sdk.transforms.Reshuffle;
 import org.apache.beam.sdk.transforms.reflect.DoFnInvokers;
 import org.apache.beam.sdk.transforms.reflect.DoFnSignature;
 import org.apache.beam.sdk.transforms.reflect.DoFnSignatures;
@@ -180,10 +181,7 @@ public class BatchStatefulParDoOverrides {
       DataflowRunner.verifyStateSupportForWindowingStrategy(input.getWindowingStrategy());
 
       if (isFnApi) {
-        return input
-            .apply(GroupByKey.create())
-            .apply(ParDo.of(new ExpandGbkFn<>()))
-            .apply(originalParDo);
+        return input.apply(Reshuffle.of()).apply(originalParDo);
       }
 
       PTransform<
@@ -216,10 +214,7 @@ public class BatchStatefulParDoOverrides {
       DataflowRunner.verifyStateSupportForWindowingStrategy(input.getWindowingStrategy());
 
       if (isFnApi) {
-        return input
-            .apply(GroupByKey.create())
-            .apply(ParDo.of(new ExpandGbkFn<>()))
-            .apply(originalParDo);
+        return input.apply(Reshuffle.of()).apply(originalParDo);
       }
 
       PTransform<
@@ -292,20 +287,6 @@ public class BatchStatefulParDoOverrides {
     }
   }
 
-  /**
-   * A key preserving {@link DoFn} that expands the output of a GBK {@code KV<K, Iterable<V>>} into
-   * individual KVs.
-   */
-  static class ExpandGbkFn<K, V> extends DoFn<KV<K, Iterable<V>>, KV<K, V>> {
-    @ProcessElement
-    public void processElement(ProcessContext c) {
-      K k = c.element().getKey();
-      for (V v : c.element().getValue()) {
-        c.output(KV.of(k, v));
-      }
-    }
-  }
-
   /**
    * A key-preserving {@link DoFn} that explodes an iterable that has been grouped by key and
    * window.
