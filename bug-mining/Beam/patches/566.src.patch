diff --git a/sdks/python/apache_beam/pipeline.py b/sdks/python/apache_beam/pipeline.py
index 74bd4cb17d0..f05a0691209 100644
--- a/sdks/python/apache_beam/pipeline.py
+++ b/sdks/python/apache_beam/pipeline.py
@@ -572,7 +572,7 @@ class Pipeline(object):
       ok = True  # Really a nonlocal.
 
       def enter_composite_transform(self, transform_node):
-        self.visit_transform(transform_node)
+        pass
 
       def visit_transform(self, transform_node):
         try:
@@ -822,7 +822,7 @@ class AppliedPTransform(object):
       if transform is None:
         return None
       else:
-        return transform.to_runner_api(context)
+        return transform.to_runner_api(context, has_parts=bool(self.parts))
     return beam_runner_api_pb2.PTransform(
         unique_name=self.full_label,
         spec=transform_to_runner_api(self.transform, context),
diff --git a/sdks/python/apache_beam/portability/python_urns.py b/sdks/python/apache_beam/portability/python_urns.py
index a284b5fe66c..fd8dbbaa9bb 100644
--- a/sdks/python/apache_beam/portability/python_urns.py
+++ b/sdks/python/apache_beam/portability/python_urns.py
@@ -24,7 +24,9 @@ PICKLED_COMBINE_FN = "beam:combinefn:pickled_python:v1"
 PICKLED_DOFN = "beam:dofn:pickled_python:v1"
 PICKLED_DOFN_INFO = "beam:dofn:pickled_python_info:v1"
 PICKLED_SOURCE = "beam:source:pickled_python:v1"
-PICKLED_TRANSFORM = "beam:ptransform:pickled_python:v1"
+PICKLED_TRANSFORM = "beam:transform:pickled_python:v1"
 PICKLED_WINDOW_MAPPING_FN = "beam:window_mapping_fn:pickled_python:v1"
 PICKLED_WINDOWFN = "beam:windowfn:pickled_python:v1"
 PICKLED_VIEWFN = "beam:view_fn:pickled_python_data:v1"
+
+GENERIC_COMPOSITE_TRANSFORM = "beam:transform:generic_composite:v1"
diff --git a/sdks/python/apache_beam/transforms/ptransform.py b/sdks/python/apache_beam/transforms/ptransform.py
index 9d9fe149497..889372f9266 100644
--- a/sdks/python/apache_beam/transforms/ptransform.py
+++ b/sdks/python/apache_beam/transforms/ptransform.py
@@ -45,7 +45,7 @@ import sys
 import threading
 from functools import reduce
 
-from google.protobuf import wrappers_pb2
+from google.protobuf import message
 
 from apache_beam import error
 from apache_beam import pvalue
@@ -537,13 +537,17 @@ class PTransform(WithTypeHints, HasDisplayData):
       # Used as a decorator.
       return register
 
-  def to_runner_api(self, context):
+  def to_runner_api(self, context, has_parts=False):
     from apache_beam.portability.api import beam_runner_api_pb2
     urn, typed_param = self.to_runner_api_parameter(context)
+    if urn == python_urns.GENERIC_COMPOSITE_TRANSFORM and not has_parts:
+      # TODO(BEAM-3812): Remove this fallback.
+      urn, typed_param = self.to_runner_api_pickled(context)
     return beam_runner_api_pb2.FunctionSpec(
         urn=urn,
         payload=typed_param.SerializeToString()
-        if typed_param is not None else None)
+        if isinstance(typed_param, message.Message)
+        else typed_param)
 
   @classmethod
   def from_runner_api(cls, proto, context):
@@ -554,19 +558,26 @@ class PTransform(WithTypeHints, HasDisplayData):
         proto_utils.parse_Bytes(proto.payload, parameter_type),
         context)
 
-  def to_runner_api_parameter(self, context):
+  def to_runner_api_parameter(self, unused_context):
+    # The payload here is just to ease debugging.
+    return (python_urns.GENERIC_COMPOSITE_TRANSFORM,
+            getattr(self, '_fn_api_payload', str(self)))
+
+  def to_runner_api_pickled(self, unused_context):
     return (python_urns.PICKLED_TRANSFORM,
-            wrappers_pb2.BytesValue(value=pickler.dumps(self)))
+            pickler.dumps(self))
+
 
-  @staticmethod
-  def from_runner_api_parameter(spec_parameter, unused_context):
-    return pickler.loads(spec_parameter.value)
+@PTransform.register_urn(python_urns.GENERIC_COMPOSITE_TRANSFORM, None)
+def _create_transform(payload, unused_context):
+  empty_transform = PTransform()
+  empty_transform._fn_api_payload = payload
+  return empty_transform
 
 
-PTransform.register_urn(
-    python_urns.PICKLED_TRANSFORM,
-    wrappers_pb2.BytesValue,
-    PTransform.from_runner_api_parameter)
+@PTransform.register_urn(python_urns.PICKLED_TRANSFORM, None)
+def _unpickle_transform(pickled_bytes, unused_context):
+  return pickler.loads(pickled_bytes)
 
 
 class _ChainedPTransform(PTransform):
diff --git a/sdks/python/apache_beam/utils/urns.py b/sdks/python/apache_beam/utils/urns.py
index e62fbcd0948..a2f040f881a 100644
--- a/sdks/python/apache_beam/utils/urns.py
+++ b/sdks/python/apache_beam/utils/urns.py
@@ -20,6 +20,7 @@
 import abc
 import inspect
 
+from google.protobuf import message
 from google.protobuf import wrappers_pb2
 
 from apache_beam.internal import pickler
@@ -96,7 +97,8 @@ class RunnerApiFn(object):
         spec=beam_runner_api_pb2.FunctionSpec(
             urn=urn,
             payload=typed_param.SerializeToString()
-            if typed_param is not None else None))
+            if isinstance(typed_param, message.Message)
+            else typed_param))
 
   @classmethod
   def from_runner_api(cls, fn_proto, context):
