diff --git a/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/data/QueueingBeamFnDataClient.java b/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/data/QueueingBeamFnDataClient.java
index a1180f95333..21d0b14ed28 100644
--- a/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/data/QueueingBeamFnDataClient.java
+++ b/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/data/QueueingBeamFnDataClient.java
@@ -97,7 +97,7 @@ public class QueueingBeamFnDataClient implements BeamFnDataClient {
     }
 
     boolean isEmpty() {
-      return queue.isEmpty();
+      return queue.isEmpty() || queue.peek() == POISON;
     }
   }
 
