diff --git a/sdks/go/pkg/beam/core/runtime/xlangx/resolve.go b/sdks/go/pkg/beam/core/runtime/xlangx/resolve.go
index b434650d2c7..3b0ea3f4444 100644
--- a/sdks/go/pkg/beam/core/runtime/xlangx/resolve.go
+++ b/sdks/go/pkg/beam/core/runtime/xlangx/resolve.go
@@ -80,7 +80,7 @@ func ResolveArtifactsWithConfig(ctx context.Context, edges []*graph.MultiEdge, c
 	}
 	paths = make(map[string]string)
 	for _, e := range edges {
-		if e.Op == graph.External {
+		if e.Op == graph.External && e.External != nil {
 			components, err := graphx.ExpandedComponents(e.External.Expanded)
 			if err != nil {
 				return nil, errors.WithContextf(err,
diff --git a/sdks/go/pkg/beam/io/pubsubio/pubsubio.go b/sdks/go/pkg/beam/io/pubsubio/pubsubio.go
index 5232a5e4e15..2d93c6ab71c 100644
--- a/sdks/go/pkg/beam/io/pubsubio/pubsubio.go
+++ b/sdks/go/pkg/beam/io/pubsubio/pubsubio.go
@@ -24,10 +24,15 @@ import (
 	"github.com/apache/beam/sdks/go/pkg/beam/core/typex"
 	"github.com/apache/beam/sdks/go/pkg/beam/core/util/protox"
 	"github.com/apache/beam/sdks/go/pkg/beam/core/util/reflectx"
-	"github.com/apache/beam/sdks/go/pkg/beam/io/pubsubio/v1"
+	pipepb "github.com/apache/beam/sdks/go/pkg/beam/model/pipeline_v1"
 	"github.com/apache/beam/sdks/go/pkg/beam/util/pubsubx"
-	"github.com/golang/protobuf/proto"
 	pb "google.golang.org/genproto/googleapis/pubsub/v1"
+	"google.golang.org/protobuf/proto"
+)
+
+var (
+	readURN  = "beam:transform:pubsub_read:v1"
+	writeURN = "beam:transform:pubsub_write:v1"
 )
 
 func init() {
@@ -49,8 +54,7 @@ type ReadOptions struct {
 func Read(s beam.Scope, project, topic string, opts *ReadOptions) beam.PCollection {
 	s = s.Scope("pubsubio.Read")
 
-	payload := &v1.PubSubPayload{
-		Op:    v1.PubSubPayload_READ,
+	payload := &pipepb.PubSubReadPayload{
 		Topic: pubsubx.MakeQualifiedTopicName(project, topic),
 	}
 	if opts != nil {
@@ -62,7 +66,7 @@ func Read(s beam.Scope, project, topic string, opts *ReadOptions) beam.PCollecti
 		payload.WithAttributes = opts.WithAttributes
 	}
 
-	out := beam.External(s, v1.PubSubPayloadURN, protox.MustEncode(payload), nil, []beam.FullType{typex.New(reflectx.ByteSlice)}, false)
+	out := beam.External(s, readURN, protox.MustEncode(payload), nil, []beam.FullType{typex.New(reflectx.ByteSlice)}, false)
 	if opts.WithAttributes {
 		return beam.ParDo(s, unmarshalMessageFn, out[0])
 	}
@@ -81,15 +85,13 @@ func unmarshalMessageFn(raw []byte) (*pb.PubsubMessage, error) {
 func Write(s beam.Scope, project, topic string, col beam.PCollection) {
 	s = s.Scope("pubsubio.Write")
 
-	payload := &v1.PubSubPayload{
-		Op:    v1.PubSubPayload_WRITE,
+	payload := &pipepb.PubSubWritePayload{
 		Topic: pubsubx.MakeQualifiedTopicName(project, topic),
 	}
 
 	out := col
 	if col.Type().Type() != reflectx.ByteSlice {
 		out = beam.ParDo(s, proto.Marshal, col)
-		payload.WithAttributes = true
 	}
-	beam.External(s, v1.PubSubPayloadURN, protox.MustEncode(payload), []beam.PCollection{out}, nil, false)
+	beam.External(s, writeURN, protox.MustEncode(payload), []beam.PCollection{out}, nil, false)
 }
diff --git a/sdks/go/pkg/beam/io/pubsubio/v1/gen.go b/sdks/go/pkg/beam/io/pubsubio/v1/gen.go
deleted file mode 100644
index 35b595e1522..00000000000
--- a/sdks/go/pkg/beam/io/pubsubio/v1/gen.go
+++ /dev/null
@@ -1,21 +0,0 @@
-// Licensed to the Apache Software Foundation (ASF) under one or more
-// contributor license agreements.  See the NOTICE file distributed with
-// this work for additional information regarding copyright ownership.
-// The ASF licenses this file to You under the Apache License, Version 2.0
-// (the "License"); you may not use this file except in compliance with
-// the License.  You may obtain a copy of the License at
-//
-//    http://www.apache.org/licenses/LICENSE-2.0
-//
-// Unless required by applicable law or agreed to in writing, software
-// distributed under the License is distributed on an "AS IS" BASIS,
-// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-// See the License for the specific language governing permissions and
-// limitations under the License.
-
-package v1
-
-//go:generate protoc -I . v1.proto --go_out=../../../../../../../../../../
-
-// PubSubPayloadURN is the URN of the pubsub proto payload.
-const PubSubPayloadURN = "beam:go:payload:pubsub:v1"
diff --git a/sdks/go/pkg/beam/io/pubsubio/v1/v1.pb.go b/sdks/go/pkg/beam/io/pubsubio/v1/v1.pb.go
deleted file mode 100644
index bbf071acf3d..00000000000
--- a/sdks/go/pkg/beam/io/pubsubio/v1/v1.pb.go
+++ /dev/null
@@ -1,278 +0,0 @@
-//
-// Licensed to the Apache Software Foundation (ASF) under one
-// or more contributor license agreements.  See the NOTICE file
-// distributed with this work for additional information
-// regarding copyright ownership.  The ASF licenses this file
-// to you under the Apache License, Version 2.0 (the
-// "License"); you may not use this file except in compliance
-// with the License.  You may obtain a copy of the License at
-//
-//     http://www.apache.org/licenses/LICENSE-2.0
-//
-// Unless required by applicable law or agreed to in writing, software
-// distributed under the License is distributed on an "AS IS" BASIS,
-// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-// See the License for the specific language governing permissions and
-// limitations under the License.
-
-//
-// Protocol Buffers describing pubsub payload (v1) to pass to beam.External.
-
-// Code generated by protoc-gen-go. DO NOT EDIT.
-// versions:
-// 	protoc-gen-go v1.25.0-devel
-// 	protoc        v3.13.0
-// source: v1.proto
-
-package v1
-
-import (
-	protoreflect "google.golang.org/protobuf/reflect/protoreflect"
-	protoimpl "google.golang.org/protobuf/runtime/protoimpl"
-	reflect "reflect"
-	sync "sync"
-)
-
-const (
-	// Verify that this generated code is sufficiently up-to-date.
-	_ = protoimpl.EnforceVersion(20 - protoimpl.MinVersion)
-	// Verify that runtime/protoimpl is sufficiently up-to-date.
-	_ = protoimpl.EnforceVersion(protoimpl.MaxVersion - 20)
-)
-
-type PubSubPayload_Op int32
-
-const (
-	PubSubPayload_INVALID PubSubPayload_Op = 0
-	PubSubPayload_READ    PubSubPayload_Op = 1
-	PubSubPayload_WRITE   PubSubPayload_Op = 2
-)
-
-// Enum value maps for PubSubPayload_Op.
-var (
-	PubSubPayload_Op_name = map[int32]string{
-		0: "INVALID",
-		1: "READ",
-		2: "WRITE",
-	}
-	PubSubPayload_Op_value = map[string]int32{
-		"INVALID": 0,
-		"READ":    1,
-		"WRITE":   2,
-	}
-)
-
-func (x PubSubPayload_Op) Enum() *PubSubPayload_Op {
-	p := new(PubSubPayload_Op)
-	*p = x
-	return p
-}
-
-func (x PubSubPayload_Op) String() string {
-	return protoimpl.X.EnumStringOf(x.Descriptor(), protoreflect.EnumNumber(x))
-}
-
-func (PubSubPayload_Op) Descriptor() protoreflect.EnumDescriptor {
-	return file_v1_proto_enumTypes[0].Descriptor()
-}
-
-func (PubSubPayload_Op) Type() protoreflect.EnumType {
-	return &file_v1_proto_enumTypes[0]
-}
-
-func (x PubSubPayload_Op) Number() protoreflect.EnumNumber {
-	return protoreflect.EnumNumber(x)
-}
-
-// Deprecated: Use PubSubPayload_Op.Descriptor instead.
-func (PubSubPayload_Op) EnumDescriptor() ([]byte, []int) {
-	return file_v1_proto_rawDescGZIP(), []int{0, 0}
-}
-
-type PubSubPayload struct {
-	state         protoimpl.MessageState
-	sizeCache     protoimpl.SizeCache
-	unknownFields protoimpl.UnknownFields
-
-	Op                 PubSubPayload_Op `protobuf:"varint,1,opt,name=op,proto3,enum=org.apache.beam.sdks.go.pkg.beam.io.pubsubio.v1.PubSubPayload_Op" json:"op,omitempty"`
-	Topic              string           `protobuf:"bytes,2,opt,name=Topic,proto3" json:"Topic,omitempty"`
-	Subscription       string           `protobuf:"bytes,3,opt,name=Subscription,proto3" json:"Subscription,omitempty"`
-	IdAttribute        string           `protobuf:"bytes,4,opt,name=IdAttribute,proto3" json:"IdAttribute,omitempty"`
-	TimestampAttribute string           `protobuf:"bytes,5,opt,name=TimestampAttribute,proto3" json:"TimestampAttribute,omitempty"`
-	WithAttributes     bool             `protobuf:"varint,6,opt,name=WithAttributes,proto3" json:"WithAttributes,omitempty"`
-}
-
-func (x *PubSubPayload) Reset() {
-	*x = PubSubPayload{}
-	if protoimpl.UnsafeEnabled {
-		mi := &file_v1_proto_msgTypes[0]
-		ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
-		ms.StoreMessageInfo(mi)
-	}
-}
-
-func (x *PubSubPayload) String() string {
-	return protoimpl.X.MessageStringOf(x)
-}
-
-func (*PubSubPayload) ProtoMessage() {}
-
-func (x *PubSubPayload) ProtoReflect() protoreflect.Message {
-	mi := &file_v1_proto_msgTypes[0]
-	if protoimpl.UnsafeEnabled && x != nil {
-		ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
-		if ms.LoadMessageInfo() == nil {
-			ms.StoreMessageInfo(mi)
-		}
-		return ms
-	}
-	return mi.MessageOf(x)
-}
-
-// Deprecated: Use PubSubPayload.ProtoReflect.Descriptor instead.
-func (*PubSubPayload) Descriptor() ([]byte, []int) {
-	return file_v1_proto_rawDescGZIP(), []int{0}
-}
-
-func (x *PubSubPayload) GetOp() PubSubPayload_Op {
-	if x != nil {
-		return x.Op
-	}
-	return PubSubPayload_INVALID
-}
-
-func (x *PubSubPayload) GetTopic() string {
-	if x != nil {
-		return x.Topic
-	}
-	return ""
-}
-
-func (x *PubSubPayload) GetSubscription() string {
-	if x != nil {
-		return x.Subscription
-	}
-	return ""
-}
-
-func (x *PubSubPayload) GetIdAttribute() string {
-	if x != nil {
-		return x.IdAttribute
-	}
-	return ""
-}
-
-func (x *PubSubPayload) GetTimestampAttribute() string {
-	if x != nil {
-		return x.TimestampAttribute
-	}
-	return ""
-}
-
-func (x *PubSubPayload) GetWithAttributes() bool {
-	if x != nil {
-		return x.WithAttributes
-	}
-	return false
-}
-
-var File_v1_proto protoreflect.FileDescriptor
-
-var file_v1_proto_rawDesc = []byte{
-	0x0a, 0x08, 0x76, 0x31, 0x2e, 0x70, 0x72, 0x6f, 0x74, 0x6f, 0x12, 0x2f, 0x6f, 0x72, 0x67, 0x2e,
-	0x61, 0x70, 0x61, 0x63, 0x68, 0x65, 0x2e, 0x62, 0x65, 0x61, 0x6d, 0x2e, 0x73, 0x64, 0x6b, 0x73,
-	0x2e, 0x67, 0x6f, 0x2e, 0x70, 0x6b, 0x67, 0x2e, 0x62, 0x65, 0x61, 0x6d, 0x2e, 0x69, 0x6f, 0x2e,
-	0x70, 0x75, 0x62, 0x73, 0x75, 0x62, 0x69, 0x6f, 0x2e, 0x76, 0x31, 0x22, 0xbe, 0x02, 0x0a, 0x0d,
-	0x50, 0x75, 0x62, 0x53, 0x75, 0x62, 0x50, 0x61, 0x79, 0x6c, 0x6f, 0x61, 0x64, 0x12, 0x51, 0x0a,
-	0x02, 0x6f, 0x70, 0x18, 0x01, 0x20, 0x01, 0x28, 0x0e, 0x32, 0x41, 0x2e, 0x6f, 0x72, 0x67, 0x2e,
-	0x61, 0x70, 0x61, 0x63, 0x68, 0x65, 0x2e, 0x62, 0x65, 0x61, 0x6d, 0x2e, 0x73, 0x64, 0x6b, 0x73,
-	0x2e, 0x67, 0x6f, 0x2e, 0x70, 0x6b, 0x67, 0x2e, 0x62, 0x65, 0x61, 0x6d, 0x2e, 0x69, 0x6f, 0x2e,
-	0x70, 0x75, 0x62, 0x73, 0x75, 0x62, 0x69, 0x6f, 0x2e, 0x76, 0x31, 0x2e, 0x50, 0x75, 0x62, 0x53,
-	0x75, 0x62, 0x50, 0x61, 0x79, 0x6c, 0x6f, 0x61, 0x64, 0x2e, 0x4f, 0x70, 0x52, 0x02, 0x6f, 0x70,
-	0x12, 0x14, 0x0a, 0x05, 0x54, 0x6f, 0x70, 0x69, 0x63, 0x18, 0x02, 0x20, 0x01, 0x28, 0x09, 0x52,
-	0x05, 0x54, 0x6f, 0x70, 0x69, 0x63, 0x12, 0x22, 0x0a, 0x0c, 0x53, 0x75, 0x62, 0x73, 0x63, 0x72,
-	0x69, 0x70, 0x74, 0x69, 0x6f, 0x6e, 0x18, 0x03, 0x20, 0x01, 0x28, 0x09, 0x52, 0x0c, 0x53, 0x75,
-	0x62, 0x73, 0x63, 0x72, 0x69, 0x70, 0x74, 0x69, 0x6f, 0x6e, 0x12, 0x20, 0x0a, 0x0b, 0x49, 0x64,
-	0x41, 0x74, 0x74, 0x72, 0x69, 0x62, 0x75, 0x74, 0x65, 0x18, 0x04, 0x20, 0x01, 0x28, 0x09, 0x52,
-	0x0b, 0x49, 0x64, 0x41, 0x74, 0x74, 0x72, 0x69, 0x62, 0x75, 0x74, 0x65, 0x12, 0x2e, 0x0a, 0x12,
-	0x54, 0x69, 0x6d, 0x65, 0x73, 0x74, 0x61, 0x6d, 0x70, 0x41, 0x74, 0x74, 0x72, 0x69, 0x62, 0x75,
-	0x74, 0x65, 0x18, 0x05, 0x20, 0x01, 0x28, 0x09, 0x52, 0x12, 0x54, 0x69, 0x6d, 0x65, 0x73, 0x74,
-	0x61, 0x6d, 0x70, 0x41, 0x74, 0x74, 0x72, 0x69, 0x62, 0x75, 0x74, 0x65, 0x12, 0x26, 0x0a, 0x0e,
-	0x57, 0x69, 0x74, 0x68, 0x41, 0x74, 0x74, 0x72, 0x69, 0x62, 0x75, 0x74, 0x65, 0x73, 0x18, 0x06,
-	0x20, 0x01, 0x28, 0x08, 0x52, 0x0e, 0x57, 0x69, 0x74, 0x68, 0x41, 0x74, 0x74, 0x72, 0x69, 0x62,
-	0x75, 0x74, 0x65, 0x73, 0x22, 0x26, 0x0a, 0x02, 0x4f, 0x70, 0x12, 0x0b, 0x0a, 0x07, 0x49, 0x4e,
-	0x56, 0x41, 0x4c, 0x49, 0x44, 0x10, 0x00, 0x12, 0x08, 0x0a, 0x04, 0x52, 0x45, 0x41, 0x44, 0x10,
-	0x01, 0x12, 0x09, 0x0a, 0x05, 0x57, 0x52, 0x49, 0x54, 0x45, 0x10, 0x02, 0x42, 0x3b, 0x5a, 0x39,
-	0x67, 0x69, 0x74, 0x68, 0x75, 0x62, 0x2e, 0x63, 0x6f, 0x6d, 0x2f, 0x61, 0x70, 0x61, 0x63, 0x68,
-	0x65, 0x2f, 0x62, 0x65, 0x61, 0x6d, 0x2f, 0x73, 0x64, 0x6b, 0x73, 0x2f, 0x67, 0x6f, 0x2f, 0x70,
-	0x6b, 0x67, 0x2f, 0x62, 0x65, 0x61, 0x6d, 0x2f, 0x69, 0x6f, 0x2f, 0x70, 0x75, 0x62, 0x73, 0x75,
-	0x62, 0x69, 0x6f, 0x2f, 0x76, 0x31, 0x3b, 0x76, 0x31, 0x62, 0x06, 0x70, 0x72, 0x6f, 0x74, 0x6f,
-	0x33,
-}
-
-var (
-	file_v1_proto_rawDescOnce sync.Once
-	file_v1_proto_rawDescData = file_v1_proto_rawDesc
-)
-
-func file_v1_proto_rawDescGZIP() []byte {
-	file_v1_proto_rawDescOnce.Do(func() {
-		file_v1_proto_rawDescData = protoimpl.X.CompressGZIP(file_v1_proto_rawDescData)
-	})
-	return file_v1_proto_rawDescData
-}
-
-var file_v1_proto_enumTypes = make([]protoimpl.EnumInfo, 1)
-var file_v1_proto_msgTypes = make([]protoimpl.MessageInfo, 1)
-var file_v1_proto_goTypes = []interface{}{
-	(PubSubPayload_Op)(0), // 0: org.apache.beam.sdks.go.pkg.beam.io.pubsubio.v1.PubSubPayload.Op
-	(*PubSubPayload)(nil), // 1: org.apache.beam.sdks.go.pkg.beam.io.pubsubio.v1.PubSubPayload
-}
-var file_v1_proto_depIdxs = []int32{
-	0, // 0: org.apache.beam.sdks.go.pkg.beam.io.pubsubio.v1.PubSubPayload.op:type_name -> org.apache.beam.sdks.go.pkg.beam.io.pubsubio.v1.PubSubPayload.Op
-	1, // [1:1] is the sub-list for method output_type
-	1, // [1:1] is the sub-list for method input_type
-	1, // [1:1] is the sub-list for extension type_name
-	1, // [1:1] is the sub-list for extension extendee
-	0, // [0:1] is the sub-list for field type_name
-}
-
-func init() { file_v1_proto_init() }
-func file_v1_proto_init() {
-	if File_v1_proto != nil {
-		return
-	}
-	if !protoimpl.UnsafeEnabled {
-		file_v1_proto_msgTypes[0].Exporter = func(v interface{}, i int) interface{} {
-			switch v := v.(*PubSubPayload); i {
-			case 0:
-				return &v.state
-			case 1:
-				return &v.sizeCache
-			case 2:
-				return &v.unknownFields
-			default:
-				return nil
-			}
-		}
-	}
-	type x struct{}
-	out := protoimpl.TypeBuilder{
-		File: protoimpl.DescBuilder{
-			GoPackagePath: reflect.TypeOf(x{}).PkgPath(),
-			RawDescriptor: file_v1_proto_rawDesc,
-			NumEnums:      1,
-			NumMessages:   1,
-			NumExtensions: 0,
-			NumServices:   0,
-		},
-		GoTypes:           file_v1_proto_goTypes,
-		DependencyIndexes: file_v1_proto_depIdxs,
-		EnumInfos:         file_v1_proto_enumTypes,
-		MessageInfos:      file_v1_proto_msgTypes,
-	}.Build()
-	File_v1_proto = out.File
-	file_v1_proto_rawDesc = nil
-	file_v1_proto_goTypes = nil
-	file_v1_proto_depIdxs = nil
-}
diff --git a/sdks/go/pkg/beam/io/pubsubio/v1/v1.proto b/sdks/go/pkg/beam/io/pubsubio/v1/v1.proto
deleted file mode 100644
index f2f779350de..00000000000
--- a/sdks/go/pkg/beam/io/pubsubio/v1/v1.proto
+++ /dev/null
@@ -1,41 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one
- * or more contributor license agreements.  See the NOTICE file
- * distributed with this work for additional information
- * regarding copyright ownership.  The ASF licenses this file
- * to you under the Apache License, Version 2.0 (the
- * "License"); you may not use this file except in compliance
- * with the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-/*
- * Protocol Buffers describing pubsub payload (v1) to pass to beam.External.
- */
-syntax = "proto3";
-
-package org.apache.beam.sdks.go.pkg.beam.io.pubsubio.v1;
-
-option go_package = "github.com/apache/beam/sdks/go/pkg/beam/io/pubsubio/v1;v1";
-
-message PubSubPayload {
-    enum Op {
-        INVALID = 0;
-        READ = 1;
-        WRITE = 2;
-    }
-    Op op = 1;
-
-    string Topic = 2;
-    string Subscription = 3;
-    string IdAttribute = 4;
-    string TimestampAttribute = 5;
-    bool WithAttributes = 6;
-}
diff --git a/sdks/go/pkg/beam/runners/dataflow/dataflowlib/translate.go b/sdks/go/pkg/beam/runners/dataflow/dataflowlib/translate.go
index 2bddbaff21d..fdf4a75b72f 100644
--- a/sdks/go/pkg/beam/runners/dataflow/dataflowlib/translate.go
+++ b/sdks/go/pkg/beam/runners/dataflow/dataflowlib/translate.go
@@ -32,7 +32,6 @@ import (
 	"github.com/apache/beam/sdks/go/pkg/beam/core/util/reflectx"
 	"github.com/apache/beam/sdks/go/pkg/beam/core/util/stringx"
 	"github.com/apache/beam/sdks/go/pkg/beam/internal/errors"
-	pubsub_v1 "github.com/apache/beam/sdks/go/pkg/beam/io/pubsubio/v1"
 	pipepb "github.com/apache/beam/sdks/go/pkg/beam/model/pipeline_v1"
 	"github.com/golang/protobuf/proto"
 	df "google.golang.org/api/dataflow/v1b3"
@@ -246,40 +245,6 @@ func (x *translator) translateTransform(trunk string, id string) ([]*df.Step, er
 		prop.SerializedFn = encodeSerializedFn(x.extractWindowingStrategy(out))
 		return []*df.Step{x.newStep(id, windowIntoKind, prop)}, nil
 
-	case pubsub_v1.PubSubPayloadURN:
-		// Translate to native handling of PubSub I/O.
-
-		var msg pubsub_v1.PubSubPayload
-		if err := proto.Unmarshal(t.Spec.Payload, &msg); err != nil {
-			return nil, errors.Wrap(err, "bad pubsub payload")
-		}
-
-		prop.Format = "pubsub"
-		prop.PubSubTopic = msg.GetTopic()
-		prop.PubSubSubscription = msg.GetSubscription()
-		prop.PubSubIDLabel = msg.GetIdAttribute()
-		prop.PubSubTimestampLabel = msg.GetTimestampAttribute()
-		prop.PubSubWithAttributes = msg.GetWithAttributes()
-
-		if prop.PubSubSubscription != "" {
-			prop.PubSubTopic = ""
-		}
-
-		switch msg.Op {
-		case pubsub_v1.PubSubPayload_READ:
-			return []*df.Step{x.newStep(id, readKind, prop)}, nil
-
-		case pubsub_v1.PubSubPayload_WRITE:
-			in := stringx.SingleValue(t.Inputs)
-
-			prop.ParallelInput = x.pcollections[in]
-			prop.Encoding = x.wrapCoder(x.comp.Pcollections[in], coder.NewBytes())
-			return []*df.Step{x.newStep(id, writeKind, prop)}, nil
-
-		default:
-			return nil, errors.Errorf("bad pubsub op: %v", msg.Op)
-		}
-
 	default:
 		if len(t.Subtransforms) > 0 {
 			return x.translateTransforms(fmt.Sprintf("%v%v/", trunk, path.Base(t.UniqueName)), t.Subtransforms)
