diff --git a/sdks/java/extensions/sql/src/main/java/org/apache/beam/sdk/extensions/sql/impl/QueryPlanner.java b/sdks/java/extensions/sql/src/main/java/org/apache/beam/sdk/extensions/sql/impl/QueryPlanner.java
index 67e1f824607..a6900828368 100644
--- a/sdks/java/extensions/sql/src/main/java/org/apache/beam/sdk/extensions/sql/impl/QueryPlanner.java
+++ b/sdks/java/extensions/sql/src/main/java/org/apache/beam/sdk/extensions/sql/impl/QueryPlanner.java
@@ -21,6 +21,8 @@ import com.google.auto.value.AutoOneOf;
 import java.util.List;
 import java.util.Map;
 import org.apache.beam.sdk.extensions.sql.impl.rel.BeamRelNode;
+import org.apache.beam.vendor.calcite.v1_20_0.com.google.common.collect.ImmutableList;
+import org.apache.beam.vendor.calcite.v1_20_0.com.google.common.collect.ImmutableMap;
 import org.apache.beam.vendor.calcite.v1_20_0.org.apache.calcite.sql.SqlNode;
 
 /**
@@ -55,12 +57,17 @@ public interface QueryPlanner {
       return AutoOneOf_QueryPlanner_QueryParameters.none();
     }
 
-    public static QueryParameters ofNamed(Map namedParams) {
-      return AutoOneOf_QueryPlanner_QueryParameters.named(namedParams);
+    public static QueryParameters ofNamed(Map<String, ?> namedParams) {
+      ImmutableMap.Builder builder = ImmutableMap.builder();
+      for (Map.Entry<String, ?> e : namedParams.entrySet()) {
+        builder.put(e.getKey().toLowerCase(), e.getValue());
+      }
+      return AutoOneOf_QueryPlanner_QueryParameters.named(builder.build());
     }
 
     public static QueryParameters ofPositional(List positionalParams) {
-      return AutoOneOf_QueryPlanner_QueryParameters.positional(positionalParams);
+      return AutoOneOf_QueryPlanner_QueryParameters.positional(
+          ImmutableList.copyOf(positionalParams));
     }
   }
 }
diff --git a/sdks/java/extensions/sql/zetasql/src/test/java/org/apache/beam/sdk/extensions/sql/zetasql/ZetaSQLDialectSpecTest.java b/sdks/java/extensions/sql/zetasql/src/test/java/org/apache/beam/sdk/extensions/sql/zetasql/ZetaSQLDialectSpecTest.java
index 749b4e8be13..bb6c808056b 100644
--- a/sdks/java/extensions/sql/zetasql/src/test/java/org/apache/beam/sdk/extensions/sql/zetasql/ZetaSQLDialectSpecTest.java
+++ b/sdks/java/extensions/sql/zetasql/src/test/java/org/apache/beam/sdk/extensions/sql/zetasql/ZetaSQLDialectSpecTest.java
@@ -3236,6 +3236,19 @@ public class ZetaSQLDialectSpecTest {
     pipeline.run().waitUntilFinish(Duration.standardMinutes(PIPELINE_EXECUTION_WAITTIME_MINUTES));
   }
 
+  @Test
+  public void testNamedParameterQuery() {
+    String sql = "SELECT @ColA AS ColA";
+    ImmutableMap<String, Value> params = ImmutableMap.of("ColA", Value.createInt64Value(5));
+
+    ZetaSQLQueryPlanner zetaSQLQueryPlanner = new ZetaSQLQueryPlanner(config);
+    BeamRelNode beamRelNode = zetaSQLQueryPlanner.convertToBeamRel(sql, params);
+    PCollection<Row> stream = BeamSqlRelUtils.toPCollection(pipeline, beamRelNode);
+    final Schema schema = Schema.builder().addInt64Field("field1").build();
+    PAssert.that(stream).containsInAnyOrder(Row.withSchema(schema).addValues(5L).build());
+    pipeline.run().waitUntilFinish(Duration.standardMinutes(PIPELINE_EXECUTION_WAITTIME_MINUTES));
+  }
+
   @Test
   public void testConcatNamedParameterQuery() {
     String sql = "SELECT CONCAT(@p0, @p1) AS ColA";
