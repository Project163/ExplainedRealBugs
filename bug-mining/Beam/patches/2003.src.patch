diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/io/LocalFileSystem.java b/sdks/java/core/src/main/java/org/apache/beam/sdk/io/LocalFileSystem.java
index 026f64f455f..25b7c47e5de 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/io/LocalFileSystem.java
+++ b/sdks/java/core/src/main/java/org/apache/beam/sdk/io/LocalFileSystem.java
@@ -202,9 +202,15 @@ class LocalFileSystem extends FileSystem<LocalResourceId> {
 
   @Override
   protected LocalResourceId matchNewResource(String singleResourceSpec, boolean isDirectory) {
-    if (singleResourceSpec.endsWith(File.separator) && !isDirectory) {
-      throw new IllegalArgumentException(
-          String.format("Expected file path but received directory path %s", singleResourceSpec));
+    if (isDirectory) {
+      if (!singleResourceSpec.endsWith(File.separator)) {
+        singleResourceSpec += File.separator;
+      }
+    } else {
+      checkArgument(
+          !singleResourceSpec.endsWith(File.separator),
+          "Expected file path but received directory path [%s].",
+          singleResourceSpec);
     }
     Path path = Paths.get(singleResourceSpec);
     return LocalResourceId.fromPath(path, isDirectory);
diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/io/LocalResourceId.java b/sdks/java/core/src/main/java/org/apache/beam/sdk/io/LocalResourceId.java
index 1c0f00455a7..02400af9067 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/io/LocalResourceId.java
+++ b/sdks/java/core/src/main/java/org/apache/beam/sdk/io/LocalResourceId.java
@@ -39,8 +39,6 @@ class LocalResourceId implements ResourceId {
 
   private transient @Nullable volatile Path cachedPath;
 
-  private final boolean isDirectory;
-
   static LocalResourceId fromPath(Path path, boolean isDirectory) {
     checkNotNull(path, "path");
     return new LocalResourceId(path, isDirectory);
@@ -48,13 +46,12 @@ class LocalResourceId implements ResourceId {
 
   private LocalResourceId(Path path, boolean isDirectory) {
     this.pathString =
-        path.toAbsolutePath().normalize().toString() + (isDirectory ? File.separatorChar : "");
-    this.isDirectory = isDirectory;
+        path.toAbsolutePath().normalize().toString() + (isDirectory ? File.separator : "");
   }
 
   @Override
   public LocalResourceId resolve(String other, ResolveOptions resolveOptions) {
-    checkState(isDirectory, "Expected the path is a directory, but had [%s].", pathString);
+    checkState(isDirectory(), "Expected the path is a directory, but had [%s].", pathString);
     checkArgument(
         resolveOptions.equals(StandardResolveOptions.RESOLVE_FILE)
             || resolveOptions.equals(StandardResolveOptions.RESOLVE_DIRECTORY),
@@ -73,7 +70,7 @@ class LocalResourceId implements ResourceId {
 
   @Override
   public LocalResourceId getCurrentDirectory() {
-    if (isDirectory) {
+    if (isDirectory()) {
       return this;
     } else {
       Path path = getPath();
@@ -118,7 +115,7 @@ class LocalResourceId implements ResourceId {
 
   @Override
   public boolean isDirectory() {
-    return isDirectory;
+    return pathString.endsWith(File.separator);
   }
 
   Path getPath() {
@@ -139,11 +136,11 @@ class LocalResourceId implements ResourceId {
       return false;
     }
     LocalResourceId other = (LocalResourceId) obj;
-    return this.pathString.equals(other.pathString) && this.isDirectory == other.isDirectory;
+    return this.pathString.equals(other.pathString);
   }
 
   @Override
   public int hashCode() {
-    return Objects.hash(pathString, isDirectory);
+    return Objects.hash(pathString);
   }
 }
diff --git a/sdks/java/core/src/test/java/org/apache/beam/sdk/io/DefaultFilenamePolicyTest.java b/sdks/java/core/src/test/java/org/apache/beam/sdk/io/DefaultFilenamePolicyTest.java
index 5ed6cad4223..aaa8c6d033e 100644
--- a/sdks/java/core/src/test/java/org/apache/beam/sdk/io/DefaultFilenamePolicyTest.java
+++ b/sdks/java/core/src/test/java/org/apache/beam/sdk/io/DefaultFilenamePolicyTest.java
@@ -19,10 +19,9 @@ package org.apache.beam.sdk.io;
 
 import static org.junit.Assert.assertEquals;
 
-import java.io.ByteArrayInputStream;
-import java.io.ByteArrayOutputStream;
 import java.io.IOException;
 import org.apache.beam.sdk.io.fs.ResourceId;
+import org.apache.beam.sdk.util.CoderUtils;
 import org.junit.Test;
 import org.junit.runner.RunWith;
 import org.junit.runners.JUnit4;
@@ -51,26 +50,6 @@ public class DefaultFilenamePolicyTest {
     return constructed.toString();
   }
 
-  private static DefaultFilenamePolicy.Params encodeDecodeParams(
-      DefaultFilenamePolicy.Params params) throws IOException {
-    return decodeParams(encodeParams(params));
-  }
-
-  private static byte[] encodeParams(DefaultFilenamePolicy.Params params) throws IOException {
-    try (ByteArrayOutputStream outputStream = new ByteArrayOutputStream()) {
-      DefaultFilenamePolicy.ParamsCoder.of().encode(params, outputStream);
-      outputStream.flush();
-      return outputStream.toByteArray();
-    }
-  }
-
-  private static DefaultFilenamePolicy.Params decodeParams(byte[] encodedParams)
-      throws IOException {
-    try (ByteArrayInputStream inputStream = new ByteArrayInputStream(encodedParams)) {
-      return DefaultFilenamePolicy.ParamsCoder.of().decode(inputStream);
-    }
-  }
-
   @Test
   public void testConstructName() {
     assertEquals(
@@ -160,14 +139,16 @@ public class DefaultFilenamePolicyTest {
     assertEquals(
         new DefaultFilenamePolicy.Params()
             .withBaseFilename(FileSystems.matchNewResource("/tmp/file1", false)),
-        encodeDecodeParams(
+        CoderUtils.clone(
+            DefaultFilenamePolicy.ParamsCoder.of(),
             new DefaultFilenamePolicy.Params()
                 .withBaseFilename(FileSystems.matchNewResource("/tmp/file1", false))));
     assertEquals(
         new DefaultFilenamePolicy.Params()
             .withBaseFilename(FileSystems.matchNewResource("/tmp/file2", false))
             .withSuffix(".json"),
-        encodeDecodeParams(
+        CoderUtils.clone(
+            DefaultFilenamePolicy.ParamsCoder.of(),
             new DefaultFilenamePolicy.Params()
                 .withBaseFilename(FileSystems.matchNewResource("/tmp/file2", false))
                 .withSuffix(".json")));
@@ -175,14 +156,16 @@ public class DefaultFilenamePolicyTest {
     assertEquals(
         new DefaultFilenamePolicy.Params()
             .withBaseFilename(FileSystems.matchNewResource("/tmp/dir1/", true)),
-        encodeDecodeParams(
+        CoderUtils.clone(
+            DefaultFilenamePolicy.ParamsCoder.of(),
             new DefaultFilenamePolicy.Params()
                 .withBaseFilename(FileSystems.matchNewResource("/tmp/dir1/", true))));
     assertEquals(
         new DefaultFilenamePolicy.Params()
             .withBaseFilename(FileSystems.matchNewResource("/tmp/dir2/", true))
             .withSuffix(".json"),
-        encodeDecodeParams(
+        CoderUtils.clone(
+            DefaultFilenamePolicy.ParamsCoder.of(),
             new DefaultFilenamePolicy.Params()
                 .withBaseFilename(FileSystems.matchNewResource("/tmp/dir2/", true))
                 .withSuffix(".json")));
@@ -190,14 +173,16 @@ public class DefaultFilenamePolicyTest {
     assertEquals(
         new DefaultFilenamePolicy.Params()
             .withBaseFilename(FileSystems.matchNewResource("/tmp/dir3", true)),
-        encodeDecodeParams(
+        CoderUtils.clone(
+            DefaultFilenamePolicy.ParamsCoder.of(),
             new DefaultFilenamePolicy.Params()
                 .withBaseFilename(FileSystems.matchNewResource("/tmp/dir3", true))));
     assertEquals(
         new DefaultFilenamePolicy.Params()
             .withBaseFilename(FileSystems.matchNewResource("/tmp/dir4", true))
             .withSuffix(".json"),
-        encodeDecodeParams(
+        CoderUtils.clone(
+            DefaultFilenamePolicy.ParamsCoder.of(),
             new DefaultFilenamePolicy.Params()
                 .withBaseFilename(FileSystems.matchNewResource("/tmp/dir4", true))
                 .withSuffix(".json")));
