diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/ReduceFnRunner.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/ReduceFnRunner.java
index ff41b4d9a5d..e14728a906d 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/ReduceFnRunner.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/ReduceFnRunner.java
@@ -343,18 +343,18 @@ public class ReduceFnRunner<K, InputT, OutputT, W extends BoundedWindow> {
 
     // All windows that are open before element processing may need to fire.
     Set<W> windowsToConsider = windowsThatAreOpen(windows);
+    // Prefetch state necessary to determine if the triggers should fire. This is done before
+    // user processing so it may fetch with user desired state.
+    for (W mergedWindow : windowsToConsider) {
+      triggerRunner.prefetchShouldFire(
+          mergedWindow, contextFactory.base(mergedWindow, StateStyle.DIRECT).state());
+    }
 
     // Process each element, using the updated activeWindows determined by mergeWindows.
     for (WindowedValue<InputT> value : values) {
       processElement(windowToMergeResult, value);
     }
 
-    // Now that we've processed the elements, see if any of the windows need to fire.
-    // Prefetch state necessary to determine if the triggers should fire.
-    for (W mergedWindow : windowsToConsider) {
-      triggerRunner.prefetchShouldFire(
-          mergedWindow, contextFactory.base(mergedWindow, StateStyle.DIRECT).state());
-    }
     // Filter to windows that are firing.
     Collection<W> windowsToFire = windowsThatShouldFire(windowsToConsider);
     // Prefetch windows that are firing.
@@ -903,7 +903,6 @@ public class ReduceFnRunner<K, InputT, OutputT, W extends BoundedWindow> {
       ReduceFn<K, InputT, OutputT, W>.Context directContext,
       ReduceFn<K, InputT, OutputT, W>.Context renamedContext) {
     triggerRunner.prefetchShouldFire(directContext.window(), directContext.state());
-    triggerRunner.prefetchOnFire(directContext.window(), directContext.state());
     triggerRunner.prefetchIsClosed(directContext.state());
     prefetchOnTrigger(directContext, renamedContext);
   }
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterAllStateMachine.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterAllStateMachine.java
index 33f35b998ee..a2f006b2bbb 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterAllStateMachine.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterAllStateMachine.java
@@ -45,6 +45,13 @@ public class AfterAllStateMachine extends TriggerStateMachine {
     return new AfterAllStateMachine(ImmutableList.copyOf(triggers));
   }
 
+  @Override
+  public void prefetchOnElement(PrefetchContext c) {
+    for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
+      subTrigger.invokePrefetchOnElement(c.forTrigger(subTrigger));
+    }
+  }
+
   @Override
   public void onElement(OnElementContext c) throws Exception {
     for (ExecutableTriggerStateMachine subTrigger : c.trigger().unfinishedSubTriggers()) {
@@ -54,6 +61,13 @@ public class AfterAllStateMachine extends TriggerStateMachine {
     }
   }
 
+  @Override
+  public void prefetchOnMerge(MergingPrefetchContext c) {
+    for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
+      subTrigger.invokePrefetchOnMerge(c.forTrigger(subTrigger));
+    }
+  }
+
   @Override
   public void onMerge(OnMergeContext c) throws Exception {
     for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
@@ -66,6 +80,13 @@ public class AfterAllStateMachine extends TriggerStateMachine {
     c.trigger().setFinished(allFinished);
   }
 
+  @Override
+  public void prefetchShouldFire(PrefetchContext c) {
+    for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
+      subTrigger.invokePrefetchShouldFire(c.forTrigger(subTrigger));
+    }
+  }
+
   /**
    * {@inheritDoc}
    *
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterDelayFromFirstElementStateMachine.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterDelayFromFirstElementStateMachine.java
index b980a9638d6..26de1cb0f07 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterDelayFromFirstElementStateMachine.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterDelayFromFirstElementStateMachine.java
@@ -20,8 +20,6 @@ package org.apache.beam.runners.core.triggers;
 import java.util.List;
 import java.util.Locale;
 import java.util.Objects;
-import org.apache.beam.runners.core.MergingStateAccessor;
-import org.apache.beam.runners.core.StateAccessor;
 import org.apache.beam.runners.core.StateMerging;
 import org.apache.beam.runners.core.StateTag;
 import org.apache.beam.runners.core.StateTags;
@@ -153,8 +151,8 @@ public abstract class AfterDelayFromFirstElementStateMachine extends TriggerStat
   }
 
   @Override
-  public void prefetchOnElement(StateAccessor<?> state) {
-    state.access(DELAYED_UNTIL_TAG).readLater();
+  public void prefetchOnElement(PrefetchContext c) {
+    c.state().access(DELAYED_UNTIL_TAG).readLater();
   }
 
   @Override
@@ -174,9 +172,8 @@ public abstract class AfterDelayFromFirstElementStateMachine extends TriggerStat
   }
 
   @Override
-  public void prefetchOnMerge(MergingStateAccessor<?, ?> state) {
-    super.prefetchOnMerge(state);
-    StateMerging.prefetchCombiningValues(state, DELAYED_UNTIL_TAG);
+  public void prefetchOnMerge(MergingPrefetchContext c) {
+    StateMerging.prefetchCombiningValues(c.state(), DELAYED_UNTIL_TAG);
   }
 
   @Override
@@ -209,8 +206,8 @@ public abstract class AfterDelayFromFirstElementStateMachine extends TriggerStat
   }
 
   @Override
-  public void prefetchShouldFire(StateAccessor<?> state) {
-    state.access(DELAYED_UNTIL_TAG).readLater();
+  public void prefetchShouldFire(PrefetchContext c) {
+    c.state().access(DELAYED_UNTIL_TAG).readLater();
   }
 
   @Override
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterEachStateMachine.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterEachStateMachine.java
index 5f039d83c88..97aa608e322 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterEachStateMachine.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterEachStateMachine.java
@@ -48,6 +48,13 @@ public class AfterEachStateMachine extends TriggerStateMachine {
     checkArgument(subTriggers.size() > 1);
   }
 
+  @Override
+  public void prefetchOnElement(PrefetchContext c) {
+    for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
+      subTrigger.invokePrefetchOnElement(c.forTrigger(subTrigger));
+    }
+  }
+
   /** Returns an {@code AfterEach} {@code Trigger} with the given subtriggers. */
   @SafeVarargs
   public static TriggerStateMachine inOrder(TriggerStateMachine... triggers) {
@@ -73,6 +80,13 @@ public class AfterEachStateMachine extends TriggerStateMachine {
     }
   }
 
+  @Override
+  public void prefetchOnMerge(MergingPrefetchContext c) {
+    for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
+      subTrigger.invokePrefetchOnMerge(c.forTrigger(subTrigger));
+    }
+  }
+
   @Override
   public void onMerge(OnMergeContext context) throws Exception {
     // If merging makes a subtrigger no-longer-finished, it will automatically
@@ -93,6 +107,13 @@ public class AfterEachStateMachine extends TriggerStateMachine {
     updateFinishedState(context);
   }
 
+  @Override
+  public void prefetchShouldFire(PrefetchContext c) {
+    for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
+      subTrigger.invokePrefetchShouldFire(c.forTrigger(subTrigger));
+    }
+  }
+
   @Override
   public boolean shouldFire(TriggerStateMachine.TriggerContext context) throws Exception {
     ExecutableTriggerStateMachine firstUnfinished = context.trigger().firstUnfinishedSubTrigger();
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterFirstStateMachine.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterFirstStateMachine.java
index 038f072c3a1..4cfe729ea88 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterFirstStateMachine.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterFirstStateMachine.java
@@ -45,6 +45,13 @@ public class AfterFirstStateMachine extends TriggerStateMachine {
     return new AfterFirstStateMachine(ImmutableList.copyOf(triggers));
   }
 
+  @Override
+  public void prefetchOnElement(PrefetchContext c) {
+    for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
+      subTrigger.invokePrefetchOnElement(c.forTrigger(subTrigger));
+    }
+  }
+
   @Override
   public void onElement(OnElementContext c) throws Exception {
     for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
@@ -52,6 +59,13 @@ public class AfterFirstStateMachine extends TriggerStateMachine {
     }
   }
 
+  @Override
+  public void prefetchOnMerge(MergingPrefetchContext c) {
+    for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
+      subTrigger.invokePrefetchOnMerge(c.forTrigger(subTrigger));
+    }
+  }
+
   @Override
   public void onMerge(OnMergeContext c) throws Exception {
     for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
@@ -60,6 +74,13 @@ public class AfterFirstStateMachine extends TriggerStateMachine {
     updateFinishedStatus(c);
   }
 
+  @Override
+  public void prefetchShouldFire(PrefetchContext c) {
+    for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
+      subTrigger.invokePrefetchShouldFire(c.forTrigger(subTrigger));
+    }
+  }
+
   @Override
   public boolean shouldFire(TriggerStateMachine.TriggerContext context) throws Exception {
     for (ExecutableTriggerStateMachine subtrigger : context.trigger().subTriggers()) {
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterPaneStateMachine.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterPaneStateMachine.java
index e0f852ab3e0..d114df65b35 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterPaneStateMachine.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterPaneStateMachine.java
@@ -18,8 +18,6 @@
 package org.apache.beam.runners.core.triggers;
 
 import java.util.Objects;
-import org.apache.beam.runners.core.MergingStateAccessor;
-import org.apache.beam.runners.core.StateAccessor;
 import org.apache.beam.runners.core.StateMerging;
 import org.apache.beam.runners.core.StateTag;
 import org.apache.beam.runners.core.StateTags;
@@ -54,15 +52,22 @@ public class AfterPaneStateMachine extends TriggerStateMachine {
     return new AfterPaneStateMachine(countElems);
   }
 
+  @Override
+  public void prefetchOnElement(PrefetchContext c) {
+    // This is not directly read by onElement since we are using a combiner.
+    // However if a read is performed for another reason we might as well
+    // read also so that the state can be compacted.
+    c.state().access(ELEMENTS_IN_PANE_TAG).readLater();
+  }
+
   @Override
   public void onElement(OnElementContext c) throws Exception {
     c.state().access(ELEMENTS_IN_PANE_TAG).add(1L);
   }
 
   @Override
-  public void prefetchOnMerge(MergingStateAccessor<?, ?> state) {
-    super.prefetchOnMerge(state);
-    StateMerging.prefetchCombiningValues(state, ELEMENTS_IN_PANE_TAG);
+  public void prefetchOnMerge(MergingPrefetchContext context) {
+    StateMerging.prefetchCombiningValues(context.state(), ELEMENTS_IN_PANE_TAG);
   }
 
   @Override
@@ -80,8 +85,8 @@ public class AfterPaneStateMachine extends TriggerStateMachine {
   }
 
   @Override
-  public void prefetchShouldFire(StateAccessor<?> state) {
-    state.access(ELEMENTS_IN_PANE_TAG).readLater();
+  public void prefetchShouldFire(PrefetchContext context) {
+    context.state().access(ELEMENTS_IN_PANE_TAG).readLater();
   }
 
   @Override
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterWatermarkStateMachine.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterWatermarkStateMachine.java
index b7be021f521..5fc6900f8bb 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterWatermarkStateMachine.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/AfterWatermarkStateMachine.java
@@ -91,6 +91,13 @@ public class AfterWatermarkStateMachine {
       return new AfterWatermarkEarlyAndLate(earlyTrigger, lateTrigger);
     }
 
+    @Override
+    public void prefetchOnElement(PrefetchContext c) {
+      for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
+        subTrigger.invokePrefetchOnElement(c);
+      }
+    }
+
     @Override
     public void onElement(OnElementContext c) throws Exception {
       if (!endOfWindowReached(c)) {
@@ -109,6 +116,13 @@ public class AfterWatermarkStateMachine {
       }
     }
 
+    @Override
+    public void prefetchOnMerge(MergingPrefetchContext c) {
+      for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
+        subTrigger.invokePrefetchOnMerge(c);
+      }
+    }
+
     @Override
     public void onMerge(OnMergeContext c) throws Exception {
       // NOTE that the ReduceFnRunner will delete all end-of-window timers for the
@@ -145,6 +159,13 @@ public class AfterWatermarkStateMachine {
           && context.currentEventTime().isAfter(context.window().maxTimestamp());
     }
 
+    @Override
+    public void prefetchShouldFire(PrefetchContext c) {
+      for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
+        subTrigger.invokePrefetchShouldFire(c);
+      }
+    }
+
     @Override
     public boolean shouldFire(TriggerStateMachine.TriggerContext context) throws Exception {
       if (!context.trigger().isFinished(EARLY_INDEX)) {
@@ -253,6 +274,9 @@ public class AfterWatermarkStateMachine {
       return new AfterWatermarkEarlyAndLate(NeverStateMachine.ever(), lateFirings);
     }
 
+    @Override
+    public void prefetchOnElement(PrefetchContext c) {}
+
     @Override
     public void onElement(OnElementContext c) throws Exception {
       // We're interested in knowing when the input watermark passes the end of the window.
@@ -263,6 +287,9 @@ public class AfterWatermarkStateMachine {
       }
     }
 
+    @Override
+    public void prefetchOnMerge(MergingPrefetchContext c) {}
+
     @Override
     public void onMerge(OnMergeContext c) throws Exception {
       // NOTE that the ReduceFnRunner will delete all end-of-window timers for the
@@ -297,6 +324,9 @@ public class AfterWatermarkStateMachine {
       return Objects.hash(getClass());
     }
 
+    @Override
+    public void prefetchShouldFire(PrefetchContext c) {}
+
     @Override
     public boolean shouldFire(TriggerStateMachine.TriggerContext context) throws Exception {
       return endOfWindowReached(context);
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/DefaultTriggerStateMachine.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/DefaultTriggerStateMachine.java
index 719172df821..fb14b8d726c 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/DefaultTriggerStateMachine.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/DefaultTriggerStateMachine.java
@@ -35,6 +35,9 @@ public class DefaultTriggerStateMachine extends TriggerStateMachine {
     return new DefaultTriggerStateMachine();
   }
 
+  @Override
+  public void prefetchOnElement(PrefetchContext c) {}
+
   @Override
   public void onElement(OnElementContext c) throws Exception {
     // If the end of the window has already been reached, then we are already ready to fire
@@ -44,6 +47,9 @@ public class DefaultTriggerStateMachine extends TriggerStateMachine {
     }
   }
 
+  @Override
+  public void prefetchOnMerge(MergingPrefetchContext c) {}
+
   @Override
   public void onMerge(OnMergeContext c) throws Exception {
     // If the end of the window has already been reached, then we are already ready to fire
@@ -53,6 +59,9 @@ public class DefaultTriggerStateMachine extends TriggerStateMachine {
     }
   }
 
+  @Override
+  public void prefetchShouldFire(PrefetchContext c) {}
+
   @Override
   public void clear(TriggerContext c) throws Exception {}
 
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/ExecutableTriggerStateMachine.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/ExecutableTriggerStateMachine.java
index 9c14e5ab9e1..6781492cff4 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/ExecutableTriggerStateMachine.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/ExecutableTriggerStateMachine.java
@@ -112,6 +112,10 @@ public class ExecutableTriggerStateMachine implements Serializable {
     return previous;
   }
 
+  public void invokePrefetchOnElement(TriggerStateMachine.PrefetchContext c) {
+    trigger.prefetchOnElement(c.forTrigger(this));
+  }
+
   /**
    * Invoke the {@link TriggerStateMachine#onElement} method for this trigger, ensuring that the
    * bits are properly updated if the trigger finishes.
@@ -120,6 +124,10 @@ public class ExecutableTriggerStateMachine implements Serializable {
     trigger.onElement(c.forTrigger(this));
   }
 
+  public void invokePrefetchOnMerge(TriggerStateMachine.MergingPrefetchContext c) {
+    trigger.prefetchOnMerge(c.forTrigger(this));
+  }
+
   /**
    * Invoke the {@link TriggerStateMachine#onMerge} method for this trigger, ensuring that the bits
    * are properly updated.
@@ -129,6 +137,10 @@ public class ExecutableTriggerStateMachine implements Serializable {
     trigger.onMerge(subContext);
   }
 
+  public void invokePrefetchShouldFire(TriggerStateMachine.PrefetchContext c) {
+    trigger.prefetchShouldFire(c.forTrigger(this));
+  }
+
   public boolean invokeShouldFire(TriggerStateMachine.TriggerContext c) throws Exception {
     return trigger.shouldFire(c.forTrigger(this));
   }
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/NeverStateMachine.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/NeverStateMachine.java
index 68d5e3ebec0..3c349bef020 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/NeverStateMachine.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/NeverStateMachine.java
@@ -40,12 +40,21 @@ public final class NeverStateMachine extends TriggerStateMachine {
     super(null);
   }
 
+  @Override
+  public void prefetchOnElement(PrefetchContext c) {}
+
   @Override
   public void onElement(OnElementContext c) {}
 
+  @Override
+  public void prefetchOnMerge(MergingPrefetchContext c) {}
+
   @Override
   public void onMerge(OnMergeContext c) {}
 
+  @Override
+  public void prefetchShouldFire(PrefetchContext c) {}
+
   @Override
   public boolean shouldFire(TriggerStateMachine.TriggerContext context) {
     return false;
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/OrFinallyStateMachine.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/OrFinallyStateMachine.java
index 3a6c1cdfae9..375972bb98e 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/OrFinallyStateMachine.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/OrFinallyStateMachine.java
@@ -33,12 +33,26 @@ class OrFinallyStateMachine extends TriggerStateMachine {
     super(Arrays.asList(actual, until));
   }
 
+  @Override
+  public void prefetchOnElement(PrefetchContext c) {
+    for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
+      subTrigger.invokePrefetchOnElement(c.forTrigger(subTrigger));
+    }
+  }
+
   @Override
   public void onElement(OnElementContext c) throws Exception {
     c.trigger().subTrigger(ACTUAL).invokeOnElement(c);
     c.trigger().subTrigger(UNTIL).invokeOnElement(c);
   }
 
+  @Override
+  public void prefetchOnMerge(MergingPrefetchContext c) {
+    for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
+      subTrigger.invokePrefetchOnMerge(c.forTrigger(subTrigger));
+    }
+  }
+
   @Override
   public void onMerge(OnMergeContext c) throws Exception {
     for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
@@ -47,6 +61,13 @@ class OrFinallyStateMachine extends TriggerStateMachine {
     updateFinishedState(c);
   }
 
+  @Override
+  public void prefetchShouldFire(PrefetchContext c) {
+    for (ExecutableTriggerStateMachine subTrigger : c.trigger().subTriggers()) {
+      subTrigger.invokePrefetchShouldFire(c.forTrigger(subTrigger));
+    }
+  }
+
   @Override
   public boolean shouldFire(TriggerStateMachine.TriggerContext context) throws Exception {
     return context.trigger().subTrigger(ACTUAL).invokeShouldFire(context)
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/RepeatedlyStateMachine.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/RepeatedlyStateMachine.java
index 7089503c048..a214ae8cb1e 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/RepeatedlyStateMachine.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/RepeatedlyStateMachine.java
@@ -52,16 +52,31 @@ public class RepeatedlyStateMachine extends TriggerStateMachine {
     super(Arrays.asList(repeated));
   }
 
+  @Override
+  public void prefetchOnElement(PrefetchContext c) {
+    getRepeated(c).invokePrefetchOnElement(c);
+  }
+
   @Override
   public void onElement(OnElementContext c) throws Exception {
     getRepeated(c).invokeOnElement(c);
   }
 
+  @Override
+  public void prefetchOnMerge(MergingPrefetchContext c) {
+    getRepeated(c).invokePrefetchOnMerge(c);
+  }
+
   @Override
   public void onMerge(OnMergeContext c) throws Exception {
     getRepeated(c).invokeOnMerge(c);
   }
 
+  @Override
+  public void prefetchShouldFire(PrefetchContext c) {
+    getRepeated(c).invokePrefetchShouldFire(c);
+  }
+
   @Override
   public boolean shouldFire(TriggerStateMachine.TriggerContext context) throws Exception {
     return getRepeated(context).invokeShouldFire(context);
@@ -85,4 +100,8 @@ public class RepeatedlyStateMachine extends TriggerStateMachine {
   private ExecutableTriggerStateMachine getRepeated(TriggerContext context) {
     return context.trigger().subTrigger(REPEATED);
   }
+
+  private ExecutableTriggerStateMachine getRepeated(PrefetchContext context) {
+    return context.trigger().subTriggers().get(REPEATED);
+  }
 }
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/ReshuffleTriggerStateMachine.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/ReshuffleTriggerStateMachine.java
index 677690b31a9..64672569aa6 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/ReshuffleTriggerStateMachine.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/ReshuffleTriggerStateMachine.java
@@ -32,12 +32,21 @@ public class ReshuffleTriggerStateMachine extends TriggerStateMachine {
     super(null);
   }
 
+  @Override
+  public void prefetchOnElement(PrefetchContext c) {}
+
   @Override
   public void onElement(TriggerStateMachine.OnElementContext c) {}
 
+  @Override
+  public void prefetchOnMerge(MergingPrefetchContext c) {}
+
   @Override
   public void onMerge(TriggerStateMachine.OnMergeContext c) {}
 
+  @Override
+  public void prefetchShouldFire(PrefetchContext c) {}
+
   @Override
   public boolean shouldFire(TriggerStateMachine.TriggerContext context) throws Exception {
     return true;
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/TriggerStateMachine.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/TriggerStateMachine.java
index ebf5c7a2d08..44de94bc1d0 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/TriggerStateMachine.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/TriggerStateMachine.java
@@ -247,15 +247,49 @@ public abstract class TriggerStateMachine implements Serializable {
     public abstract MergingTriggerInfo trigger();
   }
 
+  public abstract static class PrefetchContext {
+    /** Returns the interface for accessing persistent state. */
+    public abstract StateAccessor<?> state();
+
+    /** The window that the current context is executing in. */
+    public abstract BoundedWindow window();
+
+    public abstract ExecutableTriggerStateMachine trigger();
+
+    /** Create a sub-context for the given sub-trigger. */
+    public abstract PrefetchContext forTrigger(ExecutableTriggerStateMachine trigger);
+  }
+
+  public abstract static class MergingPrefetchContext extends PrefetchContext {
+    /** Create an {@code OnMergeContext} for executing the given trigger. */
+    @Override
+    public abstract MergingPrefetchContext forTrigger(ExecutableTriggerStateMachine trigger);
+
+    @Override
+    public abstract MergingStateAccessor<?, ?> state();
+  }
+
   protected final @Nullable List<TriggerStateMachine> subTriggers;
 
   protected TriggerStateMachine(@Nullable List<TriggerStateMachine> subTriggers) {
     this.subTriggers = subTriggers;
   }
 
+  /**
+   * Called to allow the trigger to prefetch any state it will likely need to read from during an
+   * {@link #onElement} call.
+   */
+  public abstract void prefetchOnElement(PrefetchContext c);
+
   /** Called every time an element is incorporated into a window. */
   public abstract void onElement(OnElementContext c) throws Exception;
 
+  /**
+   * Called to allow the trigger to prefetch any state it will likely need to read from during an
+   * {@link #onMerge} call.
+   */
+  public abstract void prefetchOnMerge(MergingPrefetchContext c);
+
   /**
    * Called immediately after windows have been merged.
    *
@@ -273,11 +307,17 @@ public abstract class TriggerStateMachine implements Serializable {
    */
   public abstract void onMerge(OnMergeContext c) throws Exception;
 
+  /**
+   * Called to allow the trigger to prefetch any state it will likely need to read from during an
+   * {@link #shouldFire} call.
+   */
+  public abstract void prefetchShouldFire(PrefetchContext c);
+
   /**
    * Returns {@code true} if the current state of the trigger indicates that its condition is
    * satisfied and it is ready to fire.
    */
-  public abstract boolean shouldFire(TriggerContext context) throws Exception;
+  public abstract boolean shouldFire(TriggerContext c) throws Exception;
 
   /**
    * Adjusts the state of the trigger to be ready for the next pane. For example, a {@link
@@ -286,55 +326,7 @@ public abstract class TriggerStateMachine implements Serializable {
    * <p>If the trigger is finished, it is the responsibility of the trigger itself to record that
    * fact via the {@code context}.
    */
-  public abstract void onFire(TriggerContext context) throws Exception;
-
-  /**
-   * Called to allow the trigger to prefetch any state it will likely need to read from during an
-   * {@link #onElement} call.
-   */
-  public void prefetchOnElement(StateAccessor<?> state) {
-    if (subTriggers != null) {
-      for (TriggerStateMachine trigger : subTriggers) {
-        trigger.prefetchOnElement(state);
-      }
-    }
-  }
-
-  /**
-   * Called to allow the trigger to prefetch any state it will likely need to read from during an
-   * {@link #onMerge} call.
-   */
-  public void prefetchOnMerge(MergingStateAccessor<?, ?> state) {
-    if (subTriggers != null) {
-      for (TriggerStateMachine trigger : subTriggers) {
-        trigger.prefetchOnMerge(state);
-      }
-    }
-  }
-
-  /**
-   * Called to allow the trigger to prefetch any state it will likely need to read from during an
-   * {@link #shouldFire} call.
-   */
-  public void prefetchShouldFire(StateAccessor<?> state) {
-    if (subTriggers != null) {
-      for (TriggerStateMachine trigger : subTriggers) {
-        trigger.prefetchShouldFire(state);
-      }
-    }
-  }
-
-  /**
-   * Called to allow the trigger to prefetch any state it will likely need to read from during an
-   * {@link #onFire} call.
-   */
-  public void prefetchOnFire(StateAccessor<?> state) {
-    if (subTriggers != null) {
-      for (TriggerStateMachine trigger : subTriggers) {
-        trigger.prefetchOnFire(state);
-      }
-    }
-  }
+  public abstract void onFire(TriggerContext c) throws Exception;
 
   /**
    * Clear any state associated with this trigger in the given window.
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/TriggerStateMachineContextFactory.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/TriggerStateMachineContextFactory.java
index 06e1e1dc184..b748c5383bd 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/TriggerStateMachineContextFactory.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/TriggerStateMachineContextFactory.java
@@ -86,13 +86,14 @@ public class TriggerStateMachineContextFactory<W extends BoundedWindow> {
     return new OnMergeContextImpl(window, timers, rootTrigger, finishedSet, finishedSets);
   }
 
-  public StateAccessor<?> createStateAccessor(W window, ExecutableTriggerStateMachine trigger) {
-    return new StateAccessorImpl(window, trigger);
+  public TriggerStateMachine.PrefetchContext createPrefetchContext(
+      W window, ExecutableTriggerStateMachine trigger) {
+    return new PrefetchContextImpl(window, trigger);
   }
 
-  public MergingStateAccessor<?, W> createMergingStateAccessor(
-      W mergeResult, Collection<W> mergingWindows, ExecutableTriggerStateMachine trigger) {
-    return new MergingStateAccessorImpl(trigger, mergingWindows, mergeResult);
+  public TriggerStateMachine.MergingPrefetchContext createMergingPrefetchContext(
+      W window, Collection<W> mergingWindows, ExecutableTriggerStateMachine trigger) {
+    return new MergingPrefetchContextImpl(window, mergingWindows, trigger);
   }
 
   private class TriggerInfoImpl implements TriggerStateMachine.TriggerInfo {
@@ -320,6 +321,9 @@ public class TriggerStateMachineContextFactory<W extends BoundedWindow> {
 
     @Override
     public TriggerStateMachine.TriggerContext forTrigger(ExecutableTriggerStateMachine trigger) {
+      if (this.triggerInfo.trigger == trigger) {
+        return this;
+      }
       return new TriggerContextImpl(window, timers, trigger, triggerInfo.finishedSet);
     }
 
@@ -387,6 +391,9 @@ public class TriggerStateMachineContextFactory<W extends BoundedWindow> {
 
     @Override
     public TriggerStateMachine.OnElementContext forTrigger(ExecutableTriggerStateMachine trigger) {
+      if (this.triggerInfo.trigger == trigger) {
+        return this;
+      }
       return new OnElementContextImpl(
           window, timers, trigger, triggerInfo.finishedSet, eventTimestamp);
     }
@@ -454,6 +461,9 @@ public class TriggerStateMachineContextFactory<W extends BoundedWindow> {
 
     @Override
     public TriggerStateMachine.OnMergeContext forTrigger(ExecutableTriggerStateMachine trigger) {
+      if (this.triggerInfo.trigger == trigger) {
+        return this;
+      }
       return new OnMergeContextImpl(
           window, timers, trigger, triggerInfo.finishedSet, triggerInfo.finishedSets);
     }
@@ -498,4 +508,76 @@ public class TriggerStateMachineContextFactory<W extends BoundedWindow> {
       return timers.currentEventTime();
     }
   }
+
+  private class PrefetchContextImpl extends TriggerStateMachine.PrefetchContext {
+    private final StateAccessor<?> state;
+    private final W window;
+    private final ExecutableTriggerStateMachine trigger;
+
+    private PrefetchContextImpl(W window, ExecutableTriggerStateMachine trigger) {
+      this.window = window;
+      this.trigger = trigger;
+      this.state = new StateAccessorImpl(window, trigger);
+    }
+
+    @Override
+    public StateAccessor<?> state() {
+      return state;
+    }
+
+    @Override
+    public ExecutableTriggerStateMachine trigger() {
+      return trigger;
+    }
+
+    @Override
+    public BoundedWindow window() {
+      return window;
+    }
+
+    @Override
+    public TriggerStateMachine.PrefetchContext forTrigger(ExecutableTriggerStateMachine trigger) {
+      if (trigger == this.trigger) {
+        return this;
+      }
+      return new PrefetchContextImpl(window, trigger);
+    }
+  }
+
+  private class MergingPrefetchContextImpl extends TriggerStateMachine.MergingPrefetchContext {
+    private final MergingStateAccessorImpl state;
+    private final W window;
+    private final ExecutableTriggerStateMachine trigger;
+
+    private MergingPrefetchContextImpl(
+        W window, Collection<W> mergingWindows, ExecutableTriggerStateMachine trigger) {
+      this.window = window;
+      this.trigger = trigger;
+      this.state = new MergingStateAccessorImpl(trigger, mergingWindows, window);
+    }
+
+    @Override
+    public MergingStateAccessor<?, W> state() {
+      return state;
+    }
+
+    @Override
+    public ExecutableTriggerStateMachine trigger() {
+      return trigger;
+    }
+
+    @Override
+    public BoundedWindow window() {
+      return window;
+    }
+
+    @Override
+    public TriggerStateMachine.MergingPrefetchContext forTrigger(
+        ExecutableTriggerStateMachine trigger) {
+      if (trigger == this.trigger) {
+        return this;
+      }
+      return new MergingPrefetchContextImpl(window, state.activeToBeMerged, trigger);
+    }
+  }
 }
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/TriggerStateMachineRunner.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/TriggerStateMachineRunner.java
index 7c9783bbc64..5a05895379b 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/TriggerStateMachineRunner.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/triggers/TriggerStateMachineRunner.java
@@ -107,21 +107,12 @@ public class TriggerStateMachineRunner<W extends BoundedWindow> {
 
   public void prefetchForValue(W window, StateAccessor<?> state) {
     prefetchIsClosed(state);
-    rootTrigger
-        .getSpec()
-        .prefetchOnElement(contextFactory.createStateAccessor(window, rootTrigger));
-  }
-
-  public void prefetchOnFire(W window, StateAccessor<?> state) {
-    prefetchIsClosed(state);
-    rootTrigger.getSpec().prefetchOnFire(contextFactory.createStateAccessor(window, rootTrigger));
+    rootTrigger.invokePrefetchOnElement(contextFactory.createPrefetchContext(window, rootTrigger));
   }
 
   public void prefetchShouldFire(W window, StateAccessor<?> state) {
     prefetchIsClosed(state);
-    rootTrigger
-        .getSpec()
-        .prefetchShouldFire(contextFactory.createStateAccessor(window, rootTrigger));
+    rootTrigger.invokePrefetchShouldFire(contextFactory.createPrefetchContext(window, rootTrigger));
   }
 
   /** Run the trigger logic to deal with a new value. */
@@ -142,10 +133,8 @@ public class TriggerStateMachineRunner<W extends BoundedWindow> {
         value.readLater();
       }
     }
-    rootTrigger
-        .getSpec()
-        .prefetchOnMerge(
-            contextFactory.createMergingStateAccessor(window, mergingWindows, rootTrigger));
+    rootTrigger.invokePrefetchOnMerge(
+        contextFactory.createMergingPrefetchContext(window, mergingWindows, rootTrigger));
   }
 
   /** Run the trigger merging logic as part of executing the specified merge. */
diff --git a/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/ExecutableTriggerStateMachineTest.java b/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/ExecutableTriggerStateMachineTest.java
index 0073f10e015..c4a5b1a489d 100644
--- a/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/ExecutableTriggerStateMachineTest.java
+++ b/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/ExecutableTriggerStateMachineTest.java
@@ -85,12 +85,21 @@ public class ExecutableTriggerStateMachineTest {
       super(Arrays.asList(subTriggers));
     }
 
+    @Override
+    public void prefetchOnElement(PrefetchContext c) {}
+
     @Override
     public void onElement(OnElementContext c) throws Exception {}
 
+    @Override
+    public void prefetchOnMerge(MergingPrefetchContext c) {}
+
     @Override
     public void onMerge(OnMergeContext c) throws Exception {}
 
+    @Override
+    public void prefetchShouldFire(PrefetchContext c) {}
+
     @Override
     public void clear(TriggerContext c) throws Exception {}
 
diff --git a/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/RepeatedlyStateMachineTest.java b/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/RepeatedlyStateMachineTest.java
index 556fe682613..08312360806 100644
--- a/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/RepeatedlyStateMachineTest.java
+++ b/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/RepeatedlyStateMachineTest.java
@@ -182,14 +182,7 @@ public class RepeatedlyStateMachineTest {
   @Test
   public void testToString() {
     TriggerStateMachine trigger =
-        RepeatedlyStateMachine.forever(
-            new StubTriggerStateMachine() {
-              @Override
-              public String toString() {
-                return "innerTrigger";
-              }
-            });
-
+        RepeatedlyStateMachine.forever(StubTriggerStateMachine.named("innerTrigger"));
     assertEquals("Repeatedly.forever(innerTrigger)", trigger.toString());
   }
 }
diff --git a/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/StubTriggerStateMachine.java b/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/StubTriggerStateMachine.java
index eea3c04efc6..4e25ff9e9da 100644
--- a/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/StubTriggerStateMachine.java
+++ b/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/StubTriggerStateMachine.java
@@ -41,12 +41,21 @@ abstract class StubTriggerStateMachine extends TriggerStateMachine {
   @Override
   public void onFire(TriggerContext context) throws Exception {}
 
+  @Override
+  public void prefetchOnElement(PrefetchContext c) {}
+
   @Override
   public void onElement(OnElementContext c) throws Exception {}
 
+  @Override
+  public void prefetchOnMerge(MergingPrefetchContext c) {}
+
   @Override
   public void onMerge(OnMergeContext c) throws Exception {}
 
+  @Override
+  public void prefetchShouldFire(PrefetchContext c) {}
+
   @Override
   public boolean shouldFire(TriggerContext context) throws Exception {
     return false;
diff --git a/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/TriggerStateMachineTest.java b/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/TriggerStateMachineTest.java
index 269dfde9742..20e68a434ef 100644
--- a/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/TriggerStateMachineTest.java
+++ b/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/TriggerStateMachineTest.java
@@ -60,12 +60,21 @@ public class TriggerStateMachineTest {
       super(subTriggers);
     }
 
+    @Override
+    public void prefetchOnElement(PrefetchContext c) {}
+
     @Override
     public void onElement(TriggerStateMachine.OnElementContext c) {}
 
+    @Override
+    public void prefetchOnMerge(MergingPrefetchContext c) {}
+
     @Override
     public void onMerge(TriggerStateMachine.OnMergeContext c) {}
 
+    @Override
+    public void prefetchShouldFire(PrefetchContext c) {}
+
     @Override
     public boolean shouldFire(TriggerStateMachine.TriggerContext context) throws Exception {
       return false;
@@ -81,12 +90,21 @@ public class TriggerStateMachineTest {
       super(subTriggers);
     }
 
+    @Override
+    public void prefetchOnElement(PrefetchContext c) {}
+
     @Override
     public void onElement(TriggerStateMachine.OnElementContext c) {}
 
+    @Override
+    public void prefetchOnMerge(MergingPrefetchContext c) {}
+
     @Override
     public void onMerge(TriggerStateMachine.OnMergeContext c) {}
 
+    @Override
+    public void prefetchShouldFire(PrefetchContext c) {}
+
     @Override
     public boolean shouldFire(TriggerStateMachine.TriggerContext context) throws Exception {
       return false;
diff --git a/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/TriggerStateMachineTester.java b/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/TriggerStateMachineTester.java
index c74cb0d5294..a2c6b376237 100644
--- a/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/TriggerStateMachineTester.java
+++ b/runners/core-java/src/test/java/org/apache/beam/runners/core/triggers/TriggerStateMachineTester.java
@@ -299,7 +299,9 @@ public class TriggerStateMachineTester<InputT, W extends BoundedWindow> {
             new TestTimers(windowNamespace(window)),
             executableTrigger,
             getFinishedSet(window));
-    executableTrigger.getSpec().prefetchShouldFire(context.state());
+    executableTrigger
+        .getSpec()
+        .prefetchShouldFire(contextFactory.createPrefetchContext(window, executableTrigger));
     return executableTrigger.invokeShouldFire(context);
   }
 
@@ -311,9 +313,10 @@ public class TriggerStateMachineTester<InputT, W extends BoundedWindow> {
             executableTrigger,
             getFinishedSet(window));
 
-    executableTrigger.getSpec().prefetchShouldFire(context.state());
+    executableTrigger
+        .getSpec()
+        .prefetchShouldFire(contextFactory.createPrefetchContext(window, executableTrigger));
     if (executableTrigger.invokeShouldFire(context)) {
-      executableTrigger.getSpec().prefetchOnFire(context.state());
       executableTrigger.invokeOnFire(context);
       if (context.trigger().isFinished()) {
         activeWindows.remove(window);
