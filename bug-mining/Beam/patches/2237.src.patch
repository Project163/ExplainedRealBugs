diff --git a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/WindowingStrategyTranslation.java b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/WindowingStrategyTranslation.java
index 0125a8d0387..661affff2c5 100644
--- a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/WindowingStrategyTranslation.java
+++ b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/WindowingStrategyTranslation.java
@@ -24,6 +24,7 @@ import java.io.Serializable;
 import org.apache.beam.model.pipeline.v1.RunnerApi;
 import org.apache.beam.model.pipeline.v1.RunnerApi.Components;
 import org.apache.beam.model.pipeline.v1.RunnerApi.FunctionSpec;
+import org.apache.beam.model.pipeline.v1.RunnerApi.MergeStatus;
 import org.apache.beam.model.pipeline.v1.RunnerApi.OutputTime;
 import org.apache.beam.model.pipeline.v1.StandardWindowFns.FixedWindowsPayload;
 import org.apache.beam.model.pipeline.v1.StandardWindowFns.GlobalWindowsPayload;
@@ -281,7 +282,9 @@ public class WindowingStrategyTranslation implements Serializable {
    */
   public static RunnerApi.WindowingStrategy toProto(
       WindowingStrategy<?, ?> windowingStrategy, SdkComponents components) throws IOException {
-    FunctionSpec windowFnSpec = toProto(windowingStrategy.getWindowFn(), components);
+    WindowFn<?, ?> windowFn = windowingStrategy.getWindowFn();
+
+    FunctionSpec windowFnSpec = toProto(windowFn, components);
     String environmentId =
         Strings.isNullOrEmpty(windowingStrategy.getEnvironmentId())
             ? components.getOnlyEnvironmentId()
@@ -295,10 +298,13 @@ public class WindowingStrategyTranslation implements Serializable {
             .setAllowedLateness(windowingStrategy.getAllowedLateness().getMillis())
             .setTrigger(TriggerTranslation.toProto(windowingStrategy.getTrigger()))
             .setWindowFn(windowFnSpec)
-            .setAssignsToOneWindow(windowingStrategy.getWindowFn().assignsToOneWindow())
+            .setAssignsToOneWindow(windowFn.assignsToOneWindow())
+            .setMergeStatus(
+                windowFn.isNonMerging()
+                    ? MergeStatus.Enum.NON_MERGING
+                    : MergeStatus.Enum.NEEDS_MERGE)
             .setOnTimeBehavior(toProto(windowingStrategy.getOnTimeBehavior()))
-            .setWindowCoderId(
-                components.registerCoder(windowingStrategy.getWindowFn().windowCoder()))
+            .setWindowCoderId(components.registerCoder(windowFn.windowCoder()))
             .setEnvironmentId(environmentId);
 
     return windowingStrategyProto.build();
diff --git a/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/WindowingStrategyTranslationTest.java b/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/WindowingStrategyTranslationTest.java
index ff70dd08446..cd19ace6246 100644
--- a/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/WindowingStrategyTranslationTest.java
+++ b/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/WindowingStrategyTranslationTest.java
@@ -53,19 +53,20 @@ import org.checkerframework.checker.nullness.qual.Nullable;
 import org.joda.time.Duration;
 import org.joda.time.Instant;
 import org.junit.Test;
+import org.junit.experimental.runners.Enclosed;
 import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 import org.junit.runners.Parameterized;
 import org.junit.runners.Parameterized.Parameter;
 import org.junit.runners.Parameterized.Parameters;
 
 /** Unit tests for {@link WindowingStrategy}. */
-@RunWith(Parameterized.class)
+@RunWith(Enclosed.class)
 @SuppressWarnings({
   "rawtypes", // TODO(https://issues.apache.org/jira/browse/BEAM-10556)
   "nullness" // TODO(https://issues.apache.org/jira/browse/BEAM-10402)
 })
 public class WindowingStrategyTranslationTest {
-
   // Each spec activates tests of all subsets of its fields
   @AutoValue
   @AutoValue.CopyAnnotations
@@ -74,93 +75,127 @@ public class WindowingStrategyTranslationTest {
     abstract WindowingStrategy getWindowingStrategy();
   }
 
-  private static ToProtoAndBackSpec toProtoAndBackSpec(WindowingStrategy windowingStrategy) {
-    return new AutoValue_WindowingStrategyTranslationTest_ToProtoAndBackSpec(windowingStrategy);
-  }
+  @RunWith(Parameterized.class)
+  public static class ToProtoAndBackTests {
 
-  private static final WindowFn<?, ?> REPRESENTATIVE_WINDOW_FN =
-      FixedWindows.of(Duration.millis(12));
-
-  private static final Trigger REPRESENTATIVE_TRIGGER = AfterWatermark.pastEndOfWindow();
-
-  @Parameters(name = "{index}: {0}")
-  public static Iterable<ToProtoAndBackSpec> data() {
-    return ImmutableList.of(
-        toProtoAndBackSpec(WindowingStrategy.globalDefault()),
-        toProtoAndBackSpec(
-            WindowingStrategy.of(
-                FixedWindows.of(Duration.millis(11)).withOffset(Duration.millis(3)))),
-        toProtoAndBackSpec(
-            WindowingStrategy.of(
-                SlidingWindows.of(Duration.millis(37))
-                    .every(Duration.millis(3))
-                    .withOffset(Duration.millis(2)))),
-        toProtoAndBackSpec(WindowingStrategy.of(Sessions.withGapDuration(Duration.millis(389)))),
-        toProtoAndBackSpec(
-            WindowingStrategy.of(REPRESENTATIVE_WINDOW_FN)
-                .withClosingBehavior(ClosingBehavior.FIRE_ALWAYS)
-                .withMode(AccumulationMode.ACCUMULATING_FIRED_PANES)
-                .withTrigger(REPRESENTATIVE_TRIGGER)
-                .withAllowedLateness(Duration.millis(71))
-                .withTimestampCombiner(TimestampCombiner.EARLIEST)),
-        toProtoAndBackSpec(
-            WindowingStrategy.of(REPRESENTATIVE_WINDOW_FN)
-                .withClosingBehavior(ClosingBehavior.FIRE_IF_NON_EMPTY)
-                .withMode(AccumulationMode.DISCARDING_FIRED_PANES)
-                .withTrigger(REPRESENTATIVE_TRIGGER)
-                .withAllowedLateness(Duration.millis(93))
-                .withTimestampCombiner(TimestampCombiner.LATEST)),
-        toProtoAndBackSpec(
-            WindowingStrategy.of(REPRESENTATIVE_WINDOW_FN)
-                .withClosingBehavior(ClosingBehavior.FIRE_IF_NON_EMPTY)
-                .withMode(AccumulationMode.RETRACTING_FIRED_PANES)
-                .withTrigger(REPRESENTATIVE_TRIGGER)
-                .withAllowedLateness(Duration.millis(100))
-                .withTimestampCombiner(TimestampCombiner.LATEST)),
-        toProtoAndBackSpec(WindowingStrategy.of(new CustomWindowFn())));
-  }
+    private static ToProtoAndBackSpec toProtoAndBackSpec(WindowingStrategy windowingStrategy) {
+      return new AutoValue_WindowingStrategyTranslationTest_ToProtoAndBackSpec(windowingStrategy);
+    }
+
+    private static final WindowFn<?, ?> REPRESENTATIVE_WINDOW_FN =
+        FixedWindows.of(Duration.millis(12));
+
+    private static final Trigger REPRESENTATIVE_TRIGGER = AfterWatermark.pastEndOfWindow();
+
+    @Parameters(name = "{index}: {0}")
+    public static Iterable<ToProtoAndBackSpec> data() {
+      return ImmutableList.of(
+          toProtoAndBackSpec(WindowingStrategy.globalDefault()),
+          toProtoAndBackSpec(
+              WindowingStrategy.of(
+                  FixedWindows.of(Duration.millis(11)).withOffset(Duration.millis(3)))),
+          toProtoAndBackSpec(
+              WindowingStrategy.of(
+                  SlidingWindows.of(Duration.millis(37))
+                      .every(Duration.millis(3))
+                      .withOffset(Duration.millis(2)))),
+          toProtoAndBackSpec(WindowingStrategy.of(Sessions.withGapDuration(Duration.millis(389)))),
+          toProtoAndBackSpec(
+              WindowingStrategy.of(REPRESENTATIVE_WINDOW_FN)
+                  .withClosingBehavior(ClosingBehavior.FIRE_ALWAYS)
+                  .withMode(AccumulationMode.ACCUMULATING_FIRED_PANES)
+                  .withTrigger(REPRESENTATIVE_TRIGGER)
+                  .withAllowedLateness(Duration.millis(71))
+                  .withTimestampCombiner(TimestampCombiner.EARLIEST)),
+          toProtoAndBackSpec(
+              WindowingStrategy.of(REPRESENTATIVE_WINDOW_FN)
+                  .withClosingBehavior(ClosingBehavior.FIRE_IF_NON_EMPTY)
+                  .withMode(AccumulationMode.DISCARDING_FIRED_PANES)
+                  .withTrigger(REPRESENTATIVE_TRIGGER)
+                  .withAllowedLateness(Duration.millis(93))
+                  .withTimestampCombiner(TimestampCombiner.LATEST)),
+          toProtoAndBackSpec(
+              WindowingStrategy.of(REPRESENTATIVE_WINDOW_FN)
+                  .withClosingBehavior(ClosingBehavior.FIRE_IF_NON_EMPTY)
+                  .withMode(AccumulationMode.RETRACTING_FIRED_PANES)
+                  .withTrigger(REPRESENTATIVE_TRIGGER)
+                  .withAllowedLateness(Duration.millis(100))
+                  .withTimestampCombiner(TimestampCombiner.LATEST)),
+          toProtoAndBackSpec(WindowingStrategy.of(new CustomWindowFn())));
+    }
+
+    @Parameter(0)
+    public ToProtoAndBackSpec toProtoAndBackSpec;
+
+    @Test
+    public void testToProtoAndBack() throws Exception {
+      WindowingStrategy<?, ?> windowingStrategy = toProtoAndBackSpec.getWindowingStrategy();
+      SdkComponents components = SdkComponents.create();
+      components.registerEnvironment(Environments.createDockerEnvironment("java"));
+      WindowingStrategy<?, ?> toProtoAndBackWindowingStrategy =
+          WindowingStrategyTranslation.fromProto(
+              WindowingStrategyTranslation.toMessageProto(windowingStrategy, components));
+
+      assertThat(
+          toProtoAndBackWindowingStrategy,
+          equalTo(
+              (WindowingStrategy)
+                  windowingStrategy
+                      .withEnvironmentId(components.getOnlyEnvironmentId())
+                      .fixDefaults()));
+    }
 
-  @Parameter(0)
-  public ToProtoAndBackSpec toProtoAndBackSpec;
-
-  @Test
-  public void testToProtoAndBack() throws Exception {
-    WindowingStrategy<?, ?> windowingStrategy = toProtoAndBackSpec.getWindowingStrategy();
-    SdkComponents components = SdkComponents.create();
-    components.registerEnvironment(Environments.createDockerEnvironment("java"));
-    WindowingStrategy<?, ?> toProtoAndBackWindowingStrategy =
-        WindowingStrategyTranslation.fromProto(
-            WindowingStrategyTranslation.toMessageProto(windowingStrategy, components));
-
-    assertThat(
-        toProtoAndBackWindowingStrategy,
-        equalTo(
-            (WindowingStrategy)
-                windowingStrategy
-                    .withEnvironmentId(components.getOnlyEnvironmentId())
-                    .fixDefaults()));
+    @Test
+    public void testToProtoAndBackWithComponents() throws Exception {
+      WindowingStrategy<?, ?> windowingStrategy = toProtoAndBackSpec.getWindowingStrategy();
+      SdkComponents components = SdkComponents.create();
+      components.registerEnvironment(Environments.createDockerEnvironment("java"));
+      RunnerApi.WindowingStrategy proto =
+          WindowingStrategyTranslation.toProto(windowingStrategy, components);
+      RehydratedComponents protoComponents =
+          RehydratedComponents.forComponents(components.toComponents());
+
+      assertThat(
+          WindowingStrategyTranslation.fromProto(proto, protoComponents).fixDefaults(),
+          equalTo(
+              windowingStrategy
+                  .withEnvironmentId(components.getOnlyEnvironmentId())
+                  .fixDefaults()));
+
+      protoComponents.getCoder(
+          components.registerCoder(windowingStrategy.getWindowFn().windowCoder()));
+      assertThat(
+          proto.getAssignsToOneWindow(),
+          equalTo(windowingStrategy.getWindowFn().assignsToOneWindow()));
+    }
   }
 
-  @Test
-  public void testToProtoAndBackWithComponents() throws Exception {
-    WindowingStrategy<?, ?> windowingStrategy = toProtoAndBackSpec.getWindowingStrategy();
-    SdkComponents components = SdkComponents.create();
-    components.registerEnvironment(Environments.createDockerEnvironment("java"));
-    RunnerApi.WindowingStrategy proto =
-        WindowingStrategyTranslation.toProto(windowingStrategy, components);
-    RehydratedComponents protoComponents =
-        RehydratedComponents.forComponents(components.toComponents());
-
-    assertThat(
-        WindowingStrategyTranslation.fromProto(proto, protoComponents).fixDefaults(),
-        equalTo(
-            windowingStrategy.withEnvironmentId(components.getOnlyEnvironmentId()).fixDefaults()));
-
-    protoComponents.getCoder(
-        components.registerCoder(windowingStrategy.getWindowFn().windowCoder()));
-    assertThat(
-        proto.getAssignsToOneWindow(),
-        equalTo(windowingStrategy.getWindowFn().assignsToOneWindow()));
+  @RunWith(JUnit4.class)
+  public static class ExpectedProtoTests {
+
+    @Test
+    public void testSessionsMergeStatus() throws Exception {
+      WindowingStrategy<?, ?> windowingStrategy =
+          WindowingStrategy.of(Sessions.withGapDuration(Duration.millis(456)));
+      SdkComponents components = SdkComponents.create();
+      components.registerEnvironment(Environments.createDockerEnvironment("java"));
+      RunnerApi.WindowingStrategy proto =
+          WindowingStrategyTranslation.toProto(windowingStrategy, components);
+
+      assertThat(proto.getMergeStatus(), equalTo(RunnerApi.MergeStatus.Enum.NEEDS_MERGE));
+    }
+
+    @Test
+    public void testFixedMergeStatus() throws Exception {
+      WindowingStrategy<?, ?> windowingStrategy =
+          WindowingStrategy.of(FixedWindows.of(Duration.millis(2)));
+      SdkComponents components = SdkComponents.create();
+      components.registerEnvironment(Environments.createDockerEnvironment("java"));
+      RunnerApi.WindowingStrategy proto =
+          WindowingStrategyTranslation.toProto(windowingStrategy, components);
+
+      assertThat(proto.getMergeStatus(), equalTo(RunnerApi.MergeStatus.Enum.NON_MERGING));
+    }
   }
 
   private static class CustomWindow extends IntervalWindow {
