diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/SimpleExecutionState.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/SimpleExecutionState.java
index 7d9ea969076..25725a36c01 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/SimpleExecutionState.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/SimpleExecutionState.java
@@ -17,6 +17,7 @@
  */
 package org.apache.beam.runners.core.metrics;
 
+import static org.apache.beam.runners.core.metrics.MonitoringInfoEncodings.decodeInt64Counter;
 import static org.apache.beam.runners.core.metrics.MonitoringInfoEncodings.encodeInt64Counter;
 
 import java.util.Collections;
@@ -97,6 +98,10 @@ public class SimpleExecutionState extends ExecutionState {
     return encodeInt64Counter(getTotalMillis());
   }
 
+  public ByteString mergeTotalMillisPayload(ByteString other) {
+    return encodeInt64Counter(getTotalMillis() + decodeInt64Counter(other));
+  }
+
   private MonitoringInfo getTotalMillisMonitoringMetadata() {
     SimpleMonitoringInfoBuilder builder = new SimpleMonitoringInfoBuilder();
     builder.setUrn(getUrn());
diff --git a/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/SimpleStateRegistry.java b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/SimpleStateRegistry.java
index c51c01ca9d5..c82ac88afb3 100644
--- a/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/SimpleStateRegistry.java
+++ b/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/SimpleStateRegistry.java
@@ -18,11 +18,11 @@
 package org.apache.beam.runners.core.metrics;
 
 import java.util.ArrayList;
+import java.util.HashMap;
 import java.util.List;
 import java.util.Map;
 import org.apache.beam.model.pipeline.v1.MetricsApi.MonitoringInfo;
 import org.apache.beam.vendor.grpc.v1p26p0.com.google.protobuf.ByteString;
-import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.collect.ImmutableMap;
 
 /**
  * A Class for registering SimpleExecutionStates with and extracting execution time MonitoringInfos.
@@ -60,12 +60,18 @@ public class SimpleStateRegistry {
   }
 
   public Map<String, ByteString> getExecutionTimeMonitoringData(ShortIdMap shortIds) {
-    ImmutableMap.Builder<String, ByteString> builder = ImmutableMap.builder();
+    Map<String, ByteString> result = new HashMap<>(executionStates.size());
     for (SimpleExecutionState state : executionStates) {
       if (state.getTotalMillis() != 0) {
-        builder.put(state.getTotalMillisShortId(shortIds), state.getTotalMillisPayload());
+        String shortId = state.getTotalMillisShortId(shortIds);
+        if (result.containsKey(shortId)) {
+          // This can happen due to flatten unzipping.
+          result.put(shortId, state.mergeTotalMillisPayload(result.get(shortId)));
+        } else {
+          result.put(shortId, state.getTotalMillisPayload());
+        }
       }
     }
-    return builder.build();
+    return result;
   }
 }
