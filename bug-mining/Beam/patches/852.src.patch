diff --git a/sdks/python/apache_beam/io/hdfs_integration_test/docker-compose.yml b/sdks/python/apache_beam/io/hdfs_integration_test/docker-compose.yml
index 60f7194de0b..73e567c0a05 100644
--- a/sdks/python/apache_beam/io/hdfs_integration_test/docker-compose.yml
+++ b/sdks/python/apache_beam/io/hdfs_integration_test/docker-compose.yml
@@ -24,6 +24,7 @@ services:
     hostname: namenode
     environment:
       - CLUSTER_NAME=test
+      - HDFS_CONF_dfs_namenode_datanode_registration_ip___hostname___check=false
     networks:
       - test_net
 
diff --git a/sdks/python/apache_beam/io/hdfs_integration_test/hdfs_integration_test.sh b/sdks/python/apache_beam/io/hdfs_integration_test/hdfs_integration_test.sh
index 1eeb43b3722..a2bf5f09254 100755
--- a/sdks/python/apache_beam/io/hdfs_integration_test/hdfs_integration_test.sh
+++ b/sdks/python/apache_beam/io/hdfs_integration_test/hdfs_integration_test.sh
@@ -34,6 +34,13 @@ cp -r ${ROOT_DIR}/model ${CONTEXT_DIR}/
 # Use a unique name to allow concurrent runs on the same machine.
 PROJECT_NAME=$(echo hdfs_IT-${BUILD_TAG:-non-jenkins})
 
+if [ -z "${BUILD_TAG:-}" ]; then
+  COLOR_OPT=""
+else
+  COLOR_OPT="--no-ansi"
+fi
+COMPOSE_OPT="-p ${PROJECT_NAME} ${COLOR_OPT}"
+
 cd ${CONTEXT_DIR}
 # Clean up leftover unused networks from previous runs. BEAM-4051
 # This might mess with leftover containers that still reference pruned networks,
@@ -42,10 +49,10 @@ cd ${CONTEXT_DIR}
 docker network prune --force
 
 function finally {
-  time docker-compose -p ${PROJECT_NAME} down
+  time docker-compose ${COMPOSE_OPT} down
 }
 trap finally EXIT
 
-time docker-compose -p ${PROJECT_NAME} build
-time docker-compose -p ${PROJECT_NAME} up --exit-code-from test \
+time docker-compose ${COMPOSE_OPT} build
+time docker-compose ${COMPOSE_OPT} up --exit-code-from test \
     --abort-on-container-exit --force-recreate
