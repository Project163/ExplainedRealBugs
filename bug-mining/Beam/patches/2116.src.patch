diff --git a/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/logging/BeamFnLoggingClient.java b/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/logging/BeamFnLoggingClient.java
index e2aa64d5e61..0fdf4045066 100644
--- a/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/logging/BeamFnLoggingClient.java
+++ b/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/logging/BeamFnLoggingClient.java
@@ -54,14 +54,11 @@ import org.apache.beam.vendor.grpc.v1p26p0.io.grpc.stub.ClientCallStreamObserver
 import org.apache.beam.vendor.grpc.v1p26p0.io.grpc.stub.ClientResponseObserver;
 import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.MoreObjects;
 import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.collect.ImmutableMap;
+import org.checkerframework.checker.nullness.qual.Nullable;
 
 /**
  * Configures {@link java.util.logging} to send all {@link LogRecord}s via the Beam Fn Logging API.
  */
-@SuppressWarnings({
-  "rawtypes", // TODO(https://issues.apache.org/jira/browse/BEAM-10556)
-  "nullness" // TODO(https://issues.apache.org/jira/browse/BEAM-10402)
-})
 public class BeamFnLoggingClient implements AutoCloseable {
   private static final String ROOT_LOGGER_NAME = "";
   private static final ImmutableMap<Level, BeamFnApi.LogEntry.Severity.Enum> LOG_LEVEL_MAP =
@@ -140,8 +137,9 @@ public class BeamFnLoggingClient implements AutoCloseable {
 
     BeamFnLoggingGrpc.BeamFnLoggingStub stub = BeamFnLoggingGrpc.newStub(channel);
     inboundObserver = new LogControlObserver();
-    logRecordHandler = new LogRecordHandler(options.as(GcsOptions.class).getExecutorService());
+    logRecordHandler = new LogRecordHandler();
     logRecordHandler.setLevel(Level.ALL);
+    logRecordHandler.executeOn(options.as(GcsOptions.class).getExecutorService());
     outboundObserver = (CallStreamObserver<BeamFnApi.LogEntry.List>) stub.logging(inboundObserver);
     rootLogger.addHandler(logRecordHandler);
   }
@@ -180,14 +178,14 @@ public class BeamFnLoggingClient implements AutoCloseable {
   private class LogRecordHandler extends Handler implements Runnable {
     private final BlockingDeque<BeamFnApi.LogEntry> bufferedLogEntries =
         new LinkedBlockingDeque<>(MAX_BUFFERED_LOG_ENTRY_COUNT);
-    private final Future<?> bufferedLogWriter;
+    private @Nullable Future<?> bufferedLogWriter = null;
     /**
      * Safe object publishing is not required since we only care if the thread that set this field
      * is equal to the thread also attempting to add a log entry.
      */
-    private Thread logEntryHandlerThread;
+    private @Nullable Thread logEntryHandlerThread = null;
 
-    private LogRecordHandler(ExecutorService executorService) {
+    private void executeOn(ExecutorService executorService) {
       bufferedLogWriter = executorService.submit(this);
     }
 
@@ -197,19 +195,27 @@ public class BeamFnLoggingClient implements AutoCloseable {
       if (severity == null) {
         return;
       }
+
       BeamFnApi.LogEntry.Builder builder =
           BeamFnApi.LogEntry.newBuilder()
               .setSeverity(severity)
-              .setLogLocation(record.getLoggerName())
               .setMessage(FORMATTER.formatMessage(record))
               .setThread(Integer.toString(record.getThreadID()))
               .setTimestamp(
                   Timestamp.newBuilder()
                       .setSeconds(record.getMillis() / 1000)
                       .setNanos((int) (record.getMillis() % 1000) * 1_000_000));
-      if (record.getThrown() != null) {
-        builder.setTrace(getStackTraceAsString(record.getThrown()));
+
+      Throwable thrown = record.getThrown();
+      if (thrown != null) {
+        builder.setTrace(getStackTraceAsString(thrown));
       }
+
+      String loggerName = record.getLoggerName();
+      if (loggerName != null) {
+        builder.setLogLocation(loggerName);
+      }
+
       // The thread that sends log records should never perform a blocking publish and
       // only insert log records best effort.
       if (Thread.currentThread() != logEntryHandlerThread) {
@@ -295,15 +301,17 @@ public class BeamFnLoggingClient implements AutoCloseable {
       // outbound observer.
       phaser.forceTermination();
 
-      try {
-        bufferedLogWriter.get();
-      } catch (CancellationException e) {
-        // Ignore cancellations
-      } catch (InterruptedException e) {
-        Thread.currentThread().interrupt();
-        throw new RuntimeException(e);
-      } catch (ExecutionException e) {
-        throw new RuntimeException(e);
+      if (bufferedLogWriter != null) {
+        try {
+          bufferedLogWriter.get();
+        } catch (CancellationException e) {
+          // Ignore cancellations
+        } catch (InterruptedException e) {
+          Thread.currentThread().interrupt();
+          throw new RuntimeException(e);
+        } catch (ExecutionException e) {
+          throw new RuntimeException(e);
+        }
       }
     }
   }
@@ -312,7 +320,7 @@ public class BeamFnLoggingClient implements AutoCloseable {
       implements ClientResponseObserver<BeamFnApi.LogEntry, BeamFnApi.LogControl> {
 
     @Override
-    public void beforeStart(ClientCallStreamObserver requestStream) {
+    public void beforeStart(ClientCallStreamObserver<BeamFnApi.LogEntry> requestStream) {
       requestStream.setOnReadyHandler(phaser::arrive);
     }
 
diff --git a/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/logging/BeamFnLoggingClientTest.java b/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/logging/BeamFnLoggingClientTest.java
index 8b69c6608df..93c1b3d0ef1 100644
--- a/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/logging/BeamFnLoggingClientTest.java
+++ b/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/logging/BeamFnLoggingClientTest.java
@@ -20,6 +20,7 @@ package org.apache.beam.fn.harness.logging;
 import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Throwables.getStackTraceAsString;
 import static org.hamcrest.Matchers.contains;
 import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertNotNull;
 import static org.junit.Assert.assertNull;
 import static org.junit.Assert.assertThat;
 import static org.junit.Assert.assertTrue;
@@ -32,6 +33,7 @@ import java.util.concurrent.atomic.AtomicReference;
 import java.util.logging.Level;
 import java.util.logging.LogManager;
 import java.util.logging.LogRecord;
+import java.util.logging.Logger;
 import org.apache.beam.model.fnexecution.v1.BeamFnApi;
 import org.apache.beam.model.fnexecution.v1.BeamFnLoggingGrpc;
 import org.apache.beam.model.pipeline.v1.Endpoints;
@@ -146,20 +148,25 @@ public class BeamFnLoggingClientTest {
               apiServiceDescriptor,
               (Endpoints.ApiServiceDescriptor descriptor) -> channel);
 
+      // Keep a strong reference to the loggers in this block. Otherwise the call to client.close()
+      // removes the only reference and the logger may get GC'd before the assertions (BEAM-4136).
+      Logger rootLogger = LogManager.getLogManager().getLogger("");
+      Logger configuredLogger = LogManager.getLogManager().getLogger("ConfiguredLogger");
+
       // Ensure that log levels were correctly set.
-      assertEquals(Level.OFF, LogManager.getLogManager().getLogger("").getLevel());
-      assertEquals(Level.FINE, LogManager.getLogManager().getLogger("ConfiguredLogger").getLevel());
+      assertEquals(Level.OFF, rootLogger.getLevel());
+      assertEquals(Level.FINE, configuredLogger.getLevel());
 
       // Should be filtered because the default log level override is OFF
-      LogManager.getLogManager().getLogger("").log(FILTERED_RECORD);
+      rootLogger.log(FILTERED_RECORD);
       // Should not be filtered because the default log level override for ConfiguredLogger is DEBUG
-      LogManager.getLogManager().getLogger("ConfiguredLogger").log(TEST_RECORD);
-      LogManager.getLogManager().getLogger("ConfiguredLogger").log(TEST_RECORD_WITH_EXCEPTION);
+      configuredLogger.log(TEST_RECORD);
+      configuredLogger.log(TEST_RECORD_WITH_EXCEPTION);
       client.close();
 
       // Verify that after close, log levels are reset.
-      assertEquals(Level.INFO, LogManager.getLogManager().getLogger("").getLevel());
-      assertNull(LogManager.getLogManager().getLogger("ConfiguredLogger").getLevel());
+      assertEquals(Level.INFO, rootLogger.getLevel());
+      assertNull(configuredLogger.getLevel());
 
       assertTrue(clientClosedStream.get());
       assertTrue(channel.isShutdown());
@@ -201,6 +208,12 @@ public class BeamFnLoggingClientTest {
     server.start();
 
     ManagedChannel channel = InProcessChannelBuilder.forName(apiServiceDescriptor.getUrl()).build();
+
+    // Keep a strong reference to the loggers. Otherwise the call to client.close()
+    // removes the only reference and the logger may get GC'd before the assertions (BEAM-4136).
+    Logger rootLogger = null;
+    Logger configuredLogger = null;
+
     try {
       BeamFnLoggingClient client =
           new BeamFnLoggingClient(
@@ -213,12 +226,18 @@ public class BeamFnLoggingClientTest {
               apiServiceDescriptor,
               (Endpoints.ApiServiceDescriptor descriptor) -> channel);
 
+      rootLogger = LogManager.getLogManager().getLogger("");
+      configuredLogger = LogManager.getLogManager().getLogger("ConfiguredLogger");
+
       thrown.expectMessage("TEST ERROR");
       client.close();
     } finally {
+      assertNotNull("rootLogger should be initialized before exception", rootLogger);
+      assertNotNull("configuredLogger should be initialized before exception", rootLogger);
+
       // Verify that after close, log levels are reset.
-      assertEquals(Level.INFO, LogManager.getLogManager().getLogger("").getLevel());
-      assertNull(LogManager.getLogManager().getLogger("ConfiguredLogger").getLevel());
+      assertEquals(Level.INFO, rootLogger.getLevel());
+      assertNull(configuredLogger.getLevel());
 
       assertTrue(channel.isShutdown());
 
@@ -269,12 +288,17 @@ public class BeamFnLoggingClientTest {
               apiServiceDescriptor,
               (Endpoints.ApiServiceDescriptor descriptor) -> channel);
 
+      // Keep a strong reference to the loggers in this block. Otherwise the call to client.close()
+      // removes the only reference and the logger may get GC'd before the assertions (BEAM-4136).
+      Logger rootLogger = LogManager.getLogManager().getLogger("");
+      Logger configuredLogger = LogManager.getLogManager().getLogger("ConfiguredLogger");
+
       client.close();
-    } finally {
-      // Verify that after close, log levels are reset.
-      assertEquals(Level.INFO, LogManager.getLogManager().getLogger("").getLevel());
-      assertNull(LogManager.getLogManager().getLogger("ConfiguredLogger").getLevel());
 
+      // Verify that after close, log levels are reset.
+      assertEquals(Level.INFO, rootLogger.getLevel());
+      assertNull(configuredLogger.getLevel());
+    } finally {
       assertTrue(channel.isShutdown());
 
       server.shutdownNow();
