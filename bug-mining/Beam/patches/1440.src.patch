diff --git a/sdks/java/io/rabbitmq/build.gradle b/sdks/java/io/rabbitmq/build.gradle
index 52802c5b1ac..bf5c396bf7c 100644
--- a/sdks/java/io/rabbitmq/build.gradle
+++ b/sdks/java/io/rabbitmq/build.gradle
@@ -26,7 +26,7 @@ dependencies {
   compile library.java.vendored_guava_26_0_jre
   compile project(path: ":sdks:java:core", configuration: "shadow")
   compile library.java.joda_time
-  compile "com.rabbitmq:amqp-client:4.9.3"
+  compile "com.rabbitmq:amqp-client:5.7.3"
   testCompile project(path: ":sdks:java:io:common", configuration: "testRuntime")
   testCompile "org.apache.qpid:qpid-broker:0.28"
   testCompile "org.apache.qpid:qpid-broker-core:0.28"
diff --git a/sdks/java/io/rabbitmq/src/main/java/org/apache/beam/sdk/io/rabbitmq/RabbitMqIO.java b/sdks/java/io/rabbitmq/src/main/java/org/apache/beam/sdk/io/rabbitmq/RabbitMqIO.java
index 6df3c8d83f5..0d6c3cf3688 100644
--- a/sdks/java/io/rabbitmq/src/main/java/org/apache/beam/sdk/io/rabbitmq/RabbitMqIO.java
+++ b/sdks/java/io/rabbitmq/src/main/java/org/apache/beam/sdk/io/rabbitmq/RabbitMqIO.java
@@ -23,8 +23,8 @@ import com.google.auto.value.AutoValue;
 import com.rabbitmq.client.Channel;
 import com.rabbitmq.client.Connection;
 import com.rabbitmq.client.ConnectionFactory;
+import com.rabbitmq.client.GetResponse;
 import com.rabbitmq.client.MessageProperties;
-import com.rabbitmq.client.QueueingConsumer;
 import java.io.IOException;
 import java.io.Serializable;
 import java.net.URISyntaxException;
@@ -367,7 +367,7 @@ public class RabbitMqIO {
     private RabbitMqMessage current;
     private byte[] currentRecordId;
     private ConnectionHandler connectionHandler;
-    private QueueingConsumer consumer;
+    private String queueName;
     private Instant currentTimestamp;
     private final RabbitMQCheckpointMark checkpointMark;
 
@@ -376,11 +376,6 @@ public class RabbitMqIO {
       this.source = source;
       this.current = null;
       this.checkpointMark = checkpointMark != null ? checkpointMark : new RabbitMQCheckpointMark();
-      try {
-        connectionHandler = new ConnectionHandler(source.spec.uri());
-      } catch (Exception e) {
-        throw new IOException(e);
-      }
     }
 
     @Override
@@ -429,12 +424,12 @@ public class RabbitMqIO {
     @Override
     public boolean start() throws IOException {
       try {
-        ConnectionHandler connectionHandler = new ConnectionHandler(source.spec.uri());
+        connectionHandler = new ConnectionHandler(source.spec.uri());
         connectionHandler.start();
 
         Channel channel = connectionHandler.getChannel();
 
-        String queueName = source.spec.queue();
+        queueName = source.spec.queue();
         if (source.spec.queueDeclare()) {
           // declare the queue (if not done by another application)
           // channel.queueDeclare(queueName, durable, exclusive, autoDelete, arguments);
@@ -448,11 +443,7 @@ public class RabbitMqIO {
           channel.queueBind(queueName, source.spec.exchange(), source.spec.routingKey());
         }
         checkpointMark.channel = channel;
-        consumer = new QueueingConsumer(channel);
         channel.txSelect();
-        // we consume message without autoAck (we want to do the ack ourselves)
-        channel.setDefaultConsumer(consumer);
-        channel.basicConsume(queueName, false, consumer);
       } catch (Exception e) {
         throw new IOException(e);
       }
@@ -462,12 +453,14 @@ public class RabbitMqIO {
     @Override
     public boolean advance() throws IOException {
       try {
-        QueueingConsumer.Delivery delivery = consumer.nextDelivery(1000);
+        Channel channel = connectionHandler.getChannel();
+        // we consume message without autoAck (we want to do the ack ourselves)
+        GetResponse delivery = channel.basicGet(queueName, false);
         if (delivery == null) {
           return false;
         }
         if (source.spec.useCorrelationId()) {
-          String correlationId = delivery.getProperties().getCorrelationId();
+          String correlationId = delivery.getProps().getCorrelationId();
           if (correlationId == null) {
             throw new IOException(
                 "RabbitMqIO.Read uses message correlation ID, but received "
@@ -479,7 +472,7 @@ public class RabbitMqIO {
         checkpointMark.sessionIds.add(deliveryTag);
 
         current = new RabbitMqMessage(source.spec.routingKey(), delivery);
-        currentTimestamp = new Instant(delivery.getProperties().getTimestamp());
+        currentTimestamp = new Instant(delivery.getProps().getTimestamp());
         if (currentTimestamp.isBefore(checkpointMark.oldestTimestamp)) {
           checkpointMark.oldestTimestamp = currentTimestamp;
         }
diff --git a/sdks/java/io/rabbitmq/src/main/java/org/apache/beam/sdk/io/rabbitmq/RabbitMqMessage.java b/sdks/java/io/rabbitmq/src/main/java/org/apache/beam/sdk/io/rabbitmq/RabbitMqMessage.java
index 1c24195a8e3..60288391923 100644
--- a/sdks/java/io/rabbitmq/src/main/java/org/apache/beam/sdk/io/rabbitmq/RabbitMqMessage.java
+++ b/sdks/java/io/rabbitmq/src/main/java/org/apache/beam/sdk/io/rabbitmq/RabbitMqMessage.java
@@ -20,9 +20,8 @@ package org.apache.beam.sdk.io.rabbitmq;
 import com.rabbitmq.client.AMQP;
 import com.rabbitmq.client.AMQP.BasicProperties;
 import com.rabbitmq.client.Envelope;
+import com.rabbitmq.client.GetResponse;
 import com.rabbitmq.client.LongString;
-import com.rabbitmq.client.QueueingConsumer;
-import com.rabbitmq.client.QueueingConsumer.Delivery;
 import java.io.Serializable;
 import java.util.Arrays;
 import java.util.Date;
@@ -44,11 +43,11 @@ public class RabbitMqMessage implements Serializable {
    * @param processed
    * @return
    */
-  private static Delivery serializableDeliveryOf(Delivery processed) {
+  private static GetResponse serializableDeliveryOf(GetResponse processed) {
     // All content of envelope is serializable, so no problem there
     Envelope envelope = processed.getEnvelope();
     // in basicproperties, there may be LongString, which are *not* serializable
-    BasicProperties properties = processed.getProperties();
+    BasicProperties properties = processed.getProps();
     BasicProperties nextProperties =
         new BasicProperties.Builder()
             .appId(properties.getAppId())
@@ -66,7 +65,8 @@ public class RabbitMqMessage implements Serializable {
             .type(properties.getType())
             .userId(properties.getUserId())
             .build();
-    return new Delivery(envelope, nextProperties, processed.getBody());
+    return new GetResponse(
+        envelope, nextProperties, processed.getBody(), processed.getMessageCount());
   }
 
   private static Map<String, Object> serializableHeaders(Map<String, Object> headers) {
@@ -134,24 +134,24 @@ public class RabbitMqMessage implements Serializable {
     clusterId = null;
   }
 
-  public RabbitMqMessage(String routingKey, QueueingConsumer.Delivery delivery) {
+  public RabbitMqMessage(String routingKey, GetResponse delivery) {
     this.routingKey = routingKey;
     delivery = serializableDeliveryOf(delivery);
     body = delivery.getBody();
-    contentType = delivery.getProperties().getContentType();
-    contentEncoding = delivery.getProperties().getContentEncoding();
-    headers = delivery.getProperties().getHeaders();
-    deliveryMode = delivery.getProperties().getDeliveryMode();
-    priority = delivery.getProperties().getPriority();
-    correlationId = delivery.getProperties().getCorrelationId();
-    replyTo = delivery.getProperties().getReplyTo();
-    expiration = delivery.getProperties().getExpiration();
-    messageId = delivery.getProperties().getMessageId();
-    timestamp = delivery.getProperties().getTimestamp();
-    type = delivery.getProperties().getType();
-    userId = delivery.getProperties().getUserId();
-    appId = delivery.getProperties().getAppId();
-    clusterId = delivery.getProperties().getClusterId();
+    contentType = delivery.getProps().getContentType();
+    contentEncoding = delivery.getProps().getContentEncoding();
+    headers = delivery.getProps().getHeaders();
+    deliveryMode = delivery.getProps().getDeliveryMode();
+    priority = delivery.getProps().getPriority();
+    correlationId = delivery.getProps().getCorrelationId();
+    replyTo = delivery.getProps().getReplyTo();
+    expiration = delivery.getProps().getExpiration();
+    messageId = delivery.getProps().getMessageId();
+    timestamp = delivery.getProps().getTimestamp();
+    type = delivery.getProps().getType();
+    userId = delivery.getProps().getUserId();
+    appId = delivery.getProps().getAppId();
+    clusterId = delivery.getProps().getClusterId();
   }
 
   public RabbitMqMessage(
