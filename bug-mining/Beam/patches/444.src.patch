diff --git a/sdks/python/apache_beam/coders/typecoders.py b/sdks/python/apache_beam/coders/typecoders.py
index 797aee5815f..d871c31b2ec 100644
--- a/sdks/python/apache_beam/coders/typecoders.py
+++ b/sdks/python/apache_beam/coders/typecoders.py
@@ -155,6 +155,10 @@ class CoderRegistry(object):
         if not silent:
           logging.warning(error_msg)
         return coders.DeterministicFastPrimitivesCoder(key_coder, op_name)
+      elif isinstance(key_coder, coders.TupleCoder):
+        return coders.TupleCoder([
+            self.verify_deterministic(coder, op_name, silent)
+            for coder in key_coder.coders()])
       else:
         raise ValueError(error_msg)
     else:
diff --git a/sdks/python/apache_beam/typehints/opcodes.py b/sdks/python/apache_beam/typehints/opcodes.py
index f0f81ff773f..7fae11b63ea 100644
--- a/sdks/python/apache_beam/typehints/opcodes.py
+++ b/sdks/python/apache_beam/typehints/opcodes.py
@@ -155,7 +155,7 @@ def binary_subscr(state, unused_arg):
   if base in (str, six.text_type):
     out = base
   elif (isinstance(index, Const) and isinstance(index.value, int)
-      and isinstance(base, typehints.TupleHint.TupleConstraint)):
+        and isinstance(base, typehints.TupleHint.TupleConstraint)):
     const_index = index.value
     if -len(base.tuple_types) < const_index < len(base.tuple_types):
       out = base.tuple_types[const_index]
