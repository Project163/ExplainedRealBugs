diff --git a/examples/java/src/main/java/org/apache/beam/examples/complete/game/UserScore.java b/examples/java/src/main/java/org/apache/beam/examples/complete/game/UserScore.java
index 8205baf35e3..0ebd744e0cf 100644
--- a/examples/java/src/main/java/org/apache/beam/examples/complete/game/UserScore.java
+++ b/examples/java/src/main/java/org/apache/beam/examples/complete/game/UserScore.java
@@ -128,6 +128,7 @@ public class UserScore {
 
     @ProcessElement
     public void processElement(ProcessContext c) {
+      System.out.println("GOT " + c.element());
       String[] components = c.element().split(",");
       try {
         String user = components[0].trim();
diff --git a/examples/java/src/main/java/org/apache/beam/examples/complete/game/injector/InjectorUtils.java b/examples/java/src/main/java/org/apache/beam/examples/complete/game/injector/InjectorUtils.java
index 1667f3a4691..6bad1cbe616 100644
--- a/examples/java/src/main/java/org/apache/beam/examples/complete/game/injector/InjectorUtils.java
+++ b/examples/java/src/main/java/org/apache/beam/examples/complete/game/injector/InjectorUtils.java
@@ -86,6 +86,7 @@ class InjectorUtils {
    */
   public static void createTopic(Pubsub client, String fullTopicName)
       throws IOException {
+    System.out.println("fullTopicName " + fullTopicName);
     try {
         client.projects().topics().get(fullTopicName).execute();
     } catch (GoogleJsonResponseException e) {
diff --git a/sdks/python/apache_beam/testing/data/trigger_transcripts.yaml b/sdks/python/apache_beam/testing/data/trigger_transcripts.yaml
index a736e943ac5..1244736c1ce 100644
--- a/sdks/python/apache_beam/testing/data/trigger_transcripts.yaml
+++ b/sdks/python/apache_beam/testing/data/trigger_transcripts.yaml
@@ -121,7 +121,7 @@ transcript:
     - input: [4]    # no output
     - input: [5]
     - expect:
-        - {window: [1, 14], values: [1, 2, 3, 4, 5], timestamp: 14, early: true}
+        - {window: [1, 14], values: [1, 2, 3, 4, 5], timestamp: 15, early: true}
     - input: [6]
     - watermark: 100
     - expect:
diff --git a/sdks/python/apache_beam/transforms/trigger.py b/sdks/python/apache_beam/transforms/trigger.py
index 7d03240f941..d47c740d0e1 100644
--- a/sdks/python/apache_beam/transforms/trigger.py
+++ b/sdks/python/apache_beam/transforms/trigger.py
@@ -1083,6 +1083,7 @@ class GeneralTriggerDriver(TriggerDriver):
             for unused_value, timestamp in elements)
            if element_output_time >= output_watermark))
       if output_time is not None:
+        state.clear_state(window, self.WATERMARK_HOLD)
         state.add_state(window, self.WATERMARK_HOLD, output_time)
 
       context = state.at(window, self.clock)
diff --git a/sdks/python/apache_beam/transforms/trigger_test.py b/sdks/python/apache_beam/transforms/trigger_test.py
index aaaa2247b01..a765493ae81 100644
--- a/sdks/python/apache_beam/transforms/trigger_test.py
+++ b/sdks/python/apache_beam/transforms/trigger_test.py
@@ -65,10 +65,21 @@ class TriggerTest(unittest.TestCase):
   def run_trigger_simple(self, window_fn, trigger_fn, accumulation_mode,
                          timestamped_data, expected_panes, *groupings,
                          **kwargs):
+    # Groupings is a list of integers indicating the (uniform) size of bundles
+    # to try. For example, if timestamped_data has elements [a, b, c, d, e]
+    # then groupings=(5, 2) would first run the test with everything in the same
+    # bundle, and then re-run the test with bundling [a, b], [c, d], [e].
+    # A negative value will reverse the order, e.g. -2 would result in bundles
+    # [e, d], [c, b], [a].  This is useful for deterministic triggers in testing
+    # that the output is not a function of ordering or bundling.
+    # If empty, defaults to bundles of size 1 in the given order.
     late_data = kwargs.pop('late_data', [])
     assert not kwargs
 
     def bundle_data(data, size):
+      if size < 0:
+        data = list(data)[::-1]
+        size = -size
       bundle = []
       for timestamp, elem in data:
         windows = window_fn.assign(WindowFn.AssignContext(timestamp, elem))
@@ -82,15 +93,6 @@ class TriggerTest(unittest.TestCase):
     if not groupings:
       groupings = [1]
     for group_by in groupings:
-      bundles = []
-      bundle = []
-      for timestamp, elem in timestamped_data:
-        windows = window_fn.assign(WindowFn.AssignContext(timestamp, elem))
-        bundle.append(WindowedValue(elem, timestamp, windows))
-        if len(bundle) == group_by:
-          bundles.append(bundle)
-          bundle = []
-      bundles.append(bundle)
       self.run_trigger(window_fn, trigger_fn, accumulation_mode,
                        bundle_data(timestamped_data, group_by),
                        bundle_data(late_data, group_by),
@@ -107,6 +109,7 @@ class TriggerTest(unittest.TestCase):
     for bundle in bundles:
       for wvalue in driver.process_elements(state, bundle, MIN_TIMESTAMP):
         window, = wvalue.windows
+        self.assertEqual(window.end, wvalue.timestamp)
         actual_panes[window].append(set(wvalue.value))
 
     while state.timers:
@@ -115,11 +118,13 @@ class TriggerTest(unittest.TestCase):
         for wvalue in driver.process_timer(
             timer_window, name, time_domain, timestamp, state):
           window, = wvalue.windows
+          self.assertEqual(window.end, wvalue.timestamp)
           actual_panes[window].append(set(wvalue.value))
 
     for bundle in late_bundles:
       for wvalue in driver.process_elements(state, bundle, MIN_TIMESTAMP):
         window, = wvalue.windows
+        self.assertEqual(window.end, wvalue.timestamp)
         actual_panes[window].append(set(wvalue.value))
 
       while state.timers:
@@ -128,6 +133,7 @@ class TriggerTest(unittest.TestCase):
           for wvalue in driver.process_timer(
               timer_window, name, time_domain, timestamp, state):
             window, = wvalue.windows
+            self.assertEqual(window.end, wvalue.timestamp)
             actual_panes[window].append(set(wvalue.value))
 
     self.assertEqual(expected_panes, actual_panes)
@@ -142,7 +148,10 @@ class TriggerTest(unittest.TestCase):
          IntervalWindow(10, 20): [set('c')]},
         1,
         2,
-        3)
+        3,
+        -3,
+        -2,
+        -1)
 
   def test_fixed_watermark_with_early(self):
     self.run_trigger_simple(
@@ -278,7 +287,9 @@ class TriggerTest(unittest.TestCase):
         [(1, 'a'), (2, 'b')],
         {IntervalWindow(1, 12): [set('ab')]},
         1,
-        2)
+        2,
+        -2,
+        -1)
 
     self.run_trigger_simple(
         Sessions(10),  # pyformat break
@@ -293,7 +304,10 @@ class TriggerTest(unittest.TestCase):
         3,
         4,
         5,
-        6)
+        6,
+        -4,
+        -2,
+        -1)
 
   def test_sessions_watermark(self):
     self.run_trigger_simple(
@@ -303,22 +317,9 @@ class TriggerTest(unittest.TestCase):
         [(1, 'a'), (2, 'b')],
         {IntervalWindow(1, 12): [set('ab')]},
         1,
-        2)
-
-    self.run_trigger_simple(
-        Sessions(10),  # pyformat break
-        AfterWatermark(),
-        AccumulationMode.ACCUMULATING,
-        [(1, 'a'), (2, 'b'), (15, 'c'), (16, 'd'), (30, 'z'), (9, 'e'),
-         (10, 'f'), (30, 'y')],
-        {IntervalWindow(1, 26): [set('abcdef')],
-         IntervalWindow(30, 40): [set('yz')]},
-        1,
         2,
-        3,
-        4,
-        5,
-        6)
+        -2,
+        -1)
 
   def test_sessions_after_count(self):
     self.run_trigger_simple(
