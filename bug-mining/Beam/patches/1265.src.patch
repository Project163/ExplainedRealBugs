diff --git a/runners/direct-java/src/main/java/org/apache/beam/runners/direct/DirectTransformExecutor.java b/runners/direct-java/src/main/java/org/apache/beam/runners/direct/DirectTransformExecutor.java
index a3f3c0fe86c..818af94b3a4 100644
--- a/runners/direct-java/src/main/java/org/apache/beam/runners/direct/DirectTransformExecutor.java
+++ b/runners/direct-java/src/main/java/org/apache/beam/runners/direct/DirectTransformExecutor.java
@@ -121,9 +121,14 @@ class DirectTransformExecutor<T> implements TransformExecutor {
         return;
       }
 
-      processElements(evaluator, metricsContainer, enforcements);
+      try {
+        context.lockWatermarkUpdates();
+        processElements(evaluator, metricsContainer, enforcements);
 
-      finishBundle(evaluator, metricsContainer, enforcements);
+        finishBundle(evaluator, metricsContainer, enforcements);
+      } finally {
+        context.unlockWatermarkUpdates();
+      }
     } catch (Exception e) {
       onComplete.handleException(inputBundle, e);
       if (e instanceof RuntimeException) {
diff --git a/runners/direct-java/src/main/java/org/apache/beam/runners/direct/EvaluationContext.java b/runners/direct-java/src/main/java/org/apache/beam/runners/direct/EvaluationContext.java
index 5fc27509515..cdc7d4a52df 100644
--- a/runners/direct-java/src/main/java/org/apache/beam/runners/direct/EvaluationContext.java
+++ b/runners/direct-java/src/main/java/org/apache/beam/runners/direct/EvaluationContext.java
@@ -357,6 +357,14 @@ class EvaluationContext {
     return metrics;
   }
 
+  void lockWatermarkUpdates() {
+    watermarkManager.lockRefresh();
+  }
+
+  void unlockWatermarkUpdates() {
+    watermarkManager.unlockRefresh();
+  }
+
   @VisibleForTesting
   void forceRefresh() {
     watermarkManager.refreshAll();
diff --git a/runners/direct-java/src/main/java/org/apache/beam/runners/direct/WatermarkManager.java b/runners/direct-java/src/main/java/org/apache/beam/runners/direct/WatermarkManager.java
index 82dc0ae4416..acd0b5f2447 100644
--- a/runners/direct-java/src/main/java/org/apache/beam/runners/direct/WatermarkManager.java
+++ b/runners/direct-java/src/main/java/org/apache/beam/runners/direct/WatermarkManager.java
@@ -1155,6 +1155,14 @@ public class WatermarkManager<ExecutableT, CollectionT> {
     }
   }
 
+  void unlockRefresh() {
+    refreshLock.unlock();
+  }
+
+  void lockRefresh() {
+    refreshLock.lock();
+  }
+
   /**
    * A (key, Instant) pair that holds the watermark. Holds are per-key, but the watermark is global,
    * and as such the watermark manager must track holds and the release of holds on a per-key basis.
