diff --git a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/graph/QueryablePipeline.java b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/graph/QueryablePipeline.java
index 266d02c7b05..280e705db6c 100644
--- a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/graph/QueryablePipeline.java
+++ b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/graph/QueryablePipeline.java
@@ -362,7 +362,10 @@ public class QueryablePipeline {
                           Iterables.getOnlyElement(
                               Sets.difference(
                                   transform.getTransform().getInputsMap().keySet(),
-                                  getLocalSideInputNames(transformProto))));
+                                  ImmutableSet.builder()
+                                      .addAll(getLocalSideInputNames(transformProto))
+                                      .addAll(getLocalTimerNames(transformProto))
+                                      .build())));
               PCollection collection = components.getPcollectionsOrThrow(collectionId);
               return UserStateReference.of(
                   PipelineNode.pTransform(transformId, transformProto),
diff --git a/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/graph/GreedyPipelineFuserTest.java b/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/graph/GreedyPipelineFuserTest.java
index bea936dfe90..b89e380f0a9 100644
--- a/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/graph/GreedyPipelineFuserTest.java
+++ b/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/graph/GreedyPipelineFuserTest.java
@@ -1049,6 +1049,57 @@ public class GreedyPipelineFuserTest {
             ExecutableStageMatcher.withInput("parDo.out").withNoOutputs().withTransforms("timer")));
   }
 
+  /*
+   * Tests that parDo with state and timers is fused correctly and can be queried
+   * impulse -> .out -> timer -> .out
+   * becomes
+   * (impulse.out) -> timer
+   */
+  @Test
+  public void parDoWithStateAndTimerRootsStage() {
+    PTransform timerTransform =
+        PTransform.newBuilder()
+            .setUniqueName("TimerParDo")
+            .putInputs("input", "impulse.out")
+            .putInputs("timer", "timer.out")
+            .putOutputs("timer", "timer.out")
+            .putOutputs("output", "output.out")
+            .setSpec(
+                FunctionSpec.newBuilder()
+                    .setUrn(PTransformTranslation.PAR_DO_TRANSFORM_URN)
+                    .setPayload(
+                        ParDoPayload.newBuilder()
+                            .setDoFn(SdkFunctionSpec.newBuilder().setEnvironmentId("common"))
+                            .putStateSpecs("state", StateSpec.getDefaultInstance())
+                            .putTimerSpecs("timer", TimerSpec.getDefaultInstance())
+                            .build()
+                            .toByteString()))
+            .build();
+
+    Components components =
+        partialComponents
+            .toBuilder()
+            .putTransforms("timer", timerTransform)
+            .putPcollections("timer.out", pc("timer.out"))
+            .putPcollections("output.out", pc("output.out"))
+            .putEnvironments("common", Environments.createDockerEnvironment("common"))
+            .build();
+
+    FusedPipeline fused =
+        GreedyPipelineFuser.fuse(Pipeline.newBuilder().setComponents(components).build());
+
+    assertThat(
+        fused.getRunnerExecutedTransforms(),
+        containsInAnyOrder(
+            PipelineNode.pTransform("impulse", components.getTransformsOrThrow("impulse"))));
+    assertThat(
+        fused.getFusedStages(),
+        contains(
+            ExecutableStageMatcher.withInput("impulse.out")
+                .withNoOutputs()
+                .withTransforms("timer")));
+  }
+
   /*
    * impulse -> .out -> ( read -> .out --> goTransform -> .out )
    *                                    \
