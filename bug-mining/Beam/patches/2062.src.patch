diff --git a/sdks/python/apache_beam/typehints/opcodes.py b/sdks/python/apache_beam/typehints/opcodes.py
index 8ba2c913df3..fd11b8121d5 100644
--- a/sdks/python/apache_beam/typehints/opcodes.py
+++ b/sdks/python/apache_beam/typehints/opcodes.py
@@ -269,7 +269,7 @@ def build_map(state, arg):
   if sys.version_info <= (2, ) or arg == 0:
     state.stack.append(Dict[Union[()], Union[()]])
   else:
-    state.stack[-arg:] = [
+    state.stack[-2 * arg:] = [
         Dict[reduce(union, state.stack[-2 * arg::2], Union[()]),
              reduce(union, state.stack[-2 * arg + 1::2], Union[()])]
     ]
diff --git a/sdks/python/apache_beam/typehints/trivial_inference_test.py b/sdks/python/apache_beam/typehints/trivial_inference_test.py
index 3f33490ece7..7f54a407d64 100644
--- a/sdks/python/apache_beam/typehints/trivial_inference_test.py
+++ b/sdks/python/apache_beam/typehints/trivial_inference_test.py
@@ -112,6 +112,12 @@ class TrivialInferenceTest(unittest.TestCase):
         v: {}, [int, float])
     self.assertReturnType(
         typehints.Dict[int, float], lambda k, v: {k: v}, [int, float])
+    self.assertReturnType(
+        typehints.Tuple[str, typehints.Dict[int, float]],
+        lambda k,
+        v: ('s', {
+            k: v
+        }), [int, float])
     self.assertReturnType(
         typehints.Dict[int, typehints.Union[float, str]],
         lambda k1,
@@ -128,6 +134,12 @@ class TrivialInferenceTest(unittest.TestCase):
         b: {
             'a': a, 'b': b
         }, [int, float])
+    self.assertReturnType(
+        typehints.Tuple[int, typehints.Dict[str, typehints.Union[int, float]]],
+        lambda a,
+        b: (4, {
+            'a': a, 'b': b
+        }), [int, float])
 
   def testNoneReturn(self):
     def func(a):
