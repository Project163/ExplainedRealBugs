diff --git a/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkBatchPortablePipelineTranslator.java b/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkBatchPortablePipelineTranslator.java
index b0e88c92f3b..01c93629046 100644
--- a/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkBatchPortablePipelineTranslator.java
+++ b/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkBatchPortablePipelineTranslator.java
@@ -39,7 +39,6 @@ import java.util.TreeMap;
 import java.util.stream.Collectors;
 import org.apache.beam.model.pipeline.v1.RunnerApi;
 import org.apache.beam.model.pipeline.v1.RunnerApi.ExecutableStagePayload.SideInputId;
-import org.apache.beam.runners.core.construction.CoderTranslation;
 import org.apache.beam.runners.core.construction.PTransformTranslation;
 import org.apache.beam.runners.core.construction.PipelineOptionsTranslation;
 import org.apache.beam.runners.core.construction.RehydratedComponents;
@@ -273,8 +272,15 @@ public class FlinkBatchPortablePipelineTranslator
         Iterables.getOnlyElement(transform.getTransform().getInputsMap().values());
     String outputCollectionId =
         Iterables.getOnlyElement(transform.getTransform().getOutputsMap().values());
-    Coder<WindowedValue<T>> outputCoder =
-        instantiateRunnerWireCoder(outputCollectionId, components);
+    PCollectionNode collectionNode =
+        PipelineNode.pCollection(
+            outputCollectionId, components.getPcollectionsOrThrow(outputCollectionId));
+    Coder<WindowedValue<T>> outputCoder;
+    try {
+      outputCoder = WireCoders.instantiateRunnerWireCoder(collectionNode, components);
+    } catch (IOException e) {
+      throw new RuntimeException(e);
+    }
     TypeInformation<WindowedValue<T>> resultTypeInfo = new CoderTypeInformation<>(outputCoder);
 
     DataSet<WindowedValue<T>> inputDataSet = context.getDataSetOrThrow(inputCollectionId);
@@ -307,10 +313,16 @@ public class FlinkBatchPortablePipelineTranslator
     // Enforce tuple tag sorting by union tag index.
     Map<String, Coder<WindowedValue<?>>> outputCoders = Maps.newHashMap();
     for (String collectionId : new TreeMap<>(outputMap.inverse()).values()) {
-      Coder<WindowedValue<?>> windowCoder =
-          (Coder) instantiateRunnerWireCoder(collectionId, components);
-      outputCoders.put(collectionId, windowCoder);
-      unionCoders.add(windowCoder);
+      PCollectionNode collectionNode =
+          PipelineNode.pCollection(collectionId, components.getPcollectionsOrThrow(collectionId));
+      Coder<WindowedValue<?>> coder;
+      try {
+        coder = (Coder) WireCoders.instantiateRunnerWireCoder(collectionNode, components);
+      } catch (IOException e) {
+        throw new RuntimeException(e);
+      }
+      outputCoders.put(collectionId, coder);
+      unionCoders.add(coder);
     }
     UnionCoder unionCoder = UnionCoder.of(unionCoders);
     TypeInformation<RawUnionValue> typeInformation = new CoderTypeInformation<>(unionCoder);
@@ -405,8 +417,12 @@ public class FlinkBatchPortablePipelineTranslator
 
   private static <K, V> void translateGroupByKey(
       PTransformNode transform, RunnerApi.Pipeline pipeline, BatchTranslationContext context) {
+    RunnerApi.Components components = pipeline.getComponents();
     String inputPCollectionId =
         Iterables.getOnlyElement(transform.getTransform().getInputsMap().values());
+    PCollectionNode inputCollection =
+        PipelineNode.pCollection(
+            inputPCollectionId, components.getPcollectionsOrThrow(inputPCollectionId));
     DataSet<WindowedValue<KV<K, V>>> inputDataSet = context.getDataSetOrThrow(inputPCollectionId);
     RunnerApi.WindowingStrategy windowingStrategyProto =
         pipeline
@@ -432,8 +448,14 @@ public class FlinkBatchPortablePipelineTranslator
           e);
     }
 
-    WindowedValueCoder<KV<K, V>> inputCoder =
-        instantiateRunnerWireCoder(inputPCollectionId, pipeline.getComponents());
+    WindowedValueCoder<KV<K, V>> inputCoder;
+    try {
+      inputCoder =
+          (WindowedValueCoder)
+              WireCoders.instantiateRunnerWireCoder(inputCollection, pipeline.getComponents());
+    } catch (IOException e) {
+      throw new RuntimeException(e);
+    }
 
     KvCoder<K, V> inputElementCoder = (KvCoder<K, V>) inputCoder.getValueCoder();
 
@@ -585,26 +607,4 @@ public class FlinkBatchPortablePipelineTranslator
     }
     return builder.build();
   }
-
-  /** Instantiates a Java coder for windowed values of the given PCollection id. */
-  private static <T> WindowedValueCoder<T> instantiateRunnerWireCoder(
-      String collectionId, RunnerApi.Components components) {
-    RunnerApi.PCollection collection = components.getPcollectionsOrThrow(collectionId);
-    PCollectionNode collectionNode = PipelineNode.pCollection(collectionId, collection);
-
-    // Instantiate the wire coder by length-prefixing unknown coders.
-    RunnerApi.MessageWithComponents protoCoder =
-        WireCoders.createRunnerWireCoder(collectionNode, components, components::containsCoders);
-    Coder<?> javaCoder;
-    try {
-      javaCoder =
-          CoderTranslation.fromProto(
-              protoCoder.getCoder(),
-              RehydratedComponents.forComponents(protoCoder.getComponents()));
-    } catch (IOException e) {
-      throw new RuntimeException(e);
-    }
-    checkArgument(javaCoder instanceof WindowedValueCoder);
-    return (WindowedValueCoder<T>) javaCoder;
-  }
 }
diff --git a/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/control/ProcessBundleDescriptors.java b/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/control/ProcessBundleDescriptors.java
index 2ecad1133f3..789b495953d 100644
--- a/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/control/ProcessBundleDescriptors.java
+++ b/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/control/ProcessBundleDescriptors.java
@@ -18,7 +18,6 @@
 
 package org.apache.beam.runners.fnexecution.control;
 
-import static com.google.common.base.Preconditions.checkArgument;
 import static org.apache.beam.runners.core.construction.SyntheticComponents.uniqueId;
 
 import com.google.auto.value.AutoValue;
@@ -38,19 +37,15 @@ import org.apache.beam.model.pipeline.v1.RunnerApi;
 import org.apache.beam.model.pipeline.v1.RunnerApi.Components;
 import org.apache.beam.model.pipeline.v1.RunnerApi.MessageWithComponents;
 import org.apache.beam.model.pipeline.v1.RunnerApi.PTransform;
-import org.apache.beam.runners.core.construction.CoderTranslation;
-import org.apache.beam.runners.core.construction.RehydratedComponents;
 import org.apache.beam.runners.core.construction.graph.ExecutableStage;
 import org.apache.beam.runners.core.construction.graph.PipelineNode.PCollectionNode;
 import org.apache.beam.runners.core.construction.graph.PipelineNode.PTransformNode;
 import org.apache.beam.runners.fnexecution.data.RemoteInputDestination;
-import org.apache.beam.runners.fnexecution.wire.LengthPrefixUnknownCoders;
 import org.apache.beam.runners.fnexecution.wire.WireCoders;
 import org.apache.beam.sdk.coders.Coder;
 import org.apache.beam.sdk.fn.data.RemoteGrpcPortRead;
 import org.apache.beam.sdk.fn.data.RemoteGrpcPortWrite;
 import org.apache.beam.sdk.util.WindowedValue;
-import org.apache.beam.sdk.util.WindowedValue.FullWindowedValueCoder;
 
 /** Utility methods for creating {@link ProcessBundleDescriptor} instances. */
 // TODO: Rename to ExecutableStages?
@@ -96,6 +91,10 @@ public class ProcessBundleDescriptors {
       ProcessBundleDescriptor.Builder bundleDescriptorBuilder)
       throws IOException {
     String inputWireCoderId = addWireCoder(inputPCollection, components, bundleDescriptorBuilder);
+    @SuppressWarnings("unchecked")
+    Coder<WindowedValue<?>> wireCoder =
+        (Coder) WireCoders.instantiateRunnerWireCoder(inputPCollection, components);
+
     RemoteGrpcPort inputPort =
         RemoteGrpcPort.newBuilder()
             .setApiServiceDescriptor(dataEndpoint)
@@ -109,7 +108,7 @@ public class ProcessBundleDescriptors {
         RemoteGrpcPortRead.readFromPort(inputPort, inputPCollection.getId()).toPTransform();
     bundleDescriptorBuilder.putTransforms(inputId, inputTransform);
     return RemoteInputDestination.of(
-        instantiateWireCoder(inputPort, bundleDescriptorBuilder.getCodersMap()),
+        wireCoder,
         Target.newBuilder()
             .setPrimitiveTransformReference(inputId)
             .setName(Iterables.getOnlyElement(inputTransform.getOutputsMap().keySet()))
@@ -123,7 +122,9 @@ public class ProcessBundleDescriptors {
       PCollectionNode outputPCollection)
       throws IOException {
     String outputWireCoderId = addWireCoder(outputPCollection, components, bundleDescriptorBuilder);
-
+    @SuppressWarnings("unchecked")
+    Coder<WindowedValue<?>> wireCoder =
+        (Coder) WireCoders.instantiateRunnerWireCoder(outputPCollection, components);
     RemoteGrpcPort outputPort =
         RemoteGrpcPort.newBuilder()
             .setApiServiceDescriptor(dataEndpoint)
@@ -142,7 +143,7 @@ public class ProcessBundleDescriptors {
             .setPrimitiveTransformReference(outputId)
             .setName(Iterables.getOnlyElement(outputTransform.getInputsMap().keySet()))
             .build(),
-        instantiateWireCoder(outputPort, bundleDescriptorBuilder.getCodersMap()));
+        wireCoder);
   }
 
   @AutoValue
@@ -172,24 +173,6 @@ public class ProcessBundleDescriptors {
     return wireCoderId;
   }
 
-  private static Coder<WindowedValue<?>> instantiateWireCoder(
-      RemoteGrpcPort port, Map<String, RunnerApi.Coder> components) throws IOException {
-    MessageWithComponents byteArrayCoder =
-        LengthPrefixUnknownCoders.forCoder(
-            port.getCoderId(), Components.newBuilder().putAllCoders(components).build(), true);
-    Coder<?> javaCoder =
-        CoderTranslation.fromProto(
-            byteArrayCoder.getCoder(),
-            RehydratedComponents.forComponents(byteArrayCoder.getComponents()));
-    checkArgument(
-        javaCoder instanceof WindowedValue.FullWindowedValueCoder,
-        "Unexpected Deserialized %s type, expected %s, got %s",
-        RunnerApi.Coder.class.getSimpleName(),
-        FullWindowedValueCoder.class.getSimpleName(),
-        javaCoder.getClass());
-    return (Coder<WindowedValue<?>>) javaCoder;
-  }
-
   /** */
   @AutoValue
   public abstract static class ExecutableProcessBundleDescriptor {
diff --git a/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/wire/WireCoders.java b/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/wire/WireCoders.java
index 3ec1fc74acb..52c7b289b5a 100644
--- a/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/wire/WireCoders.java
+++ b/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/wire/WireCoders.java
@@ -17,29 +17,69 @@
  */
 package org.apache.beam.runners.fnexecution.wire;
 
+import static com.google.common.base.Preconditions.checkArgument;
+
+import java.io.IOException;
 import java.util.function.Predicate;
 import org.apache.beam.model.pipeline.v1.RunnerApi;
+import org.apache.beam.runners.core.construction.CoderTranslation;
 import org.apache.beam.runners.core.construction.ModelCoders;
+import org.apache.beam.runners.core.construction.RehydratedComponents;
 import org.apache.beam.runners.core.construction.SyntheticComponents;
 import org.apache.beam.runners.core.construction.graph.PipelineNode.PCollectionNode;
+import org.apache.beam.sdk.coders.Coder;
+import org.apache.beam.sdk.util.WindowedValue;
+import org.apache.beam.sdk.util.WindowedValue.FullWindowedValueCoder;
 
 /** Helpers to construct coders for gRPC port reads and writes. */
 public class WireCoders {
-  /** Creates an SDK-side wire coder for a port read/write for the given PCollection. */
+  /**
+   * Creates an SDK-side wire coder for a port read/write for the given PCollection. Coders that are
+   * unknown to the runner are wrapped with length-prefix coders. The inner element coders are kept
+   * intact so that SDK harnesses can reconstruct the original elements.
+   *
+   * @return a windowed value coder containing the PCollection's element coder
+   */
   public static RunnerApi.MessageWithComponents createSdkWireCoder(
       PCollectionNode pCollectionNode, RunnerApi.Components components, Predicate<String> idUsed) {
     return createWireCoder(pCollectionNode, components, idUsed, false);
   }
 
   /**
-   * Creates a runner-side wire coder for a port read/write for the given PCollection. Returns a
-   * windowed value coder. The element coder itself
+   * Creates a runner-side wire coder for a port read/write for the given PCollection. Unknown
+   * coders are replaced with length-prefixed byte arrays.
+   *
+   * @return a windowed value coder containing the PCollection's element coder
    */
   public static RunnerApi.MessageWithComponents createRunnerWireCoder(
       PCollectionNode pCollectionNode, RunnerApi.Components components, Predicate<String> idUsed) {
     return createWireCoder(pCollectionNode, components, idUsed, true);
   }
 
+  /**
+   * Instantiates a runner-side wire coder for the given PCollection. Any component coders that are
+   * unknown by the runner are replaced with length-prefixed byte arrays.
+   *
+   * @return a windowed value coder containing the PCollection's element coder
+   */
+  public static <T> Coder<WindowedValue<T>> instantiateRunnerWireCoder(
+      PCollectionNode pCollectionNode, RunnerApi.Components components) throws IOException {
+    // NOTE: We discard the new set of components so we don't bother to ensure it's consistent with
+    // the caller's view.
+    RunnerApi.MessageWithComponents protoCoder =
+        createRunnerWireCoder(pCollectionNode, components, components::containsCoders);
+    Coder<?> javaCoder =
+        CoderTranslation.fromProto(
+            protoCoder.getCoder(), RehydratedComponents.forComponents(protoCoder.getComponents()));
+    checkArgument(
+        javaCoder instanceof WindowedValue.FullWindowedValueCoder,
+        "Unexpected Deserialized %s type, expected %s, got %s",
+        RunnerApi.Coder.class.getSimpleName(),
+        FullWindowedValueCoder.class.getSimpleName(),
+        javaCoder.getClass());
+    return (Coder<WindowedValue<T>>) javaCoder;
+  }
+
   private static RunnerApi.MessageWithComponents createWireCoder(
       PCollectionNode pCollectionNode,
       RunnerApi.Components components,
