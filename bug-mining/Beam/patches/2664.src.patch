diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/schemas/transforms/CoGroup.java b/sdks/java/core/src/main/java/org/apache/beam/sdk/schemas/transforms/CoGroup.java
index 0df65eab056..38cb8fabd00 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/schemas/transforms/CoGroup.java
+++ b/sdks/java/core/src/main/java/org/apache/beam/sdk/schemas/transforms/CoGroup.java
@@ -379,7 +379,6 @@ public class CoGroup {
       Schema keySchema = null;
       for (Map.Entry<TupleTag<?>, PCollection<?>> entry : input.getAll().entrySet()) {
         String tag = entry.getKey().getId();
-        int tagIndex = sortedTags.indexOf(tag);
         PCollection<?> pc = entry.getValue();
         Schema schema = pc.getSchema();
         componentSchemas.put(tag, schema);
@@ -398,6 +397,15 @@ public class CoGroup {
         } else {
           keySchema = SchemaUtils.mergeWideningNullable(keySchema, currentKeySchema);
         }
+      }
+      // Second loop so we can widen the keySchema with every input before using it
+      for (Map.Entry<TupleTag<?>, PCollection<?>> entry : input.getAll().entrySet()) {
+        String tag = entry.getKey().getId();
+        int tagIndex = sortedTags.indexOf(tag);
+        PCollection<?> pc = entry.getValue();
+        Schema schema = pc.getSchema();
+        FieldAccessDescriptor fieldAccessDescriptor = getFieldAccessDescriptor.apply(tag);
+        FieldAccessDescriptor resolved = fieldAccessDescriptor.resolve(schema);
 
         // Create a new tag for the output.
         TupleTag randomTag = new TupleTag<>();
diff --git a/sdks/java/core/src/test/java/org/apache/beam/sdk/schemas/transforms/JoinTest.java b/sdks/java/core/src/test/java/org/apache/beam/sdk/schemas/transforms/JoinTest.java
index ef8daf1f0a9..0650ea751b0 100644
--- a/sdks/java/core/src/test/java/org/apache/beam/sdk/schemas/transforms/JoinTest.java
+++ b/sdks/java/core/src/test/java/org/apache/beam/sdk/schemas/transforms/JoinTest.java
@@ -30,7 +30,7 @@ import org.apache.beam.sdk.testing.UsesSchema;
 import org.apache.beam.sdk.transforms.Create;
 import org.apache.beam.sdk.values.PCollection;
 import org.apache.beam.sdk.values.Row;
-import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.collect.Lists;
+import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.collect.ImmutableList;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.experimental.categories.Category;
@@ -55,12 +55,18 @@ public class JoinTest {
           .addInt32Field("count2")
           .addStringField("country2")
           .build();
+  private static final Schema CG_SCHEMA_2N =
+      Schema.builder()
+          .addNullableField("user2", Schema.FieldType.STRING)
+          .addNullableField("count2", Schema.FieldType.INT32)
+          .addNullableField("country2", Schema.FieldType.STRING)
+          .build();
 
   @Test
   @Category(NeedsRunner.class)
   public void testInnerJoinSameKeys() {
     List<Row> pc1Rows =
-        Lists.newArrayList(
+        ImmutableList.of(
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 1, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 2, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 3, "il").build(),
@@ -71,7 +77,7 @@ public class JoinTest {
             Row.withSchema(CG_SCHEMA_1).addValues("user2", 8, "ar").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user3", 8, "ar").build());
     List<Row> pc2Rows =
-        Lists.newArrayList(
+        ImmutableList.of(
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 9, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 10, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 11, "il").build(),
@@ -118,7 +124,7 @@ public class JoinTest {
   @Category(NeedsRunner.class)
   public void testInnerJoinDifferentKeys() {
     List<Row> pc1Rows =
-        Lists.newArrayList(
+        ImmutableList.of(
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 1, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 2, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 3, "il").build(),
@@ -129,7 +135,7 @@ public class JoinTest {
             Row.withSchema(CG_SCHEMA_1).addValues("user2", 8, "ar").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user3", 8, "ar").build());
     List<Row> pc2Rows =
-        Lists.newArrayList(
+        ImmutableList.of(
             Row.withSchema(CG_SCHEMA_2).addValues("user1", 9, "us").build(),
             Row.withSchema(CG_SCHEMA_2).addValues("user1", 10, "us").build(),
             Row.withSchema(CG_SCHEMA_2).addValues("user1", 11, "il").build(),
@@ -176,11 +182,76 @@ public class JoinTest {
     pipeline.run();
   }
 
+  @Test
+  @Category(NeedsRunner.class)
+  public void testInnerJoinDifferentKeysNullable2() {
+    List<Row> pc1Rows =
+        ImmutableList.of(
+            Row.withSchema(CG_SCHEMA_1).addValues("user1", 1, "us").build(),
+            Row.withSchema(CG_SCHEMA_1).addValues("user1", 2, "us").build(),
+            Row.withSchema(CG_SCHEMA_1).addValues("user1", 3, "il").build(),
+            Row.withSchema(CG_SCHEMA_1).addValues("user1", 4, "il").build(),
+            Row.withSchema(CG_SCHEMA_1).addValues("user2", 5, "fr").build(),
+            Row.withSchema(CG_SCHEMA_1).addValues("user2", 6, "fr").build(),
+            Row.withSchema(CG_SCHEMA_1).addValues("user2", 7, "ar").build(),
+            Row.withSchema(CG_SCHEMA_1).addValues("user2", 8, "ar").build(),
+            Row.withSchema(CG_SCHEMA_1).addValues("user3", 8, "ar").build());
+    List<Row> pc2Rows =
+        ImmutableList.of(
+            Row.withSchema(CG_SCHEMA_2N).addValues("user1", 9, "us").build(),
+            Row.withSchema(CG_SCHEMA_2N).addValues("user1", 10, "us").build(),
+            Row.withSchema(CG_SCHEMA_2N).addValues("user1", 11, "il").build(),
+            Row.withSchema(CG_SCHEMA_2N).addValues("user1", 12, "il").build(),
+            Row.withSchema(CG_SCHEMA_2N).addValues("user2", 13, "fr").build(),
+            Row.withSchema(CG_SCHEMA_2N).addValues("user2", 14, "fr").build(),
+            Row.withSchema(CG_SCHEMA_2N).addValues("user2", 15, "ar").build(),
+            Row.withSchema(CG_SCHEMA_2N).addValues("user2", 16, "ar").build(),
+            Row.withSchema(CG_SCHEMA_2N).addValues("user3", 17, null).build(),
+            Row.withSchema(CG_SCHEMA_2N).addValues(null, 18, "ar").build(),
+            Row.withSchema(CG_SCHEMA_2N).addValues(null, 19, null).build(),
+            Row.withSchema(CG_SCHEMA_2N).addValues("user4", 8, "ar").build());
+
+    PCollection<Row> pc1 = pipeline.apply("Create1", Create.of(pc1Rows)).setRowSchema(CG_SCHEMA_1);
+    PCollection<Row> pc2 = pipeline.apply("Create2", Create.of(pc2Rows)).setRowSchema(CG_SCHEMA_2N);
+
+    Schema expectedSchema =
+        Schema.builder()
+            .addRowField(Join.LHS_TAG, CG_SCHEMA_1)
+            .addRowField(Join.RHS_TAG, CG_SCHEMA_2N)
+            .build();
+
+    PCollection<Row> joined1 =
+        pc1.apply(
+            "innerBroadcast",
+            Join.<Row, Row>innerBroadcastJoin(pc2)
+                .on(FieldsEqual.left("user", "country").right("user2", "country2")));
+    PCollection<Row> joined2 =
+        pc1.apply(
+            "inner",
+            Join.<Row, Row>innerJoin(pc2)
+                .on(FieldsEqual.left("user", "country").right("user2", "country2")));
+
+    assertEquals(expectedSchema, joined1.getSchema());
+    assertEquals(expectedSchema, joined2.getSchema());
+
+    List<Row> expectedJoinedRows =
+        innerJoin(
+            pc1Rows,
+            pc2Rows,
+            new String[] {"user", "country"},
+            new String[] {"user2", "country2"},
+            expectedSchema);
+
+    PAssert.that(joined1).containsInAnyOrder(expectedJoinedRows);
+    PAssert.that(joined2).containsInAnyOrder(expectedJoinedRows);
+    pipeline.run();
+  }
+
   @Test
   @Category(NeedsRunner.class)
   public void testOuterJoinDifferentKeys() {
     List<Row> pc1Rows =
-        Lists.newArrayList(
+        ImmutableList.of(
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 1, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 2, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 3, "il").build(),
@@ -191,7 +262,7 @@ public class JoinTest {
             Row.withSchema(CG_SCHEMA_1).addValues("user2", 8, "ar").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user3", 8, "ar").build());
     List<Row> pc2Rows =
-        Lists.newArrayList(
+        ImmutableList.of(
             Row.withSchema(CG_SCHEMA_2).addValues("user1", 9, "us").build(),
             Row.withSchema(CG_SCHEMA_2).addValues("user1", 10, "us").build(),
             Row.withSchema(CG_SCHEMA_2).addValues("user1", 11, "il").build(),
@@ -243,7 +314,7 @@ public class JoinTest {
   @Category(NeedsRunner.class)
   public void testOuterJoinSameKeys() {
     List<Row> pc1Rows =
-        Lists.newArrayList(
+        ImmutableList.of(
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 1, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 2, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 3, "il").build(),
@@ -254,7 +325,7 @@ public class JoinTest {
             Row.withSchema(CG_SCHEMA_1).addValues("user2", 8, "ar").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user3", 8, "ar").build());
     List<Row> pc2Rows =
-        Lists.newArrayList(
+        ImmutableList.of(
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 9, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 10, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 11, "il").build(),
@@ -303,7 +374,7 @@ public class JoinTest {
   @Category(NeedsRunner.class)
   public void testLeftOuterJoinSameKeys() {
     List<Row> pc1Rows =
-        Lists.newArrayList(
+        ImmutableList.of(
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 1, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 2, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 3, "il").build(),
@@ -314,7 +385,7 @@ public class JoinTest {
             Row.withSchema(CG_SCHEMA_1).addValues("user2", 8, "ar").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user3", 8, "ar").build());
     List<Row> pc2Rows =
-        Lists.newArrayList(
+        ImmutableList.of(
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 9, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 10, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 11, "il").build(),
@@ -364,7 +435,7 @@ public class JoinTest {
   @Category(NeedsRunner.class)
   public void testRightOuterJoinSameKeys() {
     List<Row> pc1Rows =
-        Lists.newArrayList(
+        ImmutableList.of(
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 1, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 2, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 3, "il").build(),
@@ -375,7 +446,7 @@ public class JoinTest {
             Row.withSchema(CG_SCHEMA_1).addValues("user2", 8, "ar").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user3", 8, "ar").build());
     List<Row> pc2Rows =
-        Lists.newArrayList(
+        ImmutableList.of(
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 9, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 10, "us").build(),
             Row.withSchema(CG_SCHEMA_1).addValues("user1", 11, "il").build(),
