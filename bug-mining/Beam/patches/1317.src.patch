diff --git a/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkExecutionEnvironments.java b/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkExecutionEnvironments.java
index 256d3cd0c8c..e2a89009313 100644
--- a/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkExecutionEnvironments.java
+++ b/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkExecutionEnvironments.java
@@ -23,9 +23,11 @@ import java.net.URL;
 import java.util.Collections;
 import java.util.List;
 import javax.annotation.Nullable;
+import org.apache.beam.sdk.util.InstanceBuilder;
 import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.annotations.VisibleForTesting;
 import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.net.HostAndPort;
 import org.apache.flink.api.common.ExecutionConfig;
+import org.apache.flink.api.common.ExecutionMode;
 import org.apache.flink.api.common.JobExecutionResult;
 import org.apache.flink.api.java.CollectionEnvironment;
 import org.apache.flink.api.java.ExecutionEnvironment;
@@ -40,6 +42,7 @@ import org.apache.flink.configuration.JobManagerOptions;
 import org.apache.flink.configuration.RestOptions;
 import org.apache.flink.runtime.jobgraph.SavepointRestoreSettings;
 import org.apache.flink.runtime.state.StateBackend;
+import org.apache.flink.streaming.api.CheckpointingMode;
 import org.apache.flink.streaming.api.TimeCharacteristic;
 import org.apache.flink.streaming.api.environment.CheckpointConfig.ExternalizedCheckpointCleanup;
 import org.apache.flink.streaming.api.environment.RemoteStreamEnvironment;
@@ -91,8 +94,10 @@ public class FlinkExecutionEnvironments {
       LOG.info("Using Flink Master URL {}:{}.", hostAndPort.getHost(), hostAndPort.getPort());
     }
 
-    // Set the execution more for data exchange.
-    flinkBatchEnv.getConfig().setExecutionMode(options.getExecutionModeForBatch());
+    // Set the execution mode for data exchange.
+    flinkBatchEnv
+        .getConfig()
+        .setExecutionMode(ExecutionMode.valueOf(options.getExecutionModeForBatch()));
 
     // set the correct parallelism.
     if (options.getParallelism() != -1 && !(flinkBatchEnv instanceof CollectionEnvironment)) {
@@ -212,7 +217,8 @@ public class FlinkExecutionEnvironments {
       if (checkpointInterval < 1) {
         throw new IllegalArgumentException("The checkpoint interval must be positive");
       }
-      flinkStreamEnv.enableCheckpointing(checkpointInterval, options.getCheckpointingMode());
+      flinkStreamEnv.enableCheckpointing(
+          checkpointInterval, CheckpointingMode.valueOf(options.getCheckpointingMode()));
       if (options.getCheckpointTimeoutMillis() != -1) {
         flinkStreamEnv
             .getCheckpointConfig()
@@ -246,8 +252,12 @@ public class FlinkExecutionEnvironments {
     }
 
     // State backend
-    final StateBackend stateBackend = options.getStateBackend();
-    if (stateBackend != null) {
+    if (options.getStateBackendFactory() != null) {
+      final StateBackend stateBackend =
+          InstanceBuilder.ofType(FlinkStateBackendFactory.class)
+              .fromClass(options.getStateBackendFactory())
+              .build()
+              .createStateBackend(options);
       flinkStreamEnv.setStateBackend(stateBackend);
     }
 
diff --git a/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkPipelineOptions.java b/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkPipelineOptions.java
index ed346002f05..e9cb8dcc850 100644
--- a/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkPipelineOptions.java
+++ b/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkPipelineOptions.java
@@ -17,23 +17,25 @@
  */
 package org.apache.beam.runners.flink;
 
-import com.fasterxml.jackson.annotation.JsonIgnore;
 import java.util.List;
 import org.apache.beam.sdk.options.ApplicationNameOptions;
 import org.apache.beam.sdk.options.Default;
 import org.apache.beam.sdk.options.Description;
 import org.apache.beam.sdk.options.PipelineOptions;
 import org.apache.beam.sdk.options.StreamingOptions;
-import org.apache.flink.api.common.ExecutionMode;
-import org.apache.flink.runtime.state.StateBackend;
-import org.apache.flink.streaming.api.CheckpointingMode;
 
-/** Options which can be used to configure a Flink PortablePipelineRunner. */
+/**
+ * Options which can be used to configure a Flink PortablePipelineRunner.
+ *
+ * <p>Avoid using `org.apache.flink.*` members below. This allows including the flink runner without
+ * requiring flink on the classpath (e.g. to use with the direct runner).
+ */
 public interface FlinkPipelineOptions
     extends PipelineOptions, ApplicationNameOptions, StreamingOptions {
 
   String AUTO = "[auto]";
   String PIPELINED = "PIPELINED";
+  String EXACTLY_ONCE = "EXACTLY_ONCE";
 
   /**
    * List of local files to make available to workers.
@@ -90,10 +92,10 @@ public interface FlinkPipelineOptions
   void setCheckpointingInterval(Long interval);
 
   @Description("The checkpointing mode that defines consistency guarantee.")
-  @Default.Enum("EXACTLY_ONCE")
-  CheckpointingMode getCheckpointingMode();
+  @Default.String(EXACTLY_ONCE)
+  String getCheckpointingMode();
 
-  void setCheckpointingMode(CheckpointingMode mode);
+  void setCheckpointingMode(String mode);
 
   @Description(
       "The maximum time in milliseconds that a checkpoint may take before being discarded.")
@@ -145,12 +147,11 @@ public interface FlinkPipelineOptions
    * streaming mode.
    */
   @Description(
-      "Sets the state backend to use in streaming mode. "
-          + "Otherwise the default is read from the Flink config.")
-  @JsonIgnore
-  StateBackend getStateBackend();
+      "Sets the state backend factory to use in streaming mode. "
+          + "Defaults to the flink cluster's state.backend configuration.")
+  Class<? extends FlinkStateBackendFactory> getStateBackendFactory();
 
-  void setStateBackend(StateBackend stateBackend);
+  void setStateBackendFactory(Class<? extends FlinkStateBackendFactory> stateBackendFactory);
 
   @Description("Enable/disable Beam metrics in Flink Runner")
   @Default.Boolean(true)
@@ -217,10 +218,10 @@ public interface FlinkPipelineOptions
           + "Reference {@link org.apache.flink.api.common.ExecutionMode}. "
           + "Set this to BATCH_FORCED if pipelines get blocked, see "
           + "https://issues.apache.org/jira/browse/FLINK-10672")
-  @Default.Enum(PIPELINED)
-  ExecutionMode getExecutionModeForBatch();
+  @Default.String(PIPELINED)
+  String getExecutionModeForBatch();
 
-  void setExecutionModeForBatch(ExecutionMode executionMode);
+  void setExecutionModeForBatch(String executionMode);
 
   @Description(
       "Savepoint restore path. If specified, restores the streaming pipeline from the provided path.")
diff --git a/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkStateBackendFactory.java b/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkStateBackendFactory.java
new file mode 100644
index 00000000000..bb50d495568
--- /dev/null
+++ b/runners/flink/src/main/java/org/apache/beam/runners/flink/FlinkStateBackendFactory.java
@@ -0,0 +1,25 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.beam.runners.flink;
+
+import org.apache.flink.runtime.state.StateBackend;
+
+/** Constructs a StateBackend to use from flink pipeline options. */
+public interface FlinkStateBackendFactory {
+  StateBackend createStateBackend(FlinkPipelineOptions options);
+}
diff --git a/runners/flink/src/main/java/org/apache/beam/runners/flink/translation/wrappers/streaming/DoFnOperator.java b/runners/flink/src/main/java/org/apache/beam/runners/flink/translation/wrappers/streaming/DoFnOperator.java
index 24ed7423fb2..fffb0e01404 100644
--- a/runners/flink/src/main/java/org/apache/beam/runners/flink/translation/wrappers/streaming/DoFnOperator.java
+++ b/runners/flink/src/main/java/org/apache/beam/runners/flink/translation/wrappers/streaming/DoFnOperator.java
@@ -254,7 +254,8 @@ public class DoFnOperator<InputT, OutputT> extends AbstractStreamOperator<Window
 
     if (requiresStableInput) {
       Preconditions.checkState(
-          flinkOptions.getCheckpointingMode() == CheckpointingMode.EXACTLY_ONCE,
+          CheckpointingMode.valueOf(flinkOptions.getCheckpointingMode())
+              == CheckpointingMode.EXACTLY_ONCE,
           "Checkpointing mode is not set to exactly once but @RequiresStableInput is used.");
       Preconditions.checkState(
           flinkOptions.getCheckpointingInterval() > 0,
diff --git a/runners/flink/src/test/java/org/apache/beam/runners/flink/FlinkPipelineOptionsTest.java b/runners/flink/src/test/java/org/apache/beam/runners/flink/FlinkPipelineOptionsTest.java
index d11d7ef171e..4daf6c7ebf3 100644
--- a/runners/flink/src/test/java/org/apache/beam/runners/flink/FlinkPipelineOptionsTest.java
+++ b/runners/flink/src/test/java/org/apache/beam/runners/flink/FlinkPipelineOptionsTest.java
@@ -77,7 +77,7 @@ public class FlinkPipelineOptionsTest {
     assertThat(options.getLatencyTrackingInterval(), is(0L));
     assertThat(options.isShutdownSourcesOnFinalWatermark(), is(false));
     assertThat(options.getObjectReuse(), is(false));
-    assertThat(options.getCheckpointingMode(), is(CheckpointingMode.EXACTLY_ONCE));
+    assertThat(options.getCheckpointingMode(), is(CheckpointingMode.EXACTLY_ONCE.name()));
     assertThat(options.getMinPauseBetweenCheckpoints(), is(-1L));
     assertThat(options.getCheckpointingInterval(), is(-1L));
     assertThat(options.getCheckpointTimeoutMillis(), is(-1L));
@@ -85,10 +85,10 @@ public class FlinkPipelineOptionsTest {
     assertThat(options.getNumberOfExecutionRetries(), is(-1));
     assertThat(options.getExecutionRetryDelay(), is(-1L));
     assertThat(options.getRetainExternalizedCheckpointsOnCancellation(), is(false));
-    assertThat(options.getStateBackend(), is(nullValue()));
+    assertThat(options.getStateBackendFactory(), is(nullValue()));
     assertThat(options.getMaxBundleSize(), is(1000L));
     assertThat(options.getMaxBundleTimeMills(), is(1000L));
-    assertThat(options.getExecutionModeForBatch(), is(ExecutionMode.PIPELINED));
+    assertThat(options.getExecutionModeForBatch(), is(ExecutionMode.PIPELINED.name()));
     assertThat(options.getSavepointPath(), is(nullValue()));
     assertThat(options.getAllowNonRestoredState(), is(false));
   }
