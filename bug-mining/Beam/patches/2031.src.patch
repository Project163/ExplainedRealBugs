diff --git a/sdks/python/apache_beam/typehints/decorators_test.py b/sdks/python/apache_beam/typehints/decorators_test.py
index 8fa5ba03367..85ca94f63e9 100644
--- a/sdks/python/apache_beam/typehints/decorators_test.py
+++ b/sdks/python/apache_beam/typehints/decorators_test.py
@@ -112,7 +112,8 @@ class IOTypeHintsTest(unittest.TestCase):
 
     self._test_strip_iterable_fail(typehints.Union[str, int])
     self._test_strip_iterable_fail(typehints.Optional[str])
-    self._test_strip_iterable_fail(typehints.WindowedValue[str])  # type: ignore[misc]
+    self._test_strip_iterable_fail(
+        typehints.WindowedValue[str])  # type: ignore[misc]
     self._test_strip_iterable_fail(typehints.Dict[str, int])
 
   def test_make_traceback(self):
diff --git a/sdks/python/apache_beam/typehints/opcodes.py b/sdks/python/apache_beam/typehints/opcodes.py
index 2f638c17651..17c62a5184b 100644
--- a/sdks/python/apache_beam/typehints/opcodes.py
+++ b/sdks/python/apache_beam/typehints/opcodes.py
@@ -264,8 +264,28 @@ def build_list(state, arg):
 
 
 # A Dict[Union[], Union[]] is the type of an empty dict.
-def build_map(state, unused_arg):
-  state.stack.append(Dict[Union[()], Union[()]])
+def build_map(state, arg):
+  if sys.version_info <= (2, ) or arg == 0:
+    state.stack.append(Dict[Union[()], Union[()]])
+  else:
+    state.stack[-arg:] = [
+        Dict[reduce(union, state.stack[-2 * arg::2], Union[()]),
+             reduce(union, state.stack[-2 * arg + 1::2], Union[()])]
+    ]
+
+
+def build_const_key_map(state, arg):
+  key_tuple = state.stack.pop()
+  if isinstance(key_tuple, typehints.TupleHint.TupleConstraint):
+    key_types = key_tuple.tuple_types
+  elif isinstance(key_tuple, Const):
+    key_types = [Const(v) for v in key_tuple.value]
+  else:
+    key_types = [Any]
+  state.stack[-arg:] = [
+      Dict[reduce(union, key_types, Union[()]),
+           reduce(union, state.stack[-arg:], Union[()])]
+  ]
 
 
 def load_attr(state, arg):
diff --git a/sdks/python/apache_beam/typehints/trivial_inference_test.py b/sdks/python/apache_beam/typehints/trivial_inference_test.py
index 983fa859949..f6ec0941b1f 100644
--- a/sdks/python/apache_beam/typehints/trivial_inference_test.py
+++ b/sdks/python/apache_beam/typehints/trivial_inference_test.py
@@ -104,6 +104,30 @@ class TrivialInferenceTest(unittest.TestCase):
     self.assertReturnType(
         any_tuple, reverse, [trivial_inference.Const((1, 2, 3))])
 
+  def testBuildMap(self):
+    self.assertReturnType(
+        typehints.Dict[typehints.Any, typehints.Any],
+        lambda k,
+        v: {}, [int, float])
+    self.assertReturnType(
+        typehints.Dict[int, float], lambda k, v: {k: v}, [int, float])
+    self.assertReturnType(
+        typehints.Dict[int, typehints.Union[float, str]],
+        lambda k1,
+        v1,
+        k2,
+        v2: {
+            k1: v1, k2: v2
+        }, [int, float, int, str])
+
+    # Constant map.
+    self.assertReturnType(
+        typehints.Dict[str, typehints.Union[int, float]],
+        lambda a,
+        b: {
+            'a': a, 'b': b
+        }, [int, float])
+
   def testNoneReturn(self):
     def func(a):
       if a == 5:
