diff --git a/runners/direct-java/src/main/java/org/apache/beam/runners/direct/portable/ReferenceRunner.java b/runners/direct-java/src/main/java/org/apache/beam/runners/direct/portable/ReferenceRunner.java
index 498b50374af..40155312646 100644
--- a/runners/direct-java/src/main/java/org/apache/beam/runners/direct/portable/ReferenceRunner.java
+++ b/runners/direct-java/src/main/java/org/apache/beam/runners/direct/portable/ReferenceRunner.java
@@ -73,6 +73,7 @@ import org.apache.beam.runners.fnexecution.logging.Slf4jLogWriter;
 import org.apache.beam.runners.fnexecution.provisioning.StaticGrpcProvisionService;
 import org.apache.beam.runners.fnexecution.state.GrpcStateService;
 import org.apache.beam.sdk.fn.IdGenerators;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.apache.beam.sdk.options.PipelineOptionsFactory;
 import org.joda.time.Duration;
 import org.joda.time.Instant;
@@ -167,7 +168,8 @@ public class ReferenceRunner {
                 serverFactory);
         GrpcFnServer<GrpcDataService> data =
             GrpcFnServer.allocatePortAndCreateFor(
-                GrpcDataService.create(dataExecutor), serverFactory);
+                GrpcDataService.create(dataExecutor, OutboundObserverFactory.serverDirect()),
+                serverFactory);
         GrpcFnServer<GrpcStateService> state =
             GrpcFnServer.allocatePortAndCreateFor(GrpcStateService.create(), serverFactory)) {
 
diff --git a/runners/direct-java/src/main/java/org/apache/beam/runners/direct/portable/RemoteStageEvaluatorFactory.java b/runners/direct-java/src/main/java/org/apache/beam/runners/direct/portable/RemoteStageEvaluatorFactory.java
index c990dd458e3..ca20949c953 100644
--- a/runners/direct-java/src/main/java/org/apache/beam/runners/direct/portable/RemoteStageEvaluatorFactory.java
+++ b/runners/direct-java/src/main/java/org/apache/beam/runners/direct/portable/RemoteStageEvaluatorFactory.java
@@ -21,7 +21,6 @@ package org.apache.beam.runners.direct.portable;
 import java.util.ArrayList;
 import java.util.Collection;
 import javax.annotation.Nullable;
-import org.apache.beam.model.fnexecution.v1.BeamFnApi.ProcessBundleResponse;
 import org.apache.beam.model.pipeline.v1.RunnerApi.ExecutableStagePayload;
 import org.apache.beam.runners.core.construction.graph.ExecutableStage;
 import org.apache.beam.runners.core.construction.graph.PipelineNode.PTransformNode;
diff --git a/runners/direct-java/src/test/java/org/apache/beam/runners/direct/portable/ReferenceRunnerTest.java b/runners/direct-java/src/test/java/org/apache/beam/runners/direct/portable/ReferenceRunnerTest.java
index ae8d0f6aef3..2599a899183 100644
--- a/runners/direct-java/src/test/java/org/apache/beam/runners/direct/portable/ReferenceRunnerTest.java
+++ b/runners/direct-java/src/test/java/org/apache/beam/runners/direct/portable/ReferenceRunnerTest.java
@@ -18,7 +18,12 @@
 
 package org.apache.beam.runners.direct.portable;
 
+import static org.hamcrest.Matchers.containsInAnyOrder;
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertThat;
+
 import com.google.common.collect.ImmutableSet;
+import com.google.common.collect.Iterables;
 import java.io.Serializable;
 import java.util.Collections;
 import java.util.Set;
@@ -30,11 +35,9 @@ import org.apache.beam.sdk.options.PipelineOptionsFactory;
 import org.apache.beam.sdk.testing.PAssert;
 import org.apache.beam.sdk.transforms.Create;
 import org.apache.beam.sdk.transforms.DoFn;
-import org.apache.beam.sdk.transforms.Flatten;
 import org.apache.beam.sdk.transforms.GroupByKey;
 import org.apache.beam.sdk.transforms.ParDo;
 import org.apache.beam.sdk.transforms.Reshuffle;
-import org.apache.beam.sdk.transforms.Values;
 import org.apache.beam.sdk.transforms.windowing.FixedWindows;
 import org.apache.beam.sdk.transforms.windowing.Window;
 import org.apache.beam.sdk.values.KV;
@@ -116,10 +119,14 @@ public class ReferenceRunnerTest implements Serializable {
                 // Multiple bundles will emit values onto the same key 42.
                 // They must be processed sequentially rather than in parallel, since
                 // the trigger firing code expects to receive values sequentially for a key.
-                .apply(GroupByKey.create())
-                .apply(Values.create())
-                .apply(Flatten.iterables()))
-        .containsInAnyOrder(0, 1, 2);
+                .apply(GroupByKey.create()))
+        .satisfies(
+            input -> {
+              KV<Integer, Iterable<Integer>> kv = Iterables.getOnlyElement(input);
+              assertEquals(42, kv.getKey().intValue());
+              assertThat(kv.getValue(), containsInAnyOrder(0, 1, 2));
+              return null;
+            });
 
     p.replaceAll(Collections.singletonList(JavaReadViaImpulse.boundedOverride()));
 
diff --git a/runners/direct-java/src/test/java/org/apache/beam/runners/direct/portable/RemoteStageEvaluatorFactoryTest.java b/runners/direct-java/src/test/java/org/apache/beam/runners/direct/portable/RemoteStageEvaluatorFactoryTest.java
index 2a96a849ca6..01422901969 100644
--- a/runners/direct-java/src/test/java/org/apache/beam/runners/direct/portable/RemoteStageEvaluatorFactoryTest.java
+++ b/runners/direct-java/src/test/java/org/apache/beam/runners/direct/portable/RemoteStageEvaluatorFactoryTest.java
@@ -51,6 +51,7 @@ import org.apache.beam.runners.fnexecution.logging.GrpcLoggingService;
 import org.apache.beam.runners.fnexecution.logging.Slf4jLogWriter;
 import org.apache.beam.runners.fnexecution.state.GrpcStateService;
 import org.apache.beam.sdk.Pipeline;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.apache.beam.sdk.options.PipelineOptionsFactory;
 import org.apache.beam.sdk.transforms.DoFn;
 import org.apache.beam.sdk.transforms.Flatten;
@@ -103,7 +104,9 @@ public class RemoteStageEvaluatorFactoryTest implements Serializable {
             (workerId, timeout) -> clientPool.take());
     executor = Executors.newCachedThreadPool();
     dataServer =
-        GrpcFnServer.allocatePortAndCreateFor(GrpcDataService.create(executor), serverFactory);
+        GrpcFnServer.allocatePortAndCreateFor(
+            GrpcDataService.create(executor, OutboundObserverFactory.serverDirect()),
+            serverFactory);
     stateServer = GrpcFnServer.allocatePortAndCreateFor(GrpcStateService.create(), serverFactory);
 
     bundleFactory = ImmutableListBundleFactory.create();
diff --git a/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/control/DockerJobBundleFactory.java b/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/control/DockerJobBundleFactory.java
index 32f66fb73fd..e3cb9c1bbc6 100644
--- a/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/control/DockerJobBundleFactory.java
+++ b/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/control/DockerJobBundleFactory.java
@@ -55,6 +55,7 @@ import org.apache.beam.sdk.coders.Coder;
 import org.apache.beam.sdk.fn.IdGenerator;
 import org.apache.beam.sdk.fn.IdGenerators;
 import org.apache.beam.sdk.fn.data.FnDataReceiver;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.apache.beam.sdk.util.WindowedValue;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
@@ -301,7 +302,9 @@ public class DockerJobBundleFactory implements JobBundleFactory {
         RemoteEnvironment environment, ServerFactory serverFactory) throws Exception {
       ExecutorService executor = Executors.newCachedThreadPool();
       GrpcFnServer<GrpcDataService> dataServer =
-          GrpcFnServer.allocatePortAndCreateFor(GrpcDataService.create(executor), serverFactory);
+          GrpcFnServer.allocatePortAndCreateFor(
+              GrpcDataService.create(executor, OutboundObserverFactory.serverDirect()),
+              serverFactory);
       GrpcFnServer<GrpcStateService> stateServer =
           GrpcFnServer.allocatePortAndCreateFor(GrpcStateService.create(), serverFactory);
       SdkHarnessClient client =
diff --git a/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/data/GrpcDataService.java b/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/data/GrpcDataService.java
index a13d3d7d38c..4b9feddc5af 100644
--- a/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/data/GrpcDataService.java
+++ b/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/data/GrpcDataService.java
@@ -37,6 +37,7 @@ import org.apache.beam.sdk.fn.data.CloseableFnDataReceiver;
 import org.apache.beam.sdk.fn.data.FnDataReceiver;
 import org.apache.beam.sdk.fn.data.InboundDataClient;
 import org.apache.beam.sdk.fn.data.LogicalEndpoint;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.apache.beam.sdk.util.WindowedValue;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
@@ -53,8 +54,9 @@ public class GrpcDataService extends BeamFnDataGrpc.BeamFnDataImplBase
     implements FnService, FnDataService {
   private static final Logger LOG = LoggerFactory.getLogger(GrpcDataService.class);
 
-  public static GrpcDataService create(ExecutorService executor) {
-    return new GrpcDataService(executor);
+  public static GrpcDataService create(
+      ExecutorService executor, OutboundObserverFactory outboundObserverFactory) {
+    return new GrpcDataService(executor, outboundObserverFactory);
   }
 
   private final SettableFuture<BeamFnDataGrpcMultiplexer> connectedClient;
@@ -68,11 +70,14 @@ public class GrpcDataService extends BeamFnDataGrpc.BeamFnDataImplBase
   private final Queue<BeamFnDataGrpcMultiplexer> additionalMultiplexers;
 
   private final ExecutorService executor;
+  private final OutboundObserverFactory outboundObserverFactory;
 
-  private GrpcDataService(ExecutorService executor) {
+  private GrpcDataService(
+      ExecutorService executor, OutboundObserverFactory outboundObserverFactory) {
     this.connectedClient = SettableFuture.create();
     this.additionalMultiplexers = new LinkedBlockingQueue<>();
     this.executor = executor;
+    this.outboundObserverFactory = outboundObserverFactory;
   }
 
   @Override
@@ -80,7 +85,8 @@ public class GrpcDataService extends BeamFnDataGrpc.BeamFnDataImplBase
       final StreamObserver<BeamFnApi.Elements> outboundElementObserver) {
     LOG.info("Beam Fn Data client connected.");
     BeamFnDataGrpcMultiplexer multiplexer =
-        new BeamFnDataGrpcMultiplexer(null, inboundObserver -> outboundElementObserver);
+        new BeamFnDataGrpcMultiplexer(
+            null, outboundObserverFactory, inbound -> outboundElementObserver);
     // First client that connects completes this future.
     if (!connectedClient.set(multiplexer)) {
       additionalMultiplexers.offer(multiplexer);
diff --git a/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/environment/InProcessEnvironmentFactory.java b/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/environment/InProcessEnvironmentFactory.java
index 03a3b550eea..185d7c20ae4 100644
--- a/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/environment/InProcessEnvironmentFactory.java
+++ b/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/environment/InProcessEnvironmentFactory.java
@@ -33,7 +33,7 @@ import org.apache.beam.runners.fnexecution.control.ControlClientPool.Source;
 import org.apache.beam.runners.fnexecution.control.FnApiControlClientPoolService;
 import org.apache.beam.runners.fnexecution.control.InstructionRequestHandler;
 import org.apache.beam.runners.fnexecution.logging.GrpcLoggingService;
-import org.apache.beam.sdk.fn.stream.StreamObserverFactory;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.apache.beam.sdk.fn.test.InProcessManagedChannelFactory;
 import org.apache.beam.sdk.options.PipelineOptions;
 import org.slf4j.Logger;
@@ -92,7 +92,7 @@ public class InProcessEnvironmentFactory implements EnvironmentFactory {
                     loggingServer.getApiServiceDescriptor(),
                     controlServer.getApiServiceDescriptor(),
                     InProcessManagedChannelFactory.create(),
-                    StreamObserverFactory.direct());
+                    OutboundObserverFactory.clientDirect());
               } catch (NoClassDefFoundError e) {
                 // TODO: https://issues.apache.org/jira/browse/BEAM-4384 load the FnHarness in a
                 // Restricted classpath that we control for any user.
diff --git a/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/InProcessSdkHarness.java b/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/InProcessSdkHarness.java
index 9be07fe8e3b..572a511036b 100644
--- a/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/InProcessSdkHarness.java
+++ b/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/InProcessSdkHarness.java
@@ -33,6 +33,7 @@ import org.apache.beam.runners.fnexecution.data.GrpcDataService;
 import org.apache.beam.runners.fnexecution.environment.InProcessEnvironmentFactory;
 import org.apache.beam.runners.fnexecution.logging.GrpcLoggingService;
 import org.apache.beam.runners.fnexecution.logging.Slf4jLogWriter;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.apache.beam.sdk.options.PipelineOptionsFactory;
 import org.junit.rules.ExternalResource;
 import org.junit.rules.TestRule;
@@ -78,7 +79,9 @@ public class InProcessSdkHarness extends ExternalResource implements TestRule {
         GrpcFnServer.allocatePortAndCreateFor(
             GrpcLoggingService.forWriter(Slf4jLogWriter.getDefault()), serverFactory);
     dataServer =
-        GrpcFnServer.allocatePortAndCreateFor(GrpcDataService.create(executor), serverFactory);
+        GrpcFnServer.allocatePortAndCreateFor(
+            GrpcDataService.create(executor, OutboundObserverFactory.serverDirect()),
+            serverFactory);
     controlServer = GrpcFnServer.allocatePortAndCreateFor(clientPoolService, serverFactory);
 
     InstructionRequestHandler requestHandler =
diff --git a/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/control/RemoteExecutionTest.java b/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/control/RemoteExecutionTest.java
index 241324a3873..0d9c3b21323 100644
--- a/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/control/RemoteExecutionTest.java
+++ b/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/control/RemoteExecutionTest.java
@@ -67,7 +67,7 @@ import org.apache.beam.sdk.coders.CoderException;
 import org.apache.beam.sdk.coders.KvCoder;
 import org.apache.beam.sdk.coders.StringUtf8Coder;
 import org.apache.beam.sdk.fn.data.FnDataReceiver;
-import org.apache.beam.sdk.fn.stream.StreamObserverFactory;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.apache.beam.sdk.fn.test.InProcessManagedChannelFactory;
 import org.apache.beam.sdk.options.PipelineOptionsFactory;
 import org.apache.beam.sdk.transforms.DoFn;
@@ -112,7 +112,8 @@ public class RemoteExecutionTest implements Serializable {
     InProcessServerFactory serverFactory = InProcessServerFactory.create();
     dataServer =
         GrpcFnServer.allocatePortAndCreateFor(
-            GrpcDataService.create(serverExecutor), serverFactory);
+            GrpcDataService.create(serverExecutor, OutboundObserverFactory.serverDirect()),
+            serverFactory);
     loggingServer =
         GrpcFnServer.allocatePortAndCreateFor(
             GrpcLoggingService.forWriter(Slf4jLogWriter.getDefault()), serverFactory);
@@ -135,7 +136,7 @@ public class RemoteExecutionTest implements Serializable {
                 loggingServer.getApiServiceDescriptor(),
                 controlServer.getApiServiceDescriptor(),
                 InProcessManagedChannelFactory.create(),
-                StreamObserverFactory.direct()));
+                OutboundObserverFactory.clientDirect()));
     // TODO: https://issues.apache.org/jira/browse/BEAM-4149 Use proper worker id.
     InstructionRequestHandler controlClient =
         clientPool.getSource().take("", Duration.ofSeconds(2));
diff --git a/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/control/SingleEnvironmentInstanceJobBundleFactoryTest.java b/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/control/SingleEnvironmentInstanceJobBundleFactoryTest.java
index 760154c9d40..24cc8499de4 100644
--- a/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/control/SingleEnvironmentInstanceJobBundleFactoryTest.java
+++ b/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/control/SingleEnvironmentInstanceJobBundleFactoryTest.java
@@ -47,6 +47,7 @@ import org.apache.beam.runners.fnexecution.environment.EnvironmentFactory;
 import org.apache.beam.runners.fnexecution.environment.RemoteEnvironment;
 import org.apache.beam.runners.fnexecution.state.GrpcStateService;
 import org.apache.beam.sdk.Pipeline;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.apache.beam.sdk.transforms.Create;
 import org.junit.After;
 import org.junit.Before;
@@ -76,7 +77,9 @@ public class SingleEnvironmentInstanceJobBundleFactoryTest {
 
     InProcessServerFactory serverFactory = InProcessServerFactory.create();
     dataServer =
-        GrpcFnServer.allocatePortAndCreateFor(GrpcDataService.create(executor), serverFactory);
+        GrpcFnServer.allocatePortAndCreateFor(
+            GrpcDataService.create(executor, OutboundObserverFactory.serverDirect()),
+            serverFactory);
     stateServer = GrpcFnServer.allocatePortAndCreateFor(GrpcStateService.create(), serverFactory);
 
     factory =
diff --git a/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/data/GrpcDataServiceTest.java b/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/data/GrpcDataServiceTest.java
index 56ba5dcf641..bad102e1701 100644
--- a/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/data/GrpcDataServiceTest.java
+++ b/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/data/GrpcDataServiceTest.java
@@ -48,9 +48,9 @@ import org.apache.beam.sdk.coders.StringUtf8Coder;
 import org.apache.beam.sdk.fn.data.CloseableFnDataReceiver;
 import org.apache.beam.sdk.fn.data.InboundDataClient;
 import org.apache.beam.sdk.fn.data.LogicalEndpoint;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.apache.beam.sdk.fn.test.TestStreams;
 import org.apache.beam.sdk.util.WindowedValue;
-import org.junit.Ignore;
 import org.junit.Test;
 import org.junit.runner.RunWith;
 import org.junit.runners.JUnit4;
@@ -63,14 +63,14 @@ public class GrpcDataServiceTest {
   private static final Coder<WindowedValue<String>> CODER =
       LengthPrefixCoder.of(WindowedValue.getValueOnlyCoder(StringUtf8Coder.of()));
 
-  @Ignore("https://issues.apache.org/jira/browse/BEAM-4281")
   @Test
-  public void testMessageReceivedBySingleClientWhenThereAreMultipleClients()
-      throws Exception {
+  public void testMessageReceivedBySingleClientWhenThereAreMultipleClients() throws Exception {
     final LinkedBlockingQueue<Elements> clientInboundElements = new LinkedBlockingQueue<>();
     ExecutorService executorService = Executors.newCachedThreadPool();
     final CountDownLatch waitForInboundElements = new CountDownLatch(1);
-    GrpcDataService service = GrpcDataService.create(Executors.newCachedThreadPool());
+    GrpcDataService service =
+        GrpcDataService.create(
+            Executors.newCachedThreadPool(), OutboundObserverFactory.serverDirect());
     try (GrpcFnServer<GrpcDataService> server =
         GrpcFnServer.allocatePortAndCreateFor(service, InProcessServerFactory.create())) {
       Collection<Future<Void>> clientFutures = new ArrayList<>();
@@ -103,7 +103,8 @@ public class GrpcDataServiceTest {
       for (Future<Void> clientFuture : clientFutures) {
         clientFuture.get();
       }
-      assertThat(clientInboundElements,
+      assertThat(
+          clientInboundElements,
           containsInAnyOrder(elementsWithData("0"), elementsWithData("1"), elementsWithData("2")));
     }
   }
@@ -114,7 +115,9 @@ public class GrpcDataServiceTest {
         new LinkedBlockingQueue<>();
     ExecutorService executorService = Executors.newCachedThreadPool();
     final CountDownLatch waitForInboundElements = new CountDownLatch(1);
-    GrpcDataService service = GrpcDataService.create(Executors.newCachedThreadPool());
+    GrpcDataService service =
+        GrpcDataService.create(
+            Executors.newCachedThreadPool(), OutboundObserverFactory.serverDirect());
     try (GrpcFnServer<GrpcDataService> server =
         GrpcFnServer.allocatePortAndCreateFor(service, InProcessServerFactory.create())) {
       Collection<Future<Void>> clientFutures = new ArrayList<>();
diff --git a/sdks/java/fn-execution/src/main/java/org/apache/beam/sdk/fn/data/BeamFnDataGrpcMultiplexer.java b/sdks/java/fn-execution/src/main/java/org/apache/beam/sdk/fn/data/BeamFnDataGrpcMultiplexer.java
index 5b97d3bc8e8..60d4616dbb6 100644
--- a/sdks/java/fn-execution/src/main/java/org/apache/beam/sdk/fn/data/BeamFnDataGrpcMultiplexer.java
+++ b/sdks/java/fn-execution/src/main/java/org/apache/beam/sdk/fn/data/BeamFnDataGrpcMultiplexer.java
@@ -29,9 +29,10 @@ import java.util.concurrent.ExecutionException;
 import java.util.function.Consumer;
 import javax.annotation.Nullable;
 import org.apache.beam.model.fnexecution.v1.BeamFnApi;
+import org.apache.beam.model.fnexecution.v1.BeamFnApi.Elements;
 import org.apache.beam.model.fnexecution.v1.BeamFnApi.Elements.Data;
 import org.apache.beam.model.pipeline.v1.Endpoints;
-import org.apache.beam.sdk.fn.stream.StreamObserverFactory.StreamObserverClientFactory;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
@@ -59,11 +60,13 @@ public class BeamFnDataGrpcMultiplexer implements AutoCloseable {
 
   public BeamFnDataGrpcMultiplexer(
       @Nullable Endpoints.ApiServiceDescriptor apiServiceDescriptor,
-      StreamObserverClientFactory<BeamFnApi.Elements, BeamFnApi.Elements> outboundObserverFactory) {
+      OutboundObserverFactory outboundObserverFactory,
+      OutboundObserverFactory.BasicFactory<Elements, Elements> baseOutboundObserverFactory) {
     this.apiServiceDescriptor = apiServiceDescriptor;
     this.consumers = new ConcurrentHashMap<>();
     this.inboundObserver = new InboundObserver();
-    this.outboundObserver = outboundObserverFactory.outboundObserverFor(inboundObserver);
+    this.outboundObserver =
+        outboundObserverFactory.outboundObserverFor(baseOutboundObserverFactory, inboundObserver);
   }
 
   @Override
diff --git a/sdks/java/fn-execution/src/main/java/org/apache/beam/sdk/fn/stream/OutboundObserverFactory.java b/sdks/java/fn-execution/src/main/java/org/apache/beam/sdk/fn/stream/OutboundObserverFactory.java
new file mode 100644
index 00000000000..44874491891
--- /dev/null
+++ b/sdks/java/fn-execution/src/main/java/org/apache/beam/sdk/fn/stream/OutboundObserverFactory.java
@@ -0,0 +1,146 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.beam.sdk.fn.stream;
+
+import io.grpc.stub.CallStreamObserver;
+import io.grpc.stub.StreamObserver;
+import java.util.concurrent.ExecutorService;
+
+/**
+ * Creates factories which determine an underlying {@link StreamObserver} implementation to use in
+ * to interact with fn execution APIs.
+ */
+public abstract class OutboundObserverFactory {
+  /**
+   * Create a buffering {@link OutboundObserverFactory} for client-side RPCs with the specified
+   * {@link ExecutorService} and the default buffer size.
+   */
+  public static OutboundObserverFactory clientBuffered(ExecutorService executorService) {
+    return new Buffered(executorService, Buffered.DEFAULT_BUFFER_SIZE);
+  }
+
+  /**
+   * Create a buffering {@link OutboundObserverFactory} for client-side RPCs with the specified
+   * {@link ExecutorService} and buffer size.
+   */
+  public static OutboundObserverFactory clientBuffered(
+      ExecutorService executorService, int bufferSize) {
+    return new Buffered(executorService, bufferSize);
+  }
+
+  /**
+   * Create the default {@link OutboundObserverFactory} for client-side RPCs, which uses basic
+   * unbuffered flow control and adds synchronization to provide thread safety of access to the
+   * returned observer.
+   */
+  public static OutboundObserverFactory clientDirect() {
+    return new DirectClient();
+  }
+
+  /** Like {@link #clientDirect} but for server-side RPCs. */
+  public static OutboundObserverFactory serverDirect() {
+    return new DirectServer();
+  }
+
+  /**
+   * Creates an {@link OutboundObserverFactory} that simply delegates to the base factory, with no
+   * flow control or synchronization. Not recommended for use except in tests.
+   */
+  public static OutboundObserverFactory trivial() {
+    return new Trivial();
+  }
+
+  /** Creates an outbound observer for the given inbound observer. */
+  @FunctionalInterface
+  public interface BasicFactory<ReqT, RespT> {
+    StreamObserver<RespT> outboundObserverFor(StreamObserver<ReqT> inboundObserver);
+  }
+
+  /**
+   * Creates an outbound observer for the given inbound observer by potentially inserting hooks into
+   * the inbound and outbound observers.
+   *
+   * @param baseOutboundObserverFactory A base function to create an outbound observer from an
+   *     inbound observer.
+   * @param inboundObserver The inbound observer.
+   */
+  public abstract <ReqT, RespT> StreamObserver<RespT> outboundObserverFor(
+      BasicFactory<ReqT, RespT> baseOutboundObserverFactory,
+      StreamObserver<ReqT> inboundObserver);
+
+  private static class DirectClient extends OutboundObserverFactory {
+    @Override
+    public <ReqT, RespT> StreamObserver<RespT> outboundObserverFor(
+        BasicFactory<ReqT, RespT> baseOutboundObserverFactory,
+        StreamObserver<ReqT> inboundObserver) {
+      AdvancingPhaser phaser = new AdvancingPhaser(1);
+      inboundObserver = ForwardingClientResponseObserver.create(inboundObserver, phaser::arrive);
+      CallStreamObserver<RespT> outboundObserver =
+          (CallStreamObserver<RespT>)
+              baseOutboundObserverFactory.outboundObserverFor(inboundObserver);
+      return new DirectStreamObserver<>(phaser, outboundObserver);
+    }
+  }
+
+  private static class DirectServer extends OutboundObserverFactory {
+    @Override
+    public <ReqT, RespT> StreamObserver<RespT> outboundObserverFor(
+        BasicFactory<ReqT, RespT> baseOutboundObserverFactory,
+        StreamObserver<ReqT> inboundObserver) {
+      AdvancingPhaser phaser = new AdvancingPhaser(1);
+      CallStreamObserver<RespT> outboundObserver =
+          (CallStreamObserver<RespT>)
+              baseOutboundObserverFactory.outboundObserverFor(inboundObserver);
+      outboundObserver.setOnReadyHandler(phaser::arrive);
+      return new DirectStreamObserver<>(phaser, outboundObserver);
+    }
+  }
+
+  private static class Buffered extends OutboundObserverFactory {
+    private static final int DEFAULT_BUFFER_SIZE = 64;
+    private final ExecutorService executorService;
+    private final int bufferSize;
+
+    private Buffered(ExecutorService executorService, int bufferSize) {
+      this.executorService = executorService;
+      this.bufferSize = bufferSize;
+    }
+
+    @Override
+    public <ReqT, RespT> StreamObserver<RespT> outboundObserverFor(
+        BasicFactory<ReqT, RespT> baseOutboundObserverFactory,
+        StreamObserver<ReqT> inboundObserver) {
+      AdvancingPhaser phaser = new AdvancingPhaser(1);
+      inboundObserver = ForwardingClientResponseObserver.create(inboundObserver, phaser::arrive);
+      CallStreamObserver<RespT> outboundObserver =
+          (CallStreamObserver<RespT>)
+              baseOutboundObserverFactory.outboundObserverFor(inboundObserver);
+      return new BufferingStreamObserver<>(phaser, outboundObserver, executorService, bufferSize);
+    }
+  }
+
+  private static class Trivial extends OutboundObserverFactory {
+    @Override
+    public <ReqT, RespT> StreamObserver<RespT> outboundObserverFor(
+        BasicFactory<ReqT, RespT> baseOutboundObserverFactory,
+        StreamObserver<ReqT> inboundObserver) {
+      return baseOutboundObserverFactory.outboundObserverFor(inboundObserver);
+    }
+  }
+}
diff --git a/sdks/java/fn-execution/src/main/java/org/apache/beam/sdk/fn/stream/StreamObserverFactory.java b/sdks/java/fn-execution/src/main/java/org/apache/beam/sdk/fn/stream/StreamObserverFactory.java
deleted file mode 100644
index abba070ae14..00000000000
--- a/sdks/java/fn-execution/src/main/java/org/apache/beam/sdk/fn/stream/StreamObserverFactory.java
+++ /dev/null
@@ -1,115 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one
- * or more contributor license agreements.  See the NOTICE file
- * distributed with this work for additional information
- * regarding copyright ownership.  The ASF licenses this file
- * to you under the Apache License, Version 2.0 (the
- * "License"); you may not use this file except in compliance
- * with the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.beam.sdk.fn.stream;
-
-import io.grpc.stub.CallStreamObserver;
-import io.grpc.stub.StreamObserver;
-import java.util.concurrent.ExecutorService;
-
-/**
- * Creates factories which determine an underlying {@link StreamObserver} implementation
- * to use in to interact with fn execution APIs.
- */
-public abstract class StreamObserverFactory {
-  /**
-   * Create a buffering {@link StreamObserverFactory} with the specified {@link ExecutorService} and
-   * the default buffer size.
-   */
-  public static StreamObserverFactory buffered(ExecutorService executorService) {
-    return new Buffered(executorService, Buffered.DEFAULT_BUFFER_SIZE);
-  }
-
-  /**
-   * Create a buffering {@link StreamObserverFactory} with the specified {@link ExecutorService} and
-   * buffer size.
-   */
-  public static StreamObserverFactory buffered(
-      ExecutorService executorService, int bufferSize) {
-    return new Buffered(executorService, bufferSize);
-  }
-
-  /**
-   * Create the default {@link StreamObserverFactory}.
-   */
-  public static StreamObserverFactory direct() {
-    return new Direct();
-  }
-
-  public abstract <ReqT, RespT> StreamObserver<RespT> from(
-      StreamObserverClientFactory<ReqT, RespT> clientFactory,
-      StreamObserver<ReqT> responseObserver);
-
-  private static class Direct extends StreamObserverFactory {
-
-    @Override
-    public <ReqT, RespT> StreamObserver<RespT> from(
-        StreamObserverClientFactory<ReqT, RespT> clientFactory,
-        StreamObserver<ReqT> inboundObserver) {
-      AdvancingPhaser phaser = new AdvancingPhaser(1);
-      CallStreamObserver<RespT> outboundObserver =
-          (CallStreamObserver<RespT>)
-              clientFactory.outboundObserverFor(
-                  ForwardingClientResponseObserver.<ReqT, RespT>create(
-                      inboundObserver, StreamObserverFactory.arriveAtPhaserHandler(phaser)));
-      return new DirectStreamObserver<>(phaser, outboundObserver);
-    }
-  }
-
-  private static class Buffered extends StreamObserverFactory {
-    private static final int DEFAULT_BUFFER_SIZE = 64;
-    private final ExecutorService executorService;
-    private final int bufferSize;
-
-    private Buffered(ExecutorService executorService, int bufferSize) {
-      this.executorService = executorService;
-      this.bufferSize = bufferSize;
-    }
-
-    @Override
-    public <ReqT, RespT> StreamObserver<RespT> from(
-        StreamObserverClientFactory<ReqT, RespT> clientFactory,
-        StreamObserver<ReqT> inboundObserver) {
-      AdvancingPhaser phaser = new AdvancingPhaser(1);
-      CallStreamObserver<RespT> outboundObserver =
-          (CallStreamObserver<RespT>)
-              clientFactory.outboundObserverFor(
-                  ForwardingClientResponseObserver.<ReqT, RespT>create(
-                      inboundObserver, StreamObserverFactory.arriveAtPhaserHandler(phaser)));
-      return new BufferingStreamObserver<>(
-          phaser, outboundObserver, executorService, bufferSize);
-    }
-  }
-
-  private static Runnable arriveAtPhaserHandler(final AdvancingPhaser phaser) {
-    return phaser::arrive;
-  }
-
-  /**
-   * A factory which creates {@link StreamObserver StreamObservers} based on the input stream
-   * observer.
-   *
-   * <p>For example, this could be used to
-   *
-   * @param <RequestT> The type of message sent to the inbound stream
-   * @param <ResponseT> They type of messages sent over the outbound stream
-   */
-  public interface StreamObserverClientFactory<RequestT, ResponseT> {
-    StreamObserver<ResponseT> outboundObserverFor(StreamObserver<RequestT> inboundObserver);
-  }
-}
diff --git a/sdks/java/fn-execution/src/test/java/org/apache/beam/sdk/fn/data/BeamFnDataGrpcMultiplexerTest.java b/sdks/java/fn-execution/src/test/java/org/apache/beam/sdk/fn/data/BeamFnDataGrpcMultiplexerTest.java
index b39a1c9b217..6cfeb5cc02b 100644
--- a/sdks/java/fn-execution/src/test/java/org/apache/beam/sdk/fn/data/BeamFnDataGrpcMultiplexerTest.java
+++ b/sdks/java/fn-execution/src/test/java/org/apache/beam/sdk/fn/data/BeamFnDataGrpcMultiplexerTest.java
@@ -31,6 +31,7 @@ import java.util.concurrent.Executors;
 import java.util.concurrent.TimeUnit;
 import org.apache.beam.model.fnexecution.v1.BeamFnApi;
 import org.apache.beam.model.pipeline.v1.Endpoints;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.apache.beam.sdk.fn.test.TestStreams;
 import org.junit.Test;
 
@@ -62,7 +63,9 @@ public class BeamFnDataGrpcMultiplexerTest {
     final Collection<BeamFnApi.Elements> values = new ArrayList<>();
     BeamFnDataGrpcMultiplexer multiplexer =
         new BeamFnDataGrpcMultiplexer(
-            DESCRIPTOR, inboundObserver -> TestStreams.withOnNext(values::add).build());
+            DESCRIPTOR,
+            OutboundObserverFactory.clientDirect(),
+            inboundObserver -> TestStreams.withOnNext(values::add).build());
     multiplexer.getOutboundObserver().onNext(ELEMENTS);
     assertThat(values, contains(ELEMENTS));
   }
@@ -73,7 +76,9 @@ public class BeamFnDataGrpcMultiplexerTest {
     final Collection<BeamFnApi.Elements.Data> inboundValues = new ArrayList<>();
     final BeamFnDataGrpcMultiplexer multiplexer =
         new BeamFnDataGrpcMultiplexer(
-            DESCRIPTOR, inboundObserver -> TestStreams.withOnNext(outboundValues::add).build());
+            DESCRIPTOR,
+            OutboundObserverFactory.clientDirect(),
+            inboundObserver -> TestStreams.withOnNext(outboundValues::add).build());
     ExecutorService executorService = Executors.newCachedThreadPool();
     executorService.submit(
         () -> {
diff --git a/sdks/java/fn-execution/src/test/java/org/apache/beam/sdk/fn/stream/StreamObserverFactoryTest.java b/sdks/java/fn-execution/src/test/java/org/apache/beam/sdk/fn/stream/OutboundObserverFactoryTest.java
similarity index 78%
rename from sdks/java/fn-execution/src/test/java/org/apache/beam/sdk/fn/stream/StreamObserverFactoryTest.java
rename to sdks/java/fn-execution/src/test/java/org/apache/beam/sdk/fn/stream/OutboundObserverFactoryTest.java
index 0b51c09c811..97451b448f1 100644
--- a/sdks/java/fn-execution/src/test/java/org/apache/beam/sdk/fn/stream/StreamObserverFactoryTest.java
+++ b/sdks/java/fn-execution/src/test/java/org/apache/beam/sdk/fn/stream/OutboundObserverFactoryTest.java
@@ -25,7 +25,6 @@ import static org.junit.Assert.assertThat;
 import io.grpc.stub.CallStreamObserver;
 import io.grpc.stub.StreamObserver;
 import java.util.concurrent.Executors;
-import org.apache.beam.sdk.fn.stream.StreamObserverFactory.StreamObserverClientFactory;
 import org.junit.Before;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -33,9 +32,9 @@ import org.junit.runners.JUnit4;
 import org.mockito.Mock;
 import org.mockito.MockitoAnnotations;
 
-/** Tests for {@link StreamObserverFactory}. */
+/** Tests for {@link OutboundObserverFactory}. */
 @RunWith(JUnit4.class)
-public class StreamObserverFactoryTest {
+public class OutboundObserverFactoryTest {
   @Mock private StreamObserver<Integer> mockRequestObserver;
   @Mock private CallStreamObserver<String> mockResponseObserver;
 
@@ -47,28 +46,29 @@ public class StreamObserverFactoryTest {
   @Test
   public void testDefaultInstantiation() {
     StreamObserver<String> observer =
-        StreamObserverFactory.direct().from(this.fakeFactory(), mockRequestObserver);
+        OutboundObserverFactory.clientDirect()
+            .outboundObserverFor(this.fakeFactory(), mockRequestObserver);
     assertThat(observer, instanceOf(DirectStreamObserver.class));
   }
 
   @Test
   public void testBufferedStreamInstantiation() {
     StreamObserver<String> observer =
-        StreamObserverFactory.buffered(Executors.newSingleThreadExecutor())
-            .from(this.fakeFactory(), mockRequestObserver);
+        OutboundObserverFactory.clientBuffered(Executors.newSingleThreadExecutor())
+            .outboundObserverFor(this.fakeFactory(), mockRequestObserver);
     assertThat(observer, instanceOf(BufferingStreamObserver.class));
   }
 
   @Test
   public void testBufferedStreamWithLimitInstantiation() {
     StreamObserver<String> observer =
-        StreamObserverFactory.buffered(Executors.newSingleThreadExecutor(), 1)
-            .from(this.fakeFactory(), mockRequestObserver);
+        OutboundObserverFactory.clientBuffered(Executors.newSingleThreadExecutor(), 1)
+            .outboundObserverFor(this.fakeFactory(), mockRequestObserver);
     assertThat(observer, instanceOf(BufferingStreamObserver.class));
     assertEquals(1, ((BufferingStreamObserver<String>) observer).getBufferSize());
   }
 
-  private StreamObserverClientFactory<Integer, String> fakeFactory() {
+  private OutboundObserverFactory.BasicFactory<Integer, String> fakeFactory() {
     return inboundObserver -> {
       assertThat(inboundObserver, instanceOf(ForwardingClientResponseObserver.class));
       return mockResponseObserver;
diff --git a/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/FnApiDoFnRunner.java b/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/FnApiDoFnRunner.java
index c01a221c6de..dcd1b24d3f9 100644
--- a/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/FnApiDoFnRunner.java
+++ b/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/FnApiDoFnRunner.java
@@ -79,8 +79,10 @@ import org.apache.beam.sdk.state.WatermarkHoldState;
 import org.apache.beam.sdk.transforms.Combine.CombineFn;
 import org.apache.beam.sdk.transforms.CombineWithContext.CombineFnWithContext;
 import org.apache.beam.sdk.transforms.DoFn;
+import org.apache.beam.sdk.transforms.DoFn.FinishBundleContext;
 import org.apache.beam.sdk.transforms.DoFn.MultiOutputReceiver;
 import org.apache.beam.sdk.transforms.DoFn.OutputReceiver;
+import org.apache.beam.sdk.transforms.DoFn.StartBundleContext;
 import org.apache.beam.sdk.transforms.DoFnOutputReceivers;
 import org.apache.beam.sdk.transforms.Materializations;
 import org.apache.beam.sdk.transforms.ViewFn;
@@ -112,6 +114,11 @@ import org.joda.time.Instant;
  * concepts differently.
  */
 public class FnApiDoFnRunner<InputT, OutputT> implements DoFnRunner<InputT, OutputT> {
+
+  private final ProcessBundleContext processContext;
+  private final FinishBundleContext finishBundleContext;
+  private StartBundleContext startBundleContext;
+
   /**
    * A registrar which provides a factory to handle Java {@link DoFn}s.
    */
@@ -385,16 +392,41 @@ public class FnApiDoFnRunner<InputT, OutputT> implements DoFnRunner<InputT, Outp
     this.doFnInvoker.invokeSetup();
     this.stateBinder = new BeamFnStateBinder();
     this.stateFinalizers = new ArrayList<>();
-  }
 
-  @Override
-  public void startBundle() {
-    doFnInvoker.invokeStartBundle(doFn.new StartBundleContext() {
+    this.startBundleContext = doFn.new StartBundleContext() {
       @Override
       public PipelineOptions getPipelineOptions() {
         return pipelineOptions;
       }
-    });
+    };
+    this.processContext = new ProcessBundleContext();
+    finishBundleContext = doFn.new FinishBundleContext() {
+      @Override
+      public PipelineOptions getPipelineOptions() {
+        return pipelineOptions;
+      }
+
+      @Override
+      public void output(OutputT output, Instant timestamp, BoundedWindow window) {
+        outputTo(mainOutputConsumers,
+            WindowedValue.of(output, timestamp, window, PaneInfo.NO_FIRING));
+      }
+
+      @Override
+      public <T> void output(TupleTag<T> tag, T output, Instant timestamp, BoundedWindow window) {
+        Collection<FnDataReceiver<WindowedValue<T>>> consumers = (Collection) outputMap.get(tag);
+        if (consumers == null) {
+          throw new IllegalArgumentException(String.format("Unknown output tag %s", tag));
+        }
+        outputTo(consumers,
+            WindowedValue.of(output, timestamp, window, PaneInfo.NO_FIRING));
+      }
+    };
+  }
+
+  @Override
+  public void startBundle() {
+    doFnInvoker.invokeStartBundle(startBundleContext);
   }
 
   @Override
@@ -405,7 +437,7 @@ public class FnApiDoFnRunner<InputT, OutputT> implements DoFnRunner<InputT, Outp
           (Iterator<BoundedWindow>) elem.getWindows().iterator();
       while (windowIterator.hasNext()) {
         currentWindow = windowIterator.next();
-        doFnInvoker.invokeProcessElement(new ProcessBundleContext());
+        doFnInvoker.invokeProcessElement(processContext);
       }
     } finally {
       currentElement = null;
@@ -426,28 +458,7 @@ public class FnApiDoFnRunner<InputT, OutputT> implements DoFnRunner<InputT, Outp
 
   @Override
   public void finishBundle() {
-    doFnInvoker.invokeFinishBundle(doFn.new FinishBundleContext() {
-      @Override
-      public PipelineOptions getPipelineOptions() {
-        return pipelineOptions;
-      }
-
-      @Override
-      public void output(OutputT output, Instant timestamp, BoundedWindow window) {
-        outputTo(mainOutputConsumers,
-            WindowedValue.of(output, timestamp, window, PaneInfo.NO_FIRING));
-      }
-
-      @Override
-      public <T> void output(TupleTag<T> tag, T output, Instant timestamp, BoundedWindow window) {
-        Collection<FnDataReceiver<WindowedValue<T>>> consumers = (Collection) outputMap.get(tag);
-        if (consumers == null) {
-          throw new IllegalArgumentException(String.format("Unknown output tag %s", tag));
-        }
-        outputTo(consumers,
-            WindowedValue.of(output, timestamp, window, PaneInfo.NO_FIRING));
-      }
-    });
+    doFnInvoker.invokeFinishBundle(finishBundleContext);
 
     // Persist all dirty state cells
     try {
diff --git a/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/FnHarness.java b/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/FnHarness.java
index 204e828092d..d362d68a4ab 100644
--- a/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/FnHarness.java
+++ b/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/FnHarness.java
@@ -38,7 +38,7 @@ import org.apache.beam.sdk.fn.IdGenerator;
 import org.apache.beam.sdk.fn.IdGenerators;
 import org.apache.beam.sdk.fn.channel.ManagedChannelFactory;
 import org.apache.beam.sdk.fn.function.ThrowingFunction;
-import org.apache.beam.sdk.fn.stream.StreamObserverFactory;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.apache.beam.sdk.options.ExperimentalOptions;
 import org.apache.beam.sdk.options.PipelineOptions;
 import org.apache.beam.sdk.util.common.ReflectHelpers;
@@ -104,14 +104,14 @@ public class FnHarness {
     } else {
       channelFactory = ManagedChannelFactory.createDefault();
     }
-    StreamObserverFactory streamObserverFactory =
+    OutboundObserverFactory outboundObserverFactory =
         HarnessStreamObserverFactories.fromOptions(options);
     main(
         options,
         loggingApiServiceDescriptor,
         controlApiServiceDescriptor,
         channelFactory,
-        streamObserverFactory);
+        outboundObserverFactory);
   }
 
   public static void main(
@@ -119,7 +119,7 @@ public class FnHarness {
       Endpoints.ApiServiceDescriptor loggingApiServiceDescriptor,
       Endpoints.ApiServiceDescriptor controlApiServiceDescriptor,
       ManagedChannelFactory channelFactory,
-      StreamObserverFactory streamObserverFactory) {
+      OutboundObserverFactory outboundObserverFactory) {
     IdGenerator idGenerator = IdGenerators.decrementingLongs();
     try (BeamFnLoggingClient logging = new BeamFnLoggingClient(
         options,
@@ -133,11 +133,11 @@ public class FnHarness {
 
       RegisterHandler fnApiRegistry = new RegisterHandler();
       BeamFnDataGrpcClient beamFnDataMultiplexer = new BeamFnDataGrpcClient(
-          options, channelFactory::forDescriptor, streamObserverFactory::from);
+          options, channelFactory::forDescriptor, outboundObserverFactory);
 
       BeamFnStateGrpcClientCache beamFnStateGrpcClientCache =
           new BeamFnStateGrpcClientCache(
-              options, idGenerator, channelFactory::forDescriptor, streamObserverFactory::from);
+              idGenerator, channelFactory::forDescriptor, outboundObserverFactory);
 
       ProcessBundleHandler processBundleHandler = new ProcessBundleHandler(
           options,
@@ -148,10 +148,12 @@ public class FnHarness {
           fnApiRegistry::register);
       handlers.put(BeamFnApi.InstructionRequest.RequestCase.PROCESS_BUNDLE,
           processBundleHandler::processBundle);
-      BeamFnControlClient control = new BeamFnControlClient(controlApiServiceDescriptor,
-          channelFactory::forDescriptor,
-          streamObserverFactory::from,
-          handlers);
+      BeamFnControlClient control =
+          new BeamFnControlClient(
+              controlApiServiceDescriptor,
+              channelFactory::forDescriptor,
+              outboundObserverFactory,
+              handlers);
 
       LOG.info("Entering instruction processing loop");
       control.processInstructionRequests(options.as(GcsOptions.class).getExecutorService());
diff --git a/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/control/BeamFnControlClient.java b/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/control/BeamFnControlClient.java
index ab932c797d4..d0df30900d1 100644
--- a/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/control/BeamFnControlClient.java
+++ b/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/control/BeamFnControlClient.java
@@ -30,14 +30,12 @@ import java.util.concurrent.CompletableFuture;
 import java.util.concurrent.ExecutionException;
 import java.util.concurrent.Executor;
 import java.util.concurrent.LinkedBlockingDeque;
-import java.util.function.BiFunction;
 import java.util.function.Function;
 import org.apache.beam.model.fnexecution.v1.BeamFnApi;
-import org.apache.beam.model.fnexecution.v1.BeamFnApi.InstructionRequest;
 import org.apache.beam.model.fnexecution.v1.BeamFnControlGrpc;
 import org.apache.beam.model.pipeline.v1.Endpoints;
 import org.apache.beam.sdk.fn.function.ThrowingFunction;
-import org.apache.beam.sdk.fn.stream.StreamObserverFactory.StreamObserverClientFactory;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
@@ -71,18 +69,14 @@ public class BeamFnControlClient {
   public BeamFnControlClient(
       Endpoints.ApiServiceDescriptor apiServiceDescriptor,
       Function<Endpoints.ApiServiceDescriptor, ManagedChannel> channelFactory,
-      BiFunction<
-              StreamObserverClientFactory<InstructionRequest, BeamFnApi.InstructionResponse>,
-              StreamObserver<BeamFnApi.InstructionRequest>,
-              StreamObserver<BeamFnApi.InstructionResponse>>
-          streamObserverFactory,
+      OutboundObserverFactory outboundObserverFactory,
       EnumMap<
               BeamFnApi.InstructionRequest.RequestCase,
               ThrowingFunction<BeamFnApi.InstructionRequest, BeamFnApi.InstructionResponse.Builder>>
           handlers) {
     this.bufferedInstructions = new LinkedBlockingDeque<>();
     this.outboundObserver =
-        streamObserverFactory.apply(
+        outboundObserverFactory.outboundObserverFor(
             BeamFnControlGrpc.newStub(channelFactory.apply(apiServiceDescriptor))::control,
             new InboundObserver());
     this.handlers = handlers;
diff --git a/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/data/BeamFnDataGrpcClient.java b/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/data/BeamFnDataGrpcClient.java
index 47699a69f32..e9892803b79 100644
--- a/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/data/BeamFnDataGrpcClient.java
+++ b/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/data/BeamFnDataGrpcClient.java
@@ -19,15 +19,12 @@
 package org.apache.beam.fn.harness.data;
 
 import io.grpc.ManagedChannel;
-import io.grpc.stub.StreamObserver;
 import java.util.Collections;
 import java.util.List;
 import java.util.Optional;
 import java.util.concurrent.ConcurrentHashMap;
 import java.util.concurrent.ConcurrentMap;
-import java.util.function.BiFunction;
 import java.util.function.Function;
-import org.apache.beam.model.fnexecution.v1.BeamFnApi;
 import org.apache.beam.model.fnexecution.v1.BeamFnDataGrpc;
 import org.apache.beam.model.pipeline.v1.Endpoints;
 import org.apache.beam.model.pipeline.v1.Endpoints.ApiServiceDescriptor;
@@ -39,7 +36,7 @@ import org.apache.beam.sdk.fn.data.CloseableFnDataReceiver;
 import org.apache.beam.sdk.fn.data.FnDataReceiver;
 import org.apache.beam.sdk.fn.data.InboundDataClient;
 import org.apache.beam.sdk.fn.data.LogicalEndpoint;
-import org.apache.beam.sdk.fn.stream.StreamObserverFactory.StreamObserverClientFactory;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.apache.beam.sdk.options.ExperimentalOptions;
 import org.apache.beam.sdk.options.PipelineOptions;
 import org.apache.beam.sdk.util.WindowedValue;
@@ -57,22 +54,16 @@ public class BeamFnDataGrpcClient implements BeamFnDataClient {
 
   private final ConcurrentMap<Endpoints.ApiServiceDescriptor, BeamFnDataGrpcMultiplexer> cache;
   private final Function<Endpoints.ApiServiceDescriptor, ManagedChannel> channelFactory;
-  private final BiFunction<
-          StreamObserverClientFactory<BeamFnApi.Elements, BeamFnApi.Elements>,
-          StreamObserver<BeamFnApi.Elements>, StreamObserver<BeamFnApi.Elements>>
-      outboundStreamObserverFactory;
+  private final OutboundObserverFactory outboundObserverFactory;
   private final PipelineOptions options;
 
   public BeamFnDataGrpcClient(
       PipelineOptions options,
       Function<Endpoints.ApiServiceDescriptor, ManagedChannel> channelFactory,
-      BiFunction<
-              StreamObserverClientFactory<BeamFnApi.Elements, BeamFnApi.Elements>,
-              StreamObserver<BeamFnApi.Elements>, StreamObserver<BeamFnApi.Elements>>
-          outboundStreamObserverFactory) {
+      OutboundObserverFactory outboundObserverFactory) {
     this.options = options;
     this.channelFactory = channelFactory;
-    this.outboundStreamObserverFactory = outboundStreamObserverFactory;
+    this.outboundObserverFactory = outboundObserverFactory;
     this.cache = new ConcurrentHashMap<>();
   }
 
@@ -153,9 +144,7 @@ public class BeamFnDataGrpcClient implements BeamFnDataClient {
         (Endpoints.ApiServiceDescriptor descriptor) ->
             new BeamFnDataGrpcMultiplexer(
                 descriptor,
-                (StreamObserver<BeamFnApi.Elements> inboundObserver) ->
-                    outboundStreamObserverFactory.apply(
-                        BeamFnDataGrpc.newStub(channelFactory.apply(apiServiceDescriptor))::data,
-                        inboundObserver)));
+                outboundObserverFactory,
+                BeamFnDataGrpc.newStub(channelFactory.apply(apiServiceDescriptor))::data));
   }
 }
diff --git a/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/state/BeamFnStateGrpcClientCache.java b/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/state/BeamFnStateGrpcClientCache.java
index 8d2fe19c522..2886c71e1cf 100644
--- a/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/state/BeamFnStateGrpcClientCache.java
+++ b/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/state/BeamFnStateGrpcClientCache.java
@@ -24,7 +24,6 @@ import java.util.Map;
 import java.util.concurrent.CompletableFuture;
 import java.util.concurrent.ConcurrentHashMap;
 import java.util.concurrent.ConcurrentMap;
-import java.util.function.BiFunction;
 import java.util.function.Function;
 import org.apache.beam.fn.harness.data.BeamFnDataGrpcClient;
 import org.apache.beam.model.fnexecution.v1.BeamFnApi.StateRequest;
@@ -33,8 +32,7 @@ import org.apache.beam.model.fnexecution.v1.BeamFnStateGrpc;
 import org.apache.beam.model.pipeline.v1.Endpoints;
 import org.apache.beam.model.pipeline.v1.Endpoints.ApiServiceDescriptor;
 import org.apache.beam.sdk.fn.IdGenerator;
-import org.apache.beam.sdk.fn.stream.StreamObserverFactory.StreamObserverClientFactory;
-import org.apache.beam.sdk.options.PipelineOptions;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
@@ -48,26 +46,16 @@ public class BeamFnStateGrpcClientCache {
 
   private final ConcurrentMap<ApiServiceDescriptor, BeamFnStateClient> cache;
   private final Function<ApiServiceDescriptor, ManagedChannel> channelFactory;
-  private final BiFunction<
-          StreamObserverClientFactory<StateResponse, StateRequest>, StreamObserver<StateResponse>,
-          StreamObserver<StateRequest>>
-      streamObserverFactory;
-  private final PipelineOptions options;
+  private final OutboundObserverFactory outboundObserverFactory;
   private final IdGenerator idGenerator;
 
   public BeamFnStateGrpcClientCache(
-      PipelineOptions options,
       IdGenerator idGenerator,
       Function<Endpoints.ApiServiceDescriptor, ManagedChannel> channelFactory,
-      BiFunction<
-              StreamObserverClientFactory<StateResponse, StateRequest>,
-              StreamObserver<StateResponse>,
-              StreamObserver<StateRequest>>
-          streamObserverFactory) {
-    this.options = options;
+      OutboundObserverFactory outboundObserverFactory) {
     this.idGenerator = idGenerator;
     this.channelFactory = channelFactory;
-    this.streamObserverFactory = streamObserverFactory;
+    this.outboundObserverFactory = outboundObserverFactory;
     this.cache = new ConcurrentHashMap<>();
   }
 
@@ -99,7 +87,7 @@ public class BeamFnStateGrpcClientCache {
       this.apiServiceDescriptor = apiServiceDescriptor;
       this.outstandingRequests = new ConcurrentHashMap<>();
       this.channel = channelFactory.apply(apiServiceDescriptor);
-      this.outboundObserver = streamObserverFactory.apply(
+      this.outboundObserver = outboundObserverFactory.outboundObserverFor(
           BeamFnStateGrpc.newStub(channel)::state, new InboundObserver());
     }
 
diff --git a/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/stream/HarnessStreamObserverFactories.java b/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/stream/HarnessStreamObserverFactories.java
index 0c5eac92675..c0d43ddd9f8 100644
--- a/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/stream/HarnessStreamObserverFactories.java
+++ b/sdks/java/harness/src/main/java/org/apache/beam/fn/harness/stream/HarnessStreamObserverFactories.java
@@ -21,7 +21,7 @@ package org.apache.beam.fn.harness.stream;
 import io.grpc.stub.StreamObserver;
 import java.util.List;
 import org.apache.beam.sdk.extensions.gcp.options.GcsOptions;
-import org.apache.beam.sdk.fn.stream.StreamObserverFactory;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.apache.beam.sdk.options.ExperimentalOptions;
 import org.apache.beam.sdk.options.PipelineOptions;
 
@@ -30,19 +30,19 @@ import org.apache.beam.sdk.options.PipelineOptions;
  * to use in the java SDK harness.
  */
 public abstract class HarnessStreamObserverFactories {
-  public static StreamObserverFactory fromOptions(
+  public static OutboundObserverFactory fromOptions(
       PipelineOptions options) {
     List<String> experiments = options.as(ExperimentalOptions.class).getExperiments();
     if (experiments != null && experiments.contains("beam_fn_api_buffered_stream")) {
       int bufferSize = getBufferSize(experiments);
       if (bufferSize > 0) {
-        return StreamObserverFactory.buffered(
+        return OutboundObserverFactory.clientBuffered(
             options.as(GcsOptions.class).getExecutorService(), bufferSize);
       }
-      return StreamObserverFactory.buffered(
+      return OutboundObserverFactory.clientBuffered(
           options.as(GcsOptions.class).getExecutorService());
     }
-    return StreamObserverFactory.direct();
+    return OutboundObserverFactory.clientDirect();
   }
 
   private static int getBufferSize(List<String> experiments) {
diff --git a/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/control/BeamFnControlClientTest.java b/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/control/BeamFnControlClientTest.java
index c3661639d5c..4f465647f73 100644
--- a/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/control/BeamFnControlClientTest.java
+++ b/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/control/BeamFnControlClientTest.java
@@ -48,7 +48,7 @@ import org.apache.beam.model.fnexecution.v1.BeamFnApi.RegisterRequest;
 import org.apache.beam.model.fnexecution.v1.BeamFnControlGrpc;
 import org.apache.beam.model.pipeline.v1.Endpoints;
 import org.apache.beam.sdk.fn.function.ThrowingFunction;
-import org.apache.beam.sdk.fn.stream.StreamObserverFactory.StreamObserverClientFactory;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.apache.beam.sdk.fn.test.TestStreams;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -139,7 +139,7 @@ public class BeamFnControlClientTest {
           new BeamFnControlClient(
               apiServiceDescriptor,
               (Endpoints.ApiServiceDescriptor descriptor) -> channel,
-              this::createStreamForTest,
+              OutboundObserverFactory.trivial(),
               handlers);
 
       // Get the connected client and attempt to send and receive an instruction
@@ -221,7 +221,7 @@ public class BeamFnControlClientTest {
           new BeamFnControlClient(
               apiServiceDescriptor,
               (Endpoints.ApiServiceDescriptor descriptor) -> channel,
-              this::createStreamForTest,
+              OutboundObserverFactory.trivial(),
               handlers);
 
       // Get the connected client and attempt to send and receive an instruction
@@ -256,9 +256,4 @@ public class BeamFnControlClientTest {
       server.shutdownNow();
     }
   }
-
-  private <ReqT, RespT> StreamObserver<RespT> createStreamForTest(
-      StreamObserverClientFactory<ReqT, RespT> clientFactory, StreamObserver<ReqT> handler) {
-    return clientFactory.outboundObserverFor(handler);
-  }
 }
diff --git a/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/data/BeamFnDataGrpcClientTest.java b/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/data/BeamFnDataGrpcClientTest.java
index 9639c27fd71..cf37b9e7538 100644
--- a/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/data/BeamFnDataGrpcClientTest.java
+++ b/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/data/BeamFnDataGrpcClientTest.java
@@ -50,7 +50,7 @@ import org.apache.beam.sdk.coders.StringUtf8Coder;
 import org.apache.beam.sdk.fn.data.CloseableFnDataReceiver;
 import org.apache.beam.sdk.fn.data.InboundDataClient;
 import org.apache.beam.sdk.fn.data.LogicalEndpoint;
-import org.apache.beam.sdk.fn.stream.StreamObserverFactory.StreamObserverClientFactory;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.apache.beam.sdk.fn.test.TestStreams;
 import org.apache.beam.sdk.options.PipelineOptionsFactory;
 import org.apache.beam.sdk.transforms.windowing.GlobalWindow;
@@ -152,7 +152,7 @@ public class BeamFnDataGrpcClientTest {
     BeamFnDataGrpcClient clientFactory = new BeamFnDataGrpcClient(
         PipelineOptionsFactory.create(),
         (Endpoints.ApiServiceDescriptor descriptor) -> channel,
-        this::createStreamForTest);
+        OutboundObserverFactory.trivial());
 
       InboundDataClient readFutureA =
           clientFactory.receive(
@@ -214,10 +214,11 @@ public class BeamFnDataGrpcClientTest {
       ManagedChannel channel =
           InProcessChannelBuilder.forName(apiServiceDescriptor.getUrl()).build();
 
-      BeamFnDataGrpcClient clientFactory = new BeamFnDataGrpcClient(
-          PipelineOptionsFactory.create(),
-          (Endpoints.ApiServiceDescriptor descriptor) -> channel,
-          this::createStreamForTest);
+      BeamFnDataGrpcClient clientFactory =
+          new BeamFnDataGrpcClient(
+              PipelineOptionsFactory.create(),
+              (Endpoints.ApiServiceDescriptor descriptor) -> channel,
+              OutboundObserverFactory.trivial());
 
       InboundDataClient readFuture = clientFactory.receive(
           apiServiceDescriptor,
@@ -278,11 +279,13 @@ public class BeamFnDataGrpcClientTest {
       ManagedChannel channel =
           InProcessChannelBuilder.forName(apiServiceDescriptor.getUrl()).build();
 
-      BeamFnDataGrpcClient clientFactory = new BeamFnDataGrpcClient(
-          PipelineOptionsFactory.fromArgs(
-              new String[]{ "--experiments=beam_fn_api_data_buffer_limit=20" }).create(),
-          (Endpoints.ApiServiceDescriptor descriptor) -> channel,
-          this::createStreamForTest);
+      BeamFnDataGrpcClient clientFactory =
+          new BeamFnDataGrpcClient(
+              PipelineOptionsFactory.fromArgs(
+                      new String[] {"--experiments=beam_fn_api_data_buffer_limit=20"})
+                  .create(),
+              (Endpoints.ApiServiceDescriptor descriptor) -> channel,
+              OutboundObserverFactory.trivial());
 
       try (CloseableFnDataReceiver<WindowedValue<String>> consumer =
           clientFactory.send(apiServiceDescriptor, ENDPOINT_A, CODER)) {
@@ -298,10 +301,4 @@ public class BeamFnDataGrpcClientTest {
       server.shutdownNow();
     }
   }
-
-  private <ReqT, RespT> StreamObserver<RespT> createStreamForTest(
-      StreamObserverClientFactory<ReqT, RespT> clientFactory,
-      StreamObserver<ReqT> handler) {
-    return clientFactory.outboundObserverFor(handler);
-  }
 }
diff --git a/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/state/BeamFnStateGrpcClientCacheTest.java b/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/state/BeamFnStateGrpcClientCacheTest.java
index c8110b74a4f..3eb4810bf45 100644
--- a/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/state/BeamFnStateGrpcClientCacheTest.java
+++ b/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/state/BeamFnStateGrpcClientCacheTest.java
@@ -43,9 +43,8 @@ import org.apache.beam.model.fnexecution.v1.BeamFnApi.StateResponse;
 import org.apache.beam.model.fnexecution.v1.BeamFnStateGrpc;
 import org.apache.beam.model.pipeline.v1.Endpoints;
 import org.apache.beam.sdk.fn.IdGenerators;
-import org.apache.beam.sdk.fn.stream.StreamObserverFactory.StreamObserverClientFactory;
+import org.apache.beam.sdk.fn.stream.OutboundObserverFactory;
 import org.apache.beam.sdk.fn.test.TestStreams;
-import org.apache.beam.sdk.options.PipelineOptionsFactory;
 import org.junit.After;
 import org.junit.Before;
 import org.junit.Test;
@@ -94,10 +93,9 @@ public class BeamFnStateGrpcClientCacheTest {
 
     clientCache =
         new BeamFnStateGrpcClientCache(
-            PipelineOptionsFactory.create(),
             IdGenerators.decrementingLongs(),
             (Endpoints.ApiServiceDescriptor descriptor) -> testChannel,
-            this::createStreamForTest);
+            OutboundObserverFactory.trivial());
   }
 
   @After
@@ -226,9 +224,4 @@ public class BeamFnStateGrpcClientCacheTest {
         return;
     }
   }
-
-  private <ReqT, RespT> StreamObserver<RespT> createStreamForTest(
-      StreamObserverClientFactory<ReqT, RespT> clientFactory, StreamObserver<ReqT> handler) {
-    return clientFactory.outboundObserverFor(handler);
-  }
 }
diff --git a/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/stream/HarnessStreamObserverFactoriesTest.java b/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/stream/HarnessStreamObserverFactoriesTest.java
index 22d9fcb79bc..186bbe61c8f 100644
--- a/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/stream/HarnessStreamObserverFactoriesTest.java
+++ b/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/stream/HarnessStreamObserverFactoriesTest.java
@@ -50,7 +50,7 @@ public class HarnessStreamObserverFactoriesTest {
   public void testDefaultInstantiation() {
     StreamObserver<String> observer =
         HarnessStreamObserverFactories.fromOptions(PipelineOptionsFactory.create())
-            .from(this::fakeFactory, mockRequestObserver);
+            .outboundObserverFor(this::fakeFactory, mockRequestObserver);
     assertThat(observer, instanceOf(DirectStreamObserver.class));
   }
 
@@ -61,7 +61,7 @@ public class HarnessStreamObserverFactoriesTest {
                 PipelineOptionsFactory.fromArgs(
                         new String[] {"--experiments=beam_fn_api_buffered_stream"})
                     .create())
-            .from(this::fakeFactory, mockRequestObserver);
+            .outboundObserverFor(this::fakeFactory, mockRequestObserver);
     assertThat(observer, instanceOf(BufferingStreamObserver.class));
   }
 
@@ -75,7 +75,7 @@ public class HarnessStreamObserverFactoriesTest {
                               + "beam_fn_api_buffered_stream_buffer_size=1"
                         })
                     .create())
-            .from(this::fakeFactory, mockRequestObserver);
+            .outboundObserverFor(this::fakeFactory, mockRequestObserver);
     assertThat(observer, instanceOf(BufferingStreamObserver.class));
     assertEquals(1, ((BufferingStreamObserver<String>) observer).getBufferSize());
   }
