diff --git a/sdks/java/io/mqtt/src/main/java/org/apache/beam/sdk/io/mqtt/MqttIO.java b/sdks/java/io/mqtt/src/main/java/org/apache/beam/sdk/io/mqtt/MqttIO.java
index 408f7277657..7fd2e58ffd6 100644
--- a/sdks/java/io/mqtt/src/main/java/org/apache/beam/sdk/io/mqtt/MqttIO.java
+++ b/sdks/java/io/mqtt/src/main/java/org/apache/beam/sdk/io/mqtt/MqttIO.java
@@ -104,6 +104,7 @@ import org.slf4j.LoggerFactory;
 public class MqttIO {
 
   private static final Logger LOG = LoggerFactory.getLogger(MqttIO.class);
+  private static final int MQTT_3_1_MAX_CLIENT_ID_LENGTH = 23;
 
   public static Read read() {
     return new AutoValue_MqttIO_Read.Builder()
@@ -231,10 +232,14 @@ public class MqttIO {
       }
       if (getClientId() != null) {
         String clientId = getClientId() + "-" + UUID.randomUUID().toString();
+        clientId =
+            clientId.substring(0, Math.min(clientId.length(), MQTT_3_1_MAX_CLIENT_ID_LENGTH));
         LOG.debug("MQTT client id set to {}", clientId);
         client.setClientId(clientId);
       } else {
         String clientId = UUID.randomUUID().toString();
+        clientId =
+            clientId.substring(0, Math.min(clientId.length(), MQTT_3_1_MAX_CLIENT_ID_LENGTH));
         LOG.debug("MQTT client id set to random value {}", clientId);
         client.setClientId(clientId);
       }
