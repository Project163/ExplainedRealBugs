diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/io/LocalFileSystem.java b/sdks/java/core/src/main/java/org/apache/beam/sdk/io/LocalFileSystem.java
index 37a46321623..54253ce64ce 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/io/LocalFileSystem.java
+++ b/sdks/java/core/src/main/java/org/apache/beam/sdk/io/LocalFileSystem.java
@@ -225,7 +225,11 @@ class LocalFileSystem extends FileSystem<LocalResourceId> {
     }
 
     File parent = file.getAbsoluteFile().getParentFile();
-    if (!parent.exists()) {
+    while (parent != null && !parent.exists()) {
+      parent = parent.getParentFile();
+    }
+
+    if (parent == null) {
       return MatchResult.create(Status.NOT_FOUND, Collections.emptyList());
     }
 
diff --git a/sdks/java/core/src/test/java/org/apache/beam/sdk/io/LocalFileSystemTest.java b/sdks/java/core/src/test/java/org/apache/beam/sdk/io/LocalFileSystemTest.java
index 2a1aab72b97..64aecfcdda9 100644
--- a/sdks/java/core/src/test/java/org/apache/beam/sdk/io/LocalFileSystemTest.java
+++ b/sdks/java/core/src/test/java/org/apache/beam/sdk/io/LocalFileSystemTest.java
@@ -184,6 +184,27 @@ public class LocalFileSystemTest {
     assertTrue(f3.exists());
   }
 
+  @Test
+  public void testMatchWithGlob() throws Exception {
+    String globPattern = "/A/a=[0-9][0-9][0-9]/*/*";
+    File folder1 = temporaryFolder.newFolder("A/a=100/data1");
+    File folder2 = temporaryFolder.newFolder("A/a=233/data_dir");
+    File expectedFile1 = new File(folder1, "/file1");
+    File expectedFile2 = new File(folder2, "/data_file2");
+
+    expectedFile1.createNewFile();
+    expectedFile2.createNewFile();
+
+    List<String> expected = ImmutableList.of(expectedFile1.toString(), expectedFile2.toString());
+
+    List<MatchResult> matchResults =
+        matchGlobWithPathPrefix(temporaryFolder.getRoot().toPath(), globPattern);
+
+    assertThat(
+        toFilenames(matchResults),
+        containsInAnyOrder(expected.toArray(new String[expected.size()])));
+  }
+
   @Test
   public void testMatchExact() throws Exception {
     List<String> expected = ImmutableList.of(temporaryFolder.newFile("a").toString());
@@ -356,16 +377,6 @@ public class LocalFileSystemTest {
         containsInAnyOrder(expected.toArray(new String[expected.size()])));
   }
 
-  @Test
-  public void testMatchWithoutParentDirectory() throws Exception {
-    Path pattern =
-        LocalResourceId.fromPath(temporaryFolder.getRoot().toPath(), true /* isDirectory */)
-            .resolve("non_existing_dir", StandardResolveOptions.RESOLVE_DIRECTORY)
-            .resolve("*", StandardResolveOptions.RESOLVE_FILE)
-            .getPath();
-    assertTrue(toFilenames(localFileSystem.match(ImmutableList.of(pattern.toString()))).isEmpty());
-  }
-
   @Test
   public void testMatchNewResource() throws Exception {
     LocalResourceId fileResource =
