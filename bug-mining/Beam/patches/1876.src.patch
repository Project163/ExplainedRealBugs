diff --git a/sdks/python/apache_beam/runners/portability/fn_api_runner/execution.py b/sdks/python/apache_beam/runners/portability/fn_api_runner/execution.py
index 4bd8cc655e6..acf04b786b7 100644
--- a/sdks/python/apache_beam/runners/portability/fn_api_runner/execution.py
+++ b/sdks/python/apache_beam/runners/portability/fn_api_runner/execution.py
@@ -20,6 +20,7 @@
 from __future__ import absolute_import
 
 import collections
+import copy
 import itertools
 from typing import TYPE_CHECKING
 from typing import Any
@@ -40,6 +41,7 @@ from apache_beam.coders.coder_impl import create_OutputStream
 from apache_beam.coders.coders import GlobalWindowCoder
 from apache_beam.coders.coders import WindowedValueCoder
 from apache_beam.portability import common_urns
+from apache_beam.portability import python_urns
 from apache_beam.portability.api import beam_fn_api_pb2
 from apache_beam.portability.api import beam_runner_api_pb2
 from apache_beam.runners import pipeline_context
@@ -50,6 +52,7 @@ from apache_beam.runners.portability.fn_api_runner.translations import split_buf
 from apache_beam.runners.portability.fn_api_runner.translations import unique_name
 from apache_beam.runners.worker import bundle_processor
 from apache_beam.transforms import trigger
+from apache_beam.transforms import window
 from apache_beam.transforms.window import GlobalWindow
 from apache_beam.transforms.window import GlobalWindows
 from apache_beam.utils import proto_utils
@@ -65,6 +68,9 @@ ENCODED_IMPULSE_VALUE = WindowedValueCoder(
     BytesCoder(), GlobalWindowCoder()).get_impl().encode_nested(
         GlobalWindows.windowed_value(b''))
 
+SAFE_WINDOW_FNS = set(window.WindowFn._known_urns.keys()) - set(
+    [python_urns.PICKLED_WINDOWFN])
+
 
 class Buffer(Protocol):
   def __iter__(self):
@@ -272,6 +278,26 @@ class WindowGroupingBuffer(object):
       yield encoded_key, encoded_window, output_stream.get()
 
 
+class GenericNonMergingWindowFn(window.NonMergingWindowFn):
+
+  URN = 'internal-generic-non-merging'
+
+  def __init__(self, coder):
+    self._coder = coder
+
+  def assign(self, assign_context):
+    raise NotImplementedError()
+
+  def get_window_coder(self):
+    return self._coder
+
+  @staticmethod
+  @window.urns.RunnerApiFn.register_urn(URN, bytes)
+  def from_runner_api_parameter(window_coder_id, context):
+    return GenericNonMergingWindowFn(
+        context.coders[window_coder_id.decode('utf-8')])
+
+
 class FnApiRunnerExecutionContext(object):
   """
  :var pcoll_buffers: (dict): Mapping of
@@ -306,6 +332,10 @@ class FnApiRunnerExecutionContext(object):
         self.pipeline_components,
         iterable_state_write=self._iterable_state_write)
     self._last_uid = -1
+    self.safe_windowing_strategies = {
+        id: self._make_safe_windowing_strategy(id)
+        for id in self.pipeline_components.windowing_strategies.keys()
+    }
 
   @staticmethod
   def _build_data_side_inputs_map(stages):
@@ -364,6 +394,28 @@ class FnApiRunnerExecutionContext(object):
 
     return data_side_inputs_by_producing_stage
 
+  def _make_safe_windowing_strategy(self, id):
+    windowing_strategy_proto = self.pipeline_components.windowing_strategies[id]
+    if windowing_strategy_proto.window_fn.urn in SAFE_WINDOW_FNS:
+      return id
+    elif (windowing_strategy_proto.merge_status ==
+          beam_runner_api_pb2.MergeStatus.NON_MERGING) or True:
+      safe_id = id + '_safe'
+      while safe_id in self.pipeline_components.windowing_strategies:
+        safe_id += '_'
+      safe_proto = copy.copy(windowing_strategy_proto)
+      safe_proto.window_fn.urn = GenericNonMergingWindowFn.URN
+      safe_proto.window_fn.payload = (
+          windowing_strategy_proto.window_coder_id.encode('utf-8'))
+      self.pipeline_context.windowing_strategies.put_proto(safe_id, safe_proto)
+      return safe_id
+    elif windowing_strategy_proto.window_fn.urn == python_urns.PICKLED_WINDOWFN:
+      return id
+    else:
+      raise NotImplementedError(
+          '[BEAM-10119] Unknown merging WindowFn: %s' %
+          windowing_strategy_proto)
+
   @property
   def state_servicer(self):
     # TODO(BEAM-9625): Ensure FnApiRunnerExecutionContext owns StateServicer
@@ -613,8 +665,9 @@ class BundleContextManager(object):
                 self.execution_context.data_channel_coders[output_pcoll]]]
         windowing_strategy = (
             self.execution_context.pipeline_context.windowing_strategies[
-                self.execution_context.pipeline_components.
-                pcollections[output_pcoll].windowing_strategy_id])
+                self.execution_context.safe_windowing_strategies[
+                    self.execution_context.pipeline_components.
+                    pcollections[output_pcoll].windowing_strategy_id]])
         self.execution_context.pcoll_buffers[buffer_id] = GroupingBuffer(
             pre_gbk_coder, post_gbk_coder, windowing_strategy)
     else:
