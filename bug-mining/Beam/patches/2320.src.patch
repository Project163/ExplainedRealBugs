diff --git a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricsEnvironment.java b/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricsEnvironment.java
index 5f64e3a8eab..d01ce4ecc93 100644
--- a/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricsEnvironment.java
+++ b/sdks/java/core/src/main/java/org/apache/beam/sdk/metrics/MetricsEnvironment.java
@@ -24,6 +24,7 @@ import java.util.concurrent.atomic.AtomicReference;
 import org.apache.beam.sdk.annotations.Experimental;
 import org.apache.beam.sdk.annotations.Experimental.Kind;
 import org.apache.beam.sdk.annotations.Internal;
+import org.checkerframework.checker.nullness.qual.NonNull;
 import org.checkerframework.checker.nullness.qual.Nullable;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
@@ -52,8 +53,8 @@ public class MetricsEnvironment {
   private static final AtomicBoolean METRICS_SUPPORTED = new AtomicBoolean(false);
   private static final AtomicBoolean REPORTED_MISSING_CONTAINER = new AtomicBoolean(false);
 
-  private static final ThreadLocal<@Nullable MetricsContainer> CONTAINER_FOR_THREAD =
-      new ThreadLocal<>();
+  private static final ThreadLocal<@Nullable MetricsContainerHolder> CONTAINER_FOR_THREAD =
+      ThreadLocal.withInitial(MetricsContainerHolder::new);
 
   private static final AtomicReference<@Nullable MetricsContainer> PROCESS_WIDE_METRICS_CONTAINER =
       new AtomicReference<>();
@@ -65,12 +66,11 @@ public class MetricsEnvironment {
    */
   public static @Nullable MetricsContainer setCurrentContainer(
       @Nullable MetricsContainer container) {
-    MetricsContainer previous = CONTAINER_FOR_THREAD.get();
-    if (container == null) {
-      CONTAINER_FOR_THREAD.remove();
-    } else {
-      CONTAINER_FOR_THREAD.set(container);
-    }
+    @SuppressWarnings("nullness") // Non-null due to withInitialValue
+    @NonNull
+    MetricsContainerHolder holder = CONTAINER_FOR_THREAD.get();
+    @Nullable MetricsContainer previous = holder.container;
+    holder.container = container;
     return previous;
   }
 
@@ -105,16 +105,20 @@ public class MetricsEnvironment {
   }
 
   private static class ScopedContainer implements Closeable {
-
+    private final MetricsContainerHolder holder;
     private final @Nullable MetricsContainer oldContainer;
 
+    @SuppressWarnings("nullness") // Non-null due to withInitialValue
     private ScopedContainer(MetricsContainer newContainer) {
-      this.oldContainer = setCurrentContainer(newContainer);
+      // It is safe to cache the thread-local holder because it never changes for the thread.
+      holder = CONTAINER_FOR_THREAD.get();
+      this.oldContainer = holder.container;
+      holder.container = newContainer;
     }
 
     @Override
     public void close() throws IOException {
-      setCurrentContainer(oldContainer);
+      holder.container = oldContainer;
     }
   }
 
@@ -126,7 +130,8 @@ public class MetricsEnvironment {
    * diagnostic message.
    */
   public static @Nullable MetricsContainer getCurrentContainer() {
-    MetricsContainer container = CONTAINER_FOR_THREAD.get();
+    @SuppressWarnings("nullness") // Non-null due to withInitialValue
+    MetricsContainer container = CONTAINER_FOR_THREAD.get().container;
     if (container == null && REPORTED_MISSING_CONTAINER.compareAndSet(false, true)) {
       if (isMetricsSupported()) {
         LOG.error(
@@ -143,4 +148,8 @@ public class MetricsEnvironment {
   public static @Nullable MetricsContainer getProcessWideContainer() {
     return PROCESS_WIDE_METRICS_CONTAINER.get();
   }
+
+  private static class MetricsContainerHolder {
+    public @Nullable MetricsContainer container = null;
+  }
 }
diff --git a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsEnvironmentTest.java b/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsEnvironmentTest.java
index bbf09a64d0d..c49a59cbb58 100644
--- a/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsEnvironmentTest.java
+++ b/sdks/java/core/src/test/java/org/apache/beam/sdk/metrics/MetricsEnvironmentTest.java
@@ -17,11 +17,14 @@
  */
 package org.apache.beam.sdk.metrics;
 
+import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertNull;
 import static org.mockito.Mockito.verify;
 import static org.mockito.Mockito.verifyNoMoreInteractions;
 import static org.mockito.Mockito.when;
 
+import java.io.Closeable;
+import java.io.IOException;
 import org.junit.After;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -47,11 +50,38 @@ public class MetricsEnvironmentTest {
     when(c1.getCounter(MetricName.named("ns", "name"))).thenReturn(counter1);
     when(c2.getCounter(MetricName.named("ns", "name"))).thenReturn(counter2);
 
-    MetricsEnvironment.setCurrentContainer(c1);
+    assertNull(MetricsEnvironment.setCurrentContainer(c1));
     counter.inc();
-    MetricsEnvironment.setCurrentContainer(c2);
+    assertEquals(c1, MetricsEnvironment.setCurrentContainer(c2));
     counter.dec();
-    MetricsEnvironment.setCurrentContainer(null);
+    assertEquals(c2, MetricsEnvironment.setCurrentContainer(null));
+
+    verify(counter1).inc(1L);
+    verify(counter2).inc(-1L);
+    verifyNoMoreInteractions(counter1, counter2);
+  }
+
+  @Test
+  public void testScopedMetricsContainers() throws IOException {
+    Counter counter = Metrics.counter("ns", "name");
+
+    MetricsContainer c1 = Mockito.mock(MetricsContainer.class);
+    MetricsContainer c2 = Mockito.mock(MetricsContainer.class);
+    Counter counter1 = Mockito.mock(Counter.class);
+    Counter counter2 = Mockito.mock(Counter.class);
+    when(c2.getCounter(MetricName.named("ns", "name"))).thenReturn(counter2);
+    when(c1.getCounter(MetricName.named("ns", "name"))).thenReturn(counter1);
+
+    try (Closeable close = MetricsEnvironment.scopedMetricsContainer(c1)) {
+      try (Closeable close2 = MetricsEnvironment.scopedMetricsContainer(null)) {
+        counter.inc(1000);
+        try (Closeable close3 = MetricsEnvironment.scopedMetricsContainer(c2)) {
+          counter.dec();
+        }
+      }
+      counter.inc();
+    }
+    assertEquals(null, MetricsEnvironment.setCurrentContainer(null));
 
     verify(counter1).inc(1L);
     verify(counter2).inc(-1L);
