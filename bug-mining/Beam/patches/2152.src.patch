diff --git a/sdks/java/io/hadoop-file-system/src/main/java/org/apache/beam/sdk/io/hdfs/HadoopFileSystemOptions.java b/sdks/java/io/hadoop-file-system/src/main/java/org/apache/beam/sdk/io/hdfs/HadoopFileSystemOptions.java
index 43a6e7e7d2b..d9acf0b417b 100644
--- a/sdks/java/io/hadoop-file-system/src/main/java/org/apache/beam/sdk/io/hdfs/HadoopFileSystemOptions.java
+++ b/sdks/java/io/hadoop-file-system/src/main/java/org/apache/beam/sdk/io/hdfs/HadoopFileSystemOptions.java
@@ -18,6 +18,7 @@
 package org.apache.beam.sdk.io.hdfs;
 
 import java.io.File;
+import java.nio.file.Paths;
 import java.util.List;
 import java.util.Map;
 import java.util.Set;
@@ -112,9 +113,13 @@ public interface HadoopFileSystemOptions extends PipelineOptions {
         }
       }
 
-      // Load the configuration from paths found (if exists)
+      // Set used to dedup same config paths
+      Set<java.nio.file.Path> confPaths = Sets.newHashSet();
+      // Load the configuration from paths found (if exists and not loaded yet)
       for (String confDir : explodedConfDirs) {
-        if (new File(confDir).exists()) {
+        java.nio.file.Path path = Paths.get(confDir).normalize();
+        if (new File(confDir).exists() && !confPaths.contains(path)) {
+          confPaths.add(path);
           Configuration conf = new Configuration(false);
           boolean confLoaded = false;
           for (String confName : Lists.newArrayList("core-site.xml", "hdfs-site.xml")) {
diff --git a/sdks/java/io/hadoop-file-system/src/test/java/org/apache/beam/sdk/io/hdfs/HadoopFileSystemOptionsTest.java b/sdks/java/io/hadoop-file-system/src/test/java/org/apache/beam/sdk/io/hdfs/HadoopFileSystemOptionsTest.java
index f2f289fa452..5af0e8a7b40 100644
--- a/sdks/java/io/hadoop-file-system/src/test/java/org/apache/beam/sdk/io/hdfs/HadoopFileSystemOptionsTest.java
+++ b/sdks/java/io/hadoop-file-system/src/test/java/org/apache/beam/sdk/io/hdfs/HadoopFileSystemOptionsTest.java
@@ -182,6 +182,26 @@ public class HadoopFileSystemOptionsTest {
     assertThat(configurationList.get(0).get("propertyB"), Matchers.equalTo("B"));
   }
 
+  @Test
+  public void testDefaultSetYarnConfDirAndHadoopConfDirAndSameDir() throws IOException {
+    Files.write(
+        createPropertyData("A"), tmpFolder.newFile("core-site.xml"), StandardCharsets.UTF_8);
+    Files.write(
+        createPropertyData("B"), tmpFolder.newFile("hdfs-site.xml"), StandardCharsets.UTF_8);
+    HadoopFileSystemOptions.ConfigurationLocator configurationLocator =
+        spy(new HadoopFileSystemOptions.ConfigurationLocator());
+    Map<String, String> environment = Maps.newHashMap();
+    environment.put("HADOOP_CONF_DIR", tmpFolder.getRoot().getAbsolutePath());
+    environment.put("YARN_CONF_DIR", tmpFolder.getRoot().getAbsolutePath() + "/");
+    when(configurationLocator.getEnvironment()).thenReturn(environment);
+
+    List<Configuration> configurationList =
+        configurationLocator.create(PipelineOptionsFactory.create());
+    assertEquals(1, configurationList.size());
+    assertThat(configurationList.get(0).get("propertyA"), Matchers.equalTo("A"));
+    assertThat(configurationList.get(0).get("propertyB"), Matchers.equalTo("B"));
+  }
+
   @Test
   public void testDefaultSetYarnConfDirAndHadoopConfDirMultiPathAndSameConfiguration()
       throws IOException {
