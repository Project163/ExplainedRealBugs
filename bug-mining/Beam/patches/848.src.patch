diff --git a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/graph/GreedyPipelineFuser.java b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/graph/GreedyPipelineFuser.java
index 5e36307438f..ec959ea3a8d 100644
--- a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/graph/GreedyPipelineFuser.java
+++ b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/graph/GreedyPipelineFuser.java
@@ -364,8 +364,6 @@ public class GreedyPipelineFuser {
             .stream()
             .map(PCollectionNode::getId)
             .collect(Collectors.toSet()));
-    possibleInputs.addAll(
-        stage.getTimers().stream().map(t -> t.collection().getId()).collect(Collectors.toSet()));
     possibleInputs.addAll(
         stage
             .getSideInputs()
diff --git a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/graph/QueryablePipeline.java b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/graph/QueryablePipeline.java
index 280e705db6c..bb6a47b7555 100644
--- a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/graph/QueryablePipeline.java
+++ b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/graph/QueryablePipeline.java
@@ -382,12 +382,8 @@ public class QueryablePipeline {
             localName -> {
               String transformId = transform.getId();
               PTransform transformProto = components.getTransformsOrThrow(transformId);
-              String collectionId = transform.getTransform().getInputsOrThrow(localName);
-              PCollection collection = components.getPcollectionsOrThrow(collectionId);
               return TimerReference.of(
-                  PipelineNode.pTransform(transformId, transformProto),
-                  localName,
-                  PipelineNode.pCollection(collectionId, collection));
+                  PipelineNode.pTransform(transformId, transformProto), localName);
             })
         .collect(Collectors.toSet());
   }
diff --git a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/graph/TimerReference.java b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/graph/TimerReference.java
index 0c6bf3a36bc..ac864c8644b 100644
--- a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/graph/TimerReference.java
+++ b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/graph/TimerReference.java
@@ -27,12 +27,10 @@ import org.apache.beam.model.pipeline.v1.RunnerApi;
  */
 @AutoValue
 public abstract class TimerReference {
+
   /** Create a timer reference. */
-  public static TimerReference of(
-      PipelineNode.PTransformNode transform,
-      String localName,
-      PipelineNode.PCollectionNode collection) {
-    return new AutoValue_TimerReference(transform, localName, collection);
+  public static TimerReference of(PipelineNode.PTransformNode transform, String localName) {
+    return new AutoValue_TimerReference(transform, localName);
   }
 
   /** Create a timer reference from a TimerId proto and components. */
@@ -40,19 +38,12 @@ public abstract class TimerReference {
       RunnerApi.ExecutableStagePayload.TimerId timerId, RunnerApi.Components components) {
     String transformId = timerId.getTransformId();
     String localName = timerId.getLocalName();
-    String collectionId = components.getTransformsOrThrow(transformId).getInputsOrThrow(localName);
     RunnerApi.PTransform transform = components.getTransformsOrThrow(transformId);
-    RunnerApi.PCollection collection = components.getPcollectionsOrThrow(collectionId);
-    return of(
-        PipelineNode.pTransform(transformId, transform),
-        localName,
-        PipelineNode.pCollection(collectionId, collection));
+    return of(PipelineNode.pTransform(transformId, transform), localName);
   }
 
   /** The PTransform that uses this timer. */
   public abstract PipelineNode.PTransformNode transform();
   /** The local name the referencing PTransform uses to refer to this timer. */
   public abstract String localName();
-  /** The PCollection that backs this timer. */
-  public abstract PipelineNode.PCollectionNode collection();
 }
diff --git a/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/graph/ExecutableStageTest.java b/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/graph/ExecutableStageTest.java
index a88e45e9ddd..ea10a52d321 100644
--- a/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/graph/ExecutableStageTest.java
+++ b/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/graph/ExecutableStageTest.java
@@ -94,8 +94,7 @@ public class ExecutableStageTest {
     UserStateReference userStateRef =
         UserStateReference.of(
             transformNode, "user_state", PipelineNode.pCollection("input.out", input));
-    TimerReference timerRef =
-        TimerReference.of(transformNode, "timer", PipelineNode.pCollection("timer.out", timer));
+    TimerReference timerRef = TimerReference.of(transformNode, "timer");
     ImmutableExecutableStage stage =
         ImmutableExecutableStage.of(
             components,
diff --git a/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/graph/ImmutableExecutableStageTest.java b/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/graph/ImmutableExecutableStageTest.java
index 3c7c5b20bc7..fd034d8ac3f 100644
--- a/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/graph/ImmutableExecutableStageTest.java
+++ b/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/graph/ImmutableExecutableStageTest.java
@@ -88,8 +88,7 @@ public class ImmutableExecutableStageTest {
     UserStateReference userStateRef =
         UserStateReference.of(
             transformNode, "user_state", PipelineNode.pCollection("input.out", input));
-    TimerReference timerRef =
-        TimerReference.of(transformNode, "timer", PipelineNode.pCollection("timer.pc", timer));
+    TimerReference timerRef = TimerReference.of(transformNode, "timer");
     ImmutableExecutableStage stage =
         ImmutableExecutableStage.ofFullComponents(
             components,
diff --git a/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/PrimitiveParDoSingleFactory.java b/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/PrimitiveParDoSingleFactory.java
index c82fa091f38..a5bfe61d3aa 100644
--- a/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/PrimitiveParDoSingleFactory.java
+++ b/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/PrimitiveParDoSingleFactory.java
@@ -201,7 +201,7 @@ public class PrimitiveParDoSingleFactory<InputT, OutputT>
               for (Map.Entry<String, DoFnSignature.TimerDeclaration> timer :
                   signature.timerDeclarations().entrySet()) {
                 RunnerApi.TimerSpec spec =
-                    translateTimerSpec(getTimerSpecOrThrow(timer.getValue(), doFn));
+                    translateTimerSpec(getTimerSpecOrThrow(timer.getValue(), doFn), newComponents);
                 timerSpecs.put(timer.getKey(), spec);
               }
               return timerSpecs;
diff --git a/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/control/ProcessBundleDescriptors.java b/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/control/ProcessBundleDescriptors.java
index 39f42d5a014..ee8404654cd 100644
--- a/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/control/ProcessBundleDescriptors.java
+++ b/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/control/ProcessBundleDescriptors.java
@@ -24,6 +24,7 @@ import com.google.auto.value.AutoValue;
 import com.google.common.collect.ImmutableMap;
 import com.google.common.collect.ImmutableTable;
 import com.google.common.collect.Iterables;
+import com.google.common.collect.Sets;
 import java.io.IOException;
 import java.util.Collection;
 import java.util.Collections;
@@ -40,6 +41,7 @@ import org.apache.beam.model.pipeline.v1.RunnerApi;
 import org.apache.beam.model.pipeline.v1.RunnerApi.Components;
 import org.apache.beam.model.pipeline.v1.RunnerApi.PCollection;
 import org.apache.beam.model.pipeline.v1.RunnerApi.PTransform;
+import org.apache.beam.runners.core.construction.ModelCoders;
 import org.apache.beam.runners.core.construction.SyntheticComponents;
 import org.apache.beam.runners.core.construction.graph.ExecutableStage;
 import org.apache.beam.runners.core.construction.graph.PipelineNode;
@@ -333,22 +335,56 @@ public class ProcessBundleDescriptors {
           throw new IllegalArgumentException(String.format("Unknown time domain %s", timeDomain));
       }
 
+      String mainInputName =
+          timerReference
+              .transform()
+              .getTransform()
+              .getInputsOrThrow(
+                  Iterables.getOnlyElement(
+                      Sets.difference(
+                          timerReference.transform().getTransform().getInputsMap().keySet(),
+                          Sets.union(
+                              payload.getSideInputsMap().keySet(),
+                              payload.getTimerSpecsMap().keySet()))));
+      String timerCoderId =
+          keyValueCoderId(
+              components
+                  .getCodersOrThrow(components.getPcollectionsOrThrow(mainInputName).getCoderId())
+                  .getComponentCoderIds(0),
+              payload.getTimerSpecsOrThrow(timerReference.localName()).getTimerCoderId(),
+              components);
+      RunnerApi.PCollection timerCollectionSpec =
+          components
+              .getPcollectionsOrThrow(mainInputName)
+              .toBuilder()
+              .setCoderId(timerCoderId)
+              .build();
+
+      // "Unroll" the timers into PCollections.
+      String inputTimerPCollectionId =
+          SyntheticComponents.uniqueId(
+              String.format(
+                  "%s.timer.%s.in", timerReference.transform().getId(), timerReference.localName()),
+              components.getPcollectionsMap()::containsKey);
+      components.putPcollections(inputTimerPCollectionId, timerCollectionSpec);
       remoteInputsBuilder.put(
-          timerReference.collection().getId(),
-          addStageInput(dataEndpoint, timerReference.collection(), components));
-      // "Unroll" the timer PCollection to make the execution tree a DAG.
+          inputTimerPCollectionId,
+          addStageInput(
+              dataEndpoint,
+              PipelineNode.pCollection(inputTimerPCollectionId, timerCollectionSpec),
+              components));
       String outputTimerPCollectionId =
           SyntheticComponents.uniqueId(
-              String.format("%s.out", timerReference.collection().getId()),
+              String.format(
+                  "%s.timer.%s.out",
+                  timerReference.transform().getId(), timerReference.localName()),
               components.getPcollectionsMap()::containsKey);
-      components.putPcollections(
-          outputTimerPCollectionId, timerReference.collection().getPCollection());
+      components.putPcollections(outputTimerPCollectionId, timerCollectionSpec);
       TargetEncoding targetEncoding =
           addStageOutput(
               dataEndpoint,
               components,
-              PipelineNode.pCollection(
-                  outputTimerPCollectionId, timerReference.collection().getPCollection()));
+              PipelineNode.pCollection(outputTimerPCollectionId, timerCollectionSpec));
       outputTargetCodersBuilder.put(targetEncoding.getTarget(), targetEncoding.getCoder());
       components.putTransforms(
           timerReference.transform().getId(),
@@ -356,6 +392,7 @@ public class ProcessBundleDescriptors {
           components
               .getTransformsOrThrow(timerReference.transform().getId())
               .toBuilder()
+              .putInputs(timerReference.localName(), inputTimerPCollectionId)
               .putOutputs(timerReference.localName(), outputTimerPCollectionId)
               .build());
 
@@ -365,13 +402,32 @@ public class ProcessBundleDescriptors {
           TimerSpec.of(
               timerReference.transform().getId(),
               timerReference.localName(),
-              timerReference.collection().getId(),
+              inputTimerPCollectionId,
               targetEncoding.getTarget(),
               spec));
     }
     return idsToSpec.build().rowMap();
   }
 
+  private static String keyValueCoderId(
+      String keyCoderId, String valueCoderId, Components.Builder components) {
+    String id =
+        uniqueId(
+            String.format("kv-%s-%s", keyCoderId, valueCoderId),
+            components.getCodersMap()::containsKey);
+    RunnerApi.Coder.Builder coder;
+    components.putCoders(
+        id,
+        RunnerApi.Coder.newBuilder()
+            .setSpec(
+                RunnerApi.SdkFunctionSpec.newBuilder()
+                    .setSpec(RunnerApi.FunctionSpec.newBuilder().setUrn(ModelCoders.KV_CODER_URN)))
+            .addComponentCoderIds(keyCoderId)
+            .addComponentCoderIds(valueCoderId)
+            .build());
+    return id;
+  }
+
   @AutoValue
   abstract static class TargetEncoding {
     abstract BeamFnApi.Target getTarget();
