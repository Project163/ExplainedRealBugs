diff --git a/sdks/java/io/hadoop-format/src/test/java/org/apache/beam/sdk/io/hadoop/format/HadoopFormatIOCassandraTest.java b/sdks/java/io/hadoop-format/src/test/java/org/apache/beam/sdk/io/hadoop/format/HadoopFormatIOCassandraTest.java
index 6000c79d3fa..04e80b8be34 100644
--- a/sdks/java/io/hadoop-format/src/test/java/org/apache/beam/sdk/io/hadoop/format/HadoopFormatIOCassandraTest.java
+++ b/sdks/java/io/hadoop-format/src/test/java/org/apache/beam/sdk/io/hadoop/format/HadoopFormatIOCassandraTest.java
@@ -23,7 +23,14 @@ import com.datastax.driver.core.Session;
 import com.datastax.driver.core.SocketOptions;
 import com.datastax.driver.mapping.annotations.Column;
 import com.datastax.driver.mapping.annotations.Table;
+import java.io.File;
+import java.io.IOException;
 import java.io.Serializable;
+import java.net.ServerSocket;
+import java.net.URI;
+import java.nio.charset.Charset;
+import java.nio.file.Files;
+import java.nio.file.Path;
 import org.apache.beam.sdk.io.common.HashingFn;
 import org.apache.beam.sdk.testing.PAssert;
 import org.apache.beam.sdk.testing.TestPipeline;
@@ -58,8 +65,8 @@ public class HadoopFormatIOCassandraTest implements Serializable {
   private static final String CASSANDRA_PARTITIONER_CLASS_VALUE = "Murmur3Partitioner";
   private static final String CASSANDRA_KEYSPACE_PROPERTY = "cassandra.input.keyspace";
   private static final String CASSANDRA_COLUMNFAMILY_PROPERTY = "cassandra.input.columnfamily";
-  private static final String CASSANDRA_PORT = "9061";
-  private static final String CASSANDRA_NATIVE_PORT = "9042";
+  private static int cassandraPort;
+  private static int cassandraNativePort;
   private static transient Cluster cluster;
   private static transient Session session;
   private static final long TEST_DATA_ROW_COUNT = 10L;
@@ -67,6 +74,13 @@ public class HadoopFormatIOCassandraTest implements Serializable {
 
   @Rule public final transient TestPipeline p = TestPipeline.create();
 
+  private static int getFreeLocalPort() throws IOException {
+    ServerSocket serverSocket = new ServerSocket(0);
+    int port = serverSocket.getLocalPort();
+    serverSocket.close();
+    return port;
+  }
+
   /**
    * Test to read data from embedded Cassandra instance and verify whether data is read
    * successfully.
@@ -140,8 +154,8 @@ public class HadoopFormatIOCassandraTest implements Serializable {
    */
   private Configuration getConfiguration() {
     Configuration conf = new Configuration();
-    conf.set(CASSANDRA_NATIVE_PORT_PROPERTY, CASSANDRA_NATIVE_PORT);
-    conf.set(CASSANDRA_THRIFT_PORT_PROPERTY, CASSANDRA_PORT);
+    conf.set(CASSANDRA_NATIVE_PORT_PROPERTY, String.valueOf(cassandraNativePort));
+    conf.set(CASSANDRA_THRIFT_PORT_PROPERTY, String.valueOf(cassandraPort));
     conf.set(CASSANDRA_THRIFT_ADDRESS_PROPERTY, CASSANDRA_HOST);
     conf.set(CASSANDRA_PARTITIONER_CLASS_PROPERTY, CASSANDRA_PARTITIONER_CLASS_VALUE);
     conf.set(CASSANDRA_KEYSPACE_PROPERTY, CASSANDRA_KEYSPACE);
@@ -178,6 +192,9 @@ public class HadoopFormatIOCassandraTest implements Serializable {
 
   @BeforeClass
   public static void startCassandra() throws Exception {
+    cassandraPort = getFreeLocalPort();
+    cassandraNativePort = getFreeLocalPort();
+    replacePortsInConfFile();
     // Start the Embedded Cassandra Service
     cassandra.start();
     final SocketOptions socketOptions = new SocketOptions();
@@ -190,12 +207,21 @@ public class HadoopFormatIOCassandraTest implements Serializable {
             .addContactPoint(CASSANDRA_HOST)
             .withClusterName("beam")
             .withSocketOptions(socketOptions)
-            .withPort(Integer.valueOf(CASSANDRA_NATIVE_PORT))
+            .withPort(cassandraNativePort)
             .build();
     session = cluster.connect();
     createCassandraData();
   }
 
+  private static void replacePortsInConfFile() throws Exception {
+    URI uri = HadoopFormatIOCassandraTest.class.getResource("/cassandra.yaml").toURI();
+    Path cassandraYamlPath = new File(uri).toPath();
+    String content = new String(Files.readAllBytes(cassandraYamlPath), Charset.defaultCharset());
+    content = content.replaceAll("9042", String.valueOf(cassandraNativePort));
+    content = content.replaceAll("9061", String.valueOf(cassandraPort));
+    Files.write(cassandraYamlPath, content.getBytes(Charset.defaultCharset()));
+  }
+
   @AfterClass
   public static void stopEmbeddedCassandra() {
     session.close();
