diff --git a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/External.java b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/External.java
index bdc6efc115e..810a6e95138 100644
--- a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/External.java
+++ b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/External.java
@@ -21,6 +21,7 @@ import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Prec
 
 import java.io.IOException;
 import java.util.Collections;
+import java.util.HashMap;
 import java.util.Map;
 import java.util.concurrent.atomic.AtomicInteger;
 import javax.annotation.Nullable;
@@ -30,6 +31,7 @@ import org.apache.beam.model.pipeline.v1.RunnerApi;
 import org.apache.beam.sdk.Pipeline;
 import org.apache.beam.sdk.annotations.Experimental;
 import org.apache.beam.sdk.annotations.Experimental.Kind;
+import org.apache.beam.sdk.coders.Coder;
 import org.apache.beam.sdk.runners.AppliedPTransform;
 import org.apache.beam.sdk.transforms.Impulse;
 import org.apache.beam.sdk.transforms.PTransform;
@@ -139,6 +141,7 @@ public class External {
     @Nullable private transient RunnerApi.Components expandedComponents;
     @Nullable private transient RunnerApi.PTransform expandedTransform;
     @Nullable private transient Map<PCollection, String> externalPCollectionIdMap;
+    @Nullable private transient Map<Coder, String> externalCoderIdMap;
 
     ExpandableTransform(
         String urn,
@@ -207,6 +210,7 @@ public class External {
 
       RehydratedComponents rehydratedComponents =
           RehydratedComponents.forComponents(expandedComponents).withPipeline(p);
+
       ImmutableMap.Builder<TupleTag<?>, PCollection> outputMapBuilder = ImmutableMap.builder();
       expandedTransform
           .getOutputsMap()
@@ -222,6 +226,20 @@ public class External {
               });
       externalPCollectionIdMap = externalPCollectionIdMapBuilder.build();
 
+      Map<Coder, String> externalCoderIdMapBuilder = new HashMap<>();
+      expandedComponents
+          .getPcollectionsMap()
+          .forEach(
+              (pcolId, pCol) -> {
+                try {
+                  Coder coder = rehydratedComponents.getCoder(pCol.getCoderId());
+                  externalCoderIdMapBuilder.putIfAbsent(coder, pCol.getCoderId());
+                } catch (IOException e) {
+                  throw new RuntimeException("cannot rehydrate Coder.");
+                }
+              });
+      externalCoderIdMap = ImmutableMap.copyOf(externalCoderIdMapBuilder);
+
       return toOutputCollection(outputMapBuilder.build());
     }
 
@@ -247,6 +265,10 @@ public class External {
       return externalPCollectionIdMap;
     }
 
+    Map<Coder, String> getExternalCoderIdMap() {
+      return externalCoderIdMap;
+    }
+
     String getUrn() {
       return urn;
     }
diff --git a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/ExternalTranslation.java b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/ExternalTranslation.java
index 39be9105f26..c9e458764b2 100644
--- a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/ExternalTranslation.java
+++ b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/ExternalTranslation.java
@@ -25,10 +25,10 @@ import java.util.List;
 import java.util.Map;
 import javax.annotation.Nullable;
 import org.apache.beam.model.pipeline.v1.RunnerApi;
+import org.apache.beam.sdk.coders.Coder;
 import org.apache.beam.sdk.runners.AppliedPTransform;
 import org.apache.beam.sdk.transforms.PTransform;
 import org.apache.beam.sdk.values.PCollection;
-import org.apache.beam.sdk.values.PValue;
 import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.collect.ImmutableMap;
 
 /** Translating External transforms to proto. */
@@ -66,28 +66,24 @@ public class ExternalTranslation {
           (External.ExpandableTransform) appliedPTransform.getTransform();
       String nameSpace = expandableTransform.getNamespace();
       String impulsePrefix = expandableTransform.getImpulsePrefix();
-      ImmutableMap.Builder<String, String> pColRenameMapBuilder = ImmutableMap.builder();
       RunnerApi.PTransform expandedTransform = expandableTransform.getExpandedTransform();
       RunnerApi.Components expandedComponents = expandableTransform.getExpandedComponents();
       Map<PCollection, String> externalPCollectionIdMap =
           expandableTransform.getExternalPCollectionIdMap();
+      Map<Coder, String> externalCoderIdMap = expandableTransform.getExternalCoderIdMap();
 
-      for (PValue pcol : appliedPTransform.getInputs().values()) {
-        if (!(pcol instanceof PCollection)) {
-          throw new RuntimeException("unknown input type.");
-        }
-        pColRenameMapBuilder.put(
-            externalPCollectionIdMap.get(pcol), components.registerPCollection((PCollection) pcol));
+      ImmutableMap.Builder<String, String> pColRenameMapBuilder = ImmutableMap.builder();
+      for (Map.Entry<PCollection, String> entry : externalPCollectionIdMap.entrySet()) {
+        pColRenameMapBuilder.put(entry.getValue(), components.registerPCollection(entry.getKey()));
       }
-      for (PValue pcol : appliedPTransform.getOutputs().values()) {
-        if (!(pcol instanceof PCollection)) {
-          throw new RuntimeException("unknown input type.");
-        }
-        pColRenameMapBuilder.put(
-            externalPCollectionIdMap.get(pcol), components.registerPCollection((PCollection) pcol));
+      ImmutableMap<String, String> pColRenameMap = pColRenameMapBuilder.build();
+
+      ImmutableMap.Builder<String, String> coderRenameMapBuilder = ImmutableMap.builder();
+      for (Map.Entry<Coder, String> entry : externalCoderIdMap.entrySet()) {
+        coderRenameMapBuilder.put(entry.getValue(), components.registerCoder(entry.getKey()));
       }
+      ImmutableMap<String, String> coderRenameMap = coderRenameMapBuilder.build();
 
-      ImmutableMap<String, String> pColRenameMap = pColRenameMapBuilder.build();
       RunnerApi.Components.Builder mergingComponentsBuilder = RunnerApi.Components.newBuilder();
       for (Map.Entry<String, RunnerApi.Coder> entry :
           expandedComponents.getCodersMap().entrySet()) {
@@ -110,7 +106,14 @@ public class ExternalTranslation {
       for (Map.Entry<String, RunnerApi.PCollection> entry :
           expandedComponents.getPcollectionsMap().entrySet()) {
         if (entry.getKey().startsWith(nameSpace)) {
-          mergingComponentsBuilder.putPcollections(entry.getKey(), entry.getValue());
+          String coderId = entry.getValue().getCoderId();
+          mergingComponentsBuilder.putPcollections(
+              entry.getKey(),
+              entry
+                  .getValue()
+                  .toBuilder()
+                  .setCoderId(coderRenameMap.getOrDefault(coderId, coderId))
+                  .build());
         }
       }
       for (Map.Entry<String, RunnerApi.PTransform> entry :
