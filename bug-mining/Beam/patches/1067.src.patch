diff --git a/sdks/java/io/elasticsearch-tests/elasticsearch-tests-common/src/test/java/org/apache/beam/sdk/io/elasticsearch/ElasticSearchIOTestUtils.java b/sdks/java/io/elasticsearch-tests/elasticsearch-tests-common/src/test/java/org/apache/beam/sdk/io/elasticsearch/ElasticSearchIOTestUtils.java
index 47aaa73b109..9ca60f9f55c 100644
--- a/sdks/java/io/elasticsearch-tests/elasticsearch-tests-common/src/test/java/org/apache/beam/sdk/io/elasticsearch/ElasticSearchIOTestUtils.java
+++ b/sdks/java/io/elasticsearch-tests/elasticsearch-tests-common/src/test/java/org/apache/beam/sdk/io/elasticsearch/ElasticSearchIOTestUtils.java
@@ -244,11 +244,12 @@ class ElasticSearchIOTestUtils {
     return searchResult.path("hits").path("total").asInt();
   }
 
-  public static void setIndexMapping(RestClient restClient, String index) throws IOException {
+  public static void setIndexMapping(RestClient restClient, String index, String type) throws IOException {
     String endpoint = String.format("/%s", index);
     String requestString =
         String.format(
-            "{\"mappings\":{\"%s\":{\"properties\":{\"age\":{\"type\":\"long\"}}}}}", index);
+            "{\"mappings\":{\"%s\":{\"properties\":{\"age\":{\"type\":\"long\"},"
+                + " \"scientist\":{\"type\":\"text\"}, \"id\":{\"type\":\"long\"}}}}}", type);
     HttpEntity requestBody = new NStringEntity(requestString, ContentType.APPLICATION_JSON);
     Request request = new Request("PUT", endpoint);
     request.setEntity(requestBody);
diff --git a/sdks/java/io/elasticsearch-tests/elasticsearch-tests-common/src/test/java/org/apache/beam/sdk/io/elasticsearch/ElasticsearchIOTestCommon.java b/sdks/java/io/elasticsearch-tests/elasticsearch-tests-common/src/test/java/org/apache/beam/sdk/io/elasticsearch/ElasticsearchIOTestCommon.java
index b154764ec7a..f8629444db8 100644
--- a/sdks/java/io/elasticsearch-tests/elasticsearch-tests-common/src/test/java/org/apache/beam/sdk/io/elasticsearch/ElasticsearchIOTestCommon.java
+++ b/sdks/java/io/elasticsearch-tests/elasticsearch-tests-common/src/test/java/org/apache/beam/sdk/io/elasticsearch/ElasticsearchIOTestCommon.java
@@ -553,7 +553,8 @@ class ElasticsearchIOTestCommon implements Serializable {
   /** Tests partial updates with errors by adding some invalid info to test set. */
   void testWritePartialUpdateWithErrors() throws Exception {
     // put a mapping to simulate error of insertion
-    ElasticSearchIOTestUtils.setIndexMapping(restClient, connectionConfiguration.getIndex());
+    ElasticSearchIOTestUtils.setIndexMapping(restClient, connectionConfiguration.getIndex(),
+        connectionConfiguration.getType());
 
     // partial documents containing the ID and age only
     List<String> data = new ArrayList<>();
