diff --git a/sdks/python/apache_beam/io/fileio.py b/sdks/python/apache_beam/io/fileio.py
index d3d3a57fbf0..16e65610c18 100644
--- a/sdks/python/apache_beam/io/fileio.py
+++ b/sdks/python/apache_beam/io/fileio.py
@@ -308,74 +308,68 @@ def prefix_naming(prefix):
 
 _DEFAULT_FILE_NAME_TEMPLATE = (
     '{prefix}-{start}-{end}-{pane}-'
-    '{shard:05d}-{total_shards:05d}'
+    '{shard:05d}-of-{total_shards:05d}'
     '{suffix}{compression}')
 
 
-def destination_prefix_naming():
+def _format_shard(
+    window, pane, shard_index, total_shards, compression, prefix, suffix):
+  kwargs = {
+      'prefix': prefix,
+      'start': '',
+      'end': '',
+      'pane': '',
+      'shard': 0,
+      'total_shards': 0,
+      'suffix': '',
+      'compression': ''
+  }
+
+  if total_shards is not None and shard_index is not None:
+    kwargs['shard'] = int(shard_index)
+    kwargs['total_shards'] = int(total_shards)
+
+  if window != GlobalWindow():
+    kwargs['start'] = window.start.to_utc_datetime().isoformat()
+    kwargs['end'] = window.end.to_utc_datetime().isoformat()
+
+  # TODO(BEAM-3759): Add support for PaneInfo
+  # If the PANE is the ONLY firing in the window, we don't add it.
+  #if pane and not (pane.is_first and pane.is_last):
+  #  kwargs['pane'] = pane.index
+
+  if suffix:
+    kwargs['suffix'] = suffix
+
+  if compression:
+    kwargs['compression'] = '.%s' % compression
+
+  # Remove separators for unused template parts.
+  format = _DEFAULT_FILE_NAME_TEMPLATE
+  if shard_index is None:
+    format = format.replace('-{shard:05d}', '')
+  if total_shards is None:
+    format = format.replace('-of-{total_shards:05d}', '')
+  for name, value in kwargs.items():
+    if value in (None, ''):
+      format = format.replace('-{%s}' % name, '')
+
+  return format.format(**kwargs)
+
+
+def destination_prefix_naming(suffix=None):
   def _inner(window, pane, shard_index, total_shards, compression, destination):
-    kwargs = {
-        'prefix': str(destination),
-        'start': '',
-        'end': '',
-        'pane': '',
-        'shard': 0,
-        'total_shards': 0,
-        'suffix': '',
-        'compression': ''
-    }
-    if total_shards is not None and shard_index is not None:
-      kwargs['shard'] = int(shard_index)
-      kwargs['total_shards'] = int(total_shards)
-
-    if window != GlobalWindow():
-      kwargs['start'] = window.start.to_utc_datetime().isoformat()
-      kwargs['end'] = window.end.to_utc_datetime().isoformat()
-
-    # TODO(BEAM-3759): Add support for PaneInfo
-    # If the PANE is the ONLY firing in the window, we don't add it.
-    #if pane and not (pane.is_first and pane.is_last):
-    #  kwargs['pane'] = pane.index
-
-    if compression:
-      kwargs['compression'] = '.%s' % compression
-
-    return _DEFAULT_FILE_NAME_TEMPLATE.format(**kwargs)
+    prefix = str(destination)
+    return _format_shard(
+        window, pane, shard_index, total_shards, compression, prefix, suffix)
 
   return _inner
 
 
 def default_file_naming(prefix, suffix=None):
   def _inner(window, pane, shard_index, total_shards, compression, destination):
-    kwargs = {
-        'prefix': prefix,
-        'start': '',
-        'end': '',
-        'pane': '',
-        'shard': 0,
-        'total_shards': 0,
-        'suffix': '',
-        'compression': ''
-    }
-    if total_shards is not None and shard_index is not None:
-      kwargs['shard'] = int(shard_index)
-      kwargs['total_shards'] = int(total_shards)
-
-    if window != GlobalWindow():
-      kwargs['start'] = window.start.to_utc_datetime().isoformat()
-      kwargs['end'] = window.end.to_utc_datetime().isoformat()
-
-    # TODO(pabloem): Add support for PaneInfo
-    # If the PANE is the ONLY firing in the window, we don't add it.
-    #if pane and not (pane.is_first and pane.is_last):
-    #  kwargs['pane'] = pane.index
-
-    if compression:
-      kwargs['compression'] = '.%s' % compression
-    if suffix:
-      kwargs['suffix'] = suffix
-
-    return _DEFAULT_FILE_NAME_TEMPLATE.format(**kwargs)
+    return _format_shard(
+        window, pane, shard_index, total_shards, compression, prefix, suffix)
 
   return _inner
 
diff --git a/sdks/python/apache_beam/io/fileio_test.py b/sdks/python/apache_beam/io/fileio_test.py
index c13c104508b..473f9ec33f0 100644
--- a/sdks/python/apache_beam/io/fileio_test.py
+++ b/sdks/python/apache_beam/io/fileio_test.py
@@ -50,6 +50,7 @@ from apache_beam.testing.util import matches_all
 from apache_beam.transforms import trigger
 from apache_beam.transforms.window import FixedWindows
 from apache_beam.transforms.window import GlobalWindow
+from apache_beam.transforms.window import IntervalWindow
 
 warnings.filterwarnings(
     'ignore', category=FutureWarning, module='apache_beam.io.fileio_test')
@@ -662,13 +663,13 @@ class WriteFilesTest(_TestCaseWithTempDirCleanUp):
           cncf_files,
           matches_all([
               stringmatches.matches_regexp(
-                  '.*cncf-1970-01-01T00_00_00-1970-01-01T00_00_10--.*'),
+                  '.*cncf-1970-01-01T00_00_00-1970-01-01T00_00_10.*'),
               stringmatches.matches_regexp(
-                  '.*cncf-1970-01-01T00_00_10-1970-01-01T00_00_20--.*'),
+                  '.*cncf-1970-01-01T00_00_10-1970-01-01T00_00_20.*'),
               stringmatches.matches_regexp(
-                  '.*cncf-1970-01-01T00_00_20-1970-01-01T00_00_30--.*'),
+                  '.*cncf-1970-01-01T00_00_20-1970-01-01T00_00_30.*'),
               stringmatches.matches_regexp(
-                  '.*cncf-1970-01-01T00_00_30-1970-01-01T00_00_40--.*')
+                  '.*cncf-1970-01-01T00_00_30-1970-01-01T00_00_40.*')
           ]),
           label='verifyCNCFFiles')
 
@@ -676,16 +677,32 @@ class WriteFilesTest(_TestCaseWithTempDirCleanUp):
           apache_files,
           matches_all([
               stringmatches.matches_regexp(
-                  '.*apache-1970-01-01T00_00_00-1970-01-01T00_00_10--.*'),
+                  '.*apache-1970-01-01T00_00_00-1970-01-01T00_00_10.*'),
               stringmatches.matches_regexp(
-                  '.*apache-1970-01-01T00_00_10-1970-01-01T00_00_20--.*'),
+                  '.*apache-1970-01-01T00_00_10-1970-01-01T00_00_20.*'),
               stringmatches.matches_regexp(
-                  '.*apache-1970-01-01T00_00_20-1970-01-01T00_00_30--.*'),
+                  '.*apache-1970-01-01T00_00_20-1970-01-01T00_00_30.*'),
               stringmatches.matches_regexp(
-                  '.*apache-1970-01-01T00_00_30-1970-01-01T00_00_40--.*')
+                  '.*apache-1970-01-01T00_00_30-1970-01-01T00_00_40.*')
           ]),
           label='verifyApacheFiles')
 
+  def test_shard_naming(self):
+    namer = fileio.default_file_naming(prefix='/path/to/file', suffix='.txt')
+    self.assertEqual(
+        namer(GlobalWindow(), None, None, None, None, None),
+        '/path/to/file.txt')
+    self.assertEqual(
+        namer(GlobalWindow(), None, 1, 5, None, None),
+        '/path/to/file-00001-of-00005.txt')
+    self.assertEqual(
+        namer(GlobalWindow(), None, 1, 5, 'gz', None),
+        '/path/to/file-00001-of-00005.txt.gz')
+    self.assertEqual(
+        namer(IntervalWindow(0, 100), None, 1, 5, None, None),
+        '/path/to/file'
+        '-1970-01-01T00:00:00-1970-01-01T00:01:40-00001-of-00005.txt')
+
 
 if __name__ == '__main__':
   logging.getLogger().setLevel(logging.INFO)
