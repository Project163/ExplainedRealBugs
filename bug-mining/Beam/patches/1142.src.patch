diff --git a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/expansion/ExpansionServer.java b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/expansion/ExpansionServer.java
index d152e76d090..b8ec70c4ad5 100644
--- a/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/expansion/ExpansionServer.java
+++ b/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/expansion/ExpansionServer.java
@@ -38,6 +38,7 @@ public class ExpansionServer implements AutoCloseable {
   }
 
   private final String host;
+  private final int port;
   private final Server server;
   private final ExpansionService service;
 
@@ -49,11 +50,7 @@ public class ExpansionServer implements AutoCloseable {
             .addService(service)
             .build()
             .start();
-  }
-
-  /** Get the ExpansionService exposed by this {@link ExpansionServer}. */
-  public ExpansionService getService() {
-    return service;
+    this.port = server.getPort();
   }
 
   /** Get the host that this {@link ExpansionServer} is bound to. */
@@ -63,7 +60,7 @@ public class ExpansionServer implements AutoCloseable {
 
   /** Get the port that this {@link ExpansionServer} is bound to. */
   public int getPort() {
-    return server.getPort();
+    return port;
   }
 
   @Override
diff --git a/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/expansion/ExpansionServerTest.java b/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/expansion/ExpansionServerTest.java
new file mode 100644
index 00000000000..29370d9a38f
--- /dev/null
+++ b/runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/expansion/ExpansionServerTest.java
@@ -0,0 +1,48 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.beam.runners.core.construction.expansion;
+
+import static org.hamcrest.MatcherAssert.assertThat;
+import static org.hamcrest.Matchers.greaterThan;
+import static org.hamcrest.core.Is.is;
+
+import org.junit.Test;
+
+/** Tests for {@link ExpansionServer}. */
+public class ExpansionServerTest {
+
+  @Test
+  public void testStartupOnFreePort() throws Exception {
+    try (ExpansionServer expansionServer =
+        ExpansionServer.create(new ExpansionService(), "localhost", 0)) {
+      assertThat(expansionServer.getHost(), is("localhost"));
+      assertThat(expansionServer.getPort(), greaterThan(0));
+    }
+  }
+
+  @Test
+  public void testHostPortAvailableAfterClose() throws Exception {
+    ExpansionServer expansionServer;
+    try (ExpansionServer expServer =
+        ExpansionServer.create(new ExpansionService(), "localhost", 0)) {
+      expansionServer = expServer;
+    }
+    assertThat(expansionServer.getHost(), is("localhost"));
+    assertThat(expansionServer.getPort(), greaterThan(0));
+  }
+}
