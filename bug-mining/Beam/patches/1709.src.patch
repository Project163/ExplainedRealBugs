diff --git a/sdks/java/extensions/sql/datacatalog/src/main/java/org/apache/beam/sdk/extensions/sql/example/BeamSqlDataCatalogExample.java b/sdks/java/extensions/sql/datacatalog/src/main/java/org/apache/beam/sdk/extensions/sql/example/BeamSqlDataCatalogExample.java
index 81595cbf58d..fd56ff48845 100644
--- a/sdks/java/extensions/sql/datacatalog/src/main/java/org/apache/beam/sdk/extensions/sql/example/BeamSqlDataCatalogExample.java
+++ b/sdks/java/extensions/sql/datacatalog/src/main/java/org/apache/beam/sdk/extensions/sql/example/BeamSqlDataCatalogExample.java
@@ -68,17 +68,18 @@ public class BeamSqlDataCatalogExample {
 
     validateArgs(options);
 
-    pipeline
-        .apply(
-            "SQL Query",
-            SqlTransform.query(options.getQueryString())
-                .withDefaultTableProvider(
-                    "datacatalog",
-                    DataCatalogTableProvider.create(options.as(DataCatalogPipelineOptions.class))))
-        .apply("Convert to Strings", rowsToStrings())
-        .apply("Write output", TextIO.write().to(options.getOutputFilePrefix()));
+    try (DataCatalogTableProvider tableProvider =
+        DataCatalogTableProvider.create(options.as(DataCatalogPipelineOptions.class))) {
+      pipeline
+          .apply(
+              "SQL Query",
+              SqlTransform.query(options.getQueryString())
+                  .withDefaultTableProvider("datacatalog", tableProvider))
+          .apply("Convert to Strings", rowsToStrings())
+          .apply("Write output", TextIO.write().to(options.getOutputFilePrefix()));
 
-    pipeline.run().waitUntilFinish();
+      pipeline.run().waitUntilFinish();
+    }
   }
 
   private static MapElements<Row, String> rowsToStrings() {
diff --git a/sdks/java/extensions/sql/datacatalog/src/main/java/org/apache/beam/sdk/extensions/sql/meta/provider/datacatalog/DataCatalogTableProvider.java b/sdks/java/extensions/sql/datacatalog/src/main/java/org/apache/beam/sdk/extensions/sql/meta/provider/datacatalog/DataCatalogTableProvider.java
index 4a15974db52..445e5fbc31b 100644
--- a/sdks/java/extensions/sql/datacatalog/src/main/java/org/apache/beam/sdk/extensions/sql/meta/provider/datacatalog/DataCatalogTableProvider.java
+++ b/sdks/java/extensions/sql/datacatalog/src/main/java/org/apache/beam/sdk/extensions/sql/meta/provider/datacatalog/DataCatalogTableProvider.java
@@ -47,7 +47,7 @@ import org.apache.beam.vendor.calcite.v1_20_0.com.google.common.collect.Immutabl
 import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.MoreObjects;
 
 /** Uses DataCatalog to get the source type and schema for a table. */
-public class DataCatalogTableProvider extends FullNameTableProvider {
+public class DataCatalogTableProvider extends FullNameTableProvider implements AutoCloseable {
 
   private static final TableFactory PUBSUB_TABLE_FACTORY = new PubsubTableFactory();
   private static final TableFactory GCS_TABLE_FACTORY = new GcsTableFactory();
@@ -61,7 +61,6 @@ public class DataCatalogTableProvider extends FullNameTableProvider {
   private final TableFactory tableFactory;
 
   private DataCatalogTableProvider(DataCatalogClient dataCatalog, boolean truncateTimestamps) {
-
     this.tableCache = new HashMap<>();
     this.dataCatalog = dataCatalog;
     this.tableFactory =
@@ -174,4 +173,9 @@ public class DataCatalogTableProvider extends FullNameTableProvider {
 
     return tableBuilder.get().schema(schema).name(tableName).build();
   }
+
+  @Override
+  public void close() {
+    dataCatalog.close();
+  }
 }
diff --git a/sdks/java/extensions/sql/datacatalog/src/test/java/org/apache/beam/sdk/extensions/sql/meta/provider/datacatalog/DataCatalogBigQueryIT.java b/sdks/java/extensions/sql/datacatalog/src/test/java/org/apache/beam/sdk/extensions/sql/meta/provider/datacatalog/DataCatalogBigQueryIT.java
index 131fa11cf99..24c5fac5885 100644
--- a/sdks/java/extensions/sql/datacatalog/src/test/java/org/apache/beam/sdk/extensions/sql/meta/provider/datacatalog/DataCatalogBigQueryIT.java
+++ b/sdks/java/extensions/sql/datacatalog/src/test/java/org/apache/beam/sdk/extensions/sql/meta/provider/datacatalog/DataCatalogBigQueryIT.java
@@ -97,17 +97,18 @@ public class DataCatalogBigQueryIT {
           .as(BeamSqlPipelineOptions.class)
           .setPlannerName(queryPlanner.getCanonicalName());
 
-      PCollection<Row> result =
-          readPipeline.apply(
-              "query",
-              SqlTransform.query("SELECT id, name FROM " + tableId)
-                  .withDefaultTableProvider(
-                      "datacatalog",
-                      DataCatalogTableProvider.create(
-                          readPipeline.getOptions().as(DataCatalogPipelineOptions.class))));
+      try (DataCatalogTableProvider tableProvider =
+          DataCatalogTableProvider.create(
+              readPipeline.getOptions().as(DataCatalogPipelineOptions.class))) {
+        PCollection<Row> result =
+            readPipeline.apply(
+                "query",
+                SqlTransform.query("SELECT id, name FROM " + tableId)
+                    .withDefaultTableProvider("datacatalog", tableProvider));
 
-      PAssert.that(result).containsInAnyOrder(row(1, "name1"), row(2, "name2"), row(3, "name3"));
-      readPipeline.run().waitUntilFinish(Duration.standardMinutes(2));
+        PAssert.that(result).containsInAnyOrder(row(1, "name1"), row(2, "name2"), row(3, "name3"));
+        readPipeline.run().waitUntilFinish(Duration.standardMinutes(2));
+      }
     }
 
     private static Row row(long id, String name) {
diff --git a/sdks/java/extensions/sql/datacatalog/src/test/java/org/apache/beam/sdk/extensions/sql/meta/provider/datacatalog/DataCatalogGCSIT.java b/sdks/java/extensions/sql/datacatalog/src/test/java/org/apache/beam/sdk/extensions/sql/meta/provider/datacatalog/DataCatalogGCSIT.java
index ffd0d93737f..b780f5b8708 100644
--- a/sdks/java/extensions/sql/datacatalog/src/test/java/org/apache/beam/sdk/extensions/sql/meta/provider/datacatalog/DataCatalogGCSIT.java
+++ b/sdks/java/extensions/sql/datacatalog/src/test/java/org/apache/beam/sdk/extensions/sql/meta/provider/datacatalog/DataCatalogGCSIT.java
@@ -57,23 +57,24 @@ public class DataCatalogGCSIT implements Serializable {
             + ".`samples`"
             + ".`integ_test_small_csv_test_1`";
 
-    PCollection<Row> result =
-        pipeline.apply(
-            "query",
-            SqlTransform.query("SELECT id, name, type FROM " + gcsEntryId)
-                .withDefaultTableProvider(
-                    "dc",
-                    DataCatalogTableProvider.create(
-                        pipeline.getOptions().as(DataCatalogPipelineOptions.class))));
+    try (DataCatalogTableProvider tableProvider =
+        DataCatalogTableProvider.create(
+            pipeline.getOptions().as(DataCatalogPipelineOptions.class))) {
+      PCollection<Row> result =
+          pipeline.apply(
+              "query",
+              SqlTransform.query("SELECT id, name, type FROM " + gcsEntryId)
+                  .withDefaultTableProvider("dc", tableProvider));
 
-    pipeline.getOptions().as(DirectOptions.class).setBlockOnRun(true);
-    PAssert.that(result)
-        .containsInAnyOrder(
-            row(1, "customer1", "test"),
-            row(2, "customer2", "test"),
-            row(3, "customer1", "test"),
-            row(4, "customer2", "test"));
-    pipeline.run().waitUntilFinish(Duration.standardMinutes(2));
+      pipeline.getOptions().as(DirectOptions.class).setBlockOnRun(true);
+      PAssert.that(result)
+          .containsInAnyOrder(
+              row(1, "customer1", "test"),
+              row(2, "customer2", "test"),
+              row(3, "customer1", "test"),
+              row(4, "customer2", "test"));
+      pipeline.run().waitUntilFinish(Duration.standardMinutes(2));
+    }
   }
 
   private Row row(int id, String name, String type) {
