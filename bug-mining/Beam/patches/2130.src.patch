diff --git a/buildSrc/build.gradle b/buildSrc/build.gradle
index 2538e2295f3..618475c96f3 100644
--- a/buildSrc/build.gradle
+++ b/buildSrc/build.gradle
@@ -37,7 +37,7 @@ repositories {
 dependencies {
   compile gradleApi()
   compile localGroovy()
-  compile 'com.github.jengelman.gradle.plugins:shadow:4.0.3'
+  compile 'com.github.jengelman.gradle.plugins:shadow:5.2.0'
   compile "gradle.plugin.com.github.spotbugs.snom:spotbugs-gradle-plugin:4.5.0"
 
   runtime "net.ltgt.gradle:gradle-apt-plugin:0.21"                                                    // Enable a Java annotation processor
@@ -48,7 +48,7 @@ dependencies {
   runtime "gradle.plugin.com.github.blindpirate:gogradle:0.11.4"                                      // Enable Go code compilation
   runtime "gradle.plugin.com.palantir.gradle.docker:gradle-docker:0.22.0"                             // Enable building Docker containers
   runtime "gradle.plugin.com.dorongold.plugins:task-tree:1.5"                                       // Adds a 'taskTree' task to print task dependency tree
-  runtime "com.github.jengelman.gradle.plugins:shadow:4.0.3"                                          // Enable shading Java dependencies
+  runtime "com.github.jengelman.gradle.plugins:shadow:5.2.0"                                          // Enable shading Java dependencies
   runtime "ca.coglinc:javacc-gradle-plugin:2.4.0"                                                     // Enable the JavaCC parser generator
   runtime "net.linguica.gradle:maven-settings-plugin:0.5"
   runtime "gradle.plugin.io.pry.gradle.offline_dependencies:gradle-offline-dependencies-plugin:0.5.0" // Enable creating an offline repository
diff --git a/buildSrc/src/main/groovy/org/apache/beam/gradle/BeamModulePlugin.groovy b/buildSrc/src/main/groovy/org/apache/beam/gradle/BeamModulePlugin.groovy
index 05cf261c2f4..e58c1cfca51 100644
--- a/buildSrc/src/main/groovy/org/apache/beam/gradle/BeamModulePlugin.groovy
+++ b/buildSrc/src/main/groovy/org/apache/beam/gradle/BeamModulePlugin.groovy
@@ -1042,6 +1042,11 @@ class BeamModulePlugin implements Plugin<Project> {
           }
           testCompile.extendsFrom shadowTest
         }
+
+        // Ensure build task depends on shadowJar (required for shadow plugin >=4.0.4)
+        project.tasks.named('build').configure {
+          dependsOn project.tasks.named('shadowJar')
+        }
       }
 
       project.jar {
