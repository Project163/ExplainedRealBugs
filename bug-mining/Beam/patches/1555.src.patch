diff --git a/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/environment/ProcessManager.java b/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/environment/ProcessManager.java
index 65fcdf2a3a2..f1d88d03309 100644
--- a/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/environment/ProcessManager.java
+++ b/runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/environment/ProcessManager.java
@@ -47,19 +47,12 @@ public class ProcessManager {
   /** A list of all managers to ensure all processes shutdown on JVM exit . */
   private static final List<ProcessManager> ALL_PROCESS_MANAGERS = new ArrayList<>();
 
-  static {
-    // Install a shutdown hook to ensure processes are stopped/killed.
-    Runtime.getRuntime().addShutdownHook(ShutdownHook.create());
-  }
+  @VisibleForTesting static Thread shutdownHook = null;
 
   private final Map<String, Process> processes;
 
   public static ProcessManager create() {
-    synchronized (ALL_PROCESS_MANAGERS) {
-      ProcessManager processManager = new ProcessManager();
-      ALL_PROCESS_MANAGERS.add(processManager);
-      return processManager;
-    }
+    return new ProcessManager();
   }
 
   private ProcessManager() {
@@ -126,6 +119,7 @@ public class ProcessManager {
     return startProcess(id, command, args, env, outputFile);
   }
 
+  @SuppressFBWarnings("ST_WRITE_TO_STATIC_FROM_INSTANCE_METHOD")
   public RunningProcess startProcess(
       String id, String command, List<String> args, Map<String, String> env, File outputFile)
       throws IOException {
@@ -149,6 +143,15 @@ public class ProcessManager {
     LOG.debug("Attempting to start process with command: {}", pb.command());
     Process newProcess = pb.start();
     Process oldProcess = processes.put(id, newProcess);
+    synchronized (ALL_PROCESS_MANAGERS) {
+      if (!ALL_PROCESS_MANAGERS.contains(this)) {
+        ALL_PROCESS_MANAGERS.add(this);
+      }
+      if (shutdownHook == null) {
+        shutdownHook = ShutdownHook.create();
+        Runtime.getRuntime().addShutdownHook(shutdownHook);
+      }
+    }
     if (oldProcess != null) {
       stopProcess(id, oldProcess);
       stopProcess(id, newProcess);
@@ -159,10 +162,23 @@ public class ProcessManager {
   }
 
   /** Stops a previously started process identified by its unique id. */
+  @SuppressFBWarnings("ST_WRITE_TO_STATIC_FROM_INSTANCE_METHOD")
   public void stopProcess(String id) {
     checkNotNull(id, "Process id must not be null");
-    Process process = checkNotNull(processes.remove(id), "Process for id does not exist: " + id);
-    stopProcess(id, process);
+    try {
+      Process process = checkNotNull(processes.remove(id), "Process for id does not exist: " + id);
+      stopProcess(id, process);
+    } finally {
+      synchronized (ALL_PROCESS_MANAGERS) {
+        if (processes.isEmpty()) {
+          ALL_PROCESS_MANAGERS.remove(this);
+        }
+        if (ALL_PROCESS_MANAGERS.isEmpty() && shutdownHook != null) {
+          Runtime.getRuntime().removeShutdownHook(shutdownHook);
+          shutdownHook = null;
+        }
+      }
+    }
   }
 
   private void stopProcess(String id, Process process) {
diff --git a/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/environment/ProcessManagerTest.java b/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/environment/ProcessManagerTest.java
index d0c02c66328..a1377f33a33 100644
--- a/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/environment/ProcessManagerTest.java
+++ b/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/environment/ProcessManagerTest.java
@@ -21,7 +21,9 @@ import static org.hamcrest.Matchers.containsString;
 import static org.hamcrest.Matchers.is;
 import static org.junit.Assert.assertFalse;
 import static org.junit.Assert.assertNotNull;
+import static org.junit.Assert.assertNull;
 import static org.junit.Assert.assertThat;
+import static org.junit.Assert.assertTrue;
 import static org.junit.Assert.fail;
 
 import java.io.ByteArrayOutputStream;
@@ -157,4 +159,32 @@ public class ProcessManagerTest {
     // assertThat(outputStr, containsString("testing123"));
     assertFalse(ProcessManager.INHERIT_IO_FILE.exists());
   }
+
+  @Test
+  public void testShutdownHook() throws IOException {
+    ProcessManager processManager = ProcessManager.create();
+
+    // no process alive, no shutdown hook
+    assertNull(ProcessManager.shutdownHook);
+
+    processManager.startProcess(
+        "1", "bash", Arrays.asList("-c", "echo 'testing123'"), Collections.emptyMap());
+    // the shutdown hook will be created when process is started
+    assertNotNull(ProcessManager.shutdownHook);
+    // check the shutdown hook is registered
+    assertTrue(Runtime.getRuntime().removeShutdownHook(ProcessManager.shutdownHook));
+    // add back the shutdown hook
+    Runtime.getRuntime().addShutdownHook(ProcessManager.shutdownHook);
+
+    processManager.startProcess(
+        "2", "bash", Arrays.asList("-c", "echo 'testing123'"), Collections.emptyMap());
+
+    processManager.stopProcess("1");
+    // the shutdown hook will be not removed if there are still processes alive
+    assertNotNull(ProcessManager.shutdownHook);
+
+    processManager.stopProcess("2");
+    // the shutdown hook will be removed when there is no process alive
+    assertNull(ProcessManager.shutdownHook);
+  }
 }
