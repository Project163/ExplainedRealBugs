<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 11:03:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-7981] ParDo function wrapper doesn&apos;t support Iterable output types</title>
                <link>https://issues.apache.org/jira/browse/BEAM-7981</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;I believe the bug is in CallableWrapperDoFn.default_type_hints, which converts Iterable&lt;span class=&quot;error&quot;&gt;&amp;#91;str&amp;#93;&lt;/span&gt; to str.&lt;/p&gt;

&lt;p&gt;This test will be included (commented out) in &lt;a href=&quot;https://github.com/apache/beam/pull/9283&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/9283&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  def test_typed_callable_iterable_output(self):
    @typehints.with_input_types(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
    @typehints.with_output_types(typehints.Iterable[str])
    def do_fn(element):
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; [[str(element)] * 2]

    result = [1, 2] | beam.ParDo(do_fn)
    self.assertEqual([[&lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt;], [&lt;span class=&quot;code-quote&quot;&gt;&apos;2&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;2&apos;&lt;/span&gt;]], sorted(result))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Result:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
======================================================================
ERROR: test_typed_callable_iterable_output (apache_beam.typehints.typed_pipeline_test.MainInputTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/typehints/typed_pipeline_test.py&quot;&lt;/span&gt;, line 104, in test_typed_callable_iterable_output
    result = [1, 2] | beam.ParDo(do_fn)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/transforms/ptransform.py&quot;&lt;/span&gt;, line 519, in __ror__
    p.run().wait_until_finish()
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/pipeline.py&quot;&lt;/span&gt;, line 406, in run
    self._options).run(False)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/pipeline.py&quot;&lt;/span&gt;, line 419, in run
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.runner.run_pipeline(self, self._options)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/direct/direct_runner.py&quot;&lt;/span&gt;, line 129, in run_pipeline
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; runner.run_pipeline(pipeline, options)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 366, in run_pipeline
    default_environment=self._default_environment))
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 373, in run_via_runner_api
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.run_stages(stage_context, stages)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 455, in run_stages
    stage_context.safe_coders)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 733, in _run_stage
    result, splits = bundle_manager.process_bundle(data_input, data_output)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 1663, in process_bundle
    part, expected_outputs), part_inputs):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/lib/python3.7/concurrent/futures/_base.py&quot;&lt;/span&gt;, line 586, in result_iterator
    yield fs.pop().result()
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/lib/python3.7/concurrent/futures/_base.py&quot;&lt;/span&gt;, line 432, in result
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.__get_result()
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/lib/python3.7/concurrent/futures/_base.py&quot;&lt;/span&gt;, line 384, in __get_result
    raise self._exception
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/lib/python3.7/concurrent/futures/thread.py&quot;&lt;/span&gt;, line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 1663, in &amp;lt;lambda&amp;gt;
    part, expected_outputs), part_inputs):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 1601, in process_bundle
    result_future = self._worker_handler.control_conn.push(process_bundle_req)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 1080, in push
    response = self.worker.do_instruction(request)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/sdk_worker.py&quot;&lt;/span&gt;, line 343, in do_instruction
    request.instruction_id)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/sdk_worker.py&quot;&lt;/span&gt;, line 369, in process_bundle
    bundle_processor.process_bundle(instruction_id))
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/bundle_processor.py&quot;&lt;/span&gt;, line 593, in process_bundle
    data.ptransform_id].process_encoded(data.data)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/bundle_processor.py&quot;&lt;/span&gt;, line 143, in process_encoded
    self.output(decoded_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 256, in output
    cython.&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(Receiver, self.receivers[output_index]).receive(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 143, in receive
    self.consumer.process(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 435, in process
    self.output(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 256, in output
    cython.&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(Receiver, self.receivers[output_index]).receive(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 143, in receive
    self.consumer.process(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 594, in process
    delayed_application = self.dofn_receiver.receive(o)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/common.py&quot;&lt;/span&gt;, line 776, in receive
    self.process(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/common.py&quot;&lt;/span&gt;, line 782, in process
    self._reraise_augmented(exn)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/common.py&quot;&lt;/span&gt;, line 849, in _reraise_augmented
    raise_with_traceback(new_exn)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/virtualenvs/beam-py37/lib/python3.7/site-packages/&lt;span class=&quot;code-keyword&quot;&gt;future&lt;/span&gt;/utils/__init__.py&quot;&lt;/span&gt;, line 419, in raise_with_traceback
    raise exc.with_traceback(traceback)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/common.py&quot;&lt;/span&gt;, line 780, in process
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.do_fn_invoker.invoke_process(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/common.py&quot;&lt;/span&gt;, line 441, in invoke_process
    windowed_value, self.process_method(windowed_value.value))
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/common.py&quot;&lt;/span&gt;, line 919, in process_outputs
    self.main_receivers.receive(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 142, in receive
    self.update_counters_start(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 122, in update_counters_start
    self.opcounter.update_from(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/opcounters.py&quot;&lt;/span&gt;, line 196, in update_from
    self.do_sample(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/opcounters.py&quot;&lt;/span&gt;, line 214, in do_sample
    self.coder_impl.get_estimated_size_and_observables(windowed_value))
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/coders/coder_impl.py&quot;&lt;/span&gt;, line 1024, in get_estimated_size_and_observables
    value.value, nested=nested))
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/coders/coder_impl.py&quot;&lt;/span&gt;, line 220, in get_estimated_size_and_observables
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.estimate_size(value, nested), []
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/coders/coder_impl.py&quot;&lt;/span&gt;, line 212, in estimate_size
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self._get_nested_size(self._size_estimator(value), nested)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/coders/coders.py&quot;&lt;/span&gt;, line 135, in estimate_size
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; len(self.encode(value))
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/coders/coders.py&quot;&lt;/span&gt;, line 326, in encode
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; value.encode(&lt;span class=&quot;code-quote&quot;&gt;&apos;utf-8&apos;&lt;/span&gt;)
AttributeError: &lt;span class=&quot;code-quote&quot;&gt;&apos;list&apos;&lt;/span&gt; object has no attribute &lt;span class=&quot;code-quote&quot;&gt;&apos;encode&apos;&lt;/span&gt; [&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running &lt;span class=&quot;code-quote&quot;&gt;&apos;ParDo(CallableWrapperDoFn)&apos;&lt;/span&gt;]
-------------------- &amp;gt;&amp;gt; begin captured logging &amp;lt;&amp;lt; --------------------
root: INFO: Generating grammar tables from /usr/lib/python3.7/lib2to3/Grammar.txt
root: INFO: Generating grammar tables from /usr/lib/python3.7/lib2to3/PatternGrammar.txt
avro.schema: Level 5: Register &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; name &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.avro.file.Header&apos;&lt;/span&gt;
avro.schema: Level 5: Register &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; name &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.avro.file.magic&apos;&lt;/span&gt;
avro.schema: Level 5: Register &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; name &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.avro.file.sync&apos;&lt;/span&gt;
root: INFO: ==================== &amp;lt;function annotate_downstream_side_inputs at 0x7f3a39918158&amp;gt; ====================
root: DEBUG: 3 [1, 1, 1]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_CreatePInput0/Read_3\n  CreatePInput0/Read:beam:transform:read:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform__MaterializeValues0_5\n  _MaterializeValues0:beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function fix_side_input_pcoll_coders at 0x7f3a39918268&amp;gt; ====================
root: DEBUG: 3 [1, 1, 1]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_CreatePInput0/Read_3\n  CreatePInput0/Read:beam:transform:read:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform__MaterializeValues0_5\n  _MaterializeValues0:beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function lift_combiners at 0x7f3a399182f0&amp;gt; ====================
root: DEBUG: 3 [1, 1, 1]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_CreatePInput0/Read_3\n  CreatePInput0/Read:beam:transform:read:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform__MaterializeValues0_5\n  _MaterializeValues0:beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function expand_sdf at 0x7f3a39918378&amp;gt; ====================
root: DEBUG: 3 [1, 1, 1]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_CreatePInput0/Read_3\n  CreatePInput0/Read:beam:transform:read:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform__MaterializeValues0_5\n  _MaterializeValues0:beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function expand_gbk at 0x7f3a39918400&amp;gt; ====================
root: DEBUG: 3 [1, 1, 1]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_CreatePInput0/Read_3\n  CreatePInput0/Read:beam:transform:read:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform__MaterializeValues0_5\n  _MaterializeValues0:beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function sink_flattens at 0x7f3a39918510&amp;gt; ====================
root: DEBUG: 3 [1, 1, 1]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_CreatePInput0/Read_3\n  CreatePInput0/Read:beam:transform:read:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform__MaterializeValues0_5\n  _MaterializeValues0:beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function greedily_fuse at 0x7f3a39918598&amp;gt; ====================
root: DEBUG: 1 [3]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;((ref_AppliedPTransform_CreatePInput0/Read_3)+(ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4))+(ref_AppliedPTransform__MaterializeValues0_5)\n  CreatePInput0/Read:beam:transform:read:v1\nParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n_MaterializeValues0:beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function read_to_impulse at 0x7f3a39918620&amp;gt; ====================
root: DEBUG: 1 [4]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;((ref_AppliedPTransform_CreatePInput0/Read_3)+(ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4))+(ref_AppliedPTransform__MaterializeValues0_5)\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n_MaterializeValues0:beam:transform:pardo:v1\nCreatePInput0/Read/Impulse:beam:transform:impulse:v1\nCreatePInput0/Read:beam:transform:read_from_impulse_python:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function impulse_to_input at 0x7f3a399186a8&amp;gt; ====================
root: DEBUG: 1 [4]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;((ref_AppliedPTransform_CreatePInput0/Read_3)+(ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4))+(ref_AppliedPTransform__MaterializeValues0_5)\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n_MaterializeValues0:beam:transform:pardo:v1\nCreatePInput0/Read:beam:transform:read_from_impulse_python:v1\nCreatePInput0/Read/Impulse:beam:source:runner:0.1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function inject_timer_pcollections at 0x7f3a39918840&amp;gt; ====================
root: DEBUG: 1 [4]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;((ref_AppliedPTransform_CreatePInput0/Read_3)+(ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4))+(ref_AppliedPTransform__MaterializeValues0_5)\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n_MaterializeValues0:beam:transform:pardo:v1\nCreatePInput0/Read:beam:transform:read_from_impulse_python:v1\nCreatePInput0/Read/Impulse:beam:source:runner:0.1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function sort_stages at 0x7f3a399188c8&amp;gt; ====================
root: DEBUG: 1 [4]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;((ref_AppliedPTransform_CreatePInput0/Read_3)+(ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4))+(ref_AppliedPTransform__MaterializeValues0_5)\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n_MaterializeValues0:beam:transform:pardo:v1\nCreatePInput0/Read:beam:transform:read_from_impulse_python:v1\nCreatePInput0/Read/Impulse:beam:source:runner:0.1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function window_pcollection_coders at 0x7f3a39918950&amp;gt; ====================
root: DEBUG: 1 [4]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;((ref_AppliedPTransform_CreatePInput0/Read_3)+(ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4))+(ref_AppliedPTransform__MaterializeValues0_5)\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n_MaterializeValues0:beam:transform:pardo:v1\nCreatePInput0/Read:beam:transform:read_from_impulse_python:v1\nCreatePInput0/Read/Impulse:beam:source:runner:0.1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: Running ((ref_AppliedPTransform_CreatePInput0/Read_3)+(ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4))+(ref_AppliedPTransform__MaterializeValues0_5)
root: DEBUG: start &amp;lt;DoOperation _MaterializeValues0 output_tags=[&lt;span class=&quot;code-quote&quot;&gt;&apos;out&apos;&lt;/span&gt;], receivers=[ConsumerSet[_MaterializeValues0.out0, coder=WindowedValueCoder[FastPrimitivesCoder], len(consumers)=0]]&amp;gt;
root: DEBUG: start &amp;lt;DoOperation ParDo(CallableWrapperDoFn) output_tags=[&lt;span class=&quot;code-quote&quot;&gt;&apos;out&apos;&lt;/span&gt;], receivers=[SingletonConsumerSet[ParDo(CallableWrapperDoFn).out0, coder=WindowedValueCoder[StrUtf8Coder], len(consumers)=1]]&amp;gt;
root: DEBUG: start &amp;lt;ImpulseReadOperation receivers=[SingletonConsumerSet[CreatePInput0/Read.out0, coder=WindowedValueCoder[VarIntCoder], len(consumers)=1]]&amp;gt;
root: DEBUG: start &amp;lt;DataInputOperation receivers=[SingletonConsumerSet[CreatePInput0/Read/Impulse.out0, coder=WindowedValueCoder[BytesCoder], len(consumers)=1]]&amp;gt;
--------------------- &amp;gt;&amp;gt; end captured logging &amp;lt;&amp;lt; ---------------------

----------------------------------------------------------------------
Ran 1 test in 0.068s

FAILED (errors=1)

Error
Traceback (most recent call last):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/lib/python3.7/unittest/&lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;.py&quot;&lt;/span&gt;, line 59, in testPartExecutor
    yield
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/lib/python3.7/unittest/&lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;.py&quot;&lt;/span&gt;, line 615, in run
    testMethod()
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/typehints/typed_pipeline_test.py&quot;&lt;/span&gt;, line 104, in test_typed_callable_iterable_output
    result = [1, 2] | beam.ParDo(do_fn)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/transforms/ptransform.py&quot;&lt;/span&gt;, line 519, in __ror__
    p.run().wait_until_finish()
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/pipeline.py&quot;&lt;/span&gt;, line 406, in run
    self._options).run(False)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/pipeline.py&quot;&lt;/span&gt;, line 419, in run
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.runner.run_pipeline(self, self._options)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/direct/direct_runner.py&quot;&lt;/span&gt;, line 129, in run_pipeline
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; runner.run_pipeline(pipeline, options)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 366, in run_pipeline
    default_environment=self._default_environment))
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 373, in run_via_runner_api
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.run_stages(stage_context, stages)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 455, in run_stages
    stage_context.safe_coders)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 733, in _run_stage
    result, splits = bundle_manager.process_bundle(data_input, data_output)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 1663, in process_bundle
    part, expected_outputs), part_inputs):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/lib/python3.7/concurrent/futures/_base.py&quot;&lt;/span&gt;, line 586, in result_iterator
    yield fs.pop().result()
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/lib/python3.7/concurrent/futures/_base.py&quot;&lt;/span&gt;, line 432, in result
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.__get_result()
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/lib/python3.7/concurrent/futures/_base.py&quot;&lt;/span&gt;, line 384, in __get_result
    raise self._exception
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/lib/python3.7/concurrent/futures/thread.py&quot;&lt;/span&gt;, line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 1663, in &amp;lt;lambda&amp;gt;
    part, expected_outputs), part_inputs):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 1601, in process_bundle
    result_future = self._worker_handler.control_conn.push(process_bundle_req)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 1080, in push
    response = self.worker.do_instruction(request)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/sdk_worker.py&quot;&lt;/span&gt;, line 343, in do_instruction
    request.instruction_id)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/sdk_worker.py&quot;&lt;/span&gt;, line 369, in process_bundle
    bundle_processor.process_bundle(instruction_id))
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/bundle_processor.py&quot;&lt;/span&gt;, line 593, in process_bundle
    data.ptransform_id].process_encoded(data.data)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/bundle_processor.py&quot;&lt;/span&gt;, line 143, in process_encoded
    self.output(decoded_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 256, in output
    cython.&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(Receiver, self.receivers[output_index]).receive(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 143, in receive
    self.consumer.process(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 435, in process
    self.output(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 256, in output
    cython.&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(Receiver, self.receivers[output_index]).receive(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 143, in receive
    self.consumer.process(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 594, in process
    delayed_application = self.dofn_receiver.receive(o)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/common.py&quot;&lt;/span&gt;, line 776, in receive
    self.process(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/common.py&quot;&lt;/span&gt;, line 782, in process
    self._reraise_augmented(exn)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/common.py&quot;&lt;/span&gt;, line 849, in _reraise_augmented
    raise_with_traceback(new_exn)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/virtualenvs/beam-py37/lib/python3.7/site-packages/&lt;span class=&quot;code-keyword&quot;&gt;future&lt;/span&gt;/utils/__init__.py&quot;&lt;/span&gt;, line 419, in raise_with_traceback
    raise exc.with_traceback(traceback)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/common.py&quot;&lt;/span&gt;, line 780, in process
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.do_fn_invoker.invoke_process(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/common.py&quot;&lt;/span&gt;, line 441, in invoke_process
    windowed_value, self.process_method(windowed_value.value))
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/common.py&quot;&lt;/span&gt;, line 919, in process_outputs
    self.main_receivers.receive(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 142, in receive
    self.update_counters_start(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 122, in update_counters_start
    self.opcounter.update_from(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/opcounters.py&quot;&lt;/span&gt;, line 196, in update_from
    self.do_sample(windowed_value)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/runners/worker/opcounters.py&quot;&lt;/span&gt;, line 214, in do_sample
    self.coder_impl.get_estimated_size_and_observables(windowed_value))
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/coders/coder_impl.py&quot;&lt;/span&gt;, line 1024, in get_estimated_size_and_observables
    value.value, nested=nested))
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/coders/coder_impl.py&quot;&lt;/span&gt;, line 220, in get_estimated_size_and_observables
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.estimate_size(value, nested), []
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/coders/coder_impl.py&quot;&lt;/span&gt;, line 212, in estimate_size
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self._get_nested_size(self._size_estimator(value), nested)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/coders/coders.py&quot;&lt;/span&gt;, line 135, in estimate_size
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; len(self.encode(value))
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/google/home/ehudm/src/beam/sdks/python/apache_beam/coders/coders.py&quot;&lt;/span&gt;, line 326, in encode
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; value.encode(&lt;span class=&quot;code-quote&quot;&gt;&apos;utf-8&apos;&lt;/span&gt;)
Exception: &lt;span class=&quot;code-quote&quot;&gt;&apos;list&apos;&lt;/span&gt; object has no attribute &lt;span class=&quot;code-quote&quot;&gt;&apos;encode&apos;&lt;/span&gt; [&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running &lt;span class=&quot;code-quote&quot;&gt;&apos;ParDo(CallableWrapperDoFn)&apos;&lt;/span&gt;]
-------------------- &amp;gt;&amp;gt; begin captured logging &amp;lt;&amp;lt; --------------------
root: INFO: Generating grammar tables from /usr/lib/python3.7/lib2to3/Grammar.txt
root: INFO: Generating grammar tables from /usr/lib/python3.7/lib2to3/PatternGrammar.txt
avro.schema: Level 5: Register &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; name &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.avro.file.Header&apos;&lt;/span&gt;
avro.schema: Level 5: Register &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; name &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.avro.file.magic&apos;&lt;/span&gt;
avro.schema: Level 5: Register &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; name &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.avro.file.sync&apos;&lt;/span&gt;
root: INFO: ==================== &amp;lt;function annotate_downstream_side_inputs at 0x7f3a39918158&amp;gt; ====================
root: DEBUG: 3 [1, 1, 1]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_CreatePInput0/Read_3\n  CreatePInput0/Read:beam:transform:read:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform__MaterializeValues0_5\n  _MaterializeValues0:beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function fix_side_input_pcoll_coders at 0x7f3a39918268&amp;gt; ====================
root: DEBUG: 3 [1, 1, 1]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_CreatePInput0/Read_3\n  CreatePInput0/Read:beam:transform:read:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform__MaterializeValues0_5\n  _MaterializeValues0:beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function lift_combiners at 0x7f3a399182f0&amp;gt; ====================
root: DEBUG: 3 [1, 1, 1]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_CreatePInput0/Read_3\n  CreatePInput0/Read:beam:transform:read:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform__MaterializeValues0_5\n  _MaterializeValues0:beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function expand_sdf at 0x7f3a39918378&amp;gt; ====================
root: DEBUG: 3 [1, 1, 1]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_CreatePInput0/Read_3\n  CreatePInput0/Read:beam:transform:read:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform__MaterializeValues0_5\n  _MaterializeValues0:beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function expand_gbk at 0x7f3a39918400&amp;gt; ====================
root: DEBUG: 3 [1, 1, 1]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_CreatePInput0/Read_3\n  CreatePInput0/Read:beam:transform:read:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform__MaterializeValues0_5\n  _MaterializeValues0:beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function sink_flattens at 0x7f3a39918510&amp;gt; ====================
root: DEBUG: 3 [1, 1, 1]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_CreatePInput0/Read_3\n  CreatePInput0/Read:beam:transform:read:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ref_AppliedPTransform__MaterializeValues0_5\n  _MaterializeValues0:beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function greedily_fuse at 0x7f3a39918598&amp;gt; ====================
root: DEBUG: 1 [3]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;((ref_AppliedPTransform_CreatePInput0/Read_3)+(ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4))+(ref_AppliedPTransform__MaterializeValues0_5)\n  CreatePInput0/Read:beam:transform:read:v1\nParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n_MaterializeValues0:beam:transform:pardo:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function read_to_impulse at 0x7f3a39918620&amp;gt; ====================
root: DEBUG: 1 [4]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;((ref_AppliedPTransform_CreatePInput0/Read_3)+(ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4))+(ref_AppliedPTransform__MaterializeValues0_5)\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n_MaterializeValues0:beam:transform:pardo:v1\nCreatePInput0/Read/Impulse:beam:transform:impulse:v1\nCreatePInput0/Read:beam:transform:read_from_impulse_python:v1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function impulse_to_input at 0x7f3a399186a8&amp;gt; ====================
root: DEBUG: 1 [4]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;((ref_AppliedPTransform_CreatePInput0/Read_3)+(ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4))+(ref_AppliedPTransform__MaterializeValues0_5)\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n_MaterializeValues0:beam:transform:pardo:v1\nCreatePInput0/Read:beam:transform:read_from_impulse_python:v1\nCreatePInput0/Read/Impulse:beam:source:runner:0.1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function inject_timer_pcollections at 0x7f3a39918840&amp;gt; ====================
root: DEBUG: 1 [4]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;((ref_AppliedPTransform_CreatePInput0/Read_3)+(ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4))+(ref_AppliedPTransform__MaterializeValues0_5)\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n_MaterializeValues0:beam:transform:pardo:v1\nCreatePInput0/Read:beam:transform:read_from_impulse_python:v1\nCreatePInput0/Read/Impulse:beam:source:runner:0.1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function sort_stages at 0x7f3a399188c8&amp;gt; ====================
root: DEBUG: 1 [4]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;((ref_AppliedPTransform_CreatePInput0/Read_3)+(ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4))+(ref_AppliedPTransform__MaterializeValues0_5)\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n_MaterializeValues0:beam:transform:pardo:v1\nCreatePInput0/Read:beam:transform:read_from_impulse_python:v1\nCreatePInput0/Read/Impulse:beam:source:runner:0.1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: ==================== &amp;lt;function window_pcollection_coders at 0x7f3a39918950&amp;gt; ====================
root: DEBUG: 1 [4]
root: DEBUG: Stages: [&lt;span class=&quot;code-quote&quot;&gt;&apos;((ref_AppliedPTransform_CreatePInput0/Read_3)+(ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4))+(ref_AppliedPTransform__MaterializeValues0_5)\n  ParDo(CallableWrapperDoFn):beam:transform:pardo:v1\n_MaterializeValues0:beam:transform:pardo:v1\nCreatePInput0/Read:beam:transform:read_from_impulse_python:v1\nCreatePInput0/Read/Impulse:beam:source:runner:0.1\n  must follow: \n  downstream_side_inputs: &apos;&lt;/span&gt;]
root: INFO: Running ((ref_AppliedPTransform_CreatePInput0/Read_3)+(ref_AppliedPTransform_ParDo(CallableWrapperDoFn)_4))+(ref_AppliedPTransform__MaterializeValues0_5)
root: DEBUG: start &amp;lt;DoOperation _MaterializeValues0 output_tags=[&lt;span class=&quot;code-quote&quot;&gt;&apos;out&apos;&lt;/span&gt;], receivers=[ConsumerSet[_MaterializeValues0.out0, coder=WindowedValueCoder[FastPrimitivesCoder], len(consumers)=0]]&amp;gt;
root: DEBUG: start &amp;lt;DoOperation ParDo(CallableWrapperDoFn) output_tags=[&lt;span class=&quot;code-quote&quot;&gt;&apos;out&apos;&lt;/span&gt;], receivers=[SingletonConsumerSet[ParDo(CallableWrapperDoFn).out0, coder=WindowedValueCoder[StrUtf8Coder], len(consumers)=1]]&amp;gt;
root: DEBUG: start &amp;lt;ImpulseReadOperation receivers=[SingletonConsumerSet[CreatePInput0/Read.out0, coder=WindowedValueCoder[VarIntCoder], len(consumers)=1]]&amp;gt;
root: DEBUG: start &amp;lt;DataInputOperation receivers=[SingletonConsumerSet[CreatePInput0/Read/Impulse.out0, coder=WindowedValueCoder[BytesCoder], len(consumers)=1]]&amp;gt;
--------------------- &amp;gt;&amp;gt; end captured logging &amp;lt;&amp;lt; ---------------------
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13250896">BEAM-7981</key>
            <summary>ParDo function wrapper doesn&apos;t support Iterable output types</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="10722" iconUrl="https://issues.apache.org/jira/images/icons/statuses/generic.png" description="">Triage Needed</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="udim">Udi Meiri</assignee>
                                    <reporter username="udim">Udi Meiri</reporter>
                        <labels>
                    </labels>
                <created>Wed, 14 Aug 2019 23:17:26 +0000</created>
                <updated>Thu, 13 Apr 2023 10:58:19 +0000</updated>
                            <resolved>Wed, 22 Apr 2020 17:09:06 +0000</resolved>
                                                    <fixVersion>2.18.0</fixVersion>
                                    <component>sdk-py-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="10200">2h 50m</timespent>
                                <comments>
                            <comment id="16907699" author="altay" created="Thu, 15 Aug 2019 00:09:28 +0000"  >&lt;p&gt;Just for clarification, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=udim&quot; class=&quot;user-hover&quot; rel=&quot;udim&quot;&gt;udim&lt;/a&gt; are you planning to work on this?&lt;/p&gt;</comment>
                            <comment id="16907753" author="udim" created="Thu, 15 Aug 2019 02:06:00 +0000"  >&lt;p&gt;I have not committed to working on it yet.&lt;/p&gt;

</comment>
                            <comment id="16907813" author="altay" created="Thu, 15 Aug 2019 04:24:55 +0000"  >&lt;p&gt;Ack. Thank you.&lt;/p&gt;</comment>
                            <comment id="16969444" author="udim" created="Thu, 7 Nov 2019 17:33:50 +0000"  >&lt;p&gt;Fix has been merged.&lt;/p&gt;</comment>
                            <comment id="17085319" author="udim" created="Thu, 16 Apr 2020 23:48:59 +0000"  >&lt;p&gt;Missed a TODO in typed_pipeline_test&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 30 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z05ogg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>