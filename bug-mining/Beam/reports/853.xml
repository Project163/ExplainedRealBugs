<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 10:53:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-5813] ElasticSearchIOTest.testSplit is flaky</title>
                <link>https://issues.apache.org/jira/browse/BEAM-5813</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://builds.apache.org/job/beam_PostCommit_Java_GradleBuild/1724/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/beam_PostCommit_Java_GradleBuild/1724/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://scans.gradle.com/s/xpsswtkdf62so/tests/y3up3nrnbr2ns-opjrlgkblx2ku&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://scans.gradle.com/s/xpsswtkdf62so/tests/y3up3nrnbr2ns-opjrlgkblx2ku&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Wrong number of splits expected:&amp;lt;25&amp;gt; but was:&amp;lt;22&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13193279">BEAM-5813</key>
            <summary>ElasticSearchIOTest.testSplit is flaky</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10101" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">P1</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="echauchot">Etienne Chauchot</assignee>
                                    <reporter username="kenn">Kenneth Knowles</reporter>
                        <labels>
                            <label>flake</label>
                    </labels>
                <created>Mon, 22 Oct 2018 14:35:41 +0000</created>
                <updated>Sat, 16 May 2020 13:29:09 +0000</updated>
                            <resolved>Tue, 20 Nov 2018 10:17:39 +0000</resolved>
                                                    <fixVersion>2.9.0</fixVersion>
                                    <component>io-java-elasticsearch</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3000">50m</timespent>
                                <comments>
                            <comment id="16659055" author="echauchot" created="Mon, 22 Oct 2018 14:57:32 +0000"  >&lt;p&gt;Thanks for opening this ticket Kenn ! I&apos;ll take a look when I have a bit of time.&lt;/p&gt;</comment>
                            <comment id="16677855" author="echauchot" created="Wed, 7 Nov 2018 08:48:06 +0000"  >&lt;p&gt;I have very little availability to work on ES6 &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dattran.vn01&quot; class=&quot;user-hover&quot; rel=&quot;dattran.vn01&quot;&gt;dattran.vn01&lt;/a&gt; can you take a look at this flaky test? I cannot assign you the ticket. CC &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=timrobertson100&quot; class=&quot;user-hover&quot; rel=&quot;timrobertson100&quot;&gt;timrobertson100&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16686801" author="echauchot" created="Wed, 14 Nov 2018 16:16:16 +0000"  >&lt;p&gt;I submitted a PR that might correct that. Copying my assumption from the PR:&lt;br/&gt;
From time to time, the expected number of splits is higher that the actual number of sources after the split. But both expected and actual number of splits are determined using &lt;tt&gt;Math.ceil(indexSize/desiredBundleSize)&lt;/tt&gt;. My guess is that the difference is due to indexSize not being the same between the time when expected value is calculated and the time when it is actually estimated in split. This can have 2 reasons:&lt;br/&gt;
1- index size in ES has a part of random (says Elastic dev team)&lt;br/&gt;
2- refresh of the index was not finished when split is done.&lt;br/&gt;
=&amp;gt; This PR addresses point 2 because there is nothing we can do about point 1: test util requests to ES are issued &lt;b&gt;synchronously&lt;/b&gt; and they specify refresh=true which causes a refresh to be done but I&apos;m not sure that this refresh is synchronous. Instead use refresh=wait so that the request waits for the index refresh before returning.&lt;/p&gt;

&lt;p&gt;We need to wait some time (1 week?) to see the results of the postCommits to see if there is still flakiness on the overloaded jenkins (I cannot reproduce it on my machine).&lt;/p&gt;</comment>
                            <comment id="16693003" author="echauchot" created="Tue, 20 Nov 2018 10:17:39 +0000"  >&lt;p&gt;Within I week I saw no ES flakiness in postcommits, so PR &lt;a href=&quot;https://github.com/apache/beam/pull/7038&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/7038&lt;/a&gt;&#160;seems to have fixed this flakiness closing this ticket&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3zhjz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>