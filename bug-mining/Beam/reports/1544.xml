<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 11:04:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-8977] apache_beam.runners.interactive.display.pcoll_visualization_test.PCollectionVisualizationTest.test_dynamic_plotting_update_same_display is flaky</title>
                <link>https://issues.apache.org/jira/browse/BEAM-8977</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;Sample failure: &lt;br/&gt;
 &lt;a href=&quot;https://builds.apache.org/job/beam_PreCommit_Python_Phrase/1273/testReport/apache_beam.runners.interactive.display.pcoll_visualization_test/PCollectionVisualizationTest/test_dynamic_plotting_update_same_display/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/beam_PreCommit_Python_Phrase/1273/testReport/apache_beam.runners.interactive.display.pcoll_visualization_test/PCollectionVisualizationTest/test_dynamic_plotting_update_same_display/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Error Message&lt;/p&gt;


&lt;p&gt; IndexError: list index out of range&lt;/p&gt;

&lt;p&gt;Stacktrace&lt;br/&gt;
 self = &amp;lt;apache_beam.runners.interactive.display.pcoll_visualization_test.PCollectionVisualizationTest testMethod=test_dynamic_plotting_update_same_display&amp;gt;&lt;br/&gt;
 mocked_display_facets = &amp;lt;MagicMock name=&apos;display_facets&apos; id=&apos;139889868386376&apos;&amp;gt;&lt;/p&gt;

&lt;p&gt;@patch(&apos;apache_beam.runners.interactive.display.pcoll_visualization&apos;&lt;br/&gt;
 &apos;.PCollectionVisualization.display_facets&apos;)&lt;br/&gt;
 def test_dynamic_plotting_update_same_display(self,&lt;br/&gt;
 mocked_display_facets):&lt;br/&gt;
 fake_pipeline_result = runner.PipelineResult(runner.PipelineState.RUNNING)&lt;br/&gt;
 ie.current_env().set_pipeline_result(self._p, fake_pipeline_result)&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Starts async dynamic plotting that never ends in this test.&lt;br/&gt;
 h = pv.visualize(self._pcoll, dynamic_plotting_interval=0.001)&lt;/li&gt;
	&lt;li&gt;Blocking so the above async task can execute some iterations.&lt;br/&gt;
 time.sleep(1)&lt;/li&gt;
	&lt;li&gt;The first iteration doesn&apos;t provide updating_pv to display_facets.&lt;br/&gt;
 _, first_kwargs = mocked_display_facets.call_args_list&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 self.assertEqual(first_kwargs, {})&lt;/li&gt;
	&lt;li&gt;The following iterations use the same updating_pv to display_facets and so&lt;/li&gt;
	&lt;li&gt;on.&lt;br/&gt;
 &amp;gt; _, second_kwargs = mocked_display_facets.call_args_list&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&lt;br/&gt;
 E IndexError: list index out of range&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;apache_beam/runners/interactive/display/pcoll_visualization_test.py:105: IndexError&lt;/p&gt;

&lt;p&gt;Standard Output&lt;/p&gt;

&lt;p&gt;&amp;lt;IPython.core.display.HTML object&amp;gt;&lt;br/&gt;
 Standard Error&lt;br/&gt;
 WARNING:apache_beam.runners.interactive.interactive_environment:You cannot use Interactive Beam features when you are not in an interactive environment such as a Jupyter notebook or ipython terminal.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13274877">BEAM-8977</key>
            <summary>apache_beam.runners.interactive.display.pcoll_visualization_test.PCollectionVisualizationTest.test_dynamic_plotting_update_same_display is flaky</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ningk">Ning</assignee>
                                    <reporter username="tvalentyn">Valentyn Tymofieiev</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Dec 2019 02:17:56 +0000</created>
                <updated>Sat, 16 May 2020 13:50:03 +0000</updated>
                            <resolved>Fri, 3 Jan 2020 23:38:04 +0000</resolved>
                                                    <fixVersion>Not applicable</fixVersion>
                                    <component>test-failures</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="10200">2h 50m</timespent>
                                <comments>
                            <comment id="16998474" author="ningk" created="Tue, 17 Dec 2019 18:34:33 +0000"  >&lt;p&gt;The flakiness is caused by indeterministic execution of asynchronous tasks to be tested.&lt;/p&gt;

&lt;p&gt;Affected by the performance of the system executing the tests, it&apos;s possible that during the 1 second sleep, the asynchronous task is not executed at all.&lt;/p&gt;

&lt;p&gt;However, adding a list length check, increasing the sleeping time or setting an await with timeout will not resolve the test flakiness issue.&lt;/p&gt;

&lt;p&gt;If the asynchronous scheduled task is not executed for at least 2 iterations, there is nothing to be tested and a failure/success will not help with the tests.&lt;/p&gt;

&lt;p&gt;I&apos;ll remove the flaky unit test since it&apos;s flaky in its nature. Mocking such asynchronous mechanism doesn&apos;t give us anything, so we will not test the asynchronous mechanism.&lt;/p&gt;

&lt;p&gt;I&apos;ll add a different test for the underlying asynchronous task and test the logic synchronously.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17007838" author="tvalentyn" created="Fri, 3 Jan 2020 23:37:45 +0000"  >&lt;p&gt;Thanks, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ningk&quot; class=&quot;user-hover&quot; rel=&quot;ningk&quot;&gt;ningk&lt;/a&gt;! Let&apos;s reopen this if the error happens again.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 45 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z09qk0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>