<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 11:15:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-11797] Flaky interactive test in Precommit</title>
                <link>https://issues.apache.org/jira/browse/BEAM-11797</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description></description>
                <environment></environment>
        <key id="13358048">BEAM-11797</key>
            <summary>Flaky interactive test in Precommit</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ningk">Ning</assignee>
                                    <reporter username="robertwb">Robert Bradshaw</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Feb 2021 01:42:42 +0000</created>
                <updated>Thu, 13 Jan 2022 21:49:44 +0000</updated>
                            <resolved>Tue, 30 Mar 2021 23:36:21 +0000</resolved>
                                                    <fixVersion>Missing</fixVersion>
                                    <component>sdk-py-core</component>
                    <component>testing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="10200">2h 50m</timespent>
                                <comments>
                            <comment id="17282831" author="robertwb" created="Thu, 11 Feb 2021 01:43:19 +0000"  >&lt;p&gt;self = &amp;lt;apache_beam.runners.interactive.utils_test.ProgressIndicatorTest testMethod=test_progress_in_HTML_JS_when_in_notebook&amp;gt;&lt;br/&gt;
mocked_display_javascript = &amp;lt;MagicMock name=&apos;display_javascript&apos; id=&apos;139743144054856&apos;&amp;gt;&lt;br/&gt;
mocked_display = &amp;lt;MagicMock name=&apos;display&apos; id=&apos;139743144055136&apos;&amp;gt;&lt;br/&gt;
mocked_javascript = &amp;lt;MagicMock name=&apos;Javascript&apos; id=&apos;139743144054912&apos;&amp;gt;&lt;br/&gt;
mocked_html = &amp;lt;MagicMock name=&apos;HTML&apos; id=&apos;139742992798328&apos;&amp;gt;&lt;/p&gt;

&lt;p&gt;    @patch(&apos;IPython.core.display.HTML&apos;)&lt;br/&gt;
    @patch(&apos;IPython.core.display.Javascript&apos;)&lt;br/&gt;
    @patch(&apos;IPython.core.display.display&apos;)&lt;br/&gt;
    @patch(&apos;IPython.core.display.display_javascript&apos;)&lt;br/&gt;
    def test_progress_in_HTML_JS_when_in_notebook(&lt;br/&gt;
        self,&lt;br/&gt;
        mocked_display_javascript,&lt;br/&gt;
        mocked_display,&lt;br/&gt;
        mocked_javascript,&lt;br/&gt;
        mocked_html):&lt;/p&gt;

&lt;p&gt;      ie.current_env()._is_in_notebook = True&lt;br/&gt;
      mocked_display.assert_not_called()&lt;br/&gt;
      mocked_display_javascript.assert_not_called()&lt;/p&gt;

&lt;p&gt;      @utils.progress_indicated&lt;br/&gt;
      def progress_indicated_dummy():&lt;br/&gt;
        mocked_display.assert_called_once()&lt;br/&gt;
        mocked_html.assert_called_once()&lt;/p&gt;

&lt;p&gt;&amp;gt;     progress_indicated_dummy()&lt;/p&gt;

&lt;p&gt;apache_beam/runners/interactive/utils_test.py:232: &lt;br/&gt;
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ &lt;br/&gt;
apache_beam/runners/interactive/utils.py:228: in run_within_progress_indicator&lt;br/&gt;
    return func(*args, **kwargs)&lt;br/&gt;
apache_beam/runners/interactive/utils_test.py:229: in progress_indicated_dummy&lt;br/&gt;
    mocked_display.assert_called_once()&lt;br/&gt;
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ &lt;/p&gt;

&lt;p&gt;_mock_self = &amp;lt;MagicMock name=&apos;display&apos; id=&apos;139743144055136&apos;&amp;gt;&lt;/p&gt;

&lt;p&gt;    def assert_called_once(_mock_self):&lt;br/&gt;
        &quot;&quot;&quot;assert that the mock was called only once.&lt;br/&gt;
        &quot;&quot;&quot;&lt;br/&gt;
        self = _mock_self&lt;br/&gt;
        if not self.call_count == 1:&lt;br/&gt;
            msg = (&quot;Expected &apos;%s&apos; to have been called once. Called %s times.&quot; %&lt;br/&gt;
                   (self._mock_name or &apos;mock&apos;, self.call_count))&lt;br/&gt;
&amp;gt;           raise AssertionError(msg)&lt;br/&gt;
E           AssertionError: Expected &apos;display&apos; to have been called once. Called 2 times.&lt;/p&gt;

&lt;p&gt;/usr/lib/python3.6/unittest/mock.py:795: AssertionError&lt;/p&gt;</comment>
                            <comment id="17299327" author="tvalentyn" created="Thu, 11 Mar 2021 06:01:38 +0000"  >&lt;p&gt;still happening: &lt;a href=&quot;https://ci-beam.apache.org/job/beam_PreCommit_Python_Commit/17604/testReport/junit/apache_beam.runners.interactive.utils_test/ProgressIndicatorTest/test_progress_in_HTML_JS_when_in_notebook/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-beam.apache.org/job/beam_PreCommit_Python_Commit/17604/testReport/junit/apache_beam.runners.interactive.utils_test/ProgressIndicatorTest/test_progress_in_HTML_JS_when_in_notebook/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17300537" author="ningk" created="Fri, 12 Mar 2021 18:33:54 +0000"  >&lt;p&gt;Working on it now.&lt;/p&gt;</comment>
                            <comment id="17300602" author="tvalentyn" created="Fri, 12 Mar 2021 20:50:15 +0000"  >&lt;p&gt;Thanks, Ning!&lt;/p&gt;</comment>
                            <comment id="17311116" author="tvalentyn" created="Tue, 30 Mar 2021 04:30:54 +0000"  >&lt;p&gt;Looks like it is still happening: &lt;a href=&quot;https://ci-beam.apache.org/job/beam_PreCommit_Python_Commit/17921/testReport/junit/apache_beam.runners.interactive.utils_test/ProgressIndicatorTest/test_progress_in_HTML_JS_when_in_notebook/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-beam.apache.org/job/beam_PreCommit_Python_Commit/17921/testReport/junit/apache_beam.runners.interactive.utils_test/ProgressIndicatorTest/test_progress_in_HTML_JS_when_in_notebook/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17311758" author="ningk" created="Tue, 30 Mar 2021 19:49:31 +0000"  >&lt;p&gt;Find the root cause: assert_called_with does not mean `asserting has been called with` but `asserting the last call is`. And there is an IPythonLogHandler that emits logs from time to time that is not so deterministic when running on a Jenkins environment. The handler uses the same display module that is used by the decorator in test, causing the flakiness. Changed `assert_called_with` with `assert_any_call` to fix it.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 32 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0nkvc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>