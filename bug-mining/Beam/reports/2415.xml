<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 11:17:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-12459] Watch does not properly advance the watermark by default</title>
                <link>https://issues.apache.org/jira/browse/BEAM-12459</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;Assigning to Luke who has made substantial changes to this class most recently.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;It appears after investigation that when using Watch in the default configuration, the global watermark is not advanced properly, even though Watch documentation claims it should be (&lt;a href=&quot;https://github.com/apache/beam/blob/8922c1cf23c093262af9e4570d69947a9a749506/sdks/java/core/src/main/java/org/apache/beam/sdk/transforms/Watch.java#L118&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/8922c1cf23c093262af9e4570d69947a9a749506/sdks/java/core/src/main/java/org/apache/beam/sdk/transforms/Watch.java#L118&lt;/a&gt;). The below is example code using Watch that will not advance the watermark, but should:&lt;/p&gt;

&lt;p&gt;```&lt;br/&gt;
 Watch.growthOf(&lt;br/&gt;
 new PollFn&amp;lt;Integer, Integer&amp;gt;() {&lt;br/&gt;
 &#160; &#160; @Override&lt;br/&gt;
 &#160; &#160; public PollResult&amp;lt;Partition&amp;gt; apply(TopicPath element, Context c)&lt;/p&gt;

{ &#160; &#160; &#160; &#160; return PollResult.incomplete(Instant.now(), List.of(0)); &#160; &#160; }

&lt;p&gt;})&lt;br/&gt;
 .withPollInterval(...)&lt;br/&gt;
 .withTerminationPerInput(Watch.Growth.never());&lt;br/&gt;
 ```&lt;/p&gt;

&lt;p&gt;I&apos;ve been advised that changing the return statement to `return PollResult.incomplete(Instant.now(), List.of(0)).withWatermark(Instant.now());` will resolve this issue, but the `withWatermark` function is commented as &quot;By default, the watermark for a particular input is computed from a poll result as &quot;earliest timestamp of new elements in this poll result&quot;. It can also be set explicitly via {@link Growth.PollResult#withWatermark} if the {@link Growth.PollFn} can provide a more optimistic estimate.&quot;. The goal is not to provide a more optimistic estimate, but to allow any advancement at all. If withWatermark is needed to close windows, this function should be required (or at least more prominent in all example code).&lt;/p&gt;</description>
                <environment></environment>
        <key id="13382732">BEAM-12459</key>
            <summary>Watch does not properly advance the watermark by default</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lcwik">Luke Cwik</assignee>
                                    <reporter username="dpcollins-google">Daniel Collins</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 Jun 2021 14:48:41 +0000</created>
                <updated>Mon, 14 Jun 2021 07:47:40 +0000</updated>
                            <resolved>Fri, 11 Jun 2021 04:28:40 +0000</resolved>
                                                    <fixVersion>2.32.0</fixVersion>
                                    <component>sdk-java-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="7800">2h 10m</timespent>
                                <comments>
                            <comment id="17359473" author="lcwik" created="Tue, 8 Jun 2021 17:01:20 +0000"  >&lt;p&gt;It looks as though during the migration to being an SDF this line of logic was missed: &lt;a href=&quot;https://github.com/apache/beam/blame/413d8524f58604a3062a8eea07c1dcd1301e2f83/sdks/java/core/src/main/java/org/apache/beam/sdk/transforms/Watch.java#L1053&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blame/413d8524f58604a3062a8eea07c1dcd1301e2f83/sdks/java/core/src/main/java/org/apache/beam/sdk/transforms/Watch.java#L1053&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12311020" key="com.atlassian.jira.plugin.system.customfieldtypes:url">
                        <customfieldname>External issue URL</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[http://b/186174854]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 22 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0rrjc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>