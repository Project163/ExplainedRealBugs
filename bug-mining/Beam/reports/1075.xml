<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 10:57:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-6266] Newest AWS SDK causes errors on startup without usage</title>
                <link>https://issues.apache.org/jira/browse/BEAM-6266</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;The S3 filesystem implementation in Beam logs a message like this if it is linked in:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2018-12-18 22:17:55 INFO&#160; S3FileSystem:104 - The AWS S3 Beam extension was included in &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; build, but the awsRegion flag was not specified. If you don&apos;t plan to use S3, then ignore &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; message.&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Previous versions of the AWS libraries seemed to allow you to &lt;tt&gt;ignore this message&lt;/tt&gt;&#160;, but the newest libraries throw an exception:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.beam.sdk.Pipeline.create Pipeline.java: 145
org.apache.beam.sdk.PipelineRunner.fromOptions PipelineRunner.java: 47
org.apache.beam.sdk.io.FileSystems.setDefaultPipelineOptions FileSystems.java: 482
org.apache.beam.sdk.io.FileSystems.verifySchemesAreUnique FileSystems.java: 492
org.apache.beam.sdk.io.aws.s3.S3FileSystemRegistrar.fromOptions S3FileSystemRegistrar.java: 39
org.apache.beam.sdk.io.aws.s3.S3FileSystem.&amp;lt;init&amp;gt; S3FileSystem.java: 108
org.apache.beam.sdk.io.aws.s3.S3FileSystem.buildAmazonS3Client S3FileSystem.java: 122
com.amazonaws.client.builder.AwsClientBuilder.withRegion AwsClientBuilder.java: 245
com.amazonaws.client.builder.AwsClientBuilder.getRegionObject AwsClientBuilder.java: 258
com.amazonaws.SdkClientException: Could not find region information &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&apos;&lt;/span&gt; in SDK metadata.
retryable: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;(this stack trace is from 2.6.0, but master is also affected)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The root cause is this code that gets run unconditionally (&lt;a href=&quot;https://github.com/apache/beam/blob/master/sdks/java/io/amazon-web-services/src/main/java/org/apache/beam/sdk/io/aws/s3/DefaultS3ClientBuilderFactory.java#L42):&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/master/sdks/java/io/amazon-web-services/src/main/java/org/apache/beam/sdk/io/aws/s3/DefaultS3ClientBuilderFactory.java#L42):&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
builder = builder.withRegion(s3Options.getAwsRegion());&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Unfortunately the latest AWS library will throw if you pass &lt;tt&gt;null&lt;/tt&gt; to &lt;tt&gt;withRegion&lt;/tt&gt;. It previously did nothing. This release of the&#160;AWS java sdk added the error check: &lt;a href=&quot;https://github.com/aws/aws-sdk-java/commit/8f07cc35eec9047f7cfdbc7de3abc6d4327b08d0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/aws/aws-sdk-java/commit/8f07cc35eec9047f7cfdbc7de3abc6d4327b08d0&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13205237">BEAM-6266</key>
            <summary>Newest AWS SDK causes errors on startup without usage</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mikekap">Mike Kaplinskiy</assignee>
                                    <reporter username="mikekap">Mike Kaplinskiy</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 Dec 2018 22:48:06 +0000</created>
                <updated>Sat, 16 May 2020 14:00:59 +0000</updated>
                            <resolved>Mon, 25 Mar 2019 14:17:40 +0000</resolved>
                                    <version>2.6.0</version>
                    <version>2.7.0</version>
                    <version>2.8.0</version>
                    <version>2.9.0</version>
                                    <fixVersion>2.12.0</fixVersion>
                                    <component>io-java-aws</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="16732370" author="stevel@apache.org" created="Wed, 2 Jan 2019 19:48:41 +0000"  >&lt;p&gt;AWS SDK updates have a tendency to print things on new releases (warnings, stack traces  &amp;amp;c): changes which can sneak past system tests which don&apos;t actually look for new messages. Sometimes they are bugs in the SDK to get fixed, sometimes they&apos;re actual issues in your code.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;The latest S3A update process tells people to &lt;a href=&quot;https://github.com/apache/hadoop/blob/trunk/hadoop-tools/hadoop-aws/src/site/markdown/tools/hadoop-aws/testing.md#-qualifying-an-aws-sdk-update&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;look through the logs&lt;/a&gt; to catch this.&lt;/li&gt;
	&lt;li&gt;And we don&apos;t use the builder mechanism to create the client, just the deprecated one on the basis that&apos;s its actually better to work with&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="16746453" author="iemejia" created="Fri, 18 Jan 2019 16:29:28 +0000"  >&lt;p&gt;Are you interested in contributing a fix for this one &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mikekap&quot; class=&quot;user-hover&quot; rel=&quot;mikekap&quot;&gt;mikekap&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="16749310" author="mikekap" created="Tue, 22 Jan 2019 23:56:27 +0000"  >&lt;p&gt;I could take a stab at it.&#160;The&#160;solution I&apos;m thinking of is to make &lt;tt&gt;this.amazonS3 = null;&lt;/tt&gt;&#160;when the right flags aren&apos;t provided. We can then &lt;tt&gt;Preconditions.checkState&lt;/tt&gt;&#160;in all the APIs to give a good error message. Does that sound reasonable &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=iemejia&quot; class=&quot;user-hover&quot; rel=&quot;iemejia&quot;&gt;iemejia&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="16762235" author="udim" created="Wed, 6 Feb 2019 23:23:05 +0000"  >&lt;p&gt;Also here: &lt;a href=&quot;https://stackoverflow.com/questions/54046835/apache-beam-s3-filesystem-extension-always-requires-aws-region-input-even-in-oth&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/questions/54046835/apache-beam-s3-filesystem-extension-always-requires-aws-region-input-even-in-oth&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16799462" author="dmcintosh" created="Sat, 23 Mar 2019 00:41:58 +0000"  >&lt;p&gt;This also breaks unit tests in TestPipeline.create() and TestPipeline.testingPipelineOptions() which is tricky to try and work around.&lt;/p&gt;

&lt;p&gt;The error does seem to be around the AWS SDK not finding a region from any source. Setting the AWS_REGION environment variable allows it to work without needing to set the region on the PipelineOptions.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 34 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|u003w0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>