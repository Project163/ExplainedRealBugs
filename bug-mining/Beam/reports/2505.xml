<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 11:19:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-12781] SDFBoundedSourceReader behaves much slower compared with the original behavior of BoundedSource</title>
                <link>https://issues.apache.org/jira/browse/BEAM-12781</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description></description>
                <environment></environment>
        <key id="13396408">BEAM-12781</key>
            <summary>SDFBoundedSourceReader behaves much slower compared with the original behavior of BoundedSource</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10101" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">P1</priority>
                        <status id="10722" iconUrl="https://issues.apache.org/jira/images/icons/statuses/generic.png" description="">Triage Needed</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pabloem">Pablo Estrada</assignee>
                                    <reporter username="pabloem">Pablo Estrada</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 Aug 2021 17:18:41 +0000</created>
                <updated>Thu, 13 Apr 2023 11:06:53 +0000</updated>
                            <resolved>Fri, 1 Oct 2021 21:16:33 +0000</resolved>
                                                    <fixVersion>2.34.0</fixVersion>
                                    <component>io-py-common</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="18000">5h</timespent>
                                <comments>
                            <comment id="17402329" author="pabloem" created="Fri, 20 Aug 2021 17:19:25 +0000"  >&lt;p&gt;Okay, I finally have a reasonable theory of what&apos;s going on here. I believe the issue is caused by the separation of the&#160;&lt;tt&gt;split&lt;/tt&gt;&#160;call of a BoundedSource into a different stage. In unified worker it seems like we&apos;re pickling the intermediate result for this.&lt;/p&gt;

&lt;p&gt;Profiling from Runner V2 shows the slowest call being pickle.dumps:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;{{In &lt;span class=&quot;error&quot;&gt;&amp;#91;8&amp;#93;&lt;/span&gt;: p.sort_stats(&apos;tottime&apos;).print_stats()&lt;br/&gt;
Tue Aug 17 11:47:42 2021    profilingmofilingba/cpu_profile/2021-08-17_18_43_19-process_bundle-5799522238727205118-4&lt;/p&gt;

&lt;p&gt;         538200134 function calls (537540317 primitive calls) in 2278.252 seconds&lt;/p&gt;

&lt;p&gt;   Ordered by: internal time&lt;/p&gt;

&lt;p&gt;   ncalls  tottime  percall  cumtime  percall filename:lineno(function)&lt;br/&gt;
    21043 1021.509    0.049 1335.965    0.063 {built-in method _pickle.dumps}}}&lt;/p&gt;

&lt;p&gt;This function takes an extra 1000 unparallelizable seconds in a 1TB pipeline. After inspecting the Runner V1 profile, I did not encounter this function (in fact, the functions that encode the data are extremely fast):&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;{{Out&lt;span class=&quot;error&quot;&gt;&amp;#91;20&amp;#93;&lt;/span&gt;: &amp;lt;pstats.Stats at 0x7f158b159760&amp;gt;&lt;/p&gt;

&lt;p&gt;In &lt;span class=&quot;error&quot;&gt;&amp;#91;21&amp;#93;&lt;/span&gt;: p.sort_stats(&apos;cumtime&apos;).print_stats()&lt;br/&gt;
Tue Aug 17 14:14:23 2021    profilingmofiling_runnerv1/cpu_profile/2021-08-17_21_08_44-8751929660737608456&lt;/p&gt;

&lt;p&gt;         157945660 function calls (153771026 primitive calls) in 977.880 seconds&lt;/p&gt;

&lt;p&gt;   Ordered by: cumulative time&lt;/p&gt;

&lt;p&gt;   ncalls  tottime  percall  cumtime  percall filename:lineno(function)&lt;br/&gt;
        1    0.000    0.000  978.007  978.007 /usr/local/lib/python3.8/site-packages/dataflow_worker/batchworker.py:623(do_work)&lt;br/&gt;
        1    0.000    0.000  966.360  966.360 /usr/local/lib/python3.8/site-packages/dataflow_worker/executor.py:224(execute)&lt;br/&gt;
        1    0.003    0.003  966.360  966.360 /usr/local/lib/python3.8/site-packages/dataflow_worker/executor.py:228(_perform_source_split_considering_api_limits)&lt;br/&gt;
        1    0.022    0.022  958.413  958.413 /usr/local/lib/python3.8/site-packages/dataflow_worker/executor.py:264(_perform_source_split)&lt;br/&gt;
    10321    0.005    0.000  940.065    0.091 /usr/local/lib/python3.8/site-packages/apache_beam/io/gcp/bigquery.py:774(split)&lt;br/&gt;
     ....................................................................................................................&lt;br/&gt;
     ................................ SEVERAL LINES      ................................................................&lt;br/&gt;
     ....................................................................................................................&lt;br/&gt;
   460021    3.152    0.000   18.662    0.000 /usr/local/lib/python3.8/site-packages/apitools/base/protorpclite/messages.py:761(_&lt;em&gt;init&lt;/em&gt;_)&lt;br/&gt;
142141/52122    0.290    0.000   18.447    0.000 /usr/local/lib/python3.8/json/encoder.py:182(encode)&lt;br/&gt;
        1    0.000    0.000   18.303   18.303 /usr/local/lib/python3.8/site-packages/dataflow_worker/workerapiclient.py:593(splits_to_split_response)&lt;br/&gt;
        1    0.005    0.005   18.294   18.294 /usr/local/lib/python3.8/site-packages/dataflow_worker/workerapiclient.py:601(&amp;lt;listcomp&amp;gt;)&lt;br/&gt;
     5000    0.092    0.000   18.289    0.004 /usr/local/lib/python3.8/site-packages/dataflow_worker/workerapiclient.py:614(_source_bundle_to_derived_source)}}&lt;/p&gt;</comment>
                            <comment id="17413403" author="udim" created="Fri, 10 Sep 2021 22:05:03 +0000"  >&lt;p&gt;PR #15357 is in the 2.33.0 branch. Is this issue resolved?&lt;/p&gt;</comment>
                            <comment id="17416812" author="udim" created="Fri, 17 Sep 2021 17:12:06 +0000"  >&lt;p&gt;Is this resolved?&lt;/p&gt;</comment>
                            <comment id="17420001" author="udim" created="Fri, 24 Sep 2021 21:43:52 +0000"  >&lt;p&gt;Bumped to 2.34.0&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 7 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0u3u8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>