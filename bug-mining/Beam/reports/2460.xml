<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 11:18:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-12515] Python PreCommit flaking in PipelineOptionsTest.test_display_data</title>
                <link>https://issues.apache.org/jira/browse/BEAM-12515</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;Seeing this failure pretty frequently on PreCommit since yesterday (06/17).&lt;/p&gt;

&lt;p&gt;The first failure in precommit cron was here: &lt;a href=&quot;https://ci-beam.apache.org/job/beam_PreCommit_Python_cron/4327/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-beam.apache.org/job/beam_PreCommit_Python_cron/4327/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Seems related to &lt;a href=&quot;https://issues.apache.org/jira/browse/BEAM-10006&quot; title=&quot;PipelineOptions can pick up definitions from unrelated tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BEAM-10006&quot;&gt;BEAM-10006&lt;/a&gt;, but I&apos;m not sure what changed to make this start flaking recently.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
self = &amp;lt;apache_beam.options.pipeline_options_test.PipelineOptionsTest testMethod=test_display_data&amp;gt;

    def test_display_data(self):
      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; in PipelineOptionsTest.TEST_CASES:
        options = PipelineOptions(flags=&lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;[&lt;span class=&quot;code-quote&quot;&gt;&apos;flags&apos;&lt;/span&gt;])
        dd = DisplayData.create_from(options)
&amp;gt;       hc.assert_that(dd.items, hc.contains_inanyorder(*&lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;[&lt;span class=&quot;code-quote&quot;&gt;&apos;display_data&apos;&lt;/span&gt;]))

apache_beam/options/pipeline_options_test.py:222: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
target/.tox-py36-cloud/py36-cloud/lib/python3.6/site-packages/hamcrest/library/collection/issequence_containinginanyorder.py:68: in describe_mismatch
    self.matches(item, mismatch_description)
target/.tox-py36-cloud/py36-cloud/lib/python3.6/site-packages/hamcrest/library/collection/issequence_containinginanyorder.py:64: in matches
    .describe_mismatch(sequence, mismatch_description)
target/.tox-py36-cloud/py36-cloud/lib/python3.6/site-packages/hamcrest/core/base_matcher.py:34: in describe_mismatch
    mismatch_description.append_text(&lt;span class=&quot;code-quote&quot;&gt;&apos;was &apos;&lt;/span&gt;).append_description_of(item)
target/.tox-py36-cloud/py36-cloud/lib/python3.6/site-packages/hamcrest/core/base_description.py:34: in append_description_of
    description = str(value)
apache_beam/transforms/display.py:359: in __repr__
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;DisplayDataItem({})&apos;&lt;/span&gt;.format(json.dumps(self._get_dict()))
/usr/lib/python3.6/json/__init__.py:231: in dumps
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; _default_encoder.encode(obj)
/usr/lib/python3.6/json/encoder.py:199: in encode
    chunks = self.iterencode(o, _one_shot=True)
/usr/lib/python3.6/json/encoder.py:257: in iterencode
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; _iterencode(o, 0)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &amp;lt;json.encoder.JSONEncoder object at 0x7fef54dd19b0&amp;gt;
o = &amp;lt;apache_beam.options.value_provider.RuntimeValueProvider object at 0x7feeb2ed5c50&amp;gt;

    def &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;(self, o):
        &quot;&quot;&quot;Implement &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; method in a subclass such that it returns
        a serializable object &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ``o``, or calls the base implementation
        (to raise a ``TypeError``).
    
        For example, to support arbitrary iterators, you could
        implement &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; like &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;::
    
            def &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;(self, o):
                &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;:
                    iterable = iter(o)
                except TypeError:
                    pass
                &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;:
                    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; list(iterable)
                # Let the base &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; method raise the TypeError
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; JSONEncoder.&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;(self, o)
    
        &quot;&quot;&quot;
        raise TypeError(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; of type &lt;span class=&quot;code-quote&quot;&gt;&apos;%s&apos;&lt;/span&gt; is not JSON serializable&quot;&lt;/span&gt; %
&amp;gt;                       o.__class__.__name__)
E       TypeError: &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; of type &lt;span class=&quot;code-quote&quot;&gt;&apos;RuntimeValueProvider&apos;&lt;/span&gt; is not JSON serializable

/usr/lib/python3.6/json/encoder.py:180: TypeError
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13384580">BEAM-12515</key>
            <summary>Python PreCommit flaking in PipelineOptionsTest.test_display_data</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10101" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">P1</priority>
                        <status id="10722" iconUrl="https://issues.apache.org/jira/images/icons/statuses/generic.png" description="">Triage Needed</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="bhulette">Brian Hulette</reporter>
                        <labels>
                            <label>flake</label>
                            <label>sdk-py-core</label>
                            <label>sickbay</label>
                    </labels>
                <created>Fri, 18 Jun 2021 18:18:30 +0000</created>
                <updated>Sat, 23 Nov 2024 09:37:25 +0000</updated>
                                                                            <component>sdk-py-core</component>
                    <component>test-failures</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="36600">10h 10m</timespent>
                                <comments>
                            <comment id="17371609" author="tvalentyn" created="Tue, 29 Jun 2021 19:56:45 +0000"  >&lt;p&gt;Possible culprit, based on timing of when the errors started to happen: &lt;a href=&quot;https://github.com/apache/beam/pull/14795/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/14795/&lt;/a&gt;. Not sure why that would trigger the errors though.&lt;/p&gt;</comment>
                            <comment id="17371612" author="tvalentyn" created="Tue, 29 Jun 2021 20:00:10 +0000"  >&lt;p&gt;(saw this commit from beam.apache.org/job/beam_PreCommit_Python_cron/4327/) &lt;/p&gt;</comment>
                            <comment id="17371734" author="bhulette" created="Tue, 29 Jun 2021 23:21:43 +0000"  >&lt;p&gt;Maybe &lt;a href=&quot;https://github.com/apache/beam/pull/14460?&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/14460?&lt;/a&gt; this was the only commit in beam.apache.org/job/beam_PreCommit_Python_cron/4326/&lt;/p&gt;</comment>
                            <comment id="17373034" author="altay" created="Thu, 1 Jul 2021 20:22:52 +0000"  >&lt;p&gt;So far there are 2 proposed fix options:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/beam/pull/15104&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/15104&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/beam/pull/15101&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/15101&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Brian will be out of office for a while. Folks on those PRs &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tvalentyn&quot; class=&quot;user-hover&quot; rel=&quot;tvalentyn&quot;&gt;tvalentyn&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=udim&quot; class=&quot;user-hover&quot; rel=&quot;udim&quot;&gt;udim&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benglez&quot; class=&quot;user-hover&quot; rel=&quot;benglez&quot;&gt;benglez&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tysonjh&quot; class=&quot;user-hover&quot; rel=&quot;tysonjh&quot;&gt;tysonjh&lt;/a&gt; - Could you please pick any of ot the work arounds and go with it?&lt;/p&gt;

&lt;p&gt;Disabling the flaky tests in the meantime could also be a good option until we figure out a more permanent solution.&lt;/p&gt;</comment>
                            <comment id="17373056" author="tysonjh" created="Thu, 1 Jul 2021 20:57:22 +0000"  >&lt;p&gt;I&apos;m running the python precommit again on the rollback PR. My vote is to rollback if it passes again, that will be 4 runs passing without&#160;&lt;a href=&quot;https://github.com/apache/beam/pull/14460?&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/14460?&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17373690" author="tvalentyn" created="Fri, 2 Jul 2021 17:29:05 +0000"  >&lt;p&gt;I looked at &lt;a href=&quot;https://github.com/apache/beam/pull/14460&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/14460&lt;/a&gt;. I would prefer not to revert that PR. It seems like it is adding a useful functionality and there is no explanation how that pr could affect the display_data test. It seems that we have some esotric bug hiding in our test setup or in one of the tests, and it is not great to let this bug prevent contributions to Beam. &lt;/p&gt;

&lt;p&gt;As a possible measure to alleviate the pain, we could add a retry decorator to the offending test, that may silence the error, but also not a good status quo, ideally we should understand what is happening here as it may come up again.&lt;/p&gt;</comment>
                            <comment id="17373696" author="tvalentyn" created="Fri, 2 Jul 2021 17:31:20 +0000"  >&lt;p&gt;If reverting the PR shows that the tests passes, we could try to bisect what part of PR (likely one of the tests?) triggers this behavior, perhaps it would give some clues. &lt;/p&gt;</comment>
                            <comment id="17379254" author="altay" created="Mon, 12 Jul 2021 16:24:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/beam/pull/15115&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/15115&lt;/a&gt; reverted &lt;a href=&quot;https://github.com/apache/beam/pull/14460&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/14460&lt;/a&gt;. However this did not resolve the problem. The test is still flaky (e.g. &lt;a href=&quot;https://ci-beam.apache.org/job/beam_PreCommit_Python_Phrase/2664/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-beam.apache.org/job/beam_PreCommit_Python_Phrase/2664/&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;I think we need to sickbay this test (test_display_data) and then we can undo the reverting of &lt;a href=&quot;https://github.com/apache/beam/pull/14460&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/14460&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="17385873" author="altay" created="Fri, 23 Jul 2021 02:29:09 +0000"  >&lt;p&gt;The test is sickbayed. Remaining work is to unflake it and remove it from the sickbay.&lt;/p&gt;</comment>
                            <comment id="17472929" author="beamjirabot" created="Tue, 11 Jan 2022 16:57:14 +0000"  >&lt;p&gt;This issue is assigned but has not received an update in 30 days so it has been labeled &quot;stale-assigned&quot;. If you are still working on the issue, please give an update and remove the label. If you are no longer working on the issue, please unassign so someone else may work on it. In 7 days the issue will be automatically unassigned.&lt;/p&gt;</comment>
                            <comment id="17473063" author="beamjirabot" created="Tue, 11 Jan 2022 18:28:15 +0000"  >&lt;p&gt;This issue was marked &quot;stale-assigned&quot; and has not received a public comment in 7 days. It is now automatically unassigned. If you are still working on it, you can assign it to yourself again. Please also give an update about the status of the work.&lt;/p&gt;</comment>
                            <comment id="17474135" author="kenn" created="Wed, 12 Jan 2022 03:50:48 +0000"  >&lt;p&gt;This Jira ticket has a pull request attached to it, but is still open. Did the pull request resolve the issue? If so, could you please mark it resolved? This will help the project have a clear view of its open issues.&lt;/p&gt;</comment>
                            <comment id="17549541" author="JIRAUSER282469" created="Sat, 4 Jun 2022 21:38:52 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/apache/beam/issues/21116&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/issues/21116&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13305224">BEAM-10006</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 23 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0s2xk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>