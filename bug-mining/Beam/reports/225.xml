<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 10:43:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-1048] Spark Runner streaming batch duration does not include duration of reading from source </title>
                <link>https://issues.apache.org/jira/browse/BEAM-1048</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;Spark Runner streaming batch duration does not include duration of reading from source this is because we perform rdd.count in SparkUnboundedSourcewhich that invokes a regular spark job outside the streaming context.&lt;/p&gt;

&lt;p&gt;We do it for reporting the batch size both for UI and back pressure&lt;/p&gt;</description>
                <environment></environment>
        <key id="13023188">BEAM-1048</key>
            <summary>Spark Runner streaming batch duration does not include duration of reading from source </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10005">Workaround</resolution>
                                        <assignee username="staslev">Stas Levin</assignee>
                                    <reporter username="ksalant">Kobi Salant</reporter>
                        <labels>
                    </labels>
                <created>Thu, 24 Nov 2016 13:45:04 +0000</created>
                <updated>Sat, 16 May 2020 14:11:28 +0000</updated>
                            <resolved>Sun, 2 Apr 2017 10:21:41 +0000</resolved>
                                    <version>0.4.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>runner-spark</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15693377" author="amitsela" created="Thu, 24 Nov 2016 14:11:15 +0000"  >&lt;p&gt;To clarify - calling `rdd.count()` on the read input RDD creates a batch job each interval.&lt;br/&gt;
I was following &quot;direct kafka&quot; implementation, but in that case it&apos;s only metadata computation as the read from Kafka is known ahead of actual read (it has a preset &lt;span class=&quot;error&quot;&gt;&amp;#91;start, end&amp;#93;&lt;/span&gt; offsets).&lt;/p&gt;

&lt;p&gt;This is used for UI visibility, and feeding the &lt;tt&gt;RateController&lt;/tt&gt;.&lt;br/&gt;
If &lt;tt&gt;RateController&lt;/tt&gt; is not used, we might want to disable this for now.. (UI will lose count visualisation too).&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ksalant&quot; class=&quot;user-hover&quot; rel=&quot;ksalant&quot;&gt;ksalant&lt;/a&gt; I&apos;ve assigned you since you&apos;re working on it. If resolving this prolongs, let&apos;s open a sub-task to disable this if &lt;tt&gt;RateController&lt;/tt&gt; is not used, and enable once resolved.&lt;/p&gt;</comment>
                            <comment id="15863792" author="staslev" created="Mon, 13 Feb 2017 15:00:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ksalant&quot; class=&quot;user-hover&quot; rel=&quot;ksalant&quot;&gt;ksalant&lt;/a&gt;, following our discussion and your blessing I&apos;m assigning this to myself &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15878393" author="githubbot" created="Wed, 22 Feb 2017 15:01:24 +0000"  >&lt;p&gt;GitHub user staslev opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/beam/pull/2073&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/2073&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/BEAM-1048&quot; title=&quot;Spark Runner streaming batch duration does not include duration of reading from source &quot; class=&quot;issue-link&quot; data-issue-key=&quot;BEAM-1048&quot;&gt;&lt;del&gt;BEAM-1048&lt;/del&gt;&lt;/a&gt; Added a per-batch read duration metric to SparkUnboundedSource.&lt;/p&gt;

&lt;p&gt;    Be sure to do all of the following to help us incorporate your contribution&lt;br/&gt;
    quickly and easily:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Make sure the PR title is formatted like:&lt;br/&gt;
       `&lt;a href=&quot;#&amp;gt;&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;BEAM-&amp;lt;Jira issue #&amp;gt;&lt;/a&gt; Description of pull request`&lt;/li&gt;
	&lt;li&gt;[ ] Make sure tests pass via `mvn clean verify`. (Even better, enable&lt;br/&gt;
           Travis-CI on your fork and ensure the whole test matrix passes).&lt;/li&gt;
	&lt;li&gt;[ ] Replace `&amp;lt;Jira issue #&amp;gt;` in the title with the actual Jira issue&lt;br/&gt;
           number, if there is one.&lt;/li&gt;
	&lt;li&gt;[ ] If this contribution is large, please file an Apache&lt;br/&gt;
           &lt;span class=&quot;error&quot;&gt;&amp;#91;Individual Contributor License Agreement&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://www.apache.org/licenses/icla.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.apache.org/licenses/icla.txt&lt;/a&gt;).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    &amp;#8212;&lt;/p&gt;

&lt;p&gt;    R: @amitsela &lt;/p&gt;


&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/staslev/beam&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/staslev/beam&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/BEAM-1048&quot; title=&quot;Spark Runner streaming batch duration does not include duration of reading from source &quot; class=&quot;issue-link&quot; data-issue-key=&quot;BEAM-1048&quot;&gt;&lt;del&gt;BEAM-1048&lt;/del&gt;&lt;/a&gt;-reporting-batch-read-duration-metrics&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/beam/pull/2073.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/2073.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2073&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 1e02ab5b6320eef82a9bed597884e6cf51770682&lt;br/&gt;
Author: Stas Levin &amp;lt;staslevin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-02-22T14:58:58Z&lt;/p&gt;

&lt;p&gt;    Added a per-batch read duration metric to SparkUnboundedSource.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15952613" author="githubbot" created="Sun, 2 Apr 2017 10:09:07 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/beam/pull/2073&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/2073&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15952616" author="staslev" created="Sun, 2 Apr 2017 10:21:15 +0000"  >&lt;p&gt;While batch duration is still (and probably won&apos;t be) reported as part of what is known as the &quot;batch duration&quot;, the PR linked to this issue adds a separate metric that reports the max read duration per-batch.&lt;/p&gt;

&lt;p&gt;To get a sense of the entire &quot;batch duration&quot;, i.e., read duration + process duration, one can sum the read and process delay metrics.&lt;br/&gt;
This is not a bullet proof solution, as technically there is no guarantee that at a given point in time, the read duration and process delay metrics actually refer to the same batch id, that said, this should provide a general idea of how an application is doing vis-&#224;-vis &quot;batch duration&quot;.&lt;/p&gt;</comment>
                            <comment id="17008418" author="sophie1" created="Sun, 5 Jan 2020 20:43:54 +0000"  >&lt;p&gt;any bullet proof solution now?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 45 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i36r1b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>