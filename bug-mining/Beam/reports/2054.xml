<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 11:12:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-10769] Fix Avro IO documentation: when fastavro is used, do not pass schema parsed by avro-python3.</title>
                <link>https://issues.apache.org/jira/browse/BEAM-10769</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description></description>
                <environment></environment>
        <key id="13323630">BEAM-10769</key>
            <summary>Fix Avro IO documentation: when fastavro is used, do not pass schema parsed by avro-python3.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="10722" iconUrl="https://issues.apache.org/jira/images/icons/statuses/generic.png" description="">Triage Needed</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tvalentyn">Valentyn Tymofieiev</assignee>
                                    <reporter username="tvalentyn">Valentyn Tymofieiev</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Aug 2020 22:01:13 +0000</created>
                <updated>Mon, 25 Jul 2022 14:04:54 +0000</updated>
                            <resolved>Sat, 15 May 2021 17:58:11 +0000</resolved>
                                                    <fixVersion>2.25.0</fixVersion>
                                    <component>io-py-gcp</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="11400">3h 10m</timespent>
                                <comments>
                            <comment id="17181348" author="tvalentyn" created="Thu, 20 Aug 2020 17:24:01 +0000"  >&lt;p&gt;Beam switched to use FastAvro as a default library on Python 3. The fastavro-based Avro sink expects schema as a dictionary, while the avro-python3-based Avro Sink expects a schema that was previously parsed by avro.schema.Parse(). Fastavro will not accept a schema parsed by avro-python3.&lt;/p&gt;

&lt;p&gt;When a user switches their pipeline with WriteToAvro transform to Python 3, but does not change how schema is passed to the transform and thus passes a schema parsed by avro.schema.Parse(),  fastavro will not be able parse the schema, since FastAvro expects schema as a dictionary. Also FastAvro does not require a parsed schema, although supplying a schema parsed by fastavro works too.&lt;/p&gt;

&lt;p&gt;The error may manifest as follows:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;...lib/python3.7/site-packages/apache_beam/io/avroio.py&quot;, line 634, in open
    return Writer(file_handle, self._schema, self._codec)
  File &quot;fastavro/_write.pyx&quot;, line 522, in fastavro._write.Writer.__init__
  File &quot;fastavro/_schema.pyx&quot;, line 71, in fastavro._schema.parse_schema
  File &quot;fastavro/_schema.pyx&quot;, line 85, in fastavro._schema._parse_schema
TypeError: unhashable type: &apos;RecordSchema&apos; [while running &apos;SampleInfoToAvro/WriteToAvroFiles/Write/WriteImpl/WriteBundles&apos;]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To fix the error, users should pass the schema to the sink as a dictionary. &lt;a href=&quot;https://github.com/apache/beam/pull/12638&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/12638&lt;/a&gt; is out to fix the documentation and catch these errors with a better error message.   &lt;/p&gt;</comment>
                            <comment id="17186883" author="tvalentyn" created="Sat, 29 Aug 2020 04:39:13 +0000"  >&lt;p&gt;Py2 tests are failing on #12638 . Let&apos;s merge it once we drop Py2 support, which should happen before 2.25.0.&lt;br/&gt;
Setting 2.25.0 as fix version as a reminder to proceed with the merge before we cut 2.25.0.&lt;/p&gt;</comment>
                            <comment id="17345313" author="kenn" created="Sat, 15 May 2021 17:58:11 +0000"  >&lt;p&gt;Hello! Due to a bug in our Jira configuration, this issue had status:Resolved but resolution:Unresolved.&lt;/p&gt;

&lt;p&gt;I am bulk editing these issues to have resolution:Fixed&lt;/p&gt;

&lt;p&gt;If a different resolution is appropriate, please change it. To do this, click the &quot;Resolve&quot; button (you can do this even for closed issues) and set the Resolution field to the right value.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 26 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0hxgo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>