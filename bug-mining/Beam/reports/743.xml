<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 10:52:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-5509] Python pipeline_options doesn&apos;t handle int type</title>
                <link>https://issues.apache.org/jira/browse/BEAM-5509</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;The int option supplied at the command line is turned into a decimal during serialization and then the parser in SDK harness fails to restore it as int.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13187490">BEAM-5509</key>
            <summary>Python pipeline_options doesn&apos;t handle int type</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thw">Thomas Weise</assignee>
                                    <reporter username="thw">Thomas Weise</reporter>
                        <labels>
                            <label>portability-flink</label>
                    </labels>
                <created>Wed, 26 Sep 2018 01:41:23 +0000</created>
                <updated>Sat, 16 May 2020 13:59:37 +0000</updated>
                            <resolved>Sat, 29 Sep 2018 22:04:25 +0000</resolved>
                                                    <fixVersion>2.8.0</fixVersion>
                                    <component>sdk-py-harness</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="16628141" author="thw" created="Wed, 26 Sep 2018 01:45:21 +0000"  >&lt;p&gt;Pass&#160;--parallelism=1 and then job_utils.dict_to_struct(options) yields&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
fields {
&#160; key: &lt;span class=&quot;code-quote&quot;&gt;&quot;beam:option:parallelism:v1&quot;&lt;/span&gt;
&#160; value {
&#160; &#160; number_value: 1.0
&#160; }
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Parsing in SDK harness will bark at it:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
sdk_worker_main.py: error: argument --parallelism: invalid &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; value: u&lt;span class=&quot;code-quote&quot;&gt;&apos;1.0&apos;&lt;/span&gt;

[grpc-&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-worker-ELG-3-3] DEBUG org.apache.beam.vendor.grpc.v1.io.grpc.netty.NettyServerHandler - [id: 0x284d90f2, L:/127.0.0.1:57436 - R:/127.0.0.1:57442] INBOUND DATA: streamId=1 padding=0 endStream=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; length=980 bytes=00000003cf0acc070806120c08ccb8abdd0510e8b5f5e1011a9707507974686f6e2073646b206861726e657373206661696c65643a200a54726163656261636b...

[grpc-&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-worker-ELG-3-3] DEBUG org.apache.beam.vendor.grpc.v1.io.grpc.netty.NettyServerHandler - [id: 0x284d90f2, L:/127.0.0.1:57436 - R:/127.0.0.1:57442] INBOUND DATA: streamId=1 padding=0 endStream=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; length=0 bytes=

[grpc-&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-executor-0] ERROR sdk_worker_main.main - Python sdk harness failed:

Traceback (most recent call last):

&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/tweise/python-ve/beam/lib/python2.7/site-packages/apache_beam/runners/worker/sdk_worker_main.py&quot;&lt;/span&gt;, line 136, in main

&#160; &#160; sdk_pipeline_options.get_all_options(drop_default=True))

&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/tweise/python-ve/beam/lib/python2.7/site-packages/apache_beam/options/pipeline_options.py&quot;&lt;/span&gt;, line 216, in get_all_options

&#160; &#160; known_args, _ = parser.parse_known_args(self._flags)

&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/argparse.py&quot;&lt;/span&gt;, line 1740, in parse_known_args

&#160; &#160; self.error(str(err))

&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/argparse.py&quot;&lt;/span&gt;, line 2374, in error

&#160; &#160; self.exit(2, _(&lt;span class=&quot;code-quote&quot;&gt;&apos;%s: error: %s\n&apos;&lt;/span&gt;) % (self.prog, message))

&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/argparse.py&quot;&lt;/span&gt;, line 2362, in exit

&#160; &#160; _sys.exit(status)

SystemExit: 2&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16630428" author="robertwb" created="Thu, 27 Sep 2018 13:37:06 +0000"  >&lt;p&gt;I don&apos;t think we should be representing integral values as floating point in the pipeline options representation (though perhaps we&apos;d have to use strings given that JSON doesn&apos;t support ints.)&lt;/p&gt;</comment>
                            <comment id="16631152" author="thw" created="Thu, 27 Sep 2018 22:59:30 +0000"  >&lt;p&gt;The unwanted conversion to floating point occurs in &lt;a href=&quot;https://github.com/apache/beam/blob/6f10dd36b7f01758675e244f6da86f27bcbcea6a/sdks/python/apache_beam/runners/job/utils.py#L30&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/6f10dd36b7f01758675e244f6da86f27bcbcea6a/sdks/python/apache_beam/runners/job/utils.py#L30&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
json_format.Parse(json.dumps(dict_obj), struct_pb2.Struct())&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Specifically, when the json (which does not contain a floating point literal is turned back to the struct.&lt;/p&gt;

&lt;p&gt;Converting all int and long values to string prior to calling this utility avoids the issue.&lt;/p&gt;</comment>
                            <comment id="16632172" author="thw" created="Fri, 28 Sep 2018 17:45:14 +0000"  >&lt;p&gt;A bit more digging shows that the culprit is really the conversion from dict to struct in&#160;&lt;/p&gt;

&lt;p&gt;google/protobuf/json_format.py(582)_ConvertValueMessage&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160; /&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/bdb.py(400)run()

-&amp;gt; exec cmd in globals, locals

&#160; &amp;lt;string&amp;gt;(1)&amp;lt;module&amp;gt;()

&#160; /Users/tweise/src/beam/sdks/python/flink-example.py(23)&amp;lt;module&amp;gt;()

-&amp;gt; | beam.Map(lambda x: logging.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;1Got %s&quot;&lt;/span&gt;, x) or (x, 1))

&#160; /Users/tweise/src/beam/sdks/python/apache_beam/pipeline.py(414)__exit__()

-&amp;gt; self.run().wait_until_finish()

&#160; /Users/tweise/src/beam/sdks/python/apache_beam/pipeline.py(394)run()

-&amp;gt; self.to_runner_api(), self.runner, self._options).run(False)

&#160; /Users/tweise/src/beam/sdks/python/apache_beam/pipeline.py(407)run()

-&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.runner.run_pipeline(self)

&#160; /Users/tweise/src/beam/sdks/python/apache_beam/runners/portability/portable_runner.py(165)run_pipeline()

-&amp;gt; prepare_response = send_prepare_request()

&#160; /Users/tweise/src/beam/sdks/python/apache_beam/runners/portability/portable_runner.py(159)send_prepare_request()

-&amp;gt; pipeline_options=job_utils.dict_to_struct(options)))

&#160; /Users/tweise/src/beam/sdks/python/apache_beam/runners/job/utils.py(30)dict_to_struct()

-&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; json_format.ParseDict(dict_obj, struct_pb2.Struct())

&#160; /Users/tweise/python-ve/beam/lib/python2.7/site-packages/google/protobuf/json_format.py(404)ParseDict()

-&amp;gt; parser.ConvertMessage(js_dict, message)

&#160; /Users/tweise/python-ve/beam/lib/python2.7/site-packages/google/protobuf/json_format.py(433)ConvertMessage()

-&amp;gt; methodcaller(_WKTJSONMETHODS[full_name][1], value, message)(self)

&#160; /Users/tweise/python-ve/beam/lib/python2.7/site-packages/google/protobuf/json_format.py(605)_ConvertStructMessage()

-&amp;gt; self._ConvertValueMessage(value[key], message.fields[key])

&amp;gt; /Users/tweise/python-ve/beam/lib/python2.7/site-packages/google/protobuf/json_format.py(582)_ConvertValueMessage()&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

(Pdb) l

577&#160; &#160; &#160; elif isinstance(value, list):

578&#160; &#160; &#160; &#160; self. _ConvertListValueMessage(value, message.list_value)

579&#160; &#160; &#160; elif value is None:

580&#160; &#160; &#160; &#160; message.null_value = 0

581&#160; &#160; &#160; elif isinstance(value, bool):

582&#160; 	&#160; &#160;message.bool_value = value

583&#160; &#160; &#160; elif isinstance(value, six.string_types):

584&#160; &#160; &#160; &#160; message.string_value = value

585&#160; &#160; &#160; elif isinstance(value, _INT_OR_FLOAT):

586&#160; -&amp;gt;&#160; &#160; &#160; message.number_value = value

587&#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;:&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As we see int and float treated the same way. Is that an upstream bug that should be filed as such?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 7 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3yi0f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>