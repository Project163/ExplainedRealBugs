<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 11:10:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-10471] Failure / flake in CassandraIOTest &gt; testEstimatedSizeBytes</title>
                <link>https://issues.apache.org/jira/browse/BEAM-10471</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://ci-beam.apache.org/job/beam_PreCommit_Java_Commit/12328/testReport/junit/org.apache.beam.sdk.io.cassandra/CassandraIOTest/testEstimatedSizeBytes/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-beam.apache.org/job/beam_PreCommit_Java_Commit/12328/testReport/junit/org.apache.beam.sdk.io.cassandra/CassandraIOTest/testEstimatedSizeBytes/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;AssertionError&lt;/tt&gt; with no error message. Please give a meaningful error message. Preferably do not use &lt;tt&gt;assertTrue&lt;/tt&gt; and other less meaningful asserters.&lt;/p&gt;

&lt;p&gt;Digging into the code, it is a bounds check that the estimated bytes are +/- 10% of expected, since the result is nondeterministic. It fell outside of the range but since the assertion is written as &lt;tt&gt;assertTrue&lt;/tt&gt; we do not see the actual value.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/beam/blob/66bcc9a967746cad12dfdeed473fb60c77033514/sdks/java/io/cassandra/src/test/java/org/apache/beam/sdk/io/cassandra/CassandraIOTest.java#L291&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/66bcc9a967746cad12dfdeed473fb60c77033514/sdks/java/io/cassandra/src/test/java/org/apache/beam/sdk/io/cassandra/CassandraIOTest.java#L291&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13316536">BEAM-10471</key>
            <summary>Failure / flake in CassandraIOTest &gt; testEstimatedSizeBytes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10101" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">P1</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="echauchot">Etienne Chauchot</assignee>
                                    <reporter username="kenn">Kenneth Knowles</reporter>
                        <labels>
                            <label>flake</label>
                    </labels>
                <created>Mon, 13 Jul 2020 19:12:24 +0000</created>
                <updated>Thu, 13 Jan 2022 21:49:02 +0000</updated>
                            <resolved>Sat, 15 May 2021 17:58:02 +0000</resolved>
                                                    <fixVersion>Missing</fixVersion>
                                    <component>io-java-cassandra</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="6600">1h 50m</timespent>
                                <comments>
                            <comment id="17158749" author="kenn" created="Wed, 15 Jul 2020 22:35:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://ci-beam.apache.org/job/beam_PreCommit_Java_Commit/12388/testReport/junit/org.apache.beam.sdk.io.cassandra/CassandraIOTest/testEstimatedSizeBytes/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-beam.apache.org/job/beam_PreCommit_Java_Commit/12388/testReport/junit/org.apache.beam.sdk.io.cassandra/CassandraIOTest/testEstimatedSizeBytes/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17158782" author="kenn" created="Wed, 15 Jul 2020 23:30:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://ci-beam.apache.org/job/beam_PreCommit_Java_Commit/12391/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-beam.apache.org/job/beam_PreCommit_Java_Commit/12391/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17158783" author="kenn" created="Wed, 15 Jul 2020 23:30:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=echauchot&quot; class=&quot;user-hover&quot; rel=&quot;echauchot&quot;&gt;echauchot&lt;/a&gt; do you still work on this or know who might be able to help?&lt;/p&gt;</comment>
                            <comment id="17159078" author="echauchot" created="Thu, 16 Jul 2020 09:53:55 +0000"  >&lt;p&gt;Hi Kenn, Thanks for raising this. I don&apos;t work on this but I can take a look. To be honest 10% range for the assertion was quite random guess. As it is a minor change I could do it quickly myself changing the percentage and the assertion method.&lt;/p&gt;</comment>
                            <comment id="17159094" author="echauchot" created="Thu, 16 Jul 2020 10:23:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kenn&quot; class=&quot;user-hover&quot; rel=&quot;kenn&quot;&gt;kenn&lt;/a&gt;, fixed. Here is the PR&#160;&lt;a href=&quot;https://github.com/apache/beam/pull/12276&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/12276&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17168257" author="altay" created="Thu, 30 Jul 2020 22:11:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/beam/pull/12276&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/12276&lt;/a&gt; is merged. Can we close this?&lt;/p&gt;</comment>
                            <comment id="17168544" author="echauchot" created="Fri, 31 Jul 2020 09:09:04 +0000"  >&lt;p&gt;Hey Ahmet ! Usually for flakes I leave 2 weeks to have enough historical data before considering that the flakiness is solved. And it isn&apos;t in that case but the PR allowed me to see that the estimated size returned by the IO can be multiplied by 2 in some cases (maybe apache cassandra internal size estimates are not updated in some cases) way above the 20% margin I let in the test condition. I&apos;ll take a look and change to a proper test condition.&lt;/p&gt;</comment>
                            <comment id="17168546" author="echauchot" created="Fri, 31 Jul 2020 09:09:43 +0000"  >&lt;p&gt;here is the last flake after the PR that improves the failure message and sets the margin to 20%:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://ci-beam.apache.org/job/beam_PreCommit_Java_Commit/12690/testReport/org.apache.beam.sdk.io.cassandra/CassandraIOTest/testEstimatedSizeBytes/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-beam.apache.org/job/beam_PreCommit_Java_Commit/12690/testReport/org.apache.beam.sdk.io.cassandra/CassandraIOTest/testEstimatedSizeBytes/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17168576" author="echauchot" created="Fri, 31 Jul 2020 09:39:41 +0000"  >&lt;p&gt;just submitted this PR:&#160;&lt;a href=&quot;https://github.com/apache/beam/pull/12432&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/12432&lt;/a&gt;&#160;that updates the internal cassandra size estimates after insertion. If it does not give consistent sizes over time, I&apos;ll change the acceptance condition is the test to size &amp;gt; 0 to avoid flakiness&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17169845" author="echauchot" created="Mon, 3 Aug 2020 09:23:29 +0000"  >&lt;p&gt;Merging the PR as soon as the CI is green. I&apos;ll then wait for a couple of weeks to see if the flakiness is gone&lt;/p&gt;</comment>
                            <comment id="17174217" author="echauchot" created="Mon, 10 Aug 2020 10:12:26 +0000"  >&lt;p&gt;still failing. The history ( &lt;a href=&quot;https://ci-beam.apache.org/job/beam_PreCommit_Java_Commit/12690/testReport/junit/org.apache.beam.sdk.io.cassandra/CassandraIOTest/testEstimatedSizeBytes/history/?start=50&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-beam.apache.org/job/beam_PreCommit_Java_Commit/12690/testReport/junit/org.apache.beam.sdk.io.cassandra/CassandraIOTest/testEstimatedSizeBytes/history/?start=50&lt;/a&gt;) shows that there was only one failure (08/06) since PR merge. Right now I have no clue why the size estimation is twice bigger in rare cases. It is certainly a cassandra internal behavior. What I suggest is to change the test condition to size &amp;gt; 0 to at least test that the dataset will be split.&lt;/p&gt;</comment>
                            <comment id="17174229" author="echauchot" created="Mon, 10 Aug 2020 10:28:51 +0000"  >&lt;p&gt;I just submitted a PR for that:&#160;&lt;a href=&quot;https://github.com/apache/beam/pull/12510&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/12510&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17345304" author="kenn" created="Sat, 15 May 2021 17:58:02 +0000"  >&lt;p&gt;Hello! Due to a bug in our Jira configuration, this issue had status:Resolved but resolution:Unresolved.&lt;/p&gt;

&lt;p&gt;I am bulk editing these issues to have resolution:Fixed&lt;/p&gt;

&lt;p&gt;If a different resolution is appropriate, please change it. To do this, click the &quot;Resolve&quot; button (you can do this even for closed issues) and set the Resolution field to the right value.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 26 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0gpu8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>