<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 11:06:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-9420] Configurable timeout for Kafka setupInitialOffset()</title>
                <link>https://issues.apache.org/jira/browse/BEAM-9420</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;If bootstrap brokers does contain an unhealthy server, it can break the start of a whole Beam job. During the start, `KafkaUnboundedReader` is waiting for&#160; `setupInitialOffset()`. Wait timeout is either a double time of `request. timeout.ms` or some default constant. In both cases, it might not be enough time for kafka-client to initiate fallback and retry metadata discovery via another broker from given bootstrap list.&lt;/p&gt;

&lt;p&gt;The client should be able to specify timeout for `setupInitialOffset()` explicitly as a setting to KafkaIO read.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13288739">BEAM-9420</key>
            <summary>Configurable timeout for Kafka setupInitialOffset()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jvilcek">Jozef Vilcek</assignee>
                                    <reporter username="jvilcek">Jozef Vilcek</reporter>
                        <labels>
                    </labels>
                <created>Mon, 2 Mar 2020 10:22:13 +0000</created>
                <updated>Sat, 16 May 2020 14:18:09 +0000</updated>
                            <resolved>Wed, 25 Mar 2020 13:47:57 +0000</resolved>
                                    <version>2.19.0</version>
                                    <fixVersion>2.21.0</fixVersion>
                                    <component>io-java-kafka</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="6600">1h 50m</timespent>
                                <comments>
                            <comment id="17049204" author="iemejia" created="Mon, 2 Mar 2020 13:27:41 +0000"  >&lt;p&gt;Can this be addressed somehow with the existing `withConsumerFactoryFn` ?&lt;/p&gt;</comment>
                            <comment id="17049968" author="jvilcek" created="Tue, 3 Mar 2020 07:23:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=iemejia&quot; class=&quot;user-hover&quot; rel=&quot;iemejia&quot;&gt;iemejia&lt;/a&gt;, I do not see how. The timeout is raised outside of consumer, here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/beam/blob/master/sdks/java/io/kafka/src/main/java/org/apache/beam/sdk/io/kafka/KafkaUnboundedReader.java#L118&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/master/sdks/java/io/kafka/src/main/java/org/apache/beam/sdk/io/kafka/KafkaUnboundedReader.java#L118&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Waiting for completion of this method:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/beam/blob/master/sdks/java/io/kafka/src/main/java/org/apache/beam/sdk/io/kafka/KafkaUnboundedReader.java#L625&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/master/sdks/java/io/kafka/src/main/java/org/apache/beam/sdk/io/kafka/KafkaUnboundedReader.java#L625&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;which is executed async. Comment in the code says that `consumer.seek()` can block forever sometimes therefore there is an async Future with timeout. This default timeout does not have to be generous enough. This explicit timeout might not be needed in higher versions of kafka client thanks to&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/KAFKA/KIP-266%3A+Fix+consumer+indefinite+blocking+behavior&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/KAFKA/KIP-266%3A+Fix+consumer+indefinite+blocking+behavior&lt;/a&gt;&#160;and new `default.api.timeout.ms` setting&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17052385" author="aromanenko" created="Thu, 5 Mar 2020 17:54:46 +0000"  >&lt;p&gt;Why increasing a&#160;&lt;tt&gt;request.timeout.ms&lt;/tt&gt; wouldn&apos;t work in this case?&lt;/p&gt;</comment>
                            <comment id="17056816" author="jvilcek" created="Wed, 11 Mar 2020 10:06:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aromanenko&quot; class=&quot;user-hover&quot; rel=&quot;aromanenko&quot;&gt;aromanenko&lt;/a&gt;, I apologies for late reply. `request.timeout.ms` will make Kafka&apos;s network client just wait longer for the reply from broker. The it abandons the request and try again with different broker. Kafka does not have something like `connect.timeout.ms`. It uses a request timeout for many network IO. A higher level timeout which covers `retryCount * request.timeout.ms` is needed. That is&#160; introduced in later versions by `default.api.timeout.ms`.&lt;/p&gt;

&lt;p&gt;In case of producer, this is already possible to do by setting `max.block.ms` larger than `request.timeout.ms`. For consumer, I am not aware of such option.&lt;/p&gt;</comment>
                            <comment id="17065571" author="aromanenko" created="Tue, 24 Mar 2020 12:30:13 +0000"  >&lt;p&gt;I left my comments on the PR page. Sorry for delay with response.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 33 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0c2a8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>