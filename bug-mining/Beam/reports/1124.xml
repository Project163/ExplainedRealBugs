<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 10:57:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-3072] Improve error handling at staging time for DataflowRunner</title>
                <link>https://issues.apache.org/jira/browse/BEAM-3072</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;dependency.py calls out to external process to collect dependencies:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/beam/blob/de7cc05cc67d1aa6331cddc17c2e02ed0efbe37d/sdks/python/apache_beam/runners/dataflow/internal/dependency.py#L263&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/de7cc05cc67d1aa6331cddc17c2e02ed0efbe37d/sdks/python/apache_beam/runners/dataflow/internal/dependency.py#L263&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If these calls fails, the error is not clear. The error only tells what failed but does not show the actual error message, and is not helpful for users.&lt;/p&gt;

&lt;p&gt;As a general fix processes.py should have general better output collection from failed processes.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13110139">BEAM-3072</key>
            <summary>Improve error handling at staging time for DataflowRunner</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10103" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">P3</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nikenano">niklas Hansson</assignee>
                                    <reporter username="altay">Ahmet Altay</reporter>
                        <labels>
                            <label>starter</label>
                    </labels>
                <created>Tue, 17 Oct 2017 21:52:34 +0000</created>
                <updated>Sat, 16 May 2020 13:20:36 +0000</updated>
                            <resolved>Thu, 18 Apr 2019 17:11:52 +0000</resolved>
                                                    <fixVersion>2.12.0</fixVersion>
                                    <component>sdk-py-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="25200">7h</timespent>
                                <comments>
                            <comment id="16803038" author="nikenano" created="Wed, 27 Mar 2019 16:44:44 +0000"  >&lt;p&gt;&#160;I have requested to become a contributor and then plan to pick this task up. My initial plan is to replace the&#160;subprocess.check_call() call &#160;in process.py to instead use&#160; subprocess.check_output() and capture the error message from the subprocess and incorporate it in the error. Super happy for any feedback &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16803069" author="altay" created="Wed, 27 Mar 2019 17:04:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=robinyqiu&quot; class=&quot;user-hover&quot; rel=&quot;robinyqiu&quot;&gt;robinyqiu&lt;/a&gt; or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pabloem&quot; class=&quot;user-hover&quot; rel=&quot;pabloem&quot;&gt;pabloem&lt;/a&gt; could help with providing feedback and reviewing your PRs. Please keep them in the loop.&lt;/p&gt;

&lt;p&gt;Thank you for contributing.&lt;/p&gt;</comment>
                            <comment id="16803075" author="nikenano" created="Wed, 27 Mar 2019 17:08:36 +0000"  >&lt;p&gt;Ok great!&lt;/p&gt;

&lt;p&gt;Just excited to contribute!&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16803172" author="nikenano" created="Wed, 27 Mar 2019 18:17:11 +0000"  >&lt;p&gt;In order to get the output from the error message a possible solution(as far as I understand) would be to replace:&lt;/p&gt;

&lt;p&gt;&#160;&lt;br/&gt;
subprocess.check_call()&#160;&lt;br/&gt;
&#160;&lt;br/&gt;
with something in line with&#160;&lt;br/&gt;
&#160;&lt;br/&gt;
import subprocess&lt;br/&gt;
import traceback&lt;/p&gt;

&lt;p&gt;try:&lt;br/&gt;
&#160; subprocess.check_call(&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;lls&amp;quot;,&amp;quot;l&amp;quot;&amp;#93;&lt;/span&gt;,shell=True)&lt;br/&gt;
&#160; except subprocess.CalledProcessError as e:&lt;br/&gt;
 tb = traceback.format_exc()&lt;br/&gt;
&#160; raise RuntimeError(tb)&lt;br/&gt;
&#160;&lt;br/&gt;
However by setting shell=True makes it more vulnerable if the user gives input. Do you see that this will be a problem in this case? Thanks for the feedback.&#160;&lt;/p&gt;</comment>
                            <comment id="16803185" author="altay" created="Wed, 27 Mar 2019 18:24:54 +0000"  >&lt;p&gt;Yes, I think setting shell = True would be a concern.&lt;/p&gt;

&lt;p&gt;See the docs here: &lt;a href=&quot;https://docs.python.org/2/library/subprocess.html#subprocess.Popen&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.python.org/2/library/subprocess.html#subprocess.Popen&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;And this part specifically: &lt;br/&gt;
&quot;&quot;&quot;&lt;br/&gt;
On Unix with shell=True, the shell defaults to /bin/sh. If args is a string, the string specifies the command to execute through the shell. This means that the string must be formatted exactly as it would be when typed at the shell prompt. This includes, for example, quoting or backslash escaping filenames with spaces in them. If args is a sequence, the first item specifies the command string, and any additional items will be treated as additional arguments to the shell itself. That is to say, Popen does the equivalent of:&lt;br/&gt;
&quot;&quot;&quot;&lt;/p&gt;

&lt;p&gt;There are some use case where a Beam pipeline will be constructed on behalf of a user in a new environment. (E.g. a service that is built on top of beam but hides implementation details.) Setting shell=True here will expose those use cases to potential exploitation with this user provided input.&lt;/p&gt;</comment>
                            <comment id="16803730" author="nikenano" created="Thu, 28 Mar 2019 09:16:11 +0000"  >&lt;p&gt;Thanks, will not use shell=True on Linux as a part of the solution. Have made a pull request for a solution and asked Yueyang/Pablo to review it.&#160;&lt;/p&gt;</comment>
                            <comment id="16821316" author="nikenano" created="Thu, 18 Apr 2019 17:11:52 +0000"  >&lt;p&gt;It has now been merged in to develop branch and should be done&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 30 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ldun:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>