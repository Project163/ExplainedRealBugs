<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 11:08:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-9815] beam_PostCommit_Go perma red due to failing to start container</title>
                <link>https://issues.apache.org/jira/browse/BEAM-9815</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;For example,&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://builds.apache.org/job/beam_PostCommit_Go/6847/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/beam_PostCommit_Go/6847/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://pantheon.corp.google.com/logs/viewer?project=apache-beam-testing&amp;amp;folder&amp;amp;organizationId&amp;amp;minLogLevel=500&amp;amp;expandAll=false&amp;amp;timestamp=2020-04-24T15:09:13.455000000Z&amp;amp;customFacets=&amp;amp;limitCustomFacetWidth=true&amp;amp;interval=NO_LIMIT&amp;amp;resource=dataflow_step%2Fjob_id%2F2020-04-24_05_03_49-5495819388067192698&amp;amp;scrollTimestamp=2020-04-24T13:03:38.313084000Z&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://pantheon.corp.google.com/logs/viewer?project=apache-beam-testing&amp;amp;folder&amp;amp;organizationId&amp;amp;minLogLevel=500&amp;amp;expandAll=false&amp;amp;timestamp=2020-04-24T15:09:13.455000000Z&amp;amp;customFacets=&amp;amp;limitCustomFacetWidth=true&amp;amp;interval=NO_LIMIT&amp;amp;resource=dataflow_step%2Fjob_id%2F2020-04-24_05_03_49-5495819388067192698&amp;amp;scrollTimestamp=2020-04-24T13:03:38.313084000Z&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13300826">BEAM-9815</key>
            <summary>beam_PostCommit_Go perma red due to failing to start container</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10101" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">P1</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="robertwb">Robert Bradshaw</assignee>
                                    <reporter username="chamikara">Chamikara Madhusanka Jayalath</reporter>
                        <labels>
                    </labels>
                <created>Fri, 24 Apr 2020 15:10:46 +0000</created>
                <updated>Fri, 29 May 2020 17:13:55 +0000</updated>
                            <resolved>Fri, 29 May 2020 17:13:40 +0000</resolved>
                                                    <fixVersion>Not applicable</fixVersion>
                                    <component>sdk-go</component>
                    <component>test-failures</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="9600">2h 40m</timespent>
                                <comments>
                            <comment id="17091727" author="lostluck" created="Fri, 24 Apr 2020 16:47:02 +0000"  >&lt;p&gt;If I knew how to update the Dataflow artifact boot container that&apos;s not been updated I would do it, but I&apos;ve been unable to trace where and how that container is generated or chosen or set by the service.&lt;/p&gt;

&lt;p&gt;Last I heard, it might require a Dataflow service release to resolve. Given that Dataflow doesn&apos;t yet support the using the Go SDK on it&apos;s service, I suspect this will not be a high priority at this time.&lt;/p&gt;

&lt;p&gt;I&apos;m happier that the Flink and Spark runs, which are the same tests, are still passing however.&lt;/p&gt;</comment>
                            <comment id="17092314" author="lostluck" created="Sat, 25 Apr 2020 18:40:25 +0000"  >&lt;p&gt;Digging into this further, it reads like the &quot;apache/beam_go_sdk:dev&quot; is not found, and IIRC we changed all that up lately, so it&apos;s probable that the container was never built and doesn&apos;t exist at all at this point.&lt;/p&gt;

&lt;p&gt;This commit removed the Go SDK containers from the release, which was when we moved from our own repo to the official apache repo.&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/beam/commit/061c5c7db5064e20eef50a6a51f976235b30aae2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/commit/061c5c7db5064e20eef50a6a51f976235b30aae2&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17092371" author="lostluck" created="Sat, 25 Apr 2020 21:31:08 +0000"  >&lt;p&gt;Confirmed, that the &quot;dev&quot; tag doesn&apos;t exist&lt;br/&gt;
&lt;a href=&quot;https://hub.docker.com/r/apache/beam_go_sdk/tags&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hub.docker.com/r/apache/beam_go_sdk/tags&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Which comes from &lt;a href=&quot;https://github.com/apache/beam/blob/master/sdks/go/test/run_integration_tests.sh#L152&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/master/sdks/go/test/run_integration_tests.sh#L152&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;And I think this worked before since previously something else changed as well, since the tests should be building and pushing an image to the beam testing repo, and no defaulting to the &quot;dev&quot; tagged image. That path should only be for the universal python runner.&lt;/p&gt;

&lt;p&gt;Which I&apos;ve now confirmed that comparison not working for some reason...&lt;/p&gt;
</comment>
                            <comment id="17092381" author="lostluck" created="Sat, 25 Apr 2020 21:34:10 +0000"  >&lt;p&gt;Further investigation reveals that there must be some other logic error in the artifact fetching in the boot harness.&lt;/p&gt;

&lt;p&gt;First I thought it was an entirely different harness container that was on the dataflow side, but it turns out if I modify the &lt;span class=&quot;error&quot;&gt;&amp;#91;go binary booter&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/apache/beam/blob/master/sdks/go/container/boot.go&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/master/sdks/go/container/boot.go&lt;/a&gt;) it is reflected when submitting the job, so for some reason the artifacts are either being queried incorrectly, OR being staged incorrectly, leading to the &quot;No artifacts staged&quot; message.&lt;/p&gt;</comment>
                            <comment id="17092390" author="lostluck" created="Sat, 25 Apr 2020 21:43:57 +0000"  >&lt;p&gt;`2020/04/25 21:29:37 Initializing AWESOME Go harness: /opt/apache/beam/boot --id=1 --logging_endpoint=localhost:12370 --control_endpoint=localhost:12371 --artifact_endpoint=localhost:12372 --provision_endpoint=localhost:12373 --semi_persist_dir=/var/opt/google`&lt;/p&gt;

&lt;p&gt;is what Dataflow tells the boot container, while for Flink, only the provision service is provided.&lt;/p&gt;

&lt;p&gt;`12:16:29 2020/04/25 19:16:28 Initializing Go harness: /opt/apache/beam/boot --id=23-1 --provision_endpoint=localhost:46247`&lt;/p&gt;</comment>
                            <comment id="17092397" author="lostluck" created="Sat, 25 Apr 2020 22:16:47 +0000"  >&lt;p&gt;The provision info for dataflow has no depenencies listed (though the pipeline proto does have one listed), and also no retrieval token. So a &quot;quick&quot; fix might be to hack it to assume something is there.&lt;/p&gt;

&lt;p&gt;The data there was not at the &quot;assumed&quot; path on the worker, and it never used the staging location for the worker binary.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://pantheon.corp.google.com/storage/browser/temp-storage-for-end-to-end-tests/staging-validatesrunner-test/go-1-1587852331972351853/?forceOnBucketsSortingFiltering=false&amp;amp;project=apache-beam-testing&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://pantheon.corp.google.com/storage/browser/temp-storage-for-end-to-end-tests/staging-validatesrunner-test/go-1-1587852331972351853/?forceOnBucketsSortingFiltering=false&amp;amp;project=apache-beam-testing&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But the model was able to be found at the staging location (which makes sense since we can see it in the dataflow explorer there).&lt;br/&gt;
I 2020-04-25T22:06:49.848812Z Downloading: gs://temp-storage-for-end-to-end-tests/staging-validatesrunner-test/go-2-1587852331972428268/model to /tmp/tmp/download.0.148567144/file.0 (size: 3 Kb, MD5: sceqVeC8VgLLgWXiRJ0Kvg==) &lt;br/&gt;
I 2020-04-25T22:06:49.952462Z Download completed: gs://temp-storage-for-end-to-end-tests/staging-validatesrunner-test/go-2-1587852331972428268/model (duration: 103 ms @ 37 Kb/s) &lt;/p&gt;


&lt;p&gt;So, I&apos;m going to look now where the model is actually getting downloaded (since it&apos;s doing that somewhere, and printing it out), and see why the worker binary is  not getting the same treatment.&lt;/p&gt;</comment>
                            <comment id="17092409" author="lostluck" created="Sat, 25 Apr 2020 22:56:28 +0000"  >&lt;p&gt;I&apos;m going to stop looking at this point, but the open source side seems to be exhausted. The code eventually runs a binary on the Dataflow side to set up an artifact service, that &lt;span class=&quot;error&quot;&gt;&amp;#91;proxies reading from GCS&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/apache/beam/blob/24361d1b5981ef7d18e586a8e5deaf683f4329f1/sdks/go/pkg/beam/artifact/gcsproxy/retrieval.go#L82&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/24361d1b5981ef7d18e586a8e5deaf683f4329f1/sdks/go/pkg/beam/artifact/gcsproxy/retrieval.go#L82&lt;/a&gt;). That code &lt;/p&gt;

&lt;p&gt;is in the &lt;span class=&quot;error&quot;&gt;&amp;#91;artifact package&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/apache/beam/blob/24361d1b5981ef7d18e586a8e5deaf683f4329f1/sdks/go/pkg/beam/artifact/materialize.go#L135&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/24361d1b5981ef7d18e586a8e5deaf683f4329f1/sdks/go/pkg/beam/artifact/materialize.go#L135&lt;/a&gt;) though it&apos;s called from something inside google. That there might have some kind of version skew with the container/boot.go code, and need updating on the google side. I&apos;m unable to figure that one out at this time.&lt;/p&gt;</comment>
                            <comment id="17117009" author="lostluck" created="Tue, 26 May 2020 19:53:38 +0000"  >&lt;p&gt;This seems to be resolved since Dataflow updated.&lt;/p&gt;</comment>
                            <comment id="17119773" author="lostluck" created="Fri, 29 May 2020 17:13:40 +0000"  >&lt;p&gt;Dataflow&apos;s portable artifact service was updated, so Go Dataflow PostCommits are green again.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 24 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0e1js:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>