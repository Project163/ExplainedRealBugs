<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 11:19:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-12258] SQL postcommit timing out</title>
                <link>https://issues.apache.org/jira/browse/BEAM-12258</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;SQL postcommit (&lt;a href=&quot;https://ci-beam.apache.org/job/beam_PostCommit_SQL/)&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-beam.apache.org/job/beam_PostCommit_SQL/)&lt;/a&gt;&#160;is timing out (and the timeout is already 4 hours!). Looks like it&apos;s stuck on &quot;Task :sdks:java:extensions:sql:integrationTest&quot;.&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13376114">BEAM-12258</key>
            <summary>SQL postcommit timing out</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10101" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">P1</priority>
                        <status id="10722" iconUrl="https://issues.apache.org/jira/images/icons/statuses/generic.png" description="">Triage Needed</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bhulette">Brian Hulette</assignee>
                                    <reporter username="ibzib">Kyle Weaver</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 Apr 2021 17:06:48 +0000</created>
                <updated>Thu, 28 Nov 2024 10:37:02 +0000</updated>
                            <resolved>Tue, 25 May 2021 20:23:09 +0000</resolved>
                                                    <fixVersion>2.31.0</fixVersion>
                                    <component>dsl-sql</component>
                    <component>test-failures</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="9600">2h 40m</timespent>
                                <comments>
                            <comment id="17337520" author="ibzib" created="Fri, 30 Apr 2021 17:11:34 +0000"  >&lt;p&gt;Before it started timing out, runtimes were around 10-40 minutes.&lt;/p&gt;</comment>
                            <comment id="17338670" author="bhulette" created="Mon, 3 May 2021 23:33:49 +0000"  >&lt;p&gt;It seems likely this is due to to one of the commits included in the first run that timed out (&lt;a href=&quot;https://ci-beam.apache.org/job/beam_PostCommit_SQL/6220/):&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-beam.apache.org/job/beam_PostCommit_SQL/6220/):&lt;/a&gt;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/BEAM-9283&quot; title=&quot;Add Spark 3 test jobs to the CI (Java 11)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BEAM-9283&quot;&gt;&lt;del&gt;BEAM-9283&lt;/del&gt;&lt;/a&gt; Disable caching ValidatesRunner tests tasks (commit: 62b9c0f) (details / githubweb)&lt;/li&gt;
	&lt;li&gt;Enable dual job submission for Dataflow (commit: d284d07) (details / githubweb)&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/BEAM-12045&quot; title=&quot;Add cloud profiler agent to Java SDK harness container&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BEAM-12045&quot;&gt;&lt;del&gt;BEAM-12045&lt;/del&gt;&lt;/a&gt; Install google cloud profiler agent in java sdk container (commit: eca1426) (details / githubweb)&lt;/li&gt;
	&lt;li&gt;Fix worker_pool plumbing to use a mutable List. (commit: 62d6d41) (details / githubweb)&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/BEAM-12237&quot; title=&quot;Samza Portable Pipeline High CPU Usage in IDEA&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BEAM-12237&quot;&gt;&lt;del&gt;BEAM-12237&lt;/del&gt;&lt;/a&gt; Fix logging in Samza Runner (#14657) (commit: b379725) (details / githubweb)&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/BEAM-2085&quot; title=&quot;Transforms could give hints to runners on resource requirements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BEAM-2085&quot;&gt;BEAM-2085&lt;/a&gt; Add resource hints support in Java SDK. (commit: 729a5ed) (details / githubweb)&lt;/li&gt;
	&lt;li&gt;Translate Resource Hints into v1beta3 API in DF Runner and add test (commit: d15c210) (details / githubweb)&lt;/li&gt;
	&lt;li&gt;Support passing resource hints through pipeline options. (commit: 270903b) (details / githubweb)&lt;/li&gt;
	&lt;li&gt;Add resource hints supported by Dataflow. (commit: 9a9fb44) (details / githubweb)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17339710" author="bhulette" created="Wed, 5 May 2021 15:28:51 +0000"  >&lt;p&gt;I&apos;m going to try bisecting to look for a culprit&lt;/p&gt;</comment>
                            <comment id="17339753" author="bhulette" created="Wed, 5 May 2021 16:22:34 +0000"  >&lt;p&gt;Seems to be reproducible locally with a 30 minute timeout on ./gradlew :sdks:java:extensions:sql:integrationTest&lt;/p&gt;

&lt;p&gt;Passes at ebdfee9f0994d48db882973d2fa945a93484c186, fails at a25261a5d967bce5e6e4e3d1864ca92d6248d4f0&lt;/p&gt;

&lt;p&gt;Bisect should identify one of the above commits in a few hours&lt;/p&gt;</comment>
                            <comment id="17339773" author="bhulette" created="Wed, 5 May 2021 16:53:55 +0000"  >&lt;p&gt;Problematic commit is &lt;a href=&quot;https://github.com/apache/beam/commit/270903beb8a33cec68e5d9c70eccb6a8d08965ac&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/commit/270903beb8a33cec68e5d9c70eccb6a8d08965ac&lt;/a&gt;, &lt;a href=&quot;https://github.com/apache/beam/pull/14607&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/14607&lt;/a&gt; &quot;Support passing resource hints through pipeline options.&quot;&lt;/p&gt;</comment>
                            <comment id="17339777" author="bhulette" created="Wed, 5 May 2021 17:03:18 +0000"  >&lt;p&gt;Ah actually that commit causes :integrationTest to fail just because it doesn&apos;t compile.&lt;/p&gt;</comment>
                            <comment id="17339867" author="bhulette" created="Wed, 5 May 2021 19:30:19 +0000"  >&lt;p&gt;My journey into this failure is nearing its end. A couple of things going wrong:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;A timeout had reversed logic, so the test hung indefinitely rather than failing fast (fix: pr/14732)&lt;/li&gt;
	&lt;li&gt;testSQLLimit was throwing an exception inside a forked thread, so we hit the above timeout rather than seeing the exception&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The actual exception is related to the new resource hint pipelineOption. It seems we&apos;re incorrectly sending the default value (null) over JdbcConnection as a List with a single element &quot;null&quot;. We get an IllegalArgumentException when parsing that, here: &lt;a href=&quot;https://github.com/apache/beam/blob/2d253f915003279878b77827301428649881bec7/sdks/java/core/src/main/java/org/apache/beam/sdk/transforms/resourcehints/ResourceHints.java#L96&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/2d253f915003279878b77827301428649881bec7/sdks/java/core/src/main/java/org/apache/beam/sdk/transforms/resourcehints/ResourceHints.java#L96&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17347123" author="ibzib" created="Tue, 18 May 2021 19:11:27 +0000"  >&lt;p&gt;It&apos;s still timing out, so there must be a separate cause with the same symptoms. Leaving this open.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://ci-beam.apache.org/job/beam_PostCommit_SQL/6293/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-beam.apache.org/job/beam_PostCommit_SQL/6293/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17347130" author="bhulette" created="Tue, 18 May 2021 19:54:35 +0000"  >&lt;p&gt;It&apos;s not &lt;em&gt;still&lt;/em&gt; timing out, the suite had been passing (aside from flakes) since May 8. I&apos;ll take a look at the new timeout&lt;/p&gt;</comment>
                            <comment id="17347134" author="bhulette" created="Tue, 18 May 2021 20:00:27 +0000"  >&lt;p&gt;Looks like we&apos;ve had one successful run after the timeout: &lt;a href=&quot;https://ci-beam.apache.org/job/beam_PostCommit_SQL/6294/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-beam.apache.org/job/beam_PostCommit_SQL/6294/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I don&apos;t think this is attributable to changes between those runs, so presumably this is a flake.&lt;/p&gt;</comment>
                            <comment id="17347135" author="bhulette" created="Tue, 18 May 2021 20:01:10 +0000"  >&lt;p&gt;This happened once before: &lt;a href=&quot;https://ci-beam.apache.org/job/beam_PostCommit_SQL/6283/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-beam.apache.org/job/beam_PostCommit_SQL/6283/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17347181" author="ibzib" created="Tue, 18 May 2021 21:50:44 +0000"  >&lt;p&gt;Thanks for clarifying, Brian. I&apos;m curious how you found the earlier failure?&lt;/p&gt;

&lt;p&gt;Not even knowing which class is stuck is painful.&#160;The simplest solution may be to just slap a very high (10-20min) per-test Junit timeout on the dozen-or-so test classes in this suite. Unfortunately, it looks like Gradle doesn&apos;t have builtin support for this, so the alternative is to install a plugin. I looked up &lt;a href=&quot;https://github.com/tableau/gradle-test-timeout&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tableau/gradle-test-timeout&lt;/a&gt;&#160;but it isn&apos;t published, so we&apos;d have to copy and build it ourselves.&lt;/p&gt;</comment>
                            <comment id="17347197" author="bhulette" created="Tue, 18 May 2021 22:28:00 +0000"  >&lt;p&gt;&amp;gt;  I&apos;m curious how you found the earlier failure?&lt;/p&gt;

&lt;p&gt;Just by browsing through Build History at &lt;a href=&quot;https://ci-beam.apache.org/job/beam_PostCommit_SQL/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-beam.apache.org/job/beam_PostCommit_SQL/&lt;/a&gt; and looking for black dots&lt;/p&gt;</comment>
                            <comment id="17347198" author="bhulette" created="Tue, 18 May 2021 22:29:00 +0000"  >&lt;p&gt;Could we do it via junit with this Rule: &lt;a href=&quot;https://junit.org/junit4/javadoc/4.12/org/junit/rules/Timeout.html?&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://junit.org/junit4/javadoc/4.12/org/junit/rules/Timeout.html?&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="13376688">BEAM-12285</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13376845">BEAM-12290</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 25 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0qmsw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>