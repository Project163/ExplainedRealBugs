<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 10:50:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-4041] Performance tests fail due to kubernetes load balancer problems</title>
                <link>https://issues.apache.org/jira/browse/BEAM-4041</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;Recently, as we added more IOITs to be run on jenkins using kubernetes, some of them started to fail randomly, because they couldn&apos;t retrieve LoadBalancer address. Normally&#160;obtaining the&#160;address took&#160;about one minute.&#160;Perfkit waits for the address (actively checking for it) for 3 minutes. This should be enough for getting the address, yet it recently started to exceed the 3 minutes limit. I also noticed that this error&#160;didn&apos;t happen when there were fewer tests.&lt;/p&gt;

&lt;p&gt;Example logs:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://builds.apache.org/view/A-D/view/Beam/job/beam_PerformanceTests_Compressed_TextIOIT_HDFS/31/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/view/A-D/view/Beam/job/beam_PerformanceTests_Compressed_TextIOIT_HDFS/31/console&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13151342">BEAM-4041</key>
            <summary>Performance tests fail due to kubernetes load balancer problems</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="&#321;ukaszG">Lukasz Gajowy</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Apr 2018 10:58:37 +0000</created>
                <updated>Sat, 16 May 2020 14:11:51 +0000</updated>
                            <resolved>Thu, 19 Dec 2019 15:32:58 +0000</resolved>
                                                    <fixVersion>Not applicable</fixVersion>
                                    <component>testing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3600">1h</timespent>
                                <comments>
                            <comment id="16432075" author="&#322;ukaszg" created="Tue, 10 Apr 2018 11:11:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alanmyrvold&quot; class=&quot;user-hover&quot; rel=&quot;alanmyrvold&quot;&gt;alanmyrvold&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chamikara&quot; class=&quot;user-hover&quot; rel=&quot;chamikara&quot;&gt;chamikara&lt;/a&gt; do you think that this&#160;could be related to some Google Cloud IP addresses quotas?&lt;/p&gt;

&lt;p&gt;When the Performance tests are run on jenkins, there are&#160;7 of them trying to obtain LoadBalancer address in different namespaces but at the same time. Maybe kubernetes&#160;simply has no address&#160;left that could be assigned to the LoadBalancer?&#160;&lt;/p&gt;

&lt;p&gt;Currently, the tests that&#160;use kubernetes and are started simultaneously are:&#160;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;MongoDBIOIT&lt;/li&gt;
	&lt;li&gt;HadoopInputFormatIOIT&lt;/li&gt;
	&lt;li&gt;JdbcIOIT&lt;/li&gt;
	&lt;li&gt;file based tests that use HDFS (added in this PR:&#160;&lt;a href=&quot;https://github.com/apache/beam/pull/4861&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/4861&lt;/a&gt;, 4 of them)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Alternatively, we could try to&#160;increase the waiting for LoadBalancerIP time in Perfkit, but I&apos;m not sure it&apos;s a real issue solver.&#160;&lt;/p&gt;</comment>
                            <comment id="16432144" author="szewinho" created="Tue, 10 Apr 2018 12:00:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alanmyrvold&quot; class=&quot;user-hover&quot; rel=&quot;alanmyrvold&quot;&gt;alanmyrvold&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chamikara&quot; class=&quot;user-hover&quot; rel=&quot;chamikara&quot;&gt;chamikara&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonkuster&quot; class=&quot;user-hover&quot; rel=&quot;jasonkuster&quot;&gt;jasonkuster&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=%C5%81ukaszG&quot; class=&quot;user-hover&quot; rel=&quot;&#321;ukaszG&quot;&gt;&#321;ukaszG&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I have also took a look at that issue and noticed that&#160; we spin our prerformance tests each six hours, so that many jobs try to run at the same time.&#160;It&apos;s possible to easily run them each six hours, but with little time shift ( like +15 min), by modifying cron job settings. This could probably help, but I couldn&apos;t believe that providing just a few external IPs more at single point of time is an issue for GCE. It&apos;s just my guess that maybe it could help.&lt;/p&gt;</comment>
                            <comment id="16480754" author="dariusz.aniszewski" created="Fri, 18 May 2018 14:44:16 +0000"  >&lt;p&gt;Since those issues are still appearing, and &lt;a href=&quot;https://github.com/GoogleCloudPlatform/PerfKitBenchmarker/pull/1641&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this PR to PerfKit&lt;/a&gt;&#160;was merged, I submitted&#160;&lt;a href=&quot;https://github.com/apache/beam/pull/5425&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR 5425&lt;/a&gt;&#160;to increase retry timeout from 3 to 6 minutes - please check it and merge it if it makes sense. If increasing timeout is pointless&#160;please discard the PR.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 26 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3sd47:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>