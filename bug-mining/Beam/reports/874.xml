<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 10:54:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-6082] [SQL] Nexmark 5, 7 time out</title>
                <link>https://issues.apache.org/jira/browse/BEAM-6082</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;SQL Nexmark Queries 5 and 7 are timing out since around October 29:&#160;&lt;a href=&quot;https://apache-beam-testing.appspot.com/explore?dashboard=5084698770407424&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://apache-beam-testing.appspot.com/explore?dashboard=5084698770407424&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Current suspect is&#160;&lt;a href=&quot;https://github.com/apache/beam/pull/6856&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/6856&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13199009">BEAM-6082</key>
            <summary>[SQL] Nexmark 5, 7 time out</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10100" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">P0</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kenn">Kenneth Knowles</assignee>
                                    <reporter username="kedin">Anton Kedin</reporter>
                        <labels>
                    </labels>
                <created>Fri, 16 Nov 2018 18:58:39 +0000</created>
                <updated>Sat, 16 May 2020 14:21:05 +0000</updated>
                            <resolved>Tue, 27 Nov 2018 21:42:57 +0000</resolved>
                                                    <fixVersion>2.9.0</fixVersion>
                                    <component>dsl-sql</component>
                    <component>testing-nexmark</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="6600">1h 50m</timespent>
                                <comments>
                            <comment id="16690060" author="kenn" created="Fri, 16 Nov 2018 22:07:00 +0000"  >&lt;p&gt;Going ahead with rollback, after confirming it actually fixes.&lt;/p&gt;</comment>
                            <comment id="16690067" author="kenn" created="Fri, 16 Nov 2018 22:15:49 +0000"  >&lt;p&gt;It would look like &lt;a href=&quot;https://github.com/apache/beam/pull/6883&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/6883&lt;/a&gt;&#160;which was a rolllforward of &lt;a href=&quot;https://github.com/apache/beam/pull/6856&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/6856&lt;/a&gt;&#160;but when I roll it back I don&apos;t see obvious performance recovery.&lt;/p&gt;</comment>
                            <comment id="16690131" author="kenn" created="Fri, 16 Nov 2018 23:31:05 +0000"  >&lt;p&gt;So far, I have not reproduced any change in performance going back across a wide variety of commits :-/&lt;/p&gt;</comment>
                            <comment id="16690176" author="reuvenlax" created="Sat, 17 Nov 2018 00:58:13 +0000"  >&lt;p&gt;So to be clear, we don&apos;t know what&apos;s causing this and it doesn&apos;t appear to be pr/6856?&lt;/p&gt;</comment>
                            <comment id="16690688" author="kenn" created="Sat, 17 Nov 2018 20:16:20 +0000"  >&lt;p&gt;The evidence suggests PR 6883 but it is not conclusive.&lt;/p&gt;</comment>
                            <comment id="16690747" author="reuvenlax" created="Sun, 18 Nov 2018 01:07:41 +0000"  >&lt;p&gt;What does the evidence show? Do we have any heap profiles? Is this one of those 5-second direct-runner tests, or do we have evidence from a better run?&lt;/p&gt;

&lt;p&gt;Note: 6883 is expected to be slightly slower, as the composed combine uses maps instead of arrays of combiners. However it&apos;s unexpected that this would be a major regression.&#160;&lt;/p&gt;</comment>
                            <comment id="16691223" author="kenn" created="Mon, 19 Nov 2018 03:54:57 +0000"  >&lt;p&gt;The evidence is just the timing of the trouble starting. You can see the charts here:&lt;/p&gt;

&lt;p&gt;Dataflow: &lt;a href=&quot;https://apache-beam-testing.appspot.com/explore?dashboard=5670405876482048&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://apache-beam-testing.appspot.com/explore?dashboard=5670405876482048&lt;/a&gt;&lt;br/&gt;
Direct: &lt;a href=&quot;https://apache-beam-testing.appspot.com/explore?dashboard=5084698770407424&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://apache-beam-testing.appspot.com/explore?dashboard=5084698770407424&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For query 5 it is a 5x slowdown on Dataflow and DirectRunner. I don&apos;t see the same on Spark and it seems like SQL isn&apos;t running on Flink.&lt;/p&gt;

&lt;p&gt;For query 7 it looks like there was a major slowdown but then no more data.&lt;/p&gt;</comment>
                            <comment id="16691353" author="reuvenlax" created="Mon, 19 Nov 2018 08:02:17 +0000"  >&lt;p&gt;ok, in that case I suggest we investigate. How easy is it to run these tests manually?&lt;/p&gt;</comment>
                            <comment id="16692253" author="kenn" created="Mon, 19 Nov 2018 20:50:41 +0000"  >&lt;p&gt;Super easy. There are instructions on the web site. I copied them to the wiki since they are not really for users:&lt;br/&gt;
&lt;a href=&quot;https://cwiki.apache.org/confluence/display/BEAM/Running+Nexmark&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/BEAM/Running+Nexmark&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16692835" author="reuvenlax" created="Tue, 20 Nov 2018 08:30:58 +0000"  >&lt;p&gt;Ok, I&apos;ll try to investigate.&lt;/p&gt;

&lt;p&gt;My memory was that Nexmark SQL tests actually sped up with this PR, which is why I&apos;m surprised. It&apos;s possible I was mistaken at the time when I looked at the dashboard, but also possible that something else regressed the performance.&lt;/p&gt;</comment>
                            <comment id="16693620" author="kenn" created="Tue, 20 Nov 2018 18:19:44 +0000"  >&lt;p&gt;The Dataflow nexmark runs have been unhealthy and just got fixed by &lt;a href=&quot;https://github.com/apache/beam/pull/7041&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/7041&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;It looks like maybe SQL query 5 in batch is OK while SQL query 5 in streaming is still bad. The signal is really poor here, unfortunately. I haven&apos;t done real profiling, just vague association of timing and a little bit of git bisecting (which yielded no info as yet).&lt;/p&gt;</comment>
                            <comment id="16695546" author="reuvenlax" created="Thu, 22 Nov 2018 04:31:20 +0000"  >&lt;p&gt;Note: The same queries on the Spark runner showed no regression, only direct runner appears to have been affected. This may be due to slowing down one of the &quot;extra&quot; checks that the direct runner performs. A PR did go in that affected equality comparison, and that might have slowed down the direct runner&apos;s immutability checks.&lt;/p&gt;</comment>
                            <comment id="16695556" author="kenn" created="Thu, 22 Nov 2018 04:50:53 +0000"  >&lt;p&gt;So the Dataflow stuff on the graph was just jobs failing and timing out from crash looping, etc? No real slowdown outside of DirectRunner?&lt;/p&gt;</comment>
                            <comment id="16695558" author="reuvenlax" created="Thu, 22 Nov 2018 04:54:58 +0000"  >&lt;p&gt;I believe so, but need to verify that.&lt;/p&gt;</comment>
                            <comment id="16699603" author="chamikara" created="Mon, 26 Nov 2018 21:32:54 +0000"  >&lt;p&gt;Can we take this out of &quot;blocker for 2.9.0&quot; status if confirmed to be an expected regression for DirectRunner ?&#160;&lt;/p&gt;</comment>
                            <comment id="16699610" author="kenn" created="Mon, 26 Nov 2018 21:40:56 +0000"  >&lt;p&gt;Taking a look to make sure it is not broken for any runner right now. I&apos;m not clear now whether the job itself goes red when these fail. All jobs seem OK right now.&lt;/p&gt;</comment>
                            <comment id="16699611" author="kenn" created="Mon, 26 Nov 2018 21:45:59 +0000"  >&lt;p&gt;There is still no data for SQL query 7 in Direct runner since 2018-10-29 and Dataflow runner since 2018-10-26.&lt;/p&gt;</comment>
                            <comment id="16699627" author="kenn" created="Mon, 26 Nov 2018 22:09:07 +0000"  >&lt;p&gt;Yea browsing it does look like all the SQL runs across all runners do queries 0-5 and then stop and fail silently.&lt;/p&gt;</comment>
                            <comment id="16699664" author="kenn" created="Mon, 26 Nov 2018 22:51:18 +0000"  >&lt;p&gt;I&apos;ve now reproduced this locally so a fix should be forthcoming. I know the suite does work, since I also run it pretty often. It has got to be something to do with the configurations.&lt;/p&gt;</comment>
                            <comment id="16699681" author="kenn" created="Mon, 26 Nov 2018 23:07:04 +0000"  >&lt;p&gt;This was simply an incorrect translation of numbers to names by me in c4667f071d86205e23782c05a1f647b106d072ff. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/thumbs_down.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16699692" author="kenn" created="Mon, 26 Nov 2018 23:17:29 +0000"  >&lt;p&gt;Summarizing here:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The data for SQL Query 5 was being attributed to Query 4, which doesn&apos;t exist in SQL so it isn&apos;t on the dashboards.&lt;/li&gt;
	&lt;li&gt;The data for SQL Query 7 was being attributed to Query 5, and shows a straight line trend with no regression for production runners. There &lt;em&gt;is&lt;/em&gt; a massive regression on the Direct runner, which is expected due to immutability and encodeability enforcement. You can see this regression happened just before I broke the data reporting.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16699696" author="kenn" created="Mon, 26 Nov 2018 23:18:16 +0000"  >&lt;p&gt;I think I will leave this as a blocker as we should cherrypick the fix so perf tests against historical releases work properly.&lt;/p&gt;</comment>
                            <comment id="16701069" author="chamikara" created="Tue, 27 Nov 2018 21:34:01 +0000"  >&lt;p&gt;Kenn, this can be resolved now, right ?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 50 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|s00ljs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>