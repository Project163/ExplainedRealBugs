<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 11:22:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-13480] apache_beam.io.gcp.pubsub_integration_test.PubSubIntegrationTest.test_streaming_data_only is flaky</title>
                <link>https://issues.apache.org/jira/browse/BEAM-13480</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;One of the integration tests is failing in &lt;b&gt;PostCommits&lt;/b&gt;:&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://ci-beam.apache.org/job/beam_PostCommit_Python36/lastBuild/testReport/apache_beam.io.gcp.pubsub_integration_test/PubSubIntegrationTest/test_streaming_data_only/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-beam.apache.org/job/beam_PostCommit_Python36/lastBuild/testReport/apache_beam.io.gcp.pubsub_integration_test/PubSubIntegrationTest/test_streaming_data_only/&lt;/a&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
self = &amp;lt;apache_beam.io.gcp.pubsub_integration_test.PubSubIntegrationTest testMethod=test_streaming_data_only&amp;gt;

    @pytest.mark.it_postcommit
    def test_streaming_data_only(self):
&amp;gt;     self._test_streaming(with_attributes=False)

apache_beam/io/gcp/pubsub_integration_test.py:209: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
apache_beam/io/gcp/pubsub_integration_test.py:205: in _test_streaming
    timestamp_attribute=self.TIMESTAMP_ATTRIBUTE)
apache_beam/io/gcp/pubsub_it_pipeline.py:93: in run_pipeline
    result = p.run()
apache_beam/pipeline.py:573: in run
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.runner.run_pipeline(self, self._options)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &amp;lt;apache_beam.runners.dataflow.test_dataflow_runner.TestDataflowRunner object at 0x7face48c99e8&amp;gt;
pipeline = &amp;lt;apache_beam.pipeline.Pipeline object at 0x7face48c9278&amp;gt;
options = &amp;lt;apache_beam.options.pipeline_options.PipelineOptions object at 0x7face4891588&amp;gt;

    def run_pipeline(self, pipeline, options):
      &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;&quot;Execute test pipeline and verify test matcher&quot;&lt;/span&gt;&quot;&quot;
      test_options = options.view_as(TestOptions)
      on_success_matcher = test_options.on_success_matcher
      wait_duration = test_options.wait_until_finish_duration
      is_streaming = options.view_as(StandardOptions).streaming
    
      # [BEAM-1889] Do not send &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; to remote workers also, there is no need to
      # send &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; option to remote executors.
      test_options.on_success_matcher = None
    
      self.result = &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;().run_pipeline(pipeline, options)
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; self.result.has_job:
        # TODO(markflyhigh)(BEAM-1890): Use print since Nose dosen&apos;t show logs
        # in some cases.
        print(&lt;span class=&quot;code-quote&quot;&gt;&apos;Worker logs: %s&apos;&lt;/span&gt; % self.build_console_url(options))
    
      &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;:
        self.wait_until_in_state(PipelineState.RUNNING)
    
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; is_streaming and not wait_duration:
          _LOGGER.warning(&lt;span class=&quot;code-quote&quot;&gt;&apos;Waiting indefinitely &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; streaming job.&apos;&lt;/span&gt;)
        self.result.wait_until_finish(duration=wait_duration)
    
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; on_success_matcher:
          from hamcrest &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; assert_that as hc_assert_that
&amp;gt;         hc_assert_that(self.result, pickler.loads(on_success_matcher))
E         AssertionError: 
E         Expected: (Test pipeline expected terminated in state: RUNNING and Expected 4 messages.)
E              but: Expected 4 messages. Got 0 messages. Diffs (item, count):
E           Expected but not in actual: dict_items([(b&lt;span class=&quot;code-quote&quot;&gt;&apos;data001-seen&apos;&lt;/span&gt;, 1), (b&lt;span class=&quot;code-quote&quot;&gt;&apos;data002-seen&apos;&lt;/span&gt;, 1), (b&lt;span class=&quot;code-quote&quot;&gt;&apos;data003\xab\xac-seen&apos;&lt;/span&gt;, 1), (b&lt;span class=&quot;code-quote&quot;&gt;&apos;data004\xab\xac-seen&apos;&lt;/span&gt;, 1)])
E           Unexpected: dict_items([])

apache_beam/runners/dataflow/test_dataflow_runner.py:68: AssertionError&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13418035">BEAM-13480</key>
            <summary>apache_beam.io.gcp.pubsub_integration_test.PubSubIntegrationTest.test_streaming_data_only is flaky</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="10722" iconUrl="https://issues.apache.org/jira/images/icons/statuses/generic.png" description="">Triage Needed</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="yeandy">Andy Ye</reporter>
                        <labels>
                            <label>sickbay</label>
                    </labels>
                <created>Thu, 16 Dec 2021 16:25:53 +0000</created>
                <updated>Sat, 23 Nov 2024 09:37:34 +0000</updated>
                                                                            <component>test-failures</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="16800">4h 40m</timespent>
                                <comments>
                            <comment id="17461183" author="tvalentyn" created="Fri, 17 Dec 2021 04:02:20 +0000"  >&lt;p&gt;Is this a new failure?&lt;/p&gt;

&lt;p&gt;It seems that this test is failing only some of the time: &lt;br/&gt;
&lt;a href=&quot;https://ci-beam.apache.org/job/beam_PostCommit_Python38/2047/#showFailuresLink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-beam.apache.org/job/beam_PostCommit_Python38/2047/#showFailuresLink&lt;/a&gt; (fails)&lt;br/&gt;
&lt;a href=&quot;https://ci-beam.apache.org/job/beam_PostCommit_Python38/2048/#showFailuresLink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-beam.apache.org/job/beam_PostCommit_Python38/2048/#showFailuresLink&lt;/a&gt; (doesn&apos;t fail or at least the failure is not reported)&lt;/p&gt;</comment>
                            <comment id="17461924" author="JIRAUSER280331" created="Sat, 18 Dec 2021 16:01:21 +0000"  >&lt;p&gt;Yeah, it appears to be a flaky test. Slip up on terminology was misleading &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17470682" author="JIRAUSER280331" created="Fri, 7 Jan 2022 15:19:56 +0000"  >&lt;p&gt;This has been sickbayed until investigation is complete.&lt;/p&gt;</comment>
                            <comment id="17473512" author="kenn" created="Wed, 12 Jan 2022 03:49:36 +0000"  >&lt;p&gt;This Jira ticket has a pull request attached to it, but is still open. Did the pull request resolve the issue? If so, could you please mark it resolved? This will help the project have a clear view of its open issues.&lt;/p&gt;</comment>
                            <comment id="17474704" author="JIRAUSER280331" created="Wed, 12 Jan 2022 16:54:37 +0000"  >&lt;p&gt;The issue has not been fully resolved. We merged &lt;a href=&quot;https://github.com/apache/beam/pull/16255&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR16255&lt;/a&gt; to skip the flaky test while we investigate the issue. I&apos;ve downgraded it to P2 for now.&lt;/p&gt;</comment>
                            <comment id="17476480" author="JIRAUSER280331" created="Fri, 14 Jan 2022 23:46:49 +0000"  >&lt;p&gt;Increased timeout to fix this issue.&lt;/p&gt;</comment>
                            <comment id="17531747" author="tvalentyn" created="Wed, 4 May 2022 14:23:47 +0000"  >&lt;p&gt;Still happening:&lt;/p&gt;

&lt;p&gt;apache_beam.io.gcp.pubsub_integration_test.PubSubIntegrationTest.test_streaming_data_only (from directRunnerIT-batch)&lt;/p&gt;

&lt;p&gt;Failing for the past 1 build (Since #5168 )&lt;br/&gt;
Took 1 min 4 sec.&lt;br/&gt;
Error Message&lt;br/&gt;
AssertionError:  Expected: (Test pipeline expected terminated in state: RUNNING and Expected 4 messages.)      but: Expected 4 messages. Got 5 messages. Diffs (item, count):   Expected but not in actual: dict_items([])   Unexpected: dict_items(&lt;span class=&quot;error&quot;&gt;&amp;#91;(b&amp;#39;data002-seen&amp;#39;, 1)&amp;#93;&lt;/span&gt;)&lt;br/&gt;
Stacktrace&lt;br/&gt;
self = &amp;lt;apache_beam.io.gcp.pubsub_integration_test.PubSubIntegrationTest testMethod=test_streaming_data_only&amp;gt;&lt;/p&gt;

&lt;p&gt;    @pytest.mark.it_postcommit&lt;br/&gt;
    def test_streaming_data_only(self):&lt;br/&gt;
&amp;gt;     self._test_streaming(with_attributes=False)&lt;/p&gt;

&lt;p&gt;apache_beam/io/gcp/pubsub_integration_test.py:216: &lt;br/&gt;
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ &lt;br/&gt;
apache_beam/io/gcp/pubsub_integration_test.py:212: in _test_streaming&lt;br/&gt;
    timestamp_attribute=self.TIMESTAMP_ATTRIBUTE)&lt;br/&gt;
apache_beam/io/gcp/pubsub_it_pipeline.py:93: in run_pipeline&lt;br/&gt;
    result = p.run()&lt;br/&gt;
apache_beam/pipeline.py:573: in run&lt;br/&gt;
    return self.runner.run_pipeline(self, self._options)&lt;br/&gt;
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ &lt;/p&gt;

&lt;p&gt;self = &amp;lt;apache_beam.runners.direct.test_direct_runner.TestDirectRunner object at 0x7ff5f73c6d10&amp;gt;&lt;br/&gt;
pipeline = &amp;lt;apache_beam.pipeline.Pipeline object at 0x7ff5f73c6c10&amp;gt;&lt;br/&gt;
options = &amp;lt;apache_beam.options.pipeline_options.PipelineOptions object at 0x7ff5f7c72ad0&amp;gt;&lt;/p&gt;</comment>
                            <comment id="17534400" author="JIRAUSER280331" created="Tue, 10 May 2022 15:14:11 +0000"  >&lt;p&gt;We added some capabilities to see more detailed error messages here &lt;a href=&quot;https://issues.apache.org/jira/browse/BEAM-14439&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/BEAM-14439&lt;/a&gt;, and are looking forward to seeing this error again the next time it fails.&lt;/p&gt;</comment>
                            <comment id="17549831" author="JIRAUSER282469" created="Sat, 4 Jun 2022 23:24:08 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/apache/beam/issues/21403&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/issues/21403&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13411110">BEAM-13218</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 23 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0xsko:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>