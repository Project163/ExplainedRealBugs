<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 11:17:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-11851] ConfluentSchemaRegistryProvider fails when authentication is required</title>
                <link>https://issues.apache.org/jira/browse/BEAM-11851</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;When configuring KafkaIO.reader with ConfluentSchemaRegistryProvider as value deserializer with `basic.auth.credentials.source=AUTH_INO` and `basic.auth.user.info=user:password` properties, it fails to start the pipepline&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[error] java.lang.RuntimeException: Unable to get latest schema metadata &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; subject: identity_users_v2-value
[error]   at org.apache.beam.sdk.io.kafka.ConfluentSchemaRegistryDeserializerProvider.getSchemaMetadata(ConfluentSchemaRegistryDeserializerProvider.java:119)
[error]   at org.apache.beam.sdk.io.kafka.ConfluentSchemaRegistryDeserializerProvider.getAvroSchema(ConfluentSchemaRegistryDeserializerProvider.java:110)
[error]   at org.apache.beam.sdk.io.kafka.ConfluentSchemaRegistryDeserializerProvider.getCoder(ConfluentSchemaRegistryDeserializerProvider.java:106)
[error]   at org.apache.beam.sdk.io.kafka.KafkaIO$Read.getValueCoder(KafkaIO.java:1147)
[error]   at org.apache.beam.sdk.io.kafka.KafkaIO$Read.expand(KafkaIO.java:1052)
[error]   at org.apache.beam.sdk.io.kafka.KafkaIO$Read.expand(KafkaIO.java:481)
[error]   at org.apache.beam.sdk.Pipeline.applyInternal(Pipeline.java:547)
[error]   at org.apache.beam.sdk.Pipeline.applyTransform(Pipeline.java:498)
[error]   at org.apache.beam.sdk.values.PBegin.apply(PBegin.java:56)
[error]   at org.apache.beam.sdk.Pipeline.apply(Pipeline.java:191) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I suspect that it because it reconfigured KafkaAvroDeserializer only in getDeserializer, but doesn&apos;t do so in getCoder.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13360244">BEAM-11851</key>
            <summary>ConfluentSchemaRegistryProvider fails when authentication is required</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tunderhill">Tom Underhill</assignee>
                                    <reporter username="yamlcoder">Maxim Ivanov</reporter>
                        <labels>
                            <label>stale-P2</label>
                    </labels>
                <created>Tue, 23 Feb 2021 06:10:20 +0000</created>
                <updated>Fri, 21 May 2021 17:33:49 +0000</updated>
                            <resolved>Fri, 21 May 2021 17:33:49 +0000</resolved>
                                    <version>2.27.0</version>
                                    <fixVersion>2.31.0</fixVersion>
                                    <component>io-java-kafka</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="6600">1h 50m</timespent>
                                <comments>
                            <comment id="17298243" author="aromanenko" created="Tue, 9 Mar 2021 18:30:01 +0000"  >&lt;p&gt;Thanks for reporting! Do you have a simple code snippet to reproduce it?&lt;/p&gt;</comment>
                            <comment id="17299822" author="tunderhill" created="Thu, 11 Mar 2021 19:22:40 +0000"  >&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Hi Alexey,&lt;/p&gt;

&lt;p&gt;I&apos;m having the same issue trying to connect to a CSR that implements basic authentication. In this case I&apos;m trying to use Confluent Cloud &amp;amp; Confluent Cloud Schema Registry. Connecting to CC is no problem using&#160;.withConsumerConfigUpdates(props) but it&apos;s unclear where or if you can pass along separate API keys and secrets to CC SR.&#160; Any pointers on how to make this work? or does this need a PR?&lt;/p&gt;

&lt;p&gt;Many Thanks!&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.beam.sdk.Pipeline;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.beam.sdk.io.kafka.ConfluentSchemaRegistryDeserializerProvider;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.beam.sdk.io.kafka.KafkaIO;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.beam.sdk.options.PipelineOptions;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.beam.sdk.options.PipelineOptionsFactory;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.kafka.common.serialization.LongDeserializer;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.HashMap;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.Map;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;DataflowJob {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {

        Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; props = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&amp;gt;();
        props.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;auto.offset.reset&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;earliest&quot;&lt;/span&gt;);
        props.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;ssl.endpoint.identification.algorithm&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;https&quot;&lt;/span&gt;);
        props.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;sasl.mechanism&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PLAIN&quot;&lt;/span&gt;);
        props.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;request.timeout.ms&quot;&lt;/span&gt;, 20000);
        props.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;retry.backoff.ms&quot;&lt;/span&gt;, 500);
        props.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;sasl.jaas.config&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.kafka.common.security.plain.PlainLoginModule required username=\&quot;&lt;/span&gt;&amp;lt;CC API KEY&amp;gt;\&lt;span class=&quot;code-quote&quot;&gt;&quot; password=\&quot;&lt;/span&gt;&amp;lt;CC API SECRET&amp;gt;\&lt;span class=&quot;code-quote&quot;&gt;&quot;;&quot;&lt;/span&gt;);
        props.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;security.protocol&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;SASL_SSL&quot;&lt;/span&gt;);

        props.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;schema.registry.url&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;CC-SR-URL&amp;gt;&quot;&lt;/span&gt;);
        props.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;basic.auth.credentials.source&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;USER_INFO&quot;&lt;/span&gt;);
        props.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;basic.auth.user.info&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;CC-SR-KEY:CC-SR-SECRET&amp;gt;&quot;&lt;/span&gt;);

        PipelineOptions options = PipelineOptionsFactory.create();
        Pipeline p = Pipeline.create(options);

        p.apply(KafkaIO.&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;read()
                .withBootstrapServers(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;CC-URL&amp;gt;&quot;&lt;/span&gt;)
                .withTopic(&lt;span class=&quot;code-quote&quot;&gt;&quot;orders&quot;&lt;/span&gt;)
                .withConsumerConfigUpdates(props)
                .withKeyDeserializer(LongDeserializer.class)
                .withValueDeserializer(ConfluentSchemaRegistryDeserializerProvider.of(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;CC-SR-URL&amp;gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;orders-value&quot;&lt;/span&gt;))
                .withoutMetadata()
        );

        p.run().waitUntilFinish();
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;fails with&#160;io.confluent.kafka.schemaregistry.client.rest.exceptions.RestClientException: Unauthorized; error code: 401&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; java.lang.RuntimeException: Unable to get latest schema metadata &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; subject: orders-valueException in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; java.lang.RuntimeException: Unable to get latest schema metadata &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; subject: orders-value at org.apache.beam.sdk.io.kafka.ConfluentSchemaRegistryDeserializerProvider.getSchemaMetadata(ConfluentSchemaRegistryDeserializerProvider.java:119) at org.apache.beam.sdk.io.kafka.ConfluentSchemaRegistryDeserializerProvider.getAvroSchema(ConfluentSchemaRegistryDeserializerProvider.java:110) at org.apache.beam.sdk.io.kafka.ConfluentSchemaRegistryDeserializerProvider.getCoder(ConfluentSchemaRegistryDeserializerProvider.java:106) at org.apache.beam.sdk.io.kafka.KafkaIO$Read.getValueCoder(KafkaIO.java:1192) at org.apache.beam.sdk.io.kafka.KafkaIO$Read.expand(KafkaIO.java:1096) at org.apache.beam.sdk.io.kafka.KafkaIO$Read.expand(KafkaIO.java:486) at org.apache.beam.sdk.Pipeline.applyInternal(Pipeline.java:547) at org.apache.beam.sdk.Pipeline.applyTransform(Pipeline.java:481) at org.apache.beam.sdk.values.PBegin.apply(PBegin.java:44) at org.apache.beam.sdk.io.kafka.KafkaIO$TypedWithoutMetadata.expand(KafkaIO.java:1256) at org.apache.beam.sdk.io.kafka.KafkaIO$TypedWithoutMetadata.expand(KafkaIO.java:1245) at org.apache.beam.sdk.Pipeline.applyInternal(Pipeline.java:547) at org.apache.beam.sdk.Pipeline.applyTransform(Pipeline.java:481) at org.apache.beam.sdk.values.PBegin.apply(PBegin.java:44) at org.apache.beam.sdk.Pipeline.apply(Pipeline.java:176) at DataflowJob.main(DataflowJob.java:30)Caused by: io.confluent.kafka.schemaregistry.client.&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;.exceptions.RestClientException: Unauthorized; error code: 401 at io.confluent.kafka.schemaregistry.client.&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;.RestService.sendHttpRequest(RestService.java:230) at io.confluent.kafka.schemaregistry.client.&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;.RestService.httpRequest(RestService.java:256) at io.confluent.kafka.schemaregistry.client.&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;.RestService.getLatestVersion(RestService.java:515) at io.confluent.kafka.schemaregistry.client.&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;.RestService.getLatestVersion(RestService.java:507) at io.confluent.kafka.schemaregistry.client.CachedSchemaRegistryClient.getLatestSchemaMetadata(CachedSchemaRegistryClient.java:275) at org.apache.beam.sdk.io.kafka.ConfluentSchemaRegistryDeserializerProvider.getSchemaMetadata(ConfluentSchemaRegistryDeserializerProvider.java:116) ... 15 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17300470" author="aromanenko" created="Fri, 12 Mar 2021 17:30:37 +0000"  >&lt;p&gt;Tom,&lt;/p&gt;

&lt;p&gt;Thanks for details! I&apos;ll take a more deep look on this. I think that we need to create additional functionality only if the authentication configuring is not enough (which seems is a case).&#160;&lt;/p&gt;</comment>
                            <comment id="17343384" author="beamjirabot" created="Wed, 12 May 2021 17:19:22 +0000"  >&lt;p&gt;This issue is P2 but has been unassigned without any comment for 60 days so it has been labeled &quot;stale-P2&quot;. If this issue is still affecting you, we care! Please comment and remove the label. Otherwise, in 14 days the issue will be moved to P3.&lt;/p&gt;

&lt;p&gt;Please see &lt;a href=&quot;https://beam.apache.org/contribute/jira-priorities/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://beam.apache.org/contribute/jira-priorities/&lt;/a&gt; for a detailed explanation of what these priorities mean.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 26 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0nyeo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>