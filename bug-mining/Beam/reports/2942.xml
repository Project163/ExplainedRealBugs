<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 11:25:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-12356] BigQueryWriteClient&#160;in DatasetServiceImpl is not closed, which causes &quot;ManagedChannel allocation site&quot; exceptions</title>
                <link>https://issues.apache.org/jira/browse/BEAM-12356</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/beam/blob/v2.29.0/sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/bigquery/BigQueryServicesImpl.java#L461&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;BigQueryWriteClient&lt;/a&gt;&#160;in DatasetServiceImpl (added at &lt;a href=&quot;https://github.com/apache/beam/pull/14309)&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/14309)&lt;/a&gt;&#160;is not closed.&#160; This causes the error logs&#160; in gRPC orphan channel clean up. See &quot;bigquery_grpc.log&quot; in attachments which is extracted from GCP Dataflow. I don&apos;t think this issue affect pipeline runs except the error logs, but could you take a look at that?&lt;/p&gt;

&lt;p&gt;A similar issue is reported for &lt;tt&gt;CloudBigtableIO&lt;/tt&gt; at &lt;a href=&quot;https://github.com/googleapis/java-bigtable-hbase/issues/2658&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/googleapis/java-bigtable-hbase/issues/2658&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13378945">BEAM-12356</key>
            <summary>BigQueryWriteClient&#160;in DatasetServiceImpl is not closed, which causes &quot;ManagedChannel allocation site&quot; exceptions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="reuvenlax">Reuven Lax</assignee>
                                    <reporter username="baeminbo">Minbo Bae</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 May 2021 04:07:42 +0000</created>
                <updated>Sat, 4 Jun 2022 20:47:14 +0000</updated>
                                            <version>2.29.0</version>
                    <version>2.32.0</version>
                    <version>2.33.0</version>
                                    <fixVersion>2.34.0</fixVersion>
                                    <component>io-java-gcp</component>
                        <due></due>
                            <votes>6</votes>
                                    <watches>32</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="39600">11h</timespent>
                                <comments>
                            <comment id="17347731" author="inessa@cyber.nyc.gov" created="Wed, 19 May 2021 15:19:06 +0000"  >&lt;p&gt;Experiencing the same issue which is preventing us from upgrading to latest beam version (which has fixes we need)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Errors:&lt;br/&gt;
message: &quot;&lt;b&gt;&lt;sub&gt;&lt;/b&gt;&lt;/sub&gt;&lt;b&gt;~ Channel ManagedChannelImpl{logId=8776, target=bigquerystorage.googleapis.com:443} was not shutdown properly!!! &lt;sub&gt;&lt;/b&gt;&lt;/sub&gt;&lt;b&gt;~&lt;/b&gt;&lt;br/&gt;
 Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.&quot;&lt;br/&gt;
exception: &quot;java.lang.RuntimeException: ManagedChannel allocation site&lt;br/&gt;
 at io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:93)&lt;br/&gt;
 at io.grpc.internal.ManagedChannelOrphanWrapper.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:53)&lt;br/&gt;
 at io.grpc.internal.ManagedChannelOrphanWrapper.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:44)&lt;br/&gt;
 at io.grpc.internal.ManagedChannelImplBuilder.build(ManagedChannelImplBuilder.java:615)&lt;br/&gt;
 at io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:261)&lt;br/&gt;
 at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createSingleChannel(InstantiatingGrpcChannelProvider.java:327)&lt;br/&gt;
 at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.access$1700(InstantiatingGrpcChannelProvider.java:74)&lt;br/&gt;
 at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider$1.createSingleChannel(InstantiatingGrpcChannelProvider.java:220)&lt;br/&gt;
 at com.google.api.gax.grpc.ChannelPool.create(ChannelPool.java:72)&lt;br/&gt;
 at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createChannel(InstantiatingGrpcChannelProvider.java:227)&lt;br/&gt;
 at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.getTransportChannel(InstantiatingGrpcChannelProvider.java:210)&lt;br/&gt;
 at com.google.api.gax.rpc.ClientContext.create(ClientContext.java:169)&lt;br/&gt;
 at com.google.cloud.bigquery.storage.v1beta2.stub.GrpcBigQueryWriteStub.create(GrpcBigQueryWriteStub.java:138)&lt;br/&gt;
 at com.google.cloud.bigquery.storage.v1beta2.stub.BigQueryWriteStubSettings.createStub(BigQueryWriteStubSettings.java:145)&lt;br/&gt;
 at com.google.cloud.bigquery.storage.v1beta2.BigQueryWriteClient.&amp;lt;init&amp;gt;(BigQueryWriteClient.java:128)&lt;br/&gt;
 at com.google.cloud.bigquery.storage.v1beta2.BigQueryWriteClient.create(BigQueryWriteClient.java:109)&lt;br/&gt;
 at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl.newBigQueryWriteClient(BigQueryServicesImpl.java:1255)&lt;br/&gt;
 at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl.access$800(BigQueryServicesImpl.java:135)&lt;br/&gt;
 at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl$DatasetServiceImpl.&amp;lt;init&amp;gt;(BigQueryServicesImpl.java:521)&lt;br/&gt;
 at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl$DatasetServiceImpl.&amp;lt;init&amp;gt;(BigQueryServicesImpl.java:449)&lt;br/&gt;
 at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl.getDatasetService(BigQueryServicesImpl.java:169)&lt;br/&gt;
 at org.apache.beam.sdk.io.gcp.bigquery.BatchedStreamingWrite.flushRows(BatchedStreamingWrite.java:374)&lt;br/&gt;
 at org.apache.beam.sdk.io.gcp.bigquery.BatchedStreamingWrite.access$800(BatchedStreamingWrite.java:69)&lt;br/&gt;
 at org.apache.beam.sdk.io.gcp.bigquery.BatchedStreamingWrite$BatchAndInsertElements.finishBundle(BatchedStreamingWrite.java:271)&lt;br/&gt;
 at org.apache.beam.sdk.io.gcp.bigquery.BatchedStreamingWrite$BatchAndInsertElements$DoFnInvoker.invokeFinishBundle(Unknown Source)&lt;br/&gt;
 at org.apache.beam.runners.dataflow.worker.repackaged.org.apache.beam.runners.core.SimpleDoFnRunner.finishBundle(SimpleDoFnRunner.java:242)&lt;br/&gt;
 at org.apache.beam.runners.dataflow.worker.SimpleParDoFn.finishBundle(SimpleParDoFn.java:432)&lt;br/&gt;
 at org.apache.beam.runners.dataflow.worker.util.common.worker.ParDoOperation.finish(ParDoOperation.java:56)&lt;br/&gt;
 at org.apache.beam.runners.dataflow.worker.util.common.worker.MapTaskExecutor.execute(MapTaskExecutor.java:103)&lt;br/&gt;
 at org.apache.beam.runners.dataflow.worker.StreamingDataflowWorker.process(StreamingDataflowWorker.java:1430)&lt;br/&gt;
 at org.apache.beam.runners.dataflow.worker.StreamingDataflowWorker.access$1100(StreamingDataflowWorker.java:165)&lt;br/&gt;
 at org.apache.beam.runners.dataflow.worker.StreamingDataflowWorker$7.run(StreamingDataflowWorker.java:1109)&lt;br/&gt;
 at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)&lt;br/&gt;
 at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)&lt;br/&gt;
 at java.lang.Thread.run(Thread.java:748)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Also noticing new error after the upgrade despite using highmem machines:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;exception: &quot;java.lang.OutOfMemoryError: unable to create new native thread&lt;br/&gt;
 at java.lang.Thread.start0(Native Method)&lt;br/&gt;
 at java.lang.Thread.start(Thread.java:717)&lt;br/&gt;
 at java.util.concurrent.ThreadPoolExecutor.addWorker(ThreadPoolExecutor.java:957)&lt;br/&gt;
 at java.util.concurrent.ThreadPoolExecutor.processWorkerExit(ThreadPoolExecutor.java:1025)&lt;br/&gt;
 at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1167)&lt;br/&gt;
 at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)&lt;br/&gt;
 at java.lang.Thread.run(Thread.java:748)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17352680" author="romster" created="Thu, 27 May 2021 18:27:48 +0000"  >&lt;p&gt;Have the same problem.&lt;br/&gt;
Beam version&#160;2.29.0&lt;/p&gt;</comment>
                            <comment id="17356706" author="bhulette" created="Thu, 3 Jun 2021 20:45:39 +0000"  >&lt;p&gt;This should be harmless, especially if you aren&apos;t actually using the storage write API with your BigQueryIO (setUseStorageWriteApi(true)). But agree this is an annoying error log. I&apos;ll see if I can get a patch in&lt;/p&gt;</comment>
                            <comment id="17356716" author="bhulette" created="Thu, 3 Jun 2021 20:58:50 +0000"  >&lt;p&gt;Well after looking it over a little more the proper fix is a little more involved than I can take on right now. Rather than putting the BigQueryWriteClient in DatasetServiceImpl we should have a separate interface (that extends AutoCloseable) for wrapping the BigQueryWriteClient, similar to how we have &lt;tt&gt;StorageClient extends AutoCloseable&lt;/tt&gt; for the &lt;tt&gt;BigQueryStorageClient&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17356717" author="bhulette" created="Thu, 3 Jun 2021 20:59:58 +0000"  >&lt;p&gt;Assigning to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reuvenlax&quot; class=&quot;user-hover&quot; rel=&quot;reuvenlax&quot;&gt;reuvenlax&lt;/a&gt; for now but I think he has limited bandwidth for the next month or so, so anyone should feel free pick this up.&lt;/p&gt;</comment>
                            <comment id="17356720" author="bhulette" created="Thu, 3 Jun 2021 21:06:44 +0000"  >&lt;p&gt;CC: &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chamikara&quot; class=&quot;user-hover&quot; rel=&quot;chamikara&quot;&gt;chamikara&lt;/a&gt; in case you think we should prioritize&lt;/p&gt;</comment>
                            <comment id="17357109" author="dev2null" created="Fri, 4 Jun 2021 06:58:24 +0000"  >&lt;p&gt;Reported the &lt;a href=&quot;https://issues.apache.org/jira/browse/BEAM-12365?focusedCommentId=17356620&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-17356620&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;same issue yesterday&lt;/a&gt; and it blocks us from upgrading to beam 2.29.0 / 2.30.0.&#160;&lt;/p&gt;

&lt;p&gt;We cannot simply ignore all errors being logged as that would mean turning off all production alerts for our dataflow pipelines.&lt;/p&gt;

&lt;p&gt;One workaround might be to suppress all ERROR logs from&#160;io.grpc.internal.ManagedChannelOrphanWrapper but that would hide other issues from that component so it&apos;s not an ideal solution. Any other suggestions?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17357620" author="reuvenlax" created="Fri, 4 Jun 2021 20:51:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/beam/pull/14949&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/14949&lt;/a&gt;&#160;out for review to fix this.&lt;/p&gt;</comment>
                            <comment id="17358770" author="inessa@cyber.nyc.gov" created="Mon, 7 Jun 2021 17:59:35 +0000"  >&lt;p&gt;Thank you for working on this fix. When can we expect this fix to be released?&lt;/p&gt;</comment>
                            <comment id="17358774" author="bhulette" created="Mon, 7 Jun 2021 18:08:02 +0000"  >&lt;p&gt;Yes thank you Reuven!&lt;/p&gt;

&lt;p&gt;I think we should consider cherrypicking the release into 2.31.0, which was cut last week (cc: &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apilloud&quot; class=&quot;user-hover&quot; rel=&quot;apilloud&quot;&gt;apilloud&lt;/a&gt;). If we get it in there it should be ~5 weeks (Normally it takes ~5 weeks from release cut to validation). &lt;/p&gt;</comment>
                            <comment id="17358866" author="apilloud" created="Mon, 7 Jun 2021 20:44:09 +0000"  >&lt;p&gt;The release branch is now available for cherrypicks. What is the ETA on this?&lt;/p&gt;</comment>
                            <comment id="17358869" author="bhulette" created="Mon, 7 Jun 2021 20:55:01 +0000"  >&lt;p&gt;The patch has been reviewed, it&apos;s just blocked on the issue with ci-beam.apache.org&lt;/p&gt;</comment>
                            <comment id="17377933" author="wilson lauw" created="Fri, 9 Jul 2021 08:42:44 +0000"  >&lt;p&gt;Hi, I just tried to upgrade to beam 2.31.0, but I think this issue still persists, I still got error messages like this:&lt;/p&gt;

&lt;p&gt;&#160;&lt;br/&gt;
 SEVERE:&#160;*&lt;b&gt;&#160;&lt;/b&gt;&lt;sub&gt;Channel&#160;ManagedChannelImpl{logId=17,&#160;target=bigquerystorage.googleapis.com:443}&#160;was&#160;not&#160;shutdown&#160;properly!!!&lt;/sub&gt;&lt;b&gt;&#160;&lt;/b&gt;*&lt;br/&gt;
 &#160;&#160;&#160;&#160;Make&#160;sure&#160;to&#160;call&#160;shutdown()/shutdownNow()&#160;and&#160;wait&#160;until&#160;awaitTermination()&#160;returns&#160;true.&lt;br/&gt;
 java.lang.RuntimeException:&#160;ManagedChannel&#160;allocation&#160;site&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:93)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;io.grpc.internal.ManagedChannelOrphanWrapper.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:53)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;io.grpc.internal.ManagedChannelOrphanWrapper.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:44)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;io.grpc.internal.ManagedChannelImplBuilder.build(ManagedChannelImplBuilder.java:615)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:261)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createSingleChannel(InstantiatingGrpcChannelProvider.java:327)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.access$1700(InstantiatingGrpcChannelProvider.java:74)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;com.google.api.gax.grpc.InstantiatingGrpcChannelProvider$1.createSingleChannel(InstantiatingGrpcChannelProvider.java:220)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;com.google.api.gax.grpc.ChannelPool.create(ChannelPool.java:72)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createChannel(InstantiatingGrpcChannelProvider.java:227)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.getTransportChannel(InstantiatingGrpcChannelProvider.java:210)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;com.google.api.gax.rpc.ClientContext.create(ClientContext.java:169)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;com.google.cloud.bigquery.storage.v1beta2.stub.GrpcBigQueryWriteStub.create(GrpcBigQueryWriteStub.java:138)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;com.google.cloud.bigquery.storage.v1beta2.stub.BigQueryWriteStubSettings.createStub(BigQueryWriteStubSettings.java:145)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;com.google.cloud.bigquery.storage.v1beta2.BigQueryWriteClient.&amp;lt;init&amp;gt;(BigQueryWriteClient.java:128)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;com.google.cloud.bigquery.storage.v1beta2.BigQueryWriteClient.create(BigQueryWriteClient.java:109)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl.newBigQueryWriteClient(BigQueryServicesImpl.java:1257)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl.access$800(BigQueryServicesImpl.java:134)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl$DatasetServiceImpl.&amp;lt;init&amp;gt;(BigQueryServicesImpl.java:523)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl$DatasetServiceImpl.&amp;lt;init&amp;gt;(BigQueryServicesImpl.java:451)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl.getDatasetService(BigQueryServicesImpl.java:168)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;org.apache.beam.sdk.io.gcp.bigquery.BigQueryIO$TypedRead.validate(BigQueryIO.java:965)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;org.apache.beam.sdk.Pipeline$ValidateVisitor.enterCompositeTransform(Pipeline.java:662)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;org.apache.beam.sdk.runners.TransformHierarchy$Node.visit(TransformHierarchy.java:581)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;org.apache.beam.sdk.runners.TransformHierarchy$Node.visit(TransformHierarchy.java:585)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;org.apache.beam.sdk.runners.TransformHierarchy$Node.access$500(TransformHierarchy.java:240)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;org.apache.beam.sdk.runners.TransformHierarchy.visit(TransformHierarchy.java:214)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;org.apache.beam.sdk.Pipeline.traverseTopologically(Pipeline.java:469)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;org.apache.beam.sdk.Pipeline.validate(Pipeline.java:598)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;org.apache.beam.sdk.Pipeline.run(Pipeline.java:322)&lt;br/&gt;
 &#160;&#160;&#160;&#160;at&#160;org.apache.beam.sdk.Pipeline.run(Pipeline.java:309)&lt;br/&gt;
 &#160;&lt;br/&gt;
 Does anyone else still encounter the same issue?&lt;/p&gt;</comment>
                            <comment id="17377943" author="wilson lauw" created="Fri, 9 Jul 2021 08:50:03 +0000"  >&lt;p&gt;On the other hand, I understand this is because of a channel that is not closed, which means aside from the error messages, can we can expect no data loss on the pipeline cause by this issue?&lt;/p&gt;</comment>
                            <comment id="17382232" author="jeff.klukas@gmail.com" created="Fri, 16 Jul 2021 17:29:53 +0000"  >&lt;p&gt;I also have just observed a recurrence of this issue in a Dataflow pipeline running Java SDK 2.31.0. We had previously downgraded to 2.28.0 waiting for this fix. It looks to be less frequent than it was on 2.29.0, but is still happening.&lt;/p&gt;</comment>
                            <comment id="17383270" author="melentye" created="Mon, 19 Jul 2021 11:30:10 +0000"  >&lt;p&gt;Same here, still happening with Beam 2.31&lt;/p&gt;</comment>
                            <comment id="17388097" author="melentye" created="Tue, 27 Jul 2021 14:31:16 +0000"  >&lt;p&gt;Is this going to get reopened?&lt;/p&gt;</comment>
                            <comment id="17395980" author="romster" created="Mon, 9 Aug 2021 11:12:56 +0000"  >&lt;p&gt;Beam&#160;2.31 - Don&apos;t see the error anymore.&lt;/p&gt;</comment>
                            <comment id="17396048" author="jonnydaenen" created="Mon, 9 Aug 2021 13:37:17 +0000"  >&lt;p&gt;I still experience the error in our integration tests with Beam 2.31&lt;/p&gt;</comment>
                            <comment id="17396110" author="rlax@alumni.rice.edu" created="Mon, 9 Aug 2021 15:28:00 +0000"  >&lt;p&gt;Are you seeing actual pipeline problems due to this error, or is it simply&lt;br/&gt;
the error in the logs? How frequent is the error?&lt;/p&gt;

</comment>
                            <comment id="17396558" author="mkotsbak" created="Tue, 10 Aug 2021 09:11:13 +0000"  >&lt;p&gt;We still see this after upgrade to Beam 2.31. Very frequent, but does not seem to affect any behavior. Please reopen or open a new issue about this.&lt;/p&gt;</comment>
                            <comment id="17396734" author="rlax@alumni.rice.edu" created="Tue, 10 Aug 2021 15:11:00 +0000"  >&lt;p&gt;Can you quantify &quot;very frequent?&quot; Does this happen&lt;br/&gt;
continuously multiple times within a second?&lt;/p&gt;

&lt;p&gt;On Tue, Aug 10, 2021 at 2:12 AM Marius Kotsbak (Jira) &amp;lt;jira@apache.org&amp;gt;&lt;/p&gt;
</comment>
                            <comment id="17396761" author="jeff.klukas@gmail.com" created="Tue, 10 Aug 2021 16:19:51 +0000"  >&lt;p&gt;Looking at one of our currently deployed streaming pipelines on 2.31.0, we only have a handful of these messages once every day or two. So not very frequent in our case.&lt;/p&gt;</comment>
                            <comment id="17408550" author="joachim isaksson" created="Thu, 2 Sep 2021 05:48:33 +0000"  >&lt;p&gt;With 2.31 we see it 70-100ish times in a 5 minute integration test, and once every few seconds at low load. Have not had the opportunity to test at production like loads yet.&lt;/p&gt;</comment>
                            <comment id="17409700" author="apilloud" created="Fri, 3 Sep 2021 20:22:43 +0000"  >&lt;p&gt;For another datapoint this test produces the message 4 times over 10 seconds:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
./gradlew :sdks:java:extensions:sql:integrationTest --tests org.apache.beam.sdk.extensions.sql.meta.provider.bigquery.BigQueryReadWriteIT.testSQLRead_withDirectRead_withProjectPushDown --info
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17412078" author="reuvenlax" created="Wed, 8 Sep 2021 16:54:07 +0000"  >&lt;p&gt;I believe I found the bug. In BatchedStreamingWrite.java, we added a Teardown method to the enclosing PTransform. This is a noop - the Teardown method needs to be in the DoFns themselves.&lt;/p&gt;</comment>
                            <comment id="17412277" author="reuvenlax" created="Thu, 9 Sep 2021 02:18:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/beam/pull/15480&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/15480&lt;/a&gt;&#160;has been merged which should fix this bug.&lt;/p&gt;</comment>
                            <comment id="17421442" author="dev2null" created="Tue, 28 Sep 2021 15:01:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reuvenlax&quot; class=&quot;user-hover&quot; rel=&quot;reuvenlax&quot;&gt;reuvenlax&lt;/a&gt;&#160;Could you consider including &lt;a href=&quot;https://github.com/apache/beam/pull/15480&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/15480&lt;/a&gt;&#160;in the 2.33.0 RC2 build?&lt;/p&gt;</comment>
                            <comment id="17422349" author="piter" created="Wed, 29 Sep 2021 19:06:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reuvenlax&quot; class=&quot;user-hover&quot; rel=&quot;reuvenlax&quot;&gt;reuvenlax&lt;/a&gt;&#160;I have added yet another&#160;&lt;a href=&quot;https://github.com/apache/beam/pull/15621&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;micro fix&lt;/a&gt; for WriteTablesDoFn#finishBundle not using a cached version of DatasetService which still resulted in &quot;ManagedChannel allocation site&quot; exceptions in finishBundle() method.&lt;/p&gt;</comment>
                            <comment id="17449551" author="joachim isaksson" created="Fri, 26 Nov 2021 12:21:11 +0000"  >&lt;p&gt;I still have the same message in 2.34 (not quite the same stack trace as above but originating from org.apache.beam.sdk.io.gcp.bigquery.BigQuerySourceBase.extractFiles), should I add more details here or should I create a new issue?&lt;/p&gt;</comment>
                            <comment id="17450556" author="bhulette" created="Mon, 29 Nov 2021 16:02:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Joachim+Isaksson&quot; class=&quot;user-hover&quot; rel=&quot;Joachim Isaksson&quot;&gt;Joachim Isaksson&lt;/a&gt; it probably makes sense to re-open this jira. Could you share the full stacktrace?&lt;/p&gt;</comment>
                            <comment id="17451498" author="JIRAUSER280961" created="Wed, 1 Dec 2021 04:26:10 +0000"  >&lt;p&gt;We upgraded to beam version 2.34.0 and still have the same exceptions. Stacktrace attached below:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.RuntimeException: ManagedChannel allocation site
&#160; &#160; at io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:93)
&#160; &#160; at io.grpc.internal.ManagedChannelOrphanWrapper.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:53)
&#160; &#160; at io.grpc.internal.ManagedChannelOrphanWrapper.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:44)
&#160; &#160; at io.grpc.internal.ManagedChannelImplBuilder.build(ManagedChannelImplBuilder.java:625)
&#160; &#160; at io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:264)
&#160; &#160; at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createSingleChannel(InstantiatingGrpcChannelProvider.java:383)
&#160; &#160; at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.access$1900(InstantiatingGrpcChannelProvider.java:82)
&#160; &#160; at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider$1.createSingleChannel(InstantiatingGrpcChannelProvider.java:239)
&#160; &#160; at com.google.api.gax.grpc.ChannelPool.create(ChannelPool.java:72)
&#160; &#160; at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createChannel(InstantiatingGrpcChannelProvider.java:249)
&#160; &#160; at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.getTransportChannel(InstantiatingGrpcChannelProvider.java:227)
&#160; &#160; at com.google.api.gax.rpc.ClientContext.create(ClientContext.java:205)
&#160; &#160; at com.google.cloud.bigquery.storage.v1beta2.stub.GrpcBigQueryWriteStub.create(GrpcBigQueryWriteStub.java:136)
&#160; &#160; at com.google.cloud.bigquery.storage.v1beta2.stub.BigQueryWriteStubSettings.createStub(BigQueryWriteStubSettings.java:145)
&#160; &#160; at com.google.cloud.bigquery.storage.v1beta2.BigQueryWriteClient.&amp;lt;init&amp;gt;(BigQueryWriteClient.java:128)
&#160; &#160; at com.google.cloud.bigquery.storage.v1beta2.BigQueryWriteClient.create(BigQueryWriteClient.java:109)
&#160; &#160; at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl.newBigQueryWriteClient(BigQueryServicesImpl.java:1271)
&#160; &#160; at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl.access$800(BigQueryServicesImpl.java:144)
&#160; &#160; at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl$DatasetServiceImpl.&amp;lt;init&amp;gt;(BigQueryServicesImpl.java:518)
&#160; &#160; at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl$DatasetServiceImpl.&amp;lt;init&amp;gt;(BigQueryServicesImpl.java:463)
&#160; &#160; at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl.getDatasetService(BigQueryServicesImpl.java:180)
&#160; &#160; at org.apache.beam.sdk.io.gcp.bigquery.BigQueryStorageQuerySource.getTargetTable(BigQueryStorageQuerySource.java:176)
&#160; &#160; at org.apache.beam.sdk.io.gcp.bigquery.BigQueryStorageSourceBase.split(BigQueryStorageSourceBase.java:108)
&#160; &#160; at org.apache.beam.runners.dataflow.worker.WorkerCustomSources.splitAndValidate(WorkerCustomSources.java:295)
&#160; &#160; at org.apache.beam.runners.dataflow.worker.WorkerCustomSources.performSplitTyped(WorkerCustomSources.java:217)
&#160; &#160; at org.apache.beam.runners.dataflow.worker.WorkerCustomSources.performSplitWithApiLimit(WorkerCustomSources.java:201)
&#160; &#160; at org.apache.beam.runners.dataflow.worker.WorkerCustomSources.performSplit(WorkerCustomSources.java:180)
&#160; &#160; at org.apache.beam.runners.dataflow.worker.WorkerCustomSourceOperationExecutor.execute(WorkerCustomSourceOperationExecutor.java:82)
&#160; &#160; at org.apache.beam.runners.dataflow.worker.BatchDataflowWorker.executeWork(BatchDataflowWorker.java:420)
&#160; &#160; at org.apache.beam.runners.dataflow.worker.BatchDataflowWorker.doWork(BatchDataflowWorker.java:389)
&#160; &#160; at org.apache.beam.runners.dataflow.worker.BatchDataflowWorker.getAndPerformWork(BatchDataflowWorker.java:314)
&#160; &#160; at org.apache.beam.runners.dataflow.worker.DataflowBatchWorkerHarness$WorkerThread.doWork(DataflowBatchWorkerHarness.java:140)
&#160; &#160; at org.apache.beam.runners.dataflow.worker.DataflowBatchWorkerHarness$WorkerThread.call(DataflowBatchWorkerHarness.java:120)
&#160; &#160; at org.apache.beam.runners.dataflow.worker.DataflowBatchWorkerHarness$WorkerThread.call(DataflowBatchWorkerHarness.java:107)
&#160; &#160; at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
&#160; &#160; at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
&#160; &#160; at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
&#160; &#160; at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:834)

*~*~*~ Channel ManagedChannelImpl{logId=43, target=bigquerystorage.googleapis.com:443} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17451500" author="rlax@alumni.rice.edu" created="Wed, 1 Dec 2021 04:33:00 +0000"  >&lt;p&gt;This scenario should be fixed in the next Beam release. However this&lt;br/&gt;
scenario (performSplit) does not happen often, and mostly when a job is&lt;br/&gt;
first starting.&lt;/p&gt;

&lt;p&gt;On Tue, Nov 30, 2021 at 8:27 PM Syril Sadasivan (Jira) &amp;lt;jira@apache.org&amp;gt;&lt;/p&gt;
</comment>
                            <comment id="17457008" author="joachim isaksson" created="Fri, 10 Dec 2021 09:37:58 +0000"  >&lt;p&gt;Sorry for the delay on the stack trace, I have a couple from 2.34;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The first one in PolicyTagManager, sorry for the cutoff but the rest of the stack trace contains info I can&apos;t share (if it&apos;s important I can anonymize and reshare that part too)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2021-12-10T08:51:17.5680978Z SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=7, target=datacatalog.googleapis.com:443} was not shutdown properly!!! ~*~*~*
2021-12-10T08:51:17.5681797Z     Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;.
2021-12-10T08:51:17.5682542Z java.lang.RuntimeException: ManagedChannel allocation site
2021-12-10T08:51:17.5683413Z 	at io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:93)
2021-12-10T08:51:17.5684193Z 	at io.grpc.internal.ManagedChannelOrphanWrapper.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:53)
2021-12-10T08:51:17.5684923Z 	at io.grpc.internal.ManagedChannelOrphanWrapper.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:44)
2021-12-10T08:51:17.5685642Z 	at io.grpc.internal.ManagedChannelImplBuilder.build(ManagedChannelImplBuilder.java:625)
2021-12-10T08:51:17.5686557Z 	at io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:264)
2021-12-10T08:51:17.5687379Z 	at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createSingleChannel(InstantiatingGrpcChannelProvider.java:383)
2021-12-10T08:51:17.5688208Z 	at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.access$1900(InstantiatingGrpcChannelProvider.java:82)
2021-12-10T08:51:17.5689528Z 	at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider$1.createSingleChannel(InstantiatingGrpcChannelProvider.java:239)
2021-12-10T08:51:17.5690369Z 	at com.google.api.gax.grpc.ChannelPool.create(ChannelPool.java:72)
2021-12-10T08:51:17.5691106Z 	at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createChannel(InstantiatingGrpcChannelProvider.java:249)
2021-12-10T08:51:17.5691889Z 	at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.getTransportChannel(InstantiatingGrpcChannelProvider.java:227)
2021-12-10T08:51:17.5692624Z 	at com.google.api.gax.rpc.ClientContext.create(ClientContext.java:205)
2021-12-10T08:51:17.5693347Z 	at com.google.cloud.datacatalog.v1beta1.stub.GrpcPolicyTagManagerStub.create(GrpcPolicyTagManagerStub.java:223)
2021-12-10T08:51:17.5694156Z 	at com.google.cloud.datacatalog.v1beta1.stub.PolicyTagManagerStubSettings.createStub(PolicyTagManagerStubSettings.java:313)
2021-12-10T08:51:17.5695534Z 	at com.google.cloud.datacatalog.v1beta1.PolicyTagManagerClient.&amp;lt;init&amp;gt;(PolicyTagManagerClient.java:144)
2021-12-10T08:51:17.5696475Z 	at com.google.cloud.datacatalog.v1beta1.PolicyTagManagerClient.create(PolicyTagManagerClient.java:125)
2021-12-10T08:51:17.5697332Z 	at com.google.cloud.datacatalog.v1beta1.PolicyTagManagerClient.create(PolicyTagManagerClient.java:116) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The second one in DatasetServiceImpl/extractFiles;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2021-12-10T08:56:26.8375862Z SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=15, target=bigquerystorage.googleapis.com:443} was not shutdown properly!!! ~*~*~*
2021-12-10T08:56:26.8376960Z     Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;.
2021-12-10T08:56:26.8377785Z java.lang.RuntimeException: ManagedChannel allocation site
2021-12-10T08:56:26.8378602Z 	at io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:93)
2021-12-10T08:56:26.8379484Z 	at io.grpc.internal.ManagedChannelOrphanWrapper.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:53)
2021-12-10T08:56:26.8380368Z 	at io.grpc.internal.ManagedChannelOrphanWrapper.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:44)
2021-12-10T08:56:26.8381637Z 	at io.grpc.internal.ManagedChannelImplBuilder.build(ManagedChannelImplBuilder.java:625)
2021-12-10T08:56:26.8382550Z 	at io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:264)
2021-12-10T08:56:26.8383507Z 	at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createSingleChannel(InstantiatingGrpcChannelProvider.java:383)
2021-12-10T08:56:26.8384512Z 	at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.access$1900(InstantiatingGrpcChannelProvider.java:82)
2021-12-10T08:56:26.8385513Z 	at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider$1.createSingleChannel(InstantiatingGrpcChannelProvider.java:239)
2021-12-10T08:56:26.8386426Z 	at com.google.api.gax.grpc.ChannelPool.create(ChannelPool.java:72)
2021-12-10T08:56:26.8387599Z 	at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createChannel(InstantiatingGrpcChannelProvider.java:249)
2021-12-10T08:56:26.8389010Z 	at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.getTransportChannel(InstantiatingGrpcChannelProvider.java:227)
2021-12-10T08:56:26.8390053Z 	at com.google.api.gax.rpc.ClientContext.create(ClientContext.java:205)
2021-12-10T08:56:26.8390933Z 	at com.google.cloud.bigquery.storage.v1beta2.stub.GrpcBigQueryWriteStub.create(GrpcBigQueryWriteStub.java:136)
2021-12-10T08:56:26.8392547Z 	at com.google.cloud.bigquery.storage.v1beta2.stub.BigQueryWriteStubSettings.createStub(BigQueryWriteStubSettings.java:145)
2021-12-10T08:56:26.8393642Z 	at com.google.cloud.bigquery.storage.v1beta2.BigQueryWriteClient.&amp;lt;init&amp;gt;(BigQueryWriteClient.java:128)
2021-12-10T08:56:26.8394532Z 	at com.google.cloud.bigquery.storage.v1beta2.BigQueryWriteClient.create(BigQueryWriteClient.java:109)
2021-12-10T08:56:26.8395431Z 	at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl.newBigQueryWriteClient(BigQueryServicesImpl.java:1271)
2021-12-10T08:56:26.8396337Z 	at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl.access$800(BigQueryServicesImpl.java:144)
2021-12-10T08:56:26.8397268Z 	at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl$DatasetServiceImpl.&amp;lt;init&amp;gt;(BigQueryServicesImpl.java:518)
2021-12-10T08:56:26.8399990Z 	at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl$DatasetServiceImpl.&amp;lt;init&amp;gt;(BigQueryServicesImpl.java:463)
2021-12-10T08:56:26.8403381Z 	at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl.getDatasetService(BigQueryServicesImpl.java:180)
2021-12-10T08:56:26.8404228Z 	at org.apache.beam.sdk.io.gcp.bigquery.BigQuerySourceBase.extractFiles(BigQuerySourceBase.java:117)
2021-12-10T08:56:26.8404879Z 	at org.apache.beam.sdk.io.gcp.bigquery.BigQueryIO$TypedRead$2.processElement(BigQueryIO.java:1123)
2021-12-10T08:56:26.8405690Z 	at org.apache.beam.sdk.io.gcp.bigquery.BigQueryIO$TypedRead$2$DoFnInvoker.invokeProcessElement(Unknown Source)
2021-12-10T08:56:26.8407260Z 	at org.apache.beam.repackaged.direct_java.runners.core.SimpleDoFnRunner.invokeProcessElement(SimpleDoFnRunner.java:232)
2021-12-10T08:56:26.8408344Z 	at org.apache.beam.repackaged.direct_java.runners.core.SimpleDoFnRunner.processElement(SimpleDoFnRunner.java:191)
2021-12-10T08:56:26.8409180Z 	at org.apache.beam.repackaged.direct_java.runners.core.SimplePushbackSideInputDoFnRunner.processElementInReadyWindows(SimplePushbackSideInputDoFnRunner.java:79)
2021-12-10T08:56:26.8409966Z 	at org.apache.beam.runners.direct.ParDoEvaluator.processElement(ParDoEvaluator.java:244)
2021-12-10T08:56:26.8410834Z 	at org.apache.beam.runners.direct.DoFnLifecycleManagerRemovingTransformEvaluator.processElement(DoFnLifecycleManagerRemovingTransformEvaluator.java:54)
2021-12-10T08:56:26.8411561Z 	at org.apache.beam.runners.direct.DirectTransformExecutor.processElements(DirectTransformExecutor.java:165)
2021-12-10T08:56:26.8412197Z 	at org.apache.beam.runners.direct.DirectTransformExecutor.run(DirectTransformExecutor.java:129)
2021-12-10T08:56:26.8412782Z 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
2021-12-10T08:56:26.8413320Z 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
2021-12-10T08:56:26.8413862Z 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
2021-12-10T08:56:26.8414450Z 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
2021-12-10T08:56:26.8415193Z 	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:829) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17464988" author="JIRAUSER282576" created="Fri, 24 Dec 2021 10:58:04 +0000"  >&lt;p&gt;Error still occurs in Apache Beam 2.34 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;

&lt;p&gt;We just upgrade Apache Beam 2.28 to 2.34 to follow Log4j vulnerability recommandation.&lt;br/&gt;
Now, this error message occurs: ( but Dataflow jobs are still working well)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
io.grpc.internal.ManagedChannelOrphanWrapper&lt;span class=&quot;code-quote&quot;&gt;&quot;&#160; message:&#160;&quot;&lt;/span&gt;*~*~*~ Channel ManagedChannelImpl{logId=5, target=bigquerystorage.googleapis.com:443} was not shutdown properly!!! ~*~*~* Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; 

java.lang.RuntimeException: ManagedChannel allocation site
	at io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:93)
	at io.grpc.internal.ManagedChannelOrphanWrapper.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:53)
	at io.grpc.internal.ManagedChannelOrphanWrapper.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:44)
	at io.grpc.internal.ManagedChannelImplBuilder.build(ManagedChannelImplBuilder.java:625)
	at io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:264)
	at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createSingleChannel(InstantiatingGrpcChannelProvider.java:383)
	at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.access$1900(InstantiatingGrpcChannelProvider.java:82)
	at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider$1.createSingleChannel(InstantiatingGrpcChannelProvider.java:239)
	at com.google.api.gax.grpc.ChannelPool.create(ChannelPool.java:72)
	at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createChannel(InstantiatingGrpcChannelProvider.java:249)
	at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.getTransportChannel(InstantiatingGrpcChannelProvider.java:227)
	at com.google.api.gax.rpc.ClientContext.create(ClientContext.java:205)
	at com.google.cloud.bigquery.storage.v1beta2.stub.GrpcBigQueryWriteStub.create(GrpcBigQueryWriteStub.java:136)
	at com.google.cloud.bigquery.storage.v1beta2.stub.BigQueryWriteStubSettings.createStub(BigQueryWriteStubSettings.java:145)
	at com.google.cloud.bigquery.storage.v1beta2.BigQueryWriteClient.&amp;lt;init&amp;gt;(BigQueryWriteClient.java:128)
	at com.google.cloud.bigquery.storage.v1beta2.BigQueryWriteClient.create(BigQueryWriteClient.java:109)
	at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl.newBigQueryWriteClient(BigQueryServicesImpl.java:1271)
	at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl.access$800(BigQueryServicesImpl.java:144)
	at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl$DatasetServiceImpl.&amp;lt;init&amp;gt;(BigQueryServicesImpl.java:518)
	at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl$DatasetServiceImpl.&amp;lt;init&amp;gt;(BigQueryServicesImpl.java:463)
	at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl.getDatasetService(BigQueryServicesImpl.java:180)
	at org.apache.beam.sdk.io.gcp.bigquery.BigQuerySourceBase.extractFiles(BigQuerySourceBase.java:117)
	at org.apache.beam.sdk.io.gcp.bigquery.BigQueryIO$TypedRead$2.processElement(BigQueryIO.java:1123)
	at org.apache.beam.sdk.io.gcp.bigquery.BigQueryIO$TypedRead$2$DoFnInvoker.invokeProcessElement(Unknown Source)
	at org.apache.beam.runners.dataflow.worker.repackaged.org.apache.beam.runners.core.SimpleDoFnRunner.invokeProcessElement(SimpleDoFnRunner.java:232)
	at org.apache.beam.runners.dataflow.worker.repackaged.org.apache.beam.runners.core.SimpleDoFnRunner.processElement(SimpleDoFnRunner.java:191)
	at org.apache.beam.runners.dataflow.worker.SimpleParDoFn.processElement(SimpleParDoFn.java:339)
	at org.apache.beam.runners.dataflow.worker.util.common.worker.ParDoOperation.process(ParDoOperation.java:44)
	at org.apache.beam.runners.dataflow.worker.util.common.worker.OutputReceiver.process(OutputReceiver.java:49)
	at org.apache.beam.runners.dataflow.worker.SimpleParDoFn$1.output(SimpleParDoFn.java:284)
	at org.apache.beam.runners.dataflow.worker.repackaged.org.apache.beam.runners.core.SimpleDoFnRunner.outputWindowedValue(SimpleDoFnRunner.java:272)
	at org.apache.beam.runners.dataflow.worker.repackaged.org.apache.beam.runners.core.SimpleDoFnRunner.access$900(SimpleDoFnRunner.java:84)
	at org.apache.beam.runners.dataflow.worker.repackaged.org.apache.beam.runners.core.SimpleDoFnRunner$DoFnProcessContext.output(SimpleDoFnRunner.java:418)
	at org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.output(DoFnOutputReceivers.java:76)
	at org.apache.beam.sdk.transforms.MapElements$1.processElement(MapElements.java:142)
	at org.apache.beam.sdk.transforms.MapElements$1$DoFnInvoker.invokeProcessElement(Unknown Source)
	at org.apache.beam.runners.dataflow.worker.repackaged.org.apache.beam.runners.core.SimpleDoFnRunner.invokeProcessElement(SimpleDoFnRunner.java:232)
	at org.apache.beam.runners.dataflow.worker.repackaged.org.apache.beam.runners.core.SimpleDoFnRunner.processElement(SimpleDoFnRunner.java:191)
	at org.apache.beam.runners.dataflow.worker.SimpleParDoFn.processElement(SimpleParDoFn.java:339)
	at org.apache.beam.runners.dataflow.worker.util.common.worker.ParDoOperation.process(ParDoOperation.java:44)
	at org.apache.beam.runners.dataflow.worker.util.common.worker.OutputReceiver.process(OutputReceiver.java:49)
	at org.apache.beam.runners.dataflow.worker.util.common.worker.ReadOperation.runReadLoop(ReadOperation.java:212)
	at org.apache.beam.runners.dataflow.worker.util.common.worker.ReadOperation.start(ReadOperation.java:163)
	at org.apache.beam.runners.dataflow.worker.util.common.worker.MapTaskExecutor.execute(MapTaskExecutor.java:92)
	at org.apache.beam.runners.dataflow.worker.BatchDataflowWorker.executeWork(BatchDataflowWorker.java:420)
	at org.apache.beam.runners.dataflow.worker.BatchDataflowWorker.doWork(BatchDataflowWorker.java:389)
	at org.apache.beam.runners.dataflow.worker.BatchDataflowWorker.getAndPerformWork(BatchDataflowWorker.java:314)
	at org.apache.beam.runners.dataflow.worker.DataflowBatchWorkerHarness$WorkerThread.doWork(DataflowBatchWorkerHarness.java:140)
	at org.apache.beam.runners.dataflow.worker.DataflowBatchWorkerHarness$WorkerThread.call(DataflowBatchWorkerHarness.java:120)
	at org.apache.beam.runners.dataflow.worker.DataflowBatchWorkerHarness$WorkerThread.call(DataflowBatchWorkerHarness.java:107)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:834)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17465059" author="rlax@alumni.rice.edu" created="Fri, 24 Dec 2021 17:14:00 +0000"  >&lt;p&gt;The error in BigQuery source is fixed in 2.35 I believe. However this&lt;br/&gt;
should be fairly rare.&lt;/p&gt;

&lt;p&gt;On Fri, Dec 24, 2021 at 2:59 AM Jean-Rodolphe Poinsot (Jira) &amp;lt;&lt;/p&gt;
</comment>
                            <comment id="17468341" author="wilson lauw" created="Tue, 4 Jan 2022 03:49:51 +0000"  >&lt;p&gt;Hi, I was upgrading to 2.35.0, but still have the same SEVERE error log like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Jan&#160;04,&#160;2022&#160;3:41:26&#160;AM&#160;io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference&#160;cleanQueue
SEVERE:&#160;*~*~*~&#160;Channel&#160;ManagedChannelImpl{logId=25,&#160;target=bigquerystorage.googleapis.com:443}&#160;was&#160;not&#160;shutdown&#160;properly!!!&#160;~*~*~*&#160;&#160;&#160;&#160;Make&#160;sure&#160;to&#160;call&#160;shutdown()/shutdownNow()&#160;and&#160;wait&#160;until&#160;awaitTermination()&#160;returns&#160;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;.&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17468343" author="rlax@alumni.rice.edu" created="Tue, 4 Jan 2022 04:04:00 +0000"  >&lt;p&gt;Looks like this location was missed. Fortunately this should only happen&lt;br/&gt;
right when the pipeline is starting, so this location should not continue&lt;br/&gt;
to pollute the error log.&lt;/p&gt;

</comment>
                            <comment id="17499287" author="JIRAUSER285925" created="Tue, 1 Mar 2022 03:25:27 +0000"  >&lt;p&gt;I upgraded to 2.35.0, still getting the same error. But it seems to only happen with the FILE_LOADS method. Should we reopen this issue?&lt;br/&gt;
&#160;&lt;br/&gt;
&#160;&lt;br/&gt;
&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17499311" author="rlax@alumni.rice.edu" created="Tue, 1 Mar 2022 03:53:00 +0000"  >&lt;p&gt;Isn&apos;t 2.36.0 the most recent version?&lt;/p&gt;

</comment>
                            <comment id="17499334" author="JIRAUSER285925" created="Tue, 1 Mar 2022 04:56:38 +0000"  >&lt;p&gt;Thank &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reuvenlax&quot; class=&quot;user-hover&quot; rel=&quot;reuvenlax&quot;&gt;reuvenlax&lt;/a&gt; . Tried with 2.36.0 and got the same error.&lt;/p&gt;</comment>
                            <comment id="17507886" author="bsikander" created="Wed, 16 Mar 2022 21:46:02 +0000"  >&lt;p&gt;Have the same issue in 2.35.0.&lt;/p&gt;</comment>
                            <comment id="17508746" author="JIRAUSER286237" created="Fri, 18 Mar 2022 12:22:17 +0000"  >&lt;p&gt;Getting the same problem in 2.37.0.&lt;/p&gt;</comment>
                            <comment id="17510548" author="clairemcginty" created="Tue, 22 Mar 2022 15:00:26 +0000"  >&lt;p&gt;We still see this in Beam 2.36.0.&lt;/p&gt;</comment>
                            <comment id="17510716" author="bhulette" created="Tue, 22 Mar 2022 15:56:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bsikander&quot; class=&quot;user-hover&quot; rel=&quot;bsikander&quot;&gt;bsikander&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=joachim_isaksson&quot; class=&quot;user-hover&quot; rel=&quot;joachim_isaksson&quot;&gt;joachim_isaksson&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=clairemcginty&quot; class=&quot;user-hover&quot; rel=&quot;clairemcginty&quot;&gt;clairemcginty&lt;/a&gt; could you share the stacktraces you saw in those releases, if you still have access to them?&lt;/p&gt;</comment>
                            <comment id="17510783" author="clairemcginty" created="Tue, 22 Mar 2022 17:30:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bhulette&quot; class=&quot;user-hover&quot; rel=&quot;bhulette&quot;&gt;bhulette&lt;/a&gt; Sure, here&apos;s an example! They&apos;re also all over Scio&apos;s &lt;a href=&quot;https://github.com/spotify/scio/actions/workflows/it-tests.yml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;integration test logs&lt;/a&gt; if you want further context.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;2022-03-22 11:17:11.415-0400 error &lt;span class=&quot;error&quot;&gt;&amp;#91;ManagedChannelOrphanWrapper&amp;#93;&lt;/span&gt; &lt;b&gt;{&lt;/b&gt;}&lt;b&gt;~ Channel {0} was not shutdown properly!!!&lt;/b&gt; &lt;b&gt;~&lt;/b&gt;&lt;/tt&gt;&lt;tt&gt;&#160; &#160; Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.&#160;&lt;/tt&gt;&lt;tt&gt;java.lang.RuntimeException: ManagedChannel allocation site&lt;/tt&gt;&lt;tt&gt;at io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:93)&lt;/tt&gt;&lt;tt&gt;at io.grpc.internal.ManagedChannelOrphanWrapper.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:53)&lt;/tt&gt;&lt;tt&gt;at io.grpc.internal.ManagedChannelOrphanWrapper.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:44)&lt;/tt&gt;&lt;tt&gt;at io.grpc.internal.ManagedChannelImplBuilder.build(ManagedChannelImplBuilder.java:630)&lt;/tt&gt;&lt;tt&gt;at io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:297)&lt;/tt&gt;&lt;tt&gt;at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createSingleChannel(InstantiatingGrpcChannelProvider.java:395)&lt;/tt&gt;&lt;tt&gt;at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.access$1900(InstantiatingGrpcChannelProvider.java:82)&lt;/tt&gt;&lt;tt&gt;at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider$1.createSingleChannel(InstantiatingGrpcChannelProvider.java:240)&lt;/tt&gt;&lt;tt&gt;at com.google.api.gax.grpc.ChannelPool.create(ChannelPool.java:72)&lt;/tt&gt;&lt;tt&gt;at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createChannel(InstantiatingGrpcChannelProvider.java:250)&lt;/tt&gt;&lt;tt&gt;at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.getTransportChannel(InstantiatingGrpcChannelProvider.java:228)&lt;/tt&gt;&lt;tt&gt;at com.google.api.gax.rpc.ClientContext.create(ClientContext.java:205)&lt;/tt&gt;&lt;tt&gt;at com.google.cloud.bigquery.storage.v1.stub.GrpcBigQueryWriteStub.create(GrpcBigQueryWriteStub.java:132)&lt;/tt&gt;&lt;tt&gt;at com.google.cloud.bigquery.storage.v1.stub.BigQueryWriteStubSettings.createStub(BigQueryWriteStubSettings.java:144)&lt;/tt&gt;&lt;tt&gt;at com.google.cloud.bigquery.storage.v1.BigQueryWriteClient.&amp;lt;init&amp;gt;(BigQueryWriteClient.java:130)&lt;/tt&gt;&lt;tt&gt;at com.google.cloud.bigquery.storage.v1.BigQueryWriteClient.create(BigQueryWriteClient.java:111)&lt;/tt&gt;&lt;tt&gt;at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl.newBigQueryWriteClient(BigQueryServicesImpl.java:1353)&lt;/tt&gt;&lt;tt&gt;at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl.access$800(BigQueryServicesImpl.java:145)&lt;/tt&gt;&lt;tt&gt;at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl$DatasetServiceImpl.&amp;lt;init&amp;gt;(BigQueryServicesImpl.java:518)&lt;/tt&gt;&lt;tt&gt;at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl$DatasetServiceImpl.&amp;lt;init&amp;gt;(BigQueryServicesImpl.java:463)&lt;/tt&gt;&lt;tt&gt;at org.apache.beam.sdk.io.gcp.bigquery.BigQueryServicesImpl.getDatasetService(BigQueryServicesImpl.java:180)&lt;/tt&gt;&lt;tt&gt;at org.apache.beam.sdk.io.gcp.bigquery.BigQuerySourceBase.extractFiles(BigQuerySourceBase.java:117)&lt;/tt&gt;&lt;tt&gt;at org.apache.beam.sdk.io.gcp.bigquery.BigQuerySourceBase.split(BigQuerySourceBase.java:155)&lt;/tt&gt;&lt;tt&gt;at org.apache.beam.runners.direct.BoundedReadEvaluatorFactory$InputProvider.getInitialInputs(BoundedReadEvaluatorFactory.java:216)&lt;/tt&gt;&lt;tt&gt;at org.apache.beam.runners.direct.ReadEvaluatorFactory$InputProvider.getInitialInputs(ReadEvaluatorFactory.java:88)&lt;/tt&gt;&lt;tt&gt;at org.apache.beam.runners.direct.RootProviderRegistry.getInitialInputs(RootProviderRegistry.java:80)&lt;/tt&gt;&lt;tt&gt;at org.apache.beam.runners.direct.ExecutorServiceParallelExecutor.start(ExecutorServiceParallelExecutor.java:159)&lt;/tt&gt;&lt;tt&gt;at org.apache.beam.runners.direct.DirectRunner.run(DirectRunner.java:213)&lt;/tt&gt;&lt;tt&gt;at org.apache.beam.runners.direct.DirectRunner.run(DirectRunner.java:67)&lt;/tt&gt;&lt;tt&gt;at org.apache.beam.sdk.Pipeline.run(Pipeline.java:323)&lt;/tt&gt;&lt;tt&gt;at org.apache.beam.sdk.Pipeline.run(Pipeline.java:309)&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="17510944" author="rlax@alumni.rice.edu" created="Wed, 23 Mar 2022 00:33:00 +0000"  >&lt;p&gt;Yes - looks like one more location that wasn&apos;t caught - should be a simple&lt;br/&gt;
fix. This should only happen on pipeline startup though.&lt;/p&gt;

&lt;p&gt;On Tue, Mar 22, 2022 at 10:32 AM Claire McGinty (Jira) &amp;lt;jira@apache.org&amp;gt;&lt;/p&gt;
</comment>
                            <comment id="17511084" author="JIRAUSER286237" created="Wed, 23 Mar 2022 08:03:35 +0000"  >&lt;p&gt;Sure, here&apos;s a couple more different from Claire&apos;s from one of our current builds (apparently) related to pubsub and policy tags;&lt;/p&gt;

&lt;p&gt;&#160;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6624939Z Mar 22, 2022 6:15:37 PM io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6625821Z SEVERE: &lt;b&gt;&lt;sub&gt;&lt;/b&gt;&lt;/sub&gt;&lt;b&gt;~ Channel ManagedChannelImpl{logId=1, target=pubsub.googleapis.com:443} was not shutdown properly!!! &lt;sub&gt;&lt;/b&gt;&lt;/sub&gt;&lt;b&gt;~&lt;/b&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6626574Z Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6627168Z java.lang.RuntimeException: ManagedChannel allocation site&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6627872Z at io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:93)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6628693Z at io.grpc.internal.ManagedChannelOrphanWrapper.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:53)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6629439Z at io.grpc.internal.ManagedChannelOrphanWrapper.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:44)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6630180Z at io.grpc.internal.ManagedChannelImplBuilder.build(ManagedChannelImplBuilder.java:630)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6630961Z at io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:297)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6631827Z at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createSingleChannel(InstantiatingGrpcChannelProvider.java:395)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6632719Z at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.access$1900(InstantiatingGrpcChannelProvider.java:82)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6633621Z at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider$1.createSingleChannel(InstantiatingGrpcChannelProvider.java:240)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6634379Z at com.google.api.gax.grpc.ChannelPool.create(ChannelPool.java:72)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6635132Z at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createChannel(InstantiatingGrpcChannelProvider.java:250)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6636130Z at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.getTransportChannel(InstantiatingGrpcChannelProvider.java:228)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6636936Z at com.google.api.gax.rpc.ClientContext.create(ClientContext.java:205)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6637637Z at com.google.cloud.pubsub.v1.stub.GrpcSubscriberStub.create(GrpcSubscriberStub.java:287)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6638409Z at com.google.cloud.pubsub.v1.stub.SubscriberStubSettings.createStub(SubscriberStubSettings.java:369)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6639192Z at com.google.cloud.pubsub.v1.SubscriptionAdminClient.&amp;lt;init&amp;gt;(SubscriptionAdminClient.java:177)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6639964Z at com.google.cloud.pubsub.v1.SubscriptionAdminClient.create(SubscriptionAdminClient.java:158)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6640729Z at com.google.cloud.pubsub.v1.SubscriptionAdminClient.create(SubscriptionAdminClient.java:149)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6641567Z at com.xxx.xxx.common.pipeline.SubscriptionHelper.createSubscriptionIfItDoesNotExist(SubscriptionHelper.kt:64)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6642570Z at com.xxx.xxx.common.pipeline.SubscriptionHelperTest.createSubscriptionIfItDoesNotExist_SubscriptionIsCreated(SubscriptionHelperTest.kt:135)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6643428Z at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6644135Z at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6644943Z at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6645649Z at java.base/java.lang.reflect.Method.invoke(Method.java:566)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6646416Z at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6647138Z at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6648131Z at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6650214Z at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6651027Z at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6651848Z at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6652732Z at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6653930Z at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6654939Z at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6656004Z at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6656869Z at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6658026Z at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6658824Z at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6659569Z at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6660405Z at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:214)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6661285Z at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6662133Z at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:210)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6662970Z at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:135)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6663957Z at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6665931Z at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6666795Z at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6667637Z at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6668421Z at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6669192Z at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6670033Z at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6670852Z at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6671638Z at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6672600Z at org.junit.platform.engine.support.hierarchical.ForkJoinPoolHierarchicalTestExecutorService$ExclusiveTask.compute(ForkJoinPoolHierarchicalTestExecutorService.java:185)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6673777Z at org.junit.platform.engine.support.hierarchical.ForkJoinPoolHierarchicalTestExecutorService.executeNonConcurrentTasks(ForkJoinPoolHierarchicalTestExecutorService.java:155)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6675119Z at org.junit.platform.engine.support.hierarchical.ForkJoinPoolHierarchicalTestExecutorService.invokeAll(ForkJoinPoolHierarchicalTestExecutorService.java:135)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6676107Z at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6676954Z at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6677792Z at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6678560Z at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6679324Z at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6680143Z at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6680970Z at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6681758Z at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6682714Z at org.junit.platform.engine.support.hierarchical.ForkJoinPoolHierarchicalTestExecutorService$ExclusiveTask.compute(ForkJoinPoolHierarchicalTestExecutorService.java:185)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6683637Z at java.base/java.util.concurrent.RecursiveAction.exec(RecursiveAction.java:189)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6684308Z at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:290)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6684962Z at java.base/java.util.concurrent.ForkJoinTask.doJoin(ForkJoinTask.java:396)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6685614Z at java.base/java.util.concurrent.ForkJoinTask.join(ForkJoinTask.java:721)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6686604Z at org.junit.platform.engine.support.hierarchical.ForkJoinPoolHierarchicalTestExecutorService.joinConcurrentTasksInReverseOrderToEnableWorkStealing(ForkJoinPoolHierarchicalTestExecutorService.java:162)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6687827Z at org.junit.platform.engine.support.hierarchical.ForkJoinPoolHierarchicalTestExecutorService.invokeAll(ForkJoinPoolHierarchicalTestExecutorService.java:136)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6688816Z at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6689757Z at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6690624Z at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6691390Z at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6692156Z at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6692996Z at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6693819Z at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6694606Z at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6695544Z at org.junit.platform.engine.support.hierarchical.ForkJoinPoolHierarchicalTestExecutorService$ExclusiveTask.compute(ForkJoinPoolHierarchicalTestExecutorService.java:185)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6696470Z at java.base/java.util.concurrent.RecursiveAction.exec(RecursiveAction.java:189)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6697144Z at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:290)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6698220Z at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1020)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6698926Z at java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:1656)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6699736Z at java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1594)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:47.6700437Z at java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:183)&lt;/tt&gt;&lt;/p&gt;




&lt;p&gt;&lt;tt&gt;2022-03-22T18:16:49.7726196Z Mar 22, 2022 6:15:40 PM io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7727327Z SEVERE: &lt;b&gt;&lt;sub&gt;&lt;/b&gt;&lt;/sub&gt;&lt;b&gt;~ Channel ManagedChannelImpl{logId=7, target=datacatalog.googleapis.com:443} was not shutdown properly!!! &lt;sub&gt;&lt;/b&gt;&lt;/sub&gt;&lt;b&gt;~&lt;/b&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7728028Z Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7728576Z java.lang.RuntimeException: ManagedChannel allocation site&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7729211Z at io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:93)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7730155Z at io.grpc.internal.ManagedChannelOrphanWrapper.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:53)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7731159Z at io.grpc.internal.ManagedChannelOrphanWrapper.&amp;lt;init&amp;gt;(ManagedChannelOrphanWrapper.java:44)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7732072Z at io.grpc.internal.ManagedChannelImplBuilder.build(ManagedChannelImplBuilder.java:630)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7733015Z at io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:297)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7734040Z at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createSingleChannel(InstantiatingGrpcChannelProvider.java:395)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7734896Z at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.access$1900(InstantiatingGrpcChannelProvider.java:82)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7735968Z at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider$1.createSingleChannel(InstantiatingGrpcChannelProvider.java:240)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7736720Z at com.google.api.gax.grpc.ChannelPool.create(ChannelPool.java:72)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7737573Z at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createChannel(InstantiatingGrpcChannelProvider.java:250)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7738445Z at com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.getTransportChannel(InstantiatingGrpcChannelProvider.java:228)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7739187Z at com.google.api.gax.rpc.ClientContext.create(ClientContext.java:205)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7740016Z at com.google.cloud.datacatalog.v1beta1.stub.GrpcPolicyTagManagerStub.create(GrpcPolicyTagManagerStub.java:221)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7740854Z at com.google.cloud.datacatalog.v1beta1.stub.PolicyTagManagerStubSettings.createStub(PolicyTagManagerStubSettings.java:313)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7742023Z at com.google.cloud.datacatalog.v1beta1.PolicyTagManagerClient.&amp;lt;init&amp;gt;(PolicyTagManagerClient.java:143)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7742950Z at com.google.cloud.datacatalog.v1beta1.PolicyTagManagerClient.create(PolicyTagManagerClient.java:124)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7743724Z at com.google.cloud.datacatalog.v1beta1.PolicyTagManagerClient.create(PolicyTagManagerClient.java:115)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7745178Z at com.xxx.xxx.common.utility.PolicyHelper.getPolicyForProject(PolicyHelper.kt:21)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7746724Z at com.xxx.xxx.common.utility.PolicyHelper.getPiiPolicyTagName$lambda-0(PolicyHelper.kt:17)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7747496Z at java.base/java.util.concurrent.ConcurrentHashMap.computeIfAbsent(ConcurrentHashMap.java:1705)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7748301Z at com.xxx.xxx.common.utility.PolicyHelper.getPiiPolicyTagName(PolicyHelper.kt:16)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7749083Z at com.xxx.xxx.common.pipeline.TableDestinationFinder.addPolicyTags(TableDestinationFinder.kt:105)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7750357Z at com.xxx.xxx.common.pipeline.TableDestinationFinder.getSchema$lambda-0(TableDestinationFinder.kt:67)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7751196Z at java.base/java.util.concurrent.ConcurrentHashMap.computeIfAbsent(ConcurrentHashMap.java:1705)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7751989Z at com.xxx.xxx.common.pipeline.TableDestinationFinder.getSchema(TableDestinationFinder.kt:64)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7752795Z at com.xxx.xxx.common.pipeline.TableDestinationFinder.getSchema(TableDestinationFinder.kt:32)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7753638Z at org.apache.beam.sdk.io.gcp.bigquery.CreateTables$CreateTablesFn.lambda$processElement$0(CreateTables.java:114)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7754469Z at org.apache.beam.sdk.io.gcp.bigquery.CreateTableHelpers.tryCreateTable(CreateTableHelpers.java:114)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7755489Z at org.apache.beam.sdk.io.gcp.bigquery.CreateTableHelpers.possiblyCreateTable(CreateTableHelpers.java:86)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7756349Z at org.apache.beam.sdk.io.gcp.bigquery.CreateTables$CreateTablesFn.lambda$processElement$1(CreateTables.java:115)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7757120Z at java.base/java.util.HashMap.computeIfAbsent(HashMap.java:1133)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7757834Z at org.apache.beam.sdk.io.gcp.bigquery.CreateTables$CreateTablesFn.processElement(CreateTables.java:104)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7758774Z at org.apache.beam.sdk.io.gcp.bigquery.CreateTables$CreateTablesFn$DoFnInvoker.invokeProcessElement(Unknown Source)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7759639Z at org.apache.beam.repackaged.direct_java.runners.core.SimpleDoFnRunner.invokeProcessElement(SimpleDoFnRunner.java:228)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7760926Z at org.apache.beam.repackaged.direct_java.runners.core.SimpleDoFnRunner.processElement(SimpleDoFnRunner.java:187)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7762416Z at org.apache.beam.repackaged.direct_java.runners.core.SimplePushbackSideInputDoFnRunner.processElementInReadyWindows(SimplePushbackSideInputDoFnRunner.java:79)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7763310Z at org.apache.beam.runners.direct.ParDoEvaluator.processElement(ParDoEvaluator.java:244)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7764183Z at org.apache.beam.runners.direct.DoFnLifecycleManagerRemovingTransformEvaluator.processElement(DoFnLifecycleManagerRemovingTransformEvaluator.java:54)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7765677Z at org.apache.beam.runners.direct.DirectTransformExecutor.processElements(DirectTransformExecutor.java:165)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7766472Z at org.apache.beam.runners.direct.DirectTransformExecutor.run(DirectTransformExecutor.java:129)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7767181Z at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7767814Z at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7768453Z at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7769163Z at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7769764Z at java.base/java.lang.Thread.run(Thread.java:829)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-22T18:16:49.7770011Z&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="17511287" author="brunocvcunha" created="Wed, 23 Mar 2022 14:36:56 +0000"  >&lt;p&gt;This error is reproducible on 2.37.0 as well.&lt;/p&gt;

&lt;p&gt;However, it seems to be on the Reader side of the BigQueryIO, not the writer.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;A huge leak of Gax-* threads can be seen, after running a Beam job using this source:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
PCollection&amp;lt;TableRow&amp;gt; tableRows =
    pipeline.apply(
        &lt;span class=&quot;code-quote&quot;&gt;&quot;Read from BigQuery&quot;&lt;/span&gt;,
        BigQueryIO.readTableRows()
            .from(
                &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TableReference()
                    .setProjectId(params.getTableProjectName())
                    .setDatasetId(params.getTableDatasetName())
                    .setTableId(params.getTableName()))
            .withMethod(Method.DIRECT_READ)); &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Apparently, BigQueryServicesImpl doesn&apos;t `.close()` the Bigquery instance `client`. Will try to get more details and post them here.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17522138" author="melentye" created="Thu, 14 Apr 2022 07:51:43 +0000"  >&lt;p&gt;After a dozen people have reported that it&apos;s still an issue, can the ticket be reopened to indicate that?&lt;/p&gt;</comment>
                            <comment id="17523886" author="bhulette" created="Mon, 18 Apr 2022 20:15:43 +0000"  >&lt;p&gt;Re-opened, thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=melentye&quot; class=&quot;user-hover&quot; rel=&quot;melentye&quot;&gt;melentye&lt;/a&gt;. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reuvenlax&quot; class=&quot;user-hover&quot; rel=&quot;reuvenlax&quot;&gt;reuvenlax&lt;/a&gt; do you have time to look at this? Or maybe &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chamikara&quot; class=&quot;user-hover&quot; rel=&quot;chamikara&quot;&gt;chamikara&lt;/a&gt; or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kerrydc&quot; class=&quot;user-hover&quot; rel=&quot;kerrydc&quot;&gt;kerrydc&lt;/a&gt; could help prioritize?&lt;/p&gt;</comment>
                            <comment id="17549367" author="JIRAUSER282469" created="Sat, 4 Jun 2022 20:47:14 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/apache/beam/issues/20970&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/issues/20970&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13379338">BEAM-12365</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13384981">BEAM-12521</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13381973">BEAM-12451</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13025565" name="bigquery_grpc.log" size="4504" author="baeminbo" created="Tue, 18 May 2021 04:09:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 23 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0r48w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>