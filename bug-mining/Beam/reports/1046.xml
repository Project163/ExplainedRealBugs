<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 10:56:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-6512] [beam_PreCommit_Java_Cron] [GrpcDataServiceTest] Flake, Multiplexer hanging up</title>
                <link>https://issues.apache.org/jira/browse/BEAM-6512</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;&lt;em&gt;Use this form to file an issue for test failure:&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://builds.apache.org/job/beam_PreCommit_Java_Cron/869/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Jenkins Job&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://scans.gradle.com/s/wodzocvegyy5a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Gradle Build Scan&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/beam/blob/f560edc5a4e38cb13d41718540271ae79d7d00ee/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/data/GrpcDataServiceTest.java#L105&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Test source code&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Initial investigation:&lt;/p&gt;

&lt;p&gt;I see this message:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest &amp;gt; testMessageReceivedBySingleClientWhenThereAreMultipleClients FAILED
    java.lang.AssertionError at GrpcDataServiceTest.java:105
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And this message:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[grpc-default-executor-2] WARN org.apache.beam.sdk.fn.data.BeamFnDataGrpcMultiplexer - Hanged up for unknown endpoint.
Jan 25, 2019 6:16:02 PM org.apache.beam.vendor.grpc.v1p13p1.io.grpc.internal.SerializingExecutor run
SEVERE: Exception while executing runnable org.apache.beam.vendor.grpc.v1p13p1.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed@41415b8e
java.lang.RuntimeException: org.apache.beam.vendor.grpc.v1p13p1.io.grpc.StatusRuntimeException: CANCELLED: Multiplexer hanging up
	at org.apache.beam.sdk.fn.test.TestStreams.lambda$throwingErrorHandler$0(TestStreams.java:95)
	at org.apache.beam.sdk.fn.test.TestStreams$ForwardingCallStreamObserver.onError(TestStreams.java:144)
	at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:420)
	at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.ForwardingClientCallListener$SimpleForwardingClientCallListener.onClose(ForwardingClientCallListener.java:40)
	at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.internal.CensusStatsModule$StatsClientInterceptor$1$1.onClose(CensusStatsModule.java:684)
	at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.ForwardingClientCallListener$SimpleForwardingClientCallListener.onClose(ForwardingClientCallListener.java:40)
	at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.internal.CensusTracingModule$TracingClientInterceptor$1$1.onClose(CensusTracingModule.java:403)
	at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:459)
	at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:63)
	at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl.close(ClientCallImpl.java:546)
	at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl.access$600(ClientCallImpl.java:467)
	at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:584)
	at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.beam.vendor.grpc.v1p13p1.io.grpc.StatusRuntimeException: CANCELLED: Multiplexer hanging up
	at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.Status.asRuntimeException(Status.java:526)
	... 19 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note that the second message is something I&apos;ve seen when successfully ending a job without in portable runners (specifically the Java Reference Runner), so it might be a red herring.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13211973">BEAM-6512</key>
            <summary>[beam_PreCommit_Java_Cron] [GrpcDataServiceTest] Flake, Multiplexer hanging up</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10103" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">P3</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bhulette">Brian Hulette</assignee>
                                    <reporter username="danoliveira">Daniel Oliveira</reporter>
                        <labels>
                            <label>currently-failing</label>
                            <label>flake</label>
                    </labels>
                <created>Sat, 26 Jan 2019 00:58:47 +0000</created>
                <updated>Sat, 16 May 2020 13:23:37 +0000</updated>
                            <resolved>Fri, 22 Feb 2019 23:51:46 +0000</resolved>
                                                    <fixVersion>Not applicable</fixVersion>
                                    <component>test-failures</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="10200">2h 50m</timespent>
                                <comments>
                            <comment id="16752875" author="danoliveira" created="Sat, 26 Jan 2019 00:59:34 +0000"  >&lt;p&gt;Scott I&apos;m assigning this to you because I need to assign it to someone and have no clue who might know about Grpc related code (the original authors of the test aren&apos;t around). By all means reassign this if you know someone better.&lt;/p&gt;</comment>
                            <comment id="16762253" author="bhulette" created="Wed, 6 Feb 2019 23:52:42 +0000"  >&lt;p&gt;So far I haven&apos;t been able to repro the failure locally out of hundreds of runs.&lt;/p&gt;

&lt;p&gt;I took a look at a few other failed Jenkins builds: &lt;a href=&quot;https://builds.apache.org/job/beam_PreCommit_Java_Cron/900/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;#900&lt;/a&gt;, &lt;a href=&quot;https://builds.apache.org/job/beam_PreCommit_Java_Cron/889/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;#889&lt;/a&gt;, &lt;a href=&quot;https://builds.apache.org/job/beam_PreCommit_Java_Cron/884/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;#884&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;A common thread I&apos;ve noticed is that they all have three &quot;Multiplexer hanging up&quot; exceptions logged. Other successful builds may have one or two of those exceptions logged, but I haven&apos;t seen three. Maybe there&apos;s some kind of race condition leading to this exception, and when it happens to all three clients the flake occurs.&lt;/p&gt;</comment>
                            <comment id="16762971" author="danoliveira" created="Thu, 7 Feb 2019 18:59:55 +0000"  >&lt;p&gt;Note that the &quot;Multiplexer hanging up&quot; exceptions are something that seems to&#160;pop up in portable runners whenever the job server stops a job, so it&apos;s&#160;probably not directly related to the failure. The extra exception is probably caused by the&#160;error&#160;resulting in the job server&#160;ending the job early.&lt;/p&gt;</comment>
                            <comment id="16763165" author="bhulette" created="Thu, 7 Feb 2019 23:20:23 +0000"  >&lt;p&gt;Finally got a Gradle scan of the flake with additional logging: &lt;a href=&quot;https://scans.gradle.com/s/hp25w7lk2leze/tests/nmdop4qup5ykg-iau57g3mhia66&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://scans.gradle.com/s/hp25w7lk2leze/tests/nmdop4qup5ykg-iau57g3mhia66&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[Test worker] INFO org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest - Creating future 0
[Test worker] INFO org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest - Creating future 1
[pool-3-thread-1] INFO org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest - Creating outboundObserver 0
[Test worker] INFO org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest - Creating future 2
[pool-3-thread-2] INFO org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest - Creating outboundObserver 1
[pool-3-thread-3] INFO org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest - Creating outboundObserver 2
[grpc-default-executor-0] INFO org.apache.beam.runners.fnexecution.data.GrpcDataService - Beam Fn Data client connected.
[grpc-default-executor-1] INFO org.apache.beam.runners.fnexecution.data.GrpcDataService - Beam Fn Data client connected.
[Test worker] INFO org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest - counting down latch
[Test worker] INFO org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest - getting all futures
[pool-3-thread-3] INFO org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest - Calling onCompleted 2
[pool-3-thread-3] INFO org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest - return null 2
[pool-3-thread-1] INFO org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest - Calling onCompleted 0
[pool-3-thread-1] INFO org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest - return null 0
[pool-3-thread-2] INFO org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest - Calling onCompleted 1
[pool-3-thread-2] INFO org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest - return null 1
[grpc-default-executor-0] WARN org.apache.beam.sdk.fn.data.BeamFnDataGrpcMultiplexer - Hanged up for unknown endpoint.
[grpc-default-executor-1] WARN org.apache.beam.sdk.fn.data.BeamFnDataGrpcMultiplexer - Hanged up for unknown endpoint.
[grpc-default-executor-2] INFO org.apache.beam.runners.fnexecution.data.GrpcDataService - Beam Fn Data client connected.
[Test worker] INFO org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest - assertion
[grpc-default-executor-2] WARN org.apache.beam.sdk.fn.data.BeamFnDataGrpcMultiplexer - Hanged up for unknown endpoint.
[grpc-default-executor-3] INFO org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest - Element handled by client 2
[grpc-default-executor-3] INFO org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest - Element handled by client 2
[grpc-default-executor-3] INFO org.apache.beam.runners.fnexecution.data.GrpcDataServiceTest - Element handled by client 2
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16771448" author="rdub" created="Tue, 19 Feb 2019 00:27:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://builds.apache.org/job/beam_PreCommit_Java_Commit/4353/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Just saw this&lt;/a&gt; on &lt;a href=&quot;https://github.com/apache/beam/pull/7867&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;#7867&lt;/a&gt;, fwiw.&lt;/p&gt;</comment>
                            <comment id="16775699" author="bhulette" created="Fri, 22 Feb 2019 23:51:46 +0000"  >&lt;p&gt;Doesn&apos;t seem to have flaked since PR #7794 was merged:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://builds.apache.org/job/beam_PreCommit_Java_Commit/lastCompletedBuild/testReport/junit/org.apache.beam.runners.fnexecution.data/GrpcDataServiceTest/testMessageReceivedBySingleClientWhenThereAreMultipleClients/history&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/beam_PreCommit_Java_Commit/lastCompletedBuild/testReport/junit/org.apache.beam.runners.fnexecution.data/GrpcDataServiceTest/testMessageReceivedBySingleClientWhenThereAreMultipleClients/history&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13181069">BEAM-5215</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13213972">BEAM-6594</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 38 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|yi0c8g:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>