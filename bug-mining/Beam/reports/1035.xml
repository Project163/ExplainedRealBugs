<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 10:56:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-6676] Python timers only working with GlobalWindow</title>
                <link>https://issues.apache.org/jira/browse/BEAM-6676</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;Setting a timer with the Py SDK fails with fixed window (portable runner).&lt;/p&gt;

&lt;p&gt;Test case attached.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13215877">BEAM-6676</key>
            <summary>Python timers only working with GlobalWindow</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="robertwb">Robert Bradshaw</assignee>
                                    <reporter username="thw">Thomas Weise</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Feb 2019 03:58:26 +0000</created>
                <updated>Sat, 16 May 2020 13:54:56 +0000</updated>
                            <resolved>Wed, 20 Feb 2019 13:10:19 +0000</resolved>
                                    <version>2.10.0</version>
                                    <fixVersion>2.12.0</fixVersion>
                                    <component>sdk-py-harness</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="2400">40m</timespent>
                                <comments>
                            <comment id="16768916" author="thw" created="Fri, 15 Feb 2019 03:59:19 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
from __future__ &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; absolute_import

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; logging
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; sys

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; apache_beam as beam
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; apache_beam.transforms.window as window
from apache_beam.options.pipeline_options &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; PipelineOptions
from apache_beam.transforms &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; userstate


&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;StatefulFn(beam.DoFn):
  count_state_spec = userstate.CombiningValueStateSpec(
        &lt;span class=&quot;code-quote&quot;&gt;&apos;count&apos;&lt;/span&gt;, beam.coders.IterableCoder(beam.coders.VarIntCoder()), sum)
  timer_spec = userstate.TimerSpec(&lt;span class=&quot;code-quote&quot;&gt;&apos;timer&apos;&lt;/span&gt;, userstate.TimeDomain.WATERMARK)

  def process(self, kv, count=beam.DoFn.StateParam(count_state_spec), timer=beam.DoFn.TimerParam(timer_spec), window=beam.DoFn.WindowParam):
    count.add(1)
    timer.set(1000)
    logging.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;###count %s, %d, window %s&quot;&lt;/span&gt; % (kv, count.read(), window))

  @userstate.on_timer(timer_spec)
  def process_timer(self, count=beam.DoFn.StateParam(count_state_spec), window=beam.DoFn.WindowParam):
    logging.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;###count %d, window %s&quot;&lt;/span&gt; % (count.read(), window))

def run(argv=None):
  &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;&quot;Build and run the pipeline.&quot;&lt;/span&gt;&quot;&quot;
  args = [&lt;span class=&quot;code-quote&quot;&gt;&quot;--runner=PortableRunner&quot;&lt;/span&gt;,
          &lt;span class=&quot;code-quote&quot;&gt;&quot;--job_endpoint=localhost:8099&quot;&lt;/span&gt;,
          &lt;span class=&quot;code-quote&quot;&gt;&quot;--streaming&quot;&lt;/span&gt;,
          &lt;span class=&quot;code-quote&quot;&gt;&quot;--shutdown_sources_on_final_watermark&quot;&lt;/span&gt;]
  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; argv:
    args.extend(argv)

  pipeline_options = PipelineOptions(args)

  p = beam.Pipeline(options=pipeline_options)

  _ = (p
       | beam.Create([(&lt;span class=&quot;code-quote&quot;&gt;&apos;k1&apos;&lt;/span&gt;, 1), (&lt;span class=&quot;code-quote&quot;&gt;&apos;k1&apos;&lt;/span&gt;, 2)])
       | &lt;span class=&quot;code-quote&quot;&gt;&apos;window&apos;&lt;/span&gt; &amp;gt;&amp;gt; beam.WindowInto(window.FixedWindows(5))
       | &lt;span class=&quot;code-quote&quot;&gt;&apos;statefulCount&apos;&lt;/span&gt; &amp;gt;&amp;gt; beam.ParDo(StatefulFn())
       )

  result = p.run()
  result.wait_until_finish()


&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; __name__ == &lt;span class=&quot;code-quote&quot;&gt;&apos;__main__&apos;&lt;/span&gt;:
  logging.getLogger().setLevel(logging.INFO)
  run(sys.argv[1:])
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16768918" author="thw" created="Fri, 15 Feb 2019 04:01:15 +0000"  >&lt;p&gt;Here is the error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160; &#160; timer.set(1000)

&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/tweise/python-ve/beam/lib/python2.7/site-packages/apache_beam/runners/worker/bundle_processor.py&quot;&lt;/span&gt;, line 324, in set

&#160; &#160; dict(timestamp=timestamp.Timestamp.of(ts)))))

&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/tweise/python-ve/beam/lib/python2.7/site-packages/apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 88, in receive

&#160; &#160; self.update_counters_start(windowed_value)

&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/tweise/python-ve/beam/lib/python2.7/site-packages/apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 94, in update_counters_start

&#160; &#160; self.opcounter.update_from(windowed_value)

&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/tweise/python-ve/beam/lib/python2.7/site-packages/apache_beam/runners/worker/opcounters.py&quot;&lt;/span&gt;, line 195, in update_from

&#160; &#160; self.do_sample(windowed_value)

&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/tweise/python-ve/beam/lib/python2.7/site-packages/apache_beam/runners/worker/opcounters.py&quot;&lt;/span&gt;, line 213, in do_sample

&#160; &#160; self.coder_impl.get_estimated_size_and_observables(windowed_value))

&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/tweise/python-ve/beam/lib/python2.7/site-packages/apache_beam/coders/coder_impl.py&quot;&lt;/span&gt;, line 996, in get_estimated_size_and_observables

&#160; &#160; self._windows_coder.estimate_size(value.windows, nested=True))

&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/tweise/python-ve/beam/lib/python2.7/site-packages/apache_beam/coders/coder_impl.py&quot;&lt;/span&gt;, line 780, in estimate_size

&#160; &#160; self.get_estimated_size_and_observables(value))

&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/tweise/python-ve/beam/lib/python2.7/site-packages/apache_beam/coders/coder_impl.py&quot;&lt;/span&gt;, line 795, in get_estimated_size_and_observables

&#160; &#160; elem, nested=True))

&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/tweise/python-ve/beam/lib/python2.7/site-packages/apache_beam/coders/coder_impl.py&quot;&lt;/span&gt;, line 134, in get_estimated_size_and_observables

&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.estimate_size(value, nested), []

&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/tweise/python-ve/beam/lib/python2.7/site-packages/apache_beam/coders/coder_impl.py&quot;&lt;/span&gt;, line 477, in estimate_size

&#160; &#160; span_millis = (typed_value._end_micros &lt;span class=&quot;code-comment&quot;&gt;// 1000
&lt;/span&gt;
AttributeError: &lt;span class=&quot;code-quote&quot;&gt;&apos;GlobalWindow&apos;&lt;/span&gt; object has no attribute &lt;span class=&quot;code-quote&quot;&gt;&apos;_end_micros&apos;&lt;/span&gt; [&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running &lt;span class=&quot;code-quote&quot;&gt;&apos;statefulCount&apos;&lt;/span&gt;]



&#160; &#160; &#160; &#160; at org.apache.beam.runners.fnexecution.control.FnApiControlClient$ResponseStreamObserver.onNext(FnApiControlClient.java:157)

&#160; &#160; &#160; &#160; at org.apache.beam.runners.fnexecution.control.FnApiControlClient$ResponseStreamObserver.onNext(FnApiControlClient.java:140)

&#160; &#160; &#160; &#160; at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:248)

&#160; &#160; &#160; &#160; at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)

&#160; &#160; &#160; &#160; at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.Contexts$ContextualizedServerCallListener.onMessage(Contexts.java:76)

&#160; &#160; &#160; &#160; at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:263)

&#160; &#160; &#160; &#160; at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:683)

&#160; &#160; &#160; &#160; at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)

&#160; &#160; &#160; &#160; at org.apache.beam.vendor.grpc.v1p13p1.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)

&#160; &#160; &#160; &#160; at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)

&#160; &#160; &#160; &#160; at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)

&#160; &#160; &#160; &#160; ... 1 more&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 39 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|yi1080:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>