<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 10:55:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-6491] FileIOTest.testMatchWatchForNewFiles flakey in java presubmit</title>
                <link>https://issues.apache.org/jira/browse/BEAM-6491</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;I&apos;ve seen this fail in a few different PRs for different contributors&lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/job/beam_PreCommit_Java_Commit/3688/testReport/org.apache.beam.sdk.io/FileIOTest/testMatchWatchForNewFiles/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/beam_PreCommit_Java_Commit/3688/testReport/org.apache.beam.sdk.io/FileIOTest/testMatchWatchForNewFiles/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;java.nio.file.NoSuchFileException: /tmp/junit7417716876899005708/watch/first at sun.nio.fs.UnixException.translateToIOException(UnixException.java:86) at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102) at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107) at sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:55) at sun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:144) at sun.nio.fs.LinuxFileSystemProvider.readAttributes(LinuxFileSystemProvider.java:99) at java.nio.file.Files.readAttributes(Files.java:1737) at java.nio.file.Files.getLastModifiedTime(Files.java:2266) at org.apache.beam.sdk.io.FileIOTest.testMatchWatchForNewFiles(FileIOTest.java:243) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) at org.apache.beam.sdk.testing.TestPipeline$1.evaluate(TestPipeline.java:319) at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:265) at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:349) at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) at org.junit.runners.ParentRunner$3.run(ParentRunner.java:314) at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:312) at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:292) at org.junit.runners.ParentRunner.run(ParentRunner.java:396) at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:106) at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58) at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38) at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:66) at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51) at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35) at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24) at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32) at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93) at com.sun.proxy.$Proxy2.processTestClass(Unknown Source) at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:117) at sun.reflect.GeneratedMethodAccessor26.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35) at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24) at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:155) at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:137) at org.gradle.internal.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:404) at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:63) at org.gradle.internal.concurrent.ManagedExecutorImpl$1.run(ManagedExecutorImpl.java:46) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at org.gradle.internal.concurrent.ThreadFactoryImpl$ManagedThreadRunnable.run(ThreadFactoryImpl.java:55) at java.lang.Thread.run(Thread.java:748)&lt;/p&gt;
&lt;h3&gt;&lt;a name=&quot;StandardError&quot;&gt;&lt;/a&gt;Standard Error&lt;/h3&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;direct-runner-worker&amp;#93;&lt;/span&gt; INFO org.apache.beam.sdk.io.FileIO - Matched 1 files for pattern /tmp/junit2386911851172406517/file &lt;span class=&quot;error&quot;&gt;&amp;#91;direct-runner-worker&amp;#93;&lt;/span&gt; INFO org.apache.beam.sdk.io.FileIO - Matched 1 files for pattern /tmp/junit2386911851172406517/file.gz Exception in thread &quot;Thread-4&quot; java.lang.RuntimeException: java.nio.file.NoSuchFileException: /tmp/junit7417716876899005708/watch/first at org.apache.beam.sdk.io.FileIOTest.lambda$testMatchWatchForNewFiles$0(FileIOTest.java:233) at java.lang.Thread.run(Thread.java:748) Caused by: java.nio.file.NoSuchFileException: /tmp/junit7417716876899005708/watch/first at sun.nio.fs.UnixException.translateToIOException(UnixException.java:86) at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102) at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107) at sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:214) at java.nio.file.spi.FileSystemProvider.newOutputStream(FileSystemProvider.java:434) at java.nio.file.Files.newOutputStream(Files.java:216) at java.nio.file.Files.write(Files.java:3292) at org.apache.beam.sdk.io.FileIOTest.lambda$testMatchWatchForNewFiles$0(FileIOTest.java:227) ... 1 more [&lt;/p&gt;</description>
                <environment></environment>
        <key id="13211129">BEAM-6491</key>
            <summary>FileIOTest.testMatchWatchForNewFiles flakey in java presubmit</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jeff.klukas@gmail.com">Jeff Klukas</assignee>
                                    <reporter username="ajamato@google.com">Alex Amato</reporter>
                        <labels>
                    </labels>
                <created>Tue, 22 Jan 2019 23:17:14 +0000</created>
                <updated>Sat, 16 May 2020 13:53:04 +0000</updated>
                            <resolved>Wed, 23 Jan 2019 20:20:59 +0000</resolved>
                                                    <fixVersion>2.11.0</fixVersion>
                                    <component>java-fn-execution</component>
                    <component>test-failures</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="9600">2h 40m</timespent>
                                <comments>
                            <comment id="16749279" author="ajamato@google.com" created="Tue, 22 Jan 2019 23:25:58 +0000"  >&lt;p&gt;Recent PRs for the test file:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/beam/commit/2bf5eadff02f9effdd299c867d6e476594ddeb22#diff-9a483e071fce83aa7be513e8b8ffdba1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/commit/2bf5eadff02f9effdd299c867d6e476594ddeb22#diff-9a483e071fce83aa7be513e8b8ffdba1&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16749286" author="ajamato@google.com" created="Tue, 22 Jan 2019 23:33:23 +0000"  >&lt;p&gt;There are a lot of sleeps in this test, and its using multiple threads. perhaps it needs to use some tools&#160;to coordinate them&lt;/p&gt;</comment>
                            <comment id="16749290" author="ajamato@google.com" created="Tue, 22 Jan 2019 23:43:20 +0000"  >&lt;p&gt;I don&apos;t fully understand the &quot;writer Thread&quot; in&#160;testMatchWatchForNewFiles&lt;/p&gt;

&lt;p&gt;I think that the join in this test should moved up?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;In this test we are tryiong to access the file and its modified time when populating the &quot;expected&quot; values, but there is no guarantee that the file exists yet, or is done being modified.&lt;/p&gt;</comment>
                            <comment id="16749299" author="ajamato@google.com" created="Tue, 22 Jan 2019 23:48:11 +0000"  >&lt;p&gt;his PR introduces the threading style (no problem yet, since we aren&apos;t trying to access the file in the expected check)&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/beam/commit/910d02fb464d8a91c7149f214419964cb834639b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/commit/910d02fb464d8a91c7149f214419964cb834639b&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;However, the check for the last modified time is added in this PR which introduces the race condition&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/beam/commit/410d6c7b5f933dcb0280894553c1e576ee4e4884&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/commit/410d6c7b5f933dcb0280894553c1e576ee4e4884&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16749303" author="ajamato@google.com" created="Tue, 22 Jan 2019 23:52:49 +0000"  >&lt;p&gt;Though, simply moving the writer.join() statement upward, may defeat the purpose of the test, which seems to intend to see what happens while the pipeline is running and new files are written.&lt;/p&gt;

&lt;p&gt;I am wondering if there is a more clever AssertThat which can be used to add custom code which runs inside the pipeline in order to populate the expected values inside a function? Then it can run after the test finishes and&#160;insert its check after the pipeline has finished (and extracting the modified times as well)&lt;/p&gt;</comment>
                            <comment id="16749322" author="danoliveira" created="Wed, 23 Jan 2019 00:22:07 +0000"  >&lt;p&gt;I wonder if this is related to&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/BEAM-6352&quot; title=&quot;Watch PTransform is broken&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BEAM-6352&quot;&gt;&lt;del&gt;BEAM-6352&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16749363" author="danoliveira" created="Wed, 23 Jan 2019 01:16:35 +0000"  >&lt;p&gt;Just as an update, I made a PR setting the test to be ignored until this flake is fixed.&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 42 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|yi0714:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>