<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 10:54:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-2400] Null pointer exception when creating a template</title>
                <link>https://issues.apache.org/jira/browse/BEAM-2400</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;The template is successfully created, but is then followed by a null pointer exception.&lt;/p&gt;

&lt;p&gt;Command:&lt;br/&gt;
mvn compile exec:java      &lt;del&gt;Dexec.mainClass=com.example.WordCount      -Dexec.args=&quot;&lt;/del&gt;-runner=DataflowRunner \&lt;br/&gt;
                  --project=my-project \&lt;br/&gt;
                  --stagingLocation=gs://my-bucket/staging \&lt;br/&gt;
                  --output=gs://my-bucket/output/outputfile \&lt;br/&gt;
                  --templateLocation=gs://my-bucket/templates/mytemplate&quot;&lt;/p&gt;

&lt;p&gt;INFO: Template successfully created.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;WARNING&amp;#93;&lt;/span&gt; &lt;br/&gt;
java.lang.reflect.InvocationTargetException&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:606)&lt;br/&gt;
	at org.codehaus.mojo.exec.ExecJavaMojo$1.run(ExecJavaMojo.java:293)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:745)&lt;br/&gt;
Caused by: java.lang.NullPointerException&lt;br/&gt;
	at org.apache.beam.runners.dataflow.DataflowPipelineJob.getJobWithRetries(DataflowPipelineJob.java:489)&lt;br/&gt;
	at org.apache.beam.runners.dataflow.DataflowPipelineJob.getStateWithRetries(DataflowPipelineJob.java:465)&lt;br/&gt;
	at org.apache.beam.runners.dataflow.DataflowPipelineJob.waitUntilFinish(DataflowPipelineJob.java:304)&lt;br/&gt;
	at org.apache.beam.runners.dataflow.DataflowPipelineJob.waitUntilFinish(DataflowPipelineJob.java:240)&lt;br/&gt;
	at org.apache.beam.runners.dataflow.DataflowPipelineJob.waitUntilFinish(DataflowPipelineJob.java:193)&lt;br/&gt;
	at org.apache.beam.runners.dataflow.DataflowPipelineJob.waitUntilFinish(DataflowPipelineJob.java:186)&lt;br/&gt;
	at com.example.WordCount.main(WordCount.java:184)&lt;br/&gt;
	... 6 more&lt;/p&gt;</description>
                <environment></environment>
        <key id="13076605">BEAM-2400</key>
            <summary>Null pointer exception when creating a template</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10103" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">P3</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="melap">Melissa Pashniak</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Jun 2017 18:23:28 +0000</created>
                <updated>Fri, 3 Jun 2022 17:29:33 +0000</updated>
                                                                            <component>runner-dataflow</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16278934" author="tobi" created="Tue, 5 Dec 2017 17:44:01 +0000"  >&lt;p&gt;I&apos;m running into this as well.&lt;/p&gt;

&lt;p&gt;Turns out that when staging a template with the dataflow runner, you cannot call &lt;tt&gt;PipelineResult.waitForFinish()&lt;/tt&gt;. So if you have the common &lt;tt&gt;p.run().waitForFinish();&lt;/tt&gt; then your code throws NullPointerException when staging a template.&lt;/p&gt;

&lt;p&gt;Experimentally I found that even something like this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    PipelineResult result = p.run();
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!result.getState().isTerminal()) {
      result.waitUntilFinish();
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;will throw, but in this case it gives a more meaningful error:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; java.lang.UnsupportedOperationException: The result of template creation should not be used.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The only way I&apos;ve found that will call &lt;tt&gt;waitUntilFinish&lt;/tt&gt; when running the pipeline, and not call it when staging a template, is:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    PipelineResult result = p.run();
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (options.getTemplateLocation() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
      result.waitUntilFinish();
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16278936" author="tobi" created="Tue, 5 Dec 2017 17:45:37 +0000"  >&lt;p&gt;My request: change PipelineResult / waitUntilFinish so you can safely call &lt;tt&gt;p.run().waitUntilFinish()&lt;/tt&gt;, both when staging a template and when running a job.&lt;/p&gt;

&lt;p&gt;That is, I think it would be nice if &lt;tt&gt;waitUntilFinish&lt;/tt&gt; is a no-op when staging a template.&lt;/p&gt;</comment>
                            <comment id="16421819" author="daniel salerno" created="Sun, 1 Apr 2018 21:11:48 +0000"  >&lt;p&gt;Any official solution?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Tobi&quot; class=&quot;user-hover&quot; rel=&quot;tobi&quot;&gt;Tobi&lt;/a&gt;&#160;I tried this path that you suggested, the template is created without exceptions. However, when the template is run by Dataflow runner, the main pipeline code works correctly but the code after run () is not executed. It seems that waitUntilFinish does not work when it is run from a template.&lt;/p&gt;</comment>
                            <comment id="16709084" author="altay" created="Tue, 4 Dec 2018 18:37:16 +0000"  >&lt;p&gt;DataflowTemplateJob does not support waitUntilFinish. As there is no job to wait until completion. The bug is, it does not properly raise an UnsupportedOperationException. The reason is base class DataflowPipelineJob.java have additional code that will execute before calling into the waitUntilFinish implementation (&lt;a href=&quot;https://github.com/apache/beam/blob/master/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/util/DataflowTemplateJob.java#L52&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/master/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/util/DataflowTemplateJob.java#L52&lt;/a&gt;) in DataflowTemplateJob. &lt;/p&gt;

&lt;p&gt;Primarily direct use of `jobId` &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; instead of calling `getJobId()` will result in this. DataflowTemplateJob will raise UnsupportedOperationException properly for `getJobId()`.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/apache/beam/blob/a3a8a32dd64290a44c26bedff74b07d5ad571c82/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/DataflowPipelineJob.java#L471&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/a3a8a32dd64290a44c26bedff74b07d5ad571c82/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/DataflowPipelineJob.java#L471&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17473515" author="kenn" created="Wed, 12 Jan 2022 03:49:37 +0000"  >&lt;p&gt;This Jira ticket has a pull request attached to it, but is still open. Did the pull request resolve the issue? If so, could you please mark it resolved? This will help the project have a clear view of its open issues.&lt;/p&gt;</comment>
                            <comment id="17546497" author="kenn" created="Fri, 3 Jun 2022 17:29:33 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/apache/beam/issues/18363&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/issues/18363&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 23 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3frm7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>