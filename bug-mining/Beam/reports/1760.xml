<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 11:07:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-6860] WriteToText crash with &quot;GlobalWindow -&gt; ._IntervalWindowBase&quot;</title>
                <link>https://issues.apache.org/jira/browse/BEAM-6860</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;Main error:&lt;/p&gt;

&lt;p&gt;&amp;gt; Cannot convert GlobalWindow to apache_beam.utils.windowed_value._IntervalWindowBase&lt;/p&gt;

&lt;p&gt;This is very hard for me to debug. Doing a DoPar call before, printing the input, gives me just what I want; so the lines of data to serialise are &quot;alright&quot;; just JSON strings, in fact.&lt;/p&gt;

&lt;p&gt;Stacktrace:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Traceback (most recent call last):
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;./okr_end_ride.py&quot;&lt;/span&gt;, line 254, in &amp;lt;module&amp;gt;
&#160;&#160;&#160; run()
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;./okr_end_ride.py&quot;&lt;/span&gt;, line 250, in run
&#160;&#160;&#160; run_pipeline(pipeline_options, known_args)
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;./okr_end_ride.py&quot;&lt;/span&gt;, line 198, in run_pipeline
&#160;&#160;&#160; | &lt;span class=&quot;code-quote&quot;&gt;&apos;write_all&apos;&lt;/span&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp;gt;&amp;gt; WriteToText(known_args.output, file_name_suffix=&lt;span class=&quot;code-quote&quot;&gt;&quot;.txt&quot;&lt;/span&gt;)
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/h/.pyenv/versions/2.7.15/envs/log-analytics/lib/python2.7/site-packages/apache_beam/pipeline.py&quot;&lt;/span&gt;, line 426, in __exit__
&#160;&#160;&#160; self.run().wait_until_finish()
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/h/.pyenv/versions/2.7.15/envs/log-analytics/lib/python2.7/site-packages/apache_beam/pipeline.py&quot;&lt;/span&gt;, line 406, in run
&#160;&#160;&#160; self._options).run(False)
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/h/.pyenv/versions/2.7.15/envs/log-analytics/lib/python2.7/site-packages/apache_beam/pipeline.py&quot;&lt;/span&gt;, line 419, in run
&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.runner.run_pipeline(self, self._options)
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/h/.pyenv/versions/2.7.15/envs/log-analytics/lib/python2.7/site-packages/apache_beam/runners/direct/direct_runner.py&quot;&lt;/span&gt;, line 132, in run_pipeline
&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; runner.run_pipeline(pipeline, options)
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/h/.pyenv/versions/2.7.15/envs/log-analytics/lib/python2.7/site-packages/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 275, in run_pipeline
&#160;&#160;&#160; default_environment=self._default_environment))
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/h/.pyenv/versions/2.7.15/envs/log-analytics/lib/python2.7/site-packages/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 278, in run_via_runner_api
&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.run_stages(*self.create_stages(pipeline_proto))
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/h/.pyenv/versions/2.7.15/envs/log-analytics/lib/python2.7/site-packages/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 354, in run_stages
&#160;&#160;&#160; stage_context.safe_coders)
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/h/.pyenv/versions/2.7.15/envs/log-analytics/lib/python2.7/site-packages/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 509, in run_stage
&#160;&#160;&#160; data_input, data_output)
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/h/.pyenv/versions/2.7.15/envs/log-analytics/lib/python2.7/site-packages/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 1206, in process_bundle
&#160;&#160;&#160; result_future = self._controller.control_handler.push(process_bundle)
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/h/.pyenv/versions/2.7.15/envs/log-analytics/lib/python2.7/site-packages/apache_beam/runners/portability/fn_api_runner.py&quot;&lt;/span&gt;, line 821, in push
&#160;&#160;&#160; response = self.worker.do_instruction(request)
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/h/.pyenv/versions/2.7.15/envs/log-analytics/lib/python2.7/site-packages/apache_beam/runners/worker/sdk_worker.py&quot;&lt;/span&gt;, line 265, in do_instruction
&#160;&#160;&#160; request.instruction_id)
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/h/.pyenv/versions/2.7.15/envs/log-analytics/lib/python2.7/site-packages/apache_beam/runners/worker/sdk_worker.py&quot;&lt;/span&gt;, line 281, in process_bundle
&#160;&#160;&#160; delayed_applications = bundle_processor.process_bundle(instruction_id)
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/h/.pyenv/versions/2.7.15/envs/log-analytics/lib/python2.7/site-packages/apache_beam/runners/worker/bundle_processor.py&quot;&lt;/span&gt;, line 552, in process_bundle
&#160;&#160;&#160; op.finish()
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 549, in apache_beam.runners.worker.operations.DoOperation.finish
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 550, in apache_beam.runners.worker.operations.DoOperation.finish
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 551, in apache_beam.runners.worker.operations.DoOperation.finish
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/runners/common.py&quot;&lt;/span&gt;, line 758, in apache_beam.runners.common.DoFnRunner.finish
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/runners/common.py&quot;&lt;/span&gt;, line 752, in apache_beam.runners.common.DoFnRunner._invoke_bundle_method
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/runners/common.py&quot;&lt;/span&gt;, line 777, in apache_beam.runners.common.DoFnRunner._reraise_augmented
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/runners/common.py&quot;&lt;/span&gt;, line 750, in apache_beam.runners.common.DoFnRunner._invoke_bundle_method
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/runners/common.py&quot;&lt;/span&gt;, line 361, in apache_beam.runners.common.DoFnInvoker.invoke_finish_bundle
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/runners/common.py&quot;&lt;/span&gt;, line 364, in apache_beam.runners.common.DoFnInvoker.invoke_finish_bundle
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/runners/common.py&quot;&lt;/span&gt;, line 887, in apache_beam.runners.common._OutputProcessor.finish_bundle_outputs
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 130, in apache_beam.runners.worker.operations.SingletonConsumerSet.receive
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/runners/worker/operations.py&quot;&lt;/span&gt;, line 110, in apache_beam.runners.worker.operations.ConsumerSet.update_counters_start
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/runners/worker/opcounters.py&quot;&lt;/span&gt;, line 195, in apache_beam.runners.worker.opcounters.OperationCounters.update_from
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/runners/worker/opcounters.py&quot;&lt;/span&gt;, line 213, in apache_beam.runners.worker.opcounters.OperationCounters.do_sample
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/coders/coder_impl.py&quot;&lt;/span&gt;, line 991, in apache_beam.coders.coder_impl.WindowedValueCoderImpl.get_estimated_size_and_observables
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/coders/coder_impl.py&quot;&lt;/span&gt;, line 1007, in apache_beam.coders.coder_impl.WindowedValueCoderImpl.get_estimated_size_and_observables
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/coders/coder_impl.py&quot;&lt;/span&gt;, line 791, in apache_beam.coders.coder_impl.SequenceCoderImpl.estimate_size
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/coders/coder_impl.py&quot;&lt;/span&gt;, line 805, in apache_beam.coders.coder_impl.SequenceCoderImpl.get_estimated_size_and_observables
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/coders/coder_impl.py&quot;&lt;/span&gt;, line 145, in apache_beam.coders.coder_impl.CoderImpl.get_estimated_size_and_observables
&#160; File &lt;span class=&quot;code-quote&quot;&gt;&quot;apache_beam/coders/coder_impl.py&quot;&lt;/span&gt;, line 487, in apache_beam.coders.coder_impl.IntervalWindowCoderImpl.estimate_size
TypeError: Cannot convert GlobalWindow to apache_beam.utils.windowed_value._IntervalWindowBase [&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running &lt;span class=&quot;code-quote&quot;&gt;&apos;write_all/Write/WriteImpl/WriteBundles&apos;&lt;/span&gt;]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Slack thread: &lt;a href=&quot;https://the-asf.slack.com/archives/C9H0YNP3P/p1552928806101200&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://the-asf.slack.com/archives/C9H0YNP3P/p1552928806101200&lt;/a&gt; including code snippet&lt;/p&gt;

&lt;p&gt;Your issue tracker seems to be missing components for both the python on go SDKs.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>macOS, DirectRunner, python 2.7.15 via pyenv/pyenv-virtualenv</environment>
        <key id="13222552">BEAM-6860</key>
            <summary>WriteToText crash with &quot;GlobalWindow -&gt; ._IntervalWindowBase&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="udim">Udi Meiri</assignee>
                                    <reporter username="haf">Henrik</reporter>
                        <labels>
                            <label>newbie</label>
                    </labels>
                <created>Tue, 19 Mar 2019 11:52:53 +0000</created>
                <updated>Mon, 29 Jun 2020 18:22:34 +0000</updated>
                            <resolved>Mon, 20 Apr 2020 21:34:17 +0000</resolved>
                                    <version>2.11.0</version>
                                    <fixVersion>2.16.0</fixVersion>
                    <fixVersion>2.22.0</fixVersion>
                                    <component>sdk-py-core</component>
                        <due></due>
                            <votes>6</votes>
                                    <watches>12</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="5400">1.5h</timespent>
                                <comments>
                            <comment id="16860164" author="pshahid" created="Mon, 10 Jun 2019 17:07:11 +0000"  >&lt;p&gt;FWIW I&apos;m having this same issue on apache_beam 2.10, 2.11, 2.12, 2.13 python sdk; I confirmed that this works on 2.9.0 as well, which I saw in a stack overflow thread here (&lt;a href=&quot;https://stackoverflow.com/questions/55109403/apache-beam-python-sdk-upgrade-issue).&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/questions/55109403/apache-beam-python-sdk-upgrade-issue).&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It also fails not only on WriteToText, but also WriteToBigQuery. Specifically, this does not work when implementing windowing on a bounded data set and adding element timestamps. While doing this, I was working off of this example: &lt;a href=&quot;https://github.com/apache/beam/blob/master/sdks/python/apache_beam/examples/complete/game/hourly_team_score.py&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/master/sdks/python/apache_beam/examples/complete/game/hourly_team_score.py&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;However, this example actually works in later versions of the beam python SDK, so I&apos;m wondering if this is a user-issue with a very poor error message or if we&apos;re explicitly/implicitly using a feature of beam that the example does not.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Environment was:&lt;/p&gt;

&lt;p&gt;centos7 linux, kernel 3.10&lt;/p&gt;

&lt;p&gt;python 2.7.16&lt;/p&gt;

&lt;p&gt;apache beam versions: 2.9.0-2.13.0&lt;/p&gt;</comment>
                            <comment id="16861931" author="iemejia" created="Wed, 12 Jun 2019 09:16:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=altay&quot; class=&quot;user-hover&quot; rel=&quot;altay&quot;&gt;altay&lt;/a&gt; can you take a look or assign to someone else to check it.&lt;/p&gt;</comment>
                            <comment id="16870986" author="sacherus" created="Mon, 24 Jun 2019 09:07:55 +0000"  >&lt;p&gt;I am getting this same error:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/56705759/why-in-apache-beam-i-get-error-typeerror-cannot-convert-globalwindow-to-inte&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/questions/56705759/why-in-apache-beam-i-get-error-typeerror-cannot-convert-globalwindow-to-inte&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16929568" author="rgarver" created="Fri, 13 Sep 2019 22:27:05 +0000"  >&lt;p&gt;I&apos;m seeing this on Beam 2.15.0 and Python 3.7.4. The code is a really simple test of windowing in the &lt;tt&gt;DirectRunner&lt;/tt&gt; (read from a file, window, aggregate, write to a file). I&apos;ve been peeling back layers of this and the error definitely happens in&#160;&lt;tt&gt;WriteToText&lt;/tt&gt; and is caused by the presence of a&#160;&lt;tt&gt;beam.WindowInto&lt;/tt&gt; in the pipeline.&lt;/p&gt;

&lt;p&gt;Any thoughts on what is going on and how it might be worked around would be helpful.&lt;/p&gt;</comment>
                            <comment id="16965173" author="altay" created="Sat, 2 Nov 2019 00:47:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chamikara&quot; class=&quot;user-hover&quot; rel=&quot;chamikara&quot;&gt;chamikara&lt;/a&gt;&#160;any idea?&lt;/p&gt;</comment>
                            <comment id="17015431" author="chamikara" created="Tue, 14 Jan 2020 22:00:00 +0000"  >&lt;p&gt;This was potentially fixed for Beam 2.16.0 by following.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/beam/commit/d8c11464e9af426448c057993e3dca51adb8d697&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/commit/d8c11464e9af426448c057993e3dca51adb8d697&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17018235" author="chamikara" created="Fri, 17 Jan 2020 18:32:48 +0000"  >&lt;p&gt;I&apos;ll close this for now.&#160;&lt;/p&gt;

&lt;p&gt;Please add reproduction (pipeline) if this is still occurring for some reason.&lt;/p&gt;</comment>
                            <comment id="17067288" author="joshpeng-quibi" created="Thu, 26 Mar 2020 01:45:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chamikara&quot; class=&quot;user-hover&quot; rel=&quot;chamikara&quot;&gt;chamikara&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This seems to still be happening in Python Beam 2.19.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; argparse
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; apache_beam as beam
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; apache_beam.transforms.window as window
from apache_beam.io &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; WriteToText
from apache_beam.options.pipeline_options &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; PipelineOptions, StandardOptions


def CombineFn(m):
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;\n&quot;&lt;/span&gt;.join(m)


def run(argv=None):
    parser = argparse.ArgumentParser()
    parser.add_argument(&lt;span class=&quot;code-quote&quot;&gt;&apos;--output_path&apos;&lt;/span&gt;,
                        dest=&lt;span class=&quot;code-quote&quot;&gt;&apos;output_path&apos;&lt;/span&gt;,
                        required=True,
                        help=&lt;span class=&quot;code-quote&quot;&gt;&apos;Output GCS path location &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; dumping&apos;&lt;/span&gt;)
    known_args, pipeline_args = parser.parse_known_args(argv)
    pipeline_options = PipelineOptions(pipeline_args)

    with beam.Pipeline(options=pipeline_options) as p:
        lines = (p | &lt;span class=&quot;code-quote&quot;&gt;&apos;Read&apos;&lt;/span&gt; &amp;gt;&amp;gt; beam.io.ReadFromText(&lt;span class=&quot;code-quote&quot;&gt;&apos;./src/to_gcs/test.txt&apos;&lt;/span&gt;)
                   | &lt;span class=&quot;code-quote&quot;&gt;&apos;Fixed 10min window&apos;&lt;/span&gt; &amp;gt;&amp;gt; beam.WindowInto(window.FixedWindows(10))
                   | &lt;span class=&quot;code-quote&quot;&gt;&apos;Write to GCS&apos;&lt;/span&gt; &amp;gt;&amp;gt; WriteToText(known_args.output_path)
                )


&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; __name__ == &lt;span class=&quot;code-quote&quot;&gt;&quot;__main__&quot;&lt;/span&gt;:
    run()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Even using DirectRunner causes:&lt;/p&gt;

&lt;p&gt;TypeError: Cannot convert GlobalWindow to apache_beam.utils.windowed_value._IntervalWindowBase &lt;span class=&quot;error&quot;&gt;&amp;#91;while running &amp;#39;Write to GCS/Write/WriteImpl/WriteBundles&amp;#39;&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I can also confirm that this exact code works in Beam 2.9.&lt;/p&gt;</comment>
                            <comment id="17079956" author="bhulette" created="Thu, 9 Apr 2020 19:20:29 +0000"  >&lt;p&gt;I suspect that &lt;a href=&quot;https://github.com/apache/beam/pull/7170&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/7170&lt;/a&gt; is the reason this doesn&apos;t work now when it did work in 2.9. The &lt;a href=&quot;https://github.com/apache/beam/blob/ff8ce834ff24e847c90872a4ea545f987e3e0a2d/sdks/python/apache_beam/coders/coder_impl.pxd#L170&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;line in coder_impl.pxd&lt;/a&gt; that raises this exception was added in that PR. That being said I don&apos;t think this is a bug introduced in 2.9, its just revealing some other issue.&lt;/p&gt;

&lt;p&gt;Note it doesn&apos;t have any meaning to window into FixedWindows immediately prior to WriteToText - internally it will just &lt;a href=&quot;https://github.com/apache/beam/blob/ff8ce834ff24e847c90872a4ea545f987e3e0a2d/sdks/python/apache_beam/io/iobase.py#L1021&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;drop eveything back into the GlobalWindow&lt;/a&gt;. You can just drop that transform and this pipeline should work.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chamikara&quot; class=&quot;user-hover&quot; rel=&quot;chamikara&quot;&gt;chamikara&lt;/a&gt; it seems like the real issue here is that somehow we end up attempting to use IntervalWindowCoder with the GlobalWindow. Any idea how that&apos;s happening?&lt;/p&gt;
</comment>
                            <comment id="17080225" author="joshpeng-quibi" created="Fri, 10 Apr 2020 04:48:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bhulette&quot; class=&quot;user-hover&quot; rel=&quot;bhulette&quot;&gt;bhulette&lt;/a&gt;&#160;in the example code I was just having it come from a text file, but in my more real-world scenario I am reading from PubSub, that is why I wanted to window it before WriteToText. It errors in both scenarios regardless of initial input source when doing the WriteToText with a fixed window. Going into global window from streaming source becomes unwieldy.&lt;/p&gt;</comment>
                            <comment id="17083583" author="chamikara" created="Tue, 14 Apr 2020 20:26:39 +0000"  >&lt;p&gt;Please file a new Jira and assign to the author if you believe&#160;&lt;a href=&quot;https://github.com/apache/beam/pull/7170&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/7170&lt;/a&gt;&#160;broke this.&lt;/p&gt;</comment>
                            <comment id="17085115" author="udim" created="Thu, 16 Apr 2020 17:33:15 +0000"  >&lt;p&gt;This is still an issue. In the latest Beam it manifests as:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
AttributeError: &lt;span class=&quot;code-quote&quot;&gt;&apos;GlobalWindow&apos;&lt;/span&gt; object has no attribute &lt;span class=&quot;code-quote&quot;&gt;&apos;_end_micros&apos;&lt;/span&gt; [&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running &lt;span class=&quot;code-quote&quot;&gt;&apos;Write/Write/WriteImpl/WriteBundles&apos;&lt;/span&gt;]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17088097" author="udim" created="Mon, 20 Apr 2020 21:34:07 +0000"  >&lt;p&gt;Fix should go into 2.22 release.&lt;/p&gt;

&lt;p&gt;Meanwhile, I believe a possible workaround is to window into global windows before WriteToText.&lt;br/&gt;
Please let me know if that doesn&apos;t work.&lt;/p&gt;</comment>
                            <comment id="17145835" author="pesach" created="Thu, 25 Jun 2020 21:00:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=udim&quot; class=&quot;user-hover&quot; rel=&quot;udim&quot;&gt;udim&lt;/a&gt; This is still an issue (in python3, beam2.22)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13006465/13006465_stacktrace.txt&quot; title=&quot;stacktrace.txt attached to BEAM-6860&quot;&gt;stacktrace.txt&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17148062" author="udim" created="Mon, 29 Jun 2020 18:22:34 +0000"  >&lt;p&gt;Pesach, I just tried Josh&apos;s code above and it works on Beam 2.22 with Python 3.7.5.&lt;/p&gt;

&lt;p&gt;Can you give an example pipeline or more details please?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13006465" name="stacktrace.txt" size="220305" author="pesach" created="Thu, 25 Jun 2020 21:00:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12311020" key="com.atlassian.jira.plugin.system.customfieldtypes:url">
                        <customfieldname>External issue URL</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[https://the-asf.slack.com/archives/C9H0YNP3P/p1552928806101200]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 20 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z00uw8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>