<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 10:53:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-5683] [beam_PostCommit_Py_VR_Dataflow] [test_multiple_empty_outputs] Fails due to pip download flake</title>
                <link>https://issues.apache.org/jira/browse/BEAM-5683</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;&lt;em&gt;Use this form to file an issue for test failure:&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://builds.apache.org/job/beam_PostCommit_Py_VR_Dataflow/1289/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Jenkins Job&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://scans.gradle.com/s/hjmzvh4ylhs6y/console-log?task=:beam-sdks-python:validatesRunnerBatchTests&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Gradle Build Scan&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/beam/blob/303a4275eb0a323761e1a4dec6a22fde9863acf8/sdks/python/apache_beam/runners/portability/stager.py#L390&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Test source code&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Initial investigation:&lt;/p&gt;

&lt;p&gt;Seems to be failing on pip download.&lt;/p&gt;


&lt;p&gt;======================================================================&lt;br/&gt;
ERROR: test_multiple_empty_outputs (apache_beam.transforms.ptransform_test.PTransformTest)&lt;br/&gt;
----------------------------------------------------------------------&lt;br/&gt;
Traceback (most recent call last):&lt;br/&gt;
  File &quot;/home/jenkins/jenkins-slave/workspace/beam_PostCommit_Py_VR_Dataflow/src/sdks/python/apache_beam/transforms/ptransform_test.py&quot;, line 277, in test_multiple_empty_outputs&lt;br/&gt;
    pipeline.run()&lt;br/&gt;
  File &quot;/home/jenkins/jenkins-slave/workspace/beam_PostCommit_Py_VR_Dataflow/src/sdks/python/apache_beam/testing/test_pipeline.py&quot;, line 104, in run&lt;br/&gt;
    result = super(TestPipeline, self).run(test_runner_api)&lt;br/&gt;
  File &quot;/home/jenkins/jenkins-slave/workspace/beam_PostCommit_Py_VR_Dataflow/src/sdks/python/apache_beam/pipeline.py&quot;, line 403, in run&lt;br/&gt;
    self.to_runner_api(), self.runner, self._options).run(False)&lt;br/&gt;
  File &quot;/home/jenkins/jenkins-slave/workspace/beam_PostCommit_Py_VR_Dataflow/src/sdks/python/apache_beam/pipeline.py&quot;, line 416, in run&lt;br/&gt;
    return self.runner.run_pipeline(self)&lt;br/&gt;
  File &quot;/home/jenkins/jenkins-slave/workspace/beam_PostCommit_Py_VR_Dataflow/src/sdks/python/apache_beam/runners/dataflow/test_dataflow_runner.py&quot;, line 50, in run_pipeline&lt;br/&gt;
    self.result = super(TestDataflowRunner, self).run_pipeline(pipeline)&lt;br/&gt;
  File &quot;/home/jenkins/jenkins-slave/workspace/beam_PostCommit_Py_VR_Dataflow/src/sdks/python/apache_beam/runners/dataflow/dataflow_runner.py&quot;, line 389, in run_pipeline&lt;br/&gt;
    self.dataflow_client.create_job(self.job), self)&lt;br/&gt;
  File &quot;/home/jenkins/jenkins-slave/workspace/beam_PostCommit_Py_VR_Dataflow/src/sdks/python/apache_beam/utils/retry.py&quot;, line 184, in wrapper&lt;br/&gt;
    return fun(*args, **kwargs)&lt;br/&gt;
  File &quot;/home/jenkins/jenkins-slave/workspace/beam_PostCommit_Py_VR_Dataflow/src/sdks/python/apache_beam/runners/dataflow/internal/apiclient.py&quot;, line 490, in create_job&lt;br/&gt;
    self.create_job_description(job)&lt;br/&gt;
  File &quot;/home/jenkins/jenkins-slave/workspace/beam_PostCommit_Py_VR_Dataflow/src/sdks/python/apache_beam/runners/dataflow/internal/apiclient.py&quot;, line 519, in create_job_description&lt;br/&gt;
    resources = self._stage_resour&lt;br/&gt;
ces(job.options)&lt;br/&gt;
  File &quot;/home/jenkins/jenkins-slave/workspace/beam_PostCommit_Py_VR_Dataflow/src/sdks/python/apache_beam/runners/dataflow/internal/apiclient.py&quot;, line 452, in _stage_resources&lt;br/&gt;
    staging_location=google_cloud_options.staging_location)&lt;br/&gt;
  File &quot;/home/jenkins/jenkins-slave/workspace/beam_PostCommit_Py_VR_Dataflow/src/sdks/python/apache_beam/runners/portability/stager.py&quot;, line 161, in stage_job_resources&lt;br/&gt;
    requirements_cache_path)&lt;br/&gt;
  File &quot;/home/jenkins/jenkins-slave/workspace/beam_PostCommit_Py_VR_Dataflow/src/sdks/python/apache_beam/runners/portability/stager.py&quot;, line 411, in _populate_requirements_cache&lt;br/&gt;
    processes.check_call(cmd_args)&lt;br/&gt;
  File &quot;/home/jenkins/jenkins-slave/workspace/beam_PostCommit_Py_VR_Dataflow/src/sdks/python/apache_beam/utils/processes.py&quot;, line 46, in check_call&lt;br/&gt;
    return subprocess.check_call(*args, **kwargs)&lt;br/&gt;
  File &quot;/usr/lib/python2.7/subprocess.py&quot;, line 541, in check_call&lt;br/&gt;
    raise CalledProcessError(retcode, cmd)&lt;br/&gt;
CalledProcessError: Command &apos;&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;/home/jenkins/jenkins-slave/workspace/beam_PostCommit_Py_VR_Dataflow/src/sdks/python/build/gradleenv/bin/python&amp;#39;, &amp;#39;-m&amp;#39;, &amp;#39;pip&amp;#39;, &amp;#39;download&amp;#39;, &amp;#39;--dest&amp;#39;, &amp;#39;/tmp/dataflow-requirements-cache&amp;#39;, &amp;#39;-r&amp;#39;, &amp;#39;postcommit_requirements.txt&amp;#39;, &amp;#39;--exists-action&amp;#39;, &amp;#39;i&amp;#39;, &amp;#39;--no-binary&amp;#39;, &amp;#39;:all:&amp;#39;&amp;#93;&lt;/span&gt;&apos; returned non-zero exit status 1&lt;/p&gt;


&lt;hr /&gt;
&lt;p&gt;&lt;em&gt;After you&apos;ve filled out the above details, please &lt;a href=&quot;https://beam.apache.org/contribute/postcommits-guides/index.html#find_specialist&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;assign the issue to an individual&lt;/a&gt;. Assignee should &lt;a href=&quot;https://beam.apache.org/contribute/postcommits-policies/#assigned-failing-test&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;treat test failures as high-priority&lt;/a&gt;, helping to fix the issue or find a more appropriate owner. See &lt;a href=&quot;https://beam.apache.org/contribute/postcommits-policies&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Apache Beam Post-Commit Policies&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13190184">BEAM-5683</key>
            <summary>[beam_PostCommit_Py_VR_Dataflow] [test_multiple_empty_outputs] Fails due to pip download flake</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="angoenka">Ankur Goenka</assignee>
                                    <reporter username="swegner">Scott Wegner</reporter>
                        <labels>
                            <label>currently-failing</label>
                            <label>flake</label>
                    </labels>
                <created>Mon, 8 Oct 2018 18:48:20 +0000</created>
                <updated>Wed, 24 Mar 2021 21:15:19 +0000</updated>
                            <resolved>Fri, 4 Jan 2019 01:44:52 +0000</resolved>
                                                    <fixVersion>2.10.0</fixVersion>
                                    <component>sdk-py-harness</component>
                    <component>test-failures</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="5400">1.5h</timespent>
                                <comments>
                            <comment id="16642309" author="swegner" created="Mon, 8 Oct 2018 18:52:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=angoenka&quot; class=&quot;user-hover&quot; rel=&quot;angoenka&quot;&gt;angoenka&lt;/a&gt; I see you [previously worked on the &lt;a href=&quot;https://github.com/apache/beam/pull/5251&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;_populate_requirements_cache&lt;/a&gt; code. Can you help investigate this flake or find a more appropriate owner?&lt;/p&gt;</comment>
                            <comment id="16642450" author="angoenka" created="Mon, 8 Oct 2018 20:37:27 +0000"  >&lt;p&gt;Looking at it.&lt;/p&gt;</comment>
                            <comment id="16642484" author="angoenka" created="Mon, 8 Oct 2018 21:01:03 +0000"  >&lt;p&gt;As mentioned earlier, the test case seems to be failing because of pip.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;pip is executed as a subprocess from python. Can we access pip subprocess logs?&lt;/p&gt;</comment>
                            <comment id="16643606" author="swegner" created="Tue, 9 Oct 2018 15:19:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pabloem&quot; class=&quot;user-hover&quot; rel=&quot;pabloem&quot;&gt;pabloem&lt;/a&gt; / &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=robertwb&quot; class=&quot;user-hover&quot; rel=&quot;robertwb&quot;&gt;robertwb&lt;/a&gt; can either of you help out?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Can we access pip subprocess logs?&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="16643661" author="pabloem" created="Tue, 9 Oct 2018 15:49:46 +0000"  >&lt;p&gt;I&apos;ll take a look in a bit&lt;/p&gt;</comment>
                            <comment id="16643939" author="swegner" created="Tue, 9 Oct 2018 18:45:47 +0000"  >&lt;p&gt;This failed again today: &lt;a href=&quot;https://builds.apache.org/job/beam_PostCommit_Py_VR_Dataflow/1303/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/beam_PostCommit_Py_VR_Dataflow/1303/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16644065" author="pabloem" created="Tue, 9 Oct 2018 20:42:11 +0000"  >&lt;p&gt;it&apos;s possible to get the output from the subprocess with `check_output` instead of `check_call`. We may also want to add retries to the command that fetches from pip...&lt;/p&gt;</comment>
                            <comment id="16645718" author="angoenka" created="Wed, 10 Oct 2018 23:39:16 +0000"  >&lt;p&gt;I agree.&lt;/p&gt;

&lt;p&gt;Shall we&#160;expose the pip logs?&lt;/p&gt;

&lt;p&gt;I think exposing&#160;when failed should be ok.&lt;/p&gt;</comment>
                            <comment id="16645730" author="angoenka" created="Wed, 10 Oct 2018 23:47:38 +0000"  >&lt;p&gt;check_output does that by default.&lt;/p&gt;</comment>
                            <comment id="16662843" author="herohde" created="Wed, 24 Oct 2018 21:06:53 +0000"  >&lt;p&gt;Another failure: &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://scans.gradle.com/s/gs2tdpv4gbhiw/console-log?task=:beam-sdks-python:validatesRunnerBatchTests&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://scans.gradle.com/s/gs2tdpv4gbhiw/console-log?task=:beam-sdks-python:validatesRunnerBatchTests&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16733674" author="rohdesam" created="Fri, 4 Jan 2019 00:25:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=angoenka&quot; class=&quot;user-hover&quot; rel=&quot;angoenka&quot;&gt;angoenka&lt;/a&gt; ping&lt;/p&gt;

&lt;p&gt;Can you please take a look?&lt;/p&gt;</comment>
                            <comment id="16733716" author="angoenka" created="Fri, 4 Jan 2019 01:44:32 +0000"  >&lt;p&gt;This should be fixed after adding retry in&#160;&lt;a href=&quot;https://github.com/apache/beam/pull/7043&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;GitHub Pull Request #7043&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Please reopen if needed.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13181476">BEAM-5244</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13160117">BEAM-4332</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13189498">BEAM-5648</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 45 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3yykv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>