<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 10:59:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-5354] Side Inputs seems to be non-working in the sdk-go</title>
                <link>https://issues.apache.org/jira/browse/BEAM-5354</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;Running the contains example fails with&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Output i0 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; step was not found.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is because of the call to debug.Head (which internally uses SideInput)&lt;/p&gt;

&lt;p&gt;Removing the following line &lt;a href=&quot;https://github.com/apache/beam/blob/master/sdks/go/examples/contains/contains.go#L50&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/master/sdks/go/examples/contains/contains.go#L50&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The pipeline executes well.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Executed on id&apos;s&lt;/p&gt;

&lt;p&gt;&#160;&lt;br/&gt;
go-job-1-1536664417610678545 &lt;br/&gt;
vs&lt;br/&gt;
go-job-1-1536664934354466938&lt;br/&gt;
&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13184302">BEAM-5354</key>
            <summary>Side Inputs seems to be non-working in the sdk-go</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lostluck">Robert Burke</assignee>
                                    <reporter username="ptomasroos">Tomas Roos</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Sep 2018 11:36:28 +0000</created>
                <updated>Sat, 16 May 2020 14:01:44 +0000</updated>
                            <resolved>Wed, 22 Jan 2020 18:33:05 +0000</resolved>
                                                    <fixVersion>Not applicable</fixVersion>
                                    <component>sdk-go</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="4200">1h 10m</timespent>
                                <comments>
                            <comment id="16610976" author="lostluck" created="Tue, 11 Sep 2018 17:26:38 +0000"  >&lt;p&gt;@ptomasroos&lt;br/&gt;
It doesn&apos;t seem like the Debug is necessary, so for the purposes of the example we could commit the change to remove it as you&apos;ve suggested.&lt;br/&gt;
That said, there&apos;s evidently a distinct error in the debug.Head function that needs resolving.&lt;/p&gt;</comment>
                            <comment id="16613295" author="ptomasroos" created="Thu, 13 Sep 2018 10:20:06 +0000"  >&lt;p&gt;I agree that its not necessary but I would love to provide a fix but at this moment my knowledge is too limited to figure it out. Do you have any hints for me in order to be able to debug this faster than having a 2-4 minute feedback loop when developing against dataflow? It would be great if one could have the direct runner to oppose the same constraints as dataflow, because most examples are running fine on the direct runner but now when targeting another runner.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;In this case sure we could remove it but on the otherhand that would mean that the debug.Head won&apos;t be usable by developers which I find a bit sad since its very useful!&lt;/p&gt;</comment>
                            <comment id="16613379" author="robertwb" created="Thu, 13 Sep 2018 12:02:55 +0000"  >&lt;p&gt;There are some worker harness bugs in handling of side inputs on dataflow that I&apos;ve been fixing. I&apos;m in the process of pushing out new containers.&#160;&lt;/p&gt;</comment>
                            <comment id="16613384" author="ptomasroos" created="Thu, 13 Sep 2018 12:07:16 +0000"  >&lt;p&gt;All right, let me know when its updated and I will give you some feedback if it was solved or not.&lt;/p&gt;</comment>
                            <comment id="16613736" author="herohde" created="Thu, 13 Sep 2018 16:34:17 +0000"  >&lt;p&gt;Technically, the side input feature on Dataflow is not implemented yet: &lt;a href=&quot;https://issues.apache.org/jira/browse/BEAM-3286&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/BEAM-3286&lt;/a&gt;. I ran into an error on Dataflow that might be explained by Robert&apos;s work, but never got back to it. So YMMV.&lt;/p&gt;</comment>
                            <comment id="16850271" author="lostluck" created="Wed, 29 May 2019 01:13:38 +0000"  >&lt;p&gt;&#160;I have a fix!&lt;/p&gt;

&lt;p&gt;There&apos;s a book keeping step in the Portability Protos that requires side inputs to have another transform added to the graph for them to work, but this step was only being to as the root scope, which causes them to manifest poorly in the Dataflow representation, when that value was infixed in a scope. Which is essentially any time.&lt;/p&gt;

&lt;p&gt;For Example: Say one has a scope S, with transforms SA, where SB takes in a Side input.&lt;/p&gt;

&lt;p&gt;The side input for SB would need a SBKeyed step added to the graph.&lt;/p&gt;

&lt;p&gt;Presently, SBKeyed would be added as a root_transform to the graph. This causes runners sensitive to the ordering to sometimes put&#160;SBKeyed &lt;b&gt;after&lt;/b&gt; SB, which in Dataflow&apos;s case, triggers the above error.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The fix is to properly add inserted transforms to the parent scope when transforming the graph to the portability representation in graphx/translate.go&lt;/p&gt;</comment>
                            <comment id="16850591" author="robertwb" created="Wed, 29 May 2019 07:46:50 +0000"  >&lt;p&gt;Runner sensitivity to step ordering seems like it&apos;s something that should be fixed regardless of this workaround. Is there a JIRA for that?&lt;/p&gt;</comment>
                            <comment id="16850987" author="lostluck" created="Wed, 29 May 2019 15:42:51 +0000"  >&lt;p&gt;I don&apos;t believe there&apos;s a Jira for that, largely because AFAICT it&apos;s only something that affects Dataflow, and Dataflow predominantely supports use via the Legacy SDK implementations, rather than pure portable ones. The issue comes from Dataflow&apos;s v1b3 representation of the graph, which is a topologically ordered set of steps (transforms as nodes, with pcollections being implicit), rather than the normalized representation of the Portable Pipeline Proto.&lt;/p&gt;

&lt;p&gt;The behavior did reveal a subtle, but mostly benign bug in the Go SDK though. The Go SDK takes it&apos;s own internal representation, and converts it to the PPP. In some cases, (notably&#160;CoGBK &amp;amp; Side Inputs), it&apos;s required to add additional PTransforms &amp;amp; PCollections. The additional PTransforms were not being correctly added as&#160;sibling transforms of the side input consumer, and were instead added at the root transform level. I don&apos;t believe any runner based purely on the PPP would complain though, as having inputs from outside the current scope is permitted by the model, and that the relations between transforms are indirected though the collections.&lt;/p&gt;

&lt;p&gt;The overall fix would be for Dataflow to stop requiring it&apos;s own v1b3 representation, and only&#160;requiring the PPP for&#160;portable SDKs, rather than (modulo service+SDK version support horizons etc.). The Go SDK for example generates the v1b3 directly from the PPP, so the only things stopping the service from doing so is adding their own translation to spur the migration.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 24 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3xyfr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>