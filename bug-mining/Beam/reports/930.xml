<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 10:55:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-5386] Flink Runner gets progressively stuck when Pubsub subscription is nearly empty</title>
                <link>https://issues.apache.org/jira/browse/BEAM-5386</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;I am running the Flink runner on Apache Beam 2.6.0.&lt;/p&gt;

&lt;p&gt;My pipeline involves reading from Google Cloud Pubsub. The problem is that whenever there are few messages left in the subscription I&apos;m reading from, the whole job becomes progressively slower and slower, Flink&apos;s checkpoints start taking much more time and messages seem to not get properly acknowledged.&lt;/p&gt;

&lt;p&gt;This happens only whenever the subscription is nearly empty. For example when running 13 taskmanagers with parallelism of 52 for the job and a subscription that has 122 000 000 messages, you start feeling the slowing down after there are only 1 000 000 - 2 000 000 messages left.&lt;/p&gt;

&lt;p&gt;In one of my tests the job processed&#160;nearly 122 000 000 messages in an hour and then spent over 30 minutes attempting to do the few hundred thousand left. In the end it was reading a few hundred messages a minute and not reading at all for some periods. Upon stopping it the subscription still had 235 unacknowledged messages, even though Flink&apos;s element count was higher than the amount of messages I had loaded. The only explanation is that the messages did not get properly acknowledged and were resent.&lt;/p&gt;

&lt;p&gt;I have set up the subscriptions to a large acknowledgment deadline, but that does not help.&lt;/p&gt;

&lt;p&gt;I did smaller tests on subscriptions with 100 000 messages and a job that simply reads and does nothing else. The problem is still evident. With parallelism of 52 the job gets slow right away. Takes over 5min to read about 100 000 messages and a few&#160;hundred seem to keep cycling through never being acknowledged.&lt;/p&gt;

&lt;p&gt;On the other hand a parallelism of 1 works fine until there are about 5000 messages left, and then slows down similarly.&lt;/p&gt;

&lt;p&gt;Parallelism of 16 reads about 75 000 of the 100 000 immediately (a few seconds) and then proceeds to slowly&#160;work on the other 25 000 for minutes.&lt;/p&gt;

&lt;p&gt;The PubsubIO connector is provided by Beam so I suspect the problem to be in Beam&apos;s Flink runner rather than Flink itself.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13185151">BEAM-5386</key>
            <summary>Flink Runner gets progressively stuck when Pubsub subscription is nearly empty</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mxm">Maximilian Michels</assignee>
                                    <reporter username="enchom">Encho Mishinev</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 Sep 2018 13:46:55 +0000</created>
                <updated>Sat, 16 May 2020 13:53:37 +0000</updated>
                            <resolved>Sun, 30 Dec 2018 20:09:09 +0000</resolved>
                                    <version>2.6.0</version>
                    <version>2.7.0</version>
                    <version>2.8.0</version>
                    <version>2.9.0</version>
                                    <fixVersion>2.10.0</fixVersion>
                                    <component>io-java-gcp</component>
                    <component>runner-flink</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="22800">6h 20m</timespent>
                                <comments>
                            <comment id="16693345" author="mxm" created="Tue, 20 Nov 2018 15:04:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chamikara&quot; class=&quot;user-hover&quot; rel=&quot;chamikara&quot;&gt;chamikara&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enchom&quot; class=&quot;user-hover&quot; rel=&quot;enchom&quot;&gt;enchom&lt;/a&gt; Thanks for reporting this. Have you done any more investigation, e.g. profiling?&lt;/p&gt;

&lt;p&gt;As I mentioned on the mailing list, I&apos;m eager to fix this bug but I couldn&apos;t find anything suspicious in &lt;tt&gt;UnboundedSourceWrapper&lt;/tt&gt; so far.&lt;/p&gt;</comment>
                            <comment id="16731064" author="mxm" created="Sun, 30 Dec 2018 20:09:09 +0000"  >&lt;p&gt;Resolving this because the cause has been fixed via the linked pull request.&lt;/p&gt;

&lt;p&gt;Thanks again for reporting this. Would be great to see if you gave this another try with the new release or the snapshot version.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="13225858">BEAM-6998</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 46 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3y3mn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>