<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 11:24:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-10529] Kafka XLang fails for ?empty? key/values</title>
                <link>https://issues.apache.org/jira/browse/BEAM-10529</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;It looks like the Javadoc for ByteArrayDeserializer and StringDeserializer can return null&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2&amp;#93;&lt;/span&gt; and we aren&apos;t using NullableCoder.of(ByteArrayCoder.of()) in the expansion&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;. Note that KafkaIO does this correctly in its regular coder inference logic&lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;1:&#160;&lt;a href=&quot;https://kafka.apache.org/21/javadoc/org/apache/kafka/common/serialization/ByteArrayDeserializer.html#deserialize-java.lang.String-byte:A-2:&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://kafka.apache.org/21/javadoc/org/apache/kafka/common/serialization/ByteArrayDeserializer.html#deserialize-java.lang.String-byte:A-&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://kafka.apache.org/21/javadoc/org/apache/kafka/common/serialization/ByteArrayDeserializer.html#deserialize-java.lang.String-byte:A-2:&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2:&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;a href=&quot;https://kafka.apache.org/21/javadoc/org/apache/kafka/common/serialization/StringDeserializer.html#deserialize-java.lang.String-byte:A-&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://kafka.apache.org/21/javadoc/org/apache/kafka/common/serialization/StringDeserializer.html#deserialize-java.lang.String-byte:A-&lt;/a&gt;&lt;br/&gt;
3: &lt;a href=&quot;https://github.com/apache/beam/blob/af2d6b0379d64b522ecb769d88e9e7e7b8900208/sdks/java/io/kafka/src/main/java/org/apache/beam/sdk/io/kafka/KafkaIO.java#L478&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/af2d6b0379d64b522ecb769d88e9e7e7b8900208/sdks/java/io/kafka/src/main/java/org/apache/beam/sdk/io/kafka/KafkaIO.java#L478&lt;/a&gt;&lt;br/&gt;
4: &lt;a href=&quot;https://github.com/apache/beam/blob/af2d6b0379d64b522ecb769d88e9e7e7b8900208/sdks/java/io/kafka/src/main/java/org/apache/beam/sdk/io/kafka/LocalDeserializerProvider.java#L85&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/af2d6b0379d64b522ecb769d88e9e7e7b8900208/sdks/java/io/kafka/src/main/java/org/apache/beam/sdk/io/kafka/LocalDeserializerProvider.java#L85&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13317514">BEAM-10529</key>
            <summary>Kafka XLang fails for ?empty? key/values</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10101" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">P1</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="johnjcasey">John Casey</assignee>
                                    <reporter username="lcwik">Luke Cwik</reporter>
                        <labels>
                    </labels>
                <created>Sat, 18 Jul 2020 03:01:13 +0000</created>
                <updated>Wed, 18 May 2022 16:15:41 +0000</updated>
                            <resolved>Mon, 11 Apr 2022 14:48:48 +0000</resolved>
                                                    <fixVersion>2.39.0</fixVersion>
                                    <component>cross-language</component>
                    <component>io-java-kafka</component>
                        <due></due>
                            <votes>33</votes>
                                    <watches>16</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="96600">26h 50m</timespent>
                                <comments>
                            <comment id="17168303" author="chamikara" created="Thu, 30 Jul 2020 23:37:55 +0000"  >&lt;p&gt;I think the fix here will be a bit more complex than just changing the coder to NullableCoder.of(ByteArrayCoder.of()).&lt;/p&gt;

&lt;p&gt;NullableCoder is not a standard coder, so some runners may break when it&apos;s set at the cross-language boundary. Should we be adding something like NullableCoder to standard coders ?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;cc: &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=robertwb&quot; class=&quot;user-hover&quot; rel=&quot;robertwb&quot;&gt;robertwb&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17170356" author="lcwik" created="Mon, 3 Aug 2020 19:01:41 +0000"  >&lt;p&gt;It seems like one that might be worthwhile to make well known, alternatively we use RowCoder since it should support null fields.&lt;/p&gt;</comment>
                            <comment id="17173425" author="chamikara" created="Fri, 7 Aug 2020 19:33:39 +0000"  >&lt;p&gt;cc: &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=robertwb&quot; class=&quot;user-hover&quot; rel=&quot;robertwb&quot;&gt;robertwb&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bhulette&quot; class=&quot;user-hover&quot; rel=&quot;bhulette&quot;&gt;bhulette&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17173428" author="bhulette" created="Fri, 7 Aug 2020 19:39:34 +0000"  >&lt;p&gt;I just added an implementation of NullableCoder to python in &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;, but it was just for use in the Python RowCoder. I didn&apos;t give it it&apos;s own standard coder URN. It shouldn&apos;t be too much trouble to make standard now.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/apache/beam/pull/12426&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/12426&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17173431" author="chamikara" created="Fri, 7 Aug 2020 19:50:18 +0000"  >&lt;p&gt;Are the Python and Java nullable coders compatible ? I.e. can you encode from Java and decode from Python and vice versa ?&lt;/p&gt;</comment>
                            <comment id="17173483" author="bhulette" created="Fri, 7 Aug 2020 21:32:30 +0000"  >&lt;p&gt;Yeah they&apos;re meant to be compatible since it&apos;s used as part of RowCoder. It&apos;s verified as part of this standard_coders.yaml test for RowCoder: &lt;a href=&quot;https://github.com/apache/beam/blob/9303f651f951fe130db43a239d60016c18f9cc49/model/fn-execution/src/main/resources/org/apache/beam/model/fnexecution/v1/standard_coders.yaml#L401-L410&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/9303f651f951fe130db43a239d60016c18f9cc49/model/fn-execution/src/main/resources/org/apache/beam/model/fnexecution/v1/standard_coders.yaml#L401-L410&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17211204" author="beamjirabot" created="Fri, 9 Oct 2020 17:09:51 +0000"  >&lt;p&gt;This issue is P2 but has been unassigned without any comment for 60 days so it has been labeled &quot;stale-P2&quot;. If this issue is still affecting you, we care! Please comment and remove the label. Otherwise, in 14 days the issue will be moved to P3.&lt;/p&gt;

&lt;p&gt;Please see &lt;a href=&quot;https://beam.apache.org/contribute/jira-priorities/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://beam.apache.org/contribute/jira-priorities/&lt;/a&gt; for a detailed explanation of what these priorities mean.&lt;/p&gt;</comment>
                            <comment id="17220155" author="beamjirabot" created="Sat, 24 Oct 2020 17:09:54 +0000"  >&lt;p&gt;This issue was marked &quot;stale-P2&quot; and has not received a public comment in 14 days. It is now automatically moved to P3. If you are still affected by it, you can comment and move it back to P2.&lt;/p&gt;</comment>
                            <comment id="17271358" author="prurph" created="Mon, 25 Jan 2021 15:08:31 +0000"  >&lt;p&gt;We&apos;re currently running into this issue. Is it still something that will be addressed?&lt;/p&gt;</comment>
                            <comment id="17271555" author="chamikara" created="Mon, 25 Jan 2021 17:21:40 +0000"  >&lt;p&gt;This hasn&apos;t been fixed yet so currently you have to avoid publishing &apos;null&apos; values to Kafka to not run into this.&lt;/p&gt;

&lt;p&gt;Hope to address this in an upcoming release but I don&apos;t have an ETA yet.&lt;/p&gt;</comment>
                            <comment id="17326737" author="beamjirabot" created="Wed, 21 Apr 2021 17:19:14 +0000"  >&lt;p&gt;This issue is assigned but has not received an update in 30 days so it has been labeled &quot;stale-assigned&quot;. If you are still working on the issue, please give an update and remove the label. If you are no longer working on the issue, please unassign so someone else may work on it. In 7 days the issue will be automatically unassigned.&lt;/p&gt;</comment>
                            <comment id="17378712" author="beamjirabot" created="Sun, 11 Jul 2021 17:20:23 +0000"  >&lt;p&gt;This issue is assigned but has not received an update in 30 days so it has been labeled &quot;stale-assigned&quot;. If you are still working on the issue, please give an update and remove the label. If you are no longer working on the issue, please unassign so someone else may work on it. In 7 days the issue will be automatically unassigned.&lt;/p&gt;</comment>
                            <comment id="17383467" author="beamjirabot" created="Mon, 19 Jul 2021 17:20:24 +0000"  >&lt;p&gt;This issue was marked &quot;stale-assigned&quot; and has not received a public comment in 7 days. It is now automatically unassigned. If you are still working on it, you can assign it to yourself again. Please also give an update about the status of the work.&lt;/p&gt;</comment>
                            <comment id="17472233" author="JIRAUSER283033" created="Mon, 10 Jan 2022 18:54:32 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;Is there a chance this issue will be addressed?&lt;/p&gt;</comment>
                            <comment id="17472242" author="chamikara" created="Mon, 10 Jan 2022 19:14:20 +0000"  >&lt;p&gt;Yeah, but we haven&apos;t had time to get to this yet. If you ran into this please upvote.&lt;/p&gt;</comment>
                            <comment id="17486186" author="alexisdeman" created="Thu, 3 Feb 2022 02:15:46 +0000"  >&lt;p&gt;We&apos;re facing the same issue.&lt;/p&gt;

&lt;p&gt;We have no control on how the data is produced and must be able to read messages without a key.&lt;/p&gt;

&lt;p&gt;This is preventing us from using Beam.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17486626" author="JIRAUSER284652" created="Thu, 3 Feb 2022 17:39:11 +0000"  >&lt;p&gt;We need this!&lt;/p&gt;</comment>
                            <comment id="17490435" author="bhulette" created="Thu, 10 Feb 2022 18:52:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=johnjcasey&quot; class=&quot;user-hover&quot; rel=&quot;johnjcasey&quot;&gt;johnjcasey&lt;/a&gt; reached out offline for some pointers on defining a standard coder.&lt;/p&gt;

&lt;p&gt;1. Assign a URN for the coder and document it in the model, &lt;a href=&quot;https://github.com/apache/beam/blob/0e057fd71f96a12d74307799adabf63da9003d11/model/pipeline/src/main/proto/beam_runner_api.proto#L790&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;beam_runner_api.proto&lt;/a&gt;&lt;br/&gt;
2. Each SDK (Java, Python, Go) has an approach for registering Coder implementations for URNs (you can find these by searching for a coder URN in the codebase, e.g. in Java it&apos;s &lt;a href=&quot;https://github.com/apache/beam/blob/master/runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/ModelCoderRegistrar.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ModelCoderRegistrar&lt;/a&gt;). You&apos;ll need to find all of these places and register the SDK&apos;s NullCoder implementation for the new URN.&lt;br/&gt;
3. Add test cases to &lt;a href=&quot;https://github.com/apache/beam/blob/master/model/fn-execution/src/main/resources/org/apache/beam/model/fnexecution/v1/standard_coders.yaml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;standard_coders.yaml&lt;/a&gt;, these will be picked up by &lt;a href=&quot;https://github.com/apache/beam/blob/master/runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/wire/CommonCoderTest.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CommonCoderTest.java&lt;/a&gt;, &lt;a href=&quot;https://github.com/apache/beam/blob/master/sdks/python/apache_beam/coders/standard_coders_test.py&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;standard_coders_test.py&lt;/a&gt;, &lt;a href=&quot;https://github.com/apache/beam/blob/master/sdks/go/test/regression/coders/fromyaml/fromyaml.go&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;fromyaml.go&lt;/a&gt;, to verify the coders in their respective SDKs .&lt;/p&gt;</comment>
                            <comment id="17502130" author="denesb" created="Mon, 7 Mar 2022 08:32:48 +0000"  >&lt;p&gt;Hi, we are experiencing the same issue...&lt;/p&gt;</comment>
                            <comment id="17502670" author="chamikara" created="Tue, 8 Mar 2022 02:14:54 +0000"  >&lt;p&gt;FYI, John is working on a fix for this: &lt;a href=&quot;https://github.com/apache/beam/pull/16923&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/16923&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17520559" author="JIRAUSER286786" created="Mon, 11 Apr 2022 13:00:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=johnjcasey&quot; class=&quot;user-hover&quot; rel=&quot;johnjcasey&quot;&gt;johnjcasey&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chamikara&quot; class=&quot;user-hover&quot; rel=&quot;chamikara&quot;&gt;chamikara&lt;/a&gt;, great to hear that somebody is working on this issue. I just checkout out the master branch. In my case, the value of the Kafka messages might be null. Before the addition of &lt;a href=&quot;https://github.com/apache/beam/pull/16923&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/16923&lt;/a&gt; I got the following error:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Caused by: java.lang.IllegalArgumentException: Unable to encode element &apos;ValueWithRecordId{id=[], value=org.apache.beam.sdk.io.kafka.KafkaRecord@3fb09faf}&apos; with coder &apos;ValueWithRecordId$ValueWithRecordIdCoder(KafkaRecordCoder(ByteArrayCoder,ByteArrayCoder))&apos;. at org.apache.beam.sdk.coders.Coder.getEncodedElementByteSize(Coder.java:300) at org.apache.beam.sdk.coders.Coder.registerByteSizeObserver(Coder.java:291) at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$SampleByteSizeDistribution.tryUpdate(PCollectionConsumerRegistry.java:374) at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:248) at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209) Caused by: org.apache.beam.sdk.coders.CoderException: cannot encode a null byte[]&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;And with the changes the error is:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;RuntimeError: org.apache.beam.sdk.util.UserCodeException: java.lang.IllegalArgumentException: Unable to encode element &apos;org.apache.beam.sdk.io.kafka.KafkaIO$ByteArrayKafkaRecord@13280334&apos; with coder &apos;SchemaCoder&amp;lt;Schema: Fields:&lt;br/&gt;
Field{name=topic, description=, type=STRING NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=partition, description=, type=INT32 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=offset, description=, type=INT64 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=timestamp, description=, type=INT64 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=key, description=, type=BYTES NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=value, description=, type=BYTES NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=headers, description=, type=ARRAY&amp;lt;ROW&amp;lt;key STRING NOT NULL, value BYTES NOT NULL&amp;gt; NOT NULL&amp;gt; NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=timestampTypeId, description=, type=INT32 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=timestampTypeName, description=, type=STRING NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Encoding positions:&lt;br/&gt;
Unknown macro: {headers=6, timestampTypeName=8, partition=1, offset=2, topic=0, value=5, key=4, timestamp=3, timestampTypeId=7}&lt;br/&gt;
Options:{{}}UUID:&#160; &#160;UUID: delegateCoder: org.apache.beam.sdk.coders.Coder$ByteBuddy$FzUeGbXJ@c1ea509&apos;.&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.util.UserCodeException.wrap(UserCodeException.java:39)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1763)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.io.kafka.KafkaIO$RowsWithMetadata$1.processElement(KafkaIO.java:1768)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.io.kafka.KafkaIO$RowsWithMetadata$1$DoFnInvoker.invokeProcessElement(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.output(DoFnOutputReceivers.java:78)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.MapElements$1.processElement(MapElements.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.MapElements$1$DoFnInvoker.invokeProcessElement(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$WindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2194)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.outputWithTimestamp(DoFnOutputReceivers.java:87)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.io.kafka.ReadFromKafkaDoFn.processElement(ReadFromKafkaDoFn.java:393)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.io.kafka.ReadFromKafkaDoFn$DoFnInvoker.invokeProcessElement(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForWindowObservingSizedElementAndRestriction(FnApiDoFnRunner.java:1063)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.access$1500(FnApiDoFnRunner.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$4.accept(FnApiDoFnRunner.java:661)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$4.accept(FnApiDoFnRunner.java:656)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.BeamFnDataReadRunner.forwardElementToConsumer(BeamFnDataReadRunner.java:179)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.fn.data.BeamFnDataInboundObserver2.multiplexElements(BeamFnDataInboundObserver2.java:158)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.fn.data.BeamFnDataInboundObserver2.awaitCompletion(BeamFnDataInboundObserver2.java:123)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.control.ProcessBundleHandler.processBundle(ProcessBundleHandler.java:528)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.control.BeamFnControlClient.delegateOnInstructionRequestType(BeamFnControlClient.java:151)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.control.BeamFnControlClient$InboundObserver.lambda$onNext$0(BeamFnControlClient.java:116)&lt;br/&gt;
&#160; &#160; &#160; &#160; at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)&lt;br/&gt;
&#160; &#160; &#160; &#160; at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)&lt;br/&gt;
&#160; &#160; &#160; &#160; at java.base/java.lang.Thread.run(Thread.java:829)&lt;br/&gt;
Caused by: java.lang.IllegalArgumentException: Unable to encode element &apos;org.apache.beam.sdk.io.kafka.KafkaIO$ByteArrayKafkaRecord@13280334&apos; with coder &apos;SchemaCoder&amp;lt;Schema: Fields:&lt;/p&gt;

&lt;p&gt;Field{name=topic, description=, type=STRING NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=partition, description=, type=INT32 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=offset, description=, type=INT64 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=timestamp, description=, type=INT64 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=key, description=, type=BYTES NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=value, description=, type=BYTES NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=headers, description=, type=ARRAY&amp;lt;ROW&amp;lt;key STRING NOT NULL, value BYTES NOT NULL&amp;gt; NOT NULL&amp;gt; NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=timestampTypeId, description=, type=INT32 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=timestampTypeName, description=, type=STRING NOT NULL, options={{}}&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I use the Python SDK and the ReadFromKafka method with the argument `with_metadata=True`.&lt;/p&gt;</comment>
                            <comment id="17520624" author="johnjcasey" created="Mon, 11 Apr 2022 14:49:30 +0000"  >&lt;p&gt;Hi Matthias, that looks odd. Do you have the root exception that caused the illegal argument exception to be thrown?&lt;/p&gt;</comment>
                            <comment id="17520969" author="JIRAUSER286786" created="Tue, 12 Apr 2022 07:53:10 +0000"  >&lt;p&gt;Here is the full Error. Currently I&apos;m running it on DirectRunner, as I had no time yet to dockerize the source and deploy to DataFlow.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;message: &quot;Exception while trying to handle InstructionRequest bundle_3&quot;&lt;br/&gt;
trace: &quot;org.apache.beam.sdk.util.UserCodeException: java.lang.IllegalArgumentException: Unable to encode element \&apos;org.apache.beam.sdk.io.kafka.KafkaIO$ByteArrayKafkaRecord@9318466\&apos; with coder \&apos;SchemaCoder&amp;lt;Schema: Fields:\nField{name=topic, description=, type=STRING NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;\nField{name=partition, description=, type=INT32 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;\nField{name=offset, description=, type=INT64 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;\nField{name=timestamp, description=, type=INT64 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;\nField{name=key, description=, type=BYTES NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;\nField{name=value, description=, type=BYTES NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;\nField{name=headers, description=, type=ARRAY&amp;lt;ROW&amp;lt;key STRING NOT NULL, value BYTES NOT NULL&amp;gt; NOT NULL&amp;gt; NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;\nField{name=timestampTypeId, description=, type=INT32 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;\nField{name=timestampTypeName, description=, type=STRING NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;\nEncoding positions:\n{headers=6, timestampTypeName=8, partition=1, offset=2, topic=0, value=5, key=4, timestamp=3, timestampTypeId=7}\nOptions:&lt;tt&gt;}}UUID: 99952ae5-e379-4f4c-adfa-5052a8d4757d &#160;UUID: 99952ae5-e379-4f4c-adfa-5052a8d4757d delegateCoder: org.apache.beam.sdk.coders.Coder$ByteBuddy$J59aZwdI@33b76b03\&apos;.\n\tat org.apache.beam.sdk.util.UserCodeException.wrap(UserCodeException.java:39)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1763)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)\n\tat org.apache.beam.sdk.io.kafka.KafkaIO$RowsWithMetadata$1.processElement(KafkaIO.java:1768)\n\tat org.apache.beam.sdk.io.kafka.KafkaIO$RowsWithMetadata$1$DoFnInvoker.invokeProcessElement(Unknown Source)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)\n\tat org.apache.beam.sdk.values.ValueWithRecordId$StripIdsDoFn.processElement(ValueWithRecordId.java:139)\n\tat org.apache.beam.sdk.values.ValueWithRecordId$StripIdsDoFn$DoFnInvoker.invokeProcessElement(Unknown Source)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)\n\tat org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.outputWithTimestamp(DoFnOutputReceivers.java:87)\n\tat org.apache.beam.sdk.io.BoundedReadFromUnboundedSource$ReadFn.process(BoundedReadFromUnboundedSource.java:206)\n\tat org.apache.beam.sdk.io.BoundedReadFromUnboundedSource$ReadFn$DoFnInvoker.invokeProcessElement(Unknown Source)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)\n\tat org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.output(DoFnOutputReceivers.java:78)\n\tat org.apache.beam.sdk.transforms.MapElements$1.processElement(MapElements.java:142)\n\tat org.apache.beam.sdk.transforms.MapElements$1$DoFnInvoker.invokeProcessElement(Unknown Source)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)\n\tat org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.outputWithTimestamp(DoFnOutputReceivers.java:87)\n\tat org.apache.beam.sdk.transforms.Reify$ExtractTimestampsFromValues$1.processElement(Reify.java:206)\n\tat org.apache.beam.sdk.transforms.Reify$ExtractTimestampsFromValues$1$DoFnInvoker.invokeProcessElement(Unknown Source)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)\n\tat org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.output(DoFnOutputReceivers.java:78)\n\tat org.apache.beam.sdk.transforms.ReifyTimestamps$RemoveWildcard$1.process(ReifyTimestamps.java:70)\n\tat org.apache.beam.sdk.transforms.ReifyTimestamps$RemoveWildcard$1$DoFnInvoker.invokeProcessElement(Unknown Source)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)\n\tat org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.output(DoFnOutputReceivers.java:78)\n\tat org.apache.beam.sdk.transforms.Reshuffle$1.processElement(Reshuffle.java:103)\n\tat org.apache.beam.sdk.transforms.Reshuffle$1$DoFnInvoker.invokeProcessElement(Unknown Source)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)\n\tat org.apache.beam.fn.harness.BeamFnDataReadRunner.forwardElementToConsumer(BeamFnDataReadRunner.java:179)\n\tat org.apache.beam.sdk.fn.data.BeamFnDataInboundObserver2.multiplexElements(BeamFnDataInboundObserver2.java:158)\n\tat org.apache.beam.sdk.fn.data.BeamFnDataInboundObserver2.awaitCompletion(BeamFnDataInboundObserver2.java:123)\n\tat org.apache.beam.fn.harness.control.ProcessBundleHandler.processBundle(ProcessBundleHandler.java:528)\n\tat org.apache.beam.fn.harness.control.BeamFnControlClient.delegateOnInstructionRequestType(BeamFnControlClient.java:151)\n\tat org.apache.beam.fn.harness.control.BeamFnControlClient$InboundObserver.lambda$onNext$0(BeamFnControlClient.java:116)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\n\tat java.base/java.lang.Thread.run(Thread.java:829)\nCaused by: java.lang.IllegalArgumentException: Unable to encode element \&apos;org.apache.beam.sdk.io.kafka.KafkaIO$ByteArrayKafkaRecord@9318466\&apos; with coder \&apos;SchemaCoder&amp;lt;Schema: Fields:\nField{name=topic, description=, type=STRING NOT NULL, options={&lt;/tt&gt;\nField{name=partition, description=, type=INT32 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;\nField{name=offset, description=, type=INT64 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;\nField{name=timestamp, description=, type=INT64 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;\nField{name=key, description=, type=BYTES NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;\nField{name=value, description=, type=BYTES NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;\nField{name=headers, description=, type=ARRAY&amp;lt;ROW&amp;lt;key STRING NOT NULL, value BYTES NOT NULL&amp;gt; NOT NULL&amp;gt; NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;\nField{name=timestampTypeId, description=, type=INT32 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;\nField{name=timestampTypeName, description=, type=STRING NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;\nEncoding positions:\n{headers=6, timestampTypeName=8, partition=1, offset=2, topic=0, value=5, key=4, timestamp=3, timestampTypeId=7}\nOptions:&lt;tt&gt;}}UUID: 99952ae5-e379-4f4c-adfa-5052a8d4757d &#160;UUID: 99952ae5-e379-4f4c-adfa-5052a8d4757d delegateCoder: org.apache.beam.sdk.coders.Coder$ByteBuddy$J59aZwdI@33b76b03\&apos;.\n\tat org.apache.beam.sdk.coders.Coder.getEncodedElementByteSize(Coder.java:300)\n\tat org.apache.beam.sdk.coders.Coder.registerByteSizeObserver(Coder.java:291)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$SampleByteSizeDistribution.tryUpdate(PCollectionConsumerRegistry.java:374)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:248)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)\nCaused by: java.lang.RuntimeException: Null value set on non-nullable field Field{name=value, description=, type=BYTES NOT NULL, options={&lt;/tt&gt;\n\tat org.apache.beam.sdk.values.RowWithGetters.getValue(RowWithGetters.java:76)\n\tat org.apache.beam.sdk.coders.RowCoderGenerator$EncodeInstruction.encodeDelegate(RowCoderGenerator.java:341)\n\tat org.apache.beam.sdk.coders.Coder$ByteBuddy$J59aZwdI.encode(Unknown Source)\n\tat org.apache.beam.sdk.coders.Coder$ByteBuddy$J59aZwdI.encode(Unknown Source)\n\tat org.apache.beam.sdk.schemas.SchemaCoder.encode(SchemaCoder.java:124)\n\tat org.apache.beam.sdk.coders.Coder.getEncodedElementByteSize(Coder.java:297)\n\tat org.apache.beam.sdk.coders.Coder.registerByteSizeObserver(Coder.java:291)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$SampleByteSizeDistribution.tryUpdate(PCollectionConsumerRegistry.java:374)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:248)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)\n\tat org.apache.beam.sdk.io.kafka.KafkaIO$RowsWithMetadata$1.processElement(KafkaIO.java:1768)\n\tat org.apache.beam.sdk.io.kafka.KafkaIO$RowsWithMetadata$1$DoFnInvoker.invokeProcessElement(Unknown Source)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)\n\tat org.apache.beam.sdk.values.ValueWithRecordId$StripIdsDoFn.processElement(ValueWithRecordId.java:139)\n\tat org.apache.beam.sdk.values.ValueWithRecordId$StripIdsDoFn$DoFnInvoker.invokeProcessElement(Unknown Source)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)\n\tat org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.outputWithTimestamp(DoFnOutputReceivers.java:87)\n\tat org.apache.beam.sdk.io.BoundedReadFromUnboundedSource$ReadFn.process(BoundedReadFromUnboundedSource.java:206)\n\tat org.apache.beam.sdk.io.BoundedReadFromUnboundedSource$ReadFn$DoFnInvoker.invokeProcessElement(Unknown Source)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)\n\tat org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.output(DoFnOutputReceivers.java:78)\n\tat org.apache.beam.sdk.transforms.MapElements$1.processElement(MapElements.java:142)\n\tat org.apache.beam.sdk.transforms.MapElements$1$DoFnInvoker.invokeProcessElement(Unknown Source)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)\n\tat org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.outputWithTimestamp(DoFnOutputReceivers.java:87)\n\tat org.apache.beam.sdk.transforms.Reify$ExtractTimestampsFromValues$1.processElement(Reify.java:206)\n\tat org.apache.beam.sdk.transforms.Reify$ExtractTimestampsFromValues$1$DoFnInvoker.invokeProcessElement(Unknown Source)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)\n\tat org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.output(DoFnOutputReceivers.java:78)\n\tat org.apache.beam.sdk.transforms.ReifyTimestamps$RemoveWildcard$1.process(ReifyTimestamps.java:70)\n\tat org.apache.beam.sdk.transforms.ReifyTimestamps$RemoveWildcard$1$DoFnInvoker.invokeProcessElement(Unknown Source)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)\n\tat org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.output(DoFnOutputReceivers.java:78)\n\tat org.apache.beam.sdk.transforms.Reshuffle$1.processElement(Reshuffle.java:103)\n\tat org.apache.beam.sdk.transforms.Reshuffle$1$DoFnInvoker.invokeProcessElement(Unknown Source)\n\tat org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)\n\tat org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)\n\tat org.apache.beam.fn.harness.BeamFnDataReadRunner.forwardElementToConsumer(BeamFnDataReadRunner.java:179)\n\tat org.apache.beam.sdk.fn.data.BeamFnDataInboundObserver2.multiplexElements(BeamFnDataInboundObserver2.java:158)\n\tat org.apache.beam.sdk.fn.data.BeamFnDataInboundObserver2.awaitCompletion(BeamFnDataInboundObserver2.java:123)\n\tat org.apache.beam.fn.harness.control.ProcessBundleHandler.processBundle(ProcessBundleHandler.java:528)\n\tat org.apache.beam.fn.harness.control.BeamFnControlClient.delegateOnInstructionRequestType(BeamFnControlClient.java:151)\n\tat org.apache.beam.fn.harness.control.BeamFnControlClient$InboundObserver.lambda$onNext$0(BeamFnControlClient.java:116)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\n\tat java.base/java.lang.Thread.run(Thread.java:829)\n&quot;&lt;br/&gt;
instruction_id: &quot;bundle_3&quot;&lt;br/&gt;
log_location: &quot;org.apache.beam.fn.harness.control.BeamFnControlClient&quot;&lt;br/&gt;
thread: &quot;23&quot;&lt;/p&gt;

&lt;p&gt;E0412 09:45:46.756133600 &#160; 24697 fork_posix.cc:70] &#160; &#160; &#160; &#160; &#160; Fork support is only compatible with the epoll1 and poll polling strategies&lt;br/&gt;
E0412 09:45:47.385400200 &#160; 24450 fork_posix.cc:70] &#160; &#160; &#160; &#160; &#160; Fork support is only compatible with the epoll1 and poll polling strategies&lt;br/&gt;
dd7266e1dd24cf4a016c10a7effc1c50868af5bdb7e8af945ad815a37f410bad&lt;br/&gt;
Traceback (most recent call last):&lt;br/&gt;
&#160; File &quot;main.py&quot;, line 133, in &amp;lt;module&amp;gt;&lt;br/&gt;
&#160; &#160; run(&lt;br/&gt;
&#160; File &quot;/home/&amp;lt;path&amp;gt;beam-pipeline/kafka2gcp/pipeline.py&quot;, line 170, in run&lt;br/&gt;
&#160; &#160; (&lt;br/&gt;
&#160; File &quot;/home/&amp;lt;path&amp;gt;beam-pipeline/external/beam/sdks/python/apache_beam/pipeline.py&quot;, line 596, in _&lt;em&gt;exit&lt;/em&gt;_&lt;br/&gt;
&#160; &#160; self.result = self.run()&lt;br/&gt;
&#160; File &quot;/home/&amp;lt;path&amp;gt;beam-pipeline/external/beam/sdks/python/apache_beam/pipeline.py&quot;, line 573, in run&lt;br/&gt;
&#160; &#160; return self.runner.run_pipeline(self, self._options)&lt;br/&gt;
&#160; File &quot;/home/&amp;lt;path&amp;gt;beam-pipeline/external/beam/sdks/python/apache_beam/runners/direct/direct_runner.py&quot;, line 131, in run_pipeline&lt;br/&gt;
&#160; &#160; return runner.run_pipeline(pipeline, options)&lt;br/&gt;
&#160; File &quot;/home/&amp;lt;path&amp;gt;beam-pipeline/external/beam/sdks/python/apache_beam/runners/portability/fn_api_runner/fn_runner.py&quot;, line 199, in run_pipeline&lt;br/&gt;
&#160; &#160; self._latest_run_result = self.run_via_runner_api(&lt;br/&gt;
&#160; File &quot;/home/&amp;lt;path&amp;gt;beam-pipeline/external/beam/sdks/python/apache_beam/runners/portability/fn_api_runner/fn_runner.py&quot;, line 208, in run_via_runner_api&lt;br/&gt;
&#160; &#160; return self.run_stages(stage_context, stages)&lt;br/&gt;
&#160; File &quot;/home/&amp;lt;path&amp;gt;beam-pipeline/external/beam/sdks/python/apache_beam/runners/portability/fn_api_runner/fn_runner.py&quot;, line 408, in run_stages&lt;br/&gt;
&#160; &#160; bundle_results = self._execute_bundle(&lt;br/&gt;
&#160; File &quot;/home/&amp;lt;path&amp;gt;beam-pipeline/external/beam/sdks/python/apache_beam/runners/portability/fn_api_runner/fn_runner.py&quot;, line 736, in _execute_bundle&lt;br/&gt;
&#160; &#160; self._run_bundle(&lt;br/&gt;
&#160; File &quot;/home/&amp;lt;path&amp;gt;beam-pipeline/external/beam/sdks/python/apache_beam/runners/portability/fn_api_runner/fn_runner.py&quot;, line 966, in _run_bundle&lt;br/&gt;
&#160; &#160; result, splits = bundle_manager.process_bundle(&lt;br/&gt;
&#160; File &quot;/home/&amp;lt;path&amp;gt;beam-pipeline/external/beam/sdks/python/apache_beam/runners/portability/fn_api_runner/fn_runner.py&quot;, line 1315, in process_bundle&lt;br/&gt;
&#160; &#160; raise RuntimeError(result.error)&lt;br/&gt;
RuntimeError: org.apache.beam.sdk.util.UserCodeException: java.lang.IllegalArgumentException: Unable to encode element &apos;org.apache.beam.sdk.io.kafka.KafkaIO$ByteArrayKafkaRecord@9318466&apos; with coder &apos;SchemaCoder&amp;lt;Schema: Fields:&lt;br/&gt;
Field{name=topic, description=, type=STRING NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=partition, description=, type=INT32 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=offset, description=, type=INT64 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=timestamp, description=, type=INT64 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=key, description=, type=BYTES NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=value, description=, type=BYTES NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=headers, description=, type=ARRAY&amp;lt;ROW&amp;lt;key STRING NOT NULL, value BYTES NOT NULL&amp;gt; NOT NULL&amp;gt; NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=timestampTypeId, description=, type=INT32 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=timestampTypeName, description=, type=STRING NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Encoding positions:&lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {headers=6, timestampTypeName=8, partition=1, offset=2, topic=0, value=5, key=4, timestamp=3, timestampTypeId=7}&lt;/span&gt; 
&lt;p&gt;Options:{{}}UUID: 99952ae5-e379-4f4c-adfa-5052a8d4757d &#160;UUID: 99952ae5-e379-4f4c-adfa-5052a8d4757d delegateCoder: org.apache.beam.sdk.coders.Coder$ByteBuddy$J59aZwdI@33b76b03&apos;.&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.util.UserCodeException.wrap(UserCodeException.java:39)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1763)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.io.kafka.KafkaIO$RowsWithMetadata$1.processElement(KafkaIO.java:1768)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.io.kafka.KafkaIO$RowsWithMetadata$1$DoFnInvoker.invokeProcessElement(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.values.ValueWithRecordId$StripIdsDoFn.processElement(ValueWithRecordId.java:139)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.values.ValueWithRecordId$StripIdsDoFn$DoFnInvoker.invokeProcessElement(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.outputWithTimestamp(DoFnOutputReceivers.java:87)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.io.BoundedReadFromUnboundedSource$ReadFn.process(BoundedReadFromUnboundedSource.java:206)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.io.BoundedReadFromUnboundedSource$ReadFn$DoFnInvoker.invokeProcessElement(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.output(DoFnOutputReceivers.java:78)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.MapElements$1.processElement(MapElements.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.MapElements$1$DoFnInvoker.invokeProcessElement(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.outputWithTimestamp(DoFnOutputReceivers.java:87)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.Reify$ExtractTimestampsFromValues$1.processElement(Reify.java:206)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.Reify$ExtractTimestampsFromValues$1$DoFnInvoker.invokeProcessElement(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.output(DoFnOutputReceivers.java:78)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.ReifyTimestamps$RemoveWildcard$1.process(ReifyTimestamps.java:70)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.ReifyTimestamps$RemoveWildcard$1$DoFnInvoker.invokeProcessElement(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.output(DoFnOutputReceivers.java:78)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.Reshuffle$1.processElement(Reshuffle.java:103)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.Reshuffle$1$DoFnInvoker.invokeProcessElement(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.BeamFnDataReadRunner.forwardElementToConsumer(BeamFnDataReadRunner.java:179)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.fn.data.BeamFnDataInboundObserver2.multiplexElements(BeamFnDataInboundObserver2.java:158)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.fn.data.BeamFnDataInboundObserver2.awaitCompletion(BeamFnDataInboundObserver2.java:123)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.control.ProcessBundleHandler.processBundle(ProcessBundleHandler.java:528)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.control.BeamFnControlClient.delegateOnInstructionRequestType(BeamFnControlClient.java:151)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.control.BeamFnControlClient$InboundObserver.lambda$onNext$0(BeamFnControlClient.java:116)&lt;br/&gt;
&#160; &#160; &#160; &#160; at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)&lt;br/&gt;
&#160; &#160; &#160; &#160; at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)&lt;br/&gt;
&#160; &#160; &#160; &#160; at java.base/java.lang.Thread.run(Thread.java:829)&lt;br/&gt;
Caused by: java.lang.IllegalArgumentException: Unable to encode element &apos;org.apache.beam.sdk.io.kafka.KafkaIO$ByteArrayKafkaRecord@9318466&apos; with coder &apos;SchemaCoder&amp;lt;Schema: Fields:&lt;br/&gt;
Field{name=topic, description=, type=STRING NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=partition, description=, type=INT32 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=offset, description=, type=INT64 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=timestamp, description=, type=INT64 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=key, description=, type=BYTES NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=value, description=, type=BYTES NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=headers, description=, type=ARRAY&amp;lt;ROW&amp;lt;key STRING NOT NULL, value BYTES NOT NULL&amp;gt; NOT NULL&amp;gt; NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=timestampTypeId, description=, type=INT32 NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Field{name=timestampTypeName, description=, type=STRING NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
Encoding positions:&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;Options:{{}}UUID: 99952ae5-e379-4f4c-adfa-5052a8d4757d &#160;UUID: 99952ae5-e379-4f4c-adfa-5052a8d4757d delegateCoder: org.apache.beam.sdk.coders.Coder$ByteBuddy$J59aZwdI@33b76b03&apos;.&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.coders.Coder.getEncodedElementByteSize(Coder.java:300)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.coders.Coder.registerByteSizeObserver(Coder.java:291)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$SampleByteSizeDistribution.tryUpdate(PCollectionConsumerRegistry.java:374)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:248)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
Caused by: java.lang.RuntimeException: Null value set on non-nullable field Field{name=value, description=, type=BYTES NOT NULL, options=&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.values.RowWithGetters.getValue(RowWithGetters.java:76)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.coders.RowCoderGenerator$EncodeInstruction.encodeDelegate(RowCoderGenerator.java:341)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.coders.Coder$ByteBuddy$J59aZwdI.encode(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.coders.Coder$ByteBuddy$J59aZwdI.encode(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.schemas.SchemaCoder.encode(SchemaCoder.java:124)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.coders.Coder.getEncodedElementByteSize(Coder.java:297)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.coders.Coder.registerByteSizeObserver(Coder.java:291)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$SampleByteSizeDistribution.tryUpdate(PCollectionConsumerRegistry.java:374)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:248)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.io.kafka.KafkaIO$RowsWithMetadata$1.processElement(KafkaIO.java:1768)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.io.kafka.KafkaIO$RowsWithMetadata$1$DoFnInvoker.invokeProcessElement(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.values.ValueWithRecordId$StripIdsDoFn.processElement(ValueWithRecordId.java:139)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.values.ValueWithRecordId$StripIdsDoFn$DoFnInvoker.invokeProcessElement(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.outputWithTimestamp(DoFnOutputReceivers.java:87)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.io.BoundedReadFromUnboundedSource$ReadFn.process(BoundedReadFromUnboundedSource.java:206)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.io.BoundedReadFromUnboundedSource$ReadFn$DoFnInvoker.invokeProcessElement(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.output(DoFnOutputReceivers.java:78)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.MapElements$1.processElement(MapElements.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.MapElements$1$DoFnInvoker.invokeProcessElement(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.outputWithTimestamp(DoFnOutputReceivers.java:87)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.Reify$ExtractTimestampsFromValues$1.processElement(Reify.java:206)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.Reify$ExtractTimestampsFromValues$1$DoFnInvoker.invokeProcessElement(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.output(DoFnOutputReceivers.java:78)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.ReifyTimestamps$RemoveWildcard$1.process(ReifyTimestamps.java:70)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.ReifyTimestamps$RemoveWildcard$1$DoFnInvoker.invokeProcessElement(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.outputTo(FnApiDoFnRunner.java:1760)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.access$2800(FnApiDoFnRunner.java:142)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$NonWindowObservingProcessBundleContext.outputWithTimestamp(FnApiDoFnRunner.java:2311)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner$ProcessBundleContextBase.output(FnApiDoFnRunner.java:2481)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.DoFnOutputReceivers$WindowedContextOutputReceiver.output(DoFnOutputReceivers.java:78)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.Reshuffle$1.processElement(Reshuffle.java:103)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.transforms.Reshuffle$1$DoFnInvoker.invokeProcessElement(Unknown Source)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.FnApiDoFnRunner.processElementForParDo(FnApiDoFnRunner.java:773)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:255)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.data.PCollectionConsumerRegistry$MetricTrackingFnDataReceiver.accept(PCollectionConsumerRegistry.java:209)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.BeamFnDataReadRunner.forwardElementToConsumer(BeamFnDataReadRunner.java:179)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.fn.data.BeamFnDataInboundObserver2.multiplexElements(BeamFnDataInboundObserver2.java:158)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.sdk.fn.data.BeamFnDataInboundObserver2.awaitCompletion(BeamFnDataInboundObserver2.java:123)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.control.ProcessBundleHandler.processBundle(ProcessBundleHandler.java:528)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.control.BeamFnControlClient.delegateOnInstructionRequestType(BeamFnControlClient.java:151)&lt;br/&gt;
&#160; &#160; &#160; &#160; at org.apache.beam.fn.harness.control.BeamFnControlClient$InboundObserver.lambda$onNext$0(BeamFnControlClient.java:116)&lt;br/&gt;
&#160; &#160; &#160; &#160; at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)&lt;br/&gt;
&#160; &#160; &#160; &#160; at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)&lt;br/&gt;
&#160; &#160; &#160; &#160; at java.base/java.lang.Thread.run(Thread.java:829)&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="17521864" author="johnjcasey" created="Wed, 13 Apr 2022 18:19:56 +0000"  >&lt;p&gt;I&apos;ve opened &lt;a href=&quot;https://issues.apache.org/jira/browse/BEAM-14297&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/BEAM-14297&lt;/a&gt; to track the issue Matthias raised&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="13316746">BEAM-10484</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 30 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0gvuo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>