<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 10:55:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-3580] Do not use Go BytesCoder to encode string</title>
                <link>https://issues.apache.org/jira/browse/BEAM-3580</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;We should not use the same built-in coder for two different types. It creates the need for conversions at inopportune times in the runtime.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;One option would be to&#160;a custom coder that shares encoding with bytes, given that bytes are length prefixed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13135164">BEAM-3580</key>
            <summary>Do not use Go BytesCoder to encode string</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lostluck">Robert Burke</assignee>
                                    <reporter username="herohde">Henning Rohde</reporter>
                        <labels>
                    </labels>
                <created>Wed, 31 Jan 2018 18:34:05 +0000</created>
                <updated>Sat, 16 May 2020 13:45:00 +0000</updated>
                            <resolved>Fri, 18 Jan 2019 18:42:24 +0000</resolved>
                                                    <fixVersion>Not applicable</fixVersion>
                                    <component>sdk-go</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="7800">2h 10m</timespent>
                                <comments>
                            <comment id="16733743" author="htyleo" created="Fri, 4 Jan 2019 02:32:10 +0000"  >&lt;p&gt;Seems that&#160;this breaks beam.Combine(s, combineFn, PCollection&amp;lt;string&amp;gt;)&#160;in&#160;certain cases.&#160;&lt;/p&gt;

&lt;p&gt;When entering Combine.addInput(), the value is of type []byte.&#160;It&apos;s&#160;then converted to the specified input type, which is supposed to be &quot;string&quot;&#160;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;. But that type&#160;could be a universal type, e.g.&#160;when we define: &quot;AddInput(a accum, val beam.T) accum&quot;. In that case, the conversion is a no-op, and we&#160;call AddInput() with []byte, causing a type mismatch.&lt;/p&gt;

&lt;p&gt;Using a separate&#160;coder that encodes string -&amp;gt; []byte, and decodes []byte -&amp;gt; string should solve this problem. I will try that and see if it works.&lt;/p&gt;

&lt;p&gt;This also makes me thinking whether we should&#160;substitute universal types in CombineFn to concrete ones before/at runtime?&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&#160;&lt;a href=&quot;https://github.com/apache/beam/blob/master/sdks/go/pkg/beam/core/runtime/exec/combine.go#L219&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/master/sdks/go/pkg/beam/core/runtime/exec/combine.go#L219&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16734374" author="lostluck" created="Fri, 4 Jan 2019 17:37:26 +0000"  >&lt;p&gt;You&apos;re right though, a dedicated custom coder for strings would resolve this. In principle this would also be solvable through the User Defined Coders work.&lt;br/&gt;
An alternative work around would be to do the converters, but those are likely unnecessary altogether if there was a dedicated coder for strings which would avoid using the converts on all the paths.&lt;/p&gt;

&lt;p&gt;That can be fixed by adding conversions prior to the invocation of the combine operations which isn&apos;t currently done via the invoker in all instances (such as the binary merge fast path),&lt;/p&gt;

&lt;p&gt;See here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/beam/blob/master/sdks/go/pkg/beam/core/runtime/exec/fn.go#L132&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/master/sdks/go/pkg/beam/core/runtime/exec/fn.go#L132&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Note: I&apos;m likely going to be changing the combines soon so the code generator will be able to speed up combines for the AddInput and MergeAccumulators cases.&lt;/p&gt;</comment>
                            <comment id="16743367" author="lostluck" created="Tue, 15 Jan 2019 20:17:25 +0000"  >&lt;p&gt;I&apos;m in the process of fixing Top, and I ran into this, so I&apos;m going to take this unless &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=htyleo&quot; class=&quot;user-hover&quot; rel=&quot;htyleo&quot;&gt;htyleo&lt;/a&gt; has any objections. You&apos;ll get&#160;the review however once it&apos;s verified and tested properly&lt;/p&gt;</comment>
                            <comment id="16743374" author="htyleo" created="Tue, 15 Jan 2019 20:24:12 +0000"  >&lt;p&gt;Sounds good. Sorry that I didn&apos;t get the time to fix this after your previous review.&lt;/p&gt;</comment>
                            <comment id="16746571" author="lostluck" created="Fri, 18 Jan 2019 18:43:47 +0000"  >&lt;p&gt;There may be one or two no longer necessary []byte -&amp;gt; string conversions and vice versa that I missed, but they can be cleaned up as they&apos;re found.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 43 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ply7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>