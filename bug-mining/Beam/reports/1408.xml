<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 11:02:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-8368] [Python] libprotobuf-generated exception when importing apache_beam</title>
                <link>https://issues.apache.org/jira/browse/BEAM-8368</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;Unable to import apache_beam after upgrading to macos 10.15 (Catalina). Cleared all the pipenvs and but can&apos;t get it working again.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; apache_beam as beam
/Users&lt;span class=&quot;code-comment&quot;&gt;/***/&lt;/span&gt;.local/share/virtualenvs/beam-etl-ims6DitU/lib/python3.7/site-packages/apache_beam/__init__.py:84: UserWarning: Some syntactic constructs of Python 3 are not yet fully supported by Apache Beam.
  &lt;span class=&quot;code-quote&quot;&gt;&apos;Some syntactic constructs of Python 3 are not yet fully supported by &apos;&lt;/span&gt;
[libprotobuf ERROR google/protobuf/descriptor_database.cc:58] File already exists in database: 
[libprotobuf FATAL google/protobuf/descriptor.cc:1370] CHECK failed: GeneratedDatabase()-&amp;gt;Add(encoded_file_descriptor, size): 
libc++abi.dylib: terminating with uncaught exception of type google::protobuf::FatalException: CHECK failed: GeneratedDatabase()-&amp;gt;Add(encoded_file_descriptor, size): 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13261284">BEAM-8368</key>
            <summary>[Python] libprotobuf-generated exception when importing apache_beam</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10100" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">P0</priority>
                        <status id="10722" iconUrl="https://issues.apache.org/jira/images/icons/statuses/generic.png" description="">Triage Needed</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bhulette">Brian Hulette</assignee>
                                    <reporter username="ubaierbhat">Ubaier Bhat</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Oct 2019 10:29:52 +0000</created>
                <updated>Thu, 13 Apr 2023 10:56:12 +0000</updated>
                            <resolved>Wed, 20 Nov 2019 14:52:12 +0000</resolved>
                                    <version>2.15.0</version>
                    <version>2.17.0</version>
                                    <fixVersion>2.17.0</fixVersion>
                                    <component>sdk-py-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="16800">4h 40m</timespent>
                                <comments>
                            <comment id="16948462" author="ubaierbhat" created="Thu, 10 Oct 2019 11:25:16 +0000"  >&lt;p&gt;Attached the  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12982663/12982663_error_log.txt&quot; title=&quot;error_log.txt attached to BEAM-8368&quot;&gt;error_log.txt&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;  It looks like the problem is actually in arrow. Downgrading arrow version to 0.13.0 works. Cause might be something similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/ARROW-5247&quot; title=&quot;[Python][C++] libprotobuf-generated exception when importing pyarrow.cuda &quot; class=&quot;issue-link&quot; data-issue-key=&quot;ARROW-5247&quot;&gt;&lt;del&gt;ARROW-5247&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="16948775" author="kenn" created="Thu, 10 Oct 2019 16:57:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=altay&quot; class=&quot;user-hover&quot; rel=&quot;altay&quot;&gt;altay&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bhulette&quot; class=&quot;user-hover&quot; rel=&quot;bhulette&quot;&gt;bhulette&lt;/a&gt; &lt;/p&gt;</comment>
                            <comment id="16948813" author="bhulette" created="Thu, 10 Oct 2019 17:33:49 +0000"  >&lt;p&gt;Sorry about this issue &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ubaierbhat&quot; class=&quot;user-hover&quot; rel=&quot;ubaierbhat&quot;&gt;ubaierbhat&lt;/a&gt;. It sounds like just pinning to arrow 0.13.0 is a workaround for you now though.&lt;/p&gt;

&lt;p&gt;I know the arrow community has had a lot of trouble maintaining wheels for releasing to pypi, which we&apos;re depending on for our ParquetIO. They&apos;ve been &lt;a href=&quot;https://lists.apache.org/thread.html/128a2bec285ad45aa4189ebb39a15b39dcf6d91c4ab0278ff4f7cdea@%3Cdev.arrow.apache.org%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;looking for assistance&lt;/a&gt; with it.&lt;/p&gt;

&lt;p&gt;pyarrow 0.15.0 was just released, does that work on 10.15? If it does, maybe we could resolve this just by bumping up our lower bound, if it doesn&apos;t, we should file a jira with arrow and maybe add a &amp;lt;0.14 bound until it&apos;s resolved.&lt;/p&gt;

&lt;p&gt;FWIW it looks like arrow&apos;s nightly wheel builds are using OSX 10.9: &lt;a href=&quot;https://github.com/apache/arrow/blob/master/dev/tasks/python-wheels/travis.osx.yml#L28&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/arrow/blob/master/dev/tasks/python-wheels/travis.osx.yml#L28&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16949012" author="altay" created="Fri, 11 Oct 2019 00:02:46 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Do we need to document this as a known issue? Starting from Beam 2.14,  Beam depends on pyarrow versions &amp;lt;0.15.0. 2.14.0, 2.15.0, 2.16.0 will be impacted from this problem. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rtnguyen&quot; class=&quot;user-hover&quot; rel=&quot;rtnguyen&quot;&gt;rtnguyen&lt;/a&gt; could you add this known issue to the docs?&lt;/li&gt;
	&lt;li&gt;Both of &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bhulette&quot; class=&quot;user-hover&quot; rel=&quot;bhulette&quot;&gt;bhulette&lt;/a&gt; suggestions are reasonable to me. I do not have a device with macos 10.15 to test this. Could someone test it with pyarrow 0.15.0. After that we can decide what to do (downgrade or upgrade).&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16949013" author="altay" created="Fri, 11 Oct 2019 00:04:38 +0000"  >&lt;p&gt;/cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kamilwu&quot; class=&quot;user-hover&quot; rel=&quot;kamilwu&quot;&gt;kamilwu&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16949039" author="bhulette" created="Fri, 11 Oct 2019 01:16:34 +0000"  >&lt;p&gt;I sent a message to the arrow ML to see if anyone has used pyarrow 0.15 on 10.15 but so far no response: &lt;a href=&quot;https://lists.apache.org/thread.html/ead3bc069742437695465f9c8c1631f98dd8a5a6de056c47fc093c7d@%3Cdev.arrow.apache.org%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lists.apache.org/thread.html/ead3bc069742437695465f9c8c1631f98dd8a5a6de056c47fc093c7d@%3Cdev.arrow.apache.org%3E&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Yeah adding a known issue with the 0.13 workaround makes sense&lt;/p&gt;</comment>
                            <comment id="16949181" author="ubaierbhat" created="Fri, 11 Oct 2019 06:37:47 +0000"  >&lt;p&gt;tested with pyarrow 0.15.0,  it does not resolve this issue. &lt;/p&gt;</comment>
                            <comment id="16949231" author="kamilwu" created="Fri, 11 Oct 2019 07:48:17 +0000"  >&lt;p&gt;I confirm that upgrading to 0.15.0 does not resolve the issue.&lt;/p&gt;

&lt;p&gt;It seems that adding a &amp;lt;0.14 bound is reasonable ATM.&lt;/p&gt;</comment>
                            <comment id="16949281" author="kamilwu" created="Fri, 11 Oct 2019 08:50:04 +0000"  >&lt;p&gt;I&apos;ve opened a PR to downgrade pyarrow version: &lt;a href=&quot;https://github.com/apache/beam/pull/9768&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/9768&lt;/a&gt;. Please take a look&lt;/p&gt;</comment>
                            <comment id="16949650" author="wesmckinn" created="Fri, 11 Oct 2019 17:13:50 +0000"  >&lt;p&gt;We are statically linking libprotobuf due to taking on a grpc C++ dependency in Apache Arrow. We can probably change our linker setup to not automatically load &lt;tt&gt;libarrow_flight.so&lt;/tt&gt; which is the library that contains the symbols. &lt;/p&gt;</comment>
                            <comment id="16949744" author="bhulette" created="Fri, 11 Oct 2019 19:22:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=robertwb&quot; class=&quot;user-hover&quot; rel=&quot;robertwb&quot;&gt;robertwb&lt;/a&gt; are we also statically linking libprotobuf in beam?&lt;/p&gt;</comment>
                            <comment id="16949751" author="robertwb" created="Fri, 11 Oct 2019 19:29:49 +0000"  >&lt;p&gt;We don&apos;t link anything statically in Beam (all C compilation is optional and only has Python itself as a dependency). We are, however, taking on a dependency on the Python bindings of both protobuf and grpc, which possibly could be the source of this.&lt;/p&gt;</comment>
                            <comment id="16949810" author="wesmckinn" created="Fri, 11 Oct 2019 21:47:43 +0000"  >&lt;p&gt;It seems very likely that the grpc wheel statically links Protobuf. I just posted a patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/ARROW-6860&quot; title=&quot;[Python] Only link libarrow_flight.so to pyarrow._flight&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ARROW-6860&quot;&gt;&lt;del&gt;ARROW-6860&lt;/del&gt;&lt;/a&gt; to move the protobuf symbols out of the &lt;tt&gt;import pyarrow.parquet&lt;/tt&gt; import path. If you &lt;tt&gt;import pyarrow.flight&lt;/tt&gt; (which includes gRPC statically linked), you will still have problems. &lt;/p&gt;

&lt;p&gt;We&apos;re going to try to make a 0.15.1 release once we fix some other bugs that have surfaced since 0.15.0 was released&lt;/p&gt;</comment>
                            <comment id="16950836" author="kamilwu" created="Mon, 14 Oct 2019 09:08:49 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=wesm&quot; class=&quot;user-hover&quot; rel=&quot;wesm&quot;&gt;wesm&lt;/a&gt;. We don&apos;t import `pyarrow.flight`, so we should be safe with 0.15.1 release&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16951366" author="wesmckinn" created="Mon, 14 Oct 2019 21:11:41 +0000"  >&lt;p&gt;Thanks. &lt;/p&gt;

&lt;p&gt;More generally, it would be helpful to know if you have guidance about best practices for Python wheels that need to depend on the C++ protocol buffers. Does bundling &lt;tt&gt;libprotobuf.so&lt;/tt&gt; help (something we could do, though it does create risk if there are ABI changes in libprotobuf and two wheels are built against different ABIs)? We could also work together to make a &quot;cpp_protobuf&quot; wheel that bundles a common shared library that different wheels can import to make sure that everyone&apos;s pinning to the same protobuf version&lt;/p&gt;

&lt;p&gt;Really, wheels are a bad platform for shipping complex C++ projects, as has been discussed in many other places. &lt;/p&gt;</comment>
                            <comment id="16956590" author="altay" created="Tue, 22 Oct 2019 01:45:50 +0000"  >&lt;p&gt;Is there an issue/thread for tracking the progress of arrow 0.15.1 release ?&lt;/p&gt;</comment>
                            <comment id="16956593" author="wesmckinn" created="Tue, 22 Oct 2019 01:48:01 +0000"  >&lt;p&gt;It&apos;s on dev@arrow.apache.org. With luck we will cut an RC in the next 24 hours&lt;/p&gt;</comment>
                            <comment id="16956599" author="altay" created="Tue, 22 Oct 2019 01:54:16 +0000"  >&lt;p&gt;Thank you for the quick reply. Let us know if we can help.&lt;/p&gt;</comment>
                            <comment id="16958159" author="bhulette" created="Wed, 23 Oct 2019 18:47:21 +0000"  >&lt;p&gt;Beam 2.17 cut date is today, should we keep this as a blocker and potentially cherry-pick in the next couple of days if there&apos;s an arrow release to use? Or just punt until 2.18?&lt;/p&gt;</comment>
                            <comment id="16958282" author="altay" created="Wed, 23 Oct 2019 21:59:12 +0000"  >&lt;p&gt;Let&apos;s move to 2.18 and keep watching the pyarrow update. (For reference arrow thread is&#160;&lt;a href=&quot;https://lists.apache.org/thread.html/462464941d79e67bfef7d73fc900ea5fe0200e8a926253c6eb0285aa@%3Cdev.arrow.apache.org%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lists.apache.org/thread.html/462464941d79e67bfef7d73fc900ea5fe0200e8a926253c6eb0285aa@%3Cdev.arrow.apache.org%3E&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;If there will be Beam 2.17 RC2 maybe we can reconsider at that time.&lt;/p&gt;</comment>
                            <comment id="16965043" author="altay" created="Fri, 1 Nov 2019 19:26:48 +0000"  >&lt;p&gt;0.15.1 was released a few hours ago (&lt;a href=&quot;https://pypi.org/project/pyarrow/0.15.1/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://pypi.org/project/pyarrow/0.15.1/&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Could we get this into the 2.17.0 branch?&lt;/p&gt;</comment>
                            <comment id="16965102" author="bhulette" created="Fri, 1 Nov 2019 21:23:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ubaierbhat&quot; class=&quot;user-hover&quot; rel=&quot;ubaierbhat&quot;&gt;ubaierbhat&lt;/a&gt; or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kamilwu&quot; class=&quot;user-hover&quot; rel=&quot;kamilwu&quot;&gt;kamilwu&lt;/a&gt; any chance you could verify that pyarrow 0.15.1 works with beam on MacOS 10.15?&lt;/p&gt;</comment>
                            <comment id="16965445" author="ubaierbhat" created="Sat, 2 Nov 2019 18:07:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bhulette&quot; class=&quot;user-hover&quot; rel=&quot;bhulette&quot;&gt;bhulette&lt;/a&gt; tested with &lt;em&gt;pyarrow &lt;tt&gt;0.15.1&lt;/tt&gt;&lt;/em&gt; beam works on &lt;em&gt;&lt;tt&gt;MacOS 10.15&lt;/tt&gt;&lt;/em&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16968671" author="bhulette" created="Wed, 6 Nov 2019 20:21:34 +0000"  >&lt;p&gt;Awesome, thank you!&lt;/p&gt;</comment>
                            <comment id="16978069" author="kenn" created="Wed, 20 Nov 2019 05:10:39 +0000"  >&lt;p&gt;I see a linked PR merged into 2.17.0 branch. Is this done now?&lt;/p&gt;</comment>
                            <comment id="16978485" author="bhulette" created="Wed, 20 Nov 2019 14:53:17 +0000"  >&lt;p&gt;Yep, I went ahead and resolved it.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13262117">BEAM-8392</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13261841">ARROW-6860</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12982663" name="error_log.txt" size="81115" author="ubaierbhat" created="Thu, 10 Oct 2019 11:22:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 51 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z07f54:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>