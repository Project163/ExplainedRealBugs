<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 10:44:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-2114] KafkaIO broken with CoderException</title>
                <link>https://issues.apache.org/jira/browse/BEAM-2114</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;For a KafkaIO.Read&amp;lt;String, String&amp;gt; I simply replaced &lt;tt&gt;withKeyCoder&lt;/tt&gt; and &lt;tt&gt;withValueCoder&lt;/tt&gt; with &lt;tt&gt;withKeyDeserializer&lt;/tt&gt; and &lt;tt&gt;withValueDeserializer&lt;/tt&gt; using `StringDeserializer.class` on dataflow and I receive the following traceback:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.codehaus.mojo.exec.ExecJavaMojo$1.run(ExecJavaMojo.java:293)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: org.apache.beam.sdk.coders.CoderException: cannot encode a &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;
	at org.apache.beam.runners.direct.ImmutabilityCheckingBundleFactory$ImmutabilityEnforcingBundle.add(ImmutabilityCheckingBundleFactory.java:115)
	at org.apache.beam.runners.direct.UnboundedReadEvaluatorFactory$UnboundedReadEvaluator.processElement(UnboundedReadEvaluatorFactory.java:136)
	at org.apache.beam.runners.direct.TransformExecutor.processElements(TransformExecutor.java:139)
	at org.apache.beam.runners.direct.TransformExecutor.run(TransformExecutor.java:107)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	... 1 more
Caused by: org.apache.beam.sdk.coders.CoderException: cannot encode a &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;
	at org.apache.beam.sdk.coders.StringUtf8Coder.encode(StringUtf8Coder.java:75)
	at org.apache.beam.sdk.coders.StringUtf8Coder.encode(StringUtf8Coder.java:41)
	at org.apache.beam.sdk.coders.KvCoder.encode(KvCoder.java:88)
	at org.apache.beam.sdk.io.kafka.KafkaRecordCoder.encode(KafkaRecordCoder.java:60)
	at org.apache.beam.sdk.io.kafka.KafkaRecordCoder.encode(KafkaRecordCoder.java:36)
	at org.apache.beam.sdk.util.CoderUtils.encodeToSafeStream(CoderUtils.java:122)
	at org.apache.beam.sdk.util.CoderUtils.encodeToByteArray(CoderUtils.java:106)
	at org.apache.beam.sdk.util.CoderUtils.encodeToByteArray(CoderUtils.java:91)
	at org.apache.beam.sdk.util.MutationDetectors$CodedValueMutationDetector.&amp;lt;init&amp;gt;(MutationDetectors.java:106)
	at org.apache.beam.sdk.util.MutationDetectors.forValueWithCoder(MutationDetectors.java:44)
	at org.apache.beam.runners.direct.ImmutabilityCheckingBundleFactory$ImmutabilityEnforcingBundle.add(ImmutabilityCheckingBundleFactory.java:113)
	... 8 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;attempting to use &lt;tt&gt;readWithCoders(StringUtf8Coder.of(), StringUtf8Coder.of())&lt;/tt&gt; instead yields:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.codehaus.mojo.exec.ExecJavaMojo$1.run(ExecJavaMojo.java:293)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: org.apache.beam.sdk.transforms.display.DisplayData$InternalBuilder$PopulateDisplayDataException: Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; populating display data &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; component: org.apache.beam.sdk.io.kafka.KafkaIO$TypedWithoutMetadata
	at org.apache.beam.sdk.transforms.display.DisplayData$InternalBuilder.include(DisplayData.java:801)
	at org.apache.beam.sdk.transforms.display.DisplayData$InternalBuilder.access$100(DisplayData.java:733)
	at org.apache.beam.sdk.transforms.display.DisplayData.from(DisplayData.java:81)
	at org.apache.beam.runners.direct.DisplayDataValidator.evaluateDisplayData(DisplayDataValidator.java:47)
	at org.apache.beam.runners.direct.DisplayDataValidator.access$100(DisplayDataValidator.java:29)
	at org.apache.beam.runners.direct.DisplayDataValidator$Visitor.enterCompositeTransform(DisplayDataValidator.java:56)
	at org.apache.beam.sdk.runners.TransformHierarchy$Node.visit(TransformHierarchy.java:479)
	at org.apache.beam.sdk.runners.TransformHierarchy$Node.visit(TransformHierarchy.java:483)
	at org.apache.beam.sdk.runners.TransformHierarchy$Node.access$400(TransformHierarchy.java:232)
	at org.apache.beam.sdk.runners.TransformHierarchy.visit(TransformHierarchy.java:207)
	at org.apache.beam.sdk.Pipeline.traverseTopologically(Pipeline.java:384)
	at org.apache.beam.runners.direct.DisplayDataValidator.validateTransforms(DisplayDataValidator.java:43)
	at org.apache.beam.runners.direct.DisplayDataValidator.validatePipeline(DisplayDataValidator.java:35)
	at org.apache.beam.runners.direct.DirectRunner.run(DirectRunner.java:265)
	at org.apache.beam.runners.direct.DirectRunner.run(DirectRunner.java:63)
	at org.apache.beam.sdk.Pipeline.run(Pipeline.java:277)
	at com.shopify.attribution.pipelines.StoreSessions.main(StoreSessions.java:75)
	... 6 more
Caused by: java.lang.RuntimeException: Unknown value type: StringUtf8Coder
	at org.apache.beam.sdk.transforms.display.DisplayData.item(DisplayData.java:886)
	at org.apache.beam.sdk.io.kafka.KafkaIO$Read.populateDisplayData(KafkaIO.java:750)
	at org.apache.beam.sdk.io.kafka.KafkaIO$TypedWithoutMetadata.populateDisplayData(KafkaIO.java:785)
	at org.apache.beam.sdk.transforms.display.DisplayData$InternalBuilder.include(DisplayData.java:794)
	... 22 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13067700">BEAM-2114</key>
            <summary>KafkaIO broken with CoderException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="meunierd">Devon Meunier</assignee>
                                    <reporter username="meunierd">Devon Meunier</reporter>
                        <labels>
                    </labels>
                <created>Fri, 28 Apr 2017 14:12:13 +0000</created>
                <updated>Fri, 24 Jul 2020 20:18:56 +0000</updated>
                            <resolved>Sun, 30 Apr 2017 18:12:10 +0000</resolved>
                                                    <fixVersion>2.0.0</fixVersion>
                                    <component>io-java-kafka</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15988914" author="dhalperi@google.com" created="Fri, 28 Apr 2017 14:34:41 +0000"  >
&lt;p&gt;When using `withXDeserializer`, to parse data from the Kafka source, we still need a Coder for the `X` (Key or Value) once the data is in the pipeline. How this works today is here: &lt;a href=&quot;https://github.com/apache/beam/blob/master/sdks/java/io/kafka/src/main/java/org/apache/beam/sdk/io/kafka/KafkaIO.java#L620&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/master/sdks/java/io/kafka/src/main/java/org/apache/beam/sdk/io/kafka/KafkaIO.java#L620&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;we get the type from the KeyDeserializer and look for a coder that works with it.&lt;/li&gt;
	&lt;li&gt;if the type isn&#8217;t found, we use the coders you specify.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;It looks like there are two issues:&lt;/p&gt;

&lt;p&gt;1. Documentation and messaging: the error messages could be greatly improved.&lt;/p&gt;

&lt;p&gt;        a. review the class-level javadoc&lt;br/&gt;
        b. fix the error messaging. The error if the coder isn&apos;t specified should say something like &quot;Unable to automatically infer a Coder for the Kafka Deserializer %s: no coder registered for type %s&quot; .&lt;/p&gt;


&lt;p&gt;2. During coder inference, wrap `NullableCoder` by default around the inferred coder. I think this is mandatory, unless Kafka Deserializers have specific ways to tell values cannot be null.&lt;/p&gt;</comment>
                            <comment id="15989264" author="jkff" created="Fri, 28 Apr 2017 18:17:02 +0000"  >&lt;p&gt;There&apos;s still another issue here: the display data exception. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=peay&quot; class=&quot;user-hover&quot; rel=&quot;peay&quot;&gt;peay&lt;/a&gt; Can you take a look?&lt;/p&gt;</comment>
                            <comment id="15989275" author="githubbot" created="Fri, 28 Apr 2017 18:31:48 +0000"  >&lt;p&gt;GitHub user meunierd opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/beam/pull/2767&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/2767&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/BEAM-2114&quot; title=&quot;KafkaIO broken with CoderException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BEAM-2114&quot;&gt;&lt;del&gt;BEAM-2114&lt;/del&gt;&lt;/a&gt; Wrap inferred KafkaIO Coders with NullableCoder&lt;/p&gt;

&lt;p&gt;    Be sure to do all of the following to help us incorporate your contribution&lt;br/&gt;
    quickly and easily:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;x&amp;#93;&lt;/span&gt; Make sure the PR title is formatted like:&lt;br/&gt;
       `&lt;a href=&quot;#&amp;gt;&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;BEAM-&amp;lt;Jira issue #&amp;gt;&lt;/a&gt; Description of pull request`&lt;/li&gt;
	&lt;li&gt;[ ] Make sure tests pass via `mvn clean verify`. (Even better, enable&lt;br/&gt;
           Travis-CI on your fork and ensure the whole test matrix passes).&lt;/li&gt;
	&lt;li&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;x&amp;#93;&lt;/span&gt; Replace `&amp;lt;Jira issue #&amp;gt;` in the title with the actual Jira issue&lt;br/&gt;
           number, if there is one.&lt;/li&gt;
	&lt;li&gt;[ ] If this contribution is large, please file an Apache&lt;br/&gt;
           &lt;span class=&quot;error&quot;&gt;&amp;#91;Individual Contributor License Agreement&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://www.apache.org/licenses/icla.pdf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.apache.org/licenses/icla.pdf&lt;/a&gt;).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    &amp;#8212;&lt;/p&gt;


&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/meunierd/beam&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/meunierd/beam&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/BEAM-2114&quot; title=&quot;KafkaIO broken with CoderException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BEAM-2114&quot;&gt;&lt;del&gt;BEAM-2114&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/beam/pull/2767.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/2767.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2767&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 4dc4dc2d7832adbad6dceeaea44143b713fa7e8b&lt;br/&gt;
Author: Devon Meunier &amp;lt;devon.meunier@shopify.com&amp;gt;&lt;br/&gt;
Date:   2017-04-28T18:30:53Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/BEAM-2114&quot; title=&quot;KafkaIO broken with CoderException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BEAM-2114&quot;&gt;&lt;del&gt;BEAM-2114&lt;/del&gt;&lt;/a&gt; Wrap inferred KafkaIO Coders with NullableCoder&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15989467" author="githubbot" created="Fri, 28 Apr 2017 21:14:32 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/beam/pull/2767&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/2767&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15990289" author="githubbot" created="Sun, 30 Apr 2017 16:59:49 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/beam/pull/2780&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/2780&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 29 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3e8pz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>