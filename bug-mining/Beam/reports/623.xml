<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 10:50:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-3261] Apex runner does not detect pipeline failure</title>
                <link>https://issues.apache.org/jira/browse/BEAM-3261</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;I was looking at &lt;a href=&quot;https://github.com/apache/beam/pull/4074/files&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/4074/files&lt;/a&gt; and asked myself &quot;Don&apos;t we already have a ValidatesRunner test for this?&quot;&lt;/p&gt;

&lt;p&gt;Turns out we do: &lt;a href=&quot;https://github.com/apache/beam/blob/3b79b6298e84711528b5ad1302200cb8acbac07e/sdks/java/core/src/test/java/org/apache/beam/sdk/transforms/ViewTest.java#L793&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/3b79b6298e84711528b5ad1302200cb8acbac07e/sdks/java/core/src/test/java/org/apache/beam/sdk/transforms/ViewTest.java#L793&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I ran this test with TestApexRunner, and I observed the same exception as in &lt;a href=&quot;https://stackoverflow.com/questions/46982827/error-when-using-side-input-withsideinputs-method-not-accepting-kv-type-as-inp?noredirect=1#comment81040223_46982827&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/questions/46982827/error-when-using-side-input-withsideinputs-method-not-accepting-kv-type-as-inp?noredirect=1#comment81040223_46982827&lt;/a&gt; , however the test passed.&lt;/p&gt;

&lt;p&gt;It seems that it is passing because ApexRunnerResult.waitUntilFinish() detects only PAssert assertion errors, but not any other errors: &lt;a href=&quot;https://github.com/apache/beam/blob/3b79b6298e84711528b5ad1302200cb8acbac07e/runners/apex/src/main/java/org/apache/beam/runners/apex/ApexRunnerResult.java#L62&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/3b79b6298e84711528b5ad1302200cb8acbac07e/runners/apex/src/main/java/org/apache/beam/runners/apex/ApexRunnerResult.java#L62&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This seems very problematic, as it means that 1) the status of Apex ValidatesRunner tests cannot be trusted: if they fail in any other way other than a PAssert error, the failure will be undetected, and 2) in general, a user can not trust a successful pipeline.run() from Apex runner.&lt;/p&gt;

&lt;p&gt;For tests in particular, some other TestXRunner&apos;s guard against such a failure mode by verifying not only that there were no assertion failures, but also that all assertions succeeded - using metrics: e.g. &lt;a href=&quot;https://github.com/apache/beam/blob/3b79b6298e84711528b5ad1302200cb8acbac07e/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/TestDataflowRunner.java#L248&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/3b79b6298e84711528b5ad1302200cb8acbac07e/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/TestDataflowRunner.java#L248&lt;/a&gt; . Fixing this would be optimal, but meanwhile, the runner should at least fail the pipeline in case of error.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13121109">BEAM-3261</key>
            <summary>Apex runner does not detect pipeline failure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10101" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">P1</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jkff">Eugene Kirpichov</reporter>
                        <labels>
                    </labels>
                <created>Mon, 27 Nov 2017 22:33:42 +0000</created>
                <updated>Thu, 13 Jan 2022 21:52:13 +0000</updated>
                            <resolved>Sat, 15 May 2021 17:57:53 +0000</resolved>
                                                    <fixVersion>Missing</fixVersion>
                                    <component>runner-apex</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3600">1h</timespent>
                                <comments>
                            <comment id="16267763" author="thw" created="Mon, 27 Nov 2017 23:11:12 +0000"  >&lt;p&gt;Yes, the test runner does not check that all assertions have succeeded. Also, if any other error occurs, the pipeline does not &quot;succeed&quot;, it will be stuck in retry. The test runner caps the maximum execution time, and that may lead to false positive.&lt;/p&gt;</comment>
                            <comment id="16267771" author="thw" created="Mon, 27 Nov 2017 23:16:14 +0000"  >&lt;p&gt;Linked &lt;a href=&quot;https://issues.apache.org/jira/browse/BEAM-2004&quot; title=&quot;Verify PAssert execution in TestApexRunner&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BEAM-2004&quot;&gt;&lt;del&gt;BEAM-2004&lt;/del&gt;&lt;/a&gt; actually wasn&apos;t addressed.&lt;/p&gt;</comment>
                            <comment id="16269586" author="tgroh" created="Tue, 28 Nov 2017 22:23:16 +0000"  >&lt;p&gt;I&apos;m seeing &apos;assertion should have failed&apos; failures sometimes on precommits:&lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/job/beam_PreCommit_Java_MavenInstall/org.apache.beam$beam-runners-apex/15902/testReport/junit/org.apache.beam.runners.apex.translation/ParDoTranslatorTest/testAssertionFailure/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/beam_PreCommit_Java_MavenInstall/org.apache.beam$beam-runners-apex/15902/testReport/junit/org.apache.beam.runners.apex.translation/ParDoTranslatorTest/testAssertionFailure/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Are these related?&lt;/p&gt;</comment>
                            <comment id="16269755" author="jkff" created="Tue, 28 Nov 2017 23:56:05 +0000"  >&lt;p&gt;It looks like a separate issue to me. I filed &lt;a href=&quot;https://issues.apache.org/jira/browse/BEAM-3269&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/BEAM-3269&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="16762477" author="echauchot" created="Thu, 7 Feb 2019 08:30:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kenn&quot; class=&quot;user-hover&quot; rel=&quot;kenn&quot;&gt;kenn&lt;/a&gt;, regarding release 2.10, this ticket is old but tagged as a blocker,&#160;should we target it for later on ?&lt;/p&gt;</comment>
                            <comment id="16762742" author="kenn" created="Thu, 7 Feb 2019 15:04:46 +0000"  >&lt;p&gt;Yes. I think that the Jira priorities are a little bit confusing. I just use Fix Version = 2.10.0 for release blocking. To be Blocker == P0 == stop whatever you are doing and fix it because it is messing with (multiple) other people &lt;em&gt;right now&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;I think I will just change the priority, because if it is untouched since 2017 it can&apos;t really be so important...&lt;/p&gt;</comment>
                            <comment id="17192994" author="tysonjh" created="Wed, 9 Sep 2020 16:01:20 +0000"  >&lt;p&gt;Apex runner has been removed.&lt;/p&gt;</comment>
                            <comment id="17345292" author="kenn" created="Sat, 15 May 2021 17:57:53 +0000"  >&lt;p&gt;Hello! Due to a bug in our Jira configuration, this issue had status:Resolved but resolution:Unresolved.&lt;/p&gt;

&lt;p&gt;I am bulk editing these issues to have resolution:Fixed&lt;/p&gt;

&lt;p&gt;If a different resolution is appropriate, please change it. To do this, click the &quot;Resolve&quot; button (you can do this even for closed issues) and set the Resolution field to the right value.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13064822">BEAM-2004</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 26 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3n8zr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>