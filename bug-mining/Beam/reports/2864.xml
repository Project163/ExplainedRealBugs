<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 11:24:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BEAM-14179] MonitoringInfoMetricName null value guard uncovering additional issues</title>
                <link>https://issues.apache.org/jira/browse/BEAM-14179</link>
                <project id="12319527" key="BEAM">Beam</project>
                    <description>&lt;p&gt;Additional integration testing (//cloud/dataflow/testing/integration/sdk:V1ReadIT_testE2EV1Read) caught that &lt;a href=&quot;https://github.com/apache/beam/pull/17094&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/pull/17094&lt;/a&gt; causes a regression:&lt;/p&gt;

&lt;p&gt;The test failed with:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Caused by: java.lang.NullPointerException: null value in entry: DATASTORE_NAMESPACE=null
	at org.apache.beam.vendor.guava.v26_0_jre.com.google.common.collect.CollectPreconditions.checkEntryNotNull(CollectPreconditions.java:32)
	at org.apache.beam.vendor.guava.v26_0_jre.com.google.common.collect.RegularImmutableMap.fromEntryArray(RegularImmutableMap.java:100)
	at org.apache.beam.vendor.guava.v26_0_jre.com.google.common.collect.RegularImmutableMap.fromEntries(RegularImmutableMap.java:74)
	at org.apache.beam.vendor.guava.v26_0_jre.com.google.common.collect.ImmutableMap.copyOf(ImmutableMap.java:464)
	at org.apache.beam.vendor.guava.v26_0_jre.com.google.common.collect.ImmutableMap.copyOf(ImmutableMap.java:437)
	at org.apache.beam.runners.core.metrics.MonitoringInfoMetricName.&amp;lt;init&amp;gt;(MonitoringInfoMetricName.java:46)
	at org.apache.beam.runners.core.metrics.MonitoringInfoMetricName.named(MonitoringInfoMetricName.java:93)
	at org.apache.beam.runners.core.metrics.ServiceCallMetric.call(ServiceCallMetric.java:82)
	at org.apache.beam.sdk.io.gcp.datastore.DatastoreV1$Read$ReadFn.runQueryWithRetries(DatastoreV1.java:927)
	at org.apache.beam.sdk.io.gcp.datastore.DatastoreV1$Read$ReadFn.processElement(DatastoreV1.java:965)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13435885">BEAM-14179</key>
            <summary>MonitoringInfoMetricName null value guard uncovering additional issues</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10102" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">P2</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="danoliveira">Daniel Oliveira</assignee>
                                    <reporter username="lcwik">Luke Cwik</reporter>
                        <labels>
                    </labels>
                <created>Fri, 25 Mar 2022 19:57:48 +0000</created>
                <updated>Fri, 1 Apr 2022 21:21:08 +0000</updated>
                            <resolved>Fri, 1 Apr 2022 21:21:08 +0000</resolved>
                                                    <fixVersion>2.38.0</fixVersion>
                                    <component>io-java-gcp</component>
                    <component>sdk-java-harness</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3600">1h</timespent>
                                <comments>
                            <comment id="17512561" author="lcwik" created="Fri, 25 Mar 2022 20:02:07 +0000"  >&lt;p&gt;The question is what is the intended outcome in this case for these service call metrics:&lt;br/&gt;
1) It could be that they are required, then we should fail rightly in the code&lt;br/&gt;
2) They are optional and we should pass in some value like &quot;null&quot;, &quot;&quot;, or &quot;N/A&quot;&lt;br/&gt;
3) The key can be filtered from the map if the value is null.&lt;/p&gt;</comment>
                            <comment id="17512570" author="lcwik" created="Fri, 25 Mar 2022 20:15:02 +0000"  >&lt;p&gt;The required_labels field tells us which &lt;a href=&quot;https://github.com/apache/beam/blob/d62b5d6c43847a3b5ecb1321144cf10c6931bd98/model/pipeline/src/main/proto/metrics.proto#L311&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/beam/blob/d62b5d6c43847a3b5ecb1321144cf10c6931bd98/model/pipeline/src/main/proto/metrics.proto#L311&lt;/a&gt; labels are necessary.&lt;/p&gt;

&lt;p&gt;This reduces the problem now down to what should be done when the value is unknown.&lt;/p&gt;</comment>
                            <comment id="17512580" author="danoliveira" created="Fri, 25 Mar 2022 20:45:24 +0000"  >&lt;p&gt;Regarding this bug&apos;s release blocker status, I&apos;m currently leaning towards just rolling back the culprit PR on the release branch. However I&apos;m currently waiting on some other cherrypicks before I can make RC1, so if a fix is available before then I&apos;ll cherry-pick it in.&lt;/p&gt;</comment>
                            <comment id="17516139" author="danoliveira" created="Fri, 1 Apr 2022 21:20:16 +0000"  >&lt;p&gt;I cherry-picked in a fix, mostly because the PR that revealed this isn&apos;t the root cause; The bug would still exist even if I rolled back, it just wouldn&apos;t be revealed by our tests. Plus the cherry-picked PR is a very small fix and unlikely to cause many issues.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 32 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z10u8g:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>