{"url":"https://api.github.com/repos/vercel/next.js/issues/82157","repository_url":"https://api.github.com/repos/vercel/next.js","labels_url":"https://api.github.com/repos/vercel/next.js/issues/82157/labels{/name}","comments_url":"https://api.github.com/repos/vercel/next.js/issues/82157/comments","events_url":"https://api.github.com/repos/vercel/next.js/issues/82157/events","html_url":"https://github.com/vercel/next.js/issues/82157","id":3273952095,"node_id":"I_kwDOBC3Cis7DJItf","number":82157,"title":"The `next build` command will clear the locally symlinked `next`, `react`, `react-dom`, `typescript` packages.","user":{"login":"startracex","id":94100555,"node_id":"U_kgDOBZvcSw","avatar_url":"https://avatars.githubusercontent.com/u/94100555?v=4","gravatar_id":"","url":"https://api.github.com/users/startracex","html_url":"https://github.com/startracex","followers_url":"https://api.github.com/users/startracex/followers","following_url":"https://api.github.com/users/startracex/following{/other_user}","gists_url":"https://api.github.com/users/startracex/gists{/gist_id}","starred_url":"https://api.github.com/users/startracex/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/startracex/subscriptions","organizations_url":"https://api.github.com/users/startracex/orgs","repos_url":"https://api.github.com/users/startracex/repos","events_url":"https://api.github.com/users/startracex/events{/privacy}","received_events_url":"https://api.github.com/users/startracex/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":3499651836,"node_id":"LA_kwDOBC3Cis7QmHL8","url":"https://api.github.com/repos/vercel/next.js/labels/Output","name":"Output","color":"31A7C3","default":false,"description":"Related to the the output configuration option."},{"id":5721224978,"node_id":"LA_kwDOBC3Cis8AAAABVQL3Eg","url":"https://api.github.com/repos/vercel/next.js/labels/locked","name":"locked","color":"ededed","default":false,"description":null}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2025-07-29T14:50:07Z","updated_at":"2025-08-14T00:06:01Z","closed_at":"2025-07-30T19:34:44Z","author_association":"CONTRIBUTOR","type":{"id":1930995,"node_id":"IT_kwDOAOSnPM4AHXbz","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-25T15:36:35Z","updated_at":"2024-07-26T10:33:22Z","is_enabled":true},"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Link to the code that reproduces this issue\n\nhttps://github.com/startracex/next-issue\n\n### To Reproduce\n\n1. Set `output: \"standalone\"` to `next.config.ts`.\n2. Run `next build`.\n3. Run `next build` (will fail).\n4. `node_modules/next`, `node_modules/react`, `node_modules/react-dom`, `node_modules/typescript` will be empty.\n\n### Current vs. Expected behavior\n\nCurrent: \n\nThe mentioned package directories be cleared.\nThe source code won't be able to find the packages, and the second build will fail.\n\nExpected: \n\nRerunning \"next build\" should only clear the \".next\" directory and must not delete files within the packages linked via symbolic links.\n\n### Provide environment information\n\n```bash\nOperating System:\n  Platform: win32\n  Arch: x64\n  Version: Windows 11 Home China\n  Available memory (MB): 16125\n  Available CPU cores: 20\nBinaries:\n  Node: 24.4.1\n  npm: 11.4.2\n  Yarn: N/A\n  pnpm: 10.13.1\nRelevant Packages:\n  next: 15.4.4 // Latest available version is detected (15.4.4).\n  eslint-config-next: N/A\n  react: 19.1.1\n  react-dom: 19.1.1\n  typescript: 5.8.3\nNext.js Config:\n  output: standalone\n```\n\n### Which area(s) are affected? (Select all that apply)\n\nOutput\n\n### Which stage(s) are affected? (Select all that apply)\n\nnext build (local)\n\n### Additional context\n\nThe emptied packages will appear under `.next/standalone/node_modules` after the build.","closed_by":{"login":"ztanner","id":1939140,"node_id":"MDQ6VXNlcjE5MzkxNDA=","avatar_url":"https://avatars.githubusercontent.com/u/1939140?v=4","gravatar_id":"","url":"https://api.github.com/users/ztanner","html_url":"https://github.com/ztanner","followers_url":"https://api.github.com/users/ztanner/followers","following_url":"https://api.github.com/users/ztanner/following{/other_user}","gists_url":"https://api.github.com/users/ztanner/gists{/gist_id}","starred_url":"https://api.github.com/users/ztanner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ztanner/subscriptions","organizations_url":"https://api.github.com/users/ztanner/orgs","repos_url":"https://api.github.com/users/ztanner/repos","events_url":"https://api.github.com/users/ztanner/events{/privacy}","received_events_url":"https://api.github.com/users/ztanner/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vercel/next.js/issues/82157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vercel/next.js/issues/82157/timeline","performed_via_github_app":null,"state_reason":"completed"}