{"url":"https://api.github.com/repos/vercel/next.js/issues/85251","repository_url":"https://api.github.com/repos/vercel/next.js","labels_url":"https://api.github.com/repos/vercel/next.js/issues/85251/labels{/name}","comments_url":"https://api.github.com/repos/vercel/next.js/issues/85251/comments","events_url":"https://api.github.com/repos/vercel/next.js/issues/85251/events","html_url":"https://github.com/vercel/next.js/issues/85251","id":3543040066,"node_id":"I_kwDOBC3Cis7TLoBC","number":85251,"title":"Next16 build `InvariantError` error","user":{"login":"arvinxx","id":28616219,"node_id":"MDQ6VXNlcjI4NjE2MjE5","avatar_url":"https://avatars.githubusercontent.com/u/28616219?v=4","gravatar_id":"","url":"https://api.github.com/users/arvinxx","html_url":"https://github.com/arvinxx","followers_url":"https://api.github.com/users/arvinxx/followers","following_url":"https://api.github.com/users/arvinxx/following{/other_user}","gists_url":"https://api.github.com/users/arvinxx/gists{/gist_id}","starred_url":"https://api.github.com/users/arvinxx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arvinxx/subscriptions","organizations_url":"https://api.github.com/users/arvinxx/orgs","repos_url":"https://api.github.com/users/arvinxx/repos","events_url":"https://api.github.com/users/arvinxx/events{/privacy}","received_events_url":"https://api.github.com/users/arvinxx/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":3502418291,"node_id":"LA_kwDOBC3Cis7Qwqlz","url":"https://api.github.com/repos/vercel/next.js/labels/Webpack","name":"Webpack","color":"FF1E56","default":false,"description":"Related to Webpack with Next.js."},{"id":4771244046,"node_id":"LA_kwDOBC3Cis8AAAABHGNoDg","url":"https://api.github.com/repos/vercel/next.js/labels/Turbopack","name":"Turbopack","color":"FF1E56","default":false,"description":"Related to Turbopack with Next.js."},{"id":5721224978,"node_id":"LA_kwDOBC3Cis8AAAABVQL3Eg","url":"https://api.github.com/repos/vercel/next.js/labels/locked","name":"locked","color":"ededed","default":false,"description":null}],"state":"closed","locked":true,"assignee":{"login":"wyattjoh","id":633002,"node_id":"MDQ6VXNlcjYzMzAwMg==","avatar_url":"https://avatars.githubusercontent.com/u/633002?v=4","gravatar_id":"","url":"https://api.github.com/users/wyattjoh","html_url":"https://github.com/wyattjoh","followers_url":"https://api.github.com/users/wyattjoh/followers","following_url":"https://api.github.com/users/wyattjoh/following{/other_user}","gists_url":"https://api.github.com/users/wyattjoh/gists{/gist_id}","starred_url":"https://api.github.com/users/wyattjoh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wyattjoh/subscriptions","organizations_url":"https://api.github.com/users/wyattjoh/orgs","repos_url":"https://api.github.com/users/wyattjoh/repos","events_url":"https://api.github.com/users/wyattjoh/events{/privacy}","received_events_url":"https://api.github.com/users/wyattjoh/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"wyattjoh","id":633002,"node_id":"MDQ6VXNlcjYzMzAwMg==","avatar_url":"https://avatars.githubusercontent.com/u/633002?v=4","gravatar_id":"","url":"https://api.github.com/users/wyattjoh","html_url":"https://github.com/wyattjoh","followers_url":"https://api.github.com/users/wyattjoh/followers","following_url":"https://api.github.com/users/wyattjoh/following{/other_user}","gists_url":"https://api.github.com/users/wyattjoh/gists{/gist_id}","starred_url":"https://api.github.com/users/wyattjoh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wyattjoh/subscriptions","organizations_url":"https://api.github.com/users/wyattjoh/orgs","repos_url":"https://api.github.com/users/wyattjoh/repos","events_url":"https://api.github.com/users/wyattjoh/events{/privacy}","received_events_url":"https://api.github.com/users/wyattjoh/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":1,"created_at":"2025-10-23T03:58:49Z","updated_at":"2025-11-08T00:05:50Z","closed_at":"2025-10-24T20:07:38Z","author_association":"NONE","type":{"id":1930995,"node_id":"IT_kwDOAOSnPM4AHXbz","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-25T15:36:35Z","updated_at":"2024-07-26T10:33:22Z","is_enabled":true},"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Link to the code that reproduces this issue\n\nhttps://github.com/lobehub/lobe-chat\n\n### To Reproduce\n\n1. Clone the next-16 branch: `git clone -b next-16 https://github.com/lobehub/lobe-chat.git`\n2. Install dependencies: `bun install` (or `pnpm install`)\n3. Run production build: `bun run build`\n4. Build worker exits with InvariantError\n\n### Current vs. Expected behavior\n\nin next 15.3.5 with webpack it works well. but when >15.4.0 it will meet OOM with webpack. in next 16 it just failed\n\nhere are the build log:\n\n```log\n11:21:21.361 Running build in Washington, D.C., USA (East) â€“ iad1\n11:21:21.362 Build machine configuration: 4 cores, 8 GB\n11:21:21.380 Cloning github.com/lobehub/lobe-chat (Branch: next-16, Commit: 8557880)\n11:21:21.387 VERCEL_FORCE_NO_BUILD_CACHE is set so skipping build cache step\n11:21:23.832 Cloning completed: 2.451s\n11:21:24.623 Running \"node scripts/vercelIgnoredBuildStep.js\"\n11:21:24.758 shouldBuild: true\n11:21:24.758 \n11:21:24.759 âœ… - Build can proceed\n11:21:24.759 \n11:21:24.909 Running \"vercel build\"\n11:21:25.344 Vercel CLI 48.2.9\n11:21:26.085 Running \"install\" command: `npx bun@1.2.23 install`...\n11:21:27.101 npm warn exec The following package was not found and will be installed: bun@1.2.23\n11:21:31.605 bun install v1.2.23 (cf136713)\n11:21:31.611 Resolving dependencies\n11:22:07.045 Resolved, downloaded and extracted [12946]\n11:22:07.046 warn: incorrect peer dependency \"next@16.0.0\"\n11:22:07.046 \n11:22:07.046 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.046 \n11:22:07.046 warn: incorrect peer dependency \"react-dom@19.2.0\"\n11:22:07.046 \n11:22:07.046 warn: incorrect peer dependency \"next@16.0.0\"\n11:22:07.046 \n11:22:07.047 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.047 \n11:22:07.047 warn: incorrect peer dependency \"react-dom@19.2.0\"\n11:22:07.047 \n11:22:07.047 warn: incorrect peer dependency \"stylelint@15.11.0\"\n11:22:07.047 \n11:22:07.047 warn: incorrect peer dependency \"stylelint@15.11.0\"\n11:22:07.047 \n11:22:07.047 warn: incorrect peer dependency \"@opentelemetry/api-logs@0.206.0\"\n11:22:07.047 \n11:22:07.047 warn: incorrect peer dependency \"@opentelemetry/sdk-logs@0.206.0\"\n11:22:07.047 \n11:22:07.047 warn: incorrect peer dependency \"@opentelemetry/resources@2.2.0\"\n11:22:07.047 \n11:22:07.047 warn: incorrect peer dependency \"@opentelemetry/sdk-metrics@2.2.0\"\n11:22:07.047 \n11:22:07.048 warn: incorrect peer dependency \"@opentelemetry/sdk-trace-base@2.2.0\"\n11:22:07.048 \n11:22:07.048 warn: incorrect peer dependency \"@opentelemetry/instrumentation@0.206.0\"\n11:22:07.048 \n11:22:07.048 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.048 \n11:22:07.048 warn: incorrect peer dependency \"react-dom@19.2.0\"\n11:22:07.048 \n11:22:07.048 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.048 \n11:22:07.048 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.049 \n11:22:07.049 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.049 \n11:22:07.049 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.049 \n11:22:07.049 warn: incorrect peer dependency \"stylelint@15.11.0\"\n11:22:07.049 \n11:22:07.049 warn: incorrect peer dependency \"stylelint@15.11.0\"\n11:22:07.049 \n11:22:07.049 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.049 \n11:22:07.049 warn: incorrect peer dependency \"react-dom@19.2.0\"\n11:22:07.049 \n11:22:07.049 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.050 \n11:22:07.050 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.050 \n11:22:07.050 warn: incorrect peer dependency \"react-dom@19.2.0\"\n11:22:07.050 \n11:22:07.050 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.050 \n11:22:07.050 warn: incorrect peer dependency \"@octokit/core@5.2.2\"\n11:22:07.050 \n11:22:07.050 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.050 \n11:22:07.050 warn: incorrect peer dependency \"react-dom@19.2.0\"\n11:22:07.051 \n11:22:07.051 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.051 \n11:22:07.051 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.051 \n11:22:07.051 warn: incorrect peer dependency \"react-dom@19.2.0\"\n11:22:07.051 \n11:22:07.051 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.051 \n11:22:07.051 warn: incorrect peer dependency \"react-dom@19.2.0\"\n11:22:07.051 \n11:22:07.051 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.051 \n11:22:07.051 warn: incorrect peer dependency \"react-dom@19.2.0\"\n11:22:07.051 \n11:22:07.052 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.052 \n11:22:07.052 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.052 \n11:22:07.052 warn: incorrect peer dependency \"react-dom@19.2.0\"\n11:22:07.052 \n11:22:07.052 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.052 \n11:22:07.052 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.052 \n11:22:07.052 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.052 \n11:22:07.052 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.052 \n11:22:07.052 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.052 \n11:22:07.052 warn: incorrect peer dependency \"react-dom@19.2.0\"\n11:22:07.053 \n11:22:07.053 warn: incorrect peer dependency \"react@19.2.0\"\n11:22:07.053 \n11:22:07.053 warn: incorrect peer dependency \"react@19.2.0\"\n11:23:31.212 Saved lockfile\n11:23:31.212 \n11:23:31.212 $ husky\n11:23:31.370 \n11:23:31.370 + @commitlint/cli@19.8.1 (v20.1.0 available)\n11:23:31.370 + @edge-runtime/vm@5.0.0\n11:23:31.370 + @huggingface/tasks@0.19.58\n11:23:31.374 + @lobechat/types@workspace:packages/types\n11:23:31.374 + @lobehub/i18n-cli@1.25.1\n11:23:31.374 + @lobehub/lint@1.26.2\n11:23:31.374 + @lobehub/market-types@1.11.4\n11:23:31.374 + @lobehub/seo-cli@1.7.0\n11:23:31.374 + @next/bundle-analyzer@16.0.0-beta.0\n11:23:31.374 + @next/eslint-plugin-next@15.5.6 (v16.0.0 available)\n11:23:31.374 + @peculiar/webcrypto@1.5.0\n11:23:31.374 + @playwright/test@1.56.1\n11:23:31.374 + @prettier/sync@0.6.1\n11:23:31.374 + @semantic-release/exec@6.0.3 (v7.1.0 available)\n11:23:31.374 + @testing-library/jest-dom@6.9.1\n11:23:31.374 + @testing-library/react@16.3.0\n11:23:31.374 + @testing-library/user-event@14.6.1\n11:23:31.374 + @types/chroma-js@3.1.1\n11:23:31.374 + @types/crypto-js@4.2.2\n11:23:31.374 + @types/debug@4.1.12\n11:23:31.374 + @types/fs-extra@11.0.4\n11:23:31.374 + @types/ip@1.1.3\n11:23:31.374 + @types/json-schema@7.0.15\n11:23:31.374 + @types/lodash@4.17.20\n11:23:31.374 + @types/lodash-es@4.17.12\n11:23:31.374 + @types/node@22.18.12 (v24.9.1 available)\n11:23:31.374 + @types/numeral@2.0.5\n11:23:31.375 + @types/oidc-provider@9.5.0\n11:23:31.375 + @types/pdfkit@0.17.3\n11:23:31.377 + @types/pg@8.15.5\n11:23:31.377 + @types/react@19.2.2\n11:23:31.377 + @types/react-dom@19.2.2\n11:23:31.377 + @types/rtl-detect@1.0.3\n11:23:31.377 + @types/semver@7.7.1\n11:23:31.377 + @types/systemjs@6.15.3\n11:23:31.377 + @types/ua-parser-js@0.7.39\n11:23:31.378 + @types/unist@3.0.3\n11:23:31.378 + @types/ws@8.18.1\n11:23:31.379 + @typescript/native-preview@7.0.0-dev.20250711.1\n11:23:31.379 + @vitest/coverage-v8@3.2.4 (v4.0.1 available)\n11:23:31.380 + ajv-keywords@5.1.0\n11:23:31.380 + commitlint@19.8.1 (v20.1.0 available)\n11:23:31.380 + consola@3.4.2\n11:23:31.381 + cross-env@10.1.0\n11:23:31.381 + crypto-js@4.2.0\n11:23:31.381 + dbdocs@0.16.2\n11:23:31.381 + dotenv@17.2.3\n11:23:31.381 + dotenv-expand@12.0.3\n11:23:31.381 + dpdm-fast@1.0.14\n11:23:31.382 + drizzle-dbml-generator@0.10.0\n11:23:31.382 + drizzle-kit@0.31.5\n11:23:31.383 + eslint@8.57.1 (v9.38.0 available)\n11:23:31.383 + eslint-plugin-mdx@3.6.2\n11:23:31.384 + fake-indexeddb@6.2.4\n11:23:31.384 + fs-extra@11.3.2\n11:23:31.385 + glob@11.0.3\n11:23:31.386 + happy-dom@20.0.8\n11:23:31.386 + husky@9.1.7\n11:23:31.386 + import-in-the-middle@1.15.0 (v2.0.0 available)\n11:23:31.389 + just-diff@6.0.2\n11:23:31.389 + lint-staged@15.5.2 (v16.2.6 available)\n11:23:31.389 + lodash@4.17.21\n11:23:31.389 + markdown-table@3.0.4\n11:23:31.389 + mcp-hello-world@1.1.2\n11:23:31.389 + mime@4.1.0\n11:23:31.389 + node-fetch@3.3.2\n11:23:31.389 + node-gyp@11.5.0\n11:23:31.389 + openapi-typescript@7.10.1\n11:23:31.389 + p-map@7.0.3\n11:23:31.389 + prettier@3.6.2\n11:23:31.389 + remark-cli@12.0.1\n11:23:31.389 + remark-frontmatter@5.0.0\n11:23:31.389 + remark-mdx@3.1.1\n11:23:31.389 + remark-parse@11.0.0\n11:23:31.389 + require-in-the-middle@7.5.2 (v8.0.1 available)\n11:23:31.389 + semantic-release@21.1.2 (v25.0.1 available)\n11:23:31.389 + serwist@9.2.1\n11:23:31.389 + stylelint@15.11.0 (v16.25.0 available)\n11:23:31.389 + tsx@4.20.6\n11:23:31.389 + type-fest@4.41.0 (v5.1.0 available)\n11:23:31.389 + typescript@5.9.3\n11:23:31.389 + unified@11.0.5\n11:23:31.389 + unist-util-visit@5.0.0\n11:23:31.389 + vite@7.1.11\n11:23:31.389 + vitest@3.2.4 (v4.0.1 available)\n11:23:31.390 + @ant-design/icons@5.6.1 (v6.1.0 available)\n11:23:31.390 + @ant-design/pro-components@2.8.10\n11:23:31.390 + @anthropic-ai/sdk@0.67.0\n11:23:31.390 + @auth/core@0.40.0 (v0.41.0 available)\n11:23:31.390 + @aws-sdk/client-s3@3.893.0 (v3.914.0 available)\n11:23:31.391 + @aws-sdk/s3-request-presigner@3.893.0 (v3.914.0 available)\n11:23:31.391 + @azure-rest/ai-inference@1.0.0-beta.5\n11:23:31.391 + @azure/core-auth@1.10.1\n11:23:31.391 + @cfworker/json-schema@4.1.1\n11:23:31.392 + @clerk/localizations@3.26.3\n11:23:31.392 + @clerk/nextjs@6.34.0\n11:23:31.392 + @clerk/themes@2.4.29\n11:23:31.392 + @codesandbox/sandpack-react@2.20.0\n11:23:31.392 + @cyntler/react-doc-viewer@1.17.1\n11:23:31.392 + @electric-sql/pglite@0.2.17 (v0.3.11 available)\n11:23:31.392 + @emotion/react@11.14.0\n11:23:31.392 + @fal-ai/client@1.7.0\n11:23:31.392 + @formkit/auto-animate@0.9.0\n11:23:31.392 + @google/genai@1.26.0\n11:23:31.392 + @huggingface/inference@4.12.0\n11:23:31.393 + @icons-pack/react-simple-icons@13.8.0\n11:23:31.393 + @khmyznikov/pwa-install@0.3.9 (v0.5.8 available)\n11:23:31.393 + @langchain/community@0.3.57 (v1.0.0 available)\n11:23:31.393 + @lobechat/agent-runtime@workspace:packages/agent-runtime\n11:23:31.393 + @lobechat/const@workspace:packages/const\n11:23:31.393 + @lobechat/context-engine@workspace:packages/context-engine\n11:23:31.394 + @lobechat/database@workspace:packages/database\n11:23:31.394 + @lobechat/electron-client-ipc@workspace:packages/electron-client-ipc\n11:23:31.394 + @lobechat/electron-server-ipc@workspace:packages/electron-server-ipc\n11:23:31.394 + @lobechat/file-loaders@workspace:packages/file-loaders\n11:23:31.394 + @lobechat/model-runtime@workspace:packages/model-runtime\n11:23:31.394 + @lobechat/observability-otel@workspace:packages/obervability-otel\n11:23:31.394 + @lobechat/prompts@workspace:packages/prompts\n11:23:31.394 + @lobechat/python-interpreter@workspace:packages/python-interpreter\n11:23:31.394 + @lobechat/utils@workspace:packages/utils\n11:23:31.394 + @lobechat/web-crawler@workspace:packages/web-crawler\n11:23:31.394 + @lobehub/analytics@1.6.0\n11:23:31.394 + @lobehub/charts@2.1.2\n11:23:31.394 + @lobehub/chat-plugin-sdk@1.32.4\n11:23:31.394 + @lobehub/chat-plugins-gateway@1.9.0\n11:23:31.394 + @lobehub/editor@1.21.0\n11:23:31.394 + @lobehub/icons@2.43.1\n11:23:31.394 + @lobehub/market-sdk@0.22.7\n11:23:31.394 + @lobehub/tts@2.0.1\n11:23:31.394 + @lobehub/ui@2.13.4\n11:23:31.397 + @modelcontextprotocol/sdk@1.20.1\n11:23:31.397 + @neondatabase/serverless@1.0.2\n11:23:31.398 + @next/third-parties@16.0.0-beta.0\n11:23:31.398 + @opentelemetry/exporter-jaeger@2.2.0\n11:23:31.398 + @opentelemetry/winston-transport@0.17.0 (v0.18.0 available)\n11:23:31.398 + @react-pdf/renderer@4.3.1\n11:23:31.398 + @react-spring/web@9.7.5 (v10.0.3 available)\n11:23:31.398 + @saintno/comfyui-sdk@0.2.49\n11:23:31.398 + @serwist/next@9.2.1\n11:23:31.398 + @t3-oss/env-nextjs@0.13.8\n11:23:31.398 + @tanstack/react-query@5.90.5\n11:23:31.398 + @trpc/client@11.6.0\n11:23:31.398 + @trpc/next@11.6.0\n11:23:31.399 + @trpc/react-query@11.6.0\n11:23:31.399 + @trpc/server@11.6.0\n11:23:31.399 + @vercel/analytics@1.5.0\n11:23:31.399 + @vercel/edge-config@1.4.2\n11:23:31.400 + @vercel/functions@3.1.4\n11:23:31.400 + @vercel/speed-insights@1.2.0\n11:23:31.400 + @virtuoso.dev/masonry@1.3.5\n11:23:31.400 + @xterm/xterm@5.5.0\n11:23:31.401 + ahooks@3.9.5\n11:23:31.401 + antd@5.27.6\n11:23:31.401 + antd-style@3.7.1\n11:23:31.401 + brotli-wasm@3.0.1\n11:23:31.402 + chroma-js@3.1.2\n11:23:31.402 + cookie@1.0.2\n11:23:31.402 + countries-and-timezones@3.8.0\n11:23:31.402 + dayjs@1.11.18\n11:23:31.402 + debug@4.4.3\n11:23:31.402 + dexie@3.2.7 (v4.2.1 available)\n11:23:31.403 + diff@8.0.2\n11:23:31.403 + drizzle-orm@0.44.6\n11:23:31.403 + drizzle-zod@0.5.1 (v0.8.3 available)\n11:23:31.403 + epub2@3.0.2\n11:23:31.403 + fast-deep-equal@3.1.3\n11:23:31.403 + file-type@21.0.0\n11:23:31.403 + framer-motion@12.23.24\n11:23:31.403 + gpt-tokenizer@3.2.0\n11:23:31.404 + gray-matter@4.0.3\n11:23:31.404 + html-to-text@9.0.5\n11:23:31.404 + i18next@25.6.0\n11:23:31.404 + i18next-browser-languagedetector@8.2.0\n11:23:31.404 + i18next-resources-to-backend@1.2.1\n11:23:31.404 + idb-keyval@6.2.2\n11:23:31.405 + immer@10.1.3\n11:23:31.405 + jose@5.10.0 (v6.1.0 available)\n11:23:31.405 + js-sha256@0.11.1\n11:23:31.405 + jsonl-parse-stringify@1.0.3\n11:23:31.405 + keyv@4.5.4 (v5.5.3 available)\n11:23:31.405 + langchain@0.3.36 (v1.0.1 available)\n11:23:31.405 + langfuse@3.38.6\n11:23:31.406 + langfuse-core@3.38.6\n11:23:31.406 + lodash-es@4.17.21\n11:23:31.406 + lucide-react@0.544.0 (v0.546.0 available)\n11:23:31.406 + mammoth@1.11.0\n11:23:31.407 + markdown-to-txt@2.0.1\n11:23:31.407 + marked@16.4.1\n11:23:31.407 + mdast-util-to-markdown@2.1.2\n11:23:31.407 + model-bank@workspace:packages/model-bank\n11:23:31.407 + modern-screenshot@4.6.6\n11:23:31.407 + nanoid@5.1.6\n11:23:31.407 + next@16.0.0\n11:23:31.407 + next-auth@5.0.0-beta.29\n11:23:31.408 + next-mdx-remote@5.0.0\n11:23:31.408 + nextjs-toploader@3.9.17\n11:23:31.408 + node-machine-id@1.1.12\n11:23:31.408 + numeral@2.0.6\n11:23:31.409 + nuqs@2.7.2\n11:23:31.409 + officeparser@5.1.1 (v5.2.1 available)\n11:23:31.409 + oidc-provider@9.5.1\n11:23:31.409 + ollama@0.6.0\n11:23:31.410 + openai@4.104.0 (v6.6.0 available)\n11:23:31.410 + openapi-fetch@0.14.1 (v0.15.0 available)\n11:23:31.410 + partial-json@0.1.7\n11:23:31.410 + path-browserify-esm@1.0.6\n11:23:31.411 + pdf-parse@1.1.1 (v2.4.5 available)\n11:23:31.411 + pdfjs-dist@4.8.69 (v5.4.296 available)\n11:23:31.411 + pdfkit@0.17.2\n11:23:31.412 + pg@8.16.3\n11:23:31.412 + pino@9.14.0 (v10.1.0 available)\n11:23:31.412 + plaiceholder@3.0.0\n11:23:31.412 + polished@4.3.1\n11:23:31.412 + posthog-js@1.278.0 (v1.279.3 available)\n11:23:31.412 + pure-rand@7.0.1\n11:23:31.412 + pwa-install-handler@2.6.3\n11:23:31.412 + query-string@9.3.1\n11:23:31.412 + random-words@2.0.1\n11:23:31.412 + react@19.2.0\n11:23:31.413 + react-confetti@6.4.0\n11:23:31.413 + react-dom@19.2.0\n11:23:31.413 + react-fast-marquee@1.6.5\n11:23:31.413 + react-hotkeys-hook@5.2.1\n11:23:31.414 + react-i18next@15.7.4 (v16.1.5 available)\n11:23:31.414 + react-layout-kit@2.0.0\n11:23:31.415 + react-lazy-load@4.0.1\n11:23:31.415 + react-pdf@9.2.1 (v10.2.0 available)\n11:23:31.415 + react-responsive@10.0.1\n11:23:31.415 + react-rnd@10.5.2\n11:23:31.415 + react-router-dom@7.9.4\n11:23:31.415 + react-scan@0.4.3\n11:23:31.415 + react-virtuoso@4.14.1\n11:23:31.415 + react-wrap-balancer@1.1.1\n11:23:31.415 + remark@15.0.1\n11:23:31.416 + remark-gfm@4.0.1\n11:23:31.417 + remark-html@16.0.1\n11:23:31.417 + resolve-accept-language@3.1.13\n11:23:31.417 + rtl-detect@1.1.2\n11:23:31.417 + semver@7.7.3\n11:23:31.417 + sharp@0.34.4\n11:23:31.417 + shiki@3.13.0\n11:23:31.417 + ssrf-safe-fetch@workspace:packages/ssrf-safe-fetch\n11:23:31.417 + stripe@17.7.0 (v19.1.0 available)\n11:23:31.417 + superjson@2.2.3\n11:23:31.418 + svix@1.78.0\n11:23:31.418 + swr@2.3.6\n11:23:31.418 + systemjs@6.15.1\n11:23:31.418 + tokenx@1.2.0\n11:23:31.418 + ts-md5@2.0.1\n11:23:31.419 + ua-parser-js@1.0.41 (v2.0.6 available)\n11:23:31.420 + unstructured-client@0.19.0 (v0.28.0 available)\n11:23:31.421 + url-join@5.0.0\n11:23:31.421 + use-merge-value@1.2.0\n11:23:31.421 + uuid@11.1.0 (v13.0.0 available)\n11:23:31.421 + word-extractor@1.0.4\n11:23:31.421 + ws@8.18.3\n11:23:31.421 + yaml@2.8.1\n11:23:31.421 + zod@3.25.76 (v4.1.12 available)\n11:23:31.421 + zustand@5.0.4 (v5.0.8 available)\n11:23:31.421 + zustand-utils@2.1.1\n11:23:31.421 \n11:23:31.421 3390 packages installed [119.77s]\n11:23:31.421 \n11:23:31.421 Blocked 10 postinstalls. Run `bun pm untrusted` for details.\n11:23:31.581 Detected Next.js version: 16.0.0\n11:23:31.582 Running \"bun run build\"\n11:23:31.940 $ tsx scripts/prebuild.mts && bun run lint\n11:23:32.965 [dotenv@17.2.3] injecting env (0) from .env -- tip: ðŸ” prevent committing .env to code: https://dotenvx.com/precommit\n11:23:32.966 Starting prebuild cleanup...\n11:23:32.968 â™»ï¸ Removed src/app/desktop successfully\n11:23:32.969 â™»ï¸ Removed src/app/(backend)/trpc/desktop successfully\n11:23:32.969 Prebuild cleanup completed.\n11:23:32.998 $ bun run lint:ts && bun run lint:style && bun run type-check && bun run lint:circular\n11:23:33.002 $ eslint \"{src,tests}/**/*.{js,jsx,ts,tsx}\" --fix\n11:24:18.865 $ stylelint \"{src,tests}/**/*.{js,jsx,ts,tsx}\" --fix\n11:24:53.965 \n11:24:53.965 \u001B[33mDeprecation warnings:\u001B[39m\n11:24:53.965  \u001B[2m-\u001B[22m The \"function-whitespace-after\" rule is deprecated.\n11:24:53.965  \u001B[2m-\u001B[22m The \"media-feature-range-operator-space-after\" rule is deprecated.\n11:24:53.965  \u001B[2m-\u001B[22m The \"media-feature-range-operator-space-before\" rule is deprecated.\n11:24:53.965 \n11:24:54.019 $ tsgo --noEmit\n11:25:19.162 $ bun run lint:circular:main && bun run lint:circular:packages\n11:25:19.166 $ dpdm src/**/*.ts  --no-warning --no-tree --exit-code circular:1 --no-progress -T true --skip-dynamic-imports circular\n11:25:19.292 \n\nâ ‹ Start analyzing dependencies...\n                                   \nStart analyzing dependencies...\n11:25:19.593 â€¢ Circular Dependencies\n11:25:19.593 ðŸš€ No circular dependencies found.\n11:25:19.593 Analyze done!\n11:25:19.600 $ dpdm packages/**/src/**/*.ts  --no-warning --no-tree --exit-code circular:1 --no-progress -T true --skip-dynamic-imports circular\n11:25:19.723 \n\nâ ‹ Start analyzing dependencies...\n                                   \nStart analyzing dependencies...\n11:25:20.185 â€¢ Circular Dependencies\n11:25:20.186 ðŸš€ No circular dependencies found.\n11:25:20.186 Analyze done!\n11:25:20.192 $ cross-env NODE_OPTIONS=--max-old-space-size=6144 next build\n11:25:21.696 [@serwist/next] WARNING: You are using '@serwist/next' with `next dev --turbopack`, but Serwist doesn't support Turbopack at the moment. It is recommended that you set `disable` to `process.env.NODE_ENV !== \"production\"`. Follow https://github.com/serwist/serwist/issues/54 for progress on Serwist + Turbopack. You can also suppress this warning by setting SERWIST_SUPPRESS_TURBOPACK_WARNING=1.\n11:25:21.724 Attention: Next.js now collects completely anonymous telemetry regarding usage.\n11:25:21.725 This information is used to shape Next.js' roadmap and prioritize features.\n11:25:21.725 You can learn more, including how to opt-out if you'd not like to participate in this anonymous program, by visiting the following URL:\n11:25:21.725 https://nextjs.org/telemetry\n11:25:21.725 \n11:25:21.747    â–² Next.js 16.0.0 (Turbopack)\n11:25:21.748    - Experiments (use with caution):\n11:25:21.748      Â· optimizePackageImports\n11:25:21.748      â¨¯ serverMinification\n11:25:21.748      âœ“ turbopackFileSystemCacheForDev\n11:25:21.748      âœ“ webpackBuildWorker\n11:25:21.748      âœ“ webpackMemoryOptimizations\n11:25:21.748      Â· webVitalsAttribution\n11:25:21.748 \n11:25:21.848    Creating an optimized production build ...\n11:25:22.780 [@serwist/next] WARNING: You are using '@serwist/next' with `next dev --turbopack`, but Serwist doesn't support Turbopack at the moment. It is recommended that you set `disable` to `process.env.NODE_ENV !== \"production\"`. Follow https://github.com/serwist/serwist/issues/54 for progress on Serwist + Turbopack. You can also suppress this warning by setting SERWIST_SUPPRESS_TURBOPACK_WARNING=1.\n11:28:20.272 Turbopack build encountered 2 warnings:\n11:28:20.272 ./node_modules/@opentelemetry/instrumentation/build/esm/platform/node\n11:28:20.272 Package require-in-the-middle can't be external\n11:28:20.272 The request require-in-the-middle matches serverExternalPackages (or the default list).\n11:28:20.272 The package resolves to a different version when requested from the project directory (7.5.2) compared to the package requested from the importing module (8.0.1).\n11:28:20.272 Make sure to install the same version of the package in both locations.\n11:28:20.272 \n11:28:20.272 \n11:28:20.272 [externals]/node:buffer\n11:28:20.272 unexpected export *\n11:28:20.278 export * used with module [externals]/node:buffer [external] (node:buffer, cjs) which is a CommonJS module with exports only available at runtime\n11:28:20.278 List all export names manually (`export { a, b, c } from \"...\") or rewrite the module to ESM, to avoid the additional runtime code.`\n11:28:20.279 \n11:28:20.279 Import trace:\n11:28:20.279   external:\n11:28:20.279     [externals]/node:buffer [external]\n11:28:20.279     ./node_modules/jose/dist/node/esm/runtime/base64url.js [App Route]\n11:28:20.279     ./node_modules/jose/dist/node/esm/key/import.js [App Route]\n11:28:20.279     ./src/libs/oidc-provider/jwt.ts [App Route]\n11:28:20.279     ./src/app/(backend)/middleware/auth/index.ts [App Route]\n11:28:20.279     ./src/app/(backend)/webapi/text-to-image/[provider]/route.ts [App Route]\n11:28:20.279 \n11:28:20.279 \n11:28:21.267  âœ“ Compiled successfully in 3.0min\n11:28:21.267    Skipping validation of types\n11:28:25.839    Collecting page data ...\n11:28:31.450  âš  Using edge runtime on a page currently disables static generation for that page\n11:28:34.056 Error [InvariantError]: Invariant: Unexpected match for a pathname \"/en-US__1__dark/files/(.)[id]\" with a param \"id\" of type \"dynamic-intercepted\". This is a bug in Next.js.\n11:28:34.057     at ignore-listed frames\n11:28:34.064 \n11:28:34.065 > Build error occurred\n11:28:34.068 Error: Failed to collect page data for /[variants]/files/(.)[id]\n11:28:34.069     at ignore-listed frames {\n11:28:34.069   type: 'Error'\n11:28:34.069 }\n11:28:34.158 error: script \"build\" exited with code 1\n11:28:34.199 Error: Command \"bun run build\" exited with 1\n```\n\n### Provide environment information\n\n```bash\nOperating System:\n  Platform: darwin\n  Arch: arm64\n  Version: Darwin Kernel Version 24.6.0: Mon Jul 14 11:30:29 PDT 2025; root:xnu-11417.140.69~1/RELEASE_ARM64_T6000\n  Available memory (MB): 65536\n  Available CPU cores: 10\nBinaries:\n  Node: 24.10.0\n  npm: 11.6.1\n  Yarn: N/A\n  pnpm: 10.18.3\nRelevant Packages:\n  next: 15.3.5 // An outdated version detected (latest is 16.0.0), upgrade is highly recommended!\n  eslint-config-next: N/A\n  react: 19.2.0\n  react-dom: 19.2.0\n  typescript: 5.9.3\n```\n\n### Which area(s) are affected? (Select all that apply)\n\nTurbopack, Webpack\n\n### Which stage(s) are affected? (Select all that apply)\n\nVercel (Deployed), next build (local)\n\n### Additional context\n\nwe also meet building OOM with next >=15.4.0. as LobeChat is a large-scale open-source Next.js application with ~200,000 lines of code. Due to the project's scale and complexity, we cannot provide a minimal reproduction repository. This issue only manifests in production-scale applications and cannot be easily isolated to a minimal reproduction.\n","closed_by":{"login":"wyattjoh","id":633002,"node_id":"MDQ6VXNlcjYzMzAwMg==","avatar_url":"https://avatars.githubusercontent.com/u/633002?v=4","gravatar_id":"","url":"https://api.github.com/users/wyattjoh","html_url":"https://github.com/wyattjoh","followers_url":"https://api.github.com/users/wyattjoh/followers","following_url":"https://api.github.com/users/wyattjoh/following{/other_user}","gists_url":"https://api.github.com/users/wyattjoh/gists{/gist_id}","starred_url":"https://api.github.com/users/wyattjoh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wyattjoh/subscriptions","organizations_url":"https://api.github.com/users/wyattjoh/orgs","repos_url":"https://api.github.com/users/wyattjoh/repos","events_url":"https://api.github.com/users/wyattjoh/events{/privacy}","received_events_url":"https://api.github.com/users/wyattjoh/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vercel/next.js/issues/85251/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vercel/next.js/issues/85251/timeline","performed_via_github_app":null,"state_reason":"completed"}