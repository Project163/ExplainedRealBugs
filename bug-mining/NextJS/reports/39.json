{"url":"https://api.github.com/repos/vercel/next.js/issues/79608","repository_url":"https://api.github.com/repos/vercel/next.js","labels_url":"https://api.github.com/repos/vercel/next.js/issues/79608/labels{/name}","comments_url":"https://api.github.com/repos/vercel/next.js/issues/79608/comments","events_url":"https://api.github.com/repos/vercel/next.js/issues/79608/events","html_url":"https://github.com/vercel/next.js/issues/79608","id":3089232781,"node_id":"I_kwDOBC3Cis64IfON","number":79608,"title":"Bug Report: Nextjs form action `ReferenceError: <variable> is not defined` when large data is accessed","user":{"login":"fahidsarker","id":80589556,"node_id":"MDQ6VXNlcjgwNTg5NTU2","avatar_url":"https://avatars.githubusercontent.com/u/80589556?v=4","gravatar_id":"","url":"https://api.github.com/users/fahidsarker","html_url":"https://github.com/fahidsarker","followers_url":"https://api.github.com/users/fahidsarker/followers","following_url":"https://api.github.com/users/fahidsarker/following{/other_user}","gists_url":"https://api.github.com/users/fahidsarker/gists{/gist_id}","starred_url":"https://api.github.com/users/fahidsarker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fahidsarker/subscriptions","organizations_url":"https://api.github.com/users/fahidsarker/orgs","repos_url":"https://api.github.com/users/fahidsarker/repos","events_url":"https://api.github.com/users/fahidsarker/events{/privacy}","received_events_url":"https://api.github.com/users/fahidsarker/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":5721224978,"node_id":"LA_kwDOBC3Cis8AAAABVQL3Eg","url":"https://api.github.com/repos/vercel/next.js/labels/locked","name":"locked","color":"ededed","default":false,"description":null},{"id":8064243106,"node_id":"LA_kwDOBC3Cis8AAAAB4KqVog","url":"https://api.github.com/repos/vercel/next.js/labels/Form%20(next/form)","name":"Form (next/form)","color":"8E6D69","default":false,"description":"Related to the Next.js Forms."},{"id":8064249485,"node_id":"LA_kwDOBC3Cis8AAAAB4KqujQ","url":"https://api.github.com/repos/vercel/next.js/labels/Server%20Actions","name":"Server Actions","color":"EF04D1","default":false,"description":"Related to Server Actions."}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2025-05-25T11:26:01Z","updated_at":"2025-06-11T00:06:16Z","closed_at":"2025-05-27T15:23:26Z","author_association":"NONE","type":{"id":1930995,"node_id":"IT_kwDOAOSnPM4AHXbz","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-25T15:36:35Z","updated_at":"2024-07-26T10:33:22Z","is_enabled":true},"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Link to the code that reproduces this issue\n\nhttps://github.com/fahidsarker/nextjs-form-action-bug-reproduced\n\n### To Reproduce\n\nNextJS server actions inside form behaves strangely whenever a large data is accessed. It appears to not package anything when a large data is passed.\n\n- Error seems to be due to the `allData` variable which is an array of 100 elements:\n<img width=\"675\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/156899d6-1ac2-468f-9bd3-6330dc72fde7\" />\n\n-  When the form is submitted:\n<img width=\"1090\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/8f6c0806-a36f-474e-9841-e73fd6d872c1\" />\nit throws the `ReferenceError: user is not defined` \n\nHowever the error is gone if the `allData` is accessed outside of server-action:\n-  `allData` is not accessed inside the form\n<img width=\"713\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/5b371a9b-aa05-4619-9c0b-0ffa76eb94df\" />\n\n- form submitted with no issues\n\nThe weird thing is Nextjs does not give any logical error to detect this, leading to a very bad debug experience (specially on a large codebase). \n\nA minimal code repo is provided based on a real project to reproduce this bug.\n\n### Current vs. Expected behavior\n\nCurrent: Throws the `ReferenceError: user is not defined` error\nExpected: Form submitted or Points the error to `allData` variable \n\n### Provide environment information\n\n```bash\nOperating System:\n  Platform: darwin\n  Arch: arm64\n  Version: Darwin Kernel Version 24.3.0: Thu Jan  2 20:24:24 PST 2025; root:xnu-11215.81.4~3/RELEASE_ARM64_T6030\n  Available memory (MB): 36864\n  Available CPU cores: 12\nBinaries:\n  Node: 23.7.0\n  npm: 10.9.2\n  Yarn: N/A\n  pnpm: 9.10.0\nRelevant Packages:\n  next: 15.3.2 // Latest available version is detected (15.3.2).\n  eslint-config-next: 15.3.2\n  react: 19.1.0\n  react-dom: 19.1.0\n  typescript: 5.8.3\nNext.js Config:\n  output: N/A\n```\n\n### Which area(s) are affected? (Select all that apply)\n\nForm (next/form), Server Actions\n\n### Which stage(s) are affected? (Select all that apply)\n\nnext dev (local), Vercel (Deployed), Other (Deployed), next start (local)\n\n### Additional context\n\n_No response_","closed_by":{"login":"unstubbable","id":761683,"node_id":"MDQ6VXNlcjc2MTY4Mw==","avatar_url":"https://avatars.githubusercontent.com/u/761683?v=4","gravatar_id":"","url":"https://api.github.com/users/unstubbable","html_url":"https://github.com/unstubbable","followers_url":"https://api.github.com/users/unstubbable/followers","following_url":"https://api.github.com/users/unstubbable/following{/other_user}","gists_url":"https://api.github.com/users/unstubbable/gists{/gist_id}","starred_url":"https://api.github.com/users/unstubbable/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/unstubbable/subscriptions","organizations_url":"https://api.github.com/users/unstubbable/orgs","repos_url":"https://api.github.com/users/unstubbable/repos","events_url":"https://api.github.com/users/unstubbable/events{/privacy}","received_events_url":"https://api.github.com/users/unstubbable/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vercel/next.js/issues/79608/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vercel/next.js/issues/79608/timeline","performed_via_github_app":null,"state_reason":"completed"}