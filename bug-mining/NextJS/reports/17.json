{"url":"https://api.github.com/repos/vercel/next.js/issues/74385","repository_url":"https://api.github.com/repos/vercel/next.js","labels_url":"https://api.github.com/repos/vercel/next.js/issues/74385/labels{/name}","comments_url":"https://api.github.com/repos/vercel/next.js/issues/74385/comments","events_url":"https://api.github.com/repos/vercel/next.js/issues/74385/events","html_url":"https://github.com/vercel/next.js/issues/74385","id":2762204032,"node_id":"I_kwDOBC3Cis6ko-OA","number":74385,"title":"Importing local font in edge runtime is broken since Next 15 with pages router (vercel/og example)","user":{"login":"chemicalkosek","id":11018707,"node_id":"MDQ6VXNlcjExMDE4NzA3","avatar_url":"https://avatars.githubusercontent.com/u/11018707?v=4","gravatar_id":"","url":"https://api.github.com/users/chemicalkosek","html_url":"https://github.com/chemicalkosek","followers_url":"https://api.github.com/users/chemicalkosek/followers","following_url":"https://api.github.com/users/chemicalkosek/following{/other_user}","gists_url":"https://api.github.com/users/chemicalkosek/gists{/gist_id}","starred_url":"https://api.github.com/users/chemicalkosek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chemicalkosek/subscriptions","organizations_url":"https://api.github.com/users/chemicalkosek/orgs","repos_url":"https://api.github.com/users/chemicalkosek/repos","events_url":"https://api.github.com/users/chemicalkosek/events{/privacy}","received_events_url":"https://api.github.com/users/chemicalkosek/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":4279919987,"node_id":"LA_kwDOBC3Cis7_GmVz","url":"https://api.github.com/repos/vercel/next.js/labels/Runtime","name":"Runtime","color":"f81ce5","default":false,"description":"Related to Node.js or Edge Runtime with Next.js."},{"id":4862060773,"node_id":"LA_kwDOBC3Cis8AAAABIc0o5Q","url":"https://api.github.com/repos/vercel/next.js/labels/Pages%20Router","name":"Pages Router","color":"D63F85","default":false,"description":"Related to Pages Router."},{"id":4932840687,"node_id":"LA_kwDOBC3Cis8AAAABJgUs7w","url":"https://api.github.com/repos/vercel/next.js/labels/linear:%20next","name":"linear: next","color":"A53EF5","default":false,"description":"Confirmed issue that is tracked by the Next.js team."},{"id":5721224978,"node_id":"LA_kwDOBC3Cis8AAAABVQL3Eg","url":"https://api.github.com/repos/vercel/next.js/labels/locked","name":"locked","color":"ededed","default":false,"description":null}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2024-12-29T11:06:04Z","updated_at":"2025-03-18T00:05:39Z","closed_at":"2025-03-03T17:33:10Z","author_association":"CONTRIBUTOR","type":{"id":1930995,"node_id":"IT_kwDOAOSnPM4AHXbz","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-25T15:36:35Z","updated_at":"2024-07-26T10:33:22Z","is_enabled":true},"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Link to the code that reproduces this issue\r\n\r\nhttps://github.com/chemicalkosek/og-reproduction\r\n\r\n### To Reproduce\r\n\r\n1. Start the app in dev mode `npm run dev`\r\n2. Visit http://localhost:3000/api/og\r\n3. See error:\r\n```bash\r\n тип Error [TypeError]: fetch failed\r\n    at handler (pages/api/og.js:11:25)\r\n   9 |\r\n  10 | export default async function handler() {\r\n> 11 |   const fontData = await fetch(\r\n     |                         ^\r\n  12 |     new URL('./og/lexend-deca-v21-latin_latin-ext-700.ttf', import.meta.url),\r\n  13 |   ).then((res) => res.arrayBuffer());\r\n  14 |\r\n  ```\r\n\r\n### Current vs. Expected behavior\r\n\r\nCurrent behavior: Og generation fails with a fetch error while importing local file\r\n\r\nExpected behavior: It should generate og with custom font. This is working with Next 14\r\nI didn't see any breaking changes in Next 15 that could cause this.\r\nThe code also comes from the official example: https://vercel.com/guides/using-custom-font\r\n\r\n\r\n### Provide environment information\r\n\r\n```bash\r\nOperating System:\r\n  Platform: linux\r\n  Arch: x64\r\n  Version: #52-Ubuntu SMP PREEMPT_DYNAMIC Thu Dec  5 13:09:44 UTC 2024\r\n  Available memory (MB): 27914\r\n  Available CPU cores: 16\r\nBinaries:\r\n  Node: 22.12.0\r\n  npm: 10.9.0\r\n  Yarn: N/A\r\n  pnpm: N/A\r\nRelevant Packages:\r\n  next: 15.1.1-canary.23 // Latest available version is detected (15.1.1-canary.23).\r\n  eslint-config-next: N/A\r\n  react: 18.3.1\r\n  react-dom: 18.3.1\r\n  typescript: 5.1.3\r\nNext.js Config:\r\n  output: N/A\r\n```\r\n\r\n\r\n### Which area(s) are affected? (Select all that apply)\r\n\r\nPages Router, Runtime\r\n\r\n### Which stage(s) are affected? (Select all that apply)\r\n\r\nnext dev (local), next build (local), next start (local)\r\n\r\n### Additional context\r\n\r\n_No response_","closed_by":{"login":"huozhi","id":4800338,"node_id":"MDQ6VXNlcjQ4MDAzMzg=","avatar_url":"https://avatars.githubusercontent.com/u/4800338?v=4","gravatar_id":"","url":"https://api.github.com/users/huozhi","html_url":"https://github.com/huozhi","followers_url":"https://api.github.com/users/huozhi/followers","following_url":"https://api.github.com/users/huozhi/following{/other_user}","gists_url":"https://api.github.com/users/huozhi/gists{/gist_id}","starred_url":"https://api.github.com/users/huozhi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huozhi/subscriptions","organizations_url":"https://api.github.com/users/huozhi/orgs","repos_url":"https://api.github.com/users/huozhi/repos","events_url":"https://api.github.com/users/huozhi/events{/privacy}","received_events_url":"https://api.github.com/users/huozhi/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vercel/next.js/issues/74385/reactions","total_count":6,"+1":6,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vercel/next.js/issues/74385/timeline","performed_via_github_app":null,"state_reason":"completed"}