{"url":"https://api.github.com/repos/rclone/rclone/issues/7351","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/7351/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/7351/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/7351/events","html_url":"https://github.com/rclone/rclone/issues/7351","id":1928611852,"node_id":"I_kwDOAQ-n5M5y9EgM","number":7351,"title":"rclone hides failure on AWS S3 bucket creation","user":{"login":"saffroy","id":5315884,"node_id":"MDQ6VXNlcjUzMTU4ODQ=","avatar_url":"https://avatars.githubusercontent.com/u/5315884?v=4","gravatar_id":"","url":"https://api.github.com/users/saffroy","html_url":"https://github.com/saffroy","followers_url":"https://api.github.com/users/saffroy/followers","following_url":"https://api.github.com/users/saffroy/following{/other_user}","gists_url":"https://api.github.com/users/saffroy/gists{/gist_id}","starred_url":"https://api.github.com/users/saffroy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/saffroy/subscriptions","organizations_url":"https://api.github.com/users/saffroy/orgs","repos_url":"https://api.github.com/users/saffroy/repos","events_url":"https://api.github.com/users/saffroy/events{/privacy}","received_events_url":"https://api.github.com/users/saffroy/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399005,"node_id":"MDU6TGFiZWw4NjM5OTAwNQ==","url":"https://api.github.com/repos/rclone/rclone/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":314138213,"node_id":"MDU6TGFiZWwzMTQxMzgyMTM=","url":"https://api.github.com/repos/rclone/rclone/labels/Remote:%20S3","name":"Remote: S3","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2023-10-05T15:55:31Z","updated_at":"2023-10-09T17:17:21Z","closed_at":"2023-10-09T17:16:30Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\r\n\r\nWe understand you are having a problem with rclone; we want to help you with that!\r\n\r\n**STOP and READ**\r\n**YOUR POST WILL BE REMOVED IF IT IS LOW QUALITY**:\r\nPlease show the effort you've put into solving the problem and please be specific.\r\nPeople are volunteering their time to help! Low effort posts are not likely to get good answers!\r\n\r\nIf you think you might have found a bug, try to replicate it with the latest beta (or stable).\r\nThe update instructions are available at https://rclone.org/commands/rclone_selfupdate/\r\n\r\nIf you can still replicate it or just got a question then please use the rclone forum:\r\n\r\n    https://forum.rclone.org/\r\n\r\nfor a quick response instead of filing an issue on this repo.\r\n\r\nIf nothing else helps, then please fill in the info below which helps us help you.\r\n\r\n**DO NOT REDACT** any information except passwords/keys/personal info.\r\n\r\nYou should use 3 backticks to begin and end your paste to make it readable.\r\n\r\nMake sure to include a log obtained with '-vv'.\r\n\r\nYou can also use '-vv --log-file bug.log' and a service such as https://pastebin.com or https://gist.github.com/\r\n\r\nThank you\r\n\r\nThe Rclone Developers\r\n\r\n-->\r\n\r\n#### The associated forum post URL from `https://forum.rclone.org`\r\n\r\nNone.\r\n\r\n#### What is the problem you are having with rclone?\r\n\r\nWhen trying to create an Amazon S3 bucket, I get no error when I should get one.\r\n\r\n\r\n#### What is your rclone version (output from `rclone version`)\r\n\r\n```\r\n$ ./rclone selfupdate --beta\r\n2023/10/05 17:23:29 NOTICE: Successfully updated rclone from version v1.64.0 to version v1.65.0-beta.7409.a75256384\r\n\r\n$ ./rclone version \r\nrclone v1.65.0-beta.7409.a75256384\r\n- os/version: debian 12.1 (64 bit)\r\n- os/kernel: 6.1.0-12-amd64 (x86_64)\r\n- os/type: linux\r\n- os/arch: amd64\r\n- go/version: go1.21.1\r\n- go/linking: static\r\n- go/tags: none\r\n```\r\n\r\n#### Which cloud storage system are you using? (e.g. Google Drive)\r\n\r\nAWS S3\r\n\r\n#### The command you were trying to run (e.g. `rclone copy /tmp remote:tmp`)\r\n\r\nI have no bucket named `testtest`, and tried to create one:\r\n```\r\n$ ./rclone lsd s3: |grep test\r\n\r\n$ ./rclone mkdir s3:testtest ; echo $?\r\n0\r\n```\r\n\r\nBut nothing happened:\r\n\r\n```\r\n$ ./rclone lsd s3: |grep test \r\n```\r\n\r\nIt fails silently, actually, despite receiving a 409 HTTP status code:\r\n```\r\n$ ./rclone -vvv --dump headers mkdir s3:testtest\r\n2023/10/05 17:30:53 DEBUG : rclone: Version \"v1.65.0-beta.7409.a75256384\" starting with parameters [\"./rclone\" \"-vvv\" \"--dump\" \"headers\" \"mkdir\" \"s3:testtest\"]\r\n2023/10/05 17:30:53 DEBUG : Creating backend with remote \"s3:testtest\"\r\n2023/10/05 17:30:53 DEBUG : Using config file from \"/home/saffroy/.config/rclone/rclone.conf\"\r\n2023/10/05 17:30:53 DEBUG : You have specified to dump information. Please be noted that the Accept-Encoding as shown may not be correct in the request and the response may not show Content-Encoding if the go standard libraries auto gzip encoding was in effect. In this case the body of the request will be gunzipped before showing it.\r\n2023/10/05 17:30:53 DEBUG : You have specified to dump information. Please be noted that the Accept-Encoding as shown may not be correct in the request and the response may not show Content-Encoding if the go standard libraries auto gzip encoding was in effect. In this case the body of the request will be gunzipped before showing it.\r\n2023/10/05 17:30:53 DEBUG : S3 bucket testtest: Making directory\r\n2023/10/05 17:30:53 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2023/10/05 17:30:53 DEBUG : HTTP REQUEST (req 0xc0005eb900)\r\n2023/10/05 17:30:53 DEBUG : PUT / HTTP/1.1\r\nHost: testtest.s3.eu-west-3.amazonaws.com\r\nUser-Agent: rclone/v1.65.0-beta.7409.a75256384\r\nContent-Length: 153\r\nAuthorization: XXXX\r\nX-Amz-Content-Sha256: a0fa36eb3d33c2b2ff7f36bf054cae8281ee0b23b4309a590595a1817f636196\r\nX-Amz-Date: 20231005T153053Z\r\nAccept-Encoding: gzip\r\n\r\n2023/10/05 17:30:53 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2023/10/05 17:30:54 DEBUG : <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n2023/10/05 17:30:54 DEBUG : HTTP RESPONSE (req 0xc0005eb900)\r\n2023/10/05 17:30:54 DEBUG : HTTP/1.1 409 Conflict\r\nTransfer-Encoding: chunked\r\nContent-Type: application/xml\r\nDate: Thu, 05 Oct 2023 15:30:53 GMT\r\nServer: AmazonS3\r\nX-Amz-Bucket-Region: us-east-1\r\nX-Amz-Id-2: [REDACTED]\r\nX-Amz-Request-Id: JAA1SES5NBR4VTPT\r\n\r\n2023/10/05 17:30:54 DEBUG : <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n2023/10/05 17:30:54 DEBUG : 6 go routines active\r\n```\r\n\r\nThe reason for the error is this oddity:\r\n\r\n> The following rules apply for naming buckets in Amazon S3:\r\n> ...\r\n> A bucket name cannot be used by another AWS account in the same partition until the bucket is deleted.\r\n\r\nSource https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucketnamingrules.html\r\n\r\nCreation of a bucket with a unique name does work, so it is not a configuration issue:\r\n```\r\n$ ./rclone lsd s3: |grep test\r\n$ ./rclone mkdir s3:test-$RANDOM\r\n$ ./rclone lsd s3: |grep test\r\n          -1 2023-10-05 17:51:52        -1 test-19842\r\n```\r\n\r\nA different tool gave an error, and a very helpful one:\r\n\r\n```\r\n$ s3cmd mb s3://testtest\r\nERROR: Bucket 'testtest' already exists\r\nERROR: S3 error: 409 (BucketAlreadyExists): The requested bucket name is not available. The bucket namespace is shared by all users of the system. Please select a different name and try again.\r\n\r\n$ echo $?\r\n13\r\n```\r\n","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/7351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/7351/timeline","performed_via_github_app":null,"state_reason":"completed"}