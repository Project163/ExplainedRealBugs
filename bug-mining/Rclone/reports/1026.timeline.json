[{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1016442699","html_url":"https://github.com/rclone/rclone/issues/5929#issuecomment-1016442699","issue_url":"https://api.github.com/repos/rclone/rclone/issues/5929","id":1016442699,"node_id":"IC_kwDOAQ-n5M48la9L","user":{"login":"animosity022","id":5088712,"node_id":"MDQ6VXNlcjUwODg3MTI=","avatar_url":"https://avatars.githubusercontent.com/u/5088712?v=4","gravatar_id":"","url":"https://api.github.com/users/animosity022","html_url":"https://github.com/animosity022","followers_url":"https://api.github.com/users/animosity022/followers","following_url":"https://api.github.com/users/animosity022/following{/other_user}","gists_url":"https://api.github.com/users/animosity022/gists{/gist_id}","starred_url":"https://api.github.com/users/animosity022/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/animosity022/subscriptions","organizations_url":"https://api.github.com/users/animosity022/orgs","repos_url":"https://api.github.com/users/animosity022/repos","events_url":"https://api.github.com/users/animosity022/events{/privacy}","received_events_url":"https://api.github.com/users/animosity022/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T13:00:22Z","updated_at":"2022-01-19T13:00:22Z","body":"If the goal is to solve it, you need to provide a way to produce the issue with a debug log.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1016442699/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"animosity022","id":5088712,"node_id":"MDQ6VXNlcjUwODg3MTI=","avatar_url":"https://avatars.githubusercontent.com/u/5088712?v=4","gravatar_id":"","url":"https://api.github.com/users/animosity022","html_url":"https://github.com/animosity022","followers_url":"https://api.github.com/users/animosity022/followers","following_url":"https://api.github.com/users/animosity022/following{/other_user}","gists_url":"https://api.github.com/users/animosity022/gists{/gist_id}","starred_url":"https://api.github.com/users/animosity022/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/animosity022/subscriptions","organizations_url":"https://api.github.com/users/animosity022/orgs","repos_url":"https://api.github.com/users/animosity022/repos","events_url":"https://api.github.com/users/animosity022/events{/privacy}","received_events_url":"https://api.github.com/users/animosity022/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1016458899","html_url":"https://github.com/rclone/rclone/issues/5929#issuecomment-1016458899","issue_url":"https://api.github.com/repos/rclone/rclone/issues/5929","id":1016458899,"node_id":"IC_kwDOAQ-n5M48le6T","user":{"login":"sagiegurari","id":8112599,"node_id":"MDQ6VXNlcjgxMTI1OTk=","avatar_url":"https://avatars.githubusercontent.com/u/8112599?v=4","gravatar_id":"","url":"https://api.github.com/users/sagiegurari","html_url":"https://github.com/sagiegurari","followers_url":"https://api.github.com/users/sagiegurari/followers","following_url":"https://api.github.com/users/sagiegurari/following{/other_user}","gists_url":"https://api.github.com/users/sagiegurari/gists{/gist_id}","starred_url":"https://api.github.com/users/sagiegurari/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sagiegurari/subscriptions","organizations_url":"https://api.github.com/users/sagiegurari/orgs","repos_url":"https://api.github.com/users/sagiegurari/repos","events_url":"https://api.github.com/users/sagiegurari/events{/privacy}","received_events_url":"https://api.github.com/users/sagiegurari/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T13:19:53Z","updated_at":"2022-01-19T13:19:53Z","body":"The issue was that my personal nginx had some access control and in addition only allowed for get/post and didn't allow head that caused the head to get rejected.\r\ni fixed my nginx and now rclone works fine for me and i don't need a fix.\r\n\r\nhowever, i decided to report the issue so you can find the bug in rclone to make rclone better.\r\n\r\nbasically you can try to put a simple php server and if head request return a 403 not allowed.\r\notherwise return the file.\r\nthan run rclone copy on that with request to copy a file (not dir) like /file.txt and you will see that if head fails, the get that comes afterwards gets messed up and becomes /file.txt/ (extra /).\r\n\r\nif its not critical for you, you can close the issue. ","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1016458899/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sagiegurari","id":8112599,"node_id":"MDQ6VXNlcjgxMTI1OTk=","avatar_url":"https://avatars.githubusercontent.com/u/8112599?v=4","gravatar_id":"","url":"https://api.github.com/users/sagiegurari","html_url":"https://github.com/sagiegurari","followers_url":"https://api.github.com/users/sagiegurari/followers","following_url":"https://api.github.com/users/sagiegurari/following{/other_user}","gists_url":"https://api.github.com/users/sagiegurari/gists{/gist_id}","starred_url":"https://api.github.com/users/sagiegurari/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sagiegurari/subscriptions","organizations_url":"https://api.github.com/users/sagiegurari/orgs","repos_url":"https://api.github.com/users/sagiegurari/repos","events_url":"https://api.github.com/users/sagiegurari/events{/privacy}","received_events_url":"https://api.github.com/users/sagiegurari/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1016462633","html_url":"https://github.com/rclone/rclone/issues/5929#issuecomment-1016462633","issue_url":"https://api.github.com/repos/rclone/rclone/issues/5929","id":1016462633,"node_id":"IC_kwDOAQ-n5M48lf0p","user":{"login":"animosity022","id":5088712,"node_id":"MDQ6VXNlcjUwODg3MTI=","avatar_url":"https://avatars.githubusercontent.com/u/5088712?v=4","gravatar_id":"","url":"https://api.github.com/users/animosity022","html_url":"https://github.com/animosity022","followers_url":"https://api.github.com/users/animosity022/followers","following_url":"https://api.github.com/users/animosity022/following{/other_user}","gists_url":"https://api.github.com/users/animosity022/gists{/gist_id}","starred_url":"https://api.github.com/users/animosity022/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/animosity022/subscriptions","organizations_url":"https://api.github.com/users/animosity022/orgs","repos_url":"https://api.github.com/users/animosity022/repos","events_url":"https://api.github.com/users/animosity022/events{/privacy}","received_events_url":"https://api.github.com/users/animosity022/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T13:24:12Z","updated_at":"2022-01-19T13:24:12Z","body":"Without steps to reproduce an issue, there's no way to fix it.\r\n\r\nHardly any issue ever reported it critical for me as that's not the point as it's important to you and if you want a fix, I'm trying to collect the information to make a fix possible.\r\n\r\nThere's already:\r\n\r\nhttps://rclone.org/http/#http-no-slash\r\n\r\nhttps://rclone.org/http/#http-no-head\r\n\r\nIf it's fixed for you, feel free to close the issue out.\r\n\r\nIf not, share the steps and commands on how to reproduce the problem with some logs.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1016462633/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"animosity022","id":5088712,"node_id":"MDQ6VXNlcjUwODg3MTI=","avatar_url":"https://avatars.githubusercontent.com/u/5088712?v=4","gravatar_id":"","url":"https://api.github.com/users/animosity022","html_url":"https://github.com/animosity022","followers_url":"https://api.github.com/users/animosity022/followers","following_url":"https://api.github.com/users/animosity022/following{/other_user}","gists_url":"https://api.github.com/users/animosity022/gists{/gist_id}","starred_url":"https://api.github.com/users/animosity022/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/animosity022/subscriptions","organizations_url":"https://api.github.com/users/animosity022/orgs","repos_url":"https://api.github.com/users/animosity022/repos","events_url":"https://api.github.com/users/animosity022/events{/privacy}","received_events_url":"https://api.github.com/users/animosity022/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1016464214","html_url":"https://github.com/rclone/rclone/issues/5929#issuecomment-1016464214","issue_url":"https://api.github.com/repos/rclone/rclone/issues/5929","id":1016464214,"node_id":"IC_kwDOAQ-n5M48lgNW","user":{"login":"sagiegurari","id":8112599,"node_id":"MDQ6VXNlcjgxMTI1OTk=","avatar_url":"https://avatars.githubusercontent.com/u/8112599?v=4","gravatar_id":"","url":"https://api.github.com/users/sagiegurari","html_url":"https://github.com/sagiegurari","followers_url":"https://api.github.com/users/sagiegurari/followers","following_url":"https://api.github.com/users/sagiegurari/following{/other_user}","gists_url":"https://api.github.com/users/sagiegurari/gists{/gist_id}","starred_url":"https://api.github.com/users/sagiegurari/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sagiegurari/subscriptions","organizations_url":"https://api.github.com/users/sagiegurari/orgs","repos_url":"https://api.github.com/users/sagiegurari/repos","events_url":"https://api.github.com/users/sagiegurari/events{/privacy}","received_events_url":"https://api.github.com/users/sagiegurari/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T13:26:03Z","updated_at":"2022-01-19T13:26:03Z","body":"tried both params actually. both didn't do anything to resolve this.\r\ni think the no head is only for directly list command and is ignored by copy command (too bad).\r\n\r\ni can try to setup some test case so you can run and repo","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1016464214/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sagiegurari","id":8112599,"node_id":"MDQ6VXNlcjgxMTI1OTk=","avatar_url":"https://avatars.githubusercontent.com/u/8112599?v=4","gravatar_id":"","url":"https://api.github.com/users/sagiegurari","html_url":"https://github.com/sagiegurari","followers_url":"https://api.github.com/users/sagiegurari/followers","following_url":"https://api.github.com/users/sagiegurari/following{/other_user}","gists_url":"https://api.github.com/users/sagiegurari/gists{/gist_id}","starred_url":"https://api.github.com/users/sagiegurari/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sagiegurari/subscriptions","organizations_url":"https://api.github.com/users/sagiegurari/orgs","repos_url":"https://api.github.com/users/sagiegurari/repos","events_url":"https://api.github.com/users/sagiegurari/events{/privacy}","received_events_url":"https://api.github.com/users/sagiegurari/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1016467709","html_url":"https://github.com/rclone/rclone/issues/5929#issuecomment-1016467709","issue_url":"https://api.github.com/repos/rclone/rclone/issues/5929","id":1016467709,"node_id":"IC_kwDOAQ-n5M48lhD9","user":{"login":"animosity022","id":5088712,"node_id":"MDQ6VXNlcjUwODg3MTI=","avatar_url":"https://avatars.githubusercontent.com/u/5088712?v=4","gravatar_id":"","url":"https://api.github.com/users/animosity022","html_url":"https://github.com/animosity022","followers_url":"https://api.github.com/users/animosity022/followers","following_url":"https://api.github.com/users/animosity022/following{/other_user}","gists_url":"https://api.github.com/users/animosity022/gists{/gist_id}","starred_url":"https://api.github.com/users/animosity022/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/animosity022/subscriptions","organizations_url":"https://api.github.com/users/animosity022/orgs","repos_url":"https://api.github.com/users/animosity022/repos","events_url":"https://api.github.com/users/animosity022/events{/privacy}","received_events_url":"https://api.github.com/users/animosity022/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T13:30:21Z","updated_at":"2022-01-19T13:30:21Z","body":"That would be perfect, basically my goal is to give a nice package to the folks that can actually fix it so they spend the time fixing the bug/defect/item and less time collecting. I just push papers and sadly don't program :)\r\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1016467709/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"animosity022","id":5088712,"node_id":"MDQ6VXNlcjUwODg3MTI=","avatar_url":"https://avatars.githubusercontent.com/u/5088712?v=4","gravatar_id":"","url":"https://api.github.com/users/animosity022","html_url":"https://github.com/animosity022","followers_url":"https://api.github.com/users/animosity022/followers","following_url":"https://api.github.com/users/animosity022/following{/other_user}","gists_url":"https://api.github.com/users/animosity022/gists{/gist_id}","starred_url":"https://api.github.com/users/animosity022/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/animosity022/subscriptions","organizations_url":"https://api.github.com/users/animosity022/orgs","repos_url":"https://api.github.com/users/animosity022/repos","events_url":"https://api.github.com/users/animosity022/events{/privacy}","received_events_url":"https://api.github.com/users/animosity022/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":5917714621,"node_id":"LE_lADOAQ-n5M5CCOwOzwAAAAFguSi9","url":"https://api.github.com/repos/rclone/rclone/issues/events/5917714621","actor":{"login":"animosity022","id":5088712,"node_id":"MDQ6VXNlcjUwODg3MTI=","avatar_url":"https://avatars.githubusercontent.com/u/5088712?v=4","gravatar_id":"","url":"https://api.github.com/users/animosity022","html_url":"https://github.com/animosity022","followers_url":"https://api.github.com/users/animosity022/followers","following_url":"https://api.github.com/users/animosity022/following{/other_user}","gists_url":"https://api.github.com/users/animosity022/gists{/gist_id}","starred_url":"https://api.github.com/users/animosity022/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/animosity022/subscriptions","organizations_url":"https://api.github.com/users/animosity022/orgs","repos_url":"https://api.github.com/users/animosity022/repos","events_url":"https://api.github.com/users/animosity022/events{/privacy}","received_events_url":"https://api.github.com/users/animosity022/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-01-19T13:30:32Z","label":{"name":"bug","color":"fc2929"},"performed_via_github_app":null},{"id":5917714625,"node_id":"LE_lADOAQ-n5M5CCOwOzwAAAAFguSjB","url":"https://api.github.com/repos/rclone/rclone/issues/events/5917714625","actor":{"login":"animosity022","id":5088712,"node_id":"MDQ6VXNlcjUwODg3MTI=","avatar_url":"https://avatars.githubusercontent.com/u/5088712?v=4","gravatar_id":"","url":"https://api.github.com/users/animosity022","html_url":"https://github.com/animosity022","followers_url":"https://api.github.com/users/animosity022/followers","following_url":"https://api.github.com/users/animosity022/following{/other_user}","gists_url":"https://api.github.com/users/animosity022/gists{/gist_id}","starred_url":"https://api.github.com/users/animosity022/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/animosity022/subscriptions","organizations_url":"https://api.github.com/users/animosity022/orgs","repos_url":"https://api.github.com/users/animosity022/repos","events_url":"https://api.github.com/users/animosity022/events{/privacy}","received_events_url":"https://api.github.com/users/animosity022/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-01-19T13:30:32Z","label":{"name":"Remote: HTTP","color":"fbca04"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1016628444","html_url":"https://github.com/rclone/rclone/issues/5929#issuecomment-1016628444","issue_url":"https://api.github.com/repos/rclone/rclone/issues/5929","id":1016628444,"node_id":"IC_kwDOAQ-n5M48mITc","user":{"login":"sagiegurari","id":8112599,"node_id":"MDQ6VXNlcjgxMTI1OTk=","avatar_url":"https://avatars.githubusercontent.com/u/8112599?v=4","gravatar_id":"","url":"https://api.github.com/users/sagiegurari","html_url":"https://github.com/sagiegurari","followers_url":"https://api.github.com/users/sagiegurari/followers","following_url":"https://api.github.com/users/sagiegurari/following{/other_user}","gists_url":"https://api.github.com/users/sagiegurari/gists{/gist_id}","starred_url":"https://api.github.com/users/sagiegurari/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sagiegurari/subscriptions","organizations_url":"https://api.github.com/users/sagiegurari/orgs","repos_url":"https://api.github.com/users/sagiegurari/repos","events_url":"https://api.github.com/users/sagiegurari/events{/privacy}","received_events_url":"https://api.github.com/users/sagiegurari/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T16:15:28Z","updated_at":"2022-01-19T16:15:28Z","body":"ok so very simple test case\r\n\r\n1. create simple txt file to serve, let's call it test.txt\r\n2. create php file router.php\r\n```\r\n<?php\r\nif ($_SERVER['REQUEST_METHOD'] === 'HEAD') {\r\n    http_response_code(403);\r\n} else {\r\n    return false;\r\n}\r\n?>\r\n```\r\n\r\n3. start php server as follows:\r\n```\r\nphp -S 0.0.0.0:5555 -t ./ ./router.php\r\n```\r\nThis will start a php server that serves all local files.\r\n\r\n4. create target dir and check php serves the test file correctly (using wget)\r\n```\r\nmkdir -p ./target/\r\n\r\ncd ./target\r\nwget http://localhost:5555/test.txt\r\ncat ./test.txt\r\nrm ./test.txt\r\ncd -\r\n```\r\n\r\n5. run rclone\r\n```\r\nrclone copy --http-url=http://localhost:5555/ :http:test.txt ./target/\r\n```\r\n\r\nit fails.\r\nif you remove the HEAD condition and basically it won't return 403 on HEAD, rclone works well.\r\n\r\n```\r\n022/01/19 16:14:30 DEBUG : rclone: Version \"v1.57.0\" starting with parameters [\"rclone\" \"copy\" \"--http-url=http://localhost:5555/\" \":http:test.txt\" \"./target/\" \"-vv\"]\r\n2022/01/19 16:14:30 DEBUG : Creating backend with remote \":http:test.txt\"\r\n2022/01/19 16:14:30 DEBUG : :http: detected overridden config - adding \"{Od1Cq}\" suffix to name\r\n2022/01/19 16:14:30 NOTICE: Config file \"/home/gitpod/.config/rclone/rclone.conf\" not found - using defaults\r\n2022/01/19 16:14:30 DEBUG : fs cache: renaming cache item \":http:test.txt\" to be canonical \":http{Od1Cq}:test.txt\"\r\n2022/01/19 16:14:30 DEBUG : Creating backend with remote \"./target/\"\r\n2022/01/19 16:14:30 DEBUG : fs cache: renaming cache item \"./target/\" to be canonical \"/workspace/misc-test/target\"\r\n2022/01/19 16:14:30 ERROR : http://localhost:5555/test.txt/: error reading source root directory: error listing \"\": Can't parse content type \"text/plain\"\r\n2022/01/19 16:14:30 DEBUG : Local file system at /workspace/misc-test/target: Waiting for checks to finish\r\n2022/01/19 16:14:30 DEBUG : Local file system at /workspace/misc-test/target: Waiting for transfers to finish\r\n2022/01/19 16:14:30 ERROR : Attempt 1/3 failed with 1 errors and: error listing \"\": Can't parse content type \"text/plain\"\r\n2022/01/19 16:14:30 ERROR : http://localhost:5555/test.txt/: error reading source root directory: error listing \"\": Can't parse content type \"text/plain\"\r\n2022/01/19 16:14:30 DEBUG : Local file system at /workspace/misc-test/target: Waiting for checks to finish\r\n2022/01/19 16:14:30 DEBUG : Local file system at /workspace/misc-test/target: Waiting for transfers to finish\r\n2022/01/19 16:14:30 ERROR : Attempt 2/3 failed with 1 errors and: error listing \"\": Can't parse content type \"text/plain\"\r\n2022/01/19 16:14:30 ERROR : http://localhost:5555/test.txt/: error reading source root directory: error listing \"\": Can't parse content type \"text/plain\"\r\n2022/01/19 16:14:30 DEBUG : Local file system at /workspace/misc-test/target: Waiting for checks to finish\r\n2022/01/19 16:14:30 DEBUG : Local file system at /workspace/misc-test/target: Waiting for transfers to finish\r\n2022/01/19 16:14:30 ERROR : Attempt 3/3 failed with 1 errors and: error listing \"\": Can't parse content type \"text/plain\"\r\n2022/01/19 16:14:30 INFO  : \r\nTransferred:              0 B / 0 B, -, 0 B/s, ETA -\r\nErrors:                 1 (retrying may help)\r\nElapsed time:         0.0s\r\n\r\n2022/01/19 16:14:30 DEBUG : 3 go routines active\r\n2022/01/19 16:14:30 Failed to copy: error listing \"\": Can't parse content type \"text/plain\"\r\n```","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1016628444/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sagiegurari","id":8112599,"node_id":"MDQ6VXNlcjgxMTI1OTk=","avatar_url":"https://avatars.githubusercontent.com/u/8112599?v=4","gravatar_id":"","url":"https://api.github.com/users/sagiegurari","html_url":"https://github.com/sagiegurari","followers_url":"https://api.github.com/users/sagiegurari/followers","following_url":"https://api.github.com/users/sagiegurari/following{/other_user}","gists_url":"https://api.github.com/users/sagiegurari/gists{/gist_id}","starred_url":"https://api.github.com/users/sagiegurari/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sagiegurari/subscriptions","organizations_url":"https://api.github.com/users/sagiegurari/orgs","repos_url":"https://api.github.com/users/sagiegurari/repos","events_url":"https://api.github.com/users/sagiegurari/events{/privacy}","received_events_url":"https://api.github.com/users/sagiegurari/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1016806181","html_url":"https://github.com/rclone/rclone/issues/5929#issuecomment-1016806181","issue_url":"https://api.github.com/repos/rclone/rclone/issues/5929","id":1016806181,"node_id":"IC_kwDOAQ-n5M48mzsl","user":{"login":"albertony","id":12441419,"node_id":"MDQ6VXNlcjEyNDQxNDE5","avatar_url":"https://avatars.githubusercontent.com/u/12441419?v=4","gravatar_id":"","url":"https://api.github.com/users/albertony","html_url":"https://github.com/albertony","followers_url":"https://api.github.com/users/albertony/followers","following_url":"https://api.github.com/users/albertony/following{/other_user}","gists_url":"https://api.github.com/users/albertony/gists{/gist_id}","starred_url":"https://api.github.com/users/albertony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertony/subscriptions","organizations_url":"https://api.github.com/users/albertony/orgs","repos_url":"https://api.github.com/users/albertony/repos","events_url":"https://api.github.com/users/albertony/events{/privacy}","received_events_url":"https://api.github.com/users/albertony/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T19:40:41Z","updated_at":"2022-01-19T19:40:41Z","body":"Great bug report! ðŸ‘ \r\n\r\nThe problem is in the backend initialization, where it is trying to classify the path given on command line. Without much experience in this part of the code, I think the case is that it cannot in general trust the user to always use suffix \"/\" when specifying directories, and therefore issues a HEAD request to find out. Don't know how to work around when the HEAD request fails.. Add option to let user specify? Issue a GET instead? Assume lack of suffix \"/\" indicates file? Don't know...\r\n\r\nhttps://github.com/rclone/rclone/blob/c504d970174a604a39fdb2b2d1c51f2ca34ab31d/backend/http/http.go#L171-L199","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1016806181/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"albertony","id":12441419,"node_id":"MDQ6VXNlcjEyNDQxNDE5","avatar_url":"https://avatars.githubusercontent.com/u/12441419?v=4","gravatar_id":"","url":"https://api.github.com/users/albertony","html_url":"https://github.com/albertony","followers_url":"https://api.github.com/users/albertony/followers","following_url":"https://api.github.com/users/albertony/following{/other_user}","gists_url":"https://api.github.com/users/albertony/gists{/gist_id}","starred_url":"https://api.github.com/users/albertony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertony/subscriptions","organizations_url":"https://api.github.com/users/albertony/orgs","repos_url":"https://api.github.com/users/albertony/repos","events_url":"https://api.github.com/users/albertony/events{/privacy}","received_events_url":"https://api.github.com/users/albertony/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1016919073","html_url":"https://github.com/rclone/rclone/issues/5929#issuecomment-1016919073","issue_url":"https://api.github.com/repos/rclone/rclone/issues/5929","id":1016919073,"node_id":"IC_kwDOAQ-n5M48nPQh","user":{"login":"albertony","id":12441419,"node_id":"MDQ6VXNlcjEyNDQxNDE5","avatar_url":"https://avatars.githubusercontent.com/u/12441419?v=4","gravatar_id":"","url":"https://api.github.com/users/albertony","html_url":"https://github.com/albertony","followers_url":"https://api.github.com/users/albertony/followers","following_url":"https://api.github.com/users/albertony/following{/other_user}","gists_url":"https://api.github.com/users/albertony/gists{/gist_id}","starred_url":"https://api.github.com/users/albertony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertony/subscriptions","organizations_url":"https://api.github.com/users/albertony/orgs","repos_url":"https://api.github.com/users/albertony/repos","events_url":"https://api.github.com/users/albertony/events{/privacy}","received_events_url":"https://api.github.com/users/albertony/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T22:10:37Z","updated_at":"2022-01-19T22:10:37Z","body":"@sagiegurari I guess a workaround would be to specify a directory path (which matches the default assumption when head request fails), and then use filtering to pick the file instead.\r\n\r\nE.g. instead of:\r\n```\r\nrclone copy --http-url=http://localhost:5555/ :http:test.txt ./target/\r\n```\r\nThen:\r\n```\r\nrclone copy --http-url=http://localhost:5555/ :http: ./target/ --include /test.txt\r\n```","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1016919073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"albertony","id":12441419,"node_id":"MDQ6VXNlcjEyNDQxNDE5","avatar_url":"https://avatars.githubusercontent.com/u/12441419?v=4","gravatar_id":"","url":"https://api.github.com/users/albertony","html_url":"https://github.com/albertony","followers_url":"https://api.github.com/users/albertony/followers","following_url":"https://api.github.com/users/albertony/following{/other_user}","gists_url":"https://api.github.com/users/albertony/gists{/gist_id}","starred_url":"https://api.github.com/users/albertony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertony/subscriptions","organizations_url":"https://api.github.com/users/albertony/orgs","repos_url":"https://api.github.com/users/albertony/repos","events_url":"https://api.github.com/users/albertony/events{/privacy}","received_events_url":"https://api.github.com/users/albertony/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":5920823789,"node_id":"MEE_lADOAQ-n5M5CCOwOzwAAAAFg6Jnt","url":"https://api.github.com/repos/rclone/rclone/issues/events/5920823789","actor":{"login":"sagiegurari","id":8112599,"node_id":"MDQ6VXNlcjgxMTI1OTk=","avatar_url":"https://avatars.githubusercontent.com/u/8112599?v=4","gravatar_id":"","url":"https://api.github.com/users/sagiegurari","html_url":"https://github.com/sagiegurari","followers_url":"https://api.github.com/users/sagiegurari/followers","following_url":"https://api.github.com/users/sagiegurari/following{/other_user}","gists_url":"https://api.github.com/users/sagiegurari/gists{/gist_id}","starred_url":"https://api.github.com/users/sagiegurari/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sagiegurari/subscriptions","organizations_url":"https://api.github.com/users/sagiegurari/orgs","repos_url":"https://api.github.com/users/sagiegurari/repos","events_url":"https://api.github.com/users/sagiegurari/events{/privacy}","received_events_url":"https://api.github.com/users/sagiegurari/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-01-19T22:10:38Z","performed_via_github_app":null},{"id":5920823798,"node_id":"SE_lADOAQ-n5M5CCOwOzwAAAAFg6Jn2","url":"https://api.github.com/repos/rclone/rclone/issues/events/5920823798","actor":{"login":"sagiegurari","id":8112599,"node_id":"MDQ6VXNlcjgxMTI1OTk=","avatar_url":"https://avatars.githubusercontent.com/u/8112599?v=4","gravatar_id":"","url":"https://api.github.com/users/sagiegurari","html_url":"https://github.com/sagiegurari","followers_url":"https://api.github.com/users/sagiegurari/followers","following_url":"https://api.github.com/users/sagiegurari/following{/other_user}","gists_url":"https://api.github.com/users/sagiegurari/gists{/gist_id}","starred_url":"https://api.github.com/users/sagiegurari/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sagiegurari/subscriptions","organizations_url":"https://api.github.com/users/sagiegurari/orgs","repos_url":"https://api.github.com/users/sagiegurari/repos","events_url":"https://api.github.com/users/sagiegurari/events{/privacy}","received_events_url":"https://api.github.com/users/sagiegurari/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-01-19T22:10:38Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1016941063","html_url":"https://github.com/rclone/rclone/issues/5929#issuecomment-1016941063","issue_url":"https://api.github.com/repos/rclone/rclone/issues/5929","id":1016941063,"node_id":"IC_kwDOAQ-n5M48nUoH","user":{"login":"sagiegurari","id":8112599,"node_id":"MDQ6VXNlcjgxMTI1OTk=","avatar_url":"https://avatars.githubusercontent.com/u/8112599?v=4","gravatar_id":"","url":"https://api.github.com/users/sagiegurari","html_url":"https://github.com/sagiegurari","followers_url":"https://api.github.com/users/sagiegurari/followers","following_url":"https://api.github.com/users/sagiegurari/following{/other_user}","gists_url":"https://api.github.com/users/sagiegurari/gists{/gist_id}","starred_url":"https://api.github.com/users/sagiegurari/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sagiegurari/subscriptions","organizations_url":"https://api.github.com/users/sagiegurari/orgs","repos_url":"https://api.github.com/users/sagiegurari/repos","events_url":"https://api.github.com/users/sagiegurari/events{/privacy}","received_events_url":"https://api.github.com/users/sagiegurari/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T22:46:17Z","updated_at":"2022-01-19T22:46:17Z","body":"nice. wasn't aware of include param","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1016941063/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sagiegurari","id":8112599,"node_id":"MDQ6VXNlcjgxMTI1OTk=","avatar_url":"https://avatars.githubusercontent.com/u/8112599?v=4","gravatar_id":"","url":"https://api.github.com/users/sagiegurari","html_url":"https://github.com/sagiegurari","followers_url":"https://api.github.com/users/sagiegurari/followers","following_url":"https://api.github.com/users/sagiegurari/following{/other_user}","gists_url":"https://api.github.com/users/sagiegurari/gists{/gist_id}","starred_url":"https://api.github.com/users/sagiegurari/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sagiegurari/subscriptions","organizations_url":"https://api.github.com/users/sagiegurari/orgs","repos_url":"https://api.github.com/users/sagiegurari/repos","events_url":"https://api.github.com/users/sagiegurari/events{/privacy}","received_events_url":"https://api.github.com/users/sagiegurari/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1017458642","html_url":"https://github.com/rclone/rclone/issues/5929#issuecomment-1017458642","issue_url":"https://api.github.com/repos/rclone/rclone/issues/5929","id":1017458642,"node_id":"IC_kwDOAQ-n5M48pS_S","user":{"login":"albertony","id":12441419,"node_id":"MDQ6VXNlcjEyNDQxNDE5","avatar_url":"https://avatars.githubusercontent.com/u/12441419?v=4","gravatar_id":"","url":"https://api.github.com/users/albertony","html_url":"https://github.com/albertony","followers_url":"https://api.github.com/users/albertony/followers","following_url":"https://api.github.com/users/albertony/following{/other_user}","gists_url":"https://api.github.com/users/albertony/gists{/gist_id}","starred_url":"https://api.github.com/users/albertony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertony/subscriptions","organizations_url":"https://api.github.com/users/albertony/orgs","repos_url":"https://api.github.com/users/albertony/repos","events_url":"https://api.github.com/users/albertony/events{/privacy}","received_events_url":"https://api.github.com/users/albertony/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T12:38:59Z","updated_at":"2022-01-20T12:38:59Z","body":"Just for the record, a second workaround mentioned in the forum: \r\n\r\n> You might be better off using\r\n> \r\n> rclone copyurl https://somedomain.com//path/subpath/myfile.txt myfile.txt\r\n> This just does a single GET request.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1017458642/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"albertony","id":12441419,"node_id":"MDQ6VXNlcjEyNDQxNDE5","avatar_url":"https://avatars.githubusercontent.com/u/12441419?v=4","gravatar_id":"","url":"https://api.github.com/users/albertony","html_url":"https://github.com/albertony","followers_url":"https://api.github.com/users/albertony/followers","following_url":"https://api.github.com/users/albertony/following{/other_user}","gists_url":"https://api.github.com/users/albertony/gists{/gist_id}","starred_url":"https://api.github.com/users/albertony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertony/subscriptions","organizations_url":"https://api.github.com/users/albertony/orgs","repos_url":"https://api.github.com/users/albertony/repos","events_url":"https://api.github.com/users/albertony/events{/privacy}","received_events_url":"https://api.github.com/users/albertony/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1017687505","html_url":"https://github.com/rclone/rclone/issues/5929#issuecomment-1017687505","issue_url":"https://api.github.com/repos/rclone/rclone/issues/5929","id":1017687505,"node_id":"IC_kwDOAQ-n5M48qK3R","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T16:29:47Z","updated_at":"2022-01-20T16:29:47Z","body":"> The problem is in the backend initialization, where it is trying to classify the path given on command line.  Without much experience in this part of the code, I think the case is that it cannot in general trust the user to always use suffix \"/\" when specifying directories, and therefore issues a HEAD request to find out. \r\n\r\nYou are 100% correct :-)\r\n\r\n> Don't know how to work around when the HEAD request fails.. Add option to let user specify? Issue a GET instead? Assume lack of suffix \"/\" indicates file? Don't know...\r\n> \r\n> https://github.com/rclone/rclone/blob/c504d970174a604a39fdb2b2d1c51f2ca34ab31d/backend/http/http.go#L171-L199\r\n\r\nProbably what we should do is look at the result of the HEAD request a bit more carefully.\r\n\r\nHow about this\r\n\r\nIssue HEAD request\r\n- if no error assume root is a file\r\n- if 404 error assume root is a directory and add /\r\n- if some sort of redirect 301,302,303,307,308 check the `Location:` header\r\n    - if it ends with a / then assume root is a directory\r\n    - otherwise assume root is a file\r\n- if any other error then log something like this\r\n    - \"Assuming root is a file as server returned error (%v) on HEAD request. Add a trailing / if it is a directory.\"\r\n    - Assume it is a file\r\n\r\nThat would potentially be a backwards incompatible change if a the HEAD request is returning something other than 404 or a redirect when the file isn't found. I think that is fairly unlikely though and the log message would point it out.\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1017687505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":5938879380,"node_id":"REFE_lADOAQ-n5M5CCOwOzwAAAAFh_BuU","url":"https://api.github.com/repos/rclone/rclone/issues/events/5938879380","actor":{"login":"albertony","id":12441419,"node_id":"MDQ6VXNlcjEyNDQxNDE5","avatar_url":"https://avatars.githubusercontent.com/u/12441419?v=4","gravatar_id":"","url":"https://api.github.com/users/albertony","html_url":"https://github.com/albertony","followers_url":"https://api.github.com/users/albertony/followers","following_url":"https://api.github.com/users/albertony/following{/other_user}","gists_url":"https://api.github.com/users/albertony/gists{/gist_id}","starred_url":"https://api.github.com/users/albertony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertony/subscriptions","organizations_url":"https://api.github.com/users/albertony/orgs","repos_url":"https://api.github.com/users/albertony/repos","events_url":"https://api.github.com/users/albertony/events{/privacy}","received_events_url":"https://api.github.com/users/albertony/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"613f8773d75a8297c4b639468d7e4a440a1ea475","commit_url":"https://api.github.com/repos/albertony/rclone/commits/613f8773d75a8297c4b639468d7e4a440a1ea475","created_at":"2022-01-23T23:22:38Z","performed_via_github_app":null},{"actor":{"login":"albertony","id":12441419,"node_id":"MDQ6VXNlcjEyNDQxNDE5","avatar_url":"https://avatars.githubusercontent.com/u/12441419?v=4","gravatar_id":"","url":"https://api.github.com/users/albertony","html_url":"https://github.com/albertony","followers_url":"https://api.github.com/users/albertony/followers","following_url":"https://api.github.com/users/albertony/following{/other_user}","gists_url":"https://api.github.com/users/albertony/gists{/gist_id}","starred_url":"https://api.github.com/users/albertony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertony/subscriptions","organizations_url":"https://api.github.com/users/albertony/orgs","repos_url":"https://api.github.com/users/albertony/repos","events_url":"https://api.github.com/users/albertony/events{/privacy}","received_events_url":"https://api.github.com/users/albertony/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-23T23:36:34Z","updated_at":"2022-01-23T23:36:34Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/rclone/rclone/issues/5941","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/5941/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/5941/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/5941/events","html_url":"https://github.com/rclone/rclone/pull/5941","id":1112019579,"node_id":"PR_kwDOAQ-n5M4xdq10","number":5941,"title":"http: improved recognition of url pointing to a single file","user":{"login":"albertony","id":12441419,"node_id":"MDQ6VXNlcjEyNDQxNDE5","avatar_url":"https://avatars.githubusercontent.com/u/12441419?v=4","gravatar_id":"","url":"https://api.github.com/users/albertony","html_url":"https://github.com/albertony","followers_url":"https://api.github.com/users/albertony/followers","following_url":"https://api.github.com/users/albertony/following{/other_user}","gists_url":"https://api.github.com/users/albertony/gists{/gist_id}","starred_url":"https://api.github.com/users/albertony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertony/subscriptions","organizations_url":"https://api.github.com/users/albertony/orgs","repos_url":"https://api.github.com/users/albertony/repos","events_url":"https://api.github.com/users/albertony/events{/privacy}","received_events_url":"https://api.github.com/users/albertony/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399005,"node_id":"MDU6TGFiZWw4NjM5OTAwNQ==","url":"https://api.github.com/repos/rclone/rclone/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":657975670,"node_id":"MDU6TGFiZWw2NTc5NzU2NzA=","url":"https://api.github.com/repos/rclone/rclone/labels/Remote:%20HTTP","name":"Remote: HTTP","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"albertony","id":12441419,"node_id":"MDQ6VXNlcjEyNDQxNDE5","avatar_url":"https://avatars.githubusercontent.com/u/12441419?v=4","gravatar_id":"","url":"https://api.github.com/users/albertony","html_url":"https://github.com/albertony","followers_url":"https://api.github.com/users/albertony/followers","following_url":"https://api.github.com/users/albertony/following{/other_user}","gists_url":"https://api.github.com/users/albertony/gists{/gist_id}","starred_url":"https://api.github.com/users/albertony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertony/subscriptions","organizations_url":"https://api.github.com/users/albertony/orgs","repos_url":"https://api.github.com/users/albertony/repos","events_url":"https://api.github.com/users/albertony/events{/privacy}","received_events_url":"https://api.github.com/users/albertony/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"albertony","id":12441419,"node_id":"MDQ6VXNlcjEyNDQxNDE5","avatar_url":"https://avatars.githubusercontent.com/u/12441419?v=4","gravatar_id":"","url":"https://api.github.com/users/albertony","html_url":"https://github.com/albertony","followers_url":"https://api.github.com/users/albertony/followers","following_url":"https://api.github.com/users/albertony/following{/other_user}","gists_url":"https://api.github.com/users/albertony/gists{/gist_id}","starred_url":"https://api.github.com/users/albertony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertony/subscriptions","organizations_url":"https://api.github.com/users/albertony/orgs","repos_url":"https://api.github.com/users/albertony/repos","events_url":"https://api.github.com/users/albertony/events{/privacy}","received_events_url":"https://api.github.com/users/albertony/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":0,"created_at":"2022-01-23T23:36:34Z","updated_at":"2022-01-26T10:41:05Z","closed_at":"2022-01-26T10:41:01Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":17803236,"node_id":"MDEwOlJlcG9zaXRvcnkxNzgwMzIzNg==","name":"rclone","full_name":"rclone/rclone","private":false,"owner":{"login":"rclone","id":24937341,"node_id":"MDEyOk9yZ2FuaXphdGlvbjI0OTM3MzQx","avatar_url":"https://avatars.githubusercontent.com/u/24937341?v=4","gravatar_id":"","url":"https://api.github.com/users/rclone","html_url":"https://github.com/rclone","followers_url":"https://api.github.com/users/rclone/followers","following_url":"https://api.github.com/users/rclone/following{/other_user}","gists_url":"https://api.github.com/users/rclone/gists{/gist_id}","starred_url":"https://api.github.com/users/rclone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rclone/subscriptions","organizations_url":"https://api.github.com/users/rclone/orgs","repos_url":"https://api.github.com/users/rclone/repos","events_url":"https://api.github.com/users/rclone/events{/privacy}","received_events_url":"https://api.github.com/users/rclone/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/rclone/rclone","description":"\"rsync for cloud storage\" - Google Drive, S3, Dropbox, Backblaze B2, One Drive, Swift, Hubic, Wasabi, Google Cloud Storage, Azure Blob, Azure Files, Yandex Files","fork":false,"url":"https://api.github.com/repos/rclone/rclone","forks_url":"https://api.github.com/repos/rclone/rclone/forks","keys_url":"https://api.github.com/repos/rclone/rclone/keys{/key_id}","collaborators_url":"https://api.github.com/repos/rclone/rclone/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/rclone/rclone/teams","hooks_url":"https://api.github.com/repos/rclone/rclone/hooks","issue_events_url":"https://api.github.com/repos/rclone/rclone/issues/events{/number}","events_url":"https://api.github.com/repos/rclone/rclone/events","assignees_url":"https://api.github.com/repos/rclone/rclone/assignees{/user}","branches_url":"https://api.github.com/repos/rclone/rclone/branches{/branch}","tags_url":"https://api.github.com/repos/rclone/rclone/tags","blobs_url":"https://api.github.com/repos/rclone/rclone/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/rclone/rclone/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/rclone/rclone/git/refs{/sha}","trees_url":"https://api.github.com/repos/rclone/rclone/git/trees{/sha}","statuses_url":"https://api.github.com/repos/rclone/rclone/statuses/{sha}","languages_url":"https://api.github.com/repos/rclone/rclone/languages","stargazers_url":"https://api.github.com/repos/rclone/rclone/stargazers","contributors_url":"https://api.github.com/repos/rclone/rclone/contributors","subscribers_url":"https://api.github.com/repos/rclone/rclone/subscribers","subscription_url":"https://api.github.com/repos/rclone/rclone/subscription","commits_url":"https://api.github.com/repos/rclone/rclone/commits{/sha}","git_commits_url":"https://api.github.com/repos/rclone/rclone/git/commits{/sha}","comments_url":"https://api.github.com/repos/rclone/rclone/comments{/number}","issue_comment_url":"https://api.github.com/repos/rclone/rclone/issues/comments{/number}","contents_url":"https://api.github.com/repos/rclone/rclone/contents/{+path}","compare_url":"https://api.github.com/repos/rclone/rclone/compare/{base}...{head}","merges_url":"https://api.github.com/repos/rclone/rclone/merges","archive_url":"https://api.github.com/repos/rclone/rclone/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/rclone/rclone/downloads","issues_url":"https://api.github.com/repos/rclone/rclone/issues{/number}","pulls_url":"https://api.github.com/repos/rclone/rclone/pulls{/number}","milestones_url":"https://api.github.com/repos/rclone/rclone/milestones{/number}","notifications_url":"https://api.github.com/repos/rclone/rclone/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/rclone/rclone/labels{/name}","releases_url":"https://api.github.com/repos/rclone/rclone/releases{/id}","deployments_url":"https://api.github.com/repos/rclone/rclone/deployments","created_at":"2014-03-16T16:19:57Z","updated_at":"2025-11-09T20:38:02Z","pushed_at":"2025-11-08T21:33:38Z","git_url":"git://github.com/rclone/rclone.git","ssh_url":"git@github.com:rclone/rclone.git","clone_url":"https://github.com/rclone/rclone.git","svn_url":"https://github.com/rclone/rclone","homepage":"https://rclone.org","size":217990,"stargazers_count":53422,"watchers_count":53422,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":4767,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1169,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["azure-blob","azure-blob-storage","azure-files","backblaze-b2","cloud-storage","dropbox","encryption","ftp","fuse-filesystem","go","golang","google-cloud-storage","google-drive","onedrive","openstack-swift","rclone","s3","sftp","sync","webdav"],"visibility":"public","forks":4767,"open_issues":1169,"watchers":53422,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/rclone/rclone/pulls/5941","html_url":"https://github.com/rclone/rclone/pull/5941","diff_url":"https://github.com/rclone/rclone/pull/5941.diff","patch_url":"https://github.com/rclone/rclone/pull/5941.patch","merged_at":"2022-01-26T10:41:01Z"},"body":"#### What is the purpose of this change?\r\n\r\nIn the http backend initialization, it is trying to classify the path given on command line: If it refers to a file or directory. If it ends with \"/\" it is assumed to be a directory. But it cannot in general trust the user to always use suffix \"/\" when specifying directories, so if the path does not end with a \"/\" it issues a HEAD request to find out. But if this request fails, e.g. because the server forbids it with a HTTP 403 return, then it is always assumed to be a directory. If it in fact was a file then the remote will not work, because e.g. http://domain/file.txt becomes http://domain/file.txt/ .\r\n\r\nIt is probably impossible to find a bullet proof approach to this, but by looking at the result of the HEAD request a bit more carefully we can get it right most of the time. As suggested in a comment in that thread:\r\n- If no error assume it is a file\r\n- If 404 error assume it is a directory\r\n- If some sort of redirect 301,302,303,307,308 check the Location: header\r\n    - If it ends with a / then assume it is a directory\r\n    - Otherwise assume it is a file\r\n- If any other error assume it is a file\r\n\r\nThis is potentially backwards incompatible if a the HEAD request is returning something other than 404 or a redirect when the file isn't found, but the assumption is that this is fairly unlikely, and it is made sure to log enough information that users should be able to figure it out.\r\n\r\nEdit from [comment](#pullrequestreview-862575442):\r\n- Now also considers the `--http-no-head` option on the initial HEAD request (described above).\r\n    - So now this option will turn off any head requests, not just for listing.\r\n    - If not path has / suffix then we have no other choice than to always assume it is file, so user must then make sure to add a trailing / any time he means to refer to a directory.\r\n    - Note that for all paths to directories, which is the normal use-case I think, one can easily avoid the initial HEAD request regardless of the no-head option, by just ensuring the path is specified with / suffix.\r\n\r\n#### Was the change discussed in an issue or in the forum before?\r\n\r\nFixes #5929\r\n\r\n#### Checklist\r\n\r\n- [X] I have read the [contribution guidelines](https://github.com/rclone/rclone/blob/master/CONTRIBUTING.md#submitting-a-new-feature-or-bug-fix).\r\n- [X] I have added tests for all changes in this PR if appropriate.\r\n- [X] I have added documentation for the changes if appropriate.\r\n- [X] All commit messages are in [house style](https://github.com/rclone/rclone/blob/master/CONTRIBUTING.md#commit-messages).\r\n- [X] I'm done, this Pull Request is ready for review :-)\r\n","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/5941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/5941/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":5941194529,"node_id":"REFE_lADOAQ-n5M5CCOwOzwAAAAFiH28h","url":"https://api.github.com/repos/rclone/rclone/issues/events/5941194529","actor":{"login":"albertony","id":12441419,"node_id":"MDQ6VXNlcjEyNDQxNDE5","avatar_url":"https://avatars.githubusercontent.com/u/12441419?v=4","gravatar_id":"","url":"https://api.github.com/users/albertony","html_url":"https://github.com/albertony","followers_url":"https://api.github.com/users/albertony/followers","following_url":"https://api.github.com/users/albertony/following{/other_user}","gists_url":"https://api.github.com/users/albertony/gists{/gist_id}","starred_url":"https://api.github.com/users/albertony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertony/subscriptions","organizations_url":"https://api.github.com/users/albertony/orgs","repos_url":"https://api.github.com/users/albertony/repos","events_url":"https://api.github.com/users/albertony/events{/privacy}","received_events_url":"https://api.github.com/users/albertony/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"19205ce0e18661395a8c374ddabece3c120a1a0e","commit_url":"https://api.github.com/repos/albertony/rclone/commits/19205ce0e18661395a8c374ddabece3c120a1a0e","created_at":"2022-01-24T10:16:00Z","performed_via_github_app":null},{"id":5941832434,"node_id":"REFE_lADOAQ-n5M5CCOwOzwAAAAFiKSry","url":"https://api.github.com/repos/rclone/rclone/issues/events/5941832434","actor":{"login":"albertony","id":12441419,"node_id":"MDQ6VXNlcjEyNDQxNDE5","avatar_url":"https://avatars.githubusercontent.com/u/12441419?v=4","gravatar_id":"","url":"https://api.github.com/users/albertony","html_url":"https://github.com/albertony","followers_url":"https://api.github.com/users/albertony/followers","following_url":"https://api.github.com/users/albertony/following{/other_user}","gists_url":"https://api.github.com/users/albertony/gists{/gist_id}","starred_url":"https://api.github.com/users/albertony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertony/subscriptions","organizations_url":"https://api.github.com/users/albertony/orgs","repos_url":"https://api.github.com/users/albertony/repos","events_url":"https://api.github.com/users/albertony/events{/privacy}","received_events_url":"https://api.github.com/users/albertony/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"cfa95ca9ddb342a83a6bfc08868c3a0e8654fc2c","commit_url":"https://api.github.com/repos/albertony/rclone/commits/cfa95ca9ddb342a83a6bfc08868c3a0e8654fc2c","created_at":"2022-01-24T11:46:59Z","performed_via_github_app":null},{"id":5943070545,"node_id":"REFE_lADOAQ-n5M5CCOwOzwAAAAFiPA9R","url":"https://api.github.com/repos/rclone/rclone/issues/events/5943070545","actor":{"login":"albertony","id":12441419,"node_id":"MDQ6VXNlcjEyNDQxNDE5","avatar_url":"https://avatars.githubusercontent.com/u/12441419?v=4","gravatar_id":"","url":"https://api.github.com/users/albertony","html_url":"https://github.com/albertony","followers_url":"https://api.github.com/users/albertony/followers","following_url":"https://api.github.com/users/albertony/following{/other_user}","gists_url":"https://api.github.com/users/albertony/gists{/gist_id}","starred_url":"https://api.github.com/users/albertony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertony/subscriptions","organizations_url":"https://api.github.com/users/albertony/orgs","repos_url":"https://api.github.com/users/albertony/repos","events_url":"https://api.github.com/users/albertony/events{/privacy}","received_events_url":"https://api.github.com/users/albertony/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"8ac3bef3d176c6405119b185dfd79ee1244e699c","commit_url":"https://api.github.com/repos/albertony/rclone/commits/8ac3bef3d176c6405119b185dfd79ee1244e699c","created_at":"2022-01-24T14:48:20Z","performed_via_github_app":null},{"id":5953180413,"node_id":"REFE_lADOAQ-n5M5CCOwOzwAAAAFi1lL9","url":"https://api.github.com/repos/rclone/rclone/issues/events/5953180413","actor":{"login":"albertony","id":12441419,"node_id":"MDQ6VXNlcjEyNDQxNDE5","avatar_url":"https://avatars.githubusercontent.com/u/12441419?v=4","gravatar_id":"","url":"https://api.github.com/users/albertony","html_url":"https://github.com/albertony","followers_url":"https://api.github.com/users/albertony/followers","following_url":"https://api.github.com/users/albertony/following{/other_user}","gists_url":"https://api.github.com/users/albertony/gists{/gist_id}","starred_url":"https://api.github.com/users/albertony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertony/subscriptions","organizations_url":"https://api.github.com/users/albertony/orgs","repos_url":"https://api.github.com/users/albertony/repos","events_url":"https://api.github.com/users/albertony/events{/privacy}","received_events_url":"https://api.github.com/users/albertony/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"951b8822cfa55fc7da1f47390f9105dce6a7431d","commit_url":"https://api.github.com/repos/albertony/rclone/commits/951b8822cfa55fc7da1f47390f9105dce6a7431d","created_at":"2022-01-25T22:20:56Z","performed_via_github_app":null},{"id":5953708394,"node_id":"REFE_lADOAQ-n5M5CCOwOzwAAAAFi3mFq","url":"https://api.github.com/repos/rclone/rclone/issues/events/5953708394","actor":{"login":"albertony","id":12441419,"node_id":"MDQ6VXNlcjEyNDQxNDE5","avatar_url":"https://avatars.githubusercontent.com/u/12441419?v=4","gravatar_id":"","url":"https://api.github.com/users/albertony","html_url":"https://github.com/albertony","followers_url":"https://api.github.com/users/albertony/followers","following_url":"https://api.github.com/users/albertony/following{/other_user}","gists_url":"https://api.github.com/users/albertony/gists{/gist_id}","starred_url":"https://api.github.com/users/albertony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertony/subscriptions","organizations_url":"https://api.github.com/users/albertony/orgs","repos_url":"https://api.github.com/users/albertony/repos","events_url":"https://api.github.com/users/albertony/events{/privacy}","received_events_url":"https://api.github.com/users/albertony/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"743e0ebbeebc198e8c82b4242f6e90bd1189c7a1","commit_url":"https://api.github.com/repos/albertony/rclone/commits/743e0ebbeebc198e8c82b4242f6e90bd1189c7a1","created_at":"2022-01-26T00:53:47Z","performed_via_github_app":null},{"id":5955801565,"node_id":"CE_lADOAQ-n5M5CCOwOzwAAAAFi_lHd","url":"https://api.github.com/repos/rclone/rclone/issues/events/5955801565","actor":{"login":"albertony","id":12441419,"node_id":"MDQ6VXNlcjEyNDQxNDE5","avatar_url":"https://avatars.githubusercontent.com/u/12441419?v=4","gravatar_id":"","url":"https://api.github.com/users/albertony","html_url":"https://github.com/albertony","followers_url":"https://api.github.com/users/albertony/followers","following_url":"https://api.github.com/users/albertony/following{/other_user}","gists_url":"https://api.github.com/users/albertony/gists{/gist_id}","starred_url":"https://api.github.com/users/albertony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertony/subscriptions","organizations_url":"https://api.github.com/users/albertony/orgs","repos_url":"https://api.github.com/users/albertony/repos","events_url":"https://api.github.com/users/albertony/events{/privacy}","received_events_url":"https://api.github.com/users/albertony/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-01-26T10:41:01Z","state_reason":null,"performed_via_github_app":null},{"id":5955802100,"node_id":"REFE_lADOAQ-n5M5CCOwOzwAAAAFi_lP0","url":"https://api.github.com/repos/rclone/rclone/issues/events/5955802100","actor":{"login":"albertony","id":12441419,"node_id":"MDQ6VXNlcjEyNDQxNDE5","avatar_url":"https://avatars.githubusercontent.com/u/12441419?v=4","gravatar_id":"","url":"https://api.github.com/users/albertony","html_url":"https://github.com/albertony","followers_url":"https://api.github.com/users/albertony/followers","following_url":"https://api.github.com/users/albertony/following{/other_user}","gists_url":"https://api.github.com/users/albertony/gists{/gist_id}","starred_url":"https://api.github.com/users/albertony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertony/subscriptions","organizations_url":"https://api.github.com/users/albertony/orgs","repos_url":"https://api.github.com/users/albertony/repos","events_url":"https://api.github.com/users/albertony/events{/privacy}","received_events_url":"https://api.github.com/users/albertony/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"a667e03fc9ebc0e21f56e7a820bf873be987e034","commit_url":"https://api.github.com/repos/rclone/rclone/commits/a667e03fc9ebc0e21f56e7a820bf873be987e034","created_at":"2022-01-26T10:41:07Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/2182042271","html_url":"https://github.com/rclone/rclone/issues/5929#issuecomment-2182042271","issue_url":"https://api.github.com/repos/rclone/rclone/issues/5929","id":2182042271,"node_id":"IC_kwDOAQ-n5M6CD1Kf","user":{"login":"WizzardSK","id":42868978,"node_id":"MDQ6VXNlcjQyODY4OTc4","avatar_url":"https://avatars.githubusercontent.com/u/42868978?v=4","gravatar_id":"","url":"https://api.github.com/users/WizzardSK","html_url":"https://github.com/WizzardSK","followers_url":"https://api.github.com/users/WizzardSK/followers","following_url":"https://api.github.com/users/WizzardSK/following{/other_user}","gists_url":"https://api.github.com/users/WizzardSK/gists{/gist_id}","starred_url":"https://api.github.com/users/WizzardSK/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WizzardSK/subscriptions","organizations_url":"https://api.github.com/users/WizzardSK/orgs","repos_url":"https://api.github.com/users/WizzardSK/repos","events_url":"https://api.github.com/users/WizzardSK/events{/privacy}","received_events_url":"https://api.github.com/users/WizzardSK/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-21T05:44:57Z","updated_at":"2024-06-21T05:53:00Z","body":"Not sure if is it related, but I am having problem with --http-no-head when I use --vfs-cache-mode full.\r\nWithout using cache I may run \"head\" command on file to check the file size and then I can work with that like usual. \r\nWith cache after running \"head\" on file it does not refresh the file size and even does not write anything. Like file was empty.\r\n\r\nrclone 1.67 on x64 Linux","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/2182042271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"WizzardSK","id":42868978,"node_id":"MDQ6VXNlcjQyODY4OTc4","avatar_url":"https://avatars.githubusercontent.com/u/42868978?v=4","gravatar_id":"","url":"https://api.github.com/users/WizzardSK","html_url":"https://github.com/WizzardSK","followers_url":"https://api.github.com/users/WizzardSK/followers","following_url":"https://api.github.com/users/WizzardSK/following{/other_user}","gists_url":"https://api.github.com/users/WizzardSK/gists{/gist_id}","starred_url":"https://api.github.com/users/WizzardSK/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WizzardSK/subscriptions","organizations_url":"https://api.github.com/users/WizzardSK/orgs","repos_url":"https://api.github.com/users/WizzardSK/repos","events_url":"https://api.github.com/users/WizzardSK/events{/privacy}","received_events_url":"https://api.github.com/users/WizzardSK/received_events","type":"User","user_view_type":"public","site_admin":false}}]