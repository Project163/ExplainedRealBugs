{"url":"https://api.github.com/repos/rclone/rclone/issues/8629","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/8629/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/8629/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/8629/events","html_url":"https://github.com/rclone/rclone/issues/8629","id":3165667991,"node_id":"I_kwDOAQ-n5M68sEKX","number":8629,"title":"PikPak uploads fail in v1.70.1 with \"aws-chunked encoding is not supported\" error","user":{"login":"Shamshiel","id":13088318,"node_id":"MDQ6VXNlcjEzMDg4MzE4","avatar_url":"https://avatars.githubusercontent.com/u/13088318?v=4","gravatar_id":"","url":"https://api.github.com/users/Shamshiel","html_url":"https://github.com/Shamshiel","followers_url":"https://api.github.com/users/Shamshiel/followers","following_url":"https://api.github.com/users/Shamshiel/following{/other_user}","gists_url":"https://api.github.com/users/Shamshiel/gists{/gist_id}","starred_url":"https://api.github.com/users/Shamshiel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Shamshiel/subscriptions","organizations_url":"https://api.github.com/users/Shamshiel/orgs","repos_url":"https://api.github.com/users/Shamshiel/repos","events_url":"https://api.github.com/users/Shamshiel/events{/privacy}","received_events_url":"https://api.github.com/users/Shamshiel/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399005,"node_id":"MDU6TGFiZWw4NjM5OTAwNQ==","url":"https://api.github.com/repos/rclone/rclone/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":5350216513,"node_id":"LA_kwDOAQ-n5M8AAAABPuXTQQ","url":"https://api.github.com/repos/rclone/rclone/labels/remote:%20PikPak","name":"remote: PikPak","color":"FBCA04","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"wiserain","id":20354654,"node_id":"MDQ6VXNlcjIwMzU0NjU0","avatar_url":"https://avatars.githubusercontent.com/u/20354654?v=4","gravatar_id":"","url":"https://api.github.com/users/wiserain","html_url":"https://github.com/wiserain","followers_url":"https://api.github.com/users/wiserain/followers","following_url":"https://api.github.com/users/wiserain/following{/other_user}","gists_url":"https://api.github.com/users/wiserain/gists{/gist_id}","starred_url":"https://api.github.com/users/wiserain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wiserain/subscriptions","organizations_url":"https://api.github.com/users/wiserain/orgs","repos_url":"https://api.github.com/users/wiserain/repos","events_url":"https://api.github.com/users/wiserain/events{/privacy}","received_events_url":"https://api.github.com/users/wiserain/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"wiserain","id":20354654,"node_id":"MDQ6VXNlcjIwMzU0NjU0","avatar_url":"https://avatars.githubusercontent.com/u/20354654?v=4","gravatar_id":"","url":"https://api.github.com/users/wiserain","html_url":"https://github.com/wiserain","followers_url":"https://api.github.com/users/wiserain/followers","following_url":"https://api.github.com/users/wiserain/following{/other_user}","gists_url":"https://api.github.com/users/wiserain/gists{/gist_id}","starred_url":"https://api.github.com/users/wiserain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wiserain/subscriptions","organizations_url":"https://api.github.com/users/wiserain/orgs","repos_url":"https://api.github.com/users/wiserain/repos","events_url":"https://api.github.com/users/wiserain/events{/privacy}","received_events_url":"https://api.github.com/users/wiserain/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/rclone/rclone/milestones/59","html_url":"https://github.com/rclone/rclone/milestone/59","labels_url":"https://api.github.com/repos/rclone/rclone/milestones/59/labels","id":12156302,"node_id":"MI_kwDOAQ-n5M4AuX2O","number":59,"title":"v1.71","description":"","creator":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":19,"state":"closed","created_at":"2025-01-13T10:56:12Z","updated_at":"2025-09-04T10:21:24Z","due_on":"2025-08-23T07:00:00Z","closed_at":"2025-09-04T10:21:24Z"},"comments":21,"created_at":"2025-06-22T05:08:55Z","updated_at":"2025-07-23T12:03:26Z","closed_at":"2025-07-04T02:25:13Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### The associated forum post URL from `https://forum.rclone.org`\n\n(Not posted to forum yet)\n\n#### What is the problem you are having with rclone?\n\nAfter updating from rclone v1.69.2 to v1.70.1 on EndeavourOS (Arch Linux), uploads to PikPak stopped working. Every upload fails with an S3-related error about aws-chunked encoding not being supported with the specified x-amz-content-sha256 value. \n\nThis appears to be a regression introduced in the new version as uploads were working fine with v1.69.2. To confirm this, I installed v1.69.2 on one of my servers, tried the same upload there and  it worked without any issues.\n\n#### What is your rclone version\n\n```\nrclone v1.70.1\n- os/version: endeavouros (64 bit)\n- os/kernel: 6.15.3-arch1-1 (x86_64)\n- os/type: linux\n- os/arch: amd64\n- go/version: go1.24.4\n- go/linking: dynamic\n- go/tags: none\n```\n\n#### Which OS you are using and how many bits (e.g. Windows 7, 64 bit)\n\nEndeavourOS (Arch Linux), 64 bit\n\n#### Which cloud storage system are you using? (e.g. Google Drive)\n\nPikPak\n\n#### The command you were trying to run (e.g. `rclone copy /tmp remote:tmp`)\n\n```\nrclone copy /home/username/Videos/test.mp4 pikpak:/test/ --stats-one-line -P -vv\n```\n\n#### A log from the command with the `-vv` flag \n\n```\nrclone copy /home/username/Videos/test.mp4 pikpak:/test/ --stats-one-line -P -vv\n2025/06/22 06:30:23 DEBUG : rclone: Version \"v1.70.1\" starting with parameters [\"rclone\" \"copy\" \"/home/username/Videos/test.mp4\" \"pikpak:/test/\" \"--stats-one-line\" \"-P\" \"-vv\"]\n2025/06/22 06:30:23 DEBUG : Creating backend with remote \"/home/username/Videos/test.mp4\"\n2025/06/22 06:30:23 DEBUG : Using config file from \"/home/username/.config/rclone/rclone.conf\"\n2025/06/22 06:30:23 DEBUG : fs cache: renaming child cache item \"/home/username/Videos/test.mp4\" to be canonical for parent \"/home/username/Videos/PikPak/Error\"\n2025/06/22 06:30:23 DEBUG : Creating backend with remote \"pikpak:/test/\"\n2025/06/22 06:30:25 DEBUG : Saving config \"captcha_token\" in section \"pikpak\" of the config file\n2025/06/22 06:30:28 DEBUG : fs cache: renaming cache item \"pikpak:/test/\" to be canonical \"pikpak:test\"\n2025/06/22 06:30:28 DEBUG : test.mp4: Need to transfer - File not found at Destination\n2025/06/22 06:30:29 DEBUG : test.mp4: calculating gcid: <nil>\n2025/06/22 06:30:32 DEBUG : test.mp4: gcid = [GCID_HASH]\n2025/06/22 06:30:32 DEBUG : pacer: low level retry 1/10 (error Error \"captcha_invalid\" (9): Verification code is invalid)\n2025/06/22 06:30:32 DEBUG : pacer: Rate limited, increasing sleep to 200ms\n2025/06/22 06:30:33 DEBUG : Saving config \"captcha_token\" in section \"pikpak\" of the config file\n2025/06/22 06:30:33 DEBUG : pacer: Reducing sleep to 150ms\n2025/06/22 06:30:36 DEBUG : test.mp4: canceling upload: failed to upload: upload multipart failed, upload id: [UPLOAD_ID_1], cause: operation error S3: UploadPart, https response error StatusCode: 400, RequestID: [REQUEST_ID_1], HostID: vip-lixian-07.mypikpak.com, api error InvalidArgument: aws-chunked encoding is not supported with the specified x-amz-content-sha256 value.\n2025/06/22 06:30:36 DEBUG : pacer: Reducing sleep to 112.5ms\n2025/06/22 06:30:37 DEBUG : pacer: Reducing sleep to 100ms\n2025/06/22 06:30:37 DEBUG : test.mp4: waiting 500ms for the cancellation to be effective\n2025/06/22 06:30:38 ERROR : test.mp4: Failed to copy: failed to upload: upload multipart failed, upload id: [UPLOAD_ID_1], cause: operation error S3: UploadPart, https response error StatusCode: 400, RequestID: [REQUEST_ID_1], HostID: vip-lixian-07.mypikpak.com, api error InvalidArgument: aws-chunked encoding is not supported with the specified x-amz-content-sha256 value.\n2025/06/22 06:30:38 ERROR : Attempt 1/3 failed with 1 errors and: failed to upload: upload multipart failed, upload id: [UPLOAD_ID_1], cause: operation error S3: UploadPart, https response error StatusCode: 400, RequestID: [REQUEST_ID_1], HostID: vip-lixian-07.mypikpak.com, api error InvalidArgument: aws-chunked encoding is not supported with the specified x-amz-content-sha256 value.\n2025/06/22 06:30:38 DEBUG : test.mp4: Need to transfer - File not found at Destination\n2025/06/22 06:30:41 DEBUG : pacer: low level retry 1/10 (error Error \"internal server error: Post \\\"http://idx.shub.mypikpak.com\\\": context deadline exceeded (Client.Timeout exceeded while awaiting headers)\" (500))\n2025/06/22 06:30:41 DEBUG : pacer: Rate limited, increasing sleep to 200ms\n2025/06/22 06:30:41 DEBUG : pacer: Reducing sleep to 150ms\n2025/06/22 06:30:41 DEBUG : test.mp4: calculating gcid: <nil>\n2025/06/22 06:30:44 DEBUG : test.mp4: gcid = [GCID_HASH]\n2025/06/22 06:30:46 DEBUG : pacer: Reducing sleep to 112.5ms\n2025/06/22 06:30:48 DEBUG : test.mp4: canceling upload: failed to upload: upload multipart failed, upload id: [UPLOAD_ID_2], cause: operation error S3: UploadPart, https response error StatusCode: 400, RequestID: [REQUEST_ID_2], HostID: vip-lixian-07.mypikpak.com, api error InvalidArgument: aws-chunked encoding is not supported with the specified x-amz-content-sha256 value.\n2025/06/22 06:30:49 DEBUG : pacer: Reducing sleep to 100ms\n2025/06/22 06:30:50 DEBUG : test.mp4: waiting 500ms for the cancellation to be effective\n2025/06/22 06:30:50 ERROR : test.mp4: Failed to copy: failed to upload: upload multipart failed, upload id: [UPLOAD_ID_2], cause: operation error S3: UploadPart, https response error StatusCode: 400, RequestID: [REQUEST_ID_2], HostID: vip-lixian-07.mypikpak.com, api error InvalidArgument: aws-chunked encoding is not supported with the specified x-amz-content-sha256 value.\n2025/06/22 06:30:50 ERROR : Attempt 2/3 failed with 1 errors and: failed to upload: upload multipart failed, upload id: [UPLOAD_ID_2], cause: operation error S3: UploadPart, https response error StatusCode: 400, RequestID: [REQUEST_ID_2], HostID: vip-lixian-07.mypikpak.com, api error InvalidArgument: aws-chunked encoding is not supported with the specified x-amz-content-sha256 value.\n2025/06/22 06:30:51 DEBUG : test.mp4: Need to transfer - File not found at Destination\n2025/06/22 06:30:54 DEBUG : pacer: low level retry 1/10 (error Error \"internal server error: Post \\\"http://idx.shub.mypikpak.com\\\": context deadline exceeded (Client.Timeout exceeded while awaiting headers)\" (500))\n2025/06/22 06:30:54 DEBUG : pacer: Rate limited, increasing sleep to 200ms\n2025/06/22 06:30:56 DEBUG : pacer: Reducing sleep to 150ms\n2025/06/22 06:30:56 DEBUG : test.mp4: calculating gcid: <nil>\n2025/06/22 06:30:59 DEBUG : test.mp4: gcid = [GCID_HASH]\n2025/06/22 06:30:59 DEBUG : pacer: Reducing sleep to 112.5ms\n2025/06/22 06:31:02 DEBUG : test.mp4: canceling upload: failed to upload: upload multipart failed, upload id: [UPLOAD_ID_3], cause: operation error S3: UploadPart, https response error StatusCode: 400, RequestID: [REQUEST_ID_3], HostID: vip-lixian-07.mypikpak.com, api error InvalidArgument: aws-chunked encoding is not supported with the specified x-amz-content-sha256 value.\n2025/06/22 06:31:02 DEBUG : pacer: Reducing sleep to 100ms\n2025/06/22 06:31:04 DEBUG : test.mp4: waiting 500ms for the cancellation to be effective\n2025/06/22 06:31:04 ERROR : test.mp4: Failed to copy: failed to upload: upload multipart failed, upload id: [UPLOAD_ID_3], cause: operation error S3: UploadPart, https response error StatusCode: 400, RequestID: [REQUEST_ID_3], HostID: vip-lixian-07.mypikpak.com, api error InvalidArgument: aws-chunked encoding is not supported with the specified x-amz-content-sha256 value.\n105 MiB / 105 MiB, 100%, 3.889 MiB/s, ETA 0s\n2025/06/22 06:31:04 INFO  :       105 MiB / 105 MiB, 100%, 3.889 MiB/s, ETA 0s\n2025/06/22 06:31:04 DEBUG : 13 go routines active\n2025/06/22 06:31:04 NOTICE: Failed to copy: failed to upload: upload multipart failed, upload id: [UPLOAD_ID_3], cause: operation error S3: UploadPart, https response error StatusCode: 400, RequestID: [REQUEST_ID_3], HostID: vip-lixian-07.mypikpak.com, api error InvalidArgument: aws-chunked encoding is not supported with the specified x-amz-content-sha256 value.\n```","closed_by":{"login":"wiserain","id":20354654,"node_id":"MDQ6VXNlcjIwMzU0NjU0","avatar_url":"https://avatars.githubusercontent.com/u/20354654?v=4","gravatar_id":"","url":"https://api.github.com/users/wiserain","html_url":"https://github.com/wiserain","followers_url":"https://api.github.com/users/wiserain/followers","following_url":"https://api.github.com/users/wiserain/following{/other_user}","gists_url":"https://api.github.com/users/wiserain/gists{/gist_id}","starred_url":"https://api.github.com/users/wiserain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wiserain/subscriptions","organizations_url":"https://api.github.com/users/wiserain/orgs","repos_url":"https://api.github.com/users/wiserain/repos","events_url":"https://api.github.com/users/wiserain/events{/privacy}","received_events_url":"https://api.github.com/users/wiserain/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/8629/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/8629/timeline","performed_via_github_app":null,"state_reason":"completed"}