[{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/569846610","html_url":"https://github.com/rclone/rclone/issues/3835#issuecomment-569846610","issue_url":"https://api.github.com/repos/rclone/rclone/issues/3835","id":569846610,"node_id":"MDEyOklzc3VlQ29tbWVudDU2OTg0NjYxMA==","user":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-31T01:52:58Z","updated_at":"2019-12-31T01:52:58Z","body":"As an update, I have checked using aws-cli and s3cmd (using instructions from minio [1] and [2]).\r\nThey perform as expected as well.\r\n\r\n[1]: https://docs.min.io/docs/aws-cli-with-minio\r\n[2]: https://docs.min.io/docs/s3cmd-with-minio","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/569846610/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/570180267","html_url":"https://github.com/rclone/rclone/issues/3835#issuecomment-570180267","issue_url":"https://api.github.com/repos/rclone/rclone/issues/3835","id":570180267,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MDE4MDI2Nw==","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-02T11:19:34Z","updated_at":"2020-01-02T11:19:34Z","body":"The problem seems to be caused by the introduction of the proxy - is that right?\r\n\r\nI doubt it is https in particular as S3 transactions are normally done via https.\r\n\r\nHave you tried doing an wireshark dump to see if you can see what is going on?\r\n\r\nAre there any hints in the proxy log?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/570180267/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/570207814","html_url":"https://github.com/rclone/rclone/issues/3835#issuecomment-570207814","issue_url":"https://api.github.com/repos/rclone/rclone/issues/3835","id":570207814,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MDIwNzgxNA==","user":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-02T13:31:31Z","updated_at":"2020-01-02T13:31:31Z","body":"I ran tcpdump to see what would happen, and it looks like rclone simply isn't sending packets (I let it get to 45M, then 65M, then 85M).\r\n\r\nevery time, at some point, rclone will send some application data, the server will return with an ack, and then silence\r\n15 seconds later the server sends a keep-alive packet that rclone responds to\r\nthis repeats 3 times, 15 seconds apart each time\r\nthen rclone sends ~10 acks/psh,acks in a row, after which the transfer seems to continue\r\n\r\nI'm not particularly well-versed in networking (especially not on the tcp/ip level), so that means very little to me, and I'd rather not send the pcap file (given that it does have auth, ips and so on in it)\r\nhowever, considering that this behavior does *not* happen with minio-client, aws-cli or s3cmd I doubt we can blame the reverse-proxy\r\nfurther, it used to work fine some time ago, I might try to bisect for the breaking commit at some point (though depending on the introduction of go modules usage that may be fruitless)","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/570207814/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/570926517","html_url":"https://github.com/rclone/rclone/issues/3835#issuecomment-570926517","issue_url":"https://api.github.com/repos/rclone/rclone/issues/3835","id":570926517,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MDkyNjUxNw==","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-05T16:26:06Z","updated_at":"2020-01-05T16:26:06Z","body":"> I doubt we can blame the reverse-proxy\r\n\r\nIt will be an interaction between rclone and the reverse proxy... Maybe rclone is using the proxy differently (eg using HTTP/2) or something like that.\r\n\r\n> , I might try to bisect for the breaking commit at some point (though depending on the introduction of go modules usage that may be fruitless)\r\n\r\nThat would be really really useful if you could.  Rclone is fully vendored so build rclone with `go build -mod=vendor` and git bisect should do the trick.\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/570926517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/570928850","html_url":"https://github.com/rclone/rclone/issues/3835#issuecomment-570928850","issue_url":"https://api.github.com/repos/rclone/rclone/issues/3835","id":570928850,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MDkyODg1MA==","user":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-05T16:56:26Z","updated_at":"2020-01-05T16:56:51Z","body":"I tried to find a bisect good, and went all the way back to `6396872d7` (the first release with go modules)... and it was still bad. I did try to use dep to build the version before that but it's just hopelessly broken.\r\n\r\nI then toyed around with the various advanced configurations, and had the following revelations:\r\n1. I set the concurrency to \"1\". Once that was done, the \"first pass\" (45M quoted above) became exactly 3x chunk size (15M by default, once I set chunk size to 50M it got stuck on 150M).\r\n2. If I set upload_cutoff to \"5G\" (large.zip is around 2.5G), the issue mostly disappears (it takes a little bit to start up, even though I had checksums disabled at that point (for faster iteration), but then it goes at only 1/3 of the expected speed (~37MB/s, while ~100MB/s is expected based on other tools)).\r\n\r\nFrom this it appears to be some edge case in rclone's chunking process.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/570928850/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/570940874","html_url":"https://github.com/rclone/rclone/issues/3835#issuecomment-570940874","issue_url":"https://api.github.com/repos/rclone/rclone/issues/3835","id":570940874,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MDk0MDg3NA==","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-05T19:40:57Z","updated_at":"2020-01-05T19:40:57Z","body":"Great, looks like we are getting somewhere.\r\n\r\nInterestingly I just re-wrote the s3 chunked uploader in 7e6fac8b1eaeccbf48e197e2c1f12627c3e69ca5  - fancy trying [the latest beta](https://beta.rclone.org)?\r\n\r\nCan you run your test with `-vv --dump headers` and post the resulting log here?  That will let us see which requests exactly are stalling.\r\n\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/570940874/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/570943392","html_url":"https://github.com/rclone/rclone/issues/3835#issuecomment-570943392","issue_url":"https://api.github.com/repos/rclone/rclone/issues/3835","id":570943392,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MDk0MzM5Mg==","user":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-05T20:12:55Z","updated_at":"2020-01-05T20:12:55Z","body":"Latest beta (`g9d993e58`) - same behavior, jumps to 20M (guessing 1 chunk x 4 threads).\r\nLooking at -`-vv --dump headers` output, it looks like minio is either not sending 100-Continue, or rclone is not interpreting them (see dump at the end). (the `--bind` argument is for the network dump)\r\n\r\nI have a wireshark dump of the entire interaction (clean thanks to `--bind`), though I'm not sure how/what to interpret, given that I don't/can't see http protocol data (it's all TLSv1.3, for obvious reasons).\r\n\r\n```2020/01/05 14:58:49 DEBUG : rclone: Version \"v1.50.2-109-g9d993e58-beta\" starting with parameters [\"./rclone\" \"copy\" \"-vv\" \"--dump\" \"headers\" \"../large.zip\" \"fafnir:tmp\" \"--bind\" \"192.168.0.254\"]\r\n2020/01/05 14:58:49 DEBUG : Using config file from \"/home/toast/.config/rclone/rclone.conf\"\r\n2020/01/05 14:58:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:58:49 DEBUG : HTTP REQUEST (req 0xc00011ff00)\r\n2020/01/05 14:58:49 DEBUG : HEAD /tmp/large.zip HTTP/1.1\r\nHost: minio.toast.cafe\r\nUser-Agent: rclone/v1.50.2-109-g9d993e58-beta\r\nAuthorization: XXXX\r\nX-Amz-Content-Sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\r\nX-Amz-Date: 20200105T195849Z\r\n\r\n2020/01/05 14:58:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:58:49 DEBUG : <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n2020/01/05 14:58:49 DEBUG : HTTP RESPONSE (req 0xc00011ff00)\r\n2020/01/05 14:58:49 DEBUG : HTTP/2.0 404 Not Found\r\nAccept-Ranges: bytes\r\nContent-Security-Policy: block-all-mixed-content\r\nDate: Sun, 05 Jan 2020 19:58:01 GMT\r\nServer: Caddy\r\nServer: MinIO/DEVELOPMENT.2019-12-22T23-03-51Z\r\nVary: Origin\r\nX-Amz-Request-Id: 15E715E831E8989D\r\nX-Xss-Protection: 1; mode=block\r\nContent-Length: 0\r\n\r\n2020/01/05 14:58:49 DEBUG : <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n2020/01/05 14:58:49 DEBUG : large.zip: Need to transfer - File not found at Destination\r\n2020/01/05 14:58:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:58:49 DEBUG : HTTP REQUEST (req 0xc00011f300)\r\n2020/01/05 14:58:49 DEBUG : PUT /tmp HTTP/1.1\r\nHost: minio.toast.cafe\r\nUser-Agent: rclone/v1.50.2-109-g9d993e58-beta\r\nContent-Length: 0\r\nAuthorization: XXXX\r\nX-Amz-Acl: private\r\nX-Amz-Content-Sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\r\nX-Amz-Date: 20200105T195849Z\r\nAccept-Encoding: gzip\r\n\r\n2020/01/05 14:58:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:58:49 DEBUG : <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n2020/01/05 14:58:49 DEBUG : HTTP RESPONSE (req 0xc00011f300)\r\n2020/01/05 14:58:49 DEBUG : HTTP/2.0 409 Conflict\r\nContent-Length: 336\r\nAccept-Ranges: bytes\r\nContent-Security-Policy: block-all-mixed-content\r\nContent-Type: application/xml\r\nDate: Sun, 05 Jan 2020 19:58:01 GMT\r\nServer: Caddy\r\nServer: MinIO/DEVELOPMENT.2019-12-22T23-03-51Z\r\nVary: Origin\r\nX-Amz-Request-Id: 15E715E832392E2A\r\nX-Xss-Protection: 1; mode=block\r\n\r\n2020/01/05 14:58:49 DEBUG : <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n2020/01/05 14:58:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:58:49 DEBUG : HTTP REQUEST (req 0xc00011fb00)\r\n2020/01/05 14:58:49 DEBUG : POST /tmp/large.zip?uploads= HTTP/1.1\r\nHost: minio.toast.cafe\r\nUser-Agent: rclone/v1.50.2-109-g9d993e58-beta\r\nContent-Length: 0\r\nAuthorization: XXXX\r\nContent-Type: application/zip\r\nX-Amz-Acl: private\r\nX-Amz-Content-Sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\r\nX-Amz-Date: 20200105T195849Z\r\nX-Amz-Meta-Mtime: 1577756410.393861829\r\nAccept-Encoding: gzip\r\n\r\n2020/01/05 14:58:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:58:49 DEBUG : <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n2020/01/05 14:58:49 DEBUG : HTTP RESPONSE (req 0xc00011fb00)\r\n2020/01/05 14:58:49 DEBUG : HTTP/2.0 200 OK\r\nContent-Length: 247\r\nAccept-Ranges: bytes\r\nContent-Security-Policy: block-all-mixed-content\r\nContent-Type: application/xml\r\nDate: Sun, 05 Jan 2020 19:58:01 GMT\r\nServer: Caddy\r\nServer: MinIO/DEVELOPMENT.2019-12-22T23-03-51Z\r\nVary: Origin\r\nX-Amz-Request-Id: 15E715E8326AF2AC\r\nX-Xss-Protection: 1; mode=block\r\n\r\n2020/01/05 14:58:49 DEBUG : <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n2020/01/05 14:58:49 DEBUG : large.zip: multipart upload starting chunk 1 size 5M offset 0/2.313G\r\n2020/01/05 14:58:49 DEBUG : large.zip: multipart upload starting chunk 2 size 5M offset 5M/2.313G\r\n2020/01/05 14:58:49 DEBUG : large.zip: multipart upload starting chunk 3 size 5M offset 10M/2.313G\r\n2020/01/05 14:58:49 DEBUG : large.zip: multipart upload starting chunk 4 size 5M offset 15M/2.313G\r\n2020/01/05 14:58:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:58:49 DEBUG : HTTP REQUEST (req 0xc0001ea100)\r\n2020/01/05 14:58:49 DEBUG : PUT /tmp/large.zip?partNumber=2&uploadId=50c8fc80-4d19-455b-95c2-2e3fe5ec48ce HTTP/1.1\r\nHost: minio.toast.cafe\r\nUser-Agent: rclone/v1.50.2-109-g9d993e58-beta\r\nContent-Length: 5242880\r\nAuthorization: XXXX\r\nContent-Md5: rm8YIpRZr1VAT0WjQdTuZg==\r\nExpect: 100-Continue\r\nX-Amz-Content-Sha256: d452ec046f518cab4e529424d96a56ac4ade72b14594d904c62a3ffe2969c64f\r\nX-Amz-Date: 20200105T195849Z\r\nAccept-Encoding: gzip\r\n\r\n2020/01/05 14:58:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:58:49 DEBUG : HTTP REQUEST (req 0xc000660600)\r\n2020/01/05 14:58:49 DEBUG : PUT /tmp/large.zip?partNumber=1&uploadId=50c8fc80-4d19-455b-95c2-2e3fe5ec48ce HTTP/1.1\r\nHost: minio.toast.cafe\r\nUser-Agent: rclone/v1.50.2-109-g9d993e58-beta\r\nContent-Length: 5242880\r\nAuthorization: XXXX\r\nContent-Md5: +ylA9ARqtAvbJl1ioE7jNQ==\r\nExpect: 100-Continue\r\nX-Amz-Content-Sha256: b0acc3e09e3a597c1e1eb91cc8cb94445269e6ea5666e7ef360b475e86c7f0b5\r\nX-Amz-Date: 20200105T195849Z\r\nAccept-Encoding: gzip\r\n\r\n2020/01/05 14:58:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:58:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:58:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:58:49 DEBUG : HTTP REQUEST (req 0xc0004f0100)\r\n2020/01/05 14:58:49 DEBUG : PUT /tmp/large.zip?partNumber=3&uploadId=50c8fc80-4d19-455b-95c2-2e3fe5ec48ce HTTP/1.1\r\nHost: minio.toast.cafe\r\nUser-Agent: rclone/v1.50.2-109-g9d993e58-beta\r\nContent-Length: 5242880\r\nAuthorization: XXXX\r\nContent-Md5: IF7JBZg43y81BuGW8Tjfdw==\r\nExpect: 100-Continue\r\nX-Amz-Content-Sha256: 2d69b308e7965c8e229aace7c5946efd031c15c27dfcd56602f7eae163c35148\r\nX-Amz-Date: 20200105T195849Z\r\nAccept-Encoding: gzip\r\n\r\n2020/01/05 14:58:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:58:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:58:49 DEBUG : HTTP REQUEST (req 0xc0004e8700)\r\n2020/01/05 14:58:49 DEBUG : PUT /tmp/large.zip?partNumber=4&uploadId=50c8fc80-4d19-455b-95c2-2e3fe5ec48ce HTTP/1.1\r\nHost: minio.toast.cafe\r\nUser-Agent: rclone/v1.50.2-109-g9d993e58-beta\r\nContent-Length: 5242880\r\nAuthorization: XXXX\r\nContent-Md5: awvDTVgGYddnYcf6QpW8Vw==\r\nExpect: 100-Continue\r\nX-Amz-Content-Sha256: 01e17b4d847163794a07831273c8be9d15852ce5f358767142faf2a8d0f33545\r\nX-Amz-Date: 20200105T195849Z\r\nAccept-Encoding: gzip\r\n\r\n2020/01/05 14:58:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:59:49 INFO  :\r\nTransferred:           20M / 2.313 GBytes, 1%, 342.082 kBytes/s, ETA 1h57m11s\r\nTransferred:            0 / 1, 0%\r\nElapsed time:       59.8s\r\nTransferring:\r\n *                                     large.zip:  0% /2.313G, 79.784k/s, 8h22m26s\r\n\r\n2020/01/05 14:59:49 DEBUG : <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n2020/01/05 14:59:49 DEBUG : HTTP RESPONSE (req 0xc0001ea100)\r\n2020/01/05 14:59:49 DEBUG : HTTP/2.0 200 OK\r\nContent-Length: 0\r\nAccept-Ranges: bytes\r\nContent-Security-Policy: block-all-mixed-content\r\nDate: Sun, 05 Jan 2020 19:59:01 GMT\r\nEtag: \"ae6f18229459af55404f45a341d4ee66\"\r\nServer: Caddy\r\nServer: MinIO/DEVELOPMENT.2019-12-22T23-03-51Z\r\nVary: Origin\r\nX-Amz-Request-Id: 15E715E83C8EDDDB\r\nX-Xss-Protection: 1; mode=block\r\n\r\n2020/01/05 14:59:49 DEBUG : <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n2020/01/05 14:59:49 DEBUG : large.zip: multipart upload starting chunk 5 size 5M offset 20M/2.313G\r\n2020/01/05 14:59:49 DEBUG : <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n2020/01/05 14:59:49 DEBUG : HTTP RESPONSE (req 0xc0004f0100)\r\n2020/01/05 14:59:49 DEBUG : HTTP/2.0 200 OK\r\nContent-Length: 0\r\nAccept-Ranges: bytes\r\nContent-Security-Policy: block-all-mixed-content\r\nDate: Sun, 05 Jan 2020 19:59:01 GMT\r\nEtag: \"205ec9059838df2f3506e196f138df77\"\r\nServer: Caddy\r\nServer: MinIO/DEVELOPMENT.2019-12-22T23-03-51Z\r\nVary: Origin\r\nX-Amz-Request-Id: 15E715E83CB6F5C8\r\nX-Xss-Protection: 1; mode=block\r\n\r\n2020/01/05 14:59:49 DEBUG : <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n2020/01/05 14:59:49 DEBUG : large.zip: multipart upload starting chunk 6 size 5M offset 25M/2.313G\r\n2020/01/05 14:59:49 DEBUG : <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n2020/01/05 14:59:49 DEBUG : HTTP RESPONSE (req 0xc000660600)\r\n2020/01/05 14:59:49 DEBUG : HTTP/2.0 200 OK\r\nContent-Length: 0\r\nAccept-Ranges: bytes\r\nContent-Security-Policy: block-all-mixed-content\r\nDate: Sun, 05 Jan 2020 19:59:01 GMT\r\nEtag: \"fb2940f4046ab40bdb265d62a04ee335\"\r\nServer: Caddy\r\nServer: MinIO/DEVELOPMENT.2019-12-22T23-03-51Z\r\nVary: Origin\r\nX-Amz-Request-Id: 15E715E83C64F16B\r\nX-Xss-Protection: 1; mode=block\r\n\r\n2020/01/05 14:59:49 DEBUG : <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n2020/01/05 14:59:49 DEBUG : large.zip: multipart upload starting chunk 7 size 5M offset 30M/2.313G\r\n2020/01/05 14:59:49 DEBUG : <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n2020/01/05 14:59:49 DEBUG : HTTP RESPONSE (req 0xc0004e8700)\r\n2020/01/05 14:59:49 DEBUG : HTTP/2.0 200 OK\r\nContent-Length: 0\r\nAccept-Ranges: bytes\r\nContent-Security-Policy: block-all-mixed-content\r\nDate: Sun, 05 Jan 2020 19:59:01 GMT\r\nEtag: \"6b0bc34d580661d76761c7fa4295bc57\"\r\nServer: Caddy\r\nServer: MinIO/DEVELOPMENT.2019-12-22T23-03-51Z\r\nVary: Origin\r\nX-Amz-Request-Id: 15E715E83D401D0B\r\nX-Xss-Protection: 1; mode=block\r\n\r\n2020/01/05 14:59:49 DEBUG : <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n2020/01/05 14:59:49 DEBUG : large.zip: multipart upload starting chunk 8 size 5M offset 35M/2.313G\r\n2020/01/05 14:59:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:59:49 DEBUG : HTTP REQUEST (req 0xc0004f0300)\r\n2020/01/05 14:59:49 DEBUG : PUT /tmp/large.zip?partNumber=5&uploadId=50c8fc80-4d19-455b-95c2-2e3fe5ec48ce HTTP/1.1\r\nHost: minio.toast.cafe\r\nUser-Agent: rclone/v1.50.2-109-g9d993e58-beta\r\nContent-Length: 5242880\r\nAuthorization: XXXX\r\nContent-Md5: CkF+uhvlWhTHjbtVUsoFdQ==\r\nExpect: 100-Continue\r\nX-Amz-Content-Sha256: 5f28464144e06bc41f9b67d818f38a0edc621fb495ca7d11a69bfc40a2d8029a\r\nX-Amz-Date: 20200105T195949Z\r\nAccept-Encoding: gzip\r\n\r\n2020/01/05 14:59:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:59:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:59:49 DEBUG : HTTP REQUEST (req 0xc0001ea300)\r\n2020/01/05 14:59:49 DEBUG : PUT /tmp/large.zip?partNumber=6&uploadId=50c8fc80-4d19-455b-95c2-2e3fe5ec48ce HTTP/1.1\r\nHost: minio.toast.cafe\r\nUser-Agent: rclone/v1.50.2-109-g9d993e58-beta\r\nContent-Length: 5242880\r\nAuthorization: XXXX\r\nContent-Md5: RsyKSYPTSkEONBr0BAQORA==\r\nExpect: 100-Continue\r\nX-Amz-Content-Sha256: c9a1336f232d50723307e9f9672ebc08467a5c59ed30edbcf10266024bc016b0\r\nX-Amz-Date: 20200105T195949Z\r\nAccept-Encoding: gzip\r\n\r\n2020/01/05 14:59:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:59:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:59:49 DEBUG : HTTP REQUEST (req 0xc0004e8100)\r\n2020/01/05 14:59:49 DEBUG : PUT /tmp/large.zip?partNumber=7&uploadId=50c8fc80-4d19-455b-95c2-2e3fe5ec48ce HTTP/1.1\r\nHost: minio.toast.cafe\r\nUser-Agent: rclone/v1.50.2-109-g9d993e58-beta\r\nContent-Length: 5242880\r\nAuthorization: XXXX\r\nContent-Md5: iwq+8Ml/Q+fcWbYvwHWY/A==\r\nExpect: 100-Continue\r\nX-Amz-Content-Sha256: fffbbfc2ec010827f28a87e303bb4d65993eeac24bd78a10de8b42c6bf11d19c\r\nX-Amz-Date: 20200105T195949Z\r\nAccept-Encoding: gzip\r\n\r\n2020/01/05 14:59:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:59:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n2020/01/05 14:59:49 DEBUG : HTTP REQUEST (req 0xc00011f300)\r\n2020/01/05 14:59:49 DEBUG : PUT /tmp/large.zip?partNumber=8&uploadId=50c8fc80-4d19-455b-95c2-2e3fe5ec48ce HTTP/1.1\r\nHost: minio.toast.cafe\r\nUser-Agent: rclone/v1.50.2-109-g9d993e58-beta\r\nContent-Length: 5242880\r\nAuthorization: XXXX\r\nContent-Md5: TLt9/2Q6j0DCIKZwUefpPQ==\r\nExpect: 100-Continue\r\nX-Amz-Content-Sha256: e686b06972899a792d0fe1f41081daee2cc269b30404007ff26aa5fbf49d9324\r\nX-Amz-Date: 20200105T195949Z\r\nAccept-Encoding: gzip\r\n\r\n2020/01/05 14:59:49 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n```","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/570943392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/571131450","html_url":"https://github.com/rclone/rclone/issues/3835#issuecomment-571131450","issue_url":"https://api.github.com/repos/rclone/rclone/issues/3835","id":571131450,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MTEzMTQ1MA==","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-06T13:07:31Z","updated_at":"2020-01-06T13:07:31Z","body":"There definitely appears to be a 1 minute timeout doesn't there from request to response.\r\n\r\nI guess that might be the delay if the server doesn't support expect/continue properly.  Rclone's expect continue timeout is set to 1 second I think.\r\n\r\nDo you think the proxy doesn't support expect continue properly?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/571131450/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/571390978","html_url":"https://github.com/rclone/rclone/issues/3835#issuecomment-571390978","issue_url":"https://api.github.com/repos/rclone/rclone/issues/3835","id":571390978,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MTM5MDk3OA==","user":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-07T01:26:52Z","updated_at":"2020-01-07T01:45:11Z","body":"I believe expecting 100-Continue breaks s3 specification.\r\nFirst, find attached (at the bottom) the output of minio-client with the debug flag (similar to the above) uploading at a fast rate (cancelled at an arbitrary point).\r\nNote the lack of `Expect:` and `100` responses.\r\n\r\nNow, why are those missing?\r\nI took a look at the s3 specification.\r\nThe [multipart upload docs](https://docs.aws.amazon.com/AmazonS3/latest/dev/uploadobjusingmpu.html) have a dedicated [REST API section](https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingRESTAPImpUpload.html), which documents the [upload part procedure](https://docs.aws.amazon.com/AmazonS3/latest/API/API_UploadPart.html).\r\n\r\nHere is the summary:\r\nYou send something like this:\r\n```\r\nPUT /my-movie.m2ts?partNumber=1&uploadId=VCVsb2FkIElEIGZvciBlbZZpbmcncyBteS1tb3ZpZS5tMnRzIHVwbG9hZR HTTP/1.1\r\nHost: example-bucket.s3.amazonaws.com\r\nDate:  Mon, 1 Nov 2010 20:34:56 GMT\r\nContent-Length: 10485760\r\nContent-MD5: pUNXr/BjKK5G2UKvaRRrOA==\r\nAuthorization: authorization string\r\n>>>>>>> reefconvert-joe\r\n\r\n***part data omitted***\r\n```\r\nAnd you receive something like this when it ends.\r\n```\r\n\r\nHTTP/1.1 200 OK\r\nx-amz-id-2: Vvag1LuByRx9e6j5Onimru9pO4ZVKnJ2Qz7/C1NPcfTWAtRPfTaOFg==\r\nx-amz-request-id: 656c76696e6727732072657175657374\r\nDate:  Mon, 1 Nov 2010 20:34:56 GMT\r\nETag: \"b54357faf0632cce46e942fa68356b38\"\r\nContent-Length: 0\r\nConnection: keep-alive\r\nServer: AmazonS3\r\n```\r\nUnder this assumption, the current rclone performance should also be terrible against real aws, because it will expect 100 (and never receive it, as per the specification).\r\nI don't have any aws storage instance to test against though.\r\nHowever, based on all of this, my understanding is that 100-Continue should not be used or present in multipart uploads.\r\nAm I missing something?\r\n\r\n(mcli output, let it go to ~500mb completion, only took a few seconds)\r\n```\r\nmcli: <DEBUG> GET /tmp/?location= HTTP/1.1\r\nHost: minio.toast.cafe\r\nUser-Agent: MinIO (linux; amd64) minio-go/v6.0.45 mcli/2019-12-17T23:26:28Z\r\nAuthorization: AWS4-HMAC-SHA256 Credential=**REDACTED**/20200107/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=**REDACTED**\r\nX-Amz-Content-Sha256: UNSIGNED-PAYLOAD\r\nX-Amz-Date: 20200107T014440Z\r\nAccept-Encoding: gzip\r\n\r\nmcli: <DEBUG> HTTP/1.1 200 OK\r\nContent-Length: 128\r\nAccept-Ranges: bytes\r\nContent-Security-Policy: block-all-mixed-content\r\nContent-Type: application/xml\r\nDate: Tue, 07 Jan 2020 01:43:50 GMT\r\nServer: Caddy\r\nServer: MinIO/DEVELOPMENT.2019-12-22T23-03-51Z\r\nVary: Origin\r\nX-Amz-Request-Id: 15E7775BDBF71648\r\nX-Xss-Protection: 1; mode=block\r\n\r\nmcli: <DEBUG> Response Time:  20.573756ms\r\n\r\nmcli: <DEBUG> HEAD /tmp/ HTTP/1.1\r\nHost: minio.toast.cafe\r\nUser-Agent: MinIO (linux; amd64) minio-go/v6.0.45 mcli/2019-12-17T23:26:28Z\r\nAuthorization: AWS4-HMAC-SHA256 Credential=**REDACTED**/20200107/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=**REDACTED**\r\nX-Amz-Content-Sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\r\nX-Amz-Date: 20200107T014440Z\r\n\r\nmcli: <DEBUG> HTTP/1.1 200 OK\r\nAccept-Ranges: bytes\r\nContent-Security-Policy: block-all-mixed-content\r\nDate: Tue, 07 Jan 2020 01:43:50 GMT\r\nServer: Caddy\r\nServer: MinIO/DEVELOPMENT.2019-12-22T23-03-51Z\r\nVary: Origin\r\nX-Amz-Request-Id: 15E7775BDC2CFF43\r\nX-Xss-Protection: 1; mode=block\r\nContent-Length: 0\r\n\r\nmcli: <DEBUG> Response Time:  3.059448ms\r\n\r\nmcli: <DEBUG> HEAD /tmp/ HTTP/1.1\r\nHost: minio.toast.cafe\r\nUser-Agent: MinIO (linux; amd64) minio-go/v6.0.45 mcli/2019-12-17T23:26:28Z\r\nAuthorization: AWS4-HMAC-SHA256 Credential=**REDACTED**/20200107/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=**REDACTED**\r\nX-Amz-Content-Sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\r\nX-Amz-Date: 20200107T014440Z\r\n\r\nmcli: <DEBUG> HTTP/1.1 200 OK\r\nAccept-Ranges: bytes\r\nContent-Security-Policy: block-all-mixed-content\r\nDate: Tue, 07 Jan 2020 01:43:50 GMT\r\nServer: Caddy\r\nServer: MinIO/DEVELOPMENT.2019-12-22T23-03-51Z\r\nVary: Origin\r\nX-Amz-Request-Id: 15E7775BDC59FC69\r\nX-Xss-Protection: 1; mode=block\r\nContent-Length: 0\r\n\r\nmcli: <DEBUG> Response Time:  2.470063ms\r\n\r\nmcli: <DEBUG> HEAD /tmp/ HTTP/1.1\r\nHost: minio.toast.cafe\r\nUser-Agent: MinIO (linux; amd64) minio-go/v6.0.45 mcli/2019-12-17T23:26:28Z\r\nAuthorization: AWS4-HMAC-SHA256 Credential=**REDACTED**/20200107/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=**REDACTED**\r\nX-Amz-Content-Sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\r\nX-Amz-Date: 20200107T014440Z\r\n\r\nmcli: <DEBUG> HTTP/1.1 200 OK\r\nAccept-Ranges: bytes\r\nContent-Security-Policy: block-all-mixed-content\r\nDate: Tue, 07 Jan 2020 01:43:50 GMT\r\nServer: Caddy\r\nServer: MinIO/DEVELOPMENT.2019-12-22T23-03-51Z\r\nVary: Origin\r\nX-Amz-Request-Id: 15E7775BDC887F9C\r\nX-Xss-Protection: 1; mode=block\r\nContent-Length: 0\r\n\r\nmcli: <DEBUG> Response Time:  2.166963ms\r\n\r\nmcli: <DEBUG> POST /tmp/large.zip?uploads= HTTP/1.1\r\nHost: minio.toast.cafe\r\nUser-Agent: MinIO (linux; amd64) minio-go/v6.0.45 mcli/2019-12-17T23:26:28Z\r\nContent-Length: 0\r\nAuthorization: AWS4-HMAC-SHA256 Credential=**REDACTED**/20200107/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=**REDACTED**\r\nContent-Type: application/zip\r\nX-Amz-Content-Sha256: UNSIGNED-PAYLOAD\r\nX-Amz-Date: 20200107T014440Z\r\nAccept-Encoding: gzip\r\n\r\nmcli: <DEBUG> HTTP/1.1 200 OK\r\nContent-Length: 247\r\nAccept-Ranges: bytes\r\nContent-Security-Policy: block-all-mixed-content\r\nContent-Type: application/xml\r\nDate: Tue, 07 Jan 2020 01:43:50 GMT\r\nServer: Caddy\r\nServer: MinIO/DEVELOPMENT.2019-12-22T23-03-51Z\r\nVary: Origin\r\nX-Amz-Request-Id: 15E7775BDCB367F9\r\nX-Xss-Protection: 1; mode=block\r\n\r\nmcli: <DEBUG> Response Time:  2.7775ms\r\n\r\nmcli: <DEBUG> PUT /tmp/large.zip?partNumber=2&uploadId=c87445c7-22d5-4172-9d12-4c24170eb179 HTTP/1.1\r\nHost: minio.toast.cafe\r\nUser-Agent: MinIO (linux; amd64) minio-go/v6.0.45 mcli/2019-12-17T23:26:28Z\r\nContent-Length: 134217728\r\nAuthorization: AWS4-HMAC-SHA256 Credential=**REDACTED**/20200107/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=**REDACTED**\r\nX-Amz-Content-Sha256: UNSIGNED-PAYLOAD\r\nX-Amz-Date: 20200107T014440Z\r\nAccept-Encoding: gzip\r\n\r\nmcli: <DEBUG> HTTP/1.1 200 OK\r\nContent-Length: 0\r\nAccept-Ranges: bytes\r\nContent-Security-Policy: block-all-mixed-content\r\nDate: Tue, 07 Jan 2020 01:43:54 GMT\r\nEtag: \"8873dc889c6147398355cca9c18cc681-1\"\r\nServer: Caddy\r\nServer: MinIO/DEVELOPMENT.2019-12-22T23-03-51Z\r\nVary: Origin\r\nX-Amz-Request-Id: 15E7775BDCF1F8F0\r\nX-Xss-Protection: 1; mode=block\r\n\r\nmcli: <DEBUG> Response Time:  4.100123093s\r\n\r\nmcli: <DEBUG> PUT /tmp/large.zip?partNumber=1&uploadId=c87445c7-22d5-4172-9d12-4c24170eb179 HTTP/1.1\r\nHost: minio.toast.cafe\r\nUser-Agent: MinIO (linux; amd64) minio-go/v6.0.45 mcli/2019-12-17T23:26:28Z\r\nContent-Length: 134217728\r\nAuthorization: AWS4-HMAC-SHA256 Credential=**REDACTED**/20200107/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=**REDACTED**\r\nX-Amz-Content-Sha256: UNSIGNED-PAYLOAD\r\nX-Amz-Date: 20200107T014440Z\r\nAccept-Encoding: gzip\r\n\r\nmcli: <DEBUG> HTTP/1.1 200 OK\r\nContent-Length: 0\r\nAccept-Ranges: bytes\r\nContent-Security-Policy: block-all-mixed-content\r\nDate: Tue, 07 Jan 2020 01:43:55 GMT\r\nEtag: \"56ef370a9ee959e7cd9e1541ca2aa14f-1\"\r\nServer: Caddy\r\nServer: MinIO/DEVELOPMENT.2019-12-22T23-03-51Z\r\nVary: Origin\r\nX-Amz-Request-Id: 15E7775BDDFB3685\r\nX-Xss-Protection: 1; mode=block\r\n\r\nmcli: <DEBUG> Response Time:  4.572582037s\r\n```","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/571390978/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/571397098","html_url":"https://github.com/rclone/rclone/issues/3835#issuecomment-571397098","issue_url":"https://api.github.com/repos/rclone/rclone/issues/3835","id":571397098,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MTM5NzA5OA==","user":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-07T01:54:50Z","updated_at":"2020-01-07T01:57:12Z","body":"As a further note, performance is fine when going against the minio server directly (via http://fafnir).\r\nThere are still no HTTP 100s being returned, though, so I guess that can't be it.\r\nIt's a bit too long to paste here, so [here](https://brpaste.xyz/2b_5LA) is a paste of what it looks like against a direct remote.\r\n\r\nSo to summarize, to the best of my understanding, it is not the lack of 100-Continue, because:\r\n1. Performance is fine against `http://` without it occurring.\r\n2. Performance is fine using `mcli` (through the https proxy) without it occurring.\r\n3. The specification does not explicitly allow for it.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/571397098/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/572558352","html_url":"https://github.com/rclone/rclone/issues/3835#issuecomment-572558352","issue_url":"https://api.github.com/repos/rclone/rclone/issues/3835","id":572558352,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MjU1ODM1Mg==","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-09T13:21:42Z","updated_at":"2020-01-09T13:21:42Z","body":"> However, based on all of this, my understanding is that 100-Continue should not be used or present in multipart uploads.\r\n> Am I missing something?\r\n\r\nRclone uses the AWS SDK for its s3 interactions and it is the AWS SDK that sets expect/continue up.  So I'd be really surprised if that isn't the proper way of interacting with s3.  Note I integration test rclone with aws/digital ocean/wasabi/ceph/alibaba all of which have their own s3 implementations, all of which are happy with expect/continue.\r\n\r\n> So to summarize, to the best of my understanding, it is not the lack of 100-Continue,\r\n\r\nI think that 60 second timeout is the thing to dig into.  Are any timeouts in the proxy 60s?\r\n\r\nIs the proxy doing reverse DNS on a non-existent name and timing out after 60s?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/572558352/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/572562358","html_url":"https://github.com/rclone/rclone/issues/3835#issuecomment-572562358","issue_url":"https://api.github.com/repos/rclone/rclone/issues/3835","id":572562358,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MjU2MjM1OA==","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-09T13:32:04Z","updated_at":"2020-01-09T13:32:04Z","body":"I had a thought, there is one timer that is 60s in rclone\r\n\r\n          --contimeout duration                  Connect timeout (default 1m0s)\r\n\r\nCan you try setting that to a different amount and see if it changes things?\r\n\r\nIf that is the problem then it means that the proxy probably needs to have more simultaneous connections configured.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/572562358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/572568665","html_url":"https://github.com/rclone/rclone/issues/3835#issuecomment-572568665","issue_url":"https://api.github.com/repos/rclone/rclone/issues/3835","id":572568665,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MjU2ODY2NQ==","user":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-09T13:47:14Z","updated_at":"2020-01-09T13:47:14Z","body":"> Rclone uses the AWS SDK for its s3 interactions and it is the AWS SDK that sets expect/continue up.\r\n\r\nThat's kind of strange, I didn't have any issues using aws-cli.\r\n> Can you try setting that to a different amount and see if it changes things?\r\n\r\nIt changes how much time is taken between uploads of 5M at a time, but overall performance is still ~10x lower than it should be (expected, since the timeouts still happen).\r\n> If that is the problem then it means that the proxy probably needs to have more simultaneous connections configured.\r\n\r\nThe proxy has no connection limit.\r\nCaddy does not know how to limit incoming external connections (if it did, it wouldn't be a very useful web/rproxy server, would it?), and defaults (used in this case) to no limits to the connections to the backend when acting as an rproxy.\r\nFurther, as mentioned, there are no issues when going through the rproxy with aws-cli, s3cmd or minio-client.\r\n\r\nSo the problem then appears to be rclone thinking it's timing out in the connect phase, then?","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/572568665/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2935053389,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI5MzUwNTMzODk=","url":"https://api.github.com/repos/rclone/rclone/issues/events/2935053389","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"bd5cae21e63482984061f6923e628f65f9945d41","commit_url":"https://api.github.com/repos/rclone/rclone/commits/bd5cae21e63482984061f6923e628f65f9945d41","created_at":"2020-01-09T14:01:12Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/572574695","html_url":"https://github.com/rclone/rclone/issues/3835#issuecomment-572574695","issue_url":"https://api.github.com/repos/rclone/rclone/issues/3835","id":572574695,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MjU3NDY5NQ==","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-09T14:02:38Z","updated_at":"2020-01-09T14:02:38Z","body":"> So the problem then appears to be rclone thinking it's timing out in the connect phase, then?\r\n\r\nIt looks like it yet.\r\n\r\nI suspect if you used another tool based on the AWS go CLI (which aws-cli isn't - it is python) you'd see the same result.\r\n\r\nI just noticed I set the expect continue timeout to the same 60s by default which is defintely a mistake...\r\n\r\nTry this which sets the expect continue to 1s\r\n\r\nhttps://beta.rclone.org/branch/v1.50.2-124-gbd5cae21-fix-3835-expect-continue-beta/ (uploaded in 15-30 mins)\r\n\r\nIf that works properly then it means that the proxy isn't supporting expect/continue properly\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/572574695/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/572578603","html_url":"https://github.com/rclone/rclone/issues/3835#issuecomment-572578603","issue_url":"https://api.github.com/repos/rclone/rclone/issues/3835","id":572578603,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MjU3ODYwMw==","user":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-09T14:12:52Z","updated_at":"2020-01-09T14:12:52Z","body":"> If that works properly then it means that the proxy isn't supporting expect/continue properly\r\n\r\nThis works the same way as setting the connection timeout to 1s - better, but still 10+x slower than it should be.\r\nHowever, when I ran rclone against the server directly via http:// I didn't see any 100 responses either.\r\n> I suspect if you used another tool based on the AWS go CLI (which aws-cli isn't - it is python) you'd see the same result.\r\n\r\nAre you aware of any other consumers I could check with?\r\nIt's starting to look like it isn't equivalent to the other SDKs (to avoid saying it's not strictly compliant to the spec).","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/572578603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2935579202,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI5MzU1NzkyMDI=","url":"https://api.github.com/repos/rclone/rclone/issues/events/2935579202","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"081f88e4e0ed5adf103a44171bd12edc89fbfbe3","commit_url":"https://api.github.com/repos/rclone/rclone/commits/081f88e4e0ed5adf103a44171bd12edc89fbfbe3","created_at":"2020-01-09T16:21:53Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/572637478","html_url":"https://github.com/rclone/rclone/issues/3835#issuecomment-572637478","issue_url":"https://api.github.com/repos/rclone/rclone/issues/3835","id":572637478,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MjYzNzQ3OA==","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-09T16:24:13Z","updated_at":"2020-01-09T16:24:13Z","body":"I added an `--expect-continue-timeout` flag.  I suggest you try with 0 which disables expect/continue.\r\n\r\nIf `--expect-continue-timeout 0` works OK then it sounds to me like we've found the issue - the proxy doesn't support expect/continue properly.\r\n\r\nhttps://beta.rclone.org/branch/v1.50.2-124-g081f88e4-fix-3835-expect-continue-beta/ (uploaded in 15-30 mins)","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/572637478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/572652450","html_url":"https://github.com/rclone/rclone/issues/3835#issuecomment-572652450","issue_url":"https://api.github.com/repos/rclone/rclone/issues/3835","id":572652450,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MjY1MjQ1MA==","user":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-09T16:52:57Z","updated_at":"2020-01-09T16:52:57Z","body":"`--expect-continue-timeout=0` works ok; it's still about half the performance I expect (~45MB/s instead of >100) but it's **much** better than previously.\r\n\r\nBased on this:\r\n1. Is it possible to configure expect-continue-timeout in a config file? It'd be nice if I didn't have to explicitly specify it in the command line.\r\n2. Let's put a pin on this until caddy2 is released (they're in the beta stage right now), at which point I'll try to write a minimal case to reproduce this.\r\n\r\nre: part 2 of 2. - do you have any idea of a good way to demonstrate the faulty behavior in a maximally minimal way?","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/572652450/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2960130701,"node_id":"MDExOkNsb3NlZEV2ZW50Mjk2MDEzMDcwMQ==","url":"https://api.github.com/repos/rclone/rclone/issues/events/2960130701","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"277d94feac563e2c3a64c16e77cbe63ef88d63f8","commit_url":"https://api.github.com/repos/rclone/rclone/commits/277d94feac563e2c3a64c16e77cbe63ef88d63f8","created_at":"2020-01-18T09:51:51Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/575884020","html_url":"https://github.com/rclone/rclone/issues/3835#issuecomment-575884020","issue_url":"https://api.github.com/repos/rclone/rclone/issues/3835","id":575884020,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTg4NDAyMA==","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-18T09:53:50Z","updated_at":"2020-01-18T09:53:50Z","body":"I've merged this to master now which means it will be in [the latest beta](https://beta.rclone.org) in 15-30 mins and released in v1.51\r\n\r\n> Is it possible to configure expect-continue-timeout in a config file? It'd be nice if I didn't have to explicitly specify it in the command line.\r\n\r\nNot currently... You can set an environment variable though `RCLONE_EXPECT_CONTINUE_TIMEOUT` though.\r\n\r\n> t's put a pin on this until caddy2 is released (they're in the beta stage right now), at which point I'll try to write a minimal case to reproduce this.\r\n\r\nOK - when caddy2 comes out then please retest and re-open if necessary!\r\n\r\n> re: part 2 of 2. - do you have any idea of a good way to demonstrate the faulty behavior in a maximally minimal way?\r\n\r\nProbably varying --expect-continue-timeout and measuring the performance is a pretty good way.\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/575884020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}}]