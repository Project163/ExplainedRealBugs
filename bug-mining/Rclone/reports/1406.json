{"url":"https://api.github.com/repos/rclone/rclone/issues/8686","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/8686/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/8686/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/8686/events","html_url":"https://github.com/rclone/rclone/issues/8686","id":3230279462,"node_id":"I_kwDOAQ-n5M7Aiicm","number":8686,"title":"Rclone cannot list or access files via S3 Access Point (cross-account), but AWS CLI works","user":{"login":"msaavedra91","id":12854843,"node_id":"MDQ6VXNlcjEyODU0ODQz","avatar_url":"https://avatars.githubusercontent.com/u/12854843?v=4","gravatar_id":"","url":"https://api.github.com/users/msaavedra91","html_url":"https://github.com/msaavedra91","followers_url":"https://api.github.com/users/msaavedra91/followers","following_url":"https://api.github.com/users/msaavedra91/following{/other_user}","gists_url":"https://api.github.com/users/msaavedra91/gists{/gist_id}","starred_url":"https://api.github.com/users/msaavedra91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/msaavedra91/subscriptions","organizations_url":"https://api.github.com/users/msaavedra91/orgs","repos_url":"https://api.github.com/users/msaavedra91/repos","events_url":"https://api.github.com/users/msaavedra91/events{/privacy}","received_events_url":"https://api.github.com/users/msaavedra91/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399007,"node_id":"MDU6TGFiZWw4NjM5OTAwNw==","url":"https://api.github.com/repos/rclone/rclone/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":null},{"id":314138213,"node_id":"MDU6TGFiZWwzMTQxMzgyMTM=","url":"https://api.github.com/repos/rclone/rclone/labels/Remote:%20S3","name":"Remote: S3","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/rclone/rclone/milestones/59","html_url":"https://github.com/rclone/rclone/milestone/59","labels_url":"https://api.github.com/repos/rclone/rclone/milestones/59/labels","id":12156302,"node_id":"MI_kwDOAQ-n5M4AuX2O","number":59,"title":"v1.71","description":"","creator":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":19,"state":"closed","created_at":"2025-01-13T10:56:12Z","updated_at":"2025-09-04T10:21:24Z","due_on":"2025-08-23T07:00:00Z","closed_at":"2025-09-04T10:21:24Z"},"comments":6,"created_at":"2025-07-14T23:21:49Z","updated_at":"2025-09-03T14:23:49Z","closed_at":"2025-08-21T23:02:53Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### The associated forum post URL from `https://forum.rclone.org`\nhttps://forum.rclone.org/t/rclone-cannot-list-or-access-files-via-s3-access-point-cross-account-but-aws-cli-works/51913\n\n\n#### What is the problem you are having with rclone?\nrclone cannot list or access files via an S3 Access Point (cross-account). The same operation works with AWS CLI using the same credentials and Access Point ARN. The Access Point policy allows all required actions. rclone always returns \"directory not found\" or the buckets of the account where I am executing the command and not the ones from the account I want, even though files exist and are accessible via AWS CLI.\n\n\n#### What is your rclone version (output from `rclone version`)\n```\nrclone v1.70.3\n- os/version: Microsoft Windows Server 2022 Datacenter 21H2 21H2 (64 bit)\n- os/kernel: 10.0.20348.3091 (x86_64)\n- os/type: windows\n- os/arch: amd64\n- go/version: go1.24.4\n- go/linking: static\n- go/tags: cmount\n```\n\n\n#### Which OS you are using and how many bits (e.g. Windows 7, 64 bit)\nMicrosoft Windows Server 2022 Datacenter 21H2 21H2 (64 bit)\n\n\n#### Which cloud storage system are you using? (e.g. Google Drive)\nAmazon S3 (via S3 Access Point, cross-account)\n\n#### My config\n```\n[originals-aoc-1-full]\ntype = s3\nprovider = AWS\nenv_auth = true\nregion = us-west-2\nlocation_constraint = us-west-2\nendpoint = https://originals-aoc1-full-access-2222222222.s3-accesspoint.us-west-2.amazonaws.com\ns3_use_arn_region = true\ns3_force_path_style = false\nserver_side_encryption = AES256\nstorage_class = STANDARD\n\n[originals-aoc-1-restricted]\ntype = s3\nprovider = AWS\nenv_auth = true\nregion = us-west-2\nendpoint = https://originals-aoc1-restricted-access-2222222222.s3-accesspoint.us-west-2.amazonaws.com\nno_check_bucket = true\nno_head = true\nserver_side_encryption = AES256\nstorage_class = STANDARD\n```\n\n\n#### The command you were trying to run (e.g. `rclone copy /tmp remote:tmp`)\nFrom my account 11111111111 (where my server is) trying to connect to the bucket from 222222222222\n\n`rclone ls originals-aoc-1-restricted:PROJECT_DELETE/ --config=\"C:\\temp\\rclone-test\\rclone-test.conf\" -vv`\n\nor\n\n`rclone lsd originals-aoc-1-full: --config \"C:\\Program Files\\rclone\\rclone.conf\" -vv --dump headers`\n\n\n#### A log from the command with the `-vv` flag (e.g. output from `rclone -vv copy /tmp remote:tmp`)\n```\n2025/07/10 03:08:19 DEBUG : rclone: Version \"v1.69.0\" starting with parameters [\"C:\\\\Windows\\\\system32\\\\rclone.exe\" \"ls\" \"originals-aoc-1-restricted:PROJECT_DELETE/\" \"--config=C:\\\\temp\\\\rclone-test\\\\rclone-test.conf\" \"-vv\"]\n2025/07/10 03:08:19 DEBUG : Creating backend with remote \"originals-aoc-1-restricted:PROJECT_DELETE/\"\n2025/07/10 03:08:19 DEBUG : Using config file from \"C:\\\\temp\\\\rclone-test\\\\rclone-test.conf\"\n2025/07/10 03:08:19 DEBUG : fs cache: renaming cache item \"originals-aoc-1-restricted:PROJECT_DELETE/\" to be canonical \"originals-aoc-1-restricted:PROJECT_DELETE\"\n2025/07/10 03:08:19 DEBUG : 3 go routines active\n2025/07/10 03:08:19 NOTICE: Failed to ls: directory not found\n```\n\nor\n\n```\n2025/07/10 15:45:14 NOTICE: Automatically setting -vv as --dump is enabled\n2025/07/10 15:45:14 DEBUG : rclone: Version \"v1.70.3\" starting with parameters [\"C:\\\\Windows\\\\system32\\\\rclone.exe\" \"lsd\" \"--config=C:\\\\temp\\\\rclone-test\\\\rclone-test.conf\" \"originals-aoc-1-restricted:\" \"-vv\" \"--dump=headers\"]\n2025/07/10 15:45:14 DEBUG : Creating backend with remote \"originals-aoc-1-restricted:\"\n2025/07/10 15:45:14 DEBUG : Using config file from \"C:\\\\temp\\\\rclone-test\\\\rclone-test.conf\"\n2025/07/10 15:45:14 DEBUG : You have specified to dump information. Please be noted that the Accept-Encoding as shown may not be correct in the request and the response may not show Content-Encoding if the go standard libraries auto gzip encoding was in effect. In this case the body of the request will be gunzipped before showing it.\n2025/07/10 15:45:14 DEBUG : You have specified to dump information. Please be noted that the Accept-Encoding as shown may not be correct in the request and the response may not show Content-Encoding if the go standard libraries auto gzip encoding was in effect. In this case the body of the request will be gunzipped before showing it.\n2025/07/10 15:45:14 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\n2025/07/10 15:45:14 DEBUG : HTTP REQUEST (req 0xc0002feb40)\n2025/07/10 15:45:14 DEBUG : GET /?x-id=ListBuckets HTTP/1.1\nHost: originals-aoc1-restricted-access-2222222222.s3-accesspoint.us-west-2.amazonaws.com\nUser-Agent: rclone/v1.70.3\nAccept-Encoding: identity\nAmz-Sdk-Invocation-Id: 07bc1605-d524-444e-8f5a-65b40911a685\nAmz-Sdk-Request: attempt=1; max=10\nAuthorization: XXXX\nX-Amz-Content-Sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\nX-Amz-Date: 20250710T154514Z\nX-Amz-Security-Token: IQoJb3JpZ2luX2VjELj//////////wEaCXVzLXdlc3QtMiJHMEUCIArQXJHPHc/PKk0wTvDLNd4W+vzGy1b8aZtHWy+WnoyfAiEAvpTDzH+tp9sDytVd7DGSqubsYgGeHtUFtkQq1h9XWBQqxQUIwf//////////ARAAGgwwNTQwMzcxMzk0MDAiDOuSAByT5eyViqrFwyqZBfGRm1wSf5dJXHQ4fSQbPPwOKMmm2F4YBqxkwdcQ7g/k53fRM2NOyBnWbp9w/gm4pLk2rgUol6pl7y0edzyA8JIhknDFFwNiV5ugvANDU/VpRXXnHxwbybywQ9vjtzd1fam9ym1BBo77FCkFh8nTzrRHyF2KKWnY/amwXPAC/GGfaR/nOBcqDabn9eg7Lh3rraZCggrLB9habxV86+WQrpdaqMCmub4Ux5zHW+PhsSZJY4fTIM0CHcLp4iV1or1Q/Bu4WaUJ5qV13F6rRYMZpwiR0yznlL05lrRsWxhmNmFgLo06m/rE0uqglpQ6i3HcVZyF0XK4Shpvg79x8DGudAEcH5AU3BrEB/seUz2I8MQIIacPTyj4OQmmr9D1dDxelhDaZ0PoHUUHfdLzIpSE0gb1RtyUEhedL8EfpzRIxvfGL1gHRYmUBhBOFKbLO06BrnUUsL6w3qa6QzURthvLruw7ZiQNE+/gN6StEf5FCBOgD2hqTHKyMLLkjTRR2dfOZe/w9936xZVUtgMPwlPUJtSblzH2vDTBzASH4MeCCZymlSLmIUfGE28bVXtCvZF2agGnHrjq18UMBrfdtVJ/hzb2VpwLdH1rMQYlmCzJWqH5H3IvwYzC3HVKVerrjz1Nj4F0zrQYDkmjKPAJNx9eGBCAq+Srae43xHsGaEsN8Pq5z8BpZY8QDUIMhHL7lkcVTK31RM2BE8tIdi8Qh15xAvIuBT5Qi7Fha6QBhmN7EdwWR/LDtDFYf4KraQ7C2yhfr6GgnTHYuNUViXROOxzG1J19c5TsbMBLfB3oEc9dNJj7ngz3pWPdnwwnqVWvrRdQjQoXXqBpHW2y0kIoZwkd0XT3PDhMTy19p4/o3i+6iMrgyV1F3ze0GHckMOq7v8MGOrEBqmHXqlljKkX0HmwTmSwDRr7xMJPuJpwsSpoXQ9I1vuoNE1S4XFKkkKpQFFHpsDqurcfa4Q/odN6JghNDRXf87tA8Ndin62Ur4lQsxmktYb99hA4kXGNe9rLijcFra8OGAnXelymQh8FiQWr56K/APAjLo96/4o8nHf30o67WvgqHKlqxYbVHOtLLBfkBq3V6APOFSH81Yyp0iXCju4CEoe0ci/C8OuoNqa50aHp0MxQd\n\n2025/07/10 15:45:14 DEBUG : >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\n2025/07/10 15:45:14 DEBUG : <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n2025/07/10 15:45:14 DEBUG : HTTP RESPONSE (req 0xc0002feb40)\n2025/07/10 15:45:14 DEBUG : HTTP/1.1 200 OK\nTransfer-Encoding: chunked\nContent-Type: application/xml\nDate: Thu, 10 Jul 2025 15:45:15 GMT\nServer: AmazonS3\nX-Amz-Bucket-Region: us-west-2\nX-Amz-Id-2: 3i5P6F+wYhSPdhL5g4tlVIvydMqy5DRqh53fR/2y8PELYUwx3M6Ec+MXlR9+70am4atnXQmgvTk=\nX-Amz-Request-Id: 59VD8JHJ1FM95A49\n\n2025/07/10 15:45:14 DEBUG : <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n2025/07/10 15:45:14 DEBUG : 4 go routines active\n```\n\n```\nGET /?x-id=ListBuckets HTTP/1.1\nHost: originals-aoc1-full-access-222222222222.s3-accesspoint.us-west-2.amazonaws.com\n```\n\nAWS responds 200 OK, but returns the buckets in the server account (which is not what I need. I need the buckets from 222222222222).\n\nI guess rclone just tries ListBuckets against the access point hostname, which is unsupported by AWS S3 access points\n\n\n<!--- Please keep the note below for others who read your bug report. -->\n\n#### How to use GitHub\n\n* Please use the üëç [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to show that you are affected by the same issue.\n* Please don't comment if you have no relevant information to add. It's just extra noise for everyone subscribed to this issue.\n* Subscribe to receive notifications on status change and new comments.\n","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/8686/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/8686/timeline","performed_via_github_app":null,"state_reason":"completed"}