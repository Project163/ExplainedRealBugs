{"url":"https://api.github.com/repos/rclone/rclone/issues/5139","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/5139/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/5139/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/5139/events","html_url":"https://github.com/rclone/rclone/issues/5139","id":834276812,"node_id":"MDU6SXNzdWU4MzQyNzY4MTI=","number":5139,"title":"Mounting union includes the root filesystem","user":{"login":"robertbaker","id":51850403,"node_id":"MDQ6VXNlcjUxODUwNDAz","avatar_url":"https://avatars.githubusercontent.com/u/51850403?v=4","gravatar_id":"","url":"https://api.github.com/users/robertbaker","html_url":"https://github.com/robertbaker","followers_url":"https://api.github.com/users/robertbaker/followers","following_url":"https://api.github.com/users/robertbaker/following{/other_user}","gists_url":"https://api.github.com/users/robertbaker/gists{/gist_id}","starred_url":"https://api.github.com/users/robertbaker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/robertbaker/subscriptions","organizations_url":"https://api.github.com/users/robertbaker/orgs","repos_url":"https://api.github.com/users/robertbaker/repos","events_url":"https://api.github.com/users/robertbaker/events{/privacy}","received_events_url":"https://api.github.com/users/robertbaker/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399005,"node_id":"MDU6TGFiZWw4NjM5OTAwNQ==","url":"https://api.github.com/repos/rclone/rclone/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":306063362,"node_id":"MDU6TGFiZWwzMDYwNjMzNjI=","url":"https://api.github.com/repos/rclone/rclone/labels/Remote:%20Local%20FS","name":"Remote: Local FS","color":"fbca04","default":false,"description":""},{"id":1076920341,"node_id":"MDU6TGFiZWwxMDc2OTIwMzQx","url":"https://api.github.com/repos/rclone/rclone/labels/Remote:%20Union","name":"Remote: Union","color":"fbca04","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/rclone/rclone/milestones/43","html_url":"https://github.com/rclone/rclone/milestone/43","labels_url":"https://api.github.com/repos/rclone/rclone/milestones/43/labels","id":5847508,"node_id":"MDk6TWlsZXN0b25lNTg0NzUwOA==","number":43,"title":"v1.55","description":"","creator":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":55,"state":"closed","created_at":"2020-09-05T13:45:35Z","updated_at":"2021-04-03T13:38:18Z","due_on":"2021-03-31T07:00:00Z","closed_at":"2021-04-03T13:38:18Z"},"comments":4,"created_at":"2021-03-18T00:22:14Z","updated_at":"2021-03-24T09:48:13Z","closed_at":"2021-03-24T09:48:07Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### What is the problem you are having with rclone?\r\nI updated to the latest beta and now my union includes the entire root filesystem and it's not mounting the remote.\r\n\r\nThis only seems to affect mounting a union, mounting a remote directly works as expected.\r\n\r\nrclone is including the root fileystem in the union, even though it's not specified as a upstream branch. This issue only affects the recent 1.55 beta's and I believe were caused by the refactoring of the fsPath and splitPath code, see commit https://github.com/rclone/rclone/commit/f17d7c00126ed567e0fbf2710f2726cf92c26dfe\r\n\r\nReverting to 1.5.4.1 does not have this bug and works as expected..\r\n\r\n\r\n#### What is your rclone version (output from `rclone version`)\r\n```\r\nv1.55.0-beta.5314.e59acd16c\r\n- os/arch: linux/amd64\r\n- go version: go1.15.8\r\n```\r\n\r\n\r\n#### Which OS you are using and how many bits (e.g. Windows 7, 64 bit)\r\nUbuntu 20.04\r\n\r\n\r\n####  Which cloud storage system are you using? (e.g. Google Drive)\r\nn/a\r\n\r\n\r\n#### The command you were trying to run (e.g. `rclone copy /tmp remote:tmp`)\r\n`rclone mount gdrive-union:/ /data/union`\r\n\r\n`ls /data/union` -> shows `ls / && ls /data/local`\r\n\r\n```\r\n[gdrive]\r\ntype = drive\r\n(omitted for brevity)\r\n\r\n[gdrive-local]\r\ntype = local\r\n\r\n[gdrive-union]\r\ntype = union\r\nupstreams = gdrive-local:/data/local gdrive:/:nc\r\ncreate_policy = ff\r\n```\r\n\r\n#### A log from the command with the `-vv` flag (e.g. output from `rclone -vv copy /tmp remote:tmp`)\r\nn/a\r\n\r\n","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/5139/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/5139/timeline","performed_via_github_app":null,"state_reason":"completed"}