[{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1636981601","html_url":"https://github.com/rclone/rclone/issues/7141#issuecomment-1636981601","issue_url":"https://api.github.com/repos/rclone/rclone/issues/7141","id":1636981601,"node_id":"IC_kwDOAQ-n5M5hklth","user":{"login":"ahmedjafri","id":1191297,"node_id":"MDQ6VXNlcjExOTEyOTc=","avatar_url":"https://avatars.githubusercontent.com/u/1191297?v=4","gravatar_id":"","url":"https://api.github.com/users/ahmedjafri","html_url":"https://github.com/ahmedjafri","followers_url":"https://api.github.com/users/ahmedjafri/followers","following_url":"https://api.github.com/users/ahmedjafri/following{/other_user}","gists_url":"https://api.github.com/users/ahmedjafri/gists{/gist_id}","starred_url":"https://api.github.com/users/ahmedjafri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ahmedjafri/subscriptions","organizations_url":"https://api.github.com/users/ahmedjafri/orgs","repos_url":"https://api.github.com/users/ahmedjafri/repos","events_url":"https://api.github.com/users/ahmedjafri/events{/privacy}","received_events_url":"https://api.github.com/users/ahmedjafri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-16T04:56:02Z","updated_at":"2023-07-16T04:56:02Z","body":"It looks like setting `max_upload_parts = 50000`  seems to have mitigated the problem. Running for an hour at `~ 300MB` ","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1636981601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ahmedjafri","id":1191297,"node_id":"MDQ6VXNlcjExOTEyOTc=","avatar_url":"https://avatars.githubusercontent.com/u/1191297?v=4","gravatar_id":"","url":"https://api.github.com/users/ahmedjafri","html_url":"https://github.com/ahmedjafri","followers_url":"https://api.github.com/users/ahmedjafri/followers","following_url":"https://api.github.com/users/ahmedjafri/following{/other_user}","gists_url":"https://api.github.com/users/ahmedjafri/gists{/gist_id}","starred_url":"https://api.github.com/users/ahmedjafri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ahmedjafri/subscriptions","organizations_url":"https://api.github.com/users/ahmedjafri/orgs","repos_url":"https://api.github.com/users/ahmedjafri/repos","events_url":"https://api.github.com/users/ahmedjafri/events{/privacy}","received_events_url":"https://api.github.com/users/ahmedjafri/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1637030447","html_url":"https://github.com/rclone/rclone/issues/7141#issuecomment-1637030447","issue_url":"https://api.github.com/repos/rclone/rclone/issues/7141","id":1637030447,"node_id":"IC_kwDOAQ-n5M5hkxov","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-16T09:05:33Z","updated_at":"2023-07-16T09:05:33Z","body":"How many and how big are the files you are uploading?\r\n\r\nI suspect you are uploading multiple files bigger than 10,000 * 5M = 50 GB\r\n\r\nSince these files don't fit in the normal chunk size, rclone will be increasing the chunk size. However this means that the file gets its own memory pool to fit the new sized chunks. Potentially if you have a files which vary in size you'll get multiple memory pools leading to memory exhaustion.\r\n\r\nThis would be easy to confirm with a debug log with `-vv`. If you have one can you attach one? Or if you want to sent it to me confidentially then email it to nick@craig-wood.com with a link to this github issue in it.\r\n\r\nThere was an issue and/or a forum thread about this very recently but I can't find it at the moment.\r\n\r\n> It looks like setting `max_upload_parts = 50000` seems to have mitigated the problem. Running for an hour at `~ 300MB`\r\n\r\nYou must be using a non AWS system as [10,000 is the maximum for AWS](https://docs.aws.amazon.com/AmazonS3/latest/userguide/qfacts.html).\r\n\r\nThis fixes the problems provided your files are less than 50,000 * 5MB = 250 GB in size by making sure that all the buffers in use are the same size (5MB).\r\n\r\nAssuming this is the problem, other workarounds are\r\n\r\nSet `--s3-chunk-size 25M` - provided all your files are less than 10,000 * 25M = 250GB all files will use the same 5MB buffer.\r\n\r\nYou can also use these flags to help rclone return memory to the OS\r\n\r\n      --s3-memory-pool-flush-time Duration   How often internal memory buffer pools will be flushed (default 1m0s)\r\n      --s3-memory-pool-use-mmap              Whether to use mmap buffers in internal memory pool\r\n\r\nYou'd use `--s3-memory-pool-use-mmap` and `--s3-memory-pool-flush-time 1s`\r\n\r\nHowever all of these are workarounds to the fact rclone is not doing a good job managing memory here!\r\n\r\nPerhaps rclone should be using a scatter/gather memory allocator to synthetically make the bigger buffers from the smaller once. This would be the most efficient solution.\r\n\r\nAnother solution would be for rclone to only allocate buffer sizes in factors of 2 from the default. So allocate pools at 5MB, 10MB, 20MB, 40MB rather than lots of intermediate sizes which means rclone can't share the memory.\r\n\r\nOr maybe rclone's memory allocator should be re-worked so that it can keep buffers of more than one size.\r\n\r\nIf you are working on behalf of a company you might be interested in taking out a [support contract](https://rclone.com/support) then I could do this work as part of it and it helps keep the rclone project sustainable.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1637030447/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":9830767873,"node_id":"LE_lADOAQ-n5M5rq67uzwAAAAJJ9Z0B","url":"https://api.github.com/repos/rclone/rclone/issues/events/9830767873","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-07-16T09:05:47Z","label":{"name":"bug","color":"fc2929"},"performed_via_github_app":null},{"id":9830767876,"node_id":"LE_lADOAQ-n5M5rq67uzwAAAAJJ9Z0E","url":"https://api.github.com/repos/rclone/rclone/issues/events/9830767876","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-07-16T09:05:47Z","label":{"name":"Remote: S3","color":"fbca04"},"performed_via_github_app":null},{"id":10101531320,"node_id":"REFE_lADOAQ-n5M5rq67uzwAAAAJaGSK4","url":"https://api.github.com/repos/rclone/rclone/issues/events/10101531320","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"dfd00d97450487750eb03a3b6598c7c3dca11d3b","commit_url":"https://api.github.com/repos/rclone/rclone/commits/dfd00d97450487750eb03a3b6598c7c3dca11d3b","created_at":"2023-08-15T21:15:15Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1679626220","html_url":"https://github.com/rclone/rclone/issues/7141#issuecomment-1679626220","issue_url":"https://api.github.com/repos/rclone/rclone/issues/7141","id":1679626220,"node_id":"IC_kwDOAQ-n5M5kHQ_s","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-15T21:16:13Z","updated_at":"2023-08-15T21:16:13Z","body":"This should fix the problem properly\r\n\r\n[v1.64.0-beta.7247.5bd9e6527.multithread](https://beta.rclone.org/branch/multithread/v1.64.0-beta.7247.5bd9e6527.multithread/) on branch [multithread](https://github.com/rclone/rclone/tree/multithread) (uploaded in 15-30 mins)\r\n\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/1679626220/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-15T21:18:07Z","updated_at":"2023-08-15T21:18:07Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/rclone/rclone/issues/7056","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/7056/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/7056/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/7056/events","html_url":"https://github.com/rclone/rclone/issues/7056","id":1756483560,"node_id":"I_kwDOAQ-n5M5osc_o","number":7056,"title":"allow parallel/multithreaded/multipart transfers between remotes","user":{"login":"jorjao81","id":6204,"node_id":"MDQ6VXNlcjYyMDQ=","avatar_url":"https://avatars.githubusercontent.com/u/6204?v=4","gravatar_id":"","url":"https://api.github.com/users/jorjao81","html_url":"https://github.com/jorjao81","followers_url":"https://api.github.com/users/jorjao81/followers","following_url":"https://api.github.com/users/jorjao81/following{/other_user}","gists_url":"https://api.github.com/users/jorjao81/gists{/gist_id}","starred_url":"https://api.github.com/users/jorjao81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jorjao81/subscriptions","organizations_url":"https://api.github.com/users/jorjao81/orgs","repos_url":"https://api.github.com/users/jorjao81/repos","events_url":"https://api.github.com/users/jorjao81/events{/privacy}","received_events_url":"https://api.github.com/users/jorjao81/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399007,"node_id":"MDU6TGFiZWw4NjM5OTAwNw==","url":"https://api.github.com/repos/rclone/rclone/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":null},{"id":314138213,"node_id":"MDU6TGFiZWwzMTQxMzgyMTM=","url":"https://api.github.com/repos/rclone/rclone/labels/Remote:%20S3","name":"Remote: S3","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/rclone/rclone/milestones/56","html_url":"https://github.com/rclone/rclone/milestone/56","labels_url":"https://api.github.com/repos/rclone/rclone/milestones/56/labels","id":10662391,"node_id":"MI_kwDOAQ-n5M4AorH3","number":56,"title":"v1.68","description":"","creator":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":13,"state":"closed","created_at":"2024-03-10T12:33:56Z","updated_at":"2024-09-11T21:18:36Z","due_on":"2024-09-08T07:00:00Z","closed_at":"2024-09-11T21:18:36Z"},"comments":25,"created_at":"2023-06-14T09:43:59Z","updated_at":"2024-08-16T05:05:29Z","closed_at":"2024-08-16T05:05:29Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":17803236,"node_id":"MDEwOlJlcG9zaXRvcnkxNzgwMzIzNg==","name":"rclone","full_name":"rclone/rclone","private":false,"owner":{"login":"rclone","id":24937341,"node_id":"MDEyOk9yZ2FuaXphdGlvbjI0OTM3MzQx","avatar_url":"https://avatars.githubusercontent.com/u/24937341?v=4","gravatar_id":"","url":"https://api.github.com/users/rclone","html_url":"https://github.com/rclone","followers_url":"https://api.github.com/users/rclone/followers","following_url":"https://api.github.com/users/rclone/following{/other_user}","gists_url":"https://api.github.com/users/rclone/gists{/gist_id}","starred_url":"https://api.github.com/users/rclone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rclone/subscriptions","organizations_url":"https://api.github.com/users/rclone/orgs","repos_url":"https://api.github.com/users/rclone/repos","events_url":"https://api.github.com/users/rclone/events{/privacy}","received_events_url":"https://api.github.com/users/rclone/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/rclone/rclone","description":"\"rsync for cloud storage\" - Google Drive, S3, Dropbox, Backblaze B2, One Drive, Swift, Hubic, Wasabi, Google Cloud Storage, Azure Blob, Azure Files, Yandex Files","fork":false,"url":"https://api.github.com/repos/rclone/rclone","forks_url":"https://api.github.com/repos/rclone/rclone/forks","keys_url":"https://api.github.com/repos/rclone/rclone/keys{/key_id}","collaborators_url":"https://api.github.com/repos/rclone/rclone/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/rclone/rclone/teams","hooks_url":"https://api.github.com/repos/rclone/rclone/hooks","issue_events_url":"https://api.github.com/repos/rclone/rclone/issues/events{/number}","events_url":"https://api.github.com/repos/rclone/rclone/events","assignees_url":"https://api.github.com/repos/rclone/rclone/assignees{/user}","branches_url":"https://api.github.com/repos/rclone/rclone/branches{/branch}","tags_url":"https://api.github.com/repos/rclone/rclone/tags","blobs_url":"https://api.github.com/repos/rclone/rclone/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/rclone/rclone/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/rclone/rclone/git/refs{/sha}","trees_url":"https://api.github.com/repos/rclone/rclone/git/trees{/sha}","statuses_url":"https://api.github.com/repos/rclone/rclone/statuses/{sha}","languages_url":"https://api.github.com/repos/rclone/rclone/languages","stargazers_url":"https://api.github.com/repos/rclone/rclone/stargazers","contributors_url":"https://api.github.com/repos/rclone/rclone/contributors","subscribers_url":"https://api.github.com/repos/rclone/rclone/subscribers","subscription_url":"https://api.github.com/repos/rclone/rclone/subscription","commits_url":"https://api.github.com/repos/rclone/rclone/commits{/sha}","git_commits_url":"https://api.github.com/repos/rclone/rclone/git/commits{/sha}","comments_url":"https://api.github.com/repos/rclone/rclone/comments{/number}","issue_comment_url":"https://api.github.com/repos/rclone/rclone/issues/comments{/number}","contents_url":"https://api.github.com/repos/rclone/rclone/contents/{+path}","compare_url":"https://api.github.com/repos/rclone/rclone/compare/{base}...{head}","merges_url":"https://api.github.com/repos/rclone/rclone/merges","archive_url":"https://api.github.com/repos/rclone/rclone/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/rclone/rclone/downloads","issues_url":"https://api.github.com/repos/rclone/rclone/issues{/number}","pulls_url":"https://api.github.com/repos/rclone/rclone/pulls{/number}","milestones_url":"https://api.github.com/repos/rclone/rclone/milestones{/number}","notifications_url":"https://api.github.com/repos/rclone/rclone/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/rclone/rclone/labels{/name}","releases_url":"https://api.github.com/repos/rclone/rclone/releases{/id}","deployments_url":"https://api.github.com/repos/rclone/rclone/deployments","created_at":"2014-03-16T16:19:57Z","updated_at":"2025-11-09T20:38:02Z","pushed_at":"2025-11-08T21:33:38Z","git_url":"git://github.com/rclone/rclone.git","ssh_url":"git@github.com:rclone/rclone.git","clone_url":"https://github.com/rclone/rclone.git","svn_url":"https://github.com/rclone/rclone","homepage":"https://rclone.org","size":217990,"stargazers_count":53422,"watchers_count":53422,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":4767,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1169,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["azure-blob","azure-blob-storage","azure-files","backblaze-b2","cloud-storage","dropbox","encryption","ftp","fuse-filesystem","go","golang","google-cloud-storage","google-drive","onedrive","openstack-swift","rclone","s3","sftp","sync","webdav"],"visibility":"public","forks":4767,"open_issues":1169,"watchers":53422,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"#### What is your current rclone version (output from `rclone version`)?\r\nv1.63.0\r\n\r\n#### What problem are you are trying to solve?\r\nSpecifically, transfers from S3 to S3 are much slower than they have to be. In our case, the buckets need different credentials, so remote copying is not an option (however, in our experience remote copy is actually *slower* than local copy, and it is also not done in parallel). This happens sequentially, resulting for us in speeds of about 70MiB/s. With multithreading we can download at speeds limited only by disk and network speed. Same thing for upload using multipart.\r\nSo, actually, download to local and re-uploading is faster than a direct copy, but still half the speed we should have; AND requires more fumbling with infrastructure as the disk needs to be big enough for holding the files (> TiB).\r\n\r\nI would like to make the in-memory copy limited only by network (and maybe cpu/mem). Our main problem is S3, but I think the solution should be at least somewhat generic.\r\n\r\nSee related forum post: https://forum.rclone.org/t/s3-s3-large-file-copy/18574/4\r\n\r\n\r\n#### How do you think rclone should be changed to solve that?\r\n\r\nI would actually be happy to receive some opinions on how to go about it ;-)\r\n\r\nMy initial though would be to change (or create a new) the multithreaded downloading to make it more similiar to how multipart uploads work. Instead of simply selecting threads and then using `filesize/threads` to get ranges AND threads,  we would us `chunk-size` for ranges and `download-concurrency` for number of threads.\r\n\r\nThen we could plug this into the multi-part uploading by selecting the same sizes.\r\n\r\nBut I'm fuzzy on the details, and on how to make it more generic.\r\n\r\nIs this a feasible idea? Any other approaches that might be better than the one I suggested?  \r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/7056/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/7056/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"id":10110682794,"node_id":"REFE_lADOAQ-n5M5rq67uzwAAAAJapMaq","url":"https://api.github.com/repos/rclone/rclone/issues/events/10110682794","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"6e213c7c7517b536717536b5f0c1bd4ece2719a1","commit_url":"https://api.github.com/repos/rclone/rclone/commits/6e213c7c7517b536717536b5f0c1bd4ece2719a1","created_at":"2023-08-16T16:40:42Z","performed_via_github_app":null},{"id":10147855441,"node_id":"REFE_lADOAQ-n5M5rq67uzwAAAAJc2_xR","url":"https://api.github.com/repos/rclone/rclone/issues/events/10147855441","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"e1483db75ad920698c6d8d78062a6adec1e00cd9","commit_url":"https://api.github.com/repos/rclone/rclone/commits/e1483db75ad920698c6d8d78062a6adec1e00cd9","created_at":"2023-08-21T16:35:35Z","performed_via_github_app":null},{"id":10180344402,"node_id":"CE_lADOAQ-n5M5rq67uzwAAAAJey7pS","url":"https://api.github.com/repos/rclone/rclone/issues/events/10180344402","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"4c76fac5942bb94f906d5f61b6b41f51c83a8def","commit_url":"https://api.github.com/repos/rclone/rclone/commits/4c76fac5942bb94f906d5f61b6b41f51c83a8def","created_at":"2023-08-24T11:40:38Z","state_reason":null,"performed_via_github_app":null},{"id":10185619328,"node_id":"REFE_lADOAQ-n5M5rq67uzwAAAAJfHDeA","url":"https://api.github.com/repos/rclone/rclone/issues/events/10185619328","actor":{"login":"leekiernan","id":946518,"node_id":"MDQ6VXNlcjk0NjUxOA==","avatar_url":"https://avatars.githubusercontent.com/u/946518?v=4","gravatar_id":"","url":"https://api.github.com/users/leekiernan","html_url":"https://github.com/leekiernan","followers_url":"https://api.github.com/users/leekiernan/followers","following_url":"https://api.github.com/users/leekiernan/following{/other_user}","gists_url":"https://api.github.com/users/leekiernan/gists{/gist_id}","starred_url":"https://api.github.com/users/leekiernan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leekiernan/subscriptions","organizations_url":"https://api.github.com/users/leekiernan/orgs","repos_url":"https://api.github.com/users/leekiernan/repos","events_url":"https://api.github.com/users/leekiernan/events{/privacy}","received_events_url":"https://api.github.com/users/leekiernan/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"a42825a226bc1cf40ffef7ef83984d53e0d59f0b","commit_url":"https://api.github.com/repos/leekiernan/rclone/commits/a42825a226bc1cf40ffef7ef83984d53e0d59f0b","created_at":"2023-08-24T20:10:59Z","performed_via_github_app":null},{"id":11635039489,"node_id":"REFE_lADOAQ-n5M5rq67uzwAAAAK1gJ0B","url":"https://api.github.com/repos/rclone/rclone/issues/events/11635039489","actor":{"login":"deyarchit","id":4198802,"node_id":"MDQ6VXNlcjQxOTg4MDI=","avatar_url":"https://avatars.githubusercontent.com/u/4198802?v=4","gravatar_id":"","url":"https://api.github.com/users/deyarchit","html_url":"https://github.com/deyarchit","followers_url":"https://api.github.com/users/deyarchit/followers","following_url":"https://api.github.com/users/deyarchit/following{/other_user}","gists_url":"https://api.github.com/users/deyarchit/gists{/gist_id}","starred_url":"https://api.github.com/users/deyarchit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deyarchit/subscriptions","organizations_url":"https://api.github.com/users/deyarchit/orgs","repos_url":"https://api.github.com/users/deyarchit/repos","events_url":"https://api.github.com/users/deyarchit/events{/privacy}","received_events_url":"https://api.github.com/users/deyarchit/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"4c76fac5942bb94f906d5f61b6b41f51c83a8def","commit_url":"https://api.github.com/repos/deyarchit/rclone/commits/4c76fac5942bb94f906d5f61b6b41f51c83a8def","created_at":"2024-01-30T00:42:36Z","performed_via_github_app":null}]