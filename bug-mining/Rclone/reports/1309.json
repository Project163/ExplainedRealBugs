{"url":"https://api.github.com/repos/rclone/rclone/issues/8078","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/8078/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/8078/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/8078/events","html_url":"https://github.com/rclone/rclone/issues/8078","id":2528673669,"node_id":"I_kwDOAQ-n5M6WuH-F","number":8078,"title":"AzureBlobStorage Env_Auth setting forces system managed identity","user":{"login":"niklashha","id":181750298,"node_id":"U_kgDOCtVKGg","avatar_url":"https://avatars.githubusercontent.com/u/181750298?v=4","gravatar_id":"","url":"https://api.github.com/users/niklashha","html_url":"https://github.com/niklashha","followers_url":"https://api.github.com/users/niklashha/followers","following_url":"https://api.github.com/users/niklashha/following{/other_user}","gists_url":"https://api.github.com/users/niklashha/gists{/gist_id}","starred_url":"https://api.github.com/users/niklashha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/niklashha/subscriptions","organizations_url":"https://api.github.com/users/niklashha/orgs","repos_url":"https://api.github.com/users/niklashha/repos","events_url":"https://api.github.com/users/niklashha/events{/privacy}","received_events_url":"https://api.github.com/users/niklashha/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399007,"node_id":"MDU6TGFiZWw4NjM5OTAwNw==","url":"https://api.github.com/repos/rclone/rclone/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":null},{"id":1043114791,"node_id":"MDU6TGFiZWwxMDQzMTE0Nzkx","url":"https://api.github.com/repos/rclone/rclone/labels/Remote:%20Azure%20Blob","name":"Remote: Azure Blob","color":"fbca04","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/rclone/rclone/milestones/57","html_url":"https://github.com/rclone/rclone/milestone/57","labels_url":"https://api.github.com/repos/rclone/rclone/milestones/57/labels","id":11258698,"node_id":"MI_kwDOAQ-n5M4Aq8tK","number":57,"title":"v1.69","description":"","creator":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":1,"closed_issues":23,"state":"closed","created_at":"2024-07-01T16:37:57Z","updated_at":"2025-05-27T14:40:10Z","due_on":"2025-01-12T08:00:00Z","closed_at":"2025-01-13T10:54:46Z"},"comments":7,"created_at":"2024-09-16T14:39:52Z","updated_at":"2024-09-20T15:17:44Z","closed_at":"2024-09-20T15:16:36Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### What is the problem you are having with rclone?\r\n\r\nWe currently use RClone to connect Azure VMs to an Azure Blob Storage. In the context of the Azure Virtual Desktop, we would like to use the identity of the logged-in user. According to the documentation, it is possible to generate credentials via _az login_ and then use them via the Env_Auth flag. According to the documentation, however, the following sequence is used when setting the **Env_Auth** to true switch:\r\n\r\n1. Environment Variables\r\n2. Managed Service Identity Credentials\r\n3. Azure CLI credentials (as used by the az tool)\r\n\r\nSince we are operating in the Azure context and working with Entra ID, every VM in Azure requires a System Managed Identity, including our AVD machine. There is no option to enforce the credentials via az tool, it always automatically uses the System Managed Identity, which has no authorization, as this lies with the user.\r\nSetting the **Use_msi** flag to false also has no effect. According to the documentation, there is also no way to bypass the use of the MSI.\r\n\r\nI am not sure whether this is a bug or a desired behavior.\r\n#### What is your rclone version (output from `rclone version`)\r\n1.67\r\n\r\n\r\n#### Which OS you are using and how many bits (e.g. Windows 7, 64 bit)\r\nWindows Server 22 und Windows Server 25 Preview\r\n\r\n\r\n#### Which cloud storage system are you using? (e.g. Google Drive)\r\nAzure Blob Storage\r\n\r\n\r\n#### The command you were trying to run (e.g. `rclone copy /tmp remote:tmp`)\r\n`rclone mount`\r\n\r\nConfig File\r\n```\r\n[configName]\r\ntype = azureblob\r\naccount = <accountName>\r\nenv_auth = true\r\nuse_msi = false\r\n```\r\n\r\n<!--- Please keep the note below for others who read your bug report. -->\r\n\r\n#### How to use GitHub\r\n\r\n* Please use the üëç [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to show that you are affected by the same issue.\r\n* Please don't comment if you have no relevant information to add. It's just extra noise for everyone subscribed to this issue.\r\n* Subscribe to receive notifications on status change and new comments.\r\n","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/8078/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/8078/timeline","performed_via_github_app":null,"state_reason":"completed"}