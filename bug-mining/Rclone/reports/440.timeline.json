[{"id":1559141650,"node_id":"MDEyOkxhYmVsZWRFdmVudDE1NTkxNDE2NTA=","url":"https://api.github.com/repos/rclone/rclone/issues/events/1559141650","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2018-04-05T16:11:41Z","label":{"name":"enhancement","color":"84b6eb"},"performed_via_github_app":null},{"id":1559141948,"node_id":"MDEyOkxhYmVsZWRFdmVudDE1NTkxNDE5NDg=","url":"https://api.github.com/repos/rclone/rclone/issues/events/1559141948","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2018-04-05T16:11:48Z","label":{"name":"Remote: S3","color":"fbca04"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/378990856","html_url":"https://github.com/rclone/rclone/issues/2213#issuecomment-378990856","issue_url":"https://api.github.com/repos/rclone/rclone/issues/2213","id":378990856,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODk5MDg1Ng==","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-05T16:12:12Z","updated_at":"2018-04-05T16:12:12Z","body":"@sparrowjack63 do you want to have a go at this?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/378990856/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1559143388,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTU1OTE0MzM4OA==","url":"https://api.github.com/repos/rclone/rclone/issues/events/1559143388","actor":{"login":"sparrowjack63","id":33800996,"node_id":"MDQ6VXNlcjMzODAwOTk2","avatar_url":"https://avatars.githubusercontent.com/u/33800996?v=4","gravatar_id":"","url":"https://api.github.com/users/sparrowjack63","html_url":"https://github.com/sparrowjack63","followers_url":"https://api.github.com/users/sparrowjack63/followers","following_url":"https://api.github.com/users/sparrowjack63/following{/other_user}","gists_url":"https://api.github.com/users/sparrowjack63/gists{/gist_id}","starred_url":"https://api.github.com/users/sparrowjack63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sparrowjack63/subscriptions","organizations_url":"https://api.github.com/users/sparrowjack63/orgs","repos_url":"https://api.github.com/users/sparrowjack63/repos","events_url":"https://api.github.com/users/sparrowjack63/events{/privacy}","received_events_url":"https://api.github.com/users/sparrowjack63/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-04-05T16:12:12Z","performed_via_github_app":null},{"id":1559143389,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE1NTkxNDMzODk=","url":"https://api.github.com/repos/rclone/rclone/issues/events/1559143389","actor":{"login":"sparrowjack63","id":33800996,"node_id":"MDQ6VXNlcjMzODAwOTk2","avatar_url":"https://avatars.githubusercontent.com/u/33800996?v=4","gravatar_id":"","url":"https://api.github.com/users/sparrowjack63","html_url":"https://github.com/sparrowjack63","followers_url":"https://api.github.com/users/sparrowjack63/followers","following_url":"https://api.github.com/users/sparrowjack63/following{/other_user}","gists_url":"https://api.github.com/users/sparrowjack63/gists{/gist_id}","starred_url":"https://api.github.com/users/sparrowjack63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sparrowjack63/subscriptions","organizations_url":"https://api.github.com/users/sparrowjack63/orgs","repos_url":"https://api.github.com/users/sparrowjack63/repos","events_url":"https://api.github.com/users/sparrowjack63/events{/privacy}","received_events_url":"https://api.github.com/users/sparrowjack63/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-04-05T16:12:12Z","performed_via_github_app":null},{"id":1559143599,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDE1NTkxNDM1OTk=","url":"https://api.github.com/repos/rclone/rclone/issues/events/1559143599","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2018-04-05T16:12:16Z","milestone":{"title":"Help Wanted"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/379009495","html_url":"https://github.com/rclone/rclone/issues/2213#issuecomment-379009495","issue_url":"https://api.github.com/repos/rclone/rclone/issues/2213","id":379009495,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTAwOTQ5NQ==","user":{"login":"sparrowjack63","id":33800996,"node_id":"MDQ6VXNlcjMzODAwOTk2","avatar_url":"https://avatars.githubusercontent.com/u/33800996?v=4","gravatar_id":"","url":"https://api.github.com/users/sparrowjack63","html_url":"https://github.com/sparrowjack63","followers_url":"https://api.github.com/users/sparrowjack63/followers","following_url":"https://api.github.com/users/sparrowjack63/following{/other_user}","gists_url":"https://api.github.com/users/sparrowjack63/gists{/gist_id}","starred_url":"https://api.github.com/users/sparrowjack63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sparrowjack63/subscriptions","organizations_url":"https://api.github.com/users/sparrowjack63/orgs","repos_url":"https://api.github.com/users/sparrowjack63/repos","events_url":"https://api.github.com/users/sparrowjack63/events{/privacy}","received_events_url":"https://api.github.com/users/sparrowjack63/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-05T17:13:50Z","updated_at":"2018-04-05T17:13:50Z","body":"I'm not experienced enough to go, but I will look at the changes made to learn and try to do it alone next time.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/379009495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sparrowjack63","id":33800996,"node_id":"MDQ6VXNlcjMzODAwOTk2","avatar_url":"https://avatars.githubusercontent.com/u/33800996?v=4","gravatar_id":"","url":"https://api.github.com/users/sparrowjack63","html_url":"https://github.com/sparrowjack63","followers_url":"https://api.github.com/users/sparrowjack63/followers","following_url":"https://api.github.com/users/sparrowjack63/following{/other_user}","gists_url":"https://api.github.com/users/sparrowjack63/gists{/gist_id}","starred_url":"https://api.github.com/users/sparrowjack63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sparrowjack63/subscriptions","organizations_url":"https://api.github.com/users/sparrowjack63/orgs","repos_url":"https://api.github.com/users/sparrowjack63/repos","events_url":"https://api.github.com/users/sparrowjack63/events{/privacy}","received_events_url":"https://api.github.com/users/sparrowjack63/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/379240359","html_url":"https://github.com/rclone/rclone/issues/2213#issuecomment-379240359","issue_url":"https://api.github.com/repos/rclone/rclone/issues/2213","id":379240359,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTI0MDM1OQ==","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-06T12:37:54Z","updated_at":"2018-04-06T12:37:54Z","body":"@chris-redekop this is the, perhaps inevitable, consequence of your change 4dd1e507f4204bda949c12766bfe8012bf03dc16\r\n\r\nDo you fancy putting in a flag to turn it off?\r\n\r\nHere is some more background from the forum: https://forum.rclone.org/t/long-time-before-start-uploading-data/5278\r\n\r\nOr another possibility is to add the metadata after the file has been transferred.  The local Fs will calculate the checksum as it goes along in that case so it won't cause a big up-front delay.\r\n\r\nI'm not sure what consequences for billing updating metadata for S3 files has as it involves doing a COPY though.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/379240359/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1560812876,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTU2MDgxMjg3Ng==","url":"https://api.github.com/repos/rclone/rclone/issues/events/1560812876","actor":{"login":"chris-redekop","id":6529949,"node_id":"MDQ6VXNlcjY1Mjk5NDk=","avatar_url":"https://avatars.githubusercontent.com/u/6529949?v=4","gravatar_id":"","url":"https://api.github.com/users/chris-redekop","html_url":"https://github.com/chris-redekop","followers_url":"https://api.github.com/users/chris-redekop/followers","following_url":"https://api.github.com/users/chris-redekop/following{/other_user}","gists_url":"https://api.github.com/users/chris-redekop/gists{/gist_id}","starred_url":"https://api.github.com/users/chris-redekop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chris-redekop/subscriptions","organizations_url":"https://api.github.com/users/chris-redekop/orgs","repos_url":"https://api.github.com/users/chris-redekop/repos","events_url":"https://api.github.com/users/chris-redekop/events{/privacy}","received_events_url":"https://api.github.com/users/chris-redekop/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-04-06T12:37:54Z","performed_via_github_app":null},{"id":1560812878,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE1NjA4MTI4Nzg=","url":"https://api.github.com/repos/rclone/rclone/issues/events/1560812878","actor":{"login":"chris-redekop","id":6529949,"node_id":"MDQ6VXNlcjY1Mjk5NDk=","avatar_url":"https://avatars.githubusercontent.com/u/6529949?v=4","gravatar_id":"","url":"https://api.github.com/users/chris-redekop","html_url":"https://github.com/chris-redekop","followers_url":"https://api.github.com/users/chris-redekop/followers","following_url":"https://api.github.com/users/chris-redekop/following{/other_user}","gists_url":"https://api.github.com/users/chris-redekop/gists{/gist_id}","starred_url":"https://api.github.com/users/chris-redekop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chris-redekop/subscriptions","organizations_url":"https://api.github.com/users/chris-redekop/orgs","repos_url":"https://api.github.com/users/chris-redekop/repos","events_url":"https://api.github.com/users/chris-redekop/events{/privacy}","received_events_url":"https://api.github.com/users/chris-redekop/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-04-06T12:37:54Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/379566830","html_url":"https://github.com/rclone/rclone/issues/2213#issuecomment-379566830","issue_url":"https://api.github.com/repos/rclone/rclone/issues/2213","id":379566830,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTU2NjgzMA==","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-08T17:24:12Z","updated_at":"2018-04-08T17:24:12Z","body":"...Another advantage of applying the hash after is that it will work with `rcat` and more importantly uploading large files with `rclone mount`.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/379566830/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/379579772","html_url":"https://github.com/rclone/rclone/issues/2213#issuecomment-379579772","issue_url":"https://api.github.com/repos/rclone/rclone/issues/2213","id":379579772,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTU3OTc3Mg==","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-08T20:25:32Z","updated_at":"2018-04-08T20:25:32Z","body":"...And if we calculate the hash when streaming through the s3 backend (rather than reading the source hash) then it will fix hashes missing when uploading to a crypt backend and hence to s3.  \r\n\r\nSee [forum thread](https://forum.rclone.org/t/how-to-identify-files-that-cant-be-cryptcheck/5206/12)\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/379579772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/379741278","html_url":"https://github.com/rclone/rclone/issues/2213#issuecomment-379741278","issue_url":"https://api.github.com/repos/rclone/rclone/issues/2213","id":379741278,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTc0MTI3OA==","user":{"login":"sparrowjack63","id":33800996,"node_id":"MDQ6VXNlcjMzODAwOTk2","avatar_url":"https://avatars.githubusercontent.com/u/33800996?v=4","gravatar_id":"","url":"https://api.github.com/users/sparrowjack63","html_url":"https://github.com/sparrowjack63","followers_url":"https://api.github.com/users/sparrowjack63/followers","following_url":"https://api.github.com/users/sparrowjack63/following{/other_user}","gists_url":"https://api.github.com/users/sparrowjack63/gists{/gist_id}","starred_url":"https://api.github.com/users/sparrowjack63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sparrowjack63/subscriptions","organizations_url":"https://api.github.com/users/sparrowjack63/orgs","repos_url":"https://api.github.com/users/sparrowjack63/repos","events_url":"https://api.github.com/users/sparrowjack63/events{/privacy}","received_events_url":"https://api.github.com/users/sparrowjack63/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-09T12:53:41Z","updated_at":"2018-04-09T12:53:41Z","body":"It could be a good way to calculate hash when streaming. If it could delete the delay before the upload, it will be interresting.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/379741278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sparrowjack63","id":33800996,"node_id":"MDQ6VXNlcjMzODAwOTk2","avatar_url":"https://avatars.githubusercontent.com/u/33800996?v=4","gravatar_id":"","url":"https://api.github.com/users/sparrowjack63","html_url":"https://github.com/sparrowjack63","followers_url":"https://api.github.com/users/sparrowjack63/followers","following_url":"https://api.github.com/users/sparrowjack63/following{/other_user}","gists_url":"https://api.github.com/users/sparrowjack63/gists{/gist_id}","starred_url":"https://api.github.com/users/sparrowjack63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sparrowjack63/subscriptions","organizations_url":"https://api.github.com/users/sparrowjack63/orgs","repos_url":"https://api.github.com/users/sparrowjack63/repos","events_url":"https://api.github.com/users/sparrowjack63/events{/privacy}","received_events_url":"https://api.github.com/users/sparrowjack63/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/379764941","html_url":"https://github.com/rclone/rclone/issues/2213#issuecomment-379764941","issue_url":"https://api.github.com/repos/rclone/rclone/issues/2213","id":379764941,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTc2NDk0MQ==","user":{"login":"chris-redekop","id":6529949,"node_id":"MDQ6VXNlcjY1Mjk5NDk=","avatar_url":"https://avatars.githubusercontent.com/u/6529949?v=4","gravatar_id":"","url":"https://api.github.com/users/chris-redekop","html_url":"https://github.com/chris-redekop","followers_url":"https://api.github.com/users/chris-redekop/followers","following_url":"https://api.github.com/users/chris-redekop/following{/other_user}","gists_url":"https://api.github.com/users/chris-redekop/gists{/gist_id}","starred_url":"https://api.github.com/users/chris-redekop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chris-redekop/subscriptions","organizations_url":"https://api.github.com/users/chris-redekop/orgs","repos_url":"https://api.github.com/users/chris-redekop/repos","events_url":"https://api.github.com/users/chris-redekop/events{/privacy}","received_events_url":"https://api.github.com/users/chris-redekop/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-09T14:08:44Z","updated_at":"2018-04-09T19:22:38Z","body":"Sure, I can take a look, @ncw.  Thanks for looping me in.\r\n\r\nFor my own context, I'll recap how we got here and where rclone has gone since #1926:\r\n\r\n1. The original motivation for #1926 was to verify rclone large-file uploads, according to https://aws.amazon.com/premiumsupport/knowledge-center/data-integrity-s3/ .  This article indicates that the MD5 must be calculated **before** the upload.  The work in #1926 is my take on this AWS article.\r\n\r\n2. After we were some way toward #1926, @ncw  found that the AWS API *already* pre-hashes and verifies the upload.  This is discussed in #523 and in https://docs.aws.amazon.com/AmazonS3/latest/API/bucket-policy-s3-sigv4-conditions.html.\r\n\r\n3. Note that 2) alleviates the need for 1), but we kept 1) for a different use case: verifying the MD5 some time after uploading.  Note that we don't need to **pre-**compute the MD5 for this use case, but there are other reasons to do so.  (I'll discuss these below.)\r\n\r\n4. From the forum post, @ncw, I get the impression that rcrypt large-file checking is now relying on a fixed chunk size and the ETag.  Did I get that right, or what is `--s3-chunk-size` for?\r\n\r\n>> So as of now running “rclone cryptcheck --fast-list --verbose /path/to/files encryptedremote:path/to/files” is expected to return “X hashes could not be checked” for any files over 5 MB?\r\n\r\n>Yes. You can move that threshold with the latest beta using\r\n> `--s3-chunk-size int                   Chunk size to use for uploading (default 5M)`\r\n\r\n\r\nSo now we have large files that have an MD5 sum, but it requires streaming a file twice--once for the MD5, and once to transfer--which isn't optimal.  What are our options?\r\n\r\n1. Add a `–s3-disable-checksum` option to turn off the calculation altogether.  This seems heavy handed, but could be a good compromise if we decide to keep MD5 pre-calculations.\r\n\r\n2. Calculate the MD5 during uploading and send it as S3 object *metadata* **after** the upload is complete.  A con of this one is the $$$ price: an S3 object and its metadata are considered an immutable pair and so a new (object + metadata) pair would need to be created when the MD5 is uploaded.  As @ncw mentions, this increases transaction costs:\r\n\r\n> I'm not sure what consequences for billing updating metadata for S3 files has as it involves doing a COPY though.\r\n\r\nEven more important for users like me, who use versioned S3 buckets as secondary backup, is the extra storage cost: uploading the MD5 after means another full (object + metadata) version is put in the history, thus **doubling** the storage cost of each object.\r\n\r\n3.  Calculate the MD5 during uploading and send it as an S3 object *tag* **after** the upload is complete.  Tags are different from object metadata in that they can change separately from objects.  This feature addresses the $$$ cons of 2).  The only con is minor: they're intended more for categorization and less for arbitrary metadata.  See https://docs.aws.amazon.com/AmazonS3/latest/dev/object-tagging.html\r\n\r\n4. I asked above, @ncw, is the latest beta using fixed chunk size + ETag for verification?  The con here are ETag's now well understood limitations: rclone can't control the chunk size for any objects that it does not create, and the ETag does not hold the object's MD5 when the object is KMS encrypted.  (Third parties may KMS encrypt a bucket that  we want to manage with rclone.)\r\n\r\n\r\nWhat do you think?  Did I miss any?  What are your preferences?\r\n\r\nMy preference is 1), as it's complete, and most consistent with AWS's body of documentation.  I also think 3) is complete and workable.  I wouldn't use 2) as it would double my storage costs.  I don't think 4) is complete--it doesn't address third-party chunk size, nor KMS encryption.\r\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/379764941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"chris-redekop","id":6529949,"node_id":"MDQ6VXNlcjY1Mjk5NDk=","avatar_url":"https://avatars.githubusercontent.com/u/6529949?v=4","gravatar_id":"","url":"https://api.github.com/users/chris-redekop","html_url":"https://github.com/chris-redekop","followers_url":"https://api.github.com/users/chris-redekop/followers","following_url":"https://api.github.com/users/chris-redekop/following{/other_user}","gists_url":"https://api.github.com/users/chris-redekop/gists{/gist_id}","starred_url":"https://api.github.com/users/chris-redekop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chris-redekop/subscriptions","organizations_url":"https://api.github.com/users/chris-redekop/orgs","repos_url":"https://api.github.com/users/chris-redekop/repos","events_url":"https://api.github.com/users/chris-redekop/events{/privacy}","received_events_url":"https://api.github.com/users/chris-redekop/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1563921055,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTU2MzkyMTA1NQ==","url":"https://api.github.com/repos/rclone/rclone/issues/events/1563921055","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-04-09T14:08:44Z","performed_via_github_app":null},{"id":1563921056,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE1NjM5MjEwNTY=","url":"https://api.github.com/repos/rclone/rclone/issues/events/1563921056","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-04-09T14:08:44Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/379771214","html_url":"https://github.com/rclone/rclone/issues/2213#issuecomment-379771214","issue_url":"https://api.github.com/repos/rclone/rclone/issues/2213","id":379771214,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTc3MTIxNA==","user":{"login":"sparrowjack63","id":33800996,"node_id":"MDQ6VXNlcjMzODAwOTk2","avatar_url":"https://avatars.githubusercontent.com/u/33800996?v=4","gravatar_id":"","url":"https://api.github.com/users/sparrowjack63","html_url":"https://github.com/sparrowjack63","followers_url":"https://api.github.com/users/sparrowjack63/followers","following_url":"https://api.github.com/users/sparrowjack63/following{/other_user}","gists_url":"https://api.github.com/users/sparrowjack63/gists{/gist_id}","starred_url":"https://api.github.com/users/sparrowjack63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sparrowjack63/subscriptions","organizations_url":"https://api.github.com/users/sparrowjack63/orgs","repos_url":"https://api.github.com/users/sparrowjack63/repos","events_url":"https://api.github.com/users/sparrowjack63/events{/privacy}","received_events_url":"https://api.github.com/users/sparrowjack63/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-09T14:27:18Z","updated_at":"2018-04-09T14:27:18Z","body":"Some users like me are using rclone with \"on premise\" S3 compatible solution (like ceph).\r\nSo for this case, we dont care about the $ of calculating MD5 during upload.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/379771214/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sparrowjack63","id":33800996,"node_id":"MDQ6VXNlcjMzODAwOTk2","avatar_url":"https://avatars.githubusercontent.com/u/33800996?v=4","gravatar_id":"","url":"https://api.github.com/users/sparrowjack63","html_url":"https://github.com/sparrowjack63","followers_url":"https://api.github.com/users/sparrowjack63/followers","following_url":"https://api.github.com/users/sparrowjack63/following{/other_user}","gists_url":"https://api.github.com/users/sparrowjack63/gists{/gist_id}","starred_url":"https://api.github.com/users/sparrowjack63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sparrowjack63/subscriptions","organizations_url":"https://api.github.com/users/sparrowjack63/orgs","repos_url":"https://api.github.com/users/sparrowjack63/repos","events_url":"https://api.github.com/users/sparrowjack63/events{/privacy}","received_events_url":"https://api.github.com/users/sparrowjack63/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/379895403","html_url":"https://github.com/rclone/rclone/issues/2213#issuecomment-379895403","issue_url":"https://api.github.com/repos/rclone/rclone/issues/2213","id":379895403,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTg5NTQwMw==","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-09T21:11:19Z","updated_at":"2018-04-09T21:11:19Z","body":"Thanks for taking a look at this @chris-redekop \r\n\r\nThere are several related problems here:\r\n  * long time before initial upload of large file\r\n  * hashes missing for crypt uploads (making cryptcheck useless)\r\n  * hashes missing for rcat/mount uploads\r\n\r\n> From the forum post, @ncw, I get the impression that rcrypt large-file checking is now relying on a fixed chunk size and the ETag. Did I get that right, or what is --s3-chunk-size for?\r\n\r\nNo that isn't correct.  `--s3-chunk-size` allows the user to vary the size of the multpart upload chunks.  The Etag is done as metadata as before.\r\n\r\nMaybe what we should do is option 1) to turn it off and...\r\n\r\nA hybrid option 2) -  do exactly what we are doing now, so reading the MD5 from the source object and using that if available.  That is cheap and easy.  However if the MD5 hash isn't available at that point in time, then we could calculate it as we stream it and add it as metadata after with the COPY+update metadata.\r\n\r\nAccording to [the pricing page](https://aws.amazon.com/s3/pricing/) a COPY costs the same as a PUT or a LIST operation `$0.005 per 1,000 requests` - I don't think there is a per byte cost.\r\n\r\nI note that you can't copy an object bigger than 5GB without using the multipart upload so that is a bit of a nuisance! rclone already uses this to set the modtime of an object and I hadn't noticed that bit of the docs until now.\r\n\r\nI don't know anything about S3 tags - it sounds like they added that feature to support Amazon Cloud Drive!  These seem to cost `$0.0004 per 1,000 requests` assuming they are in the Other category.  I wonder if all/any of the S3 compatiable offerings (CEPH/Digital Ocean/Wasabi) support tagging? That might be a good reason not to use tagging.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/379895403/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1564807117,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTU2NDgwNzExNw==","url":"https://api.github.com/repos/rclone/rclone/issues/events/1564807117","actor":{"login":"chris-redekop","id":6529949,"node_id":"MDQ6VXNlcjY1Mjk5NDk=","avatar_url":"https://avatars.githubusercontent.com/u/6529949?v=4","gravatar_id":"","url":"https://api.github.com/users/chris-redekop","html_url":"https://github.com/chris-redekop","followers_url":"https://api.github.com/users/chris-redekop/followers","following_url":"https://api.github.com/users/chris-redekop/following{/other_user}","gists_url":"https://api.github.com/users/chris-redekop/gists{/gist_id}","starred_url":"https://api.github.com/users/chris-redekop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chris-redekop/subscriptions","organizations_url":"https://api.github.com/users/chris-redekop/orgs","repos_url":"https://api.github.com/users/chris-redekop/repos","events_url":"https://api.github.com/users/chris-redekop/events{/privacy}","received_events_url":"https://api.github.com/users/chris-redekop/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-04-09T21:11:19Z","performed_via_github_app":null},{"id":1564807118,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE1NjQ4MDcxMTg=","url":"https://api.github.com/repos/rclone/rclone/issues/events/1564807118","actor":{"login":"chris-redekop","id":6529949,"node_id":"MDQ6VXNlcjY1Mjk5NDk=","avatar_url":"https://avatars.githubusercontent.com/u/6529949?v=4","gravatar_id":"","url":"https://api.github.com/users/chris-redekop","html_url":"https://github.com/chris-redekop","followers_url":"https://api.github.com/users/chris-redekop/followers","following_url":"https://api.github.com/users/chris-redekop/following{/other_user}","gists_url":"https://api.github.com/users/chris-redekop/gists{/gist_id}","starred_url":"https://api.github.com/users/chris-redekop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chris-redekop/subscriptions","organizations_url":"https://api.github.com/users/chris-redekop/orgs","repos_url":"https://api.github.com/users/chris-redekop/repos","events_url":"https://api.github.com/users/chris-redekop/events{/privacy}","received_events_url":"https://api.github.com/users/chris-redekop/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-04-09T21:11:19Z","performed_via_github_app":null},{"id":1564807120,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTU2NDgwNzEyMA==","url":"https://api.github.com/repos/rclone/rclone/issues/events/1564807120","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-04-09T21:11:19Z","performed_via_github_app":null},{"id":1564807122,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE1NjQ4MDcxMjI=","url":"https://api.github.com/repos/rclone/rclone/issues/events/1564807122","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-04-09T21:11:19Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/380118519","html_url":"https://github.com/rclone/rclone/issues/2213#issuecomment-380118519","issue_url":"https://api.github.com/repos/rclone/rclone/issues/2213","id":380118519,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDExODUxOQ==","user":{"login":"chris-redekop","id":6529949,"node_id":"MDQ6VXNlcjY1Mjk5NDk=","avatar_url":"https://avatars.githubusercontent.com/u/6529949?v=4","gravatar_id":"","url":"https://api.github.com/users/chris-redekop","html_url":"https://github.com/chris-redekop","followers_url":"https://api.github.com/users/chris-redekop/followers","following_url":"https://api.github.com/users/chris-redekop/following{/other_user}","gists_url":"https://api.github.com/users/chris-redekop/gists{/gist_id}","starred_url":"https://api.github.com/users/chris-redekop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chris-redekop/subscriptions","organizations_url":"https://api.github.com/users/chris-redekop/orgs","repos_url":"https://api.github.com/users/chris-redekop/repos","events_url":"https://api.github.com/users/chris-redekop/events{/privacy}","received_events_url":"https://api.github.com/users/chris-redekop/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-10T14:24:10Z","updated_at":"2018-04-10T14:32:11Z","body":"I'm in full agreement with adding a flag re: MD5 pre-calculation.\r\n\r\nOn the hybrid option 2), I stress that updating an object's metadata after-the-fact can double **storage** costs and so is not an option for users with versioned buckets.\r\n\r\n@ncw , this is not about the cost of the extra COPY request; this is about S3 buckets with versioning enabled.  In a versioned bucket, when an object's metadata is updated with a COPY request, S3 puts a second *complete* copy of the object in its version history.  S3 charges for every copy, and so it now charges for the storage of two objects where it previously charged for the storage of only one.\r\n\r\nI see what you mean about the tags.  I don't know much about S3 clones like Ceph but can imagine that some of them don't support tags.  It was a bit of a stretch anyway, and I'm fine to drop it as an option.\r\n\r\nI think, then, that I prefer 1), without any 2), 3), or 4).\r\n\r\nI do still have some background questions:\r\n\r\n>--s3-chunk-size allows the user to vary the size of the multpart upload chunks.\r\n\r\nWhy would a user want to do this?  (I could only think of it helping with ETag-based rclone checks.)\r\n\r\n> There are several related problems here: hashes missing for rcat/mount uploads\r\n\r\nI'm trying to put the MD5 pre-calculation in this context.  Does the MD5 pre-calc block hashes for rcat/mount, or (how) is the MD5 pre-calc related to rcat/mount?\r\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/380118519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"chris-redekop","id":6529949,"node_id":"MDQ6VXNlcjY1Mjk5NDk=","avatar_url":"https://avatars.githubusercontent.com/u/6529949?v=4","gravatar_id":"","url":"https://api.github.com/users/chris-redekop","html_url":"https://github.com/chris-redekop","followers_url":"https://api.github.com/users/chris-redekop/followers","following_url":"https://api.github.com/users/chris-redekop/following{/other_user}","gists_url":"https://api.github.com/users/chris-redekop/gists{/gist_id}","starred_url":"https://api.github.com/users/chris-redekop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chris-redekop/subscriptions","organizations_url":"https://api.github.com/users/chris-redekop/orgs","repos_url":"https://api.github.com/users/chris-redekop/repos","events_url":"https://api.github.com/users/chris-redekop/events{/privacy}","received_events_url":"https://api.github.com/users/chris-redekop/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1566312446,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTU2NjMxMjQ0Ng==","url":"https://api.github.com/repos/rclone/rclone/issues/events/1566312446","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-04-10T14:24:10Z","performed_via_github_app":null},{"id":1566312450,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE1NjYzMTI0NTA=","url":"https://api.github.com/repos/rclone/rclone/issues/events/1566312450","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-04-10T14:24:10Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/380235229","html_url":"https://github.com/rclone/rclone/issues/2213#issuecomment-380235229","issue_url":"https://api.github.com/repos/rclone/rclone/issues/2213","id":380235229,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDIzNTIyOQ==","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-10T20:26:02Z","updated_at":"2018-04-10T20:26:02Z","body":"> Why would a user want to do this? (I could only think of it helping with ETag-based rclone checks.)\r\n\r\nBigger chunks means rclone goes faster.\r\n\r\n> I'm trying to put the MD5 pre-calculation in this context. Does the MD5 pre-calc block hashes for rcat/mount, or (how) is the MD5 pre-calc related to rcat/mount?\r\n\r\nrcat/mount don't have the file at the point that the current s3 backend code asks for the MD5SUM so they can't return it.\r\n\r\n----\r\n\r\nOption 1) is safe for definite.\r\n\r\nAnother idea: Maybe we should bring back the `--s3-upload-cutoff` which can use the old [single part upload](https://docs.aws.amazon.com/AmazonS3/latest/API/RESTObjectPUT.html) for small uploads (below that threshold).  I think this is good to 5GB.  This will always have an ETag which is a valid MD5SUM and rclone will check the MD5SUM when it is uploaded. That is how rclone used to work before I cut over to using the official SDK.\r\n\r\nUploading like this isn't as robust as the multpart upload, but it could be as quick or quicker as it gets to stream lots of TCP data.\r\n\r\nYou can optionally give it a Content-MD5 to check on upload too if you have it at the point of creating the request.\r\n\r\nThat might be a better solution, or an additional part anyway...","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/380235229/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/380483909","html_url":"https://github.com/rclone/rclone/issues/2213#issuecomment-380483909","issue_url":"https://api.github.com/repos/rclone/rclone/issues/2213","id":380483909,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDQ4MzkwOQ==","user":{"login":"chris-redekop","id":6529949,"node_id":"MDQ6VXNlcjY1Mjk5NDk=","avatar_url":"https://avatars.githubusercontent.com/u/6529949?v=4","gravatar_id":"","url":"https://api.github.com/users/chris-redekop","html_url":"https://github.com/chris-redekop","followers_url":"https://api.github.com/users/chris-redekop/followers","following_url":"https://api.github.com/users/chris-redekop/following{/other_user}","gists_url":"https://api.github.com/users/chris-redekop/gists{/gist_id}","starred_url":"https://api.github.com/users/chris-redekop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chris-redekop/subscriptions","organizations_url":"https://api.github.com/users/chris-redekop/orgs","repos_url":"https://api.github.com/users/chris-redekop/repos","events_url":"https://api.github.com/users/chris-redekop/events{/privacy}","received_events_url":"https://api.github.com/users/chris-redekop/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-11T14:59:55Z","updated_at":"2018-04-11T14:59:55Z","body":"> Bigger chunks means rclone goes faster.\r\n\r\n👍 \r\n\r\n> rcat/mount don't have the file at the point that the current s3 backend code asks for the MD5SUM so they can't return it.\r\n\r\nInteresting...\r\n\r\n---\r\n\r\nOK, I will take a look at adding that flag.  I'll use `--s3-disable-checksum`, as suggested, for now.  Just let me know if you'd like a different name.\r\n\r\nOn the `--s3-upload-cutoff` option and relying on the ETag; during our earlier conversation I convinced myself that the ETag is not the way to go.  (It's dodgy at best and doesn't address some well-known cases.)  Using the ETag might help a bit in this case, but I don't think it can be a complete sol'n.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/comments/380483909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"chris-redekop","id":6529949,"node_id":"MDQ6VXNlcjY1Mjk5NDk=","avatar_url":"https://avatars.githubusercontent.com/u/6529949?v=4","gravatar_id":"","url":"https://api.github.com/users/chris-redekop","html_url":"https://github.com/chris-redekop","followers_url":"https://api.github.com/users/chris-redekop/followers","following_url":"https://api.github.com/users/chris-redekop/following{/other_user}","gists_url":"https://api.github.com/users/chris-redekop/gists{/gist_id}","starred_url":"https://api.github.com/users/chris-redekop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chris-redekop/subscriptions","organizations_url":"https://api.github.com/users/chris-redekop/orgs","repos_url":"https://api.github.com/users/chris-redekop/repos","events_url":"https://api.github.com/users/chris-redekop/events{/privacy}","received_events_url":"https://api.github.com/users/chris-redekop/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1577436891,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDE1Nzc0MzY4OTE=","url":"https://api.github.com/repos/rclone/rclone/issues/events/1577436891","actor":{"login":"chris-redekop","id":6529949,"node_id":"MDQ6VXNlcjY1Mjk5NDk=","avatar_url":"https://avatars.githubusercontent.com/u/6529949?v=4","gravatar_id":"","url":"https://api.github.com/users/chris-redekop","html_url":"https://github.com/chris-redekop","followers_url":"https://api.github.com/users/chris-redekop/followers","following_url":"https://api.github.com/users/chris-redekop/following{/other_user}","gists_url":"https://api.github.com/users/chris-redekop/gists{/gist_id}","starred_url":"https://api.github.com/users/chris-redekop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chris-redekop/subscriptions","organizations_url":"https://api.github.com/users/chris-redekop/orgs","repos_url":"https://api.github.com/users/chris-redekop/repos","events_url":"https://api.github.com/users/chris-redekop/events{/privacy}","received_events_url":"https://api.github.com/users/chris-redekop/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"4529173e35543026e08d1e50db8bf9aae380e520","commit_url":"https://api.github.com/repos/chris-redekop/rclone/commits/4529173e35543026e08d1e50db8bf9aae380e520","created_at":"2018-04-16T22:26:48Z","performed_via_github_app":null},{"id":1577499991,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDE1Nzc0OTk5OTE=","url":"https://api.github.com/repos/rclone/rclone/issues/events/1577499991","actor":{"login":"chris-redekop","id":6529949,"node_id":"MDQ6VXNlcjY1Mjk5NDk=","avatar_url":"https://avatars.githubusercontent.com/u/6529949?v=4","gravatar_id":"","url":"https://api.github.com/users/chris-redekop","html_url":"https://github.com/chris-redekop","followers_url":"https://api.github.com/users/chris-redekop/followers","following_url":"https://api.github.com/users/chris-redekop/following{/other_user}","gists_url":"https://api.github.com/users/chris-redekop/gists{/gist_id}","starred_url":"https://api.github.com/users/chris-redekop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chris-redekop/subscriptions","organizations_url":"https://api.github.com/users/chris-redekop/orgs","repos_url":"https://api.github.com/users/chris-redekop/repos","events_url":"https://api.github.com/users/chris-redekop/events{/privacy}","received_events_url":"https://api.github.com/users/chris-redekop/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"a36052a5d78eb518e094c637ec9e6e215c3de217","commit_url":"https://api.github.com/repos/chris-redekop/rclone/commits/a36052a5d78eb518e094c637ec9e6e215c3de217","created_at":"2018-04-16T23:18:44Z","performed_via_github_app":null},{"id":1586917963,"node_id":"MDExOkNsb3NlZEV2ZW50MTU4NjkxNzk2Mw==","url":"https://api.github.com/repos/rclone/rclone/issues/events/1586917963","actor":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"a35e62e15c1b4cbedc9cef9dc775f157b0a30d23","commit_url":"https://api.github.com/repos/rclone/rclone/commits/a35e62e15c1b4cbedc9cef9dc775f157b0a30d23","created_at":"2018-04-20T19:51:17Z","state_reason":null,"performed_via_github_app":null}]