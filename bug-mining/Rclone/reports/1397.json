{"url":"https://api.github.com/repos/rclone/rclone/issues/8272","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/8272/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/8272/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/8272/events","html_url":"https://github.com/rclone/rclone/issues/8272","id":2759083578,"node_id":"I_kwDOAQ-n5M6kdEY6","number":8272,"title":"bisync race tests ocassionally fail due to setting time.Local","user":{"login":"darthShadow","id":6824881,"node_id":"MDQ6VXNlcjY4MjQ4ODE=","avatar_url":"https://avatars.githubusercontent.com/u/6824881?v=4","gravatar_id":"","url":"https://api.github.com/users/darthShadow","html_url":"https://github.com/darthShadow","followers_url":"https://api.github.com/users/darthShadow/followers","following_url":"https://api.github.com/users/darthShadow/following{/other_user}","gists_url":"https://api.github.com/users/darthShadow/gists{/gist_id}","starred_url":"https://api.github.com/users/darthShadow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/darthShadow/subscriptions","organizations_url":"https://api.github.com/users/darthShadow/orgs","repos_url":"https://api.github.com/users/darthShadow/repos","events_url":"https://api.github.com/users/darthShadow/events{/privacy}","received_events_url":"https://api.github.com/users/darthShadow/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399005,"node_id":"MDU6TGFiZWw4NjM5OTAwNQ==","url":"https://api.github.com/repos/rclone/rclone/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":252555516,"node_id":"MDU6TGFiZWwyNTI1NTU1MTY=","url":"https://api.github.com/repos/rclone/rclone/labels/maintenance","name":"maintenance","color":"5319e7","default":false,"description":null},{"id":591433922,"node_id":"MDU6TGFiZWw1OTE0MzM5MjI=","url":"https://api.github.com/repos/rclone/rclone/labels/good%20first%20issue","name":"good first issue","color":"5319e7","default":true,"description":null},{"id":718218493,"node_id":"MDU6TGFiZWw3MTgyMTg0OTM=","url":"https://api.github.com/repos/rclone/rclone/labels/help%20wanted","name":"help wanted","color":"c2e0c6","default":true,"description":null},{"id":2530449981,"node_id":"MDU6TGFiZWwyNTMwNDQ5OTgx","url":"https://api.github.com/repos/rclone/rclone/labels/test%20issue","name":"test issue","color":"994FD9","default":false,"description":""},{"id":3427818774,"node_id":"LA_kwDOAQ-n5M7MUF0W","url":"https://api.github.com/repos/rclone/rclone/labels/bisync","name":"bisync","color":"1D76DB","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/rclone/rclone/milestones/13","html_url":"https://github.com/rclone/rclone/milestone/13","labels_url":"https://api.github.com/repos/rclone/rclone/milestones/13/labels","id":1575401,"node_id":"MDk6TWlsZXN0b25lMTU3NTQwMQ==","number":13,"title":"Help Wanted","description":"Enhancements which might be useful, but currently aren't planned.\r\n\r\nAny help doing these much appreciated.","creator":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":228,"closed_issues":302,"state":"open","created_at":"2016-02-10T17:44:20Z","updated_at":"2025-11-04T14:55:57Z","due_on":null,"closed_at":null},"comments":5,"created_at":"2024-12-25T20:30:38Z","updated_at":"2025-08-13T15:58:36Z","closed_at":"2025-08-13T15:58:36Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\r\n\r\nWe understand you are having a problem with rclone; we want to help you with that!\r\n\r\n**STOP and READ**\r\n**YOUR POST WILL BE REMOVED IF IT IS LOW QUALITY**:\r\nPlease show the effort you've put into solving the problem and please be specific.\r\nPeople are volunteering their time to help! Low effort posts are not likely to get good answers!\r\n\r\nIf you think you might have found a bug, try to replicate it with the latest beta (or stable).\r\nThe update instructions are available at https://rclone.org/commands/rclone_selfupdate/\r\n\r\nIf you can still replicate it or just got a question then please use the rclone forum:\r\n\r\n    https://forum.rclone.org/\r\n\r\nfor a quick response instead of filing an issue on this repo.\r\n\r\nIf nothing else helps, then please fill in the info below which helps us help you.\r\n\r\n**DO NOT REDACT** any information except passwords/keys/personal info.\r\n\r\nYou should use 3 backticks to begin and end your paste to make it readable.\r\n\r\nMake sure to include a log obtained with '-vv'.\r\n\r\nYou can also use '-vv --log-file bug.log' and a service such as https://pastebin.com or https://gist.github.com/\r\n\r\nThank you\r\n\r\nThe Rclone Developers\r\n\r\n-->\r\n\r\n#### The associated forum post URL from `https://forum.rclone.org`\r\n\r\nN/A\r\n\r\n#### What is the problem you are having with rclone?\r\n\r\nThe bisync race tests occasionally fail due to a data race with the time.Local variable.\r\n\r\nSource:\r\n\r\nhttps://github.com/rclone/rclone/blob/master/cmd/bisync/bisync_test.go#L278\r\n\r\n<details>\r\n<summary>Race Output</summary>\r\n\r\n```\r\nWARNING: DATA RACE\r\nWrite at 0x00000560c998 by goroutine 30:\r\n  github.com/rclone/rclone/cmd/bisync_test.testBisync()\r\n      /home/runner/work/rclone/rclone/cmd/bisync/bisync_test.go:278 +0x1d6\r\n  github.com/rclone/rclone/cmd/bisync_test.TestBisyncRemoteRemote()\r\n      /home/runner/work/rclone/rclone/cmd/bisync/bisync_test.go:261 +0x12c\r\n  testing.tRunner()\r\n      /opt/hostedtoolcache/go/1.23.4/x64/src/testing/testing.go:1690 +0x226\r\n  testing.(*T).Run.gowrap1()\r\n      /opt/hostedtoolcache/go/1.23.4/x64/src/testing/testing.go:1743 +0x44\r\n\r\nPrevious read at 0x00000560c998 by goroutine 14:\r\n  time.Now()\r\n      /opt/hostedtoolcache/go/1.23.4/x64/src/time/time.go:1169 +0xcf\r\n  time.sendTime()\r\n      /opt/hostedtoolcache/go/1.23.4/x64/src/time/sleep.go:187 +0x3c\r\n\r\nGoroutine 30 (running) created at:\r\n  testing.(*T).Run()\r\n      /opt/hostedtoolcache/go/1.23.4/x64/src/testing/testing.go:1743 +0x825\r\n  testing.runTests.func1()\r\n      /opt/hostedtoolcache/go/1.23.4/x64/src/testing/testing.go:2168 +0x85\r\n  testing.tRunner()\r\n      /opt/hostedtoolcache/go/1.23.4/x64/src/testing/testing.go:1690 +0x226\r\n  testing.runTests()\r\n      /opt/hostedtoolcache/go/1.23.4/x64/src/testing/testing.go:2166 +0x8be\r\n  testing.(*M).Run()\r\n      /opt/hostedtoolcache/go/1.23.4/x64/src/testing/testing.go:2034 +0xf17\r\n  github.com/rclone/rclone/fstest.TestMain()\r\n      /home/runner/work/rclone/rclone/fstest/run.go:69 +0x11d\r\n  github.com/rclone/rclone/cmd/bisync_test.TestMain()\r\n      /home/runner/work/rclone/rclone/cmd/bisync/bisync_test.go:227 +0x172\r\n  main.main()\r\n      _testmain.go:53 +0x16d\r\n\r\nGoroutine 14 (finished) created at:\r\n  [failed to restore the stack]\r\n```\r\n\r\n</details>\r\n\r\n\r\nFrom further digging, it looks like this is a known issue (ref: https://github.com/golang/go/issues/34814) because time.Local is not meant to be modified.\r\n\r\n```\r\nYeah, don't do that. That's an application error, not a bug in the standard library.\r\n\r\nAs you have seen, packages can (and do) assume that it is safe to spawn goroutines that call time.Now in an init function, but those calls are inherently racy if the program is concurrently mutating the variables that determine the behavior of time.Now.\r\n\r\nIf you need to customize a program's notion of ‚Äúlocal time‚Äù, that's what the [TZ environment variable](https://www.gnu.org/software/libc/manual/html_node/TZ-Variable.html) is for.\r\n```\r\n\r\n\r\n#### What is your rclone version (output from `rclone version`)\r\n\r\nN/A\r\n\r\n#### Which OS you are using and how many bits (e.g. Windows 7, 64 bit)\r\n\r\nN/A\r\n\r\n#### Which cloud storage system are you using? (e.g. Google Drive)\r\n\r\nN/A\r\n\r\n#### The command you were trying to run (e.g. `rclone copy /tmp remote:tmp`)\r\n\r\nN/A\r\n\r\n#### A log from the command with the `-vv` flag (e.g. output from `rclone -vv copy /tmp remote:tmp`)\r\n\r\nN/A\r\n\r\n<!--- Please keep the note below for others who read your bug report. -->\r\n\r\n#### How to use GitHub\r\n\r\n* Please use the üëç [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to show that you are affected by the same issue.\r\n* Please don't comment if you have no relevant information to add. It's just extra noise for everyone subscribed to this issue.\r\n* Subscribe to receive notifications on status change and new comments.\r\n","closed_by":{"login":"nielash","id":31582349,"node_id":"MDQ6VXNlcjMxNTgyMzQ5","avatar_url":"https://avatars.githubusercontent.com/u/31582349?v=4","gravatar_id":"","url":"https://api.github.com/users/nielash","html_url":"https://github.com/nielash","followers_url":"https://api.github.com/users/nielash/followers","following_url":"https://api.github.com/users/nielash/following{/other_user}","gists_url":"https://api.github.com/users/nielash/gists{/gist_id}","starred_url":"https://api.github.com/users/nielash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nielash/subscriptions","organizations_url":"https://api.github.com/users/nielash/orgs","repos_url":"https://api.github.com/users/nielash/repos","events_url":"https://api.github.com/users/nielash/events{/privacy}","received_events_url":"https://api.github.com/users/nielash/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/8272/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/8272/timeline","performed_via_github_app":null,"state_reason":"completed"}