{"url":"https://api.github.com/repos/rclone/rclone/issues/4427","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/4427/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/4427/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/4427/events","html_url":"https://github.com/rclone/rclone/issues/4427","id":655193472,"node_id":"MDU6SXNzdWU2NTUxOTM0NzI=","number":4427,"title":"Sync hangs with --track-renames and --track-renames-strategy \"modtime\" flags and correct deletions/transfers are not performed","user":{"login":"Mushin","id":357887,"node_id":"MDQ6VXNlcjM1Nzg4Nw==","avatar_url":"https://avatars.githubusercontent.com/u/357887?v=4","gravatar_id":"","url":"https://api.github.com/users/Mushin","html_url":"https://github.com/Mushin","followers_url":"https://api.github.com/users/Mushin/followers","following_url":"https://api.github.com/users/Mushin/following{/other_user}","gists_url":"https://api.github.com/users/Mushin/gists{/gist_id}","starred_url":"https://api.github.com/users/Mushin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Mushin/subscriptions","organizations_url":"https://api.github.com/users/Mushin/orgs","repos_url":"https://api.github.com/users/Mushin/repos","events_url":"https://api.github.com/users/Mushin/events{/privacy}","received_events_url":"https://api.github.com/users/Mushin/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399005,"node_id":"MDU6TGFiZWw4NjM5OTAwNQ==","url":"https://api.github.com/repos/rclone/rclone/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/rclone/rclone/milestones/40","html_url":"https://github.com/rclone/rclone/milestone/40","labels_url":"https://api.github.com/repos/rclone/rclone/milestones/40/labels","id":5062622,"node_id":"MDk6TWlsZXN0b25lNTA2MjYyMg==","number":40,"title":"v1.53","description":"","creator":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":43,"state":"closed","created_at":"2020-02-01T14:11:00Z","updated_at":"2020-09-05T13:46:47Z","due_on":"2020-08-31T07:00:00Z","closed_at":"2020-09-05T13:46:47Z"},"comments":6,"created_at":"2020-07-11T11:42:08Z","updated_at":"2020-07-17T16:11:59Z","closed_at":"2020-07-17T16:11:19Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\r\n\r\nWelcome :-) We understand you are having a problem with rclone; we want to help you with that!\r\n\r\nIf you've just got a question or aren't sure if you've found a bug then please use the rclone forum:\r\n\r\n    https://forum.rclone.org/\r\n\r\ninstead of filing an issue for a quick response.\r\n\r\nIf you think you might have found a bug, please can you try to replicate it with the latest beta?\r\n\r\n    https://beta.rclone.org/\r\n    \r\nIf you can still replicate it with the latest beta, then please fill in the info below which makes our lives much easier.  A log with -vv will make our day :-)\r\n\r\nThank you\r\n\r\nThe Rclone Developers\r\n\r\n-->\r\n\r\n#### What is the problem you are having with rclone?\r\n\r\nWhen using the --track-renames and --track-renames-strategy \"modtime\" flags, the checker is skipping many files and is not performing the correct transfers and deletions. See below (note, the 1534 transfers and 2150 deletions are correct and should be performed):\r\n\r\nwithout --track-renames --track-renames-strategy \"modtime\":\r\n\r\n```\r\nroot@nas:~# rclone sync \"/mnt/user/test\" \"crypt:current/test\" --progress --fast-list --max-backlog 10000000 --transfers 3 --tpslimit 3 --checkers 16 --dry-run --log-file \"/mnt/user/scripts/rclone/logs/testing.txt\" -vv\r\nTransferred:             0 / 0 Bytes, -, 0 Bytes/s, ETA -\r\nChecks:              4820 / 4820, 100%\r\nDeleted:             2150\r\nTransferred:         1534 / 1534, 100%\r\nElapsed time:         0.6s\r\n```\r\n\r\nwith --track-renames --track-renames-strategy \"modtime\":\r\n\r\n```\r\nrclone sync \"/mnt/user/test\" \"crypt:current/test\" --progress --fast-list --max-backlog 10000000 --transfers 3 --tpslimit 3 --checkers 16 --log-file \"/mnt/user/scripts/rclone/logs/testing.txt\" -vv --dry-run --\r\ntrack-renames --track-renames-strategy \"modtime\"\r\nTransferred:             0 / 0 Bytes, -, 0 Bytes/s, ETA -\r\nChecks:              2684 / 2684, 100%\r\nTransferred:           11 / 11, 100%\r\nElapsed time:         0.4s\r\n```\r\n\r\nAlso, the sync process is hanging at this point - the last log line is:\r\n\r\n`2020/07/11 12:22:40 DEBUG : Encrypted drive 'crypt:current/test': Waiting for renames to finish`\r\n\r\n#### What is your rclone version (output from `rclone version`)\r\n\r\n```\r\nrclone v1.52.2-192-g8d5bc7f2-beta\r\n- os/arch: linux/amd64\r\n- go version: go1.14.4\r\n```\r\n\r\n#### Which OS you are using and how many bits (eg Windows 7, 64 bit)\r\n\r\nUnraid 64 bit / Docker\r\n\r\n####  Which cloud storage system are you using? (eg Google Drive)\r\n\r\nGoogle Drive crypt\r\n\r\n#### The command you were trying to run (eg `rclone copy /tmp remote:tmp`)\r\n\r\n`rclone sync \"/mnt/user/test\" \"crypt:current/test\" --progress --fast-list --max-backlog 10000000 --transfers 3 --tpslimit 3 --checkers 16 --track-renames --track-renames-strategy \"modtime\" --dry-run --log-file \"/mnt/user/scripts/rclone/logs/testing.txt\" -vv`\r\n\r\nNote the same error still happens without all the other additional flags, i.e.:\r\n\r\n`rclone sync \"/mnt/user/test\" \"crypt:current/test\" --dry-run --track-renames --track-renames-strategy \"modtime\"\r\n`\r\n\r\n#### A log from the command with the `-vv` flag (eg output from `rclone -vv copy /tmp remote:tmp`)\r\n\r\n[log.txt](https://github.com/rclone/rclone/files/4906698/log.txt)\r\n\r\n","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/4427/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/4427/timeline","performed_via_github_app":null,"state_reason":"completed"}