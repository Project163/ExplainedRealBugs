{"url":"https://api.github.com/repos/rclone/rclone/issues/2157","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/2157/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/2157/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/2157/events","html_url":"https://github.com/rclone/rclone/issues/2157","id":306967045,"node_id":"MDU6SXNzdWUzMDY5NjcwNDU=","number":2157,"title":"rclone using too much memory","user":{"login":"calisro","id":5018276,"node_id":"MDQ6VXNlcjUwMTgyNzY=","avatar_url":"https://avatars.githubusercontent.com/u/5018276?v=4","gravatar_id":"","url":"https://api.github.com/users/calisro","html_url":"https://github.com/calisro","followers_url":"https://api.github.com/users/calisro/followers","following_url":"https://api.github.com/users/calisro/following{/other_user}","gists_url":"https://api.github.com/users/calisro/gists{/gist_id}","starred_url":"https://api.github.com/users/calisro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calisro/subscriptions","organizations_url":"https://api.github.com/users/calisro/orgs","repos_url":"https://api.github.com/users/calisro/repos","events_url":"https://api.github.com/users/calisro/events{/privacy}","received_events_url":"https://api.github.com/users/calisro/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399005,"node_id":"MDU6TGFiZWw4NjM5OTAwNQ==","url":"https://api.github.com/repos/rclone/rclone/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/rclone/rclone/milestones/28","html_url":"https://github.com/rclone/rclone/milestone/28","labels_url":"https://api.github.com/repos/rclone/rclone/milestones/28/labels","id":3028709,"node_id":"MDk6TWlsZXN0b25lMzAyODcwOQ==","number":28,"title":"v1.41","description":"","creator":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":33,"state":"closed","created_at":"2018-01-11T14:25:44Z","updated_at":"2018-05-10T10:57:57Z","due_on":"2018-04-29T07:00:00Z","closed_at":"2018-04-28T12:06:39Z"},"comments":43,"created_at":"2018-03-20T17:33:29Z","updated_at":"2018-06-22T13:18:15Z","closed_at":"2018-03-24T11:17:51Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"rclone v1.39-211-g572ee5ecβ\r\n- os/arch: linux/amd64\r\n- go version: go1.10\r\n\r\n\r\nI recently upgraded from rclone.v1.38-235-g2a01fa9fβ to  rclone v1.39-211-g572ee5ecβ\r\n\r\nI'm using the following mount:\r\nexport RCLONE_CONFIG=\"/home/robert/.rclone.conf\"\r\nexport RCLONE_BUFFER_SIZE=0M\r\nexport RCLONE_RETRIES=5\r\nexport RCLONE_STATS=0\r\nexport RCLONE_TIMEOUT=10m\r\nexport RCLONE_LOG_LEVEL=INFO\r\nexport RCLONE_DRIVE_USE_TRASH=false\r\n    /usr/sbin/rclone -vv --log-file /data/log/rmount-gs.log \\\r\n     mount robgs-cryptp:Media $GS_RCLONE \\\r\n     --allow-other \\\r\n     --default-permissions \\\r\n     --gid $gid --uid $uid \\\r\n     --max-read-ahead 1024k \\\r\n     --buffer-size 50M \\\r\n     --dir-cache-time=72h \\\r\n     --umask $UMASK 2>&1 > /data/log/debug &\r\n\r\nThis worked flawlessly before.  In the most recent version, it is using WAY too much memory causing OOM issues on my linux server.  The above uses upwards of 7GIGS of resident memory before my OOM killer terminates the mount when activity is being read/written to the mount.  I used to be able to crank up the buffer-size to 150M without issues.  There is NOTHING else different between the setup. I can restore my old version and re-run the batch process without issues and then replace it with the new version and it consistently terminates due to OOM after consuming everything left.\r\n\r\nIf I restore the old version and rerun the exact same process, rclone consistently uses no more than 1.8G.  \r\n\r\nI can provide logs but there is nothing them.  They simply show transfers.  Even in the fuse-debug there is nothing but normal activity.    There seems to be either a leak or the use of memory has changed DRASTICALLY between the versions making things unusable.  I've rolled back till this is sorted.","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/2157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/2157/timeline","performed_via_github_app":null,"state_reason":"completed"}