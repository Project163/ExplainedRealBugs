{"url":"https://api.github.com/repos/rclone/rclone/issues/4950","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/4950/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/4950/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/4950/events","html_url":"https://github.com/rclone/rclone/issues/4950","id":792215670,"node_id":"MDU6SXNzdWU3OTIyMTU2NzA=","number":4950,"title":"Errors with symlinks and Google Drive","user":{"login":"ruphy","id":2030,"node_id":"MDQ6VXNlcjIwMzA=","avatar_url":"https://avatars.githubusercontent.com/u/2030?v=4","gravatar_id":"","url":"https://api.github.com/users/ruphy","html_url":"https://github.com/ruphy","followers_url":"https://api.github.com/users/ruphy/followers","following_url":"https://api.github.com/users/ruphy/following{/other_user}","gists_url":"https://api.github.com/users/ruphy/gists{/gist_id}","starred_url":"https://api.github.com/users/ruphy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ruphy/subscriptions","organizations_url":"https://api.github.com/users/ruphy/orgs","repos_url":"https://api.github.com/users/ruphy/repos","events_url":"https://api.github.com/users/ruphy/events{/privacy}","received_events_url":"https://api.github.com/users/ruphy/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399007,"node_id":"MDU6TGFiZWw4NjM5OTAwNw==","url":"https://api.github.com/repos/rclone/rclone/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":null},{"id":306063362,"node_id":"MDU6TGFiZWwzMDYwNjMzNjI=","url":"https://api.github.com/repos/rclone/rclone/labels/Remote:%20Local%20FS","name":"Remote: Local FS","color":"fbca04","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"ruphy","id":2030,"node_id":"MDQ6VXNlcjIwMzA=","avatar_url":"https://avatars.githubusercontent.com/u/2030?v=4","gravatar_id":"","url":"https://api.github.com/users/ruphy","html_url":"https://github.com/ruphy","followers_url":"https://api.github.com/users/ruphy/followers","following_url":"https://api.github.com/users/ruphy/following{/other_user}","gists_url":"https://api.github.com/users/ruphy/gists{/gist_id}","starred_url":"https://api.github.com/users/ruphy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ruphy/subscriptions","organizations_url":"https://api.github.com/users/ruphy/orgs","repos_url":"https://api.github.com/users/ruphy/repos","events_url":"https://api.github.com/users/ruphy/events{/privacy}","received_events_url":"https://api.github.com/users/ruphy/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"ruphy","id":2030,"node_id":"MDQ6VXNlcjIwMzA=","avatar_url":"https://avatars.githubusercontent.com/u/2030?v=4","gravatar_id":"","url":"https://api.github.com/users/ruphy","html_url":"https://github.com/ruphy","followers_url":"https://api.github.com/users/ruphy/followers","following_url":"https://api.github.com/users/ruphy/following{/other_user}","gists_url":"https://api.github.com/users/ruphy/gists{/gist_id}","starred_url":"https://api.github.com/users/ruphy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ruphy/subscriptions","organizations_url":"https://api.github.com/users/ruphy/orgs","repos_url":"https://api.github.com/users/ruphy/repos","events_url":"https://api.github.com/users/ruphy/events{/privacy}","received_events_url":"https://api.github.com/users/ruphy/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":5,"created_at":"2021-01-22T18:25:25Z","updated_at":"2021-01-28T18:19:55Z","closed_at":"2021-01-27T18:13:17Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"\r\n#### What is the problem you are having with rclone?\r\n\r\nI am backing up some LucidLink storage (a cloud storage provider that mounts with its daemon as a fuse space) to Google Drive, and links don't get copied because of a \"detected corruption\". The issue seems similar to #4581, however it persists even in the last beta.\r\n\r\nInterestingly, it seems to be a problem only with files stored on the Lucid mount, as I confirm that copying symlinks that exist on a traditional filesystem works just fine. Copying a directory with links from the Lucid mount to my homedir and retrying the copy from there makes everything work, so the bug definitely exists between the interaction of the two tools.\r\n\r\nHowever, symlinks exist properly within the lucid virtual filesystem and are otherwise properly behaving and working in any other app I tried so far (I have been using them extensively since a while niw). I can't get my head around why rclone should fail.\r\n\r\nThis is the test layout I am trying to copy over:\r\n```\r\n~/Lucid \r\n❯ file testdir/*\r\ntestdir/link-dir:  symbolic link to test1\r\ntestdir/link-file: symbolic link to test2\r\ntestdir/test1:     directory\r\ntestdir/test2:     empty\r\n```\r\n\r\n#### What is your rclone version (output from `rclone version`)\r\n\r\n`v1.54.0-beta.5087.3e986cdf5`\r\n\r\n#### Which OS you are using and how many bits (e.g. Windows 7, 64 bit)\r\n\r\nLinux (Elementary OS - Ubuntu LTS)\r\n\r\n####  Which cloud storage system are you using? (e.g. Google Drive)\r\n\r\nGoogle Drive\r\n\r\n#### The command you were trying to run (e.g. `rclone copy /tmp remote:tmp`)\r\n\r\n`❯ rclone copy -vv -Pl testdir gdrive:testdir `\r\n\r\n\r\n#### A log from the command with the `-vv` flag (e.g. output from `rclone -vv copy /tmp remote:tmp`)\r\n\r\n```\r\n~/Lucid\r\n❯ rclone copy -vv -Pl testdir gdrive:testdir \r\n2021/01/22 19:15:39 DEBUG : rclone: Version \"v1.54.0-beta.5087.3e986cdf5\" starting with parameters [\"rclone\" \"copy\" \"-vv\" \"-Pl\" \"testdir\" \"gdrive:testdir\"]\r\n2021/01/22 19:15:39 DEBUG : Creating backend with remote \"testdir\"\r\n2021/01/22 19:15:39 DEBUG : Using config file from \"/home/ruphy/.config/rclone/rclone.conf\"\r\n2021/01/22 19:15:39 DEBUG : fs cache: renaming cache item \"testdir\" to be canonical \"/home/ruphy/Lucid/testdir\"\r\n2021/01/22 19:15:39 DEBUG : Creating backend with remote \"gdrive:testdir\"\r\n2021/01/22 19:15:39 DEBUG : gdrive: Loaded invalid token from config file - ignoring\r\n2021/01/22 19:15:39 DEBUG : gdrive: Saved new token in config file\r\n2021-01-22 19:15:41 DEBUG : Google drive root 'testdir': Waiting for checks to finish\r\n2021-01-22 19:15:41 DEBUG : Google drive root 'testdir': Waiting for transfers to finish\r\n2021-01-22 19:15:44 DEBUG : test2: MD5 = d41d8cd98f00b204e9800998ecf8427e OK\r\n2021-01-22 19:15:44 INFO  : test2: Copied (new)\r\n2021-01-22 19:15:46 DEBUG : test1/empty: MD5 = d41d8cd98f00b204e9800998ecf8427e OK\r\n2021-01-22 19:15:46 INFO  : test1/empty: Copied (new)\r\n2021-01-22 19:15:46 ERROR : link-file.rclonelink: corrupted on transfer: sizes differ 0 vs 5\r\n2021-01-22 19:15:46 INFO  : link-file.rclonelink: Removing failed copy\r\n2021-01-22 19:15:46 ERROR : link-dir.rclonelink: corrupted on transfer: sizes differ 0 vs 5\r\n2021-01-22 19:15:46 INFO  : link-dir.rclonelink: Removing failed copy\r\n2021-01-22 19:15:47 ERROR : Attempt 1/3 failed with 2 errors and: corrupted on transfer: sizes differ 0 vs 5\r\n2021-01-22 19:15:47 DEBUG : test2: Size and modification time the same (differ by -452.558µs, within tolerance 1ms)\r\n2021-01-22 19:15:47 DEBUG : test2: Unchanged skipping\r\n2021-01-22 19:15:48 DEBUG : test1/empty: Size and modification time the same (differ by -558.716µs, within tolerance 1ms)\r\n2021-01-22 19:15:48 DEBUG : test1/empty: Unchanged skipping\r\n2021-01-22 19:15:48 DEBUG : Google drive root 'testdir': Waiting for checks to finish\r\n2021-01-22 19:15:48 DEBUG : Google drive root 'testdir': Waiting for transfers to finish\r\n2021-01-22 19:15:49 ERROR : link-dir.rclonelink: corrupted on transfer: sizes differ 0 vs 5\r\n2021-01-22 19:15:49 INFO  : link-dir.rclonelink: Removing failed copy\r\n2021-01-22 19:15:49 ERROR : link-file.rclonelink: corrupted on transfer: sizes differ 0 vs 5\r\n2021-01-22 19:15:49 INFO  : link-file.rclonelink: Removing failed copy\r\n2021-01-22 19:15:50 ERROR : Attempt 2/3 failed with 2 errors and: corrupted on transfer: sizes differ 0 vs 5\r\n2021-01-22 19:15:50 DEBUG : test2: Size and modification time the same (differ by -452.558µs, within tolerance 1ms)\r\n2021-01-22 19:15:50 DEBUG : test2: Unchanged skipping\r\n2021-01-22 19:15:51 DEBUG : test1/empty: Size and modification time the same (differ by -558.716µs, within tolerance 1ms)\r\n2021-01-22 19:15:51 DEBUG : test1/empty: Unchanged skipping\r\n2021-01-22 19:15:51 DEBUG : Google drive root 'testdir': Waiting for checks to finish\r\n2021-01-22 19:15:51 DEBUG : Google drive root 'testdir': Waiting for transfers to finish\r\n2021-01-22 19:15:52 ERROR : link-file.rclonelink: corrupted on transfer: sizes differ 0 vs 5\r\n2021-01-22 19:15:52 INFO  : link-file.rclonelink: Removing failed copy\r\n2021-01-22 19:15:52 ERROR : link-dir.rclonelink: corrupted on transfer: sizes differ 0 vs 5\r\n2021-01-22 19:15:52 INFO  : link-dir.rclonelink: Removing failed copy\r\n2021-01-22 19:15:53 ERROR : Attempt 3/3 failed with 2 errors and: corrupted on transfer: sizes differ 0 vs 5\r\nTransferred:            30 / 30 Bytes, 100%, 2 Bytes/s, ETA 0s\r\nErrors:                 2 (retrying may help)\r\nChecks:                 4 / 4, 100%\r\nTransferred:            2 / 2, 100%\r\nElapsed time:        14.0s\r\n2021/01/22 19:15:53 INFO  : \r\nTransferred:            30 / 30 Bytes, 100%, 2 Bytes/s, ETA 0s\r\nErrors:                 2 (retrying may help)\r\nChecks:                 4 / 4, 100%\r\nTransferred:            2 / 2, 100%\r\nElapsed time:        14.0s\r\n\r\n2021/01/22 19:15:53 DEBUG : 14 go routines active\r\n2021/01/22 19:15:53 Failed to copy with 2 errors: last error was: corrupted on transfer: sizes differ 0 vs 5\r\n```\r\n","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/4950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/4950/timeline","performed_via_github_app":null,"state_reason":"completed"}