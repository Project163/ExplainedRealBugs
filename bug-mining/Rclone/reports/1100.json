{"url":"https://api.github.com/repos/rclone/rclone/issues/5066","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/5066/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/5066/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/5066/events","html_url":"https://github.com/rclone/rclone/issues/5066","id":815956125,"node_id":"MDU6SXNzdWU4MTU5NTYxMjU=","number":5066,"title":"s3: seems to not figure out bucket zone \"automagically\"","user":{"login":"yarikoptic","id":39889,"node_id":"MDQ6VXNlcjM5ODg5","avatar_url":"https://avatars.githubusercontent.com/u/39889?v=4","gravatar_id":"","url":"https://api.github.com/users/yarikoptic","html_url":"https://github.com/yarikoptic","followers_url":"https://api.github.com/users/yarikoptic/followers","following_url":"https://api.github.com/users/yarikoptic/following{/other_user}","gists_url":"https://api.github.com/users/yarikoptic/gists{/gist_id}","starred_url":"https://api.github.com/users/yarikoptic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yarikoptic/subscriptions","organizations_url":"https://api.github.com/users/yarikoptic/orgs","repos_url":"https://api.github.com/users/yarikoptic/repos","events_url":"https://api.github.com/users/yarikoptic/events{/privacy}","received_events_url":"https://api.github.com/users/yarikoptic/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399007,"node_id":"MDU6TGFiZWw4NjM5OTAwNw==","url":"https://api.github.com/repos/rclone/rclone/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":null},{"id":314138213,"node_id":"MDU6TGFiZWwzMTQxMzgyMTM=","url":"https://api.github.com/repos/rclone/rclone/labels/Remote:%20S3","name":"Remote: S3","color":"fbca04","default":false,"description":null},{"id":718218493,"node_id":"MDU6TGFiZWw3MTgyMTg0OTM=","url":"https://api.github.com/repos/rclone/rclone/labels/help%20wanted","name":"help wanted","color":"c2e0c6","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/rclone/rclone/milestones/13","html_url":"https://github.com/rclone/rclone/milestone/13","labels_url":"https://api.github.com/repos/rclone/rclone/milestones/13/labels","id":1575401,"node_id":"MDk6TWlsZXN0b25lMTU3NTQwMQ==","number":13,"title":"Help Wanted","description":"Enhancements which might be useful, but currently aren't planned.\r\n\r\nAny help doing these much appreciated.","creator":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":228,"closed_issues":302,"state":"open","created_at":"2016-02-10T17:44:20Z","updated_at":"2025-11-04T14:55:57Z","due_on":null,"closed_at":null},"comments":5,"created_at":"2021-02-25T00:24:52Z","updated_at":"2022-11-02T11:48:16Z","closed_at":"2022-11-02T11:48:16Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### What is the problem you are having with rclone?\r\n\r\nit works so good that I want to (ab)use it more, but it is resisting ;)\r\n\r\nsummary: having a generic s3 configuration without zone specification seems to work only for some public buckets (in `us-east-1`?) zone but not the others.\r\n\r\n<details>\r\n<summary>\r\nNot sure how, but e.g. python's good old boto 2.49.0 seems to connect to sample buckets anonymously just fine without any zone specification:\r\n</summary> \r\n\r\n```shell\r\n$> python3 -c 'import boto; print(next(iter(boto.connect_s3(anon=True).get_bucket(\"fcp-indi\").list_versions())))'\r\n<boto.s3.deletemarker.DeleteMarker object at 0x7f81e2e679d0>\r\n\r\n$> python3 -c 'import boto; print(next(iter(boto.connect_s3(anon=True).get_bucket(\"openfmri\").list_versions())))'  \r\n<Key: openfmri,corral-repl/utexas/poldracklab/openfmri/inprocess/ds113c/ds113c-gitannex/tarballs/ds113c_R1.0.0_metadata.tar.gz>\r\n\r\n$> python3 -c 'import boto; print(next(iter(boto.connect_s3(anon=True).get_bucket(\"dandiarchive\").list_versions())))'\r\n<Key: dandiarchive,dandiarchive/dandiarchive/2019-10-02T04-00Z/manifest.checksum>\r\n```\r\n</details>\r\n\r\nwhenever rclone would work for first two but fail for the last:\r\n\r\n```shell\r\n$> tail -3 ~/.config/rclone/rclone.conf\r\n[s3]\r\ntype = s3\r\nprovider = AWS\r\n\r\n$> rclone ls s3:dandiarchive       \r\n2021/02/24 19:16:53 ERROR : S3 bucket dandiarchive: Failed to update region for bucket: reading bucket location failed: AccessDenied: Access Denied\r\n\tstatus code: 403, request id: 1C82D50F1B54F94D, host id: P2abi9H9rNSseBsDWVHlgw+rRalYTtAyakieS269zt2ltlPaFzUH1WhmLS3dMhKzZZ47KRxf8fM=\r\n2021/02/24 19:16:53 Failed to ls: BucketRegionError: incorrect region, the bucket is not in 'us-east-1' region at endpoint ''\r\n\tstatus code: 301, request id: , host id: \r\n```\r\n\r\nFor this bucket I could even query for the zone:\r\n\r\n```shell\r\n$> python3 -c 'import boto; print(boto.connect_s3(anon=True).get_bucket(\"dandiarchive\").get_location())' \r\nus-east-2\r\n```\r\n\r\nAnd rclone does work if I use rclone config where I did specify zone:\r\n\r\n```\r\n[s3_us_east_2]\r\ntype = s3\r\nprovider = AWS\r\nregion = us-east-2\r\n```\r\n\r\n```shell\r\n$> rclone ls s3_us_east_2:dandiarchive | head\r\n       33 dandiarchive/dandiarchive/2019-10-02T04-00Z/manifest.checksum\r\n      490 dandiarchive/dandiarchive/2019-10-02T04-00Z/manifest.json\r\n...\r\n```\r\n\r\n#### What is your rclone version (output from `rclone version`)\r\n\r\nrclone v1.53.3-DEV\r\n- os/arch: linux/amd64\r\n- go version: go1.15.5\r\n\r\n#### Which OS you are using and how many bits (e.g. Windows 7, 64 bit)\r\n\r\nDebian GNU/Linux testing/unstable mix\r\n\r\n#### A log from the command with the `-vv` flag (e.g. output from `rclone -vv copy /tmp remote:tmp`)\r\n\r\n```shell\r\n$> rclone ls -vvv s3:dandiarchive  \r\n2021/02/24 19:20:55 DEBUG : rclone: Version \"v1.53.3-DEV\" starting with parameters [\"rclone\" \"ls\" \"-vvv\" \"s3:dandiarchive\"]\r\n2021/02/24 19:20:55 DEBUG : Using config file from \"/home/yoh/.config/rclone/rclone.conf\"\r\n2021/02/24 19:20:55 DEBUG : Creating backend with remote \"s3:dandiarchive\"\r\n2021/02/24 19:20:55 ERROR : S3 bucket dandiarchive: Failed to update region for bucket: reading bucket location failed: AccessDenied: Access Denied\r\n\tstatus code: 403, request id: AC1347C12224B7FD, host id: ljNjKG0S3uwLJEnGMYgHt8Qe3pjGTlXU7f+Ai8LlEl7jWWEtEf+dnUXs/jdQI9OTBTK3qhcib48=\r\n2021/02/24 19:20:55 DEBUG : 4 go routines active\r\n2021/02/24 19:20:55 Failed to ls: BucketRegionError: incorrect region, the bucket is not in 'us-east-1' region at endpoint ''\r\n\tstatus code: 301, request id: , host id: \r\n```","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/5066/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/5066/timeline","performed_via_github_app":null,"state_reason":"completed"}