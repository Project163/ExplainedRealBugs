{"url":"https://api.github.com/repos/rclone/rclone/issues/8355","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/8355/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/8355/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/8355/events","html_url":"https://github.com/rclone/rclone/issues/8355","id":2825365995,"node_id":"I_kwDOAQ-n5M6oZ6nr","number":8355,"title":"fatal error: concurrent map writes","user":{"login":"cilki","id":10459406,"node_id":"MDQ6VXNlcjEwNDU5NDA2","avatar_url":"https://avatars.githubusercontent.com/u/10459406?v=4","gravatar_id":"","url":"https://api.github.com/users/cilki","html_url":"https://github.com/cilki","followers_url":"https://api.github.com/users/cilki/followers","following_url":"https://api.github.com/users/cilki/following{/other_user}","gists_url":"https://api.github.com/users/cilki/gists{/gist_id}","starred_url":"https://api.github.com/users/cilki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cilki/subscriptions","organizations_url":"https://api.github.com/users/cilki/orgs","repos_url":"https://api.github.com/users/cilki/repos","events_url":"https://api.github.com/users/cilki/events{/privacy}","received_events_url":"https://api.github.com/users/cilki/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399005,"node_id":"MDU6TGFiZWw4NjM5OTAwNQ==","url":"https://api.github.com/repos/rclone/rclone/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":306063207,"node_id":"MDU6TGFiZWwzMDYwNjMyMDc=","url":"https://api.github.com/repos/rclone/rclone/labels/Remote:%20Backblaze%20B2","name":"Remote: Backblaze B2","color":"fbca04","default":false,"description":null},{"id":1710413418,"node_id":"MDU6TGFiZWwxNzEwNDEzNDE4","url":"https://api.github.com/repos/rclone/rclone/labels/Point%20Release%20Candidate","name":"Point Release Candidate","color":"b60205","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/rclone/rclone/milestones/58","html_url":"https://github.com/rclone/rclone/milestone/58","labels_url":"https://api.github.com/repos/rclone/rclone/milestones/58/labels","id":11570782,"node_id":"MI_kwDOAQ-n5M4AsI5e","number":58,"title":"v1.70","description":"","creator":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":30,"state":"closed","created_at":"2024-09-11T21:18:44Z","updated_at":"2025-06-23T15:40:38Z","due_on":"2025-06-17T07:00:00Z","closed_at":"2025-06-19T17:12:14Z"},"comments":4,"created_at":"2025-02-01T18:44:51Z","updated_at":"2025-02-03T11:34:30Z","closed_at":"2025-02-03T11:33:50Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### What is the problem you are having with rclone?\n\n```\nTransferred:   \t  214.899 GiB / 253.672 GiB, 85%, 47.525 MiB/s, ETA 13m55s\nTransferred:        23387 / 33399, 70%\nElapsed time:   1h16m43.3s\nTransferring:\n *  20170319_100813.mp4: 91% /48.184Mi, 30.995Mi/s, 0s\n *  20170319_100901.mp4: 22% /79.658Mi, 0/s, -\n * 010-12-11 11.57.50.jpg: 21% /2.333Mi, 0/s, -\n *  20170319_101035.mp4:  0% /552.517Mi, 0/s, -fatal error: concurrent map writes\nfatal error: concurrent map writes\n\ngoroutine 79229 [running]:\ngithub.com/rclone/rclone/backend/b2.(*Object).getOrHead(0xc002081810, {0x3c0bb70, 0xc00079af50}, {0x3773789, 0x3}, {0xc0021a1ad0, 0x1, 0x1})\n\tgithub.com/rclone/rclone/backend/b2/b2.go:1887 +0xa65\ngithub.com/rclone/rclone/backend/b2.(*Object).Open(0xc002081810, {0x3c0bb70, 0xc00079af50}, {0xc0021a1ad0, 0x1, 0x1})\n\tgithub.com/rclone/rclone/backend/b2/b2.go:1904 +0x98\ngithub.com/rclone/rclone/backend/crypt.(*Object).Open.func1({0x3c0bb70, 0xc00079af50}, 0x0, 0x10?)\n\tgithub.com/rclone/rclone/backend/crypt/crypt.go:1047 +0x175\ngithub.com/rclone/rclone/backend/crypt.(*Cipher).newDecrypterSeek(0xc0007c6dd0, {0x3c0bb70, 0xc00079af50}, 0xc003271740, 0x4000000, 0x4000000)\n\tgithub.com/rclone/rclone/backend/crypt/cipher.go:836 +0xf7\ngithub.com/rclone/rclone/backend/crypt.(*Cipher).DecryptDataSeek(0xc0018cf638?, {0x3c0bb70?, 0xc00079af50?}, 0x7f97989ce7e8?, 0x10?, 0x7f9799b28b88?)\n\tgithub.com/rclone/rclone/backend/crypt/cipher.go:1113 +0x1d\ngithub.com/rclone/rclone/backend/crypt.(*Object).Open(0xc0018cf638, {0x3c0bb70, 0xc00079af50}, {0xc0021a1ac0?, 0x20?, 0x1b807a7?})\n\tgithub.com/rclone/rclone/backend/crypt/crypt.go:1033 +0x313\ngithub.com/rclone/rclone/fs/operations.(*ReOpen).open(0xc0027269a0)\n\tgithub.com/rclone/rclone/fs/operations/reopen.go:147 +0x109\ngithub.com/rclone/rclone/fs/operations.NewReOpen({0x3c0bb70, 0xc00079af50}, {0x3c21d60, 0xc0018cf638}, 0xa, {0xc0021a1ab0, 0x1, 0x1})\n\tgithub.com/rclone/rclone/fs/operations/reopen.go:102 +0x50b\ngithub.com/rclone/rclone/fs/operations.Open({0x3c0bb70, 0xc00079af50}, {0x3c21d60, 0xc0018cf638}, {0xc0021a1ab0, 0x1, 0x1})\n\tgithub.com/rclone/rclone/fs/operations/reopen.go:124 +0x6b\ngithub.com/rclone/rclone/fs/operations.(*multiThreadCopyState).copyChunk(0xc00079afa0, {0x3c0bb70, 0xc00079af50}, 0x1, {0x3c054b0, 0xc00105a9c0})\n\tgithub.com/rclone/rclone/fs/operations/multithread.go:84 +0x2df\ngithub.com/rclone/rclone/fs/operations.multiThreadCopy.func2()\n\tgithub.com/rclone/rclone/fs/operations/multithread.go:228 +0x2b\ngolang.org/x/sync/errgroup.(*Group).Go.func1()\n\tgolang.org/x/sync@v0.8.0/errgroup/errgroup.go:78 +0x50\ncreated by golang.org/x/sync/errgroup.(*Group).Go in goroutine 73\n\tgolang.org/x/sync@v0.8.0/errgroup/errgroup.go:75 +0x96\n\ngoroutine 1 [semacquire, 76 minutes]:\nsync.runtime_Semacquire(0xc000171d20?)\n\truntime/sema.go:71 +0x25\nsync.(*WaitGroup).Wait(0xc0005d0ea0?)\n\tsync/waitgroup.go:118 +0x48\ngithub.com/rclone/rclone/fs/march.(*March).Run(0xc0005d0ea0, {0x3c0bb70, 0xc0001691d0})\n\tgithub.com/rclone/rclone/fs/march/march.go:216 +0x385\ngithub.com/rclone/rclone/fs/sync.(*syncCopyMove).run(0xc000808288)\n\tgithub.com/rclone/rclone/fs/sync/sync.go:952 +0x1f4\ngithub.com/rclone/rclone/fs/sync.runSyncCopyMove({0x3c0ba90, 0x51d5d20}, {0x3c22e70, 0xc0008ce500}, {0x3c219e0, 0xc0007c7ba0}, 0x0, 0x0, 0x0, 0x0)\n\tgithub.com/rclone/rclone/fs/sync/sync.go:1361 +0x208\ngithub.com/rclone/rclone/fs/sync.CopyDir(...)\n\tgithub.com/rclone/rclone/fs/sync/sync.go:1372\ngithub.com/rclone/rclone/cmd/copy.init.func1.1()\n\tgithub.com/rclone/rclone/cmd/copy/copy.go:103 +0x4d\ngithub.com/rclone/rclone/cmd.Run(0x1, 0x1, 0x5000600, 0xc001f75c30)\n\tgithub.com/rclone/rclone/cmd/cmd.go:251 +0x125\ngithub.com/rclone/rclone/cmd/copy.init.func1(0x5000600, {0xc000605f20, 0x2, 0x3})\n\tgithub.com/rclone/rclone/cmd/copy/copy.go:101 +0xbd\ngithub.com/spf13/cobra.(*Command).execute(0x5000600, {0xc000605ec0, 0x3, 0x3})\n\tgithub.com/spf13/cobra@v1.8.1/command.go:989 +0xa91\ngithub.com/spf13/cobra.(*Command).ExecuteC(0x4ffa440)\n\tgithub.com/spf13/cobra@v1.8.1/command.go:1117 +0x3ff\ngithub.com/spf13/cobra.(*Command).Execute(...)\n\tgithub.com/spf13/cobra@v1.8.1/command.go:1041\ngithub.com/rclone/rclone/cmd.Main()\n\tgithub.com/rclone/rclone/cmd/cmd.go:535 +0x31\nmain.main()\n\tgithub.com/rclone/rclone/rclone.go:14 +0xf\n\ngoroutine 73067 [select, 4 minutes]:\ngithub.com/rclone/rclone/fs/march.(*March).Run.func1.1()\n\tgithub.com/rclone/rclone/fs/march/march.go:185 +0x145\ncreated by github.com/rclone/rclone/fs/march.(*March).Run.func1 in goroutine 79\n\tgithub.com/rclone/rclone/fs/march/march.go:181 +0x3a9\n\ngoroutine 68522 [select, 2 minutes]:\ngithub.com/rclone/rclone/fs/march.(*March).Run.func1.1()\n\tgithub.com/rclone/rclone/fs/march/march.go:185 +0x145\ncreated by github.com/rclone/rclone/fs/march.(*March).Run.func1 in goroutine 79\n\tgithub.com/rclone/rclone/fs/march/march.go:181 +0x3a9\n\ngoroutine 22 [select]:\ngo.opencensus.io/stats/view.(*worker).start(0xc0005bc900)\n\tgo.opencensus.io@v0.24.0/stats/view/worker.go:292 +0x9f\ncreated by go.opencensus.io/stats/view.init.0 in goroutine 1\n\tgo.opencensus.io@v0.24.0/stats/view/worker.go:34 +0x8d\n\ngoroutine 25 [syscall, 76 minutes]:\nos/signal.signal_recv()\n\truntime/sigqueue.go:152 +0x29\nos/signal.loop()\n\tos/signal/signal_unix.go:23 +0x13\ncreated by os/signal.Notify.func1.1 in goroutine 1\n\tos/signal/signal.go:151 +0x1f\n\ngoroutine 26 [chan receive, 76 minutes]:\ngithub.com/rclone/rclone/fs/accounting.(*tokenBucket).startSignalHandler.func1()\n\tgithub.com/rclone/rclone/fs/accounting/accounting_unix.go:24 +0x27\ncreated by github.com/rclone/rclone/fs/accounting.(*tokenBucket).startSignalHandler in goroutine 1\n\tgithub.com/rclone/rclone/fs/accounting/accounting_unix.go:21 +0xa7\n\ngoroutine 73258 [select, 3 minutes]:\ngithub.com/rclone/rclone/fs/march.(*March).Run.func1.1()\n\tgithub.com/rclone/rclone/fs/march/march.go:185 +0x145\ncreated by github.com/rclone/rclone/fs/march.(*March).Run.func1 in goroutine 77\n\tgithub.com/rclone/rclone/fs/march/march.go:181 +0x3a9\n\ngoroutine 15 [select]:\ngithub.com/rclone/rclone/cmd.startProgress.func3()\n\tgithub.com/rclone/rclone/cmd/progress.go:57 +0xf2\ncreated by github.com/rclone/rclone/cmd.startProgress in goroutine 1\n\tgithub.com/rclone/rclone/cmd/progress.go:49 +0x12e\n\ngoroutine 73055 [select, 4 minutes]:\ngithub.com/rclone/rclone/fs/march.(*March).Run.func1.1()\n\tgithub.com/rclone/rclone/fs/march/march.go:185 +0x145\ncreated by github.com/rclone/rclone/fs/march.(*March).Run.func1 in goroutine 79\n\tgithub.com/rclone/rclone/fs/march/march.go:181 +0x3a9\n\ngoroutine 16 [select, 76 minutes]:\ngithub.com/rclone/rclone/fs/sync.(*pipe).GetMax(0xc0001690e0, {0x3c0bb70, 0xc000169220}, 0x0)\n\tgithub.com/rclone/rclone/fs/sync/pipe.go:126 +0xac\ngithub.com/rclone/rclone/fs/sync.(*syncCopyMove).pairChecker(0xc000808288, 0xc0001690e0, 0xc000169130, 0x0, 0xc000052500?)\n\tgithub.com/rclone/rclone/fs/sync/sync.go:370 +0xbe\ncreated by github.com/rclone/rclone/fs/sync.(*syncCopyMove).startCheckers in goroutine 1\n\tgithub.com/rclone/rclone/fs/sync/sync.go:515 +0x55\n\ngoroutine 66 [select, 76 minutes]:\ngithub.com/rclone/rclone/fs/sync.(*pipe).GetMax(0xc0001690e0, {0x3c0bb70, 0xc000169220}, 0xc)\n\tgithub.com/rclone/rclone/fs/sync/pipe.go:126 +0xac\ngithub.com/rclone/rclone/fs/sync.(*syncCopyMove).pairChecker(0xc000808288, 0xc0001690e0, 0xc000169130, 0xc, 0xc0000524b0?)\n\tgithub.com/rclone/rclone/fs/sync/sync.go:370 +0xbe\ncreated by github.com/rclone/rclone/fs/sync.(*syncCopyMove).startCheckers in goroutine 1\n\tgithub.com/rclone/rclone/fs/sync/sync.go:515 +0x55\n...\n```\n\n#### What is your rclone version (output from `rclone version`)\n\n```\nrclone 1.68.2\n- os/version: nixos 24.11 (64 bit)\n- os/kernel: 6.6.74 (x86_64)\n- os/type: linux\n- os/arch: amd64\n- go/version: go1.23.5\n- go/linking: dynamic\n- go/tags: cmount\n```\n\n\n#### Which cloud storage system are you using? (e.g. Google Drive)\n\nBackblaze B2 + `crypt` backend\n\n#### The command you were trying to run (e.g. `rclone copy /tmp remote:tmp`)\n\n```sh\nrclone copy -P remote:/ /mnt/\n```\n","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/8355/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/8355/timeline","performed_via_github_app":null,"state_reason":"completed"}