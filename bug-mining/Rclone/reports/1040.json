{"url":"https://api.github.com/repos/rclone/rclone/issues/6013","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/6013/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/6013/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/6013/events","html_url":"https://github.com/rclone/rclone/issues/6013","id":1151493523,"node_id":"I_kwDOAQ-n5M5EomWT","number":6013,"title":"Memory leak with compress + encrypt backend on Google Drive","user":{"login":"mrtolkien","id":8489650,"node_id":"MDQ6VXNlcjg0ODk2NTA=","avatar_url":"https://avatars.githubusercontent.com/u/8489650?v=4","gravatar_id":"","url":"https://api.github.com/users/mrtolkien","html_url":"https://github.com/mrtolkien","followers_url":"https://api.github.com/users/mrtolkien/followers","following_url":"https://api.github.com/users/mrtolkien/following{/other_user}","gists_url":"https://api.github.com/users/mrtolkien/gists{/gist_id}","starred_url":"https://api.github.com/users/mrtolkien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrtolkien/subscriptions","organizations_url":"https://api.github.com/users/mrtolkien/orgs","repos_url":"https://api.github.com/users/mrtolkien/repos","events_url":"https://api.github.com/users/mrtolkien/events{/privacy}","received_events_url":"https://api.github.com/users/mrtolkien/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399005,"node_id":"MDU6TGFiZWw4NjM5OTAwNQ==","url":"https://api.github.com/repos/rclone/rclone/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":2528508859,"node_id":"MDU6TGFiZWwyNTI4NTA4ODU5","url":"https://api.github.com/repos/rclone/rclone/labels/Remote:%20Compress","name":"Remote: Compress","color":"fbca04","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":13,"created_at":"2022-02-26T08:48:41Z","updated_at":"2022-03-04T15:46:15Z","closed_at":"2022-03-03T17:20:37Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### What is the problem you are having with rclone?\r\n`rclone` memory usage goes up linearly to the point where it crashes my machine. Tried it 5 times already, always the same outcome.\r\n\r\n#### What is your rclone version (output from `rclone version`)\r\n```shell\r\n‚ùØ rclone --version\r\nrclone v1.58.0-beta.6000.5650c1aa3.fix-5994-compress-crash\r\n- os/version: debian 10.11 (64 bit)\r\n- os/kernel: 5.4.166-1-pve (x86_64)\r\n- os/type: linux\r\n- os/arch: amd64\r\n- go/version: go1.17.6\r\n- go/linking: static\r\n- go/tags: none\r\n```\r\n\r\n#### Which OS you are using and how many bits (e.g. Windows 7, 64 bit)\r\nDebian 10 amd64\r\n\r\n#### Which cloud storage system are you using? (e.g. Google Drive)\r\nGoogle Drive\r\n\r\n#### The command you were trying to run (e.g. `rclone copy /tmp remote:tmp`)\r\n`rclone copy /slowpool gdrive_tachikoma_compress:slowpool -P --skip-links`\r\n\r\nThe remotes are configured as follow:\r\n```\r\n[gdrive_tachikoma]\r\ntype = drive\r\nclient_id = xxxx\r\nclient_secret = xxxx\r\nscope = drive\r\ntoken = xxxx\r\nteam_drive = \r\n\r\n[gdrive_tachikoma_crypt]\r\ntype = crypt\r\nremote = gdrive_tachikoma:NAS/BACKUP\r\npassword = xxx\r\npassword2 = xxx\r\n\r\n[gdrive_tachikoma_compress]\r\ntype = compress\r\nremote = gdrive_tachikoma_crypt:\r\n```\r\n\r\n#### A log from the command with the `-vv` flag (e.g. output from `rclone -vv copy /tmp remote:tmp`)\r\nThere are no particular logs from `rclone` as everything goes fine until the OS sends a `SIGKILL` once it reaches 100% RAM usage.\r\n\r\nI will re-run the command with `-vv` and update here if anything of notice appears.\r\n\r\n#### `atop` data\r\n\r\n`VGROW` represent \"The amount of virtual memory that the process has grown during the last interval\". As you can see, it's roughly 1Gb/10m, which is indicative of a memory leak.\r\n\r\n16:55\r\n![image](https://user-images.githubusercontent.com/8489650/155836522-b8fe6895-6feb-4ef8-9622-c187c635d405.png)\r\n17:05\r\n![image](https://user-images.githubusercontent.com/8489650/155836531-0fa9eb03-d5bd-4aa0-adf7-67a82b6db90d.png)\r\n17:15\r\n![image](https://user-images.githubusercontent.com/8489650/155836576-6967a402-af14-4b83-bbcf-2a75935efe16.png)\r\n17:25\r\n![image](https://user-images.githubusercontent.com/8489650/155836584-b24d7ce1-f02a-4662-b1c6-41ada8ff9c05.png)\r\n17:35\r\n![image](https://user-images.githubusercontent.com/8489650/155836590-b7b36754-0629-4906-b595-c183e6f36258.png)\r\n\r\n<!--- Please keep the note below for others who read your bug report. -->\r\n\r\n#### How to use GitHub\r\n\r\n* Please use the üëç [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to show that you are affected by the same issue.\r\n* Please don't comment if you have no relevant information to add. It's just extra noise for everyone subscribed to this issue.\r\n* Subscribe to receive notifications on status change and new comments.\r\n","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/6013/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/6013/timeline","performed_via_github_app":null,"state_reason":"completed"}