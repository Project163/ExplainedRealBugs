{"url":"https://api.github.com/repos/rclone/rclone/issues/2880","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/2880/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/2880/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/2880/events","html_url":"https://github.com/rclone/rclone/issues/2880","id":394889734,"node_id":"MDU6SXNzdWUzOTQ4ODk3MzQ=","number":2880,"title":"drive: increase pacer to 100ms by default","user":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399007,"node_id":"MDU6TGFiZWw4NjM5OTAwNw==","url":"https://api.github.com/repos/rclone/rclone/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":null},{"id":306062764,"node_id":"MDU6TGFiZWwzMDYwNjI3NjQ=","url":"https://api.github.com/repos/rclone/rclone/labels/Remote:%20Drive","name":"Remote: Drive","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/rclone/rclone/milestones/33","html_url":"https://github.com/rclone/rclone/milestone/33","labels_url":"https://api.github.com/repos/rclone/rclone/milestones/33/labels","id":3752396,"node_id":"MDk6TWlsZXN0b25lMzc1MjM5Ng==","number":33,"title":"v1.46","description":"","creator":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":43,"state":"closed","created_at":"2018-10-19T14:56:28Z","updated_at":"2019-02-09T18:12:01Z","due_on":"2019-02-09T08:00:00Z","closed_at":"2019-02-09T18:11:23Z"},"comments":18,"created_at":"2018-12-30T17:52:14Z","updated_at":"2019-01-27T21:20:35Z","closed_at":"2019-01-27T21:20:28Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Rclone currently uses a minimum pacer time for the google drive backend of 10mS which equates to 100 transactions per second.\r\n\r\nHowever the maximum allowed quota per user is 1000 transactions in 100 seconds.  Even rclone's key can't exceed this.\r\n\r\nThis means that we are potentially doing more work, receiving more 403 errors and increasing the chance of a ban.\r\n\r\nI propose to reduce the minimum pacer timeout to 100mS which is equivalent to 10 transactions per second.\r\n\r\nIn support of this, here are some tests made with an otherwise unused client_id with the user quota set to 1000 transactions per 100s.  These show uploading 100 small fles and listing 2,400 files (using `rclone size`) each in a reasonably normal file system heirachy.\r\n\r\nThese support quite strongly the idea that tpslimit 10 is the correct limit.\r\n\r\n![image](https://user-images.githubusercontent.com/536803/50549736-8e917c80-0c5a-11e9-9ac5-fb6360de8457.png)\r\n\r\n![image](https://user-images.githubusercontent.com/536803/50549743-99e4a800-0c5a-11e9-84b7-88cd94419b8b.png)\r\n\r\n![image](https://user-images.githubusercontent.com/536803/50549749-a7019700-0c5a-11e9-9693-72f2ad917118.png)\r\n\r\n![image](https://user-images.githubusercontent.com/536803/50549754-b97bd080-0c5a-11e9-9558-e6a29c0545cb.png)\r\n\r\nI haven't tested how equivalent exactly `--tps-limit` and the pacer limits are though.\r\n\r\nSo questions\r\n\r\n1. Is this a good idea?\r\n2. Should the pacer be configurable by the user?\r\n  - For drive min-sleep is the only parameter but there are others for the other backends\r\n\r\nThoughts @animosity22 and @B4dM4n ?\r\n\r\nI'll do a test implementation with the default pacer set to 100ms and making it configurable and post it here in a moment so we can experiment.\r\n","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/2880/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/2880/timeline","performed_via_github_app":null,"state_reason":"completed"}