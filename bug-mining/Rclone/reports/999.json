{"url":"https://api.github.com/repos/rclone/rclone/issues/5632","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/5632/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/5632/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/5632/events","html_url":"https://github.com/rclone/rclone/issues/5632","id":1007479668,"node_id":"I_kwDOAQ-n5M48DOt0","number":5632,"title":"can‚Äôt move inside union rclone mount","user":{"login":"cberni","id":4624597,"node_id":"MDQ6VXNlcjQ2MjQ1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/4624597?v=4","gravatar_id":"","url":"https://api.github.com/users/cberni","html_url":"https://github.com/cberni","followers_url":"https://api.github.com/users/cberni/followers","following_url":"https://api.github.com/users/cberni/following{/other_user}","gists_url":"https://api.github.com/users/cberni/gists{/gist_id}","starred_url":"https://api.github.com/users/cberni/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cberni/subscriptions","organizations_url":"https://api.github.com/users/cberni/orgs","repos_url":"https://api.github.com/users/cberni/repos","events_url":"https://api.github.com/users/cberni/events{/privacy}","received_events_url":"https://api.github.com/users/cberni/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399007,"node_id":"MDU6TGFiZWw4NjM5OTAwNw==","url":"https://api.github.com/repos/rclone/rclone/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":null},{"id":431089529,"node_id":"MDU6TGFiZWw0MzEwODk1Mjk=","url":"https://api.github.com/repos/rclone/rclone/labels/IMPORTANT","name":"IMPORTANT","color":"d93f0b","default":false,"description":null},{"id":1076920341,"node_id":"MDU6TGFiZWwxMDc2OTIwMzQx","url":"https://api.github.com/repos/rclone/rclone/labels/Remote:%20Union","name":"Remote: Union","color":"fbca04","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2021-09-26T19:24:57Z","updated_at":"2021-09-30T19:09:26Z","closed_at":"2021-09-30T14:54:26Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### The associated forum post URL from `https://forum.rclone.org`\r\n\r\nhttps://forum.rclone.org/t/cant-move-inside-union-rclone-mount/26645\r\n\r\n#### What is the problem you are having with rclone?\r\n\r\nIn order to rename a file you need to be able to Move it or Copy it then delete it (used in s3/gcs/swift/b2/etc as you can't rename an object)\r\nThe local backend can Move but not Copy\r\nThe bucket can Copy but not Move\r\nThe union's features are the AND of the underlying remotes so the union can't Move or Copy\r\nSo when rclone tries to move a file in the union it can't Move or Copy so it gives up.\r\n\r\nThe best solution that I can think of is for the union to advertise Move if all the underlying remotes support Move or Copy. Then in its own implementation of Move it should be turning Move into Copy+Delete on remotes which only support Copy.\r\n\r\n#### What is your rclone version (output from `rclone version`)\r\n\r\nrclone v1.56.1\r\n- os/version: ubuntu 20.04 (64 bit)\r\n- os/kernel: 5.4.0-86-generic (x86_64)\r\n- os/type: linux\r\n- os/arch: amd64\r\n- go/version: go1.16.8\r\n- go/linking: static\r\n- go/tags: none\r\n\r\n#### Which cloud storage system are you using? (e.g. Google Drive)\r\n\r\nunion of \"local\" and \"google cloud storate\"\r\n\r\n#### The command you were trying to run (e.g. `rclone copy /tmp remote:tmp`)\r\n\r\nroot@client:/union# mv a b\r\nmv: cannot move 'a' to 'b': Input/output error\r\n\r\n#### A log from the command with the `-vv` flag (e.g. output from `rclone -vv copy /tmp remote:tmp`)\r\n\r\n2021/09/22 13:05:13 DEBUG : /: Attr:\r\n2021/09/22 13:05:13 DEBUG : /: >Attr: attr=valid=1s ino=0 size=0 mode=drwxrwxr-x, err=<nil>\r\n2021/09/22 13:05:13 DEBUG : /: Lookup: name=\"a\"\r\n2021/09/22 13:05:13 DEBUG : /: >Lookup: node=a, err=<nil>\r\n2021/09/22 13:05:13 DEBUG : a: Attr:\r\n2021/09/22 13:05:13 DEBUG : a: >Attr: a=valid=1s ino=0 size=0 mode=-rw-rw-r--, err=<nil>\r\n2021/09/22 13:05:13 DEBUG : /: Lookup: name=\"b\"\r\n2021/09/22 13:05:13 DEBUG : /: >Lookup: node=<nil>, err=no such file or directory\r\n2021/09/22 13:05:13 DEBUG : /: Lookup: name=\"b\"\r\n2021/09/22 13:05:13 DEBUG : /: >Lookup: node=<nil>, err=no such file or directory\r\n2021/09/22 13:05:13 DEBUG : /: Lookup: name=\"b\"\r\n2021/09/22 13:05:13 DEBUG : /: >Lookup: node=<nil>, err=no such file or directory\r\n2021/09/22 13:05:13 DEBUG : /: Rename: oldName=\"a\", newName=\"b\", newDir=/\r\n2021/09/22 13:05:13 ERROR : a: Dir.Rename error: Fs \"union root ''\" can't rename files (no server-side Move or Copy)\r\n2021/09/22 13:05:13 ERROR : a: Dir.Rename error: Fs \"union root ''\" can't rename files (no server-side Move or Copy)\r\n2021/09/22 13:05:13 DEBUG : /: >Rename: err=Fs \"union root ''\" can't rename files (no server-side Move or Copy)\r\n2021/09/22 13:05:13 DEBUG : /: Lookup: name=\"b\"\r\n2021/09/22 13:05:13 DEBUG : /: >Lookup: node=<nil>, err=no such file or directory\r\n2021/09/22 13:05:13 DEBUG : /: Lookup: name=\"b\"\r\n2021/09/22 13:05:13 DEBUG : /: >Lookup: node=<nil>, err=no such file or directory\r\n\r\n<!--- Please keep the note below for others who read your bug report. -->\r\n\r\n#### How to use GitHub\r\n\r\n* Please use the üëç [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to show that you are affected by the same issue.\r\n* Please don't comment if you have no relevant information to add. It's just extra noise for everyone subscribed to this issue.\r\n* Subscribe to receive notifications on status change and new comments.\r\n","closed_by":{"login":"cberni","id":4624597,"node_id":"MDQ6VXNlcjQ2MjQ1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/4624597?v=4","gravatar_id":"","url":"https://api.github.com/users/cberni","html_url":"https://github.com/cberni","followers_url":"https://api.github.com/users/cberni/followers","following_url":"https://api.github.com/users/cberni/following{/other_user}","gists_url":"https://api.github.com/users/cberni/gists{/gist_id}","starred_url":"https://api.github.com/users/cberni/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cberni/subscriptions","organizations_url":"https://api.github.com/users/cberni/orgs","repos_url":"https://api.github.com/users/cberni/repos","events_url":"https://api.github.com/users/cberni/events{/privacy}","received_events_url":"https://api.github.com/users/cberni/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/5632/reactions","total_count":14,"+1":13,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/5632/timeline","performed_via_github_app":null,"state_reason":"completed"}