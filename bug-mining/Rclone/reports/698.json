{"url":"https://api.github.com/repos/rclone/rclone/issues/3232","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/3232/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/3232/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/3232/events","html_url":"https://github.com/rclone/rclone/issues/3232","id":449355024,"node_id":"MDU6SXNzdWU0NDkzNTUwMjQ=","number":3232,"title":"`--update` flag causes sync command to skip checksum checks","user":{"login":"cfbao","id":8552945,"node_id":"MDQ6VXNlcjg1NTI5NDU=","avatar_url":"https://avatars.githubusercontent.com/u/8552945?v=4","gravatar_id":"","url":"https://api.github.com/users/cfbao","html_url":"https://github.com/cfbao","followers_url":"https://api.github.com/users/cfbao/followers","following_url":"https://api.github.com/users/cfbao/following{/other_user}","gists_url":"https://api.github.com/users/cfbao/gists{/gist_id}","starred_url":"https://api.github.com/users/cfbao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cfbao/subscriptions","organizations_url":"https://api.github.com/users/cfbao/orgs","repos_url":"https://api.github.com/users/cfbao/repos","events_url":"https://api.github.com/users/cfbao/events{/privacy}","received_events_url":"https://api.github.com/users/cfbao/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":22,"created_at":"2019-05-28T16:05:13Z","updated_at":"2024-01-19T00:42:27Z","closed_at":"2019-10-12T10:57:16Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### What is the problem you are having with rclone?\r\nBy default, `rclone sync` will\r\n1. check file sizes and modtimes\r\n2. if there's a difference in modtime, check checksums\r\n3. if checksums are different, transfer from source to destination.\r\n\r\nWhen used with the `--update` flag, I expect the process to be similar, except it'd only proceed beyond the 1st step if the modtime at the destination is older (but not newer) than the modtime at the source.\r\n\r\nHowever, what `rclone sync --update` actually does is:\r\n1. check file sizes and modtimes\r\n2. if modtime at destination is older, directly proceed to transfer from source to destination without checking checksums\r\n\r\n#### What is your rclone version (output from `rclone version`)\r\n```\r\nrclone v1.47.0-086-ge7c20e0b-beta\r\n- os/arch: windows/amd64\r\n- go version: go1.12.3\r\n```\r\n\r\n#### Which OS you are using and how many bits (eg Windows 7, 64 bit)\r\nWindows 7 Pro 64-bit\r\n\r\n####  Which cloud storage system are you using? (eg Google Drive)\r\nFirst discovered when using Google Drive; reproduced on local filesystem.\r\n\r\n#### The command you were trying to run\r\nDiscovered the problem when running\r\n`rclone sync src dst --update -v`\r\n\r\nFor better clarity, here's a more elaborated sequence of commands\r\n```\r\n> rclone lsf src\r\ntest_file\r\n> rclone check src dst\r\n2019/05/28 11:45:52 NOTICE: Local file system at \\\\?\\D:\\test\\dst: 0 differences found\r\n2019/05/28 11:45:52 NOTICE: Local file system at \\\\?\\D:\\test\\dst: 1 matching files\r\n> rclone touch src/test_file\r\n> rclone sync src dst --no-update-modtime --stats 0 -v\r\n2019/05/28 11:48:49 INFO  : Local file system at \\\\?\\D:\\test\\dst: Waiting for checks to finish\r\n2019/05/28 11:48:49 INFO  : Local file system at \\\\?\\D:\\test\\dst: Waiting for transfers to finish\r\n2019/05/28 11:48:49 INFO  : Waiting for deletions to finish\r\n> rclone sync src dst --update --no-update-modtime --stats 0 -vv\r\n```\r\n\r\n#### A log from the command with the `-vv` flag\r\nlog of the last command:\r\n```\r\n2019/05/28 12:03:53 DEBUG : rclone: Version \"v1.47.0-086-ge7c20e0b-beta\" starting with parameters [\"rclone\" \"sync\" \"src\" \"dst\" \"--update\" \"--no-update-modtime\" \"--stats\" \"0\" \"-vv\"]\r\n2019/05/28 12:03:53 DEBUG : Using config file from \"C:\\\\Users\\\\Chenfeng\\\\.config\\\\rclone\\\\rclone.conf\"\r\n2019/05/28 12:03:53 INFO  : Local file system at \\\\?\\D:\\test\\dst: Waiting for checks to finish\r\n2019/05/28 12:03:53 DEBUG : test_file: Destination is older than source, transferring\r\n2019/05/28 12:03:53 INFO  : Local file system at \\\\?\\D:\\test\\dst: Waiting for transfers to finish\r\n2019/05/28 12:03:53 INFO  : test_file: Copied (replaced existing)\r\n2019/05/28 12:03:53 INFO  : Waiting for deletions to finish\r\n2019/05/28 12:03:53 DEBUG : 4 go routines active\r\n2019/05/28 12:03:53 DEBUG : rclone: Version \"v1.47.0-086-ge7c20e0b-beta\" finishing with parameters [\"rclone\" \"sync\" \"src\" \"dst\" \"--update\" \"--no-update-modtime\" \"--stats\" \"0\" \"-vv\"]\r\n```\r\n","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/3232/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/3232/timeline","performed_via_github_app":null,"state_reason":"completed"}