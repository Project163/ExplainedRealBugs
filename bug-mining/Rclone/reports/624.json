{"url":"https://api.github.com/repos/rclone/rclone/issues/3123","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/3123/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/3123/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/3123/events","html_url":"https://github.com/rclone/rclone/issues/3123","id":435731038,"node_id":"MDU6SXNzdWU0MzU3MzEwMzg=","number":3123,"title":"Error When Using S3 Accelerated Transfer Endpoint and No Bucket Name","user":{"login":"davidbitton","id":277207,"node_id":"MDQ6VXNlcjI3NzIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/277207?v=4","gravatar_id":"","url":"https://api.github.com/users/davidbitton","html_url":"https://github.com/davidbitton","followers_url":"https://api.github.com/users/davidbitton/followers","following_url":"https://api.github.com/users/davidbitton/following{/other_user}","gists_url":"https://api.github.com/users/davidbitton/gists{/gist_id}","starred_url":"https://api.github.com/users/davidbitton/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidbitton/subscriptions","organizations_url":"https://api.github.com/users/davidbitton/orgs","repos_url":"https://api.github.com/users/davidbitton/repos","events_url":"https://api.github.com/users/davidbitton/events{/privacy}","received_events_url":"https://api.github.com/users/davidbitton/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399005,"node_id":"MDU6TGFiZWw4NjM5OTAwNQ==","url":"https://api.github.com/repos/rclone/rclone/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":314138213,"node_id":"MDU6TGFiZWwzMTQxMzgyMTM=","url":"https://api.github.com/repos/rclone/rclone/labels/Remote:%20S3","name":"Remote: S3","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/rclone/rclone/milestones/35","html_url":"https://github.com/rclone/rclone/milestone/35","labels_url":"https://api.github.com/repos/rclone/rclone/milestones/35/labels","id":4043942,"node_id":"MDk6TWlsZXN0b25lNDA0Mzk0Mg==","number":35,"title":"v1.48","description":"","creator":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":22,"state":"closed","created_at":"2019-02-09T18:12:59Z","updated_at":"2019-06-19T08:41:20Z","due_on":"2019-06-15T07:00:00Z","closed_at":"2019-06-19T08:41:20Z"},"comments":6,"created_at":"2019-04-22T13:42:14Z","updated_at":"2019-05-02T13:02:19Z","closed_at":"2019-05-02T13:01:50Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\r\n\r\nWelcome :-) We understand you are having a problem with rclone; we want to help you with that!\r\n\r\nIf you've just got a question or aren't sure if you've found a bug then please use the rclone forum:\r\n\r\n    https://forum.rclone.org/\r\n\r\ninstead of filing an issue for a quick response.\r\n\r\nIf you think you might have found a bug, please can you try to replicate it with the latest beta?\r\n\r\n    https://beta.rclone.org/\r\n    \r\nIf you can still replicate it with the latest beta, then please fill in the info below which makes our lives much easier.  A log with -vv will make our day :-)\r\n\r\nThank you\r\n\r\nThe Rclone Developers\r\n\r\n-->\r\n\r\n#### What is the problem you are having with rclone?\r\nErrors generated when there is no S3 bucket specified when using a bucket specific accelerated transfer endpoint\r\n\r\n\r\n#### What is your rclone version (output from `rclone version`)\r\nv1.47.0\r\n\r\n\r\n#### Which OS you are using and how many bits (eg Windows 7, 64 bit)\r\nLinux ip-10-0-0-10.ec2.internal 3.10.0-957.10.1.el7.x86_64 #1 SMP Mon Mar 18 15:06:45 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n\r\n####  Which cloud storage system are you using? (eg Google Drive)\r\nDropbox and S3\r\n\r\n\r\n#### The command you were trying to run (eg `rclone copy /tmp remote:tmp`)\r\n`rclone -vv sync MBLive:/David\\ Bitton/ MBLive_S3:/  --stats-one-line --stats-unit bits  -P --stats 2s  --max-backlog 200000`\r\n\r\n\r\n#### A log from the command with the `-vv` flag (eg output from `rclone -vv copy /tmp remote:tmp`)\r\n```\r\n2019/04/21 02:29:15 DEBUG : rclone: Version \"v1.47.0\" starting with parameters [\"rclone\" \"-vv\" \"sync\" \"MBLive:/David Bitton/\" \"MBLive_S3:/\" \"--stats-one-line\" \"-P\" \"--stats\" \"2s\" \"--max-backlog\" \"100000\"]\r\n2019/04/21 02:29:15 DEBUG : Using config file from \"/home/centos/.config/rclone/rclone.conf\"\r\n2019/04/21 02:29:16 DEBUG : Dropbox root 'David Bitton': Using root namespace \"5362150896\"\r\npanic: runtime error: comparing uncomparable type request.ErrInvalidParams\r\n\r\ngoroutine 158 [running]:\r\ngithub.com/ncw/rclone/lib/errors.Walk(0x15e1160, 0xc000956a20, 0xc0006c75d0)\r\n        /home/travis/gopath/src/github.com/ncw/rclone/lib/errors/errors.go:65 +0x1a9\r\ngithub.com/ncw/rclone/lib/pacer.IsRetryAfter(0x15e1160, 0xc000956a20, 0x0, 0x0)\r\n        /home/travis/gopath/src/github.com/ncw/rclone/lib/pacer/pacer.go:256 +0x7e\r\ngithub.com/ncw/rclone/lib/pacer.(*S3).Calculate(0xc0009b2820, 0x0, 0x0, 0x15e1160, 0xc000956a20, 0xc0001b2400)\r\n        /home/travis/gopath/src/github.com/ncw/rclone/lib/pacer/pacers.go:301 +0x39\r\ngithub.com/ncw/rclone/fs.(*logCalculator).Calculate(0xc00099e200, 0x0, 0x0, 0x15e1160, 0xc000956a20, 0xc0009ae1e0)\r\n        /home/travis/gopath/src/github.com/ncw/rclone/fs/fs.go:1144 +0x6b\r\ngithub.com/ncw/rclone/lib/pacer.(*Pacer).endCall(0xc0009ae1e0, 0x0, 0x15e1160, 0xc000956a20)\r\n        /home/travis/gopath/src/github.com/ncw/rclone/lib/pacer/pacer.go:188 +0xa1\r\ngithub.com/ncw/rclone/lib/pacer.(*Pacer).call(0xc0009ae1e0, 0xc000578640, 0xa, 0x20, 0x123f460)\r\n        /home/travis/gopath/src/github.com/ncw/rclone/lib/pacer/pacer.go:198 +0xc4\r\ngithub.com/ncw/rclone/lib/pacer.(*Pacer).Call(0xc0009ae1e0, 0xc000578640, 0x40be29, 0xc0006c77e0)\r\n        /home/travis/gopath/src/github.com/ncw/rclone/lib/pacer/pacer.go:216 +0x78\r\ngithub.com/ncw/rclone/backend/s3.(*Fs).dirExists(0xc00021a160, 0x13f1c80, 0xc00021a298, 0xc0000f4700)\r\n        /home/travis/gopath/src/github.com/ncw/rclone/backend/s3/s3.go:1420 +0xaf\r\ngithub.com/ncw/rclone/backend/s3.(*Fs).Mkdir(0xc00021a160, 0x0, 0x0, 0x0, 0x0)\r\n        /home/travis/gopath/src/github.com/ncw/rclone/backend/s3/s3.go:1443 +0x3ca\r\ngithub.com/ncw/rclone/backend/s3.(*Object).Update(0xc0001cb3e0, 0x15debc0, 0xc00093e180, 0x7f284fb5fce0, 0xc00067c320, 0xc0003ba8d0, 0x1, 0x1, 0x40c6b8, 0x10)\r\n        /home/travis/gopath/src/github.com/ncw/rclone/backend/s3/s3.go:1777 +0x6b\r\ngithub.com/ncw/rclone/backend/s3.(*Fs).Put(0xc00021a160, 0x15debc0, 0xc00093e180, 0x7f284fb5fce0, 0xc00067c320, 0xc0003ba8d0, 0x1, 0x1, 0x40c6b8, 0x60, ...)\r\n        /home/travis/gopath/src/github.com/ncw/rclone/backend/s3/s3.go:1405 +0x101\r\ngithub.com/ncw/rclone/fs/operations.Copy(0x1614800, 0xc00021a160, 0x0, 0x0, 0xc000ae20ce, 0x21, 0x1613c00, 0xc00067c320, 0xc00011f8a8, 0xc00011f9b8, ...)\r\n        /home/travis/gopath/src/github.com/ncw/rclone/fs/operations/operations.go:317 +0x14c4\r\ngithub.com/ncw/rclone/fs/sync.(*syncCopyMove).pairCopyOrMove(0xc00098c8c0, 0xc0001d8600, 0x1614800, 0xc00021a160, 0xc00098c998)\r\n        /home/travis/gopath/src/github.com/ncw/rclone/fs/sync/sync.go:295 +0x251\r\ncreated by github.com/ncw/rclone/fs/sync.(*syncCopyMove).startTransfers\r\n        /home/travis/gopath/src/github.com/ncw/rclone/fs/sync/sync.go:321 +0x9f\r\nc\r\n```\r\n\r\nI'm receiving this error when I use an S3 endpoint for an accelerated transfer. The accelerated transfer endpoint includes the bucket name — `bucketname.s3-accelerate.amazonaws.com` — which changes the target use on the command line to `MBLive_S3:` from `MBLive_S3:bucketname`. When I removed the specifically defined endpoint from the config file, I no longer receive this error. According to the S3 [documentation](https://tro.pe/2veiN0B) on Accelerated transfer:\r\n> You can use the accelerate endpoint in the AWS CLI, AWS SDKs, and other tools that  transfer data to and from Amazon S3. If you are using the AWS SDKs, some of the supported languages use an accelerate endpoint client configuration flag so you don't need to explicitly set the endpoint for Transfer Acceleration to bucketname.s3-accelerate.amazonaws.com. For examples of how to use an accelerate endpoint client configuration flag, see [Amazon S3 Transfer Acceleration Examples](https://tro.pe/2veB5ip).\r\nHowever I don't know how `rclone` is coding against AWS.\r\n\r\n\r\n\r\n\r\n\r\n","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/3123/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/3123/timeline","performed_via_github_app":null,"state_reason":"completed"}