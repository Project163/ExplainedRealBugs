{"url":"https://api.github.com/repos/rclone/rclone/issues/6644","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/6644/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/6644/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/6644/events","html_url":"https://github.com/rclone/rclone/issues/6644","id":1505811682,"node_id":"I_kwDOAQ-n5M5ZwNzi","number":6644,"title":"Something broke in `rclone serve restic` with docker image tag 1.61","user":{"login":"saikpr","id":3977057,"node_id":"MDQ6VXNlcjM5NzcwNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3977057?v=4","gravatar_id":"","url":"https://api.github.com/users/saikpr","html_url":"https://github.com/saikpr","followers_url":"https://api.github.com/users/saikpr/followers","following_url":"https://api.github.com/users/saikpr/following{/other_user}","gists_url":"https://api.github.com/users/saikpr/gists{/gist_id}","starred_url":"https://api.github.com/users/saikpr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/saikpr/subscriptions","organizations_url":"https://api.github.com/users/saikpr/orgs","repos_url":"https://api.github.com/users/saikpr/repos","events_url":"https://api.github.com/users/saikpr/events{/privacy}","received_events_url":"https://api.github.com/users/saikpr/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399005,"node_id":"MDU6TGFiZWw4NjM5OTAwNQ==","url":"https://api.github.com/repos/rclone/rclone/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":1710413418,"node_id":"MDU6TGFiZWwxNzEwNDEzNDE4","url":"https://api.github.com/repos/rclone/rclone/labels/Point%20Release%20Candidate","name":"Point Release Candidate","color":"b60205","default":false,"description":""},{"id":2510153547,"node_id":"MDU6TGFiZWwyNTEwMTUzNTQ3","url":"https://api.github.com/repos/rclone/rclone/labels/Serving","name":"Serving","color":"5cf2b8","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/rclone/rclone/milestones/50","html_url":"https://github.com/rclone/rclone/milestone/50","labels_url":"https://api.github.com/repos/rclone/rclone/milestones/50/labels","id":8720373,"node_id":"MI_kwDOAQ-n5M4AhQ_1","number":50,"title":"v1.62","description":"","creator":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":6,"state":"closed","created_at":"2022-12-05T11:11:19Z","updated_at":"2023-05-09T17:05:53Z","due_on":"2023-03-14T07:00:00Z","closed_at":"2023-05-09T17:05:53Z"},"comments":3,"created_at":"2022-12-21T07:06:36Z","updated_at":"2022-12-24T06:37:24Z","closed_at":"2022-12-23T12:29:05Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### The associated forum post URL from `https://forum.rclone.org`\r\n\r\nDidn't post in forum as this was a regression.\r\n\r\n#### What is the problem you are having with rclone?\r\nTL;DR\r\nHaving issues with using `rclone serve` with `1.61`, didn't have issue with `1.60`.\r\n\r\nLong story:\r\n\r\nI use `rclone serve` to host a repo, here's my docker config - \r\n\r\n```\r\nversion: \"2.4\"\r\nservices:\r\n  restic_server:\r\n    image: rclone/rclone:latest\r\n    restart: unless-stopped\r\n    networks:\r\n      - default\r\n    container_name: restic_server\r\n    command: serve restic -vvv --fast-list --transfers 16 restic-backup-storage:restic-backup-storage --append-only --baseurl XXX --addr :8080 --htpasswd /config/rclone/htpasswd\r\n    volumes:\r\n      - ./rclone_creds:/config/rclone\r\n    ports:\r\n      - 127.0.0.1:16080:8080/tcp\r\n    environment:\r\n      - PUID=1000\r\n      - PGID=1000\r\n      - TZ=America/Los_Angeles\r\n\r\nnetworks:\r\n  default:\r\n```\r\n\r\nbut recently this container started to fail after it was updated to 1.61 tag [docker repo](https://hub.docker.com/layers/rclone/rclone/1.61/images/sha256-6dfc66aa9eb36ee5ce00a7d646726949a7182ec6b5545e915aaf91e8e1329694?context=explore), but it still works with 1.60 tag [docker repo](https://hub.docker.com/layers/rclone/rclone/1.60/images/sha256-8c7a6492379247c606401281412d865207c4584d959f7530c1cff3e98172e4f1?context=explore).\r\n\r\n\r\nHere's my docker version as well (if it helps)\r\n\r\n```\r\nsainyam@app-az:~/apps/restic-rclone-server$ docker version\r\nClient: Docker Engine - Community\r\n Version:           20.10.21\r\n API version:       1.41\r\n Go version:        go1.18.7\r\n Git commit:        baeda1f\r\n Built:             Tue Oct 25 18:01:19 2022\r\n OS/Arch:           linux/arm64\r\n Context:           default\r\n Experimental:      true\r\n\r\nServer: Docker Engine - Community\r\n Engine:\r\n  Version:          20.10.21\r\n  API version:      1.41 (minimum version 1.12)\r\n  Go version:       go1.18.7\r\n  Git commit:       3056208\r\n  Built:            Tue Oct 25 17:59:41 2022\r\n  OS/Arch:          linux/arm64\r\n  Experimental:     false\r\n containerd:\r\n  Version:          1.6.10\r\n  GitCommit:        770bd0108c32f3fb5c73ae1264f7e503fe7b2661\r\n runc:\r\n  Version:          1.1.4\r\n  GitCommit:        v1.1.4-0-g5fd4c4d\r\n docker-init:\r\n  Version:          0.19.0\r\n  GitCommit:        de40ad0\r\n  ```\r\n  \r\n\r\n\r\n\r\n#### What is your rclone version (output from `rclone version`)\r\n\r\nDoesn't work on 1.61 but works on 1.60\r\n```\r\ndocker run rclone/rclone:1.61 version\r\nrclone v1.61.0\r\n- os/version: alpine 3.17.0 (64 bit)\r\n- os/kernel: 5.10.0-19-arm64 (aarch64)\r\n- os/type: linux\r\n- os/arch: arm64\r\n- go/version: go1.19.4\r\n- go/linking: static\r\n- go/tags: none\r\n\r\n```\r\n\r\n```\r\ndocker run rclone/rclone:1.60 version\r\nrclone v1.60.1\r\n- os/version: alpine 3.16.3 (64 bit)\r\n- os/kernel: 5.10.0-19-arm64 (aarch64)\r\n- os/type: linux\r\n- os/arch: arm64\r\n- go/version: go1.19.3\r\n- go/linking: static\r\n- go/tags: none\r\n```\r\n\r\n\r\n#### Which OS you are using and how many bits (e.g. Windows 7, 64 bit)\r\nDebian 11\r\n\r\n\r\n#### Which cloud storage system are you using? (e.g. Google Drive)\r\nBackblaze b2\r\n\r\n\r\n#### The command you were trying to run (e.g. `rclone copy /tmp remote:tmp`)\r\n\r\nSee docker-compose above\r\n\r\n#### A log from the command with the `-vv` flag (e.g. output from `rclone -vv copy /tmp remote:tmp`)\r\n```\r\nAttaching to restic_server\r\nrestic_server  | 2022/12/20 22:57:41 DEBUG : rclone: Version \"v1.61.0\" starting with parameters [\"rclone\" \"serve\" \"restic\" \"-vvv\" \"--fast-list\" \"--transfers\" \"16\" \"restic-backup-storage:restic-backup-storage\" \"--append-only\" \"--baseurl\" \"my-restic-server\" \"--addr\" \":8080\" \"--htpasswd\" \"/config/rclone/htpasswd\"]\r\nrestic_server  | 2022/12/20 22:57:41 DEBUG : Creating backend with remote \"restic-backup-storage:restic-backup-storage\"\r\nrestic_server  | 2022/12/20 22:57:41 DEBUG : Using config file from \"/config/rclone/rclone.conf\"\r\nrestic_server  | 2022/12/20 22:57:41 INFO  : Using \"/config/rclone/htpasswd\" as htpasswd storage\r\nrestic_server  | 2022/12/20 22:57:41 NOTICE: B2 bucket restic-backup-storage: Serving restic REST API on [http://[::]:8080/my-restic-server/]\r\nrestic_server  | 2022/12/20 22:57:41 INFO  :\r\nrestic_server  | Transferred:   \t          0 B / 0 B, -, 0 B/s, ETA -\r\nrestic_server  | Elapsed time:         0.3s\r\nrestic_server  |\r\nrestic_server  | 2022/12/20 22:57:41 DEBUG : 5 go routines active\r\nrestic_server exited with code 0\r\nrestic_server  | 2022/12/20 22:57:41 DEBUG : rclone: Version \"v1.61.0\" starting with parameters [\"rclone\" \"serve\" \"restic\" \"-vvv\" \"--fast-list\" \"--transfers\" \"16\" \"restic-backup-storage:restic-backup-storage\" \"--append-only\" \"--baseurl\" \"my-restic-server\" \"--addr\" \":8080\" \"--htpasswd\" \"/config/rclone/htpasswd\"]\r\nrestic_server  | 2022/12/20 22:57:41 DEBUG : Creating backend with remote \"restic-backup-storage:restic-backup-storage\"\r\nrestic_server  | 2022/12/20 22:57:41 DEBUG : Using config file from \"/config/rclone/rclone.conf\"\r\nrestic_server  | 2022/12/20 22:57:42 INFO  : Using \"/config/rclone/htpasswd\" as htpasswd storage\r\nrestic_server  | 2022/12/20 22:57:42 NOTICE: B2 bucket restic-backup-storage: Serving restic REST API on [http://[::]:8080/my-restic-server/]\r\nrestic_server  | 2022/12/20 22:57:42 INFO  :\r\nrestic_server  | Transferred:   \t          0 B / 0 B, -, 0 B/s, ETA -\r\nrestic_server  | Elapsed time:         0.2s\r\nrestic_server  |\r\nrestic_server  | 2022/12/20 22:57:42 DEBUG : 5 go routines active\r\nrestic_server exited with code 0\r\n```\r\n\r\n\r\n<!--- Please keep the note below for others who read your bug report. -->\r\n\r\n#### How to use GitHub\r\n\r\n* Please use the üëç [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to show that you are affected by the same issue.\r\n* Please don't comment if you have no relevant information to add. It's just extra noise for everyone subscribed to this issue.\r\n* Subscribe to receive notifications on status change and new comments.\r\n","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/6644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/6644/timeline","performed_via_github_app":null,"state_reason":"completed"}