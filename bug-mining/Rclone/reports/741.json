{"url":"https://api.github.com/repos/rclone/rclone/issues/3835","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/3835/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/3835/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/3835/events","html_url":"https://github.com/rclone/rclone/issues/3835","id":544061949,"node_id":"MDU6SXNzdWU1NDQwNjE5NDk=","number":3835,"title":"performance is shot on minio over tls","user":{"login":"CosmicToast","id":5273047,"node_id":"MDQ6VXNlcjUyNzMwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/5273047?v=4","gravatar_id":"","url":"https://api.github.com/users/CosmicToast","html_url":"https://github.com/CosmicToast","followers_url":"https://api.github.com/users/CosmicToast/followers","following_url":"https://api.github.com/users/CosmicToast/following{/other_user}","gists_url":"https://api.github.com/users/CosmicToast/gists{/gist_id}","starred_url":"https://api.github.com/users/CosmicToast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CosmicToast/subscriptions","organizations_url":"https://api.github.com/users/CosmicToast/orgs","repos_url":"https://api.github.com/users/CosmicToast/repos","events_url":"https://api.github.com/users/CosmicToast/events{/privacy}","received_events_url":"https://api.github.com/users/CosmicToast/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":18,"created_at":"2019-12-31T01:46:09Z","updated_at":"2020-01-18T09:53:50Z","closed_at":"2020-01-18T09:51:51Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\r\n\r\nWelcome :-) We understand you are having a problem with rclone; we want to help you with that!\r\n\r\nIf you've just got a question or aren't sure if you've found a bug then please use the rclone forum:\r\n\r\n    https://forum.rclone.org/\r\n\r\ninstead of filing an issue for a quick response.\r\n\r\nIf you think you might have found a bug, please can you try to replicate it with the latest beta?\r\n\r\n    https://beta.rclone.org/\r\n    \r\nIf you can still replicate it with the latest beta, then please fill in the info below which makes our lives much easier.  A log with -vv will make our day :-)\r\n\r\nThank you\r\n\r\nThe Rclone Developers\r\n\r\n-->\r\n\r\n#### What is the problem you are having with rclone?\r\n\r\nUnder some circumstances, performance is shot (more on the circumstances below) on minio over tls.\r\nRclone will transfer ~45MB, after which it stalls (and MB/s keeps going down).\r\nI can replicate this with the latest beta but not with latest mcli.\r\n\r\n#### What is your rclone version (output from `rclone version`)\r\n\r\n```\r\nrclone v1.50.2-094-g207474ab-beta\r\n- os/arch: linux/amd64\r\n- go version: go1.13.5\r\n```\r\n\r\n#### Which OS you are using and how many bits (eg Windows 7, 64 bit)\r\n\r\nArch Linux, Amd64\r\n\r\n####  Which cloud storage system are you using? (eg Google Drive)\r\n\r\nMinio\r\n\r\n#### The command you were trying to run (eg `rclone copy /tmp remote:tmp`)\r\n\r\n`rclone copy ./largefile remote:tmp -P`\r\n\r\n#### A log from the command with the `-vv` flag (eg output from `rclone -vv copy /tmp remote:tmp`)\r\n\r\n```\r\n2019/12/30 20:41:08 DEBUG : rclone: Version \"v1.50.2-094-g207474ab-beta\" starting with parameters [\"./rclone\" \"copy\" \"../large.zip\" \"fafnir:shared/tmp\" \"-vv\"]\r\n2019/12/30 20:41:08 DEBUG : Using config file from \"/home/toast/.config/rclone/rclone.conf\"\r\n2019/12/30 20:41:08 DEBUG : large.zip: Need to transfer - File not found at Destination\r\n```\r\nit copies 45M almost instantly, after which it stalls for a long time\r\nthen progress jumps to 65M almost instantly, and the stalling continues, until it jumps by 20M more (and the cycle repeats)\r\nThe speed will occasionally jump to 600kb/s (whenever a bit of progress is made), and then drops in freefall again\r\nNo further debug lines show up\r\n\r\n#### Further information on the setup\r\n\r\nI have a gateway running Alpine Linux and Caddy.\r\nIt reverse proxies back to fafnir (the minio host) which is running in an lxd container in the internal network.\r\n\r\nThis does not trigger if any of the following are changed:\r\na) I use a different client (only checked with mcli, which is consistent at >100MB/s)\r\nb) change rclone.conf to refer to http://fafnir:9000 in place of https://minio.host","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/3835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/3835/timeline","performed_via_github_app":null,"state_reason":"completed"}