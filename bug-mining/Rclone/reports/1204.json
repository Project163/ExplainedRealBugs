{"url":"https://api.github.com/repos/rclone/rclone/issues/7355","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/7355/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/7355/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/7355/events","html_url":"https://github.com/rclone/rclone/issues/7355","id":1931311141,"node_id":"I_kwDOAQ-n5M5zHXgl","number":7355,"title":"\"Got fatal error on delete\" error message should include path","user":{"login":"folknor","id":233791,"node_id":"MDQ6VXNlcjIzMzc5MQ==","avatar_url":"https://avatars.githubusercontent.com/u/233791?v=4","gravatar_id":"","url":"https://api.github.com/users/folknor","html_url":"https://github.com/folknor","followers_url":"https://api.github.com/users/folknor/followers","following_url":"https://api.github.com/users/folknor/following{/other_user}","gists_url":"https://api.github.com/users/folknor/gists{/gist_id}","starred_url":"https://api.github.com/users/folknor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/folknor/subscriptions","organizations_url":"https://api.github.com/users/folknor/orgs","repos_url":"https://api.github.com/users/folknor/repos","events_url":"https://api.github.com/users/folknor/events{/privacy}","received_events_url":"https://api.github.com/users/folknor/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2023-10-07T11:18:42Z","updated_at":"2023-10-11T10:34:57Z","closed_at":"2023-10-11T10:34:24Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### What is your current rclone version (output from `rclone version`)?\r\n1.64\r\n\r\n\r\n#### What problem are you are trying to solve?\r\nThe console output from an `rclone` command like `rclone --update -P -L --max-delete 0 --ignore-errors sync ...` will produce something like this:\r\n```\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Got fatal error on delete: --max-delete threshold reached\r\n2023-10-07 12:39:22 ERROR : Cancelling sync due to fatal error: failed to delete 24 files\r\n2023-10-07 12:39:22 ERROR : Fatal error received - not attempting retries\r\nTransferred:      214.195 MiB / 214.195 MiB, 100%, 898.753 KiB/s, ETA 0s\r\nErrors:                25 (fatal error encountered)\r\nChecks:             57320 / 57320, 100%\r\nDeleted:                0 (files), 35 (dirs)\r\nTransferred:           19 / 19, 100%\r\nElapsed time:      9m29.9s\r\n2023/10/07 12:39:22 Failed to sync with 25 errors: last error was: failed to delete 24 files\r\n```\r\n\r\nI think there are 2-3 problems here, but in order of priority in my opinion:\r\n1. Each `ERROR : Got fatal error on delete` should name the path that it had trouble deleting.\r\n2. `2023-10-07 12:39:22 ERROR : Fatal error received - not attempting retries` leads me to believe that rclone is in fact not done, but that it stopped execution early because it encountered too many errors. I have no idea if that is the case or if it did indeed finish. Surely `--ignore-errors` should mean that it will finish.\r\n3. I don't believe `2023-10-07 12:39:22 ERROR : Cancelling sync due to fatal error: failed to delete 24 files` is a correct statement, because I passed `--ignore-errors`?\r\n\r\nObviously this ticket is about point 1, but I'm not sure if the others need tickets so I won't open any.\r\n\r\n\r\n#### How do you think rclone should be changed to solve that?\r\nhttps://github.com/rclone/rclone/blob/bcb3289dad58efad617eacd2ee1103b51a6ee3cf/fs/operations/operations.go#L769\r\nSeems to me to be the place to extend the `fs.Errorf(nil, \"Got fatal error on delete: %s\", err)` code to include some part of `dst`.\r\n\r\nThank you for reading!\r\n\r\n#### How to use GitHub\r\n\r\n* Please use the üëç [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to show that you are affected by the same issue.\r\n* Please don't comment if you have no relevant information to add. It's just extra noise for everyone subscribed to this issue.\r\n* Subscribe to receive notifications on status change and new comments.\r\n","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/7355/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/7355/timeline","performed_via_github_app":null,"state_reason":"completed"}