{"url":"https://api.github.com/repos/rclone/rclone/issues/5732","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/5732/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/5732/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/5732/events","html_url":"https://github.com/rclone/rclone/issues/5732","id":1028978289,"node_id":"I_kwDOAQ-n5M49VPZx","number":5732,"title":"corrupted on transfer: sizes differ 0 vs xxxx (s3 -> local)","user":{"login":"hakong","id":4422113,"node_id":"MDQ6VXNlcjQ0MjIxMTM=","avatar_url":"https://avatars.githubusercontent.com/u/4422113?v=4","gravatar_id":"","url":"https://api.github.com/users/hakong","html_url":"https://github.com/hakong","followers_url":"https://api.github.com/users/hakong/followers","following_url":"https://api.github.com/users/hakong/following{/other_user}","gists_url":"https://api.github.com/users/hakong/gists{/gist_id}","starred_url":"https://api.github.com/users/hakong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hakong/subscriptions","organizations_url":"https://api.github.com/users/hakong/orgs","repos_url":"https://api.github.com/users/hakong/repos","events_url":"https://api.github.com/users/hakong/events{/privacy}","received_events_url":"https://api.github.com/users/hakong/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399009,"node_id":"MDU6TGFiZWw4NjM5OTAwOQ==","url":"https://api.github.com/repos/rclone/rclone/labels/question","name":"question","color":"a07898","default":true,"description":""},{"id":314138213,"node_id":"MDU6TGFiZWwzMTQxMzgyMTM=","url":"https://api.github.com/repos/rclone/rclone/labels/Remote:%20S3","name":"Remote: S3","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":22,"created_at":"2021-10-18T11:15:52Z","updated_at":"2022-11-02T10:19:11Z","closed_at":"2021-10-30T11:01:21Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### The associated forum post URL from `https://forum.rclone.org`\r\nn/a\r\n\r\n#### What is the problem you are having with rclone?\r\nRclone fails to move most files from s3 to local disk with the error `corrupted on transfer: sizes differ 0 vs xxxx`.\r\nSome files are moved successfully.\r\n\r\n#### What is your rclone version (output from `rclone version`)\r\nThe issue was first noticed after upgrading from 1.55.1 to 1.56.2. After downgrading back to 1.55.1 the errors stopped.\r\n\r\n```\r\ngrep rclone /var/log/yum.log\r\nFeb 03 03:30:17 Updated: rclone-1.53.4-1.x86_64\r\nMar 24 03:27:45 Updated: rclone-1.54.1-1.x86_64\r\nMay 05 03:21:08 Updated: rclone-1.55.1-1.x86_64\r\nOct 06 03:13:24 Updated: rclone-1.56.2-1.x86_64\r\nOct 15 21:45:25 Installed: rclone-1.55.1-1.x86_64\r\n```\r\n\r\nThe errors started appearing on the first run after upgrading to 1.56.2 (see timestamps of yum.log vs count of \"corrupt\" in rclone logs):\r\n\r\n```\r\nroot@hostname:~# fgrep corrupt /home/username/transfer_logs-incoming/rclone/* -c\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-05T220001.log:0\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-05T230000.log:0\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-06T000001.log:0\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-06T010001.log:0\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-06T020000.log:0\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-06T030000.log:0\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-06T040001.log:628\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-06T050001.log:3280\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-06T060001.log:7546\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-06T074515.log:9988\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-06T093303.log:9988\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-06T100001.log:9988\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-06T110001.log:9988\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-06T120001.log:9988\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-06T130001.log:9988\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-06T140001.log:9988\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-06T150001.log:9988\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-06T160001.log:9988\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-06T170001.log:9988\r\n[...]\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-15T150000.log:9988\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-15T160000.log:9988\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-15T170001.log:9988\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-15T180000.log:9988\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-15T190000.log:9988\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-15T200000.log:9988\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-15T210000.log:9988\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-15T220000.log:0\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-15T230000.log:0\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-16T000000.log:0\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-16T010000.log:0\r\n/home/username/transfer_logs-incoming/rclone/rclone-2021-10-16T020001.log:0\r\n```\r\n\r\n#### Which OS you are using and how many bits (e.g. Windows 7, 64 bit)\r\nRed Hat Enterprise Linux Server release 7.9 (Maipo) 3.10.0-1160.42.2.el7.x86_64\r\n\r\n#### Which cloud storage system are you using? (e.g. Google Drive)\r\nS3-compliant storage.\r\n```\r\n[src]\r\ntype = s3\r\nprovider = other\r\nenv_auth = false\r\naccess_key_id = xxx\r\nsecret_access_key = xxx\r\nendpoint = xx.xxxx.xxx:10443\r\n```\r\n\r\n#### The command you were trying to run (e.g. `rclone copy /tmp remote:tmp`)\r\n`rclone: Version \"v1.56.2\" starting with parameters [\"rclone\" \"move\" \"--min-age=30m\" \"--checkers=50\" \"--transfers=15\" \"--log-file=/home/username/transfer_logs-incoming/rclone/rclone-2021-10-14T000000.log\" \"--log-level=DEBUG\" \"src:srcconf/\" \"/nfs/directory/incoming/download_in_progress/\"]`\r\n\r\n\r\n#### A log from the command with the `-vv` flag (e.g. output from `rclone -vv copy /tmp remote:tmp`)\r\n```\r\n2021/10/14 00:00:00 DEBUG : --min-age 30m0s to 2021-10-13 23:30:00.691982455 +0000 GMT m=-1799.954754214\r\n2021/10/14 00:00:00 DEBUG : rclone: Version \"v1.56.2\" starting with parameters [\"rclone\" \"move\" \"--min-age=30m\" \"--checkers=50\" \"--transfers=15\" \"--log-file=/home/username/transfer_logs-incoming/rclone/rclone-2021-10-14T000000.log\" \"--log-level=DEBUG\" \"src:srcconf/\" \"/nfs/directory/incoming/download_in_progress/\"]\r\n2021/10/14 00:00:00 DEBUG : Creating backend with remote \"src:srcconf/\"\r\n2021/10/14 00:00:00 DEBUG : Using config file from \"/home/username/.config/rclone/rclone.conf\"\r\n2021/10/14 00:00:00 DEBUG : fs cache: renaming cache item \"src:srcconf/\" to be canonical \"src:srcconf\"\r\n2021/10/14 00:00:00 DEBUG : Creating backend with remote \"/nfs/directory/incoming/download_in_progress/\"\r\n2021/10/14 00:01:00 INFO  :\r\nTransferred:              0 / 0 Byte, -, 0 Byte/s, ETA -\r\nElapsed time:       1m0.0s\r\n\r\n2021/10/14 00:02:00 INFO  :\r\nTransferred:              0 / 0 Byte, -, 0 Byte/s, ETA -\r\nElapsed time:       2m0.0s\r\n\r\n2021/10/14 00:03:00 INFO  :\r\nTransferred:              0 / 0 Byte, -, 0 Byte/s, ETA -\r\nElapsed time:       3m0.0s\r\n\r\n2021/10/14 00:04:00 INFO  :\r\nTransferred:              0 / 0 Byte, -, 0 Byte/s, ETA -\r\nElapsed time:       4m0.0s\r\n\r\n2021/10/14 00:05:00 INFO  :\r\nTransferred:              0 / 0 Byte, -, 0 Byte/s, ETA -\r\nElapsed time:       5m0.0s\r\n\r\n2021/10/14 00:06:00 INFO  :\r\nTransferred:              0 / 0 Byte, -, 0 Byte/s, ETA -\r\nElapsed time:       6m0.0s\r\n\r\n2021/10/14 00:07:00 INFO  :\r\nTransferred:              0 / 0 Byte, -, 0 Byte/s, ETA -\r\nElapsed time:       7m0.0s\r\n\r\n2021/10/14 00:08:00 INFO  :\r\nTransferred:              0 / 0 Byte, -, 0 Byte/s, ETA -\r\nElapsed time:       8m0.0s\r\n\r\n2021/10/14 00:09:00 INFO  :\r\nTransferred:              0 / 0 Byte, -, 0 Byte/s, ETA -\r\nElapsed time:       9m0.0s\r\n\r\n2021/10/14 00:10:00 INFO  :\r\nTransferred:              0 / 0 Byte, -, 0 Byte/s, ETA -\r\nElapsed time:      10m0.0s\r\n\r\n2021/10/14 00:11:00 INFO  :\r\nTransferred:              0 / 0 Byte, -, 0 Byte/s, ETA -\r\nElapsed time:      11m0.0s\r\n\r\n2021/10/14 00:12:00 INFO  :\r\nTransferred:              0 / 0 Byte, -, 0 Byte/s, ETA -\r\nElapsed time:      12m0.0s\r\n\r\n2021/10/14 00:13:00 INFO  :\r\nTransferred:              0 / 0 Byte, -, 0 Byte/s, ETA -\r\nElapsed time:      13m0.0s\r\n\r\n2021/10/14 00:14:00 INFO  :\r\nTransferred:              0 / 0 Byte, -, 0 Byte/s, ETA -\r\nElapsed time:      14m0.0s\r\n\r\n2021/10/14 00:15:00 INFO  :\r\nTransferred:              0 / 0 Byte, -, 0 Byte/s, ETA -\r\nElapsed time:      15m0.0s\r\n\r\n2021/10/14 00:15:01 ERROR : 2021-10-06_2140833/2140833.x.gpg.md5: corrupted on transfer: sizes differ 0 vs 33\r\n2021/10/14 00:15:01 INFO  : 2021-10-06_2140833/2140833.x.gpg.md5: Removing failed copy\r\n2021/10/14 00:15:01 ERROR : 2021-10-06_2140833/2140833.x.gpg.md5: Not deleting source as copy failed: corrupted on transfer: sizes differ 0 vs 33\r\n2021/10/14 00:15:01 ERROR : 2021-10-06_1818365/1818365.x.y.gpg.md5: corrupted on transfer: sizes differ 0 vs 33\r\n2021/10/14 00:15:01 INFO  : 2021-10-06_1818365/1818365.x.y.gpg.md5: Removing failed copy\r\n2021/10/14 00:15:01 ERROR : 2021-10-06_2140833/2140833.z.gz.q.md5: corrupted on transfer: sizes differ 0 vs 185\r\n2021/10/14 00:15:01 INFO  : 2021-10-06_2140833/2140833.z.gz.q.md5: Removing failed copy\r\n2021/10/14 00:15:01 ERROR : 2021-10-06_1818365/1818365.x.y.gpg.md5: Not deleting source as copy failed: corrupted on transfer: sizes differ 0 vs 33\r\n2021/10/14 00:15:01 ERROR : 2021-10-06_2140833/2140833.z.gz.q.md5: Not deleting source as copy failed: corrupted on transfer: sizes differ 0 vs 185\r\n2021/10/14 00:15:01 ERROR : 2021-10-06_2140833/2140833.x.md5: corrupted on transfer: sizes differ 0 vs 185\r\n2021/10/14 00:15:01 INFO  : 2021-10-06_2140833/2140833.x.md5: Removing failed copy\r\n2021/10/14 00:15:01 ERROR : 2021-10-06_2140833/2140833.z.gz.md5: corrupted on transfer: sizes differ 0 vs 181\r\n2021/10/14 00:15:01 INFO  : 2021-10-06_2140833/2140833.z.gz.md5: Removing failed copy\r\n2021/10/14 00:15:01 ERROR : 2021-10-06_2140833/2140833.x.md5: Not deleting source as copy failed: corrupted on transfer: sizes differ 0 vs 185\r\n2021/10/14 00:15:01 ERROR : 2021-10-06_2140833/2140833.s.tar.gz.md5: corrupted on transfer: sizes differ 0 vs 180\r\n2021/10/14 00:15:01 INFO  : 2021-10-06_2140833/2140833.s.tar.gz.md5: Removing failed copy\r\n2021/10/14 00:15:01 ERROR : 2021-10-06_2140833/2140833.z.gz.md5: Not deleting source as copy failed: corrupted on transfer: sizes differ 0 vs 181\r\n2021/10/14 00:15:01 ERROR : 2021-10-06_1818365/1818365.x.gpg.md5: corrupted on transfer: sizes differ 0 vs 33\r\n2021/10/14 00:15:01 INFO  : 2021-10-06_1818365/1818365.x.gpg.md5: Removing failed copy\r\n2021/10/14 00:15:01 ERROR : 2021-10-06_2140833/2140833.x.y.gpg.md5: corrupted on transfer: sizes differ 0 vs 33\r\n[...]\r\n2021/10/14 00:30:49 ERROR : 2021-10-06_5874950/5874950.z.gz.q.gpg: Not deleting source as copy failed: corrupted on transfer: sizes differ 0 vs 4037185\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5265500/5265500.s.tar.gz.gpg: corrupted on transfer: sizes differ 0 vs 7000496\r\n2021/10/14 00:30:50 INFO  : 2021-10-06_5265500/5265500.s.tar.gz.gpg: Removing failed copy\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5265500/5265500.s.tar.gz.gpg: Not deleting source as copy failed: corrupted on transfer: sizes differ 0 vs 7000496\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5875340/5875340.z.gz.q.gpg: corrupted on transfer: sizes differ 0 vs 4042184\r\n2021/10/14 00:30:50 INFO  : 2021-10-06_5875340/5875340.z.gz.q.gpg: Removing failed copy\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5875340/5875340.z.gz.q.gpg: Not deleting source as copy failed: corrupted on transfer: sizes differ 0 vs 4042184\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5570730/5570730.s.tar.gz.gpg: corrupted on transfer: sizes differ 0 vs 6982951\r\n2021/10/14 00:30:50 INFO  : 2021-10-06_5570730/5570730.s.tar.gz.gpg: Removing failed copy\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5570730/5570730.s.tar.gz.gpg: Not deleting source as copy failed: corrupted on transfer: sizes differ 0 vs 6982951\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5930824/5930824.z.gz.q.gpg: corrupted on transfer: sizes differ 0 vs 4039141\r\n2021/10/14 00:30:50 INFO  : 2021-10-06_5930824/5930824.z.gz.q.gpg: Removing failed copy\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5930824/5930824.z.gz.q.gpg: Not deleting source as copy failed: corrupted on transfer: sizes differ 0 vs 4039141\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5490927/5490927.s.tar.gz.gpg: corrupted on transfer: sizes differ 0 vs 7025257\r\n2021/10/14 00:30:50 INFO  : 2021-10-06_5490927/5490927.s.tar.gz.gpg: Removing failed copy\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5490927/5490927.s.tar.gz.gpg: Not deleting source as copy failed: corrupted on transfer: sizes differ 0 vs 7025257\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5877125/5877125.z.gz.q.gpg: corrupted on transfer: sizes differ 0 vs 4026912\r\n2021/10/14 00:30:50 INFO  : 2021-10-06_5877125/5877125.z.gz.q.gpg: Removing failed copy\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5877125/5877125.z.gz.q.gpg: Not deleting source as copy failed: corrupted on transfer: sizes differ 0 vs 4026912\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5874950/5874950.s.tar.gz.gpg: corrupted on transfer: sizes differ 0 vs 7008193\r\n2021/10/14 00:30:50 INFO  : 2021-10-06_5874950/5874950.s.tar.gz.gpg: Removing failed copy\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5874950/5874950.s.tar.gz.gpg: Not deleting source as copy failed: corrupted on transfer: sizes differ 0 vs 7008193\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5875340/5875340.s.tar.gz.gpg: corrupted on transfer: sizes differ 0 vs 7021153\r\n2021/10/14 00:30:50 INFO  : 2021-10-06_5875340/5875340.s.tar.gz.gpg: Removing failed copy\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5875340/5875340.s.tar.gz.gpg: Not deleting source as copy failed: corrupted on transfer: sizes differ 0 vs 7021153\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5930824/5930824.s.tar.gz.gpg: corrupted on transfer: sizes differ 0 vs 6966945\r\n2021/10/14 00:30:50 INFO  : 2021-10-06_5930824/5930824.s.tar.gz.gpg: Removing failed copy\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5930824/5930824.s.tar.gz.gpg: Not deleting source as copy failed: corrupted on transfer: sizes differ 0 vs 6966945\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5877125/5877125.s.tar.gz.gpg: corrupted on transfer: sizes differ 0 vs 6981619\r\n2021/10/14 00:30:50 INFO  : 2021-10-06_5877125/5877125.s.tar.gz.gpg: Removing failed copy\r\n2021/10/14 00:30:50 ERROR : 2021-10-06_5877125/5877125.s.tar.gz.gpg: Not deleting source as copy failed: corrupted on transfer: sizes differ 0 vs 6981619\r\n2021/10/14 00:30:50 ERROR : Attempt 3/3 failed with 1664 errors and: corrupted on transfer: sizes differ 0 vs 6981619\r\n2021/10/14 00:30:50 INFO  :\r\nTransferred:        4.405Gi / 4.405 GiByte, 100%, 6.999 MiByte/s, ETA 0s\r\nErrors:              1664 (retrying may help)\r\nChecks:              4992 / 4992, 100%\r\nElapsed time:     30m49.6s\r\n\r\n2021/10/14 00:30:50 DEBUG : 200 go routines active\r\n2021/10/14 00:30:50 Failed to move with 1664 errors: last error was: corrupted on transfer: sizes differ 0 vs 6981619\r\n```\r\n\r\n<!--- Please keep the note below for others who read your bug report. -->\r\n\r\n#### How to use GitHub\r\n\r\n* Please use the üëç [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to show that you are affected by the same issue.\r\n* Please don't comment if you have no relevant information to add. It's just extra noise for everyone subscribed to this issue.\r\n* Subscribe to receive notifications on status change and new comments.\r\n","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/5732/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/5732/timeline","performed_via_github_app":null,"state_reason":"completed"}