{"url":"https://api.github.com/repos/rclone/rclone/issues/5984","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/5984/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/5984/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/5984/events","html_url":"https://github.com/rclone/rclone/issues/5984","id":1129746667,"node_id":"I_kwDOAQ-n5M5DVpDr","number":5984,"title":"mount gdrive with vfs full cache - vfs cache: failed to _ensure cache internal error: downloaders is nil","user":{"login":"hekmon","id":3418467,"node_id":"MDQ6VXNlcjM0MTg0Njc=","avatar_url":"https://avatars.githubusercontent.com/u/3418467?v=4","gravatar_id":"","url":"https://api.github.com/users/hekmon","html_url":"https://github.com/hekmon","followers_url":"https://api.github.com/users/hekmon/followers","following_url":"https://api.github.com/users/hekmon/following{/other_user}","gists_url":"https://api.github.com/users/hekmon/gists{/gist_id}","starred_url":"https://api.github.com/users/hekmon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hekmon/subscriptions","organizations_url":"https://api.github.com/users/hekmon/orgs","repos_url":"https://api.github.com/users/hekmon/repos","events_url":"https://api.github.com/users/hekmon/events{/privacy}","received_events_url":"https://api.github.com/users/hekmon/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":86399005,"node_id":"MDU6TGFiZWw4NjM5OTAwNQ==","url":"https://api.github.com/repos/rclone/rclone/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":430778096,"node_id":"MDU6TGFiZWw0MzA3NzgwOTY=","url":"https://api.github.com/repos/rclone/rclone/labels/VFS%20/%20mount","name":"VFS / mount","color":"0e8a16","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2022-02-10T09:57:31Z","updated_at":"2022-03-03T17:44:03Z","closed_at":"2022-03-03T17:43:52Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### What is the problem you are having with rclone?\r\n\r\nFor several versions now, rclone mount will randomly be unable to provide read or write to file leading to OS I/O errors. I have no real clue how to replicate it other than waiting for it to happen. The only fix is to restart rclone. Frequency is random.\r\n\r\nI managed to catch one just after a copy (logs in reverse order):\r\n```\r\nFeb 07 16:37:13 hostname rclone[814]: INFO  : vfs cache: cleaned: objects 2623 (was 2623) in use 87, to upload 0, uploading 0, total size 1.114Ti (was 1.114Ti)\r\n[...]\r\nFeb 07 16:36:06 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:36:06 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:36:06 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:36:06 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:36:05 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:36:05 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:36:05 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:36:05 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:36:05 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:36:05 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:36:05 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:36:05 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:36:05 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:36:05 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:36:05 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:36:05 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:36:05 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:36:05 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:35:58 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:35:58 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:35:45 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:35:45 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:35:45 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:35:45 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:35:45 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:35:45 hostname rclone[814]: ERROR : some/path/to/a/file: vfs cache: failed to _ensure cache internal error: downloaders is nil\r\nFeb 07 16:35:45 hostname rclone[814]: INFO  : some/path/to/a/file: vfs cache: removed cache file as stale (remote is different)\r\nFeb 07 16:34:22 hostname rclone[814]: INFO  : some/path/to/a/file: vfs cache: upload succeeded try #1\r\nFeb 07 16:34:21 hostname rclone[814]: INFO  : some/path/to/a/file: Copied (new)\r\n```\r\n\r\nOther files are fine and can be read/write, but the affected file won't be usable until rclone restart.\r\n\r\n#### What is your rclone version?\r\n\r\n```\r\nrclone v1.57.0\r\n- os/version: ubuntu 20.04 (64 bit)\r\n- os/kernel: 5.4.0-99-generic (x86_64)\r\n- os/type: linux\r\n- os/arch: amd64\r\n- go/version: go1.17.2\r\n- go/linking: static\r\n- go/tags: none\r\n```\r\n\r\n#### Which OS you are using and how many bits?\r\n\r\nLinux amd64\r\n\r\n\r\n#### Which cloud storage system are you using? \r\n\r\nGoogle Drive\r\n\r\n\r\n#### The command you were trying to run?\r\n\r\n```\r\nEnvironmentFile=/etc/rclone/%i.env\r\nExecStart=/usr/bin/rclone mount $SOURCE $DESTINATION --config /etc/rclone/%i.conf\r\n```\r\n\r\nEnv file:\r\n```\r\n# Command\r\nSOURCE=\"<redacted>\"\r\nDESTINATION=\"<redacted>\"\r\nWARMUPCACHE=\"yes\"\r\n\r\n# Global\r\nRCLONE_CHECKERS=8\r\nRCLONE_CHECKSUM=true\r\nRCLONE_FAST_LIST=true\r\nRCLONE_LOG_LEVEL=INFO\r\nRCLONE_TRANSFERS=4\r\nRCLONE_USE_MMAP=true\r\n\r\n# Mount\r\nRCLONE_ALLOW_OTHER=true\r\nRCLONE_ATTR_TIMEOUT=8760h\r\nRCLONE_CACHE_DIR=\"<redacted>\"\r\nRCLONE_DEFAULT_PERMISSIONS=true\r\nRCLONE_DIR_CACHE_TIME=8760h\r\nRCLONE_DIR_PERMS=0750\r\nRCLONE_FILE_PERMS=0640\r\nRCLONE_GID=993\r\nRCLONE_POLL_INTERVAL=1h\r\nRCLONE_UID=993\r\nRCLONE_UMASK=0027\r\nRCLONE_VFS_CACHE_MAX_AGE=\"2232h\"\r\nRCLONE_VFS_CACHE_MAX_SIZE=\"3000G\"\r\nRCLONE_VFS_CACHE_MODE=\"full\"\r\nRCLONE_VFS_CACHE_POLL_INTERVAL=\"10m\"\r\nRCLONE_VFS_READ_AHEAD=\"4M\"\r\nRCLONE_VFS_WRITE_BACK=\"1m\"\r\nRCLONE_VOLNAME=\"<redacted>\"\r\nRCLONE_WRITE_BACK_CACHE=true\r\n\r\n# RC\r\nRCLONE_RC=true\r\nRCLONE_RC_ADDR=\"127.0.0.1:5573\"\r\nRCLONE_RC_USER=\"rclonerc\"\r\nRCLONE_RC_PASS=\"<redacted>\"\r\nRCLONE_RC_SERVER_WRITE_TIMEOUT=24h\r\n```\r\n\r\n#### A log from the command with the `-vv` flag \r\n\r\nThis issue is already spamming hard logs on my disk by the time I see it (hundred of thousands of lines) just by being in INFO level (given this is an ERROR level spamming). As I can not force reproduce the bug and have to wait for it to happen, I would like to avoid leaving it en -vv for several days, not sure my disk can handle it (or journalctl will prune it). I *will* if you can not find anything but at start I would like to avoid it if possible.\r\n\r\n\r\n<!--- Please keep the note below for others who read your bug report. -->\r\n\r\n#### How to use GitHub\r\n\r\n* Please use the üëç [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to show that you are affected by the same issue.\r\n* Please don't comment if you have no relevant information to add. It's just extra noise for everyone subscribed to this issue.\r\n* Subscribe to receive notifications on status change and new comments.\r\n","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/5984/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/5984/timeline","performed_via_github_app":null,"state_reason":"completed"}