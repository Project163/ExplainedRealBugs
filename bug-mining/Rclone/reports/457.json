{"url":"https://api.github.com/repos/rclone/rclone/issues/2130","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/2130/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/2130/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/2130/events","html_url":"https://github.com/rclone/rclone/issues/2130","id":304135508,"node_id":"MDU6SXNzdWUzMDQxMzU1MDg=","number":2130,"title":"Can not work on files opened with gedit from a mount","user":{"login":"sheepdestroyer","id":1377479,"node_id":"MDQ6VXNlcjEzNzc0Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/1377479?v=4","gravatar_id":"","url":"https://api.github.com/users/sheepdestroyer","html_url":"https://github.com/sheepdestroyer","followers_url":"https://api.github.com/users/sheepdestroyer/followers","following_url":"https://api.github.com/users/sheepdestroyer/following{/other_user}","gists_url":"https://api.github.com/users/sheepdestroyer/gists{/gist_id}","starred_url":"https://api.github.com/users/sheepdestroyer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sheepdestroyer/subscriptions","organizations_url":"https://api.github.com/users/sheepdestroyer/orgs","repos_url":"https://api.github.com/users/sheepdestroyer/repos","events_url":"https://api.github.com/users/sheepdestroyer/events{/privacy}","received_events_url":"https://api.github.com/users/sheepdestroyer/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2018-03-11T06:52:15Z","updated_at":"2019-02-06T11:31:37Z","closed_at":"2018-05-24T18:45:16Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"\r\n#### What is the problem you are having with rclone?\r\nCan not work on files opened from a mount\r\nEx : in a mounted gdrive remote, I create a new empty file \"test\" then try to edit it with gedit.\r\nWhen trying to save a text file opened with gedit or geany, I get the following error: \r\n````\r\nCould not save the file “/home/sheepdestroyer/Vra…eractiv/Gdrive-Mount/test”.\r\nYou do not have the permissions necessary to save the file. Please check that you typed the location correctly and try again.\r\n````\r\nBut I can edit the same file from the command line with vi or echo  : ````echo 123123 > testfile````\r\n\r\n#### What is your rclone version\r\nLast commit from 2018/03/10, installed like this : \r\n````\r\ngo get -u -v github.com/ncw/rclone/...\r\n$ rclone -V\r\n$ rclone v1.39-DEV\r\n- os/arch: linux/amd64\r\n- go version: go1.9.4\r\n````\r\n#### Which OS you are using and how many bits\r\nfedora 27 64bit \r\n\r\n####  Which cloud storage system are you using? \r\nGoogle Drive\r\n\r\n#### The command you were trying to run \r\nI get the same error with or without using a cache remote : \r\n````\r\nrclone mount -vv --vfs-cache-mode=full Interactiv-Gdrive: /home/sheepdestroyer/Vrac/interactiv/Gdrive-Mount\r\n````\r\n\r\n#### A log from the command with the `-vv` flag\r\nThis is what I get when trying to save a file opened with gedit : \r\n````\r\n2018/03/11 15:41:08 DEBUG : toto: Attr: \r\n2018/03/11 15:41:08 DEBUG : toto: >Attr: a=valid=0s ino=0 size=0 mode=-rw-rw-r--, err=<nil>\r\n2018/03/11 15:41:11 DEBUG : toto: Attr: \r\n2018/03/11 15:41:11 DEBUG : toto: >Attr: a=valid=0s ino=0 size=0 mode=-rw-rw-r--, err=<nil>\r\n2018/03/11 15:41:11 DEBUG : toto: Attr: \r\n2018/03/11 15:41:11 DEBUG : toto: >Attr: a=valid=0s ino=0 size=0 mode=-rw-rw-r--, err=<nil>\r\n2018/03/11 15:41:11 DEBUG : toto: Open: flags=OpenWriteOnly+0x20000\r\n2018/03/11 15:41:11 DEBUG : toto: Open: flags=O_WRONLY|O_CREATE|0x20000\r\n2018/03/11 15:41:11 DEBUG : toto: >Open: fd=toto (rw), err=<nil>\r\n2018/03/11 15:41:11 DEBUG : toto: >Open: fh=&{toto (rw)}, err=<nil>\r\n2018/03/11 15:41:11 DEBUG : toto: Attr: \r\n2018/03/11 15:41:11 DEBUG : toto: >Attr: a=valid=0s ino=0 size=0 mode=-rw-rw-r--, err=<nil>\r\n2018/03/11 15:41:11 DEBUG : /: Lookup: name=\".goutputstream-36OSFZ\"\r\n2018/03/11 15:41:11 DEBUG : /: >Lookup: node=<nil>, err=no such file or directory\r\n2018/03/11 15:41:11 DEBUG : /: Create: name=\".goutputstream-36OSFZ\"\r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: Open: flags=O_WRONLY|O_CREATE|O_EXCL\r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ(0xc4202ca7e0): Opening cached copy with flags=O_WRONLY|O_CREATE|O_EXCL\r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: >Open: fd=.goutputstream-36OSFZ (rw), err=<nil>\r\n2018/03/11 15:41:11 DEBUG : /: >Create: node=.goutputstream-36OSFZ, handle=&{.goutputstream-36OSFZ (rw)}, err=<nil>\r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: Attr: \r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: >Attr: a=valid=0s ino=0 size=0 mode=-rw-rw-r--, err=<nil>\r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: Attr: \r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: >Attr: a=valid=0s ino=0 size=0 mode=-rw-rw-r--, err=<nil>\r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: Attr: \r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: >Attr: a=valid=0s ino=0 size=0 mode=-rw-rw-r--, err=<nil>\r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: Attr: \r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: >Attr: a=valid=0s ino=0 size=0 mode=-rw-rw-r--, err=<nil>\r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: Attr: \r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: >Attr: a=valid=0s ino=0 size=0 mode=-rw-rw-r--, err=<nil>\r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: Setattr: a=Setattr [ID=0x97c Node=0x5 Uid=1000 Gid=1000 Pid=24710] uid=1000 gid=1000 handle=INVALID-0x0\r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: >Setattr: err=<nil>\r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: Attr: \r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: >Attr: a=valid=0s ino=0 size=0 mode=-rw-rw-r--, err=<nil>\r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: Setattr: a=Setattr [ID=0x97d Node=0x5 Uid=1000 Gid=1000 Pid=24710] mode=-rw-rw-r-- handle=INVALID-0x0\r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: >Setattr: err=<nil>\r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: Attr: \r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: >Attr: a=valid=0s ino=0 size=0 mode=-rw-rw-r--, err=<nil>\r\n2018/03/11 15:41:11 DEBUG : &{toto (rw)}: Flush: \r\n2018/03/11 15:41:11 DEBUG : &{toto (rw)}: >Flush: err=<nil>\r\n2018/03/11 15:41:11 DEBUG : &{toto (rw)}: Release: \r\n2018/03/11 15:41:11 DEBUG : toto(0xc420010240): RWFileHandle.Release closing\r\n2018/03/11 15:41:11 DEBUG : toto(0xc420010240): close: \r\n2018/03/11 15:41:11 DEBUG : toto(0xc420010240): not modified so not transferring\r\n2018/03/11 15:41:11 DEBUG : toto: Size and modification time the same (differ by 0s, within tolerance 1ms)\r\n2018/03/11 15:41:11 DEBUG : toto: Unchanged skipping\r\n2018/03/11 15:41:11 DEBUG : toto(0xc420010240): Opened existing cached copy with flags=O_WRONLY|O_CREATE|0x20000\r\n2018/03/11 15:41:11 DEBUG : toto(0xc420010240): >close: err=<nil>\r\n2018/03/11 15:41:11 DEBUG : &{toto (rw)}: >Release: err=<nil>\r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: Attr: \r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: >Attr: a=valid=0s ino=0 size=0 mode=-rw-rw-r--, err=<nil>\r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: Attr: \r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: >Attr: a=valid=0s ino=0 size=0 mode=-rw-rw-r--, err=<nil>\r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: Attr: \r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: >Attr: a=valid=0s ino=0 size=0 mode=-rw-rw-r--, err=<nil>\r\n2018/03/11 15:41:11 DEBUG : &{.goutputstream-36OSFZ (rw)}: Write: len=5, offset=0\r\n2018/03/11 15:41:11 DEBUG : &{.goutputstream-36OSFZ (rw)}: >Write: written=5, err=<nil>\r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: Fsync: \r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: >Fsync: err=<nil>\r\n2018/03/11 15:41:11 DEBUG : /: Rename: oldName=\".goutputstream-36OSFZ\", newName=\"toto\", newDir=/\r\n2018/03/11 15:41:11 ERROR : .goutputstream-36OSFZ: Dir.Rename cant rename open file\r\n2018/03/11 15:41:11 DEBUG : /: >Rename: err=operation not permitted\r\n2018/03/11 15:41:11 DEBUG : &{.goutputstream-36OSFZ (rw)}: Flush: \r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ(0xc4202ca7e0): close: \r\n2018/03/11 15:41:11 DEBUG : .goutputstream-36OSFZ: Couldn't find file - need to transfer\r\n2018/03/11 15:41:12 INFO  : .goutputstream-36OSFZ: Copied (new)\r\n2018/03/11 15:41:12 DEBUG : .goutputstream-36OSFZ: transferred to remote\r\n2018/03/11 15:41:12 DEBUG : .goutputstream-36OSFZ(0xc4202ca7e0): >close: err=<nil>\r\n2018/03/11 15:41:12 DEBUG : &{.goutputstream-36OSFZ (rw)}: >Flush: err=<nil>\r\n2018/03/11 15:41:12 DEBUG : &{.goutputstream-36OSFZ (rw)}: Release: \r\n2018/03/11 15:41:12 DEBUG : .goutputstream-36OSFZ(0xc4202ca7e0): RWFileHandle.Release nothing to do\r\n2018/03/11 15:41:12 DEBUG : &{.goutputstream-36OSFZ (rw)}: >Release: err=<nil>\r\n2018/03/11 15:41:12 DEBUG : /: Remove: name=\".goutputstream-36OSFZ\"\r\n2018/03/11 15:41:13 DEBUG : .goutputstream-36OSFZ: Removed from cache\r\n2018/03/11 15:41:13 DEBUG : /: >Remove: err=<nil>\r\n2018/03/11 15:41:13 DEBUG : toto: Attr: \r\n2018/03/11 15:41:13 DEBUG : toto: >Attr: a=valid=0s ino=0 size=0 mode=-rw-rw-r--, err=<nil>\r\n````\r\nAgain, through command line like vi or echo, I can edit the file.\r\n","closed_by":{"login":"breunigs","id":307954,"node_id":"MDQ6VXNlcjMwNzk1NA==","avatar_url":"https://avatars.githubusercontent.com/u/307954?v=4","gravatar_id":"","url":"https://api.github.com/users/breunigs","html_url":"https://github.com/breunigs","followers_url":"https://api.github.com/users/breunigs/followers","following_url":"https://api.github.com/users/breunigs/following{/other_user}","gists_url":"https://api.github.com/users/breunigs/gists{/gist_id}","starred_url":"https://api.github.com/users/breunigs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/breunigs/subscriptions","organizations_url":"https://api.github.com/users/breunigs/orgs","repos_url":"https://api.github.com/users/breunigs/repos","events_url":"https://api.github.com/users/breunigs/events{/privacy}","received_events_url":"https://api.github.com/users/breunigs/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/2130/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/2130/timeline","performed_via_github_app":null,"state_reason":"completed"}