{"url":"https://api.github.com/repos/rclone/rclone/issues/3861","repository_url":"https://api.github.com/repos/rclone/rclone","labels_url":"https://api.github.com/repos/rclone/rclone/issues/3861/labels{/name}","comments_url":"https://api.github.com/repos/rclone/rclone/issues/3861/comments","events_url":"https://api.github.com/repos/rclone/rclone/issues/3861/events","html_url":"https://github.com/rclone/rclone/issues/3861","id":546886477,"node_id":"MDU6SXNzdWU1NDY4ODY0Nzc=","number":3861,"title":"Wrong accounting of retried transfers","user":{"login":"zimnx","id":3951334,"node_id":"MDQ6VXNlcjM5NTEzMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/3951334?v=4","gravatar_id":"","url":"https://api.github.com/users/zimnx","html_url":"https://github.com/zimnx","followers_url":"https://api.github.com/users/zimnx/followers","following_url":"https://api.github.com/users/zimnx/following{/other_user}","gists_url":"https://api.github.com/users/zimnx/gists{/gist_id}","starred_url":"https://api.github.com/users/zimnx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zimnx/subscriptions","organizations_url":"https://api.github.com/users/zimnx/orgs","repos_url":"https://api.github.com/users/zimnx/repos","events_url":"https://api.github.com/users/zimnx/events{/privacy}","received_events_url":"https://api.github.com/users/zimnx/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-01-08T14:14:52Z","updated_at":"2020-01-09T10:32:50Z","closed_at":"2020-01-09T10:32:50Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### What is your rclone version (output from `rclone version`)\r\nv1.50.2 \r\n#### Which OS you are using and how many bits (eg Windows 7, 64 bit)\r\nLinux x64\r\n####  Which cloud storage system are you using? (eg Google Drive)\r\nAWS S3\r\n#### What is the problem you are having with rclone?\r\nAccounting of retried transfers is wrong. I tried to copy file from local storage to S3, when transfer is interrupted it is being retried, but statistics from previous iteration aren't cleared.\r\n```\r\n// [...]\r\n{\"L\":\"DEBUG\",\"T\":\"2020-01-08T10:47:49.438Z\",\"N\":\"rclone\",\"M\":\"rc: \\\"job/info\\\": reply map[transferring:[map[bytes:6127616 eta:4 name:mc-2-big-Data.db percentage:52 size:11770210 speed:1.2167212394978774e+06 speedAvg:1.2180803066497073e+06]]\r\n{\"L\":\"DEBUG\",\"T\":\"2020-01-08T10:47:49.479Z\",\"N\":\"rclone\",\"M\":\"mc-2-big-Data.db: Received error: Put http://192.168.100.99:9000/mc-2-big-Data.db: read tcp 192.168.100.21:54838->192.168.100.99:9000: read: connection reset by peer - low level retry 1/5\"}\r\n{\"L\":\"DEBUG\",\"T\":\"2020-01-08T10:47:49.489Z\",\"N\":\"rclone\",\"M\":\"rc: \\\"job/info\\\": reply map[transferring:[map[bytes:6160384 eta:4 name:mc-2-big-Data.db percentage:52 size:11770210 speed:1.2111075296935646e+06 speedAvg:1.2180803066497073e+06]\r\n// [...]\r\n{\"L\":\"DEBUG\",\"T\":\"2020-01-08T10:48:14.038Z\",\"N\":\"rclone\",\"M\":\"rc: \\\"job/info\\\": reply map[job:map[transferring:[map[bytes:17930594 eta:<nil> name:mc-2-big-Data.db percentage:152 size:11770210 speed:605032.6104130592 speedAvg:642147.118981138]]\r\n// [...]\r\n\"L\":\"DEBUG\",\"T\":\"2020-01-08T10:48:20.140Z\",\"N\":\"rclone\",\"M\":\"rc: \\\"job/info\\\": reply map[transferred:[{Name:mc-2-big-Data.db Size:11770210 Bytes:17930594 Checked:false StartedAt:2020-01-08 10:47:44.398259826 +0000 UTC m=+443.976519334 CompletedAt:2020-01-08 10:48:14.058848275 +0000 UTC m=+473.637107757 Error:<nil>} [...]]\r\n```\r\nNote that file size is 11770210B, 17930594B was transferred, so there are additional 6160384B, which is exactly how many bytes were transferred before failure happened.","closed_by":{"login":"ncw","id":536803,"node_id":"MDQ6VXNlcjUzNjgwMw==","avatar_url":"https://avatars.githubusercontent.com/u/536803?v=4","gravatar_id":"","url":"https://api.github.com/users/ncw","html_url":"https://github.com/ncw","followers_url":"https://api.github.com/users/ncw/followers","following_url":"https://api.github.com/users/ncw/following{/other_user}","gists_url":"https://api.github.com/users/ncw/gists{/gist_id}","starred_url":"https://api.github.com/users/ncw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncw/subscriptions","organizations_url":"https://api.github.com/users/ncw/orgs","repos_url":"https://api.github.com/users/ncw/repos","events_url":"https://api.github.com/users/ncw/events{/privacy}","received_events_url":"https://api.github.com/users/ncw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rclone/rclone/issues/3861/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rclone/rclone/issues/3861/timeline","performed_via_github_app":null,"state_reason":"completed"}