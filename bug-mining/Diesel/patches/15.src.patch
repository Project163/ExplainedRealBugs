diff --git a/diesel/src/doctest_setup.rs b/diesel/src/doctest_setup.rs
index 0fe1bca5d..5e434e51e 100644
--- a/diesel/src/doctest_setup.rs
+++ b/diesel/src/doctest_setup.rs
@@ -10,6 +10,7 @@ fn connection_no_data() -> Connection {
         .expect("DATABASE_URL must be set in order to run tests");
     let connection = Connection::establish(&connection_url).unwrap();
     connection.begin_test_transaction().unwrap();
+    connection.execute("DROP TABLE IF EXISTS users").unwrap();
 
     connection
 }
diff --git a/diesel_tests/build.rs b/diesel_tests/build.rs
index 10277ddba..465362e06 100644
--- a/diesel_tests/build.rs
+++ b/diesel_tests/build.rs
@@ -32,10 +32,8 @@ use dotenv::dotenv;
 
 fn main() {
     dotenv().ok();
-    let database_url = ::std::env::var("DATABASE_URL_FOR_SCHEMA")
-        .expect("DATABASE_URL_FOR_SCHEMA must be set and different \
-                from DATABASE_URL for integration tests, so we can \
-                test our schema inference code.");
+    let database_url = ::std::env::var("DATABASE_URL")
+        .expect("DATABASE_URL must be set to run tests");
     let connection = Connection::establish(&database_url).unwrap();
     setup_tables_for_schema(&connection);
     inner::main();
diff --git a/diesel_tests/tests/associations.rs b/diesel_tests/tests/associations.rs
index d7e236304..572eec2ee 100644
--- a/diesel_tests/tests/associations.rs
+++ b/diesel_tests/tests/associations.rs
@@ -4,7 +4,6 @@ use diesel::*;
 #[test]
 fn one_to_many_returns_query_source_for_association() {
     let connection = connection_with_sean_and_tess_in_users_table();
-    setup_posts_table(&connection);
 
     let sean = find_user_by_name("Sean", &connection);
     let tess = find_user_by_name("Tess", &connection);
diff --git a/diesel_tests/tests/bench.rs b/diesel_tests/tests/bench.rs
index 33f2aec03..f513ff83b 100644
--- a/diesel_tests/tests/bench.rs
+++ b/diesel_tests/tests/bench.rs
@@ -13,7 +13,6 @@ use diesel::*;
 #[bench]
 fn bench_selecting_0_rows_with_trivial_query(b: &mut Bencher) {
     let conn = connection();
-    setup_users_table(&conn);
 
     b.iter(|| {
         users::table.load(&conn).unwrap().collect::<Vec<User>>();
@@ -23,7 +22,6 @@ fn bench_selecting_0_rows_with_trivial_query(b: &mut Bencher) {
 #[bench]
 fn bench_selecting_10k_rows_with_trivial_query(b: &mut Bencher) {
     let conn = connection();
-    setup_users_table(&conn);
     let data: Vec<_> = (0..10_000).map(|i| {
         NewUser::new(&format!("User {}", i), None)
     }).collect();
@@ -37,8 +35,6 @@ fn bench_selecting_10k_rows_with_trivial_query(b: &mut Bencher) {
 #[bench]
 fn bench_selecting_0_rows_with_medium_complex_query(b: &mut Bencher) {
     let conn = connection();
-    setup_users_table(&conn);
-    setup_posts_table(&conn);
 
     b.iter(|| {
         use schema::users::dsl::*;
@@ -52,8 +48,6 @@ fn bench_selecting_0_rows_with_medium_complex_query(b: &mut Bencher) {
 #[bench]
 fn bench_selecting_10k_rows_with_medium_complex_query(b: &mut Bencher) {
     let conn = connection();
-    setup_users_table(&conn);
-    setup_posts_table(&conn);
 
     let data: Vec<_> = (0..10_000).map(|i| {
         let hair_color = if i % 2 == 0 { "black" } else { "brown" };
diff --git a/diesel_tests/tests/expressions/mod.rs b/diesel_tests/tests/expressions/mod.rs
index 04c61b3ca..11e8dfb4e 100644
--- a/diesel_tests/tests/expressions/mod.rs
+++ b/diesel_tests/tests/expressions/mod.rs
@@ -1,7 +1,7 @@
 mod date_and_time;
 mod ops;
 
-use schema::{connection, NewUser, setup_users_table};
+use schema::{connection, NewUser};
 use schema::users::dsl::*;
 use diesel::*;
 use diesel::query_builder::*;
@@ -10,7 +10,6 @@ use diesel::expression::dsl::*;
 #[test]
 fn test_count_counts_the_rows() {
     let connection = connection();
-    setup_users_table(&connection);
     let source = users.select(count(users.star()));
 
     assert_eq!(Ok(0), source.first(&connection));
@@ -21,7 +20,6 @@ fn test_count_counts_the_rows() {
 #[test]
 fn test_count_star() {
     let connection = connection();
-    setup_users_table(&connection);
     let source = users.count();
 
     assert_eq!(Ok(0), source.first(&connection));
@@ -75,7 +73,6 @@ fn test_count_max() {
 #[test]
 fn max_returns_same_type_as_expression_being_maximized() {
     let connection = connection();
-    setup_users_table(&connection);
     let source = users.select(max(name));
 
     let data: &[_] = &[
@@ -158,7 +155,6 @@ fn function_with_multiple_arguments() {
     use schema::users::dsl::*;
 
     let connection = connection();
-    setup_users_table(&connection);
     insert(&vec![NewUser::new("Sean", Some("black")), NewUser::new("Tess", None)])
         .into(users)
         .execute(&connection)
diff --git a/diesel_tests/tests/expressions/ops.rs b/diesel_tests/tests/expressions/ops.rs
index 7f8f4aff8..785cc71c3 100644
--- a/diesel_tests/tests/expressions/ops.rs
+++ b/diesel_tests/tests/expressions/ops.rs
@@ -95,8 +95,8 @@ fn mix_and_match_all_numeric_ops() {
     use schema::users::dsl::*;
 
     let connection = connection_with_sean_and_tess_in_users_table();
-    let data = vec![NewUser::new("Jim", None), NewUser::new("Bob", None)];
-    insert(&data).into(users).execute(&connection).unwrap();
+    connection.execute("INSERT INTO users (id, name) VALUES
+        (3, 'Jim'), (4, 'Bob')").unwrap();
 
     let expected_data = vec![4, 6, 7, 9];
     let data: Vec<_> = users.select(id * 3 / 2 + 4 - 1).load(&connection)
diff --git a/diesel_tests/tests/filter.rs b/diesel_tests/tests/filter.rs
index 536e6c37c..1f824fb00 100644
--- a/diesel_tests/tests/filter.rs
+++ b/diesel_tests/tests/filter.rs
@@ -35,17 +35,17 @@ fn filter_by_equality_on_nullable_columns() {
     use schema::users::dsl::*;
 
     let connection = connection();
-    setup_users_table(&connection);
     let data = vec![
         NewUser::new("Sean", Some("black")),
         NewUser::new("Tess", Some("brown")),
         NewUser::new("Jim", Some("black")),
     ];
-    insert(&data).into(users).execute(&connection).unwrap();
+    let data: Vec<User> = insert(&data).into(users)
+        .get_results(&connection).unwrap().collect();;
+    let sean = data[0].clone();
+    let tess = data[1].clone();
+    let jim = data[2].clone();
 
-    let sean = User::with_hair_color(1, "Sean", "black");
-    let tess = User::with_hair_color(2, "Tess", "brown");
-    let jim = User::with_hair_color(3, "Jim", "black");
     let source = users.filter(hair_color.eq("black"));
     assert_eq!(vec![sean, jim], source.load(&connection).unwrap().collect::<Vec<_>>());
     let source = users.filter(hair_color.eq("brown"));
@@ -57,14 +57,14 @@ fn filter_by_is_not_null_on_nullable_columns() {
     use schema::users::dsl::*;
 
     let connection = connection();
-    setup_users_table(&connection);
     let data = vec![
         NewUser::new("Derek", Some("red")),
         NewUser::new("Gordon", None),
     ];
-    insert(&data).into(users).execute(&connection).unwrap();
+    let data: Vec<User> = insert(&data).into(users)
+        .get_results(&connection).unwrap().collect();
+    let derek = data[0].clone();
 
-    let derek = User::with_hair_color(1, "Derek", "red");
     let source = users.filter(hair_color.is_not_null());
     assert_eq!(vec![derek], source.load(&connection).unwrap().collect::<Vec<_>>());
 }
@@ -74,14 +74,14 @@ fn filter_by_is_null_on_nullable_columns() {
     use schema::users::dsl::*;
 
     let connection = connection();
-    setup_users_table(&connection);
     let data = vec![
         NewUser::new("Derek", Some("red")),
         NewUser::new("Gordon", None),
     ];
-    insert(&data).into(users).execute(&connection).unwrap();
+    let data: Vec<User> = insert(&data).into(users)
+        .get_results(&connection).unwrap().collect();
+    let gordon = data[1].clone();
 
-    let gordon = User::new(2, "Gordon");
     let source = users.filter(hair_color.is_null());
     assert_eq!(vec![gordon], source.load(&connection).unwrap().collect::<Vec<_>>());
 }
@@ -91,8 +91,8 @@ fn filter_after_joining() {
     use schema::users::name;
 
     let connection = connection_with_sean_and_tess_in_users_table();
-    setup_posts_table(&connection);
-    connection.execute("INSERT INTO POSTS (title, user_id) VALUES ('Hello', 1), ('World', 2)")
+    connection.execute("INSERT INTO POSTS (id, title, user_id) VALUES
+                       (1, 'Hello', 1), (2, 'World', 2)")
         .unwrap();
 
     let sean = User::new(1, "Sean");
@@ -127,7 +127,6 @@ fn filter_then_select() {
     use schema::users::dsl::*;
 
     let connection = connection();
-    setup_users_table(&connection);
     let data = vec![NewUser::new("Sean", None), NewUser::new("Tess", None)];
     insert(&data).into(users).execute(&connection).unwrap();
 
@@ -144,7 +143,6 @@ fn filter_on_multiple_columns() {
     use schema::users::dsl::*;
 
     let connection = connection();
-    setup_users_table(&connection);
     let data: &[_] = &[
         NewUser::new("Sean", Some("black")),
         NewUser::new("Sean", Some("brown")),
@@ -152,13 +150,12 @@ fn filter_on_multiple_columns() {
         NewUser::new("Tess", Some("black")),
         NewUser::new("Tess", Some("brown")),
     ];
-    assert_eq!(5, insert(data).into(users).execute(&connection).unwrap());
-
-    let black_haired_sean = User::with_hair_color(1, "Sean", "black");
-    let brown_haired_sean = User::with_hair_color(2, "Sean", "brown");
-    let _bald_sean = User::new(3, "Sean");
-    let black_haired_tess = User::with_hair_color(4, "Tess", "black");
-    let brown_haired_tess = User::with_hair_color(5, "Tess", "brown");
+    let data: Vec<User> = insert(data).into(users)
+        .get_results(&connection).unwrap().collect();
+    let black_haired_sean = data[0].clone();
+    let brown_haired_sean = data[1].clone();
+    let black_haired_tess = data[3].clone();
+    let brown_haired_tess = data[4].clone();
 
     let source = users.filter(name.eq("Sean").and(hair_color.eq("black")));
     assert_eq!(vec![black_haired_sean], source.load(&connection).unwrap()
@@ -182,7 +179,6 @@ fn filter_called_twice_means_same_thing_as_and() {
     use schema::users::dsl::*;
 
     let connection = connection();
-    setup_users_table(&connection);
     let data: &[_] = &[
         NewUser::new("Sean", Some("black")),
         NewUser::new("Sean", Some("brown")),
@@ -190,13 +186,12 @@ fn filter_called_twice_means_same_thing_as_and() {
         NewUser::new("Tess", Some("black")),
         NewUser::new("Tess", Some("brown")),
     ];
-    assert_eq!(5, insert(data).into(users).execute(&connection).unwrap());
-
-    let black_haired_sean = User::with_hair_color(1, "Sean", "black");
-    let brown_haired_sean = User::with_hair_color(2, "Sean", "brown");
-    let _bald_sean = User::new(3, "Sean");
-    let black_haired_tess = User::with_hair_color(4, "Tess", "black");
-    let brown_haired_tess = User::with_hair_color(5, "Tess", "brown");
+    let data: Vec<User> = insert(data).into(users)
+        .get_results(&connection).unwrap().collect();
+    let black_haired_sean = data[0].clone();
+    let brown_haired_sean = data[1].clone();
+    let black_haired_tess = data[3].clone();
+    let brown_haired_tess = data[4].clone();
 
     let source = users.filter(name.eq("Sean")).filter(hair_color.eq("black"));
     assert_eq!(vec![black_haired_sean], source.load(&connection).unwrap()
diff --git a/diesel_tests/tests/filter_operators.rs b/diesel_tests/tests/filter_operators.rs
index fbdcc3d1b..1bab4b1b9 100644
--- a/diesel_tests/tests/filter_operators.rs
+++ b/diesel_tests/tests/filter_operators.rs
@@ -86,17 +86,17 @@ fn filter_by_like() {
     use schema::users::dsl::*;
 
     let connection = connection();
-    setup_users_table(&connection);
     let data = vec![
         NewUser::new("Sean Griffin", None),
         NewUser::new("Tess Griffin", None),
         NewUser::new("Jim", None),
     ];
-    insert(&data).into(users).execute(&connection).unwrap();
+    let data: Vec<User> = insert(&data).into(users)
+        .get_results(&connection).unwrap().collect();;
+    let sean = data[0].clone();
+    let tess = data[1].clone();
+    let jim = data[2].clone();
 
-    let sean = User::new(1, "Sean Griffin");
-    let tess = User::new(2, "Tess Griffin");
-    let jim = User::new(3, "Jim");
     assert_eq!(vec![sean, tess],
         users.filter(name.like("%Griffin")).load(&connection).as_vec());
     assert_eq!(vec![jim],
@@ -134,13 +134,7 @@ impl<ST, U> TestResultHelpers<U> for QueryResult<Cursor<ST, U>> where
 }
 
 fn connection_with_3_users() -> Connection {
-    let connection = connection();
-    setup_users_table(&connection);
-    let data = vec![
-        NewUser::new("Sean", None),
-        NewUser::new("Tess", None),
-        NewUser::new("Jim", None),
-    ];
-    insert(&data).into(users::table).execute(&connection).unwrap();
+    let connection = connection_with_sean_and_tess_in_users_table();
+    connection.execute("INSERT INTO users (id, name) VALUES (3, 'Jim')").unwrap();
     connection
 }
diff --git a/diesel_tests/tests/find.rs b/diesel_tests/tests/find.rs
index 24b672e08..db361dd97 100644
--- a/diesel_tests/tests/find.rs
+++ b/diesel_tests/tests/find.rs
@@ -6,9 +6,8 @@ fn find() {
     use schema::users::table as users;
 
     let connection = connection();
-    setup_users_table(&connection);
 
-    connection.execute("INSERT INTO users (name) VALUES ('Sean'), ('Tess')")
+    connection.execute("INSERT INTO users (id, name) VALUES (1, 'Sean'), (2, 'Tess')")
         .unwrap();
 
     assert_eq!(Ok(User::new(1, "Sean")), connection.find(users, 1));
diff --git a/diesel_tests/tests/insert.rs b/diesel_tests/tests/insert.rs
index df8078b32..01281e23c 100644
--- a/diesel_tests/tests/insert.rs
+++ b/diesel_tests/tests/insert.rs
@@ -5,17 +5,16 @@ use diesel::*;
 fn insert_records() {
     use schema::users::table as users;
     let connection = connection();
-    setup_users_table(&connection);
 
     let new_users: &[_] = &[
         NewUser::new("Sean", Some("Black")),
         NewUser::new("Tess", None),
     ];
-    let inserted_users: Vec<_> = insert(new_users).into(users).get_results(&connection).unwrap().collect();
+    let inserted_users: Vec<User> = insert(new_users).into(users).get_results(&connection).unwrap().collect();
 
     let expected_users = vec![
-        User { id: 1, name: "Sean".to_string(), hair_color: Some("Black".to_string()) },
-        User { id: 2, name: "Tess".to_string(), hair_color: None },
+        User { id: inserted_users[0].id, name: "Sean".to_string(), hair_color: Some("Black".to_string()) },
+        User { id: inserted_users[1].id, name: "Tess".to_string(), hair_color: None },
     ];
     let actual_users: Vec<_> = users.load(&connection).unwrap().collect();
 
@@ -27,6 +26,7 @@ fn insert_records() {
 fn insert_with_defaults() {
     use schema::users::table as users;
     let connection = connection();
+    connection.execute("DROP TABLE users").unwrap();
     connection.execute("CREATE TABLE users (
         id SERIAL PRIMARY KEY,
         name VARCHAR NOT NULL,
@@ -52,6 +52,7 @@ fn insert_with_defaults() {
 fn insert_with_defaults_not_provided() {
     use schema::users::table as users;
     let connection = connection();
+    connection.execute("DROP TABLE users").unwrap();
     connection.execute("CREATE TABLE users (
         id SERIAL PRIMARY KEY,
         name VARCHAR NOT NULL,
@@ -77,6 +78,7 @@ fn insert_with_defaults_not_provided() {
 fn insert_returning_count_returns_number_of_rows_inserted() {
     use schema::users::table as users;
     let connection = connection();
+    connection.execute("DROP TABLE users").unwrap();
     connection.execute("CREATE TABLE users (
         id SERIAL PRIMARY KEY,
         name VARCHAR NOT NULL,
@@ -107,17 +109,16 @@ struct BorrowedUser<'a> {
 fn insert_borrowed_content() {
     use schema::users::table as users;
     let connection = connection();
-    setup_users_table(&connection);
     let new_users: &[_] = &[
         BorrowedUser { name: "Sean" },
         BorrowedUser { name: "Tess" },
     ];
-    let inserted_users: Vec<_> = insert(new_users).into(users).get_results(&connection)
+    let inserted_users: Vec<User> = insert(new_users).into(users).get_results(&connection)
         .unwrap().collect();
 
     let expected_users = vec![
-        User::new(1, "Sean"),
-        User::new(2, "Tess"),
+        User::new(inserted_users[0].id, "Sean"),
+        User::new(inserted_users[1].id, "Tess"),
     ];
     let actual_users: Vec<_> = users.load(&connection).unwrap().collect();
 
diff --git a/diesel_tests/tests/joins.rs b/diesel_tests/tests/joins.rs
index e8f84b063..03c455092 100644
--- a/diesel_tests/tests/joins.rs
+++ b/diesel_tests/tests/joins.rs
@@ -3,15 +3,11 @@ use diesel::*;
 
 #[test]
 fn belongs_to() {
-    let connection = connection();
-    setup_users_table(&connection);
-    setup_posts_table(&connection);
+    let connection = connection_with_sean_and_tess_in_users_table();
 
-    connection.execute("INSERT INTO users (name) VALUES ('Sean'), ('Tess')")
-        .unwrap();
-    connection.execute("INSERT INTO posts (user_id, title, body) VALUES
-        (1, 'Hello', 'Content'),
-        (2, 'World', DEFAULT)
+    connection.execute("INSERT INTO posts (id, user_id, title, body) VALUES
+        (1, 1, 'Hello', 'Content'),
+        (2, 2, 'World', DEFAULT)
     ").unwrap();
 
     let sean = User::new(1, "Sean");
@@ -28,15 +24,11 @@ fn belongs_to() {
 
 #[test]
 fn select_single_from_join() {
-    let connection = connection();
-    setup_users_table(&connection);
-    setup_posts_table(&connection);
+    let connection = connection_with_sean_and_tess_in_users_table();
 
-    connection.execute("INSERT INTO users (name) VALUES ('Sean'), ('Tess')")
-        .unwrap();
-    connection.execute("INSERT INTO posts (user_id, title) VALUES
-        (1, 'Hello'),
-        (2, 'World')
+    connection.execute("INSERT INTO posts (id, user_id, title) VALUES
+        (1, 1, 'Hello'),
+        (2, 2, 'World')
     ").unwrap();
 
     let source = posts::table.inner_join(users::table);
@@ -56,15 +48,11 @@ fn select_single_from_join() {
 
 #[test]
 fn select_multiple_from_join() {
-    let connection = connection();
-    setup_users_table(&connection);
-    setup_posts_table(&connection);
+    let connection = connection_with_sean_and_tess_in_users_table();
 
-    connection.execute("INSERT INTO users (name) VALUES ('Sean'), ('Tess')")
-        .unwrap();
-    connection.execute("INSERT INTO posts (user_id, title) VALUES
-        (1, 'Hello'),
-        (2, 'World')
+    connection.execute("INSERT INTO posts (id, user_id, title) VALUES
+        (1, 1, 'Hello'),
+        (2, 2, 'World')
     ").unwrap();
 
     let source = posts::table.inner_join(users::table)
@@ -81,12 +69,8 @@ fn select_multiple_from_join() {
 
 #[test]
 fn select_only_one_side_of_join() {
-    let connection = connection();
-    setup_users_table(&connection);
-    setup_posts_table(&connection);
+    let connection = connection_with_sean_and_tess_in_users_table();
 
-    connection.execute("INSERT INTO users (name) VALUES ('Sean'), ('Tess')")
-        .unwrap();
     connection.execute("INSERT INTO posts (user_id, title) VALUES (2, 'Hello')")
         .unwrap();
 
@@ -100,15 +84,11 @@ fn select_only_one_side_of_join() {
 
 #[test]
 fn left_outer_joins() {
-    let connection = connection();
-    setup_users_table(&connection);
-    setup_posts_table(&connection);
+    let connection = connection_with_sean_and_tess_in_users_table();
 
-    connection.execute("INSERT INTO users (name) VALUES ('Sean'), ('Tess')")
-        .unwrap();
-    connection.execute("INSERT INTO posts (user_id, title) VALUES
-        (1, 'Hello'),
-        (1, 'World')
+    connection.execute("INSERT INTO posts (id, user_id, title) VALUES
+        (1, 1, 'Hello'),
+        (2, 1, 'World')
     ").unwrap();
 
     let sean = User::new(1, "Sean");
@@ -129,12 +109,8 @@ fn left_outer_joins() {
 
 #[test]
 fn columns_on_right_side_of_left_outer_joins_are_nullable() {
-    let connection = connection();
-    setup_users_table(&connection);
-    setup_posts_table(&connection);
+    let connection = connection_with_sean_and_tess_in_users_table();
 
-    connection.execute("INSERT INTO users (name) VALUES ('Sean'), ('Tess')")
-        .unwrap();
     connection.execute("INSERT INTO posts (user_id, title) VALUES
         (1, 'Hello'),
         (1, 'World')
@@ -153,12 +129,8 @@ fn columns_on_right_side_of_left_outer_joins_are_nullable() {
 
 #[test]
 fn select_multiple_from_right_side_returns_optional_tuple() {
-    let connection = connection();
-    setup_users_table(&connection);
-    setup_posts_table(&connection);
+    let connection = connection_with_sean_and_tess_in_users_table();
 
-    connection.execute("INSERT INTO users (name) VALUES ('Sean'), ('Tess')")
-        .unwrap();
     connection.execute("INSERT INTO posts (user_id, title, body) VALUES
         (1, 'Hello', 'Content'),
         (1, 'World', DEFAULT)
@@ -178,12 +150,8 @@ fn select_multiple_from_right_side_returns_optional_tuple() {
 
 #[test]
 fn select_complex_from_left_join() {
-    let connection = connection();
-    setup_users_table(&connection);
-    setup_posts_table(&connection);
+    let connection = connection_with_sean_and_tess_in_users_table();
 
-    connection.execute("INSERT INTO users (name) VALUES ('Sean'), ('Tess')")
-        .unwrap();
     connection.execute("INSERT INTO posts (user_id, title, body) VALUES
         (1, 'Hello', 'Content'),
         (1, 'World', DEFAULT)
@@ -205,12 +173,8 @@ fn select_complex_from_left_join() {
 
 #[test]
 fn select_right_side_with_nullable_column_first() {
-    let connection = connection();
-    setup_users_table(&connection);
-    setup_posts_table(&connection);
+    let connection = connection_with_sean_and_tess_in_users_table();
 
-    connection.execute("INSERT INTO users (name) VALUES ('Sean'), ('Tess')")
-        .unwrap();
     connection.execute("INSERT INTO posts (user_id, title, body) VALUES
         (1, 'Hello', 'Content'),
         (1, 'World', DEFAULT)
@@ -234,7 +198,6 @@ fn select_right_side_with_nullable_column_first() {
 fn select_then_join() {
     use schema::users::dsl::*;
     let connection = connection_with_sean_and_tess_in_users_table();
-    setup_posts_table(&connection);
 
     connection.execute("INSERT INTO posts (user_id, title) VALUES (1, 'Hello')")
         .unwrap();
@@ -255,19 +218,18 @@ fn select_then_join() {
 fn join_through_other() {
     use schema::users::dsl::*;
     let connection = connection_with_sean_and_tess_in_users_table();
-    setup_posts_table(&connection);
-    setup_comments_table(&connection);
 
     insert(&NewUser::new("Jim", None)).into(users).execute(&connection).unwrap();
-    insert(&vec![
+    let posts: Vec<Post> = insert(&vec![
         NewPost::new(1, "Hello", None), NewPost::new(2, "World", None),
         NewPost::new(1, "Hello again!", None),
         ]).into(posts::table)
-        .execute(&connection)
-        .unwrap();
+        .get_results(&connection)
+        .unwrap()
+        .collect();
     let comments: Vec<Comment> = insert(&vec![
-        NewComment(1, "OMG"), NewComment(2, "WTF"),
-        NewComment(3, "Best post ever!!!")
+        NewComment(posts[0].id, "OMG"), NewComment(posts[1].id, "WTF"),
+        NewComment(posts[2].id, "Best post ever!!!")
     ]).into(comments::table).get_results(&connection).unwrap().collect();
 
     let data: Vec<_> = users.inner_join(comments::table).load(&connection)
diff --git a/diesel_tests/tests/order.rs b/diesel_tests/tests/order.rs
index 13da9b4e6..07a978964 100644
--- a/diesel_tests/tests/order.rs
+++ b/diesel_tests/tests/order.rs
@@ -6,28 +6,32 @@ fn order_by_column() {
     use schema::users::dsl::*;
 
     let conn = connection();
-    setup_users_table(&conn);
     let data = vec![
         NewUser::new("Sean", None),
         NewUser::new("Tess", None),
         NewUser::new("Jim", None),
     ];
-    insert(&data).into(users).execute(&conn).unwrap();
+    let data: Vec<User> =
+        insert(&data).into(users).get_results(&conn).unwrap().collect();
+    let sean = &data[0];
+    let tess = &data[1];
+    let jim = &data[2];
 
     let expected_data = vec![
-        User::new(3, "Jim"),
-        User::new(1, "Sean"),
-        User::new(2, "Tess"),
+        User::new(jim.id, "Jim"),
+        User::new(sean.id, "Sean"),
+        User::new(tess.id, "Tess"),
     ];
     let data: Vec<_> = users.order(name).load(&conn).unwrap().collect();
     assert_eq!(expected_data, data);
 
-    insert(&NewUser::new("Aaron", None)).into(users).execute(&conn).unwrap();
+    let aaron = insert(&NewUser::new("Aaron", None)).into(users)
+        .get_result::<User>(&conn).unwrap();
     let expected_data = vec![
-        User::new(4, "Aaron"),
-        User::new(3, "Jim"),
-        User::new(1, "Sean"),
-        User::new(2, "Tess"),
+        User::new(aaron.id, "Aaron"),
+        User::new(jim.id, "Jim"),
+        User::new(sean.id, "Sean"),
+        User::new(tess.id, "Tess"),
     ];
     let data: Vec<_> = users.order(name.asc()).load(&conn).unwrap().collect();
     assert_eq!(expected_data, data);
@@ -38,28 +42,32 @@ fn order_by_descending_column() {
     use schema::users::dsl::*;
 
     let conn = connection();
-    setup_users_table(&conn);
     let data = vec![
         NewUser::new("Sean", None),
         NewUser::new("Tess", None),
         NewUser::new("Jim", None),
     ];
-    insert(&data).into(users).execute(&conn).unwrap();
+    let data: Vec<User> = insert(&data).into(users)
+        .get_results(&conn).unwrap().collect();
+    let sean = &data[0];
+    let tess = &data[1];
+    let jim = &data[2];
 
     let expected_data = vec![
-        User::new(2, "Tess"),
-        User::new(1, "Sean"),
-        User::new(3, "Jim"),
+        User::new(tess.id, "Tess"),
+        User::new(sean.id, "Sean"),
+        User::new(jim.id, "Jim"),
     ];
     let data: Vec<_> = users.order(name.desc()).load(&conn).unwrap().collect();
     assert_eq!(expected_data, data);
 
-    insert(&NewUser::new("Aaron", None)).into(users).execute(&conn).unwrap();
+    let aaron = insert(&NewUser::new("Aaron", None)).into(users)
+        .get_result::<User>(&conn).unwrap();
     let expected_data = vec![
-        User::new(2, "Tess"),
-        User::new(1, "Sean"),
-        User::new(3, "Jim"),
-        User::new(4, "Aaron"),
+        User::new(tess.id, "Tess"),
+        User::new(sean.id, "Sean"),
+        User::new(jim.id, "Jim"),
+        User::new(aaron.id, "Aaron"),
     ];
     let data: Vec<_> = users.order(name.desc()).load(&conn).unwrap().collect();
     assert_eq!(expected_data, data);
diff --git a/diesel_tests/tests/schema.rs b/diesel_tests/tests/schema.rs
index 3ed7636da..0b3f8b175 100644
--- a/diesel_tests/tests/schema.rs
+++ b/diesel_tests/tests/schema.rs
@@ -107,31 +107,6 @@ pub struct NewComment<'a>(
     pub &'a str,
 );
 
-pub fn setup_users_table(connection: &Connection) {
-    connection.execute("CREATE TABLE users (
-        id SERIAL PRIMARY KEY,
-        name VARCHAR NOT NULL,
-        hair_color VARCHAR
-    )").unwrap();
-}
-
-pub fn setup_posts_table(connection: &Connection) {
-    connection.execute("CREATE TABLE posts (
-        id SERIAL PRIMARY KEY,
-        user_id INTEGER NOT NULL,
-        title VARCHAR NOT NULL,
-        body TEXT
-    )").unwrap();
-}
-
-pub fn setup_comments_table(connection: &Connection) {
-    connection.execute("CREATE TABLE comments (
-        id SERIAL PRIMARY KEY,
-        post_id INTEGER NOT NULL,
-        text TEXT NOT NULL
-    )").unwrap();
-}
-
 pub fn connection() -> Connection {
     let result = connection_without_transaction();
     result.begin_test_transaction().unwrap();
@@ -146,9 +121,8 @@ pub fn connection_without_transaction() -> Connection {
 
 pub fn connection_with_sean_and_tess_in_users_table() -> Connection {
     let connection = connection();
-    setup_users_table(&connection);
-    let data: &[_] = &[NewUser::new("Sean", None), NewUser::new("Tess", None)];
-    insert(data).into(users::table).execute(&connection).unwrap();
+    connection.execute("INSERT INTO users (id, name) VALUES (1, 'Sean'), (2, 'Tess')")
+        .unwrap();
     connection
 }
 
diff --git a/diesel_tests/tests/select.rs b/diesel_tests/tests/select.rs
index bcbf663fb..a6c77f9f5 100644
--- a/diesel_tests/tests/select.rs
+++ b/diesel_tests/tests/select.rs
@@ -3,32 +3,37 @@ use diesel::*;
 
 #[test]
 fn selecting_basic_data() {
+    use schema::users::dsl::*;
+
     let connection = connection();
-    setup_users_table(&connection);
     connection.execute("INSERT INTO users (name) VALUES ('Sean'), ('Tess')")
         .unwrap();
 
     let expected_data = vec![
-        (1, "Sean".to_string(), None::<String>),
-        (2, "Tess".to_string(), None::<String>),
+        ("Sean".to_string(), None::<String>),
+        ("Tess".to_string(), None::<String>),
      ];
-    let actual_data: Vec<_> = users::table.load(&connection)
+    let actual_data: Vec<_> = users
+        .select((name, hair_color))
+        .load(&connection)
         .unwrap().collect();
     assert_eq!(expected_data, actual_data);
 }
 
 #[test]
 fn selecting_a_struct() {
+    use schema::users::dsl::*;
     let connection = connection();
-    setup_users_table(&connection);
     connection.execute("INSERT INTO users (name) VALUES ('Sean'), ('Tess')")
         .unwrap();
 
     let expected_users = vec![
-        User::new(1, "Sean"),
-        User::new(2, "Tess"),
+        NewUser::new("Sean", None),
+        NewUser::new("Tess", None),
     ];
-    let actual_users: Vec<_> = users::table.load(&connection)
+    let actual_users: Vec<_> = users
+        .select((name, hair_color))
+        .load(&connection)
         .unwrap().collect();
     assert_eq!(expected_users, actual_users);
 }
@@ -38,65 +43,19 @@ fn with_safe_select() {
     use schema::users::dsl::*;
 
     let connection = connection();
-    setup_users_table(&connection);
     connection.execute("INSERT INTO users (name) VALUES ('Sean'), ('Tess')")
         .unwrap();
 
-    let select_id = users.select(id);
     let select_name = users.select(name);
-    let ids: Vec<_> = select_id.load(&connection)
-        .unwrap().collect();
     let names: Vec<String> = select_name.load(&connection)
         .unwrap().collect();
 
-    assert_eq!(vec![1, 2], ids);
     assert_eq!(vec!["Sean".to_string(), "Tess".to_string()], names);
 }
 
-#[test]
-fn selecting_multiple_columns() {
-    use schema::users::dsl::*;
-
-    let connection = connection();
-    setup_users_table(&connection);
-    connection.execute("INSERT INTO users (name, hair_color) VALUES ('Jim', 'Black'), ('Bob', 'Brown')")
-        .unwrap();
-
-    let source = users.select((name, hair_color));
-    let expected_data = vec![
-        ("Jim".to_string(), Some("Black".to_string())),
-        ("Bob".to_string(), Some("Brown".to_string())),
-    ];
-    let actual_data: Vec<_> = source.load(&connection)
-        .unwrap().collect();
-
-    assert_eq!(expected_data, actual_data);
-}
-
-#[test]
-fn selecting_multiple_columns_into_struct() {
-    use schema::users::dsl::*;
-
-    let connection = connection();
-    setup_users_table(&connection);
-    connection.execute("INSERT INTO users (name, hair_color) VALUES ('Jim', 'Black'), ('Bob', 'Brown')")
-        .unwrap();
-
-    let source = users.select((name, hair_color));
-    let expected_data = vec![
-        NewUser::new("Jim", Some("Black")),
-        NewUser::new("Bob", Some("Brown")),
-    ];
-    let actual_data: Vec<_> = source.load(&connection)
-        .unwrap().collect();
-
-    assert_eq!(expected_data, actual_data);
-}
-
 #[test]
 fn with_select_sql() {
     let connection = connection();
-    setup_users_table(&connection);
     connection.execute("INSERT INTO users (name) VALUES ('Sean'), ('Tess')")
         .unwrap();
 
@@ -116,7 +75,6 @@ fn selecting_nullable_followed_by_non_null() {
     use schema::users::dsl::*;
 
     let connection = connection();
-    setup_users_table(&connection);
     connection.execute("INSERT INTO users (name) VALUES ('Sean')")
         .unwrap();
 
@@ -132,7 +90,6 @@ fn selecting_expression_with_bind_param() {
     use schema::users::dsl::*;
 
     let connection = connection();
-    setup_users_table(&connection);
     connection.execute("INSERT INTO users (name) VALUES ('Sean'), ('Tess')")
         .unwrap();
 
@@ -176,6 +133,7 @@ fn selecting_columns_and_tables_with_reserved_names() {
 #[test]
 fn selecting_columns_with_different_definition_order() {
     let connection = connection();
+    connection.execute("DROP TABLE users").unwrap();
     connection.execute("CREATE TABLE users (id SERIAL PRIMARY KEY, hair_color VARCHAR, name VARCHAR NOT NULL)")
         .unwrap();
     let expected_user = User::with_hair_color(1, "Sean", "black");
@@ -192,9 +150,11 @@ fn selection_using_subselect() {
     use diesel::expression::dsl::*;
 
     let connection = connection_with_sean_and_tess_in_users_table();
-    setup_posts_table(&connection);
-    connection.execute("INSERT INTO posts (user_id, title) VALUES (1, 'Hello'), (2, 'World')")
-        .unwrap();
+    let ids: Vec<i32> = users::table.select(users::id).load(&connection).unwrap().collect();
+    let query = format!(
+        "INSERT INTO posts (user_id, title) VALUES ({}, 'Hello'), ({}, 'World')",
+        ids[0], ids[1]);
+    connection.execute(&query).unwrap();
 
     let users = users::table.filter(users::name.eq("Sean")).select(users::id);
     let data: Vec<String> = posts
