diff --git a/CHANGELOG.md b/CHANGELOG.md
index 493faf1cd..5d7328066 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -39,11 +39,18 @@ for Rust libraries in [RFC #1105](https://github.com/rust-lang/rfcs/blob/master/
 * `TextExpressionMethods` is now implemented for expressions of type
   `Nullable<Text>` as well as `Text`.
 
+* `allow_tables_to_appear_in_same_query!` can now take more than 2 tables, and is the same
+  as invoking it separately for every combination of those tables.
+
 ### Changed
 
 * The signatures of `QueryId`, `Column`, and `FromSqlRow` have all changed to
   use associated constants where appropriate.
 
+* You will now need to invoke `allow_tables_to_appear_in_same_query!` any time two tables
+  appear together in the same query, even if there is a `joinable!` invocation
+  for those tables.
+
 ### Deprecated
 
 * Deprecated `insert_default_values()` in favor of
@@ -64,6 +71,9 @@ for Rust libraries in [RFC #1105](https://github.com/rust-lang/rfcs/blob/master/
 * Deprecated `.values(x.on_conflict(y, do_update().set(z)))` in favor of
   `.values(x).on_conflict(y).do_update().set(z)`
 
+* Deprecated `enable_multi_table_joins` in favor of
+  `allow_tables_to_appear_in_same_query!`
+
 ### Removed
 
 * `IntoInsertStatement` and `BatchInsertStatement` have been removed. It's
diff --git a/diesel/src/expression_methods/global_expression_methods.rs b/diesel/src/expression_methods/global_expression_methods.rs
index 0dd4a6698..0ba542fae 100644
--- a/diesel/src/expression_methods/global_expression_methods.rs
+++ b/diesel/src/expression_methods/global_expression_methods.rs
@@ -426,18 +426,19 @@ pub trait NullableExpressionMethods: Expression + Sized {
     ///     }
     /// }
     /// #
-    /// #  pub struct User {
-    /// #      id: i32,
-    /// #      name: VarChar,
-    /// #  }
-    /// #
-    /// #  pub struct Post {
-    /// #      id: i32,
-    /// #      user_id: i32,
-    /// #      author_name: Option<VarChar>,
-    /// #  }
-    /// #
-    /// #  joinable!(posts -> users (user_id));
+    /// # pub struct User {
+    /// #     id: i32,
+    /// #     name: VarChar,
+    /// # }
+    /// #
+    /// # pub struct Post {
+    /// #     id: i32,
+    /// #     user_id: i32,
+    /// #     author_name: Option<VarChar>,
+    /// # }
+    /// #
+    /// # joinable!(posts -> users (user_id));
+    /// # allow_tables_to_appear_in_same_query!(posts, users);
     ///
     /// fn main() {
     ///     use users::dsl::*;
diff --git a/diesel/src/macros/mod.rs b/diesel/src/macros/mod.rs
index b542acd9f..e68ac5a21 100644
--- a/diesel/src/macros/mod.rs
+++ b/diesel/src/macros/mod.rs
@@ -749,12 +749,6 @@ macro_rules! table_body {
                 type Count = Never;
             }
 
-            impl<T> AppearsInFromClause<T> for table where
-                T: Table + JoinTo<table>,
-            {
-                type Count = Never;
-            }
-
             impl<Left, Right, Kind> JoinTo<Join<Left, Right, Kind>> for table where
                 Join<Left, Right, Kind>: JoinTo<table>,
             {
@@ -888,35 +882,43 @@ macro_rules! __diesel_table_query_source_impl {
     };
 }
 
-/// Allow two tables to be referenced in a join query.
+/// Allow two tables to be referenced in a join query without providing an
+/// explicit `ON` clause.
+///
+/// The generated `ON` clause will always join to the primary key of the parent
+/// table. This macro removes the need to call [`.on`] explicitly, you will
+/// still need to invoke [`allow_tables_to_appear_in_same_query!`] for these two tables to
+/// be able to use the resulting query, unless you are using `infer_schema!` or
+/// `diesel print-schema` which will generate it for you.
+///
+/// If you are using `infer_schema!` or `diesel print-schema`, an invocation of
+/// this macro will be generated for every foreign key in your database unless
+/// one of the following is true:
+///
+/// - The foreign key references something other than the primary key
+/// - The foreign key is composite
+/// - There is more than one foreign key connecting two tables
+/// - The foreign key is self-referential
 ///
 /// # Example
 ///
 /// ```rust
 /// # #[macro_use] extern crate diesel;
-/// # use diesel::prelude::*;
-/// mod schema {
-///    table! {
-///         users(id) {
-///             id -> Integer,
-///         }
-///     }
-///     table! {
-///         posts(id) {
-///             id -> Integer,
-///             user_id -> Integer,
-///         }
-///     }
-///
-/// }
+/// # include!("../doctest_setup.rs");
+/// use schema::*;
 ///
-/// joinable!(schema::posts -> schema::users(user_id));
+/// joinable!(posts -> users (user_id));
+/// allow_tables_to_appear_in_same_query!(posts, users);
 ///
 /// # fn main() {
-/// use schema::*;
+/// let implicit_on_clause = users::table.inner_join(posts::table);
+/// let implicit_on_clause_sql = diesel::debug_query::<DB, _>(&implicit_on_clause).to_string();
+///
+/// let explicit_on_clause = users::table
+///     .inner_join(posts::table.on(posts::user_id.eq(users::id)));
+/// let explicit_on_clause_sql = diesel::debug_query::<DB, _>(&explicit_on_clause).to_string();
 ///
-/// // Without the joinable! call, this wouldn't compile
-/// let query = users::table.inner_join(posts::table);
+/// assert_eq!(implicit_on_clause_sql, explicit_on_clause_sql);
 /// # }
 /// ```
 #[macro_export]
@@ -965,7 +967,9 @@ macro_rules! joinable_inner {
     }
 }
 
+
 #[deprecated(since = "0.16.0", note = "use `allow_tables_to_appear_in_same_query!` instead")]
+#[cfg(feature = "with-deprecated")]
 #[macro_export]
 macro_rules! enable_multi_table_joins {
     ($left_mod:ident, $right_mod:ident) => {
@@ -973,33 +977,53 @@ macro_rules! enable_multi_table_joins {
     }
 }
 
-/// Allow two tables which are otherwise unrelated to be used together in a
-/// multi-table join. This macro only needs to be invoked when the two tables
-/// don't have an association between them (e.g. parent to grandchild)
+/// Allow two or more tables which are otherwise unrelated to be used together
+/// in a query.
+///
+/// This macro must be invoked any time two tables need to appear in the same
+/// query either because they are being joined together, or because one appears
+/// in a subselect. When this macro is invoked with more than 2 tables, every
+/// combination of those tables will be allowed to appear together.
+///
+/// If you are using `infer_schema!` or `diesel print-schema`, an invocation of
+/// this macro will be generated for you for all tables in your schema.
 ///
 /// # Example
 ///
 /// ```ignore
 /// // This would be required to do `users.inner_join(posts.inner_join(comments))`
-/// // if there were an association between users and posts, and an association
-/// // between posts and comments, but no association between users and comments
-/// enable_multi_table_joins!(users, comments);
+/// allow_tables_to_appear_in_same_query!(comments, posts, users);
+/// ```
+///
+/// When more than two tables are passed, the relevant code is generated for
+/// every combination of those tables. This code would be equivalent to the
+/// previous example.
+///
+/// ```ignore
+/// allow_tables_to_appear_in_same_query!(comments, posts);
+/// allow_tables_to_appear_in_same_query!(comments, users);
+/// allow_tables_to_appear_in_same_query!(posts, users);
 /// ```
 #[macro_export]
 macro_rules! allow_tables_to_appear_in_same_query {
-    ($left_mod:ident, $right_mod:ident) => {
-        impl $crate::query_source::AppearsInFromClause<$left_mod::table>
-            for $right_mod::table
-        {
-            type Count = $crate::query_source::Never;
-        }
+    ($left_mod:ident, $($right_mod:ident),+ $(,)*) => {
+        $(
+            impl $crate::query_source::AppearsInFromClause<$left_mod::table>
+                for $right_mod::table
+            {
+                type Count = $crate::query_source::Never;
+            }
 
-        impl $crate::query_source::AppearsInFromClause<$right_mod::table>
-            for $left_mod::table
-        {
-            type Count = $crate::query_source::Never;
-        }
-    }
+            impl $crate::query_source::AppearsInFromClause<$right_mod::table>
+                for $left_mod::table
+            {
+                type Count = $crate::query_source::Never;
+            }
+        )+
+        allow_tables_to_appear_in_same_query!($($right_mod,)+);
+    };
+
+    ($last_table:ident,) => {};
 }
 
 /// Takes a query `QueryFragment` expression as an argument and returns a string
diff --git a/diesel_cli/src/print_schema.rs b/diesel_cli/src/print_schema.rs
index 42b0467a9..0ee47e779 100644
--- a/diesel_cli/src/print_schema.rs
+++ b/diesel_cli/src/print_schema.rs
@@ -97,6 +97,19 @@ impl Display for TableDefinitions {
         for foreign_key in &self.fk_constraints {
             writeln!(f, "{}", Joinable(foreign_key))?;
         }
+
+        if self.tables.len() > 1 {
+            write!(f, "\nallow_tables_to_appear_in_same_query!(")?;
+            {
+                let mut out = PadAdapter::new(f);
+                write!(out, "\n")?;
+                for table in &self.tables {
+                    writeln!(out, "{},", table.name.name)?;
+                }
+            }
+            writeln!(f, ");")?;
+        }
+
         Ok(())
     }
 }
diff --git a/diesel_cli/tests/print_schema/print_schema_order/mysql/expected.rs b/diesel_cli/tests/print_schema/print_schema_order/mysql/expected.rs
index a8f4d0c97..59204758c 100644
--- a/diesel_cli/tests/print_schema/print_schema_order/mysql/expected.rs
+++ b/diesel_cli/tests/print_schema/print_schema_order/mysql/expected.rs
@@ -39,3 +39,9 @@ table! {
         id -> Integer,
     }
 }
+
+allow_tables_to_appear_in_same_query!(
+    abc,
+    def,
+    ghi,
+);
diff --git a/diesel_cli/tests/print_schema/print_schema_order/postgres/expected.rs b/diesel_cli/tests/print_schema/print_schema_order/postgres/expected.rs
index c0172a1c1..a71e79389 100644
--- a/diesel_cli/tests/print_schema/print_schema_order/postgres/expected.rs
+++ b/diesel_cli/tests/print_schema/print_schema_order/postgres/expected.rs
@@ -39,3 +39,9 @@ table! {
         id -> Int4,
     }
 }
+
+allow_tables_to_appear_in_same_query!(
+    abc,
+    def,
+    ghi,
+);
diff --git a/diesel_cli/tests/print_schema/print_schema_order/sqlite/expected.rs b/diesel_cli/tests/print_schema/print_schema_order/sqlite/expected.rs
index 8979aa4cc..58e4159b1 100644
--- a/diesel_cli/tests/print_schema/print_schema_order/sqlite/expected.rs
+++ b/diesel_cli/tests/print_schema/print_schema_order/sqlite/expected.rs
@@ -39,3 +39,9 @@ table! {
         id -> Nullable<Integer>,
     }
 }
+
+allow_tables_to_appear_in_same_query!(
+    abc,
+    def,
+    ghi,
+);
diff --git a/diesel_cli/tests/print_schema/print_schema_simple/mysql/expected.rs b/diesel_cli/tests/print_schema/print_schema_simple/mysql/expected.rs
index b102e198b..9994b9c4d 100644
--- a/diesel_cli/tests/print_schema/print_schema_simple/mysql/expected.rs
+++ b/diesel_cli/tests/print_schema/print_schema_simple/mysql/expected.rs
@@ -25,3 +25,8 @@ table! {
         id -> Integer,
     }
 }
+
+allow_tables_to_appear_in_same_query!(
+    users1,
+    users2,
+);
diff --git a/diesel_cli/tests/print_schema/print_schema_simple/postgres/expected.rs b/diesel_cli/tests/print_schema/print_schema_simple/postgres/expected.rs
index c49e9fd46..cdac1b464 100644
--- a/diesel_cli/tests/print_schema/print_schema_simple/postgres/expected.rs
+++ b/diesel_cli/tests/print_schema/print_schema_simple/postgres/expected.rs
@@ -25,3 +25,8 @@ table! {
         id -> Int4,
     }
 }
+
+allow_tables_to_appear_in_same_query!(
+    users1,
+    users2,
+);
diff --git a/diesel_cli/tests/print_schema/print_schema_simple/sqlite/expected.rs b/diesel_cli/tests/print_schema/print_schema_simple/sqlite/expected.rs
index c86a9bc03..a34d644e1 100644
--- a/diesel_cli/tests/print_schema/print_schema_simple/sqlite/expected.rs
+++ b/diesel_cli/tests/print_schema/print_schema_simple/sqlite/expected.rs
@@ -25,3 +25,8 @@ table! {
         id -> Nullable<Integer>,
     }
 }
+
+allow_tables_to_appear_in_same_query!(
+    users1,
+    users2,
+);
diff --git a/diesel_cli/tests/print_schema/print_schema_simple_without_docs/mysql/expected.rs b/diesel_cli/tests/print_schema/print_schema_simple_without_docs/mysql/expected.rs
index 85545ca3c..7b3aa1cca 100644
--- a/diesel_cli/tests/print_schema/print_schema_simple_without_docs/mysql/expected.rs
+++ b/diesel_cli/tests/print_schema/print_schema_simple_without_docs/mysql/expected.rs
@@ -9,3 +9,8 @@ table! {
         id -> Integer,
     }
 }
+
+allow_tables_to_appear_in_same_query!(
+    users1,
+    users2,
+);
diff --git a/diesel_cli/tests/print_schema/print_schema_simple_without_docs/postgres/expected.rs b/diesel_cli/tests/print_schema/print_schema_simple_without_docs/postgres/expected.rs
index 195b05e24..13523495b 100644
--- a/diesel_cli/tests/print_schema/print_schema_simple_without_docs/postgres/expected.rs
+++ b/diesel_cli/tests/print_schema/print_schema_simple_without_docs/postgres/expected.rs
@@ -9,3 +9,8 @@ table! {
         id -> Int4,
     }
 }
+
+allow_tables_to_appear_in_same_query!(
+    users1,
+    users2,
+);
diff --git a/diesel_cli/tests/print_schema/print_schema_simple_without_docs/sqlite/expected.rs b/diesel_cli/tests/print_schema/print_schema_simple_without_docs/sqlite/expected.rs
index bc0c8759a..22e5140d6 100644
--- a/diesel_cli/tests/print_schema/print_schema_simple_without_docs/sqlite/expected.rs
+++ b/diesel_cli/tests/print_schema/print_schema_simple_without_docs/sqlite/expected.rs
@@ -9,3 +9,8 @@ table! {
         id -> Nullable<Integer>,
     }
 }
+
+allow_tables_to_appear_in_same_query!(
+    users1,
+    users2,
+);
diff --git a/diesel_cli/tests/print_schema/print_schema_specifying_schema_name_with_foreign_keys/postgres/expected.rs b/diesel_cli/tests/print_schema/print_schema_specifying_schema_name_with_foreign_keys/postgres/expected.rs
index 637a24400..ff85c50f3 100644
--- a/diesel_cli/tests/print_schema/print_schema_specifying_schema_name_with_foreign_keys/postgres/expected.rs
+++ b/diesel_cli/tests/print_schema/print_schema_specifying_schema_name_with_foreign_keys/postgres/expected.rs
@@ -34,4 +34,9 @@ pub mod custom_schema {
     }
 
     joinable!(b -> a (parent));
+
+    allow_tables_to_appear_in_same_query!(
+        a,
+        b,
+    );
 }
diff --git a/diesel_cli/tests/print_schema/print_schema_with_foreign_keys/postgres/expected.rs b/diesel_cli/tests/print_schema/print_schema_with_foreign_keys/postgres/expected.rs
index d5bf22c3a..e2675609e 100644
--- a/diesel_cli/tests/print_schema/print_schema_with_foreign_keys/postgres/expected.rs
+++ b/diesel_cli/tests/print_schema/print_schema_with_foreign_keys/postgres/expected.rs
@@ -54,3 +54,9 @@ table! {
 
 joinable!(comments -> posts (post_id));
 joinable!(posts -> users (user_id));
+
+allow_tables_to_appear_in_same_query!(
+    comments,
+    posts,
+    users,
+);
diff --git a/diesel_codegen/src/schema_inference.rs b/diesel_codegen/src/schema_inference.rs
index 2d6ede6ed..13b8048ca 100644
--- a/diesel_codegen/src/schema_inference.rs
+++ b/diesel_codegen/src/schema_inference.rs
@@ -1,5 +1,5 @@
-use syn;
 use quote;
+use syn;
 
 use database_url::extract_database_url;
 use diesel_infer_schema::*;
@@ -43,8 +43,10 @@ pub fn derive_infer_schema(input: syn::DeriveInput) -> quote::Tokens {
         let foreign_key = syn::Ident::new(fk.foreign_key);
         quote!(joinable!(#child_table -> #parent_table (#foreign_key));)
     });
+    let table_idents = table_names.iter().map(|t| syn::Ident::from(&*t.name));
+    let multi_table_joins = quote!(allow_tables_to_appear_in_same_query!(#(#table_idents,)*););
 
-    let tokens = quote!(#(#tables)* #(#joinables)*);
+    let tokens = quote!(#(#tables)* #(#joinables)* #multi_table_joins);
     if let Some(schema_name) = schema_name {
         let schema_ident = syn::Ident::new(schema_name);
         quote!(pub mod #schema_ident { #tokens })
diff --git a/diesel_tests/tests/associations.rs b/diesel_tests/tests/associations.rs
index 9e5d8c85c..77248335e 100644
--- a/diesel_tests/tests/associations.rs
+++ b/diesel_tests/tests/associations.rs
@@ -45,6 +45,7 @@ mod eager_loading_with_string_keys {
 
     table! { users { id -> Text, } }
     table! { posts { id -> Text, user_id -> Text, } }
+    allow_tables_to_appear_in_same_query!(users, posts);
 
     #[derive(Queryable, Identifiable, Debug, PartialEq, Clone)]
     pub struct User {
@@ -277,6 +278,8 @@ fn custom_foreign_key() {
         }
     }
 
+    allow_tables_to_appear_in_same_query!(users1, posts1);
+
     #[derive(Clone, Debug, PartialEq, Identifiable, Queryable)]
     #[table_name = "users1"]
     pub struct User {
diff --git a/diesel_tests/tests/schema.rs b/diesel_tests/tests/schema.rs
index 9f28af513..5b8ccbeec 100644
--- a/diesel_tests/tests/schema.rs
+++ b/diesel_tests/tests/schema.rs
@@ -300,8 +300,3 @@ pub fn find_user_by_name(name: &str, connection: &TestConnection) -> User {
         .first(connection)
         .unwrap()
 }
-
-allow_tables_to_appear_in_same_query!(users, comments);
-allow_tables_to_appear_in_same_query!(posts, likes);
-allow_tables_to_appear_in_same_query!(followings, likes);
-allow_tables_to_appear_in_same_query!(followings, comments);
