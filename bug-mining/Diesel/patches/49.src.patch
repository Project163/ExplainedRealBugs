diff --git a/diesel_codegen/Cargo.toml b/diesel_codegen/Cargo.toml
index 81ef40553..313506d9e 100644
--- a/diesel_codegen/Cargo.toml
+++ b/diesel_codegen/Cargo.toml
@@ -17,7 +17,7 @@ syntex_syntax = { version = "0.31.0", optional = true }
 [dependencies]
 syntex = { version = "0.31.0", optional = true }
 syntex_syntax = { version = "0.31.0", optional = true }
-diesel = { version = "0.6.0", default-features = false }
+diesel = { git = "https://github.com/diesel-rs/diesel.git", default-features = false }
 
 [dev-dependencies]
 tempdir = "0.3.4"
@@ -31,4 +31,4 @@ sqlite = ["diesel/sqlite"]
 
 [lib]
 name = "diesel_codegen"
-plugin = true
+crate-type = ["rlib", "dylib"]
