diff --git a/diesel_cli/src/main.rs b/diesel_cli/src/main.rs
index ed64799b4..1dceab499 100644
--- a/diesel_cli/src/main.rs
+++ b/diesel_cli/src/main.rs
@@ -265,11 +265,11 @@ fn create_config_file(matches: &ArgMatches) -> DatabaseResult<()> {
 fn run_database_command(matches: &ArgMatches) -> Result<(), Box<dyn Error>> {
     match matches.subcommand() {
         ("setup", Some(args)) => {
-            let migrations_dir = migrations_dir(args).unwrap_or_else(handle_error);
+            let migrations_dir = migrations_dir(matches).unwrap_or_else(handle_error);
             database::setup_database(args, &migrations_dir)?;
         }
         ("reset", Some(args)) => {
-            let migrations_dir = migrations_dir(args).unwrap_or_else(handle_error);
+            let migrations_dir = migrations_dir(matches).unwrap_or_else(handle_error);
             database::reset_database(args, &migrations_dir)?;
             regenerate_schema_if_file_specified(matches)?;
         }
diff --git a/diesel_cli/tests/database_setup.rs b/diesel_cli/tests/database_setup.rs
index 158af59e6..e49aa35b8 100644
--- a/diesel_cli/tests/database_setup.rs
+++ b/diesel_cli/tests/database_setup.rs
@@ -84,6 +84,39 @@ fn database_abbreviated_as_db() {
     assert!(db.exists());
 }
 
+#[test]
+fn database_setup_respects_migration_dir_by_arg_to_database() {
+    let p = project("database_setup_respects_migration_dir_by_arg_to_database")
+        .folder("foo")
+        .build();
+
+    let db = database(&p.database_url());
+
+    p.create_migration_in_directory(
+        "foo",
+        "12345_create_users_table",
+        "CREATE TABLE users ( id INTEGER )",
+        "DROP TABLE users",
+    );
+
+    // sanity check
+    assert!(!db.exists());
+
+    let result = p
+        .command("database")
+        .arg("--migration-dir=foo")
+        .arg("setup")
+        .run();
+
+    assert!(result.is_success(), "Result was unsuccessful {:?}", result);
+    assert!(
+        result.stdout().contains("Running migration 12345"),
+        "Unexpected stdout {}",
+        result.stdout()
+    );
+    assert!(db.table_exists("users"));
+}
+
 #[test]
 fn database_setup_respects_migration_dir_by_arg() {
     let p = project("database_setup_respects_migration_dir_by_arg")
