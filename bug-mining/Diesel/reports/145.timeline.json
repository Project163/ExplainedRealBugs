[{"id":1206565991,"node_id":"MDEyOkxhYmVsZWRFdmVudDEyMDY1NjU5OTE=","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/1206565991","actor":{"login":"killercup","id":20063,"node_id":"MDQ6VXNlcjIwMDYz","avatar_url":"https://avatars.githubusercontent.com/u/20063?v=4","gravatar_id":"","url":"https://api.github.com/users/killercup","html_url":"https://github.com/killercup","followers_url":"https://api.github.com/users/killercup/followers","following_url":"https://api.github.com/users/killercup/following{/other_user}","gists_url":"https://api.github.com/users/killercup/gists{/gist_id}","starred_url":"https://api.github.com/users/killercup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/killercup/subscriptions","organizations_url":"https://api.github.com/users/killercup/orgs","repos_url":"https://api.github.com/users/killercup/repos","events_url":"https://api.github.com/users/killercup/events{/privacy}","received_events_url":"https://api.github.com/users/killercup/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2017-08-15T14:38:28Z","label":{"name":"question","color":"cc317c"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/322790014","html_url":"https://github.com/diesel-rs/diesel/issues/1106#issuecomment-322790014","issue_url":"https://api.github.com/repos/diesel-rs/diesel/issues/1106","id":322790014,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjc5MDAxNA==","user":{"login":"lancecarlson","id":107,"node_id":"MDQ6VXNlcjEwNw==","avatar_url":"https://avatars.githubusercontent.com/u/107?v=4","gravatar_id":"","url":"https://api.github.com/users/lancecarlson","html_url":"https://github.com/lancecarlson","followers_url":"https://api.github.com/users/lancecarlson/followers","following_url":"https://api.github.com/users/lancecarlson/following{/other_user}","gists_url":"https://api.github.com/users/lancecarlson/gists{/gist_id}","starred_url":"https://api.github.com/users/lancecarlson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lancecarlson/subscriptions","organizations_url":"https://api.github.com/users/lancecarlson/orgs","repos_url":"https://api.github.com/users/lancecarlson/repos","events_url":"https://api.github.com/users/lancecarlson/events{/privacy}","received_events_url":"https://api.github.com/users/lancecarlson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T14:29:52Z","updated_at":"2017-08-16T14:29:52Z","body":"Thinking this through, I would imagine the syntax might look like this:\n\n```rust\ndiesel::insert(diesel::select_table).into(diesel::insert_into_table);\n```\n\nI'm not sure that the dsl adds anything over the SQL unless it can generate the columns from the struct because (at least in postgres) you have to cast the select output into a table with an explicit column manifest/schema.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/322790014/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lancecarlson","id":107,"node_id":"MDQ6VXNlcjEwNw==","avatar_url":"https://avatars.githubusercontent.com/u/107?v=4","gravatar_id":"","url":"https://api.github.com/users/lancecarlson","html_url":"https://github.com/lancecarlson","followers_url":"https://api.github.com/users/lancecarlson/followers","following_url":"https://api.github.com/users/lancecarlson/following{/other_user}","gists_url":"https://api.github.com/users/lancecarlson/gists{/gist_id}","starred_url":"https://api.github.com/users/lancecarlson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lancecarlson/subscriptions","organizations_url":"https://api.github.com/users/lancecarlson/orgs","repos_url":"https://api.github.com/users/lancecarlson/repos","events_url":"https://api.github.com/users/lancecarlson/events{/privacy}","received_events_url":"https://api.github.com/users/lancecarlson/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/322817978","html_url":"https://github.com/diesel-rs/diesel/issues/1106#issuecomment-322817978","issue_url":"https://api.github.com/repos/diesel-rs/diesel/issues/1106","id":322817978,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjgxNzk3OA==","user":{"login":"killercup","id":20063,"node_id":"MDQ6VXNlcjIwMDYz","avatar_url":"https://avatars.githubusercontent.com/u/20063?v=4","gravatar_id":"","url":"https://api.github.com/users/killercup","html_url":"https://github.com/killercup","followers_url":"https://api.github.com/users/killercup/followers","following_url":"https://api.github.com/users/killercup/following{/other_user}","gists_url":"https://api.github.com/users/killercup/gists{/gist_id}","starred_url":"https://api.github.com/users/killercup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/killercup/subscriptions","organizations_url":"https://api.github.com/users/killercup/orgs","repos_url":"https://api.github.com/users/killercup/repos","events_url":"https://api.github.com/users/killercup/events{/privacy}","received_events_url":"https://api.github.com/users/killercup/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T15:57:42Z","updated_at":"2017-08-16T15:57:42Z","body":"If the tables have the exact same columns, you could try\r\n\r\n```rust\r\ndiesel::insert(table1::table.select(table1::all_columns)).into(table2::table)\r\n```","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/322817978/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"killercup","id":20063,"node_id":"MDQ6VXNlcjIwMDYz","avatar_url":"https://avatars.githubusercontent.com/u/20063?v=4","gravatar_id":"","url":"https://api.github.com/users/killercup","html_url":"https://github.com/killercup","followers_url":"https://api.github.com/users/killercup/followers","following_url":"https://api.github.com/users/killercup/following{/other_user}","gists_url":"https://api.github.com/users/killercup/gists{/gist_id}","starred_url":"https://api.github.com/users/killercup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/killercup/subscriptions","organizations_url":"https://api.github.com/users/killercup/orgs","repos_url":"https://api.github.com/users/killercup/repos","events_url":"https://api.github.com/users/killercup/events{/privacy}","received_events_url":"https://api.github.com/users/killercup/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/352214789","html_url":"https://github.com/diesel-rs/diesel/issues/1106#issuecomment-352214789","issue_url":"https://api.github.com/repos/diesel-rs/diesel/issues/1106","id":352214789,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MjIxNDc4OQ==","user":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-16T21:59:27Z","updated_at":"2017-12-16T21:59:27Z","body":"Update: https://github.com/diesel-rs/diesel/commit/73778af0 was very much in service of this eventual feature. Any version of this that lands will require explicitly listing the columns. e.g. We will not support `INSERT INTO table SELECT ...` but we will support `INSERT INTO table (col1, col2) SELECT ...`.\r\n\r\nI would love to see ideas on concrete API proposals for this. Right now the best I've got is:\r\n\r\n```rust\r\ninsert_into(table1)\r\n    .from_select(\r\n        (col1, col2, col3),\r\n        table2.select(...).etc,\r\n    )\r\n```\r\n\r\nI think we can do better though. In particular, I don't like the amount of rightward drift there. It reminds me very much of our old `on_conflict` function from 0.16, which we deprecated in 0.99 for the same ergonomic reasons","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/352214789/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1424412665,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDE0MjQ0MTI2NjU=","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/1424412665","actor":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2018-01-15T14:15:40Z","milestone":{"title":"1.2"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/357695254","html_url":"https://github.com/diesel-rs/diesel/issues/1106#issuecomment-357695254","issue_url":"https://api.github.com/repos/diesel-rs/diesel/issues/1106","id":357695254,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NzY5NTI1NA==","user":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-15T14:19:26Z","updated_at":"2018-01-15T14:19:26Z","body":"I think I'm going to go with this API:\r\n\r\n```\r\ninsert_into(table1)\r\n    .from_select(table2.select(...))\r\n    .into_columns((col1, col2, col3))\r\n```\r\n\r\nThe order is backwards from what you'd write in SQL, but it lets us default to `table1::all_columns`, and any method that allowed you to specify the columns doesn't make sense unless you know that you're inserting from a select statement.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/357695254/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/358127172","html_url":"https://github.com/diesel-rs/diesel/issues/1106#issuecomment-358127172","issue_url":"https://api.github.com/repos/diesel-rs/diesel/issues/1106","id":358127172,"node_id":"MDEyOklzc3VlQ29tbWVudDM1ODEyNzE3Mg==","user":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-16T22:20:06Z","updated_at":"2018-01-16T22:20:06Z","body":"So I prototyped this out, and found that the select statement generally was so long we had the same rightward drift problem. You can work around it by sticking stuff in locals, but then the variable is awkward to name and really \"you can work around this crappy API\" doesn't make it acceptable. @weiznich had a really good idea in the gitter room though. `select_statement.insert_into(table).columns(col_list)`, which is even more backwards from the SQL, but definitely lets you insert line breaks where it's natural. TBH this is also pretty close to how I read these queries anyway, since the select statement is by far the most important part.\r\n\r\nI'm going to play around with it some more, but I think I want to go with that API. The main issue will be making it discoverable. It'll have to end up being a trait that's implemented on `BoxedSelectStatement`, `SelectStatement`, and `Table` rather than an inherent method on `IncompleteInsertStatement`. I suppose linking to it from the docs, and adding a section to the insert guide will probably be sufficient.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/358127172/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1427164006,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTQyNzE2NDAwNg==","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/1427164006","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-01-16T22:20:06Z","performed_via_github_app":null},{"id":1427164007,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE0MjcxNjQwMDc=","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/1427164007","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-01-16T22:20:06Z","performed_via_github_app":null},{"id":1428783966,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDE0Mjg3ODM5NjY=","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/1428783966","actor":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"b484fe0de225f0e7f4089e01d85ab1962fd3628c","commit_url":"https://api.github.com/repos/diesel-rs/diesel/commits/b484fe0de225f0e7f4089e01d85ab1962fd3628c","created_at":"2018-01-17T17:38:24Z","performed_via_github_app":null},{"actor":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-17T17:39:30Z","updated_at":"2018-01-17T17:39:30Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/1486","repository_url":"https://api.github.com/repos/diesel-rs/diesel","labels_url":"https://api.github.com/repos/diesel-rs/diesel/issues/1486/labels{/name}","comments_url":"https://api.github.com/repos/diesel-rs/diesel/issues/1486/comments","events_url":"https://api.github.com/repos/diesel-rs/diesel/issues/1486/events","html_url":"https://github.com/diesel-rs/diesel/pull/1486","id":289352886,"node_id":"MDExOlB1bGxSZXF1ZXN0MTYzNTA3MTc3","number":1486,"title":"Remove `Changeset`","user":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2018-01-17T17:39:30Z","updated_at":"2018-01-17T20:34:08Z","closed_at":"2018-01-17T20:34:04Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":41609775,"node_id":"MDEwOlJlcG9zaXRvcnk0MTYwOTc3NQ==","name":"diesel","full_name":"diesel-rs/diesel","private":false,"owner":{"login":"diesel-rs","id":16763251,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE2NzYzMjUx","avatar_url":"https://avatars.githubusercontent.com/u/16763251?v=4","gravatar_id":"","url":"https://api.github.com/users/diesel-rs","html_url":"https://github.com/diesel-rs","followers_url":"https://api.github.com/users/diesel-rs/followers","following_url":"https://api.github.com/users/diesel-rs/following{/other_user}","gists_url":"https://api.github.com/users/diesel-rs/gists{/gist_id}","starred_url":"https://api.github.com/users/diesel-rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/diesel-rs/subscriptions","organizations_url":"https://api.github.com/users/diesel-rs/orgs","repos_url":"https://api.github.com/users/diesel-rs/repos","events_url":"https://api.github.com/users/diesel-rs/events{/privacy}","received_events_url":"https://api.github.com/users/diesel-rs/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/diesel-rs/diesel","description":"A safe, extensible ORM and Query Builder for Rust","fork":false,"url":"https://api.github.com/repos/diesel-rs/diesel","forks_url":"https://api.github.com/repos/diesel-rs/diesel/forks","keys_url":"https://api.github.com/repos/diesel-rs/diesel/keys{/key_id}","collaborators_url":"https://api.github.com/repos/diesel-rs/diesel/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/diesel-rs/diesel/teams","hooks_url":"https://api.github.com/repos/diesel-rs/diesel/hooks","issue_events_url":"https://api.github.com/repos/diesel-rs/diesel/issues/events{/number}","events_url":"https://api.github.com/repos/diesel-rs/diesel/events","assignees_url":"https://api.github.com/repos/diesel-rs/diesel/assignees{/user}","branches_url":"https://api.github.com/repos/diesel-rs/diesel/branches{/branch}","tags_url":"https://api.github.com/repos/diesel-rs/diesel/tags","blobs_url":"https://api.github.com/repos/diesel-rs/diesel/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/diesel-rs/diesel/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/diesel-rs/diesel/git/refs{/sha}","trees_url":"https://api.github.com/repos/diesel-rs/diesel/git/trees{/sha}","statuses_url":"https://api.github.com/repos/diesel-rs/diesel/statuses/{sha}","languages_url":"https://api.github.com/repos/diesel-rs/diesel/languages","stargazers_url":"https://api.github.com/repos/diesel-rs/diesel/stargazers","contributors_url":"https://api.github.com/repos/diesel-rs/diesel/contributors","subscribers_url":"https://api.github.com/repos/diesel-rs/diesel/subscribers","subscription_url":"https://api.github.com/repos/diesel-rs/diesel/subscription","commits_url":"https://api.github.com/repos/diesel-rs/diesel/commits{/sha}","git_commits_url":"https://api.github.com/repos/diesel-rs/diesel/git/commits{/sha}","comments_url":"https://api.github.com/repos/diesel-rs/diesel/comments{/number}","issue_comment_url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments{/number}","contents_url":"https://api.github.com/repos/diesel-rs/diesel/contents/{+path}","compare_url":"https://api.github.com/repos/diesel-rs/diesel/compare/{base}...{head}","merges_url":"https://api.github.com/repos/diesel-rs/diesel/merges","archive_url":"https://api.github.com/repos/diesel-rs/diesel/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/diesel-rs/diesel/downloads","issues_url":"https://api.github.com/repos/diesel-rs/diesel/issues{/number}","pulls_url":"https://api.github.com/repos/diesel-rs/diesel/pulls{/number}","milestones_url":"https://api.github.com/repos/diesel-rs/diesel/milestones{/number}","notifications_url":"https://api.github.com/repos/diesel-rs/diesel/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/diesel-rs/diesel/labels{/name}","releases_url":"https://api.github.com/repos/diesel-rs/diesel/releases{/id}","deployments_url":"https://api.github.com/repos/diesel-rs/diesel/deployments","created_at":"2015-08-29T22:51:00Z","updated_at":"2025-11-09T19:31:55Z","pushed_at":"2025-11-07T18:13:31Z","git_url":"git://github.com/diesel-rs/diesel.git","ssh_url":"git@github.com:diesel-rs/diesel.git","clone_url":"https://github.com/diesel-rs/diesel.git","svn_url":"https://github.com/diesel-rs/diesel","homepage":"https://diesel.rs","size":109357,"stargazers_count":13771,"watchers_count":13771,"language":"Rust","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":true,"forks_count":1168,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":153,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["mysql","orm","postgresql","query-builder","rust","sqlite"],"visibility":"public","forks":1168,"open_issues":153,"watchers":13771,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/diesel-rs/diesel/pulls/1486","html_url":"https://github.com/diesel-rs/diesel/pull/1486","diff_url":"https://github.com/diesel-rs/diesel/pull/1486.diff","patch_url":"https://github.com/diesel-rs/diesel/pull/1486.patch","merged_at":"2018-01-17T20:34:04Z"},"body":"This is a long overdue refactoring. I'm going to do a similar\r\nrefactoring for `InsertValues` as part of #1106, but this shares a lot\r\nof groundwork for that and is much smaller in scope. `Changeset` has\r\nalways been entirely redundant with `QueryFragment`, but we had to keep\r\nit as a separate trait for two places where the implementation changed:\r\n\r\n- `Eq` doesn't qualify the column name\r\n- tuples skip commas when `is_noop` returned true (for `Changeset` this\r\n  was only the case for `None` or a tuple where all elements were `None`)\r\n\r\nThe first one is easy to solve, we just return a type other than `Eq` in\r\n`AsChangeset` (there was very little reason to use `Eq` in the first\r\nplace. We weren't able to re-use any of its code.)\r\n\r\nThe second one is a bit trickier, since we need to replicate the\r\n`is_noop` method in `QueryFragment`. I'm fine with doing this, since\r\n`InsertValues` has the same method (and tuples implement `walk_ast`\r\nidentically for `InsertValues` and `Changeset`), so it makes sense to\r\nshare them.\r\n\r\nOriginally I added an explicit `noop` method to `AstPass` which we would\r\ncall. However, it felt weird that the impl for `()` which literally just\r\ndoes `Ok(())` didn't call `noop`. At that point I realized I could just\r\ngeneralize this to \"did a method that generates SQL get called?\" This\r\nworks fine for updates. I'm not 100% sure if it'll work for inserts, but\r\nit's worth a shot.\r\n\r\nI should note that the semantics of the new `is_noop` are slightly\r\ndifferent than the one on `InsertValues`, which explicitly states that\r\nan empty array will return `false`. This will make it return `true` when\r\nwe switch inserts to use this. Since we already have to explicitly\r\nhandle empty arrays long before we start checking `is_noop`, I think\r\nthat's fine.","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/1486/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/diesel-rs/diesel/issues/1486/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/358759577","html_url":"https://github.com/diesel-rs/diesel/issues/1106#issuecomment-358759577","issue_url":"https://api.github.com/repos/diesel-rs/diesel/issues/1106","id":358759577,"node_id":"MDEyOklzc3VlQ29tbWVudDM1ODc1OTU3Nw==","user":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-18T19:43:14Z","updated_at":"2018-01-18T19:43:14Z","body":"I ended up generalizing the API. The only API that is being explicitly added for this feature is the `into_columns` method, which only works for insert from select. Otherwise, passing a select statement to `values` will now \"just work\", and *any* query that can be written as `insert_into(table).values(values)` can instead be written as `values.insert_into(table)`","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/358759577/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1431413945,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDE0MzE0MTM5NDU=","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/1431413945","actor":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"bcd8074aec24658dc683a066ae669086681f6af5","commit_url":"https://api.github.com/repos/diesel-rs/diesel/commits/bcd8074aec24658dc683a066ae669086681f6af5","created_at":"2018-01-18T22:27:38Z","performed_via_github_app":null},{"actor":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-18T22:27:49Z","updated_at":"2018-01-18T22:27:49Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/1496","repository_url":"https://api.github.com/repos/diesel-rs/diesel","labels_url":"https://api.github.com/repos/diesel-rs/diesel/issues/1496/labels{/name}","comments_url":"https://api.github.com/repos/diesel-rs/diesel/issues/1496/comments","events_url":"https://api.github.com/repos/diesel-rs/diesel/issues/1496/events","html_url":"https://github.com/diesel-rs/diesel/pull/1496","id":289797922,"node_id":"MDExOlB1bGxSZXF1ZXN0MTYzODM4OTMx","number":1496,"title":"Add support for `INSERT INTO table (...) SELECT ...`","user":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2018-01-18T22:27:49Z","updated_at":"2018-01-20T20:47:14Z","closed_at":"2018-01-20T20:47:09Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":41609775,"node_id":"MDEwOlJlcG9zaXRvcnk0MTYwOTc3NQ==","name":"diesel","full_name":"diesel-rs/diesel","private":false,"owner":{"login":"diesel-rs","id":16763251,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE2NzYzMjUx","avatar_url":"https://avatars.githubusercontent.com/u/16763251?v=4","gravatar_id":"","url":"https://api.github.com/users/diesel-rs","html_url":"https://github.com/diesel-rs","followers_url":"https://api.github.com/users/diesel-rs/followers","following_url":"https://api.github.com/users/diesel-rs/following{/other_user}","gists_url":"https://api.github.com/users/diesel-rs/gists{/gist_id}","starred_url":"https://api.github.com/users/diesel-rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/diesel-rs/subscriptions","organizations_url":"https://api.github.com/users/diesel-rs/orgs","repos_url":"https://api.github.com/users/diesel-rs/repos","events_url":"https://api.github.com/users/diesel-rs/events{/privacy}","received_events_url":"https://api.github.com/users/diesel-rs/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/diesel-rs/diesel","description":"A safe, extensible ORM and Query Builder for Rust","fork":false,"url":"https://api.github.com/repos/diesel-rs/diesel","forks_url":"https://api.github.com/repos/diesel-rs/diesel/forks","keys_url":"https://api.github.com/repos/diesel-rs/diesel/keys{/key_id}","collaborators_url":"https://api.github.com/repos/diesel-rs/diesel/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/diesel-rs/diesel/teams","hooks_url":"https://api.github.com/repos/diesel-rs/diesel/hooks","issue_events_url":"https://api.github.com/repos/diesel-rs/diesel/issues/events{/number}","events_url":"https://api.github.com/repos/diesel-rs/diesel/events","assignees_url":"https://api.github.com/repos/diesel-rs/diesel/assignees{/user}","branches_url":"https://api.github.com/repos/diesel-rs/diesel/branches{/branch}","tags_url":"https://api.github.com/repos/diesel-rs/diesel/tags","blobs_url":"https://api.github.com/repos/diesel-rs/diesel/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/diesel-rs/diesel/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/diesel-rs/diesel/git/refs{/sha}","trees_url":"https://api.github.com/repos/diesel-rs/diesel/git/trees{/sha}","statuses_url":"https://api.github.com/repos/diesel-rs/diesel/statuses/{sha}","languages_url":"https://api.github.com/repos/diesel-rs/diesel/languages","stargazers_url":"https://api.github.com/repos/diesel-rs/diesel/stargazers","contributors_url":"https://api.github.com/repos/diesel-rs/diesel/contributors","subscribers_url":"https://api.github.com/repos/diesel-rs/diesel/subscribers","subscription_url":"https://api.github.com/repos/diesel-rs/diesel/subscription","commits_url":"https://api.github.com/repos/diesel-rs/diesel/commits{/sha}","git_commits_url":"https://api.github.com/repos/diesel-rs/diesel/git/commits{/sha}","comments_url":"https://api.github.com/repos/diesel-rs/diesel/comments{/number}","issue_comment_url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments{/number}","contents_url":"https://api.github.com/repos/diesel-rs/diesel/contents/{+path}","compare_url":"https://api.github.com/repos/diesel-rs/diesel/compare/{base}...{head}","merges_url":"https://api.github.com/repos/diesel-rs/diesel/merges","archive_url":"https://api.github.com/repos/diesel-rs/diesel/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/diesel-rs/diesel/downloads","issues_url":"https://api.github.com/repos/diesel-rs/diesel/issues{/number}","pulls_url":"https://api.github.com/repos/diesel-rs/diesel/pulls{/number}","milestones_url":"https://api.github.com/repos/diesel-rs/diesel/milestones{/number}","notifications_url":"https://api.github.com/repos/diesel-rs/diesel/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/diesel-rs/diesel/labels{/name}","releases_url":"https://api.github.com/repos/diesel-rs/diesel/releases{/id}","deployments_url":"https://api.github.com/repos/diesel-rs/diesel/deployments","created_at":"2015-08-29T22:51:00Z","updated_at":"2025-11-09T19:31:55Z","pushed_at":"2025-11-07T18:13:31Z","git_url":"git://github.com/diesel-rs/diesel.git","ssh_url":"git@github.com:diesel-rs/diesel.git","clone_url":"https://github.com/diesel-rs/diesel.git","svn_url":"https://github.com/diesel-rs/diesel","homepage":"https://diesel.rs","size":109357,"stargazers_count":13771,"watchers_count":13771,"language":"Rust","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":true,"forks_count":1168,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":153,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["mysql","orm","postgresql","query-builder","rust","sqlite"],"visibility":"public","forks":1168,"open_issues":153,"watchers":13771,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/diesel-rs/diesel/pulls/1496","html_url":"https://github.com/diesel-rs/diesel/pull/1496","diff_url":"https://github.com/diesel-rs/diesel/pull/1496.diff","patch_url":"https://github.com/diesel-rs/diesel/pull/1496.patch","merged_at":"2018-01-20T20:47:09Z"},"body":"This feature has been in the works for a very long time, and has a lot\r\nof context... I've added headers so if you already know about the\r\niteration of the API and the evolution of `InsertStatement` internally,\r\nskip to the third section.\r\n\r\nGetting to this API\r\n===\r\n\r\nI'd like to give a bit of context on the APIs that have been considered,\r\nand how I landed on this one.\r\n\r\nTo preface, all of the iterations around this have been trying to\r\ncarefully balance three things:\r\n\r\n- Easy to discover in the API\r\n- Being syntactically close to the generated SQL\r\n- Avoiding rightward drift\r\n\r\nFor most of Diesel's life, our API was `insert(values).into(table)`.\r\nThat API was originally introduced in 0.2 \"to mirror `update` and\r\n`delete` (it didn't mirror them. It was backwards. It's always been\r\nbackwards).\r\n\r\nMy main concern with the old API actually was related to this feature.\r\nI couldn't come up with a decent API that had you specify the column\r\nlist (you basically always need to specify the column list for this\r\nfeature).\r\n\r\nSo in 0.99 we changed it to what we have now, and I had toyed around\r\nwith `insert_into(table).columns(columns).values(select)`, as well as\r\n`insert_into(table).from_select(columns, select)`. I was leaning towards\r\nthe second one for a while (I didn't realize at the time that it was\r\nexactly SQLAlchemy's API). I hated the `columns` method because it was\r\nunclear what it was doing until you saw you were inserting from a select\r\nstatement. It also implied an interaction with tuples that didn't exist.\r\n\r\nHowever, another thing that happened in 0.99 was that we deprecated our\r\nold upsert API. The `from_select` form reminded me far too much of the\r\nold `on_conflict` API, which we had just removed. In practice what that\r\nAPI would give you was something like this:\r\n\r\n```rust\r\ninsert_into(posts::table)\r\n    .from_select(\r\n        (posts::user_id, posts::title),\r\n        users::table\r\n            .select((\r\n                users::id,\r\n                users::name.concat(\"'s First Post\"),\r\n            )),\r\n    )\r\n```\r\n\r\nThat's just far too much rightward drift for me. Yes, you can assign the\r\nargs to local variables, but they're awkward to name and now your code\r\nreads weird. I thought moving the columns list to another method call\r\nwould help, but it doesn't.\r\n\r\n```rust\r\ninsert_into(posts::table)\r\n    .from_select(\r\n        users::table\r\n            .select((\r\n                users::id,\r\n                users::name.concat(\"'s First Post\"),\r\n            )),\r\n    )\r\n    .into_columns((posts::user_id, posts::title))\r\n```\r\n\r\nEventually a member of the Diesel team had the idea of making this an\r\n`insert_into` method on select statements. This solves all of my\r\nconcerns around rightward drift, though at the cost of the other two\r\npriorities. The API now looked like this:\r\n\r\n```\r\nusers::table\r\n    .select((\r\n        users::id,\r\n        users::name.concat(\"'s First Post\"),\r\n    ))\r\n    .insert_into(posts::table)\r\n    .into_columns((posts::user_id, posts::title))\r\n```\r\n\r\nI liked the way the code flowed, but I had concerns around\r\ndiscoverability, and didn't like how backwards it was from SQL. But I\r\ncould live with it and started implementing.\r\n\r\nUp until this point I had been assuming that we would have an\r\n`InsertFromSelectStatement` struct, which was distinct from\r\n`InsertStatement` and necessitated the differently named methods. I\r\nrealized when I started digging into it though, that we really just want\r\nto re-use `InsertStatement` for this. It seems obvious in hindsight.\r\n\r\nAnd if we were going to use that structure, that meant that it wouldn't\r\nbe much harder to just make passing `SelectStatement` to `values` work.\r\nThis automatically solves most of my concerns around discoverability,\r\nsince it now just works exactly like every other form of insert.\r\n\r\nThat said, I really don't like the rightward drift. I liked the\r\n`.insert_into` form for being able to avoid that. But for the final\r\nimplementation, I just generalized that feature. *Anything* that can be\r\nwritten as `insert_into(table).values(values)` can now be written as\r\n`values.insert_into(table)`.\r\n\r\nContext around InsertStatement\r\n===\r\n\r\nThis file has churned more than just about any other part of Diesel. I\r\nfeel like I've re-written it nearly every release at this point. I think\r\nthe reason it's churned so much is for two reasons. The first is that\r\nit's kept a fundamental design flaw through 1.1 (which I'll get to), and\r\nwe've been constantly working around it. The second is that `INSERT` is\r\nactually one of the most complex queries in SQL. It has less variations\r\nthan `SELECT`, but far more of its variations are backend specific, or\r\nhave different syntaxes between backends.\r\n\r\n`InsertStatement` was originally added for 0.2 in c9894b35 which has a\r\nvery helpful commit message \"WIP\" (good job past Sean). At the time we\r\nonly supported PG, so we actually had two versions -- `InsertStatement`\r\nand `InsertQuery`, the latter having a returning clause. I'm honestly\r\nnot sure why I didn't do the `ReturningClause<T>` `NoReturningClause`\r\ndance we do now and did back then in `SelectStatement`. Maybe I thought\r\nit'd be easier?\r\n\r\nAnyway this file had to go through some pretty major changes in 0.5 when\r\nwe added SQLite support. We needed to disallow batch insert and\r\nreturning clauses on that backend. Additionally, the way we handle\r\ndefault values had to work differently on SQLite since it doesn't\r\nsupport the `DEFAULT` keyword.\r\n\r\nAt this point though, it still a few things. The query starts with\r\n`INSERT INTO`, had a columns list, then the word `VALUES` and then some\r\nvalues. It also managed all parenthesis. (Yes it was trivial to make it\r\ngenerate invalid SQL at that point).\r\n\r\nFast forward to 0.9, I decided to support batch insert on SQLite. This\r\nneeds to do one query per row, and I felt that meant we needed a\r\nseparate struct. I didn't want to have `BatchInsertStatement` and\r\n`BatchInsertQuery` and `InsertStatement` and `InsertQuery`, so we got\r\nthe `NoReturningClause` struct, and got a little closer to how literally\r\nevery other part of Diesel works.\r\n\r\nIn 0.14 we added `insert_default_values` which left us with\r\n`InsertStatement`, `BatchInsertStatement`, and `DefaultInsertStatement`,\r\nwhich eventually went back down to the two.\r\n\r\nThe last time the file went through a big rewrite was in 0.99 when I\r\nfinally unified it down to the one struct we have today.\r\n\r\nHowever, it still had the fatal flaw I mentioned earlier. It was trying\r\nto handle too much logic, and was too disjoint from the rest of the\r\nquery builder. It assumed that the two forms were `DEFAULT VALUES` or\r\n`(columns) VALUES ...`, and also handled parens.\r\n\r\nWe've gone through a lot of refactoring to get rid of that. I finally\r\nthink this struct is at a point where it will stop churning, mostly\r\nbecause it looks like the rest of Diesel now. It doesn't do anything at\r\nall, and the only thing it assumes is that the word `INTO` appears in\r\nthe query (which I'm pretty sure actually is true).\r\n\r\nThe actual implementation of this commit\r\n====\r\n\r\nWith all that said, this commit is relatively simple. The main addition\r\nis the `InsertFromSelect` struct. It's definitely a Diesel struct, in\r\nthat it basically does nothing, and all the logic is in its `where`\r\nclauses.\r\n\r\nI tried to make `Insertable` work roughly everywhere that methods like\r\n`filter` work. I couldn't actually do a blanket impl for tables in Rust\r\nitself, because it made rustc vomit on recursion with our impls on\r\n`Option`. That shouldn't be happening, but I suspect it's a lot of work\r\nto fix that in the language.\r\n\r\nI've also implemented it for references, since most of the time that you\r\npass values to `.values`, you pass a reference. That should \"just work\"\r\nhere unless we have a good reason not to.\r\n\r\nThe majority of the additions here are tests. This is a feature that\r\nfundamentally interacts with many of our most complex features, and I've\r\ntried to be exhaustive. Theres ~3 lines of tests for every line of code\r\nadded. I've done at least a minimal test of this feature's interaction\r\nwith every other feature on inserts that I could think of. I am not so\r\nmuch worried about whether they work, but I was worried about if there\r\nwas a syntactic edge case I didn't know about. There weren't. Same with\r\nthe compile tests, I've tried to think of every way the feature could be\r\naccidentally misused (bad arguments to `into_columns` basically), as\r\nwell as all the nonsense things we should make sure don't work (putting\r\nit in a tuple or vec).\r\n\r\nI didn't add any compile tests on making sure that the select statement\r\nitself is valid. The fact that the `Query` bound only matches valid\r\ncomplete select statements is already very well tested, and we don't\r\nneed to re-test that here. I also did not explicitly disallow selecting\r\nfrom the same table as the insert, as this appears to be one of the few\r\nplaces where the table can appear twice with no ambiguity.\r\n\r\nFixes #1106","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/1496/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/diesel-rs/diesel/issues/1496/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":1433835725,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDE0MzM4MzU3MjU=","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/1433835725","actor":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"dcc642df47f4d91aca98c155d9876ad894602590","commit_url":"https://api.github.com/repos/diesel-rs/diesel/commits/dcc642df47f4d91aca98c155d9876ad894602590","created_at":"2018-01-20T20:46:58Z","performed_via_github_app":null},{"id":1433835759,"node_id":"MDExOkNsb3NlZEV2ZW50MTQzMzgzNTc1OQ==","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/1433835759","actor":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2018-01-20T20:47:09Z","state_reason":null,"performed_via_github_app":null},{"actor":{"login":"SadiinsoSnowfall","id":32017313,"node_id":"MDQ6VXNlcjMyMDE3MzEz","avatar_url":"https://avatars.githubusercontent.com/u/32017313?v=4","gravatar_id":"","url":"https://api.github.com/users/SadiinsoSnowfall","html_url":"https://github.com/SadiinsoSnowfall","followers_url":"https://api.github.com/users/SadiinsoSnowfall/followers","following_url":"https://api.github.com/users/SadiinsoSnowfall/following{/other_user}","gists_url":"https://api.github.com/users/SadiinsoSnowfall/gists{/gist_id}","starred_url":"https://api.github.com/users/SadiinsoSnowfall/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SadiinsoSnowfall/subscriptions","organizations_url":"https://api.github.com/users/SadiinsoSnowfall/orgs","repos_url":"https://api.github.com/users/SadiinsoSnowfall/repos","events_url":"https://api.github.com/users/SadiinsoSnowfall/events{/privacy}","received_events_url":"https://api.github.com/users/SadiinsoSnowfall/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-04T11:27:54Z","updated_at":"2022-03-04T11:27:54Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/3067","repository_url":"https://api.github.com/repos/diesel-rs/diesel","labels_url":"https://api.github.com/repos/diesel-rs/diesel/issues/3067/labels{/name}","comments_url":"https://api.github.com/repos/diesel-rs/diesel/issues/3067/comments","events_url":"https://api.github.com/repos/diesel-rs/diesel/issues/3067/events","html_url":"https://github.com/diesel-rs/diesel/issues/3067","id":1159543309,"node_id":"I_kwDOAnrqL85FHToN","number":3067,"title":"Support passing values to `select(fields...)` for `insert into ... select from`","user":{"login":"SadiinsoSnowfall","id":32017313,"node_id":"MDQ6VXNlcjMyMDE3MzEz","avatar_url":"https://avatars.githubusercontent.com/u/32017313?v=4","gravatar_id":"","url":"https://api.github.com/users/SadiinsoSnowfall","html_url":"https://github.com/SadiinsoSnowfall","followers_url":"https://api.github.com/users/SadiinsoSnowfall/followers","following_url":"https://api.github.com/users/SadiinsoSnowfall/following{/other_user}","gists_url":"https://api.github.com/users/SadiinsoSnowfall/gists{/gist_id}","starred_url":"https://api.github.com/users/SadiinsoSnowfall/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SadiinsoSnowfall/subscriptions","organizations_url":"https://api.github.com/users/SadiinsoSnowfall/orgs","repos_url":"https://api.github.com/users/SadiinsoSnowfall/repos","events_url":"https://api.github.com/users/SadiinsoSnowfall/events{/privacy}","received_events_url":"https://api.github.com/users/SadiinsoSnowfall/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":254193212,"node_id":"MDU6TGFiZWwyNTQxOTMyMTI=","url":"https://api.github.com/repos/diesel-rs/diesel/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-03-04T11:27:54Z","updated_at":"2022-03-04T12:12:05Z","closed_at":"2022-03-04T12:12:05Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":41609775,"node_id":"MDEwOlJlcG9zaXRvcnk0MTYwOTc3NQ==","name":"diesel","full_name":"diesel-rs/diesel","private":false,"owner":{"login":"diesel-rs","id":16763251,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE2NzYzMjUx","avatar_url":"https://avatars.githubusercontent.com/u/16763251?v=4","gravatar_id":"","url":"https://api.github.com/users/diesel-rs","html_url":"https://github.com/diesel-rs","followers_url":"https://api.github.com/users/diesel-rs/followers","following_url":"https://api.github.com/users/diesel-rs/following{/other_user}","gists_url":"https://api.github.com/users/diesel-rs/gists{/gist_id}","starred_url":"https://api.github.com/users/diesel-rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/diesel-rs/subscriptions","organizations_url":"https://api.github.com/users/diesel-rs/orgs","repos_url":"https://api.github.com/users/diesel-rs/repos","events_url":"https://api.github.com/users/diesel-rs/events{/privacy}","received_events_url":"https://api.github.com/users/diesel-rs/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/diesel-rs/diesel","description":"A safe, extensible ORM and Query Builder for Rust","fork":false,"url":"https://api.github.com/repos/diesel-rs/diesel","forks_url":"https://api.github.com/repos/diesel-rs/diesel/forks","keys_url":"https://api.github.com/repos/diesel-rs/diesel/keys{/key_id}","collaborators_url":"https://api.github.com/repos/diesel-rs/diesel/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/diesel-rs/diesel/teams","hooks_url":"https://api.github.com/repos/diesel-rs/diesel/hooks","issue_events_url":"https://api.github.com/repos/diesel-rs/diesel/issues/events{/number}","events_url":"https://api.github.com/repos/diesel-rs/diesel/events","assignees_url":"https://api.github.com/repos/diesel-rs/diesel/assignees{/user}","branches_url":"https://api.github.com/repos/diesel-rs/diesel/branches{/branch}","tags_url":"https://api.github.com/repos/diesel-rs/diesel/tags","blobs_url":"https://api.github.com/repos/diesel-rs/diesel/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/diesel-rs/diesel/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/diesel-rs/diesel/git/refs{/sha}","trees_url":"https://api.github.com/repos/diesel-rs/diesel/git/trees{/sha}","statuses_url":"https://api.github.com/repos/diesel-rs/diesel/statuses/{sha}","languages_url":"https://api.github.com/repos/diesel-rs/diesel/languages","stargazers_url":"https://api.github.com/repos/diesel-rs/diesel/stargazers","contributors_url":"https://api.github.com/repos/diesel-rs/diesel/contributors","subscribers_url":"https://api.github.com/repos/diesel-rs/diesel/subscribers","subscription_url":"https://api.github.com/repos/diesel-rs/diesel/subscription","commits_url":"https://api.github.com/repos/diesel-rs/diesel/commits{/sha}","git_commits_url":"https://api.github.com/repos/diesel-rs/diesel/git/commits{/sha}","comments_url":"https://api.github.com/repos/diesel-rs/diesel/comments{/number}","issue_comment_url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments{/number}","contents_url":"https://api.github.com/repos/diesel-rs/diesel/contents/{+path}","compare_url":"https://api.github.com/repos/diesel-rs/diesel/compare/{base}...{head}","merges_url":"https://api.github.com/repos/diesel-rs/diesel/merges","archive_url":"https://api.github.com/repos/diesel-rs/diesel/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/diesel-rs/diesel/downloads","issues_url":"https://api.github.com/repos/diesel-rs/diesel/issues{/number}","pulls_url":"https://api.github.com/repos/diesel-rs/diesel/pulls{/number}","milestones_url":"https://api.github.com/repos/diesel-rs/diesel/milestones{/number}","notifications_url":"https://api.github.com/repos/diesel-rs/diesel/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/diesel-rs/diesel/labels{/name}","releases_url":"https://api.github.com/repos/diesel-rs/diesel/releases{/id}","deployments_url":"https://api.github.com/repos/diesel-rs/diesel/deployments","created_at":"2015-08-29T22:51:00Z","updated_at":"2025-11-09T19:31:55Z","pushed_at":"2025-11-07T18:13:31Z","git_url":"git://github.com/diesel-rs/diesel.git","ssh_url":"git@github.com:diesel-rs/diesel.git","clone_url":"https://github.com/diesel-rs/diesel.git","svn_url":"https://github.com/diesel-rs/diesel","homepage":"https://diesel.rs","size":109357,"stargazers_count":13771,"watchers_count":13771,"language":"Rust","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":true,"forks_count":1168,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":153,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["mysql","orm","postgresql","query-builder","rust","sqlite"],"visibility":"public","forks":1168,"open_issues":153,"watchers":13771,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"The issue #1106 and then the PR #1496 added support for this kind of request : \r\n```sql\r\nINSERT INTO the_table (id, name, description)\r\n    SELECT id + 1, name, description FROM the_table\r\n```\r\nUsing this construct : \r\n```rust\r\ntable! (\r\n    the_table {\r\n        id -> Integer,\r\n        name -> Text,\r\n        description -> Text,\r\n    }\r\n);\r\n\r\ndiesel::insert_into(the_table)\r\n    .values(the_table.select(id + 1, name, description))\r\n    .execute(conn);\r\n```\r\nHowever, it is not possible to re-create this following query using Diesel:\r\n```sql\r\nINSERT INTO the_table (id, name, description)\r\n    SELECT 55, name, description FROM the_table\r\n```\r\n```rust\r\ndiesel::insert_into(the_table)\r\n    .values(the_table.select(55, name, description))\r\n    .execute(conn);\r\n```\r\nThis rust code produce the following errors:\r\n```\r\nthe trait bound `{integer}: diesel::Expression` is not satisfied\r\nthe trait bound `{integer}: SelectableExpression<the_table::table>` is not satisfied\r\nthe trait bound `{integer}: NonAggregate` is not satisfied\r\n```\r\n\r\nWould it be possible to support passing direct values to `select(...)` in order to support this kind of SQL query ?","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/3067/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/diesel-rs/diesel/issues/3067/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"}]