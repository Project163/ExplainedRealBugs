{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/4606","repository_url":"https://api.github.com/repos/diesel-rs/diesel","labels_url":"https://api.github.com/repos/diesel-rs/diesel/issues/4606/labels{/name}","comments_url":"https://api.github.com/repos/diesel-rs/diesel/issues/4606/comments","events_url":"https://api.github.com/repos/diesel-rs/diesel/issues/4606/events","html_url":"https://github.com/diesel-rs/diesel/issues/4606","id":3079566705,"node_id":"I_kwDOAnrqL863jnVx","number":4606,"title":"No compile error on count distinct","user":{"login":"omid","id":45714,"node_id":"MDQ6VXNlcjQ1NzE0","avatar_url":"https://avatars.githubusercontent.com/u/45714?v=4","gravatar_id":"","url":"https://api.github.com/users/omid","html_url":"https://github.com/omid","followers_url":"https://api.github.com/users/omid/followers","following_url":"https://api.github.com/users/omid/following{/other_user}","gists_url":"https://api.github.com/users/omid/gists{/gist_id}","starred_url":"https://api.github.com/users/omid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omid/subscriptions","organizations_url":"https://api.github.com/users/omid/orgs","repos_url":"https://api.github.com/users/omid/repos","events_url":"https://api.github.com/users/omid/events{/privacy}","received_events_url":"https://api.github.com/users/omid/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":254193212,"node_id":"MDU6TGFiZWwyNTQxOTMyMTI=","url":"https://api.github.com/repos/diesel-rs/diesel/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":254193215,"node_id":"MDU6TGFiZWwyNTQxOTMyMTU=","url":"https://api.github.com/repos/diesel-rs/diesel/labels/help%20wanted","name":"help wanted","color":"159818","default":true,"description":null},{"id":292827048,"node_id":"MDU6TGFiZWwyOTI4MjcwNDg=","url":"https://api.github.com/repos/diesel-rs/diesel/labels/hole%20in%20api","name":"hole in api","color":"eb6420","default":false,"description":null},{"id":536100334,"node_id":"MDU6TGFiZWw1MzYxMDAzMzQ=","url":"https://api.github.com/repos/diesel-rs/diesel/labels/postgres","name":"postgres","color":"c5def5","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2025-05-21T09:28:22Z","updated_at":"2025-05-24T07:12:22Z","closed_at":"2025-05-24T07:12:22Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\nIf you want to report a bug, we added some points below which help us track down the problem faster.\n-->\n\n## Setup\n\n### Versions\n\n- **Rust:** 1.87\n- **Diesel:** 2.2.10 (Also diesel_async 0.5.2)\n- **Database:** PostgreSQL\n- **Operating System:** Linux\n\n### Feature Flags\n\n- **diesel:** \"postgres\", \"chrono\", \"serde_json\", \"uuid\"\n\n## Problem Description\nI expected to see compile time error for a wrong query, but didn't!\n\n### What are you trying to accomplish?\nI had a `distinct_on` query and later added a `count` to it. It's wrong, but the code compiles happily!\n\n### What is the expected output?\nTo see compile time error.\n\n### What is the actual output?\nNo error at compile time.\n\n### Are you seeing any additional errors?\n\n\n### Steps to reproduce\n\nI expected to see an error for this.\n```\nposts::table\n        .filter(posts::status.eq(status))\n        .distinct_on(posts::user_id)\n        .order_by(posts::user_id)\n        .count()\n        .get_result(conn)\n        .await\n```\n\nI know the right query is this, that's not the bug report\n```\nposts::table\n        .filter(posts::status.eq(status))\n        .select(count_distinct(posts::user_id))\n        .get_result(conn)\n        .await\n```\n<!--\nPlease include as much of your codebase as needed to reproduce the error.  If the relevant files are large, please consider linking to a public repository or a [Gist](https://gist.github.com/). This includes normally the following parts:\n\n* The exact code where your hit the problem\n* Relevant parts your schema, so any `table!` macro calls required for\n* Any other type definitions involved in the code, which produces your problem\n-->\n\n## Checklist\n\n- [x] I have already looked over the [issue tracker](https://github.com/diesel-rs/diesel/issues) and the [discussion forum](https://github.com/diesel-rs/diesel/discussions) for similar possible closed issues.\n<!--\nIf you are unsure if your issue is a duplicate of an existing issue please link the issue in question here\n--> \n- [x] This issue can be reproduced on Rust's stable channel. (Your issue will be\n  closed if this is not the case)\n- [x] This issue can be reproduced without requiring a third party crate\n\n<!--\nThank you for your submission!  You're helping make Diesel more robust ðŸŽ‰\n\nWe'll try to respond as quickly as possible.\n-->\n","closed_by":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/4606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/diesel-rs/diesel/issues/4606/timeline","performed_via_github_app":null,"state_reason":"completed"}