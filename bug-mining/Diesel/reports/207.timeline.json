[{"id":2729399705,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDI3MjkzOTk3MDU=","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/2729399705","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2019-10-21T12:06:09Z","milestone":{"title":"2.0"},"performed_via_github_app":null},{"id":2729417891,"node_id":"MDE3OkRlbWlsZXN0b25lZEV2ZW50MjcyOTQxNzg5MQ==","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/2729417891","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"demilestoned","commit_id":null,"commit_url":null,"created_at":"2019-10-21T12:12:44Z","milestone":{"title":"2.0"},"performed_via_github_app":null},{"id":2729418362,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDI3Mjk0MTgzNjI=","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/2729418362","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2019-10-21T12:12:54Z","milestone":{"title":"2.0"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/544489062","html_url":"https://github.com/diesel-rs/diesel/issues/2203#issuecomment-544489062","issue_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2203","id":544489062,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NDQ4OTA2Mg==","user":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-21T12:20:51Z","updated_at":"2019-10-21T12:20:51Z","body":"Please not that this behaviour was not introduced in that PR, the query does just not check the corresponding search path.\r\nI think it should be not that hard to fix issue. Basically we only need to add way to have a optional schema/search path for custom types. Otherwise public will be assumed as search patch. Fortunately the next release will be 2.0 so we are able to tweak the API a bit here.\r\n\r\nSteps to implement this change:\r\n* Change [`PgMetadataLookup::lookup_type`](https://github.com/diesel-rs/diesel/blob/8396134f1fb581529070de0b2a946f1c7d5f9e91/diesel/src/pg/metadata_lookup.rs#L25) to have a additional optional parameter for the schema name.\r\n* Adjust [this](https://github.com/diesel-rs/diesel/blob/8396134f1fb581529070de0b2a946f1c7d5f9e91/diesel/src/pg/metadata_lookup.rs#L30-L34) query to use that optional schema name.\r\n* Change [`PgMetadataCache`](https://github.com/diesel-rs/diesel/blob/8396134f1fb581529070de0b2a946f1c7d5f9e91/diesel/src/pg/metadata_lookup.rs#L44) to store also the schema name.\r\n* Change the [`SqlType` derive](https://github.com/diesel-rs/diesel/blob/8396134f1fb581529070de0b2a946f1c7d5f9e91/diesel_derives/src/sql_type.rs#L90-L140) to have an optional schema parameter (basically like the type_name parameter, but optional) and pass it [here](https://github.com/diesel-rs/diesel/blob/8396134f1fb581529070de0b2a946f1c7d5f9e91/diesel_derives/src/sql_type.rs#L124) to the changed lookup function.\r\n* Add a test case to [this file](https://github.com/diesel-rs/diesel/blob/8396134f1fb581529070de0b2a946f1c7d5f9e91/diesel_tests/tests/custom_types.rs)","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/544489062/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2729442384,"node_id":"MDEyOkxhYmVsZWRFdmVudDI3Mjk0NDIzODQ=","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/2729442384","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-10-21T12:21:03Z","label":{"name":"help wanted","color":"159818"},"performed_via_github_app":null},{"id":2729442386,"node_id":"MDEyOkxhYmVsZWRFdmVudDI3Mjk0NDIzODY=","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/2729442386","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-10-21T12:21:03Z","label":{"name":"mentoring available","color":"0e8a16"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/557150039","html_url":"https://github.com/diesel-rs/diesel/issues/2203#issuecomment-557150039","issue_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2203","id":557150039,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NzE1MDAzOQ==","user":{"login":"Boscop","id":535593,"node_id":"MDQ6VXNlcjUzNTU5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/535593?v=4","gravatar_id":"","url":"https://api.github.com/users/Boscop","html_url":"https://github.com/Boscop","followers_url":"https://api.github.com/users/Boscop/followers","following_url":"https://api.github.com/users/Boscop/following{/other_user}","gists_url":"https://api.github.com/users/Boscop/gists{/gist_id}","starred_url":"https://api.github.com/users/Boscop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Boscop/subscriptions","organizations_url":"https://api.github.com/users/Boscop/orgs","repos_url":"https://api.github.com/users/Boscop/repos","events_url":"https://api.github.com/users/Boscop/events{/privacy}","received_events_url":"https://api.github.com/users/Boscop/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-21T15:58:55Z","updated_at":"2019-11-21T15:59:58Z","body":"> - Change the SqlType derive to have an optional schema parameter (basically like the type_name parameter, but optional) and pass it here to the changed lookup function.\r\n\r\n@weiznich But wouldn't that hardcode the schema at compile-time, so that that custom type only works in that one schema? \r\nThat wouldn't solve our problem, we are using the same enum type in multiple schemas that are created at runtime based on user input (but structurally the same for all tables).\r\nSo the set of schemas that the enum type will be used in is not fixed/known at compile-time.\r\nIt needs to do the lookup based on the current `search_path` at runtime!","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/557150039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Boscop","id":535593,"node_id":"MDQ6VXNlcjUzNTU5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/535593?v=4","gravatar_id":"","url":"https://api.github.com/users/Boscop","html_url":"https://github.com/Boscop","followers_url":"https://api.github.com/users/Boscop/followers","following_url":"https://api.github.com/users/Boscop/following{/other_user}","gists_url":"https://api.github.com/users/Boscop/gists{/gist_id}","starred_url":"https://api.github.com/users/Boscop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Boscop/subscriptions","organizations_url":"https://api.github.com/users/Boscop/orgs","repos_url":"https://api.github.com/users/Boscop/repos","events_url":"https://api.github.com/users/Boscop/events{/privacy}","received_events_url":"https://api.github.com/users/Boscop/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2820204747,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjgyMDIwNDc0Nw==","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/2820204747","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-11-21T15:58:56Z","performed_via_github_app":null},{"id":2820204750,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI4MjAyMDQ3NTA=","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/2820204750","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-11-21T15:58:56Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/557153881","html_url":"https://github.com/diesel-rs/diesel/issues/2203#issuecomment-557153881","issue_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2203","id":557153881,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NzE1Mzg4MQ==","user":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-21T16:07:16Z","updated_at":"2019-11-21T16:07:16Z","body":"If you have \"the same\" type in multiple schema they remain different types. You wouldn't consider the same rust type definitions in different modules to be resolved to the same type, right?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/557153881/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/557170722","html_url":"https://github.com/diesel-rs/diesel/issues/2203#issuecomment-557170722","issue_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2203","id":557170722,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NzE3MDcyMg==","user":{"login":"Boscop","id":535593,"node_id":"MDQ6VXNlcjUzNTU5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/535593?v=4","gravatar_id":"","url":"https://api.github.com/users/Boscop","html_url":"https://github.com/Boscop","followers_url":"https://api.github.com/users/Boscop/followers","following_url":"https://api.github.com/users/Boscop/following{/other_user}","gists_url":"https://api.github.com/users/Boscop/gists{/gist_id}","starred_url":"https://api.github.com/users/Boscop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Boscop/subscriptions","organizations_url":"https://api.github.com/users/Boscop/orgs","repos_url":"https://api.github.com/users/Boscop/repos","events_url":"https://api.github.com/users/Boscop/events{/privacy}","received_events_url":"https://api.github.com/users/Boscop/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-21T16:44:00Z","updated_at":"2019-11-21T16:44:00Z","body":"@weiznich It's static definition vs dynamic instances. Like having 1 struct and multiple instances at runtime. We have 1 \"schema\" (in the sense of a set of schemas for a set of tables) and multiple instances at runtime (multiple pg schemas). \r\nBeing able to \"mount\" one of these instances to a set of static types (that represent this \"schema\") based on the `search_path` is a valid use case IMO. \r\nAt least it's our use case (multi-tenant system with one schema instance per tenant).\r\nWould it be possible to accommodate this use case in Diesel or do you think it'd be too disruptive / inefficient?","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/557170722/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Boscop","id":535593,"node_id":"MDQ6VXNlcjUzNTU5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/535593?v=4","gravatar_id":"","url":"https://api.github.com/users/Boscop","html_url":"https://github.com/Boscop","followers_url":"https://api.github.com/users/Boscop/followers","following_url":"https://api.github.com/users/Boscop/following{/other_user}","gists_url":"https://api.github.com/users/Boscop/gists{/gist_id}","starred_url":"https://api.github.com/users/Boscop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Boscop/subscriptions","organizations_url":"https://api.github.com/users/Boscop/orgs","repos_url":"https://api.github.com/users/Boscop/repos","events_url":"https://api.github.com/users/Boscop/events{/privacy}","received_events_url":"https://api.github.com/users/Boscop/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2820373717,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjgyMDM3MzcxNw==","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/2820373717","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-11-21T16:44:00Z","performed_via_github_app":null},{"id":2820373736,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI4MjAzNzM3MzY=","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/2820373736","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-11-21T16:44:00Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/557174231","html_url":"https://github.com/diesel-rs/diesel/issues/2203#issuecomment-557174231","issue_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2203","id":557174231,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NzE3NDIzMQ==","user":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-21T16:51:42Z","updated_at":"2019-11-21T16:51:42Z","body":"If you have the \"same\" types in different schemas that's only a interpretation added on top of the actual types. It's nothing we can infer (because matching by name/whatever will fail for constructed edge cases). That means it will be never something that will be supported by diesel out of the box in my opinion. That said it should be possible to support such an setup by implementing some things manually.\r\nThe probably easiest way to do that with the latest released diesel version is to just set the search schema dynamically by just calling `SELECT pg_catalog.set_config('search_path', 'your_schema', false);`.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/557174231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/568046542","html_url":"https://github.com/diesel-rs/diesel/issues/2203#issuecomment-568046542","issue_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2203","id":568046542,"node_id":"MDEyOklzc3VlQ29tbWVudDU2ODA0NjU0Mg==","user":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-20T19:02:54Z","updated_at":"2019-12-20T19:02:54Z","body":"One thing that's important to note is that getting the current search_path requires a round trip to the database, which defeats the purpose of caching the result in the first place. I'm not sure what the right answer is here, but I think there's some missing context here. Duplicating a type per-schema seems like an anti-pattern to me. If the type is the same for all schemas, why does it need to be schema specific in the first place?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/568046542/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/568048078","html_url":"https://github.com/diesel-rs/diesel/issues/2203#issuecomment-568048078","issue_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2203","id":568048078,"node_id":"MDEyOklzc3VlQ29tbWVudDU2ODA0ODA3OA==","user":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-20T19:07:46Z","updated_at":"2019-12-20T19:07:46Z","body":"@Boscop Can you clarify what you're asking for here? Is your issue that the query itself doesn't take the search path into account? Or that we cache the answer, but that may change if the search path changes?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/568048078/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2901732165,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjkwMTczMjE2NQ==","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/2901732165","actor":{"login":"Boscop","id":535593,"node_id":"MDQ6VXNlcjUzNTU5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/535593?v=4","gravatar_id":"","url":"https://api.github.com/users/Boscop","html_url":"https://github.com/Boscop","followers_url":"https://api.github.com/users/Boscop/followers","following_url":"https://api.github.com/users/Boscop/following{/other_user}","gists_url":"https://api.github.com/users/Boscop/gists{/gist_id}","starred_url":"https://api.github.com/users/Boscop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Boscop/subscriptions","organizations_url":"https://api.github.com/users/Boscop/orgs","repos_url":"https://api.github.com/users/Boscop/repos","events_url":"https://api.github.com/users/Boscop/events{/privacy}","received_events_url":"https://api.github.com/users/Boscop/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-12-20T19:07:46Z","performed_via_github_app":null},{"id":2901732169,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI5MDE3MzIxNjk=","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/2901732169","actor":{"login":"Boscop","id":535593,"node_id":"MDQ6VXNlcjUzNTU5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/535593?v=4","gravatar_id":"","url":"https://api.github.com/users/Boscop","html_url":"https://github.com/Boscop","followers_url":"https://api.github.com/users/Boscop/followers","following_url":"https://api.github.com/users/Boscop/following{/other_user}","gists_url":"https://api.github.com/users/Boscop/gists{/gist_id}","starred_url":"https://api.github.com/users/Boscop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Boscop/subscriptions","organizations_url":"https://api.github.com/users/Boscop/orgs","repos_url":"https://api.github.com/users/Boscop/repos","events_url":"https://api.github.com/users/Boscop/events{/privacy}","received_events_url":"https://api.github.com/users/Boscop/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-12-20T19:07:46Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/568061155","html_url":"https://github.com/diesel-rs/diesel/issues/2203#issuecomment-568061155","issue_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2203","id":568061155,"node_id":"MDEyOklzc3VlQ29tbWVudDU2ODA2MTE1NQ==","user":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-20T19:38:30Z","updated_at":"2019-12-20T19:38:30Z","body":"So it seems like there are three issues here:\r\n\r\n- We don't take the search path into account on lookup\r\n- There's no way to specify an explicit schema\r\n- If the result *were* based on the search path, the answer could change between calls\r\n\r\nI believe the first two can be solved by changing the where clause on our query to `WHERE oid = $1::regtype::oid`. This would also resolve schemas for us (though we should make sure this still works when given an explicit schema that isn't in the search path). We can also just narrow the schema manually if the string contains a `.`, but that'd be more complicated and also break any types with a `.` in the name (which probably won't actually break any real code)\r\n\r\nThe third problem is something I consider to be extremely niche, but it seems like we could support it by providing a second lookup function which doesn't cache the answer. But if you can't tell us the schema you want us to look in, I don't see any way we could possibly support that without doing a query every time the lookup needs to be performed.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/568061155/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sgrif","id":1529387,"node_id":"MDQ6VXNlcjE1MjkzODc=","avatar_url":"https://avatars.githubusercontent.com/u/1529387?v=4","gravatar_id":"","url":"https://api.github.com/users/sgrif","html_url":"https://github.com/sgrif","followers_url":"https://api.github.com/users/sgrif/followers","following_url":"https://api.github.com/users/sgrif/following{/other_user}","gists_url":"https://api.github.com/users/sgrif/gists{/gist_id}","starred_url":"https://api.github.com/users/sgrif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgrif/subscriptions","organizations_url":"https://api.github.com/users/sgrif/orgs","repos_url":"https://api.github.com/users/sgrif/repos","events_url":"https://api.github.com/users/sgrif/events{/privacy}","received_events_url":"https://api.github.com/users/sgrif/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"frol","id":304265,"node_id":"MDQ6VXNlcjMwNDI2NQ==","avatar_url":"https://avatars.githubusercontent.com/u/304265?v=4","gravatar_id":"","url":"https://api.github.com/users/frol","html_url":"https://github.com/frol","followers_url":"https://api.github.com/users/frol/followers","following_url":"https://api.github.com/users/frol/following{/other_user}","gists_url":"https://api.github.com/users/frol/gists{/gist_id}","starred_url":"https://api.github.com/users/frol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/frol/subscriptions","organizations_url":"https://api.github.com/users/frol/orgs","repos_url":"https://api.github.com/users/frol/repos","events_url":"https://api.github.com/users/frol/events{/privacy}","received_events_url":"https://api.github.com/users/frol/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-28T16:02:00Z","updated_at":"2020-07-28T16:02:00Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/adwhit/diesel-derive-enum/issues/52","repository_url":"https://api.github.com/repos/adwhit/diesel-derive-enum","labels_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/issues/52/labels{/name}","comments_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/issues/52/comments","events_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/issues/52/events","html_url":"https://github.com/adwhit/diesel-derive-enum/issues/52","id":666435457,"node_id":"MDU6SXNzdWU2NjY0MzU0NTc=","number":52,"title":"Enums in Postgres generate a request to every use of enum value","user":{"login":"frol","id":304265,"node_id":"MDQ6VXNlcjMwNDI2NQ==","avatar_url":"https://avatars.githubusercontent.com/u/304265?v=4","gravatar_id":"","url":"https://api.github.com/users/frol","html_url":"https://github.com/frol","followers_url":"https://api.github.com/users/frol/followers","following_url":"https://api.github.com/users/frol/following{/other_user}","gists_url":"https://api.github.com/users/frol/gists{/gist_id}","starred_url":"https://api.github.com/users/frol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/frol/subscriptions","organizations_url":"https://api.github.com/users/frol/orgs","repos_url":"https://api.github.com/users/frol/repos","events_url":"https://api.github.com/users/frol/events{/privacy}","received_events_url":"https://api.github.com/users/frol/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-07-27T16:46:32Z","updated_at":"2020-07-28T16:02:00Z","closed_at":"2020-07-28T12:54:41Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":116128188,"node_id":"MDEwOlJlcG9zaXRvcnkxMTYxMjgxODg=","name":"diesel-derive-enum","full_name":"adwhit/diesel-derive-enum","private":false,"owner":{"login":"adwhit","id":3189554,"node_id":"MDQ6VXNlcjMxODk1NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/3189554?v=4","gravatar_id":"","url":"https://api.github.com/users/adwhit","html_url":"https://github.com/adwhit","followers_url":"https://api.github.com/users/adwhit/followers","following_url":"https://api.github.com/users/adwhit/following{/other_user}","gists_url":"https://api.github.com/users/adwhit/gists{/gist_id}","starred_url":"https://api.github.com/users/adwhit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adwhit/subscriptions","organizations_url":"https://api.github.com/users/adwhit/orgs","repos_url":"https://api.github.com/users/adwhit/repos","events_url":"https://api.github.com/users/adwhit/events{/privacy}","received_events_url":"https://api.github.com/users/adwhit/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/adwhit/diesel-derive-enum","description":"Use enums with Diesel ORM","fork":false,"url":"https://api.github.com/repos/adwhit/diesel-derive-enum","forks_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/forks","keys_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/keys{/key_id}","collaborators_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/teams","hooks_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/hooks","issue_events_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/issues/events{/number}","events_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/events","assignees_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/assignees{/user}","branches_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/branches{/branch}","tags_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/tags","blobs_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/git/refs{/sha}","trees_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/git/trees{/sha}","statuses_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/statuses/{sha}","languages_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/languages","stargazers_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/stargazers","contributors_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/contributors","subscribers_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/subscribers","subscription_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/subscription","commits_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/commits{/sha}","git_commits_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/git/commits{/sha}","comments_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/comments{/number}","issue_comment_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/issues/comments{/number}","contents_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/contents/{+path}","compare_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/compare/{base}...{head}","merges_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/merges","archive_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/downloads","issues_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/issues{/number}","pulls_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/pulls{/number}","milestones_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/milestones{/number}","notifications_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/labels{/name}","releases_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/releases{/id}","deployments_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/deployments","created_at":"2018-01-03T11:15:25Z","updated_at":"2025-11-02T00:10:33Z","pushed_at":"2025-03-25T12:04:21Z","git_url":"git://github.com/adwhit/diesel-derive-enum.git","ssh_url":"git@github.com:adwhit/diesel-derive-enum.git","clone_url":"https://github.com/adwhit/diesel-derive-enum.git","svn_url":"https://github.com/adwhit/diesel-derive-enum","homepage":"","size":178,"stargazers_count":287,"watchers_count":287,"language":"Rust","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":35,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":13,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":35,"open_issues":13,"watchers":287,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"Using a remote DB @khorolets and I discovered that our requests are too slow (observed high latencies). Digging into it we learned that doing an insert of N records in a single query produce N pre-flight queries and they are related to the lookup:\r\n\r\nhttps://github.com/adwhit/diesel-derive-enum/blob/731b86fec2afb39a255a59c564abe002c7f22e23/src/lib.rs#L273-L277\r\n\r\nLogging out the looked up type we observe:\r\n\r\n```rust\r\nPgTypeMetadata { oid: 0, array_oid: 0 }\r\n```\r\n\r\nThus, replacing the lookup call with the const value we avoid all the unrelated requests and our implementation seems to work just fine. It is hard to tell if this is reasonable to use this const instead of a dynamic lookup:\r\n\r\n```rust\r\n impl HasSqlType<#diesel_mapping> for Pg { \r\n     fn metadata(lookup: &Self::MetadataLookup) -> Self::TypeMetadata { \r\n         Self::TypeMetadata { oid: 0, array_oid: 0 }\r\n     } \r\n } \r\n```\r\n\r\n**UPD:** Our `CREATE TYPE` SQL migration had mismatching names with the enums in the source code, but even once we fixed the mismatch and started observing proper values (`PgTypeMetadata { oid: 21564, array_oid: 21563 }`), it did not change anything (still slow if we do this lookup every time). I wonder what is the use of these `oid` and `array_oid` values since SELECT (with and without filters), UPDATE, and INSERT operations succeed even if the metadata method always returns `Self::TypeMetadata { oid: 0, array_oid: 0 }`.","reactions":{"url":"https://api.github.com/repos/adwhit/diesel-derive-enum/issues/52/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/adwhit/diesel-derive-enum/issues/52/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"id":4229020689,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQyMjkwMjA2ODk=","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/4229020689","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"1efb59bf93a6243e729c7bf80e3215153a0c3eea","commit_url":"https://api.github.com/repos/weiznich/diesel/commits/1efb59bf93a6243e729c7bf80e3215153a0c3eea","created_at":"2021-01-20T17:11:22Z","performed_via_github_app":null},{"id":4229429019,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQyMjk0MjkwMTk=","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/4229429019","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"9b8b724a3a486d98089ccd1c8ecaadb70da7eb92","commit_url":"https://api.github.com/repos/weiznich/diesel/commits/9b8b724a3a486d98089ccd1c8ecaadb70da7eb92","created_at":"2021-01-20T18:47:43Z","performed_via_github_app":null},{"id":4264849927,"node_id":"MDExOkNsb3NlZEV2ZW50NDI2NDg0OTkyNw==","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/4264849927","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"9b8b724a3a486d98089ccd1c8ecaadb70da7eb92","commit_url":"https://api.github.com/repos/diesel-rs/diesel/commits/9b8b724a3a486d98089ccd1c8ecaadb70da7eb92","created_at":"2021-01-29T07:51:22Z","state_reason":null,"performed_via_github_app":null},{"id":4264849938,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQyNjQ4NDk5Mzg=","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/4264849938","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"93015910b7cd79c0ea00574e2dfc5c81047f3a5f","commit_url":"https://api.github.com/repos/diesel-rs/diesel/commits/93015910b7cd79c0ea00574e2dfc5c81047f3a5f","created_at":"2021-01-29T07:51:22Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/944998093","html_url":"https://github.com/diesel-rs/diesel/issues/2203#issuecomment-944998093","issue_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2203","id":944998093,"node_id":"IC_kwDOAnrqL844U4bN","user":{"login":"pietroalbini","id":2299951,"node_id":"MDQ6VXNlcjIyOTk5NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2299951?v=4","gravatar_id":"","url":"https://api.github.com/users/pietroalbini","html_url":"https://github.com/pietroalbini","followers_url":"https://api.github.com/users/pietroalbini/followers","following_url":"https://api.github.com/users/pietroalbini/following{/other_user}","gists_url":"https://api.github.com/users/pietroalbini/gists{/gist_id}","starred_url":"https://api.github.com/users/pietroalbini/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pietroalbini/subscriptions","organizations_url":"https://api.github.com/users/pietroalbini/orgs","repos_url":"https://api.github.com/users/pietroalbini/repos","events_url":"https://api.github.com/users/pietroalbini/events{/privacy}","received_events_url":"https://api.github.com/users/pietroalbini/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-16T19:58:13Z","updated_at":"2021-10-16T19:58:13Z","body":"crates.io is hitting this problem too as we need to add our first custom type, and the fix @weiznich committed in https://github.com/diesel-rs/diesel/commit/9b8b724a3a486d98089ccd1c8ecaadb70da7eb92 is only present in the master branch (targeting 2.0). Is there any chance the fix could be backported to 1.4.x?\r\n\r\nAlso, the fix does not seem to cover all cases, as the *order* of the search path is not respected. Let's assume type `Ty` is created first on schema `foo` (type OID 5000) and then on schema `bar` (type OID 5001). [The query used to fetch the OID](https://github.com/diesel-rs/diesel/blob/e7c98fc4460dad0045386658a9f2cdc2b23d0082/diesel/src/pg/metadata_lookup.rs#L95-L107) will always return OID 5000 if both schemas are in the search path, even when `bar` is before `foo` in the search path, as no sorting is done.\r\n\r\nI have a minimal repro in [this gist](https://gist.github.com/pietroalbini/68af598b2107b8bfb23a7ab00ecfac11), which fails on both Diesel 1.4.8 (as the search path is ignored) and Diesel master (as the *ordering* of the search path is ignored).","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/944998093/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pietroalbini","id":2299951,"node_id":"MDQ6VXNlcjIyOTk5NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2299951?v=4","gravatar_id":"","url":"https://api.github.com/users/pietroalbini","html_url":"https://github.com/pietroalbini","followers_url":"https://api.github.com/users/pietroalbini/followers","following_url":"https://api.github.com/users/pietroalbini/following{/other_user}","gists_url":"https://api.github.com/users/pietroalbini/gists{/gist_id}","starred_url":"https://api.github.com/users/pietroalbini/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pietroalbini/subscriptions","organizations_url":"https://api.github.com/users/pietroalbini/orgs","repos_url":"https://api.github.com/users/pietroalbini/repos","events_url":"https://api.github.com/users/pietroalbini/events{/privacy}","received_events_url":"https://api.github.com/users/pietroalbini/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":5473441092,"node_id":"MEE_lADOAnrqL84eYwX3zwAAAAFGPhVE","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/5473441092","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-10-16T19:58:13Z","performed_via_github_app":null},{"id":5473441094,"node_id":"SE_lADOAnrqL84eYwX3zwAAAAFGPhVG","url":"https://api.github.com/repos/diesel-rs/diesel/issues/events/5473441094","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-10-16T19:58:13Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/944998235","html_url":"https://github.com/diesel-rs/diesel/issues/2203#issuecomment-944998235","issue_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2203","id":944998235,"node_id":"IC_kwDOAnrqL844U4db","user":{"login":"pietroalbini","id":2299951,"node_id":"MDQ6VXNlcjIyOTk5NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2299951?v=4","gravatar_id":"","url":"https://api.github.com/users/pietroalbini","html_url":"https://github.com/pietroalbini","followers_url":"https://api.github.com/users/pietroalbini/followers","following_url":"https://api.github.com/users/pietroalbini/following{/other_user}","gists_url":"https://api.github.com/users/pietroalbini/gists{/gist_id}","starred_url":"https://api.github.com/users/pietroalbini/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pietroalbini/subscriptions","organizations_url":"https://api.github.com/users/pietroalbini/orgs","repos_url":"https://api.github.com/users/pietroalbini/repos","events_url":"https://api.github.com/users/pietroalbini/events{/privacy}","received_events_url":"https://api.github.com/users/pietroalbini/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-16T19:58:50Z","updated_at":"2021-10-16T19:58:50Z","body":"To give additional context on why crates.io uses multiple schemas with overlapping types (only in our test suite), most of our tests use a single connection with `begin_test_transaction()` on the `public` schema, as that's faster than creating a new schema and running migrations on it for each of the hundreds of tests. Still, some of the tests can't use `begin_test_transaction()` for a variety of reasons [^transaction], and just for those tests we need to create a fresh schema and run migrations on it.\r\n\r\nThe search path for tests using a fresh schema has to be `$random_name, public` though, since extensions can only be initialized in a single schema for the whole database and we can't initialize them in each of the fresh schemas (we're running tests in parallel). This causes Diesel to confuse the types defined in the fresh schema (the ones dedicated to the specific test) and the types defined in the `public` schema (the ones used by all tests relying on `begin_test_transaction()`).\r\n\r\nRight now the most promising solution for us is to simply avoid adding the custom type and work around that, but it'd be nice to see this fixed so that in the future we could actually start using custom types.\r\n\r\n[^transaction]: One of the things we implemented a couple months ago in crates.io is the ability to serve most download requests when the underlying database fails, to reduce the impact of outages. To ensure this doesn't break we added back then multiple tests simulating database failures and checking how the database pool reacts to them (like closing all the TCP connections between the app and the database). This requires multiple connections to properly work, preventing us from using `begin_test_transaction()`.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/944998235/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pietroalbini","id":2299951,"node_id":"MDQ6VXNlcjIyOTk5NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2299951?v=4","gravatar_id":"","url":"https://api.github.com/users/pietroalbini","html_url":"https://github.com/pietroalbini","followers_url":"https://api.github.com/users/pietroalbini/followers","following_url":"https://api.github.com/users/pietroalbini/following{/other_user}","gists_url":"https://api.github.com/users/pietroalbini/gists{/gist_id}","starred_url":"https://api.github.com/users/pietroalbini/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pietroalbini/subscriptions","organizations_url":"https://api.github.com/users/pietroalbini/orgs","repos_url":"https://api.github.com/users/pietroalbini/repos","events_url":"https://api.github.com/users/pietroalbini/events{/privacy}","received_events_url":"https://api.github.com/users/pietroalbini/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T08:19:17Z","updated_at":"2021-10-18T08:19:17Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/2925","repository_url":"https://api.github.com/repos/diesel-rs/diesel","labels_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2925/labels{/name}","comments_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2925/comments","events_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2925/events","html_url":"https://github.com/diesel-rs/diesel/pull/2925","id":1028782506,"node_id":"PR_kwDOAnrqL84tT5Vj","number":2925,"title":"Fix type confusion in custom type lookup","user":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-10-18T08:19:17Z","updated_at":"2021-10-18T10:25:00Z","closed_at":"2021-10-18T10:24:59Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":41609775,"node_id":"MDEwOlJlcG9zaXRvcnk0MTYwOTc3NQ==","name":"diesel","full_name":"diesel-rs/diesel","private":false,"owner":{"login":"diesel-rs","id":16763251,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE2NzYzMjUx","avatar_url":"https://avatars.githubusercontent.com/u/16763251?v=4","gravatar_id":"","url":"https://api.github.com/users/diesel-rs","html_url":"https://github.com/diesel-rs","followers_url":"https://api.github.com/users/diesel-rs/followers","following_url":"https://api.github.com/users/diesel-rs/following{/other_user}","gists_url":"https://api.github.com/users/diesel-rs/gists{/gist_id}","starred_url":"https://api.github.com/users/diesel-rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/diesel-rs/subscriptions","organizations_url":"https://api.github.com/users/diesel-rs/orgs","repos_url":"https://api.github.com/users/diesel-rs/repos","events_url":"https://api.github.com/users/diesel-rs/events{/privacy}","received_events_url":"https://api.github.com/users/diesel-rs/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/diesel-rs/diesel","description":"A safe, extensible ORM and Query Builder for Rust","fork":false,"url":"https://api.github.com/repos/diesel-rs/diesel","forks_url":"https://api.github.com/repos/diesel-rs/diesel/forks","keys_url":"https://api.github.com/repos/diesel-rs/diesel/keys{/key_id}","collaborators_url":"https://api.github.com/repos/diesel-rs/diesel/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/diesel-rs/diesel/teams","hooks_url":"https://api.github.com/repos/diesel-rs/diesel/hooks","issue_events_url":"https://api.github.com/repos/diesel-rs/diesel/issues/events{/number}","events_url":"https://api.github.com/repos/diesel-rs/diesel/events","assignees_url":"https://api.github.com/repos/diesel-rs/diesel/assignees{/user}","branches_url":"https://api.github.com/repos/diesel-rs/diesel/branches{/branch}","tags_url":"https://api.github.com/repos/diesel-rs/diesel/tags","blobs_url":"https://api.github.com/repos/diesel-rs/diesel/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/diesel-rs/diesel/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/diesel-rs/diesel/git/refs{/sha}","trees_url":"https://api.github.com/repos/diesel-rs/diesel/git/trees{/sha}","statuses_url":"https://api.github.com/repos/diesel-rs/diesel/statuses/{sha}","languages_url":"https://api.github.com/repos/diesel-rs/diesel/languages","stargazers_url":"https://api.github.com/repos/diesel-rs/diesel/stargazers","contributors_url":"https://api.github.com/repos/diesel-rs/diesel/contributors","subscribers_url":"https://api.github.com/repos/diesel-rs/diesel/subscribers","subscription_url":"https://api.github.com/repos/diesel-rs/diesel/subscription","commits_url":"https://api.github.com/repos/diesel-rs/diesel/commits{/sha}","git_commits_url":"https://api.github.com/repos/diesel-rs/diesel/git/commits{/sha}","comments_url":"https://api.github.com/repos/diesel-rs/diesel/comments{/number}","issue_comment_url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments{/number}","contents_url":"https://api.github.com/repos/diesel-rs/diesel/contents/{+path}","compare_url":"https://api.github.com/repos/diesel-rs/diesel/compare/{base}...{head}","merges_url":"https://api.github.com/repos/diesel-rs/diesel/merges","archive_url":"https://api.github.com/repos/diesel-rs/diesel/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/diesel-rs/diesel/downloads","issues_url":"https://api.github.com/repos/diesel-rs/diesel/issues{/number}","pulls_url":"https://api.github.com/repos/diesel-rs/diesel/pulls{/number}","milestones_url":"https://api.github.com/repos/diesel-rs/diesel/milestones{/number}","notifications_url":"https://api.github.com/repos/diesel-rs/diesel/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/diesel-rs/diesel/labels{/name}","releases_url":"https://api.github.com/repos/diesel-rs/diesel/releases{/id}","deployments_url":"https://api.github.com/repos/diesel-rs/diesel/deployments","created_at":"2015-08-29T22:51:00Z","updated_at":"2025-11-09T19:31:55Z","pushed_at":"2025-11-07T18:13:31Z","git_url":"git://github.com/diesel-rs/diesel.git","ssh_url":"git@github.com:diesel-rs/diesel.git","clone_url":"https://github.com/diesel-rs/diesel.git","svn_url":"https://github.com/diesel-rs/diesel","homepage":"https://diesel.rs","size":109357,"stargazers_count":13771,"watchers_count":13771,"language":"Rust","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":true,"forks_count":1168,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":153,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["mysql","orm","postgresql","query-builder","rust","sqlite"],"visibility":"public","forks":1168,"open_issues":153,"watchers":13771,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/diesel-rs/diesel/pulls/2925","html_url":"https://github.com/diesel-rs/diesel/pull/2925","diff_url":"https://github.com/diesel-rs/diesel/pull/2925.diff","patch_url":"https://github.com/diesel-rs/diesel/pull/2925.patch","merged_at":"2021-10-18T10:24:59Z"},"body":"The old code did not incorporate the order of schemas in your search\r\npath. As consequence it could pick the wrong type if types with the same\r\nname exists in more than one schema. This commit fixes that issue by\r\nperforming the name resolution on database side by casting the type name\r\nto the type itself.\r\n\r\nCC #2203 ","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/2925/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2925/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/945522710","html_url":"https://github.com/diesel-rs/diesel/issues/2203#issuecomment-945522710","issue_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2203","id":945522710,"node_id":"IC_kwDOAnrqL844W4gW","user":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T08:29:44Z","updated_at":"2021-10-18T08:29:44Z","body":"@pietroalbini Thanks for that great report :+1:. I'm able to reproduce the problem with the master branch and have submitted #2925 to fix this issue, so it should be fixed on the master branch soon.\r\n\r\n> Is there any chance the fix could be backported to 1.4.x?\r\n\r\nThis depends a bit on how important the fix is for the crates.io team. If it's fine to wait a few more weeks for the first 2.0 release using the master branch + migrate to that I would not do any backport to 1.4.x, especially as the code changed quite a bit since the 1.4.0 release. If you need that fix in the next few days we can talk about backporting a limited version of all that changes. In that case I would suggest to only backport this specific fix (as it changes the query only sligtly), and not the whole caching stuff. \r\n\r\n> The search path for tests using a fresh schema has to be $random_name, public though, since extensions can only be initialized in a single schema for the whole database and we can't initialize them in each of the fresh schemas (we're running tests in parallel). This causes Diesel to confuse the types defined in the fresh schema (the ones dedicated to the specific test) and the types defined in the public schema (the ones used by all tests relying on begin_test_transaction()).\r\n\r\nJust to point the obvious here: Changing the search path on any existing connection will likely have \"funny\" side effects. For example at least the master branch caches type oid's. If you now change the search path, a type could resolve to another oid but diesel will never notice that as it just uses an internal type oid cache to prevent requering the oid on each bind. There is no real way to fix this, so just be very careful how you change the search path. \r\nThat written: I assume the in the crates.io test suite creates a new connection for each test case, so it will be fine there.\r\n\r\n> I have a minimal repro in this gist, which fails on both Diesel 1.4.8 (as the search path is ignored) and Diesel master (as the ordering of the search path is ignored).\r\n\r\nAs semi-related side note: Diesel normally distinguishes between sql side types and rust side types. Your minimal example uses the [same type](https://gist.github.com/pietroalbini/68af598b2107b8bfb23a7ab00ecfac11#file-main-rs-L49) for both. The classical diesel style has an distinct type for the sql side, that is just a zero sized struct (and derives `SqlType` + `QueryId`).","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/comments/945522710/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false}}]