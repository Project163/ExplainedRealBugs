{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/2790","repository_url":"https://api.github.com/repos/diesel-rs/diesel","labels_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2790/labels{/name}","comments_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2790/comments","events_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2790/events","html_url":"https://github.com/diesel-rs/diesel/issues/2790","id":897952501,"node_id":"MDU6SXNzdWU4OTc5NTI1MDE=","number":2790,"title":"sqlite: not possible to use SQL functions without Arguments","user":{"login":"toxeus","id":7702854,"node_id":"MDQ6VXNlcjc3MDI4NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/7702854?v=4","gravatar_id":"","url":"https://api.github.com/users/toxeus","html_url":"https://github.com/toxeus","followers_url":"https://api.github.com/users/toxeus/followers","following_url":"https://api.github.com/users/toxeus/following{/other_user}","gists_url":"https://api.github.com/users/toxeus/gists{/gist_id}","starred_url":"https://api.github.com/users/toxeus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/toxeus/subscriptions","organizations_url":"https://api.github.com/users/toxeus/orgs","repos_url":"https://api.github.com/users/toxeus/repos","events_url":"https://api.github.com/users/toxeus/events{/privacy}","received_events_url":"https://api.github.com/users/toxeus/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":254193214,"node_id":"MDU6TGFiZWwyNTQxOTMyMTQ=","url":"https://api.github.com/repos/diesel-rs/diesel/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":null},{"id":254193215,"node_id":"MDU6TGFiZWwyNTQxOTMyMTU=","url":"https://api.github.com/repos/diesel-rs/diesel/labels/help%20wanted","name":"help wanted","color":"159818","default":true,"description":null},{"id":292827048,"node_id":"MDU6TGFiZWwyOTI4MjcwNDg=","url":"https://api.github.com/repos/diesel-rs/diesel/labels/hole%20in%20api","name":"hole in api","color":"eb6420","default":false,"description":null},{"id":320991993,"node_id":"MDU6TGFiZWwzMjA5OTE5OTM=","url":"https://api.github.com/repos/diesel-rs/diesel/labels/sqlite","name":"sqlite","color":"bfd4f2","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-05-21T11:24:20Z","updated_at":"2021-05-25T15:28:13Z","closed_at":"2021-05-25T15:28:13Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Setup\r\n\r\n### Versions\r\n\r\n- **Rust:** 1.52.1\r\n- **Diesel:** master\r\n- **Database:** Sqlite\r\n- **Operating System:** Linux\r\n\r\n### Feature Flags\r\n\r\n- **diesel:** sqlite\r\n\r\n## Problem Description\r\n\r\n[This condition](https://github.com/diesel-rs/diesel/blob/7587a3bda93bcbe8d44a22f8537da157b953ae5e/diesel_derives/src/sql_function.rs#L245) skips the code generation of `register_impl` and `register_nondeterministic_impl` for SQL functions without arguments. Because the [documentation](https://docs.diesel.rs/master/diesel/prelude/macro.sql_function.html#sql-functions-without-arguments) doesn't mention any limitations for Sqlite SQL functions without arguments, I'm assuming this to be a bug. \r\n\r\nI've tracked down the [commit that introduced that regression]( https://github.com/diesel-rs/diesel/commit/dd05ee2588f80f240896bd8c95cd8539d706d7e7#diff-3dc6bb01ed73137c473d075bf6f9ae482857b07fdfd5aa7d95691705daaebc6bR235) but its commit message doesn't help to understand why the condition was changed.\r\n\r\n### What are you trying to accomplish?\r\n\r\nI want to use a SQL function without arguments with Sqlite.\r\n\r\n### What is the expected output?\r\n\r\nNo errors.\r\n\r\n### What is the actual output?\r\n\r\n> cannot find function `register_nondeterministic_impl` in module `foo`\r\n\r\n### Are you seeing any additional errors?\r\n\r\nNo.\r\n\r\n### Steps to reproduce\r\n\r\n```rs\r\nsql_function! {\r\n    fn foo() -> Text;\r\n}\r\nfn main() {\r\n    let conn = diesel::SqliteConnection::establish(\":memory:\");\r\n    foo::register_impl(&conn, || \"foo\".to_string());\r\n}\r\n```\r\n\r\n## Checklist\r\n\r\n- [x] I have already looked over the [issue tracker](https://github.com/diesel-rs/diesel/issues)  and the [disussion forum](https://github.com/diesel-rs/diesel/discussions)  for similar possible closed issues.\r\n<!--\r\nIf you are unsure if your issue is a duplicate of an existing issue please link the issue in question here\r\n--> \r\n- [x] This issue can be reproduced on Rust's stable channel. (Your issue will be\r\n  closed if this is not the case)\r\n- [x] This issue can be reproduced without requiring a third party crate\r\n","closed_by":{"login":"weiznich","id":1674512,"node_id":"MDQ6VXNlcjE2NzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1674512?v=4","gravatar_id":"","url":"https://api.github.com/users/weiznich","html_url":"https://github.com/weiznich","followers_url":"https://api.github.com/users/weiznich/followers","following_url":"https://api.github.com/users/weiznich/following{/other_user}","gists_url":"https://api.github.com/users/weiznich/gists{/gist_id}","starred_url":"https://api.github.com/users/weiznich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weiznich/subscriptions","organizations_url":"https://api.github.com/users/weiznich/orgs","repos_url":"https://api.github.com/users/weiznich/repos","events_url":"https://api.github.com/users/weiznich/events{/privacy}","received_events_url":"https://api.github.com/users/weiznich/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/diesel-rs/diesel/issues/2790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/diesel-rs/diesel/issues/2790/timeline","performed_via_github_app":null,"state_reason":"completed"}