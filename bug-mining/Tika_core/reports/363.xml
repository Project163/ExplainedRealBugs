<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:08:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-3815] Inconsistent Date/Time information extracted from Exif data</title>
                <link>https://issues.apache.org/jira/browse/TIKA-3815</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Running tika-app-2.4.1.jar on the attached image, these metadata is returned:&lt;/p&gt;

&lt;p&gt;Exif IFD0:Date/Time: 2022:06:16 11:18:49&lt;br/&gt;
Exif SubIFD:Date/Time Digitized: 2022:06:16 11:18:49&lt;br/&gt;
Exif SubIFD:Date/Time Original: 2022:06:16 11:18:49&lt;br/&gt;
Exif SubIFD:Time Zone: -03:00&lt;br/&gt;
Exif SubIFD:Time Zone Digitized: -03:00&lt;br/&gt;
Exif SubIFD:Time Zone Original: -03:00&lt;br/&gt;
File Modified Date: Thu Jun 16 11:18:50 -03:00 2022&lt;br/&gt;
GPS:GPS Date Stamp: 2022:06:16&lt;br/&gt;
GPS:GPS Time-Stamp: 14:18:47.000 UTC&lt;br/&gt;
dcterms:created: 2022-06-16T08:18:49&lt;br/&gt;
dcterms:modified: 2022-06-16T08:18:49&lt;br/&gt;
exif:DateTimeOriginal: 2022-06-16T08:18:49&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The right value is 2022-06-16T14:18:49Z. Although there is no timezone specified for some values, I think it makes no sense converting them to timezones different than GMT, the one used to take the picture (-03:00) or the one used to run the application (-03:00), so Tika could be making an incorrect timezone conversion on the last 3 fields.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13471076">TIKA-3815</key>
            <summary>Inconsistent Date/Time information extracted from Exif data</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lfcnassif">Lu&#237;s Filipe Nassif</assignee>
                                    <reporter username="lfcnassif">Lu&#237;s Filipe Nassif</reporter>
                        <labels>
                    </labels>
                <created>Mon, 11 Jul 2022 21:49:39 +0000</created>
                <updated>Wed, 14 Sep 2022 18:26:46 +0000</updated>
                            <resolved>Wed, 13 Jul 2022 18:35:56 +0000</resolved>
                                    <version>2.4.1</version>
                    <version>1.28.4</version>
                                    <fixVersion>2.5.0</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17565187" author="lfcnassif" created="Mon, 11 Jul 2022 22:59:56 +0000"  >&lt;p&gt;Does anyone know if the EXIF specification defines a default timezone for those dates if it is not specified? Even if not, maybe we could make some checking if &quot;Exif SubIFD:Time Zone*&quot; fields are found and if different date values differ exactly about those timezone fields...&lt;/p&gt;</comment>
                            <comment id="17565200" author="lfcnassif" created="Tue, 12 Jul 2022 00:14:00 +0000"  >&lt;p&gt;Ok we should at least change this SimpleDateFormat:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/tika/blob/2.4.1/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-image-module/src/main/java/org/apache/tika/parser/image/ImageMetadataExtractor.java#L381&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/blob/2.4.1/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-image-module/src/main/java/org/apache/tika/parser/image/ImageMetadataExtractor.java#L381&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;to set its timezone explicitly to GMT, otherwise it will use the default/local timezone when formatting the Date (that uses UTC as reference) even if the output pattern has no timezone information to print. Without this, running Tika on different timezones could return different date values...&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I&apos;ll submit a fix to that if there aren&apos;t objections.&lt;/p&gt;</comment>
                            <comment id="17565229" author="githubbot" created="Tue, 12 Jul 2022 02:36:31 +0000"  >&lt;p&gt;lfcnassif opened a new pull request, #605:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/605&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/605&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   Fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3815&quot; title=&quot;Inconsistent Date/Time information extracted from Exif data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3815&quot;&gt;&lt;del&gt;TIKA-3815&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;   Actually Drew Noakes metadata-extractor library uses *&lt;b&gt;GMT&lt;/b&gt;* timezone when timezone is not specified since version 2.8.1, not JVM default:&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;fix tests to work on different timezones&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/drewnoakes/metadata-extractor/commit/1899deac8af55934363183dae605e286bc79afa3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/drewnoakes/metadata-extractor/commit/1899deac8af55934363183dae605e286bc79afa3&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;   So I changed the code to reflect that and updated tests. Now `user.timezone` doesn&apos;t need to be fixed to UTC anymore to run tests, they should work on any timezone.&lt;/p&gt;

&lt;p&gt;   I would like some other committer to test this to be sure tests work on a timezone different than mine (GMT-3)&lt;/p&gt;

</comment>
                            <comment id="17565231" author="githubbot" created="Tue, 12 Jul 2022 02:42:04 +0000"  >&lt;p&gt;lfcnassif commented on PR #605:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/605#issuecomment-1181250211&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/605#issuecomment-1181250211&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   Should this be also applied to 1.x branch or we are just fixing security issues?&lt;/p&gt;

</comment>
                            <comment id="17565886" author="githubbot" created="Tue, 12 Jul 2022 15:50:24 +0000"  >&lt;p&gt;lfcnassif commented on PR #605:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/605#issuecomment-1181936424&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/605#issuecomment-1181936424&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   I did a few more tests and I think this is fine, I&apos;m going to merge.&lt;/p&gt;

</comment>
                            <comment id="17565888" author="githubbot" created="Tue, 12 Jul 2022 15:53:44 +0000"  >&lt;p&gt;lfcnassif merged PR #605:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/605&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/605&lt;/a&gt;&lt;/p&gt;

</comment>
                            <comment id="17565950" author="hudson" created="Tue, 12 Jul 2022 18:07:08 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-main-jdk8 #679 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/679/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/679/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3815&quot; title=&quot;Inconsistent Date/Time information extracted from Exif data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3815&quot;&gt;&lt;del&gt;TIKA-3815&lt;/del&gt;&lt;/a&gt;: set GMT timezone for unspecified timezones like drew noakes, (lfcnassif: &lt;a href=&quot;https://github.com/apache/tika/commit/e3c1a0c11c2cd693a3599c7f71ae262d9d7795f5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/e3c1a0c11c2cd693a3599c7f71ae262d9d7795f5&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-image-module/src/main/java/org/apache/tika/parser/image/ImageMetadataExtractor.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parent/pom.xml&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-image-module/src/test/java/org/apache/tika/parser/image/JpegParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-core/src/test/java/org/apache/tika/metadata/TestMetadata.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-image-module/src/test/java/org/apache/tika/parser/image/ImageMetadataExtractorTest.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3815&quot; title=&quot;Inconsistent Date/Time information extracted from Exif data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3815&quot;&gt;&lt;del&gt;TIKA-3815&lt;/del&gt;&lt;/a&gt;: update CHANGES.txt (lfcnassif: &lt;a href=&quot;https://github.com/apache/tika/commit/fc375f8dbbdce0d341e89e1ab1b5a7ded532ac22&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/fc375f8dbbdce0d341e89e1ab1b5a7ded532ac22&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;(edit) CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17566129" author="tilman" created="Wed, 13 Jul 2022 03:28:10 +0000"  >&lt;p&gt;The build fails for me (in Germany, jdk8, windows 10):&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[ERROR] Tests run: 23, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 2.131 s &amp;lt;&amp;lt;&amp;lt; FAILURE! - in org.apache.tika.parser.mail.RFC822ParserTest
[ERROR] org.apache.tika.parser.mail.RFC822ParserTest.testDates &#160;Time elapsed: 0.042 s &#160;&amp;lt;&amp;lt;&amp;lt; FAILURE!
org.opentest4j.AssertionFailedError: failed to match: Sun, 15 May 2016 01:32:00 UTC ==&amp;gt; expected: &amp;lt;2016-05-15T01:32:00Z&amp;gt; but was: &amp;lt;2016-05-15T03:32:00Z&amp;gt;
&#160; &#160; &#160; &#160; at org.junit.jupiter.api.AssertionUtils.fail(AssertionUtils.java:55)
&#160; &#160; &#160; &#160; at org.junit.jupiter.api.AssertionUtils.failNotEqual(AssertionUtils.java:62)
&#160; &#160; &#160; &#160; at org.junit.jupiter.api.AssertEquals.assertEquals(AssertEquals.java:182)
&#160; &#160; &#160; &#160; at org.junit.jupiter.api.Assertions.assertEquals(Assertions.java:1152)
&#160; &#160; &#160; &#160; at org.apache.tika.parser.mail.RFC822ParserTest.testDate(RFC822ParserTest.java:428)
&#160; &#160; &#160; &#160; at org.apache.tika.parser.mail.RFC822ParserTest.testDates(RFC822ParserTest.java:390) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17566133" author="lfcnassif" created="Wed, 13 Jul 2022 03:49:57 +0000"  >&lt;p&gt;Hum... thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt;. I had no issue with that test (in Brazil). I&apos;ll take a look tomorrow.&lt;/p&gt;</comment>
                            <comment id="17566134" author="lfcnassif" created="Wed, 13 Jul 2022 03:52:23 +0000"  >&lt;p&gt;Last CI build also worked...&lt;/p&gt;</comment>
                            <comment id="17566135" author="tilman" created="Wed, 13 Jul 2022 03:53:21 +0000"  >&lt;p&gt;Surprisingly, the 1.x build succeeds (I noticed you changed both versions). (Both with jdk 1.8)&lt;/p&gt;</comment>
                            <comment id="17566137" author="lfcnassif" created="Wed, 13 Jul 2022 03:56:44 +0000"  >&lt;p&gt;Actually I did change just main&lt;/p&gt;</comment>
                            <comment id="17566138" author="tilman" created="Wed, 13 Jul 2022 03:58:19 +0000"  >&lt;p&gt;You&apos;re right, I misread the git output.&lt;/p&gt;</comment>
                            <comment id="17566141" author="lfcnassif" created="Wed, 13 Jul 2022 04:11:02 +0000"  >&lt;p&gt;I &lt;em&gt;think&lt;/em&gt; the timezone of the SimpleDateFormat in that test should be set to UTC. Not sure why that didn&apos;t fail in my machine. I&apos;ll double check tomorrow.&lt;/p&gt;</comment>
                            <comment id="17566429" author="lfcnassif" created="Wed, 13 Jul 2022 17:20:12 +0000"  >&lt;p&gt;That test also doesn&apos;t pass in my machine, sorry about that...&lt;/p&gt;

&lt;p&gt;Maybe I have found a similar issue in RFC822Parser: when timezone is not specified in Date strings, they are parsed using local timezone. That could lead to different results in different timezones. But I&apos;m not sure if that is not fine or if that is not expected.&lt;/p&gt;

&lt;p&gt;I&apos;ll fix the RFC822ParserTest to use UTC timezone when formatting parsed Dates with some timezone information. If there is no timezone info in tested Date strings, don&apos;t set a timezone in the test, like RFC822Parser does.&lt;/p&gt;

&lt;p&gt;But maybe RFC822Parser should be changed to use UTC when no timezone is specified in Date strings. This would make results consistent in different timezones, but would change the behavior and I&apos;m not sure if it is desired.&lt;/p&gt;

&lt;p&gt;Opinions?&lt;/p&gt;</comment>
                            <comment id="17566438" author="tilman" created="Wed, 13 Jul 2022 17:33:15 +0000"  >&lt;p&gt;I have no opinion about this. I wonder what thunderbird does when displaying such content where the date has no timezone.&lt;/p&gt;</comment>
                            <comment id="17566460" author="lfcnassif" created="Wed, 13 Jul 2022 18:35:56 +0000"  >&lt;p&gt;fixed by d79448e465708d59d12de54aac7d8b3af9f0439c&lt;/p&gt;</comment>
                            <comment id="17566485" author="hudson" created="Wed, 13 Jul 2022 20:20:38 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-main-jdk8 #683 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/683/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/683/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3815&quot; title=&quot;Inconsistent Date/Time information extracted from Exif data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3815&quot;&gt;&lt;del&gt;TIKA-3815&lt;/del&gt;&lt;/a&gt;: fix RFC822ParserTest failing tests (lfcnassif: &lt;a href=&quot;https://github.com/apache/tika/commit/d79448e465708d59d12de54aac7d8b3af9f0439c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/d79448e465708d59d12de54aac7d8b3af9f0439c&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-mail-module/src/test/java/org/apache/tika/parser/mail/RFC822ParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17566632" author="tilman" created="Thu, 14 Jul 2022 04:15:03 +0000"  >&lt;p&gt;Local build successful too, thanks (tested with jdk8 and 18).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13046550" name="IMG_20220616_111848_HDR.jpg" size="4857517" author="lfcnassif" created="Mon, 11 Jul 2022 21:49:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 17 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z16ryo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>