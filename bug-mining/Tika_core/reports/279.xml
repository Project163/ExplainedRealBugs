<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:08:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-1141] javascript files that contain &quot;&lt;html&quot; are detected as text/html</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1141</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;The Mimetypes detector will return text/html as the mimetype for any javascript file that contains the string &quot;&amp;lt;html&quot; in it. I believe this is due to the rule &amp;lt;match value=&quot;&amp;lt;html&quot; type=&quot;string&quot; offset=&quot;0:8192&quot;/&amp;gt; in the tika-mimetypes.xml file.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12655875">TIKA-1141</key>
            <summary>javascript files that contain &quot;&lt;html&quot; are detected as text/html</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="hodavidhara">David Hara</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 Jul 2013 23:30:56 +0000</created>
                <updated>Thu, 21 Jul 2022 11:02:34 +0000</updated>
                                            <version>1.2</version>
                                                    <component>mime</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>11</watches>
                                                                                                                <comments>
                            <comment id="14362174" author="tpalsulich" created="Sun, 15 Mar 2015 03:27:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;, you seem to be the magic guy around here. Can you make a decision on this?&lt;/p&gt;</comment>
                            <comment id="14364072" author="gagravarr" created="Mon, 16 Mar 2015 22:15:29 +0000"  >&lt;p&gt;Maybe we should split this into two, one with the current high priority for just a match in the first few hundred bytes, then another with a lower priority for the remaining few hundred kb?&lt;/p&gt;

&lt;p&gt;We might also want to look at adding some low priority patterns for common &quot;start of javascript&quot;&lt;/p&gt;</comment>
                            <comment id="14596761" author="ottenhoff" created="Mon, 22 Jun 2015 22:24:36 +0000"  >&lt;p&gt;Here is an easy file to replicate the issue with:&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;http://code.jquery.com/jquery-1.6.1.js&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://code.jquery.com/jquery-1.6.1.js&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Line 8540 contains:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  iframeDoc.write( &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;!doctype&amp;gt;&amp;lt;html&amp;gt;&amp;lt;body&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&quot;&lt;/span&gt; );
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We are tracking this bug in our open-source learning management system Sakai here:&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;https://jira.sakaiproject.org/browse/KNL-1306&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://jira.sakaiproject.org/browse/KNL-1306&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15130723" author="gagravarr" created="Wed, 3 Feb 2016 17:29:57 +0000"  >&lt;p&gt;I&apos;ve tweaked the mime magic for HTML, so we give &amp;lt;html a lower priority if it isn&apos;t near the start. As long as the .js filename is given, Tika is able to correctly identify these JQuery files as application/javascript now. Without the filename it can&apos;t, as we don&apos;t have any javascript magic. Not sure if we could add any either, given the format, but if someone wants to take a stab that&apos;d be great!&lt;/p&gt;</comment>
                            <comment id="15130853" author="bslobodin" created="Wed, 3 Feb 2016 18:43:11 +0000"  >&lt;p&gt;This would be a great workaround.&lt;/p&gt;</comment>
                            <comment id="16294124" author="dagoltz" created="Sun, 17 Dec 2017 12:40:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;,&lt;br/&gt;
I&apos;ve tested this behavior in tika-app-1.17 and am still getting &quot;text/html&quot; for &quot;jquery-2.0.3.js&quot; (also after rename to &quot;jquery.js&quot;).&lt;br/&gt;
In what version was this change done?&lt;/p&gt;</comment>
                            <comment id="16294758" author="gagravarr" created="Mon, 18 Dec 2017 10:20:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dagoltz&quot; class=&quot;user-hover&quot; rel=&quot;dagoltz&quot;&gt;dagoltz&lt;/a&gt; The change was first released in Apache Tika 1.12. Trying with 1.17, I get the correct answer for jquery-2.0.3.min.js:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java -jar apache-tika-1.17.jar --detect jquery-2.0.3.min.js 
Dec 18, 2017 10:19:34 AM org.apache.tika.config.InitializableProblemHandler$3 handleInitializableProblem
WARNING: org.xerial&apos;s sqlite-jdbc is not loaded.
Please provide the jar on your classpath to parse sqlite files.
See tika-parsers/pom.xml &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the correct version.
application/javascript
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16294760" author="dagoltz" created="Mon, 18 Dec 2017 10:23:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;,&lt;br/&gt;
I ran&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java -jar apache-tika-1.17.jar
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and then dropped the file into the UI and got &quot;text/html&quot;&lt;/p&gt;

&lt;p&gt;Also, Tika 1.14 is used in &lt;a href=&quot;https://github.com/jenkinsci/windows-azure-storage-plugin&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;windows-azure-storage-plugin&lt;/a&gt; and we get &quot;text/html&quot; &lt;a href=&quot;https://github.com/jenkinsci/windows-azure-storage-plugin/blob/7f4fae6240e7cf0dd1b24d6aa3c0ceb3d2bba317/src/main/java/com/microsoftopentechnologies/windowsazurestorage/AzureBlobProperties.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;there&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Tika tika = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Tika();
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (InputStream stream = file.read()) {
     &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; tika.detect(stream, file.getName());
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I have opened a &lt;a href=&quot;https://github.com/jenkinsci/windows-azure-storage-plugin/issues/89&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;bug&lt;/a&gt; in windows-azure-storage-plugin as this doesn&apos;t work&lt;/p&gt;</comment>
                            <comment id="16294763" author="gagravarr" created="Mon, 18 Dec 2017 10:26:36 +0000"  >&lt;p&gt;That might not pass in the filename, but I&apos;m not sure on the GUI part of the Tika app... &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison%40mitre.org&quot; class=&quot;user-hover&quot; rel=&quot;tallison@mitre.org&quot;&gt;tallison@mitre.org&lt;/a&gt; any idea?&lt;/p&gt;

&lt;p&gt;In general though, there&apos;s no unique file magic for JS files, so we (along with most other tools) require the filename as an additional hint to get it right&lt;/p&gt;</comment>
                            <comment id="16299893" author="dagoltz" created="Thu, 21 Dec 2017 11:33:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt; this is our soltution to this issue:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; detectContentType(FilePath file) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; InterruptedException, IOException {
        Tika tika = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Tika();
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (InputStream stream = file.read()) {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (file.getName().endsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;.js&quot;&lt;/span&gt;)) {
                &lt;span class=&quot;code-comment&quot;&gt;// Tika has a shortcoming not able to properly identify JavaScript files, determine type by extension
&lt;/span&gt;                &lt;span class=&quot;code-comment&quot;&gt;// rather than Tika &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; those.
&lt;/span&gt;                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;application/javascript&quot;&lt;/span&gt;;
            } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; tika.detect(stream, file.getName());
            }
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As you can see, the file name exists and is definitly pased to Tika otherwise our solution wouldn&apos;t have worked.&lt;br/&gt;
We are using a jquery version that was minified in-house but this should have worked in any case if the file name is passed.&lt;/p&gt;</comment>
                            <comment id="16300281" author="hudson" created="Thu, 21 Dec 2017 16:58:42 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1418 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1418/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1418/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1141&quot; title=&quot;javascript files that contain &amp;quot;&amp;lt;html&amp;quot; are detected as text/html&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1141&quot;&gt;TIKA-1141&lt;/a&gt; - There is no unique magic for JavaScript files, no matter how (nick: &lt;a href=&quot;https://github.com/apache/tika/commit/97699598f000139b1222b785d634b3c8a8e216c7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/97699598f000139b1222b785d634b3c8a8e216c7&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1141&quot; title=&quot;javascript files that contain &amp;quot;&amp;lt;html&amp;quot; are detected as text/html&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1141&quot;&gt;TIKA-1141&lt;/a&gt; Few more well-known JS library headers (nick: &lt;a href=&quot;https://github.com/apache/tika/commit/700b38acb6443c30b4b05312a2010826fc618477&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/700b38acb6443c30b4b05312a2010826fc618477&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;(edit) tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17569267" author="tril" created="Thu, 21 Jul 2022 05:01:45 +0000"  >&lt;p&gt;I&apos;ve now run into this problem as well and am relatively shocked that there isn&apos;t a viable solution here yet.&lt;br/&gt;
The new Magic definitions also only work with non-minified jQuery files.&lt;br/&gt;
One of our customers now loaded a &lt;tt&gt;jquery-1.9.1.min.js&lt;/tt&gt; into our system, which was not recognized as JavaScript.&lt;br/&gt;
I had to add following magic sequences in &lt;tt&gt;custom-mimetypes.xml&lt;/tt&gt;:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;&amp;lt;!-- jQuery --&amp;gt;&lt;/span&gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;match value=&lt;span class=&quot;code-quote&quot;&gt;&quot;define(&amp;amp;quot;jquery&amp;amp;quot;,&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt; offset=&lt;span class=&quot;code-quote&quot;&gt;&quot;128:8192&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;match value=&lt;span class=&quot;code-quote&quot;&gt;&quot;.write(&amp;amp;quot;&amp;amp;lt;!doctype html&amp;amp;gt;&amp;amp;lt;html&amp;amp;gt;&amp;amp;lt;body&amp;amp;gt;&amp;amp;quot;)&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt; offset=&lt;span class=&quot;code-quote&quot;&gt;&quot;128:8192&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17569338" author="gagravarr" created="Thu, 21 Jul 2022 10:09:55 +0000"  >&lt;p&gt;I&apos;ve just checked &lt;a href=&quot;https://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js&lt;/a&gt; and Tika is able to correctly spot that it&apos;s javascript, despite the lack of any kind of magic headers in all JS files&lt;/p&gt;

&lt;p&gt;If someone has a spare week and fancies a fun research-type project, it ought to be possible to build a probabilistic &quot;text based file&quot; detector which would look for common tokens and patterns to take a guess. Won&apos;t always get it right, as HTML can contain a bit of JS and JS will normally have some HTML, but with the right tokenisation and some fiddling with the relative weightings I think you should be able to do a pretty good job.&lt;/p&gt;</comment>
                            <comment id="17569353" author="tril" created="Thu, 21 Jul 2022 11:02:34 +0000"  >&lt;p&gt;Our customer must have used a build tool that removed all comments. So the &lt;tt&gt;/*! jQuery&lt;/tt&gt; and &lt;tt&gt;sourceMappingURL&lt;/tt&gt; comment no longer available.&lt;br/&gt;
Relying on commentary sequences is quite adventurous.&lt;br/&gt;
On the other hand, it is also difficult to rely on code sequences, which may look different afterwards depending on the transformer. &#129300;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13431729">TIKA-3686</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12903220" name="jquery-2.0.3.js" size="125680" author="dagoltz" created="Thu, 21 Dec 2017 11:36:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>336150</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 16 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1lzen:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>336474</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>