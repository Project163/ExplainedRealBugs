<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:08:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2578] Mails not recognized when unknown X-headers are present</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2578</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Found some mails with leading X-headers.&lt;/p&gt;

&lt;p&gt;These mails are recognized as text/plain.&lt;/p&gt;

&lt;p&gt;One example is CISCOs IronPort, which might add &quot;X-IronPort-AV&quot; to the beginning of mails.&lt;/p&gt;

&lt;p&gt;Therefore I would like to discuss if and how TIKA shall handle these cases.&lt;/p&gt;

&lt;p&gt;In my opinion TIKA should try to detect files with x-headers and preprocess them to get a valid mail.&lt;/p&gt;

&lt;p&gt;Suggestion:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;mime-type type=&lt;span class=&quot;code-quote&quot;&gt;&quot;text/x-tika-x-header&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;magic priority=&lt;span class=&quot;code-quote&quot;&gt;&quot;50&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;match value=&lt;span class=&quot;code-quote&quot;&gt;&quot;X-&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt; offset=&lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;match value=&lt;span class=&quot;code-quote&quot;&gt;&quot;Message-ID:&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt; offset=&lt;span class=&quot;code-quote&quot;&gt;&quot;0:8192&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;match value=&lt;span class=&quot;code-quote&quot;&gt;&quot;From:&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;stringignorecase&quot;&lt;/span&gt; offset=&lt;span class=&quot;code-quote&quot;&gt;&quot;0:8192&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;match value=&lt;span class=&quot;code-quote&quot;&gt;&quot;To:&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;stringignorecase&quot;&lt;/span&gt; offset=&lt;span class=&quot;code-quote&quot;&gt;&quot;0:8192&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;match value=&lt;span class=&quot;code-quote&quot;&gt;&quot;Subject:&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt; offset=&lt;span class=&quot;code-quote&quot;&gt;&quot;0:8192&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;match value=&lt;span class=&quot;code-quote&quot;&gt;&quot;MIME-Version:&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;stringignorecase&quot;&lt;/span&gt; offset=&lt;span class=&quot;code-quote&quot;&gt;&quot;0:8192&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/match&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/magic&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;sub-class-of type=&lt;span class=&quot;code-quote&quot;&gt;&quot;text/x-tika-text-based-message&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/mime-type&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;See also: &lt;a href=&quot;https://tools.ietf.org/html/rfc6648&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;RFC6648&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Attached an example file.&lt;/p&gt;

&lt;p&gt;Regards&lt;/p&gt;

&lt;p&gt;Andreas&lt;/p&gt;</description>
                <environment></environment>
        <key id="13139607">TIKA-2578</key>
            <summary>Mails not recognized when unknown X-headers are present</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tallison">Tim Allison</assignee>
                                    <reporter username="AndreasMeier">Andreas Meier</reporter>
                        <labels>
                    </labels>
                <created>Tue, 20 Feb 2018 08:52:24 +0000</created>
                <updated>Tue, 29 Oct 2019 15:52:05 +0000</updated>
                            <resolved>Mon, 26 Feb 2018 22:31:26 +0000</resolved>
                                    <version>1.17</version>
                    <version>1.18</version>
                    <version>2.0.0</version>
                                    <fixVersion>1.18</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>detector</component>
                    <component>mime</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16377715" author="tallison@mitre.org" created="Mon, 26 Feb 2018 22:31:26 +0000"  >&lt;p&gt;Thank you, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=AndreasMeier&quot; class=&quot;user-hover&quot; rel=&quot;AndreasMeier&quot;&gt;AndreasMeier&lt;/a&gt;.  I look forward to running this updated version against our regression corpus.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lfcnassif&quot; class=&quot;user-hover&quot; rel=&quot;lfcnassif&quot;&gt;lfcnassif&lt;/a&gt;, if my proposed modifications are too broad, let me know.&lt;/p&gt;</comment>
                            <comment id="16377749" author="hudson" created="Mon, 26 Feb 2018 22:57:06 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1442 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1442/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1442/&lt;/a&gt;)&lt;br/&gt;
 &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2578&quot; title=&quot;Mails not recognized when unknown X-headers are present&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2578&quot;&gt;&lt;del&gt;TIKA-2578&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2587&quot; title=&quot;DKIM signed mails recognized as text/plain&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2587&quot;&gt;&lt;del&gt;TIKA-2587&lt;/del&gt;&lt;/a&gt; &amp;#8211; Allow for RFC822 detection for files (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/8289d0b704514067a57928905b3654486b5831eb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/8289d0b704514067a57928905b3654486b5831eb&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/mime/TestMimeTypes.java&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testRFC822_dkim.eml&lt;/li&gt;
	&lt;li&gt;(edit) CHANGES.txt&lt;/li&gt;
	&lt;li&gt;(edit) tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testRFC822_x-.eml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16377788" author="lfcnassif" created="Mon, 26 Feb 2018 23:35:39 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison%40mitre.org&quot; class=&quot;user-hover&quot; rel=&quot;tallison@mitre.org&quot;&gt;tallison@mitre.org&lt;/a&gt;&#160;I do not like too much widening From: To: and Subject: headers because they are common patterns. We have widened Return-Path: Received: and Reply-To: in our project. But the X- header presence may decrease the number of false positives. Let&apos;s see the regression tests results!&lt;/p&gt;</comment>
                            <comment id="16547149" author="yurykats" created="Tue, 17 Jul 2018 22:00:08 +0000"  >&lt;p&gt;I&apos;ve ran into the same issue with MBOX files, where X- headers at the top prevent proper mbox detection.&lt;br/&gt;
Current config:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  &amp;lt;mime-type type=&quot;application/mbox&quot;&amp;gt;
    &amp;lt;!-- MBOX files start with &quot;From [sender] [date]&quot; --&amp;gt;
    &amp;lt;!-- To avoid false matches, check for other headers after that --&amp;gt;
    &amp;lt;magic priority=&quot;70&quot;&amp;gt;
      &amp;lt;match value=&quot;From &quot; type=&quot;string&quot; offset=&quot;0&quot;&amp;gt;
         &amp;lt;match value=&quot;\nFrom: &quot; type=&quot;string&quot; offset=&quot;32:256&quot;/&amp;gt;
         &amp;lt;match value=&quot;\nDate: &quot; type=&quot;string&quot; offset=&quot;32:256&quot;/&amp;gt;
         &amp;lt;match value=&quot;\nSubject: &quot; type=&quot;string&quot; offset=&quot;32:256&quot;/&amp;gt;
         &amp;lt;match value=&quot;\nDelivered-To: &quot; type=&quot;string&quot; offset=&quot;32:256&quot;/&amp;gt;
         &amp;lt;match value=&quot;\nReceived: by &quot; type=&quot;string&quot; offset=&quot;32:256&quot;/&amp;gt;
         &amp;lt;match value=&quot;\nReceived: via &quot; type=&quot;string&quot; offset=&quot;32:256&quot;/&amp;gt;
         &amp;lt;match value=&quot;\nReceived: from &quot; type=&quot;string&quot; offset=&quot;32:256&quot;/&amp;gt;
         &amp;lt;match value=&quot;\nMime-Version: &quot; type=&quot;string&quot; offset=&quot;32:256&quot;/&amp;gt;
      &amp;lt;/match&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;mbox file:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;From &quot;naveen.andrews@enron.com&quot; Wed Jan 30 18:07:01 2002
X-EDO-Dataset: EnronData.org Abridged Email Dataset (AED)
X-EDO-AED-Version: 1.0
X-EDO-AED-License: Creative Commons Attribution 3.0 United States;
 http://creativecommons.org/licenses/by/3.0/us/;
 To provide attribution, please cite to &quot;EnronData.org.&quot;
X-EDO-AED-ID: 516172
X-EDO-AED-File: zipper-a/inbox/38.eml
Message-ID: &amp;lt;8269158.1075842014924.JavaMail.evans@thyme&amp;gt;
Date: Wed, 30 Jan 2002 15:07:01 -0800 (PST)
From: naveen.andrews@enron.com
To: andy.zipper@enron.com
Subject: RE: Var simulation
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12547381">TIKA-879</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13140448">TIKA-2587</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13172781">TIKA-2688</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12911202" name="testRFC822_with_leading_x_header" size="1857" author="AndreasMeier" created="Tue, 20 Feb 2018 08:36:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 17 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3qdcf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>