<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:08:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2714] Tika Parse Errors for certain attachments</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2714</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Tika fails to parse certain attachments that our customers send to our application.&lt;/p&gt;

&lt;p&gt;We got a sample rar file from our customer that fails parsing, it only has simple pdf files in them&#160; and we were able to re-produce the issue.&lt;/p&gt;

&lt;p&gt;However. If WE create a new rar file out of the same contents (using winrar) and try to parse it, that succeeds.&#160;&lt;/p&gt;

&lt;p&gt;The rar file that our customer used is not encrypted or corrupted. Not sure why their rar file fails parsing, but a new rar file with same contents succeeds.&lt;/p&gt;

&lt;p&gt;Can you please provide a solution or feedback to this problem?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Below is the exception thrown when we try to parse the rar file attachment from our customer:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Aug 02, 2018 5:04:09 AM com.github.junrar.Archive setFile&lt;/p&gt;

&lt;p&gt;WARNING: exception in archive constructor maybe file is encrypted or currupt&lt;/p&gt;

&lt;p&gt;com.github.junrar.exception.RarException: badRarArchive&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at com.github.junrar.Archive.readHeaders(Archive.java:250)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at com.github.junrar.Archive.setFile(Archive.java:136)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at com.github.junrar.Archive.setVolume(Archive.java:581)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at com.github.junrar.Archive.&amp;lt;init&amp;gt;(Archive.java:108)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at com.github.junrar.Archive.&amp;lt;init&amp;gt;(Archive.java:113)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at org.apache.tika.parser.pkg.RarParser.parse(RarParser.java:72)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:281)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:281)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:120)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at com.actiance.platform.sfab.cis.etl.documentProcessor.internal.DocumentProcessorImpl.getExtractedContent(DocumentProcessorImpl.java:160)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at test.TikaParserAPIExample.main(TikaParserAPIExample.java:31)&lt;/p&gt;

&lt;p&gt;org.apache.tika.exception.TikaException: Unexpected RuntimeException from &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;mailto:org.apache.tika.parser.pkg.RarParser@1372ed45&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;org.apache.tika.parser.pkg.RarParser@1372ed45&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/mail_small.gif&quot; height=&quot;12&quot; width=&quot;13&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:283)&lt;/p&gt;

&lt;p&gt;05:04:09.488 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; DEBUG com.actiance.platform.commons.spi.FileReaderUtils - Deleted Temp File - 0a44423c-6fad-47e6-943b-7b56178b0b7f.tmp&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:281)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:120)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at com.actiance.platform.sfab.cis.etl.documentProcessor.internal.DocumentProcessorImpl.getExtractedContent(DocumentProcessorImpl.java:160)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at test.TikaParserAPIExample.main(TikaParserAPIExample.java:31)&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.NullPointerException: mainheader is null&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at com.github.junrar.Archive.isEncrypted(Archive.java:206)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at org.apache.tika.parser.pkg.RarParser.parse(RarParser.java:74)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:281)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160; ... 4 more&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13180083">TIKA-2714</key>
            <summary>Tika Parse Errors for certain attachments</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sumanmoorthy">Suman Moorthy</reporter>
                        <labels>
                    </labels>
                <created>Mon, 20 Aug 2018 22:47:50 +0000</created>
                <updated>Wed, 11 Mar 2020 17:22:46 +0000</updated>
                                            <version>1.9</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16593971" author="tallison@mitre.org" created="Mon, 27 Aug 2018 17:18:21 +0000"  >&lt;p&gt;This looks like an underlying problem with the junrar library.  You might try asking Beothorn over on: &lt;a href=&quot;https://github.com/junrar/junrar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/junrar/junrar&lt;/a&gt; .  I regret that we can&apos;t fix this at the Tika level.&lt;/p&gt;</comment>
                            <comment id="17056777" author="harirehm" created="Wed, 11 Mar 2020 09:16:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison&quot; class=&quot;user-hover&quot; rel=&quot;tallison&quot;&gt;tallison&lt;/a&gt;, it turns out that files that are compressed using rar5 format of Winrar will throw this exception, as junrar does not support rar5 format decompression. And it looks like Beothorn is not planning to support rar5 format either.&lt;/p&gt;

&lt;p&gt;Do you have any scope for adding rar5 support in tika by any other means?&lt;/p&gt;</comment>
                            <comment id="17056994" author="tallison@mitre.org" created="Wed, 11 Mar 2020 13:24:12 +0000"  >&lt;p&gt;I personally don&apos;t have time to develop a rar5 parser.  If you can find a java-based ASL-2.0 friendly parser, I&apos;d be happy to add it to Tika.  If you can find any parser,, even if it is a commandline utility, with a license that you can accept, I can show you how to wrap that in the Tika framework.&lt;/p&gt;</comment>
                            <comment id="17056999" author="tallison@mitre.org" created="Wed, 11 Mar 2020 13:25:49 +0000"  >&lt;p&gt;No matter what, we should be detecting rar5 and throwing an unsupported exception rather than the exception that you found. &lt;/p&gt;</comment>
                            <comment id="17057012" author="tallison@mitre.org" created="Wed, 11 Mar 2020 13:43:33 +0000"  >&lt;p&gt;This has some great info and useful pointers to rarlab&apos;s technote: &lt;a href=&quot;https://www.loc.gov/preservation/digital/formats/fdd/fdd000460.shtml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.loc.gov/preservation/digital/formats/fdd/fdd000460.shtml&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We should be able to differentiate based only on magic, which is great.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;, recommendations for the mime type for rar5?&lt;/p&gt;</comment>
                            <comment id="17057022" author="gagravarr" created="Wed, 11 Mar 2020 13:58:23 +0000"  >&lt;p&gt;From &lt;a href=&quot;https://www.rarlab.com/technote.htm&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.rarlab.com/technote.htm&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3&gt;&lt;a name=&quot;RAR5.0signature&quot;&gt;&lt;/a&gt;RAR 5.0 signature&lt;/h3&gt;

&lt;p&gt;RAR 5.0 signature consists of 8 bytes: 0x52 0x61 0x72 0x21 0x1A 0x07 0x01 0x00. You need to search for this signature in supposed archive from beginning and up to maximum SFX module size. Just for comparison this is RAR 4.x 7 byte length signature: 0x52 0x61 0x72 0x21 0x1A 0x07 0x00.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;Not sure if we want to scan for it all the way to the end of the possible self-extracting block (1mb), but at offset 0 should be fine&lt;/p&gt;</comment>
                            <comment id="17057026" author="tallison@mitre.org" created="Wed, 11 Mar 2020 14:01:38 +0000"  >&lt;p&gt;Sounds good, what should we call it &lt;tt&gt;&amp;lt;mime-type type=&quot;application/x-rar-compressed;version=5&quot;&amp;gt;&lt;/tt&gt;?&lt;/p&gt;</comment>
                            <comment id="17057039" author="gagravarr" created="Wed, 11 Mar 2020 14:14:00 +0000"  >&lt;p&gt;Seems good to me.&lt;/p&gt;

&lt;p&gt;Since we know the magic for v4, we can add that in too, both as subtypes of the main one (which has a shorter magic match as a catch-all)&lt;/p&gt;</comment>
                            <comment id="17057111" author="tallison@mitre.org" created="Wed, 11 Mar 2020 15:27:56 +0000"  >&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  &amp;lt;mime-type type=&quot;application/x-rar-compressed&quot;&amp;gt;
    &amp;lt;_comment&amp;gt;RAR archive&amp;lt;/_comment&amp;gt;
    &amp;lt;alias type=&quot;application/x-rar&quot;/&amp;gt;
    &amp;lt;magic priority=&quot;50&quot;&amp;gt;
      &amp;lt;match value=&quot;Rar!&quot; type=&quot;string&quot; offset=&quot;0&quot;/&amp;gt;
      &amp;lt;match value=&quot;\x52\x61\x72\x21\x1a&quot; type=&quot;string&quot; offset=&quot;0&quot;/&amp;gt;
    &amp;lt;/magic&amp;gt;
    &amp;lt;glob pattern=&quot;*.rar&quot;/&amp;gt;
  &amp;lt;/mime-type&amp;gt;
  &amp;lt;mime-type type=&quot;application/x-rar-compressed;version=4&quot;&amp;gt;
    &amp;lt;_comment&amp;gt;RAR archive&amp;lt;/_comment&amp;gt;
    &amp;lt;magic priority=&quot;60&quot;&amp;gt;
      &amp;lt;match value=&quot;\x52\x61\x72\x21\x1a\x07\x00&quot; type=&quot;string&quot; offset=&quot;0&quot;/&amp;gt;
    &amp;lt;/magic&amp;gt;
    &amp;lt;sub-class-of type=&quot;application/x-rar-compressed&quot;/&amp;gt;
  &amp;lt;/mime-type&amp;gt;
  &amp;lt;mime-type type=&quot;application/x-rar-compressed;version=5&quot;&amp;gt;
    &amp;lt;_comment&amp;gt;RAR archive&amp;lt;/_comment&amp;gt;
    &amp;lt;magic priority=&quot;60&quot;&amp;gt;
      &amp;lt;match value=&quot;\x52\x61\x72\x21\x1a\x07\x01\x00&quot; type=&quot;string&quot; offset=&quot;0&quot;/&amp;gt;
    &amp;lt;/magic&amp;gt;
    &amp;lt;sub-class-of type=&quot;application/x-rar-compressed&quot;/&amp;gt;
  &amp;lt;/mime-type&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17057230" author="hudson" created="Wed, 11 Mar 2020 17:15:37 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Jenkins build tika-branch-1x #322 (See &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/322/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/322/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2714&quot; title=&quot;Tika Parse Errors for certain attachments&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2714&quot;&gt;TIKA-2714&lt;/a&gt; &amp;#8211; add detection for rar4 and rar5 files; throw an (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/fec8db0431a930a867093200a95e9e71f1977f86&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/fec8db0431a930a867093200a95e9e71f1977f86&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/pkg/RarParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/pkg/RarParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17057236" author="hudson" created="Wed, 11 Mar 2020 17:22:46 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1790 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1790/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1790/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2714&quot; title=&quot;Tika Parse Errors for certain attachments&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2714&quot;&gt;TIKA-2714&lt;/a&gt; &amp;#8211; add detection for rar4 and rar5 files; throw an (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/7b83f7538c788af4cd1c9e997e64dc550e733dee&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/7b83f7538c788af4cd1c9e997e64dc550e733dee&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/pkg/RarParser.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/pkg/RarParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 35 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3x8o7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>