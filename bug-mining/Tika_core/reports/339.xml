<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:08:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-3496] Allow users to specify a default timezone when a file format doesn&apos;t store the tz</title>
                <link>https://issues.apache.org/jira/browse/TIKA-3496</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;In working on the Solr pipe emitter, I noticed that some dates as stored in our Metadata do not have a timezone, which causes a problem for Solr.&lt;/p&gt;

&lt;p&gt;I noticed this issue in a JPEG with date: &quot;2011-06-11T09:30:54&quot;. &lt;/p&gt;

&lt;p&gt;In a comment in our JPEG parser, I see:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;// Unless we have GPS time we don&apos;t know the time zone so date must be set
                // as ISO 8601 datetime without timezone suffix (no Z or +/-)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So, the question is should we try to add a timezone (arbitrarily assign &apos;Z&apos;) in the Solr (and OpenSearch) emitter or should we store the date as if it were Z in the JPEG parser?  &lt;/p&gt;

&lt;p&gt;Or do something else?&lt;/p&gt;

&lt;p&gt;The challenge with doing anything on the emitter side, is that we aren&apos;t currently storing the property type in the metadata.  So, at emit time, we only have string keys and string values.  We can&apos;t easily guess which fields should be a date in order to reformat for the sake of Solr. We could make a request to Solr/OpenSearch to figure out what the field types are, but that seems really awful...&lt;/p&gt;

&lt;p&gt;Ideas?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13391601">TIKA-3496</key>
            <summary>Allow users to specify a default timezone when a file format doesn&apos;t store the tz</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tallison">Tim Allison</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Jul 2021 17:26:43 +0000</created>
                <updated>Tue, 17 Aug 2021 13:30:07 +0000</updated>
                            <resolved>Fri, 23 Jul 2021 21:22:35 +0000</resolved>
                                                    <fixVersion>2.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17386415" author="tallison@mitre.org" created="Fri, 23 Jul 2021 17:35:31 +0000"  >&lt;p&gt;My current preference would be to store the Property in the Metadata object so that at emit time, we could determine if the value is supposed to be a date.&lt;/p&gt;

&lt;p&gt;I don&apos;t want to run afoul of the point of that JPEG comment, and I don&apos;t want to deal with figuring out what the emit-target thinks the date is...&lt;/p&gt;

&lt;p&gt;The other issue is that even if it were right to fix the issue in the JPEG parser, we&apos;ll probably have this issue in other parsers currently in new parsers in the future.&lt;/p&gt;</comment>
                            <comment id="17386428" author="gagravarr" created="Fri, 23 Jul 2021 17:55:07 +0000"  >&lt;p&gt;If there is no timezone stored in the original file, I don&apos;t think we should be adding one, we should be honest to users that it&apos;s a timezone-naive datetime. That means returning it as just date+time, no timezone&lt;/p&gt;

&lt;p&gt;If a given system we&apos;re passing data to refuses to accept timezone-naive dates, our least-worst option is to slap the local machine&apos;s local zone on&lt;/p&gt;

&lt;p&gt;If the file format has timezone info we should get our parsers to extract it, but if the format lacks a timezone I don&apos;t think there&apos;s really anything more we can/should do at the metadata properties level&lt;/p&gt;</comment>
                            <comment id="17386493" author="tallison@mitre.org" created="Fri, 23 Jul 2021 19:19:09 +0000"  >&lt;p&gt;Thank you, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;.  This makes sense.  I&apos;ll implement the least-worst option and require users to &quot;opt in&quot; by selecting a DateNormalizing metadata filter.&lt;/p&gt;

&lt;p&gt;On the good news, I hadn&apos;t realized that Property keeps a static map of all properties created so we don&apos;t need to modify the Metadata object...onwards and thank you!&lt;/p&gt;</comment>
                            <comment id="17386546" author="tallison@mitre.org" created="Fri, 23 Jul 2021 21:23:46 +0000"  >&lt;p&gt;Users can also specify what they&apos;d like the default timezone to be in those cases where the file format doesn&apos;t store the timezone.  Thank you, again, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="17386577" author="hudson" created="Fri, 23 Jul 2021 23:04:10 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-main-jdk8 #289 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/289/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/289/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3496&quot; title=&quot;Allow users to specify a default timezone when a file format doesn&amp;#39;t store the tz&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3496&quot;&gt;&lt;del&gt;TIKA-3496&lt;/del&gt;&lt;/a&gt; &amp;#8211; add a metadatafilter to allow users to ensure that dates emitted to Solr/OpenSearch are all UTC &apos;Z&apos; formatted. (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/381b36e8cc9a83fb34f22a74eaf20b86c78b6274&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/381b36e8cc9a83fb34f22a74eaf20b86c78b6274&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(add) tika-pipes/tika-emitters/tika-emitter-solr/src/test/java/org/apache/tika/pipes/emitter/solr/SolrEmitterDevTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-integration-tests/tika-pipes-solr-integration-tests/src/test/resources/tika-config-solr-urls.xml&lt;/li&gt;
	&lt;li&gt;(edit) tika-integration-tests/tika-pipes-opensearch-integration-tests/src/test/resources/opensearch/tika-config-opensearch.xml&lt;/li&gt;
	&lt;li&gt;(add) tika-core/src/main/java/org/apache/tika/metadata/filter/DateNormalizingMetadataFilter.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-core/src/test/java/org/apache/tika/metadata/filter/TestMetadataFilter.java&lt;/li&gt;
	&lt;li&gt;(edit) CHANGES.txt&lt;/li&gt;
	&lt;li&gt;(edit) tika-core/src/main/java/org/apache/tika/metadata/Property.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 16 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ta6g:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>