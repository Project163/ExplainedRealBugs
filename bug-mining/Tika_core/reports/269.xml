<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:08:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2454] Emails extracted from PSTs detected as unexpected file types</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2454</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;This issue is severe. The Outlook PST parser extracts a string for the body of every email and passes that string to the &lt;tt&gt;EmbeddedDocumentExtractor&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;However, no content type is set on the &lt;tt&gt;Metadata&lt;/tt&gt; object passed to the extractor. Therefore, if for example, the body of the email starts with the string &quot;From John Smith.&quot; (for example, when an email was forwarded), then body of the email is detected as &lt;tt&gt;application/mbox&lt;/tt&gt; and parsed as though it were an mbox file.&lt;/p&gt;

&lt;p&gt;I think the immediate fix for this issue is to force the type of the email to &lt;tt&gt;text/plain&lt;/tt&gt; and for it to be parsed as such.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13098613">TIKA-2454</key>
            <summary>Emails extracted from PSTs detected as unexpected file types</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mcaruanagalizia">Matthew Caruana Galizia</reporter>
                        <labels>
                    </labels>
                <created>Wed, 30 Aug 2017 17:33:51 +0000</created>
                <updated>Thu, 31 Aug 2017 00:56:45 +0000</updated>
                            <resolved>Wed, 30 Aug 2017 20:15:17 +0000</resolved>
                                    <version>1.16</version>
                                    <fixVersion>1.17</fixVersion>
                                    <component>detector</component>
                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16147831" author="tallison@mitre.org" created="Wed, 30 Aug 2017 18:52:47 +0000"  >&lt;p&gt;We&apos;ve had discussions on and off about whether we should have an &quot;override&quot; detector &amp;#8211; a dummy detector that returns whatever the user sends in via the metadata.  I think this is the issue that forces this.&lt;/p&gt;

&lt;p&gt;I tried playing around with swapping out the parser in the ParsingEmbeddedDocumentExtractor or otherwise trying to apply a different parser to the ParseContext (as in the OutlookExtractor and the JackcessExtractor), but those options don&apos;t work.&lt;/p&gt;</comment>
                            <comment id="16147907" author="mcaruanagalizia" created="Wed, 30 Aug 2017 19:46:58 +0000"  >&lt;p&gt;I agree with you. The fact that you can&apos;t force the type means that PST parsing is completely broken.&lt;/p&gt;</comment>
                            <comment id="16147973" author="tallison@mitre.org" created="Wed, 30 Aug 2017 20:12:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mcaruanagalizia&quot; class=&quot;user-hover&quot; rel=&quot;mcaruanagalizia&quot;&gt;mcaruanagalizia&lt;/a&gt; and fellow Tika devs, let me know how that looks.  I put the override logic in CompositeDetector.&lt;/p&gt;

&lt;p&gt;As a side note, I&apos;m not sure why we aren&apos;t getting &amp;lt;b&amp;gt; markup now that we&apos;re grabbing the html instead of the text for the body when it exists in the new test pst file I added.  For another issue...&lt;/p&gt;</comment>
                            <comment id="16147978" author="tallison@mitre.org" created="Wed, 30 Aug 2017 20:15:17 +0000"  >&lt;p&gt;This should be fixed. Please re-open if there is a more elegant way of accomplishing this or if there are surprises.&lt;/p&gt;

&lt;p&gt;We have to rely on the PST library for correct encoding of both the body text and the html.&lt;/p&gt;</comment>
                            <comment id="16148043" author="hudson" created="Wed, 30 Aug 2017 20:57:35 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1353 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1353/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1353/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2454&quot; title=&quot;Emails extracted from PSTs detected as unexpected file types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2454&quot;&gt;&lt;del&gt;TIKA-2454&lt;/del&gt;&lt;/a&gt;: add OverrideDetector and allow PSTParser to specify body (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/83f1afae3db65af966b13e6cc6dae3872aef630f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/83f1afae3db65af966b13e6cc6dae3872aef630f&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/resources/META-INF/services/org.apache.tika.detect.Detector&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testPST_variousBodyTypes.pst&lt;/li&gt;
	&lt;li&gt;(edit) CHANGES.txt&lt;/li&gt;
	&lt;li&gt;(edit) tika-core/src/main/java/org/apache/tika/detect/CompositeDetector.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/mbox/OutlookPSTParser.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/mbox/OutlookPSTParserTest.java&lt;/li&gt;
	&lt;li&gt;(add) tika-core/src/main/java/org/apache/tika/detect/OverrideDetector.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-core/src/main/java/org/apache/tika/metadata/TikaCoreProperties.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2454&quot; title=&quot;Emails extracted from PSTs detected as unexpected file types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2454&quot;&gt;&lt;del&gt;TIKA-2454&lt;/del&gt;&lt;/a&gt;: don&apos;t process the htmlbody.  There could be encoding (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/e0ff3ebff559bcdad690498d40898d426c0b2b02&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/e0ff3ebff559bcdad690498d40898d426c0b2b02&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/mbox/OutlookPSTParser.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/mbox/OutlookPSTParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16148079" author="lfcnassif" created="Wed, 30 Aug 2017 21:27:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;tallison@apache.org&quot;&gt;tallison@apache.org&lt;/a&gt;, are you the flash? I was thinking about Content-Type-Trusted, but Override is ok.&lt;/p&gt;

&lt;p&gt;I think we should do similar changes in MBoxParser to fix its children mediaType, given the recurrent detection problems with message/rfc822.&lt;/p&gt;</comment>
                            <comment id="16148117" author="mcaruanagalizia" created="Wed, 30 Aug 2017 21:59:04 +0000"  >&lt;p&gt;I don&apos;t know if the same thing can be done wholesale for mbox files. There are four variants of emails in mbox files: &lt;a href=&quot;http://www.forensicswiki.org/wiki/MBox#MBOX_File_Variants&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.forensicswiki.org/wiki/MBox#MBOX_File_Variants&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16148251" author="lfcnassif" created="Thu, 31 Aug 2017 00:23:04 +0000"  >&lt;p&gt;Those look like 4 variants of the (container) mbox format. But all of them contain rfc822 emails, which detection can fail as you have already noted on &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2042&quot; title=&quot;MBOX file detected wrongly as text/html&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2042&quot;&gt;&lt;del&gt;TIKA-2042&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-879&quot; title=&quot;Detection problem: message/rfc822 file is detected as text/plain.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-879&quot;&gt;&lt;del&gt;TIKA-879&lt;/del&gt;&lt;/a&gt;. I propose changing line 105 of MBoxParser to:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;mailMetadata.set(Metadata.CONTENT_TYPE_OVERRIDE, &lt;span class=&quot;code-quote&quot;&gt;&quot;message/rfc822&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Will do if &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;tallison@apache.org&quot;&gt;tallison@apache.org&lt;/a&gt; does not beat me...&lt;/p&gt;</comment>
                            <comment id="16148257" author="tallison@mitre.org" created="Thu, 31 Aug 2017 00:30:20 +0000"  >&lt;p&gt;Commit away!&lt;/p&gt;</comment>
                            <comment id="16148283" author="hudson" created="Thu, 31 Aug 2017 00:56:45 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1354 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1354/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1354/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2454&quot; title=&quot;Emails extracted from PSTs detected as unexpected file types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2454&quot;&gt;&lt;del&gt;TIKA-2454&lt;/del&gt;&lt;/a&gt;: cleanup unused TEXT_PARSER thanks to Matthew Caruana Galizia (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/3eff3ac86cb826faf76d98fb80147c28a4eb7562&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/3eff3ac86cb826faf76d98fb80147c28a4eb7562&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/mbox/OutlookPSTParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 11 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3jgm7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>