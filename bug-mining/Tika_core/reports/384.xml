<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:09:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-4199] commons-compress 1.26.0 breaks Apache Tika 2.9.1</title>
                <link>https://issues.apache.org/jira/browse/TIKA-4199</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;An update to commons-compress 1.26.0 to fix CVE-2024-25710 and CVE-2024-26308 breaks Tika.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;For more information see &lt;a href=&quot;https://issues.apache.org/jira/browse/COMPRESS-661&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/COMPRESS-661&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13569188">TIKA-4199</key>
            <summary>commons-compress 1.26.0 breaks Apache Tika 2.9.1</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="veita">Alexander Veit</reporter>
                        <labels>
                    </labels>
                <created>Tue, 20 Feb 2024 11:49:55 +0000</created>
                <updated>Fri, 15 Mar 2024 12:21:17 +0000</updated>
                            <resolved>Sat, 9 Mar 2024 10:58:15 +0000</resolved>
                                    <version>2.9.1</version>
                                    <fixVersion>2.9.2</fixVersion>
                    <fixVersion>3.0.0</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17818774" author="tilman" created="Tue, 20 Feb 2024 11:51:24 +0000"  >&lt;p&gt;I&apos;m working on it&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/tika/pull/1605&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/1605&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17818823" author="tilman" created="Tue, 20 Feb 2024 14:21:46 +0000"  >&lt;p&gt;After merging I discovered that the SevenZWrapper class is incomplete (markSupported / mark / reset was missing, and many more). I tested reverting my one-line change, and some of the previously failing tests (e.g. the 7z tests) were now succeeding. So this kindof suggests that the cause is related to markSupported  / mark / reset. If we ever find that cause, then the one-line change in &lt;tt&gt;PackageParser&lt;/tt&gt; can be removed because it makes things slower.&lt;/p&gt;</comment>
                            <comment id="17818846" author="tallison@mitre.org" created="Tue, 20 Feb 2024 14:55:17 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; for working on this! I&apos;m sorry I opened a duplicate ticket.&lt;/p&gt;

&lt;p&gt;To confirm, the current workaround is to write each embedded file to disc instead of handling in memory --&amp;gt; &lt;tt&gt;tis.getPath()&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;If I have any time, I&apos;ll see if I can create a small reproducer for the commons-compress team that uses mark/reset on a wrapped ArchiveInputStream. To be clear, without looking further, I&apos;m not declaring this a problem with commons-compress! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/biggrin.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17818853" author="tallison@mitre.org" created="Tue, 20 Feb 2024 15:07:14 +0000"  >&lt;p&gt;As I look at the IWorkPackageParser and the detectType(), I think we should rework the mark/reset there. There&apos;s currently no hard limit on the number of bytes read when trying to extract the root element. So, it is entirely possible that more than the mark() value is read. I think we happened to get lucky earlier, and we&apos;re relying on the same luck by doubling the mark value.&lt;/p&gt;</comment>
                            <comment id="17818867" author="tilman" created="Tue, 20 Feb 2024 15:37:31 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;m not declaring this a problem with commons-compress!&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;My bet was 51% it&apos;s with Tika but from the latest test code you inspired me to write in &lt;a href=&quot;https://issues.apache.org/jira/browse/COMPRESS-661&quot; title=&quot;ArchiveInputStream markSupported should always return false&quot; class=&quot;issue-link&quot; data-issue-key=&quot;COMPRESS-661&quot;&gt;&lt;del&gt;COMPRESS-661&lt;/del&gt;&lt;/a&gt;, it might be them or BufferedInputStream itself, or a misunderstanding how BufferedInputStream works.&lt;/p&gt;

&lt;p&gt;I also found another incomplete delegate class (BoundedInputStream), I&apos;ll complete that one too.&lt;/p&gt;</comment>
                            <comment id="17818871" author="tallison@mitre.org" created="Tue, 20 Feb 2024 15:40:09 +0000"  >&lt;p&gt;I opened &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-4201&quot; title=&quot;Add hard limit to stream reading in IWorksParser#detectType&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-4201&quot;&gt;TIKA-4201&lt;/a&gt; to add a hard limit to the read in the IWorksParser.&lt;/p&gt;</comment>
                            <comment id="17818877" author="hudson" created="Tue, 20 Feb 2024 15:53:06 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-main-jdk11 #1516 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk11/1516/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk11/1516/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-4199&quot; title=&quot;commons-compress 1.26.0 breaks Apache Tika 2.9.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-4199&quot;&gt;&lt;del&gt;TIKA-4199&lt;/del&gt;&lt;/a&gt;: complete delegate class (tilman: &lt;a href=&quot;https://github.com/apache/tika/commit/e5d57528d92fe41bd2c7ba4545323e8b9cae4883&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/e5d57528d92fe41bd2c7ba4545323e8b9cae4883&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-pkg-module/src/main/java/org/apache/tika/parser/pkg/PackageParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17818905" author="hudson" created="Tue, 20 Feb 2024 16:54:09 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build Tika &#187; tika-main-jdk11 #1517 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk11/1517/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk11/1517/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-4199&quot; title=&quot;commons-compress 1.26.0 breaks Apache Tika 2.9.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-4199&quot;&gt;&lt;del&gt;TIKA-4199&lt;/del&gt;&lt;/a&gt;: complete delegate class (tilman: &lt;a href=&quot;https://github.com/apache/tika/commit/a3a830359f088f216ffaca31bf640e296d72531a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/a3a830359f088f216ffaca31bf640e296d72531a&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-core/src/main/java/org/apache/tika/io/BoundedInputStream.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17818937" author="tilman" created="Tue, 20 Feb 2024 18:33:11 +0000"  >&lt;p&gt;I tried an another solution&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (archive.markSupported())
{
    archive = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArchiveInputStreamWrapper(archive);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;which also works. The wrapper delegates all except markSupported. I&apos;ll wait a few days if the commons compress people fix this. If not then I&apos;ll commit that solution.&lt;/p&gt;</comment>
                            <comment id="17819093" author="hudson" created="Wed, 21 Feb 2024 06:43:14 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-main-jdk11 #1520 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk11/1520/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk11/1520/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-4199&quot; title=&quot;commons-compress 1.26.0 breaks Apache Tika 2.9.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-4199&quot;&gt;&lt;del&gt;TIKA-4199&lt;/del&gt;&lt;/a&gt;: replace deprecated (tilman: &lt;a href=&quot;https://github.com/apache/tika/commit/a305ab772277db6cdcbd60653e6cf1eb147a1df7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/a305ab772277db6cdcbd60653e6cf1eb147a1df7&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-pkg-module/src/main/java/org/apache/tika/parser/pkg/PackageParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17823577" author="hudson" created="Tue, 5 Mar 2024 11:45:04 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-main-jdk11 #1540 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk11/1540/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk11/1540/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-4199&quot; title=&quot;commons-compress 1.26.0 breaks Apache Tika 2.9.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-4199&quot;&gt;&lt;del&gt;TIKA-4199&lt;/del&gt;&lt;/a&gt;: add comment, print to stderr (tilman: &lt;a href=&quot;https://github.com/apache/tika/commit/32ef34ff49ccd6a8a7e595861216e66666fdeded&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/32ef34ff49ccd6a8a7e595861216e66666fdeded&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-package/src/test/java/org/apache/tika/parser/pkg/Seven7ParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17824923" author="tilman" created="Sat, 9 Mar 2024 10:58:15 +0000"  >&lt;p&gt;Commons-Compress has been updated to 1.26.1, I have reverted the workaround and a change that wasn&apos;t helpful.&lt;/p&gt;</comment>
                            <comment id="17824933" author="hudson" created="Sat, 9 Mar 2024 12:07:55 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-main-jdk11 #1544 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk11/1544/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk11/1544/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-4199&quot; title=&quot;commons-compress 1.26.0 breaks Apache Tika 2.9.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-4199&quot;&gt;&lt;del&gt;TIKA-4199&lt;/del&gt;&lt;/a&gt;: revert &quot;complete delegate class&quot;, field &quot;in&quot; is a dummy; remove workaround for commons-compress 1.26 (tilman: &lt;a href=&quot;https://github.com/apache/tika/commit/8b398201a969b952bfee3166cec1395ae409071b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/8b398201a969b952bfee3166cec1395ae409071b&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-pkg-module/src/main/java/org/apache/tika/parser/pkg/PackageParser.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-4199&quot; title=&quot;commons-compress 1.26.0 breaks Apache Tika 2.9.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-4199&quot;&gt;&lt;del&gt;TIKA-4199&lt;/del&gt;&lt;/a&gt;: adjust test results now that commons compress bug has been fixed (tilman: &lt;a href=&quot;https://github.com/apache/tika/commit/5b259d60a490699252ea582aaec02a3575e4f7ff&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/5b259d60a490699252ea582aaec02a3575e4f7ff&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-package/src/test/java/org/apache/tika/parser/microsoft/ooxml/TruncatedOOXMLTest.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-4199&quot; title=&quot;commons-compress 1.26.0 breaks Apache Tika 2.9.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-4199&quot;&gt;&lt;del&gt;TIKA-4199&lt;/del&gt;&lt;/a&gt;: update commons-compress (tilman: &lt;a href=&quot;https://github.com/apache/tika/commit/4d6acfc109f842421030e05c33794bc8090caebb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/4d6acfc109f842421030e05c33794bc8090caebb&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;(edit) tika-parent/pom.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17826992" author="veita" created="Thu, 14 Mar 2024 08:23:05 +0000"  >&lt;p&gt;The same error also occurs with Tika 2.9.1 and commons-compress 1.26.1.&lt;/p&gt;</comment>
                            <comment id="17826996" author="tilman" created="Thu, 14 Mar 2024 08:40:23 +0000"  >&lt;p&gt;The original error you reported wasn&apos;t really a bug in commons compress, rather a change that more bytes were read than tika expected, see my first comment in &lt;a href=&quot;https://issues.apache.org/jira/browse/COMPRESS-661&quot; title=&quot;ArchiveInputStream markSupported should always return false&quot; class=&quot;issue-link&quot; data-issue-key=&quot;COMPRESS-661&quot;&gt;&lt;del&gt;COMPRESS-661&lt;/del&gt;&lt;/a&gt;. It resulted in several fixes in tika.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13569191">TIKA-4200</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13572042">TIKA-4214</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13569161">COMPRESS-661</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>Java</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 34 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1nia0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>