<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:07:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-1689] Parser sort order change in TIKA-1517 breaks parser override capability</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1689</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;In Tika 1.9, the comparator used to sort parsers (in ServiceLoaderUtils) now returns them in the reverse order from how they were returned in prior versions, when the comparator was in DefaultParser.  This work was done under &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1517&quot; title=&quot;MIME type selection with probability&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1517&quot;&gt;&lt;del&gt;TIKA-1517&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;This change broke one of our customizations in which we use our own parser instead of Tika&apos;s HtmlParser to process html.  We use the service loader logic (creating our own META-INF/services/org.apache.tika.parser.Parser file) and rely on the order in which the list returned by DefaultParser.getDefaultParsers() is evaluated.    Expecting that when Tika builds the map of mime types to parsers it first puts in entries for HtmlParser, then overwrites these with our custom parser.  &lt;/p&gt;

&lt;p&gt;I realize relying on this is brittle.  And I found a valid workaround to the problem in Tika 1.9 is to blacklist HtmlParser.  However, in case this parser ordering change was not intentional, I figured I&apos;d mention it.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12845711">TIKA-1689</key>
            <summary>Parser sort order change in TIKA-1517 breaks parser override capability</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dwarren">David Warren</reporter>
                        <labels>
                    </labels>
                <created>Thu, 16 Jul 2015 20:35:05 +0000</created>
                <updated>Tue, 29 Oct 2019 15:51:59 +0000</updated>
                            <resolved>Fri, 24 Jul 2015 18:25:29 +0000</resolved>
                                    <version>1.9</version>
                                    <fixVersion>1.10</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14631212" author="tallison@mitre.org" created="Fri, 17 Jul 2015 11:27:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwarren&quot; class=&quot;user-hover&quot; rel=&quot;dwarren&quot;&gt;dwarren&lt;/a&gt;, thank you for raising this.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chrismattmann&quot; class=&quot;user-hover&quot; rel=&quot;chrismattmann&quot;&gt;chrismattmann&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Lukeliush&quot; class=&quot;user-hover&quot; rel=&quot;Lukeliush&quot;&gt;Lukeliush&lt;/a&gt;, this seems like a pretty serious change in the API, no?&lt;/p&gt;</comment>
                            <comment id="14632907" author="gagravarr" created="Sun, 19 Jul 2015 19:37:18 +0000"  >&lt;p&gt;I believe we should still be preferring non-Tika parsers/detectors over Tika ones, even without the much-discussed proposed changes to let ordering be config-controlled for those who need full control. &lt;/p&gt;

&lt;p&gt;If we really have accidentally swapped the ordering, I&apos;d say we should change it back + add a unit test to ensure that non-Tika ones come first. (The Ogg parsers are always included, but in a non-Tika namespace, so can be used for checking this logic with)&lt;/p&gt;</comment>
                            <comment id="14640350" author="tallison@mitre.org" created="Fri, 24 Jul 2015 11:56:40 +0000"  >&lt;p&gt;To confirm &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwarren&quot; class=&quot;user-hover&quot; rel=&quot;dwarren&quot;&gt;dwarren&lt;/a&gt;&apos;s point and to supplement with detail...it turns out this change happened in some cleanup to &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1517&quot; title=&quot;MIME type selection with probability&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1517&quot;&gt;&lt;del&gt;TIKA-1517&lt;/del&gt;&lt;/a&gt; (&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1677328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;r1677328&lt;/a&gt;).  Before that patch we had in DefaultParser:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;            public int compare(Parser p1, Parser p2) {
                String n1 = p1.getClass().getName();
                String n2 = p2.getClass().getName();
                boolean t1 = n1.startsWith(&quot;org.apache.tika.&quot;);
                boolean t2 = n2.startsWith(&quot;org.apache.tika.&quot;);
                if (t1 == t2) {
                    return n1.compareTo(n2);
                } else if (t1) {
                    return -1;
                } else {
                    return 1;
                }
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When that was pulled into ServiceLoaderUtils, it became:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;             public int compare(T c1, T c2) {
 
                 String n1 = c1.getClass().getName(); 
                 String n2 = c2.getClass().getName();
 
                 boolean t1 = n1.startsWith(&quot;org.apache.tika.&quot;); 
                 boolean t2 = n2.startsWith(&quot;org.apache.tika.&quot;); 
                 if (t1 == t2) { 
                     return n1.compareTo(n2); 
                 } else if (t1) {
                     return 1; 
                 } else {
                     return -1; 
                }
              } 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;, can you think of any problems if I flip the -1/1 back to where they were?&lt;/p&gt;</comment>
                            <comment id="14640870" author="tallison@mitre.org" created="Fri, 24 Jul 2015 18:25:29 +0000"  >&lt;p&gt;In r1692564, I flipped the sort order back to what it was before r1677328.  If that change in sort order was made intentionally, please let us know.&lt;/p&gt;</comment>
                            <comment id="14641461" author="hudson" created="Sat, 25 Jul 2015 08:14:59 +0000"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.7 #800 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/800/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/800/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1689&quot; title=&quot;Parser sort order change in TIKA-1517 breaks parser override capability&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1689&quot;&gt;&lt;del&gt;TIKA-1689&lt;/del&gt;&lt;/a&gt;: with mention in Changes.txt (tallison: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1692565&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1692565&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/CHANGES.txt&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1689&quot; title=&quot;Parser sort order change in TIKA-1517 breaks parser override capability&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1689&quot;&gt;&lt;del&gt;TIKA-1689&lt;/del&gt;&lt;/a&gt;: revert mistakenly flipped sort order of parsers from r1677328 (tallison: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1692564&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1692564&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/main/java/org/apache/tika/utils/ServiceLoaderUtils.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/utils&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/utils/ServiceLoaderUtilsTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 17 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2hcvb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>