diff --git a/Cargo.lock b/Cargo.lock
index c59ec412..d78c2090 100644
--- a/Cargo.lock
+++ b/Cargo.lock
@@ -1649,6 +1649,7 @@ dependencies = [
  "versions",
  "which",
  "winapi",
+ "winres",
  "yaml-rust",
 ]
 
@@ -2106,6 +2107,15 @@ version = "0.30.0"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "08cabc9f0066848fef4bc6a1c1668e6efce38b661d2aeec75d18d8617eebb5f1"
 
+[[package]]
+name = "winres"
+version = "0.1.12"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "b68db261ef59e9e52806f688020631e987592bd83619edccda9c47d42cde4f6c"
+dependencies = [
+ "toml",
+]
+
 [[package]]
 name = "winrt-notification"
 version = "0.5.0"
diff --git a/Cargo.toml b/Cargo.toml
index 1558e496..93eba138 100644
--- a/Cargo.toml
+++ b/Cargo.toml
@@ -84,6 +84,9 @@ nix = "0.23.1"
 [build-dependencies]
 shadow-rs = "0.8.1"
 
+[target.'cfg(windows)'.build-dependencies]
+winres = "0.1.12"
+
 [dev-dependencies]
 mockall = "0.11"
 tempfile = "3.2.0"
diff --git a/build.rs b/build.rs
index 4a0dfc45..f6c76935 100644
--- a/build.rs
+++ b/build.rs
@@ -1,3 +1,14 @@
-fn main() -> shadow_rs::SdResult<()> {
-    shadow_rs::new()
+use std::error::Error;
+
+fn main() -> Result<(), Box<dyn Error>> {
+    shadow_rs::new().map_err(|err| err.to_string())?;
+
+    #[cfg(windows)]
+    {
+        let mut res = winres::WindowsResource::new();
+        res.set_manifest_file("starship.exe.manifest");
+        res.compile()?;
+    }
+
+    Ok(())
 }
diff --git a/starship.exe.manifest b/starship.exe.manifest
new file mode 100644
index 00000000..32d556ed
--- /dev/null
+++ b/starship.exe.manifest
@@ -0,0 +1,32 @@
+<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
+<assembly manifestVersion="1.0" xmlns="urn:schemas-microsoft-com:asm.v1">
+    <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
+        <security>
+            <requestedPrivileges>
+                <requestedExecutionLevel
+                    level="asInvoker"
+                    uiAccess="false"
+                />
+            </requestedPrivileges>
+        </security>
+    </trustInfo>
+    <compatibility xmlns="urn:schemas-microsoft-com:compatibility.v1">
+        <application>
+            <!-- Windows 10 & 11 -->
+            <supportedOS Id="{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}"/>
+            <!-- Windows 8.1 -->
+            <supportedOS Id="{1f676c76-80e1-4239-95bb-83d0f6d0da78}"/>
+            <!-- Windows 8 -->
+            <supportedOS Id="{4a2f28e3-53b9-4441-ba9c-d69d4a4a6e38}"/>
+            <!-- Windows 7 -->
+            <supportedOS Id="{35138b9a-5d96-4fbd-8e2d-a2440225f93a}"/>
+            <!-- Windows Vista -->
+            <supportedOS Id="{e2011457-1546-43c5-a5fe-008deee3d3f0}"/>
+        </application>
+    </compatibility>
+    <application xmlns="urn:schemas-microsoft-com:asm.v3">
+        <windowsSettings xmlns:ws2="http://schemas.microsoft.com/SMI/2016/WindowsSettings">
+            <ws2:longPathAware>true</ws2:longPathAware>
+        </windowsSettings>
+    </application>
+</assembly>
