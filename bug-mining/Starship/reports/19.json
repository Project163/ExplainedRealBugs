{"url":"https://api.github.com/repos/starship/starship/issues/2474","repository_url":"https://api.github.com/repos/starship/starship","labels_url":"https://api.github.com/repos/starship/starship/issues/2474/labels{/name}","comments_url":"https://api.github.com/repos/starship/starship/issues/2474/comments","events_url":"https://api.github.com/repos/starship/starship/issues/2474/events","html_url":"https://github.com/starship/starship/issues/2474","id":835102029,"node_id":"MDU6SXNzdWU4MzUxMDIwMjk=","number":2474,"title":"shell module doesn't support conditional format strings","user":{"login":"rouge8","id":237005,"node_id":"MDQ6VXNlcjIzNzAwNQ==","avatar_url":"https://avatars.githubusercontent.com/u/237005?v=4","gravatar_id":"","url":"https://api.github.com/users/rouge8","html_url":"https://github.com/rouge8","followers_url":"https://api.github.com/users/rouge8/followers","following_url":"https://api.github.com/users/rouge8/following{/other_user}","gists_url":"https://api.github.com/users/rouge8/gists{/gist_id}","starred_url":"https://api.github.com/users/rouge8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rouge8/subscriptions","organizations_url":"https://api.github.com/users/rouge8/orgs","repos_url":"https://api.github.com/users/rouge8/repos","events_url":"https://api.github.com/users/rouge8/events{/privacy}","received_events_url":"https://api.github.com/users/rouge8/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1300028463,"node_id":"MDU6TGFiZWwxMzAwMDI4NDYz","url":"https://api.github.com/repos/starship/starship/labels/%F0%9F%90%9B%20bug","name":"üêõ bug","color":"d73a4a","default":false,"description":"Something isn't working as expected."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-03-18T17:56:50Z","updated_at":"2021-03-23T21:20:29Z","closed_at":"2021-03-23T21:20:29Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### Current Behavior\r\n\r\nThe shell module doesn't seem to support conditional format strings, e.g.:\r\n\r\n```toml\r\n[shell]\r\nfish_indicator = \"\"\r\nbash_indicator = \"üêö\"\r\nformat = \"($indicator )\"\r\ndisabled = false\r\n```\r\n\r\nNothing displays for bash or fish. Removing the `format = ...` line displays: ` ‚ùØ` for fish (note the space) and `üêö  ‚ùØ` for bash.\r\n\r\n#### Expected Behavior\r\n\r\n`üêö  ` shows up for bash and nothing shows up for fish.\r\n\r\n#### Additional context/Screenshots\r\n\r\nTest cases to add to the `shell` module:\r\n\r\n```rust\r\n    #[test]\r\n    fn test_custom_format_optional_indicator_match() {\r\n        let expected = Some(format!(\"{} \", \"B\"));\r\n        let actual = ModuleRenderer::new(\"shell\")\r\n            .shell(Shell::Bash)\r\n            .config(toml::toml! {\r\n                [shell]\r\n                bash_indicator = \"B\"\r\n                format = \"($indicator )\"\r\n                disabled = false\r\n            })\r\n            .collect();\r\n\r\n        assert_eq!(expected, actual);\r\n    }\r\n\r\n    #[test]\r\n    fn test_custom_format_optional_indicator_no_match() {\r\n        let expected = None;\r\n        let actual = ModuleRenderer::new(\"shell\")\r\n            .shell(Shell::Fish)\r\n            .config(toml::toml! {\r\n                [shell]\r\n                bash_indicator = \"B\"\r\n                format = \"($indicator )\"\r\n                disabled = false\r\n            })\r\n            .collect();\r\n\r\n        assert_eq!(expected, actual);\r\n    }\r\n```\r\n\r\n#### Environment\r\n- Starship version: 0.50.0\r\n- bash version: GNU bash, version 3.2.57(1)-release (x86_64-apple-darwin19)\r\nCopyright (C) 2007 Free Software Foundation, Inc.\r\n- Operating system: Mac OS 10.15.7\r\n- Terminal emulator: Apple_Terminal 433\r\n- Git Commit Hash: 3a4c9063\r\n- Branch/Tag: master\r\n- Rust Version: rustc 1.50.0\r\n- Rust channel:  release\r\n- Build Time: 2021-03-18 09:54:54\r\n","closed_by":{"login":"matchai","id":4658208,"node_id":"MDQ6VXNlcjQ2NTgyMDg=","avatar_url":"https://avatars.githubusercontent.com/u/4658208?v=4","gravatar_id":"","url":"https://api.github.com/users/matchai","html_url":"https://github.com/matchai","followers_url":"https://api.github.com/users/matchai/followers","following_url":"https://api.github.com/users/matchai/following{/other_user}","gists_url":"https://api.github.com/users/matchai/gists{/gist_id}","starred_url":"https://api.github.com/users/matchai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matchai/subscriptions","organizations_url":"https://api.github.com/users/matchai/orgs","repos_url":"https://api.github.com/users/matchai/repos","events_url":"https://api.github.com/users/matchai/events{/privacy}","received_events_url":"https://api.github.com/users/matchai/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/starship/starship/issues/2474/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/starship/starship/issues/2474/timeline","performed_via_github_app":null,"state_reason":"completed"}