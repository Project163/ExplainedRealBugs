diff --git a/java/modules/core/src/main/java/org/apache/synapse/util/TextFileDataSource.java b/java/modules/core/src/main/java/org/apache/synapse/util/TextFileDataSource.java
index 084566bc4..26a60d9da 100644
--- a/java/modules/core/src/main/java/org/apache/synapse/util/TextFileDataSource.java
+++ b/java/modules/core/src/main/java/org/apache/synapse/util/TextFileDataSource.java
@@ -25,21 +25,25 @@ import org.apache.axiom.om.OMFactory;
 import org.apache.axiom.om.OMOutputFormat;
 import org.apache.axiom.om.OMSourcedElement;
 import org.apache.axiom.om.ds.OMDataSourceExtBase;
+import org.apache.axiom.om.impl.MTOMXMLStreamWriter;
 import org.apache.axiom.om.impl.llom.OMSourcedElementImpl;
 import org.apache.axiom.om.impl.serialize.StreamingOMSerializer;
-import org.apache.synapse.SynapseException;
+import org.apache.axiom.om.util.StAXUtils;
 import org.apache.synapse.transport.base.BaseConstants;
 
 import javax.xml.stream.XMLStreamException;
 import javax.xml.stream.XMLStreamReader;
 import javax.xml.stream.XMLStreamWriter;
-import java.io.*;
+
+import java.io.IOException;
+import java.io.InputStream;
+import java.io.InputStreamReader;
+import java.io.OutputStream;
+import java.io.UnsupportedEncodingException;
+import java.io.Writer;
 import java.nio.charset.Charset;
 
 public class TextFileDataSource extends OMDataSourceExtBase {
-
-    private static final byte[] empty =
-        "<text xmlns=\"http://ws.apache.org/commons/ns/payload\"/>".getBytes();
     private final TemporaryData temporaryData;
     private final Charset charset;
 
@@ -54,27 +58,23 @@ public class TextFileDataSource extends OMDataSourceExtBase {
         return new OMSourcedElementImpl(BaseConstants.DEFAULT_TEXT_WRAPPER, fac, txtFileDS);
     }
 
+    @Override
     public void serialize(OutputStream out, OMOutputFormat format) throws XMLStreamException {
-        try {
-            InputStream is = temporaryData.getInputStream();
-            byte[] buf = new byte[4096];
-            int len;
-            while ((len = is.read(buf)) > 0) {
-                out.write(buf, 0, len);
-            }
-        } catch (IOException e) {
-            throw new SynapseException("Error serializing TextFileDataSource to an OutputStream", e);
-        }
+        XMLStreamWriter writer = new MTOMXMLStreamWriter(out, format);
+        serialize(writer);
+        writer.flush();
     }
 
+    @Override
     public void serialize(Writer writer, OMOutputFormat format) throws XMLStreamException {
-        try {
-            writer.write(new String(empty));
-        } catch (IOException e) {
-            throw new XMLStreamException(e);
-        }
+        MTOMXMLStreamWriter xmlWriter =
+            new MTOMXMLStreamWriter(StAXUtils.createXMLStreamWriter(writer));
+        xmlWriter.setOutputFormat(format);
+        serialize(xmlWriter);
+        xmlWriter.flush();
     }
 
+    @Override
     public void serialize(XMLStreamWriter xmlWriter) throws XMLStreamException {
         StreamingOMSerializer serializer = new StreamingOMSerializer();
         serializer.serialize(getReader(), xmlWriter);
diff --git a/java/modules/core/src/test/java/org/apache/synapse/util/TextFileDataSourceTest.java b/java/modules/core/src/test/java/org/apache/synapse/util/TextFileDataSourceTest.java
index 7ba056509..a38648f22 100644
--- a/java/modules/core/src/test/java/org/apache/synapse/util/TextFileDataSourceTest.java
+++ b/java/modules/core/src/test/java/org/apache/synapse/util/TextFileDataSourceTest.java
@@ -19,23 +19,56 @@
 
 package org.apache.synapse.util;
 
+import java.io.ByteArrayOutputStream;
+import java.io.IOException;
 import java.io.OutputStream;
+import java.io.StringWriter;
 import java.nio.charset.Charset;
+import java.util.Arrays;
 
 import junit.framework.TestCase;
 
 import org.apache.axiom.om.OMSourcedElement;
 
 public class TextFileDataSourceTest extends TestCase {
-    private final static Charset UTF8 = Charset.forName("UTF-8");
-
-    public void testWithXMLChars() throws Exception {
+    private static final Charset UTF8 = Charset.forName("UTF-8");
+    
+    private OMSourcedElement createSourcedElement(String content, Charset charset) throws IOException {
         TemporaryData tmp = new TemporaryData(4, 1024, "tmp_", ".dat");
         OutputStream out = tmp.getOutputStream();
-        String testString = "Test string with ampersand (&)";
-        out.write(testString.getBytes(UTF8.name()));
+        out.write(content.getBytes(charset.name()));
         out.close();
-        OMSourcedElement element = TextFileDataSource.createOMSourcedElement(tmp, UTF8);
+        return TextFileDataSource.createOMSourcedElement(tmp, charset);
+    }
+    
+    public void testWithXMLChars() throws Exception {
+        String testString = "Test string with ampersand (&)";
+        OMSourcedElement element = createSourcedElement(testString, UTF8);
         assertEquals(testString, element.getText());
     }
+    
+    public void testSerializeToBytes() throws Exception {
+        OMSourcedElement element = createSourcedElement("test", UTF8);
+        ByteArrayOutputStream baos = new ByteArrayOutputStream();
+        element.serialize(baos);
+        byte[] actual = baos.toByteArray();
+        baos.reset();
+        // We validate the result by creating an equivalent OMElement
+        // and calling serialize on it. The two results must be identical.
+        element.cloneOMElement().serialize(baos);
+        byte[] expected = baos.toByteArray();
+        assertTrue(Arrays.equals(expected, actual));
+    }
+    
+    public void testSerializeToChars() throws Exception {
+        OMSourcedElement element = createSourcedElement("test", UTF8);
+        StringWriter sw = new StringWriter();
+        element.serialize(sw);
+        String actual = sw.toString();
+        sw.getBuffer().setLength(0);
+        // Compare with the behavior of an equivalent OMElement
+        element.cloneOMElement().serialize(sw);
+        String expected = sw.toString();
+        assertEquals(expected, actual);
+    }
 }
