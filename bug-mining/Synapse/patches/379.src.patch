diff --git a/java/modules/core/src/main/java/org/apache/synapse/mediators/db/AbstractDBMediator.java b/java/modules/core/src/main/java/org/apache/synapse/mediators/db/AbstractDBMediator.java
index 0dd210b48..67578626c 100644
--- a/java/modules/core/src/main/java/org/apache/synapse/mediators/db/AbstractDBMediator.java
+++ b/java/modules/core/src/main/java/org/apache/synapse/mediators/db/AbstractDBMediator.java
@@ -200,12 +200,13 @@ public abstract class AbstractDBMediator extends AbstractMediator implements Man
 
     /**
      * Return a Prepared statement for the given Statement object, which is ready to be executed
-     * @param stmnt SQL stataement to be executed
+     * @param stmnt SQL statement to be executed
+     * @param con The connection to be used
      * @param msgCtx Current message context
      * @return a PreparedStatement
      * @throws SQLException on error
      */
-    protected PreparedStatement getPreparedStatement(Statement stmnt,
+    protected PreparedStatement getPreparedStatement(Statement stmnt, Connection con,
                                                      MessageContext msgCtx) throws SQLException {
 
         SynapseLog synLog = getLog(msgCtx);
@@ -215,7 +216,6 @@ public abstract class AbstractDBMediator extends AbstractMediator implements Man
                 " and preparing statement : " + stmnt.getRawStatement());
         }
 
-        Connection con = getDataSource().getConnection();
         if (con == null) {
             String msg = "Connection from DataSource " + getDSName() + " is null.";
             log.error(msg);
diff --git a/java/modules/core/src/main/java/org/apache/synapse/mediators/db/DBLookupMediator.java b/java/modules/core/src/main/java/org/apache/synapse/mediators/db/DBLookupMediator.java
index e6093f82b..66f98f27f 100644
--- a/java/modules/core/src/main/java/org/apache/synapse/mediators/db/DBLookupMediator.java
+++ b/java/modules/core/src/main/java/org/apache/synapse/mediators/db/DBLookupMediator.java
@@ -41,8 +41,8 @@ public class DBLookupMediator extends AbstractDBMediator {
         Connection con = null;
         ResultSet rs = null;
         try {
-            PreparedStatement ps = getPreparedStatement(stmnt, msgCtx);
-            con = ps.getConnection();
+            con = this.getDataSource().getConnection();
+            PreparedStatement ps = getPreparedStatement(stmnt, con, msgCtx);
             rs = ps.executeQuery();
 
             if (rs.next()) {
@@ -90,7 +90,7 @@ public class DBLookupMediator extends AbstractDBMediator {
             if (rs != null) {
                 try {
                     rs.close();
-                } catch (SQLException e) {}
+                } catch (SQLException ignore) {}
             }
             if (con != null) {
                 try {
diff --git a/java/modules/core/src/main/java/org/apache/synapse/mediators/db/DBReportMediator.java b/java/modules/core/src/main/java/org/apache/synapse/mediators/db/DBReportMediator.java
index e24792e67..5a46f811f 100644
--- a/java/modules/core/src/main/java/org/apache/synapse/mediators/db/DBReportMediator.java
+++ b/java/modules/core/src/main/java/org/apache/synapse/mediators/db/DBReportMediator.java
@@ -50,7 +50,8 @@ public class DBReportMediator extends AbstractDBMediator {
 
         Connection con = null;
         try {
-            PreparedStatement ps = getPreparedStatement(stmnt, msgCtx);
+            con = this.getDataSource().getConnection();
+            PreparedStatement ps = getPreparedStatement(stmnt, con, msgCtx);
             con = ps.getConnection();
             int count = ps.executeUpdate();
 
