diff --git a/java/modules/transports/src/main/java/org/apache/synapse/transport/jms/JMSConnectionFactory.java b/java/modules/transports/src/main/java/org/apache/synapse/transport/jms/JMSConnectionFactory.java
index 3036abf33..d927a8b35 100644
--- a/java/modules/transports/src/main/java/org/apache/synapse/transport/jms/JMSConnectionFactory.java
+++ b/java/modules/transports/src/main/java/org/apache/synapse/transport/jms/JMSConnectionFactory.java
@@ -452,47 +452,6 @@ public class JMSConnectionFactory implements ExceptionListener {
         return new EndpointReference(sb.toString());
     }
 
-    /**
-     * Is this connection factory referring to the same underlying connection factory passed in
-     *
-     * @param o a JMSOutTransport object which specifies a connection factory
-     * @return true if this instance could be substituted for the out-transport
-     */
-    // TODO: this implementation violates the contract of Object#equals (however, JMSSender#getJMSConnectionFactory depends on this behavior)
-    public boolean equals(Object o) {
-        if (o instanceof JMSOutTransportInfo) {
-            JMSOutTransportInfo trpInfo = (JMSOutTransportInfo) o;
-
-            Map<String,String> trpProps = trpInfo.getProperties();
-            if (equals(trpProps.get(JMSConstants.CONFAC_JNDI_NAME_PARAM), jndiProperties.get(JMSConstants.CONFAC_JNDI_NAME_PARAM))
-                &&
-                equals(trpProps.get(Context.INITIAL_CONTEXT_FACTORY), jndiProperties.get(Context.INITIAL_CONTEXT_FACTORY))
-                &&
-                equals(trpProps.get(Context.PROVIDER_URL), jndiProperties.get(Context.PROVIDER_URL))
-                &&
-                equals(trpProps.get(Context.SECURITY_PRINCIPAL), jndiProperties.get(Context.SECURITY_PRINCIPAL))
-                &&
-                equals(trpProps.get(Context.SECURITY_CREDENTIALS), jndiProperties.get(Context.SECURITY_CREDENTIALS))) {
-                return true;
-            }
-        }
-        return false;
-    }
-
-    /**
-     *     Prevents NullPointerException when s1 is null.
-     *     If both values are null this returns true 
-     */
-    private boolean equals(Object s1, Object s2) {
-        if(s1 == s2) {
-            return true;
-        } else if(s1 != null && s1.equals(s2)) {
-            return true;
-        } else {
-            return false;
-        }
-    }
-
     // -------------------- getters and setters and trivial methods --------------------
 
     /**
diff --git a/java/modules/transports/src/main/java/org/apache/synapse/transport/jms/JMSConnectionFactoryManager.java b/java/modules/transports/src/main/java/org/apache/synapse/transport/jms/JMSConnectionFactoryManager.java
new file mode 100644
index 000000000..00df16c29
--- /dev/null
+++ b/java/modules/transports/src/main/java/org/apache/synapse/transport/jms/JMSConnectionFactoryManager.java
@@ -0,0 +1,192 @@
+/*
+* Copyright 2004,2005 The Apache Software Foundation.
+*
+* Licensed under the Apache License, Version 2.0 (the "License");
+* you may not use this file except in compliance with the License.
+* You may obtain a copy of the License at
+*
+*      http://www.apache.org/licenses/LICENSE-2.0
+*
+* Unless required by applicable law or agreed to in writing, software
+* distributed under the License is distributed on an "AS IS" BASIS,
+* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+* See the License for the specific language governing permissions and
+* limitations under the License.
+*/
+package org.apache.synapse.transport.jms;
+
+import java.util.Collection;
+import java.util.HashMap;
+import java.util.Iterator;
+import java.util.Map;
+
+import javax.jms.JMSException;
+import javax.naming.Context;
+import javax.naming.NamingException;
+
+import org.apache.axis2.AxisFault;
+import org.apache.axis2.context.ConfigurationContext;
+import org.apache.axis2.description.Parameter;
+import org.apache.axis2.description.ParameterInclude;
+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
+import org.apache.synapse.transport.base.threads.WorkerPool;
+
+/**
+ * Class managing a set of {@link JMSConnectionFactory} objects.
+ */
+public class JMSConnectionFactoryManager {
+    private static final Log log = LogFactory.getLog(JMSConnectionFactoryManager.class);
+    
+    /** A Map containing the JMS connection factories managed by this, keyed by name */
+    private final Map<String,JMSConnectionFactory> connectionFactories = new HashMap<String,JMSConnectionFactory>();
+    
+    private final ConfigurationContext cfgCtx;
+    
+    private final JMSListener jmsListener;
+    
+    private final WorkerPool workerPool;
+    
+    public JMSConnectionFactoryManager(ConfigurationContext cfgCtx) {
+        this.cfgCtx = cfgCtx;
+        jmsListener = null;
+        workerPool = null;
+    }
+    
+    public JMSConnectionFactoryManager(ConfigurationContext cfgCtx, JMSListener jmsListener, WorkerPool workerPool) {
+        this.cfgCtx = cfgCtx;
+        this.jmsListener = jmsListener;
+        this.workerPool = workerPool;
+    }
+    
+    /**
+     * Create JMSConnectionFactory instances for the definitions in the transport configuration,
+     * and add these into our collection of connectionFactories map keyed by name
+     *
+     * @param trpDesc the transport description for JMS
+     */
+    public void loadConnectionFactoryDefinitions(ParameterInclude trpDesc) {
+
+        // iterate through all defined connection factories
+        Iterator<?> conFacIter = trpDesc.getParameters().iterator();
+
+        while (conFacIter.hasNext()) {
+            Parameter conFacParams = (Parameter) conFacIter.next();
+
+            JMSConnectionFactory jmsConFactory =
+                new JMSConnectionFactory(conFacParams.getName(), jmsListener, workerPool, cfgCtx);
+            JMSUtils.setConnectionFactoryParameters(conFacParams, jmsConFactory);
+
+            connectionFactories.put(jmsConFactory.getName(), jmsConFactory);
+        }
+    }
+    
+    /**
+     * Get the names of the defined connection factories.
+     * @return
+     */
+    public String[] getNames() {
+        Collection<String> result = connectionFactories.keySet();
+        return result.toArray(new String[result.size()]);
+    }
+    
+    /**
+     * Start all connection factories.
+     * 
+     * @throws AxisFault
+     */
+    public void start() throws AxisFault {
+        for (JMSConnectionFactory conFac : connectionFactories.values()) {
+            try {
+                conFac.connectAndListen();
+            } catch (JMSException e) {
+                handleException("Error starting connection factory : " + conFac.getName(), e);
+            } catch (NamingException e) {
+                handleException("Error starting connection factory : " + conFac.getName(), e);
+            }
+        }
+    }
+
+    /**
+     * Get the JMS connection factory with the given name.
+     * 
+     * @param name the name of the JMS connection factory
+     * @return the JMS connection factory or null if no connection factory with
+     *         the given name exists
+     */
+    public JMSConnectionFactory getJMSConnectionFactory(String name) {
+        return connectionFactories.get(name);
+    }
+    
+    /**
+     * Get the JMS connection factory that matches the given properties, i.e. referring to
+     * the same underlying connection factory.
+     * 
+     * @param props
+     * @return the JMS connection factory or null if no connection factory compatible
+     *         with the given properties exists
+     */
+    public JMSConnectionFactory getJMSConnectionFactory(Map<String,String> props) {
+        for (JMSConnectionFactory cf : connectionFactories.values()) {
+            Map<String,String> jndiProperties = cf.getJndiProperties();
+            if (equals(props.get(JMSConstants.CONFAC_JNDI_NAME_PARAM), jndiProperties.get(JMSConstants.CONFAC_JNDI_NAME_PARAM))
+                &&
+                equals(props.get(Context.INITIAL_CONTEXT_FACTORY), jndiProperties.get(Context.INITIAL_CONTEXT_FACTORY))
+                &&
+                equals(props.get(Context.PROVIDER_URL), jndiProperties.get(Context.PROVIDER_URL))
+                &&
+                equals(props.get(Context.SECURITY_PRINCIPAL), jndiProperties.get(Context.SECURITY_PRINCIPAL))
+                &&
+                equals(props.get(Context.SECURITY_CREDENTIALS), jndiProperties.get(Context.SECURITY_CREDENTIALS))) {
+                return cf;
+            }
+        }
+        return null;
+    }
+    
+    /**
+     *     Prevents NullPointerException when s1 is null.
+     *     If both values are null this returns true 
+     */
+    private static boolean equals(Object s1, Object s2) {
+        if(s1 == s2) {
+            return true;
+        } else if(s1 != null && s1.equals(s2)) {
+            return true;
+        } else {
+            return false;
+        }
+    }
+
+    /**
+     * Pause all connection factories.
+     */
+    public void pause() {
+        for (JMSConnectionFactory conFac : connectionFactories.values()) {
+            conFac.pause();
+        }
+    }
+    
+    /**
+     * Resume all connection factories.
+     */
+    public void resume() {
+        for (JMSConnectionFactory conFac : connectionFactories.values()) {
+            conFac.resume();
+        }
+    }
+    
+    /**
+     * Stop all connection factories.
+     */
+    public void stop() {
+        for (JMSConnectionFactory conFac : connectionFactories.values()) {
+            conFac.stop();
+        }
+    }
+
+    protected void handleException(String msg, Exception e) throws AxisFault {
+        log.error(msg, e);
+        throw new AxisFault(msg, e);
+    }
+}
diff --git a/java/modules/transports/src/main/java/org/apache/synapse/transport/jms/JMSListener.java b/java/modules/transports/src/main/java/org/apache/synapse/transport/jms/JMSListener.java
index a373a16f3..3a63978a3 100644
--- a/java/modules/transports/src/main/java/org/apache/synapse/transport/jms/JMSListener.java
+++ b/java/modules/transports/src/main/java/org/apache/synapse/transport/jms/JMSListener.java
@@ -27,10 +27,7 @@ import org.apache.synapse.transport.base.BaseConstants;
 import org.apache.synapse.transport.base.BaseUtils;
 import org.apache.synapse.transport.base.ManagementSupport;
 
-import javax.jms.JMSException;
-import javax.naming.NamingException;
 import java.util.HashMap;
-import java.util.Iterator;
 import java.util.Map;
 
 /**
@@ -59,8 +56,7 @@ public class JMSListener extends AbstractTransportListener implements Management
 
     public static final String TRANSPORT_NAME = Constants.TRANSPORT_JMS;
 
-    /** A Map containing the JMS connection factories managed by this, keyed by name */
-    private Map<String,JMSConnectionFactory> connectionFactories = new HashMap<String,JMSConnectionFactory>();
+    private JMSConnectionFactoryManager connFacManager;
     /** A Map of service name to the JMS EPR addresses */
     private Map<String,String> serviceNameToEPRMap = new HashMap<String,String>();
 
@@ -74,11 +70,12 @@ public class JMSListener extends AbstractTransportListener implements Management
                      TransportInDescription trpInDesc) throws AxisFault {
         super.init(cfgCtx, trpInDesc);
 
+        connFacManager = new JMSConnectionFactoryManager(cfgCtx, this, workerPool);
         // read the connection factory definitions and create them
-        loadConnectionFactoryDefinitions(trpInDesc);
+        connFacManager.loadConnectionFactoryDefinitions(trpInDesc);
 
         // if no connection factories are defined, we cannot listen for any messages
-        if (connectionFactories.isEmpty()) {
+        if (connFacManager.getNames().length == 0) {
             log.warn("No JMS connection factories are defined. Cannot listen for JMS");
             return;
         }
@@ -92,17 +89,7 @@ public class JMSListener extends AbstractTransportListener implements Management
      * @throws AxisFault
      */
     public void start() throws AxisFault {
-
-        for (JMSConnectionFactory conFac : connectionFactories.values()) {
-            try {
-                conFac.connectAndListen();
-            } catch (JMSException e) {
-                handleException("Error starting connection factory : " + conFac.getName(), e);
-            } catch (NamingException e) {
-                handleException("Error starting connection factory : " + conFac.getName(), e);
-            }
-        }
-
+        connFacManager.start();
         super.start();
     }
 
@@ -111,9 +98,7 @@ public class JMSListener extends AbstractTransportListener implements Management
      */
     public void stop() throws AxisFault {
         super.stop();
-        for (JMSConnectionFactory conFac : connectionFactories.values()) {
-            conFac.stop();
-        }
+        connFacManager.stop();
     }
 
     /**
@@ -196,43 +181,12 @@ public class JMSListener extends AbstractTransportListener implements Management
 
         // validate connection factory name (specified or default)
         if (conFacParam != null) {
-            String conFac = (String) conFacParam.getValue();
-            if (connectionFactories.containsKey(conFac)) {
-                return connectionFactories.get(conFac);
-            } else {
-                return null;
-            }
-
-        } else if (connectionFactories.containsKey(JMSConstants.DEFAULT_CONFAC_NAME)) {
-            return connectionFactories.get(JMSConstants.DEFAULT_CONFAC_NAME);
-
+            return connFacManager.getJMSConnectionFactory((String)conFacParam.getValue());
         } else {
-            return null;
+            return connFacManager.getJMSConnectionFactory(JMSConstants.DEFAULT_CONFAC_NAME);
         }
     }
 
-    /**
-     * Create JMSConnectionFactory instances for the definitions in the transport listener,
-     * and add these into our collection of connectionFactories map keyed by name
-     *
-     * @param transprtIn the transport-in description for JMS
-     */
-    private void loadConnectionFactoryDefinitions(TransportInDescription transprtIn) {
-
-        // iterate through all defined connection factories
-        Iterator conFacIter = transprtIn.getParameters().iterator();
-
-        while (conFacIter.hasNext()) {
-            Parameter conFacParams = (Parameter) conFacIter.next();
-
-            JMSConnectionFactory jmsConFactory =
-                new JMSConnectionFactory(conFacParams.getName(), this, workerPool, cfgCtx);
-            JMSUtils.setConnectionFactoryParameters(conFacParams, jmsConFactory);
-
-            connectionFactories.put(jmsConFactory.getName(), jmsConFactory);
-        }
-    }
-    
     // -- jmx/management methods--
     /**
      * Pause the listener - Stop accepting/processing new messages, but continues processing existing
@@ -242,9 +196,7 @@ public class JMSListener extends AbstractTransportListener implements Management
     public void pause() throws AxisFault {
         if (state != BaseConstants.STARTED) return;
         try {
-            for (JMSConnectionFactory conFac : connectionFactories.values()) {
-                conFac.pause();
-            }
+            connFacManager.pause();
             state = BaseConstants.PAUSED;
             log.info("Listener paused");
         } catch (AxisJMSException e) {
@@ -259,9 +211,7 @@ public class JMSListener extends AbstractTransportListener implements Management
     public void resume() throws AxisFault {
         if (state != BaseConstants.PAUSED) return;
         try {
-            for (JMSConnectionFactory conFac : connectionFactories.values()) {
-                conFac.resume();
-            }
+            connFacManager.resume();
             state = BaseConstants.STARTED;
             log.info("Listener resumed");
         } catch (AxisJMSException e) {
diff --git a/java/modules/transports/src/main/java/org/apache/synapse/transport/jms/JMSSender.java b/java/modules/transports/src/main/java/org/apache/synapse/transport/jms/JMSSender.java
index 3a5105c84..0150b94d7 100644
--- a/java/modules/transports/src/main/java/org/apache/synapse/transport/jms/JMSSender.java
+++ b/java/modules/transports/src/main/java/org/apache/synapse/transport/jms/JMSSender.java
@@ -19,12 +19,10 @@ import org.apache.axiom.om.OMOutputFormat;
 import org.apache.axiom.om.OMElement;
 import org.apache.axiom.om.OMText;
 import org.apache.axiom.om.OMNode;
-import org.apache.axiom.om.util.UUIDGenerator;
 import org.apache.axis2.AxisFault;
 import org.apache.axis2.context.MessageContext;
 import org.apache.axis2.context.ConfigurationContext;
 import org.apache.axis2.description.TransportOutDescription;
-import org.apache.axis2.description.Parameter;
 import org.apache.axis2.transport.TransportUtils;
 import org.apache.axis2.transport.MessageFormatter;
 import org.apache.axis2.transport.OutTransportInfo;
@@ -36,7 +34,6 @@ import javax.jms.*;
 import javax.jms.Queue;
 import javax.activation.DataHandler;
 import javax.naming.Context;
-import javax.naming.NamingException;
 import java.io.ByteArrayOutputStream;
 import java.io.IOException;
 import java.io.UnsupportedEncodingException;
@@ -48,9 +45,8 @@ import java.util.*;
 public class JMSSender extends AbstractTransportSender implements ManagementSupport {
 
     public static final String TRANSPORT_NAME = "jms";
-
-    /** A Map containing the JMS connection factories managed by this, keyed by name */
-    private Map<String,JMSConnectionFactory> connectionFactories = new HashMap<String,JMSConnectionFactory>();
+    
+    private JMSConnectionFactoryManager connFacManager;
 
     public JMSSender() {
         log = LogFactory.getLog(JMSSender.class);
@@ -66,8 +62,16 @@ public class JMSSender extends AbstractTransportSender implements ManagementSupp
      */
     public void init(ConfigurationContext cfgCtx, TransportOutDescription transportOut) throws AxisFault {
         super.init(cfgCtx, transportOut);
+        connFacManager = new JMSConnectionFactoryManager(cfgCtx);
         // read the connection factory definitions and create them
-        loadConnectionFactoryDefinitions(transportOut);
+        connFacManager.loadConnectionFactoryDefinitions(transportOut);
+        connFacManager.start();
+    }
+
+    @Override
+    public void stop() {
+        connFacManager.stop();
+        super.stop();
     }
 
     /**
@@ -78,19 +82,17 @@ public class JMSSender extends AbstractTransportSender implements ManagementSupp
      * @return the corresponding JMS connection factory, if any
      */
     private JMSConnectionFactory getJMSConnectionFactory(JMSOutTransportInfo trpInfo) {
+        Map<String,String> props = trpInfo.getProperties();
         if(trpInfo.getProperties() != null) {
-            String jmsConnectionFactoryName = trpInfo.getProperties().get(JMSConstants.CONFAC_PARAM);
+            String jmsConnectionFactoryName = props.get(JMSConstants.CONFAC_PARAM);
             if(jmsConnectionFactoryName != null) {
-                return connectionFactories.get(jmsConnectionFactoryName);
-            }
-        }
-
-        for (JMSConnectionFactory cf : connectionFactories.values()) {
-            if (cf.equals(trpInfo)) {
-                return cf;
+                return connFacManager.getJMSConnectionFactory(jmsConnectionFactoryName);
+            } else {
+                return connFacManager.getJMSConnectionFactory(props);
             }
+        } else {
+            return null;
         }
-        return null;
     }
 
     /**
@@ -544,35 +546,4 @@ public class JMSSender extends AbstractTransportSender implements ManagementSupp
     private String getProperty(MessageContext mc, String key) {
         return (String) mc.getProperty(key);
     }
-
-    /**
-     * Create JMSConnectionFactory instances for the definitions in the transport sender,
-     * and add these into our collection of connectionFactories map keyed by name
-     *
-     * @param transportOut the transport-in description for JMS
-     */
-    private void loadConnectionFactoryDefinitions(TransportOutDescription transportOut) {
-
-        // iterate through all defined connection factories
-        Iterator conFacIter = transportOut.getParameters().iterator();
-
-        while (conFacIter.hasNext()) {
-            Parameter conFacParams = (Parameter) conFacIter.next();
-
-            JMSConnectionFactory jmsConFactory =
-                new JMSConnectionFactory(conFacParams.getName(), null, null, cfgCtx);
-            JMSUtils.setConnectionFactoryParameters(conFacParams, jmsConFactory);
-
-            try {
-                jmsConFactory.connectAndListen();
-            } catch (NamingException e) {
-                log.warn("Error looking up JMS connection factory : " + jmsConFactory.getName(), e);
-            } catch (JMSException e) {
-                log.warn("Error connecting to JMS connection factory : " + jmsConFactory.getName(), e);
-            }
-
-            connectionFactories.put(jmsConFactory.getName(), jmsConFactory);
-        }
-    }
-
 }
