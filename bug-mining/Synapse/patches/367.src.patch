diff --git a/java/modules/extensions/src/main/java/org/apache/synapse/mediators/bsf/ScriptMediatorFactory.java b/java/modules/extensions/src/main/java/org/apache/synapse/mediators/bsf/ScriptMediatorFactory.java
index 27e8da95b..e31bf3ed5 100644
--- a/java/modules/extensions/src/main/java/org/apache/synapse/mediators/bsf/ScriptMediatorFactory.java
+++ b/java/modules/extensions/src/main/java/org/apache/synapse/mediators/bsf/ScriptMediatorFactory.java
@@ -29,10 +29,7 @@ import org.apache.synapse.mediators.Value;
 import org.apache.synapse.config.xml.ValueFactory;
 
 import javax.xml.namespace.QName;
-import java.util.Iterator;
-import java.util.Map;
-import java.util.Properties;
-import java.util.TreeMap;
+import java.util.*;
 
 /**
  * Creates an instance of a Script mediator for inline or external script mediation for BSF
@@ -112,7 +109,7 @@ public class ScriptMediatorFactory extends AbstractMediatorFactory {
         // from void ScriptMediator.prepareExternalScript(MessageContext synCtx)
 
         // TreeMap used to keep given scripts order if needed
-        Map<Value, Object> includeKeysMap = new TreeMap<Value, Object>();
+        Map<Value, Object> includeKeysMap = new LinkedHashMap<Value, Object>();
         Iterator itr = elem.getChildrenWithName(INCLUDE_Q);
         while (itr.hasNext()) {
             OMElement includeElem = (OMElement) itr.next();
@@ -121,7 +118,7 @@ public class ScriptMediatorFactory extends AbstractMediatorFactory {
             // ValueFactory for creating dynamic or static Value
             ValueFactory keyFac = new ValueFactory();
             // create dynamic or static key based on OMElement
-            Value generatedKey = keyFac.createValue(XMLConfigConstants.KEY, elem);
+            Value generatedKey = keyFac.createValue(XMLConfigConstants.KEY, includeElem);
 
             if (key == null) {
                 throw new SynapseException("Cannot use 'include' element without 'key'" +
diff --git a/java/modules/extensions/src/test/java/org/apache/synapse/mediators/bsf/ScriptMediatorSerializationTest.java b/java/modules/extensions/src/test/java/org/apache/synapse/mediators/bsf/ScriptMediatorSerializationTest.java
index 1b9e8555e..9f758a0a0 100644
--- a/java/modules/extensions/src/test/java/org/apache/synapse/mediators/bsf/ScriptMediatorSerializationTest.java
+++ b/java/modules/extensions/src/test/java/org/apache/synapse/mediators/bsf/ScriptMediatorSerializationTest.java
@@ -42,6 +42,12 @@ public class ScriptMediatorSerializationTest extends AbstractTestCase {
         assertTrue(serialization(inputXml, scriptMediatorSerializer));
     }
 
+    public void testScriptMediatorSerializationScenarioThree() {
+        String inputXml = "<script xmlns=\"http://ws.apache.org/ns/synapse\" language=\"js\" key=\"jsMaster\" function=\"functionFoo\"><include key=\"jschild1\"/><include key=\"jschild2\"/></script>";
+        assertTrue(serialization(inputXml, mediatorFactory, scriptMediatorSerializer));
+        assertTrue(serialization(inputXml, scriptMediatorSerializer));
+    }
+
     public void testInlineScriptMediatorSerializationScenarioOne() {
         String inputXml = "<syn:script xmlns:syn=\"http://ws.apache.org/ns/synapse\" language='js'>" +
                 "<![CDATA[var symbol = mc.getPayloadXML()..*::Code.toString();mc.setPayloadXML(<m:getQuote xmlns:m=\"http://services.samples/xsd\">\n" +
