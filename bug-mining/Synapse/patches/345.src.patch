diff --git a/java/modules/documentation/src/site/xdoc/userguide/samples/sample50.xml b/java/modules/documentation/src/site/xdoc/userguide/samples/sample50.xml
index b4f0c463d..5eaba0169 100644
--- a/java/modules/documentation/src/site/xdoc/userguide/samples/sample50.xml
+++ b/java/modules/documentation/src/site/xdoc/userguide/samples/sample50.xml
@@ -28,6 +28,7 @@
 
     &lt;sequence name="main"&gt;
         &lt;!-- filtering of messages with XPath and regex matches --&gt;
+        &lt;header name="Action" value="urn:getQuote"/&gt;
         &lt;filter source="get-property('To')" regex=".*/StockQuote.*"&gt;
             &lt;then&gt;
                 &lt;send&gt;
diff --git a/java/modules/transports/core/nhttp/src/main/java/org/apache/synapse/transport/nhttp/Axis2HttpRequest.java b/java/modules/transports/core/nhttp/src/main/java/org/apache/synapse/transport/nhttp/Axis2HttpRequest.java
index 056e3559e..baeca342d 100644
--- a/java/modules/transports/core/nhttp/src/main/java/org/apache/synapse/transport/nhttp/Axis2HttpRequest.java
+++ b/java/modules/transports/core/nhttp/src/main/java/org/apache/synapse/transport/nhttp/Axis2HttpRequest.java
@@ -253,7 +253,7 @@ public class Axis2HttpRequest {
         }
 
         if (msgContext.isSOAP11() && soapAction != null &&
-                soapAction.length() > 0) {
+                soapAction.length() >= 0) {
             Header existingHeader =
                     httpRequest.getFirstHeader(HTTPConstants.HEADER_SOAP_ACTION);
             if (existingHeader != null) {
diff --git a/java/modules/transports/core/nhttp/src/main/java/org/apache/synapse/transport/nhttp/util/MessageFormatterDecoratorFactory.java b/java/modules/transports/core/nhttp/src/main/java/org/apache/synapse/transport/nhttp/util/MessageFormatterDecoratorFactory.java
index be2cfb145..a4df1564a 100644
--- a/java/modules/transports/core/nhttp/src/main/java/org/apache/synapse/transport/nhttp/util/MessageFormatterDecoratorFactory.java
+++ b/java/modules/transports/core/nhttp/src/main/java/org/apache/synapse/transport/nhttp/util/MessageFormatterDecoratorFactory.java
@@ -21,7 +21,7 @@ package org.apache.synapse.transport.nhttp.util;
 import org.apache.axis2.AxisFault;
 import org.apache.axis2.context.MessageContext;
 import org.apache.axis2.transport.MessageFormatter;
-import org.apache.axis2.transport.TransportUtils;
+import org.apache.axis2.util.MessageProcessorSelector;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.http.protocol.HTTP;
@@ -46,7 +46,7 @@ public class MessageFormatterDecoratorFactory {
 
         try {
             // Get message formatter based on the content type
-            MessageFormatter formatter = TransportUtils.getMessageFormatter(msgContext);
+            MessageFormatter formatter = MessageProcessorSelector.getMessageFormatter(msgContext);
 
             Object o = msgContext.getProperty(MessageContext.TRANSPORT_HEADERS);
             if (o != null && o instanceof Map) {
diff --git a/java/modules/transports/core/vfs/src/main/java/org/apache/synapse/transport/vfs/VFSTransportSender.java b/java/modules/transports/core/vfs/src/main/java/org/apache/synapse/transport/vfs/VFSTransportSender.java
index 8b8312f7e..6e1c78095 100644
--- a/java/modules/transports/core/vfs/src/main/java/org/apache/synapse/transport/vfs/VFSTransportSender.java
+++ b/java/modules/transports/core/vfs/src/main/java/org/apache/synapse/transport/vfs/VFSTransportSender.java
@@ -26,7 +26,7 @@ import org.apache.axis2.description.TransportOutDescription;
 import org.apache.axis2.description.Parameter;
 import org.apache.axis2.transport.MessageFormatter;
 import org.apache.axis2.transport.OutTransportInfo;
-import org.apache.axis2.transport.TransportUtils;
+import org.apache.axis2.util.MessageProcessorSelector;
 import org.apache.axis2.transport.base.AbstractTransportSender;
 import org.apache.axis2.transport.base.BaseUtils;
 import org.apache.axis2.transport.base.ManagementSupport;
@@ -226,7 +226,7 @@ public class VFSTransportSender extends AbstractTransportSender implements Manag
     private void populateResponseFile(FileObject responseFile, MessageContext msgContext,
                                       boolean append, boolean lockingEnabled) throws AxisFault {
         
-        MessageFormatter messageFormatter = TransportUtils.getMessageFormatter(msgContext);
+        MessageFormatter messageFormatter = MessageProcessorSelector.getMessageFormatter(msgContext);
         OMOutputFormat format = BaseUtils.getOMOutputFormat(msgContext);
         
         try {
diff --git a/java/repository/conf/sample/synapse_sample_50.xml b/java/repository/conf/sample/synapse_sample_50.xml
index 5dffc71b6..7d94abd77 100644
--- a/java/repository/conf/sample/synapse_sample_50.xml
+++ b/java/repository/conf/sample/synapse_sample_50.xml
@@ -23,6 +23,7 @@
 
     <sequence name="main">
         <!-- filtering of messages with XPath and regex matches -->
+        <header name="Action" value="urn:getQuote"/>
         <filter source="get-property('To')" regex=".*/StockQuote.*">
             <then>
                 <send>
