diff --git a/java/modules/core/src/main/java/org/apache/synapse/mediators/builtin/PropertyMediator.java b/java/modules/core/src/main/java/org/apache/synapse/mediators/builtin/PropertyMediator.java
index 718d2151e..f447b6d72 100644
--- a/java/modules/core/src/main/java/org/apache/synapse/mediators/builtin/PropertyMediator.java
+++ b/java/modules/core/src/main/java/org/apache/synapse/mediators/builtin/PropertyMediator.java
@@ -137,7 +137,7 @@ public class PropertyMediator extends AbstractMediator {
                         org.apache.axis2.context.MessageContext.TRANSPORT_HEADERS);
 
                 if (headers != null && headers instanceof Map) {
-                    Map headersMap = (HashMap) headers;
+                    Map headersMap = (Map) headers;
                     headersMap.put(name, resultValue);
                 }
                 if (headers == null) {
@@ -181,7 +181,7 @@ public class PropertyMediator extends AbstractMediator {
                 Object headers = axis2MessageCtx.getProperty(
                         org.apache.axis2.context.MessageContext.TRANSPORT_HEADERS);
                 if (headers != null && headers instanceof Map) {
-                    Map headersMap = (HashMap) headers;
+                    Map headersMap = (Map) headers;
                     headersMap.remove(name);
                 } else {
                     synLog.traceOrDebug("No transport headers found for the message");
diff --git a/java/modules/core/src/main/java/org/apache/synapse/util/MessageHelper.java b/java/modules/core/src/main/java/org/apache/synapse/util/MessageHelper.java
index e22245438..af2cb67a2 100644
--- a/java/modules/core/src/main/java/org/apache/synapse/util/MessageHelper.java
+++ b/java/modules/core/src/main/java/org/apache/synapse/util/MessageHelper.java
@@ -142,14 +142,23 @@ public class MessageHelper {
 
     public static Map getClonedTransportHeaders(org.apache.axis2.context.MessageContext msgCtx) {
         
-        Map headers = (Map) msgCtx.getProperty(
-                org.apache.axis2.context.MessageContext.TRANSPORT_HEADERS);
-        Map<String, Object> clonedHeaders = new HashMap<String, Object>();
+        Map headers = (Map) msgCtx.
+                getProperty(org.apache.axis2.context.MessageContext.TRANSPORT_HEADERS);
+        Map<String, String> clonedHeaders;
+        if (headers instanceof TreeMap) {
+            clonedHeaders = new TreeMap<String, String>(new Comparator<String>() {
+                public int compare(String s1, String s2) {
+                    return s1.compareToIgnoreCase(s2);
+                }
+            });
+        } else {
+            clonedHeaders = new HashMap<String, String>();
+        }
 
-        if (headers != null && headers.isEmpty()) {
+        if (headers != null && !headers.isEmpty()) {
             for (Object o : headers.keySet()) {
                 String headerName = (String) o;
-                clonedHeaders.put(headerName, headers.get(headerName));
+                clonedHeaders.put(headerName, (String) headers.get(headerName));
             }
         }
 
diff --git a/java/modules/core/src/main/java/org/apache/synapse/util/xpath/SynapseXPathVariableContext.java b/java/modules/core/src/main/java/org/apache/synapse/util/xpath/SynapseXPathVariableContext.java
index 5fb989fdd..0aca20544 100644
--- a/java/modules/core/src/main/java/org/apache/synapse/util/xpath/SynapseXPathVariableContext.java
+++ b/java/modules/core/src/main/java/org/apache/synapse/util/xpath/SynapseXPathVariableContext.java
@@ -177,7 +177,7 @@ public class SynapseXPathVariableContext implements VariableContext {
                                 for (String param : params) {
                                     String temp[] = param.split("=");
                                     if (temp != null && temp.length >= 1) {
-                                        if (temp[0].equals(localName)) {
+                                        if (temp[0].equalsIgnoreCase(localName)) {
                                             try {
                                                 return temp.length > 1 ?
                                                         URIEncoderDecoder.decode(temp[1]) : "";
diff --git a/java/modules/transports/core/nhttp/src/main/java/org/apache/synapse/transport/nhttp/ClientWorker.java b/java/modules/transports/core/nhttp/src/main/java/org/apache/synapse/transport/nhttp/ClientWorker.java
index 2d6e0028c..7cf6a1372 100644
--- a/java/modules/transports/core/nhttp/src/main/java/org/apache/synapse/transport/nhttp/ClientWorker.java
+++ b/java/modules/transports/core/nhttp/src/main/java/org/apache/synapse/transport/nhttp/ClientWorker.java
@@ -42,8 +42,10 @@ import org.apache.synapse.transport.nhttp.debug.ClientConnectionDebug;
 import javax.xml.stream.XMLStreamException;
 import java.io.IOException;
 import java.io.InputStream;
+import java.util.Comparator;
 import java.util.HashMap;
 import java.util.Map;
+import java.util.TreeMap;
 
 /**
  * Performs processing of the HTTP response received for our outgoing request. An instance of this
@@ -118,7 +120,14 @@ public class ClientWorker implements Runnable {
             // set any transport headers received
             Header[] headers = response.getAllHeaders();
             if (headers != null && headers.length > 0) {
-                Map headerMap = new HashMap();
+
+                Map<String, String> headerMap
+                        = new TreeMap<String, String>(new Comparator<String>() {
+                    public int compare(String o1, String o2) {
+                        return o1.compareToIgnoreCase(o2);
+                    }
+                });
+                
                 for (int i=0; i<headers.length; i++) {
                     Header header = headers[i];
                     if ("Location".equals(header.getName())
diff --git a/java/modules/transports/core/nhttp/src/main/java/org/apache/synapse/transport/nhttp/ServerWorker.java b/java/modules/transports/core/nhttp/src/main/java/org/apache/synapse/transport/nhttp/ServerWorker.java
index 4e33b7566..463112353 100644
--- a/java/modules/transports/core/nhttp/src/main/java/org/apache/synapse/transport/nhttp/ServerWorker.java
+++ b/java/modules/transports/core/nhttp/src/main/java/org/apache/synapse/transport/nhttp/ServerWorker.java
@@ -161,7 +161,13 @@ public class ServerWorker implements Runnable {
         msgContext.setProperty(
             Constants.Configuration.TRANSPORT_IN_URL, request.getRequestLine().getUri());
 
-        Map<String, String> headers = new HashMap<String, String>();
+        // http transport header names are case insensitive 
+        Map<String, String> headers = new TreeMap<String, String>(new Comparator<String>() {
+            public int compare(String o1, String o2) {
+                return o1.compareToIgnoreCase(o2);
+            }
+        });
+        
         for (Header header : request.getAllHeaders()) {
             headers.put(header.getName(), header.getValue());
         }
