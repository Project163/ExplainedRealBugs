diff --git a/java/modules/core/src/main/java/org/apache/synapse/mediators/GetPropertyFunction.java b/java/modules/core/src/main/java/org/apache/synapse/mediators/GetPropertyFunction.java
index d85b104ab..731bd9081 100644
--- a/java/modules/core/src/main/java/org/apache/synapse/mediators/GetPropertyFunction.java
+++ b/java/modules/core/src/main/java/org/apache/synapse/mediators/GetPropertyFunction.java
@@ -72,6 +72,14 @@ public class GetPropertyFunction implements Function {
      */
     public Object call(Context context, List args) throws FunctionCallException {
 
+        if (synCtx == null) {
+            if (log.isDebugEnabled()) {
+                log.debug("Synapse message context has not been set for the " +
+                        "XPath extension function 'synapse:get-property(prop-name)'");
+            }
+            return null;
+        }
+        
         boolean traceOn = synCtx.getTracingState() == SynapseConstants.TRACING_ON;
         boolean traceOrDebugOn = traceOn || log.isDebugEnabled();
 
@@ -127,14 +135,6 @@ public class GetPropertyFunction implements Function {
      */
     public Object evaluate(Object scopeObject, Object keyObject, Object dateformat,Navigator navigator) {
 
-        if (synCtx == null) {
-            if (log.isDebugEnabled()) {
-                log.debug("Synapse message context has not been set for the " +
-                        "XPath extension function 'synapse:get-property(prop-name)'");
-            }
-            return null;
-        }
-
         boolean traceOn = synCtx.getTracingState() == SynapseConstants.TRACING_ON;
         boolean traceOrDebugOn = traceOn || log.isDebugEnabled();
 
diff --git a/java/modules/extensions/src/main/java/org/apache/synapse/mediators/xquery/MediatorCustomVariable.java b/java/modules/extensions/src/main/java/org/apache/synapse/mediators/xquery/MediatorCustomVariable.java
index b883c27da..6458c2dcc 100644
--- a/java/modules/extensions/src/main/java/org/apache/synapse/mediators/xquery/MediatorCustomVariable.java
+++ b/java/modules/extensions/src/main/java/org/apache/synapse/mediators/xquery/MediatorCustomVariable.java
@@ -75,7 +75,7 @@ public class MediatorCustomVariable extends MediatorVariable {
     public boolean evaluateValue(MessageContext synCtx) {
 
         if (this.regKey == null) {   // get the node from the current message payload
-            this.value = evaluate(synCtx.getEnvelope());
+            this.value = evaluate(synCtx);
             return true;
         } else {
             //Load the XML document from the registry
