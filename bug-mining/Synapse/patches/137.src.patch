diff --git a/java/modules/transports/pom.xml b/java/modules/transports/pom.xml
index 250f80d82..1334ce9ee 100644
--- a/java/modules/transports/pom.xml
+++ b/java/modules/transports/pom.xml
@@ -37,6 +37,17 @@
 
     <build>
         <plugins>
+            <plugin>
+                <groupId>org.apache.maven.plugins</groupId>
+                <artifactId>maven-compiler-plugin</artifactId>
+                <configuration>
+                    <source>1.5</source>
+                    <target>1.5</target>
+                    <excludes>
+                        <exclude>org/apache/synapse/transport/amqp/**</exclude>
+                    </excludes>
+                </configuration>
+             </plugin>
             <plugin>
                 <groupId>org.apache.maven.plugins</groupId>
                 <artifactId>maven-surefire-plugin</artifactId>
@@ -162,6 +173,19 @@
             <version>0.3.1</version>
             <scope>test</scope>
         </dependency>
+        <dependency>
+            <groupId>org.apache.qpid</groupId>
+            <artifactId>qpid-broker</artifactId>
+            <version>${qpid.version}</version>
+            <scope>test</scope>
+        </dependency>
+        <!-- qpid 1.0-incubating-M2.1 only works correctly with this version of mina -->
+        <dependency>
+            <groupId>org.apache.mina</groupId>
+            <artifactId>mina-core</artifactId>
+            <version>1.0.1</version>
+            <scope>test</scope>
+        </dependency>
         
         <!-- Workaround for SYNAPSE-400 -->
         <dependency>
diff --git a/java/pom.xml b/java/pom.xml
index bc6e7b60f..38d1ffd35 100644
--- a/java/pom.xml
+++ b/java/pom.xml
@@ -1097,6 +1097,18 @@
                 <updatePolicy>daily</updatePolicy>
             </snapshots>
         </repository>
+        <!-- this is for qpid -->
+        <repository>
+            <id>apache-incubating</id>
+            <name>Apache Maven 2 Incubating Repository</name>
+            <url>http://people.apache.org/repo/m2-incubating-repository/</url>
+            <releases>
+                <updatePolicy>never</updatePolicy>
+            </releases>
+            <snapshots>
+                <updatePolicy>interval:60</updatePolicy>
+            </snapshots>
+        </repository>
     </repositories>
 
     <modules>
@@ -1177,7 +1189,7 @@
         <bsf.version>3.0-beta2</bsf.version>
         <groovy.version>1.0</groovy.version>
         <servlet-api.version>2.3</servlet-api.version>
-        <qpid.version>1.0-incubating-M3-615355</qpid.version>
+        <qpid.version>1.0-incubating-M2.1</qpid.version>
 
     </properties>
 
