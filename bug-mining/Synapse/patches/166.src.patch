diff --git a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/ActiveMQTestEnvironment.java b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/ActiveMQTestEnvironment.java
index 6170225af..b9851201f 100644
--- a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/ActiveMQTestEnvironment.java
+++ b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/ActiveMQTestEnvironment.java
@@ -20,9 +20,7 @@
 package org.apache.synapse.transport.jms;
 
 import javax.jms.Queue;
-import javax.jms.QueueConnectionFactory;
 import javax.jms.Topic;
-import javax.jms.TopicConnectionFactory;
 
 import org.apache.activemq.ActiveMQConnectionFactory;
 import org.apache.activemq.broker.BrokerService;
@@ -53,16 +51,7 @@ public class ActiveMQTestEnvironment extends JMSTestEnvironment {
     }
 
     @Override
-    protected QueueConnectionFactory createQueueConnectionFactory() throws Exception {
-        return createConnectionFactory();
-    }
-
-    @Override
-    protected TopicConnectionFactory createTopicConnectionFactory() throws Exception {
-        return createConnectionFactory();
-    }
-    
-    private ActiveMQConnectionFactory createConnectionFactory() throws Exception {
+    protected ActiveMQConnectionFactory createConnectionFactory() throws Exception {
         return new ActiveMQConnectionFactory("vm://" + BROKER_NAME);
     }
 
diff --git a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSChannel.java b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSChannel.java
index cf7c8d8c4..cbb6f323b 100644
--- a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSChannel.java
+++ b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSChannel.java
@@ -27,6 +27,7 @@ import javax.jms.JMSException;
 import javax.jms.Queue;
 import javax.jms.QueueBrowser;
 import javax.jms.Session;
+import javax.naming.Context;
 
 import org.apache.axis2.addressing.EndpointReference;
 import org.apache.axis2.description.AxisService;
@@ -38,9 +39,12 @@ public abstract class JMSChannel implements AxisServiceConfigurator {
     private final String destinationType;
     private final ContentTypeMode contentTypeMode;
     protected JMSTestEnvironment env;
+    protected Context context;
     private String destinationName;
     private String jndiName;
     private Destination destination;
+    private String connectionFactoryName;
+    private String connectionFactoryJNDIName;
     
     public JMSChannel(String name, String destinationType, ContentTypeMode contentTypeMode) {
         this.name = name;
@@ -70,17 +74,20 @@ public abstract class JMSChannel implements AxisServiceConfigurator {
     }
     
     @SuppressWarnings("unused")
-    private void setUp(JMSTestEnvironment env) throws Exception {
+    private void setUp(JMSTestEnvironment env, JNDIEnvironment jndiEnvironment, JMSTransportDescriptionFactory tdf) throws Exception {
         this.env = env;
+        context = jndiEnvironment.getContext();
         destinationName = buildDestinationName("request", destinationType);
         jndiName = buildJndiName("request", destinationType);
         destination = env.createDestination(destinationType, destinationName);
-        env.getContext().bind(jndiName, destination);
+        context.bind(jndiName, destination);
+        connectionFactoryName = tdf.getConnectionFactoryName(destinationType);
+        connectionFactoryJNDIName = tdf.getConnectionFactoryJNDIName(destinationType);
     }
 
     @SuppressWarnings("unused")
     private void tearDown() throws Exception {
-        env.getContext().unbind(jndiName);
+        context.unbind(jndiName);
         destinationName = null;
         jndiName = null;
         destination = null;
@@ -105,7 +112,7 @@ public abstract class JMSChannel implements AxisServiceConfigurator {
     }
 
     public int getMessageCount() throws JMSException {
-        Connection connection = env.getConnectionFactory(destination).createConnection();
+        Connection connection = env.getConnectionFactory().createConnection();
         try {
             connection.start();
             Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
@@ -121,11 +128,14 @@ public abstract class JMSChannel implements AxisServiceConfigurator {
     }
 
     public EndpointReference getEndpointReference() throws Exception {
-        return new EndpointReference("jms:/" + jndiName + "?transport.jms.DestinationType=" + destinationType + "&java.naming.factory.initial=org.mockejb.jndi.MockContextFactory&transport.jms.ConnectionFactoryJNDIName=QueueConnectionFactory");
+        return new EndpointReference(
+                "jms:/" + jndiName + "?transport.jms.DestinationType=" + destinationType +
+                "&java.naming.factory.initial=org.mockejb.jndi.MockContextFactory" +
+                "&transport.jms.ConnectionFactoryJNDIName=" + connectionFactoryJNDIName);
     }
 
     public void setupService(AxisService service) throws Exception {
-        service.addParameter(JMSConstants.CONFAC_PARAM, destinationType);
+        service.addParameter(JMSConstants.CONFAC_PARAM, connectionFactoryName);
         service.addParameter(JMSConstants.DEST_PARAM_TYPE, destinationType);
         service.addParameter(JMSConstants.DEST_PARAM, jndiName);
     }
diff --git a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSClient.java b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSClient.java
index fa1617189..695ca299a 100644
--- a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSClient.java
+++ b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSClient.java
@@ -54,7 +54,7 @@ public class JMSClient<T> implements TestClient {
     @SuppressWarnings("unused")
     private void setUp(JMSTestEnvironment env, JMSChannel channel) throws Exception {
         Destination destination = channel.getDestination();
-        ConnectionFactory connectionFactory = env.getConnectionFactory(destination);
+        ConnectionFactory connectionFactory = env.getConnectionFactory();
         connection = connectionFactory.createConnection();
         session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
         producer = session.createProducer(destination);
diff --git a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSRequestResponseChannel.java b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSRequestResponseChannel.java
index 5f4858ad0..e22123b2e 100644
--- a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSRequestResponseChannel.java
+++ b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSRequestResponseChannel.java
@@ -48,12 +48,12 @@ public class JMSRequestResponseChannel extends JMSChannel implements RequestResp
         replyDestinationName = buildDestinationName("response", replyDestinationType);
         replyJndiName = buildJndiName("response", replyDestinationType);
         replyDestination = env.createDestination(replyDestinationType, replyDestinationName);
-        env.getContext().bind(replyJndiName, replyDestination);
+        context.bind(replyJndiName, replyDestination);
     }
 
     @SuppressWarnings("unused")
     private void tearDown() throws Exception {
-        env.getContext().unbind(replyJndiName);
+        context.unbind(replyJndiName);
         replyDestinationName = null;
         replyJndiName = null;
         replyDestination = null;
diff --git a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSRequestResponseClient.java b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSRequestResponseClient.java
index 46e380449..18bdab4b5 100644
--- a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSRequestResponseClient.java
+++ b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSRequestResponseClient.java
@@ -43,7 +43,7 @@ public class JMSRequestResponseClient<T> extends JMSClient<T> implements Request
     @SuppressWarnings("unused")
     private void setUp(JMSTestEnvironment env, JMSRequestResponseChannel channel) throws Exception {
         replyDestination = channel.getReplyDestination();
-        ConnectionFactory connectionFactory = env.getConnectionFactory(replyDestination);
+        ConnectionFactory connectionFactory = env.getConnectionFactory();
         replyConnection = connectionFactory.createConnection();
         replyConnection.start();
         replySession = replyConnection.createSession(false, Session.AUTO_ACKNOWLEDGE);
diff --git a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSTestEnvironment.java b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSTestEnvironment.java
index 83a3d3854..72ba90898 100644
--- a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSTestEnvironment.java
+++ b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSTestEnvironment.java
@@ -22,50 +22,26 @@ package org.apache.synapse.transport.jms;
 import javax.jms.ConnectionFactory;
 import javax.jms.Destination;
 import javax.jms.Queue;
-import javax.jms.QueueConnectionFactory;
 import javax.jms.Topic;
-import javax.jms.TopicConnectionFactory;
-import javax.naming.Context;
-import javax.naming.InitialContext;
 
 import org.apache.synapse.transport.testkit.name.Key;
-import org.mockejb.jndi.MockContextFactory;
 
 @Key("broker")
 public abstract class JMSTestEnvironment {
-    public static final String QUEUE_CONNECTION_FACTORY = "QueueConnectionFactory";
-    public static final String TOPIC_CONNECTION_FACTORY = "TopicConnectionFactory";
-    
-    private Context context;
-    private QueueConnectionFactory queueConnectionFactory;
-    private TopicConnectionFactory topicConnectionFactory;
+    private ConnectionFactory connectionFactory;
     
     @SuppressWarnings("unused")
     private void setUp() throws Exception {
-        MockContextFactory.setAsInitial();
-        context = new InitialContext();
-        queueConnectionFactory = createQueueConnectionFactory();
-        topicConnectionFactory = createTopicConnectionFactory();
-        context.bind(QUEUE_CONNECTION_FACTORY, queueConnectionFactory);
-        context.bind(TOPIC_CONNECTION_FACTORY, topicConnectionFactory);
+        connectionFactory = createConnectionFactory();
     }
     
     @SuppressWarnings("unused")
     private void tearDown() throws Exception {
-        context.unbind(QUEUE_CONNECTION_FACTORY);
-        context.unbind(TOPIC_CONNECTION_FACTORY);
-        context = null;
-        queueConnectionFactory = null;
-        topicConnectionFactory = null;
+        connectionFactory = null;
     }
     
-    protected abstract QueueConnectionFactory createQueueConnectionFactory() throws Exception;
-    protected abstract TopicConnectionFactory createTopicConnectionFactory() throws Exception;
+    protected abstract ConnectionFactory createConnectionFactory() throws Exception;
     
-    public Context getContext() {
-        return context;
-    }
-
     public Destination createDestination(String destinationType, String name) {
         if (destinationType.equals(JMSConstants.DESTINATION_TYPE_TOPIC)) {
             return createTopic(name);
@@ -77,19 +53,7 @@ public abstract class JMSTestEnvironment {
     public abstract Queue createQueue(String name);
     public abstract Topic createTopic(String name);
     
-    public QueueConnectionFactory getQueueConnectionFactory() {
-        return queueConnectionFactory;
-    }
-    
-    public TopicConnectionFactory getTopicConnectionFactory() {
-        return topicConnectionFactory;
-    }
-    
-    public ConnectionFactory getConnectionFactory(Destination destination) {
-        if (destination instanceof Queue) {
-            return queueConnectionFactory;
-        } else {
-            return topicConnectionFactory;
-        }
+    public ConnectionFactory getConnectionFactory() {
+        return connectionFactory;
     }
 }
diff --git a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSTransportDescriptionFactory.java b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSTransportDescriptionFactory.java
index aef5ee468..e9b7b01ec 100644
--- a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSTransportDescriptionFactory.java
+++ b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSTransportDescriptionFactory.java
@@ -19,6 +19,7 @@
 
 package org.apache.synapse.transport.jms;
 
+import javax.jms.ConnectionFactory;
 import javax.naming.Context;
 import javax.xml.namespace.QName;
 
@@ -35,26 +36,58 @@ import org.apache.synapse.transport.testkit.name.Key;
 import org.mockejb.jndi.MockContextFactory;
 
 public class JMSTransportDescriptionFactory implements TransportDescriptionFactory {
+    public static final String CONNECTION_FACTORY = "ConnectionFactory";
+    public static final String QUEUE_CONNECTION_FACTORY = "QueueConnectionFactory";
+    public static final String TOPIC_CONNECTION_FACTORY = "TopicConnectionFactory";
+    
     private static final OMFactory factory = OMAbstractFactory.getOMFactory();
     
+    private final boolean singleCF;
     private final boolean cfOnSender;
+    private Context context;
     
     /**
      * Constructor.
+     * @param singleCF True if a single connection factory for all types of destinations
+     *                 (queues and topics) should be used. Otherwise, separate connection
+     *                 factories will be configured.
      * @param cfOnSender Determine whether the connection factories (JMS providers)
      *                   should also be configured on the sender. This switch allows
      *                   us to build regression tests for SYNAPSE-448. 
      */
-    public JMSTransportDescriptionFactory(boolean cfOnSender) {
+    public JMSTransportDescriptionFactory(boolean singleCF, boolean cfOnSender) {
+        this.singleCF = singleCF;
         this.cfOnSender = cfOnSender;
     }
 
     @SuppressWarnings("unused")
-    // We implicitly depend on the environment; make this explicit
-    private void setUp(JMSTestEnvironment env) {
-        
+    private void setUp(JMSTestEnvironment env, JNDIEnvironment jndiEnvironment) throws Exception {
+        context = jndiEnvironment.getContext();
+        ConnectionFactory connectionFactory = env.getConnectionFactory();
+        if (singleCF) {
+            context.bind(CONNECTION_FACTORY, connectionFactory);
+        } else {
+            context.bind(QUEUE_CONNECTION_FACTORY, connectionFactory);
+            context.bind(TOPIC_CONNECTION_FACTORY, connectionFactory);
+        }
+    }
+    
+    @SuppressWarnings("unused")
+    private void tearDown() throws Exception {
+        if (singleCF) {
+            context.unbind(CONNECTION_FACTORY);
+        } else {
+            context.unbind(QUEUE_CONNECTION_FACTORY);
+            context.unbind(TOPIC_CONNECTION_FACTORY);
+        }
+        context = null;
     }
     
+    @Key("singleCF")
+    public boolean isSingleCF() {
+        return singleCF;
+    }
+
     @Key("cfOnSender")
     public boolean isCfOnSender() {
         return cfOnSender;
@@ -75,13 +108,20 @@ public class JMSTransportDescriptionFactory implements TransportDescriptionFacto
                 MockContextFactory.class.getName()));
         element.addChild(createParameterElement(JMSConstants.CONFAC_JNDI_NAME_PARAM,
                 connFactName));
-        element.addChild(createParameterElement(JMSConstants.CONFAC_TYPE, type));
+        if (type != null) {
+            element.addChild(createParameterElement(JMSConstants.CONFAC_TYPE, type));
+        }
         trpDesc.addParameter(new Parameter(name, element));
     }
     
     private void setupTransport(ParameterInclude trpDesc) throws AxisFault {
-        setupConnectionFactoryConfig(trpDesc, "queue", JMSTestEnvironment.QUEUE_CONNECTION_FACTORY, "queue");
-        setupConnectionFactoryConfig(trpDesc, "topic", JMSTestEnvironment.TOPIC_CONNECTION_FACTORY, "topic");
+        if (singleCF) {
+            // TODO: setting the type to "queue" is nonsense, but required by the transport (see SYNAPSE-439)
+            setupConnectionFactoryConfig(trpDesc, "default", CONNECTION_FACTORY, "queue");
+        } else {
+            setupConnectionFactoryConfig(trpDesc, "queue", QUEUE_CONNECTION_FACTORY, "queue");
+            setupConnectionFactoryConfig(trpDesc, "topic", TOPIC_CONNECTION_FACTORY, "topic");
+        }
     }
     
     public TransportInDescription createTransportInDescription() throws Exception {
@@ -99,4 +139,17 @@ public class JMSTransportDescriptionFactory implements TransportDescriptionFacto
         trpOutDesc.setSender(new JMSSender());
         return trpOutDesc;
     }
+    
+    public String getConnectionFactoryName(String destinationType) {
+        return singleCF ? "default" : destinationType;
+    }
+    
+    public String getConnectionFactoryJNDIName(String destinationType) {
+        if (singleCF) {
+            return CONNECTION_FACTORY;
+        } else {
+            return destinationType.equals("queue") ? QUEUE_CONNECTION_FACTORY
+                                                   : TOPIC_CONNECTION_FACTORY;
+        }
+    }
 }
diff --git a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSTransportTest.java b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSTransportTest.java
index faa5c585e..87bb6f268 100644
--- a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSTransportTest.java
+++ b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JMSTransportTest.java
@@ -45,7 +45,7 @@ public class JMSTransportTest extends TestCase {
         // Don't execute all possible test combinations:
         //  * Use a single setup to execute tests with all message types.
         //  * Only use a small set of message types for the other setups.
-        suite.addExclude("(!(|(&(broker=qpid)(cfOnSender=false)(!(|(destType=topic)(replyDestType=topic))))" +
+        suite.addExclude("(!(|(&(broker=qpid)(singleCF=false)(cfOnSender=false)(!(|(destType=topic)(replyDestType=topic))))" +
         		             "(&(test=AsyncXML)(messageType=SOAP11)(data=ASCII))" +
         		             "(&(test=EchoXML)(messageType=POX)(data=ASCII))))");
         
@@ -57,9 +57,11 @@ public class JMSTransportTest extends TestCase {
         TransportTestSuiteBuilder builder = new TransportTestSuiteBuilder(suite);
 
         JMSTestEnvironment[] environments = new JMSTestEnvironment[] { new QpidTestEnvironment(), new ActiveMQTestEnvironment() };
-        for (boolean cfOnSender : new boolean[] { false, true }) {
-            for (JMSTestEnvironment env : environments) {
-                builder.addEnvironment(env, new JMSTransportDescriptionFactory(cfOnSender));
+        for (boolean singleCF : new boolean[] { false, true }) {
+            for (boolean cfOnSender : new boolean[] { false, true }) {
+                for (JMSTestEnvironment env : environments) {
+                    builder.addEnvironment(env, new JMSTransportDescriptionFactory(singleCF, cfOnSender));
+                }
             }
         }
         
@@ -93,7 +95,7 @@ public class JMSTransportTest extends TestCase {
             suite.addTest(new MinConcurrencyTest(AxisServer.INSTANCE, new AsyncChannel[] {
                     new JMSAsyncChannel("endpoint1", JMSConstants.DESTINATION_TYPE_QUEUE, ContentTypeMode.TRANSPORT),
                     new JMSAsyncChannel("endpoint2", JMSConstants.DESTINATION_TYPE_QUEUE, ContentTypeMode.TRANSPORT) },
-                    2, false, env, new JMSTransportDescriptionFactory(false)));
+                    2, false, env, new JMSTransportDescriptionFactory(false, false)));
         }
         
         
diff --git a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JNDIEnvironment.java b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JNDIEnvironment.java
new file mode 100644
index 000000000..4e9060cc0
--- /dev/null
+++ b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/JNDIEnvironment.java
@@ -0,0 +1,48 @@
+/*
+ *  Licensed to the Apache Software Foundation (ASF) under one
+ *  or more contributor license agreements.  See the NOTICE file
+ *  distributed with this work for additional information
+ *  regarding copyright ownership.  The ASF licenses this file
+ *  to you under the Apache License, Version 2.0 (the
+ *  "License"); you may not use this file except in compliance
+ *  with the License.  You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ *  Unless required by applicable law or agreed to in writing,
+ *  software distributed under the License is distributed on an
+ *   * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ *  KIND, either express or implied.  See the License for the
+ *  specific language governing permissions and limitations
+ *  under the License.
+ */
+
+package org.apache.synapse.transport.jms;
+
+import javax.naming.Context;
+import javax.naming.InitialContext;
+
+import org.mockejb.jndi.MockContextFactory;
+
+public class JNDIEnvironment {
+    public static final JNDIEnvironment INSTANCE = new JNDIEnvironment();
+    
+    private Context context;
+    
+    private JNDIEnvironment() {}
+    
+    @SuppressWarnings("unused")
+    private void setUp() throws Exception {
+        MockContextFactory.setAsInitial();
+        context = new InitialContext();
+    }
+    
+    public Context getContext() {
+        return context;
+    }
+
+    @SuppressWarnings("unused")
+    private void tearDown() throws Exception {
+        context = null;
+    }
+}
diff --git a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/MockEchoEndpoint.java b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/MockEchoEndpoint.java
index 368c7072b..a3312304a 100644
--- a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/MockEchoEndpoint.java
+++ b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/MockEchoEndpoint.java
@@ -46,9 +46,9 @@ public class MockEchoEndpoint implements Endpoint {
     private void setUp(JMSTestEnvironment env, JMSRequestResponseChannel channel) throws Exception {
         Destination destination = channel.getDestination();
         Destination replyDestination = channel.getReplyDestination();
-        connection = env.getConnectionFactory(destination).createConnection();
+        connection = env.getConnectionFactory().createConnection();
         connection.start();
-        replyConnection = env.getConnectionFactory(replyDestination).createConnection();
+        replyConnection = env.getConnectionFactory().createConnection();
         final Session replySession = replyConnection.createSession(false, Session.AUTO_ACKNOWLEDGE);
         final MessageProducer producer = replySession.createProducer(replyDestination);
         MessageConsumer consumer = connection.createSession(false, Session.AUTO_ACKNOWLEDGE).createConsumer(destination);
diff --git a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/QpidTestEnvironment.java b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/QpidTestEnvironment.java
index 21524bf3f..2983b9843 100644
--- a/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/QpidTestEnvironment.java
+++ b/java/modules/transports/src/test/java/org/apache/synapse/transport/jms/QpidTestEnvironment.java
@@ -20,9 +20,7 @@
 package org.apache.synapse.transport.jms;
 
 import javax.jms.Queue;
-import javax.jms.QueueConnectionFactory;
 import javax.jms.Topic;
-import javax.jms.TopicConnectionFactory;
 
 import org.apache.qpid.client.AMQConnectionFactory;
 import org.apache.qpid.client.AMQQueue;
@@ -44,16 +42,7 @@ public class QpidTestEnvironment extends JMSTestEnvironment {
     }
 
     @Override
-    protected QueueConnectionFactory createQueueConnectionFactory() throws Exception {
-        return createConnectionFactory();
-    }
-
-    @Override
-    protected TopicConnectionFactory createTopicConnectionFactory() throws Exception {
-        return createConnectionFactory();
-    }
-    
-    private AMQConnectionFactory createConnectionFactory() throws Exception {
+    protected AMQConnectionFactory createConnectionFactory() throws Exception {
         return new AMQConnectionFactory("vm://:1", "guest", "guest", "fred", "test");
     }
 
