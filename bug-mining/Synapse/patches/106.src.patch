diff --git a/java/modules/transports/src/main/java/org/apache/synapse/format/BinaryFormatter.java b/java/modules/transports/src/main/java/org/apache/synapse/format/BinaryFormatter.java
index 522f01a9c..38c8dcaaf 100644
--- a/java/modules/transports/src/main/java/org/apache/synapse/format/BinaryFormatter.java
+++ b/java/modules/transports/src/main/java/org/apache/synapse/format/BinaryFormatter.java
@@ -24,6 +24,7 @@ import java.io.OutputStream;
 import java.net.URL;
 
 import javax.activation.DataHandler;
+import javax.activation.DataSource;
 
 import org.apache.axiom.om.OMElement;
 import org.apache.axiom.om.OMNode;
@@ -31,11 +32,10 @@ import org.apache.axiom.om.OMOutputFormat;
 import org.apache.axiom.om.OMText;
 import org.apache.axis2.AxisFault;
 import org.apache.axis2.context.MessageContext;
-import org.apache.axis2.transport.MessageFormatter;
 import org.apache.axis2.transport.http.util.URLTemplatingUtil;
 import org.apache.synapse.transport.base.BaseConstants;
 
-public class BinaryFormatter implements MessageFormatter {
+public class BinaryFormatter implements MessageFormatterEx {
     public byte[] getBytes(MessageContext messageContext, OMOutputFormat format) throws AxisFault {
         ByteArrayOutputStream baos = new ByteArrayOutputStream();
         writeTo(messageContext, format, baos, true);
@@ -88,4 +88,9 @@ public class BinaryFormatter implements MessageFormatter {
             OMOutputFormat format, String soapAction) {
         return null;
     }
+
+    public DataSource getDataSource(MessageContext messageContext,
+            OMOutputFormat format, String soapAction) throws AxisFault {
+        return getDataHandler(messageContext).getDataSource();
+    }
 }
diff --git a/java/modules/transports/src/main/java/org/apache/synapse/format/MessageFormatterEx.java b/java/modules/transports/src/main/java/org/apache/synapse/format/MessageFormatterEx.java
new file mode 100644
index 000000000..939ba21b5
--- /dev/null
+++ b/java/modules/transports/src/main/java/org/apache/synapse/format/MessageFormatterEx.java
@@ -0,0 +1,44 @@
+/*
+ *  Licensed to the Apache Software Foundation (ASF) under one
+ *  or more contributor license agreements.  See the NOTICE file
+ *  distributed with this work for additional information
+ *  regarding copyright ownership.  The ASF licenses this file
+ *  to you under the Apache License, Version 2.0 (the
+ *  "License"); you may not use this file except in compliance
+ *  with the License.  You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ *  Unless required by applicable law or agreed to in writing,
+ *  software distributed under the License is distributed on an
+ *   * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ *  KIND, either express or implied.  See the License for the
+ *  specific language governing permissions and limitations
+ *  under the License.
+ */
+package org.apache.synapse.format;
+
+import javax.activation.DataSource;
+
+import org.apache.axiom.om.OMOutputFormat;
+import org.apache.axis2.AxisFault;
+import org.apache.axis2.context.MessageContext;
+import org.apache.axis2.transport.MessageFormatter;
+
+/**
+ * Message formatter with extended capabilities.
+ * This interface adds new methods to the {@link MessageFormatter}
+ * interface, allowing transport to optimize data transfers.
+ */
+public interface MessageFormatterEx extends MessageFormatter {
+    /**
+     * Get the formatted message as a {@link DataSource} object.
+     * 
+     * @param messageContext
+     * @param format
+     * @param soapAction
+     * @return
+     * @throws AxisFault
+     */
+    DataSource getDataSource(MessageContext messageContext, OMOutputFormat format, String soapAction) throws AxisFault;
+}
diff --git a/java/modules/transports/src/main/java/org/apache/synapse/format/MessageFormatterExAdapter.java b/java/modules/transports/src/main/java/org/apache/synapse/format/MessageFormatterExAdapter.java
new file mode 100644
index 000000000..7e523d495
--- /dev/null
+++ b/java/modules/transports/src/main/java/org/apache/synapse/format/MessageFormatterExAdapter.java
@@ -0,0 +1,83 @@
+/*
+ *  Licensed to the Apache Software Foundation (ASF) under one
+ *  or more contributor license agreements.  See the NOTICE file
+ *  distributed with this work for additional information
+ *  regarding copyright ownership.  The ASF licenses this file
+ *  to you under the Apache License, Version 2.0 (the
+ *  "License"); you may not use this file except in compliance
+ *  with the License.  You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ *  Unless required by applicable law or agreed to in writing,
+ *  software distributed under the License is distributed on an
+ *   * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ *  KIND, either express or implied.  See the License for the
+ *  specific language governing permissions and limitations
+ *  under the License.
+ */
+package org.apache.synapse.format;
+
+import java.io.OutputStream;
+import java.net.URL;
+
+import javax.activation.DataSource;
+
+import org.apache.axiom.attachments.ByteArrayDataSource;
+import org.apache.axiom.om.OMOutputFormat;
+import org.apache.axis2.AxisFault;
+import org.apache.axis2.context.MessageContext;
+import org.apache.axis2.transport.MessageFormatter;
+
+/**
+ * Adapter to add the {@link MessageFormatterEx} interface to an
+ * existing {@link MessageFormatter}.
+ * It implements the {@link MessageFormatterEx#getDataSource(MessageContext, OMOutputFormat, String)} method
+ * using {@link MessageFormatter#getBytes(MessageContext, OMOutputFormat)} and
+ * {@link MessageFormatter#getContentType(MessageContext, OMOutputFormat, String)}.
+ */
+public class MessageFormatterExAdapter implements MessageFormatterEx {
+    private final MessageFormatter messageFormatter;
+
+    public MessageFormatterExAdapter(MessageFormatter messageFormatter) {
+        this.messageFormatter = messageFormatter;
+    }
+
+    public DataSource getDataSource(MessageContext messageContext,
+                                    OMOutputFormat format,
+                                    String soapAction) throws AxisFault {
+        return new ByteArrayDataSource(
+                getBytes(messageContext, format),
+                getContentType(messageContext, format, soapAction));
+    }
+
+    public String formatSOAPAction(MessageContext messageContext,
+                                   OMOutputFormat format,
+                                   String soapAction) {
+        return messageFormatter.formatSOAPAction(messageContext, format, soapAction);
+    }
+
+    public byte[] getBytes(MessageContext messageContext,
+                           OMOutputFormat format) throws AxisFault {
+        return messageFormatter.getBytes(messageContext, format);
+    }
+
+    public String getContentType(MessageContext messageContext,
+                                 OMOutputFormat format,
+                                 String soapAction) {
+        return messageFormatter.getContentType(messageContext, format, soapAction);
+    }
+
+    public URL getTargetAddress(MessageContext messageContext,
+                                OMOutputFormat format,
+                                URL targetURL) throws AxisFault {
+        return messageFormatter.getTargetAddress(messageContext, format, targetURL);
+    }
+
+    public void writeTo(MessageContext messageContext,
+                        OMOutputFormat format,
+                        OutputStream outputStream,
+                        boolean preserve) throws AxisFault {
+        messageFormatter.writeTo(messageContext, format, outputStream, preserve);
+    }
+}
diff --git a/java/modules/transports/src/main/java/org/apache/synapse/format/PlainTextFormatter.java b/java/modules/transports/src/main/java/org/apache/synapse/format/PlainTextFormatter.java
index c761791b9..f6cf69752 100644
--- a/java/modules/transports/src/main/java/org/apache/synapse/format/PlainTextFormatter.java
+++ b/java/modules/transports/src/main/java/org/apache/synapse/format/PlainTextFormatter.java
@@ -19,7 +19,6 @@
 
 package org.apache.synapse.format;
 
-import org.apache.axis2.transport.MessageFormatter;
 import org.apache.axis2.transport.http.util.URLTemplatingUtil;
 import org.apache.axis2.context.MessageContext;
 import org.apache.axis2.AxisFault;
@@ -34,10 +33,11 @@ import java.io.OutputStreamWriter;
 import java.io.Writer;
 import java.net.URL;
 
+import javax.activation.DataSource;
 import javax.xml.stream.XMLStreamException;
 import javax.xml.stream.XMLStreamReader;
 
-public class PlainTextFormatter implements MessageFormatter {
+public class PlainTextFormatter implements MessageFormatterEx {
 
     public byte[] getBytes(MessageContext messageContext, OMOutputFormat format) throws AxisFault {
     	ByteArrayOutputStream baos = new ByteArrayOutputStream();
@@ -94,4 +94,12 @@ public class PlainTextFormatter implements MessageFormatter {
     public String formatSOAPAction(MessageContext messageContext, OMOutputFormat format, String soapAction) {
         return null;
     }
+
+    public DataSource getDataSource(MessageContext messageContext,
+            OMOutputFormat format, String soapAction) throws AxisFault {
+        return new TextFromElementDataSource(
+                messageContext.getEnvelope().getBody().getFirstElement(),
+                format.getCharSetEncoding(),
+                getContentType(messageContext, format, soapAction));
+    }
 }
diff --git a/java/modules/transports/src/main/java/org/apache/synapse/format/TextFromElementDataSource.java b/java/modules/transports/src/main/java/org/apache/synapse/format/TextFromElementDataSource.java
new file mode 100644
index 000000000..dc793b2ed
--- /dev/null
+++ b/java/modules/transports/src/main/java/org/apache/synapse/format/TextFromElementDataSource.java
@@ -0,0 +1,126 @@
+/*
+ *  Licensed to the Apache Software Foundation (ASF) under one
+ *  or more contributor license agreements.  See the NOTICE file
+ *  distributed with this work for additional information
+ *  regarding copyright ownership.  The ASF licenses this file
+ *  to you under the Apache License, Version 2.0 (the
+ *  "License"); you may not use this file except in compliance
+ *  with the License.  You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ *  Unless required by applicable law or agreed to in writing,
+ *  software distributed under the License is distributed on an
+ *   * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ *  KIND, either express or implied.  See the License for the
+ *  specific language governing permissions and limitations
+ *  under the License.
+ */
+package org.apache.synapse.format;
+
+import java.io.IOException;
+import java.io.InputStream;
+import java.io.OutputStream;
+
+import javax.activation.DataSource;
+import javax.xml.stream.XMLStreamException;
+import javax.xml.stream.XMLStreamReader;
+
+import org.apache.axiom.om.OMElement;
+
+/**
+ * Data source that represents the text of a given {@link OMElement}.
+ * <p>
+ * The expression
+ * <pre>new TextFromElementDataSource(element, charset, contentType)</pre>
+ * produces a DataSource implementation that is equivalent to
+ * <pre>new ByteArrayDataSource(element.getText().getBytes(charset), contentType)</pre>
+ * but that is more efficient.
+ */
+public class TextFromElementDataSource implements DataSource {
+    private static class InputStreamImpl extends InputStream {
+        private final XMLStreamReader reader;
+        private final String charset;
+        private byte[] buffer;
+        private int offset;
+        
+        public InputStreamImpl(XMLStreamReader reader, String charset) {
+            this.reader = reader;
+            this.charset = charset;
+        }
+
+        @Override
+        public int read() throws IOException {
+            byte[] b = new byte[1];
+            return read(b) == -1 ? -1 : b[0] & 0xFF;
+        }
+
+        @Override
+        public int read(byte[] b) throws IOException {
+            return read(b, 0, b.length);
+        }
+
+        @Override
+        public int read(byte[] b, int off, int len) throws IOException {
+            try {
+                int read = 0;
+                outer: while (len > 0) {
+                    if (buffer == null || offset == buffer.length) {
+                        // Refill buffer
+                        while (true) {
+                            if (!reader.hasNext()) {
+                                break outer;
+                            }
+                            if (reader.next() == XMLStreamReader.CHARACTERS) {
+                                // Note: this is not entirely correct for encodings such as UTF-16.
+                                // Once IO-158 is implemented, we could avoid this by implementing a
+                                // Reader and using ReaderInputStream.
+                                buffer = reader.getText().getBytes(charset);
+                                offset = 0;
+                                break;
+                            }
+                        }
+                    }
+                    int c = Math.min(len, buffer.length-offset);
+                    System.arraycopy(buffer, offset, b, off, c);
+                    offset += c;
+                    off += c;
+                    len -= c;
+                    read += c;
+                }
+                return read == 0 ? -1 : read;
+            }
+            catch (XMLStreamException ex) {
+                IOException ioException = new IOException("Unable to read from XMLStreamReader");
+                ioException.initCause(ex);
+                throw ioException;
+            }
+        }
+    }
+    
+    private final OMElement element;
+    private final String charset;
+    private final String contentType;
+    
+    public TextFromElementDataSource(OMElement element, String charset, String contentType) {
+        this.element = element;
+        this.charset = charset;
+        this.contentType = contentType;
+    }
+    
+    public String getContentType() {
+        return contentType;
+    }
+
+    public String getName() {
+        return null;
+    }
+
+    public InputStream getInputStream() throws IOException {
+        return new InputStreamImpl(element.getXMLStreamReader(), charset);
+    }
+
+    public OutputStream getOutputStream() throws IOException {
+        throw new UnsupportedOperationException();
+    }
+}
diff --git a/java/modules/transports/src/main/java/org/apache/synapse/transport/mail/MailTransportSender.java b/java/modules/transports/src/main/java/org/apache/synapse/transport/mail/MailTransportSender.java
index 09c703476..173cebcb9 100644
--- a/java/modules/transports/src/main/java/org/apache/synapse/transport/mail/MailTransportSender.java
+++ b/java/modules/transports/src/main/java/org/apache/synapse/transport/mail/MailTransportSender.java
@@ -19,10 +19,11 @@
 
 package org.apache.synapse.transport.mail;
 
+import org.apache.synapse.format.MessageFormatterEx;
+import org.apache.synapse.format.MessageFormatterExAdapter;
 import org.apache.synapse.transport.base.AbstractTransportSender;
 import org.apache.synapse.transport.base.BaseConstants;
 import org.apache.synapse.transport.base.BaseUtils;
-import org.apache.synapse.transport.base.BaseTransportException;
 import org.apache.commons.logging.LogFactory;
 import org.apache.axis2.context.ConfigurationContext;
 import org.apache.axis2.context.MessageContext;
@@ -32,25 +33,15 @@ import org.apache.axis2.AxisFault;
 import org.apache.axis2.addressing.AddressingConstants;
 import org.apache.axis2.transport.OutTransportInfo;
 import org.apache.axis2.transport.MessageFormatter;
-import org.apache.axis2.transport.TransportUtils;
-import org.apache.axiom.om.OMElement;
 import org.apache.axiom.om.OMOutputFormat;
-import org.apache.axiom.om.OMNode;
-import org.apache.axiom.om.OMText;
-import org.apache.axiom.om.impl.llom.OMSourcedElementImpl;
 
 import javax.mail.*;
-import javax.mail.util.ByteArrayDataSource;
 import javax.mail.internet.*;
 import javax.activation.DataHandler;
-import javax.activation.DataSource;
 import javax.activation.MailcapCommandMap;
 import javax.activation.CommandMap;
-import javax.xml.stream.XMLStreamException;
-import javax.xml.stream.XMLStreamReader;
 
 import java.util.*;
-import java.io.ByteArrayOutputStream;
 import java.io.IOException;
 
 /**
@@ -210,13 +201,7 @@ public class MailTransportSender extends AbstractTransportSender {
         throws AxisFault, MessagingException, IOException {
 
         OMOutputFormat format = BaseUtils.getOMOutputFormat(msgContext);
-        MessageFormatter messageFormatter = null;
-
-        try {
-            messageFormatter = TransportUtils.getMessageFormatter(msgContext);
-        } catch (AxisFault axisFault) {
-            throw new BaseTransportException("Unable to get the message formatter to use");
-        }
+        MessageFormatter messageFormatter = BaseUtils.getMessageFormatter(msgContext);
 
         WSMimeMessage message = new WSMimeMessage(session);
         Map trpHeaders = (Map) msgContext.getProperty(MessageContext.TRANSPORT_HEADERS);
@@ -320,74 +305,34 @@ public class MailTransportSender extends AbstractTransportSender {
         message.setHeader(BaseConstants.SOAPACTION, msgContext.getSoapAction());
 
         // write body
-        ByteArrayOutputStream baos = null;
-        String contentType = messageFormatter.getContentType(
-            msgContext, format, msgContext.getSoapAction());
-        DataHandler dataHandler = null;
+        MessageFormatterEx messageFormatterEx;
+        if (messageFormatter instanceof MessageFormatterEx) {
+            messageFormatterEx = (MessageFormatterEx)messageFormatter;
+        } else {
+            messageFormatterEx = new MessageFormatterExAdapter(messageFormatter);
+        }
+        
+        DataHandler dataHandler = new DataHandler(messageFormatterEx.getDataSource(msgContext, format, msgContext.getSoapAction()));
+        
         MimeMultipart mimeMultiPart = null;
 
-        OMElement firstChild = msgContext.getEnvelope().getBody().getFirstElement();
-        if (firstChild != null) {
-
-            if (BaseConstants.DEFAULT_BINARY_WRAPPER.equals(firstChild.getQName())) {
-                baos = new ByteArrayOutputStream();
-                OMNode omNode = firstChild.getFirstOMChild();
-
-                if (omNode != null && omNode instanceof OMText) {
-                    Object dh = ((OMText) omNode).getDataHandler();
-                    if (dh != null && dh instanceof DataHandler) {
-                        dataHandler = (DataHandler) dh;
-                    }
-                }
-            } else if (BaseConstants.DEFAULT_TEXT_WRAPPER.equals(firstChild.getQName())) {
-//                if (firstChild instanceof OMSourcedElementImpl) {
-//                    // Note: this code will be replaced by something more efficient later
-//                    baos = new ByteArrayOutputStream();
-//                    try {
-//                        XMLStreamReader reader = firstChild.getXMLStreamReader();
-//                        while (reader.hasNext()) {
-//                            if (reader.next() == XMLStreamReader.CHARACTERS) {
-//                                baos.write(reader.getText().getBytes());
-//                            }
-//                        }
-//                    } catch (XMLStreamException e) {
-//                        handleException("Error serializing 'text' payload from OMSourcedElement", e);
-//                    }
-//                    dataHandler = new DataHandler(new String(
-//                        baos.toByteArray(), format.getCharSetEncoding()), MailConstants.TEXT_PLAIN);
-//                } else {
-//                    dataHandler = new DataHandler(firstChild.getText(), MailConstants.TEXT_PLAIN);
-//                }
-                dataHandler = new DataHandler(firstChild.getText(), MailConstants.TEXT_PLAIN +
-                        "; charset=" + format.getCharSetEncoding());
-            } else {
-
-                baos = new ByteArrayOutputStream();
-                messageFormatter.writeTo(msgContext, format, baos, true);
-
-                // create the data handler
-                dataHandler = new DataHandler(
-                    new String(baos.toByteArray(), format.getCharSetEncoding()), contentType);
+        String mFormat = (String) msgContext.getProperty(MailConstants.TRANSPORT_MAIL_FORMAT);
+        if (mFormat == null) {
+            mFormat = defaultMailFormat;
+        }
 
-                String mFormat = (String) msgContext.getProperty(MailConstants.TRANSPORT_MAIL_FORMAT);
-                if (mFormat == null) {
-                    mFormat = defaultMailFormat;
-                }
+        if (MailConstants.TRANSPORT_FORMAT_MP.equals(mFormat)) {
+            mimeMultiPart = new MimeMultipart();
+            MimeBodyPart mimeBodyPart1 = new MimeBodyPart();
+            mimeBodyPart1.setContent("Web Service Message Attached","text/plain");
+            MimeBodyPart mimeBodyPart2 = new MimeBodyPart();
+            mimeBodyPart2.setDataHandler(dataHandler);
+            mimeBodyPart2.setHeader(BaseConstants.SOAPACTION, msgContext.getSoapAction());
+            mimeMultiPart.addBodyPart(mimeBodyPart1);
+            mimeMultiPart.addBodyPart(mimeBodyPart2);
 
-                if (MailConstants.TRANSPORT_FORMAT_MP.equals(mFormat)) {
-                    mimeMultiPart = new MimeMultipart();
-                    MimeBodyPart mimeBodyPart1 = new MimeBodyPart();
-                    mimeBodyPart1.setContent("Web Service Message Attached","text/plain");
-                    MimeBodyPart mimeBodyPart2 = new MimeBodyPart();
-                    mimeBodyPart2.setDataHandler(dataHandler);
-                    mimeBodyPart2.setHeader(BaseConstants.SOAPACTION, msgContext.getSoapAction());
-                    mimeMultiPart.addBodyPart(mimeBodyPart1);
-                    mimeMultiPart.addBodyPart(mimeBodyPart2);
-
-                } else {
-                    message.setHeader(BaseConstants.SOAPACTION, msgContext.getSoapAction());
-                }
-            }
+        } else {
+            message.setHeader(BaseConstants.SOAPACTION, msgContext.getSoapAction());
         }
 
         try {
@@ -419,12 +364,6 @@ public class MailTransportSender extends AbstractTransportSender {
             handleException("Error creating mail message or sending it to the configured server", e);
             metrics.incrementFaultsSending();
             
-        } finally {
-            try {
-                if (baos != null) {
-                    baos.close();
-                }
-            } catch (IOException ignore) {}
         }
     }
 }
