diff --git a/java/modules/core/src/main/java/org/apache/synapse/util/TemporaryData.java b/java/modules/core/src/main/java/org/apache/synapse/util/TemporaryData.java
index 60d85b5e2..6549eb56d 100644
--- a/java/modules/core/src/main/java/org/apache/synapse/util/TemporaryData.java
+++ b/java/modules/core/src/main/java/org/apache/synapse/util/TemporaryData.java
@@ -239,6 +239,9 @@ public class TemporaryData {
     
     public void release() {
         if (temporaryFile != null) {
+            if (log.isDebugEnabled()) {
+                log.debug("Deleting temporary file " + temporaryFile);
+            }
             temporaryFile.delete();
         }
     }
diff --git a/java/modules/core/src/main/java/org/apache/synapse/util/TextFileDataSource.java b/java/modules/core/src/main/java/org/apache/synapse/util/TextFileDataSource.java
index 3c4b2693e..d237f9654 100644
--- a/java/modules/core/src/main/java/org/apache/synapse/util/TextFileDataSource.java
+++ b/java/modules/core/src/main/java/org/apache/synapse/util/TextFileDataSource.java
@@ -19,48 +19,31 @@
 
 package org.apache.synapse.util;
 
-import org.apache.axiom.om.OMDataSource;
+import org.apache.axiom.om.OMDataSourceExt;
 import org.apache.axiom.om.OMOutputFormat;
-import org.apache.axiom.om.OMFactory;
-import org.apache.axiom.om.OMAbstractFactory;
-import org.apache.axiom.om.impl.llom.OMSourcedElementImpl;
+import org.apache.axiom.om.ds.OMDataSourceExtBase;
 import org.apache.axiom.om.impl.serialize.StreamingOMSerializer;
 import org.apache.synapse.SynapseException;
 import org.apache.synapse.transport.base.BaseConstants;
 
-import javax.activation.DataSource;
-import javax.activation.FileDataSource;
 import javax.xml.stream.XMLStreamException;
 import javax.xml.stream.XMLStreamReader;
 import javax.xml.stream.XMLStreamWriter;
 import java.io.*;
 
-public class TextFileDataSource implements OMDataSource {
+public class TextFileDataSource extends OMDataSourceExtBase {
 
     private static final byte[] empty =
         "<text xmlns=\"http://ws.apache.org/commons/ns/payload\"/>".getBytes();
-    private InputStream is = null;
+    private final TemporaryData temporaryData;
 
-    public TextFileDataSource(DataSource ds) {
-        try {
-            this.is = ds.getInputStream();
-        } catch (IOException e) {
-            throw new SynapseException(
-                "Unable to get an InputStream for DataSource : " + ds.getName(), e);
-        }
-    }
-    
     public TextFileDataSource(TemporaryData temporaryData) {
-        try {
-            this.is = temporaryData.getInputStream();
-        } catch (IOException e) {
-            throw new SynapseException(
-                "Unable to get an InputStream for temporary data", e);
-        }
+        this.temporaryData = temporaryData;
     }
 
     public void serialize(OutputStream out, OMOutputFormat format) throws XMLStreamException {
         try {
+            InputStream is = temporaryData.getInputStream();
             byte[] buf = new byte[4096];
             int len;
             while ((len = is.read(buf)) > 0) {
@@ -85,6 +68,36 @@ public class TextFileDataSource implements OMDataSource {
     }
 
     public XMLStreamReader getReader() throws XMLStreamException {
+        InputStream is;
+        try {
+            is = temporaryData.getInputStream();
+        }
+        catch (IOException ex) {
+            throw new XMLStreamException(ex);
+        }
         return new WrappedTextNodeStreamReader(BaseConstants.DEFAULT_TEXT_WRAPPER, new InputStreamReader(is));
     }
+
+    public Object getObject() {
+        return temporaryData;
+    }
+
+    public boolean isDestructiveRead() {
+        return false;
+    }
+
+    public boolean isDestructiveWrite() {
+        return false;
+    }
+    
+    public byte[] getXMLBytes(String encoding) throws UnsupportedEncodingException {
+        throw new UnsupportedOperationException();
+    }
+
+    public void close() {
+    }
+
+    public OMDataSourceExt copy() {
+        return new TextFileDataSource(temporaryData);
+    }
 }
diff --git a/java/modules/core/src/test/java/org/apache/synapse/util/TextFileDataSourceTest.java b/java/modules/core/src/test/java/org/apache/synapse/util/TextFileDataSourceTest.java
index 5c0fbc9fc..d78a32f97 100644
--- a/java/modules/core/src/test/java/org/apache/synapse/util/TextFileDataSourceTest.java
+++ b/java/modules/core/src/test/java/org/apache/synapse/util/TextFileDataSourceTest.java
@@ -19,22 +19,25 @@
 
 package org.apache.synapse.util;
 
-import org.apache.axiom.attachments.ByteArrayDataSource;
+import java.io.OutputStream;
+
+import junit.framework.TestCase;
+
 import org.apache.axiom.om.OMAbstractFactory;
 import org.apache.axiom.om.OMDataSource;
 import org.apache.axiom.om.OMFactory;
 import org.apache.axiom.om.impl.llom.OMSourcedElementImpl;
 import org.apache.synapse.transport.base.BaseConstants;
-import org.apache.synapse.util.TextFileDataSource;
-
-import junit.framework.TestCase;
 
 public class TextFileDataSourceTest extends TestCase {
 
     public void testWithXMLChars() throws Exception {
+        TemporaryData tmp = new TemporaryData(4, 1024, "tmp_", ".dat");
+        OutputStream out = tmp.getOutputStream();
         String testString = "Test string with ampersand (&)";
-        OMDataSource dataSource
-            = new TextFileDataSource(new ByteArrayDataSource(testString.getBytes("UTF-8")));
+        out.write(testString.getBytes("UTF-8"));
+        out.close();
+        OMDataSource dataSource = new TextFileDataSource(tmp);
         OMFactory omFactory = OMAbstractFactory.getOMFactory();
         OMSourcedElementImpl element
             = new OMSourcedElementImpl(BaseConstants.DEFAULT_TEXT_WRAPPER, omFactory, dataSource);
