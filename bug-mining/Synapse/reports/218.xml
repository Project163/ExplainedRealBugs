<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 20:08:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SYNAPSE-525] Option to preserve addressing headers should be available</title>
                <link>https://issues.apache.org/jira/browse/SYNAPSE-525</link>
                <project id="12310201" key="SYNAPSE">Synapse</project>
                    <description>&lt;p&gt;For the moment Synapse replaces all the addressing headers when sending the message out to the routed service, but there can be case where the mediation configuration should preserve the addressing headers. For example like wsa:Reply-To&lt;/p&gt;

&lt;p&gt;So this requires a switch to configure the send mediator to not to alter addressing headers.&lt;/p&gt;</description>
                <environment>all env</environment>
        <key id="12419367">SYNAPSE-525</key>
            <summary>Option to preserve addressing headers should be available</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ruwan">Ruwan Linton</assignee>
                                    <reporter username="ruwan">Ruwan Linton</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Mar 2009 05:12:24 +0000</created>
                <updated>Mon, 25 May 2009 08:13:52 +0000</updated>
                            <resolved>Mon, 11 May 2009 19:31:58 +0000</resolved>
                                    <version>1.2</version>
                                    <fixVersion>2.0</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12689473" author="ruwan" created="Thu, 26 Mar 2009 13:29:43 +0000"  >&lt;p&gt;This can also be fixed in the same manner by introducing a property to configure the behavior?&lt;/p&gt;

&lt;p&gt;&amp;lt;property name=&quot;PRESERVE_WS_ADDRESSING&quot; value=&quot;true&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;In the same way as discussed in the;&lt;br/&gt;
&lt;a href=&quot;http://markmail.org/message/cvbfh2wpapn2yt6u&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://markmail.org/message/cvbfh2wpapn2yt6u&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;What us the best place for this property is that inside the send or inside the endpoint??&lt;/p&gt;

&lt;p&gt;Ruwan&lt;/p&gt;</comment>
                            <comment id="12689488" author="asankha" created="Thu, 26 Mar 2009 13:52:33 +0000"  >&lt;p&gt;Ruwan&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SYNAPSE-422&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SYNAPSE-422&lt;/a&gt; was fixed by me a few days back, and seems related to this.&lt;/p&gt;

&lt;p&gt;On the question &quot;What us the best place for this property is that inside the send or inside the endpoint&quot;, there will be NO distinction on this.. what we will do is make it possible to set some properties within send and endpoint, instead of as property mediator calls. &lt;/p&gt;

&lt;p&gt;thanks&lt;br/&gt;
asankha&lt;/p&gt;</comment>
                            <comment id="12689524" author="ruwan" created="Thu, 26 Mar 2009 15:58:56 +0000"  >&lt;p&gt;Well, I think this is exactly what I wanted to fix.... &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I will test my scenario and let you know.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Ruwan&lt;/p&gt;</comment>
                            <comment id="12689529" author="ruwan" created="Thu, 26 Mar 2009 16:14:35 +0000"  >&lt;p&gt;This is what I wanted and actually I was about to propose to handle the addressing case in the same way as the security case, so this fixes the issue on the out going message but the response will also have to be fixed.... I will look into that.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Ruwan&lt;/p&gt;</comment>
                            <comment id="12689955" author="asankha" created="Fri, 27 Mar 2009 16:33:51 +0000"  >&lt;p&gt;Ruwan, since this caused a build instability (due to an error I made in &lt;a href=&quot;https://issues.apache.org/jira/browse/SYNAPSE-422&quot; title=&quot;Axis2FlexibleMEPClient removal of addressing headers should be configurable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SYNAPSE-422&quot;&gt;&lt;del&gt;SYNAPSE-422&lt;/del&gt;&lt;/a&gt;) and since you would be traveling back this weekend from ApacheCon, I&apos;ve committed this fix&lt;/p&gt;

&lt;p&gt;thanks&lt;br/&gt;
asankha&lt;/p&gt;</comment>
                            <comment id="12690142" author="ruwan" created="Fri, 27 Mar 2009 22:55:19 +0000"  >&lt;p&gt;Asankha, this fixes only one path and at the same time it uses the PRESERVE_ADDRESSING property.... can&apos;t we fix this in the way that you fixed it earlier.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Ruwan&lt;/p&gt;</comment>
                            <comment id="12694560" author="ruwan" created="Wed, 1 Apr 2009 14:47:33 +0000"  >&lt;p&gt;Asankha, I changed the default behavior to preserve addressing and if you need to remove addressing you could use the REMOVE_WS_ADDRESSING property in the flow before sending.&lt;/p&gt;

&lt;p&gt;This is how we handle security as well and it is consistent this way. This property is useful because not like in security case we have at least 3 headers to be removed in addressing &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Ruwan&lt;/p&gt;</comment>
                            <comment id="12695748" author="veithen" created="Sat, 4 Apr 2009 14:48:51 +0000"  >&lt;p&gt;I don&apos;t think that preserving the WS-Addressing headers by default is a good idea. At least it is not a good idea to reuse the same message ID. One reason is that this is probably in contradiction with the WS-Addressing specs. The other is that it will change the behavior of existing mediations and it will have unexpected effects in mediations that send out multiple messages. For example this change breaks sample 400.&lt;/p&gt;</comment>
                            <comment id="12695760" author="ruwan" created="Sat, 4 Apr 2009 15:39:43 +0000"  >&lt;p&gt;Let me have a look at the sample 400, it shouldn&apos;t be affected because in splitting we assign them a new messageId anyway.&lt;/p&gt;

&lt;p&gt;But I agree with the argument on messageId, but at the same time the proxy shouldn&apos;t change the addressing details by default, because lets say you want to bypass Synapse on the response, what you do is you send a message to synapse specifying the Reply-To as the client itself, in which case message id also has to be preserved for the correlation to work properly.&lt;/p&gt;

&lt;p&gt;Anyway I will have a more deep look into this.&lt;/p&gt;</comment>
                            <comment id="12700446" author="veithen" created="Sat, 18 Apr 2009 09:53:56 +0000"  >&lt;p&gt;The following change in Axis2FlexibleMEPClient causes a serious issue:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Options clientOptions = new Options();&lt;br/&gt;
+        Options clientOptions = MessageHelper.cloneOptions(originalInMsgCtx.getOptions());&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;With this change, if the incoming request has no WS-Addressing headers, the proxy service seems to attempt sending the outgoing message to itself instead of the target endpoint!&lt;/p&gt;

&lt;p&gt;The issue can be reproduced with sample 150: use SOAPUI to send a message without WS-Addressing to the proxy service. It will fail saying that Axis2 can&apos;t infer the outgoing transport. The endpoint URI from which it tries to infer the transport is the URI of the proxy service, not the target service.&lt;/p&gt;</comment>
                            <comment id="12700449" author="veithen" created="Sat, 18 Apr 2009 10:03:29 +0000"  >&lt;p&gt;Just noticed that the cloneOptions related issue is actually the same as the one reported by Eric &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;. Since this is quite serious, I temporarily reverted the change.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://markmail.org/message/2cjy73ksrly5znaz&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://markmail.org/message/2cjy73ksrly5znaz&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12700499" author="ruwan" created="Sat, 18 Apr 2009 16:09:41 +0000"  >&lt;p&gt;Sorry, for not testing all the scenarios with this change.... I will fix this ASAP.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Ruwan&lt;/p&gt;</comment>
                            <comment id="12700650" author="ruwan" created="Mon, 20 Apr 2009 05:17:21 +0000"  >&lt;p&gt;This issue is due to the fact that the Addressing information being copied while cloning the options and the client options gets a higher precedence on messages going out, in the client side of the axis2 and this particular case in synapse acts as a axis2 client.&lt;/p&gt;</comment>
                            <comment id="12700651" author="ruwan" created="Mon, 20 Apr 2009 05:18:11 +0000"  >&lt;p&gt;Fixed on the trunk&lt;/p&gt;</comment>
                            <comment id="12700656" author="ruwan" created="Mon, 20 Apr 2009 05:59:44 +0000"  >&lt;p&gt;Ooopppsseeee, wrong ticket... the above 3 comments and the resolution applies to the &lt;a href=&quot;https://issues.apache.org/jira/browse/SYNAPSE-531&quot; title=&quot;Clone the complete options object when coning the mesasge but not just the option properties&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SYNAPSE-531&quot;&gt;&lt;del&gt;SYNAPSE-531&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12707822" author="veithen" created="Sun, 10 May 2009 18:21:11 +0000"  >&lt;p&gt;As already said above, I don&apos;t think that preserving the WS-Addressing headers by default is a good idea. This change breaks many of the Synapse samples and will therefore also break lots of existing user configurations. I just discovered that sample 251 is also broken because of this. It now fails with the following error in the sample Axis2 server:&lt;/p&gt;

&lt;p&gt;org.apache.axis2.AxisFault: A header representing a Message Addressing Property is not valid and the message cannot be processed&lt;br/&gt;
  at org.apache.axis2.addressing.AddressingFaultsHelper.triggerAddressingFault(AddressingFaultsHelper.java:373)&lt;br/&gt;
  at org.apache.axis2.addressing.AddressingFaultsHelper.triggerActionMismatchFault(AddressingFaultsHelper.java:222)&lt;br/&gt;
  at org.apache.axis2.handlers.addressing.AddressingInHandler.extractActionInformation(AddressingInHandler.java:532)&lt;br/&gt;
  at org.apache.axis2.handlers.addressing.AddressingInHandler.extractAddressingInformation(AddressingInHandler.java:238)&lt;br/&gt;
  at org.apache.axis2.handlers.addressing.AddressingInHandler.invoke(AddressingInHandler.java:153)&lt;br/&gt;
  at org.apache.axis2.engine.Phase.invoke(Phase.java:318)&lt;br/&gt;
  at org.apache.axis2.engine.AxisEngine.invoke(AxisEngine.java:251)&lt;br/&gt;
  at org.apache.axis2.engine.AxisEngine.receive(AxisEngine.java:160)&lt;br/&gt;
  at org.apache.axis2.transport.base.AbstractTransportListener.handleIncomingMessage(AbstractTransportListener.java:314)&lt;br/&gt;
  at org.apache.axis2.transport.jms.JMSMessageReceiver.processThoughEngine(JMSMessageReceiver.java:215)&lt;br/&gt;
  at org.apache.axis2.transport.jms.JMSMessageReceiver.onMessage(JMSMessageReceiver.java:126)&lt;br/&gt;
  at org.apache.axis2.transport.jms.ServiceTaskManager$MessageListenerTask.handleMessage(ServiceTaskManager.java:512)&lt;br/&gt;
  at org.apache.axis2.transport.jms.ServiceTaskManager$MessageListenerTask.run(ServiceTaskManager.java:424)&lt;br/&gt;
  at org.apache.axis2.transport.base.threads.NativeWorkerPool$1.run(NativeWorkerPool.java:58)&lt;br/&gt;
  at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:650)&lt;br/&gt;
  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:675)&lt;br/&gt;
  at java.lang.Thread.run(Thread.java:613)&lt;/p&gt;

&lt;p&gt;Ruwan, can you please work on this?&lt;/p&gt;</comment>
                            <comment id="12707828" author="ruwan" created="Sun, 10 May 2009 18:48:00 +0000"  >&lt;p&gt;I will definitely have a look at these issues... but the rationale behind this was to make the addresing handling be consistent with other QoS handlings like security and reliable messaging. In those cases if you want to drop them, you need to drop them within the configuration, but if you do not specify anything in the configuration we are preserving the security and RM headers. We need to be consistent about these and I didn&apos;t want to specialize the addressing scenario.&lt;/p&gt;

&lt;p&gt;I still believe that preserving addressing is the correct behavior.... please note that options cloning is not related to the preserving addressing headers, which also seems to be introducing a quite a bit of issues.&lt;/p&gt;

&lt;p&gt;I will have a look at all the samples and these changes once I get some free slot.&lt;/p&gt;</comment>
                            <comment id="12707938" author="veithen" created="Mon, 11 May 2009 08:49:17 +0000"  >&lt;p&gt;I think that neither the preserve-by-default nor the remove-by-default approach are appropriate and consistent, but that the most reasonable default behavior would be as follows:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;If the SOAP header has been processed by a module engaged on the proxy service, remove it when forwarding the message.&lt;/li&gt;
	&lt;li&gt;If the SOAP header has not been processed by a module engaged on the proxy service, preserve it and forward it to the target service.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This would even extend to WS-Security: if Rampart is engaged on a proxy service (I don&apos;t know if that is possible for the moment), it means that the security headers are for Synapse and in general it would be wrong to forward them. On the other hand, if Rampart is not engaged on the proxy, in most cases this means that they are for the target service and we should forward them.&lt;/p&gt;

&lt;p&gt;Since currently only addressing is engaged by default on proxy services, the old behavior (remove addressing headers, but preserve security and RM headers) was actually consistent! On the other hand, I agree with you that hardcoding this decision in the core is not a good idea. I think that Axis2 keeps track of the headers that have been processed (for the must understand check). Therefore my counterproposal would be:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;For 1.3, revert to the old behavior (remove addressing information by default).&lt;/li&gt;
	&lt;li&gt;For the next release after 1.3, implement a proper mechanism that preserves or removes headers based on the rules above.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12707963" author="ruwan" created="Mon, 11 May 2009 10:21:45 +0000"  >&lt;p&gt;I agree... I will fix this ASAP, we need to keep the parameter to preserve the addressing headers as well.&lt;/p&gt;

&lt;p&gt;So in effect, we can revert the default behavior to remove the addressing headers, and keep the property to specify to not to remove the addressing headers.&lt;/p&gt;</comment>
                            <comment id="12707990" author="veithen" created="Mon, 11 May 2009 12:17:31 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;When I said &quot;revert to the old behavior&quot;, I actually meant implementing the change as in the initial proposal for this issue, i.e. to introduce a property to preserve the addressing headers.&lt;/p&gt;</comment>
                            <comment id="12708146" author="ruwan" created="Mon, 11 May 2009 18:34:02 +0000"  >&lt;p&gt;I have reverted the default behavior change.... and in the process of testing the samples&lt;/p&gt;</comment>
                            <comment id="12708166" author="ruwan" created="Mon, 11 May 2009 19:27:30 +0000"  >&lt;p&gt;tested a few samples and seems to be working fine - (even sample 13 dual channel mode is working)&lt;/p&gt;</comment>
                            <comment id="12708168" author="ruwan" created="Mon, 11 May 2009 19:31:58 +0000"  >&lt;p&gt;tested most of the affected samples and they all seems to be fixed&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12425381">SYNAPSE-549</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12426274">SYNAPSE-552</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>183748</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 29 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i11dhr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>216152</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>