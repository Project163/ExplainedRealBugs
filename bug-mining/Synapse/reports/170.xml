<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 20:07:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SYNAPSE-443] If ClientHandler receives a response of bad request from http server, causes many NullPointerExceptions.</title>
                <link>https://issues.apache.org/jira/browse/SYNAPSE-443</link>
                <project id="12310201" key="SYNAPSE">Synapse</project>
                    <description>&lt;p&gt;In ClientHandler.responseReceived(), if the resposne.getStatusLine().getStatusCode() is HttpStatus.SC_BAD_REQUEST, we log the error and return.  After this, IO Reactor tries to stream the response content to us with a call to inputReady(), however the RESPONSE_SINK_BUFFER will be null, so we throw a NullPointerException.  IO Reactor will continue to try to deliver content to us, so the result is a huge pile of NullPointerExceptions.&lt;/p&gt;

&lt;p&gt;Easy fix seems to be to call &quot;processResponse()&quot; in the SC_BAD_REQUEST case of the switch statement, like every other case does.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12404197">SYNAPSE-443</key>
            <summary>If ClientHandler receives a response of bad request from http server, causes many NullPointerExceptions.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ruwan">Ruwan Linton</assignee>
                                    <reporter username="jasonwalton">Jason Walton</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Sep 2008 19:52:18 +0000</created>
                <updated>Mon, 20 Oct 2008 19:42:07 +0000</updated>
                            <resolved>Mon, 20 Oct 2008 19:42:07 +0000</resolved>
                                    <version>2.0</version>
                                    <fixVersion>2.0</fixVersion>
                                    <component>Transports</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12636522" author="ruwan" created="Fri, 3 Oct 2008 04:12:49 +0000"  >&lt;p&gt;Can you please point me how to reproduce this issue? By looking at the code your suggestion seems to work because even in the case of unknown status code we call processResponse(), but I need to test this before committing the fix.&lt;/p&gt;</comment>
                            <comment id="12636618" author="jasonwalton" created="Fri, 3 Oct 2008 12:42:27 +0000"  >&lt;p&gt;The easiest way to test this that I can think of would be to write a quick and dirty &quot;dummy web server&quot;, which always returns bad request.  Make sure you read the request from Synapse completely before returning 400, if you go this route, otherwise you&apos;ll likely also get errors from IOReactor (see &lt;a href=&quot;https://issues.apache.org/jira/browse/SYNAPSE-341&quot; title=&quot;System unstable when HTTP response returned before request fully written&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SYNAPSE-341&quot;&gt;&lt;del&gt;SYNAPSE-341&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;The other obvious way would be to hack up Synapse so it actually generates bad requests.  &lt;/p&gt;

&lt;p&gt;I have seen this exact problem happen (which is how I found it in the first place), but in my case I was sending requests to a closed-source web server written by a third party.  So it&apos;s possible there&apos;s some code path that causes Synapse to send bad requests, but to be honest I&apos;m somewhat suspicious of the web server in question.  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12641129" author="ruwan" created="Mon, 20 Oct 2008 19:42:07 +0000"  >&lt;p&gt;Fixed on the trunk..&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>183667</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 6 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i11cy7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>216064</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>