<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 20:07:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SYNAPSE-309] Adding an attachment causes failure in MessageHelper.clonePartially</title>
                <link>https://issues.apache.org/jira/browse/SYNAPSE-309</link>
                <project id="12310201" key="SYNAPSE">Synapse</project>
                    <description>&lt;p&gt;The failure occurs in the following scenario:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;The incoming message is not a SwA message.&lt;/li&gt;
	&lt;li&gt;A mediator adds an attachment using one of the org.apache.axis2.context.MessageContext#addAttachment methods.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This causes MessageContext to create a new Attachments object using the default constructor. When the message is sent out later, MessageHelper.clonePartially fails on the following instruction:&lt;/p&gt;

&lt;p&gt;String soapPart = attachments.getSOAPPartContentID();&lt;/p&gt;

&lt;p&gt;A NullPointerException is triggered inside the Attachments#getSOAPPartContentID method because it tries to use the contentType attribute which is null in this case (Attachments object created using the default constructor).&lt;/p&gt;

&lt;p&gt;The problem can be solved easily by catching the NPE in clonePartially. Using this workaround I was able to successfully send out the message with the attachment, but intercepting NullPointerException is not a very clean solution.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12395818">SYNAPSE-309</key>
            <summary>Adding an attachment causes failure in MessageHelper.clonePartially</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="veithen">Andreas Veithen-Knowles</assignee>
                                    <reporter username="veithen">Andreas Veithen-Knowles</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 May 2008 09:25:38 +0000</created>
                <updated>Wed, 18 Jun 2008 11:31:57 +0000</updated>
                            <resolved>Wed, 18 Jun 2008 11:31:57 +0000</resolved>
                                                    <fixVersion>2.0</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12600438" author="kalani" created="Wed, 28 May 2008 11:12:59 +0000"  >&lt;p&gt;I had a look into this issue and seems like this occurs due to an issue in Axiom code. &lt;/p&gt;

&lt;p&gt;The default constructor of the &quot;org.apache.axiom.attachments.Attachments&quot; class allows to create an Attachment instance without setting a default value to the &quot;contentType&quot; attribute. Inside the method getSOAPPartContentID(), the getParameter() method is called on contentType attribue without performing a null check.&lt;/p&gt;

&lt;p&gt;We can easily get this fixed by adding a null check to the getSOAPPartContentID() method or by setting a default contentType inside the default constructor.&lt;/p&gt;

&lt;p&gt;So we will have to file this against AXIOM, I guess. What do you think?&lt;/p&gt;</comment>
                            <comment id="12600949" author="veithen" created="Thu, 29 May 2008 22:43:16 +0000"  >&lt;p&gt;Setting a default contentType inside the default constructor is not a solution because in this case getSOAPPartContentID falls back to the ID of the first MIME part, which would be incorrect. The basic question is actually to find a clean way to distinguish the SOAP part from non SOAP parts that works for any Attachments instance (no matter whether it has been created from an incoming message or programmatically using the default constructor). I&apos;ve posted a message on the WS commons mailing list about that.&lt;/p&gt;</comment>
                            <comment id="12601371" author="veithen" created="Sat, 31 May 2008 10:13:27 +0000"  >&lt;p&gt;Shortly after my post, a null check on contentType has been added to the getSOAPPartContentID method:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/viewvc/webservices/commons/trunk/modules/axiom/modules/axiom-api/src/main/java/org/apache/axiom/attachments/Attachments.java?r1=651600&amp;amp;r2=661562&amp;amp;diff_format=h&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/webservices/commons/trunk/modules/axiom/modules/axiom-api/src/main/java/org/apache/axiom/attachments/Attachments.java?r1=651600&amp;amp;r2=661562&amp;amp;diff_format=h&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;According to the commit comment this was done to solve issue &lt;a href=&quot;https://issues.apache.org/jira/browse/AXIS2-3805&quot; title=&quot;Provider&amp;lt;DataSource&amp;gt; does not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AXIS2-3805&quot;&gt;&lt;del&gt;AXIS2-3805&lt;/del&gt;&lt;/a&gt;, but it should also solve our issue.&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>183538</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 26 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i11ilb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>216978</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>