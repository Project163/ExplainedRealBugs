<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 20:07:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SYNAPSE-168] java.lang.IllegalStateException: I/O reactor has been shut down</title>
                <link>https://issues.apache.org/jira/browse/SYNAPSE-168</link>
                <project id="12310201" key="SYNAPSE">Synapse</project>
                    <description>&lt;p&gt;Synapse configuration:&lt;/p&gt;

&lt;p&gt;&amp;lt;definitions xmlns=&quot;http://ws.apache.org/ns/synapse&quot;&amp;gt;                                                                                   &lt;/p&gt;

&lt;p&gt;    &amp;lt;in&amp;gt;                                                                                                                                &lt;br/&gt;
        &amp;lt;log level=&quot;full&quot;/&amp;gt;                                                                                                             &lt;/p&gt;

&lt;p&gt;        &amp;lt;send&amp;gt;                                                                                                                          &lt;br/&gt;
        &amp;lt;endpoint&amp;gt;                                                                                                                      &lt;br/&gt;
            &amp;lt;wsdl uri=&quot;http://hostname:2006/echo/echo.wsdl&quot; service=&quot;EchoService&quot; port=&quot;EchoPort&quot;&amp;gt;                                          &lt;/p&gt;

&lt;p&gt;                &amp;lt;suspendDurationOnFailure&amp;gt;5&amp;lt;/suspendDurationOnFailure&amp;gt;                                                                  &lt;br/&gt;
                &amp;lt;timeout&amp;gt;                                                                                                               &lt;br/&gt;
                        &amp;lt;duration&amp;gt;3&amp;lt;/duration&amp;gt;                                                                                          &lt;br/&gt;
                        &amp;lt;action&amp;gt;fault&amp;lt;/action&amp;gt;                                                                                          &lt;br/&gt;
                &amp;lt;/timeout&amp;gt;                                                                                                              &lt;/p&gt;

&lt;p&gt;            &amp;lt;/wsdl&amp;gt;                                                                                                                     &lt;br/&gt;
        &amp;lt;/endpoint&amp;gt;                                                                                                                     &lt;br/&gt;
        &amp;lt;/send&amp;gt;                                                                                                                         &lt;/p&gt;

&lt;p&gt;    &amp;lt;/in&amp;gt;                                                                                                                               &lt;br/&gt;
    &amp;lt;out&amp;gt;                                                                                                                               &lt;br/&gt;
        &amp;lt;send/&amp;gt;                                                                                                                         &lt;br/&gt;
    &amp;lt;/out&amp;gt;                                                                                                                              &lt;br/&gt;
&amp;lt;/definitions&amp;gt;&lt;/p&gt;

&lt;p&gt;When simple &apos;echo&apos; endpoint is deployed and working - everything is OK.&lt;br/&gt;
But when I undeploy it and ask Synapse, I&apos;ve got series of exception:&lt;/p&gt;

&lt;p&gt;First query:&lt;br/&gt;
2007-11-05 10:06:18,460 [ CUT ] &lt;span class=&quot;error&quot;&gt;&amp;#91;HttpServerWorker-5&amp;#93;&lt;/span&gt;  INFO LogMediator To: /soap, WSAction: , SOAPAction: , Direction: request, Envelope: &amp;lt;?xml version=&apos;1.0&apos; encoding=&apos;utf-8&apos;?&amp;gt;&amp;lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:echo=&quot;http://www.springframework.org/spring-ws/samples/echo&quot;&amp;gt;&amp;lt;soapenv:Body&amp;gt;&lt;br/&gt;
      &amp;lt;echo:echoRequest&amp;gt;test123&amp;lt;/echo:echoRequest&amp;gt;&lt;br/&gt;
   &amp;lt;/soapenv:Body&amp;gt;&amp;lt;/soapenv:Envelope&amp;gt;&lt;br/&gt;
Exception in thread &quot;HttpCoreNIOSender&quot; java.lang.NullPointerException&lt;br/&gt;
        at org.apache.synapse.transport.nhttp.ClientHandler.inputReady(ClientHandler.java:225)&lt;br/&gt;
        at org.apache.synapse.transport.nhttp.LoggingNHttpClientHandler.inputReady(LoggingNHttpClientHandler.java:113)&lt;br/&gt;
        at org.apache.http.impl.nio.DefaultNHttpClientConnection.consumeInput(DefaultNHttpClientConnection.java:135)&lt;br/&gt;
        at org.apache.synapse.transport.nhttp.PlainClientIOEventDispatch.inputReady(PlainClientIOEventDispatch.java:71)&lt;br/&gt;
        at org.apache.http.impl.nio.reactor.BaseIOReactor.readable(BaseIOReactor.java:94)&lt;br/&gt;
        at org.apache.http.impl.nio.reactor.AbstractIOReactor.processEvent(AbstractIOReactor.java:189)&lt;br/&gt;
        at org.apache.http.impl.nio.reactor.AbstractIOReactor.processEvents(AbstractIOReactor.java:174)&lt;br/&gt;
        at org.apache.http.impl.nio.reactor.AbstractIOReactor.execute(AbstractIOReactor.java:137)&lt;br/&gt;
        at org.apache.http.impl.nio.reactor.BaseIOReactor.execute(BaseIOReactor.java:69)&lt;br/&gt;
        at org.apache.http.impl.nio.reactor.AbstractMultiworkerIOReactor$Worker.run(AbstractMultiworkerIOReactor.java:281)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:613)&lt;/p&gt;


&lt;p&gt;Second query:&lt;br/&gt;
2007-11-05 10:20:25,461 [  CUT  ] &lt;span class=&quot;error&quot;&gt;&amp;#91;HttpServerWorker-14&amp;#93;&lt;/span&gt; ERROR Axis2Sender Unexpected error during sending message out&lt;br/&gt;
java.lang.IllegalStateException: I/O reactor has been shut down&lt;br/&gt;
        at org.apache.http.impl.nio.reactor.DefaultConnectingIOReactor.connect(DefaultConnectingIOReactor.java:164)&lt;br/&gt;
        at org.apache.synapse.transport.nhttp.HttpCoreNIOSender.sendAsyncRequest(HttpCoreNIOSender.java:285)&lt;br/&gt;
        at org.apache.synapse.transport.nhttp.HttpCoreNIOSender.invoke(HttpCoreNIOSender.java:208)&lt;br/&gt;
        at org.apache.axis2.engine.AxisEngine.send(AxisEngine.java:396)&lt;br/&gt;
        at org.apache.synapse.core.axis2.DynamicAxisOperation$DynamicOperationClient.send(DynamicAxisOperation.java:192)&lt;br/&gt;
        at org.apache.synapse.core.axis2.DynamicAxisOperation$DynamicOperationClient.executeImpl(DynamicAxisOperation.java:176)&lt;br/&gt;
        at org.apache.axis2.client.OperationClient.execute(OperationClient.java:163)&lt;br/&gt;
        at org.apache.synapse.core.axis2.Axis2FlexibleMEPClient.send(Axis2FlexibleMEPClient.java:250)&lt;br/&gt;
        at org.apache.synapse.core.axis2.Axis2Sender.sendOn(Axis2Sender.java:55)&lt;br/&gt;
        at org.apache.synapse.core.axis2.Axis2SynapseEnvironment.send(Axis2SynapseEnvironment.java:200)&lt;br/&gt;
        at org.apache.synapse.endpoints.WSDLEndpoint.send(WSDLEndpoint.java:140)&lt;br/&gt;
        at org.apache.synapse.mediators.builtin.SendMediator.mediate(SendMediator.java:100)&lt;br/&gt;
        at org.apache.synapse.mediators.AbstractListMediator.mediate(AbstractListMediator.java:60)&lt;br/&gt;
        at org.apache.synapse.mediators.filters.InMediator.mediate(InMediator.java:60)&lt;br/&gt;
        at org.apache.synapse.mediators.AbstractListMediator.mediate(AbstractListMediator.java:60)&lt;br/&gt;
        at org.apache.synapse.mediators.base.SequenceMediator.mediate(SequenceMediator.java:122)&lt;br/&gt;
        at org.apache.synapse.core.axis2.Axis2SynapseEnvironment.injectMessage(Axis2SynapseEnvironment.java:154)&lt;br/&gt;
        at org.apache.synapse.core.axis2.SynapseMessageReceiver.receive(SynapseMessageReceiver.java:89)&lt;br/&gt;
        at org.apache.axis2.engine.AxisEngine.receive(AxisEngine.java:145)&lt;br/&gt;
        at org.apache.axis2.transport.http.HTTPTransportUtils.processHTTPPostRequest(HTTPTransportUtils.java:275)&lt;br/&gt;
        at org.apache.synapse.transport.nhttp.ServerWorker.processPost(ServerWorker.java:218)&lt;br/&gt;
        at org.apache.synapse.transport.nhttp.ServerWorker.run(ServerWorker.java:182)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:650)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:675)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:613)&lt;/p&gt;

&lt;p&gt;End every next query ends with this exception.&lt;br/&gt;
Even if I redeploy echo endpoint, Synapse does not process my requests and responses with 0 bytes:&lt;/p&gt;

&lt;p&gt;Mon Nov 05 10:13:59 CET 2007:INFO:Got response for &lt;span class=&quot;error&quot;&gt;&amp;#91;EchoBinding.echo:Request 1&amp;#93;&lt;/span&gt; in 18ms (0 bytes)&lt;/p&gt;

&lt;p&gt;And after a few seconds in logs I have:&lt;/p&gt;

&lt;p&gt;2007-11-05 10:19:06,408 [ CUT ] &lt;span class=&quot;error&quot;&gt;&amp;#91;Timer-0&amp;#93;&lt;/span&gt;  INFO LogMediator To: /soap, WSAction: , SOAPAction: , Direction: request, Envelope: &amp;lt;?xml version=&apos;1.0&apos; encoding=&apos;utf-8&apos;?&amp;gt;&amp;lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:echo=&quot;http://www.springframework.org/spring-ws/samples/echo&quot;&amp;gt;&amp;lt;soapenv:Body&amp;gt;&lt;br/&gt;
      &amp;lt;echo:echoRequest&amp;gt;dupa123&amp;lt;/echo:echoRequest&amp;gt;&lt;br/&gt;
   &amp;lt;/soapenv:Body&amp;gt;&amp;lt;/soapenv:Envelope&amp;gt;&lt;/p&gt;

&lt;p&gt;After restarting Synapse everything backs to normal - so it isn&apos;t endpoint&apos;s issue.&lt;/p&gt;</description>
                <environment>java 1.5.0_07, Mac OS X 10.4.10, endpoint made with Spring-WS deployed on JBoss 4.2.1</environment>
        <key id="12381831">SYNAPSE-168</key>
            <summary>java.lang.IllegalStateException: I/O reactor has been shut down</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="asankha">Asankha Chamath Perera</assignee>
                                    <reporter username="macieq">Maciej Majewski</reporter>
                        <labels>
                    </labels>
                <created>Mon, 5 Nov 2007 09:25:07 +0000</created>
                <updated>Thu, 3 Jan 2008 10:52:20 +0000</updated>
                            <resolved>Thu, 3 Jan 2008 10:52:20 +0000</resolved>
                                    <version>1.1-RC1</version>
                                    <fixVersion>1.1.1-QA-B2</fixVersion>
                                    <component>Transports</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12541018" author="asankha" created="Thu, 8 Nov 2007 10:47:43 +0000"  >&lt;p&gt;Can you reproduce this in a Linux environment? I am not very familiar with MacOS or have access to a system with it. Looking at the code where the NPE occurred it seems like it could be host OS specific. Also let me know the client HTTP version and if chunking and keepalives are used. If you are sending thousands of requests, you may also want to tune your OS to help Synapse reach its peak levels.&lt;/p&gt;</comment>
                            <comment id="12541062" author="asankha" created="Thu, 8 Nov 2007 15:24:12 +0000"  >&lt;p&gt;This could not be reproduced and I consider this as not a defect - however, more information may prove useful to determine actual cause and solution&lt;/p&gt;

&lt;p&gt;the endpoint definition:&lt;br/&gt;
&amp;lt;wsdl uri=&quot;http://hostname:2006/echo/echo.wsdl&quot; service=&quot;EchoService&quot; port=&quot;EchoPort&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;                &amp;lt;suspendDurationOnFailure&amp;gt;5&amp;lt;/suspendDurationOnFailure&amp;gt;&lt;br/&gt;
                &amp;lt;timeout&amp;gt;&lt;br/&gt;
                        &amp;lt;duration&amp;gt;3&amp;lt;/duration&amp;gt;&lt;br/&gt;
                        &amp;lt;action&amp;gt;fault&amp;lt;/action&amp;gt;&lt;br/&gt;
                &amp;lt;/timeout&amp;gt;&lt;/p&gt;

&lt;p&gt;            &amp;lt;/wsdl&amp;gt;&lt;/p&gt;

&lt;p&gt;will not send back an error when the EPR is down, as what is specified is to throw a &quot;fault&quot; if the response &lt;b&gt;arrives&lt;/b&gt; later than 3 seconds after the request was sent. If the EPR was found to be offline, it will be considered an error to send to this endpoint during the next 5 seconds after this was found out.&lt;/p&gt;

&lt;p&gt;When Synapse encounters an error as above (e.g. Connection refused, late reply in the above scenario etc) it will execute the onError error handler sequence for the sequence that generates the error. If none can be found the default &quot;fault&quot; sequence would execute (unless defined, this defaults to a simple log of the current message)&lt;/p&gt;</comment>
                            <comment id="12541101" author="macieq" created="Thu, 8 Nov 2007 18:40:53 +0000"  >&lt;p&gt;Everything works fine, when you test on SimpleStockQuoteService and just shutdown it. This is situation when endpoint do not answer (service is down, connection refused). &lt;/p&gt;

&lt;p&gt;But... &lt;/p&gt;

&lt;p&gt;There is a problem when we &lt;em&gt;undeploy&lt;/em&gt; app and application server returns something, e.g. malformed HTML page.&lt;/p&gt;

&lt;p&gt;Please try it with Echo endpoint (will attach .war).&lt;/p&gt;

&lt;p&gt;&amp;#8212;&lt;/p&gt;

&lt;p&gt;Sorry but cannot attach it, will try again later from home.&lt;/p&gt;</comment>
                            <comment id="12541222" author="asankha" created="Fri, 9 Nov 2007 04:20:18 +0000"  >&lt;p&gt;Seems like a JBoss issue.. if the service is not available what does it return? is it a HTTP 404? or 500? with a HTML message too? Please capture the response from JBoss when the service is undeployed (using TCPMon etc) and attach it for review. I will either need this, or the exact JBoss version and your WAR file to reproduce the scenario&lt;/p&gt;

&lt;p&gt;You may try to Zip the war file and then attach to this JIRA if you have problems&lt;/p&gt;</comment>
                            <comment id="12541348" author="macieq" created="Fri, 9 Nov 2007 15:26:44 +0000"  >&lt;p&gt;Attaching query, normal response and 404 error.&lt;br/&gt;
This 404 response causes exceptions.&lt;/p&gt;</comment>
                            <comment id="12541349" author="macieq" created="Fri, 9 Nov 2007 15:27:55 +0000"  >&lt;p&gt;And response when JBoss got OutOfMemory / PermGen&lt;/p&gt;

&lt;p&gt;16:25:02,197 ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;STDERR&amp;#93;&lt;/span&gt; java.lang.OutOfMemoryError: PermGen space&lt;/p&gt;

&lt;p&gt;This also causes exceptions in Synapse.&lt;/p&gt;</comment>
                            <comment id="12541354" author="asankha" created="Fri, 9 Nov 2007 15:44:04 +0000"  >&lt;p&gt;The problem is that JBoss returns an error message in HTML targeted for a browser, when a Web service encounters a fault or is unavailable. The typical response expected by Synapse in such a scenario is a SOAP fault. We may be able to address this issue as an enhancement over our typical behavior - but this would take some investigation.&lt;/p&gt;

&lt;p&gt;I do not understand what you mean by JBoss running out of memory? As I understand Synapse runs on a separate host than JBoss? but do you mean that if JBoss responds with a HTTP 500 without a body, Synapse encounters an exception? If so the same enhancement I propose could address this issue as well&lt;/p&gt;</comment>
                            <comment id="12541355" author="macieq" created="Fri, 9 Nov 2007 15:47:24 +0000"  >&lt;p&gt;Echo from Spring-WS examples&lt;/p&gt;</comment>
                            <comment id="12551702" author="ruwan" created="Fri, 14 Dec 2007 05:55:25 +0000"  >&lt;p&gt;changed the fix version&lt;/p&gt;</comment>
                            <comment id="12555533" author="asankha" created="Thu, 3 Jan 2008 10:52:20 +0000"  >&lt;p&gt;Fixed this and &lt;a href=&quot;https://issues.apache.org/jira/browse/SYNAPSE-188&quot; title=&quot;If backend https service is down, frontend service https gets low level problem that destabilizes non-blocking transport&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SYNAPSE-188&quot;&gt;&lt;del&gt;SYNAPSE-188&lt;/del&gt;&lt;/a&gt; which is almost the same&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12369239" name="echo.zip" size="7060302" author="macieq" created="Fri, 9 Nov 2007 15:47:24 +0000"/>
                            <attachment id="12369237" name="error_response.txt" size="1482" author="macieq" created="Fri, 9 Nov 2007 15:26:44 +0000"/>
                            <attachment id="12369236" name="normal_response.txt" size="579" author="macieq" created="Fri, 9 Nov 2007 15:26:44 +0000"/>
                            <attachment id="12369235" name="query.txt" size="531" author="macieq" created="Fri, 9 Nov 2007 15:26:44 +0000"/>
                            <attachment id="12369238" name="response_after_permgen.txt" size="140" author="macieq" created="Fri, 9 Nov 2007 15:27:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>183400</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 47 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i116gv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>215014</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>