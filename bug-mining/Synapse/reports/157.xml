<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 20:07:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SYNAPSE-446] Multipart/mixed mail message not forwarded to proxy</title>
                <link>https://issues.apache.org/jira/browse/SYNAPSE-446</link>
                <project id="12310201" key="SYNAPSE">Synapse</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://wso2.org/jira/browse/ESBJAVA-566&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://wso2.org/jira/browse/ESBJAVA-566&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12404222">SYNAPSE-446</key>
            <summary>Multipart/mixed mail message not forwarded to proxy</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stlecho">Stefan Lecho</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Sep 2008 07:05:34 +0000</created>
                <updated>Sun, 28 Sep 2008 14:42:22 +0000</updated>
                            <resolved>Sun, 28 Sep 2008 14:42:22 +0000</resolved>
                                                                    <component>Transports</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12630705" author="veithen" created="Fri, 12 Sep 2008 23:03:03 +0000"  >&lt;p&gt;Can you try to dump the transports headers just before the message is sent out?&lt;/p&gt;</comment>
                            <comment id="12630741" author="stlecho" created="Sat, 13 Sep 2008 08:25:46 +0000"  >&lt;p&gt;Tracing for the &lt;b&gt;javax.mail&lt;/b&gt; and &lt;b&gt;org.apache.synapse.transport&lt;/b&gt; has been&lt;br/&gt;
activated. Is this sufficient to dump the transport headers ?&lt;/p&gt;

</comment>
                            <comment id="12630840" author="veithen" created="Sun, 14 Sep 2008 00:19:20 +0000"  >&lt;p&gt;I added more logging to MailTransportSender. Can you test using the latest source code from trunk and post the logs?&lt;/p&gt;</comment>
                            <comment id="12631055" author="stlecho" created="Mon, 15 Sep 2008 15:53:44 +0000"  >&lt;p&gt;Attached you&apos;ll find an extract from the log file after using the Synapse&lt;br/&gt;
snapshot build.&lt;/p&gt;

&lt;p&gt;It seems that now the same problem occurs when sending a text-based message,&lt;br/&gt;
whereas with the 1.2 releases the problem only occured when sending&lt;br/&gt;
XML-based messages. Could this be a regression ?&lt;/p&gt;

</comment>
                            <comment id="12631080" author="veithen" created="Mon, 15 Sep 2008 17:42:01 +0000"  >&lt;p&gt;I think the problem is totally unrelated to the content type of the message. The real explanation can be seen from the following lines in the logs:&lt;/p&gt;

&lt;p&gt;MailTransportSender Setting From header to credoc.out@posthouse.com from OutTransportInfo&lt;br/&gt;
MailTransportSender Setting To header to credoc.in@posthouse.com from transport headers&lt;br/&gt;
MailTransportSender Setting Subject header to &apos;WSO2ESB - The subject of the mail - without an attachment !&apos; from transport headers&lt;/p&gt;

&lt;p&gt;To determine the recipient of the message, MailTransportSender gives precedence to the transport headers and only if there are no transport headers it will check the OutTransportInfo (which contains the address you specify as target of the proxy service). Why does the message context contain transport headers? Because the message initially came in as a mail (BTW, that&apos;s why you see a difference between mail and HTTP). Instead of sending the message to bank.in@posthouse.com, the transport sends the message to the original recipient, i.e. credoc.in@posthouse.com.&lt;/p&gt;

&lt;p&gt;Why does the sender give precedence to the transport headers to determine the recipient? I don&apos;t know. Note that for the From and CC addresses, it&apos;s the other way round: the sender firsts looks at OutTransportInfo. Maybe somebody else knows why this was implemented in this way?&lt;/p&gt;

&lt;p&gt;As a workaround you can try to clear the transport headers before sending the message out.&lt;/p&gt;</comment>
                            <comment id="12631333" author="stlecho" created="Tue, 16 Sep 2008 10:49:46 +0000"  >&lt;p&gt;Based on the 255 and 256 samples, I&apos;ve defined the following&lt;br/&gt;
properties: &quot;*&amp;lt;syn:property&lt;br/&gt;
name=&quot;Subject&quot; value=&quot;Custom Subject for Response&quot;&lt;br/&gt;
scope=&quot;transport&quot;/&amp;gt;&amp;lt;syn:header name=&quot;To&quot; value=&quot;&lt;br/&gt;
&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;mailto:bank.in@posthouse.com&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;bank.in@posthouse.com&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/mail_small.gif&quot; height=&quot;12&quot; width=&quot;13&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&quot;/ &amp;lt;bank.in@posthouse.com%22/&amp;gt;&amp;gt;*&quot;. Theses&lt;br/&gt;
settings change however nothing to the result.&lt;/p&gt;

&lt;p&gt;MailTransportSender keeps on using *credoc.in@posthouse.com *instead of *&lt;br/&gt;
bank*&lt;b&gt;.in@posthouse.com &amp;lt;credoc.in@posthouse.com&amp;gt;&lt;/b&gt; as &lt;b&gt;To Header&lt;/b&gt; and I have&lt;br/&gt;
the impression that the address specified in the endpoint is not used at all.&lt;br/&gt;
Could this be clarified ?&lt;br/&gt;
*&lt;br/&gt;
Log*&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;2008-09-16 12:05:57,805 &lt;span class=&quot;error&quot;&gt;&amp;#91;192.168.13.175-INFOR2&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Axis2 Task&amp;#93;&lt;/span&gt; DEBUG&lt;br/&gt;
MailTransportSender Setting From header to credoc.out@posthouse.com from&lt;br/&gt;
OutTransportInfo&lt;br/&gt;
 2008-09-16 12:05:57,805 &lt;span class=&quot;error&quot;&gt;&amp;#91;192.168.13.175-INFOR2&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Axis2 Task&amp;#93;&lt;/span&gt; DEBUG&lt;br/&gt;
MailTransportSender Setting To header to credoc.in@posthouse.com from&lt;br/&gt;
transport headers&lt;br/&gt;
 2008-09-16 12:05:57,805 &lt;span class=&quot;error&quot;&gt;&amp;#91;192.168.13.175-INFOR2&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Axis2 Task&amp;#93;&lt;/span&gt; DEBUG&lt;br/&gt;
MailTransportSender Setting Subject header to &apos;WSO2ESB - The subject of the&lt;br/&gt;
mail - without an attachment !&apos; from transport headers*&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;b&gt;Synapse.xml&lt;/b&gt;*&amp;lt;syn:target endpoint=&quot;MailTo-Endpoint&quot;&amp;gt;&lt;br/&gt;
 &amp;lt;syn:inSequence&amp;gt;&lt;br/&gt;
  &amp;lt;syn:log level=&quot;full&quot; separator=&quot;,&quot;/&amp;gt;&lt;br/&gt;
  &amp;lt;syn:property name=&quot;senderAddress&quot; expression=&quot;get-property(&apos;transport&apos;,&lt;br/&gt;
&apos;From&apos;)&quot;/&amp;gt;&lt;br/&gt;
  &amp;lt;syn:log level=&quot;full&quot;&amp;gt;&lt;br/&gt;
   &amp;lt;syn:property name=&quot;Sender Address&quot;&lt;br/&gt;
expression=&quot;get-property(&apos;senderAddress&apos;)&quot;/&amp;gt;&lt;br/&gt;
  &amp;lt;/syn:log&amp;gt;&lt;br/&gt;
  &amp;lt;spring:spring bean=&quot;MailMediatorBean&quot; key=&quot;MailMediatorApplicContext&quot;/&amp;gt;&lt;br/&gt;
 &amp;lt;/syn:inSequence&amp;gt;&lt;br/&gt;
 &amp;lt;syn:outSequence&amp;gt;&lt;br/&gt;
  &amp;lt;syn:log level=&quot;full&quot; separator=&quot;,&quot;/&amp;gt;&lt;br/&gt;
  &amp;lt;syn:property name=&quot;Subject&quot; value=&quot;Custom Subject for Response&quot;&lt;br/&gt;
scope=&quot;transport&quot;/&amp;gt;&lt;br/&gt;
  &amp;lt;syn:header name=&quot;To&quot;&lt;br/&gt;
value=&quot;mailto:bank.in@posthouse.com&quot;/&amp;lt;bank.in@posthouse.com%22/&amp;gt;&lt;br/&gt;
  &amp;lt;syn:log level=&quot;full&quot;&amp;gt;&lt;br/&gt;
   &amp;lt;syn:property name=&quot;message&quot; value=&quot;Response message&quot;/&amp;gt;&lt;br/&gt;
   &amp;lt;syn:property name=&quot;Sender Address&quot;&lt;br/&gt;
expression=&quot;get-property(&apos;senderAddress&apos;)&quot;/&amp;gt;&lt;br/&gt;
  &amp;lt;/syn:log&amp;gt;&lt;br/&gt;
  &amp;lt;syn:send/&amp;gt;&lt;br/&gt;
 &amp;lt;/syn:outSequence&amp;gt;&lt;br/&gt;
&amp;lt;/syn:target&amp;gt;&lt;/p&gt;

&lt;p&gt;*&lt;b&gt;Endpoint&lt;/b&gt;*&lt;br/&gt;
*&lt;br/&gt;
*&amp;lt;syn:endpoint name=&quot;MailTo-Endpoint&quot;&amp;gt;&lt;br/&gt;
&amp;lt;syn:address uri=&quot;mailto:bank.in@posthouse.com&quot; statistics=&quot;enable&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/syn:endpoint&amp;gt;*&lt;/p&gt;

&lt;p&gt;On Mon, Sep 15, 2008 at 7:43 PM, Andreas Veithen (JIRA) &amp;lt;jira@apache.org&amp;gt;wrote:&lt;/p&gt;
</comment>
                            <comment id="12631540" author="veithen" created="Tue, 16 Sep 2008 20:41:27 +0000"  >&lt;p&gt;Can you try with the following mediator?&lt;/p&gt;

&lt;p&gt;&amp;lt;syn:property name=&quot;To&quot; action=&quot;remove&quot; scope=&quot;transport&quot;/&amp;gt;&lt;/p&gt;</comment>
                            <comment id="12631747" author="asankha" created="Wed, 17 Sep 2008 11:57:20 +0000"  >&lt;p&gt;Andreas / Stefan&lt;/p&gt;

&lt;p&gt;Sorry about the delay in my reply.. &lt;/p&gt;

&lt;p&gt;&amp;gt;Why does the sender give precedence to the transport headers to determine the recipient? I don&apos;t know. Note that for the From and CC addresses, it&apos;s the other way round: the sender firsts looks at OutTransportInfo. Maybe somebody else knows why this was implemented in this way?&lt;/p&gt;

&lt;p&gt;This is because all transport senders gives higher priority to &apos;transport&apos; headers/properties than the others. So a WS-A SOAP message may have its &apos;To&apos; address to &lt;a href=&quot;http://someendpoint&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://someendpoint&lt;/a&gt; while it maybe sent over the mail transport to &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;mailto:someone@somewhere.com&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;someone@somewhere.com&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/mail_small.gif&quot; height=&quot;12&quot; width=&quot;13&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&amp;gt; &amp;lt;syn:header name=&quot;To&quot; value=&quot;mailto:bank.in@posthouse.com&quot;/ &amp;lt;bank.in@posthouse.com%22/&amp;gt;&amp;gt;*&quot;. Theses&lt;br/&gt;
settings change however nothing to the result.&lt;/p&gt;

&lt;p&gt;Yes, the &quot;header&quot; mediator changes the SOAP header not the transport headers. Use the following instead:&lt;/p&gt;

&lt;p&gt;&amp;lt;syn:property name=&quot;To&quot; value=&quot;addressuwant@somewhere.com&quot; scope=&quot;transport&quot;/&amp;gt;&lt;/p&gt;
</comment>
                            <comment id="12631815" author="stlecho" created="Wed, 17 Sep 2008 15:45:41 +0000"  >&lt;p&gt;Adding &amp;lt;syn:property name=&quot;To&quot; value=&quot;addressuwant@somewhere.com&quot; scope=&quot;transport&quot;/&amp;gt;  or &amp;lt;syn:property name=&quot;To&quot; action=&quot;remove&quot; scope=&quot;transport&quot;/&amp;gt;  works both. I prefer the last solution, because in that case the endpoint defined on the target level is used so there is no duplication of mail addresses. &lt;/p&gt;

&lt;p&gt;PS: I&apos;ve remarked that the properties should be added to the inSequence and not to the outSequence. Is this normal ?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12390117" name="ASF.LICENSE.NOT.GRANTED--log.txt" size="5463" author="stlecho" created="Mon, 15 Sep 2008 15:53:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>183670</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 11 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i11mtj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>217663</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>