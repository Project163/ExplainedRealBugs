<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 20:08:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SYNAPSE-491] Sporadic test failures in NIO HTTP tests</title>
                <link>https://issues.apache.org/jira/browse/SYNAPSE-491</link>
                <project id="12310201" key="SYNAPSE">Synapse</project>
                    <description>&lt;p&gt;From time to time, one or more of the tests in HttpCoreNIOListenerTest fail with the following assertion failure:&lt;/p&gt;

&lt;p&gt;junit.framework.AssertionFailedError: No increase in bytes sent&lt;br/&gt;
    at junit.framework.Assert.fail(Assert.java:47)&lt;br/&gt;
    at junit.framework.Assert.assertTrue(Assert.java:20)&lt;br/&gt;
    at org.apache.axis2.transport.testkit.axis2.client.AxisTestClient.afterReceive(AxisTestClient.java:115)&lt;br/&gt;
    at org.apache.axis2.transport.testkit.tests.MessageTestCase.runTest(MessageTestCase.java:64)&lt;br/&gt;
    ...&lt;/p&gt;

&lt;p&gt;The code containing the assertion looks as follows:&lt;/p&gt;

&lt;p&gt;        if (sender instanceof ManagementSupport) &lt;/p&gt;
{
            ManagementSupport sender = (ManagementSupport)this.sender;
            Assert.assertEquals(messagesSent+1, sender.getMessagesSent());
            Assert.assertTrue(&quot;No increase in bytes sent&quot;, sender.getBytesSent() &amp;gt; bytesSent);
        }

&lt;p&gt;This would mean that under some circumstances the transport sender doesn&apos;t correctly update the metrics for bytes sent (while the number of messages sent is increased as expected).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12411250">SYNAPSE-491</key>
            <summary>Sporadic test failures in NIO HTTP tests</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="veithen">Andreas Veithen-Knowles</assignee>
                                    <reporter username="veithen">Andreas Veithen-Knowles</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 Dec 2008 15:57:25 +0000</created>
                <updated>Sat, 27 Dec 2008 19:06:31 +0000</updated>
                            <resolved>Sat, 27 Dec 2008 19:06:31 +0000</resolved>
                                                                    <component>Transports</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12659322" author="veithen" created="Sat, 27 Dec 2008 10:45:34 +0000"  >&lt;p&gt;Attached log file for a failed test run.&lt;/p&gt;</comment>
                            <comment id="12659360" author="veithen" created="Sat, 27 Dec 2008 18:11:51 +0000"  >&lt;p&gt;The messagesSent metric is updated immediately after the message content has been streamed to the SharedOutputBuffer (see HttpCoreNIOSender#sendAsyncRequest), while the bytesSent metric is updated only after the data has been written to the HTTP connection. This explains why the assertion on messagesSent succeeds while the assertion on bytesSent fails.&lt;/p&gt;

&lt;p&gt;The attached logs indicate that it sometimes happens that the entire request is processed by the test endpoint between the write operation and the metrics update. This is quite surprising since the request has to flow through the TCP monitor set up by HttpChannel and through Jetty&apos;s HTTP dispatcher, while on the client side the metrics are updated immediately after the write operation (see ClientHandler#outputReady). However this explanation is compatible with the observation that the test failure mainly occurs if the system running the test is under load. Also there is no indication that the HttpCoreNIOSender thread blocks between the write operation and the metrics update. The conclusion is therefore that there is no problem with the HTTP transport but that the transport testkit needs to be modified to give the transport sender more time to update the metrics.&lt;/p&gt;</comment>
                            <comment id="12659366" author="veithen" created="Sat, 27 Dec 2008 19:06:31 +0000"  >&lt;p&gt;Should be fixed now with latests versions of the transport testkit.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12396793" name="01-debug.log" size="17355" author="veithen" created="Sat, 27 Dec 2008 10:45:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>183714</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 48 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i11jnz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>217152</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>