<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 20:09:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SYNAPSE-851] VFS proxy generates the response.xml with empty content (Synapse-2.2.0-Snapshot trunk)</title>
                <link>https://issues.apache.org/jira/browse/SYNAPSE-851</link>
                <project id="12310201" key="SYNAPSE">Synapse</project>
                    <description>&lt;p&gt;Used following configuration;&lt;br/&gt;
I see the output(response.xml) at &quot;out&quot; folder is empty..&lt;br/&gt;
&amp;lt;proxy name=&quot;StockQuoteProxy&quot; transports=&quot;vfs&quot; startOnLoad=&quot;true&quot; trace=&quot;disable&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;target faultSequence=&quot;fault&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;inSequence&amp;gt;&lt;br/&gt;
                &amp;lt;property name=&quot;OUT_ONLY&quot; value=&quot;true&quot;/&amp;gt;&lt;br/&gt;
                &amp;lt;send&amp;gt;&lt;br/&gt;
                    &amp;lt;endpoint&amp;gt;&lt;br/&gt;
                        &amp;lt;address uri=&quot;vfs:&lt;a href=&quot;file:C:UsersTOSHIBADesktopout&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:C:\Users\TOSHIBA\Desktop\out&lt;/a&gt;&quot;/&amp;gt;&lt;br/&gt;
                    &amp;lt;/endpoint&amp;gt;&lt;br/&gt;
                &amp;lt;/send&amp;gt;&lt;br/&gt;
            &amp;lt;/inSequence&amp;gt;&lt;br/&gt;
        &amp;lt;/target&amp;gt;&lt;br/&gt;
        &amp;lt;parameter name=&quot;transport.PollInterval&quot;&amp;gt;15&amp;lt;/parameter&amp;gt;&lt;br/&gt;
        &amp;lt;parameter name=&quot;transport.vfs.ActionAfterProcess&quot;&amp;gt;MOVE&amp;lt;/parameter&amp;gt;&lt;br/&gt;
        &amp;lt;!-&lt;del&gt;&amp;lt;parameter name=&quot;transport.vfs.FileURI&quot;&amp;gt;vfs:&lt;a href=&quot;ftp://anonymous@localhost/in?vfs.passive=true&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ftp://anonymous@localhost/in?vfs.passive=true&lt;/a&gt;&amp;lt;/parameter&amp;gt;&lt;/del&gt;-&amp;gt;&lt;br/&gt;
		&amp;lt;parameter name=&quot;transport.vfs.FileURI&quot;&amp;gt;&lt;a href=&quot;file:C:UsersTOSHIBADesktopin&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:C:\Users\TOSHIBA\Desktop\in&lt;/a&gt;&amp;lt;/parameter&amp;gt;&lt;br/&gt;
        &amp;lt;parameter name=&quot;transport.vfs.MoveAfterProcess&quot;&amp;gt;&lt;a href=&quot;file:C:UsersTOSHIBADesktoporiginal&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:C:\Users\TOSHIBA\Desktop\original&lt;/a&gt;&amp;lt;/parameter&amp;gt;&lt;br/&gt;
        &amp;lt;parameter name=&quot;transport.vfs.MoveAfterFailure&quot;&amp;gt;&lt;a href=&quot;file:C:UsersTOSHIBADesktoperror&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:C:\Users\TOSHIBA\Desktop\error&lt;/a&gt;&amp;lt;/parameter&amp;gt;&lt;br/&gt;
        &amp;lt;parameter name=&quot;transport.vfs.FileNamePattern&quot;&amp;gt;.*&amp;lt;/parameter&amp;gt;&lt;br/&gt;
        &amp;lt;parameter name=&quot;transport.vfs.ContentType&quot;&amp;gt;text/plain&amp;lt;/parameter&amp;gt;&lt;br/&gt;
        &amp;lt;parameter name=&quot;transport.vfs.ActionAfterFailure&quot;&amp;gt;MOVE&amp;lt;/parameter&amp;gt;&lt;br/&gt;
        &amp;lt;parameter name=&quot;serviceType&quot;&amp;gt;proxy&amp;lt;/parameter&amp;gt;&lt;br/&gt;
    &amp;lt;/proxy&amp;gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12546079">SYNAPSE-851</key>
            <summary>VFS proxy generates the response.xml with empty content (Synapse-2.2.0-Snapshot trunk)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="isudana">Isuru Udana</assignee>
                                    <reporter username="ratha">Vijayaratha Vijayasingam</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Mar 2012 10:50:25 +0000</created>
                <updated>Sat, 1 Oct 2016 06:17:30 +0000</updated>
                            <resolved>Sat, 1 Oct 2016 04:20:12 +0000</resolved>
                                    <version>NIGHTLY</version>
                                    <fixVersion>3.0.0</fixVersion>
                                    <component>Transports</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13228436" author="ratha" created="Tue, 13 Mar 2012 15:27:31 +0000"  >&lt;p&gt;This is not working in the latest Synapse 2.1 release too..&lt;/p&gt;</comment>
                            <comment id="13243048" author="dushan@wso2.com" created="Sat, 31 Mar 2012 06:16:49 +0000"  >&lt;p&gt;Hi&lt;br/&gt;
 I just check this with synapse-2.2.0-SNAPSHOT and its working fine for me and can see the response content with expected results this is my configuration&lt;/p&gt;

&lt;p&gt; &amp;lt;proxy name=&quot;StockQuoteProxy&quot; transports=&quot;https http vfs&quot; startOnLoad=&quot;true&quot; trace=&quot;disable&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;target&amp;gt;&lt;br/&gt;
            &amp;lt;endpoint&amp;gt;&lt;br/&gt;
                &amp;lt;address uri=&quot;http://localhost:9000/services/SimpleStockQuoteService&quot; format=&quot;soap12&quot;/&amp;gt;&lt;br/&gt;
            &amp;lt;/endpoint&amp;gt;&lt;br/&gt;
            &amp;lt;outSequence&amp;gt;&lt;br/&gt;
                &amp;lt;property name=&quot;transport.vfs.ReplyFileName&quot; expression=&quot;fn:concat(fn:substring-after(get-property(&apos;MessageID&apos;), &apos;urn:uuid:&apos;), &apos;.xml&apos;)&quot; scope=&quot;transport&quot;/&amp;gt;&lt;br/&gt;
                &amp;lt;property name=&quot;OUT_ONLY&quot; value=&quot;true&quot;/&amp;gt;&lt;br/&gt;
                &amp;lt;send&amp;gt;&lt;br/&gt;
                    &amp;lt;endpoint&amp;gt;&lt;br/&gt;
                        &amp;lt;address uri=&quot;vfs:&lt;a href=&quot;file:///home/dushan/poc/esbvfs/out&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:///home/dushan/poc/esbvfs/out&lt;/a&gt;&quot;/&amp;gt;&lt;br/&gt;
                    &amp;lt;/endpoint&amp;gt;&lt;br/&gt;
                &amp;lt;/send&amp;gt;&lt;br/&gt;
            &amp;lt;/outSequence&amp;gt;&lt;br/&gt;
        &amp;lt;/target&amp;gt;&lt;br/&gt;
        &amp;lt;publishWSDL uri=&quot;file:repository/samples/resources/proxy/sample_proxy_1.wsdl&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;parameter name=&quot;transport.PollInterval&quot;&amp;gt;15&amp;lt;/parameter&amp;gt;&lt;br/&gt;
        &amp;lt;parameter name=&quot;transport.vfs.ActionAfterProcess&quot;&amp;gt;MOVE&amp;lt;/parameter&amp;gt;&lt;br/&gt;
        &amp;lt;parameter name=&quot;transport.vfs.FileURI&quot;&amp;gt;&lt;a href=&quot;file:///home/dushan/poc/esbvfs/in&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:///home/dushan/poc/esbvfs/in&lt;/a&gt;&amp;lt;/parameter&amp;gt;&lt;br/&gt;
        &amp;lt;parameter name=&quot;transport.vfs.MoveAfterProcess&quot;&amp;gt;&lt;a href=&quot;file:///home/dushan/poc/esbvfs/done&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:///home/dushan/poc/esbvfs/done&lt;/a&gt;&amp;lt;/parameter&amp;gt;&lt;br/&gt;
        &amp;lt;parameter name=&quot;transport.vfs.MoveAfterFailure&quot;&amp;gt;&lt;a href=&quot;file:///home/dushan/poc/esbvfs/done&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:///home/dushan/poc/esbvfs/done&lt;/a&gt;&amp;lt;/parameter&amp;gt;&lt;br/&gt;
        &amp;lt;parameter name=&quot;transport.vfs.FileNamePattern&quot;&amp;gt;.*.xml&amp;lt;/parameter&amp;gt;&lt;br/&gt;
        &amp;lt;parameter name=&quot;transport.vfs.ContentType&quot;&amp;gt;text/xml&amp;lt;/parameter&amp;gt;&lt;br/&gt;
        &amp;lt;parameter name=&quot;transport.vfs.ActionAfterFailure&quot;&amp;gt;MOVE&amp;lt;/parameter&amp;gt;&lt;br/&gt;
    &amp;lt;/proxy&amp;gt;&lt;/p&gt;


</comment>
                            <comment id="13712628" author="hiranya" created="Thu, 18 Jul 2013 18:36:00 +0000"  >&lt;p&gt;Hi Dushan,&lt;/p&gt;

&lt;p&gt;Looks like Ratha is trying this scenario with plain text files. The content type parameter has been set to text/plain. The scenario works fine with XML input files.&lt;/p&gt;

&lt;p&gt;In the latest trunk, this is the response.xml I get for a plain text input:&lt;/p&gt;

&lt;p&gt;&amp;lt;?xml version=&apos;1.0&apos; encoding=&apos;UTF-8&apos;?&amp;gt;&amp;lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&amp;gt;&amp;lt;soapenv:Body&amp;gt;&amp;lt;text xmlns=&quot;http://ws.apache.org/commons/ns/payload&quot;/&amp;gt;&amp;lt;/soapenv:Body&amp;gt;&amp;lt;/soapenv:Envelope&amp;gt;&lt;/p&gt;

&lt;p&gt;The original input content was &quot;HelloWorld&quot;. Looks like Synapse has dropped the text payload. I&apos;m going to take a closer look.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Hiranya&lt;/p&gt;</comment>
                            <comment id="13712667" author="hiranya" created="Thu, 18 Jul 2013 19:04:26 +0000"  >&lt;p&gt;I think Ratha has uncovered a serious bug here. This is what happens:&lt;/p&gt;

&lt;p&gt;1. VFS listener receives a plain text message. The plain text builder creates an OMSourcedElement to represent the message payload.&lt;br/&gt;
2. When the ESB hits send, a new thread is spawned to handle the send operation. At this point the VFS listener thread returns and it closes the input stream to the input file.&lt;br/&gt;
3. Now when the VFS sender attempts to format the message, the OMSourcedElement no longer have access to the original file input stream. So an empty payload is written out.&lt;/p&gt;</comment>
                            <comment id="13712878" author="hudson" created="Thu, 18 Jul 2013 21:23:59 +0000"  >&lt;p&gt;SUCCESS: Integrated in Synapse - Trunk #4620 (See &lt;a href=&quot;https://builds.apache.org/job/Synapse%20-%20Trunk/4620/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Synapse%20-%20Trunk/4620/&lt;/a&gt;)&lt;br/&gt;
Some changes related to &lt;a href=&quot;https://issues.apache.org/jira/browse/SYNAPSE-851&quot; title=&quot;VFS proxy generates the response.xml with empty content (Synapse-2.2.0-Snapshot trunk)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SYNAPSE-851&quot;&gt;&lt;del&gt;SYNAPSE-851&lt;/del&gt;&lt;/a&gt;; Adding plain text formatter to the AxisConfig by default (we already add the plain text builder by default). In the VFS sender, setting the default output file name to response.dat for potential non-XML outputs. (hiranya: rev 1504634)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/synapse/trunk/java/modules/core/src/main/java/org/apache/synapse/Axis2SynapseController.java&lt;/li&gt;
	&lt;li&gt;/synapse/trunk/java/modules/transports/core/vfs/src/main/java/org/apache/synapse/transport/vfs/VFSConstants.java&lt;/li&gt;
	&lt;li&gt;/synapse/trunk/java/modules/transports/core/vfs/src/main/java/org/apache/synapse/transport/vfs/VFSUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15537798" author="isudana" created="Sat, 1 Oct 2016 03:39:43 +0000"  >&lt;p&gt;The problem is a new Thread is spawning at the axis2 level. &lt;br/&gt;
Only option I see to fix this is stop spawning of a new thread for vfs listener scenarios. &lt;br/&gt;
We need to remove ClientApiNonBlocking property before sending out the message.&lt;/p&gt;

&lt;p&gt;By adding the following at the inSequence I could get the scenario working.&lt;br/&gt;
&amp;lt;property name=&quot;ClientApiNonBlocking&quot; scope=&quot;axis2&quot; action=&quot;remove&quot;/&amp;gt; &lt;/p&gt;

&lt;p&gt;IMO, it is ok to remove that at the VFSListener level programatically.&lt;/p&gt;
</comment>
                            <comment id="15537850" author="isudana" created="Sat, 1 Oct 2016 04:19:47 +0000"  >&lt;p&gt;Committed revision 1762976&lt;/p&gt;</comment>
                            <comment id="15537995" author="hudson" created="Sat, 1 Oct 2016 06:17:30 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Synapse - Trunk #5276 (See &lt;a href=&quot;https://builds.apache.org/job/Synapse%20-%20Trunk/5276/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Synapse%20-%20Trunk/5276/&lt;/a&gt;)&lt;br/&gt;
fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/SYNAPSE-851&quot; title=&quot;VFS proxy generates the response.xml with empty content (Synapse-2.2.0-Snapshot trunk)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SYNAPSE-851&quot;&gt;&lt;del&gt;SYNAPSE-851&lt;/del&gt;&lt;/a&gt; (isudana: rev 1762976)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) java/modules/transports/core/vfs/src/main/java/org/apache/synapse/transport/vfs/VFSTransportListener.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>231237</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 7 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i17t2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>253680</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>