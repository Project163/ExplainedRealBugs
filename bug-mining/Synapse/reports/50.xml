<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 20:07:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SYNAPSE-150] SSL returns headers but no response XML for POX POST from PHP. From Java, OK. http POST from PHP, OK. SSL POST from PHP to Tomcat, OK</title>
                <link>https://issues.apache.org/jira/browse/SYNAPSE-150</link>
                <project id="12310201" key="SYNAPSE">Synapse</project>
                    <description>&lt;p&gt;When I use PHP to POST an http 1.0 POX request to Synapse by SSL, Synapse replies with http response code and headers only, and then closes the connection. No XML  is returned.&lt;/p&gt;

&lt;p&gt;Exactly the same PHP POST with plain http receives the XML.&lt;br/&gt;
A Java command line SSL POST receives the XML.&lt;br/&gt;
And PHP POSTing the data to a Tomcat JSP page over SSL works fine - it simply receives HTML instead of XML.&lt;/p&gt;

&lt;p&gt;Seems to be something in the Synapse SSL code that is doing the wrong thing, and silently.&lt;/p&gt;

&lt;p&gt;I tried setting non-blocking to false - no difference.&lt;/p&gt;</description>
                <environment>JDK6 on RHEL3.</environment>
        <key id="12380453">SYNAPSE-150</key>
            <summary>SSL returns headers but no response XML for POX POST from PHP. From Java, OK. http POST from PHP, OK. SSL POST from PHP to Tomcat, OK</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="asankha">Asankha Chamath Perera</assignee>
                                    <reporter username="panderson">Paul Anderson</reporter>
                        <labels>
                    </labels>
                <created>Mon, 15 Oct 2007 14:45:54 +0000</created>
                <updated>Wed, 24 Oct 2007 14:37:04 +0000</updated>
                            <resolved>Wed, 24 Oct 2007 12:07:30 +0000</resolved>
                                    <version>1.0</version>
                                    <fixVersion>1.1-RC1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12534861" author="panderson" created="Mon, 15 Oct 2007 14:49:18 +0000"  >&lt;p&gt;Synapse logs the incoming XML fine, and also the outgoing message. But the reply never goes out on the wire. I thought it might be a timeout, so I made a filter that forwarded the request to a static XML document on Apache httpd. Same result:- headers only.&lt;/p&gt;</comment>
                            <comment id="12534866" author="ruwan" created="Mon, 15 Oct 2007 15:16:40 +0000"  >&lt;p&gt;Upul can you look in to this?&lt;/p&gt;</comment>
                            <comment id="12536719" author="panderson" created="Mon, 22 Oct 2007 16:01:58 +0000"  >&lt;p&gt;Here&apos;s my PHP code. I used PHP 4.3.2, OpenSSL 0.9.7a Feb 19 2003, but PHP 5 and a similar OpenSSL version gave the same result, so the problem should be easy to reproduce.&lt;/p&gt;

&lt;p&gt;I tried the same test on the Oct 17th snapshot binary of Synapse - same result, even when the 2 filter configurations that I had before were combined into one filter.&lt;/p&gt;

&lt;p&gt;I see the XML message coming into Synapse, being passed on, WS-Sec headers added, message processed on the remote Geronimo web service, message being passed back out and logged. But only the headers are returned to the posting PHP script, not the payload. No error either.&lt;/p&gt;

&lt;p&gt;That&apos;s what makes me think it&apos;s a Synapse problem - the incoming message is received OK and the http headers go back OK, so it seems there&apos;s no keystore access, cert validity or channel encryption problem. Plain http POST is fine from PHP - I see the returned payload. And SSL POST is fine when I use Java! So the config is OK on Synapse.&lt;/p&gt;

&lt;p&gt;Help!&lt;/p&gt;

&lt;p&gt;&amp;lt;?php&lt;br/&gt;
$avariable= &quot;123456&quot;;&lt;/p&gt;

&lt;p&gt;$sock = fsockopen(&quot;ssl://theserver&quot;, 9443, $errno, $errstr, 30);&lt;br/&gt;
#$sock = fsockopen(&quot;theserver&quot;, 9080, $errno, $errstr, 30);&lt;/p&gt;

&lt;p&gt;if (!$sock) exit(&quot;Unable to connect&quot;);&lt;br/&gt;
socket_set_timeout($sock,60);&lt;/p&gt;

&lt;p&gt;$xmlpacket =&apos;&amp;lt;?xml version=&quot;1.0&quot;?&amp;gt;&amp;lt;ANXMLPAYLOAD&amp;gt;&apos;;$xmlpacket.=$avariable;$xmlpacket.=&apos;&amp;lt;/ANXMLPAYLOAD&amp;gt;&apos;;&lt;br/&gt;
#echo &quot;Content-Length: &quot;.strlen($xmlpacket).&quot;\r\n&quot;;&lt;/p&gt;

&lt;p&gt;$in = &quot;POST /TheService HTTP/1.0\r\n&quot;;&lt;br/&gt;
$in .=&quot;Host: theserver\r\n&quot;;&lt;/p&gt;

&lt;p&gt;$in .=&quot;Content-Type: application/xml; charset=utf-8\r\n&quot;;&lt;br/&gt;
$in .=&quot;Authorization: Basic xyzzy\r\n&quot;;&lt;br/&gt;
#$in .=&quot;Content-Length: &quot;.strlen($xmlpacket).&quot;\r\n&quot;;&lt;/p&gt;

&lt;p&gt;$in .=&quot;\r\n&quot;;&lt;br/&gt;
$in .=$xmlpacket;&lt;br/&gt;
$in .=&quot;\r\n&quot;;&lt;/p&gt;

&lt;p&gt;fputs($sock, $in, strlen($in));&lt;br/&gt;
sleep(10);&lt;br/&gt;
if ($sock) {&lt;br/&gt;
    while (!feof($sock)) &lt;/p&gt;
{
        $buffer = fgets($sock, 4096);
        echo &quot;Header:&quot;.$buffer.&quot;*&quot;;
    }

&lt;p&gt;    fclose($sock);&lt;br/&gt;
echo &quot;Socket was valid, closed it!&quot;;&lt;br/&gt;
}&lt;br/&gt;
else {&lt;br/&gt;
echo &quot;Socket invalid!&quot;;&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;?&amp;gt;&lt;/p&gt;</comment>
                            <comment id="12536728" author="panderson" created="Mon, 22 Oct 2007 16:21:17 +0000"  >&lt;p&gt;I enabled SSL debug. When I post over SSL from Java, in the logs after the dumped outgoing message I see:-&lt;/p&gt;

&lt;p&gt;I/O dispatcher 6, WRITE: TLSv1 Application Data, length = 262&lt;br/&gt;
I/O dispatcher 6, WRITE: TLSv1 Application Data, length = 125&lt;br/&gt;
I/O dispatcher 6, WRITE: TLSv1 Application Data, length = 5&lt;/p&gt;

&lt;p&gt;All is well - http headers and POX reply.&lt;/p&gt;

&lt;p&gt;When I post over SSL with PHP, there&apos;s a difference - the log looks like this after the dumped outgoing message:-&lt;br/&gt;
I/O dispatcher 8, WRITE: TLSv1 Application Data, length = 229&lt;br/&gt;
I/O dispatcher 8, called closeOutbound()&lt;br/&gt;
I/O dispatcher 8, closeOutboundInternal()&lt;br/&gt;
I/O dispatcher 8, SEND TLSv1 ALERT:  warning, description = close_notify&lt;br/&gt;
I/O dispatcher 8, WRITE: TLSv1 Alert, length = 32&lt;br/&gt;
I/O dispatcher 8, READ: TLSv1 Alert, length = 32&lt;br/&gt;
I/O dispatcher 8, RECV TLSv1 ALERT:  warning, close_notify&lt;br/&gt;
I/O dispatcher 8, closeInboundInternal()&lt;br/&gt;
I/O dispatcher 8, closeOutboundInternal()&lt;/p&gt;

&lt;p&gt;So it seems Synapse sends the headers and then cuts the connection?&lt;/p&gt;</comment>
                            <comment id="12536735" author="olegk" created="Mon, 22 Oct 2007 16:35:45 +0000"  >&lt;p&gt;Paul&lt;/p&gt;

&lt;p&gt;You can some more detailed info about what Synapse&apos;s HTTP transport is doing by setting the following two log categories to the DEBUG priority  &lt;/p&gt;

&lt;p&gt;org.apache.http&lt;br/&gt;
org.apache.axis2.transport.nhttp.headers&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="12536737" author="panderson" created="Mon, 22 Oct 2007 16:49:08 +0000"  >&lt;p&gt;Thanks Oleg. Done that now (maybe it means something to someone!):-&lt;/p&gt;

&lt;p&gt;2007-10-22 17:41:08,888 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;HttpClientWorker-1&amp;#93;&lt;/span&gt; DEBUG SSLIOSession I/O session 1 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;]&lt;span class=&quot;error&quot;&gt;&amp;#91;SSL handshake status: NOT_HANDSHAKING&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: Set event &lt;span class=&quot;error&quot;&gt;&amp;#91;w&amp;#93;&lt;/span&gt;&lt;br/&gt;
I/O dispatcher 6, WRITE: TLSv1 Application Data, length = 229&lt;br/&gt;
2007-10-22 17:41:08,890 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 6&amp;#93;&lt;/span&gt; DEBUG SSLIOSession I/O session 1 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;rw&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;w&amp;#93;&lt;/span&gt;]&lt;span class=&quot;error&quot;&gt;&amp;#91;SSL handshake status: NOT_HANDSHAKING&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;261&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: 229 bytes written&lt;br/&gt;
2007-10-22 17:41:08,891 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 6&amp;#93;&lt;/span&gt; DEBUG SSLIOSession I/O session 1 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;rw&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;w&amp;#93;&lt;/span&gt;]&lt;span class=&quot;error&quot;&gt;&amp;#91;SSL handshake status: NOT_HANDSHAKING&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;261&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: 0 bytes written&lt;br/&gt;
2007-10-22 17:41:08,892 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 6&amp;#93;&lt;/span&gt; DEBUG SSLIOSession I/O session 1 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;rw&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;w&amp;#93;&lt;/span&gt;]&lt;span class=&quot;error&quot;&gt;&amp;#91;SSL handshake status: NOT_HANDSHAKING&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: Close&lt;br/&gt;
I/O dispatcher 6, called closeOutbound()&lt;br/&gt;
I/O dispatcher 6, closeOutboundInternal()&lt;br/&gt;
I/O dispatcher 6, SEND TLSv1 ALERT:  warning, description = close_notify&lt;br/&gt;
I/O dispatcher 6, WRITE: TLSv1 Alert, length = 32&lt;br/&gt;
2007-10-22 17:41:08,893 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 6&amp;#93;&lt;/span&gt; DEBUG SSLIOSession I/O session 1 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;rw&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;w&amp;#93;&lt;/span&gt;]&lt;span class=&quot;error&quot;&gt;&amp;#91;SSL handshake status: NEED_WRAP&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: Clear event &lt;span class=&quot;error&quot;&gt;&amp;#91;w&amp;#93;&lt;/span&gt;&lt;br/&gt;
I/O dispatcher 6, READ: TLSv1 Alert, length = 32&lt;br/&gt;
I/O dispatcher 6, RECV TLSv1 ALERT:  warning, close_notify&lt;br/&gt;
I/O dispatcher 6, closeInboundInternal()&lt;br/&gt;
I/O dispatcher 6, closeOutboundInternal()&lt;br/&gt;
2007-10-22 17:41:18,527 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 6&amp;#93;&lt;/span&gt; DEBUG SSLIOSession I/O session 1 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;]&lt;span class=&quot;error&quot;&gt;&amp;#91;SSL handshake status: NOT_HANDSHAKING&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: Clear event &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;&lt;br/&gt;
2007-10-22 17:41:28,866 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 1&amp;#93;&lt;/span&gt; DEBUG IOSessionImpl I/O session 2 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;]: -1 bytes read&lt;br/&gt;
2007-10-22 17:41:28,867 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 1&amp;#93;&lt;/span&gt; DEBUG IOSessionImpl I/O session 2 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;]: Close&lt;/p&gt;
</comment>
                            <comment id="12536741" author="olegk" created="Mon, 22 Oct 2007 16:54:16 +0000"  >&lt;p&gt;Paul,&lt;br/&gt;
Could you attach a complete log of the HTTP session?&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="12536744" author="panderson" created="Mon, 22 Oct 2007 17:08:12 +0000"  >&lt;p&gt;The POX from PHP passes through the Synapse filter, gets SOAP headers added, goes to Geronimo, gets processed by a web service, and the reply comes back:-&lt;br/&gt;
This log is from tcpmon between Synapse and the backend Geronimo.&lt;/p&gt;

&lt;p&gt;POST &lt;a href=&quot;http://server:10082/smscontractservice/services&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://server:10082/smscontractservice/services&lt;/a&gt; HTTP/1.1&lt;br/&gt;
Authorization: Basic xxyyzzy=&lt;br/&gt;
Host: 127.0.0.1:10082&lt;br/&gt;
Content-Type: text/xml; charset=utf-8&lt;br/&gt;
Transfer-Encoding: chunked&lt;br/&gt;
Connection: Keep-Alive&lt;br/&gt;
User-Agent: Synapse-HttpComponents-NIO&lt;/p&gt;

&lt;p&gt;169&lt;br/&gt;
&amp;lt;?xml version=&apos;1.0&apos; encoding=&apos;utf-8&apos;?&amp;gt;&lt;br/&gt;
   &amp;lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;soapenv:Body&amp;gt;&lt;br/&gt;
         &amp;lt;vas:ContractConsumptionSendRequest xmlns:vas=&quot;http://www.wta.dz/schema/vas&quot; xmlns:telco=&quot;http://www.wta.dz/schema/telco&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;telco:MSISDN&amp;gt;213xxxxyyyy&amp;lt;/telco:MSISDN&amp;gt;&lt;br/&gt;
         &amp;lt;/vas:ContractConsumptionSendRequest&amp;gt;&lt;br/&gt;
      &amp;lt;/soapenv:Body&amp;gt;&lt;br/&gt;
   &amp;lt;/soapenv:Envelope&amp;gt;0&lt;/p&gt;

&lt;p&gt;HTTP/1.1 200 OK&lt;br/&gt;
Server: Apache-Coyote/1.1&lt;br/&gt;
Accept: text/xml, text/html, image/gif, image/jpeg, &lt;b&gt;; q=.2, */&lt;/b&gt;; q=.2&lt;br/&gt;
Content-Type: text/xml;charset=utf-8&lt;br/&gt;
Content-Length: 269&lt;br/&gt;
Date: Mon, 22 Oct 2007 16:41:08 GMT&lt;/p&gt;

&lt;p&gt;&amp;lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&amp;gt;&lt;br/&gt;
   &amp;lt;SOAP-ENV:Header/&amp;gt;&lt;br/&gt;
   &amp;lt;SOAP-ENV:Body&amp;gt;&lt;br/&gt;
      &amp;lt;ns3:ContractConsumptionSendResponse xmlns:ns2=&quot;http://www.wta.dz/schema/telco&quot; xmlns:ns3=&quot;http://www.wta.dz/schema/vas&quot;/&amp;gt;&lt;br/&gt;
   &amp;lt;/SOAP-ENV:Body&amp;gt;&amp;lt;/SOAP-ENV:Envelope&amp;gt;&lt;/p&gt;

&lt;p&gt;After the last outgoing message gets logged by Synapse, the payload doesn&apos;t come back to PHP, the connection ends after the http headers - and you see the SSL debug lines I described.&lt;/p&gt;

&lt;p&gt;2007-10-22 18:03:34,592 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 1&amp;#93;&lt;/span&gt; DEBUG headers &amp;lt;&amp;lt; HTTP/1.1 200 OK&lt;br/&gt;
2007-10-22 18:03:34,592 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 1&amp;#93;&lt;/span&gt; DEBUG headers &amp;lt;&amp;lt; Server: Apache-Coyote/1.1&lt;br/&gt;
2007-10-22 18:03:34,593 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 1&amp;#93;&lt;/span&gt; DEBUG headers &amp;lt;&amp;lt; Accept: text/xml, text/html, image/gif, image/jpeg, &lt;b&gt;; q=.2, */&lt;/b&gt;; q=.2&lt;br/&gt;
2007-10-22 18:03:34,593 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 1&amp;#93;&lt;/span&gt; DEBUG headers &amp;lt;&amp;lt; Content-Type: text/xml;charset=utf-8&lt;br/&gt;
2007-10-22 18:03:34,593 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 1&amp;#93;&lt;/span&gt; DEBUG headers &amp;lt;&amp;lt; Content-Length: 269&lt;br/&gt;
2007-10-22 18:03:34,593 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 1&amp;#93;&lt;/span&gt; DEBUG headers &amp;lt;&amp;lt; Date: Mon, 22 Oct 2007 17:03:34 GMT&lt;br/&gt;
2007-10-22 18:03:34,593 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 1&amp;#93;&lt;/span&gt; DEBUG IOSessionImpl I/O session 2 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;]: 269 bytes read&lt;br/&gt;
2007-10-22 18:03:34,605 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;HttpClientWorker-1&amp;#93;&lt;/span&gt;  INFO Axis2MessageContext To: &lt;a href=&quot;http://www.w3.org/2005/08/addressing/anonymous&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.w3.org/2005/08/addressing/anonymous&lt;/a&gt;, MessageID: urn:uuid:623ABD3C74BF9644BF11930726144187820011006578058, Direction: response, Envelope: &amp;lt;?xml version=&apos;1.0&apos; encoding=&apos;utf-8&apos;?&amp;gt;&amp;lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&amp;gt;&amp;lt;SOAP-ENV:Body&amp;gt;&amp;lt;ns3:ContractConsumptionSendResponse xmlns:ns3=&quot;http://www.wta.dz/schema/vas&quot; xmlns:ns2=&quot;http://www.wta.dz/schema/telco&quot; /&amp;gt;&amp;lt;/SOAP-ENV:Body&amp;gt;&amp;lt;/SOAP-ENV:Envelope&amp;gt;&lt;br/&gt;
2007-10-22 18:03:34,605 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;HttpClientWorker-1&amp;#93;&lt;/span&gt;  INFO LogMediator To: &lt;a href=&quot;http://www.w3.org/2005/08/addressing/anonymous&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.w3.org/2005/08/addressing/anonymous&lt;/a&gt;, MessageID: urn:uuid:623ABD3C74BF9644BF11930726144187820011006578058, Direction: response, Envelope: &amp;lt;?xml version=&apos;1.0&apos; encoding=&apos;utf-8&apos;?&amp;gt;&amp;lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&amp;gt;&amp;lt;SOAP-ENV:Body&amp;gt;&amp;lt;ns3:ContractConsumptionSendResponse xmlns:ns3=&quot;http://www.wta.dz/schema/vas&quot; xmlns:ns2=&quot;http://www.wta.dz/schema/telco&quot; /&amp;gt;&amp;lt;/SOAP-ENV:Body&amp;gt;&amp;lt;/SOAP-ENV:Envelope&amp;gt;&lt;br/&gt;
2007-10-22 18:03:34,609 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;HttpClientWorker-1&amp;#93;&lt;/span&gt; DEBUG SSLIOSession I/O session 1 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;]&lt;span class=&quot;error&quot;&gt;&amp;#91;SSL handshake status: NOT_HANDSHAKING&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: Set event &lt;span class=&quot;error&quot;&gt;&amp;#91;w&amp;#93;&lt;/span&gt;&lt;br/&gt;
I/O dispatcher 4, WRITE: TLSv1 Application Data, length = 229&lt;br/&gt;
2007-10-22 18:03:34,611 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 4&amp;#93;&lt;/span&gt; DEBUG SSLIOSession I/O session 1 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;rw&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;w&amp;#93;&lt;/span&gt;]&lt;span class=&quot;error&quot;&gt;&amp;#91;SSL handshake status: NOT_HANDSHAKING&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;261&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: 229 bytes written&lt;br/&gt;
2007-10-22 18:03:34,612 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 4&amp;#93;&lt;/span&gt; DEBUG SSLIOSession I/O session 1 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;rw&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;w&amp;#93;&lt;/span&gt;]&lt;span class=&quot;error&quot;&gt;&amp;#91;SSL handshake status: NOT_HANDSHAKING&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;261&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: 0 bytes written&lt;br/&gt;
2007-10-22 18:03:34,612 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 4&amp;#93;&lt;/span&gt; DEBUG SSLIOSession I/O session 1 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;rw&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;w&amp;#93;&lt;/span&gt;]&lt;span class=&quot;error&quot;&gt;&amp;#91;SSL handshake status: NOT_HANDSHAKING&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: Close&lt;br/&gt;
I/O dispatcher 4, called closeOutbound()&lt;br/&gt;
I/O dispatcher 4, closeOutboundInternal()&lt;br/&gt;
I/O dispatcher 4, SEND TLSv1 ALERT:  warning, description = close_notify&lt;br/&gt;
I/O dispatcher 4, WRITE: TLSv1 Alert, length = 32&lt;br/&gt;
2007-10-22 18:03:34,613 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 4&amp;#93;&lt;/span&gt; DEBUG SSLIOSession I/O session 1 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;rw&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;w&amp;#93;&lt;/span&gt;]&lt;span class=&quot;error&quot;&gt;&amp;#91;SSL handshake status: NEED_WRAP&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: Clear event &lt;span class=&quot;error&quot;&gt;&amp;#91;w&amp;#93;&lt;/span&gt;&lt;br/&gt;
I/O dispatcher 4, READ: TLSv1 Alert, length = 32&lt;br/&gt;
I/O dispatcher 4, RECV TLSv1 ALERT:  warning, close_notify&lt;br/&gt;
I/O dispatcher 4, closeInboundInternal()&lt;br/&gt;
I/O dispatcher 4, closeOutboundInternal()&lt;br/&gt;
2007-10-22 18:03:44,287 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 4&amp;#93;&lt;/span&gt; DEBUG SSLIOSession I/O session 1 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;]&lt;span class=&quot;error&quot;&gt;&amp;#91;SSL handshake status: NOT_HANDSHAKING&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: Clear event &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;sup&gt;[[5~&lt;/sup&gt;[[5~2007-10-22 18:03:54,587 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 1&amp;#93;&lt;/span&gt; DEBUG IOSessionImpl I/O session 2 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;]: -1 bytes read&lt;br/&gt;
2007-10-22 18:03:54,587 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 1&amp;#93;&lt;/span&gt; DEBUG IOSessionImpl I/O session 2 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;]: Close&lt;/p&gt;

</comment>
                            <comment id="12536752" author="olegk" created="Mon, 22 Oct 2007 17:26:18 +0000"  >&lt;p&gt;...&lt;br/&gt;
2007-10-22 18:03:34,593 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 1&amp;#93;&lt;/span&gt; DEBUG headers &amp;lt;&amp;lt; Content-Length: 269&lt;br/&gt;
...&lt;br/&gt;
2007-10-22 18:03:34,593 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 1&amp;#93;&lt;/span&gt; DEBUG IOSessionImpl I/O session 2 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;]: 269 bytes read &lt;br/&gt;
...&lt;br/&gt;
2007-10-22 18:03:34,609 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;HttpClientWorker-1&amp;#93;&lt;/span&gt; DEBUG SSLIOSession I/O session 1 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;r&amp;#93;&lt;/span&gt;]&lt;span class=&quot;error&quot;&gt;&amp;#91;SSL handshake status: NOT_HANDSHAKING&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: Set event &lt;span class=&quot;error&quot;&gt;&amp;#91;w&amp;#93;&lt;/span&gt;&lt;br/&gt;
I/O dispatcher 4, WRITE: TLSv1 Application Data, length = 229&lt;br/&gt;
2007-10-22 18:03:34,611 &lt;span class=&quot;error&quot;&gt;&amp;#91;server&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;I/O dispatcher 4&amp;#93;&lt;/span&gt; DEBUG SSLIOSession I/O session 1 [interested ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;rw&amp;#93;&lt;/span&gt;; ready ops: &lt;span class=&quot;error&quot;&gt;&amp;#91;w&amp;#93;&lt;/span&gt;]&lt;span class=&quot;error&quot;&gt;&amp;#91;SSL handshake status: NOT_HANDSHAKING&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;261&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: 229 bytes written&lt;/p&gt;

&lt;p&gt;This seems to suggest 269 of content were received from the target server but only 229 sent to the client.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="12537296" author="asankha" created="Wed, 24 Oct 2007 12:07:30 +0000"  >&lt;p&gt;When HTTP 1.0 was used with SSL, the SSLEngine was probably not writing all plain text output in one call - as per its documentation. Thus in ServerHandler.outputReady(..) method, we were incorrectly marking the encoder (The IdentityEncoder in this instance) as complete, when the outbuf still had more of the response to be written..&lt;/p&gt;

&lt;p&gt;An additional check to check the outbuf seems to make sure that we wait for all data to be assed through before the encoder is informed of completion&lt;/p&gt;

&lt;p&gt;        try {&lt;br/&gt;
            int bytesRead = source.read(outbuf);&lt;br/&gt;
            if (bytesRead == -1 &amp;amp;&amp;amp; outbuf.position() == 0) {&lt;br/&gt;
                encoder.complete();&lt;br/&gt;
................&lt;/p&gt;

&lt;p&gt;one of the interesting and time consuming defects of our 1.1 release.. fulled by an enthusiastic and persistent real user of Synapse &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;!&lt;/p&gt;</comment>
                            <comment id="12537297" author="olegk" created="Wed, 24 Oct 2007 12:13:38 +0000"  >&lt;p&gt;Asankha,&lt;/p&gt;

&lt;p&gt;Could you please also apply this fix to HttpCore NIOSSL?&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="12537310" author="panderson" created="Wed, 24 Oct 2007 12:49:03 +0000"  >&lt;p&gt;Will there be a binary posted somewhere for 1.1.-RC1-B1? I have found /~ruwan/ to be much less pain than Maven behind a corporate proxy!&lt;/p&gt;</comment>
                            <comment id="12537312" author="asankha" created="Wed, 24 Oct 2007 12:50:36 +0000"  >&lt;p&gt;Hi Oleg&lt;/p&gt;

&lt;p&gt;I do not think this can ever happen on plain HttpCore as ServerWorker is a Synapse class that implements the NHttpServiceHandler interface. This is a bug in the Synapse code.. &lt;/p&gt;

&lt;p&gt;thanks&lt;br/&gt;
asankha&lt;/p&gt;</comment>
                            <comment id="12537332" author="ruwan" created="Wed, 24 Oct 2007 14:37:04 +0000"  >&lt;p&gt;We will be doing the RC1-B1 ASA we are done with the Critical JIRAs for the 1.1 release, basically we will have to wait till XmlSchema release.&lt;/p&gt;

&lt;p&gt;We do have nightly builds &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; but it seems like they were not updated after 17th. I will look in to that.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; - &lt;a href=&quot;http://people.apache.org/dist/synapse/nightly/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://people.apache.org/dist/synapse/nightly/&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>183382</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 6 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i11id3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>216941</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>