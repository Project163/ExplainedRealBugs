<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 20:07:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SYNAPSE-448] NullPointerException in JMSSender when JMS config details defined in axis2.xml</title>
                <link>https://issues.apache.org/jira/browse/SYNAPSE-448</link>
                <project id="12310201" key="SYNAPSE">Synapse</project>
                    <description>&lt;p&gt;I am proxying a JMS service over HTTP.  The JMS service responds with some XML, so the JMSSender expects a reply.  To make my endpoint more reusable, I&apos;m putting the JMS connection details in axis2.xml (as detailed in &lt;a href=&quot;https://issues.apache.org/jira/browse/SYNAPSE-183&quot; title=&quot;It should be possible to re-use the JMS connection information from the axis2.xml JMSSender when specifying JMS EPRs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SYNAPSE-183&quot;&gt;&lt;del&gt;SYNAPSE-183&lt;/del&gt;&lt;/a&gt;).  What&apos;s actually happening though is that the HTTP client is just timing out.  I ran the debugger over Synapse to see what was going on, and it looks like a defect with the implementation of that feature.&lt;/p&gt;

&lt;p&gt;To listen for a JMS reply from the endpoint, Synapse starts a connection (JMSSender:267) after sending the message.  However, this connection is only ever initialised if the JMS connection is &lt;em&gt;not&lt;/em&gt; defined in axis2.xml, due to the if/else that checks for an already established connectionFactory at the key &quot;transport.jms.ConnectionFactory&quot; (JMSSender:119).  This means the connection is always null when using this feature, and a NPE will be thrown at line 267.&lt;/p&gt;

&lt;p&gt;I&apos;ll supply a test if required.&lt;/p&gt;

&lt;p&gt;Cheers,&lt;br/&gt;
Jason&lt;/p&gt;</description>
                <environment>Any</environment>
        <key id="12404254">SYNAPSE-448</key>
            <summary>NullPointerException in JMSSender when JMS config details defined in axis2.xml</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="veithen">Andreas Veithen-Knowles</assignee>
                                    <reporter username="majikshoe">Jason Royals</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Sep 2008 14:37:33 +0000</created>
                <updated>Wed, 17 Sep 2008 20:57:00 +0000</updated>
                            <resolved>Wed, 17 Sep 2008 20:57:00 +0000</resolved>
                                    <version>1.2</version>
                                    <fixVersion>2.0</fixVersion>
                                    <component>Transports</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12630723" author="majikshoe" created="Sat, 13 Sep 2008 00:56:25 +0000"  >&lt;p&gt;Just an addition to this, just changing the endpoint in synapse.xml from using &quot;transport.jms.ConnectionFactory&quot; to the less-reusable equivalent (eg, jms:/queuename?transport.jms.ConnectionFactoryJNDIName=QueueConnectionFactory&amp;amp;java.naming.factory.initial=org.apache.activemq.jndi.ActiveMQInitialContextFactory&amp;amp;java.naming.provider.url=tcp://localhost:61616&amp;amp;transport.jms.ConnectionFactoryType=queue) didn&apos;t work either, at least not intially.  &lt;/p&gt;

&lt;p&gt;I found that JMSSender is doing something I didn&apos;t expect when it looks for a JMS Connection to use.  JMSSender, if it cannot find a cached connection factory by name, will iterate over the axis2.xml configured factories and look for equivalence between the fully-qualified jms:/ URI and a pre-configured factory for each JMS message (JMSSender:117).  If it finds one (JMSSender:92), it uses the pre-configured connection factory instead of creating a new one.&lt;/p&gt;

&lt;p&gt;That&apos;s fine, but it&apos;s not what I expected to happen.  Synapse should probably log something here to advise that it&apos;s found some equivalence in the pre-configured factory and will use it instead of creating the new one.  Unfortunately, when Synapse uses the cached factory, it then follows the same code path as described in the original report, and will break for the same reasons.&lt;/p&gt;

&lt;p&gt;Workaround for this is to simply remove the definition from axis2.xml, and my test goes peachy green.  That&apos;s not what I want though because my endpoint now knows too much about the JMS implementation, and we cannot switch JMS implementations without changing the endpoint itself.&lt;/p&gt;</comment>
                            <comment id="12630928" author="veithen" created="Sun, 14 Sep 2008 22:03:07 +0000"  >&lt;p&gt;Actually, if connection is null, this means JMSSender uses a cached session and the underlying connection is already started. Therefore it is sufficient to add a simple if statement to fix this issue. I corrected this in the trunk but I believe there is also some resource leak in the case we are discussing here, so you are invited to test the solution, but I discourage you from using it in a production environment. Anyway I will keep this JIRA issue open until I have written a regression test.&lt;/p&gt;</comment>
                            <comment id="12631105" author="veithen" created="Mon, 15 Sep 2008 19:10:08 +0000"  >&lt;p&gt;The resource leak was actually due to the fact that the sender doesn&apos;t close the JMS connections when the transport is stopped. This is now corrected in trunk.&lt;/p&gt;</comment>
                            <comment id="12631943" author="veithen" created="Wed, 17 Sep 2008 20:57:00 +0000"  >&lt;p&gt;Added regression test for this issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>183672</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 10 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i11cof:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>216020</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>