{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/18291","repository_url":"https://api.github.com/repos/bazelbuild/bazel","labels_url":"https://api.github.com/repos/bazelbuild/bazel/issues/18291/labels{/name}","comments_url":"https://api.github.com/repos/bazelbuild/bazel/issues/18291/comments","events_url":"https://api.github.com/repos/bazelbuild/bazel/issues/18291/events","html_url":"https://github.com/bazelbuild/bazel/issues/18291","id":1693553714,"node_id":"I_kwDOATz7jc5k8ZQy","number":18291,"title":"Bazel Unrecoverable Error with Capital Letters in SHA256 String","user":{"login":"alexbeattie42","id":30098201,"node_id":"MDQ6VXNlcjMwMDk4MjAx","avatar_url":"https://avatars.githubusercontent.com/u/30098201?v=4","gravatar_id":"","url":"https://api.github.com/users/alexbeattie42","html_url":"https://github.com/alexbeattie42","followers_url":"https://api.github.com/users/alexbeattie42/followers","following_url":"https://api.github.com/users/alexbeattie42/following{/other_user}","gists_url":"https://api.github.com/users/alexbeattie42/gists{/gist_id}","starred_url":"https://api.github.com/users/alexbeattie42/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexbeattie42/subscriptions","organizations_url":"https://api.github.com/users/alexbeattie42/orgs","repos_url":"https://api.github.com/users/alexbeattie42/repos","events_url":"https://api.github.com/users/alexbeattie42/events{/privacy}","received_events_url":"https://api.github.com/users/alexbeattie42/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":106503259,"node_id":"MDU6TGFiZWwxMDY1MDMyNTk=","url":"https://api.github.com/repos/bazelbuild/bazel/labels/type:%20bug","name":"type: bug","color":"0052cc","default":false,"description":null},{"id":1020663381,"node_id":"MDU6TGFiZWwxMDIwNjYzMzgx","url":"https://api.github.com/repos/bazelbuild/bazel/labels/team-ExternalDeps","name":"team-ExternalDeps","color":"f1f442","default":false,"description":"External dependency handling, remote repositiories, WORKSPACE file."},{"id":1020665933,"node_id":"MDU6TGFiZWwxMDIwNjY1OTMz","url":"https://api.github.com/repos/bazelbuild/bazel/labels/untriaged","name":"untriaged","color":"c34ddd","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-05-03T07:37:37Z","updated_at":"2023-05-05T04:27:06Z","closed_at":"2023-05-05T04:27:06Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description of the bug:\n\n\nIf there is a capital letter present in the SHA256 string bazel crashes with the fatal error contained below. Some tools, specifically [Get-FileHash](https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-filehash?view=powershell-7.3) on Windows return upper case SHA256 strings.\r\n\r\nThe `Illegal hexadecimal character` error message does not make it clear that the problem is that uppercase letters are not valid in a bazel SHA256 string.\r\n\r\nThe code should either be updated so that letter case doesn't matter or the error message should specifically state that upper case letters are not accepted. \r\n\r\n---\r\n```\r\njava.lang.RuntimeException: Unrecoverable error while evaluating node 'REPOSITORY_DIRECTORY:@bazel_skylib' (requested by nodes 'PACKAGE_LOOKUP:@bazel_skylib//')\r\n        at com.google.devtools.build.skyframe.AbstractParallelEvaluator$Evaluate.run(AbstractParallelEvaluator.java:642)\r\n        at com.google.devtools.build.lib.concurrent.AbstractQueueVisitor$WrappedRunnable.run(AbstractQueueVisitor.java:382)\r\n        at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\r\n        at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\r\n        at java.base/java.lang.Thread.run(Unknown Source)\r\nCaused by: net.starlark.java.eval.Starlark$UncheckedEvalException: IllegalArgumentException thrown during Starlark evaluation (LOADING)\r\n        at <starlark>.download_and_extract(<builtin>:0)\r\n        at <starlark>._http_archive_impl(/private/var/tmp/_bazel_abeattie/6d30cdea4ede9832a87c4794c274b995/external/bazel_tools/tools/build_defs/repo/http.bzl:132)\r\nCaused by: java.lang.IllegalArgumentException: Illegal hexadecimal character: D\r\n        at com.google.common.hash.HashCode.decode(HashCode.java:360)\r\n        at com.google.common.hash.HashCode.fromString(HashCode.java:346)\r\n        at com.google.devtools.build.lib.bazel.repository.downloader.Checksum.fromString(Checksum.java:47)\r\n        at com.google.devtools.build.lib.bazel.repository.starlark.StarlarkBaseExternalContext.validateChecksum(StarlarkBaseExternalContext.java:302)\r\n        at com.google.devtools.build.lib.bazel.repository.starlark.StarlarkBaseExternalContext.downloadAndExtract(StarlarkBaseExternalContext.java:650)\r\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\r\n        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\r\n        at java.base/java.lang.reflect.Method.invoke(Unknown Source)\r\n        at net.starlark.java.eval.MethodDescriptor.call(MethodDescriptor.java:162)\r\n        at net.starlark.java.eval.BuiltinFunction.fastcall(BuiltinFunction.java:77)\r\n        at net.starlark.java.eval.Starlark.fastcall(Starlark.java:638)\r\n        at net.starlark.java.eval.Eval.evalCall(Eval.java:682)\r\n        at net.starlark.java.eval.Eval.eval(Eval.java:497)\r\n        at net.starlark.java.eval.Eval.execAssignment(Eval.java:109)\r\n        at net.starlark.java.eval.Eval.exec(Eval.java:268)\r\n        at net.starlark.java.eval.Eval.execStatements(Eval.java:82)\r\n        at net.starlark.java.eval.Eval.execFunctionBody(Eval.java:66)\r\n        at net.starlark.java.eval.StarlarkFunction.fastcall(StarlarkFunction.java:173)\r\n        at net.starlark.java.eval.Starlark.fastcall(Starlark.java:638)\r\n        at net.starlark.java.eval.Starlark.call(Starlark.java:604)\r\n        at com.google.devtools.build.lib.bazel.repository.starlark.StarlarkRepositoryFunction.fetch(StarlarkRepositoryFunction.java:220)\r\n        at com.google.devtools.build.lib.rules.repository.RepositoryDelegatorFunction.fetchRepository(RepositoryDelegatorFunction.java:413)\r\n        at com.google.devtools.build.lib.rules.repository.RepositoryDelegatorFunction.compute(RepositoryDelegatorFunction.java:344)\r\n        at com.google.devtools.build.skyframe.AbstractParallelEvaluator$Evaluate.run(AbstractParallelEvaluator.java:571)\r\n        at com.google.devtools.build.lib.concurrent.AbstractQueueVisitor$WrappedRunnable.run(AbstractQueueVisitor.java:382)\r\n        at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\r\n        at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\r\n        at java.base/java.lang.Thread.run(Unknown Source)\r\n```\n\n### What's the simplest, easiest way to reproduce this bug? Please provide a minimal example if possible.\n\n\nFails:\r\n```\r\nhttp_archive(\r\n    name = \"bazel_skylib\",\r\n    sha256 = \"74D544D96F4A5BB630D465CA8BBCFE231E3594E5AAE57E1EDBF17A6EB3CA2506\",\r\n    urls = [\r\n        \"https://storage.googleapis.com/mirror.tensorflow.org/github.com/bazelbuild/bazel-skylib/releases/download/1.3.0/bazel-skylib-1.3.0.tar.gz\",\r\n        \"https://github.com/bazelbuild/bazel-skylib/releases/download/1.3.0/bazel-skylib-1.3.0.tar.gz\",\r\n    ],\r\n)\r\n```\r\nSucceeds:\r\n```\r\nhttp_archive(\r\n    name = \"bazel_skylib\",\r\n    sha256 = \"74d544d96f4a5bb630d465ca8bbcfe231e3594e5aae57e1edbf17a6eb3ca2506\",\r\n    urls = [\r\n        \"https://storage.googleapis.com/mirror.tensorflow.org/github.com/bazelbuild/bazel-skylib/releases/download/1.3.0/bazel-skylib-1.3.0.tar.gz\",\r\n        \"https://github.com/bazelbuild/bazel-skylib/releases/download/1.3.0/bazel-skylib-1.3.0.tar.gz\",\r\n    ],\r\n)\r\n```\n\n### Which operating system are you running Bazel on?\n\n\nWindows & MacOS\n\n### What is the output of `bazel info release`?\n\n\n6.1.1\n\n### If `bazel info release` returns `development version` or `(@non-git)`, tell us how you built Bazel.\n\n\n_No response_\n\n### What's the output of `git remote get-url origin; git rev-parse master; git rev-parse HEAD` ?\n\n\n_No response_\n\n### Have you found anything relevant by searching the web?\n\n_No response_\n\n### Any other information, logs, or outputs that you want to share?\n\n_No response_","closed_by":{"login":"copybara-service[bot]","id":56741989,"node_id":"MDM6Qm90NTY3NDE5ODk=","avatar_url":"https://avatars.githubusercontent.com/in/44061?v=4","gravatar_id":"","url":"https://api.github.com/users/copybara-service%5Bbot%5D","html_url":"https://github.com/apps/copybara-service","followers_url":"https://api.github.com/users/copybara-service%5Bbot%5D/followers","following_url":"https://api.github.com/users/copybara-service%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/copybara-service%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/copybara-service%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/copybara-service%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/copybara-service%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/copybara-service%5Bbot%5D/repos","events_url":"https://api.github.com/users/copybara-service%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/copybara-service%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/18291/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bazelbuild/bazel/issues/18291/timeline","performed_via_github_app":null,"state_reason":"completed"}