{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/24239","repository_url":"https://api.github.com/repos/bazelbuild/bazel","labels_url":"https://api.github.com/repos/bazelbuild/bazel/issues/24239/labels{/name}","comments_url":"https://api.github.com/repos/bazelbuild/bazel/issues/24239/comments","events_url":"https://api.github.com/repos/bazelbuild/bazel/issues/24239/events","html_url":"https://github.com/bazelbuild/bazel/issues/24239","id":2641457081,"node_id":"I_kwDOATz7jc6dcW-5","number":24239,"title":"Unable to execute `bazel info` without a module file","user":{"login":"shs96c","id":28229,"node_id":"MDQ6VXNlcjI4MjI5","avatar_url":"https://avatars.githubusercontent.com/u/28229?v=4","gravatar_id":"","url":"https://api.github.com/users/shs96c","html_url":"https://github.com/shs96c","followers_url":"https://api.github.com/users/shs96c/followers","following_url":"https://api.github.com/users/shs96c/following{/other_user}","gists_url":"https://api.github.com/users/shs96c/gists{/gist_id}","starred_url":"https://api.github.com/users/shs96c/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shs96c/subscriptions","organizations_url":"https://api.github.com/users/shs96c/orgs","repos_url":"https://api.github.com/users/shs96c/repos","events_url":"https://api.github.com/users/shs96c/events{/privacy}","received_events_url":"https://api.github.com/users/shs96c/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":106503259,"node_id":"MDU6TGFiZWwxMDY1MDMyNTk=","url":"https://api.github.com/repos/bazelbuild/bazel/labels/type:%20bug","name":"type: bug","color":"0052cc","default":false,"description":null},{"id":1020665933,"node_id":"MDU6TGFiZWwxMDIwNjY1OTMz","url":"https://api.github.com/repos/bazelbuild/bazel/labels/untriaged","name":"untriaged","color":"c34ddd","default":false,"description":""},{"id":1182274167,"node_id":"MDU6TGFiZWwxMTgyMjc0MTY3","url":"https://api.github.com/repos/bazelbuild/bazel/labels/team-Core","name":"team-Core","color":"f1f442","default":false,"description":"Skyframe, bazel query, BEP, options parsing, bazelrc"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":12,"created_at":"2024-11-07T15:54:30Z","updated_at":"2024-11-22T23:30:47Z","closed_at":"2024-11-07T18:57:54Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description of the bug:\n\n\nSee [the build logs](https://buildkite.com/bazel/rules-jvm-external-examples/builds/4407#0193073d-7cb4-43e8-bbf6-c8c1390b8b4f/116-128) from [this PR in rules_jvm_external](https://github.com/bazel-contrib/rules_jvm_external/pull/1279)\r\n\r\nThe execution of `bazel info` fails with:\r\n\r\n```shell\r\nFATAL: bazel crashed due to an internal error. Printing stack trace:\r\njava.lang.NullPointerException: Cannot invoke \"java.lang.Throwable.getMessage()\" because \"cause\" is null\r\n\tat com.google.devtools.build.lib.analysis.config.InvalidConfigurationException.<init>(InvalidConfigurationException.java:53)\r\n\tat com.google.devtools.build.lib.skyframe.SkyframeExecutor.createBuildConfigurationKey(SkyframeExecutor.java:1813)\r\n\tat com.google.devtools.build.lib.skyframe.SkyframeExecutor.getConfiguration(SkyframeExecutor.java:1752)\r\n\tat com.google.devtools.build.lib.runtime.commands.InfoCommand.lambda$exec$0(InfoCommand.java:158)\r\n\tat com.google.common.base.Suppliers$NonSerializableMemoizingSupplier.get(Suppliers.java:181)\r\n\tat com.google.devtools.build.lib.runtime.commands.InfoCommand.exec(InfoCommand.java:215)\r\n\tat com.google.devtools.build.lib.runtime.BlazeCommandDispatcher.execExclusively(BlazeCommandDispatcher.java:664)\r\n\tat com.google.devtools.build.lib.runtime.BlazeCommandDispatcher.exec(BlazeCommandDispatcher.java:244)\r\n\tat com.google.devtools.build.lib.server.GrpcServerImpl.executeCommand(GrpcServerImpl.java:573)\r\n\tat com.google.devtools.build.lib.server.GrpcServerImpl.lambda$run$1(GrpcServerImpl.java:641)\r\n\tat io.grpc.Context$1.run(Context.java:566)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\r\n\tat java.base/java.lang.Thread.run(Unknown Source)\r\nTraceback (most recent call last):\r\n  File \"bazelci.py\", line 4493, in <module>\r\n    sys.exit(main())\r\n  File \"bazelci.py\", line 4471, in main\r\n    bazel_version=task_config.get(\"bazel\") or configs.get(\"bazel\"),\r\n  File \"bazelci.py\", line 1212, in execute_commands\r\n    bazel_version = print_bazel_version_info(bazel_binary, platform)\r\n  File \"bazelci.py\", line 1515, in print_bazel_version_info\r\n    [bazel_binary] + common_startup_flags() + [\"--nosystem_rc\", \"--nohome_rc\", \"info\"]\r\n  File \"bazelci.py\", line 2653, in execute_command\r\n    subprocess.PIPE if capture_stderr else None\r\n  File \"/usr/lib/python3.6/subprocess.py\", line 438, in run\r\n    output=stdout, stderr=stderr)\r\nsubprocess.CalledProcessError: Command '['bazel', '--nosystem_rc', '--nohome_rc', 'info']' returned non-zero exit status 37.\r\n```\n\n### Which category does this issue belong to?\n\nCore\n\n### What's the simplest, easiest way to reproduce this bug? Please provide a minimal example if possible.\n\n\n1. Clone `rules_jvm_external` and checks out `d8cc6c07f2c1c61276f46e6f03b270db497e98fe`. \r\n2. `cd examples/simple`\r\n3. `bazel info`\n\n### Which operating system are you running Bazel on?\n\n\nmacOS and Linux\n\n### What is the output of `bazel info release`?\n\n\n7.4.0\n\n### If `bazel info release` returns `development version` or `(@non-git)`, tell us how you built Bazel.\n\n\n_No response_\n\n### What's the output of `git remote get-url origin; git rev-parse HEAD` ?\n\n\n```text\nhttps://github.com/bazel-contrib/rules_jvm_external.git\r\nd8cc6c07f2c1c61276f46e6f03b270db497e98fe\n```\n\n\n### If this is a regression, please try to identify the Bazel commit where the bug was introduced with bazelisk --bisect.\n\n\n_No response_\n\n### Have you found anything relevant by searching the web?\n\n_No response_\n\n### Any other information, logs, or outputs that you want to share?\n\n_No response_","closed_by":{"login":"copybara-service[bot]","id":56741989,"node_id":"MDM6Qm90NTY3NDE5ODk=","avatar_url":"https://avatars.githubusercontent.com/in/44061?v=4","gravatar_id":"","url":"https://api.github.com/users/copybara-service%5Bbot%5D","html_url":"https://github.com/apps/copybara-service","followers_url":"https://api.github.com/users/copybara-service%5Bbot%5D/followers","following_url":"https://api.github.com/users/copybara-service%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/copybara-service%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/copybara-service%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/copybara-service%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/copybara-service%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/copybara-service%5Bbot%5D/repos","events_url":"https://api.github.com/users/copybara-service%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/copybara-service%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/24239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bazelbuild/bazel/issues/24239/timeline","performed_via_github_app":null,"state_reason":"completed"}