{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/24882","repository_url":"https://api.github.com/repos/bazelbuild/bazel","labels_url":"https://api.github.com/repos/bazelbuild/bazel/issues/24882/labels{/name}","comments_url":"https://api.github.com/repos/bazelbuild/bazel/issues/24882/comments","events_url":"https://api.github.com/repos/bazelbuild/bazel/issues/24882/events","html_url":"https://github.com/bazelbuild/bazel/issues/24882","id":2778696237,"node_id":"I_kwDOATz7jc6ln4ot","number":24882,"title":"`bazel help flags-as-proto` incorrectly reports `has_negative: false` for `--experimental_convenience_symlinks` and `--subcommands`","user":{"login":"tempoz","id":735684,"node_id":"MDQ6VXNlcjczNTY4NA==","avatar_url":"https://avatars.githubusercontent.com/u/735684?v=4","gravatar_id":"","url":"https://api.github.com/users/tempoz","html_url":"https://github.com/tempoz","followers_url":"https://api.github.com/users/tempoz/followers","following_url":"https://api.github.com/users/tempoz/following{/other_user}","gists_url":"https://api.github.com/users/tempoz/gists{/gist_id}","starred_url":"https://api.github.com/users/tempoz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tempoz/subscriptions","organizations_url":"https://api.github.com/users/tempoz/orgs","repos_url":"https://api.github.com/users/tempoz/repos","events_url":"https://api.github.com/users/tempoz/events{/privacy}","received_events_url":"https://api.github.com/users/tempoz/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":106503259,"node_id":"MDU6TGFiZWwxMDY1MDMyNTk=","url":"https://api.github.com/repos/bazelbuild/bazel/labels/type:%20bug","name":"type: bug","color":"0052cc","default":false,"description":null},{"id":1020665933,"node_id":"MDU6TGFiZWwxMDIwNjY1OTMz","url":"https://api.github.com/repos/bazelbuild/bazel/labels/untriaged","name":"untriaged","color":"c34ddd","default":false,"description":""},{"id":4761872548,"node_id":"LA_kwDOATz7jc8AAAABG9RopA","url":"https://api.github.com/repos/bazelbuild/bazel/labels/team-CLI","name":"team-CLI","color":"f1f442","default":false,"description":"Console UI"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2025-01-09T20:27:24Z","updated_at":"2025-01-22T23:58:27Z","closed_at":"2025-01-13T08:24:53Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description of the bug:\r\n\r\n\r\n`bazel help flags-as-proto` incorrectly reports `has_negative: false` for `--experimental_convenience_symlinks` and `--subcommands`.\r\n\r\n### Which category does this issue belong to?\r\n\r\nCLI\r\n\r\n### What's the simplest, easiest way to reproduce this bug? Please provide a minimal example if possible.\r\n\r\n\r\n```sh\r\nwget https://raw.githubusercontent.com/bazelbuild/bazel/refs/tags/8.0.0/src/main/protobuf/bazel_flags.proto\r\nbazel help flags-as-proto | tail -1 | base64 --decode | protoc --decode bazel_flags.FlagCollection bazel_flags.proto\r\n```\r\n\r\noutputs:\r\n\r\n```\r\n[ other options... ]\r\n\r\nflag_infos {\r\n  name: \"experimental_convenience_symlinks\"\r\n  has_negative_flag: false\r\n  documentation: \"This flag controls how the convenience symlinks (the symlinks that appear in the workspace after the build) will be managed. Possible values:\\n  normal (default): Each kind of convenience symlink will be created or deleted, as determined by the build.\\n  clean: All symlinks will be unconditionally deleted.\\n  ignore: Symlinks will not be created or cleaned up.\\n  log_only: Generate log messages as if \\'normal\\' were passed, but don\\'t actually performany filesystem operations (useful for tools).\\nNote that only symlinks whose names are generated by the current value of --symlink_prefix can be affected; if the prefix changes, any pre-existing symlinks will be left alone.\"\r\n  commands: \"aquery\"\r\n  commands: \"build\"\r\n  commands: \"canonicalize-flags\"\r\n  commands: \"clean\"\r\n  commands: \"config\"\r\n  commands: \"coverage\"\r\n  commands: \"cquery\"\r\n  commands: \"fetch\"\r\n  commands: \"info\"\r\n  commands: \"mobile-install\"\r\n  commands: \"print_action\"\r\n  commands: \"run\"\r\n  commands: \"test\"\r\n  commands: \"vendor\"\r\n  allows_multiple: false\r\n  effect_tags: \"AFFECTS_OUTPUTS\"\r\n  documentation_category: \"OUTPUT_PARAMETERS\"\r\n  requires_value: false\r\n}\r\n\r\n[ other options... ]\r\n\r\nflag_infos {\r\n  name: \"subcommands\"\r\n  has_negative_flag: false\r\n  documentation: \"Display the subcommands executed during a build. Related flags: --execution_log_json_file, --execution_log_binary_file (for logging subcommands to a file in a tool-friendly format).\"\r\n  commands: \"aquery\"\r\n  commands: \"build\"\r\n  commands: \"canonicalize-flags\"\r\n  commands: \"clean\"\r\n  commands: \"config\"\r\n  commands: \"coverage\"\r\n  commands: \"cquery\"\r\n  commands: \"fetch\"\r\n  commands: \"info\"\r\n  commands: \"mobile-install\"\r\n  commands: \"print_action\"\r\n  commands: \"run\"\r\n  commands: \"test\"\r\n  commands: \"vendor\"\r\n  abbreviation: \"s\"\r\n  allows_multiple: false\r\n  effect_tags: \"TERMINAL_OUTPUT\"\r\n  documentation_category: \"LOGGING\"\r\n  requires_value: false\r\n}\r\n\r\n[ other options... ]\r\n```\r\n\r\nThis contradicts the bazel documentation [here](https://bazel.build/reference/command-line-reference#flag--experimental_convenience_symlinks):\r\n\r\n>**[`--[no]experimental_convenience_symlinks`](https://bazel.build/reference/command-line-reference#flag--experimental_convenience_symlinks) default: \"normal\"**\r\nThis flag controls how the convenience symlinks (the symlinks that appear in the workspace after the build) will be managed. Possible values: normal (default): Each kind of convenience symlink will be created or deleted, as determined by the build. clean: All symlinks will be unconditionally deleted. ignore: Symlinks will not be created or cleaned up. log_only: Generate log messages as if 'normal' were passed, but don't actually perform any filesystem operations (useful for tools). Note that only symlinks whose names are generated by the current value of --symlink_prefix can be affected; if the prefix changes, any pre-existing symlinks will be left alone.\r\nTags: [affects_outputs](https://bazel.build/reference/command-line-reference#effect_tag_AFFECTS_OUTPUTS)\r\n\r\nand [here](https://bazel.build/reference/command-line-reference#flag--subcommands):\r\n\r\n>**[` --[no]subcommands`](https://bazel.build/reference/command-line-reference#flag--subcommands) [`-s`] default: \"false\"**\r\nDisplay the subcommands executed during a build. Related flags: --execution_log_json_file, --execution_log_binary_file (for logging subcommands to a file in a tool-friendly format).\r\nTags: [`terminal_output`](https://bazel.build/reference/command-line-reference#effect_tag_TERMINAL_OUTPUT)\r\n\r\n, respectively.\r\n\r\n### Which operating system are you running Bazel on?\r\n\r\n\r\nDebian trixie\r\n\r\n### What is the output of `bazel info release`?\r\n\r\n\r\nrelease 8.0.0\r\n\r\n### If `bazel info release` returns `development version` or `(@non-git)`, tell us how you built Bazel.\r\n\r\n\r\n_No response_\r\n\r\n### What's the output of `git remote get-url origin; git rev-parse HEAD` ?\r\n\r\n\r\n```text\r\nfatal: not a git repository (or any parent up to mount point /)\r\nStopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).\r\nfatal: not a git repository (or any parent up to mount point /)\r\nStopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).\r\n```\r\n\r\n\r\n### If this is a regression, please try to identify the Bazel commit where the bug was introduced with bazelisk --bisect.\r\n\r\n\r\n_No response_\r\n\r\n### Have you found anything relevant by searching the web?\r\n\r\nI don't think there's anything that searching the web can help with here.\r\n\r\n### Any other information, logs, or outputs that you want to share?\r\n\r\n_No response_","closed_by":{"login":"copybara-service[bot]","id":56741989,"node_id":"MDM6Qm90NTY3NDE5ODk=","avatar_url":"https://avatars.githubusercontent.com/in/44061?v=4","gravatar_id":"","url":"https://api.github.com/users/copybara-service%5Bbot%5D","html_url":"https://github.com/apps/copybara-service","followers_url":"https://api.github.com/users/copybara-service%5Bbot%5D/followers","following_url":"https://api.github.com/users/copybara-service%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/copybara-service%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/copybara-service%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/copybara-service%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/copybara-service%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/copybara-service%5Bbot%5D/repos","events_url":"https://api.github.com/users/copybara-service%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/copybara-service%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/24882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bazelbuild/bazel/issues/24882/timeline","performed_via_github_app":null,"state_reason":"completed"}