{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/19635","repository_url":"https://api.github.com/repos/bazelbuild/bazel","labels_url":"https://api.github.com/repos/bazelbuild/bazel/issues/19635/labels{/name}","comments_url":"https://api.github.com/repos/bazelbuild/bazel/issues/19635/comments","events_url":"https://api.github.com/repos/bazelbuild/bazel/issues/19635/events","html_url":"https://github.com/bazelbuild/bazel/issues/19635","id":1913547825,"node_id":"I_kwDOATz7jc5yDmwx","number":19635,"title":"use_repo name remapping limits the space of possible target workspace names","user":{"login":"aherrmann","id":732652,"node_id":"MDQ6VXNlcjczMjY1Mg==","avatar_url":"https://avatars.githubusercontent.com/u/732652?v=4","gravatar_id":"","url":"https://api.github.com/users/aherrmann","html_url":"https://github.com/aherrmann","followers_url":"https://api.github.com/users/aherrmann/followers","following_url":"https://api.github.com/users/aherrmann/following{/other_user}","gists_url":"https://api.github.com/users/aherrmann/gists{/gist_id}","starred_url":"https://api.github.com/users/aherrmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aherrmann/subscriptions","organizations_url":"https://api.github.com/users/aherrmann/orgs","repos_url":"https://api.github.com/users/aherrmann/repos","events_url":"https://api.github.com/users/aherrmann/events{/privacy}","received_events_url":"https://api.github.com/users/aherrmann/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":106503261,"node_id":"MDU6TGFiZWwxMDY1MDMyNjE=","url":"https://api.github.com/repos/bazelbuild/bazel/labels/type:%20feature%20request","name":"type: feature request","color":"0052cc","default":false,"description":null},{"id":192364170,"node_id":"MDU6TGFiZWwxOTIzNjQxNzA=","url":"https://api.github.com/repos/bazelbuild/bazel/labels/P2","name":"P2","color":"e99695","default":false,"description":"We'll consider working on this in future. (Assignee optional)"},{"id":1020663381,"node_id":"MDU6TGFiZWwxMDIwNjYzMzgx","url":"https://api.github.com/repos/bazelbuild/bazel/labels/team-ExternalDeps","name":"team-ExternalDeps","color":"f1f442","default":false,"description":"External dependency handling, remote repositiories, WORKSPACE file."},{"id":3718884690,"node_id":"LA_kwDOATz7jc7dqa1S","url":"https://api.github.com/repos/bazelbuild/bazel/labels/area-Bzlmod","name":"area-Bzlmod","color":"a4fc20","default":false,"description":"Bzlmod-specific PRs, issues, and feature requests"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2023-09-26T13:43:09Z","updated_at":"2025-04-10T21:44:56Z","closed_at":"2025-03-18T09:48:48Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description of the feature request:\n\n\n`use_repo`, called in `MODULE.bazel` to import an external workspace generated by a module extension, supports name remapping using keyword argument syntax. E.g. if the module extension `ext` generates the external workspace `foo` then I can rename it to `bar` using the syntax\r\n```\r\nuse_repo(ext, bar = \"foo\")\r\n```\r\n\r\nThis limits the space of possible target names to those names which are valid Starlark identifiers. In particular, it is not possible to remap the workspace to the name `bar-baz`, because it is not a valid Starlark identifier, i.e. the following causes an error\r\n```\r\nuse_repo(ext, bar-baz = \"foo\")\r\n```\r\n\r\nHowever, `bar-baz` would be a legal name for an external workspace and `@bar-baz//:xyz` would be a valid label. And other forms of repo name remapping do support the full range of possible workspace names, e.g. via the `bazel_dep` `repo_name` parameter which accepts a string. Making this limitation seem like an inconsistency.\r\n\r\nPlease support repo name remapping to the full range of possible workspace names for module extension generated workspaces.\n\n### Which category does this issue belong to?\n\n\nExternal Dependency\n\n### What underlying problem are you trying to solve with this feature?\n\n\nI am trying to map old usage patterns under the WORKSPACE and repository rule system to bzlmod using isolated extensions and repo name remapping. See https://github.com/tweag/gazelle_cabal/issues/61. In particular, I am trying to remap an external workspace generated by a module extension named `stackage-exe` to the name `stackage-b-exe`.\n\n### Which operating system are you running Bazel on?\n\n\nUbuntu 22.04\n\n### What is the output of `bazel info release`?\n\n\nrelease 6.2.0- (@non-git)\n\n### If `bazel info release` returns `development version` or `(@non-git)`, tell us how you built Bazel.\n\n\nNix\n\n### What's the output of `git remote get-url origin; git rev-parse master; git rev-parse HEAD` ?\n\n\n```text\nn/a\n```\n\n\n### Have you found anything relevant by searching the web?\n\n_No response_\n\n### Any other information, logs, or outputs that you want to share?\n\n[Bazel Slack discussion](https://bazelbuild.slack.com/archives/C014RARENH0/p1695733945408119).\r\nThis kind of name remapping was possible using `kwargs` until https://github.com/bazelbuild/bazel/commit/7a262a6ee88e0ecc10705c460e38efe32c8543e2, thanks @fmeum for the pointer.","closed_by":{"login":"copybara-service[bot]","id":56741989,"node_id":"MDM6Qm90NTY3NDE5ODk=","avatar_url":"https://avatars.githubusercontent.com/in/44061?v=4","gravatar_id":"","url":"https://api.github.com/users/copybara-service%5Bbot%5D","html_url":"https://github.com/apps/copybara-service","followers_url":"https://api.github.com/users/copybara-service%5Bbot%5D/followers","following_url":"https://api.github.com/users/copybara-service%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/copybara-service%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/copybara-service%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/copybara-service%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/copybara-service%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/copybara-service%5Bbot%5D/repos","events_url":"https://api.github.com/users/copybara-service%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/copybara-service%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/19635/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bazelbuild/bazel/issues/19635/timeline","performed_via_github_app":null,"state_reason":"completed"}