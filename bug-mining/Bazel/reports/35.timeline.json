[{"id":8697227824,"node_id":"LE_lADOATz7jc5gSO6AzwAAAAIGZSow","url":"https://api.github.com/repos/bazelbuild/bazel/issues/events/8697227824","actor":{"login":"Wyverald","id":453203,"node_id":"MDQ6VXNlcjQ1MzIwMw==","avatar_url":"https://avatars.githubusercontent.com/u/453203?v=4","gravatar_id":"","url":"https://api.github.com/users/Wyverald","html_url":"https://github.com/Wyverald","followers_url":"https://api.github.com/users/Wyverald/followers","following_url":"https://api.github.com/users/Wyverald/following{/other_user}","gists_url":"https://api.github.com/users/Wyverald/gists{/gist_id}","starred_url":"https://api.github.com/users/Wyverald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wyverald/subscriptions","organizations_url":"https://api.github.com/users/Wyverald/orgs","repos_url":"https://api.github.com/users/Wyverald/repos","events_url":"https://api.github.com/users/Wyverald/events{/privacy}","received_events_url":"https://api.github.com/users/Wyverald/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-03-08T14:43:29Z","label":{"name":"type: bug","color":"0052cc"},"performed_via_github_app":null},{"id":8697227829,"node_id":"LE_lADOATz7jc5gSO6AzwAAAAIGZSo1","url":"https://api.github.com/repos/bazelbuild/bazel/issues/events/8697227829","actor":{"login":"Wyverald","id":453203,"node_id":"MDQ6VXNlcjQ1MzIwMw==","avatar_url":"https://avatars.githubusercontent.com/u/453203?v=4","gravatar_id":"","url":"https://api.github.com/users/Wyverald","html_url":"https://github.com/Wyverald","followers_url":"https://api.github.com/users/Wyverald/followers","following_url":"https://api.github.com/users/Wyverald/following{/other_user}","gists_url":"https://api.github.com/users/Wyverald/gists{/gist_id}","starred_url":"https://api.github.com/users/Wyverald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wyverald/subscriptions","organizations_url":"https://api.github.com/users/Wyverald/orgs","repos_url":"https://api.github.com/users/Wyverald/repos","events_url":"https://api.github.com/users/Wyverald/events{/privacy}","received_events_url":"https://api.github.com/users/Wyverald/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-03-08T14:43:29Z","label":{"name":"team-Configurability","color":"f1f442"},"performed_via_github_app":null},{"id":8697227836,"node_id":"LE_lADOATz7jc5gSO6AzwAAAAIGZSo8","url":"https://api.github.com/repos/bazelbuild/bazel/issues/events/8697227836","actor":{"login":"Wyverald","id":453203,"node_id":"MDQ6VXNlcjQ1MzIwMw==","avatar_url":"https://avatars.githubusercontent.com/u/453203?v=4","gravatar_id":"","url":"https://api.github.com/users/Wyverald","html_url":"https://github.com/Wyverald","followers_url":"https://api.github.com/users/Wyverald/followers","following_url":"https://api.github.com/users/Wyverald/following{/other_user}","gists_url":"https://api.github.com/users/Wyverald/gists{/gist_id}","starred_url":"https://api.github.com/users/Wyverald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wyverald/subscriptions","organizations_url":"https://api.github.com/users/Wyverald/orgs","repos_url":"https://api.github.com/users/Wyverald/repos","events_url":"https://api.github.com/users/Wyverald/events{/privacy}","received_events_url":"https://api.github.com/users/Wyverald/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-03-08T14:43:29Z","label":{"name":"untriaged","color":"c34ddd"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/comments/1460267853","html_url":"https://github.com/bazelbuild/bazel/issues/17689#issuecomment-1460267853","issue_url":"https://api.github.com/repos/bazelbuild/bazel/issues/17689","id":1460267853,"node_id":"IC_kwDOATz7jc5XCetN","user":{"login":"Wyverald","id":453203,"node_id":"MDQ6VXNlcjQ1MzIwMw==","avatar_url":"https://avatars.githubusercontent.com/u/453203?v=4","gravatar_id":"","url":"https://api.github.com/users/Wyverald","html_url":"https://github.com/Wyverald","followers_url":"https://api.github.com/users/Wyverald/followers","following_url":"https://api.github.com/users/Wyverald/following{/other_user}","gists_url":"https://api.github.com/users/Wyverald/gists{/gist_id}","starred_url":"https://api.github.com/users/Wyverald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wyverald/subscriptions","organizations_url":"https://api.github.com/users/Wyverald/orgs","repos_url":"https://api.github.com/users/Wyverald/repos","events_url":"https://api.github.com/users/Wyverald/events{/privacy}","received_events_url":"https://api.github.com/users/Wyverald/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-08T14:44:01Z","updated_at":"2023-03-08T14:44:01Z","body":"cc @katre ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/comments/1460267853/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Wyverald","id":453203,"node_id":"MDQ6VXNlcjQ1MzIwMw==","avatar_url":"https://avatars.githubusercontent.com/u/453203?v=4","gravatar_id":"","url":"https://api.github.com/users/Wyverald","html_url":"https://github.com/Wyverald","followers_url":"https://api.github.com/users/Wyverald/followers","following_url":"https://api.github.com/users/Wyverald/following{/other_user}","gists_url":"https://api.github.com/users/Wyverald/gists{/gist_id}","starred_url":"https://api.github.com/users/Wyverald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wyverald/subscriptions","organizations_url":"https://api.github.com/users/Wyverald/orgs","repos_url":"https://api.github.com/users/Wyverald/repos","events_url":"https://api.github.com/users/Wyverald/events{/privacy}","received_events_url":"https://api.github.com/users/Wyverald/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":8697233195,"node_id":"MEE_lADOATz7jc5gSO6AzwAAAAIGZT8r","url":"https://api.github.com/repos/bazelbuild/bazel/issues/events/8697233195","actor":{"login":"katre","id":326527,"node_id":"MDQ6VXNlcjMyNjUyNw==","avatar_url":"https://avatars.githubusercontent.com/u/326527?v=4","gravatar_id":"","url":"https://api.github.com/users/katre","html_url":"https://github.com/katre","followers_url":"https://api.github.com/users/katre/followers","following_url":"https://api.github.com/users/katre/following{/other_user}","gists_url":"https://api.github.com/users/katre/gists{/gist_id}","starred_url":"https://api.github.com/users/katre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/katre/subscriptions","organizations_url":"https://api.github.com/users/katre/orgs","repos_url":"https://api.github.com/users/katre/repos","events_url":"https://api.github.com/users/katre/events{/privacy}","received_events_url":"https://api.github.com/users/katre/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-03-08T14:44:01Z","performed_via_github_app":null},{"id":8697233218,"node_id":"SE_lADOATz7jc5gSO6AzwAAAAIGZT9C","url":"https://api.github.com/repos/bazelbuild/bazel/issues/events/8697233218","actor":{"login":"katre","id":326527,"node_id":"MDQ6VXNlcjMyNjUyNw==","avatar_url":"https://avatars.githubusercontent.com/u/326527?v=4","gravatar_id":"","url":"https://api.github.com/users/katre","html_url":"https://github.com/katre","followers_url":"https://api.github.com/users/katre/followers","following_url":"https://api.github.com/users/katre/following{/other_user}","gists_url":"https://api.github.com/users/katre/gists{/gist_id}","starred_url":"https://api.github.com/users/katre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/katre/subscriptions","organizations_url":"https://api.github.com/users/katre/orgs","repos_url":"https://api.github.com/users/katre/repos","events_url":"https://api.github.com/users/katre/events{/privacy}","received_events_url":"https://api.github.com/users/katre/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-03-08T14:44:01Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/comments/1460270793","html_url":"https://github.com/bazelbuild/bazel/issues/17689#issuecomment-1460270793","issue_url":"https://api.github.com/repos/bazelbuild/bazel/issues/17689","id":1460270793,"node_id":"IC_kwDOATz7jc5XCfbJ","user":{"login":"Wyverald","id":453203,"node_id":"MDQ6VXNlcjQ1MzIwMw==","avatar_url":"https://avatars.githubusercontent.com/u/453203?v=4","gravatar_id":"","url":"https://api.github.com/users/Wyverald","html_url":"https://github.com/Wyverald","followers_url":"https://api.github.com/users/Wyverald/followers","following_url":"https://api.github.com/users/Wyverald/following{/other_user}","gists_url":"https://api.github.com/users/Wyverald/gists{/gist_id}","starred_url":"https://api.github.com/users/Wyverald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wyverald/subscriptions","organizations_url":"https://api.github.com/users/Wyverald/orgs","repos_url":"https://api.github.com/users/Wyverald/repos","events_url":"https://api.github.com/users/Wyverald/events{/privacy}","received_events_url":"https://api.github.com/users/Wyverald/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-08T14:46:01Z","updated_at":"2023-03-08T14:46:01Z","body":"For the record, to figure out what was wrong initially, I had to build my own Bazel and insert a line in `PackageValue#key` to crash immediately when the requested package identifier is `//c` o,o","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/comments/1460270793/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null,"event":"commented","actor":{"login":"Wyverald","id":453203,"node_id":"MDQ6VXNlcjQ1MzIwMw==","avatar_url":"https://avatars.githubusercontent.com/u/453203?v=4","gravatar_id":"","url":"https://api.github.com/users/Wyverald","html_url":"https://github.com/Wyverald","followers_url":"https://api.github.com/users/Wyverald/followers","following_url":"https://api.github.com/users/Wyverald/following{/other_user}","gists_url":"https://api.github.com/users/Wyverald/gists{/gist_id}","starred_url":"https://api.github.com/users/Wyverald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wyverald/subscriptions","organizations_url":"https://api.github.com/users/Wyverald/orgs","repos_url":"https://api.github.com/users/Wyverald/repos","events_url":"https://api.github.com/users/Wyverald/events{/privacy}","received_events_url":"https://api.github.com/users/Wyverald/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"Wyverald","id":453203,"node_id":"MDQ6VXNlcjQ1MzIwMw==","avatar_url":"https://avatars.githubusercontent.com/u/453203?v=4","gravatar_id":"","url":"https://api.github.com/users/Wyverald","html_url":"https://github.com/Wyverald","followers_url":"https://api.github.com/users/Wyverald/followers","following_url":"https://api.github.com/users/Wyverald/following{/other_user}","gists_url":"https://api.github.com/users/Wyverald/gists{/gist_id}","starred_url":"https://api.github.com/users/Wyverald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wyverald/subscriptions","organizations_url":"https://api.github.com/users/Wyverald/orgs","repos_url":"https://api.github.com/users/Wyverald/repos","events_url":"https://api.github.com/users/Wyverald/events{/privacy}","received_events_url":"https://api.github.com/users/Wyverald/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-08T14:46:22Z","updated_at":"2023-03-08T14:46:22Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/17655","repository_url":"https://api.github.com/repos/bazelbuild/bazel","labels_url":"https://api.github.com/repos/bazelbuild/bazel/issues/17655/labels{/name}","comments_url":"https://api.github.com/repos/bazelbuild/bazel/issues/17655/comments","events_url":"https://api.github.com/repos/bazelbuild/bazel/issues/17655/events","html_url":"https://github.com/bazelbuild/bazel/issues/17655","id":1607061421,"node_id":"I_kwDOATz7jc5fyc-t","number":17655,"title":"Bazel can't resolve \"platforms\" repository, despite explicit module dependency","user":{"login":"seh","id":175841,"node_id":"MDQ6VXNlcjE3NTg0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/175841?v=4","gravatar_id":"","url":"https://api.github.com/users/seh","html_url":"https://github.com/seh","followers_url":"https://api.github.com/users/seh/followers","following_url":"https://api.github.com/users/seh/following{/other_user}","gists_url":"https://api.github.com/users/seh/gists{/gist_id}","starred_url":"https://api.github.com/users/seh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seh/subscriptions","organizations_url":"https://api.github.com/users/seh/orgs","repos_url":"https://api.github.com/users/seh/repos","events_url":"https://api.github.com/users/seh/events{/privacy}","received_events_url":"https://api.github.com/users/seh/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":106503259,"node_id":"MDU6TGFiZWwxMDY1MDMyNTk=","url":"https://api.github.com/repos/bazelbuild/bazel/labels/type:%20bug","name":"type: bug","color":"0052cc","default":false,"description":null},{"id":192364170,"node_id":"MDU6TGFiZWwxOTIzNjQxNzA=","url":"https://api.github.com/repos/bazelbuild/bazel/labels/P2","name":"P2","color":"e99695","default":false,"description":"We'll consider working on this in future. (Assignee optional)"},{"id":1020663381,"node_id":"MDU6TGFiZWwxMDIwNjYzMzgx","url":"https://api.github.com/repos/bazelbuild/bazel/labels/team-ExternalDeps","name":"team-ExternalDeps","color":"f1f442","default":false,"description":"External dependency handling, remote repositiories, WORKSPACE file."},{"id":3718884690,"node_id":"LA_kwDOATz7jc7dqa1S","url":"https://api.github.com/repos/bazelbuild/bazel/labels/area-Bzlmod","name":"area-Bzlmod","color":"a4fc20","default":false,"description":"Bzlmod-specific PRs, issues, and feature requests"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2023-03-02T15:55:20Z","updated_at":"2023-03-09T14:32:14Z","closed_at":"2023-03-09T14:32:14Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":20773773,"node_id":"MDEwOlJlcG9zaXRvcnkyMDc3Mzc3Mw==","name":"bazel","full_name":"bazelbuild/bazel","private":false,"owner":{"login":"bazelbuild","id":11684617,"node_id":"MDEyOk9yZ2FuaXphdGlvbjExNjg0NjE3","avatar_url":"https://avatars.githubusercontent.com/u/11684617?v=4","gravatar_id":"","url":"https://api.github.com/users/bazelbuild","html_url":"https://github.com/bazelbuild","followers_url":"https://api.github.com/users/bazelbuild/followers","following_url":"https://api.github.com/users/bazelbuild/following{/other_user}","gists_url":"https://api.github.com/users/bazelbuild/gists{/gist_id}","starred_url":"https://api.github.com/users/bazelbuild/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bazelbuild/subscriptions","organizations_url":"https://api.github.com/users/bazelbuild/orgs","repos_url":"https://api.github.com/users/bazelbuild/repos","events_url":"https://api.github.com/users/bazelbuild/events{/privacy}","received_events_url":"https://api.github.com/users/bazelbuild/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/bazelbuild/bazel","description":"a fast, scalable, multi-language and extensible build system","fork":false,"url":"https://api.github.com/repos/bazelbuild/bazel","forks_url":"https://api.github.com/repos/bazelbuild/bazel/forks","keys_url":"https://api.github.com/repos/bazelbuild/bazel/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bazelbuild/bazel/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bazelbuild/bazel/teams","hooks_url":"https://api.github.com/repos/bazelbuild/bazel/hooks","issue_events_url":"https://api.github.com/repos/bazelbuild/bazel/issues/events{/number}","events_url":"https://api.github.com/repos/bazelbuild/bazel/events","assignees_url":"https://api.github.com/repos/bazelbuild/bazel/assignees{/user}","branches_url":"https://api.github.com/repos/bazelbuild/bazel/branches{/branch}","tags_url":"https://api.github.com/repos/bazelbuild/bazel/tags","blobs_url":"https://api.github.com/repos/bazelbuild/bazel/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bazelbuild/bazel/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bazelbuild/bazel/git/refs{/sha}","trees_url":"https://api.github.com/repos/bazelbuild/bazel/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bazelbuild/bazel/statuses/{sha}","languages_url":"https://api.github.com/repos/bazelbuild/bazel/languages","stargazers_url":"https://api.github.com/repos/bazelbuild/bazel/stargazers","contributors_url":"https://api.github.com/repos/bazelbuild/bazel/contributors","subscribers_url":"https://api.github.com/repos/bazelbuild/bazel/subscribers","subscription_url":"https://api.github.com/repos/bazelbuild/bazel/subscription","commits_url":"https://api.github.com/repos/bazelbuild/bazel/commits{/sha}","git_commits_url":"https://api.github.com/repos/bazelbuild/bazel/git/commits{/sha}","comments_url":"https://api.github.com/repos/bazelbuild/bazel/comments{/number}","issue_comment_url":"https://api.github.com/repos/bazelbuild/bazel/issues/comments{/number}","contents_url":"https://api.github.com/repos/bazelbuild/bazel/contents/{+path}","compare_url":"https://api.github.com/repos/bazelbuild/bazel/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bazelbuild/bazel/merges","archive_url":"https://api.github.com/repos/bazelbuild/bazel/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bazelbuild/bazel/downloads","issues_url":"https://api.github.com/repos/bazelbuild/bazel/issues{/number}","pulls_url":"https://api.github.com/repos/bazelbuild/bazel/pulls{/number}","milestones_url":"https://api.github.com/repos/bazelbuild/bazel/milestones{/number}","notifications_url":"https://api.github.com/repos/bazelbuild/bazel/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bazelbuild/bazel/labels{/name}","releases_url":"https://api.github.com/repos/bazelbuild/bazel/releases{/id}","deployments_url":"https://api.github.com/repos/bazelbuild/bazel/deployments","created_at":"2014-06-12T16:00:38Z","updated_at":"2025-11-10T01:33:52Z","pushed_at":"2025-11-08T01:50:45Z","git_url":"git://github.com/bazelbuild/bazel.git","ssh_url":"git@github.com:bazelbuild/bazel.git","clone_url":"https://github.com/bazelbuild/bazel.git","svn_url":"https://github.com/bazelbuild/bazel","homepage":"https://bazel.build","size":990573,"stargazers_count":24742,"watchers_count":24742,"language":"Java","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":4332,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1832,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["bazel","build","build-system","correct","fast","multi-language","scalable","test"],"visibility":"public","forks":4332,"open_issues":1832,"watchers":24742,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"### Description of the bug:\r\n\r\n\r\nPer [discussion in the \"bzlmod\" channel](https://bazelbuild.slack.com/archives/C014RARENH0/p1677711749797079) of the \"Bazel\" Slack workspace, and possibly related to #17289, when I try to use [_rules_oci_'s `oci_image` rule](https://github.com/bazel-contrib/rules_oci/blob/main/docs/image.md#oci_image) in a root module (that is, in a Bazel workspace with a _MODULE.bazel_ file and with the `--enable_bzlmod` flag active), building the target fails due to Bazel claiming that there is no repository named \"platforms\" defined:\r\n```\r\nbazel build //test:image\r\nERROR: Analysis of target '//test:image' failed;\r\n       build aborted: no such package '@platforms//cpu':\r\n       The repository '@platforms' could not be resolved: Repository '@platforms' is not defined\r\n```\r\nThis error arises even when I have the following function call in my _MODULE.bazel_ file, referring to [the \"platforms\" module](https://github.com/bazelbuild/bazel-central-registry/tree/main/modules/platforms/0.0.6):\r\n```bazel\r\nbazel_dep(name = \"platforms\", version = \"0.0.6\")\r\n```\r\nIf I don't mention the \"platforms\" module's repository explicitly anywhere in my code and remove that entry from my _MODULE.bazel_ file, then Bazel fails differently, though this is not the root of my complaint here:\r\n```\r\nbazel build //test:image\r\nERROR: /private/var/tmp/.../external/yq_toolchains/BUILD.bazel:12:10:\r\n       no such package '@platforms//cpu':\r\n       The repository '@platforms' could not be resolved:\r\n       Repository '@platforms' is not defined and referenced by '@yq_toolchains//:darwin_amd64_toolchain'\r\nERROR: /.../bzlmod-platforms-test/test/BUILD.bazel:14:10:\r\n       While resolving toolchains for target //test:image:\r\n       invalid registered toolchain '@yq_toolchains//:darwin_amd64_toolchain':\r\n       Analysis failed\r\n```\r\n\r\n### What's the simplest, easiest way to reproduce this bug? Please provide a minimal example if possible.\r\n\r\n\r\nPlease find [attached here an archive of a Bazel repository](https://github.com/bazelbuild/bazel/files/10873027/bzlmod-platforms-test.tar.gz), with a root module named \"bzlmod_platforms_test.\" In the _WORKSPACE.bzlmod_ file, it uses _rules_oci_'s `oci_pull` rule to pull an OCI image from the _distroless_ project.\r\n\r\nIn the \"test\" package, there's a tiny shell program named _greet.sh_, packaged into a tar archive by _pkg_tar_, and then used as the content of an OCI image in the \"image\" target by way of the `oci_image` rule.\r\n\r\nUnpack that archive, and attempt to build the \"test:image\" target.\r\n```shell\r\ntar zxf bzlmod-platforms-test.tar.gz\r\ncd bzlmod-platforms-test\r\nbazel build //test:image\r\n``` \r\nObserve that the build fails for lack of the \"platforms\" repository (nominated in the error message as \"@platforms\").\r\n\r\n\r\n### Which operating system are you running Bazel on?\r\n\r\n\r\nmacOS 13.2.1\r\n\r\n### What is the output of `bazel info release`?\r\n\r\n\r\nrelease 6.0.0\r\n\r\n### If `bazel info release` returns `development version` or `(@non-git)`, tell us how you built Bazel.\r\n\r\n\r\n_No response_\r\n\r\n### What's the output of `git remote get-url origin; git rev-parse master; git rev-parse HEAD` ?\r\n\r\n\r\n_No response_\r\n\r\n### Have you found anything relevant by searching the web?\r\n\r\nThe use of _rules_oci_ and _pkg_tar_ is based mostly on @alexeagle's bazel-contrib/rules_oci#77, simplified here to show that I'm not even using the \"platforms\" module explicitly in my own code. In the real repository in which this problem arose, I _am_ using that module explicitly in various places, but I wanted to show that I was unable to use _pkg_tar_ and _rules_oci_ together both with and without a dependency on the \"platforms\" module. In other words, while the error message makes it _look_ like I'm missing a dependency, expressing that dependency explicitly doesn't help.\r\n\r\n### Any other information, logs, or outputs that you want to share?\r\n\r\n_No response_","reactions":{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/17655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bazelbuild/bazel/issues/17655/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"id":8697261464,"node_id":"UE_lADOATz7jc5gSO6AzwAAAAIGZa2Y","url":"https://api.github.com/repos/bazelbuild/bazel/issues/events/8697261464","actor":{"login":"keith","id":283886,"node_id":"MDQ6VXNlcjI4Mzg4Ng==","avatar_url":"https://avatars.githubusercontent.com/u/283886?v=4","gravatar_id":"","url":"https://api.github.com/users/keith","html_url":"https://github.com/keith","followers_url":"https://api.github.com/users/keith/followers","following_url":"https://api.github.com/users/keith/following{/other_user}","gists_url":"https://api.github.com/users/keith/gists{/gist_id}","starred_url":"https://api.github.com/users/keith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith/subscriptions","organizations_url":"https://api.github.com/users/keith/orgs","repos_url":"https://api.github.com/users/keith/repos","events_url":"https://api.github.com/users/keith/events{/privacy}","received_events_url":"https://api.github.com/users/keith/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unsubscribed","commit_id":null,"commit_url":null,"created_at":"2023-03-08T14:46:48Z","performed_via_github_app":null},{"id":8733495576,"node_id":"LE_lADOATz7jc5gSO6AzwAAAAIIjpEY","url":"https://api.github.com/repos/bazelbuild/bazel/issues/events/8733495576","actor":{"login":"gregestren","id":5130366,"node_id":"MDQ6VXNlcjUxMzAzNjY=","avatar_url":"https://avatars.githubusercontent.com/u/5130366?v=4","gravatar_id":"","url":"https://api.github.com/users/gregestren","html_url":"https://github.com/gregestren","followers_url":"https://api.github.com/users/gregestren/followers","following_url":"https://api.github.com/users/gregestren/following{/other_user}","gists_url":"https://api.github.com/users/gregestren/gists{/gist_id}","starred_url":"https://api.github.com/users/gregestren/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregestren/subscriptions","organizations_url":"https://api.github.com/users/gregestren/orgs","repos_url":"https://api.github.com/users/gregestren/repos","events_url":"https://api.github.com/users/gregestren/events{/privacy}","received_events_url":"https://api.github.com/users/gregestren/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-03-13T15:51:40Z","label":{"name":"bad error messaging","color":"e07d80"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/comments/1466412090","html_url":"https://github.com/bazelbuild/bazel/issues/17689#issuecomment-1466412090","issue_url":"https://api.github.com/repos/bazelbuild/bazel/issues/17689","id":1466412090,"node_id":"IC_kwDOATz7jc5XZ6w6","user":{"login":"gregestren","id":5130366,"node_id":"MDQ6VXNlcjUxMzAzNjY=","avatar_url":"https://avatars.githubusercontent.com/u/5130366?v=4","gravatar_id":"","url":"https://api.github.com/users/gregestren","html_url":"https://github.com/gregestren","followers_url":"https://api.github.com/users/gregestren/followers","following_url":"https://api.github.com/users/gregestren/following{/other_user}","gists_url":"https://api.github.com/users/gregestren/gists{/gist_id}","starred_url":"https://api.github.com/users/gregestren/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregestren/subscriptions","organizations_url":"https://api.github.com/users/gregestren/orgs","repos_url":"https://api.github.com/users/gregestren/repos","events_url":"https://api.github.com/users/gregestren/events{/privacy}","received_events_url":"https://api.github.com/users/gregestren/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T15:53:32Z","updated_at":"2023-03-13T15:53:32Z","body":"We have a long history of analysis errors not always propagating cleanly. I can't tell offhand if this is specifically about `select()` or the broader analysis error issue.\r\n\r\nEither way, good point. Agreed on the bad messaging.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/comments/1466412090/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"gregestren","id":5130366,"node_id":"MDQ6VXNlcjUxMzAzNjY=","avatar_url":"https://avatars.githubusercontent.com/u/5130366?v=4","gravatar_id":"","url":"https://api.github.com/users/gregestren","html_url":"https://github.com/gregestren","followers_url":"https://api.github.com/users/gregestren/followers","following_url":"https://api.github.com/users/gregestren/following{/other_user}","gists_url":"https://api.github.com/users/gregestren/gists{/gist_id}","starred_url":"https://api.github.com/users/gregestren/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregestren/subscriptions","organizations_url":"https://api.github.com/users/gregestren/orgs","repos_url":"https://api.github.com/users/gregestren/repos","events_url":"https://api.github.com/users/gregestren/events{/privacy}","received_events_url":"https://api.github.com/users/gregestren/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/comments/1466485323","html_url":"https://github.com/bazelbuild/bazel/issues/17689#issuecomment-1466485323","issue_url":"https://api.github.com/repos/bazelbuild/bazel/issues/17689","id":1466485323,"node_id":"IC_kwDOATz7jc5XaMpL","user":{"login":"gregestren","id":5130366,"node_id":"MDQ6VXNlcjUxMzAzNjY=","avatar_url":"https://avatars.githubusercontent.com/u/5130366?v=4","gravatar_id":"","url":"https://api.github.com/users/gregestren","html_url":"https://github.com/gregestren","followers_url":"https://api.github.com/users/gregestren/followers","following_url":"https://api.github.com/users/gregestren/following{/other_user}","gists_url":"https://api.github.com/users/gregestren/gists{/gist_id}","starred_url":"https://api.github.com/users/gregestren/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregestren/subscriptions","organizations_url":"https://api.github.com/users/gregestren/orgs","repos_url":"https://api.github.com/users/gregestren/repos","events_url":"https://api.github.com/users/gregestren/events{/privacy}","received_events_url":"https://api.github.com/users/gregestren/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T16:33:52Z","updated_at":"2023-03-13T16:33:52Z","body":"Probed a little bit. I wonder if we need to propagate the lookup error from https://github.com/bazelbuild/bazel/blob/0e6cc076b32056fe7d16fa650dabe202f4791ee2/src/main/java/com/google/devtools/build/lib/skyframe/PrerequisiteProducer.java#L529-L532 ?\r\n\r\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/comments/1466485323/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"gregestren","id":5130366,"node_id":"MDQ6VXNlcjUxMzAzNjY=","avatar_url":"https://avatars.githubusercontent.com/u/5130366?v=4","gravatar_id":"","url":"https://api.github.com/users/gregestren","html_url":"https://github.com/gregestren","followers_url":"https://api.github.com/users/gregestren/followers","following_url":"https://api.github.com/users/gregestren/following{/other_user}","gists_url":"https://api.github.com/users/gregestren/gists{/gist_id}","starred_url":"https://api.github.com/users/gregestren/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregestren/subscriptions","organizations_url":"https://api.github.com/users/gregestren/orgs","repos_url":"https://api.github.com/users/gregestren/repos","events_url":"https://api.github.com/users/gregestren/events{/privacy}","received_events_url":"https://api.github.com/users/gregestren/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":8733977131,"node_id":"LE_lADOATz7jc5gSO6AzwAAAAIIleor","url":"https://api.github.com/repos/bazelbuild/bazel/issues/events/8733977131","actor":{"login":"gregestren","id":5130366,"node_id":"MDQ6VXNlcjUxMzAzNjY=","avatar_url":"https://avatars.githubusercontent.com/u/5130366?v=4","gravatar_id":"","url":"https://api.github.com/users/gregestren","html_url":"https://github.com/gregestren","followers_url":"https://api.github.com/users/gregestren/followers","following_url":"https://api.github.com/users/gregestren/following{/other_user}","gists_url":"https://api.github.com/users/gregestren/gists{/gist_id}","starred_url":"https://api.github.com/users/gregestren/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregestren/subscriptions","organizations_url":"https://api.github.com/users/gregestren/orgs","repos_url":"https://api.github.com/users/gregestren/repos","events_url":"https://api.github.com/users/gregestren/events{/privacy}","received_events_url":"https://api.github.com/users/gregestren/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-03-13T16:35:33Z","label":{"name":"P2","color":"e99695"},"performed_via_github_app":null},{"id":8733978412,"node_id":"UNLE_lADOATz7jc5gSO6AzwAAAAIIle8s","url":"https://api.github.com/repos/bazelbuild/bazel/issues/events/8733978412","actor":{"login":"gregestren","id":5130366,"node_id":"MDQ6VXNlcjUxMzAzNjY=","avatar_url":"https://avatars.githubusercontent.com/u/5130366?v=4","gravatar_id":"","url":"https://api.github.com/users/gregestren","html_url":"https://github.com/gregestren","followers_url":"https://api.github.com/users/gregestren/followers","following_url":"https://api.github.com/users/gregestren/following{/other_user}","gists_url":"https://api.github.com/users/gregestren/gists{/gist_id}","starred_url":"https://api.github.com/users/gregestren/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregestren/subscriptions","organizations_url":"https://api.github.com/users/gregestren/orgs","repos_url":"https://api.github.com/users/gregestren/repos","events_url":"https://api.github.com/users/gregestren/events{/privacy}","received_events_url":"https://api.github.com/users/gregestren/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2023-03-13T16:35:41Z","label":{"name":"untriaged","color":"c34ddd"},"performed_via_github_app":null},{"actor":{"login":"Wyverald","id":453203,"node_id":"MDQ6VXNlcjQ1MzIwMw==","avatar_url":"https://avatars.githubusercontent.com/u/453203?v=4","gravatar_id":"","url":"https://api.github.com/users/Wyverald","html_url":"https://github.com/Wyverald","followers_url":"https://api.github.com/users/Wyverald/followers","following_url":"https://api.github.com/users/Wyverald/following{/other_user}","gists_url":"https://api.github.com/users/Wyverald/gists{/gist_id}","starred_url":"https://api.github.com/users/Wyverald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wyverald/subscriptions","organizations_url":"https://api.github.com/users/Wyverald/orgs","repos_url":"https://api.github.com/users/Wyverald/repos","events_url":"https://api.github.com/users/Wyverald/events{/privacy}","received_events_url":"https://api.github.com/users/Wyverald/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-10T15:25:39Z","updated_at":"2023-05-10T15:25:39Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/bazel-contrib/rules_oci/issues/234","repository_url":"https://api.github.com/repos/bazel-contrib/rules_oci","labels_url":"https://api.github.com/repos/bazel-contrib/rules_oci/issues/234/labels{/name}","comments_url":"https://api.github.com/repos/bazel-contrib/rules_oci/issues/234/comments","events_url":"https://api.github.com/repos/bazel-contrib/rules_oci/issues/234/events","html_url":"https://github.com/bazel-contrib/rules_oci/pull/234","id":1703917222,"node_id":"PR_kwDOGgrN6M5QMWXU","number":234,"title":"try fix","user":{"login":"Wyverald","id":453203,"node_id":"MDQ6VXNlcjQ1MzIwMw==","avatar_url":"https://avatars.githubusercontent.com/u/453203?v=4","gravatar_id":"","url":"https://api.github.com/users/Wyverald","html_url":"https://github.com/Wyverald","followers_url":"https://api.github.com/users/Wyverald/followers","following_url":"https://api.github.com/users/Wyverald/following{/other_user}","gists_url":"https://api.github.com/users/Wyverald/gists{/gist_id}","starred_url":"https://api.github.com/users/Wyverald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wyverald/subscriptions","organizations_url":"https://api.github.com/users/Wyverald/orgs","repos_url":"https://api.github.com/users/Wyverald/repos","events_url":"https://api.github.com/users/Wyverald/events{/privacy}","received_events_url":"https://api.github.com/users/Wyverald/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2023-05-10T13:17:05Z","updated_at":"2023-05-10T17:57:09Z","closed_at":"2023-05-10T17:57:05Z","author_association":"NONE","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":436915688,"node_id":"R_kgDOGgrN6A","name":"rules_oci","full_name":"bazel-contrib/rules_oci","private":false,"owner":{"login":"bazel-contrib","id":91752542,"node_id":"O_kgDOBXgIXg","avatar_url":"https://avatars.githubusercontent.com/u/91752542?v=4","gravatar_id":"","url":"https://api.github.com/users/bazel-contrib","html_url":"https://github.com/bazel-contrib","followers_url":"https://api.github.com/users/bazel-contrib/followers","following_url":"https://api.github.com/users/bazel-contrib/following{/other_user}","gists_url":"https://api.github.com/users/bazel-contrib/gists{/gist_id}","starred_url":"https://api.github.com/users/bazel-contrib/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bazel-contrib/subscriptions","organizations_url":"https://api.github.com/users/bazel-contrib/orgs","repos_url":"https://api.github.com/users/bazel-contrib/repos","events_url":"https://api.github.com/users/bazel-contrib/events{/privacy}","received_events_url":"https://api.github.com/users/bazel-contrib/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/bazel-contrib/rules_oci","description":"Bazel rules for building OCI containers","fork":false,"url":"https://api.github.com/repos/bazel-contrib/rules_oci","forks_url":"https://api.github.com/repos/bazel-contrib/rules_oci/forks","keys_url":"https://api.github.com/repos/bazel-contrib/rules_oci/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bazel-contrib/rules_oci/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bazel-contrib/rules_oci/teams","hooks_url":"https://api.github.com/repos/bazel-contrib/rules_oci/hooks","issue_events_url":"https://api.github.com/repos/bazel-contrib/rules_oci/issues/events{/number}","events_url":"https://api.github.com/repos/bazel-contrib/rules_oci/events","assignees_url":"https://api.github.com/repos/bazel-contrib/rules_oci/assignees{/user}","branches_url":"https://api.github.com/repos/bazel-contrib/rules_oci/branches{/branch}","tags_url":"https://api.github.com/repos/bazel-contrib/rules_oci/tags","blobs_url":"https://api.github.com/repos/bazel-contrib/rules_oci/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bazel-contrib/rules_oci/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bazel-contrib/rules_oci/git/refs{/sha}","trees_url":"https://api.github.com/repos/bazel-contrib/rules_oci/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bazel-contrib/rules_oci/statuses/{sha}","languages_url":"https://api.github.com/repos/bazel-contrib/rules_oci/languages","stargazers_url":"https://api.github.com/repos/bazel-contrib/rules_oci/stargazers","contributors_url":"https://api.github.com/repos/bazel-contrib/rules_oci/contributors","subscribers_url":"https://api.github.com/repos/bazel-contrib/rules_oci/subscribers","subscription_url":"https://api.github.com/repos/bazel-contrib/rules_oci/subscription","commits_url":"https://api.github.com/repos/bazel-contrib/rules_oci/commits{/sha}","git_commits_url":"https://api.github.com/repos/bazel-contrib/rules_oci/git/commits{/sha}","comments_url":"https://api.github.com/repos/bazel-contrib/rules_oci/comments{/number}","issue_comment_url":"https://api.github.com/repos/bazel-contrib/rules_oci/issues/comments{/number}","contents_url":"https://api.github.com/repos/bazel-contrib/rules_oci/contents/{+path}","compare_url":"https://api.github.com/repos/bazel-contrib/rules_oci/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bazel-contrib/rules_oci/merges","archive_url":"https://api.github.com/repos/bazel-contrib/rules_oci/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bazel-contrib/rules_oci/downloads","issues_url":"https://api.github.com/repos/bazel-contrib/rules_oci/issues{/number}","pulls_url":"https://api.github.com/repos/bazel-contrib/rules_oci/pulls{/number}","milestones_url":"https://api.github.com/repos/bazel-contrib/rules_oci/milestones{/number}","notifications_url":"https://api.github.com/repos/bazel-contrib/rules_oci/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bazel-contrib/rules_oci/labels{/name}","releases_url":"https://api.github.com/repos/bazel-contrib/rules_oci/releases{/id}","deployments_url":"https://api.github.com/repos/bazel-contrib/rules_oci/deployments","created_at":"2021-12-10T09:06:52Z","updated_at":"2025-11-08T16:51:45Z","pushed_at":"2025-11-07T18:45:44Z","git_url":"git://github.com/bazel-contrib/rules_oci.git","ssh_url":"git@github.com:bazel-contrib/rules_oci.git","clone_url":"https://github.com/bazel-contrib/rules_oci.git","svn_url":"https://github.com/bazel-contrib/rules_oci","homepage":"https://registry.build/github/bazel-contrib/rules_oci","size":5011,"stargazers_count":394,"watchers_count":394,"language":"Starlark","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":191,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":69,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["aspect-build","containers","docker","oci"],"visibility":"public","forks":191,"open_issues":69,"watchers":394,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/bazel-contrib/rules_oci/pulls/234","html_url":"https://github.com/bazel-contrib/rules_oci/pull/234","diff_url":"https://github.com/bazel-contrib/rules_oci/pull/234.diff","patch_url":"https://github.com/bazel-contrib/rules_oci/pull/234.patch","merged_at":null},"body":"https://github.com/bazel-contrib/rules_oci/pull/227, but with WORKSPACE copied to WORKSPACE.bzlmod","reactions":{"url":"https://api.github.com/repos/bazel-contrib/rules_oci/issues/234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bazel-contrib/rules_oci/issues/234/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"fmeum","id":4312191,"node_id":"MDQ6VXNlcjQzMTIxOTE=","avatar_url":"https://avatars.githubusercontent.com/u/4312191?v=4","gravatar_id":"","url":"https://api.github.com/users/fmeum","html_url":"https://github.com/fmeum","followers_url":"https://api.github.com/users/fmeum/followers","following_url":"https://api.github.com/users/fmeum/following{/other_user}","gists_url":"https://api.github.com/users/fmeum/gists{/gist_id}","starred_url":"https://api.github.com/users/fmeum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmeum/subscriptions","organizations_url":"https://api.github.com/users/fmeum/orgs","repos_url":"https://api.github.com/users/fmeum/repos","events_url":"https://api.github.com/users/fmeum/events{/privacy}","received_events_url":"https://api.github.com/users/fmeum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T12:28:29Z","updated_at":"2023-05-19T12:28:29Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/18454","repository_url":"https://api.github.com/repos/bazelbuild/bazel","labels_url":"https://api.github.com/repos/bazelbuild/bazel/issues/18454/labels{/name}","comments_url":"https://api.github.com/repos/bazelbuild/bazel/issues/18454/comments","events_url":"https://api.github.com/repos/bazelbuild/bazel/issues/18454/events","html_url":"https://github.com/bazelbuild/bazel/pull/18454","id":1717170617,"node_id":"PR_kwDOATz7jc5Q42e3","number":18454,"title":"Improve error message if `select` references non-existent package","user":{"login":"fmeum","id":4312191,"node_id":"MDQ6VXNlcjQzMTIxOTE=","avatar_url":"https://avatars.githubusercontent.com/u/4312191?v=4","gravatar_id":"","url":"https://api.github.com/users/fmeum","html_url":"https://github.com/fmeum","followers_url":"https://api.github.com/users/fmeum/followers","following_url":"https://api.github.com/users/fmeum/following{/other_user}","gists_url":"https://api.github.com/users/fmeum/gists{/gist_id}","starred_url":"https://api.github.com/users/fmeum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmeum/subscriptions","organizations_url":"https://api.github.com/users/fmeum/orgs","repos_url":"https://api.github.com/users/fmeum/repos","events_url":"https://api.github.com/users/fmeum/events{/privacy}","received_events_url":"https://api.github.com/users/fmeum/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1020660688,"node_id":"MDU6TGFiZWwxMDIwNjYwNjg4","url":"https://api.github.com/repos/bazelbuild/bazel/labels/team-Configurability","name":"team-Configurability","color":"f1f442","default":false,"description":"platforms, toolchains, cquery, select(), config transitions"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2023-05-19T12:28:17Z","updated_at":"2023-06-23T18:59:41Z","closed_at":"2023-05-20T05:33:04Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":20773773,"node_id":"MDEwOlJlcG9zaXRvcnkyMDc3Mzc3Mw==","name":"bazel","full_name":"bazelbuild/bazel","private":false,"owner":{"login":"bazelbuild","id":11684617,"node_id":"MDEyOk9yZ2FuaXphdGlvbjExNjg0NjE3","avatar_url":"https://avatars.githubusercontent.com/u/11684617?v=4","gravatar_id":"","url":"https://api.github.com/users/bazelbuild","html_url":"https://github.com/bazelbuild","followers_url":"https://api.github.com/users/bazelbuild/followers","following_url":"https://api.github.com/users/bazelbuild/following{/other_user}","gists_url":"https://api.github.com/users/bazelbuild/gists{/gist_id}","starred_url":"https://api.github.com/users/bazelbuild/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bazelbuild/subscriptions","organizations_url":"https://api.github.com/users/bazelbuild/orgs","repos_url":"https://api.github.com/users/bazelbuild/repos","events_url":"https://api.github.com/users/bazelbuild/events{/privacy}","received_events_url":"https://api.github.com/users/bazelbuild/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/bazelbuild/bazel","description":"a fast, scalable, multi-language and extensible build system","fork":false,"url":"https://api.github.com/repos/bazelbuild/bazel","forks_url":"https://api.github.com/repos/bazelbuild/bazel/forks","keys_url":"https://api.github.com/repos/bazelbuild/bazel/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bazelbuild/bazel/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bazelbuild/bazel/teams","hooks_url":"https://api.github.com/repos/bazelbuild/bazel/hooks","issue_events_url":"https://api.github.com/repos/bazelbuild/bazel/issues/events{/number}","events_url":"https://api.github.com/repos/bazelbuild/bazel/events","assignees_url":"https://api.github.com/repos/bazelbuild/bazel/assignees{/user}","branches_url":"https://api.github.com/repos/bazelbuild/bazel/branches{/branch}","tags_url":"https://api.github.com/repos/bazelbuild/bazel/tags","blobs_url":"https://api.github.com/repos/bazelbuild/bazel/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bazelbuild/bazel/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bazelbuild/bazel/git/refs{/sha}","trees_url":"https://api.github.com/repos/bazelbuild/bazel/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bazelbuild/bazel/statuses/{sha}","languages_url":"https://api.github.com/repos/bazelbuild/bazel/languages","stargazers_url":"https://api.github.com/repos/bazelbuild/bazel/stargazers","contributors_url":"https://api.github.com/repos/bazelbuild/bazel/contributors","subscribers_url":"https://api.github.com/repos/bazelbuild/bazel/subscribers","subscription_url":"https://api.github.com/repos/bazelbuild/bazel/subscription","commits_url":"https://api.github.com/repos/bazelbuild/bazel/commits{/sha}","git_commits_url":"https://api.github.com/repos/bazelbuild/bazel/git/commits{/sha}","comments_url":"https://api.github.com/repos/bazelbuild/bazel/comments{/number}","issue_comment_url":"https://api.github.com/repos/bazelbuild/bazel/issues/comments{/number}","contents_url":"https://api.github.com/repos/bazelbuild/bazel/contents/{+path}","compare_url":"https://api.github.com/repos/bazelbuild/bazel/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bazelbuild/bazel/merges","archive_url":"https://api.github.com/repos/bazelbuild/bazel/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bazelbuild/bazel/downloads","issues_url":"https://api.github.com/repos/bazelbuild/bazel/issues{/number}","pulls_url":"https://api.github.com/repos/bazelbuild/bazel/pulls{/number}","milestones_url":"https://api.github.com/repos/bazelbuild/bazel/milestones{/number}","notifications_url":"https://api.github.com/repos/bazelbuild/bazel/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bazelbuild/bazel/labels{/name}","releases_url":"https://api.github.com/repos/bazelbuild/bazel/releases{/id}","deployments_url":"https://api.github.com/repos/bazelbuild/bazel/deployments","created_at":"2014-06-12T16:00:38Z","updated_at":"2025-11-10T01:33:52Z","pushed_at":"2025-11-08T01:50:45Z","git_url":"git://github.com/bazelbuild/bazel.git","ssh_url":"git@github.com:bazelbuild/bazel.git","clone_url":"https://github.com/bazelbuild/bazel.git","svn_url":"https://github.com/bazelbuild/bazel","homepage":"https://bazel.build","size":990573,"stargazers_count":24742,"watchers_count":24742,"language":"Java","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":4332,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1832,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["bazel","build","build-system","correct","fast","multi-language","scalable","test"],"visibility":"public","forks":4332,"open_issues":1832,"watchers":24742,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/bazelbuild/bazel/pulls/18454","html_url":"https://github.com/bazelbuild/bazel/pull/18454","diff_url":"https://github.com/bazelbuild/bazel/pull/18454.diff","patch_url":"https://github.com/bazelbuild/bazel/pull/18454.patch","merged_at":null},"body":"If a key in a `select` references a package that does not exist, the error message now includes a reference to the target with the `select`:\r\n\r\n```\r\nERROR: no such package 'hello/c': BUILD file not found in any of the following directories. Add a BUILD file to a directory to mark it as a package.\r\n - /tmp/bazel-crash/hello/c\r\nERROR: /tmp/bazel-crash/hello/b/BUILD:1:13: errors encountered resolving select() keys for //hello/b:b\r\nERROR: Analysis of target '//hello/a:a' failed; build aborted\r\n```\r\n\r\nPreviously, it didn't:\r\n```\r\nERROR: Analysis of target '//hello/a:a' failed; build aborted: no such package 'hello/c': BUILD file not found in any of the following directories. Add a BUILD file to a directory to mark it as a package.\r\n - /tmp/bazel-crash/hello/c\r\n```\r\n\r\nFixes #17689","reactions":{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/18454/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bazelbuild/bazel/issues/18454/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":9293849108,"node_id":"CE_lADOATz7jc5gSO6AzwAAAAIp9OIU","url":"https://api.github.com/repos/bazelbuild/bazel/issues/events/9293849108","actor":{"login":"copybara-service[bot]","id":56741989,"node_id":"MDM6Qm90NTY3NDE5ODk=","avatar_url":"https://avatars.githubusercontent.com/in/44061?v=4","gravatar_id":"","url":"https://api.github.com/users/copybara-service%5Bbot%5D","html_url":"https://github.com/apps/copybara-service","followers_url":"https://api.github.com/users/copybara-service%5Bbot%5D/followers","following_url":"https://api.github.com/users/copybara-service%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/copybara-service%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/copybara-service%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/copybara-service%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/copybara-service%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/copybara-service%5Bbot%5D/repos","events_url":"https://api.github.com/users/copybara-service%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/copybara-service%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"665a3241f4acf2291d157c76a413d872ae59241e","commit_url":"https://api.github.com/repos/bazelbuild/bazel/commits/665a3241f4acf2291d157c76a413d872ae59241e","created_at":"2023-05-20T05:33:04Z","state_reason":null,"performed_via_github_app":null},{"id":9341178005,"node_id":"REFE_lADOATz7jc5gSO6AzwAAAAIsxxCV","url":"https://api.github.com/repos/bazelbuild/bazel/issues/events/9341178005","actor":{"login":"fweikert","id":12609729,"node_id":"MDQ6VXNlcjEyNjA5NzI5","avatar_url":"https://avatars.githubusercontent.com/u/12609729?v=4","gravatar_id":"","url":"https://api.github.com/users/fweikert","html_url":"https://github.com/fweikert","followers_url":"https://api.github.com/users/fweikert/followers","following_url":"https://api.github.com/users/fweikert/following{/other_user}","gists_url":"https://api.github.com/users/fweikert/gists{/gist_id}","starred_url":"https://api.github.com/users/fweikert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fweikert/subscriptions","organizations_url":"https://api.github.com/users/fweikert/orgs","repos_url":"https://api.github.com/users/fweikert/repos","events_url":"https://api.github.com/users/fweikert/events{/privacy}","received_events_url":"https://api.github.com/users/fweikert/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"0bdee2cb95a112594bc65fb95c29e39883d311cf","commit_url":"https://api.github.com/repos/fweikert/bazel/commits/0bdee2cb95a112594bc65fb95c29e39883d311cf","created_at":"2023-05-25T14:58:00Z","performed_via_github_app":null}]