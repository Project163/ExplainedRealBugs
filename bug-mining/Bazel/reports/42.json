{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/17483","repository_url":"https://api.github.com/repos/bazelbuild/bazel","labels_url":"https://api.github.com/repos/bazelbuild/bazel/issues/17483/labels{/name}","comments_url":"https://api.github.com/repos/bazelbuild/bazel/issues/17483/comments","events_url":"https://api.github.com/repos/bazelbuild/bazel/issues/17483/events","html_url":"https://github.com/bazelbuild/bazel/issues/17483","id":1583236353,"node_id":"I_kwDOATz7jc5eXkUB","number":17483,"title":"`repr` representation of starlarkified rules is too generic","user":{"login":"gholms","id":92943,"node_id":"MDQ6VXNlcjkyOTQz","avatar_url":"https://avatars.githubusercontent.com/u/92943?v=4","gravatar_id":"","url":"https://api.github.com/users/gholms","html_url":"https://github.com/gholms","followers_url":"https://api.github.com/users/gholms/followers","following_url":"https://api.github.com/users/gholms/following{/other_user}","gists_url":"https://api.github.com/users/gholms/gists{/gist_id}","starred_url":"https://api.github.com/users/gholms/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gholms/subscriptions","organizations_url":"https://api.github.com/users/gholms/orgs","repos_url":"https://api.github.com/users/gholms/repos","events_url":"https://api.github.com/users/gholms/events{/privacy}","received_events_url":"https://api.github.com/users/gholms/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":106503259,"node_id":"MDU6TGFiZWwxMDY1MDMyNTk=","url":"https://api.github.com/repos/bazelbuild/bazel/labels/type:%20bug","name":"type: bug","color":"0052cc","default":false,"description":null},{"id":192364241,"node_id":"MDU6TGFiZWwxOTIzNjQyNDE=","url":"https://api.github.com/repos/bazelbuild/bazel/labels/P3","name":"P3","color":"fbca04","default":false,"description":"We're not considering working on this, but happy to review a PR. (No assignee)"},{"id":4761858692,"node_id":"LA_kwDOATz7jc8AAAABG9QyhA","url":"https://api.github.com/repos/bazelbuild/bazel/labels/team-Rules-API","name":"team-Rules-API","color":"f1f442","default":false,"description":"API for writing rules/aspects: providers, runfiles, actions, artifacts"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2023-02-13T23:35:58Z","updated_at":"2023-09-20T18:17:34Z","closed_at":"2023-06-07T12:31:44Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description of the bug:\n\n\nRunning `str` on a built-in rule function written in java, such as `py_library`, returns strings like `<built-in rule py_library>`, while for one whose implementation has been rewritten in starlark, such as `cc_library`, it merely returns `<rule>`.  Upgrading from Bazel 4 to 6 broke some of our macros which take those functions as inputs and make decisions based on what rules they correspond to.  Given such a function, there no longer seems to be a way to determine the name of the rule to which it corresponds.  One can work around it by explicitly comparing things against `native.cc_library` and so on, but the difference in output seems like an unintended regression.  Preferably, the string representations of internal starlarkified rules should somehow expose the rules' names, but another generic means of determining the names of arbitrary rules would suffice instead.\n\n### What's the simplest, easiest way to reproduce this bug? Please provide a minimal example if possible.\n\n\nCompare the outputs of `str(cc_library)` and `str(py_library)` using Bazel 6, which are `<rule>` and `<built-in rule py_binary>` respectively.\n\n### Which operating system are you running Bazel on?\n\n\nUbuntu\n\n### What is the output of `bazel info release`?\n\n\nrelease 6.0.0\n\n### If `bazel info release` returns `development version` or `(@non-git)`, tell us how you built Bazel.\n\n\n_No response_\n\n### What's the output of `git remote get-url origin; git rev-parse master; git rev-parse HEAD` ?\n\n\n_No response_\n\n### Have you found anything relevant by searching the web?\n\n_No response_\n\n### Any other information, logs, or outputs that you want to share?\n\n_No response_","closed_by":{"login":"copybara-service[bot]","id":56741989,"node_id":"MDM6Qm90NTY3NDE5ODk=","avatar_url":"https://avatars.githubusercontent.com/in/44061?v=4","gravatar_id":"","url":"https://api.github.com/users/copybara-service%5Bbot%5D","html_url":"https://github.com/apps/copybara-service","followers_url":"https://api.github.com/users/copybara-service%5Bbot%5D/followers","following_url":"https://api.github.com/users/copybara-service%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/copybara-service%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/copybara-service%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/copybara-service%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/copybara-service%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/copybara-service%5Bbot%5D/repos","events_url":"https://api.github.com/users/copybara-service%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/copybara-service%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bazelbuild/bazel/issues/17483/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bazelbuild/bazel/issues/17483/timeline","performed_via_github_app":null,"state_reason":"completed"}