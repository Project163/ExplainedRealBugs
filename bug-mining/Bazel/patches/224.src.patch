diff --git a/src/main/java/com/google/devtools/build/lib/unix/UnixFileSystem.java b/src/main/java/com/google/devtools/build/lib/unix/UnixFileSystem.java
index 49f2ce2a39..dc0eaaa666 100644
--- a/src/main/java/com/google/devtools/build/lib/unix/UnixFileSystem.java
+++ b/src/main/java/com/google/devtools/build/lib/unix/UnixFileSystem.java
@@ -355,9 +355,10 @@ public class UnixFileSystem extends AbstractFileSystemWithCustomStat {
   public boolean createDirectory(PathFragment path) throws IOException {
     var comp = Blocker.begin();
     try {
+      // Use 0777 so that the permissions can be overridden by umask(2).
       // Note: UNIX mkdir(2), FilesystemUtils.mkdir() and createDirectory all
       // have different ways of representing failure!
-      if (NativePosixFiles.mkdir(path.toString(), 0755)) {
+      if (NativePosixFiles.mkdir(path.toString(), 0777)) {
         return true; // successfully created
       }
     } finally {
@@ -386,7 +387,8 @@ public class UnixFileSystem extends AbstractFileSystemWithCustomStat {
   public void createDirectoryAndParents(PathFragment path) throws IOException {
     var comp = Blocker.begin();
     try {
-      NativePosixFiles.mkdirs(path.toString(), 0755);
+      // Use 0777 so that the permissions can be overridden by umask(2).
+      NativePosixFiles.mkdirs(path.toString(), 0777);
     } finally {
       Blocker.end(comp);
     }
diff --git a/src/main/java/com/google/devtools/build/lib/vfs/FileSystem.java b/src/main/java/com/google/devtools/build/lib/vfs/FileSystem.java
index 2ce3e58454..7685a6ebcf 100644
--- a/src/main/java/com/google/devtools/build/lib/vfs/FileSystem.java
+++ b/src/main/java/com/google/devtools/build/lib/vfs/FileSystem.java
@@ -198,7 +198,7 @@ public abstract class FileSystem {
       throw new IOException(path + " (Not a directory)");
     }
 
-    chmod(path, 0755);
+    chmod(path, 0777);
     return false;
   }
 
diff --git a/src/main/native/unix_jni.cc b/src/main/native/unix_jni.cc
index c05d54dc65..acdbef5c83 100644
--- a/src/main/native/unix_jni.cc
+++ b/src/main/native/unix_jni.cc
@@ -581,20 +581,25 @@ Java_com_google_devtools_build_lib_unix_NativePosixFiles_mkdirWritable(
       PostException(env, errno, path_chars);
       return false;
     }
-    // directory does not exist.
-    if (::mkdir(path_chars, 0755) == -1) {
+    // Directory does not exist.
+    // Use 0777 so that the permissions can be overridden by umask(2).
+    if (::mkdir(path_chars, 0777) == -1) {
       PostException(env, errno, path_chars);
     }
     return true;
   }
-  // path already exists
+  // Path already exists, but might not be a directory.
   if (!S_ISDIR(statbuf.st_mode)) {
     PostException(env, ENOTDIR, path_chars);
     return false;
   }
-  // Make sure the mode is correct.
-  if ((statbuf.st_mode & 0755) != 0755 && ::chmod(path_chars, 0755) == -1) {
-    PostException(env, errno, path_chars);
+  // Make sure the permissions are correct.
+  // Avoid touching permissions for group/other, which may have been overridden
+  // by umask(2) when this directory was originally created.
+  if ((statbuf.st_mode & S_IRWXU) != S_IRWXU) {
+    if (::chmod(path_chars, statbuf.st_mode | S_IRWXU) == -1) {
+      PostException(env, errno, path_chars);
+    }
   }
   return false;
 }
