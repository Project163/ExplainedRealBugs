diff --git a/src/main/java/com/google/devtools/build/lib/rules/cpp/CcLinkingHelper.java b/src/main/java/com/google/devtools/build/lib/rules/cpp/CcLinkingHelper.java
index 58e697645c..3ac8de6973 100644
--- a/src/main/java/com/google/devtools/build/lib/rules/cpp/CcLinkingHelper.java
+++ b/src/main/java/com/google/devtools/build/lib/rules/cpp/CcLinkingHelper.java
@@ -694,7 +694,8 @@ public final class CcLinkingHelper {
                 "-Wl,-soname="
                     + SolibSymlinkAction.getDynamicLibrarySoname(
                         linkerOutput.getRootRelativePath(),
-                        /* preserveName= */ false,
+                        /* preserveName= */ dynamicLinkType
+                            != LinkTargetType.NODEPS_DYNAMIC_LIBRARY,
                         actionConstructionContext.getConfiguration().getMnemonic()));
       }
     }
@@ -799,6 +800,10 @@ public final class CcLinkingHelper {
     if (dynamicLinkActionBuilder.getAllLtoBackendArtifacts() != null) {
       ccLinkingOutputs.addAllLtoArtifacts(dynamicLinkActionBuilder.getAllLtoBackendArtifacts());
     }
+    Artifact implLibraryLinkArtifact = getDynamicLibrarySolibSymlinkOutput(linkerOutput);
+    if (implLibraryLinkArtifact != null) {
+      dynamicLinkActionBuilder.setDynamicLibrarySolibSymlinkOutput(implLibraryLinkArtifact);
+    }
     CppLinkAction dynamicLinkAction = dynamicLinkActionBuilder.build();
     if (dynamicLinkType.isExecutable()) {
       ccLinkingOutputs.setExecutable(linkerOutput);
@@ -824,14 +829,16 @@ public final class CcLinkingHelper {
         }
         libraryToLinkBuilder.setDynamicLibrary(dynamicLibrary.getArtifact());
       } else {
-        Artifact implLibraryLinkArtifact =
-            SolibSymlinkAction.getDynamicLibrarySymlink(
-                /* actionRegistry= */ actionRegistry,
-                /* actionConstructionContext= */ actionConstructionContext,
-                ccToolchain.getSolibDirectory(),
-                dynamicLibrary.getArtifact(),
-                /* preserveName= */ false,
-                /* prefixConsumer= */ false);
+        if (dynamicLinkType == LinkTargetType.NODEPS_DYNAMIC_LIBRARY) {
+          implLibraryLinkArtifact =
+              SolibSymlinkAction.getDynamicLibrarySymlink(
+                  /* actionRegistry= */ actionRegistry,
+                  /* actionConstructionContext= */ actionConstructionContext,
+                  ccToolchain.getSolibDirectory(),
+                  dynamicLibrary.getArtifact(),
+                  /* preserveName= */ false,
+                  /* prefixConsumer= */ false);
+        }
         libraryToLinkBuilder.setDynamicLibrary(implLibraryLinkArtifact);
         libraryToLinkBuilder.setResolvedSymlinkDynamicLibrary(dynamicLibrary.getArtifact());
 
@@ -842,7 +849,8 @@ public final class CcLinkingHelper {
                   /* actionConstructionContext= */ actionConstructionContext,
                   ccToolchain.getSolibDirectory(),
                   interfaceLibrary.getArtifact(),
-                  /* preserveName= */ false,
+                  // Need to preserve name for transitive shared libraries that may be distributed.
+                  /* preserveName= */ dynamicLinkType != LinkTargetType.NODEPS_DYNAMIC_LIBRARY,
                   /* prefixConsumer= */ false);
           libraryToLinkBuilder.setInterfaceLibrary(libraryLinkArtifact);
           libraryToLinkBuilder.setResolvedSymlinkInterfaceLibrary(interfaceLibrary.getArtifact());
@@ -1001,4 +1009,24 @@ public final class CcLinkingHelper {
     }
     return librariesToLinkBuilder.build();
   }
+
+  @Nullable
+  private Artifact getDynamicLibrarySolibSymlinkOutput(Artifact linkerOutputArtifact) {
+    if (dynamicLinkType != LinkTargetType.DYNAMIC_LIBRARY
+        || neverlink
+        || featureConfiguration.isEnabled(CppRuleClasses.COPY_DYNAMIC_LIBRARIES_TO_BINARY)) {
+      return null;
+    }
+    return SolibSymlinkAction.getDynamicLibrarySymlink(
+        /* actionRegistry= */ actionRegistry,
+        /* actionConstructionContext= */ actionConstructionContext,
+        ccToolchain.getSolibDirectory(),
+        linkerOutputArtifact,
+        // For transitive shared libraries we want to preserve the name of the original library so
+        // that distribution artifacts can be linked against it and not against the mangled name.
+        // This makes it possible to find the library on the system if the RPATH has been set
+        // properly.
+        /* preserveName= */ true,
+        /* prefixConsumer= */ false);
+  }
 }
diff --git a/src/main/java/com/google/devtools/build/lib/rules/cpp/CppLinkActionBuilder.java b/src/main/java/com/google/devtools/build/lib/rules/cpp/CppLinkActionBuilder.java
index f364008afd..0140fc1fa8 100644
--- a/src/main/java/com/google/devtools/build/lib/rules/cpp/CppLinkActionBuilder.java
+++ b/src/main/java/com/google/devtools/build/lib/rules/cpp/CppLinkActionBuilder.java
@@ -147,6 +147,10 @@ public class CppLinkActionBuilder {
   private boolean isStampingEnabled;
   private final Map<String, String> executionInfo = new LinkedHashMap<>();
 
+  // We have to add the dynamicLibrarySolibOutput to the CppLinkActionBuilder so that it knows how
+  // to set up the RPATH properly with respect to the symlink itself and not the original library.
+  private Artifact dynamicLibrarySolibSymlinkOutput;
+
   /**
    * Creates a builder that builds {@link CppLinkAction}s.
    *
@@ -814,7 +818,8 @@ public class CppLinkActionBuilder {
             nonExpandedLinkerInputs,
             needWholeArchive,
             ruleErrorConsumer,
-            ((RuleContext) actionConstructionContext).getWorkspaceName());
+            ((RuleContext) actionConstructionContext).getWorkspaceName(),
+            dynamicLibrarySolibSymlinkOutput);
     CollectedLibrariesToLink collectedLibrariesToLink =
         librariesToLinkCollector.collectLibrariesToLink();
 
@@ -831,13 +836,6 @@ public class CppLinkActionBuilder {
         userLinkFlags.addAll(cppConfiguration.getLtoIndexOptions());
       }
 
-      NestedSet<String> runtimeLibrarySearchDirectories =
-          collectedLibrariesToLink.getRuntimeLibrarySearchDirectories();
-      if (linkType.getActionName().equals(CppActionNames.CPP_LINK_DYNAMIC_LIBRARY)
-          && featureConfiguration.isEnabled(
-              CppRuleClasses.EXCLUDE_BAZEL_RPATHS_IN_TRANSITIVE_LIBS_FEATURE_NAME)) {
-        runtimeLibrarySearchDirectories = null;
-      }
       variables =
           LinkBuildVariables.setupVariables(
               ((RuleContext) actionConstructionContext).getStarlarkThread(),
@@ -865,7 +863,7 @@ public class CppLinkActionBuilder {
               ltoOutputRootPrefix,
               defFile != null ? defFile.getExecPathString() : null,
               fdoContext,
-              runtimeLibrarySearchDirectories,
+              collectedLibrariesToLink.getRuntimeLibrarySearchDirectories(),
               collectedLibrariesToLink.getLibrariesToLink(),
               collectedLibrariesToLink.getLibrarySearchDirectories(),
               /* addIfsoRelatedVariables= */ true);
@@ -1563,4 +1561,11 @@ public class CppLinkActionBuilder {
     this.executionInfo.putAll(executionInfo);
     return this;
   }
+
+  @CanIgnoreReturnValue
+  public CppLinkActionBuilder setDynamicLibrarySolibSymlinkOutput(
+      Artifact dynamicLibrarySolibSymlinkOutput) {
+    this.dynamicLibrarySolibSymlinkOutput = dynamicLibrarySolibSymlinkOutput;
+    return this;
+  }
 }
diff --git a/src/main/java/com/google/devtools/build/lib/rules/cpp/CppRuleClasses.java b/src/main/java/com/google/devtools/build/lib/rules/cpp/CppRuleClasses.java
index fab3d348f4..89289d652c 100644
--- a/src/main/java/com/google/devtools/build/lib/rules/cpp/CppRuleClasses.java
+++ b/src/main/java/com/google/devtools/build/lib/rules/cpp/CppRuleClasses.java
@@ -517,37 +517,6 @@ public class CppRuleClasses {
    */
   public static final String LEGACY_IS_CC_TEST_FEATURE_NAME = "legacy_is_cc_test";
 
-  /**
-   * By default Bazel will be embed runtime search directories (RPATHS) in transitive shared
-   * libraries, however, for Linux they are wrong in most cases since the runfiles directory where
-   * the transitive shared library will live will not be known at the time of linking. The runfiles
-   * directory is decided by dependent rules, we don't know where those dependents will live. For
-   * Mac (where it works differently by searching from the library's path instead of the main
-   * binary's) the loader paths (not rpaths) are correct so the paths will work.
-   *
-   * <p>This feature controls whether Bazel will embed those rpaths into the transitive shared
-   * library.
-   */
-  public static final String EXCLUDE_BAZEL_RPATHS_IN_TRANSITIVE_LIBS_FEATURE_NAME =
-      "exclude_bazel_rpaths_in_transitive_libs";
-
-  /**
-   * With this feature enabled cc_binary will link all its dynamic_deps, even the ones it depends on
-   * transitively, linking indirect deps might be necessary because if the RPATHs haven't been set
-   * up properly in those dynamic_deps then the loader won't be able to find those libraries unless
-   * they are also linked. For a production binary this is probably not the desired behavior and you
-   * can switch it off by disabling this feature, for the binary to work you have to make sure that
-   * the RPATHs in all shared libraries are set up properly though. The default toolchains have this
-   * behavior switched off for cc_binaries by default. The behavior for cc_tests with dynamic_deps
-   * on all platforms and Windows cc_binaries is hardcoded to always link every transitive library.
-   *
-   * <p>This feature controls the behavior for shared libraries depended on via dynamic_deps and
-   * doesn't control the behavior of the dynamic dependencies created by cc_libraries and used for
-   * cc_tests or cc_binaries(linkstatic=0).
-   */
-  public static final String LINK_INDIRECT_DYNAMIC_DEPS_IN_BINARY_FEATURE_NAME =
-      "link_indirect_dynamic_deps_in_binary";
-
   /** Ancestor for all rules that do include scanning. */
   public static final class CcIncludeScanningRule implements RuleDefinition {
     private final boolean addGrepIncludes;
diff --git a/src/main/java/com/google/devtools/build/lib/rules/cpp/LibrariesToLinkCollector.java b/src/main/java/com/google/devtools/build/lib/rules/cpp/LibrariesToLinkCollector.java
index abf3c1babf..0704dde023 100644
--- a/src/main/java/com/google/devtools/build/lib/rules/cpp/LibrariesToLinkCollector.java
+++ b/src/main/java/com/google/devtools/build/lib/rules/cpp/LibrariesToLinkCollector.java
@@ -61,6 +61,7 @@ public class LibrariesToLinkCollector {
   private final RuleErrorConsumer ruleErrorConsumer;
   private final Artifact output;
   private final String workspaceName;
+  private final Artifact dynamicLibrarySolibSymlinkOutput;
 
   public LibrariesToLinkCollector(
       boolean isNativeDeps,
@@ -79,7 +80,8 @@ public class LibrariesToLinkCollector {
       Iterable<LinkerInput> linkerInputs,
       boolean needWholeArchive,
       RuleErrorConsumer ruleErrorConsumer,
-      String workspaceName) {
+      String workspaceName,
+      Artifact dynamicLibrarySolibSymlinkOutput) {
     this.isNativeDeps = isNativeDeps;
     this.cppConfiguration = cppConfiguration;
     this.ccToolchainProvider = toolchain;
@@ -95,6 +97,7 @@ public class LibrariesToLinkCollector {
     this.ruleErrorConsumer = ruleErrorConsumer;
     this.output = output;
     this.workspaceName = workspaceName;
+    this.dynamicLibrarySolibSymlinkOutput = dynamicLibrarySolibSymlinkOutput;
 
     needToolchainLibrariesRpath =
         toolchainLibrariesSolibDir != null
@@ -164,81 +167,88 @@ public class LibrariesToLinkCollector {
   }
 
   private ImmutableList<String> findPotentialSolibParents() {
-    // The runtime location of the solib directory relative to the binary depends on four factors:
-    //
-    // * whether the binary is contained in the main repository or an external repository;
-    // * whether the binary is executed directly or from a runfiles tree;
-    // * whether the binary is staged as a symlink (sandboxed execution; local execution if the
-    //   binary is in the runfiles of another target) or a regular file (remote execution) - the
-    //   dynamic linker follows sandbox and runfiles symlinks into its location under the
-    //   unsandboxed execroot, which thus becomes the effective $ORIGIN;
-    // * whether --experimental_sibling_repository_layout is enabled or not.
-    //
-    // The rpaths emitted into the binary thus have to cover the following cases (assuming that
-    // the binary target is located in the pkg `pkg` and has name `file`) for the directory used
-    // as $ORIGIN by the dynamic linker and the directory containing the solib directories:
-    //
-    // 1. main, direct, symlink:
-    //    $ORIGIN:    $EXECROOT/pkg
-    //    solib root: $EXECROOT
-    // 2. main, direct, regular file:
-    //    $ORIGIN:    $EXECROOT/pkg
-    //    solib root: $EXECROOT/pkg/file.runfiles/main_repo
-    // 3. main, runfiles, symlink:
-    //    $ORIGIN:    $EXECROOT/pkg
-    //    solib root: $EXECROOT
-    // 4. main, runfiles, regular file:
-    //    $ORIGIN:    other_target.runfiles/main_repo/pkg
-    //    solib root: other_target.runfiles/main_repo
-    // 5a. external, direct, symlink:
-    //    $ORIGIN:    $EXECROOT/external/other_repo/pkg
-    //    solib root: $EXECROOT
-    // 5b. external, direct, symlink, with --experimental_sibling_repository_layout:
-    //    $ORIGIN:    $EXECROOT/../other_repo/pkg
-    //    solib root: $EXECROOT/../other_repo
-    // 6a. external, direct, regular file:
-    //    $ORIGIN:    $EXECROOT/external/other_repo/pkg
-    //    solib root: $EXECROOT/external/other_repo/pkg/file.runfiles/main_repo
-    // 6b. external, direct, regular file, with --experimental_sibling_repository_layout:
-    //    $ORIGIN:    $EXECROOT/../other_repo/pkg
-    //    solib root: $EXECROOT/../other_repo/pkg/file.runfiles/other_repo
-    // 7a. external, runfiles, symlink:
-    //    $ORIGIN:    $EXECROOT/external/other_repo/pkg
-    //    solib root: $EXECROOT
-    // 7b. external, runfiles, symlink, with --experimental_sibling_repository_layout:
-    //    $ORIGIN:    $EXECROOT/../other_repo/pkg
-    //    solib root: $EXECROOT/../other_repo
-    // 8a. external, runfiles, regular file:
-    //    $ORIGIN:    other_target.runfiles/some_repo/pkg
-    //    solib root: other_target.runfiles/main_repo
-    // 8b. external, runfiles, regular file, with --experimental_sibling_repository_layout:
-    //    $ORIGIN:    other_target.runfiles/some_repo/pkg
-    //    solib root: other_target.runfiles/some_repo
-    //
-    // Cases 1, 3, 4, 5, 7, and 8b are covered by an rpath that walks up the root relative path.
-    // Cases 2 and 6 covered by walking into file.runfiles/main_repo.
-    // Case 8a is covered by walking up some_repo/pkg and then into main_repo.
-    boolean isExternal =
-        output.getRunfilesPath().startsWith(LabelConstants.EXTERNAL_RUNFILES_PATH_PREFIX);
-    boolean usesLegacyRepositoryLayout = output.getRoot().isLegacy();
     ImmutableList.Builder<String> solibParents = ImmutableList.builder();
-    // Handles cases 1, 3, 4, 5, and 7.
-    solibParents.add("../".repeat(output.getRootRelativePath().segmentCount() - 1));
-    // Handle cases 2 and 6.
-    String solibRepositoryName;
-    if (isExternal && !usesLegacyRepositoryLayout) {
-      // Case 6b
-      solibRepositoryName = output.getRunfilesPath().getSegment(1);
-    } else {
-      // Cases 2 and 6a
-      solibRepositoryName = workspaceName;
+    ImmutableList.Builder<Artifact> outputs = ImmutableList.builder();
+    outputs.add(output);
+    if (dynamicLibrarySolibSymlinkOutput != null) {
+      outputs.add(dynamicLibrarySolibSymlinkOutput);
     }
-    solibParents.add(output.getFilename() + ".runfiles/" + solibRepositoryName + "/");
-    if (isExternal && usesLegacyRepositoryLayout) {
-      // Handles case 8a. The runfiles path is of the form ../some_repo/pkg/file and we need to
-      // walk up some_repo/pkg and then down into main_repo.
-      solibParents.add(
-          "../".repeat(output.getRunfilesPath().segmentCount() - 2) + workspaceName + "/");
+    for (Artifact output : outputs.build()) {
+      // The runtime location of the solib directory relative to the binary depends on four factors:
+      //
+      // * whether the binary is contained in the main repository or an external repository;
+      // * whether the binary is executed directly or from a runfiles tree;
+      // * whether the binary is staged as a symlink (sandboxed execution; local execution if the
+      //   binary is in the runfiles of another target) or a regular file (remote execution) - the
+      //   dynamic linker follows sandbox and runfiles symlinks into its location under the
+      //   unsandboxed execroot, which thus becomes the effective $ORIGIN;
+      // * whether --experimental_sibling_repository_layout is enabled or not.
+      //
+      // The rpaths emitted into the binary thus have to cover the following cases (assuming that
+      // the binary target is located in the pkg `pkg` and has name `file`) for the directory used
+      // as $ORIGIN by the dynamic linker and the directory containing the solib directories:
+      //
+      // 1. main, direct, symlink:
+      //    $ORIGIN:    $EXECROOT/pkg
+      //    solib root: $EXECROOT
+      // 2. main, direct, regular file:
+      //    $ORIGIN:    $EXECROOT/pkg
+      //    solib root: $EXECROOT/pkg/file.runfiles/main_repo
+      // 3. main, runfiles, symlink:
+      //    $ORIGIN:    $EXECROOT/pkg
+      //    solib root: $EXECROOT
+      // 4. main, runfiles, regular file:
+      //    $ORIGIN:    other_target.runfiles/main_repo/pkg
+      //    solib root: other_target.runfiles/main_repo
+      // 5a. external, direct, symlink:
+      //    $ORIGIN:    $EXECROOT/external/other_repo/pkg
+      //    solib root: $EXECROOT
+      // 5b. external, direct, symlink, with --experimental_sibling_repository_layout:
+      //    $ORIGIN:    $EXECROOT/../other_repo/pkg
+      //    solib root: $EXECROOT/../other_repo
+      // 6a. external, direct, regular file:
+      //    $ORIGIN:    $EXECROOT/external/other_repo/pkg
+      //    solib root: $EXECROOT/external/other_repo/pkg/file.runfiles/main_repo
+      // 6b. external, direct, regular file, with --experimental_sibling_repository_layout:
+      //    $ORIGIN:    $EXECROOT/../other_repo/pkg
+      //    solib root: $EXECROOT/../other_repo/pkg/file.runfiles/other_repo
+      // 7a. external, runfiles, symlink:
+      //    $ORIGIN:    $EXECROOT/external/other_repo/pkg
+      //    solib root: $EXECROOT
+      // 7b. external, runfiles, symlink, with --experimental_sibling_repository_layout:
+      //    $ORIGIN:    $EXECROOT/../other_repo/pkg
+      //    solib root: $EXECROOT/../other_repo
+      // 8a. external, runfiles, regular file:
+      //    $ORIGIN:    other_target.runfiles/some_repo/pkg
+      //    solib root: other_target.runfiles/main_repo
+      // 8b. external, runfiles, regular file, with --experimental_sibling_repository_layout:
+      //    $ORIGIN:    other_target.runfiles/some_repo/pkg
+      //    solib root: other_target.runfiles/some_repo
+      //
+      // Cases 1, 3, 4, 5, 7, and 8b are covered by an rpath that walks up the root relative path.
+      // Cases 2 and 6 covered by walking into file.runfiles/main_repo.
+      // Case 8a is covered by walking up some_repo/pkg and then into main_repo.
+      boolean isExternal =
+          output.getRunfilesPath().startsWith(LabelConstants.EXTERNAL_RUNFILES_PATH_PREFIX);
+      boolean usesLegacyRepositoryLayout = output.getRoot().isLegacy();
+      // Handles cases 1, 3, 4, 5, and 7.
+      solibParents.add("../".repeat(output.getRootRelativePath().segmentCount() - 1));
+      // Handle cases 2 and 6.
+      String solibRepositoryName;
+      if (isExternal && !usesLegacyRepositoryLayout) {
+        // Case 6b
+        solibRepositoryName = output.getRunfilesPath().getSegment(1);
+      } else {
+        // Cases 2 and 6a
+        solibRepositoryName = workspaceName;
+      }
+      solibParents.add(output.getFilename() + ".runfiles/" + solibRepositoryName + "/");
+      if (isExternal && usesLegacyRepositoryLayout) {
+        // Handles case 8a. The runfiles path is of the form ../some_repo/pkg/file and we need to
+        // walk up some_repo/pkg and then down into main_repo.
+        solibParents.add(
+            "../".repeat(output.getRunfilesPath().segmentCount() - 2) + workspaceName + "/");
+      }
     }
 
     return solibParents.build();
diff --git a/src/main/starlark/builtins_bzl/common/cc/cc_binary.bzl b/src/main/starlark/builtins_bzl/common/cc/cc_binary.bzl
index b889808d74..b6724ecbf1 100644
--- a/src/main/starlark/builtins_bzl/common/cc/cc_binary.bzl
+++ b/src/main/starlark/builtins_bzl/common/cc/cc_binary.bzl
@@ -409,22 +409,8 @@ def _filter_libraries_that_are_linked_dynamically(ctx, feature_configuration, cc
 
     # Unlike Unix on Windows every dynamic dependency must be linked to the
     # main binary, even indirect ones that are dependencies of direct
-    # dynamic dependencies of this binary. So even though linking indirect
-    # dynamic dependencies is not needed for Unix, we link them here for tests too
-    # because we cannot know whether the shared libraries were linked with
-    # RUNPATH or RPATH. If they were linked with the former, then the loader
-    # won't search in the runfiles directory of this binary for the library, it
-    # will only search in the RUNPATH set at the time of linking the shared
-    # library and we cannot possibly know at that point the runfiles directory
-    # of all of its dependents.
-    link_indirect_deps = (
-        ctx.attr._is_test or
-        cc_common.is_enabled(feature_configuration = feature_configuration, feature_name = "targets_windows") or
-        cc_common.is_enabled(
-            feature_configuration = feature_configuration,
-            feature_name = "link_indirect_dynamic_deps_in_binary",
-        )
-    )
+    # dynamic dependencies of this binary.
+    link_indirect_deps = cc_common.is_enabled(feature_configuration = feature_configuration, feature_name = "targets_windows")
     direct_dynamic_dep_labels = {dep[CcSharedLibraryInfo].linker_input.owner: True for dep in ctx.attr.dynamic_deps}
     topologically_sorted_labels_set = {label: True for label in topologically_sorted_labels}
     for dynamic_linker_input_owner, unused_linker_input in unused_dynamic_linker_inputs.items():
diff --git a/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library/BUILD.builtin_test b/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library/BUILD.builtin_test
index 3df2f8b868..11203e74e9 100644
--- a/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library/BUILD.builtin_test
+++ b/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library/BUILD.builtin_test
@@ -25,7 +25,6 @@ licenses(["notice"])
 
 package(
     default_visibility = ["//src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library:__subpackages__"],
-    features = ["exclude_bazel_rpaths_in_transitive_libs"],
 )
 
 py_test(
@@ -46,7 +45,6 @@ cc_binary(
     name = "binary",
     srcs = ["main.cc"],
     dynamic_deps = ["foo_so"],
-    features = ["use_rpath_instead_of_runpath"],
     deps = [
         ":foo",
     ],
@@ -133,7 +131,7 @@ cc_shared_library(
         "bar_so",
         "//src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library3:diff_pkg_so"
     ],
-    features = ["windows_export_all_symbols", "use_rpath_instead_of_runpath"],
+    features = ["windows_export_all_symbols"],
     exports_filter = [
         ":indirect_dep2",
     ],
diff --git a/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library/cc_shared_library_integration_test.sh b/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library/cc_shared_library_integration_test.sh
index 8bc6c1e88e..cf2769994b 100755
--- a/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library/cc_shared_library_integration_test.sh
+++ b/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library/cc_shared_library_integration_test.sh
@@ -52,7 +52,8 @@ function test_shared_library_symbols() {
 
 function test_shared_library_user_link_flags() {
   foo_so=$(find . -name libfoo_so.so)
-  objdump -x $foo_so | grep RPATH | grep "kittens" > /dev/null \
+  # $RPATH defined in testenv.sh
+  objdump -x $foo_so | grep $RPATH | grep "kittens" > /dev/null \
       || (echo "Expected to have RUNPATH contain 'kittens' (set by user_link_flags)" \
           && exit 1)
 }
diff --git a/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library/starlark_tests.bzl b/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library/starlark_tests.bzl
index b04d475d77..27913fa891 100644
--- a/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library/starlark_tests.bzl
+++ b/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library/starlark_tests.bzl
@@ -68,7 +68,7 @@ def _linking_order_test_impl(env, target):
         if "qux2.pic.o" in user_libs:
             found_bar = False
             for arg in args:
-                if "libbar" in arg:
+                if "-lbar_so" in arg:
                     found_bar = True
                 elif "qux2.pic.o" in arg:
                     env.expect.where(
diff --git a/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library/testenv.sh b/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library/testenv.sh
index 1572f31dda..5e946c88ca 100644
--- a/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library/testenv.sh
+++ b/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library/testenv.sh
@@ -14,3 +14,4 @@
 # limitations under the License.
 
 LDD_BINARY="ldd"
+RPATH="RUNPATH"
diff --git a/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library3/BUILD.builtin_test b/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library3/BUILD.builtin_test
index 7d15613e67..39d541f8f3 100644
--- a/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library3/BUILD.builtin_test
+++ b/src/main/starlark/tests/builtins_bzl/cc/cc_shared_library/test_cc_shared_library3/BUILD.builtin_test
@@ -16,7 +16,7 @@ cc_library(
 
 cc_shared_library(
     name = "diff_pkg_so",
-    features = ["windows_export_all_symbols", "exclude_bazel_rpaths_in_transitive_libs"],
+    features = ["windows_export_all_symbols"],
     deps = [
         ":diff_pkg",
     ],
diff --git a/tools/cpp/unix_cc_toolchain_config.bzl b/tools/cpp/unix_cc_toolchain_config.bzl
index cdbec472aa..a4fb2f606e 100644
--- a/tools/cpp/unix_cc_toolchain_config.bzl
+++ b/tools/cpp/unix_cc_toolchain_config.bzl
@@ -609,10 +609,6 @@ def _impl(ctx):
         ],
     )
 
-    link_indirect_dynamic_deps_in_binary_feature = feature(
-        name = "link_indirect_dynamic_deps_in_binary",
-    )
-
     fission_support_feature = feature(
         name = "fission_support",
         flag_sets = [
@@ -1363,23 +1359,6 @@ def _impl(ctx):
 
     # TODO(#8303): Mac crosstool should also declare every feature.
     if is_linux:
-        use_rpath_instead_of_runpath_feature = feature(
-            name = "use_rpath_instead_of_runpath",
-            flag_sets = [
-                flag_set(
-                    actions = all_link_actions + lto_index_actions,
-                    flag_groups = [
-                        flag_group(
-                            flags = ["-Wl,--disable-new-dtags"],
-                        ),
-                    ],
-                ),
-            ],
-        )
-        exclude_bazel_rpaths_in_transitive_libs_feature = feature(
-            name = "exclude_bazel_rpaths_in_transitive_libs",
-        )
-
         # Linux artifact name patterns are the default.
         artifact_name_patterns = []
         features = [
@@ -1404,9 +1383,6 @@ def _impl(ctx):
             linkstamps_feature,
             output_execpath_flags_feature,
             runtime_library_search_directories_feature,
-            exclude_bazel_rpaths_in_transitive_libs_feature,
-            use_rpath_instead_of_runpath_feature,
-            link_indirect_dynamic_deps_in_binary_feature,
             library_search_directories_feature,
             libtool_feature,
             archiver_flags_feature,
@@ -1469,7 +1445,6 @@ def _impl(ctx):
             default_link_flags_feature,
             user_link_flags_feature,
             default_link_libs_feature,
-            link_indirect_dynamic_deps_in_binary_feature,
             fdo_optimize_feature,
             dbg_feature,
             opt_feature,
