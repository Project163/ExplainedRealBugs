{"url":"https://api.github.com/repos/akka/akka-core/issues/23416","repository_url":"https://api.github.com/repos/akka/akka-core","labels_url":"https://api.github.com/repos/akka/akka-core/issues/23416/labels{/name}","comments_url":"https://api.github.com/repos/akka/akka-core/issues/23416/comments","events_url":"https://api.github.com/repos/akka/akka-core/issues/23416/events","html_url":"https://github.com/akka/akka-core/issues/23416","id":245413781,"node_id":"MDU6SXNzdWUyNDU0MTM3ODE=","number":23416,"title":"Invalid stack trace because reused exception code is defined as val","user":{"login":"francisdb","id":161305,"node_id":"MDQ6VXNlcjE2MTMwNQ==","avatar_url":"https://avatars.githubusercontent.com/u/161305?v=4","gravatar_id":"","url":"https://api.github.com/users/francisdb","html_url":"https://github.com/francisdb","followers_url":"https://api.github.com/users/francisdb/followers","following_url":"https://api.github.com/users/francisdb/following{/other_user}","gists_url":"https://api.github.com/users/francisdb/gists{/gist_id}","starred_url":"https://api.github.com/users/francisdb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/francisdb/subscriptions","organizations_url":"https://api.github.com/users/francisdb/orgs","repos_url":"https://api.github.com/users/francisdb/repos","events_url":"https://api.github.com/users/francisdb/events{/privacy}","received_events_url":"https://api.github.com/users/francisdb/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":92616708,"node_id":"MDU6TGFiZWw5MjYxNjcwOA==","url":"https://api.github.com/repos/akka/akka-core/labels/help%20wanted","name":"help wanted","color":"009800","default":true,"description":"Issues that the core team will likely not have time to work on"},{"id":93144690,"node_id":"MDU6TGFiZWw5MzE0NDY5MA==","url":"https://api.github.com/repos/akka/akka-core/labels/t:stream","name":"t:stream","color":"cccccc","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/akka/akka-core/milestones/117","html_url":"https://github.com/akka/akka-core/milestone/117","labels_url":"https://api.github.com/repos/akka/akka-core/milestones/117/labels","id":2591375,"node_id":"MDk6TWlsZXN0b25lMjU5MTM3NQ==","number":117,"title":"2.5.4","description":null,"creator":{"login":"ktoso","id":120979,"node_id":"MDQ6VXNlcjEyMDk3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/120979?v=4","gravatar_id":"","url":"https://api.github.com/users/ktoso","html_url":"https://github.com/ktoso","followers_url":"https://api.github.com/users/ktoso/followers","following_url":"https://api.github.com/users/ktoso/following{/other_user}","gists_url":"https://api.github.com/users/ktoso/gists{/gist_id}","starred_url":"https://api.github.com/users/ktoso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktoso/subscriptions","organizations_url":"https://api.github.com/users/ktoso/orgs","repos_url":"https://api.github.com/users/ktoso/repos","events_url":"https://api.github.com/users/ktoso/events{/privacy}","received_events_url":"https://api.github.com/users/ktoso/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":53,"state":"closed","created_at":"2017-06-19T16:35:05Z","updated_at":"2017-08-10T19:21:30Z","due_on":null,"closed_at":"2017-08-10T19:21:30Z"},"comments":6,"created_at":"2017-07-25T14:08:04Z","updated_at":"2017-08-09T20:14:35Z","closed_at":"2017-08-09T14:35:09Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Both `OutputStreamSourceStage` (and `InputStreamSinkStage`) build an IOException and store it as val. This causes the stack trace to be populated at val instantiation time instead of the place where it is thrown. This in turn yields strange stack traces originating at the wrong location.\r\n\r\nMy guess is that this is not on purpose and should have been defined as a `def` instead of a `val`\r\n(you might want to search the code for more of these)\r\n\r\nhttps://github.com/akka/akka/blob/87b28d0dc53d236168b00dab0f443886f0f11853/akka-stream/src/main/scala/akka/stream/impl/io/OutputStreamSourceStage.scala#L164\r\n\r\n```scala\r\n val publisherClosedException = new IOException(\"Reactive stream is terminated, no writes are possible\")\r\n\r\n  @scala.throws(classOf[IOException])\r\n  private[this] def send(sendAction: () â‡’ Unit): Unit = {\r\n    if (isActive) {\r\n      if (isPublisherAlive) sendAction()\r\n      else throw publisherClosedException\r\n    } else throw new IOException(\"OutputStream is closed\")\r\n  }\r\n```\r\n\r\nthe same is done here: https://github.com/akka/akka/blob/87b28d0dc53d236168b00dab0f443886f0f11853/akka-stream/src/main/scala/akka/stream/impl/io/InputStreamSinkStage.scala#L117","closed_by":{"login":"patriknw","id":336161,"node_id":"MDQ6VXNlcjMzNjE2MQ==","avatar_url":"https://avatars.githubusercontent.com/u/336161?v=4","gravatar_id":"","url":"https://api.github.com/users/patriknw","html_url":"https://github.com/patriknw","followers_url":"https://api.github.com/users/patriknw/followers","following_url":"https://api.github.com/users/patriknw/following{/other_user}","gists_url":"https://api.github.com/users/patriknw/gists{/gist_id}","starred_url":"https://api.github.com/users/patriknw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/patriknw/subscriptions","organizations_url":"https://api.github.com/users/patriknw/orgs","repos_url":"https://api.github.com/users/patriknw/repos","events_url":"https://api.github.com/users/patriknw/events{/privacy}","received_events_url":"https://api.github.com/users/patriknw/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/akka/akka-core/issues/23416/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/akka/akka-core/issues/23416/timeline","performed_via_github_app":null,"state_reason":"completed"}