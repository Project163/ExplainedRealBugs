{"url":"https://api.github.com/repos/akka/akka-core/issues/25983","repository_url":"https://api.github.com/repos/akka/akka-core","labels_url":"https://api.github.com/repos/akka/akka-core/issues/25983/labels{/name}","comments_url":"https://api.github.com/repos/akka/akka-core/issues/25983/comments","events_url":"https://api.github.com/repos/akka/akka-core/issues/25983/events","html_url":"https://github.com/akka/akka-core/issues/25983","id":384408809,"node_id":"MDU6SXNzdWUzODQ0MDg4MDk=","number":25983,"title":"Responding with stream created with StreamConverters.asOutputStream() causes responses to be truncated.","user":{"login":"Vistritium","id":4985589,"node_id":"MDQ6VXNlcjQ5ODU1ODk=","avatar_url":"https://avatars.githubusercontent.com/u/4985589?v=4","gravatar_id":"","url":"https://api.github.com/users/Vistritium","html_url":"https://github.com/Vistritium","followers_url":"https://api.github.com/users/Vistritium/followers","following_url":"https://api.github.com/users/Vistritium/following{/other_user}","gists_url":"https://api.github.com/users/Vistritium/gists{/gist_id}","starred_url":"https://api.github.com/users/Vistritium/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Vistritium/subscriptions","organizations_url":"https://api.github.com/users/Vistritium/orgs","repos_url":"https://api.github.com/users/Vistritium/repos","events_url":"https://api.github.com/users/Vistritium/events{/privacy}","received_events_url":"https://api.github.com/users/Vistritium/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":92356828,"node_id":"MDU6TGFiZWw5MjM1NjgyOA==","url":"https://api.github.com/repos/akka/akka-core/labels/1%20-%20triaged","name":"1 - triaged","color":"5319e7","default":false,"description":"Tickets that are safe to pick up for contributing in terms of likeliness of being accepted"},{"id":92619677,"node_id":"MDU6TGFiZWw5MjYxOTY3Nw==","url":"https://api.github.com/repos/akka/akka-core/labels/bug","name":"bug","color":"e11d21","default":true,"description":null},{"id":93144690,"node_id":"MDU6TGFiZWw5MzE0NDY5MA==","url":"https://api.github.com/repos/akka/akka-core/labels/t:stream","name":"t:stream","color":"cccccc","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[{"login":"raboof","id":131856,"node_id":"MDQ6VXNlcjEzMTg1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/131856?v=4","gravatar_id":"","url":"https://api.github.com/users/raboof","html_url":"https://github.com/raboof","followers_url":"https://api.github.com/users/raboof/followers","following_url":"https://api.github.com/users/raboof/following{/other_user}","gists_url":"https://api.github.com/users/raboof/gists{/gist_id}","starred_url":"https://api.github.com/users/raboof/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raboof/subscriptions","organizations_url":"https://api.github.com/users/raboof/orgs","repos_url":"https://api.github.com/users/raboof/repos","events_url":"https://api.github.com/users/raboof/events{/privacy}","received_events_url":"https://api.github.com/users/raboof/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/akka/akka-core/milestones/137","html_url":"https://github.com/akka/akka-core/milestone/137","labels_url":"https://api.github.com/repos/akka/akka-core/milestones/137/labels","id":4010515,"node_id":"MDk6TWlsZXN0b25lNDAxMDUxNQ==","number":137,"title":"2.5.21","description":null,"creator":{"login":"johanandren","id":666915,"node_id":"MDQ6VXNlcjY2NjkxNQ==","avatar_url":"https://avatars.githubusercontent.com/u/666915?v=4","gravatar_id":"","url":"https://api.github.com/users/johanandren","html_url":"https://github.com/johanandren","followers_url":"https://api.github.com/users/johanandren/followers","following_url":"https://api.github.com/users/johanandren/following{/other_user}","gists_url":"https://api.github.com/users/johanandren/gists{/gist_id}","starred_url":"https://api.github.com/users/johanandren/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johanandren/subscriptions","organizations_url":"https://api.github.com/users/johanandren/orgs","repos_url":"https://api.github.com/users/johanandren/repos","events_url":"https://api.github.com/users/johanandren/events{/privacy}","received_events_url":"https://api.github.com/users/johanandren/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":26,"state":"closed","created_at":"2019-01-29T08:21:48Z","updated_at":"2019-02-13T13:35:45Z","due_on":null,"closed_at":"2019-02-13T13:35:45Z"},"comments":4,"created_at":"2018-11-23T11:34:11Z","updated_at":"2019-02-07T16:00:51Z","closed_at":"2019-02-07T16:00:39Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"When creating streaming response using `StreamConverters.asOutputStream` the returned data is sometimes truncated. Response code is ok.\r\nI created simple example that reproduces this issue:\r\nhttps://github.com/Vistritium/akka-http-stramconverters-asoutputstream-truncated/blob/master/src/test/scala/com/example/Test.scala\r\n(it's only 73 lines of code)\r\nWhen I create steam using other methods it works correctly. When using `StreamConverters.asOutputStream` it usually fails between 1st and 5th request.\r\n\r\nThere is no issue with akka-http-testkit, I have this issue with real application.\r\n\r\nAkka version: 2.5.18\r\nAkka-http version: 10.1.5\r\n\r\nFull project showing the issue with failing test: https://github.com/Vistritium/akka-http-stramconverters-asoutputstream-truncated (5 files)\r\n\r\nAdditional details:\r\nThe test usually shows empty string response, but in real application this is usually truncated in half of the response, some data is sent and some data is dropped.\r\nIn the test the issue is usually happening between 1st and 5th request but in my app it happens less frequently: 1 in 50 or even 1 in 100 times.","closed_by":{"login":"jrudolph","id":9868,"node_id":"MDQ6VXNlcjk4Njg=","avatar_url":"https://avatars.githubusercontent.com/u/9868?v=4","gravatar_id":"","url":"https://api.github.com/users/jrudolph","html_url":"https://github.com/jrudolph","followers_url":"https://api.github.com/users/jrudolph/followers","following_url":"https://api.github.com/users/jrudolph/following{/other_user}","gists_url":"https://api.github.com/users/jrudolph/gists{/gist_id}","starred_url":"https://api.github.com/users/jrudolph/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrudolph/subscriptions","organizations_url":"https://api.github.com/users/jrudolph/orgs","repos_url":"https://api.github.com/users/jrudolph/repos","events_url":"https://api.github.com/users/jrudolph/events{/privacy}","received_events_url":"https://api.github.com/users/jrudolph/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/akka/akka-core/issues/25983/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/akka/akka-core/issues/25983/timeline","performed_via_github_app":null,"state_reason":"completed"}