{"url":"https://api.github.com/repos/actix/actix-web/issues/2306","repository_url":"https://api.github.com/repos/actix/actix-web","labels_url":"https://api.github.com/repos/actix/actix-web/issues/2306/labels{/name}","comments_url":"https://api.github.com/repos/actix/actix-web/issues/2306/comments","events_url":"https://api.github.com/repos/actix/actix-web/issues/2306/events","html_url":"https://github.com/actix/actix-web/issues/2306","id":939522874,"node_id":"MDU6SXNzdWU5Mzk1MjI4NzQ=","number":2306,"title":"[awc] HTTP client ignores Content-Length if Body is stream.","user":{"login":"ArtBlnd","id":2209400,"node_id":"MDQ6VXNlcjIyMDk0MDA=","avatar_url":"https://avatars.githubusercontent.com/u/2209400?v=4","gravatar_id":"","url":"https://api.github.com/users/ArtBlnd","html_url":"https://github.com/ArtBlnd","followers_url":"https://api.github.com/users/ArtBlnd/followers","following_url":"https://api.github.com/users/ArtBlnd/following{/other_user}","gists_url":"https://api.github.com/users/ArtBlnd/gists{/gist_id}","starred_url":"https://api.github.com/users/ArtBlnd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ArtBlnd/subscriptions","organizations_url":"https://api.github.com/users/ArtBlnd/orgs","repos_url":"https://api.github.com/users/ArtBlnd/repos","events_url":"https://api.github.com/users/ArtBlnd/events{/privacy}","received_events_url":"https://api.github.com/users/ArtBlnd/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":707286502,"node_id":"MDU6TGFiZWw3MDcyODY1MDI=","url":"https://api.github.com/repos/actix/actix-web/labels/C-bug","name":"C-bug","color":"ee0701","default":false,"description":"Category: bug"},{"id":1296793625,"node_id":"MDU6TGFiZWwxMjk2NzkzNjI1","url":"https://api.github.com/repos/actix/actix-web/labels/A-awc","name":"A-awc","color":"fff4af","default":false,"description":"project: awc"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-07-08T06:38:04Z","updated_at":"2025-08-23T03:23:58Z","closed_at":"2025-08-23T03:23:58Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Expected Behavior\r\n<!--- If you're describing a bug, tell us what should happen -->\r\n<!--- If you're suggesting a change/improvement, tell us how it should work -->\r\n\r\nHTTP client should respect Content-Length even body of request is stream.\r\n\r\n## Current Behavior\r\n<!--- If describing a bug, tell us what happens instead of the expected behavior -->\r\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\r\n\r\nContent-Length header is removed by client itself.\r\n\r\n## Possible Solution\r\n<!--- Not obligatory, but suggest a fix/reason for the bug, -->\r\n<!--- or ideas how to implement the addition or change -->\r\n\r\nrespect Content-Length header if present.\r\nalso an enhancement, if first item of body stream is known as `None` it is better set Content-Length to zero. not inserting chunked encoding header.\r\n\r\n## Steps to Reproduce (for bugs)\r\n<!--- Provide a link to a live example, or an unambiguous set of steps to -->\r\n<!--- reproduce this bug. Include code to reproduce, if relevant -->\r\n\r\nSend request with empty stream. \r\n\r\n## Context\r\n<!--- How has this issue affected you? What are you trying to accomplish? -->\r\n<!--- Providing context helps us come up with a solution that is most useful in the real world -->\r\n\r\nCloudfront will reject you.\r\n\r\n## Your Environment\r\n<!--- Include as many relevant details about the environment you experienced the bug in -->\r\n\r\n* Rust Version (I.e, output of `rustc -V`): rustc 1.53.0 (53cb7b09b 2021-06-17)\r\n* Actix Web Version: awc 3.0.0-beta.7\r\n","closed_by":{"login":"JohnTitor","id":25030997,"node_id":"MDQ6VXNlcjI1MDMwOTk3","avatar_url":"https://avatars.githubusercontent.com/u/25030997?v=4","gravatar_id":"","url":"https://api.github.com/users/JohnTitor","html_url":"https://github.com/JohnTitor","followers_url":"https://api.github.com/users/JohnTitor/followers","following_url":"https://api.github.com/users/JohnTitor/following{/other_user}","gists_url":"https://api.github.com/users/JohnTitor/gists{/gist_id}","starred_url":"https://api.github.com/users/JohnTitor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JohnTitor/subscriptions","organizations_url":"https://api.github.com/users/JohnTitor/orgs","repos_url":"https://api.github.com/users/JohnTitor/repos","events_url":"https://api.github.com/users/JohnTitor/events{/privacy}","received_events_url":"https://api.github.com/users/JohnTitor/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/actix/actix-web/issues/2306/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/actix/actix-web/issues/2306/timeline","performed_via_github_app":null,"state_reason":"completed"}