{"url":"https://api.github.com/repos/actix/actix-web/issues/938","repository_url":"https://api.github.com/repos/actix/actix-web","labels_url":"https://api.github.com/repos/actix/actix-web/issues/938/labels{/name}","comments_url":"https://api.github.com/repos/actix/actix-web/issues/938/comments","events_url":"https://api.github.com/repos/actix/actix-web/issues/938/events","html_url":"https://github.com/actix/actix-web/issues/938","id":459804306,"node_id":"MDU6SXNzdWU0NTk4MDQzMDY=","number":938,"title":"Error reporting in 1.0","user":{"login":"eastern-grey","id":51985396,"node_id":"MDQ6VXNlcjUxOTg1Mzk2","avatar_url":"https://avatars.githubusercontent.com/u/51985396?v=4","gravatar_id":"","url":"https://api.github.com/users/eastern-grey","html_url":"https://github.com/eastern-grey","followers_url":"https://api.github.com/users/eastern-grey/followers","following_url":"https://api.github.com/users/eastern-grey/following{/other_user}","gists_url":"https://api.github.com/users/eastern-grey/gists{/gist_id}","starred_url":"https://api.github.com/users/eastern-grey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eastern-grey/subscriptions","organizations_url":"https://api.github.com/users/eastern-grey/orgs","repos_url":"https://api.github.com/users/eastern-grey/repos","events_url":"https://api.github.com/users/eastern-grey/events{/privacy}","received_events_url":"https://api.github.com/users/eastern-grey/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":12,"created_at":"2019-06-24T10:07:17Z","updated_at":"2023-04-14T19:56:53Z","closed_at":"2019-07-18T08:31:21Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I am still quite new to actix and rust in general, so I apologise if I have missed something obvious in the text below.\r\n\r\nIn actix-web 0.7, if a handler returned an actix Error, the error message was logged:\r\n\r\n```\r\nERROR 2019-06-24T07:29:59Z: actix_web::pipeline: Error occurred during request handling, status: 500 Internal Server Error test\r\nDEBUG 2019-06-24T07:29:59Z: actix_web::pipeline: Custom { kind: Other, error: StringError(\"test\") }\r\nINFO 2019-06-24T07:30:00Z: actix_web::middleware::logger: 127.0.0.1:56449 \"GET /error HTTP/1.1\" 500 0 \"-\" ...\r\n```\r\n\r\nIn 1.0, errors no longer appear to be logged. If the logger middleware is enabled, it is possible to see that a handler has returned a 500 response, but actix gives no indication of what the error actually was in the logs.\r\n\r\n```\r\n INFO 2019-06-24T08:49:54Z: actix_web::middleware::logger: 127.0.0.1:59661 \"GET /error HTTP/1.1\" 500 4 \"-\" ...\r\n```\r\n\r\nI gather that I can implement a custom error type in order to log the error, and optionally display something else in the http response. The following seems to work:\r\n\r\n```\r\n#[derive(Debug)]\r\nstruct UserError {\r\n    err: failure::Error\r\n}\r\n\r\nimpl actix_web::error::ResponseError for UserError {\r\n    fn error_response(&self) -> HttpResponse {\r\n        error!(\"caught internal server error: {:?}\", self);\r\n        HttpResponse::new(\r\n            http::StatusCode::INTERNAL_SERVER_ERROR)\r\n    }\r\n}\r\n\r\nimpl fmt::Display for UserError {\r\n    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {\r\n        write!(f, \"hidden error\")\r\n    }\r\n}\r\n\r\nimpl<T: Into<failure::Error>> From<T> for UserError {\r\n    fn from(t: T) -> UserError { UserError { err: t.into() } }\r\n}\r\n\r\n#[get(\"/error\")]\r\nfn errortest() -> impl Future<Item = String, Error = UserError> {\r\n    futures::future::err(format_err!(\"test fail\")).from_err()\r\n}\r\n```\r\n\r\nBut that took me quite some time to figure out as someone new to the ecosystem. The other web frameworks I have used in the past all hide error messages from end users by default, and show them only to the developer, so the fact that actix does the opposite caught me by surprise. While custom error types may be the best solution in the long run, for the benefit of people starting out, might it make more sense if actix's Error type behaved differently to how it does now?\r\n\r\nThanks for all your work on actix :-)","closed_by":{"login":"fafhrd91","id":598990,"node_id":"MDQ6VXNlcjU5ODk5MA==","avatar_url":"https://avatars.githubusercontent.com/u/598990?v=4","gravatar_id":"","url":"https://api.github.com/users/fafhrd91","html_url":"https://github.com/fafhrd91","followers_url":"https://api.github.com/users/fafhrd91/followers","following_url":"https://api.github.com/users/fafhrd91/following{/other_user}","gists_url":"https://api.github.com/users/fafhrd91/gists{/gist_id}","starred_url":"https://api.github.com/users/fafhrd91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fafhrd91/subscriptions","organizations_url":"https://api.github.com/users/fafhrd91/orgs","repos_url":"https://api.github.com/users/fafhrd91/repos","events_url":"https://api.github.com/users/fafhrd91/events{/privacy}","received_events_url":"https://api.github.com/users/fafhrd91/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/actix/actix-web/issues/938/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/actix/actix-web/issues/938/timeline","performed_via_github_app":null,"state_reason":"completed"}