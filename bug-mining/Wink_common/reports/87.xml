<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:29:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WINK-363] Failure to find array entity providers (such as ByteArrayProvider) in Java 7</title>
                <link>https://issues.apache.org/jira/browse/WINK-363</link>
                <project id="12310940" key="WINK">Wink</project>
                    <description>&lt;p&gt;The ByteArrayProvider is properly registered and is found through ProvidersRegistry in Java 6,but not in Java 7. The effect is a consequence of Java bug &lt;a href=&quot;http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=5041784&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=5041784&lt;/a&gt; which got fixed in Java 7. It can also affect other array entity providers.&lt;/p&gt;

&lt;p&gt;Explanation: &lt;/p&gt;

&lt;p&gt;ProvidersRegistry collects the providers for the target type byte[] by checking whether the provider type and the target type are assignable. The corresponding utilities are in GenericsUtils. To determine the provider type, GenericsUtil.getGenericInterfaceParamType retrieves the type from the generic interfaces of ByteArrayProvider. The type parameters in the generic interfaces are represented as java.lang.reflect.Type in Java 6 but as java.lang.Class in Java 7. As consequence, the method GenericsUtils.isAssignableFrom fails to see that the type parameter is an array, hence it returns that byte[] is not assignable to the retrieved type of ByteArrayProvider.&lt;/p&gt;

&lt;p&gt;Here is a simple Java program that explains the difference between Java 6 and Java 7. &lt;/p&gt;

&lt;p&gt;In Java 6, the output is:&lt;/p&gt;

&lt;p&gt;Type Parameter byte[]&lt;br/&gt;
Type Parameter class class sun.reflect.generics.reflectiveObjects.GenericArrayTypeImpl&lt;br/&gt;
Is Generic Array true&lt;/p&gt;

&lt;p&gt;In Java 7, the output is:&lt;/p&gt;

&lt;p&gt;Type Parameter class [B&lt;br/&gt;
Type Parameter class class java.lang.Class&lt;br/&gt;
Is Generic Array false&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.lang.reflect.GenericArrayType;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.lang.reflect.ParameterizedType;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.lang.reflect.Type;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Test
{

  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
    &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt; cls = ByteArrayProvider.class;
    Type[] interfaces = cls.getGenericInterfaces();
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Type type : interfaces) {
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (type &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; ParameterizedType) {
        ParameterizedType pType = (ParameterizedType)type;
        Type t = pType.getActualTypeArguments()[0];
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Type Parameter &quot;&lt;/span&gt; + t);
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Type Parameter class &quot;&lt;/span&gt; + t.getClass());
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Is Generic Array &quot;&lt;/span&gt; + (t &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; GenericArrayType));
      }
    }
  }
}

&lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; MessageBodyWriter&amp;lt;T&amp;gt; { }

&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;ByteArrayProvider &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; MessageBodyWriter&amp;lt;&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[]&amp;gt; { }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;I suggest the following fix in GenericsUtils (tested locally in Wink 1.1.3):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;GenericsUtils.isAssignableFrom&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isAssignableFrom(Type type, &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; cls) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (cls.isArray()) {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (type &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; GenericArrayType) {
                GenericArrayType genericArray = (GenericArrayType)type;
                &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; componentType = cls.getComponentType();
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; isAssignableFrom(genericArray.getGenericComponentType(), componentType);
            }
            &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((type &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt;) &amp;amp;&amp;amp; ((&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt;)type).isArray()) {
                &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; componentType1 = ((&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt;)type).getComponentType();
                &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; componentType2 = cls.getComponentType();
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; isAssignableFrom(componentType1, componentType2);
            }
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (type &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; GenericArrayType == &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;) {
                &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; classType = getClassType(type, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (classType == &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.class || classType.isAssignableFrom(cls)) {
                    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
                }
            }
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;Linux, Java 1.7.0-b147&lt;/p&gt;</environment>
        <key id="12544924">WINK-363</key>
            <summary>Failure to find array entity providers (such as ByteArrayProvider) in Java 7</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="geosan">Georg Sander</reporter>
                        <labels>
                    </labels>
                <created>Fri, 2 Mar 2012 11:53:23 +0000</created>
                <updated>Sat, 13 Jul 2013 20:13:13 +0000</updated>
                            <resolved>Thu, 2 Aug 2012 00:36:58 +0000</resolved>
                                    <version>1.2</version>
                                    <fixVersion>1.3</fixVersion>
                                    <component>Providers</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13221103" author="kevan" created="Fri, 2 Mar 2012 18:02:31 +0000"  >&lt;p&gt;Thanks Georg.&lt;/p&gt;

&lt;p&gt;Your code above is assumed to be a contribution to the ASF under the Apache License v2 (and thus we could incorporate into Wink).&lt;/p&gt;

&lt;p&gt;Attaching the source (preferably as a patch file) to the Jira and clicking the &quot;Grant license to ASF for inclusion in ASF works (as per the Apache License &#167;5)&quot; radio button makes the licensing of your contribution explicit.&lt;/p&gt;

&lt;p&gt;The latter method is preferred, but not absolutely necessary. Doesn&apos;t look like Wink has any documentation on this (something for the to do list).&lt;/p&gt;</comment>
                            <comment id="13239663" author="geosan" created="Tue, 27 Mar 2012 17:22:36 +0000"  >&lt;p&gt;Attached the version I used for debugging, just for the purpose of my granting you license for inclusion. &lt;/p&gt;

&lt;p&gt;If I might have left debug code inside that file, please ignore. I have no clean version at hand right now. Look only at the method isAssignableFrom, that&apos;s where the change must go.&lt;/p&gt;</comment>
                            <comment id="13425978" author="mffiedler" created="Tue, 31 Jul 2012 18:12:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kevan&quot; class=&quot;user-hover&quot; rel=&quot;kevan&quot;&gt;kevan&lt;/a&gt; Any chance of getting this in a build?  I verified the proposed patch on 1.2.0 and can confirm it fixes the issue.   The wink-commons JUnits actually fail without the patch on and pass with it on.  I can open a separate issue for the JUNit failure if that helps.&lt;/p&gt;

&lt;p&gt;My JRE:&lt;/p&gt;

&lt;p&gt;java version &quot;1.7.0&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build pwa6470sr1-20120405_01(SR1))&lt;br/&gt;
IBM J9 VM (build 2.6, JRE 1.7.0 Windows Server 2008 R2 amd64-64 20120322_106209&lt;br/&gt;
(JIT enabled, AOT enabled)&lt;br/&gt;
J9VM - R26_Java726_SR1_20120322_1720_B106209&lt;br/&gt;
JIT  - r11_20120322_22976&lt;br/&gt;
GC   - R26_Java726_SR1_20120322_1720_B106209&lt;br/&gt;
J9CL - 20120322_106209)&lt;br/&gt;
JCL - 20120322_01 based on Oracle 7u3-b05&lt;/p&gt;</comment>
                            <comment id="13426009" author="mffiedler" created="Tue, 31 Jul 2012 18:42:53 +0000"  >&lt;p&gt;I see that&apos;s probably the wrong person to ping in my comment.  Project leads/committers, can this be a candidate for an upcoming build?  &lt;/p&gt;</comment>
                            <comment id="13427042" author="luciano resende" created="Thu, 2 Aug 2012 00:36:58 +0000"  >&lt;p&gt;Patch applied into trunk. This fixes the issue with IBM JDK7 (latest)&lt;/p&gt;</comment>
                            <comment id="13427636" author="mffiedler" created="Thu, 2 Aug 2012 21:30:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=luciano+resende&quot; class=&quot;user-hover&quot; rel=&quot;luciano resende&quot;&gt;luciano resende&lt;/a&gt; Great news.   What is the outlook for getting a Wink.next build with the fix incorporated? &lt;/p&gt;</comment>
                            <comment id="13427738" author="luciano resende" created="Thu, 2 Aug 2012 23:43:05 +0000"  >&lt;p&gt;Are you actually asking for a official release (e.g. 1.2.1) otherwise Jenkins builds are running and should be available.&lt;/p&gt;</comment>
                            <comment id="13428287" author="mffiedler" created="Fri, 3 Aug 2012 18:45:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=luciano+resende&quot; class=&quot;user-hover&quot; rel=&quot;luciano resende&quot;&gt;luciano resende&lt;/a&gt; Sorry, yes, I was asking for a release.  I am a committer on the Eclipse Lyo project &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; and we currently consume Wink for our builds from maven central.   We have array providers for some custom media types and we&apos;re currently broken on Java 7 for these providers.&lt;/p&gt;

&lt;p&gt;What might be the outlook on a new 1.2.x maint. release?  I&apos;d prefer to go that route vs having to checkin patched Wink source.  Thanks.&lt;/p&gt;

&lt;p&gt;Let me know if I should be making this type of request on the mailing list.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; - &lt;a href=&quot;http://eclipse.org/lyo/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://eclipse.org/lyo/&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12520156" name="GenericsUtils.java" size="8569" author="geosan" created="Tue, 27 Mar 2012 17:22:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>230110</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 16 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1girz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>304635</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>