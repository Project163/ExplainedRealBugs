diff --git a/wink-common/pom.xml b/wink-common/pom.xml
index 0597d7a2..f23f69ce 100644
--- a/wink-common/pom.xml
+++ b/wink-common/pom.xml
@@ -69,6 +69,12 @@
             <groupId>javax.ws.rs</groupId>
             <artifactId>jsr311-api</artifactId>
         </dependency>
+        <dependency>
+            <groupId>org.jmock</groupId>
+            <artifactId>jmock-junit3</artifactId>
+            <version>2.5.1</version>
+            <scope>test</scope>
+        </dependency>
     </dependencies>
     <build>
         <plugins>
diff --git a/wink-common/src/main/java/org/apache/wink/common/internal/contexts/MediaTypeCharsetAdjuster.java b/wink-common/src/main/java/org/apache/wink/common/internal/contexts/MediaTypeCharsetAdjuster.java
new file mode 100644
index 00000000..a5777c7f
--- /dev/null
+++ b/wink-common/src/main/java/org/apache/wink/common/internal/contexts/MediaTypeCharsetAdjuster.java
@@ -0,0 +1,29 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *  
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *  
+ *  Unless required by applicable law or agreed to in writing,
+ *  software distributed under the License is distributed on an
+ *  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ *  KIND, either express or implied.  See the License for the
+ *  specific language governing permissions and limitations
+ *  under the License.
+ *  
+ */
+package org.apache.wink.common.internal.contexts;
+
+import javax.ws.rs.core.MediaType;
+import javax.ws.rs.core.MultivaluedMap;
+
+public interface MediaTypeCharsetAdjuster {
+
+    public MediaType setDefaultCharsetOnMediaTypeHeader(MultivaluedMap<String, Object> httpHeaders,
+                                                        MediaType mediaType);
+}
diff --git a/wink-common/src/main/java/org/apache/wink/common/internal/utils/MediaTypeUtils.java b/wink-common/src/main/java/org/apache/wink/common/internal/utils/MediaTypeUtils.java
index 3723c516..a2c8c681 100644
--- a/wink-common/src/main/java/org/apache/wink/common/internal/utils/MediaTypeUtils.java
+++ b/wink-common/src/main/java/org/apache/wink/common/internal/utils/MediaTypeUtils.java
@@ -24,14 +24,13 @@ import java.util.Comparator;
 import java.util.LinkedHashSet;
 import java.util.Set;
 
-import javax.ws.rs.core.HttpHeaders;
 import javax.ws.rs.core.MediaType;
 import javax.ws.rs.core.MultivaluedMap;
 
 import org.apache.wink.common.RuntimeContext;
+import org.apache.wink.common.internal.contexts.MediaTypeCharsetAdjuster;
 import org.apache.wink.common.internal.runtime.RuntimeContextTLS;
 import org.apache.wink.common.internal.uri.UriEncoder;
-import org.apache.wink.common.utils.ProviderUtils;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
@@ -256,33 +255,14 @@ public class MediaTypeUtils {
      */
     public static MediaType setDefaultCharsetOnMediaTypeHeader(MultivaluedMap<String, Object> httpHeaders,
                                                                MediaType mediaType) {
-        logger.debug("setDefaultCharsetOnMediaTypeHeader({}, {}) entry", httpHeaders, mediaType); //$NON-NLS-1$
-
-        if (httpHeaders != null && httpHeaders.get(HttpHeaders.CONTENT_TYPE) == null) {
-            // only correct the MediaType if the MediaType was not explicitly
-            // set
-            logger
-                .debug("Media Type not explicitly set on Response so going to correct charset parameter if necessary"); //$NON-NLS-1$
-            if (ProviderUtils.getCharsetOrNull(mediaType) == null) { //$NON-NLS-1$
-                try {
-                    RuntimeContext context = RuntimeContextTLS.getRuntimeContext();
-                    HttpHeaders requestHeaders = null;
-                    if (context != null) {
-                        requestHeaders = context.getHttpHeaders();
-                    }
-                    String charsetValue = ProviderUtils.getCharset(mediaType, requestHeaders);
-                    String newMediaTypeStr = mediaType.toString() + ";charset=" + charsetValue;
-                    mediaType = MediaType.valueOf(newMediaTypeStr);
-                    httpHeaders.putSingle(HttpHeaders.CONTENT_TYPE, newMediaTypeStr); //$NON-NLS-1$
-                    logger
-                        .debug("Changed media type to be {} in Content-Type HttpHeader", newMediaTypeStr); //$NON-NLS-1$
-                } catch (Exception e) {
-                    logger.debug("Caught exception while trying to set the charset", e); //$NON-NLS-1$
-                }
+        RuntimeContext context = RuntimeContextTLS.getRuntimeContext();
+        MediaTypeCharsetAdjuster adjuster = null;
+        if (context != null) {
+            adjuster = context.getAttribute(MediaTypeCharsetAdjuster.class);
+            if (adjuster != null) {
+                return adjuster.setDefaultCharsetOnMediaTypeHeader(httpHeaders, mediaType);
             }
         }
-
-        logger.debug("setDefaultCharsetOnMediaTypeHeader() exit returning {}", mediaType); //$NON-NLS-1$
         return mediaType;
     }
 
diff --git a/wink-common/src/test/java/org/apache/wink/common/internal/providers/jaxb/ProvidersJAXBTest.java b/wink-common/src/test/java/org/apache/wink/common/internal/providers/jaxb/ProvidersJAXBTest.java
index ded3f6dd..0c6cb6d6 100644
--- a/wink-common/src/test/java/org/apache/wink/common/internal/providers/jaxb/ProvidersJAXBTest.java
+++ b/wink-common/src/test/java/org/apache/wink/common/internal/providers/jaxb/ProvidersJAXBTest.java
@@ -19,24 +19,39 @@
  *******************************************************************************/
 package org.apache.wink.common.internal.providers.jaxb;
 
-import static org.junit.Assert.assertTrue;
-
 import java.io.ByteArrayInputStream;
+import java.io.ByteArrayOutputStream;
+import java.io.IOException;
 
+import javax.ws.rs.WebApplicationException;
 import javax.ws.rs.core.MediaType;
+import javax.ws.rs.core.MultivaluedMap;
+import javax.ws.rs.ext.ContextResolver;
 import javax.ws.rs.ext.MessageBodyReader;
+import javax.ws.rs.ext.MessageBodyWriter;
+import javax.ws.rs.ext.Providers;
 import javax.xml.bind.JAXBContext;
 import javax.xml.bind.JAXBException;
 
+import org.apache.wink.common.internal.CaseInsensitiveMultivaluedMap;
 import org.apache.wink.common.internal.providers.entity.xml.JAXBXmlProvider;
 import org.apache.wink.common.internal.providers.jaxb.jaxb1.AddNumbers;
+import org.apache.wink.common.model.JAXBUnmarshalOptions;
+import org.apache.wink.common.model.XmlFormattingOptions;
+import org.jmock.Expectations;
+import org.jmock.integration.junit3.MockObjectTestCase;
 import org.junit.Before;
 import org.junit.Test;
 
-public class ProvidersJAXBTest {
+public class ProvidersJAXBTest extends MockObjectTestCase {
     
     public class MyJAXBXmlProvider extends JAXBXmlProvider {
 
+        MyJAXBXmlProvider() {
+            super();
+            providers = ProvidersJAXBTest.this.providers;
+        }
+        
         /* 
          * simulate what would happen if application had supplied a JAXBContext provider
          */
@@ -55,19 +70,66 @@ public class ProvidersJAXBTest {
         "<arg1>2</arg1>" +
         "</ns2:addNumbers>";
     
-    private MessageBodyReader jaxbProvider = null;
+    static final String expectedXml = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>" + 
+        "<addNumbers xmlns=\"http://org/apache/wink/common/internal/providers/jaxb/jaxb1\">" +
+        "<arg0>0</arg0>" +
+        "<arg1>0</arg1>" +
+        "</addNumbers>";
+
+    private MessageBodyReader jaxbProviderReader = null;
+    private MessageBodyWriter jaxbProviderWriter = null;
+    private Providers providers;
     
     @Before
     public void setUp() {
-        jaxbProvider = new MyJAXBXmlProvider();
+        providers = mock(Providers.class);
+        checking(new Expectations() {{
+            allowing(providers).getContextResolver(JAXBContext.class, MediaType.TEXT_XML_TYPE); will(returnValue(new MyJAXBContextResolver()));
+            allowing(providers).getContextResolver(XmlFormattingOptions.class, MediaType.TEXT_XML_TYPE); will(returnValue(null));
+            allowing(providers).getContextResolver(JAXBUnmarshalOptions.class, MediaType.TEXT_XML_TYPE); will(returnValue(null));
+        }});
+        jaxbProviderReader = new MyJAXBXmlProvider();
+        jaxbProviderWriter = new MyJAXBXmlProvider();
     }
     
     @Test
     public void testJAXBUnmarshallingWithAlternateContext1() throws Exception {
-        assertTrue(jaxbProvider.isReadable(AddNumbers.class, null, null, MediaType.TEXT_XML_TYPE));
+        assertTrue(jaxbProviderReader.isReadable(AddNumbers.class, null, null, MediaType.TEXT_XML_TYPE));
         ByteArrayInputStream bais = new ByteArrayInputStream(xml.getBytes());
-        Object obj = jaxbProvider.readFrom(AddNumbers.class, null, null, MediaType.TEXT_XML_TYPE, null, bais);
+        Object obj = jaxbProviderReader.readFrom(AddNumbers.class, null, null, MediaType.TEXT_XML_TYPE, null, bais);
         assertTrue(obj instanceof AddNumbers);
     }
     
+    public class MyJAXBContextResolver implements ContextResolver<JAXBContext> {
+
+        public JAXBContext getContext(Class<?> arg0) {
+            try {
+                return JAXBContext.newInstance(arg0);
+            } catch (JAXBException e) {
+                e.printStackTrace();
+                throw new RuntimeException(e);
+            }
+        }
+    }
+    
+    @SuppressWarnings("unchecked")
+    @Test
+    public void testJAXBMarshalling() throws WebApplicationException, IOException {
+        assertTrue(jaxbProviderWriter.isWriteable(AddNumbers.class, null, null, MediaType.TEXT_XML_TYPE));
+        ByteArrayOutputStream baos = new ByteArrayOutputStream();
+        jaxbProviderWriter.writeTo(new AddNumbers(), AddNumbers.class, null, null, MediaType.TEXT_XML_TYPE, null, baos);
+        assertEquals(expectedXml, baos.toString());
+    }
+    
+    @SuppressWarnings("unchecked")
+    @Test
+    public void testJAXBMarshallingWithMap() throws WebApplicationException, IOException {
+        assertTrue(jaxbProviderWriter.isWriteable(AddNumbers.class, null, null, MediaType.TEXT_XML_TYPE));
+        ByteArrayOutputStream baos = new ByteArrayOutputStream();
+        MultivaluedMap map = new CaseInsensitiveMultivaluedMap<Object>();
+        jaxbProviderWriter.writeTo(new AddNumbers(), AddNumbers.class, null, null, MediaType.TEXT_XML_TYPE, map, baos);
+        assertEquals(expectedXml, baos.toString());
+    }
+    
+    
 }
