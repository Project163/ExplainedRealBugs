{"url":"https://api.github.com/repos/d3/d3/issues/3256","repository_url":"https://api.github.com/repos/d3/d3","labels_url":"https://api.github.com/repos/d3/d3/issues/3256/labels{/name}","comments_url":"https://api.github.com/repos/d3/d3/issues/3256/comments","events_url":"https://api.github.com/repos/d3/d3/issues/3256/events","html_url":"https://github.com/d3/d3/issues/3256","id":292380209,"node_id":"MDU6SXNzdWUyOTIzODAyMDk=","number":3256,"title":"Installing `d3` pulls in multiple versions of the same d3-* packages","user":{"login":"edmorley","id":501702,"node_id":"MDQ6VXNlcjUwMTcwMg==","avatar_url":"https://avatars.githubusercontent.com/u/501702?v=4","gravatar_id":"","url":"https://api.github.com/users/edmorley","html_url":"https://github.com/edmorley","followers_url":"https://api.github.com/users/edmorley/followers","following_url":"https://api.github.com/users/edmorley/following{/other_user}","gists_url":"https://api.github.com/users/edmorley/gists{/gist_id}","starred_url":"https://api.github.com/users/edmorley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edmorley/subscriptions","organizations_url":"https://api.github.com/users/edmorley/orgs","repos_url":"https://api.github.com/users/edmorley/repos","events_url":"https://api.github.com/users/edmorley/events{/privacy}","received_events_url":"https://api.github.com/users/edmorley/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2018-01-29T11:56:16Z","updated_at":"2021-12-23T10:50:15Z","closed_at":"2018-01-29T15:13:41Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### STR\r\n1. `mkdir d3-test && cd d3-test`\r\n2. `yarn add d3@4.12.2`\r\n3. Inspect `yarn.lock` to see if any packages installed more than once due to different versions. eg using: `grep '^[^ ]' yarn.lock | sed 's/@.*//' | sort | uniq -d`\r\n\r\n### Expected\r\nNo duplicate d3 packages of differing versions.\r\n\r\n### Actual\r\n* `d3-format` is installed twice, once at version `1.2.1` and once at `1.2.2`. The older version is due to the parent `d3` package pinning to an exact version, whereas `d3-scale` pins to a version range (`1`).\r\n* `d3-selection` is installed twice, once at version `1.2.0` and once at `1.3.0`. Similar to above, the older version is due to the `d3` package pinning to an exact version, whereas `d3-drag`, `d3-brush`, `d3-zoom` pin to `1` and `d3-transition` pins to `^1.1.0`.\r\n\r\nThis means potentially two copies of both packages can end up in the webpack build output, bloating the size of the browser bundle.\r\n\r\nI was going to suggest changing the `d3` package's exact version pinning to use version ranges - however it appears that the status quo is intentional (#3088). It seems that if this design decision is to be kept, then either:\r\n* the d3 repo needs to be updated regularly for new d3 sub-package releases - perhaps using something like [Renovate](https://renovateapp.com/) to simplify the process?\r\n* the sub packages need to use exact versions as well, rather than ranges (although this will presumably create even more chances of dependencies drifting and not being in sync)\r\n\r\nMany thanks :-)","closed_by":{"login":"mbostock","id":230541,"node_id":"MDQ6VXNlcjIzMDU0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/230541?v=4","gravatar_id":"","url":"https://api.github.com/users/mbostock","html_url":"https://github.com/mbostock","followers_url":"https://api.github.com/users/mbostock/followers","following_url":"https://api.github.com/users/mbostock/following{/other_user}","gists_url":"https://api.github.com/users/mbostock/gists{/gist_id}","starred_url":"https://api.github.com/users/mbostock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mbostock/subscriptions","organizations_url":"https://api.github.com/users/mbostock/orgs","repos_url":"https://api.github.com/users/mbostock/repos","events_url":"https://api.github.com/users/mbostock/events{/privacy}","received_events_url":"https://api.github.com/users/mbostock/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/d3/d3/issues/3256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/d3/d3/issues/3256/timeline","performed_via_github_app":null,"state_reason":"completed"}