{"url":"https://api.github.com/repos/d3/d3/issues/1599","repository_url":"https://api.github.com/repos/d3/d3","labels_url":"https://api.github.com/repos/d3/d3/issues/1599/labels{/name}","comments_url":"https://api.github.com/repos/d3/d3/issues/1599/comments","events_url":"https://api.github.com/repos/d3/d3/issues/1599/events","html_url":"https://github.com/d3/d3/issues/1599","id":21416376,"node_id":"MDU6SXNzdWUyMTQxNjM3Ng==","number":1599,"title":"Initial drag event slugish on android tablet","user":{"login":"ratbeard","id":28356,"node_id":"MDQ6VXNlcjI4MzU2","avatar_url":"https://avatars.githubusercontent.com/u/28356?v=4","gravatar_id":"","url":"https://api.github.com/users/ratbeard","html_url":"https://github.com/ratbeard","followers_url":"https://api.github.com/users/ratbeard/followers","following_url":"https://api.github.com/users/ratbeard/following{/other_user}","gists_url":"https://api.github.com/users/ratbeard/gists{/gist_id}","starred_url":"https://api.github.com/users/ratbeard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ratbeard/subscriptions","organizations_url":"https://api.github.com/users/ratbeard/orgs","repos_url":"https://api.github.com/users/ratbeard/repos","events_url":"https://api.github.com/users/ratbeard/events{/privacy}","received_events_url":"https://api.github.com/users/ratbeard/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/d3/d3/milestones/28","html_url":"https://github.com/d3/d3/milestone/28","labels_url":"https://api.github.com/repos/d3/d3/milestones/28/labels","id":401944,"node_id":"MDk6TWlsZXN0b25lNDAxOTQ0","number":28,"title":"3.3.x","description":"","creator":{"login":"mbostock","id":230541,"node_id":"MDQ6VXNlcjIzMDU0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/230541?v=4","gravatar_id":"","url":"https://api.github.com/users/mbostock","html_url":"https://github.com/mbostock","followers_url":"https://api.github.com/users/mbostock/followers","following_url":"https://api.github.com/users/mbostock/following{/other_user}","gists_url":"https://api.github.com/users/mbostock/gists{/gist_id}","starred_url":"https://api.github.com/users/mbostock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mbostock/subscriptions","organizations_url":"https://api.github.com/users/mbostock/orgs","repos_url":"https://api.github.com/users/mbostock/repos","events_url":"https://api.github.com/users/mbostock/events{/privacy}","received_events_url":"https://api.github.com/users/mbostock/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":71,"state":"closed","created_at":"2013-08-14T16:40:06Z","updated_at":"2015-02-06T15:46:48Z","due_on":null,"closed_at":"2014-01-10T18:32:42Z"},"comments":2,"created_at":"2013-10-22T20:50:37Z","updated_at":"2013-11-06T23:52:44Z","closed_at":"2013-10-25T22:40:02Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"In our application we have noticed slow responsiveness on drag events in d3 using an android nexus 10 tablet, running android 4.3 and chrome 30.  d3 is version 3.3.6\n\n![screen shot 2013-10-22 at 3 19 45 pm](https://f.cloud.github.com/assets/28356/1385084/da4c3c6a-3b58-11e3-83d6-d6cfc2f1c2bb.png)\n\nIn our app we have you can drag the green circles above around, we update the position using `d3.select(this).attr(cx: draggedPointXCoordinate, cy: draggedPointYCoordinate)` in a drag handler.  After touching a circle and moving your finger, there is a noticeable (I'd guess 150-200ms) delay before the circle updates its position to where your finger is the first time.  Once its gotten over this initial \"hump\", the circle's position tracks your fingers' position pretty well, its only that first update that has a delay.  This delay is observable even with very simple code like replacing the drag handler code with: `this.setAttribute(\"fill\", \"red\")`.  console.logs put inside the drag handler are visible immediately, its just that first UI update that is delayed.\n\nUsing android remote debugging and the timeline view, I saw:\n\n![screen shot 2013-10-22 at 3 17 31 pm](https://f.cloud.github.com/assets/28356/1384943/245133da-3b57-11e3-8527-bc41373e8fd1.png)\n\nYou can see there is an initial long recalc and paint step after the first drag event.  The first drag event is longer than usual and has a warning icon that recalcing is going on within the browser.  Clicking on the line number, the problem was setting the userSelect style twice in the drag_suppress function: https://github.com/mbostock/d3/blob/master/src/event/drag.js#L17\n\nWhen I comment out the two lines that set this style, the initial performance delay is gone (no recalcs, initial touch event is only 4ms), and it feels snappy:\n\n![screen shot 2013-10-22 at 3 36 06 pm](https://f.cloud.github.com/assets/28356/1385129/a273e4d6-3b59-11e3-967d-13cc881cc144.png)\n\nWe're going to keep this functionality commented out as it isn't needed for a `<circle>`, but sounds like it is for a `<a>` or `<img>`.  Not sure if there is a solution to handle both cases, other than making this a configurable option.  I could help with that and supply a better demo than these screenshots if we think theres a way to fix this.\n","closed_by":{"login":"mbostock","id":230541,"node_id":"MDQ6VXNlcjIzMDU0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/230541?v=4","gravatar_id":"","url":"https://api.github.com/users/mbostock","html_url":"https://github.com/mbostock","followers_url":"https://api.github.com/users/mbostock/followers","following_url":"https://api.github.com/users/mbostock/following{/other_user}","gists_url":"https://api.github.com/users/mbostock/gists{/gist_id}","starred_url":"https://api.github.com/users/mbostock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mbostock/subscriptions","organizations_url":"https://api.github.com/users/mbostock/orgs","repos_url":"https://api.github.com/users/mbostock/repos","events_url":"https://api.github.com/users/mbostock/events{/privacy}","received_events_url":"https://api.github.com/users/mbostock/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/d3/d3/issues/1599/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/d3/d3/issues/1599/timeline","performed_via_github_app":null,"state_reason":"completed"}