diff --git a/index.js b/index.js
index b10f07f8..c745778d 100644
--- a/index.js
+++ b/index.js
@@ -1,17 +1,18 @@
-var document = require("jsdom").jsdom("<html><head></head><body></body></html>"),
-    window = document.parentWindow,
+var document = require("jsdom").jsdom(),
     globals = {};
 
-// stash globals
+// Stash old globals.
+if ("d3" in global) globals.d3 = global.d3;
 if ("window" in global) globals.window = global.window;
-global.window = window;
 if ("document" in global) globals.document = global.document;
+
+// Set temporary globals to pretend we’re in a browser.
+global.window = document.parentWindow;
 global.document = document;
 
 module.exports = require("./d3");
 
-// restore globals
-if ("window" in globals) global.window = globals.window;
-else delete global.window;
-if ("document" in globals) global.document = globals.document;
-else delete global.document;
+// Restore old globals.
+if ("d3" in globals) global.d3 = globals.d3; else delete global.d3;
+if ("window" in globals) global.window = globals.window; else delete global.window;
+if ("document" in globals) global.document = globals.document; else delete global.document;
diff --git a/test/index-test.js b/test/index-test.js
new file mode 100644
index 00000000..f6e23abf
--- /dev/null
+++ b/test/index-test.js
@@ -0,0 +1,16 @@
+var vows = require("vows"),
+    assert = require("./assert");
+
+var suite = vows.describe("d3");
+
+require("../");
+
+suite.addBatch({
+  "d3": {
+    "is not a global when require’d": function() {
+      assert.equal("d3" in global, false);
+    }
+  }
+});
+
+suite.export(module);
