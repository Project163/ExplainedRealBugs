diff --git a/pom.xml b/pom.xml
index ebc76d3..ac939be 100644
--- a/pom.xml
+++ b/pom.xml
@@ -112,7 +112,7 @@ under the License.
     <dependency>
       <groupId>org.ow2.asm</groupId>
       <artifactId>asm</artifactId>
-      <version>6.0_ALPHA</version>
+      <version>6.0_ALPHA2</version>
     </dependency>
     <dependency>
       <groupId>com.thoughtworks.qdox</groupId>
diff --git a/src/it/automodules-application/invoker.properties b/src/it/automodules-application/invoker.properties
index bd324cb..9511718 100644
--- a/src/it/automodules-application/invoker.properties
+++ b/src/it/automodules-application/invoker.properties
@@ -16,4 +16,3 @@
 # under the License.
 
 invoker.java.version = 9+
-invoker.build.result=failure
diff --git a/src/it/automodules-application/src/main/java/org/maven/test/Main.java b/src/it/automodules-application/src/main/java/org/maven/test/Main.java
index 570983c..eea5036 100644
--- a/src/it/automodules-application/src/main/java/org/maven/test/Main.java
+++ b/src/it/automodules-application/src/main/java/org/maven/test/Main.java
@@ -19,17 +19,14 @@ package org.maven.test;
  * under the License.
  */
 
-import java.util.ArrayList;
-import java.util.List;
-
-
+import org.codehaus.plexus.util.StringUtils;
 
 public class Main {
+    
     /**
      * @param args
      */
     public static void main(String[] args) {
-        List blah = new ArrayList();
-        blah.add("hello");
+        System.out.println( StringUtils.concatenate( args ) );
     }
 }
diff --git a/src/it/automodules-library/invoker.properties b/src/it/automodules-library/invoker.properties
index bd324cb..9511718 100644
--- a/src/it/automodules-library/invoker.properties
+++ b/src/it/automodules-library/invoker.properties
@@ -16,4 +16,3 @@
 # under the License.
 
 invoker.java.version = 9+
-invoker.build.result=failure
diff --git a/src/it/automodules-library/src/main/java/org/maven/test/Main.java b/src/it/automodules-library/src/main/java/org/maven/test/Main.java
index 570983c..463feac 100644
--- a/src/it/automodules-library/src/main/java/org/maven/test/Main.java
+++ b/src/it/automodules-library/src/main/java/org/maven/test/Main.java
@@ -19,17 +19,14 @@ package org.maven.test;
  * under the License.
  */
 
-import java.util.ArrayList;
-import java.util.List;
-
-
+import org.codehaus.plexus.util.StringUtils;
 
 public class Main {
+    
     /**
      * @param args
      */
     public static void main(String[] args) {
-        List blah = new ArrayList();
-        blah.add("hello");
+        System.out.println( StringUtils.concatenate( args ) );
     }
-}
+}
\ No newline at end of file
diff --git a/src/it/automodules-manifest/invoker.properties b/src/it/automodules-manifest/invoker.properties
new file mode 100644
index 0000000..9511718
--- /dev/null
+++ b/src/it/automodules-manifest/invoker.properties
@@ -0,0 +1,18 @@
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+# 
+#   http://www.apache.org/licenses/LICENSE-2.0
+# 
+# Unless required by applicable law or agreed to in writing,
+# software distributed under the License is distributed on an
+# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+# KIND, either express or implied.  See the License for the
+# specific language governing permissions and limitations
+# under the License.
+
+invoker.java.version = 9+
diff --git a/src/it/automodules-manifest/pom.xml b/src/it/automodules-manifest/pom.xml
new file mode 100644
index 0000000..7f1eb74
--- /dev/null
+++ b/src/it/automodules-manifest/pom.xml
@@ -0,0 +1,56 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+  ~ Licensed to the Apache Software Foundation (ASF) under one
+  ~ or more contributor license agreements.  See the NOTICE file
+  ~ distributed with this work for additional information
+  ~ regarding copyright ownership.  The ASF licenses this file
+  ~ to you under the Apache License, Version 2.0 (the
+  ~ "License"); you may not use this file except in compliance
+  ~ with the License.  You may obtain a copy of the License at
+  ~
+  ~   http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing,
+  ~ software distributed under the License is distributed on an
+  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+  ~ KIND, either express or implied.  See the License for the
+  ~ specific language governing permissions and limitations
+  ~ under the License.
+  -->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0"
+         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+  <modelVersion>4.0.0</modelVersion>
+
+  <groupId>org.apache.maven.plugins.compiler.it</groupId>
+  <artifactId>automodules</artifactId>
+  <version>1.0-SNAPSHOT</version>
+
+  <properties>
+    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
+  </properties>
+
+  <build>
+    <pluginManagement>
+      <plugins>
+        <plugin>
+          <groupId>org.apache.maven.plugins</groupId>
+          <artifactId>maven-compiler-plugin</artifactId>
+          <version>@project.version@</version>
+          <configuration>
+            <release>9</release>
+          </configuration>
+        </plugin>
+      </plugins>
+    </pluginManagement>
+  </build>
+
+  <dependencies>
+    <dependency>
+      <groupId>org.apache.maven.plugins.compiler.it</groupId>
+      <artifactId>ta3</artifactId>
+      <version>3.0-SNAPSHOT</version>
+    </dependency>
+  </dependencies>
+</project>
diff --git a/src/it/automodules-manifest/src/main/java/module-info.java b/src/it/automodules-manifest/src/main/java/module-info.java
new file mode 100644
index 0000000..5bd017f
--- /dev/null
+++ b/src/it/automodules-manifest/src/main/java/module-info.java
@@ -0,0 +1,22 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ * 
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+module app 
+{
+    requires com.ta3;    
+}
\ No newline at end of file
diff --git a/src/it/automodules-manifest/src/main/java/org/maven/test/Main.java b/src/it/automodules-manifest/src/main/java/org/maven/test/Main.java
new file mode 100644
index 0000000..b81a720
--- /dev/null
+++ b/src/it/automodules-manifest/src/main/java/org/maven/test/Main.java
@@ -0,0 +1,28 @@
+package org.maven.test;
+
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ * 
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+public class Main 
+{
+    public static void main( String[] args )
+    {
+        System.out.println( com.ta3.MyClass.class.getName() );
+    }
+}
diff --git a/src/it/automodules-manifest/verify.groovy b/src/it/automodules-manifest/verify.groovy
new file mode 100644
index 0000000..51ff08e
--- /dev/null
+++ b/src/it/automodules-manifest/verify.groovy
@@ -0,0 +1,22 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ * 
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+buildLog = new File( basedir, 'build.log' ).text;
+
+assert !buildLog.contains("] Required automodules detected. Please don't publish this project to a public artifact repository!");
diff --git a/src/it/automodules-transitive-module/invoker.properties b/src/it/automodules-transitive-module/invoker.properties
new file mode 100644
index 0000000..9511718
--- /dev/null
+++ b/src/it/automodules-transitive-module/invoker.properties
@@ -0,0 +1,18 @@
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+# 
+#   http://www.apache.org/licenses/LICENSE-2.0
+# 
+# Unless required by applicable law or agreed to in writing,
+# software distributed under the License is distributed on an
+# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+# KIND, either express or implied.  See the License for the
+# specific language governing permissions and limitations
+# under the License.
+
+invoker.java.version = 9+
diff --git a/src/it/automodules-transitive-module/pom.xml b/src/it/automodules-transitive-module/pom.xml
new file mode 100644
index 0000000..e87e3aa
--- /dev/null
+++ b/src/it/automodules-transitive-module/pom.xml
@@ -0,0 +1,56 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+  ~ Licensed to the Apache Software Foundation (ASF) under one
+  ~ or more contributor license agreements.  See the NOTICE file
+  ~ distributed with this work for additional information
+  ~ regarding copyright ownership.  The ASF licenses this file
+  ~ to you under the Apache License, Version 2.0 (the
+  ~ "License"); you may not use this file except in compliance
+  ~ with the License.  You may obtain a copy of the License at
+  ~
+  ~   http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing,
+  ~ software distributed under the License is distributed on an
+  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+  ~ KIND, either express or implied.  See the License for the
+  ~ specific language governing permissions and limitations
+  ~ under the License.
+  -->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0"
+         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+  <modelVersion>4.0.0</modelVersion>
+
+  <groupId>org.apache.maven.plugins.compiler.it</groupId>
+  <artifactId>automodules</artifactId>
+  <version>1.0-SNAPSHOT</version>
+
+  <properties>
+    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
+  </properties>
+
+  <build>
+    <pluginManagement>
+      <plugins>
+        <plugin>
+          <groupId>org.apache.maven.plugins</groupId>
+          <artifactId>maven-compiler-plugin</artifactId>
+          <version>@project.version@</version>
+          <configuration>
+            <release>9</release>
+          </configuration>
+        </plugin>
+      </plugins>
+    </pluginManagement>
+  </build>
+
+  <dependencies>
+    <dependency>
+      <groupId>org.codehaus.plexus</groupId>
+      <artifactId>plexus-utils</artifactId>
+      <version>2.0.4</version>
+    </dependency>
+  </dependencies>
+</project>
diff --git a/src/it/automodules-transitive-module/src/main/java/module-info.java b/src/it/automodules-transitive-module/src/main/java/module-info.java
new file mode 100644
index 0000000..17205e3
--- /dev/null
+++ b/src/it/automodules-transitive-module/src/main/java/module-info.java
@@ -0,0 +1,24 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ * 
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+module lib 
+{
+    requires plexus.utils;
+    
+    exports org.maven.test;
+}
\ No newline at end of file
diff --git a/src/it/automodules-transitive-module/src/main/java/org/maven/test/Main.java b/src/it/automodules-transitive-module/src/main/java/org/maven/test/Main.java
new file mode 100644
index 0000000..463feac
--- /dev/null
+++ b/src/it/automodules-transitive-module/src/main/java/org/maven/test/Main.java
@@ -0,0 +1,32 @@
+package org.maven.test;
+
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ * 
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+import org.codehaus.plexus.util.StringUtils;
+
+public class Main {
+    
+    /**
+     * @param args
+     */
+    public static void main(String[] args) {
+        System.out.println( StringUtils.concatenate( args ) );
+    }
+}
\ No newline at end of file
diff --git a/src/it/automodules-transitive-module/verify.groovy b/src/it/automodules-transitive-module/verify.groovy
new file mode 100644
index 0000000..15c7a52
--- /dev/null
+++ b/src/it/automodules-transitive-module/verify.groovy
@@ -0,0 +1,22 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ * 
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+buildLog = new File( basedir, 'build.log' ).text;
+
+assert buildLog.contains("[WARNING] * Required automodules detected. Please don't publish this project to a public artifact repository! *");
diff --git a/src/it/setup_jar_automodule/invoker.properties b/src/it/setup_jar_automodule/invoker.properties
new file mode 100644
index 0000000..4b40d10
--- /dev/null
+++ b/src/it/setup_jar_automodule/invoker.properties
@@ -0,0 +1,19 @@
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+# 
+#   http://www.apache.org/licenses/LICENSE-2.0
+# 
+# Unless required by applicable law or agreed to in writing,
+# software distributed under the License is distributed on an
+# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+# KIND, either express or implied.  See the License for the
+# specific language governing permissions and limitations
+# under the License.
+
+invoker.java.version = 1.9+
+invoker.goals = install
diff --git a/src/it/setup_jar_automodule/pom.xml b/src/it/setup_jar_automodule/pom.xml
new file mode 100644
index 0000000..b20e48b
--- /dev/null
+++ b/src/it/setup_jar_automodule/pom.xml
@@ -0,0 +1,59 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+  ~ Licensed to the Apache Software Foundation (ASF) under one
+  ~ or more contributor license agreements.  See the NOTICE file
+  ~ distributed with this work for additional information
+  ~ regarding copyright ownership.  The ASF licenses this file
+  ~ to you under the Apache License, Version 2.0 (the
+  ~ "License"); you may not use this file except in compliance
+  ~ with the License.  You may obtain a copy of the License at
+  ~
+  ~   http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing,
+  ~ software distributed under the License is distributed on an
+  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+  ~ KIND, either express or implied.  See the License for the
+  ~ specific language governing permissions and limitations
+  ~ under the License.
+  -->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0"
+         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+  <modelVersion>4.0.0</modelVersion>
+
+  <groupId>org.apache.maven.plugins.compiler.it</groupId>
+  <artifactId>ta3</artifactId>
+  <version>3.0-SNAPSHOT</version>
+
+  <properties>
+    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
+  </properties>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-compiler-plugin</artifactId>
+        <version>@project.version@</version>
+        <configuration>
+          <release>9</release>
+        </configuration>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-jar-plugin</artifactId>
+        <version>3.0.2</version>
+        <configuration>
+          <archive>
+            <manifestEntries>
+              <Automatic-Module-Name>com.ta3</Automatic-Module-Name>
+            </manifestEntries>
+          </archive>
+        </configuration>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/it/setup_jar_automodule/src/main/java/com/ta3/MyClass.java b/src/it/setup_jar_automodule/src/main/java/com/ta3/MyClass.java
new file mode 100644
index 0000000..e6cbd8b
--- /dev/null
+++ b/src/it/setup_jar_automodule/src/main/java/com/ta3/MyClass.java
@@ -0,0 +1,25 @@
+package com.ta3;
+
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ * 
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+public class MyClass
+{
+
+}
diff --git a/src/it/setup_jar_classic/invoker.properties b/src/it/setup_jar_classic/invoker.properties
new file mode 100644
index 0000000..4b40d10
--- /dev/null
+++ b/src/it/setup_jar_classic/invoker.properties
@@ -0,0 +1,19 @@
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+# 
+#   http://www.apache.org/licenses/LICENSE-2.0
+# 
+# Unless required by applicable law or agreed to in writing,
+# software distributed under the License is distributed on an
+# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+# KIND, either express or implied.  See the License for the
+# specific language governing permissions and limitations
+# under the License.
+
+invoker.java.version = 1.9+
+invoker.goals = install
diff --git a/src/it/setup_jar_classic/pom.xml b/src/it/setup_jar_classic/pom.xml
new file mode 100644
index 0000000..6c9c7c9
--- /dev/null
+++ b/src/it/setup_jar_classic/pom.xml
@@ -0,0 +1,47 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+  ~ Licensed to the Apache Software Foundation (ASF) under one
+  ~ or more contributor license agreements.  See the NOTICE file
+  ~ distributed with this work for additional information
+  ~ regarding copyright ownership.  The ASF licenses this file
+  ~ to you under the Apache License, Version 2.0 (the
+  ~ "License"); you may not use this file except in compliance
+  ~ with the License.  You may obtain a copy of the License at
+  ~
+  ~   http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing,
+  ~ software distributed under the License is distributed on an
+  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+  ~ KIND, either express or implied.  See the License for the
+  ~ specific language governing permissions and limitations
+  ~ under the License.
+  -->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0"
+         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+  <modelVersion>4.0.0</modelVersion>
+
+  <groupId>org.apache.maven.plugins.compiler.it</groupId>
+  <artifactId>ta2</artifactId>
+  <version>1.0-SNAPSHOT</version>
+
+  <properties>
+    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
+  </properties>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-compiler-plugin</artifactId>
+        <version>@project.version@</version>
+        <configuration>
+          <release>9</release>
+        </configuration>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/it/setup_jar_classic/src/main/java/com/ta2/MyClass.java b/src/it/setup_jar_classic/src/main/java/com/ta2/MyClass.java
new file mode 100644
index 0000000..4309cae
--- /dev/null
+++ b/src/it/setup_jar_classic/src/main/java/com/ta2/MyClass.java
@@ -0,0 +1,25 @@
+package com.ta2;
+
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ * 
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+public class MyClass
+{
+
+}
diff --git a/src/it/setup_jar_module/invoker.properties b/src/it/setup_jar_module/invoker.properties
new file mode 100644
index 0000000..4b40d10
--- /dev/null
+++ b/src/it/setup_jar_module/invoker.properties
@@ -0,0 +1,19 @@
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+# 
+#   http://www.apache.org/licenses/LICENSE-2.0
+# 
+# Unless required by applicable law or agreed to in writing,
+# software distributed under the License is distributed on an
+# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+# KIND, either express or implied.  See the License for the
+# specific language governing permissions and limitations
+# under the License.
+
+invoker.java.version = 1.9+
+invoker.goals = install
diff --git a/src/it/setup_jar_module/pom.xml b/src/it/setup_jar_module/pom.xml
new file mode 100644
index 0000000..f651038
--- /dev/null
+++ b/src/it/setup_jar_module/pom.xml
@@ -0,0 +1,47 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+  ~ Licensed to the Apache Software Foundation (ASF) under one
+  ~ or more contributor license agreements.  See the NOTICE file
+  ~ distributed with this work for additional information
+  ~ regarding copyright ownership.  The ASF licenses this file
+  ~ to you under the Apache License, Version 2.0 (the
+  ~ "License"); you may not use this file except in compliance
+  ~ with the License.  You may obtain a copy of the License at
+  ~
+  ~   http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing,
+  ~ software distributed under the License is distributed on an
+  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+  ~ KIND, either express or implied.  See the License for the
+  ~ specific language governing permissions and limitations
+  ~ under the License.
+  -->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0"
+         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+  <modelVersion>4.0.0</modelVersion>
+
+  <groupId>org.apache.maven.plugins.compiler.it</groupId>
+  <artifactId>ta2</artifactId>
+  <version>2.0-SNAPSHOT</version>
+
+  <properties>
+    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
+  </properties>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-compiler-plugin</artifactId>
+        <version>@project.version@</version>
+        <configuration>
+          <release>9</release>
+        </configuration>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/src/it/setup_jar_module/src/main/java/com/ta2/MyClass.java b/src/it/setup_jar_module/src/main/java/com/ta2/MyClass.java
new file mode 100644
index 0000000..4309cae
--- /dev/null
+++ b/src/it/setup_jar_module/src/main/java/com/ta2/MyClass.java
@@ -0,0 +1,25 @@
+package com.ta2;
+
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ * 
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+public class MyClass
+{
+
+}
diff --git a/src/it/setup_jar_module/src/main/java/module-info.java b/src/it/setup_jar_module/src/main/java/module-info.java
new file mode 100644
index 0000000..8567718
--- /dev/null
+++ b/src/it/setup_jar_module/src/main/java/module-info.java
@@ -0,0 +1,24 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ * 
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+module ta2 {
+    
+    exports com.ta2;
+    
+}
\ No newline at end of file
diff --git a/src/it/setup_module-transitive/invoker.properties b/src/it/setup_module-transitive/invoker.properties
new file mode 100644
index 0000000..4b40d10
--- /dev/null
+++ b/src/it/setup_module-transitive/invoker.properties
@@ -0,0 +1,19 @@
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+# 
+#   http://www.apache.org/licenses/LICENSE-2.0
+# 
+# Unless required by applicable law or agreed to in writing,
+# software distributed under the License is distributed on an
+# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+# KIND, either express or implied.  See the License for the
+# specific language governing permissions and limitations
+# under the License.
+
+invoker.java.version = 1.9+
+invoker.goals = install
diff --git a/src/it/setup_module-transitive/pom.xml b/src/it/setup_module-transitive/pom.xml
new file mode 100644
index 0000000..be1ec64
--- /dev/null
+++ b/src/it/setup_module-transitive/pom.xml
@@ -0,0 +1,55 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+  ~ Licensed to the Apache Software Foundation (ASF) under one
+  ~ or more contributor license agreements.  See the NOTICE file
+  ~ distributed with this work for additional information
+  ~ regarding copyright ownership.  The ASF licenses this file
+  ~ to you under the Apache License, Version 2.0 (the
+  ~ "License"); you may not use this file except in compliance
+  ~ with the License.  You may obtain a copy of the License at
+  ~
+  ~   http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing,
+  ~ software distributed under the License is distributed on an
+  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+  ~ KIND, either express or implied.  See the License for the
+  ~ specific language governing permissions and limitations
+  ~ under the License.
+  -->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0"
+         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+  <modelVersion>4.0.0</modelVersion>
+
+  <groupId>org.apache.maven.plugins.compiler.it</groupId>
+  <artifactId>ta2-plus</artifactId>
+  <version>1.0-SNAPSHOT</version>
+
+  <properties>
+    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
+  </properties>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-compiler-plugin</artifactId>
+        <version>@project.version@</version>
+        <configuration>
+          <release>9</release>
+        </configuration>
+      </plugin>
+    </plugins>
+  </build>
+  
+  <dependencies>
+    <dependency>
+      <groupId>org.apache.maven.plugins.compiler.it</groupId>
+      <artifactId>ta2</artifactId>
+      <version>1.0-SNAPSHOT</version>
+    </dependency>
+  </dependencies>
+
+</project>
diff --git a/src/it/setup_module-transitive/src/main/java/com/ta2/plus/MyClass.java b/src/it/setup_module-transitive/src/main/java/com/ta2/plus/MyClass.java
new file mode 100644
index 0000000..ce9abfe
--- /dev/null
+++ b/src/it/setup_module-transitive/src/main/java/com/ta2/plus/MyClass.java
@@ -0,0 +1,25 @@
+package com.ta2.plus;
+
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ * 
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+public class MyClass
+{
+
+}
diff --git a/src/it/setup_module-transitive/src/main/java/module-info.java b/src/it/setup_module-transitive/src/main/java/module-info.java
new file mode 100644
index 0000000..642a635
--- /dev/null
+++ b/src/it/setup_module-transitive/src/main/java/module-info.java
@@ -0,0 +1,24 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ * 
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ * 
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+module ta2.plus {
+    
+    exports com.ta2.plus;
+    
+}
\ No newline at end of file
diff --git a/src/main/java/org/apache/maven/plugin/compiler/CompilerMojo.java b/src/main/java/org/apache/maven/plugin/compiler/CompilerMojo.java
index a06b2f2..ef9db32 100644
--- a/src/main/java/org/apache/maven/plugin/compiler/CompilerMojo.java
+++ b/src/main/java/org/apache/maven/plugin/compiler/CompilerMojo.java
@@ -112,7 +112,8 @@ public class CompilerMojo
     @Parameter( defaultValue = "${project.compileClasspathElements}", readonly = true, required = true )
     private List<String> compilePath;
     
-    private final boolean allowPartialRequirements = false;
+    @Parameter
+    private boolean allowPartialRequirements;
 
     @Component( hint = "qdox" )
     private ModuleInfoParser moduleInfoParser;
@@ -209,17 +210,32 @@ public class CompilerMojo
 
                 if ( !analyzerResult.getRequiredAutomaticModules().isEmpty() )
                 {
-                    final String message = "Required automodules detected. "
-                        + "Please don't publish this project to a public artifact repository!"; 
-                    if ( moduleDescriptor.exports().isEmpty() )
-                    {
-                        // application
-                        getLog().info( message );
-                    }
-                    else
+                    boolean filenameBased = false;
+                    
+                    for ( String automodule : analyzerResult.getRequiredAutomaticModules() )
                     {
-                        // library
-                        writeBoxedWarning( message );
+                        filenameBased =
+                            ProjectAnalyzerResult.ModuleNameSource.FILENAME.equals( 
+                                                            analyzerResult.getModuleNameSource( automodule ) );
+                        
+                        if ( filenameBased )
+                        {
+                            final String message = "Required automodules detected. "
+                                + "Please don't publish this project to a public artifact repository!";
+                            
+                            if ( moduleDescriptor.exports().isEmpty() )
+                            {
+                                // application
+                                getLog().info( message );
+                            }
+                            else
+                            {
+                                // library
+                                writeBoxedWarning( message );
+                            }
+                            
+                            break;
+                        }
                     }
                 }
                 
@@ -252,21 +268,21 @@ public class CompilerMojo
                 getLog().warn( e.getMessage() );
             }
 
-            if ( !classpathElements.isEmpty() )
-            {
-                if ( compilerArgs == null )
-                {
-                    compilerArgs = new ArrayList<String>();
-                }
-                compilerArgs.add( "--add-reads" );
-                compilerArgs.add( moduleDescriptor.name() + "=ALL-UNNAMED" );
-
-                if ( !modulepathElements.isEmpty() )
-                {
-                    compilerArgs.add( "--add-reads" );
-                    compilerArgs.add( "ALL-MODULE-PATH=ALL-UNNAMED" );
-                }
-            }
+//            if ( !classpathElements.isEmpty() )
+//            {
+//                if ( compilerArgs == null )
+//                {
+//                    compilerArgs = new ArrayList<String>();
+//                }
+//                compilerArgs.add( "--add-reads" );
+//                compilerArgs.add( moduleDescriptor.name() + "=ALL-UNNAMED" );
+//
+//                if ( !modulepathElements.isEmpty() )
+//                {
+//                    compilerArgs.add( "--add-reads" );
+//                    compilerArgs.add( "ALL-MODULE-PATH=ALL-UNNAMED" );
+//                }
+//            }
         }
         else
         {
diff --git a/src/main/java/org/apache/maven/plugin/compiler/TestCompilerMojo.java b/src/main/java/org/apache/maven/plugin/compiler/TestCompilerMojo.java
index e97fde5..0651508 100644
--- a/src/main/java/org/apache/maven/plugin/compiler/TestCompilerMojo.java
+++ b/src/main/java/org/apache/maven/plugin/compiler/TestCompilerMojo.java
@@ -31,7 +31,6 @@ import java.util.Set;
 
 import org.apache.maven.plugin.MojoExecutionException;
 import org.apache.maven.plugin.compiler.module.ModuleInfoParser;
-import org.apache.maven.plugin.compiler.module.ModuleInfoParser.Type;
 import org.apache.maven.plugins.annotations.Component;
 import org.apache.maven.plugins.annotations.LifecyclePhase;
 import org.apache.maven.plugins.annotations.Mojo;
@@ -53,6 +52,8 @@ import org.codehaus.plexus.compiler.util.scan.StaleSourceScanner;
 public class TestCompilerMojo
     extends AbstractCompilerMojo
 {
+    protected static final String PS = System.getProperty( "path.separator" );
+    
     /**
      * Set this to 'true' to bypass compilation of test sources.
      * Its use is NOT RECOMMENDED, but quite convenient on occasion.
@@ -263,7 +264,19 @@ public class TestCompilerMojo
                 
                 String moduleName = getModuleName( mainOutputDirectory );
                 
-                compilerArgs.add( "-Xmodule:" + moduleName );
+                compilerArgs.add( "--patch-module" );
+                
+                StringBuilder addReadsValue = new StringBuilder( moduleName )
+                                .append( '=' )
+                                .append( mainOutputDirectory )
+                                .append( PS );
+                for ( String root : compileSourceRoots )
+                {
+                    addReadsValue.append( root ).append( PS );
+                }
+                
+                compilerArgs.add( addReadsValue.toString() );
+                
                 compilerArgs.add( "--add-reads" );
                 compilerArgs.add( moduleName + "=ALL-UNNAMED" );
             }
@@ -281,40 +294,16 @@ public class TestCompilerMojo
         
         Map<String, Exception> exceptionMap = new LinkedHashMap<String, Exception>( moduleInfoParsers.size() ); 
         
-        // Prefer ASM over QDox, since we're missing the info where the module-info.class is coming from. 
-        // With QDox it is just the best possible guess 
-        List<String> parserKeys = Arrays.asList( "asm" );
+        List<String> parserKeys = Arrays.asList( "reflect", "asm" );
         
         // The class format is still changing, for that reason provide multiple strategies to parse module-info 
         for ( String parserKey: parserKeys )
         {
             ModuleInfoParser parser = moduleInfoParsers.get( parserKey );
 
-            File modulePath = null;
-            if ( Type.CLASS.equals( parser.getType() ) )
-            {
-                modulePath = mainOutputDirectory;
-            }
-            else if ( Type.SOURCE.equals( parser.getType() ) )
-            {
-                for ( String compileSourceRoot : getProject().getCompileSourceRoots() )
-                {
-                    File sourceRoot = new File( compileSourceRoot );
-                    
-                    if ( new File( sourceRoot, "module-info.java" ).exists() )
-                    {
-                        modulePath = sourceRoot;
-                    }
-                }
-            }
-            else
-            {
-                throw new RuntimeException( "Unmapped type: " + parser.getType()  );
-            }
-            
             try
             {
-                moduleName = parser.getModuleDescriptor( modulePath  ).name();
+                moduleName = parser.getModuleDescriptor( mainOutputDirectory  ).name();
                 
                 if ( moduleName != null )
                 {
diff --git a/src/main/java/org/apache/maven/plugin/compiler/module/AsmModuleInfoParser.java b/src/main/java/org/apache/maven/plugin/compiler/module/AsmModuleInfoParser.java
index 577f84e..9b80bca 100644
--- a/src/main/java/org/apache/maven/plugin/compiler/module/AsmModuleInfoParser.java
+++ b/src/main/java/org/apache/maven/plugin/compiler/module/AsmModuleInfoParser.java
@@ -30,6 +30,7 @@ import java.util.jar.JarFile;
 import org.codehaus.plexus.component.annotations.Component;
 import org.objectweb.asm.ClassReader;
 import org.objectweb.asm.ClassVisitor;
+import org.objectweb.asm.ModuleVisitor;
 //import org.objectweb.asm.ModuleVisitor;
 import org.objectweb.asm.Opcodes;
 
@@ -65,20 +66,20 @@ public class AsmModuleInfoParser
             {
 //  REQUIRES ASM 6.0_ALPHA2
                 
-//                @Override
-//                public ModuleVisitor visitModule( String name, int arg1, String arg2 )
-//                {
-//                    wrapper.builder = JavaModuleDescriptor.newModule( name );
-//
-//                    return new ModuleVisitor( Opcodes.ASM6 )
-//                    {
-//                        @Override
-//                        public void visitRequire( String module, int access, String version )
-//                        {
-//                            wrapper.builder.requires( module );
-//                        }
-//                    };
-//                }
+                @Override
+                public ModuleVisitor visitModule( String name, int arg1, String arg2 )
+                {
+                    wrapper.builder = JavaModuleDescriptor.newModule( name );
+
+                    return new ModuleVisitor( Opcodes.ASM6 )
+                    {
+                        @Override
+                        public void visitRequire( String module, int access, String version )
+                        {
+                            wrapper.builder.requires( module );
+                        }
+                    };
+                }
             }, 0 );
 
             in.close();
diff --git a/src/main/java/org/apache/maven/plugin/compiler/module/ProjectAnalyzer.java b/src/main/java/org/apache/maven/plugin/compiler/module/ProjectAnalyzer.java
index 1e34a93..afb96b6 100644
--- a/src/main/java/org/apache/maven/plugin/compiler/module/ProjectAnalyzer.java
+++ b/src/main/java/org/apache/maven/plugin/compiler/module/ProjectAnalyzer.java
@@ -20,6 +20,7 @@ package org.apache.maven.plugin.compiler.module;
  */
 
 import java.io.File;
+import java.io.FileInputStream;
 import java.io.IOException;
 import java.util.Collections;
 import java.util.HashMap;
@@ -27,7 +28,10 @@ import java.util.HashSet;
 import java.util.LinkedHashMap;
 import java.util.Map;
 import java.util.Set;
+import java.util.jar.JarFile;
+import java.util.jar.Manifest;
 
+import org.apache.maven.plugin.compiler.module.ProjectAnalyzerResult.ModuleNameSource;
 import org.codehaus.plexus.component.annotations.Component;
 import org.codehaus.plexus.component.annotations.Requirement;
 import org.codehaus.plexus.logging.AbstractLogEnabled;
@@ -59,6 +63,8 @@ public class ProjectAnalyzer extends AbstractLogEnabled
 
         Map<String, JavaModuleDescriptor> availableNamedModules = new HashMap<String, JavaModuleDescriptor>(); 
         
+        Map<String, ModuleNameSource> moduleNameSources = new HashMap<String, ModuleNameSource>();
+        
         // start from root
         result.setBaseModuleDescriptor( baseModuleDescriptor );
 
@@ -66,15 +72,42 @@ public class ProjectAnalyzer extends AbstractLogEnabled
         for ( File file : request.getDependencyArtifacts() )
         {
             JavaModuleDescriptor descriptor = extractDescriptor( file );
-            
+
             if ( descriptor != null )
             {
                 availableNamedModules.put( descriptor.name(), descriptor );
             }
             
+            if ( descriptor == null || descriptor.isAutomatic() )
+            {
+                Manifest manifest = extractManifest( file );
+
+                String modulename = null;
+                
+                if ( manifest != null )
+                {
+                    modulename = manifest.getMainAttributes().getValue( "Automatic-Module-Name" );
+                }
+
+                if ( modulename != null )
+                {
+                    moduleNameSources.put( modulename, ModuleNameSource.MANIFEST );
+                }
+                else if ( descriptor != null )
+                {
+                    moduleNameSources.put( descriptor.name(), ModuleNameSource.FILENAME );
+                }
+            }
+            else
+            {
+                moduleNameSources.put( descriptor.name(), ModuleNameSource.MODULEDESCRIPTOR );
+            }
+            
             pathElements.put( file, descriptor );
         }
         result.setPathElements( pathElements );
+        
+        result.setModuleNameSources( moduleNameSources );
 
         if ( baseModuleDescriptor != null )
         {
@@ -110,7 +143,37 @@ public class ProjectAnalyzer extends AbstractLogEnabled
         }
         return moduleDescriptor;
     }
-    
+
+    private Manifest extractManifest( File file )
+        throws IOException
+    {
+        Manifest manifest;
+        if ( file.isFile() )
+        {
+            JarFile jarFile = null;
+            try
+            {
+                jarFile = new JarFile( file );
+                manifest = jarFile.getManifest();
+            }
+            finally
+            {
+                jarFile.close();
+            }
+        }
+        else if ( new File( file, "META-INF/MANIFEST.MF" ).exists() )
+        {
+            manifest = new Manifest( new FileInputStream( new File( file, "META-INF/MANIFEST.MF" ) ) );
+        }
+        else
+        {
+            manifest = null;
+        }
+
+        return manifest;
+    }
+
+
     private void select( JavaModuleDescriptor module, Map<String, JavaModuleDescriptor> availableModules,
                          Set<String> namedModules, Set<String> unnamedModules )
     {
diff --git a/src/main/java/org/apache/maven/plugin/compiler/module/ProjectAnalyzerResult.java b/src/main/java/org/apache/maven/plugin/compiler/module/ProjectAnalyzerResult.java
index 0ce754a..3efc0b6 100644
--- a/src/main/java/org/apache/maven/plugin/compiler/module/ProjectAnalyzerResult.java
+++ b/src/main/java/org/apache/maven/plugin/compiler/module/ProjectAnalyzerResult.java
@@ -20,6 +20,7 @@ package org.apache.maven.plugin.compiler.module;
  */
 
 import java.io.File;
+import java.util.HashMap;
 import java.util.HashSet;
 import java.util.Map;
 import java.util.Set;
@@ -32,13 +33,23 @@ import java.util.Set;
  */
 public class ProjectAnalyzerResult
 {
+    /**
+     * Source of the modulename 
+     */
+    public enum ModuleNameSource
+    {
+        FILENAME, MANIFEST, MODULEDESCRIPTOR
+    }
+    
     private JavaModuleDescriptor baseModuleDescriptor;
     
     /**
      * Ordered map, respects the classpath order
      */
     private Map<File, JavaModuleDescriptor> pathElements;
-
+    
+    private Map<String, ModuleNameSource> moduleNameSources = new HashMap<String, ModuleNameSource>();
+    
     private Set<String> requiredNormalModules = new HashSet<String>();
 
     private Set<String> requiredAutomaticModules = new HashSet<String>();
@@ -66,6 +77,16 @@ public class ProjectAnalyzerResult
         return pathElements;
     }
     
+    public void setModuleNameSources( Map<String, ModuleNameSource> moduleNameSources )
+    {
+        this.moduleNameSources = moduleNameSources;
+    }
+    
+    public ModuleNameSource getModuleNameSource( String name )
+    {
+        return moduleNameSources.get( name );
+    }
+    
     public void setRequiredNormalModules( Set<String> requiredNormalModules )
     {
         this.requiredNormalModules = requiredNormalModules;
