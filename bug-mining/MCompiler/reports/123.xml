<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:22:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MCOMPILER-157] Maven Compiler Plugin should add to compileSourceRoots for next plugins to consider as source directory for generated files </title>
                <link>https://issues.apache.org/jira/browse/MCOMPILER-157</link>
                <project id="12317225" key="MCOMPILER">Maven Compiler Plugin (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;Maven Compiler Plugin by relying on javac by default, on Java 6 platform includes annotation processors in it&apos;s processing, these in end could generate sources that are placed by default in target/generated-sources/annotations. The later should be added to compileSourceRoots so that next plugin in execution would consider those sources.&lt;/p&gt;

&lt;p&gt;Please, see the attached test case and consider the attached patch in the next release of maven-compiler-plugin.&lt;/p&gt;

&lt;p&gt;thanks,&lt;/p&gt;

&lt;p&gt;Zoran&lt;/p&gt;</description>
                <environment>Java 6</environment>
        <key id="12800448">MCOMPILER-157</key>
            <summary>Maven Compiler Plugin should add to compileSourceRoots for next plugins to consider as source directory for generated files </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdcasey">John Dennis Casey</assignee>
                                    <reporter username="zregvart@gmail.com">Zoran Regvart</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 Jul 2011 07:57:28 +0000</created>
                <updated>Mon, 16 Jun 2025 11:11:48 +0000</updated>
                            <resolved>Fri, 3 Oct 2014 16:09:05 +0000</resolved>
                                    <version>2.3.2</version>
                                    <fixVersion>3.2</fixVersion>
                                        <due></due>
                            <votes>7</votes>
                                    <watches>17</watches>
                                                                                                                <comments>
                            <comment id="14429133" author="zregvart@gmail.com" created="Tue, 19 Jul 2011 08:23:41 +0000"  >&lt;p&gt;One obvious workaround would be using build helper plugin to add the target/generated-sources/annotations to source path, like:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; 
&amp;lt;build&amp;gt;
    &amp;lt;plugins&amp;gt;
      &amp;lt;plugin&amp;gt;
        &amp;lt;groupId&amp;gt;org.codehaus.mojo&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;build-helper-maven-plugin&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;1.7&amp;lt;/version&amp;gt;
        &amp;lt;executions&amp;gt;
          &amp;lt;execution&amp;gt;
            &amp;lt;id&amp;gt;add-source&amp;lt;/id&amp;gt;
            &amp;lt;phase&amp;gt;generate-sources&amp;lt;/phase&amp;gt;
            &amp;lt;goals&amp;gt;
              &amp;lt;goal&amp;gt;add-source&amp;lt;/goal&amp;gt;
            &amp;lt;/goals&amp;gt;
            &amp;lt;configuration&amp;gt;
              &amp;lt;sources&amp;gt;
                &amp;lt;source&amp;gt;target/generated-sources/annotations&amp;lt;/source&amp;gt;
              &amp;lt;/sources&amp;gt;
            &amp;lt;/configuration&amp;gt;
          &amp;lt;/execution&amp;gt;
        &amp;lt;/executions&amp;gt;
      &amp;lt;/plugin&amp;gt;
    &amp;lt;/plugins&amp;gt;
  &amp;lt;/build&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14428852" author="jverstry" created="Sun, 7 Aug 2011 16:16:33 +0000"  >&lt;p&gt;Hi, I have tried to above workaround, but it does not work.&lt;/p&gt;

&lt;p&gt;Here is the link to the StackOverflow question I created earlier today: &lt;a href=&quot;http://stackoverflow.com/questions/6975298/generated-code-not-taken-into-account-in-maven-compile-process&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/6975298/generated-code-not-taken-into-account-in-maven-compile-process&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14428713" author="jverstry" created="Sun, 7 Aug 2011 16:39:34 +0000"  >&lt;p&gt;To be more precise, when I apply the workaround to the provided test case, it works. Yet, in my application, it does not work. The only difference is that I generate a java file where only a .aj file is generated in the test case.&lt;/p&gt;</comment>
                            <comment id="14428825" author="jverstry" created="Sun, 7 Aug 2011 20:28:22 +0000"  >&lt;p&gt;I have performed some tests and here are my results:&lt;/p&gt;

&lt;p&gt;i) I have checked-out maven-compiler-plugin from the 2.3.3 release locally&lt;br/&gt;
ii) I have applied the patch provided by Zoran&lt;br/&gt;
iii) I confirm that the issue he reported is solved with this patch (and it does not break existing tests)&lt;br/&gt;
iv) However, when generating a java file instead of an aspectj file, the java file is not taken into account in the compiling process (it is not part of the generated .jar)&lt;/p&gt;

&lt;p&gt;I am posting another test case to illustrate my point. Keep in mind that I am new to annotation processing, so I may miss something obvious. &lt;/p&gt;</comment>
                            <comment id="14428779" author="jverstry" created="Sun, 7 Aug 2011 20:29:22 +0000"  >&lt;p&gt;Sorry, I meant 2.3.2 release.&lt;/p&gt;</comment>
                            <comment id="14428676" author="glebfrank" created="Tue, 28 Feb 2012 02:38:36 +0000"  >&lt;p&gt;For that matter, why not also add the generated sources directory to the sourcepath as well, so that it gets compiled in the same run? The attached patch (maven-compiler-plugin-addToSourcePathAsWell.patch) builds on the original one to do that.&lt;/p&gt;</comment>
                            <comment id="14428833" author="jglick" created="Thu, 17 May 2012 20:54:46 +0000"  >&lt;p&gt;maven-compiler-plugin-addToSourcePathAsWell.patch should not be necessary to my knowledge; 269-generated sources already get compiled in the same run.&lt;/p&gt;</comment>
                            <comment id="14428862" author="martinfr62" created="Wed, 12 Sep 2012 15:04:50 +0000"  >&lt;p&gt;I managed to get this working using the helper plugin in combination with a second invocation of the compiler.&lt;/p&gt;

&lt;p&gt;Let compiler run normally and generate the annotation processor output.&lt;/p&gt;

&lt;p&gt;Then invoke the help plugin at the process-classes lifecycle stage, followed by the compiler again.&lt;/p&gt;

&lt;p&gt;Note that the order is important, so that the build-helper gets invoked before the compiler.&lt;/p&gt;


&lt;p&gt;&amp;lt;plugins&amp;gt;&lt;/p&gt;

&lt;p&gt;			&amp;lt;plugin&amp;gt;&lt;br/&gt;
				&amp;lt;groupId&amp;gt;org.codehaus.mojo&amp;lt;/groupId&amp;gt;&lt;br/&gt;
				&amp;lt;artifactId&amp;gt;build-helper-maven-plugin&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
				&amp;lt;version&amp;gt;1.7&amp;lt;/version&amp;gt;&lt;br/&gt;
				&amp;lt;executions&amp;gt;&lt;br/&gt;
					&amp;lt;execution&amp;gt;&lt;br/&gt;
						&amp;lt;id&amp;gt;add-source&amp;lt;/id&amp;gt;&lt;br/&gt;
						&amp;lt;phase&amp;gt;process-classes&amp;lt;/phase&amp;gt;&lt;br/&gt;
						&amp;lt;goals&amp;gt;&lt;br/&gt;
							&amp;lt;goal&amp;gt;add-source&amp;lt;/goal&amp;gt;&lt;br/&gt;
						&amp;lt;/goals&amp;gt;&lt;br/&gt;
						&amp;lt;configuration&amp;gt;&lt;br/&gt;
							&amp;lt;sources&amp;gt;&lt;br/&gt;
								&amp;lt;source&amp;gt;target/generated-sources/annotations&amp;lt;/source&amp;gt;&lt;br/&gt;
							&amp;lt;/sources&amp;gt;&lt;br/&gt;
						&amp;lt;/configuration&amp;gt;&lt;br/&gt;
					&amp;lt;/execution&amp;gt;&lt;br/&gt;
				&amp;lt;/executions&amp;gt;&lt;br/&gt;
			&amp;lt;/plugin&amp;gt;&lt;br/&gt;
			&amp;lt;plugin&amp;gt;&lt;br/&gt;
				&amp;lt;artifactId&amp;gt;maven-compiler-plugin&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
				&amp;lt;executions&amp;gt;&lt;br/&gt;
					&amp;lt;execution&amp;gt;&lt;br/&gt;
						&amp;lt;id&amp;gt;add-source&amp;lt;/id&amp;gt;&lt;br/&gt;
						&amp;lt;phase&amp;gt;process-classes&amp;lt;/phase&amp;gt;&lt;br/&gt;
						&amp;lt;goals&amp;gt;&lt;br/&gt;
							&amp;lt;goal&amp;gt;compile&amp;lt;/goal&amp;gt;&lt;br/&gt;
						&amp;lt;/goals&amp;gt;&lt;/p&gt;

&lt;p&gt;					&amp;lt;/execution&amp;gt;&lt;br/&gt;
				&amp;lt;/executions&amp;gt;&lt;br/&gt;
			&amp;lt;/plugin&amp;gt;&lt;br/&gt;
		&amp;lt;/plugins&amp;gt;&lt;/p&gt;</comment>
                            <comment id="14428817" author="martinfr62" created="Wed, 12 Sep 2012 15:06:15 +0000"  >&lt;p&gt;Should also state I upgraded to the compiler version 2.5.1 and am using maven 3.0.4&lt;/p&gt;</comment>
                            <comment id="14428962" author="olamy" created="Mon, 12 Nov 2012 03:13:57 +0000"  >&lt;p&gt;is there any way to have a failing test case ?  &lt;/p&gt;</comment>
                            <comment id="14429137" author="zregvart@gmail.com" created="Wed, 14 Nov 2012 16:48:03 +0000"  >&lt;p&gt;Olivier, so the two projects that I&apos;ll upload are example of a failing situation. The awkwardly named  compiler-plugin-simple-annotation-processor is an annotation processor that will generate a .txt file in the with the same directory structure as the annotated class, that is a class annotated with @SimpleAnnotation. The other project is compiler-plugin-annotation-test that has a compile dependency on the former, and a test that checks if the .txt file was indeed created.&lt;/p&gt;

&lt;p&gt;If you were to do it on command line using standard java tools you would first compile the sources with javac (including compiler-plugin-simple-annotation-processor.jar and junit.jar) at this point javac would detect the annotation processor and it would create the .txt file (in current directory if no -s option was given). Then you would use java org.junit.runner.JUnitCore org.apache.maven.plugin.AnnotationProcessorTest with classpath pointing to the output of javac (that would include the generated .txt file).&lt;/p&gt;

&lt;p&gt;With maven project directory structure and conventions, i.e. source output of annotation processors is target/generated-sources/&lt;span class=&quot;error&quot;&gt;&amp;#91;test-&amp;#93;&lt;/span&gt;annotations, and the fact that current maven compiler plugin does not forward the target/generated-sources/&lt;span class=&quot;error&quot;&gt;&amp;#91;test-&amp;#93;&lt;/span&gt;annotations to compileSourceRoots fails the test. The build helper workaround mentioned above helps, but I think that proper solution is for maven compiler plugin to include the sources it generated (via annotation processors) in classpath for other plugins to have.&lt;/p&gt;

&lt;p&gt;This is very similar to my original use case - in which I was generating resources (AspectJ inter type declarations) to be considered by the another plugin after maven compiler plugin (AspectJ maven plugin), that needs these generated resources in classpath. But I imagine that there are other use cases for this as well.&lt;/p&gt;

&lt;p&gt;I don&apos;t know it this is what you were thinking by a failing test, but I hope it helps.&lt;/p&gt;

&lt;p&gt;Zoran&lt;/p&gt;</comment>
                            <comment id="14428886" author="zregvart@gmail.com" created="Wed, 14 Nov 2012 16:48:25 +0000"  >&lt;p&gt;The failing test example&lt;/p&gt;</comment>
                            <comment id="14429082" author="jdcasey" created="Fri, 3 Oct 2014 16:09:05 +0000"  >&lt;p&gt;adapted failing test case. It&apos;s now using a plugin to try to read the generated file from the annotation processor execution. It doesn&apos;t make sense that text files in the source roots would be accessible via the JUnit test classpath...&lt;/p&gt;

&lt;p&gt;Thanks for the patch and base test case!&lt;/p&gt;</comment>
                            <comment id="14429088" author="scottcarey" created="Fri, 13 Feb 2015 16:28:05 +0000"  >&lt;p&gt;This &lt;em&gt;seems&lt;/em&gt; to be the nexus of a lot of broken behavior related to annotation processing tools.   Any chance it would be reverted?  It simply appears to be the wrong thing to do.   &apos;mvn clean compile&apos; followed by &apos;mvn compile&apos; breaks in most builds that have annotation processors that generate classes, from what appears to be this as the root cause.&lt;/p&gt;

&lt;p&gt;Adding a project&apos;s generated-sources/annotations to &lt;em&gt;downstream&lt;/em&gt; projects classpath is probably ok, but adding it to itself appears flawed &amp;#8211; that would imply that &apos;compile&apos; and &apos;clean compile&apos; are not expected to have the same input to the compile phase!.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/MCOMPILER-235&quot; title=&quot;duplicate classes due to MCOMPILER-157 when compiler is called twice or more&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MCOMPILER-235&quot;&gt;&lt;del&gt;MCOMPILER-235&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/MCOMPILER-236&quot; title=&quot;Compilation error due to MCOMPILER-157 in deploy phase&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MCOMPILER-236&quot;&gt;&lt;del&gt;MCOMPILER-236&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14429087" author="dawid.weiss" created="Mon, 9 Mar 2015 15:48:42 +0000"  >&lt;blockquote&gt;&lt;p&gt;&apos;mvn clean compile&apos; followed by &apos;mvn compile&apos; breaks in most builds that have annotation processors that generate classes, from what appears to be this as the root cause.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Amen to that. It also happens with just about any JMH project.&lt;/p&gt;</comment>
                            <comment id="17532819" author="hudson" created="Fri, 6 May 2022 12:01:24 +0000"  >&lt;p&gt;Build succeeded in Jenkins: Maven &#187; Maven TLP &#187; maven-compiler-plugin &#187; master #54&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://ci-maven.apache.org/job/Maven/job/maven-box/job/maven-compiler-plugin/job/master/54/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-maven.apache.org/job/Maven/job/maven-box/job/maven-compiler-plugin/job/master/54/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17569277" author="hudson" created="Thu, 21 Jul 2022 06:01:10 +0000"  >&lt;p&gt;Build succeeded in Jenkins: Maven &#187; Maven TLP &#187; maven-compiler-plugin &#187; master #72&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://ci-maven.apache.org/job/Maven/job/maven-box/job/maven-compiler-plugin/job/master/72/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-maven.apache.org/job/Maven/job/maven-box/job/maven-compiler-plugin/job/master/72/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17978821" author="olamy" created="Mon, 16 Jun 2025 11:11:48 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-compiler-plugin/issues/872&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-compiler-plugin#872&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12800502">MCOMPILER-159</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310260">
                    <name>Related</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12800483">MCOMPILER-235</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12800499">MCOMPILER-236</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12714928" name="TestCase2.zip" size="7812" author="jverstry" created="Sun, 7 Aug 2011 20:32:41 +0000"/>
                            <attachment id="12714947" name="failing-test-example.zip" size="9824" author="zregvart" created="Wed, 14 Nov 2012 16:48:24 +0000"/>
                            <attachment id="12714897" name="maven-compiler-plugin-add-compileSourceRoots.patch" size="1675" author="zregvart" created="Tue, 19 Jul 2011 07:57:31 +0000"/>
                            <attachment id="12714921" name="maven-compiler-plugin-addToSourcePathAsWell.patch" size="2239" author="glebfrank" created="Tue, 28 Feb 2012 02:38:36 +0000"/>
                            <attachment id="12714919" name="test-case.zip" size="8637" author="zregvart" created="Tue, 19 Jul 2011 07:57:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i29t73:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>