<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:57:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLUME-2525] flume should handle a zero byte .flumespool-main.meta file for the spooldir source</title>
                <link>https://issues.apache.org/jira/browse/FLUME-2525</link>
                <project id="12311321" key="FLUME">Flume</project>
                    <description>&lt;p&gt;When a zero byte .flumespool-main.meta file exists in the trackerDir (usually do to the partition filling up), flume will throw the following ambiguous error message when trying to read in new spool files:&lt;br/&gt;
2014-10-19 18:28:31,333 ERROR org.apache.flume.client.avro.ReliableSpoolingFileEventReader: Exception opening file: /home/spooldir/input.log&lt;br/&gt;
java.io.IOException: Not a data file. &lt;br/&gt;
at org.apache.avro.file.DataFileStream.initialize(DataFileStream.java:102) &lt;br/&gt;
at org.apache.avro.file.DataFileReader.&amp;lt;init&amp;gt;(DataFileReader.java:97) &lt;br/&gt;
at org.apache.avro.file.DataFileWriter.appendTo(DataFileWriter.java:160) &lt;br/&gt;
at org.apache.avro.file.DataFileWriter.appendTo(DataFileWriter.java:149) &lt;br/&gt;
at org.apache.flume.serialization.DurablePositionTracker.&amp;lt;init&amp;gt;(DurablePositionTracker.java:141) &lt;br/&gt;
at org.apache.flume.serialization.DurablePositionTracker.getInstance(DurablePositionTracker.java:76) &lt;br/&gt;
at org.apache.flume.client.avro.ReliableSpoolingFileEventReader.getNextFile(ReliableSpoolingFileEventReader.java:420) &lt;br/&gt;
at org.apache.flume.client.avro.ReliableSpoolingFileEventReader.readEvents(ReliableSpoolingFileEventReader.java:215) &lt;br/&gt;
at org.apache.flume.source.SpoolDirectorySource$SpoolDirectoryRunnable.run(SpoolDirectorySource.java:182) &lt;br/&gt;
at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441) &lt;br/&gt;
at java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:317) &lt;br/&gt;
at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:150) &lt;br/&gt;
at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:98) &lt;br/&gt;
at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:180) &lt;br/&gt;
at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:204) &lt;br/&gt;
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) &lt;br/&gt;
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) &lt;br/&gt;
at java.lang.Thread.run(Thread.java:662) &lt;/p&gt;

&lt;p&gt;Restarts of the flume agent do not resolve the issue.  Only when the zero byte file is removed, will flume properly start processing files from the spooldir again.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12751270">FLUME-2525</key>
            <summary>flume should handle a zero byte .flumespool-main.meta file for the spooldir source</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jrufus">Johny Rufus</assignee>
                                    <reporter username="pdvorak">Patrick Dvorak</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Oct 2014 23:31:40 +0000</created>
                <updated>Thu, 6 Nov 2014 20:44:13 +0000</updated>
                            <resolved>Thu, 6 Nov 2014 19:33:15 +0000</resolved>
                                    <version>1.5.0.1</version>
                                    <fixVersion>1.6.0</fixVersion>
                                    <component>Sinks+Sources</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14187712" author="pdvorak" created="Tue, 28 Oct 2014 23:34:29 +0000"  >&lt;p&gt;When a partition containing the trackerDir (or spoolDir in the event trackerDir is not specified) fills up, a new meta file can be created, but it will have a zero byte size.  This prevents flume from properly processing any files once the partition full issue has been resolved, even across restarts.  The error thrown does not really indicate the root issue.  Ideally flume should remove any zero byte spooldir meta files when it starts up, as these are invalid.&lt;/p&gt;</comment>
                            <comment id="14189220" author="jrufus" created="Wed, 29 Oct 2014 23:05:50 +0000"  >&lt;p&gt;Attached a patch, that deletes zero byte tracker files when trying to instantiate the position tracker and logs detailed error messages &lt;/p&gt;</comment>
                            <comment id="14195289" author="hshreedharan" created="Mon, 3 Nov 2014 22:55:48 +0000"  >&lt;p&gt;Couple of comments:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Do you really need to wait for the IOException before deleting the zero-byte file? Why not check beforehand, and delete the file?&lt;/li&gt;
	&lt;li&gt;In the unit tests, please use junit Assert.* methods, not the standard java asserts.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14196250" author="jrufus" created="Tue, 4 Nov 2014 15:44:32 +0000"  >&lt;p&gt;Thanks Hari, the initial idea was to decode the IOException to find the root cause, but since we cant do that accurately, following your suggestion. Attaching a new patch&lt;/p&gt;</comment>
                            <comment id="14199504" author="hshreedharan" created="Thu, 6 Nov 2014 01:00:25 +0000"  >&lt;p&gt;+1. I made a couple of formatting changes (added {} for single statement if). Running tests now, if they pass I will commit this.&lt;/p&gt;</comment>
                            <comment id="14200733" author="jira-bot" created="Thu, 6 Nov 2014 19:32:47 +0000"  >&lt;p&gt;Commit efbf87fb6ddc0bbc736446a5a91cf6a83d34d2d4 in flume&apos;s branch refs/heads/trunk from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hshreedharan&quot; class=&quot;user-hover&quot; rel=&quot;hshreedharan&quot;&gt;hshreedharan&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=efbf87f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=efbf87f&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2525&quot; title=&quot;flume should handle a zero byte .flumespool-main.meta file for the spooldir source&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2525&quot;&gt;&lt;del&gt;FLUME-2525&lt;/del&gt;&lt;/a&gt;. Handle a zero byte .flumespool-main.meta file for the spooldir source.&lt;/p&gt;

&lt;p&gt;(Johny Rufus via Hari)&lt;/p&gt;</comment>
                            <comment id="14200734" author="jira-bot" created="Thu, 6 Nov 2014 19:32:54 +0000"  >&lt;p&gt;Commit c2b953449d033acaa02e3ced1d9a95e9cdcb5e02 in flume&apos;s branch refs/heads/flume-1.6 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hshreedharan&quot; class=&quot;user-hover&quot; rel=&quot;hshreedharan&quot;&gt;hshreedharan&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=c2b9534&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=c2b9534&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2525&quot; title=&quot;flume should handle a zero byte .flumespool-main.meta file for the spooldir source&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2525&quot;&gt;&lt;del&gt;FLUME-2525&lt;/del&gt;&lt;/a&gt;. Handle a zero byte .flumespool-main.meta file for the spooldir source.&lt;/p&gt;

&lt;p&gt;(Johny Rufus via Hari)&lt;/p&gt;</comment>
                            <comment id="14200736" author="hshreedharan" created="Thu, 6 Nov 2014 19:33:15 +0000"  >&lt;p&gt;Committed! Thanks Johny!&lt;/p&gt;</comment>
                            <comment id="14200866" author="hudson" created="Thu, 6 Nov 2014 20:38:41 +0000"  >&lt;p&gt;SUCCESS: Integrated in flume-trunk #688 (See &lt;a href=&quot;https://builds.apache.org/job/flume-trunk/688/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/flume-trunk/688/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2525&quot; title=&quot;flume should handle a zero byte .flumespool-main.meta file for the spooldir source&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2525&quot;&gt;&lt;del&gt;FLUME-2525&lt;/del&gt;&lt;/a&gt;. Handle a zero byte .flumespool-main.meta file for the spooldir source. (hshreedharan: &lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/flume/repo?p=flume.git&amp;amp;a=commit&amp;amp;h=efbf87fb6ddc0bbc736446a5a91cf6a83d34d2d4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/flume/repo?p=flume.git&amp;amp;a=commit&amp;amp;h=efbf87fb6ddc0bbc736446a5a91cf6a83d34d2d4&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;flume-ng-core/src/test/java/org/apache/flume/client/avro/TestReliableSpoolingFileEventReader.java&lt;/li&gt;
	&lt;li&gt;flume-ng-core/src/main/java/org/apache/flume/client/avro/ReliableSpoolingFileEventReader.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14200878" author="hudson" created="Thu, 6 Nov 2014 20:44:13 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Flume-trunk-hbase-98 #45 (See &lt;a href=&quot;https://builds.apache.org/job/Flume-trunk-hbase-98/45/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Flume-trunk-hbase-98/45/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2525&quot; title=&quot;flume should handle a zero byte .flumespool-main.meta file for the spooldir source&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2525&quot;&gt;&lt;del&gt;FLUME-2525&lt;/del&gt;&lt;/a&gt;. Handle a zero byte .flumespool-main.meta file for the spooldir source. (hshreedharan: &lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/flume/repo?p=flume.git&amp;amp;a=commit&amp;amp;h=efbf87fb6ddc0bbc736446a5a91cf6a83d34d2d4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/flume/repo?p=flume.git&amp;amp;a=commit&amp;amp;h=efbf87fb6ddc0bbc736446a5a91cf6a83d34d2d4&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;flume-ng-core/src/main/java/org/apache/flume/client/avro/ReliableSpoolingFileEventReader.java&lt;/li&gt;
	&lt;li&gt;flume-ng-core/src/test/java/org/apache/flume/client/avro/TestReliableSpoolingFileEventReader.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12679239" name="FLUME-2525-1.patch" size="2548" author="jrufus" created="Tue, 4 Nov 2014 15:44:32 +0000"/>
                            <attachment id="12678050" name="FLUME-2525.patch" size="3669" author="jrufus" created="Wed, 29 Oct 2014 23:04:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 2 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i21p6v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>