<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:57:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLUME-2950] ReliableSpoolingFileEventReader.rollCurrentFile is broken</title>
                <link>https://issues.apache.org/jira/browse/FLUME-2950</link>
                <project id="12311321" key="FLUME">Flume</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2939&quot; title=&quot;Upgrade recursive SpoolDir to use Java7 features&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2939&quot;&gt;&lt;del&gt;FLUME-2939&lt;/del&gt;&lt;/a&gt; introduced Java 7 API (nio.file) to ReliableSpoolingFileEventReader. However, the committed patch breaks rollCurrentFile on Windows machines.&lt;br/&gt;
File rename might be not atomic, in such cases, and under the assumption that the rolled file and the current file store the same data, Flume only logs a warning and does not assume that the user broke the contract that the spooling directory source demands.&lt;br/&gt;
In order to determine whether the files store the same data, we used the com.google.common.io.Files.equal method. However, &lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2939&quot; title=&quot;Upgrade recursive SpoolDir to use Java7 features&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2939&quot;&gt;&lt;del&gt;FLUME-2939&lt;/del&gt;&lt;/a&gt; uses java.nio.file.Files.isSameFile which has different semantics.&lt;br/&gt;
Consequently, this relaxation does not hold anymore. In addition, org.apache.flume.client.avro.TestSpoolingFileLineReader.testDestinationExistsAndSameFileWindows fails.&lt;/p&gt;

&lt;p&gt;I attach a patch that brings back the old check for Files.equal.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12988143">FLUME-2950</key>
            <summary>ReliableSpoolingFileEventReader.rollCurrentFile is broken</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="liorze">Lior Zeno</assignee>
                                    <reporter username="liorze">Lior Zeno</reporter>
                        <labels>
                    </labels>
                <created>Sun, 10 Jul 2016 17:06:12 +0000</created>
                <updated>Mon, 11 Jul 2016 00:08:34 +0000</updated>
                            <resolved>Sun, 10 Jul 2016 22:43:25 +0000</resolved>
                                    <version>1.7.0</version>
                                    <fixVersion>1.7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15369976" author="mpercy" created="Sun, 10 Jul 2016 22:17:32 +0000"  >&lt;p&gt;+1. Nice find.&lt;/p&gt;</comment>
                            <comment id="15369984" author="jira-bot" created="Sun, 10 Jul 2016 22:38:32 +0000"  >&lt;p&gt;Commit ba64b12670f7b2c9ce079f8898f4601689a51def in flume&apos;s branch refs/heads/trunk from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=liorze&quot; class=&quot;user-hover&quot; rel=&quot;liorze&quot;&gt;liorze&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=ba64b12&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=ba64b12&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2950&quot; title=&quot;ReliableSpoolingFileEventReader.rollCurrentFile is broken&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2950&quot;&gt;&lt;del&gt;FLUME-2950&lt;/del&gt;&lt;/a&gt;. ReliableSpoolingFileEventReader.rollCurrentFile is broken&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2939&quot; title=&quot;Upgrade recursive SpoolDir to use Java7 features&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2939&quot;&gt;&lt;del&gt;FLUME-2939&lt;/del&gt;&lt;/a&gt; introduced a Java 7 API (nio.file) to&lt;br/&gt;
ReliableSpoolingFileEventReader. However, the committed patch breaks&lt;br/&gt;
rollCurrentFile() on Windows machines. File rename might be not atomic,&lt;br/&gt;
in such cases, and under the assumption that the rolled file and the&lt;br/&gt;
current file store the same data, Flume only logs a warning and does not&lt;br/&gt;
assume that the user broke the contract that the spooling directory&lt;br/&gt;
source demands.&lt;/p&gt;

&lt;p&gt;In order to determine whether the files store the same data, we used the&lt;br/&gt;
com.google.common.io.Files.equal() method. However, &lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2939&quot; title=&quot;Upgrade recursive SpoolDir to use Java7 features&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2939&quot;&gt;&lt;del&gt;FLUME-2939&lt;/del&gt;&lt;/a&gt; uses&lt;br/&gt;
java.nio.file.Files.isSameFile() which has different semantics.&lt;br/&gt;
Consequently, this relaxation does not hold anymore. In addition,&lt;br/&gt;
TestSpoolingFileLineReader.testDestinationExistsAndSameFileWindows&lt;br/&gt;
fails. This patch brings back the old check using Files.equal().&lt;/p&gt;

&lt;p&gt;(Lior Zeno via Mike Percy)&lt;/p&gt;</comment>
                            <comment id="15369987" author="mpercy" created="Sun, 10 Jul 2016 22:39:32 +0000"  >&lt;p&gt;Pushed to trunk. Thanks for the fix, Lior!&lt;/p&gt;</comment>
                            <comment id="15370012" author="hudson" created="Mon, 11 Jul 2016 00:08:34 +0000"  >&lt;p&gt;FAILURE: Integrated in Flume-trunk-hbase-1 #176 (See &lt;a href=&quot;https://builds.apache.org/job/Flume-trunk-hbase-1/176/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Flume-trunk-hbase-1/176/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2950&quot; title=&quot;ReliableSpoolingFileEventReader.rollCurrentFile is broken&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2950&quot;&gt;&lt;del&gt;FLUME-2950&lt;/del&gt;&lt;/a&gt;. ReliableSpoolingFileEventReader.rollCurrentFile is broken (mpercy: &lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/flume/repo?p=flume.git&amp;amp;a=commit&amp;amp;h=ba64b12670f7b2c9ce079f8898f4601689a51def&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/flume/repo?p=flume.git&amp;amp;a=commit&amp;amp;h=ba64b12670f7b2c9ce079f8898f4601689a51def&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;flume-ng-core/src/main/java/org/apache/flume/client/avro/ReliableSpoolingFileEventReader.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12817048" name="FLUME-2950-0.patch" size="1003" author="liorze" created="Sun, 10 Jul 2016 17:07:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 18 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i30rjb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>