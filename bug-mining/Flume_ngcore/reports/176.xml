<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:57:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLUME-2725] HDFS Sink does not use configured timezone for rounding</title>
                <link>https://issues.apache.org/jira/browse/FLUME-2725</link>
                <project id="12311321" key="FLUME">Flume</project>
                    <description>&lt;p&gt;When a BucketPath used by an HDFS sink is configured to run with some roundUnit and roundValue &amp;gt; 1 (e.g. 6 hours), the &quot;roundDown&quot; function used by BucketPath does not actually round the date correctly.&lt;/p&gt;

&lt;p&gt;That function calls TimestampRoundDownUtil which creates a Calendar instance using the &lt;b&gt;local&lt;/b&gt; timezone to truncate a unix timestamp rather than the TimeZone that the sink was configured to convert dates to paths with (and that timezone is already available in the BucketPath class but it just isn&apos;t passed to TimestampRoundDownUtil).&lt;/p&gt;

&lt;p&gt;The net effect of this is that if a flume jvm is running on a system with an EST clock while trying to write, say, 6 hour directories in UTC time, the directories are written with the hours 04, 10, 16, 22 rather than 00, 06, 12, 18 like you would expect.&lt;/p&gt;

&lt;p&gt;I found a workaround for this by passing &quot;-Duser.timezone=&amp;lt;hdfs_sink_timezone&amp;gt;&quot; as a system property, but I wanted to create a ticket for this since it seems like it would be very minimal effort to carry that configured timezone down into the rounding utility as well.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12839612">FLUME-2725</key>
            <summary>HDFS Sink does not use configured timezone for rounding</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="denes">Denes Arvay</assignee>
                                    <reporter username="eczech">Eric Czech</reporter>
                        <labels>
                    </labels>
                <created>Mon, 22 Jun 2015 17:30:00 +0000</created>
                <updated>Wed, 13 Jul 2016 21:14:15 +0000</updated>
                            <resolved>Wed, 13 Jul 2016 19:27:49 +0000</resolved>
                                                    <fixVersion>1.7.0</fixVersion>
                                    <component>Sinks+Sources</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15358826" author="denes" created="Fri, 1 Jul 2016 11:30:19 +0000"  >&lt;p&gt;I&apos;ve attached a patch to use the configured time zone for rounding but I&apos;m a bit concerned about this change as it might break stuff at users who already adapted to the current behavior. Shouldn&apos;t we put this behind a configuration parameter, wdyt?&lt;/p&gt;</comment>
                            <comment id="15368551" author="mpercy" created="Fri, 8 Jul 2016 21:54:10 +0000"  >&lt;p&gt;Added a minor comment to the code review. I took a quick look at the patch and it looks pretty good.&lt;/p&gt;

&lt;p&gt;Overall, I think a config param to maintain backcompat could be useful in some circumstances, but the fact that the rounding did not use the timezone in the first place seems like a bug to me. Overall, I don&apos;t have a strong opinion. Maybe others have a strong opinion about it.&lt;/p&gt;</comment>
                            <comment id="15368626" author="hshreedharan" created="Fri, 8 Jul 2016 22:50:37 +0000"  >&lt;p&gt;I agree it is a bug. I don&apos;t think we actually need it to be backwards compatible - it is a bug fix, we don&apos;t need bug fixes to be backwards compatible.&lt;/p&gt;</comment>
                            <comment id="15372535" author="denes" created="Tue, 12 Jul 2016 08:40:10 +0000"  >&lt;p&gt;new patch: rebased on trunk + fixed checkstyle errors&lt;/p&gt;</comment>
                            <comment id="15375577" author="mpercy" created="Wed, 13 Jul 2016 19:25:09 +0000"  >&lt;p&gt;+1. I am about to commit this.&lt;/p&gt;</comment>
                            <comment id="15375578" author="jira-bot" created="Wed, 13 Jul 2016 19:25:54 +0000"  >&lt;p&gt;Commit ec28b66246f1f165ccaf01abf7fb27adebc9e4bb in flume&apos;s branch refs/heads/trunk from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=denes&quot; class=&quot;user-hover&quot; rel=&quot;denes&quot;&gt;denes&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=ec28b66&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=ec28b66&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2725&quot; title=&quot;HDFS Sink does not use configured timezone for rounding&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2725&quot;&gt;&lt;del&gt;FLUME-2725&lt;/del&gt;&lt;/a&gt;. HDFS Sink does not use configured timezone for rounding&lt;/p&gt;

&lt;p&gt;(Denes Arvay via Mike Percy)&lt;/p&gt;</comment>
                            <comment id="15375580" author="mpercy" created="Wed, 13 Jul 2016 19:27:49 +0000"  >&lt;p&gt;Pushed to trunk. Thanks for the patch, Denes!&lt;/p&gt;</comment>
                            <comment id="15375703" author="mpercy" created="Wed, 13 Jul 2016 20:40:16 +0000"  >&lt;p&gt;Also, thank you Attila for helping to review this patch!&lt;/p&gt;</comment>
                            <comment id="15375769" author="hudson" created="Wed, 13 Jul 2016 21:14:15 +0000"  >&lt;p&gt;FAILURE: Integrated in Flume-trunk-hbase-1 #179 (See &lt;a href=&quot;https://builds.apache.org/job/Flume-trunk-hbase-1/179/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Flume-trunk-hbase-1/179/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2725&quot; title=&quot;HDFS Sink does not use configured timezone for rounding&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2725&quot;&gt;&lt;del&gt;FLUME-2725&lt;/del&gt;&lt;/a&gt;. HDFS Sink does not use configured timezone for rounding (mpercy: &lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/flume/repo?p=flume.git&amp;amp;a=commit&amp;amp;h=ec28b66246f1f165ccaf01abf7fb27adebc9e4bb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/flume/repo?p=flume.git&amp;amp;a=commit&amp;amp;h=ec28b66246f1f165ccaf01abf7fb27adebc9e4bb&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;flume-ng-core/src/test/java/org/apache/flume/tools/TestTimestampRoundDownUtil.java&lt;/li&gt;
	&lt;li&gt;flume-ng-core/src/main/java/org/apache/flume/tools/TimestampRoundDownUtil.java&lt;/li&gt;
	&lt;li&gt;flume-ng-core/src/test/java/org/apache/flume/formatter/output/TestBucketPath.java&lt;/li&gt;
	&lt;li&gt;flume-ng-core/src/main/java/org/apache/flume/formatter/output/BucketPath.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12817376" name="FLUME-2725-2.patch" size="16134" author="denes" created="Tue, 12 Jul 2016 08:40:10 +0000"/>
                            <attachment id="12817668" name="FLUME-2725-3.patch" size="22370" author="denes" created="Wed, 13 Jul 2016 12:30:39 +0000"/>
                            <attachment id="12815736" name="FLUME-2725.patch" size="16140" author="denes" created="Fri, 1 Jul 2016 11:22:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 18 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2gciv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>