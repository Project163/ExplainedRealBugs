<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:56:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLUME-1254] RpcClient can hang when communication is broken with the source.</title>
                <link>https://issues.apache.org/jira/browse/FLUME-1254</link>
                <project id="12311321" key="FLUME">Flume</project>
                    <description>&lt;p&gt;If the source that the client is connected to fails, the RpcClient can hang indefinitely. This problem also affects the AvroCLIClient and AvroSink since they internally use the same RpcClient.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12559138">FLUME-1254</key>
            <summary>RpcClient can hang when communication is broken with the source.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aprabhakar">Arvind Prabhakar</assignee>
                                    <reporter username="aprabhakar">Arvind Prabhakar</reporter>
                        <labels>
                    </labels>
                <created>Mon, 4 Jun 2012 08:09:38 +0000</created>
                <updated>Tue, 5 Jun 2012 03:14:57 +0000</updated>
                            <resolved>Tue, 5 Jun 2012 03:02:51 +0000</resolved>
                                                    <fixVersion>1.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13288400" author="aprabhakar" created="Mon, 4 Jun 2012 08:16:02 +0000"  >&lt;p&gt;Review board is down still. Will post a review when it comes back up.&lt;/p&gt;</comment>
                            <comment id="13288408" author="aprabhakar" created="Mon, 4 Jun 2012 08:21:34 +0000"  >&lt;p&gt;This patch does the following:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Upgrades Avro to version 1.6.3 which fixes two underlying bugs &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-982&quot; title=&quot;NettyTransceiver: can hang on connection interruption&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-982&quot;&gt;&lt;del&gt;AVRO-982&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1013&quot; title=&quot;NettyTransceiver can hang after server restart&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1013&quot;&gt;&lt;del&gt;AVRO-1013&lt;/del&gt;&lt;/a&gt;.&lt;/li&gt;
	&lt;li&gt;Modifies the NettyAvroRpcClient to use a custom ThreadFactory for the transceiver that sets each thread as a daemon.&lt;/li&gt;
	&lt;li&gt;Modifies the NettyAvroRpcClient to allow the configuration of connection and request timeouts&lt;/li&gt;
	&lt;li&gt;Modifies the FailoverRpcClient to use the properties based factory method for creating individual NettyAvroRpcClients&lt;/li&gt;
	&lt;li&gt;General clean up of configuration keys/default values and tests&lt;/li&gt;
	&lt;li&gt;Modifies the AvroSink to startup normally even if there is a failure while establishing connection since the process() retries establishing the connection anyway.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Ran all tests. Will be doning more manual testing in the meantime.&lt;/p&gt;</comment>
                            <comment id="13288433" author="aprabhakar" created="Mon, 4 Jun 2012 09:01:48 +0000"  >&lt;p&gt;Fixed a problem with the sink runner due to which the AvroSink when not connected can spin out of control leading to OOM exceptions.&lt;/p&gt;</comment>
                            <comment id="13288707" author="mpercy" created="Mon, 4 Jun 2012 17:27:16 +0000"  >&lt;p&gt;Hi Arvind, I&apos;m looking at your changes. Can you please rebase the patch? It&apos;s not applying cleanly for me.&lt;/p&gt;</comment>
                            <comment id="13288765" author="aprabhakar" created="Mon, 4 Jun 2012 18:14:34 +0000"  >&lt;p&gt;Thanks Mike. Rebased the patch to latest trunk.&lt;/p&gt;</comment>
                            <comment id="13289050" author="mpercy" created="Tue, 5 Jun 2012 01:20:25 +0000"  >&lt;p&gt;Hi Arvind,&lt;br/&gt;
These changes look really good. Great job digging into and fixing this stuff!&lt;/p&gt;

&lt;p&gt;Comments:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;I was going to say that caching InetSocketAddress instead of using the new HostInfo class might be a good thing for performance. But then again it makes sense to allow DNS to change under us... so, not caching each InetSocketAddress instance actually a reliability improvement in that respect. Awesome.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Just a few nits:&lt;br/&gt;
1. RpcClientConfigurationConstants.java&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DEFAULT_CONNECT_TIMEOUT_MILLIS - maybe make it 5 seconds default? 60 seconds seems like a long time. I know this was there from before.&lt;/li&gt;
	&lt;li&gt;DEFAULT_REQUEST_TIMEOUT_MILLIS - maybe make it 20 seconds default? (Same as above)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;2. It seems like much of the code in these classes is just parsing properties file configuration. Would be nice if it was factored out somehow (using Context object internally?) - maybe this should be another JIRA&lt;/p&gt;

&lt;p&gt;3. Doesn&apos;t look like the commons-compress addition to pom.xml is used.&lt;/p&gt;</comment>
                            <comment id="13289087" author="aprabhakar" created="Tue, 5 Jun 2012 02:18:31 +0000"  >&lt;p&gt;Thanks for the review Mike. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;* DEFAULT_CONNECT_TIMEOUT_MILLIS - maybe make it 5 seconds default? 60 seconds seems like a long time. I know this was there from before.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;done&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;* DEFAULT_REQUEST_TIMEOUT_MILLIS - maybe make it 20 seconds default? (Same as above)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;done&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;2. It seems like much of the code in these classes is just parsing properties file configuration. Would be nice if it was factored out somehow (using Context object internally?) - maybe this should be another JIRA&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The rational behind having properties based factory methods was to eventually adopt a properties file based client configuration. So &lt;tt&gt;RpcClientFactory.getInstance(CONFIG_FILE_NAME)&lt;/tt&gt; will return a client that is configured vi the property file &lt;tt&gt;CONFIG_FILE_NAME&lt;/tt&gt;. Although it could internally construct a Context to do &lt;tt&gt;getInteger()&lt;/tt&gt; etc calls, but that would be an implementation detail. I would much rather leave it as is for now.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;3. Doesn&apos;t look like the commons-compress addition to pom.xml is used.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Removed.&lt;/p&gt;
</comment>
                            <comment id="13289088" author="aprabhakar" created="Tue, 5 Jun 2012 02:19:04 +0000"  >&lt;p&gt;Updated with review feedback.&lt;/p&gt;</comment>
                            <comment id="13289106" author="mpercy" created="Tue, 5 Jun 2012 03:01:54 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13289107" author="mpercy" created="Tue, 5 Jun 2012 03:02:51 +0000"  >&lt;p&gt;Patch committed. Thanks Arvind!&lt;/p&gt;</comment>
                            <comment id="13289112" author="hudson" created="Tue, 5 Jun 2012 03:14:57 +0000"  >&lt;p&gt;Integrated in flume-trunk #222 (See &lt;a href=&quot;https://builds.apache.org/job/flume-trunk/222/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/flume-trunk/222/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-1254&quot; title=&quot;RpcClient can hang when communication is broken with the source.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-1254&quot;&gt;&lt;del&gt;FLUME-1254&lt;/del&gt;&lt;/a&gt;. RpcClient can hang when communication is broken with the source.&lt;/p&gt;

&lt;p&gt;(Arvind Prabhakar via Mike Percy) (Revision 1346220)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
mpercy : &lt;a href=&quot;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1346220&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1346220&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/incubator/flume/trunk/flume-ng-core/src/main/java/org/apache/flume/SinkRunner.java&lt;/li&gt;
	&lt;li&gt;/incubator/flume/trunk/flume-ng-core/src/main/java/org/apache/flume/sink/AvroSink.java&lt;/li&gt;
	&lt;li&gt;/incubator/flume/trunk/flume-ng-sdk/src/main/java/org/apache/flume/api/AbstractRpcClient.java&lt;/li&gt;
	&lt;li&gt;/incubator/flume/trunk/flume-ng-sdk/src/main/java/org/apache/flume/api/FailoverRpcClient.java&lt;/li&gt;
	&lt;li&gt;/incubator/flume/trunk/flume-ng-sdk/src/main/java/org/apache/flume/api/NettyAvroRpcClient.java&lt;/li&gt;
	&lt;li&gt;/incubator/flume/trunk/flume-ng-sdk/src/main/java/org/apache/flume/api/RpcClientConfigurationConstants.java&lt;/li&gt;
	&lt;li&gt;/incubator/flume/trunk/flume-ng-sdk/src/main/java/org/apache/flume/api/RpcClientFactory.java&lt;/li&gt;
	&lt;li&gt;/incubator/flume/trunk/flume-ng-sdk/src/test/java/org/apache/flume/api/TestFailoverRpcClient.java&lt;/li&gt;
	&lt;li&gt;/incubator/flume/trunk/pom.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12530741" name="FLUME-1254-2.patch" size="28517" author="aprabhakar" created="Mon, 4 Jun 2012 09:01:48 +0000"/>
                            <attachment id="12530829" name="FLUME-1254-3.patch" size="28519" author="aprabhakar" created="Mon, 4 Jun 2012 18:14:34 +0000"/>
                            <attachment id="12530888" name="FLUME-1254-4.patch" size="28215" author="aprabhakar" created="Tue, 5 Jun 2012 02:19:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248255</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 24 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i09tx3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>55280</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>