<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:57:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLUME-2712] Optional channel errors slows down the Source to Main channel event rate</title>
                <link>https://issues.apache.org/jira/browse/FLUME-2712</link>
                <project id="12311321" key="FLUME">Flume</project>
                    <description>&lt;p&gt;When we have a source configured to deliver events to a main channel and an optional channel, and if the delivery to optional channel fails, this significantly slows down the rate at which events are delivered to the main channel by the source.&lt;br/&gt;
We need to evaluate async means of delivering events to the optional channel and isolate the errors happening in optional channel from the delivery to the main channel&lt;/p&gt;</description>
                <environment></environment>
        <key id="12833599">FLUME-2712</key>
            <summary>Optional channel errors slows down the Source to Main channel event rate</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jrufus">Johny Rufus</assignee>
                                    <reporter username="jrufus">Johny Rufus</reporter>
                        <labels>
                    </labels>
                <created>Thu, 28 May 2015 22:27:20 +0000</created>
                <updated>Sat, 18 Jun 2016 17:31:59 +0000</updated>
                            <resolved>Fri, 30 Oct 2015 23:42:27 +0000</resolved>
                                                    <fixVersion>1.7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14563807" author="hshreedharan" created="Thu, 28 May 2015 22:31:41 +0000"  >&lt;p&gt;A good way of doing this would be to write to all channels in parallel via a &lt;b&gt;fixed&lt;/b&gt; number of threads (to end up not using too many threads). For the ones from the &lt;em&gt;required&lt;/em&gt; channels, wait on the futures, for the others, just don&apos;t care - submit and go away.&lt;/p&gt;</comment>
                            <comment id="14944375" author="jrufus" created="Tue, 6 Oct 2015 01:31:39 +0000"  >&lt;p&gt;Attached patch with the changes to deliver to optional channel asynchronously&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;review board link -&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/39035/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/39035/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14949211" author="hshreedharan" created="Thu, 8 Oct 2015 19:23:44 +0000"  >&lt;p&gt;In general, the idea looks ok. But there is one problem with this patch - the ordering of events in the optional channel is now messed up, since we are using a thread pool to do so. This is true even if there is exactly one source. This is a pretty obvious regression. I think we&apos;d need to ensure ordering by actually having a single thread submitting the events - we should keep a blocking queue and have the thread poll that queue. &lt;/p&gt;</comment>
                            <comment id="14949215" author="hshreedharan" created="Thu, 8 Oct 2015 19:25:38 +0000"  >&lt;p&gt;Also please add a test to ensure no data gets dropped&lt;/p&gt;</comment>
                            <comment id="14949257" author="jrufus" created="Thu, 8 Oct 2015 19:48:11 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hshreedharan&quot; class=&quot;user-hover&quot; rel=&quot;hshreedharan&quot;&gt;hshreedharan&lt;/a&gt; for the catch. I thought we generally dont guarantee ordering, but it makes sense not to break the existing level of ordering. Submitting to a single threaded executor will guarantee the sequential execution of jobs and it works out of an unbounded queue, so let me make that change. Will also work on a test case.&lt;/p&gt;</comment>
                            <comment id="14977439" author="jrufus" created="Wed, 28 Oct 2015 00:12:17 +0000"  >&lt;p&gt; Attaching patch with the test case and single thread of execution for optional channel&lt;/p&gt;</comment>
                            <comment id="14981879" author="hshreedharan" created="Fri, 30 Oct 2015 04:48:44 +0000"  >&lt;p&gt;Johny,&lt;/p&gt;

&lt;p&gt;This looks good in general. Some minor comments:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;I think the &lt;tt&gt;executeRequiredChannelTransaction&lt;/tt&gt; can be &lt;tt&gt;executeChannelTransaction&lt;/tt&gt; and can be used for both. Just take an additional flag as an argument and throw the &lt;tt&gt;ChannelException&lt;/tt&gt; based on that. Otherwise the run method in &lt;tt&gt;OptionalChannelTransactionExecutor&lt;/tt&gt; are exactly the same&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;OptionalChannelTransactionExecutor&lt;/tt&gt; should be named &lt;tt&gt;OptionalChannelTransactionThread&lt;/tt&gt; or something like that - it really is not an executor.&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;List&amp;lt;Event&amp;gt; events = new ArrayList&amp;lt;Event&amp;gt;()&lt;/tt&gt; -&amp;gt; &lt;tt&gt;List&amp;lt;Event&amp;gt; events = new ArrayList&amp;lt;Event&amp;gt;(1)&lt;/tt&gt; in &lt;tt&gt;processEvent&lt;/tt&gt; method.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14983224" author="jrufus" created="Fri, 30 Oct 2015 20:12:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hshreedharan&quot; class=&quot;user-hover&quot; rel=&quot;hshreedharan&quot;&gt;hshreedharan&lt;/a&gt;, Attaching patch with review comments incorporated&lt;/p&gt;</comment>
                            <comment id="14983371" author="hshreedharan" created="Fri, 30 Oct 2015 21:33:20 +0000"  >&lt;p&gt;+1. LGTM. Running tests and committing&lt;/p&gt;</comment>
                            <comment id="14983597" author="jira-bot" created="Fri, 30 Oct 2015 23:37:31 +0000"  >&lt;p&gt;Commit 8bb556604047974775eb2da4c5c1686d89fe62d2 in flume&apos;s branch refs/heads/trunk from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hshreedharan&quot; class=&quot;user-hover&quot; rel=&quot;hshreedharan&quot;&gt;hshreedharan&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=8bb5566&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=8bb5566&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2712&quot; title=&quot;Optional channel errors slows down the Source to Main channel event rate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2712&quot;&gt;&lt;del&gt;FLUME-2712&lt;/del&gt;&lt;/a&gt;. Optional channel errors slows down the Source to Main channel event rate&lt;/p&gt;

&lt;p&gt;(Johny Rufus via Hari)&lt;/p&gt;</comment>
                            <comment id="14983607" author="jira-bot" created="Fri, 30 Oct 2015 23:42:05 +0000"  >&lt;p&gt;Commit a7ffb27014f5808633f829b5f1e72a0290bd35a5 in flume&apos;s branch refs/heads/flume-1.7 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hshreedharan&quot; class=&quot;user-hover&quot; rel=&quot;hshreedharan&quot;&gt;hshreedharan&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=a7ffb27&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=a7ffb27&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2712&quot; title=&quot;Optional channel errors slows down the Source to Main channel event rate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2712&quot;&gt;&lt;del&gt;FLUME-2712&lt;/del&gt;&lt;/a&gt;. Optional channel errors slows down the Source to Main channel event rate&lt;/p&gt;

&lt;p&gt;(Johny Rufus via Hari)&lt;/p&gt;</comment>
                            <comment id="14983610" author="hshreedharan" created="Fri, 30 Oct 2015 23:42:27 +0000"  >&lt;p&gt;Committed! Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jrufus&quot; class=&quot;user-hover&quot; rel=&quot;jrufus&quot;&gt;jrufus&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="14983712" author="hudson" created="Sat, 31 Oct 2015 00:56:27 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Flume-trunk-hbase-1 #132 (See &lt;a href=&quot;https://builds.apache.org/job/Flume-trunk-hbase-1/132/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Flume-trunk-hbase-1/132/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2712&quot; title=&quot;Optional channel errors slows down the Source to Main channel event rate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2712&quot;&gt;&lt;del&gt;FLUME-2712&lt;/del&gt;&lt;/a&gt;. Optional channel errors slows down the Source to Main (hshreedharan: &lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/flume/repo?p=flume.git&amp;amp;a=commit&amp;amp;h=8bb556604047974775eb2da4c5c1686d89fe62d2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/flume/repo?p=flume.git&amp;amp;a=commit&amp;amp;h=8bb556604047974775eb2da4c5c1686d89fe62d2&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;flume-ng-core/src/test/java/org/apache/flume/channel/TestChannelProcessor.java&lt;/li&gt;
	&lt;li&gt;flume-ng-core/src/main/java/org/apache/flume/channel/ChannelProcessor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15187681" author="jira-bot" created="Wed, 9 Mar 2016 19:05:35 +0000"  >&lt;p&gt;Commit caa64a1a6d4bc97be5993cb468516e9ffe862794 in flume&apos;s branch refs/heads/trunk from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jarcec&quot; class=&quot;user-hover&quot; rel=&quot;jarcec&quot;&gt;jarcec&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=caa64a1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=caa64a1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2891&quot; title=&quot;Revert FLUME-2712 and FLUME-2886&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2891&quot;&gt;&lt;del&gt;FLUME-2891&lt;/del&gt;&lt;/a&gt;: Revert &lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2712&quot; title=&quot;Optional channel errors slows down the Source to Main channel event rate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2712&quot;&gt;&lt;del&gt;FLUME-2712&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2886&quot; title=&quot;Optional Channels can cause OOMs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2886&quot;&gt;&lt;del&gt;FLUME-2886&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(Hari Shreedharan via Jarek Jarcec Cecho)&lt;/p&gt;</comment>
                            <comment id="15187685" author="jira-bot" created="Wed, 9 Mar 2016 19:05:54 +0000"  >&lt;p&gt;Commit c2562900f1ab9c21ae2d7c0fc26e270847e81b6d in flume&apos;s branch refs/heads/flume-1.7 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jarcec&quot; class=&quot;user-hover&quot; rel=&quot;jarcec&quot;&gt;jarcec&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=c256290&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=c256290&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2891&quot; title=&quot;Revert FLUME-2712 and FLUME-2886&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2891&quot;&gt;&lt;del&gt;FLUME-2891&lt;/del&gt;&lt;/a&gt;: Revert &lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2712&quot; title=&quot;Optional channel errors slows down the Source to Main channel event rate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2712&quot;&gt;&lt;del&gt;FLUME-2712&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2886&quot; title=&quot;Optional Channels can cause OOMs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2886&quot;&gt;&lt;del&gt;FLUME-2886&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(Hari Shreedharan via Jarek Jarcec Cecho)&lt;/p&gt;</comment>
                            <comment id="15187940" author="hudson" created="Wed, 9 Mar 2016 21:01:27 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Flume-trunk-hbase-1 #152 (See &lt;a href=&quot;https://builds.apache.org/job/Flume-trunk-hbase-1/152/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Flume-trunk-hbase-1/152/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2891&quot; title=&quot;Revert FLUME-2712 and FLUME-2886&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2891&quot;&gt;&lt;del&gt;FLUME-2891&lt;/del&gt;&lt;/a&gt;: Revert &lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2712&quot; title=&quot;Optional channel errors slows down the Source to Main channel event rate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2712&quot;&gt;&lt;del&gt;FLUME-2712&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2886&quot; title=&quot;Optional Channels can cause OOMs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2886&quot;&gt;&lt;del&gt;FLUME-2886&lt;/del&gt;&lt;/a&gt; (jarcec: &lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/flume/repo?p=flume.git&amp;amp;a=commit&amp;amp;h=caa64a1a6d4bc97be5993cb468516e9ffe862794&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/flume/repo?p=flume.git&amp;amp;a=commit&amp;amp;h=caa64a1a6d4bc97be5993cb468516e9ffe862794&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;flume-ng-core/src/test/java/org/apache/flume/channel/TestChannelProcessor.java&lt;/li&gt;
	&lt;li&gt;flume-ng-core/src/main/java/org/apache/flume/channel/ChannelProcessor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12769161" name="FLUME-2712-1.patch" size="9843" author="jrufus" created="Wed, 28 Oct 2015 00:12:17 +0000"/>
                            <attachment id="12769854" name="FLUME-2712-2.patch" size="10159" author="jrufus" created="Fri, 30 Oct 2015 20:12:07 +0000"/>
                            <attachment id="12765119" name="FLUME-2712.patch" size="7027" author="jrufus" created="Tue, 6 Oct 2015 03:29:17 +0000"/>
                            <attachment id="12765110" name="FLUME-2712.patch" size="7027" author="jrufus" created="Tue, 6 Oct 2015 01:31:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 36 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2fckn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>