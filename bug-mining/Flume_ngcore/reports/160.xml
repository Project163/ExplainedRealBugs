<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:57:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLUME-1934] Spoolingdir source exception when reading multiple   zero size files </title>
                <link>https://issues.apache.org/jira/browse/FLUME-1934</link>
                <project id="12311321" key="FLUME">Flume</project>
                    <description>&lt;p&gt;move more than one files to the spool dir, and each file size is 0, then flume agent will throw IllegalStateException forever, and never work again,its&apos; main cause is commited flag will not set to true.&lt;/p&gt;

&lt;p&gt;logs:&lt;/p&gt;

&lt;p&gt;08 &#19977;&#26376; 2013 08:00:14,406 ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-5-thread-1&amp;#93;&lt;/span&gt; (org.apache.flume.source.SpoolDirectorySource$SpoolDirectoryRunnable.run:148)  - Uncaught exception in Runnable&lt;br/&gt;
java.lang.IllegalStateException: File should not roll when  commit is outstanding.&lt;br/&gt;
	at org.apache.flume.client.avro.SpoolingFileLineReader.readLines(SpoolingFileLineReader.java:164)&lt;br/&gt;
	at org.apache.flume.source.SpoolDirectorySource$SpoolDirectoryRunnable.run(SpoolDirectorySource.java:135)&lt;br/&gt;
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)&lt;br/&gt;
	at java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:317)&lt;br/&gt;
	at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:150)&lt;br/&gt;
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:98)&lt;br/&gt;
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:181)&lt;br/&gt;
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:205)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:619)&lt;/p&gt;</description>
                <environment>&lt;p&gt;windows 7, flume 1.3.1, spooling dir source.&lt;/p&gt;</environment>
        <key id="12635955">FLUME-1934</key>
            <summary>Spoolingdir source exception when reading multiple   zero size files </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="granthenke">Grant Henke</assignee>
                                    <reporter username="ablozhou">andy zhou</reporter>
                        <labels>
                    </labels>
                <created>Fri, 8 Mar 2013 03:58:04 +0000</created>
                <updated>Tue, 7 Apr 2015 02:40:51 +0000</updated>
                            <resolved>Tue, 7 Apr 2015 01:16:49 +0000</resolved>
                                    <version>1.3.1</version>
                                    <fixVersion>1.6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="13704072" author="mpercy" created="Wed, 10 Jul 2013 01:06:04 +0000"  >&lt;p&gt;I think this is fixed. Does this still affect you on Flume 1.4.0?&lt;/p&gt;</comment>
                            <comment id="13737440" author="mpercy" created="Mon, 12 Aug 2013 22:17:44 +0000"  >&lt;p&gt;I believe the underlying issue could actually be &lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2157&quot; title=&quot;Spool directory source does not shut down correctly when Flume is reconfigured&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2157&quot;&gt;&lt;del&gt;FLUME-2157&lt;/del&gt;&lt;/a&gt; ... please reopen if you still see this issue on trunk.&lt;/p&gt;</comment>
                            <comment id="13737441" author="mpercy" created="Mon, 12 Aug 2013 22:19:14 +0000"  >&lt;p&gt;Another possible issue could be that you were running multiple SpoolDir sources pointing to the same spool directory. That will not work and is not supported.&lt;/p&gt;</comment>
                            <comment id="14394743" author="granthenke" created="Fri, 3 Apr 2015 17:33:01 +0000"  >&lt;p&gt;This is still an issue. It can be quickly reproduced with the following command:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Create empty files in a spooling directory&lt;br/&gt;
touch flumeSpool/zero1; touch flumeSpool/zero2; touch flumeSpool/zero3;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I will attach a patch with a failing test and code to make it succeed. If there is a better way to write the test please provide feedback.&lt;/p&gt;</comment>
                            <comment id="14394757" author="gwenshap" created="Fri, 3 Apr 2015 17:45:58 +0000"  >&lt;p&gt;Clicking for &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=granthenke&quot; class=&quot;user-hover&quot; rel=&quot;granthenke&quot;&gt;granthenke&lt;/a&gt; who submitted the patch but apparently doesn&apos;t have access to change status &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14394766" author="jarcec" created="Fri, 3 Apr 2015 17:50:54 +0000"  >&lt;p&gt;I&apos;ve granted you &quot;contributor&quot; role on JIRA &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=granthenke&quot; class=&quot;user-hover&quot; rel=&quot;granthenke&quot;&gt;granthenke&lt;/a&gt;. You should be able to assign the JIRA to yourself.&lt;/p&gt;</comment>
                            <comment id="14395044" author="gwenshap" created="Fri, 3 Apr 2015 20:41:16 +0000"  >&lt;p&gt;+1 - simple and clean fix, nice tests and nice log message.&lt;/p&gt;</comment>
                            <comment id="14481900" author="hshreedharan" created="Mon, 6 Apr 2015 20:45:43 +0000"  >&lt;p&gt;+1. Looks good, running tests and committing.&lt;/p&gt;</comment>
                            <comment id="14482105" author="hshreedharan" created="Mon, 6 Apr 2015 22:42:09 +0000"  >&lt;p&gt;Holding off until &lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-2657&quot; title=&quot;Upgrade to Hive 1.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-2657&quot;&gt;&lt;del&gt;FLUME-2657&lt;/del&gt;&lt;/a&gt; is committed, as full builds are currently failing due to hive depending on a snapshot of calcite that is now missing from snapshots repos&lt;/p&gt;</comment>
                            <comment id="14482352" author="jira-bot" created="Tue, 7 Apr 2015 01:16:06 +0000"  >&lt;p&gt;Commit 4d2a34e931554baa1c1b255d95540a46354a521f in flume&apos;s branch refs/heads/trunk from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hshreedharan&quot; class=&quot;user-hover&quot; rel=&quot;hshreedharan&quot;&gt;hshreedharan&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=4d2a34e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=4d2a34e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-1934&quot; title=&quot;Spoolingdir source exception when reading multiple   zero size files &quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-1934&quot;&gt;&lt;del&gt;FLUME-1934&lt;/del&gt;&lt;/a&gt;. Spooling Directory Source dies on encountering zero-byte files.&lt;/p&gt;

&lt;p&gt;(Grant Henke via Hari)&lt;/p&gt;</comment>
                            <comment id="14482353" author="jira-bot" created="Tue, 7 Apr 2015 01:16:11 +0000"  >&lt;p&gt;Commit 04f384576c1a84677d11a693812def519ac57baa in flume&apos;s branch refs/heads/flume-1.6 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hshreedharan&quot; class=&quot;user-hover&quot; rel=&quot;hshreedharan&quot;&gt;hshreedharan&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=04f3845&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=flume.git;h=04f3845&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-1934&quot; title=&quot;Spoolingdir source exception when reading multiple   zero size files &quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-1934&quot;&gt;&lt;del&gt;FLUME-1934&lt;/del&gt;&lt;/a&gt;. Spooling Directory Source dies on encountering zero-byte files.&lt;/p&gt;

&lt;p&gt;(Grant Henke via Hari)&lt;/p&gt;</comment>
                            <comment id="14482354" author="hshreedharan" created="Tue, 7 Apr 2015 01:16:49 +0000"  >&lt;p&gt;Committed! Thanks Grant!&lt;/p&gt;</comment>
                            <comment id="14482466" author="hudson" created="Tue, 7 Apr 2015 02:37:21 +0000"  >&lt;p&gt;UNSTABLE: Integrated in flume-trunk #726 (See &lt;a href=&quot;https://builds.apache.org/job/flume-trunk/726/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/flume-trunk/726/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-1934&quot; title=&quot;Spoolingdir source exception when reading multiple   zero size files &quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-1934&quot;&gt;&lt;del&gt;FLUME-1934&lt;/del&gt;&lt;/a&gt;. Spooling Directory Source dies on encountering zero-byte files. (hshreedharan: &lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/flume/repo?p=flume.git&amp;amp;a=commit&amp;amp;h=4d2a34e931554baa1c1b255d95540a46354a521f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/flume/repo?p=flume.git&amp;amp;a=commit&amp;amp;h=4d2a34e931554baa1c1b255d95540a46354a521f&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;flume-ng-core/src/test/java/org/apache/flume/source/TestSpoolDirectorySource.java&lt;/li&gt;
	&lt;li&gt;flume-ng-core/src/main/java/org/apache/flume/client/avro/ReliableSpoolingFileEventReader.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14482471" author="hudson" created="Tue, 7 Apr 2015 02:40:51 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Flume-trunk-hbase-98 #83 (See &lt;a href=&quot;https://builds.apache.org/job/Flume-trunk-hbase-98/83/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Flume-trunk-hbase-98/83/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/FLUME-1934&quot; title=&quot;Spoolingdir source exception when reading multiple   zero size files &quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLUME-1934&quot;&gt;&lt;del&gt;FLUME-1934&lt;/del&gt;&lt;/a&gt;. Spooling Directory Source dies on encountering zero-byte files. (hshreedharan: &lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/flume/repo?p=flume.git&amp;amp;a=commit&amp;amp;h=4d2a34e931554baa1c1b255d95540a46354a521f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/flume/repo?p=flume.git&amp;amp;a=commit&amp;amp;h=4d2a34e931554baa1c1b255d95540a46354a521f&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;flume-ng-core/src/test/java/org/apache/flume/source/TestSpoolDirectorySource.java&lt;/li&gt;
	&lt;li&gt;flume-ng-core/src/main/java/org/apache/flume/client/avro/ReliableSpoolingFileEventReader.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12663011">FLUME-2157</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12709273" name="FLUME-1934.patch" size="2650" author="granthenke" created="Fri, 3 Apr 2015 17:33:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>316447</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 32 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ilsf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>316790</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>