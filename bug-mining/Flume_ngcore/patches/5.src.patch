diff --git a/flume-ng-core/src/test/java/org/apache/flume/sink/TestAvroSink.java b/flume-ng-core/src/test/java/org/apache/flume/sink/TestAvroSink.java
index dd6cae80..0ac093b7 100644
--- a/flume-ng-core/src/test/java/org/apache/flume/sink/TestAvroSink.java
+++ b/flume-ng-core/src/test/java/org/apache/flume/sink/TestAvroSink.java
@@ -46,8 +46,8 @@ public class TestAvroSink {
     Context context = new Context();
 
     context.put("hostname", "localhost");
-    context.put("port", 41414);
-    context.put("batch-size", 2);
+    context.put("port", "41414");
+    context.put("batch-size", "2");
 
     sink.setChannel(channel);
 
diff --git a/flume-ng-core/src/test/java/org/apache/flume/sink/TestRollingFileSink.java b/flume-ng-core/src/test/java/org/apache/flume/sink/TestRollingFileSink.java
index 7be1266e..490ae8ac 100644
--- a/flume-ng-core/src/test/java/org/apache/flume/sink/TestRollingFileSink.java
+++ b/flume-ng-core/src/test/java/org/apache/flume/sink/TestRollingFileSink.java
@@ -9,6 +9,7 @@ import org.apache.flume.Channel;
 import org.apache.flume.Context;
 import org.apache.flume.Event;
 import org.apache.flume.EventDeliveryException;
+import org.apache.flume.channel.MemoryChannel;
 import org.apache.flume.channel.PseudoTxnMemoryChannel;
 import org.apache.flume.conf.Configurables;
 import org.apache.flume.event.SimpleEvent;
@@ -34,6 +35,8 @@ public class TestRollingFileSink {
 
     sink = new RollingFileSink();
 
+    sink.setChannel(new MemoryChannel());
+
     tmpDir.mkdirs();
   }
 
diff --git a/flume-ng-core/src/test/java/org/apache/flume/source/TestAvroSource.java b/flume-ng-core/src/test/java/org/apache/flume/source/TestAvroSource.java
index f3676143..7cd4776b 100644
--- a/flume-ng-core/src/test/java/org/apache/flume/source/TestAvroSource.java
+++ b/flume-ng-core/src/test/java/org/apache/flume/source/TestAvroSource.java
@@ -52,7 +52,7 @@ public class TestAvroSource {
       try {
         Context context = new Context();
 
-        context.put("port", selectedPort = 41414 + i);
+        context.put("port", String.valueOf(selectedPort = 41414 + i));
         context.put("bind", "0.0.0.0");
 
         Configurables.configure(source, context);
@@ -88,7 +88,7 @@ public class TestAvroSource {
       try {
         Context context = new Context();
 
-        context.put("port", selectedPort = 41414 + i);
+        context.put("port", String.valueOf(selectedPort = 41414 + i));
         context.put("bind", "0.0.0.0");
 
         Configurables.configure(source, context);
@@ -121,7 +121,7 @@ public class TestAvroSource {
     Status status = client.append(avroEvent);
 
     Assert.assertEquals(Status.OK, status);
- 
+
     Transaction transaction = channel.getTransaction();
     transaction.begin();
 
@@ -132,7 +132,6 @@ public class TestAvroSource {
     transaction.commit();
     transaction.close();
 
-
     logger.debug("Round trip event:{}", event);
 
     source.stop();
