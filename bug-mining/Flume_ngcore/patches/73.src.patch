diff --git a/flume-ng-core/pom.xml b/flume-ng-core/pom.xml
index 8dd0d3e2..8708953a 100644
--- a/flume-ng-core/pom.xml
+++ b/flume-ng-core/pom.xml
@@ -164,6 +164,11 @@ limitations under the License.
       <artifactId>servlet-api</artifactId>
     </dependency>
 
+    <dependency>
+      <groupId>com.google.code.gson</groupId>
+      <artifactId>gson</artifactId>
+    </dependency>
+
     <dependency>
       <groupId>org.mockito</groupId>
       <artifactId>mockito-all</artifactId>
diff --git a/flume-ng-core/src/main/java/org/apache/flume/channel/MemoryChannel.java b/flume-ng-core/src/main/java/org/apache/flume/channel/MemoryChannel.java
index 65b01669..c72e97ca 100644
--- a/flume-ng-core/src/main/java/org/apache/flume/channel/MemoryChannel.java
+++ b/flume-ng-core/src/main/java/org/apache/flume/channel/MemoryChannel.java
@@ -247,6 +247,8 @@ public class MemoryChannel extends BasicChannelSemantics {
   public synchronized void start() {
     channelCounter.start();
     channelCounter.setChannelSize(queue.size());
+    channelCounter.setChannelCapacity(Long.valueOf(
+            queue.size() + queue.remainingCapacity()));
     super.start();
   }
 
diff --git a/flume-ng-core/src/main/java/org/apache/flume/channel/PseudoTxnMemoryChannel.java b/flume-ng-core/src/main/java/org/apache/flume/channel/PseudoTxnMemoryChannel.java
index 489d3e5b..cc391c4b 100644
--- a/flume-ng-core/src/main/java/org/apache/flume/channel/PseudoTxnMemoryChannel.java
+++ b/flume-ng-core/src/main/java/org/apache/flume/channel/PseudoTxnMemoryChannel.java
@@ -28,6 +28,7 @@ import org.apache.flume.Event;
 import org.apache.flume.Transaction;
 
 import com.google.common.base.Preconditions;
+import org.apache.flume.instrumentation.ChannelCounter;
 
 /**
  * <p>
@@ -83,6 +84,7 @@ public class PseudoTxnMemoryChannel extends AbstractChannel {
 
   private BlockingQueue<Event> queue;
   private Integer keepAlive;
+  private ChannelCounter channelCounter;
 
   @Override
   public void configure(Context context) {
@@ -98,27 +100,51 @@ public class PseudoTxnMemoryChannel extends AbstractChannel {
     }
 
     queue = new ArrayBlockingQueue<Event>(capacity);
+    if(channelCounter == null) {
+      channelCounter = new ChannelCounter(getName());
+    }
+  }
+
+  @Override
+  public void start(){
+    channelCounter.start();
+    channelCounter.setChannelSize(queue.size());
+    channelCounter.setChannelSize(
+            Long.valueOf(queue.size() + queue.remainingCapacity()));
+    super.start();
+  }
+
+  @Override
+  public void stop(){
+    channelCounter.setChannelSize(queue.size());
+    channelCounter.stop();
+    super.stop();
   }
 
   @Override
   public void put(Event event) {
     Preconditions.checkState(queue != null,
         "No queue defined (Did you forget to configure me?");
-
+    channelCounter.incrementEventPutAttemptCount();
     try {
       queue.put(event);
     } catch (InterruptedException ex) {
       throw new ChannelException("Failed to put(" + event + ")", ex);
     }
+    channelCounter.addToEventPutSuccessCount(1);
+    channelCounter.setChannelSize(queue.size());
   }
 
   @Override
   public Event take() {
     Preconditions.checkState(queue != null,
         "No queue defined (Did you forget to configure me?");
-
+    channelCounter.incrementEventTakeAttemptCount();
     try {
-      return queue.poll(keepAlive, TimeUnit.SECONDS);
+      Event e = queue.poll(keepAlive, TimeUnit.SECONDS);
+      channelCounter.addToEventTakeSuccessCount(1);
+      channelCounter.setChannelSize(queue.size());
+      return e;
     } catch (InterruptedException ex) {
       throw new ChannelException("Failed to take()", ex);
     }
diff --git a/flume-ng-core/src/main/java/org/apache/flume/instrumentation/ChannelCounter.java b/flume-ng-core/src/main/java/org/apache/flume/instrumentation/ChannelCounter.java
index 316384a8..602481e9 100644
--- a/flume-ng-core/src/main/java/org/apache/flume/instrumentation/ChannelCounter.java
+++ b/flume-ng-core/src/main/java/org/apache/flume/instrumentation/ChannelCounter.java
@@ -35,10 +35,13 @@ public class ChannelCounter extends MonitoredCounterGroup implements
   private static final String COUNTER_EVENT_TAKE_SUCCESS =
       "channel.event.take.success";
 
+  private static final String COUNTER_CHANNEL_CAPACITY =
+          "channel.capacity";
+
   private static final String[] ATTRIBUTES = {
     COUNTER_CHANNEL_SIZE, COUNTER_EVENT_PUT_ATTEMPT,
     COUNTER_EVENT_TAKE_ATTEMPT, COUNTER_EVENT_PUT_SUCCESS,
-    COUNTER_EVENT_TAKE_SUCCESS
+    COUNTER_EVENT_TAKE_SUCCESS, COUNTER_CHANNEL_CAPACITY
   };
 
   public ChannelCounter(String name) {
@@ -89,4 +92,13 @@ public class ChannelCounter extends MonitoredCounterGroup implements
   public long addToEventTakeSuccessCount(long delta) {
     return addAndGet(COUNTER_EVENT_TAKE_SUCCESS, delta);
   }
+
+  public void setChannelCapacity(long capacity){
+    set(COUNTER_CHANNEL_CAPACITY, capacity);
+  }
+
+  public long getChannelCapacity(){
+    return get(COUNTER_CHANNEL_CAPACITY);
+  }
+
 }
diff --git a/flume-ng-core/src/main/java/org/apache/flume/instrumentation/ChannelCounterMBean.java b/flume-ng-core/src/main/java/org/apache/flume/instrumentation/ChannelCounterMBean.java
index 799dd5d9..f0c3ef36 100644
--- a/flume-ng-core/src/main/java/org/apache/flume/instrumentation/ChannelCounterMBean.java
+++ b/flume-ng-core/src/main/java/org/apache/flume/instrumentation/ChannelCounterMBean.java
@@ -18,6 +18,13 @@
  */
 package org.apache.flume.instrumentation;
 
+/**
+ * This interface represents a channel counter mbean. Any class implementing
+ * this interface must sub-class
+ * {@linkplain org.apache.flume.instrumentation.MonitoredCounterGroup}. This
+ * interface might change between minor releases. Please see
+ * {@linkplain org.apache.flume.instrumentation.ChannelCounter} class.
+ */
 public interface ChannelCounterMBean {
 
   long getChannelSize();
@@ -33,4 +40,8 @@ public interface ChannelCounterMBean {
   long getStartTime();
 
   long getStopTime();
+
+  long getChannelCapacity();
+
+  String getType();
 }
diff --git a/flume-ng-core/src/main/java/org/apache/flume/instrumentation/GangliaServer.java b/flume-ng-core/src/main/java/org/apache/flume/instrumentation/GangliaServer.java
index d93cd332..8d34fee9 100644
--- a/flume-ng-core/src/main/java/org/apache/flume/instrumentation/GangliaServer.java
+++ b/flume-ng-core/src/main/java/org/apache/flume/instrumentation/GangliaServer.java
@@ -28,6 +28,7 @@ import java.net.SocketAddress;
 import java.net.SocketException;
 import java.util.ArrayList;
 import java.util.List;
+import java.util.Map;
 import java.util.Set;
 import java.util.concurrent.Executors;
 import java.util.concurrent.ScheduledExecutorService;
@@ -41,6 +42,7 @@ import org.apache.flume.Context;
 import org.apache.flume.FlumeException;
 import org.apache.flume.api.HostInfo;
 import org.apache.flume.conf.ConfigurationException;
+import org.apache.flume.instrumentation.util.JMXPollUtil;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
@@ -49,19 +51,16 @@ import org.slf4j.LoggerFactory;
  * once every 60 seconds). This implementation can send data to ganglia 3 and
  * ganglia 3.1. <p>
  *
- * <b>Mandatory Parameters:</b><p>
- * <tt>hosts: </tt> List of comma separated hostname:ports of ganglia
- * servers to report metrics to. <p>
- * <b>Optional Parameters: </b><p>
- * <tt>pollFrequency:</tt>Interval in seconds between consecutive reports to
- * ganglia servers. Default = 60 seconds.<p>
+ * <b>Mandatory Parameters:</b><p> <tt>hosts: </tt> List of comma separated
+ * hostname:ports of ganglia servers to report metrics to. <p> <b>Optional
+ * Parameters: </b><p> <tt>pollFrequency:</tt>Interval in seconds between
+ * consecutive reports to ganglia servers. Default = 60 seconds.<p>
  * <tt>isGanglia3:</tt> Report to ganglia 3 ? Default = false - reports to
  * ganglia 3.1.
  *
  *
  *
  */
-
 public class GangliaServer implements MonitorService {
   /*
    * The Ganglia protocol specific stuff: the xdr_* methods
@@ -284,14 +283,13 @@ public class GangliaServer implements MonitorService {
   public void configure(Context context) {
     this.pollFrequency = context.getInteger(this.CONF_POLL_FREQUENCY, 60);
     String localHosts = context.getString(this.CONF_HOSTS);
-    if(localHosts == null || localHosts.isEmpty()){
+    if (localHosts == null || localHosts.isEmpty()) {
       throw new ConfigurationException("Hosts list cannot be empty.");
     }
     this.hosts = this.getHostsFromString(localHosts);
     this.isGanglia3 = context.getBoolean(this.CONF_ISGANGLIA3, false);
   }
 
-
   private List<HostInfo> getHostsFromString(String hosts)
           throws FlumeException {
     List<HostInfo> hostInfoList = new ArrayList<HostInfo>();
@@ -316,6 +314,7 @@ public class GangliaServer implements MonitorService {
     }
     return hostInfoList;
   }
+
   /**
    * Worker which polls JMX for all mbeans with
    * {@link javax.management.ObjectName} within the flume namespace:
@@ -332,47 +331,24 @@ public class GangliaServer implements MonitorService {
     @Override
     public void run() {
       try {
-        Set<ObjectInstance> queryMBeans = null;
-        try {
-          queryMBeans = mbeanServer.queryMBeans(
-                  null, null);
-        } catch (Exception ex) {
-          logger.error("Could not get Mbeans for monitoring", ex);
-          Throwables.propagate(ex);
-        }
-        for (ObjectInstance obj : queryMBeans) {
-          try {
-            if (!obj.getObjectName().toString().startsWith("org.apache.flume")) {
-              continue;
-            }
-            MBeanAttributeInfo[] attrs = mbeanServer.
-                    getMBeanInfo(obj.getObjectName()).getAttributes();
-            String strAtts[] = new String[attrs.length];
-            for (int i = 0; i < strAtts.length; i++) {
-              strAtts[i] = attrs[i].getName();
-            }
-            AttributeList attrList = mbeanServer.getAttributes(
-                    obj.getObjectName(), strAtts);
-            String component = obj.getObjectName().toString().substring(
-                obj.getObjectName().toString().indexOf('=') + 1);
-            for (Object attr : attrList) {
-              Attribute localAttr = (Attribute) attr;
-              if (isGanglia3) {
-                server.createGangliaMessage(GANGLIA_CONTEXT + component + "."
-                        + localAttr.getName(),
-                        localAttr.getValue().toString());
-              } else {
-                server.createGangliaMessage31(GANGLIA_CONTEXT + component + "."
-                        + localAttr.getName(),
-                        localAttr.getValue().toString());
-              }
-              server.sendToGangliaNodes();
+        Map<String, Map<String, String>> metricsMap =
+                JMXPollUtil.getAllMBeans();
+        for (String component : metricsMap.keySet()) {
+          Map<String, String> attributeMap = metricsMap.get(component);
+          for (String attribute : attributeMap.keySet()) {
+            if (isGanglia3) {
+              server.createGangliaMessage(GANGLIA_CONTEXT + component + "."
+                      + attribute,
+                      attributeMap.get(attribute));
+            } else {
+              server.createGangliaMessage31(GANGLIA_CONTEXT + component + "."
+                      + attribute,
+                      attributeMap.get(attribute));
             }
-          } catch (Exception ex) {
-            logger.error("Error getting mbean attributes", ex);
+            server.sendToGangliaNodes();
           }
         }
-      } catch(Throwable t) {
+      } catch (Throwable t) {
         logger.error("Unexpected error", t);
       }
     }
diff --git a/flume-ng-core/src/main/java/org/apache/flume/instrumentation/MonitoredCounterGroup.java b/flume-ng-core/src/main/java/org/apache/flume/instrumentation/MonitoredCounterGroup.java
index a03d004b..6bc31efa 100644
--- a/flume-ng-core/src/main/java/org/apache/flume/instrumentation/MonitoredCounterGroup.java
+++ b/flume-ng-core/src/main/java/org/apache/flume/instrumentation/MonitoredCounterGroup.java
@@ -139,4 +139,8 @@ public abstract class MonitoredCounterGroup {
     SINK_PROCESSOR,
     SINK
   };
+
+  public String getType(){
+    return type.name();
+  }
 }
diff --git a/flume-ng-core/src/main/java/org/apache/flume/instrumentation/MonitoringType.java b/flume-ng-core/src/main/java/org/apache/flume/instrumentation/MonitoringType.java
index d1329958..443335c9 100644
--- a/flume-ng-core/src/main/java/org/apache/flume/instrumentation/MonitoringType.java
+++ b/flume-ng-core/src/main/java/org/apache/flume/instrumentation/MonitoringType.java
@@ -24,7 +24,8 @@ package org.apache.flume.instrumentation;
  */
 public enum MonitoringType {
   OTHER(null),
-  GANGLIA(org.apache.flume.instrumentation.GangliaServer.class);
+  GANGLIA(org.apache.flume.instrumentation.GangliaServer.class),
+  HTTP(org.apache.flume.instrumentation.http.HTTPMetricsServer.class);
 
   private Class<? extends MonitorService> monitoringClass;
 
diff --git a/flume-ng-core/src/main/java/org/apache/flume/instrumentation/SinkCounterMBean.java b/flume-ng-core/src/main/java/org/apache/flume/instrumentation/SinkCounterMBean.java
index 6905d493..472a4dd6 100644
--- a/flume-ng-core/src/main/java/org/apache/flume/instrumentation/SinkCounterMBean.java
+++ b/flume-ng-core/src/main/java/org/apache/flume/instrumentation/SinkCounterMBean.java
@@ -17,6 +17,13 @@
  * under the License.
  */
 package org.apache.flume.instrumentation;
+/**
+ * This interface represents a sink counter mbean. Any class implementing
+ * this interface must sub-class
+ * {@linkplain org.apache.flume.instrumentation.MonitoredCounterGroup}. This
+ * interface might change between minor releases. Please see
+ * {@linkplain org.apache.flume.instrumentation.SinkCounter} class.
+ */
 
 public interface SinkCounterMBean {
 
@@ -39,4 +46,6 @@ public interface SinkCounterMBean {
   long getStartTime();
 
   long getStopTime();
+
+  String getType();
 }
diff --git a/flume-ng-core/src/main/java/org/apache/flume/instrumentation/SourceCounterMBean.java b/flume-ng-core/src/main/java/org/apache/flume/instrumentation/SourceCounterMBean.java
index e6612d53..792e689d 100644
--- a/flume-ng-core/src/main/java/org/apache/flume/instrumentation/SourceCounterMBean.java
+++ b/flume-ng-core/src/main/java/org/apache/flume/instrumentation/SourceCounterMBean.java
@@ -17,7 +17,13 @@
  * under the License.
  */
 package org.apache.flume.instrumentation;
-
+/**
+ * This interface represents a source counter mbean. Any class implementing
+ * this interface must sub-class
+ * {@linkplain org.apache.flume.instrumentation.MonitoredCounterGroup}. This
+ * interface might change between minor releases. Please see
+ * {@linkplain org.apache.flume.instrumentation.SourceCounter} class.
+ */
 public interface SourceCounterMBean {
 
   long getEventReceivedCount();
@@ -35,4 +41,6 @@ public interface SourceCounterMBean {
   long getStartTime();
 
   long getStopTime();
+
+  String getType();
 }
