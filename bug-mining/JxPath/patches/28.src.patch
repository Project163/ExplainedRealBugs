diff --git a/src/test/org/apache/commons/jxpath/JXPathTestSuite.java b/src/test/org/apache/commons/jxpath/JXPathTestSuite.java
index e7d8e19a..ca28ee59 100644
--- a/src/test/org/apache/commons/jxpath/JXPathTestSuite.java
+++ b/src/test/org/apache/commons/jxpath/JXPathTestSuite.java
@@ -30,6 +30,7 @@ import org.apache.commons.jxpath.ri.compiler.CoreFunctionTest;
 import org.apache.commons.jxpath.ri.compiler.CoreOperationTest;
 import org.apache.commons.jxpath.ri.compiler.ExtensionFunctionTest;
 import org.apache.commons.jxpath.ri.compiler.VariableTest;
+import org.apache.commons.jxpath.ri.model.EmbeddedColonMapKeysTest;
 import org.apache.commons.jxpath.ri.model.EmptyCollectionTest;
 import org.apache.commons.jxpath.ri.model.ExternalXMLNamespaceTest;
 import org.apache.commons.jxpath.ri.model.MixedModelTest;
@@ -101,6 +102,7 @@ public class JXPathTestSuite extends TestCase {
         suite.addTestSuite(XMLPreserveSpaceTest.class);
         suite.addTestSuite(ExternalXMLNamespaceTest.class);
         suite.addTestSuite(BadlyImplementedFactoryTest.class);
+        suite.addTestSuite(EmbeddedColonMapKeysTest.class);
         return suite;
     }
 }
\ No newline at end of file
diff --git a/src/test/org/apache/commons/jxpath/ri/model/EmbeddedColonMapKeysTest.java b/src/test/org/apache/commons/jxpath/ri/model/EmbeddedColonMapKeysTest.java
new file mode 100644
index 00000000..38f700c1
--- /dev/null
+++ b/src/test/org/apache/commons/jxpath/ri/model/EmbeddedColonMapKeysTest.java
@@ -0,0 +1,62 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.commons.jxpath.ri.model;
+
+import java.util.HashMap;
+
+import org.apache.commons.jxpath.JXPathContext;
+import org.apache.commons.jxpath.JXPathTestCase;
+
+/**
+ * JXPATH-104 test.
+ * 
+ * @author Matt Benson
+ * @version $Revision$ $Date$
+ */
+public class EmbeddedColonMapKeysTest extends JXPathTestCase {
+    private JXPathContext context;
+
+    /*
+     * (non-Javadoc)
+     * 
+     * @see junit.framework.TestCase#setUp()
+     */
+    protected void setUp() throws Exception {
+        super.setUp();
+        HashMap m = new HashMap();
+        m.put("foo:key", "value");
+        context = JXPathContext.newContext(m);
+        context.setLenient(true);
+    }
+
+    /**
+     * Create a new EmbeddedColonMapKeysTest.
+     */
+    public EmbeddedColonMapKeysTest(String name) {
+        super(name);
+    }
+
+    public void testSelectNodes() throws Exception {
+        assertXPathValueIterator(context, "/.[@name='foo:key']", list("value"));
+        assertXPathValueIterator(context, "/foo:key", list());
+    }
+
+    public void testSelectSingleNode() throws Exception {
+        assertXPathValue(context, "/.[@name='foo:key']", "value");
+        assertXPathValueLenient(context, "/foo:key", null);
+    }
+}
