diff --git a/src/java/org/apache/commons/jxpath/JXPathContext.java b/src/java/org/apache/commons/jxpath/JXPathContext.java
index aa809a41..935ebcfd 100644
--- a/src/java/org/apache/commons/jxpath/JXPathContext.java
+++ b/src/java/org/apache/commons/jxpath/JXPathContext.java
@@ -380,17 +380,8 @@ import org.apache.commons.jxpath.util.KeyManagerUtils;
  * @version $Revision$ $Date$
  */
 public abstract class JXPathContext {
-	
-	static {
-		// Initialize in this order:
-		// 1) contextFactory
-	    contextFactory = JXPathContextFactory.newInstance();
-		// 2) compilationContext
-	    compilationContext = JXPathContext.newContext(null);		
-	}
-	
-    private static final JXPathContextFactory contextFactory;
-    private static final JXPathContext compilationContext;
+    private static volatile JXPathContextFactory contextFactory;
+    private static volatile JXPathContext compilationContext;
 
     private static final PackageFunctions GENERIC_FUNCTIONS =
         new PackageFunctions("", null);
@@ -444,6 +435,9 @@ public abstract class JXPathContext {
      * @return JXPathContextFactory
      */
     private static JXPathContextFactory getContextFactory () {
+        if (contextFactory == null) {
+            contextFactory = JXPathContextFactory.newInstance();
+        }
         return contextFactory;
     }
 
@@ -652,6 +646,9 @@ public abstract class JXPathContext {
      * @return CompiledExpression
      */
     public static CompiledExpression compile(String xpath) {
+        if (compilationContext == null) {
+            compilationContext = JXPathContext.newContext(null);
+        }
         return compilationContext.compilePath(xpath);
     }
 
diff --git a/src/test/org/apache/commons/jxpath/ri/JXPathContextReferenceImplTestCase.java b/src/test/org/apache/commons/jxpath/ri/JXPathContextReferenceImplTestCase.java
new file mode 100644
index 00000000..d1dead36
--- /dev/null
+++ b/src/test/org/apache/commons/jxpath/ri/JXPathContextReferenceImplTestCase.java
@@ -0,0 +1,15 @@
+package org.apache.commons.jxpath.ri;
+
+import junit.framework.TestCase;
+
+import org.apache.commons.jxpath.ri.model.container.ContainerPointerFactory;
+
+public class JXPathContextReferenceImplTestCase extends TestCase {
+
+    /**
+     * https://issues.apache.org/jira/browse/JXPATH-166
+     */
+    public void testInit() {
+        JXPathContextReferenceImpl.addNodePointerFactory(new ContainerPointerFactory());
+    }
+}
