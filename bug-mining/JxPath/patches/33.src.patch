diff --git a/src/java/org/apache/commons/jxpath/ri/axes/PrecedingOrFollowingContext.java b/src/java/org/apache/commons/jxpath/ri/axes/PrecedingOrFollowingContext.java
index 90196454..cd3d5f91 100644
--- a/src/java/org/apache/commons/jxpath/ri/axes/PrecedingOrFollowingContext.java
+++ b/src/java/org/apache/commons/jxpath/ri/axes/PrecedingOrFollowingContext.java
@@ -22,7 +22,6 @@ import org.apache.commons.jxpath.ri.EvalContext;
 import org.apache.commons.jxpath.ri.compiler.NodeTest;
 import org.apache.commons.jxpath.ri.model.NodeIterator;
 import org.apache.commons.jxpath.ri.model.NodePointer;
-import org.apache.commons.jxpath.ri.model.beans.PropertyIterator;
 
 /**
  * EvalContext that walks the "preceding::" and "following::" axes.
@@ -148,7 +147,7 @@ public class PrecedingOrFollowingContext extends EvalContext {
                     else {
                         stack.pop();
                         if (!stack.isEmpty()) {
-                            it = (PropertyIterator) stack.peek();
+                            it = (NodeIterator) stack.peek();
                             currentNodePointer = it.getNodePointer();
                             if (currentNodePointer.testNode(nodeTest)) {
                                 super.setPosition(getCurrentPosition() + 1);
diff --git a/src/test/org/apache/commons/jxpath/ri/model/XMLModelTestCase.java b/src/test/org/apache/commons/jxpath/ri/model/XMLModelTestCase.java
index 591ee482..69b6c39d 100644
--- a/src/test/org/apache/commons/jxpath/ri/model/XMLModelTestCase.java
+++ b/src/test/org/apache/commons/jxpath/ri/model/XMLModelTestCase.java
@@ -464,6 +464,15 @@ public abstract class XMLModelTestCase extends JXPathTestCase {
             "/vendor[1]/location[1]/address[1]/street[1]");
     }
 
+    public void testAxisPreceding() {
+        // preceding::
+        assertXPathPointer(
+                context,
+                "//location[2]/preceding-sibling::location//street",
+        "/vendor[1]/location[1]/address[1]/street[1]");
+        assertXPathPointer(context, "//location[2]/preceding::node()[1]", "/vendor[1]/location[1]/employeeCount[1]");
+    }
+
     public void testAxisAttribute() {
         // attribute::
         assertXPathValue(context, "vendor/location/@id", "100");
@@ -630,6 +639,7 @@ public abstract class XMLModelTestCase extends JXPathTestCase {
             context,
             "//location/following::price:sale/saleEnds",
             "never");
+        assertXPathPointer(context, "//location[2]/following::node()[1]", "/vendor[1]/product[1]");
     }
 
     public void testAxisSelf() {
