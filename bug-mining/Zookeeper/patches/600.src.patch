diff --git a/CHANGES.txt b/CHANGES.txt
index b056c1979..326798a40 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -623,6 +623,9 @@ BUGFIXES:
   ZOOKEEPER-1819. DeserializationPerfTest calls method with wrong arguments
   (Daniel Knightly via michim)
 
+  ZOOKEEPER-1673. Zookeeper don't support cidr in expression in ACL with ip
+  scheme (Craig Condit via michim)
+
 IMPROVEMENTS:
 
   ZOOKEEPER-1170. Fix compiler (eclipse) warnings: unused imports,
diff --git a/src/java/main/org/apache/zookeeper/server/auth/IPAuthenticationProvider.java b/src/java/main/org/apache/zookeeper/server/auth/IPAuthenticationProvider.java
index 192dc0603..6f2a81dfa 100644
--- a/src/java/main/org/apache/zookeeper/server/auth/IPAuthenticationProvider.java
+++ b/src/java/main/org/apache/zookeeper/server/auth/IPAuthenticationProvider.java
@@ -112,6 +112,21 @@ public boolean isAuthenticated() {
     }
 
     public boolean isValid(String id) {
-        return addr2Bytes(id) != null;
+        String parts[] = id.split("/", 2);
+        byte aclAddr[] = addr2Bytes(parts[0]);
+        if (aclAddr == null) {
+            return false;
+        }
+        if (parts.length == 2) {
+            try {
+                int bits = Integer.parseInt(parts[1]);
+                if (bits < 0 || bits > aclAddr.length * 8) {
+                    return false;
+                }
+            } catch (NumberFormatException e) {
+                return false;
+            }
+        }
+        return true;
     }
 }
diff --git a/src/java/test/org/apache/zookeeper/test/ACLTest.java b/src/java/test/org/apache/zookeeper/test/ACLTest.java
index 793265c51..bb0245838 100644
--- a/src/java/test/org/apache/zookeeper/test/ACLTest.java
+++ b/src/java/test/org/apache/zookeeper/test/ACLTest.java
@@ -40,6 +40,7 @@
 import org.apache.zookeeper.server.ServerCnxnFactory;
 import org.apache.zookeeper.server.SyncRequestProcessor;
 import org.apache.zookeeper.server.ZooKeeperServer;
+import org.apache.zookeeper.server.auth.IPAuthenticationProvider;
 import org.junit.Assert;
 import org.junit.Test;
 
@@ -49,6 +50,16 @@ public class ACLTest extends ZKTestCase implements Watcher {
         "127.0.0.1:" + PortAssignment.unique();
     private volatile CountDownLatch startSignal;
 
+    @Test
+    public void testIPAuthenticationIsValidCIDR() throws Exception {
+        IPAuthenticationProvider prov = new IPAuthenticationProvider();
+        Assert.assertTrue("testing no netmask", prov.isValid("127.0.0.1"));
+        Assert.assertTrue("testing single ip netmask", prov.isValid("127.0.0.1/32"));
+        Assert.assertTrue("testing lowest netmask possible", prov.isValid("127.0.0.1/0"));
+        Assert.assertFalse("testing netmask too high", prov.isValid("127.0.0.1/33"));
+        Assert.assertFalse("testing netmask too low", prov.isValid("10.0.0.1/-1"));
+    }
+
     @Test
     public void testDisconnectedAddAuth() throws Exception {
         File tmpDir = ClientBase.createTmpDir();
