diff --git a/CHANGES.txt b/CHANGES.txt
index 7654caf7e..cf353190b 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -174,6 +174,8 @@ BUGFIXES:
   ZOOKEEPER-902. Fix findbug issue in trunk "Malicious code vulnerability"
   (flavio and phunt via phunt)
 
+  ZOOKEEPER-985. Test BookieRecoveryTest fails on trunk. (fpj via breed)
+
 IMPROVEMENTS:
   ZOOKEEPER-724. Improve junit test integration - log harness information 
   (phunt via mahadev)
diff --git a/src/contrib/bookkeeper/src/java/org/apache/bookkeeper/bookie/Bookie.java b/src/contrib/bookkeeper/src/java/org/apache/bookkeeper/bookie/Bookie.java
index 40278a328..3f6d347b3 100644
--- a/src/contrib/bookkeeper/src/java/org/apache/bookkeeper/bookie/Bookie.java
+++ b/src/contrib/bookkeeper/src/java/org/apache/bookkeeper/bookie/Bookie.java
@@ -66,6 +66,9 @@ public class Bookie extends Thread {
 
     // ZooKeeper client instance for the Bookie
     ZooKeeper zk;
+    
+    // Running flag
+    private volatile boolean running = false;
 
     public static class NoLedgerException extends IOException {
         private static final long serialVersionUID = 1L;
@@ -378,6 +381,10 @@ synchronized void readLog() {
     
     private LastLogMark lastLogMark = new LastLogMark(0, 0);
     
+    public boolean isRunning(){
+        return running;
+    }
+    
     @Override
     public void run() {
         LinkedList<QueueEntry> toFlush = new LinkedList<QueueEntry>();
@@ -390,6 +397,7 @@ public void run() {
             long nextPrealloc = preAllocSize;
             long lastFlushPosition = 0;
             logFile.write(zeros, nextPrealloc);
+            running = true;
             // TODO: Currently, when we roll over the journal logs, the older
             // ones are never garbage collected. We should remove a journal log
             // once all of its entries have been synced with the entry logs.
@@ -432,6 +440,7 @@ public void run() {
         } catch (Exception e) {
             LOG.fatal("Bookie thread exiting", e);
         }
+        running = false;
     }
 
     private FileChannel openChannel(long logId) throws FileNotFoundException {
diff --git a/src/contrib/bookkeeper/src/java/org/apache/bookkeeper/proto/BookieServer.java b/src/contrib/bookkeeper/src/java/org/apache/bookkeeper/proto/BookieServer.java
index fd2bd1816..5881fcb88 100644
--- a/src/contrib/bookkeeper/src/java/org/apache/bookkeeper/proto/BookieServer.java
+++ b/src/contrib/bookkeeper/src/java/org/apache/bookkeeper/proto/BookieServer.java
@@ -38,7 +38,7 @@
 public class BookieServer implements NIOServerFactory.PacketProcessor, BookkeeperInternalCallbacks.WriteCallback {
     int port;
     NIOServerFactory nioServerFactory;
-    volatile boolean down = false;
+    private volatile boolean running = false;
     Bookie bookie;
     static Logger LOG = Logger.getLogger(BookieServer.class);
 
@@ -49,16 +49,17 @@ public BookieServer(int port, String zkServers, File journalDirectory, File ledg
 
     public void start() throws IOException {
         nioServerFactory = new NIOServerFactory(port, this);
+        running = true;
     }
 
     public void shutdown() throws InterruptedException {
-        down = true;
+        running = false;
         nioServerFactory.shutdown();
         bookie.shutdown();
     }
 
-    public boolean isDown() {
-        return down;
+    public boolean isRunning(){
+        return bookie.isRunning() && nioServerFactory.isRunning() && running;
     }
 
     public void join() throws InterruptedException {
diff --git a/src/contrib/bookkeeper/src/java/org/apache/bookkeeper/proto/NIOServerFactory.java b/src/contrib/bookkeeper/src/java/org/apache/bookkeeper/proto/NIOServerFactory.java
index 46cb5b7f3..377b14fa1 100644
--- a/src/contrib/bookkeeper/src/java/org/apache/bookkeeper/proto/NIOServerFactory.java
+++ b/src/contrib/bookkeeper/src/java/org/apache/bookkeeper/proto/NIOServerFactory.java
@@ -90,6 +90,10 @@ private void addCnxn(Cnxn cnxn) {
         }
     }
 
+    public boolean isRunning() {
+        return !ss.socket().isClosed();
+    }
+    
     @Override
     public void run() {
         while (!ss.socket().isClosed()) {
diff --git a/src/contrib/bookkeeper/test/org/apache/bookkeeper/test/BookieRecoveryTest.java b/src/contrib/bookkeeper/test/org/apache/bookkeeper/test/BookieRecoveryTest.java
index 96177dc61..9815bce5d 100644
--- a/src/contrib/bookkeeper/test/org/apache/bookkeeper/test/BookieRecoveryTest.java
+++ b/src/contrib/bookkeeper/test/org/apache/bookkeeper/test/BookieRecoveryTest.java
@@ -154,7 +154,8 @@ private void writeEntriestoLedgers(int numEntries, long startEntryId, List<Ledge
      *            Port to start the new bookie server on
      * @throws IOException
      */
-    private void startNewBookie(int port) throws IOException {
+    private void startNewBookie(int port)
+    throws IOException, InterruptedException {
         File f = File.createTempFile("bookie", "test");
         tmpDirs.add(f);
         f.delete();
@@ -162,6 +163,9 @@ private void startNewBookie(int port) throws IOException {
         BookieServer server = new BookieServer(port, HOSTPORT, f, new File[] { f });
         server.start();
         bs.add(server);
+        while(!server.isRunning()){
+            Thread.sleep(500);
+        }
         LOG.info("New bookie on port " + port + " has been created.");
     }
 
