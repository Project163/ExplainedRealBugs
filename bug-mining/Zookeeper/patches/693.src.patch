diff --git a/CHANGES.txt b/CHANGES.txt
index 9e7dee83b..1531a6456 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -111,6 +111,9 @@ BUGFIXES:
   ZOOKEEPER-2197 non-ascii character in FinalRequestProcessor.java
   (Michi Mutsuzaki via rgs)
 
+  ZOOKEEPER-2096: C client builds with incorrect error codes in VisualStudio 2010+
+  (Vitaly Stakhovsky via rgs)
+
 IMPROVEMENTS:
   ZOOKEEPER-1660 Documentation for Dynamic Reconfiguration (Reed Wanderman-Milne via shralex)  
 
diff --git a/src/c/include/winconfig.h b/src/c/include/winconfig.h
index 2c4c5dbe0..ccc3c1899 100644
--- a/src/c/include/winconfig.h
+++ b/src/c/include/winconfig.h
@@ -184,8 +184,13 @@
 #define EHOSTDOWN EPIPE
 #define ESTALE ENODEV
 
+#ifndef EWOULDBLOCK
 #define EWOULDBLOCK WSAEWOULDBLOCK
+#endif
+
+#ifndef EINPROGRESS
 #define EINPROGRESS WSAEINPROGRESS
+#endif
 
 typedef int pid_t;
 #endif
diff --git a/src/c/src/zookeeper.c b/src/c/src/zookeeper.c
index 6a4b0374d..c7da6659c 100644
--- a/src/c/src/zookeeper.c
+++ b/src/c/src/zookeeper.c
@@ -2109,6 +2109,16 @@ static socket_t zookeeper_connect(zhandle_t *zh,
 
 #ifdef _WIN32
     get_errno();
+#if _MSC_VER >= 1600
+    switch(errno) {
+    case WSAEWOULDBLOCK:
+        errno = EWOULDBLOCK;
+        break;
+    case WSAEINPROGRESS:
+        errno = EINPROGRESS;
+        break;
+    }
+#endif
 #endif
 
     return rc;
