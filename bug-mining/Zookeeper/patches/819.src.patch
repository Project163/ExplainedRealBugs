diff --git a/src/java/test/org/apache/zookeeper/test/ClientBase.java b/src/java/test/org/apache/zookeeper/test/ClientBase.java
index f32244415..129d815aa 100644
--- a/src/java/test/org/apache/zookeeper/test/ClientBase.java
+++ b/src/java/test/org/apache/zookeeper/test/ClientBase.java
@@ -100,6 +100,8 @@ public static class CountdownWatcher implements Watcher {
         volatile boolean connected;
         // Set to true when connected to a quorum server.
         volatile boolean syncConnected;
+        // Set to true when connected to a quorum server in read-only mode
+        volatile boolean readOnlyConnected;
 
         public CountdownWatcher() {
             reset();
@@ -108,18 +110,22 @@ synchronized public void reset() {
             clientConnected = new CountDownLatch(1);
             connected = false;
             syncConnected = false;
+            readOnlyConnected = false;
         }
         synchronized public void process(WatchedEvent event) {
             KeeperState state = event.getState();
             if (state == KeeperState.SyncConnected) {
                 connected = true;
                 syncConnected = true;
+                readOnlyConnected = false;
             } else if (state == KeeperState.ConnectedReadOnly) {
                 connected = true;
                 syncConnected = false;
+                readOnlyConnected = true;
             } else {
                 connected = false;
                 syncConnected = false;
+                readOnlyConnected = false;
             }
 
             notifyAll();
@@ -157,6 +163,19 @@ synchronized public void waitForSyncConnected(long timeout)
                 throw new TimeoutException("Failed to connect to read-write ZooKeeper server.");
             }
         }
+        synchronized public void waitForReadOnlyConnected(long timeout)
+                throws InterruptedException, TimeoutException
+        {
+            long expire = System.currentTimeMillis() + timeout;
+            long left = timeout;
+            while(!readOnlyConnected && left > 0) {
+                wait(left);
+                left = expire - System.currentTimeMillis();
+            }
+            if (!readOnlyConnected) {
+                throw new TimeoutException("Failed to connect in read-only mode to ZooKeeper server.");
+            }
+        }
         synchronized public void waitForDisconnected(long timeout)
             throws InterruptedException, TimeoutException
         {
diff --git a/src/java/test/org/apache/zookeeper/test/ReadOnlyModeTest.java b/src/java/test/org/apache/zookeeper/test/ReadOnlyModeTest.java
index 5dfbb215b..68c718240 100644
--- a/src/java/test/org/apache/zookeeper/test/ReadOnlyModeTest.java
+++ b/src/java/test/org/apache/zookeeper/test/ReadOnlyModeTest.java
@@ -169,13 +169,9 @@ public void testReadOnlyClient() throws Exception {
      */
     @Test(timeout = 90000)
     public void testConnectionEvents() throws Exception {
-        final List<KeeperState> states = new ArrayList<KeeperState>();
+        CountdownWatcher watcher = new CountdownWatcher();
         ZooKeeper zk = new ZooKeeper(qu.getConnString(), CONNECTION_TIMEOUT,
-                new Watcher() {
-                    public void process(WatchedEvent event) {
-                        states.add(event.getState());
-                    }
-                }, true);
+                watcher, true);
         boolean success = false;
         for (int i = 0; i < 30; i++) {
             try {
@@ -188,6 +184,7 @@ public void process(WatchedEvent event) {
             }            
         }
         Assert.assertTrue("Did not succeed in connecting in 30s", success);
+        Assert.assertFalse("The connection should not be read-only yet", watcher.readOnlyConnected);
 
         // kill peer and wait no more than 5 seconds for read-only server
         // to be started (which should take one tickTime (2 seconds))
@@ -195,12 +192,7 @@ public void process(WatchedEvent event) {
 
         // Re-connect the client (in case we were connected to the shut down
         // server and the local session was not persisted).
-        zk = new ZooKeeper(qu.getConnString(), CONNECTION_TIMEOUT,
-                new Watcher() {
-                    public void process(WatchedEvent event) {
-                        states.add(event.getState());
-                    }
-                }, true);
+        zk = new ZooKeeper(qu.getConnString(), CONNECTION_TIMEOUT, watcher, true);
         long start = Time.currentElapsedTime();
         while (!(zk.getState() == States.CONNECTEDREADONLY)) {
             Thread.sleep(200);
@@ -209,10 +201,7 @@ public void process(WatchedEvent event) {
                               Time.currentElapsedTime() - start < 30000);
         }
 
-        // At this point states list should contain, in the given order,
-        // SyncConnected, Disconnected, and ConnectedReadOnly states
-        Assert.assertTrue("ConnectedReadOnly event wasn't received", states
-                .get(2) == KeeperState.ConnectedReadOnly);
+        watcher.waitForReadOnlyConnected(5000);
         zk.close();
     }
 
