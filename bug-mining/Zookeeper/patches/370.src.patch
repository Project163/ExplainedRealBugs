diff --git a/CHANGES.txt b/CHANGES.txt
index 856c7a83e..e473b748e 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -419,6 +419,8 @@ IMPROVEMENTS:
 
   ZOOKEEPER-1169. Fix compiler (eclipse) warnings in (generated) jute
   code (Thomas Koch via phunt)
+
+  ZOOKEEPER-1171. fix build for java 7 (phunt via mahadev)
  
 
 NEW FEATURES:
diff --git a/build.xml b/build.xml
index 7bef8f060..219ce54f5 100644
--- a/build.xml
+++ b/build.xml
@@ -30,8 +30,8 @@
     <property name="revision.properties" value="revision.properties" />
     <property file="${basedir}/src/java/${revision.properties}" />
     
-    <!-- Target Java 1.5 -->
     <property name="javac.target" value="1.5" />
+    <property name="javac.source" value="1.5" />
 
     <property name="src.dir" value="${basedir}/src" />
     <property name="java.src.dir" value="${src.dir}/java/main" />
@@ -235,7 +235,8 @@
     </target>
     
     <target name="jute" depends="init">
-        <javac srcdir="${java.src.dir}" destdir="${build.classes}" target="${javac.target}"
+        <javac srcdir="${java.src.dir}" destdir="${build.classes}" includeantruntime="false"
+            target="${javac.target}" source="${javac.source}"
             includes="org/apache/jute/**" debug="on" />
     </target>
 
@@ -270,7 +271,8 @@
     </target>
 
     <target name="ver-gen" depends="init">
-        <javac srcdir="${java.src.dir}" destdir="${build.classes}" target="${javac.target}"
+        <javac srcdir="${java.src.dir}" destdir="${build.classes}" includeantruntime="false"
+            target="${javac.target}" source="${javac.source}"
             includes="org/apache/zookeeper/version/util/**" debug="on" />
     </target>
     
@@ -303,8 +305,8 @@
     </target>
     
     <target name="build-generated" depends="compile_jute,version-info" >
-        <javac srcdir="${src_generated.dir}" destdir="${build.classes}" 
-            target="${javac.target}" debug="on" />
+        <javac srcdir="${src_generated.dir}" destdir="${build.classes}" includeantruntime="false"
+            target="${javac.target}" source="${javac.source}" debug="on" />
     </target>
     
     <target name="ivy-download" unless="ivy.jar.exists" depends="init">
@@ -353,8 +355,8 @@
     </target>
 
     <target name="compile" depends="ivy-retrieve,clover,build-generated">
-        <javac srcdir="${java.src.dir}" destdir="${build.classes}" 
-               target="${javac.target}" debug="on">
+        <javac srcdir="${java.src.dir}" destdir="${build.classes}" includeantruntime="false"
+               target="${javac.target}" source="${javac.source}" debug="on">
             <classpath refid="java.classpath"/>
             <compilerarg value="-Xlint:all"/>
             <compilerarg value="-Xlint:-path"/>
@@ -363,12 +365,12 @@
 
     <target name="compile-test" depends="ivy-retrieve-test,compile">
       <mkdir dir="${test.java.classes}"/>
-      <javac srcdir="${test.src.dir}" destdir="${test.java.classes}"
-             target="${javac.target}" debug="on">
+      <javac srcdir="${test.src.dir}" destdir="${test.java.classes}" includeantruntime="false"
+             target="${javac.target}" source="${javac.source}" debug="on">
         <classpath refid="test.java.classpath"/>
       </javac>
-      <javac srcdir="${systest.src.dir}" destdir="${test.java.classes}"
-             target="${javac.target}" debug="on">
+      <javac srcdir="${systest.src.dir}" destdir="${test.java.classes}" includeantruntime="false"
+             target="${javac.target}" source="${javac.source}" debug="on">
         <classpath refid="test.java.classpath"/>
       </javac>
     </target>
