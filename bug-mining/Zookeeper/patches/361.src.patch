diff --git a/CHANGES.txt b/CHANGES.txt
index c0f4d8464..487813472 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -292,6 +292,9 @@ BUGFIXES:
   
   ZOOKEEPER-1025. zkCli is overly sensitive to to spaces. (Laxman via camille)
 
+  ZOOKEEPER-1117. zookeeper 3.3.3 fails to build with gcc >= 4.6.1 on
+  Debian/Ubuntu (James Page via mahadev)
+
 IMPROVEMENTS:
   ZOOKEEPER-724. Improve junit test integration - log harness information 
   (phunt via mahadev)
diff --git a/src/c/src/cli.c b/src/c/src/cli.c
index c1d54a216..c9fe4ddd3 100644
--- a/src/c/src/cli.c
+++ b/src/c/src/cli.c
@@ -595,11 +595,13 @@ int main(int argc, char **argv) {
         FD_SET(0, &rfds);
         rc = select(fd+1, &rfds, &wfds, &efds, &tv);
         events = 0;
-        if (FD_ISSET(fd, &rfds)) {
-            events |= ZOOKEEPER_READ;
-        }
-        if (FD_ISSET(fd, &wfds)) {
-            events |= ZOOKEEPER_WRITE;
+        if (rc > 0) {
+            if (FD_ISSET(fd, &rfds)) {
+                events |= ZOOKEEPER_READ;
+            }
+            if (FD_ISSET(fd, &wfds)) {
+                events |= ZOOKEEPER_WRITE;
+            }
         }
         if(batchMode && processed==0){
           //batch mode
diff --git a/src/c/src/zookeeper.c b/src/c/src/zookeeper.c
index edf368ff2..29ad9dc92 100644
--- a/src/c/src/zookeeper.c
+++ b/src/c/src/zookeeper.c
@@ -480,7 +480,7 @@ int getaddrs(zhandle_t *zh)
         *port_spec = '\0';
         port_spec++;
         port = strtol(port_spec, &end_port_spec, 0);
-        if (!*port_spec || *end_port_spec) {
+        if (!*port_spec || *end_port_spec || port == 0) {
             LOG_ERROR(("invalid port in %s", host));
             errno=EINVAL;
             rc=ZBADARGUMENTS;
