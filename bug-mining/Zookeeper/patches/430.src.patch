diff --git a/CHANGES.txt b/CHANGES.txt
index fe83c3e5b..f25ae1879 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -138,6 +138,8 @@ BUGFIXES:
   replace "http://java.sun.com/javase/6/docs/api/" with 
   "http://download.oracle.com/javase/6/docs/api/" (Eugene Koontz via camille)
  
+  ZOOKEEPER-1361. Leader.lead iterates over 'learners' set without proper synchronisation (henryr via camille)
+  
 IMPROVEMENTS:
 
   ZOOKEEPER-1170. Fix compiler (eclipse) warnings: unused imports,
diff --git a/src/java/main/org/apache/zookeeper/server/NIOServerCnxn.java b/src/java/main/org/apache/zookeeper/server/NIOServerCnxn.java
index eb61a297d..0fd56b6df 100644
--- a/src/java/main/org/apache/zookeeper/server/NIOServerCnxn.java
+++ b/src/java/main/org/apache/zookeeper/server/NIOServerCnxn.java
@@ -771,9 +771,9 @@ public void commandRun() {
             if(stats.getServerState().equals("leader")) {
                 Leader leader = ((LeaderZooKeeperServer)zkServer).getLeader();
 
-                print("followers", leader.learners.size());
-                print("synced_followers", leader.forwardingFollowers.size());
-                print("pending_syncs", leader.pendingSyncs.size());
+                print("followers", leader.getLearners().size());
+                print("synced_followers", leader.getForwardingFollowers().size());
+                print("pending_syncs", leader.getNumPendingSyncs());
             }
         }
 
diff --git a/src/java/main/org/apache/zookeeper/server/NettyServerCnxn.java b/src/java/main/org/apache/zookeeper/server/NettyServerCnxn.java
index 1d2034aac..33b610497 100644
--- a/src/java/main/org/apache/zookeeper/server/NettyServerCnxn.java
+++ b/src/java/main/org/apache/zookeeper/server/NettyServerCnxn.java
@@ -582,9 +582,9 @@ public void commandRun() {
             if(stats.getServerState().equals("leader")) {
                 Leader leader = ((LeaderZooKeeperServer)zkServer).getLeader();
 
-                print("followers", leader.learners.size());
-                print("synced_followers", leader.forwardingFollowers.size());
-                print("pending_syncs", leader.pendingSyncs.size());
+                print("followers", leader.getLearners().size());
+                print("synced_followers", leader.getForwardingFollowers().size());
+                print("pending_syncs", leader.getNumPendingSyncs());
             }
         }
 
diff --git a/src/java/main/org/apache/zookeeper/server/quorum/Leader.java b/src/java/main/org/apache/zookeeper/server/quorum/Leader.java
index 597971607..2ff532671 100644
--- a/src/java/main/org/apache/zookeeper/server/quorum/Leader.java
+++ b/src/java/main/org/apache/zookeeper/server/quorum/Leader.java
@@ -32,10 +32,10 @@
 import java.util.HashSet;
 import java.util.Iterator;
 import java.util.List;
+import java.util.concurrent.atomic.AtomicLong;
 import java.util.concurrent.ConcurrentHashMap;
 import java.util.concurrent.ConcurrentLinkedQueue;
 import java.util.concurrent.ConcurrentMap;
-import java.util.concurrent.atomic.AtomicLong;
 
 import org.apache.jute.BinaryOutputArchive;
 import org.apache.zookeeper.server.FinalRequestProcessor;
@@ -79,22 +79,66 @@ public String toString() {
     volatile LearnerCnxAcceptor cnxAcceptor = null;
 
     // list of all the followers
-    public final HashSet<LearnerHandler> learners =
+    private final HashSet<LearnerHandler> learners =
         new HashSet<LearnerHandler>();
 
+    /**
+     * Returns a copy of the current learner snapshot
+     */
+    public List<LearnerHandler> getLearners() {
+        synchronized (learners) {
+            return new ArrayList<LearnerHandler>(learners);
+        }
+    }
+
     // list of followers that are ready to follow (i.e synced with the leader)
-    public final HashSet<LearnerHandler> forwardingFollowers =
+    private final HashSet<LearnerHandler> forwardingFollowers =
         new HashSet<LearnerHandler>();
 
-    protected final HashSet<LearnerHandler> observingLearners =
+    /**
+     * Returns a copy of the current forwarding follower snapshot
+     */
+    public List<LearnerHandler> getForwardingFollowers() {
+        synchronized (forwardingFollowers) {
+            return new ArrayList<LearnerHandler>(forwardingFollowers);
+        }
+    }
+
+    private void addForwardingFollower(LearnerHandler lh) {
+        synchronized (forwardingFollowers) {
+            forwardingFollowers.add(lh);
+        }
+    }
+
+    private final HashSet<LearnerHandler> observingLearners =
         new HashSet<LearnerHandler>();
 
-    //Pending sync requests
-    public final HashMap<Long,List<LearnerSyncRequest>> pendingSyncs =
+    /**
+     * Returns a copy of the current observer snapshot
+     */
+    public List<LearnerHandler> getObservingLearners() {
+        synchronized (observingLearners) {
+            return new ArrayList<LearnerHandler>(observingLearners);
+        }
+    }
+
+    private void addObserverLearnerHandler(LearnerHandler lh) {
+        synchronized (observingLearners) {
+            observingLearners.add(lh);
+        }
+    }
+
+    // Pending sync requests. Must access under 'this' lock.
+    private final HashMap<Long,List<LearnerSyncRequest>> pendingSyncs =
         new HashMap<Long,List<LearnerSyncRequest>>();
 
+    synchronized public int getNumPendingSyncs() {
+        return pendingSyncs.size();
+    }
+
     //Follower counter
     final AtomicLong followerCounter = new AtomicLong(-1);
+
     /**
      * Adds peer to the leader.
      *
@@ -119,6 +163,9 @@ void removeLearnerHandler(LearnerHandler peer) {
         synchronized (learners) {
             learners.remove(peer);
         }
+        synchronized (observingLearners) {
+            observingLearners.remove(peer);
+        }
     }
 
     boolean isLearnerSynced(LearnerHandler peer){
@@ -347,8 +394,10 @@ void lead() throws IOException, InterruptedException {
 
                     shutdown("Waiting for a quorum of followers, only synced with: " + ackToString);
                     HashSet<Long> followerSet = new HashSet<Long>();
-                    for(LearnerHandler f : learners)
+
+                    for(LearnerHandler f : getLearners()) {
                         followerSet.add(f.getSid());
+                    }
 
                     if (self.getQuorumVerifier().containsQuorum(followerSet)) {
                     //if (followers.size() >= self.quorumPeers.size() / 2) {
@@ -384,16 +433,16 @@ void lead() throws IOException, InterruptedException {
 
                 // lock on the followers when we use it.
                 syncedSet.add(self.getId());
-                synchronized (learners) {
-                    for (LearnerHandler f : learners) {
-                        // Synced set is used to check we have a supporting quorum, so only
-                        // PARTICIPANT, not OBSERVER, learners should be used
-                        if (f.synced() && f.getLearnerType() == LearnerType.PARTICIPANT) {
-                            syncedSet.add(f.getSid());
-                        }
-                        f.ping();
+
+                for (LearnerHandler f : getLearners()) {
+                    // Synced set is used to check we have a supporting quorum, so only
+                    // PARTICIPANT, not OBSERVER, learners should be used
+                    if (f.synced() && f.getLearnerType() == LearnerType.PARTICIPANT) {
+                        syncedSet.add(f.getSid());
                     }
+                    f.ping();
                 }
+
               if (!tickSkip && !self.getQuorumVerifier().containsQuorum(syncedSet)) {
                 //if (!tickSkip && syncedCount < self.quorumPeers.size() / 2) {
                     // Lost quorum, shutdown
@@ -602,10 +651,8 @@ void sendPacket(QuorumPacket qp) {
      * send a packet to all observers
      */
     void sendObserverPacket(QuorumPacket qp) {
-        synchronized(observingLearners) {
-            for (LearnerHandler f : observingLearners) {
-                f.queuePacket(qp);
-            }
+        for (LearnerHandler f : getObservingLearners()) {
+            f.queuePacket(qp);
         }
     }
 
@@ -747,13 +794,9 @@ synchronized public long startForwarding(LearnerHandler handler,
             }
         }
         if (handler.getLearnerType() == LearnerType.PARTICIPANT) {
-            synchronized (forwardingFollowers) {
-                forwardingFollowers.add(handler);
-            }
+            addForwardingFollower(handler);
         } else {
-            synchronized (observingLearners) {
-                observingLearners.add(handler);
-            }
+            addObserverLearnerHandler(handler);
         }
 
         return lastProposed;
diff --git a/src/java/main/org/apache/zookeeper/server/quorum/LeaderBean.java b/src/java/main/org/apache/zookeeper/server/quorum/LeaderBean.java
index 921b0027a..b5a3a10ec 100644
--- a/src/java/main/org/apache/zookeeper/server/quorum/LeaderBean.java
+++ b/src/java/main/org/apache/zookeeper/server/quorum/LeaderBean.java
@@ -44,7 +44,7 @@ public String getCurrentZxid() {
     
     public String followerInfo() {
         StringBuilder sb = new StringBuilder();
-        for (LearnerHandler handler : leader.learners) {
+        for (LearnerHandler handler : leader.getLearners()) {
             sb.append(handler.toString()).append("\n");
         }
         return sb.toString();
diff --git a/src/java/main/org/apache/zookeeper/server/quorum/QuorumPeer.java b/src/java/main/org/apache/zookeeper/server/quorum/QuorumPeer.java
index 87620ed70..21cd1eb98 100644
--- a/src/java/main/org/apache/zookeeper/server/quorum/QuorumPeer.java
+++ b/src/java/main/org/apache/zookeeper/server/quorum/QuorumPeer.java
@@ -852,12 +852,8 @@ public String[] getQuorumPeers() {
         List<String> l = new ArrayList<String>();
         synchronized (this) {
             if (leader != null) {
-                synchronized (leader.learners) {
-                    for (LearnerHandler fh :
-                        leader.learners)
-                    {
-                        if (fh.getSocket() == null)
-                            continue;
+                for (LearnerHandler fh : leader.getLearners()) {
+                    if (fh.getSocket() != null) {
                         String s = fh.getSocket().getRemoteSocketAddress().toString();
                         if (leader.isLearnerSynced(fh))
                             s += "*";
diff --git a/src/java/test/org/apache/zookeeper/test/QuorumTest.java b/src/java/test/org/apache/zookeeper/test/QuorumTest.java
index d4fe35aeb..fcbf527e1 100644
--- a/src/java/test/org/apache/zookeeper/test/QuorumTest.java
+++ b/src/java/test/org/apache/zookeeper/test/QuorumTest.java
@@ -149,8 +149,7 @@ public void processResult(int rc, String path, Object ctx,
                 }
             }, null);
         }
-        ArrayList<LearnerHandler> fhs = new ArrayList<LearnerHandler>(leader.forwardingFollowers);
-        for(LearnerHandler f: fhs) {
+        for(LearnerHandler f : leader.getForwardingFollowers()) {
             f.getSocket().shutdownInput();
         }
         for(int i = 0; i < 5000; i++) {
