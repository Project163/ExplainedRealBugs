diff --git a/CHANGES.txt b/CHANGES.txt
index fe9e38214..c80ae56c7 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -250,6 +250,8 @@ BUGFIXES:
   ZOOKEEPER-689.  release build broken - ivysettings.xml not copied during
   "package" (phunt via mahadev)
 
+  ZOOKEEPER-59. Synchronized block in NIOServerCnxn (flavio via mahadev) 
+
 IMPROVEMENTS:
   ZOOKEEPER-473. cleanup junit tests to eliminate false positives due to
   "socket reuse" and failure to close client (phunt via mahadev)
diff --git a/src/java/main/org/apache/zookeeper/server/NIOServerCnxn.java b/src/java/main/org/apache/zookeeper/server/NIOServerCnxn.java
index b6f7e34fe..4d8661f22 100644
--- a/src/java/main/org/apache/zookeeper/server/NIOServerCnxn.java
+++ b/src/java/main/org/apache/zookeeper/server/NIOServerCnxn.java
@@ -395,7 +395,8 @@ void sendBuffer(ByteBuffer bb) {
                     return;
                 }
             }
-            synchronized (factory) {
+
+            synchronized(this.factory){
                 sk.selector().wakeup();
                 if (LOG.isTraceEnabled()) {
                     LOG.trace("Add a buffer to outgoingBuffers, sk " + sk
@@ -406,6 +407,7 @@ void sendBuffer(ByteBuffer bb) {
                     sk.interestOps(sk.interestOps() | SelectionKey.OP_WRITE);
                 }
             }
+            
         } catch(Exception e) {
             LOG.error("Unexpected Exception: ", e);
         }
@@ -564,7 +566,8 @@ void doIO(SelectionKey k) throws InterruptedException {
                     // ZooLog.CLIENT_DATA_PACKET_TRACE_MASK, "after send,
                     // outgoingBuffers.size() = " + outgoingBuffers.size());
                 }
-                synchronized (this) {
+
+                synchronized(this.factory){
                     if (outgoingBuffers.size() == 0) {
                         if (!initialized
                                 && (sk.interestOps() & SelectionKey.OP_READ) == 0) {
@@ -574,7 +577,7 @@ void doIO(SelectionKey k) throws InterruptedException {
                                 & (~SelectionKey.OP_WRITE));
                     } else {
                         sk.interestOps(sk.interestOps()
-                                        | SelectionKey.OP_WRITE);
+                                | SelectionKey.OP_WRITE);
                     }
                 }
             }
@@ -654,19 +657,19 @@ private void readRequest() throws IOException {
         }
         if (h.getXid() >= 0) {
             synchronized (this) {
-                synchronized (this.factory) {
-                    outstandingRequests++;
-                    // check throttling
-                    if (zk.getInProcess() > factory.outstandingLimit) {
-                        if (LOG.isDebugEnabled()) {
-                            LOG.debug("Throttling recv " + zk.getInProcess());
-                        }
-                        disableRecv();
-                        // following lines should not be needed since we are
-                        // already reading
-                        // } else {
-                        // enableRecv();
+                outstandingRequests++;
+            }
+            synchronized (this.factory) {        
+                // check throttling
+                if (zk.getInProcess() > factory.outstandingLimit) {
+                    if (LOG.isDebugEnabled()) {
+                        LOG.debug("Throttling recv " + zk.getInProcess());
                     }
+                    disableRecv();
+                    // following lines should not be needed since we are
+                    // already reading
+                    // } else {
+                    // enableRecv();
                 }
             }
         }
@@ -1312,9 +1315,11 @@ synchronized public void sendResponse(ReplyHeader h, Record r, String tag) {
             bb.putInt(b.length - 4).rewind();
             sendBuffer(bb);
             if (h.getXid() > 0) {
-                synchronized (this.factory) {
+                synchronized(this){
                     outstandingRequests--;
-                    // check throttling
+                }
+                // check throttling
+                synchronized (this.factory) {        
                     if (zk.getInProcess() < factory.outstandingLimit
                             || outstandingRequests < 1) {
                         sk.selector().wakeup();
