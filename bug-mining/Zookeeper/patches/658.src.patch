diff --git a/CHANGES.txt b/CHANGES.txt
index 49342b40c..6474c4185 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -15,6 +15,8 @@ BUGFIXES:
   ZOOKEEPER-2052 Unable to delete a node when the node has no children
   (Hongchao Deng and Yip Ng via rakeshr)
 
+  ZOOKEEPER-2064 Prevent resource leak in various classes (Ted Yu via fpj)
+
 IMPROVEMENTS:
   ZOOKEEPER-1660 Documentation for Dynamic Reconfiguration (Reed Wanderman-Milne via shralex)  
 
diff --git a/src/contrib/loggraph/src/java/org/apache/zookeeper/graph/Log4JSource.java b/src/contrib/loggraph/src/java/org/apache/zookeeper/graph/Log4JSource.java
index 78f0898b1..84a9d983e 100644
--- a/src/contrib/loggraph/src/java/org/apache/zookeeper/graph/Log4JSource.java
+++ b/src/contrib/loggraph/src/java/org/apache/zookeeper/graph/Log4JSource.java
@@ -351,11 +351,21 @@ public static void main(String[] args) throws IOException {
 		
 		LogIterator iter = s.iterator(starttime, endtime);
 		System.out.println(iter);
+		try {
+		  iter.close();
+		} catch (IOException ioe) {
+		  System.out.println(ioe.getMessage());
+		}
 	    }; };
 	    Thread t2 = new Thread() { public void run () { 
 		
 		LogIterator iter = s.iterator(starttime, endtime);
 		System.out.println(iter);
+		try {
+		  iter.close();
+		} catch (IOException ioe) {
+		  System.out.println(ioe.getMessage());
+		}
 	    }; };
 	    Thread t3 = new Thread() { public void run () { 
 		
diff --git a/src/contrib/loggraph/src/java/org/apache/zookeeper/graph/RandomAccessFileReader.java b/src/contrib/loggraph/src/java/org/apache/zookeeper/graph/RandomAccessFileReader.java
index 827a8a7a0..13a41a5ae 100644
--- a/src/contrib/loggraph/src/java/org/apache/zookeeper/graph/RandomAccessFileReader.java
+++ b/src/contrib/loggraph/src/java/org/apache/zookeeper/graph/RandomAccessFileReader.java
@@ -324,5 +324,6 @@ public static void main(String[] args) throws IOException {
 	System.out.println(f.readLine());
 	f.seek(pos2);
 	System.out.println(f.readLine());
+	f.close();
     }
 };
diff --git a/src/contrib/loggraph/src/java/org/apache/zookeeper/graph/servlets/NumEvents.java b/src/contrib/loggraph/src/java/org/apache/zookeeper/graph/servlets/NumEvents.java
index ed4694581..5961a1258 100644
--- a/src/contrib/loggraph/src/java/org/apache/zookeeper/graph/servlets/NumEvents.java
+++ b/src/contrib/loggraph/src/java/org/apache/zookeeper/graph/servlets/NumEvents.java
@@ -81,6 +81,7 @@ String handleRequest(JsonRequest request) throws Exception {
 	if (LOG.isDebugEnabled()) {
 	    LOG.debug("handle(start= " + starttime + ", end=" + endtime + ", numEntries=" + size +")");
 	}
+	iter.close();
 	return JSONValue.toJSONString(data);
     }
 }
diff --git a/src/contrib/loggraph/src/java/org/apache/zookeeper/graph/servlets/StaticContent.java b/src/contrib/loggraph/src/java/org/apache/zookeeper/graph/servlets/StaticContent.java
index 4af78959a..d91acb600 100644
--- a/src/contrib/loggraph/src/java/org/apache/zookeeper/graph/servlets/StaticContent.java
+++ b/src/contrib/loggraph/src/java/org/apache/zookeeper/graph/servlets/StaticContent.java
@@ -39,9 +39,12 @@ protected void doGet(HttpServletRequest request, HttpServletResponse response) t
 	    response.setStatus(HttpServletResponse.SC_NOT_FOUND);
 	    return;
 	}
-	
-	while (resource.available() > 0) {
+	try {
+	  while (resource.available() > 0) {
 	    response.getWriter().write(resource.read());
+	  }
+	} finally {
+	  resource.close();
 	}
 	//        response.setContentType("text/plain;charset=utf-8");
         response.setStatus(HttpServletResponse.SC_OK);
diff --git a/src/contrib/rest/src/java/org/apache/zookeeper/server/jersey/cfg/RestCfg.java b/src/contrib/rest/src/java/org/apache/zookeeper/server/jersey/cfg/RestCfg.java
index c7730201d..93dd63246 100644
--- a/src/contrib/rest/src/java/org/apache/zookeeper/server/jersey/cfg/RestCfg.java
+++ b/src/contrib/rest/src/java/org/apache/zookeeper/server/jersey/cfg/RestCfg.java
@@ -36,9 +36,13 @@ public RestCfg(String resource) throws IOException {
    }
 
    public RestCfg(InputStream io) throws IOException {
+     try {
        cfg.load(io);
        extractEndpoints();
        extractCredentials();
+     } finally {
+       io.close();
+     }
    }
 
    private void extractCredentials() {
diff --git a/src/java/systest/org/apache/zookeeper/test/system/GenerateLoad.java b/src/java/systest/org/apache/zookeeper/test/system/GenerateLoad.java
index 174508744..4092c760f 100644
--- a/src/java/systest/org/apache/zookeeper/test/system/GenerateLoad.java
+++ b/src/java/systest/org/apache/zookeeper/test/system/GenerateLoad.java
@@ -696,12 +696,16 @@ private static String getMode(String hostPort) throws NumberFormatException, Unk
         s.getOutputStream().write("stat".getBytes());
         BufferedReader br = new BufferedReader(new InputStreamReader(s.getInputStream()));
         String line;
-        while((line = br.readLine()) != null) {
+        try {
+          while((line = br.readLine()) != null) {
             if (line.startsWith("Mode: ")) {
-                return line.substring(6);
+              return line.substring(6);
             }
+          }
+          return "unknown";
+        } finally {
+          s.close();
         }
-        return "unknown";
     }
 
     private static void doUsage() {
diff --git a/src/java/systest/org/apache/zookeeper/test/system/QuorumPeerInstance.java b/src/java/systest/org/apache/zookeeper/test/system/QuorumPeerInstance.java
index d5e0f2f22..6900e6b01 100644
--- a/src/java/systest/org/apache/zookeeper/test/system/QuorumPeerInstance.java
+++ b/src/java/systest/org/apache/zookeeper/test/system/QuorumPeerInstance.java
@@ -68,7 +68,12 @@ public QuorumPeerInstance() {
             Properties p;
             if (zkDirs.exists()) {
                 p = new Properties();
-                p.load(new FileInputStream(zkDirs));
+                FileInputStream input = new FileInputStream(zkDirs);
+                try {
+                  p.load(input);
+                } finally {
+                  input.close();
+                }
             } else {
                 p = System.getProperties();
             }
