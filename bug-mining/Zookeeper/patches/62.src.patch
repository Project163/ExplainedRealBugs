diff --git a/CHANGES.txt b/CHANGES.txt
index 88f9c81ad..1c3cc78c5 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -2,6 +2,10 @@ Trunk
   
 Non-backward compatible changes:
 
+BUGFIXES:
+  ZOOKEEPER-255. zoo_set() api does not return stat datastructure. (avery
+ching via mahadev)
+
 Backward compatibile changes:
 
 BUGFIXES: 
diff --git a/src/c/include/zookeeper.h b/src/c/include/zookeeper.h
index 85f977038..88c2334d3 100644
--- a/src/c/include/zookeeper.h
+++ b/src/c/include/zookeeper.h
@@ -1084,6 +1084,7 @@ ZOOAPI int zoo_wget(zhandle_t *zh, const char *path,
  * \param version the expected version of the node. The function will fail if 
  * the actual version of the node does not match the expected version. If -1 is 
  * used the version check will not take place. 
+ * \param stat if not NULL, will hold the value of stat for the path on return.
  * \return the return code for the function call.
  * ZOK operation completed succesfully
  * ZNONODE the node does not exist.
@@ -1093,9 +1094,8 @@ ZOOAPI int zoo_wget(zhandle_t *zh, const char *path,
  * ZINVALIDSTATE - zhandle state is either ZOO_SESSION_EXPIRED_STATE or ZOO_AUTH_FAILED_STATE
  * ZMARSHALLINGERROR - failed to marshall a request; possibly, out of memory
  */
-ZOOAPI int zoo_set(zhandle_t *zh, const char *path, const char *buffer, int buflen,
-                   int version);
-
+ZOOAPI int zoo_set(zhandle_t *zh, const char *path, const char *buffer,
+                   int buflen, int version, struct Stat *stat);
 
 /**
  * \brief lists the children of a node synchronously.
diff --git a/src/c/src/cli.c b/src/c/src/cli.c
index d995a0d6b..ac3d95bf3 100644
--- a/src/c/src/cli.c
+++ b/src/c/src/cli.c
@@ -266,7 +266,8 @@ void processline(char *line) {
             rc = zoo_aset(zh, line, ptr, strlen(ptr), -1, my_stat_completion,
                     strdup(line));
         } else {
-            rc = zoo_set(zh, line, ptr, strlen(ptr), -1);
+            struct Stat stat;
+            rc = zoo_set(zh, line, ptr, strlen(ptr), -1, &stat);
         }
         if (rc) {
             fprintf(stderr, "Error %d for %s\n", rc, line);
diff --git a/src/c/src/zookeeper.c b/src/c/src/zookeeper.c
index 747d5dad7..a3c11db7e 100644
--- a/src/c/src/zookeeper.c
+++ b/src/c/src/zookeeper.c
@@ -492,8 +492,9 @@ zhandle_t *zookeeper_init(const char *host, watcher_fn watcher,
               host,
               recv_timeout,
               watcher,
-              clientid->client_id,
-              (clientid->passwd == 0 ? "<null>" : "<hidden>"),
+              (clientid == 0 ? 0 : clientid->client_id),
+              ((clientid == 0) || (clientid->passwd == 0) ?
+               "<null>" : "<hidden>"),
               context,
               flags));
 
@@ -2426,7 +2427,7 @@ int zoo_wget(zhandle_t *zh, const char *path,
 }
 
 int zoo_set(zhandle_t *zh, const char *path, const char *buffer, int buflen,
-        int version)
+        int version, struct Stat *stat)
 {
     struct sync_completion *sc = alloc_sync_completion();
     int rc;
@@ -2437,6 +2438,9 @@ int zoo_set(zhandle_t *zh, const char *path, const char *buffer, int buflen,
     if(rc==ZOK){
         wait_sync_completion(sc);
         rc = sc->rc;
+        if (rc == 0 && stat) {
+            *stat = sc->u.stat;
+        }
     }
     free_sync_completion(sc);
     return rc;
diff --git a/src/c/tests/TestClient.cc b/src/c/tests/TestClient.cc
index f81678b5f..160de1b8a 100644
--- a/src/c/tests/TestClient.cc
+++ b/src/c/tests/TestClient.cc
@@ -390,7 +390,16 @@ public:
         CPPUNIT_ASSERT_MESSAGE(testName, ctxLocal->waitForConnected(zk));
 
         CPPUNIT_ASSERT(ctxLocal->countEvents() == 0);
-        rc = zoo_set(zk, "/watchtest/child", "1", 1, -1);
+
+        rc = zoo_set(zk, "/watchtest/child", "1", 1, -1, 0);
+        CPPUNIT_ASSERT_EQUAL(ZOK, rc);
+        struct Stat stat1, stat2;
+        rc = zoo_set(zk, "/watchtest/child", "1", 1, -1, &stat1);
+        CPPUNIT_ASSERT_EQUAL(ZOK, rc);
+        CPPUNIT_ASSERT(stat1.version >= 0);
+        rc = zoo_set(zk, "/watchtest/child", "1", 1, stat1.version, &stat2);
+        CPPUNIT_ASSERT_EQUAL(ZOK, rc);
+        rc = zoo_set(zk, "/watchtest/child", "1", 1, stat2.version, 0);
         CPPUNIT_ASSERT_EQUAL(ZOK, rc);
         rc = zoo_create(zk, "/watchtest/child2", "", 0,
                         &ZOO_OPEN_ACL_UNSAFE, 0, 0, 0);
diff --git a/src/contrib/zkfuse/src/zkadapter.cc b/src/contrib/zkfuse/src/zkadapter.cc
index c3c80766b..a8e375393 100644
--- a/src/contrib/zkfuse/src/zkadapter.cc
+++ b/src/contrib/zkfuse/src/zkadapter.cc
@@ -866,7 +866,9 @@ ZooKeeperAdapter::setNodeData(const string &path,
         rc = zoo_set( mp_zkHandle,
                       path.c_str(),
                       value.c_str(),
-                      value.length(), version );
+                      value.length(),
+                      version,
+                      0);
     } while (rc != ZOK && rh.handleRC(rc));
     if (rc != ZOK) {
         LOG_ERROR( LOG, "Error %d for %s", rc, path.c_str() );
