<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:00:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[ZOOKEEPER-2893] very poor choice of logging if client fails to connect to server</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-2893</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;We are using ZooKeeper in our project and have received reports that, when suffering a networking problem, log files become flooded with messages like:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;07 Sep 2017 08:22:00 (System) [] Session 0x45d3151be3600a9 for server null, unexpected error, closing socket connection and attempting reconnect&lt;br/&gt;
java.net.NoRouteToHostException: No route to host&lt;br/&gt;
        at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;na:1.8.0_131&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;na:1.8.0_131&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:361) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;zookeeper-3.4.6.jar:3.4.6-1569965&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1081) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;zookeeper-3.4.6.jar:3.4.6-1569965&amp;#93;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Looking at the code that logs this message (&lt;tt&gt;ClientCnxn&lt;/tt&gt;), there seems to be quite a few problems here:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;the code logs a stack-trace, even though there is no bug here.  In our project, we treat all logged stack-traces as bugs,&lt;/li&gt;
	&lt;li&gt;if the networking issue is not fixed promptly, the log files is flooded with these message,&lt;/li&gt;
	&lt;li&gt;The message is built using &lt;tt&gt;ClientCnxnSocket#getRemoteSocketAddress&lt;/tt&gt;, yet in this case, this does not provide the expected information (yielding &lt;tt&gt;null&lt;/tt&gt;),&lt;/li&gt;
	&lt;li&gt;The log message fails to include a description of what actually went wrong.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;(Additionally, the code uses string concatenation rather than templating when building the message; however, this is an optimisation issue)&lt;/p&gt;

&lt;p&gt;My suggestion is that this log entry is updated so that it doesn&apos;t log a stack-trace, but does include some indication why the connection failed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13100412">ZOOKEEPER-2893</key>
            <summary>very poor choice of logging if client fails to connect to server</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="andor">Andor Molnar</assignee>
                                    <reporter username="paulmillar">Paul Millar</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 Sep 2017 09:50:36 +0000</created>
                <updated>Sun, 29 Sep 2024 01:18:37 +0000</updated>
                            <resolved>Tue, 19 Dec 2017 19:05:05 +0000</resolved>
                                    <version>3.4.6</version>
                    <version>3.5.3</version>
                    <version>3.6.0</version>
                                    <fixVersion>3.5.4</fixVersion>
                    <fixVersion>3.6.0</fixVersion>
                    <fixVersion>3.4.12</fixVersion>
                                    <component>java client</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="16167189" author="maoling" created="Fri, 15 Sep 2017 01:09:45 +0000"  >&lt;p&gt;it is an unexpected exception:NoRouteToHostException, so ClientCnxnSocket#getRemoteSocketAddress returns null.for an unexpected exception,we can&apos;t know the reason why it happened and log its stack-trace for locating the problem&lt;/p&gt;</comment>
                            <comment id="16171675" author="paulmillar" created="Tue, 19 Sep 2017 13:27:16 +0000"  >&lt;p&gt;... just to add my 2c-worth&lt;/p&gt;

&lt;p&gt;Sure, ClientCnxnSocket#getRemoteSocketAddress returns null; however the problem (item 3.) is not with the return value of ClientCnxnSocket#getRemoteSocketAddress.&lt;/p&gt;

&lt;p&gt;Rather, the problem (item 3. in the list) is that the &lt;em&gt;error message&lt;/em&gt; is built using something that can be `null`.&lt;/p&gt;

&lt;p&gt;The remote address is actually well-defined.  ClientCnxn certainly should know to which endpoint it is trying to connect.&lt;/p&gt;

&lt;p&gt;To fix this problem, the error message should include the remote endpoint using something that cannot be null.&lt;/p&gt;</comment>
                            <comment id="16287581" author="andorm" created="Tue, 12 Dec 2017 13:15:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulmillar&quot; class=&quot;user-hover&quot; rel=&quot;paulmillar&quot;&gt;paulmillar&lt;/a&gt; I&apos;ll take a look and submit a pull request soon.&lt;/p&gt;</comment>
                            <comment id="16287622" author="githubbot" created="Tue, 12 Dec 2017 13:50:33 +0000"  >&lt;p&gt;GitHub user anmolnar opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/430&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/430&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2893&quot; title=&quot;very poor choice of logging if client fails to connect to server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2893&quot;&gt;&lt;del&gt;ZOOKEEPER-2893&lt;/del&gt;&lt;/a&gt;. Make &apos;addr&apos; variable available for error handling code to give a chance to fallback if the socket hasn&apos;t been initialized yet&lt;/p&gt;

&lt;p&gt;    &apos;addr&apos; variable is used to identify which server to connect to.&lt;br/&gt;
    I&apos;ve made this available for error handling code in order to let it fallback to this address if the remote socket hasn&apos;t been initialised yet. This will give us better error messages if the client is unable to connect to server for some reason.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/anmolnar/zookeeper&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/anmolnar/zookeeper&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2893&quot; title=&quot;very poor choice of logging if client fails to connect to server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2893&quot;&gt;&lt;del&gt;ZOOKEEPER-2893&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/430.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/430.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #430&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit fbe4ccde8516150cfd69d2a2260266fd1c0bf10d&lt;br/&gt;
Author: Andor Molnar &amp;lt;andor@cloudera.com&amp;gt;&lt;br/&gt;
Date:   2017-12-12T13:46:34Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2893&quot; title=&quot;very poor choice of logging if client fails to connect to server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2893&quot;&gt;&lt;del&gt;ZOOKEEPER-2893&lt;/del&gt;&lt;/a&gt;. Make &apos;addr&apos; variable available for error handling code to give a chance to fallback if the socket hasn&apos;t been initialized yet&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16287625" author="andorm" created="Tue, 12 Dec 2017 13:51:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulmillar&quot; class=&quot;user-hover&quot; rel=&quot;paulmillar&quot;&gt;paulmillar&lt;/a&gt; please check it &lt;/p&gt;</comment>
                            <comment id="16287649" author="hadoopqa" created="Tue, 12 Dec 2017 14:09:13 +0000"  >&lt;p&gt;+1 overall.  GitHub Pull Request  Build&lt;/p&gt;


&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +0 tests included.  The patch appears to be a documentation patch that doesn&apos;t require tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1340//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1340//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1340//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1340//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1340//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1340//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16288906" author="githubbot" created="Wed, 13 Dec 2017 08:52:20 +0000"  >&lt;p&gt;Github user paulmillar commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/430#discussion_r156594153&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/430#discussion_r156594153&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java &amp;#8212;&lt;br/&gt;
    @@ -1232,11 +1233,12 @@ public void run() {&lt;br/&gt;
                             } else if (e instanceof RWServerFoundException) &lt;/p&gt;
{
                                 LOG.info(e.getMessage());
                             }
&lt;p&gt; else {&lt;br/&gt;
    +                            SocketAddress remoteAddr = clientCnxnSocket.getRemoteSocketAddress();&lt;br/&gt;
                                 LOG.warn(&lt;br/&gt;
                                         &quot;Session 0x&quot;&lt;br/&gt;
                                                 + Long.toHexString(getSessionId())&lt;br/&gt;
                                                 + &quot; for server &quot;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;+ clientCnxnSocket.getRemoteSocketAddress()&lt;br/&gt;
    +                                            + (remoteAddr == null ? addr : remoteAddr)
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    I believe that, if `clientCnxnSocket.getRemoteSocketAddress()` is non-null, the value is always the same as `addr`.&lt;/p&gt;

&lt;p&gt;    If so, then this could be simplified to just `addr` without the ternary operation.&lt;/p&gt;</comment>
                            <comment id="16288908" author="githubbot" created="Wed, 13 Dec 2017 08:55:34 +0000"  >&lt;p&gt;Github user paulmillar commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/430#discussion_r156594864&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/430#discussion_r156594864&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java &amp;#8212;&lt;br/&gt;
    @@ -1041,6 +1041,8 @@ private void sendPing() {&lt;/p&gt;

&lt;p&gt;             private InetSocketAddress rwServerAddress = null;&lt;/p&gt;

&lt;p&gt;    +        private InetSocketAddress addr = null;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;non-blocking&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;    The name could be an ambiguous: is this the address of the local (client) side of the connection, or the remote (server) side of the connection?  Especially as there is `rwServerAddress` field member defined immediately above.&lt;/p&gt;

&lt;p&gt;    Suggest `serverAddress` (or similar)&lt;/p&gt;</comment>
                            <comment id="16288909" author="githubbot" created="Wed, 13 Dec 2017 08:56:01 +0000"  >&lt;p&gt;Github user paulmillar commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/430#discussion_r156594949&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/430#discussion_r156594949&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java &amp;#8212;&lt;br/&gt;
    @@ -1232,11 +1233,12 @@ public void run() {&lt;br/&gt;
                             } else if (e instanceof RWServerFoundException) &lt;/p&gt;
{
                                 LOG.info(e.getMessage());
                             }
&lt;p&gt; else {&lt;br/&gt;
    +                            SocketAddress remoteAddr = clientCnxnSocket.getRemoteSocketAddress();&lt;br/&gt;
                                 LOG.warn(&lt;br/&gt;
                                         &quot;Session 0x&quot;&lt;br/&gt;
                                                 + Long.toHexString(getSessionId())&lt;br/&gt;
                                                 + &quot; for server &quot;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;+ clientCnxnSocket.getRemoteSocketAddress()&lt;br/&gt;
    +                                            + (remoteAddr == null ? addr : remoteAddr)
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Of course this comment is &lt;span class=&quot;error&quot;&gt;&amp;#91;non-blocking&amp;#93;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="16288924" author="githubbot" created="Wed, 13 Dec 2017 09:08:41 +0000"  >&lt;p&gt;Github user anmolnar commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/430#discussion_r156597536&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/430#discussion_r156597536&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java &amp;#8212;&lt;br/&gt;
    @@ -1232,11 +1233,12 @@ public void run() {&lt;br/&gt;
                             } else if (e instanceof RWServerFoundException) &lt;/p&gt;
{
                                 LOG.info(e.getMessage());
                             }
&lt;p&gt; else {&lt;br/&gt;
    +                            SocketAddress remoteAddr = clientCnxnSocket.getRemoteSocketAddress();&lt;br/&gt;
                                 LOG.warn(&lt;br/&gt;
                                         &quot;Session 0x&quot;&lt;br/&gt;
                                                 + Long.toHexString(getSessionId())&lt;br/&gt;
                                                 + &quot; for server &quot;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;+ clientCnxnSocket.getRemoteSocketAddress()&lt;br/&gt;
    +                                            + (remoteAddr == null ? addr : remoteAddr)
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Makes sense. I&apos;ll just use &apos;addr&apos; here.&lt;/p&gt;</comment>
                            <comment id="16288941" author="githubbot" created="Wed, 13 Dec 2017 09:18:45 +0000"  >&lt;p&gt;Github user anmolnar commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/430#discussion_r156599702&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/430#discussion_r156599702&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java &amp;#8212;&lt;br/&gt;
    @@ -1041,6 +1041,8 @@ private void sendPing() {&lt;/p&gt;

&lt;p&gt;             private InetSocketAddress rwServerAddress = null;&lt;/p&gt;

&lt;p&gt;    +        private InetSocketAddress addr = null;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Remote side of the connection. Basically the ip address that the client is trying to connect to. ```rwServerAddress``` is the address of non-R/O server found if there&apos;s any.&lt;/p&gt;

&lt;p&gt;    I&apos;ll change this to ```serverAddress```.&lt;/p&gt;</comment>
                            <comment id="16289186" author="hadoopqa" created="Wed, 13 Dec 2017 12:14:57 +0000"  >&lt;p&gt;+1 overall.  GitHub Pull Request  Build&lt;/p&gt;


&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +0 tests included.  The patch appears to be a documentation patch that doesn&apos;t require tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1359//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1359//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1359//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1359//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1359//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1359//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16289222" author="paulmillar" created="Wed, 13 Dec 2017 13:02:34 +0000"  >&lt;p&gt;The other thing that would be good to fix is that the message is logged with a stack-trace.&lt;/p&gt;

&lt;p&gt;Would it be possible to change the log message so it doesn&apos;t include a stack-trace; for example, &lt;tt&gt;LOG.warn(&quot;Session 0x&quot; +  ... + String.valueOf(e))&lt;/tt&gt;, instead of &lt;tt&gt;LOG.warn(&quot;Session 0x&quot; + ..., e)&lt;/tt&gt; ?&lt;/p&gt;</comment>
                            <comment id="16289437" author="andorm" created="Wed, 13 Dec 2017 16:02:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulmillar&quot; class=&quot;user-hover&quot; rel=&quot;paulmillar&quot;&gt;paulmillar&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I thought about it, but that would be a non backward compatible change. This part is the catch-all exception handler so all non-expected errors will end up here which makes sense for dumping the whole stack trace.&lt;/p&gt;

&lt;p&gt;I&apos;d rather implement specific error handlers for NoRouteToHost and other special errors if you want to make it fancy.&lt;/p&gt;

&lt;p&gt;Additionally, I&apos;m not familiar with log4j/slf4j settings, but that could be a setting of the appender whether stack traces needs to be logged or not.&lt;/p&gt;</comment>
                            <comment id="16290147" author="githubbot" created="Thu, 14 Dec 2017 00:30:57 +0000"  >&lt;p&gt;Github user phunt commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/430#discussion_r156825456&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/430#discussion_r156825456&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java &amp;#8212;&lt;br/&gt;
    @@ -1041,6 +1041,8 @@ private void sendPing() {&lt;/p&gt;

&lt;p&gt;             private InetSocketAddress rwServerAddress = null;&lt;/p&gt;

&lt;p&gt;    +        private InetSocketAddress serverAddress = null;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    This seems kinda bogus to me - why push this up to a field. Can&apos;t we determine the server address in &quot;run&quot; method, as a local variable, and call startConnect with that as an argument? That seems like an improvement to startConnect call at the same time. What do you think @anmolnar , does that make sense or am I missing something?&lt;/p&gt;</comment>
                            <comment id="16290148" author="githubbot" created="Thu, 14 Dec 2017 00:30:57 +0000"  >&lt;p&gt;Github user phunt commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/430#discussion_r156825263&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/430#discussion_r156825263&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java &amp;#8212;&lt;br/&gt;
    @@ -1236,7 +1237,7 @@ public void run() {&lt;br/&gt;
                                         &quot;Session 0x&quot;&lt;br/&gt;
                                                 + Long.toHexString(getSessionId())&lt;br/&gt;
                                                 + &quot; for server &quot;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;+ clientCnxnSocket.getRemoteSocketAddress()&lt;br/&gt;
    +                                            + serverAddress&lt;br/&gt;
                                                 + &quot;, unexpected error&quot;&lt;br/&gt;
                                                 + RETRY_CONN_MSG, e);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    I think it would be good to address the other issue Paul mentioned - no need to dump a stack if we know this is NoRouteToHostException - why wouldn&apos;t we add another elseif to check for this type?&lt;/p&gt;</comment>
                            <comment id="16290571" author="paulmillar" created="Thu, 14 Dec 2017 08:59:28 +0000"  >&lt;p&gt;Catching NoRouteToHostException would be good, but there are other exceptions that can happen legitimately and that (I believe) shouldn&apos;t result in logging a stack-trace: ConnectException and PortUnreachableException for example.&lt;/p&gt;

&lt;p&gt;Perhaps it would be better to catch SocketException and log it without a stack-trace?&lt;/p&gt;

&lt;p&gt;The same argument could also applies to IOException; I&apos;m not sure how useful it is to log a stack-trace on an UnknownHostException.&lt;/p&gt;</comment>
                            <comment id="16290883" author="githubbot" created="Thu, 14 Dec 2017 14:07:15 +0000"  >&lt;p&gt;Github user anmolnar commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/430#discussion_r156951799&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/430#discussion_r156951799&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java &amp;#8212;&lt;br/&gt;
    @@ -1041,6 +1041,8 @@ private void sendPing() {&lt;/p&gt;

&lt;p&gt;             private InetSocketAddress rwServerAddress = null;&lt;/p&gt;

&lt;p&gt;    +        private InetSocketAddress serverAddress = null;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Good idea. I&apos;ve made the change.&lt;/p&gt;</comment>
                            <comment id="16290884" author="githubbot" created="Thu, 14 Dec 2017 14:09:14 +0000"  >&lt;p&gt;Github user anmolnar commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/430#discussion_r156952287&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/430#discussion_r156952287&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java &amp;#8212;&lt;br/&gt;
    @@ -1236,7 +1237,7 @@ public void run() {&lt;br/&gt;
                                         &quot;Session 0x&quot;&lt;br/&gt;
                                                 + Long.toHexString(getSessionId())&lt;br/&gt;
                                                 + &quot; for server &quot;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;+ clientCnxnSocket.getRemoteSocketAddress()&lt;br/&gt;
    +                                            + serverAddress&lt;br/&gt;
                                                 + &quot;, unexpected error&quot;&lt;br/&gt;
                                                 + RETRY_CONN_MSG, e);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    We&apos;re talking about the same thing in the Jira. It&apos;s arguable which exception should be logged at INFO level without the stack trace, I ended up separating SocketExceptions altogether and leaving the rest for the original handler.&lt;/p&gt;</comment>
                            <comment id="16290905" author="hadoopqa" created="Thu, 14 Dec 2017 14:28:19 +0000"  >&lt;p&gt;-1 overall.  GitHub Pull Request  Build&lt;/p&gt;


&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +0 tests included.  The patch appears to be a documentation patch that doesn&apos;t require tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1368//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1368//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1368//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1368//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1368//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1368//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16290951" author="hadoopqa" created="Thu, 14 Dec 2017 15:05:20 +0000"  >&lt;p&gt;+1 overall.  GitHub Pull Request  Build&lt;/p&gt;


&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +0 tests included.  The patch appears to be a documentation patch that doesn&apos;t require tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1369//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1369//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1369//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1369//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1369//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1369//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16291144" author="andorm" created="Thu, 14 Dec 2017 16:38:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulmillar&quot; class=&quot;user-hover&quot; rel=&quot;paulmillar&quot;&gt;paulmillar&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I&apos;ve created a separate &apos;if&apos; for SocketException, but not for IOException. Do you think we can live with that for now?&lt;/p&gt;</comment>
                            <comment id="16291327" author="paulmillar" created="Thu, 14 Dec 2017 18:35:09 +0000"  >&lt;p&gt;Yes, that sounds fine.&lt;/p&gt;

&lt;p&gt;One final thing: log4j has a built-in template support.  You can write the log message like:&lt;/p&gt;

&lt;p&gt;    LOG.info(&quot;Socket error occurred: {}: {}&quot;, serverAddress, e.getMessage());&lt;/p&gt;

&lt;p&gt;In addition to being shorter, this has the advantage of avoiding the string concatenation if the message isn&apos;t going to be logged.  This is particularly useful for DEBUG-level and TRACE-level logging.&lt;/p&gt;</comment>
                            <comment id="16292522" author="andorm" created="Fri, 15 Dec 2017 13:18:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulmillar&quot; class=&quot;user-hover&quot; rel=&quot;paulmillar&quot;&gt;paulmillar&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Done.&lt;br/&gt;
Let&apos;s move this review to github, if you still have comments.&lt;/p&gt;</comment>
                            <comment id="16292541" author="githubbot" created="Fri, 15 Dec 2017 13:31:32 +0000"  >&lt;p&gt;Github user paulmillar commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/430#discussion_r157201054&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/430#discussion_r157201054&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java &amp;#8212;&lt;br/&gt;
    @@ -1231,14 +1231,14 @@ public void run() &lt;/p&gt;
{
                                 LOG.info(e.getMessage() + RETRY_CONN_MSG);
                             }
&lt;p&gt; else if (e instanceof RWServerFoundException) &lt;/p&gt;
{
                                 LOG.info(e.getMessage());
    +                        }
&lt;p&gt; else if (e instanceof SocketException) {&lt;br/&gt;
    +                            LOG.info(&quot;Socket error occurred: {}: {}&quot;, serverAddress, e.getMessage());&lt;br/&gt;
                             } else {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;LOG.warn(&lt;/li&gt;
	&lt;li&gt;&quot;Session 0x&quot;&lt;/li&gt;
	&lt;li&gt;+ Long.toHexString(getSessionId())&lt;/li&gt;
	&lt;li&gt;+ &quot; for server &quot;&lt;/li&gt;
	&lt;li&gt;+ clientCnxnSocket.getRemoteSocketAddress()&lt;/li&gt;
	&lt;li&gt;+ &quot;, unexpected error&quot;&lt;/li&gt;
	&lt;li&gt;+ RETRY_CONN_MSG, e);&lt;br/&gt;
    +                            LOG.warn(&quot;Session 0x{} for server {}, unexpected error{}&quot;,
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;non-blocking&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;    Although this isn&apos;t a regression, you probably want a &quot;: &quot; here (and a space); e.g.,&lt;/p&gt;

&lt;p&gt;        &quot;Session 0x{} for server {}, unexpected error: {}&quot;&lt;/p&gt;</comment>
                            <comment id="16292545" author="hadoopqa" created="Fri, 15 Dec 2017 13:37:16 +0000"  >&lt;p&gt;+1 overall.  GitHub Pull Request  Build&lt;/p&gt;


&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +0 tests included.  The patch appears to be a documentation patch that doesn&apos;t require tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1375//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1375//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1375//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1375//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1375//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1375//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16292967" author="githubbot" created="Fri, 15 Dec 2017 18:22:00 +0000"  >&lt;p&gt;Github user anmolnar commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/430#discussion_r157266599&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/430#discussion_r157266599&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java &amp;#8212;&lt;br/&gt;
    @@ -1231,14 +1231,14 @@ public void run() &lt;/p&gt;
{
                                 LOG.info(e.getMessage() + RETRY_CONN_MSG);
                             }
&lt;p&gt; else if (e instanceof RWServerFoundException) &lt;/p&gt;
{
                                 LOG.info(e.getMessage());
    +                        }
&lt;p&gt; else if (e instanceof SocketException) {&lt;br/&gt;
    +                            LOG.info(&quot;Socket error occurred: {}: {}&quot;, serverAddress, e.getMessage());&lt;br/&gt;
                             } else {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;LOG.warn(&lt;/li&gt;
	&lt;li&gt;&quot;Session 0x&quot;&lt;/li&gt;
	&lt;li&gt;+ Long.toHexString(getSessionId())&lt;/li&gt;
	&lt;li&gt;+ &quot; for server &quot;&lt;/li&gt;
	&lt;li&gt;+ clientCnxnSocket.getRemoteSocketAddress()&lt;/li&gt;
	&lt;li&gt;+ &quot;, unexpected error&quot;&lt;/li&gt;
	&lt;li&gt;+ RETRY_CONN_MSG, e);&lt;br/&gt;
    +                            LOG.warn(&quot;Session 0x{} for server {}, unexpected error{}&quot;,
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    No, because the RETRY_CONN_MSG should go right after it. (starts with &quot;, &quot;)&lt;/p&gt;</comment>
                            <comment id="16294827" author="githubbot" created="Mon, 18 Dec 2017 11:20:54 +0000"  >&lt;p&gt;Github user anmolnar commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/430&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/430&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @paulmillar Please approve it, if you&apos;re happy with the change.&lt;br/&gt;
    @phunt Do you think it can be committed?&lt;/p&gt;</comment>
                            <comment id="16297198" author="githubbot" created="Tue, 19 Dec 2017 18:28:44 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/430&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/430&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16297257" author="hudson" created="Tue, 19 Dec 2017 18:55:27 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build ZooKeeper-trunk #3665 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/3665/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/3665/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2893&quot; title=&quot;very poor choice of logging if client fails to connect to server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2893&quot;&gt;&lt;del&gt;ZOOKEEPER-2893&lt;/del&gt;&lt;/a&gt;: very poor choice of logging if client fails to connect (phunt: rev e129e7a0b64d6555460d240be2d79e53aaa1bef9)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/ClientCnxn.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16297268" author="phunt" created="Tue, 19 Dec 2017 19:05:05 +0000"  >&lt;p&gt;+1 lgtm. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andor&quot; class=&quot;user-hover&quot; rel=&quot;andor&quot;&gt;andor&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulmillar&quot; class=&quot;user-hover&quot; rel=&quot;paulmillar&quot;&gt;paulmillar&lt;/a&gt; !&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310051">
                    <name>Supercedes</name>
                                            <outwardlinks description="supercedes">
                                        <issuelink>
            <issuekey id="12559477">ZOOKEEPER-1480</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 48 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3jr6f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>