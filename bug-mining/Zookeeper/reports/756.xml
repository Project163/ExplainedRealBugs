<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:58:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[ZOOKEEPER-2442] Socket leak in QuorumCnxManager connectOne</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-2442</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;The function connectOne() in QuorumCnxManager.java sometimes fails to release a socket allocated by Socket():&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {

                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (LOG.isDebugEnabled()) {
                    LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Opening channel to server &quot;&lt;/span&gt; + sid);
                }
                Socket sock = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Socket();
                setSockOpts(sock);
                sock.connect(self.getView().get(sid).electionAddr, cnxTO);
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (LOG.isDebugEnabled()) {
                    LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Connected to server &quot;&lt;/span&gt; + sid);
                }
                initiateConnection(sock, sid);
            } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (UnresolvedAddressException e) {
                &lt;span class=&quot;code-comment&quot;&gt;// Sun doesn&apos;t include the address that causes &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;
&lt;/span&gt;                &lt;span class=&quot;code-comment&quot;&gt;// exception to be thrown, also UAE cannot be wrapped cleanly
&lt;/span&gt;                &lt;span class=&quot;code-comment&quot;&gt;// so we log the exception in order to capture &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; critical
&lt;/span&gt;                &lt;span class=&quot;code-comment&quot;&gt;// detail.
&lt;/span&gt;                LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Cannot open channel to &quot;&lt;/span&gt; + sid
                        + &lt;span class=&quot;code-quote&quot;&gt;&quot; at election address &quot;&lt;/span&gt; + electionAddr, e);
                &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; e;
            } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {
                LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Cannot open channel to &quot;&lt;/span&gt; + sid
                        + &lt;span class=&quot;code-quote&quot;&gt;&quot; at election address &quot;&lt;/span&gt; + electionAddr,
                        e);
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Another place in Listener.run() where the client socket is not explicitly closed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12975658">ZOOKEEPER-2442</key>
            <summary>Socket leak in QuorumCnxManager connectOne</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hanm">Michael Han</assignee>
                                    <reporter username="hanm">Michael Han</reporter>
                        <labels>
                    </labels>
                <created>Fri, 3 Jun 2016 23:05:36 +0000</created>
                <updated>Thu, 18 May 2017 03:43:59 +0000</updated>
                            <resolved>Wed, 3 Aug 2016 04:32:35 +0000</resolved>
                                    <version>3.5.1</version>
                                    <fixVersion>3.5.3</fixVersion>
                    <fixVersion>3.6.0</fixVersion>
                                    <component>quorum</component>
                    <component>server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="15319079" author="hanm" created="Tue, 7 Jun 2016 18:32:01 +0000"  >&lt;p&gt;1. Refactor closeSocket so it can handle null input parameter which simplifies caller side.&lt;br/&gt;
2. Close socket for all code path that&apos;s previously missing.&lt;br/&gt;
3. Refactor Log.debug to remove the conditional check to make the usage consistent across the file.&lt;/p&gt;</comment>
                            <comment id="15319081" author="hanm" created="Tue, 7 Jun 2016 18:32:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=phunt&quot; class=&quot;user-hover&quot; rel=&quot;phunt&quot;&gt;phunt&lt;/a&gt; PTAL.&lt;/p&gt;</comment>
                            <comment id="15319110" author="hadoopqa" created="Tue, 7 Jun 2016 18:50:32 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12808731/ZOOKEEPER-2442.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12808731/ZOOKEEPER-2442.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1746511.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3182//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3182//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3182//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3182//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3182//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3182//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15319556" author="hanm" created="Tue, 7 Jun 2016 22:09:04 +0000"  >&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; -1 tests included. &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;No test included because the existing tests provide enough coverage for this patch.&lt;/p&gt;</comment>
                            <comment id="15320763" author="rgs" created="Wed, 8 Jun 2016 15:38:27 +0000"  >&lt;p&gt;lgtm, +1 - thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hanm&quot; class=&quot;user-hover&quot; rel=&quot;hanm&quot;&gt;hanm&lt;/a&gt;! &lt;/p&gt;

&lt;p&gt;Presumably we want this for trunk and 3.5.x, right? I&apos;ll merge to trunk first. &lt;/p&gt;

&lt;p&gt;cc: &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cnauroth&quot; class=&quot;user-hover&quot; rel=&quot;cnauroth&quot;&gt;cnauroth&lt;/a&gt; who is getting the next 3.5.x release ready. &lt;/p&gt;</comment>
                            <comment id="15320766" author="rgs" created="Wed, 8 Jun 2016 15:39:48 +0000"  >&lt;p&gt;Oh, forgot to mention, a super small nit for next time. In:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;-        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (LOG.isDebugEnabled()) {
-            LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Opening channel to server &quot;&lt;/span&gt; + sid);
-        }
+        LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Opening channel to server &quot;&lt;/span&gt; + sid);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think for LOG statements using {} (extrapolation) instead of + (concatenation) reads nicer (specially for statements with multiple vars in them.&lt;/p&gt;</comment>
                            <comment id="15320773" author="rgs" created="Wed, 8 Jun 2016 15:44:07 +0000"  >&lt;p&gt;Merged to trunk:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/zookeeper/commit/3c37184e83a3e68b73544cebccf9388eea26f523&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/commit/3c37184e83a3e68b73544cebccf9388eea26f523&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Waiting on &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cnauroth&quot; class=&quot;user-hover&quot; rel=&quot;cnauroth&quot;&gt;cnauroth&lt;/a&gt; for merging to the 3.5 branch.&lt;/p&gt;</comment>
                            <comment id="15320828" author="hanm" created="Wed, 8 Jun 2016 16:08:01 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rgs&quot; class=&quot;user-hover&quot; rel=&quot;rgs&quot;&gt;rgs&lt;/a&gt; for the code review and commit!&lt;/p&gt;</comment>
                            <comment id="15320859" author="hudson" created="Wed, 8 Jun 2016 16:23:42 +0000"  >&lt;p&gt;FAILURE: Integrated in ZooKeeper-trunk #2953 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/2953/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/2953/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2442&quot; title=&quot;Socket leak in QuorumCnxManager connectOne&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2442&quot;&gt;&lt;del&gt;ZOOKEEPER-2442&lt;/del&gt;&lt;/a&gt;: Socket leak in QuorumCnxManager connectOne&lt;br/&gt;
(Michael Han via rgs) (rgs: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1747408&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1747408&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;trunk/src/java/main/org/apache/zookeeper/server/quorum/QuorumCnxManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15580106" author="rakeshr" created="Sun, 16 Oct 2016 15:08:02 +0000"  >&lt;p&gt;I think this has to be back ported to &lt;tt&gt;branch-3.5&lt;/tt&gt;, shall I merge this to branch-3.5, any comments?&lt;/p&gt;</comment>
                            <comment id="15586911" author="hanm" created="Tue, 18 Oct 2016 22:43:39 +0000"  >&lt;p&gt;+1 on merge this to 3.5 branch. cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cnauroth&quot; class=&quot;user-hover&quot; rel=&quot;cnauroth&quot;&gt;cnauroth&lt;/a&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rgs&quot; class=&quot;user-hover&quot; rel=&quot;rgs&quot;&gt;rgs&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15589587" author="cnauroth" created="Wed, 19 Oct 2016 19:15:49 +0000"  >&lt;p&gt;+1 for a back-port to branch-3.5.  Thank you, Michael and Rakesh.&lt;/p&gt;</comment>
                            <comment id="15607177" author="rakeshr" created="Wed, 26 Oct 2016 02:43:31 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hanm&quot; class=&quot;user-hover&quot; rel=&quot;hanm&quot;&gt;hanm&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cnauroth&quot; class=&quot;user-hover&quot; rel=&quot;cnauroth&quot;&gt;cnauroth&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Merged to branch-3.5, committed revision: &lt;a href=&quot;https://github.com/apache/zookeeper/commit/6bd38e3d89ecc03285459be3e511d32f487ced0c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;6bd38e3d89ecc03285459be3e511d32f487ced0c&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12808731" name="ZOOKEEPER-2442.patch" size="4933" author="hanm" created="Tue, 7 Jun 2016 18:32:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2yz2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>