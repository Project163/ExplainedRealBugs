<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:59:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[ZOOKEEPER-2683] RaceConditionTest is flaky</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-2683</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;&lt;b&gt;Error Message&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Leader failed to transition to LOOKING or FOLLOWING state
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;b&gt;Stacktrace&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;junit.framework.AssertionFailedError: Leader failed to transition to LOOKING or FOLLOWING state
	at org.apache.zookeeper.server.quorum.RaceConditionTest.testRaceConditionBetweenLeaderAndAckRequestProcessor(RaceConditionTest.java:74)
	at org.apache.zookeeper.JUnit4ZKTestRunner$LoggedInvokeMethod.evaluate(JUnit4ZKTestRunner.java:79)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.lang.Thread.run(Thread.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/279//testReport/org.apache.zookeeper.server.quorum/RaceConditionTest/testRaceConditionBetweenLeaderAndAckRequestProcessor/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CI Failures Reference&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13040701">ZOOKEEPER-2683</key>
            <summary>RaceConditionTest is flaky</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="arshad.mohammad">Mohammad Arshad</assignee>
                                    <reporter username="arshad.mohammad">Mohammad Arshad</reporter>
                        <labels>
                    </labels>
                <created>Mon, 6 Feb 2017 18:01:41 +0000</created>
                <updated>Thu, 18 May 2017 03:43:54 +0000</updated>
                            <resolved>Mon, 13 Feb 2017 21:10:28 +0000</resolved>
                                    <version>3.5.2</version>
                    <version>3.6.0</version>
                                    <fixVersion>3.5.3</fixVersion>
                    <fixVersion>3.6.0</fixVersion>
                                    <component>tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15854462" author="arshad.mohammad" created="Mon, 6 Feb 2017 18:03:25 +0000"  >&lt;p&gt;Test case expectation is wrong. Test case is expecting the old leader to be the follower only, which is not correct.&lt;br/&gt;
Old leader can become the leader again.&lt;/p&gt;</comment>
                            <comment id="15855445" author="arshad.mohammad" created="Tue, 7 Feb 2017 06:56:35 +0000"  >&lt;p&gt;QuorumPeerMain.getQuorumPeer visibility changed to protected to simply the test case. This is just improvement&lt;br/&gt;
Fix can be without this change but it is good to have.&lt;/p&gt;</comment>
                            <comment id="15855651" author="hadoopqa" created="Tue, 7 Feb 2017 09:43:18 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12851322/ZOOKEEPER-2683-01.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12851322/ZOOKEEPER-2683-01.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision ee5615d31ff4da2b2111f5a3b5d5b650f60bf936.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3575//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3575//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3575//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3575//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3575//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3575//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15860210" author="hanm" created="Thu, 9 Feb 2017 21:18:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arshad.mohammad&quot; class=&quot;user-hover&quot; rel=&quot;arshad.mohammad&quot;&gt;arshad.mohammad&lt;/a&gt; Do you mind creating a pull request for this? It is easier to comment in github and easier to merge a PR with the merge script, thanks.&lt;/p&gt;

&lt;p&gt;Quick comments on the patch: why not just do this instead?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;assertTrue(
                &lt;span class=&quot;code-quote&quot;&gt;&quot;Leader failed to transition to &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; state. Current state is &quot;&lt;/span&gt;
                        + leader.getServerState(),
            ClientBase.waitForServerState(leader, 15000,
                QuorumStats.Provider.LOOKING_STATE, QuorumStats.Provider.FOLLOWING_STATE,
                QuorumStats.Provider.LEADING_STATE));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15864234" author="arshad.mohammad" created="Mon, 13 Feb 2017 19:09:48 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hanm&quot; class=&quot;user-hover&quot; rel=&quot;hanm&quot;&gt;hanm&lt;/a&gt; for review. &lt;br/&gt;
Old leader is already in QuorumStats.Provider.LEADING_STATE that is why I think it is not good to include in the assert list.&lt;/p&gt;</comment>
                            <comment id="15864293" author="githubbot" created="Mon, 13 Feb 2017 19:45:29 +0000"  >&lt;p&gt;GitHub user arshadmohammad opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/175&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/175&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2683&quot; title=&quot;RaceConditionTest is flaky&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2683&quot;&gt;&lt;del&gt;ZOOKEEPER-2683&lt;/del&gt;&lt;/a&gt;: RaceConditionTest is flaky&lt;/p&gt;

&lt;p&gt;    RaceConditionTest assertion is wrong, It fails when old leader becomes leader again.  &lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/arshadmohammad/zookeeper&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/arshadmohammad/zookeeper&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2683&quot; title=&quot;RaceConditionTest is flaky&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2683&quot;&gt;&lt;del&gt;ZOOKEEPER-2683&lt;/del&gt;&lt;/a&gt;-03&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/175.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/175.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #175&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 797edf7aa9d182df87e91355d6493263e92e11f9&lt;br/&gt;
Author: Mohammad Arshad &amp;lt;arshad@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-02-13T19:11:02Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2683&quot; title=&quot;RaceConditionTest is flaky&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2683&quot;&gt;&lt;del&gt;ZOOKEEPER-2683&lt;/del&gt;&lt;/a&gt;: RaceConditionTest is flaky&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15864418" author="hanm" created="Mon, 13 Feb 2017 21:08:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arshad.mohammad&quot; class=&quot;user-hover&quot; rel=&quot;arshad.mohammad&quot;&gt;arshad.mohammad&lt;/a&gt; make sense, we could improve waitForServerState so it captures state transitions between same states, but your current code is fine. +1, merging.&lt;/p&gt;</comment>
                            <comment id="15864423" author="githubbot" created="Mon, 13 Feb 2017 21:10:22 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/175&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/175&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15864424" author="hanm" created="Mon, 13 Feb 2017 21:10:28 +0000"  >&lt;p&gt;Issue resolved by pull request 175&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/zookeeper/pull/175&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/175&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15864427" author="hanm" created="Mon, 13 Feb 2017 21:11:53 +0000"  >&lt;p&gt;Merged to master: &lt;a href=&quot;https://github.com/apache/zookeeper/commit/201cac20e1a66e7d4180a6c7e18834c0ca6094dc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/commit/201cac20e1a66e7d4180a6c7e18834c0ca6094dc&lt;/a&gt;&lt;br/&gt;
Merged to branch-3.5: &lt;a href=&quot;https://github.com/apache/zookeeper/commit/5c414230e7b277abdc819a6d6dd196a1ad17cc16&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/commit/5c414230e7b277abdc819a6d6dd196a1ad17cc16&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15864434" author="hudson" created="Mon, 13 Feb 2017 21:15:14 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build ZooKeeper-trunk #3277 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/3277/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/3277/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2683&quot; title=&quot;RaceConditionTest is flaky&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2683&quot;&gt;&lt;del&gt;ZOOKEEPER-2683&lt;/del&gt;&lt;/a&gt;: RaceConditionTest is flaky (hanm: rev 201cac20e1a66e7d4180a6c7e18834c0ca6094dc)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) src/java/test/org/apache/zookeeper/server/quorum/RaceConditionTest.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/server/quorum/QuorumPeerMain.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12780346">ZOOKEEPER-2135</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12851322" name="ZOOKEEPER-2683-01.patch" size="5834" author="arshad.mohammad" created="Tue, 7 Feb 2017 06:56:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 40 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i39obj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>