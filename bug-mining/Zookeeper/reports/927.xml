<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:01:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[ZOOKEEPER-3218] zk server reopened&#65292;the interval for observer connect to the new leader is too long&#65292;then session expired</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-3218</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;two participants&#12289;one observer&#65292;zkclient connect to observer&#12290;&lt;/p&gt;

&lt;p&gt;Then&#65292;close the two participants&#65292;the zookeeper server cloesed&lt;/p&gt;

&lt;p&gt;Ten seconds later&#65292;reopen the two participants&#65292;and leader selected&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt;But the observer can&apos;t connect to the new leader immediately&#12290;Because in lookForLeader, the observer use blockingQueue(recvqueue)&#160; to offer/poll notifications&#65292;when the recvqueue is empty&#65292;poll from recvqueue will be blocked&#65292;and timeout is 200ms&#65292;400ms&#65292;800ms....60s&#12290;&lt;/p&gt;

&lt;p&gt;For example&#65292;09:59:59 observer poll notification&#65292;recvqueue was empty and timeout was 60s&#65307;10:00:00 two participants reopened and reselected&#65307;10:00:59 observer polled notification&#65292;connected to the new leader&lt;/p&gt;

&lt;p&gt;But the maxSessionTimeout default to 40s&#12290;The session expired&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Please improve it&#65306;observer should connect to the new leader as soon as possible&lt;/p&gt;</description>
                <environment>&lt;p&gt;win7 32bits&lt;/p&gt;

&lt;p&gt;zookeeper 3.4.6&#12289;3.4.13&lt;/p&gt;</environment>
        <key id="13204989">ZOOKEEPER-3218</key>
            <summary>zk server reopened&#65292;the interval for observer connect to the new leader is too long&#65292;then session expired</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="q_zero">yangoofy</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 17 Dec 2018 20:55:57 +0000</created>
                <updated>Fri, 18 Jan 2019 06:28:31 +0000</updated>
                            <resolved>Fri, 18 Jan 2019 02:45:51 +0000</resolved>
                                                    <fixVersion>3.6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16728423" author="maoling" created="Mon, 24 Dec 2018 14:58:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=q_zero&quot; class=&quot;user-hover&quot; rel=&quot;q_zero&quot;&gt;q_zero&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;except increasing the &lt;b&gt;maxSessionTimeout&lt;/b&gt;, Do you hava any good idea?&lt;/p&gt;</comment>
                            <comment id="16729186" author="nixon" created="Wed, 26 Dec 2018 20:54:26 +0000"  >&lt;p&gt;We had similar issues which we addressed by making the polling interval configurable. Attaching our patch to this issue (it adds &quot;zookeeper.fastleader.minNotificationInterval&quot;).&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16745725" author="lvfangmin" created="Fri, 18 Jan 2019 02:45:51 +0000"  >&lt;p&gt;Issue resolved by pull request 747&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/zookeeper/pull/747&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/747&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16745788" author="hudson" created="Fri, 18 Jan 2019 05:08:07 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Zookeeper-trunk-single-thread #194 (See &lt;a href=&quot;https://builds.apache.org/job/Zookeeper-trunk-single-thread/194/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Zookeeper-trunk-single-thread/194/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-3218&quot; title=&quot;zk server reopened&#65292;the interval for observer connect to the new leader is too long&#65292;then session expired&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-3218&quot;&gt;&lt;del&gt;ZOOKEEPER-3218&lt;/del&gt;&lt;/a&gt;: Add min notification interval property for fast leader (fangmin: rev 0b504dec95b09acb05b40505588f7cda8131fea6)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) zookeeper-docs/src/main/resources/markdown/zookeeperAdmin.md&lt;/li&gt;
	&lt;li&gt;(edit) zookeeper-server/src/main/java/org/apache/zookeeper/server/quorum/FastLeaderElection.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16745824" author="hudson" created="Fri, 18 Jan 2019 06:28:31 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build ZooKeeper-trunk #356 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/356/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/356/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-3218&quot; title=&quot;zk server reopened&#65292;the interval for observer connect to the new leader is too long&#65292;then session expired&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-3218&quot;&gt;&lt;del&gt;ZOOKEEPER-3218&lt;/del&gt;&lt;/a&gt;: Add min notification interval property for fast leader (fangmin: rev 0b504dec95b09acb05b40505588f7cda8131fea6)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) zookeeper-docs/src/main/resources/markdown/zookeeperAdmin.md&lt;/li&gt;
	&lt;li&gt;(edit) zookeeper-server/src/main/java/org/apache/zookeeper/server/quorum/FastLeaderElection.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 43 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|u002cw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>