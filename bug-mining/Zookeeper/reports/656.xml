<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:56:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[ZOOKEEPER-2052] Unable to delete a node when the node has no children</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-2052</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;We stumbled upon a ZooKeeper bug where a node with no children cannot be removed on our 3 node ZooKeeper ensemble or standalone ZooKeeper on Red Hat Enterprise Linux x86_64 environment.  Here is an example scenario/setup:&lt;/p&gt;

&lt;p&gt;o Standalone ZooKeeper or 3 node ensemble (v3.4.6)&lt;br/&gt;
o 2 Java clients (v3.4.6)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Client A creates a persistent node (e.g.:  /metadata/resources)&lt;/li&gt;
	&lt;li&gt;Client B creates ephemeral nodes under this persistent node&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;o Client A attempts to remove the /metadata/resources node via multi op  &lt;br/&gt;
   delete but fails since there are children&lt;br/&gt;
o Client B&apos;s session expired, all the ephemeral nodes are removed&lt;br/&gt;
o Client A attempts to recursively remove /metadata/resources node via &lt;br/&gt;
   multi op, this is expected to succeed but got the following exception:&lt;br/&gt;
      org.apache.zookeeper.KeeperException$NotEmptyException:     &lt;br/&gt;
         KeeperErrorCode = Directory not empty&lt;/p&gt;

&lt;p&gt;   (Note that Client B is the only client that creates these ephemeral nodes)&lt;/p&gt;

&lt;p&gt;o After this, we use zkCli.sh to inspect the problematic node but the zkCli.sh shows the /metadata/resources node indeed have no children but it will not allow /metadata/resources node to get deleted.  (shown below)&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;zk: localhost:2181(CONNECTED) 0&amp;#93;&lt;/span&gt; ls /&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;zookeeper, metadata&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;zk: localhost:2181(CONNECTED) 1&amp;#93;&lt;/span&gt; ls /metadata&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;resources&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;zk: localhost:2181(CONNECTED) 2&amp;#93;&lt;/span&gt; get /metadata/resources&lt;br/&gt;
null&lt;br/&gt;
cZxid = 0x3&lt;br/&gt;
ctime = Wed Oct 01 22:04:11 PDT 2014&lt;br/&gt;
mZxid = 0x3&lt;br/&gt;
mtime = Wed Oct 01 22:04:11 PDT 2014&lt;br/&gt;
pZxid = 0x9&lt;br/&gt;
cversion = 2&lt;br/&gt;
dataVersion = 0&lt;br/&gt;
aclVersion = 0&lt;br/&gt;
ephemeralOwner = 0x0&lt;br/&gt;
dataLength = 0&lt;br/&gt;
numChildren = 0&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;zk: localhost:2181(CONNECTED) 3&amp;#93;&lt;/span&gt; delete /metadata/resources&lt;br/&gt;
Node not empty: /metadata/resources&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;zk: localhost:2181(CONNECTED) 4&amp;#93;&lt;/span&gt; get /metadata/resources   &lt;br/&gt;
null&lt;br/&gt;
cZxid = 0x3&lt;br/&gt;
ctime = Wed Oct 01 22:04:11 PDT 2014&lt;br/&gt;
mZxid = 0x3&lt;br/&gt;
mtime = Wed Oct 01 22:04:11 PDT 2014&lt;br/&gt;
pZxid = 0x9&lt;br/&gt;
cversion = 2&lt;br/&gt;
dataVersion = 0&lt;br/&gt;
aclVersion = 0&lt;br/&gt;
ephemeralOwner = 0x0&lt;br/&gt;
dataLength = 0&lt;br/&gt;
numChildren = 0&lt;/p&gt;

&lt;p&gt;o The only ways to remove this node is to either:&lt;br/&gt;
   a) Restart the ZooKeeper server&lt;br/&gt;
   b) set data to /metadata/resources then followed by a subsequent delete.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Red Hat Enterprise Linux 6.1 x86_64, standalone or 3 node ensemble (v3.4.6), 2 Java clients (v3.4.6)&lt;/p&gt;</environment>
        <key id="12745421">ZOOKEEPER-2052</key>
            <summary>Unable to delete a node when the node has no children</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hdeng">Hongchao Deng</assignee>
                                    <reporter username="yipng">Yip Ng</reporter>
                        <labels>
                    </labels>
                <created>Thu, 2 Oct 2014 07:08:40 +0000</created>
                <updated>Tue, 28 Oct 2014 11:10:52 +0000</updated>
                            <resolved>Tue, 28 Oct 2014 04:41:16 +0000</resolved>
                                    <version>3.4.6</version>
                    <version>3.5.0</version>
                                    <fixVersion>3.4.7</fixVersion>
                    <fixVersion>3.5.1</fixVersion>
                    <fixVersion>3.6.0</fixVersion>
                                    <component>server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="14156152" author="yipng" created="Thu, 2 Oct 2014 07:09:42 +0000"  >&lt;p&gt;Attached zookeeper server debug log&lt;/p&gt;</comment>
                            <comment id="14156163" author="yipng" created="Thu, 2 Oct 2014 07:17:39 +0000"  >&lt;p&gt;This issue looks very similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1424&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/ZOOKEEPER-1424&lt;/a&gt; &lt;br/&gt;
where it was reported on ZooKeeper v3.4.2&lt;/p&gt;</comment>
                            <comment id="14158745" author="yipng" created="Sat, 4 Oct 2014 00:00:36 +0000"  >&lt;p&gt;Got abit curious, so went through the code in the PrepRequestProcessor class, particularly the multi logic path.  Here are some observations:&lt;/p&gt;

&lt;p&gt;a)  There were no outstanding changes to the /metadata or /metadata/resources node prior the first multi.&lt;/p&gt;

&lt;p&gt;b)  During the first multi with delete, it saves the pending changes in getPendingChanges() but I noticed that it is calling getRecordForPath(path) which saves a ChangeRecord with zxid = -1 &lt;br/&gt;
     (zks.outstandingChangesForPath.get(path) returns null and hence, it produces this ChangeRecord from the ZKDatabase if the node exists.) &lt;/p&gt;

&lt;p&gt;c)  The multi op with delete failed since there was an ephemeral node under /metadata/resources and the operation rolls back in rollbackPendingChanges(); it removes the new ChangeRecords added by the multi; however, the ChangeRecords with zxid = -1 are injected back to outstandingChangesForPath since getPendingChanges() saved them.&lt;/p&gt;

&lt;p&gt;Can someone with knowledge in this code area comment on c)?   &lt;/p&gt;

&lt;p&gt;Shouldn&apos;t getPendingChanges() only obtain actual &quot;pending changes&quot; strictly from outstandingChangeForPath instead?&lt;/p&gt;</comment>
                            <comment id="14159277" author="yipng" created="Sat, 4 Oct 2014 20:34:35 +0000"  >&lt;p&gt;Attach patch with fix and  junit to reproduce the symptom.&lt;/p&gt;

&lt;p&gt;Fix summary:&lt;/p&gt;

&lt;p&gt;getPendingChanges() should only save ChangeRecord&lt;br/&gt;
strictly from zks.outstandingChanges since getRecordForPath() can &lt;br/&gt;
return ChangeRecord with zxid = -1 which is from the ZKDatabase and &lt;br/&gt;
not the actual outstanding change.  This would cause unwanted &lt;b&gt;new&lt;/b&gt; &lt;br/&gt;
ChangeRecords added to zks.outstandingChanges during &lt;br/&gt;
rollbackPendingChanges() when the multi() fails.&lt;/p&gt;</comment>
                            <comment id="14159279" author="yipng" created="Sat, 4 Oct 2014 20:44:31 +0000"  >&lt;p&gt;Appreciate if someone can review and comment on the patch.  Thanks!&lt;/p&gt;</comment>
                            <comment id="14159582" author="hadoopqa" created="Sun, 5 Oct 2014 16:32:10 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12672951/ZOOKEEPER-2052.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12672951/ZOOKEEPER-2052.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1628224.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2369//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2369//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14159614" author="yipng" created="Sun, 5 Oct 2014 18:13:29 +0000"  >&lt;p&gt;The patch was generated on v3.4.6. Will resubmit patch for trunk when I get a chance.&lt;/p&gt;</comment>
                            <comment id="14159647" author="hdeng" created="Sun, 5 Oct 2014 19:15:10 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yipng&quot; class=&quot;user-hover&quot; rel=&quot;yipng&quot;&gt;yipng&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;This sounds a known issue. Can you explain your solution with an example? Thanks.&lt;/p&gt;</comment>
                            <comment id="14160001" author="yipng" created="Mon, 6 Oct 2014 04:44:59 +0000"  >&lt;p&gt;Resubmit patch for trunk.  Patch includes junit testcase to reproduce the issue and the fix.&lt;/p&gt;</comment>
                            <comment id="14160006" author="yipng" created="Mon, 6 Oct 2014 05:02:11 +0000"  >&lt;p&gt;Hi Hongchao:&lt;/p&gt;

&lt;p&gt;As illustrated in the junit testcase, the first multi failure was the culprit to this issue.  When the first multi with delete executes, it stores the pending changes for the path but in this specific case, there were no outstanding changes for those paths.  The getPendingChanges() method mistakenly saved the records that was obtained by the ZKDatabase with zxid = -1 (these are not outstanding changes).  When multi delete fails(there were ephemeral nodes under /mymetadata/resources), it attempts to remove the added change records from the multi operation and restore the outstanding changes for the paths.  But there were none to begin with, so the rollback actually added new change records.  When the multi op rolls back, one would expect that there shouldn&apos;t be any &lt;b&gt;new&lt;/b&gt; change records.&lt;/p&gt;

&lt;p&gt;When client B&apos;s session expired, all its ephemeral nodes get removed, so the subsequent multi delete should succeed; however, due to this lingering change record in the zks.outstandingChanges, it prevents any deletion to /mymetadata/resources since the ChangeRecord still have the count for the ephemeral nodes.&lt;/p&gt;

&lt;p&gt;Hence, the solution is to save pending changes only if there is an actual outstanding change for that path.  (zxid != -1)&lt;/p&gt;</comment>
                            <comment id="14160013" author="hadoopqa" created="Mon, 6 Oct 2014 05:30:14 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12673056/ZOOKEEPER-2052.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12673056/ZOOKEEPER-2052.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1628224.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    -1 release audit.  The applied patch generated 2 release audit warnings (more than the trunk&apos;s current 0 warnings).&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2370//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2370//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2370//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2370//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2370//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2370//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2370//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2370//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14160057" author="hdeng" created="Mon, 6 Oct 2014 07:11:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yipng&quot; class=&quot;user-hover&quot; rel=&quot;yipng&quot;&gt;yipng&lt;/a&gt;&lt;br/&gt;
Thanks for the explanation and hard work on patch.&lt;br/&gt;
I think your patch doesn&apos;t work for the following case:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;multi:
  delete &lt;span class=&quot;code-quote&quot;&gt;&quot;/existed&quot;&lt;/span&gt; =&amp;gt; succeed
  delete &lt;span class=&quot;code-quote&quot;&gt;&quot;/non-existed&quot;&lt;/span&gt; =&amp;gt; failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In such case, the entire operation set should be aborted. However, your patch will lead to non-aborted operations.&lt;/p&gt;

&lt;p&gt;This case seems specific on &quot;number of children&quot;. I wonder if a Children.count() could substitute the variable to fix this problem. I didn&apos;t have enough time to look at it now.&lt;/p&gt;

&lt;p&gt;I wonder why you want to call a delete within multi(). This bug would be fixed later... However, in your case, I didn&apos;t why you need to call multi for the delete. multi() was introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-965&quot; title=&quot;Need a multi-update command to allow multiple znodes to be updated safely&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-965&quot;&gt;&lt;del&gt;ZOOKEEPER-965&lt;/del&gt;&lt;/a&gt; to do multi-update. I think it isn&apos;t checked very well for other usages by far.&lt;/p&gt;</comment>
                            <comment id="14160158" author="yipng" created="Mon, 6 Oct 2014 10:17:39 +0000"  >&lt;p&gt;Hongchao:&lt;/p&gt;

&lt;p&gt;Thanks for taking a look at the patch.  The patch only deals with saving pending changes and it does not change any of precondition checkings for delete; hence, I am not sure &lt;br/&gt;
why it didn&apos;t work the way you described.  Anyhow, I verified your scenario and it works as expected where the second  delete on a non-exist node will triggered the abort of the entire &lt;br/&gt;
operation.  A KeeperException.NoNodeException was thrown at getPathForRecord() in this case and the /existed node was not deleted.   &lt;/p&gt;

&lt;p&gt;2014-10-06 02:38:21,795 &lt;span class=&quot;error&quot;&gt;&amp;#91;myid:&amp;#93;&lt;/span&gt; - INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;ProcessThread(sid:0 cport:11221)::PrepRequestProcessor@798&amp;#93;&lt;/span&gt; - Got user-level KeeperException when processing sessionid:0x148e4d2ed5b0000 type:multi cxid:0x4 zxid:0x4 txntype:2 reqpath:n/a aborting remaining multi ops. Error Path:/non-existed Error:KeeperErrorCode = NoNode for /non-existed&lt;br/&gt;
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;I did ran the patch with &quot;ant clean test&quot; before submitting it and the all tests passed in my environment.  Is there a particular test case you are referring to for the core tests that failed?  &lt;br/&gt;
I see 6 failed tests in core test report but its error details show that the &quot;Address already in use&quot; for 4 of the testcases and the other 2 are &quot;waiting for server being up&quot;  and &lt;br/&gt;
&quot;Forked Java VM exited abnormally. Please note the time in the report does not reflect the time until the VM exit.&quot; respectively.  It looks like socket bind issues &lt;br/&gt;
preventing the tests to run in completion.&lt;/p&gt;

&lt;p&gt;The testcase was a simplified version to reproduce the issue.   We use multi() with delete to remove a set of nodes in its entirety or none at all as advertised by the multi javadoc.&lt;br/&gt;
Partial deletions will result in inconsistency of the application state. &lt;/p&gt;</comment>
                            <comment id="14160289" author="rakeshr" created="Mon, 6 Oct 2014 13:37:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yipng&quot; class=&quot;user-hover&quot; rel=&quot;yipng&quot;&gt;yipng&lt;/a&gt; Good catch and thanks for unit test to understand it more.&lt;/p&gt;

&lt;p&gt;I didn&apos;t fully understood the logic why change record is adding into the &lt;tt&gt;outstandingChangesForPath&lt;/tt&gt; when &lt;tt&gt;outstandingChanges&lt;/tt&gt; is empty. I think this is resulting into the failure situation. Could anyone knows this logic.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;PrepRequestProcessor#rollbackPendingChanges(){
     &lt;span class=&quot;code-comment&quot;&gt;//....
&lt;/span&gt;     &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; empty = zks.outstandingChanges.isEmpty(); 
     &lt;span class=&quot;code-comment&quot;&gt;//....
&lt;/span&gt;     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!empty &amp;amp;&amp;amp; (c.zxid &amp;lt; firstZxid)) {
          &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;
     }

     zks.outstandingChangesForPath.put(c.path, c);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14160725" author="yipng" created="Mon, 6 Oct 2014 19:04:56 +0000"  >&lt;p&gt;Added a testcase to confirm what Hongchao&apos;s scenario works.  Rerun with &lt;br/&gt;
ant clean test, all tests passed in my environment &lt;/p&gt;</comment>
                            <comment id="14160821" author="hadoopqa" created="Mon, 6 Oct 2014 19:50:58 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12673165/ZOOKEEPER-2052.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12673165/ZOOKEEPER-2052.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1628224.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    -1 release audit.  The applied patch generated 2 release audit warnings (more than the trunk&apos;s current 0 warnings).&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2372//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2372//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2372//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2372//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2372//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2372//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2372//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2372//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14160955" author="yipng" created="Mon, 6 Oct 2014 21:09:56 +0000"  >&lt;p&gt;Thanks Rakesh, it took some time for us to reproduce this issue since it happens intermittently.  &lt;/p&gt;

&lt;p&gt;I see there are a great deal of discussion and information exchange in &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-965&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/ZOOKEEPER-965&lt;/a&gt; ,&lt;br/&gt;
particularly there was a comment there regarding details on the rollbackPendingChanges() implementation.  It would certainly be &lt;br/&gt;
very helpful if folks involved with that jira can comment further.&lt;/p&gt;

&lt;p&gt;Nevertheless, there seems to be a bug in getPendingChanges() where it can save a ChangeRecord with zxid = -1 (obtained from getRecordForPath )&lt;br/&gt;
If I understand this correctly, this ChangeRecord is NOT an entry from the zks.outstandingChangesForPath map but came from ZKDatabase.   Since &lt;br/&gt;
it is not an actual outstanding change for the path, it shouldn&apos;t be saved in getPendingChanges() as then it will introduce new ChangeRecords when the&lt;br/&gt;
multi() fails.&lt;/p&gt;</comment>
                            <comment id="14161406" author="hdeng" created="Tue, 7 Oct 2014 03:17:37 +0000"  >&lt;p&gt;Thanks for &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yipng&quot; class=&quot;user-hover&quot; rel=&quot;yipng&quot;&gt;yipng&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;rakeshr&lt;/a&gt;&apos;s discussion here. I dig into the code a little bit.&lt;/p&gt;

&lt;p&gt;Let me brief up how the error is caused in code level:&lt;br/&gt;
1. when a multi delete was initiated, &lt;em&gt;pendingChanges&lt;/em&gt; add a copy of parent node (&lt;a href=&quot;https://github.com/apache/zookeeper/blob/ac3371a133fffcb31e3f0c489a3564fe5ed2a851/src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java#L231&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;github link&lt;/a&gt;).&lt;br/&gt;
2. when delete failed and multi rolled back, it adds back &lt;em&gt;pendingChanges&lt;/em&gt; to &lt;em&gt;outstandingsForPath&lt;/em&gt; (should this be reamed &lt;em&gt;lastChangeForPath&lt;/em&gt;)&lt;br/&gt;
3. when a session was closed, unfortunately, its parent&apos;s last change isn&apos;t modified (&lt;a href=&quot;https://github.com/apache/zookeeper/blob/ac3371a133fffcb31e3f0c489a3564fe5ed2a851/src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java#L670&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;github link&lt;/a&gt;).&lt;br/&gt;
4. when another delete happened, unfortunately (again &amp;amp;_&amp;amp;), it checked parent&apos;s record which is put back by multi rollback (&lt;a href=&quot;https://github.com/apache/zookeeper/blob/ac3371a133fffcb31e3f0c489a3564fe5ed2a851/src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java#L482&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;github link&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;The fix is simple: do what delete do (&lt;a href=&quot;https://github.com/apache/zookeeper/blob/ac3371a133fffcb31e3f0c489a3564fe5ed2a851/src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java#L491&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;github link&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yipng&quot; class=&quot;user-hover&quot; rel=&quot;yipng&quot;&gt;yipng&lt;/a&gt;, Do you wanna work on this or will I create a patch based on the above discussion?&lt;/p&gt;</comment>
                            <comment id="14161408" author="hdeng" created="Tue, 7 Oct 2014 03:22:58 +0000"  >&lt;p&gt;So in the fix I mean also changing parent&apos;s record like what delete operation does.&lt;/p&gt;</comment>
                            <comment id="14161471" author="hdeng" created="Tue, 7 Oct 2014 05:04:27 +0000"  >&lt;p&gt;I have another question: what&apos;s diff between create and create2?&lt;/p&gt;</comment>
                            <comment id="14161505" author="hdeng" created="Tue, 7 Oct 2014 05:44:59 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thawan&quot; class=&quot;user-hover&quot; rel=&quot;thawan&quot;&gt;thawan&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1624&quot; title=&quot;PrepRequestProcessor abort multi-operation incorrectly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1624&quot;&gt;&lt;del&gt;ZOOKEEPER-1624&lt;/del&gt;&lt;/a&gt; adds parent record into pendingOutstandings which introduces a concern in the &lt;a href=&quot;https://github.com/apache/zookeeper/blob/ac3371a133fffcb31e3f0c489a3564fe5ed2a851/src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java#L284&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;following line&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  Iterator&amp;lt;ChangeRecord&amp;gt; priorIter = pendingChangeRecords.values().iterator();
            &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (priorIter.hasNext()) {
                ChangeRecord c = priorIter.next();
                 ...
                zks.outstandingChangesForPath.put(c.path, c);
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This might take parent records not in outstandingChanges (e.g. delete) into outstandingChangesForPath. Could you share any insight into this?&lt;/p&gt;
</comment>
                            <comment id="14162039" author="hdeng" created="Tue, 7 Oct 2014 16:12:40 +0000"  >&lt;p&gt;I think the root cause is for something that didn&apos;t exist in &lt;em&gt;outstandingChangesForPath&lt;/em&gt; would be added back because of &lt;a href=&quot;https://github.com/apache/zookeeper/blob/ac3371a133fffcb31e3f0c489a3564fe5ed2a851/src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java#L284&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this line&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In my humble understanding, the purpose of rollback is to restore what original &lt;em&gt;outstandingChanges&lt;/em&gt; and &lt;em&gt;outstandingChangesForPath&lt;/em&gt;. So something that wasn&apos;t there should be removed instead of put zxid=-1.&lt;/p&gt;</comment>
                            <comment id="14162066" author="hdeng" created="Tue, 7 Oct 2014 16:25:02 +0000"  >&lt;p&gt;I also believe that in closeSession it&apos;s neccesary to addChangeRecord ( parentCr ). Even though this isn&apos;t the main problem and the effect is ephemeral &amp;#8211; outstandingChanges will be removed at the end.&lt;/p&gt;</comment>
                            <comment id="14162073" author="hdeng" created="Tue, 7 Oct 2014 16:29:10 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marshall&quot; class=&quot;user-hover&quot; rel=&quot;marshall&quot;&gt;marshall&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Please see my above two comments. Can you share any insight to fix this problem?&lt;/p&gt;</comment>
                            <comment id="14162344" author="yipng" created="Tue, 7 Oct 2014 19:17:12 +0000"  >&lt;p&gt;Hongchao Deng wrote:&lt;br/&gt;
&amp;gt;I think the root cause is for something that didn&apos;t exist in outstandingChangesForPath would be added back because of this line.&lt;br/&gt;
&amp;gt;In my humble understanding, the purpose of rollback is to restore what original outstandingChanges and outstandingChangesForPath. So something that wasn&apos;t there should be removed &amp;gt;instead of put zxid=-1.&lt;/p&gt;

&lt;p&gt;Right, so if there was no entry in outstandingChangesForPath for the path to begin with, why save it during getPendingChanges()?  This is what the current patch is addressing, it checks to see if zxid != -1 before saving actual outstanding change for the path.  &lt;/p&gt;
</comment>
                            <comment id="14162392" author="hdeng" created="Tue, 7 Oct 2014 19:43:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yipng&quot; class=&quot;user-hover&quot; rel=&quot;yipng&quot;&gt;yipng&lt;/a&gt;&lt;br/&gt;
I agree that your patch is a good start on finding the root cause.&lt;/p&gt;

&lt;p&gt;Checking zxid != -1 is kinda obscure in code and sounds a temp patch. Certain paths doesn&apos;t exist in &lt;em&gt;outstandingChangesForPath&lt;/em&gt; and we shouldn&apos;t put it back in rollback. This means the change record doesn&apos;t need to be constructed.&lt;/p&gt;</comment>
                            <comment id="14162436" author="hdeng" created="Tue, 7 Oct 2014 20:05:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yipng&quot; class=&quot;user-hover&quot; rel=&quot;yipng&quot;&gt;yipng&lt;/a&gt;&lt;br/&gt;
And the test should also reflect that the root cause for &lt;em&gt;outstandingChangesForPath&lt;/em&gt; is fixed.&lt;/p&gt;</comment>
                            <comment id="14162462" author="yipng" created="Tue, 7 Oct 2014 20:21:16 +0000"  >&lt;p&gt;Hongchao&lt;/p&gt;

&lt;p&gt;I agree, perhaps getPendingChanges() should not call getRecordsForPath() and just check with outstandingChangesForPath directly.  I see difference places in the code where it has these hardcoded zxids with 0 and -1, perhaps they can get clean up in another jira to bring code clarity.  Let&apos;s continue to improve the patch.  =)&lt;/p&gt;</comment>
                            <comment id="14162877" author="hdeng" created="Wed, 8 Oct 2014 00:52:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;rakeshr&lt;/a&gt;&lt;br/&gt;
Good catch!&lt;br/&gt;
I think the code&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!empty &amp;amp;&amp;amp; (c.zxid &amp;lt; firstZxid)) {
          &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;
 }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;means that for anything that wasn&apos;t in outstanding shouldn&apos;t be put back into outSForPath. However, it failed when outstanding is empty&lt;/p&gt;</comment>
                            <comment id="14162998" author="yipng" created="Wed, 8 Oct 2014 03:08:57 +0000"  >&lt;p&gt;Rakesh R, Hongchao Deng.&lt;/p&gt;

&lt;p&gt;Yes, I think you guys are right.  Since the list is empty after the revert in rollbackPendingChanges(), this means possibly the FinalRequestProcessor thread have processed ChangeRecord and have removed it from the outstandingChanges list; hence, the logic in rollbackPendingChanges() should not apply any of the prior saved changes back into outstandingChangesForPath map.&lt;/p&gt;

&lt;p&gt;So in summary, it appears there are two bugs found so far:&lt;/p&gt;

&lt;p&gt;1) getPendingChanges() saves ChangeRecord(s) for path that does not exist in outstandingChangesForPath ( zxid = -1 )&lt;br/&gt;
2) rollbackPendingChanges() puts back prior saved changes back to outstandingChangesForPath when the outstandingChange list is empty.&lt;/p&gt;

&lt;p&gt;Working on another patch now and will resubmit it for review.&lt;/p&gt;</comment>
                            <comment id="14163013" author="hdeng" created="Wed, 8 Oct 2014 03:26:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yipng&quot; class=&quot;user-hover&quot; rel=&quot;yipng&quot;&gt;yipng&lt;/a&gt;&lt;br/&gt;
I am almost done with my patch...&lt;/p&gt;</comment>
                            <comment id="14163020" author="hdeng" created="Wed, 8 Oct 2014 03:38:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yipng&quot; class=&quot;user-hover&quot; rel=&quot;yipng&quot;&gt;yipng&lt;/a&gt;&lt;br/&gt;
I am familiar with the outstanding stuff. Let me handle this in the low level code. Thanks &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14163029" author="yipng" created="Wed, 8 Oct 2014 03:55:47 +0000"  >&lt;p&gt;Hongchao:&lt;br/&gt;
Sure, no problem.&lt;/p&gt;</comment>
                            <comment id="14163049" author="hadoopqa" created="Wed, 8 Oct 2014 04:20:17 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12673516/test-jenkins.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12673516/test-jenkins.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1628224.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    -1 release audit.  The applied patch generated 2 release audit warnings (more than the trunk&apos;s current 0 warnings).&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2377//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2377//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2377//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2377//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2377//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2377//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2377//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2377//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14163065" author="yipng" created="Wed, 8 Oct 2014 04:53:57 +0000"  >&lt;p&gt;Just took a brief look at the latest patch.  In rollingPendingChange(), the logic to compare with the firstZxid has been removed and now it applies the pending changes directly to outstandingChangesForPath.   Is it safe to do this?&lt;/p&gt;

&lt;p&gt;Note that between the time the pending changes are saved and the time the multi abort, the outstanding changes may have been removed by the FinalRequestProcessor thread.&lt;/p&gt;


&lt;p&gt;+            // add previously existed records back.&lt;br/&gt;
+            for (ChangeRecord c: pendingChangeRecords.values()) &lt;/p&gt;
{
                 zks.outstandingChangesForPath.put(c.path, c);
             }</comment>
                            <comment id="14163070" author="hdeng" created="Wed, 8 Oct 2014 04:59:43 +0000"  >&lt;p&gt;That&apos;s right.&lt;br/&gt;
I should add a comment there.&lt;/p&gt;</comment>
                            <comment id="14163091" author="yipng" created="Wed, 8 Oct 2014 05:16:28 +0000"  >&lt;p&gt;Hongchao:&lt;/p&gt;

&lt;p&gt;You meant you will place back the logic for the firstZxid comparision in rollingPendingChange() right?  Since it may not be correct to assume that the saved pending changes are still in the outstandingChanges list due to race condition I mentioned on my previous comment.  &lt;/p&gt;</comment>
                            <comment id="14163094" author="hdeng" created="Wed, 8 Oct 2014 05:17:22 +0000"  >&lt;p&gt;Yes. I also added a note on the code.&lt;/p&gt;</comment>
                            <comment id="14163111" author="hdeng" created="Wed, 8 Oct 2014 05:35:33 +0000"  >&lt;p&gt;Created a RB: &lt;a href=&quot;https://reviews.apache.org/r/26437/diff/#&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/26437/diff/#&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14163139" author="hadoopqa" created="Wed, 8 Oct 2014 06:19:30 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12673530/ZOOKEEPER-2052-v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12673530/ZOOKEEPER-2052-v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1628224.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    -1 release audit.  The applied patch generated 2 release audit warnings (more than the trunk&apos;s current 0 warnings).&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2378//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2378//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2378//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2378//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2378//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2378//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2378//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2378//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14164016" author="hadoopqa" created="Wed, 8 Oct 2014 19:26:04 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12673651/ZOOKEEPER-2052-v3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12673651/ZOOKEEPER-2052-v3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1630026.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    -1 release audit.  The applied patch generated 2 release audit warnings (more than the trunk&apos;s current 0 warnings).&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2380//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2380//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2380//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2380//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2380//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2380//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2380//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2380//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14164080" author="hdeng" created="Wed, 8 Oct 2014 20:11:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;fpj&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;rakeshr&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rgs&quot; class=&quot;user-hover&quot; rel=&quot;rgs&quot;&gt;rgs&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This bug is reproducible by aborting multi for a delete.&lt;br/&gt;
Can you take a look at the patch: &lt;a href=&quot;https://reviews.apache.org/r/26437/diff/#&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/26437/diff/#&lt;/a&gt; ?&lt;/p&gt;

&lt;p&gt;The release audit might be caused by the legacy Apache header starting with &quot;/**&quot; (should be one star). I have updated them in latest patch.&lt;/p&gt;</comment>
                            <comment id="14164134" author="hadoopqa" created="Wed, 8 Oct 2014 20:50:52 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12673687/ZOOKEEPER-2052-v3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12673687/ZOOKEEPER-2052-v3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1630026.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    -1 release audit.  The applied patch generated 2 release audit warnings (more than the trunk&apos;s current 0 warnings).&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2381//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2381//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2381//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2381//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2381//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2381//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2381//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2381//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14164168" author="rgs" created="Wed, 8 Oct 2014 21:06:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hdeng&quot; class=&quot;user-hover&quot; rel=&quot;hdeng&quot;&gt;hdeng&lt;/a&gt;: reviewed. &lt;/p&gt;</comment>
                            <comment id="14164195" author="hadoopqa" created="Wed, 8 Oct 2014 21:23:25 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12673707/ZOOKEEPER-2052-v3-release.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12673707/ZOOKEEPER-2052-v3-release.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1630026.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    -1 release audit.  The applied patch generated 2 release audit warnings (more than the trunk&apos;s current 0 warnings).&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    -1 contrib tests.  The patch failed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2382//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2382//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2382//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2382//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2382//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2382//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2382//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2382//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14164196" author="hadoopqa" created="Wed, 8 Oct 2014 21:23:26 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12673710/ZOOKEEPER-2052-v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12673710/ZOOKEEPER-2052-v4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1630026.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    -1 release audit.  The applied patch generated 2 release audit warnings (more than the trunk&apos;s current 0 warnings).&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2383//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2383//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2383//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2383//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2383//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2383//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2383//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2383//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14164451" author="hadoopqa" created="Thu, 9 Oct 2014 00:22:07 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12673758/ZOOKEEPER-2052-v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12673758/ZOOKEEPER-2052-v4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1630026.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    -1 release audit.  The applied patch generated 2 release audit warnings (more than the trunk&apos;s current 0 warnings).&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2384//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2384//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2384//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2384//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2384//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2384//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2384//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2384//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14165303" author="hdeng" created="Thu, 9 Oct 2014 16:03:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;rakeshr&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;fpj&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marshall&quot; class=&quot;user-hover&quot; rel=&quot;marshall&quot;&gt;marshall&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tdunning&quot; class=&quot;user-hover&quot; rel=&quot;tdunning&quot;&gt;tdunning&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The failure seems irrelevant. Please review this patch: &lt;a href=&quot;https://reviews.apache.org/r/26437/diff/#&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/26437/diff/#&lt;/a&gt;&lt;br/&gt;
Thanks!&lt;/p&gt;</comment>
                            <comment id="14166065" author="fpj" created="Fri, 10 Oct 2014 00:34:54 +0000"  >&lt;p&gt;I haven&apos;t been following this issue closely, give me some time to digest it.&lt;/p&gt;</comment>
                            <comment id="14166076" author="hdeng" created="Fri, 10 Oct 2014 00:40:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;fpj&lt;/a&gt;&lt;br/&gt;
Great!&lt;br/&gt;
Just a brief sum-up &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
The issue is caused by multi rollback that put records from zkDatabase into outStandingChangesForPath:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/zookeeper/blob/ac3371a133fffcb31e3f0c489a3564fe5ed2a851/src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java#L232&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/blob/ac3371a133fffcb31e3f0c489a3564fe5ed2a851/src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java#L232&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/zookeeper/blob/ac3371a133fffcb31e3f0c489a3564fe5ed2a851/src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java#L284&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/blob/ac3371a133fffcb31e3f0c489a3564fe5ed2a851/src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java#L284&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14166509" author="marshall" created="Fri, 10 Oct 2014 07:22:18 +0000"  >&lt;p&gt;I&apos;m just seeing this jira for the first time as well. It looks like a really fantastic find and definitely very concerning if the issue is indeed as you describe. I&apos;m pretty swamped at work at present so it may take me a few days before I&apos;ll have a chance to dig into this but I&apos;ll be very happy to do so... Will update when I&apos;ve had a chance to digest this issue and comment on it.&lt;/p&gt;</comment>
                            <comment id="14170164" author="fpj" created="Mon, 13 Oct 2014 22:56:34 +0000"  >&lt;p&gt;Here is my initial reaction to the patch. The changes to rollback seem ok. I&apos;m wondering though if we can&apos;t get around with getRecordForPath() and if we really need to declare getOutstandingChange(). One of the problems pointed out here is that getPendingChanges is adding a record for a path that doesn&apos;t exist and I was wondering why a nonode exception is not being thrown for such a znode, which would skip the addition of the -1 record to the hashmap. &lt;/p&gt;</comment>
                            <comment id="14170185" author="hdeng" created="Mon, 13 Oct 2014 23:09:11 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;fpj&lt;/a&gt;. Thanks for looking at it.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;One of the problems pointed out here is that getPendingChanges is adding a record for a path that doesn&apos;t exist and I was wondering why a nonode exception is not being thrown for such a znode, which would skip the addition of the -1 record to the hashmap.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I didn&apos;t get your question..&lt;br/&gt;
So the case described is:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;ClientA.create( &quot;/a&quot;, ... PERSISTENT) =&amp;gt; succeed&lt;/li&gt;
	&lt;li&gt;ClientB.create( &quot;/a/b&quot;, ... EPHEMERAL) =&amp;gt; succeed&lt;/li&gt;
	&lt;li&gt;ClientA.multi([ delete(&quot;/a&quot;) ]) =&amp;gt; fail, abort. This left a OutStandingRecord
{ path=&quot;/a&quot;, zxid=-1, childCount=1}
&lt;p&gt; which didn&apos;t get removed.&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;ClientB disconnect.&lt;/li&gt;
	&lt;li&gt;ClientA.delete(&quot;/a&quot;) =&amp;gt; fail. Because it gets the left &lt;a href=&quot;https://github.com/fengjingchao/zookeeper/blob/trunk/src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java#L482&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;OutStandingRecord&lt;/a&gt; and thinks &lt;a href=&quot;https://github.com/fengjingchao/zookeeper/blob/trunk/src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java#L485&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;childCount &amp;gt; 0&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14170245" author="hdeng" created="Mon, 13 Oct 2014 23:41:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;fpj&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I was wondering why a nonode exception is not being thrown for such a znode, which would skip the addition of the -1 record to the hashmap.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think I understand kinda... So the node does exist. It&apos;s just not in outstanding changes. Every operation will be removed from outstanding changes after FinalRequestProcessor.&lt;/p&gt;</comment>
                            <comment id="14170332" author="hdeng" created="Tue, 14 Oct 2014 01:11:17 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;m wondering though if we can&apos;t get around with getRecordForPath()&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think using getRecordForPath() would still work &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Let me know what you think.&lt;/p&gt;</comment>
                            <comment id="14171618" author="fpj" created="Tue, 14 Oct 2014 22:08:48 +0000"  >&lt;p&gt;Sure, got it. Initially I didn&apos;t like that much that we are adding getOutstandingChange, which is a tweaked version of getRecordForPath, but after having another look, I think it is clean like this. It is fine with me to leave getOutstandingChange unless you can think of clean way of removing it.&lt;/p&gt;

&lt;p&gt;Let me do some local testing and I&apos;ll +1 it. Also, have you checked if we need separate patches for branches 3.4, 3.5, and trunk? &lt;/p&gt;</comment>
                            <comment id="14171636" author="hdeng" created="Tue, 14 Oct 2014 22:19:23 +0000"  >&lt;p&gt;This patch is tested on trunk. I was waiting for feedback from you or anyone else who have experience in multi() stuff.&lt;br/&gt;
As long as the patch makes sense, it would be easy for me to create relevant patches for 3.4, 3.5 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14171988" author="marshall" created="Wed, 15 Oct 2014 04:59:39 +0000"  >&lt;p&gt;I&apos;m going to go look over the final version of this patch on RB, but I think you guys have absolutely nailed this problem. I would I could give some useful insight into why it was originally implemented this way but I think it was just an oversight on our part. The particular use case of deleting a multi with intermixed ephemeral nodes is one we would never have encountered or tested against and thus I probably just didn&apos;t think of that... Anyhow, great find.&lt;/p&gt;</comment>
                            <comment id="14171996" author="marshall" created="Wed, 15 Oct 2014 05:04:26 +0000"  >&lt;p&gt;I reviewed the RB and the changes look solid to me. +1 from me.&lt;/p&gt;</comment>
                            <comment id="14172057" author="rakeshr" created="Wed, 15 Oct 2014 06:21:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hdeng&quot; class=&quot;user-hover&quot; rel=&quot;hdeng&quot;&gt;hdeng&lt;/a&gt; Thanks for the patch. Test cases looks nice. I&apos;ve added few comments in RB, pls see before preparing the final patch.&lt;/p&gt;</comment>
                            <comment id="14172505" author="fpj" created="Wed, 15 Oct 2014 15:58:24 +0000"  >&lt;p&gt;I&apos;m cancelling the patch until we fix the issues that &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;rakeshr&lt;/a&gt; has raised and we have patches for all branches. Otw, +1, lgtm.&lt;/p&gt;</comment>
                            <comment id="14172551" author="hdeng" created="Wed, 15 Oct 2014 16:32:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;rakeshr&lt;/a&gt;&lt;br/&gt;
Thanks for the comments. Addressed them and feel welcome to take a look at the new changes. &lt;a href=&quot;https://reviews.apache.org/r/26437/diff/#&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/26437/diff/#&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14172677" author="hadoopqa" created="Wed, 15 Oct 2014 17:55:53 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12675045/ZOOKEEPER-2052-v5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12675045/ZOOKEEPER-2052-v5.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1631280.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2391//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2391//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2391//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2391//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2391//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2391//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14172715" author="hadoopqa" created="Wed, 15 Oct 2014 18:16:04 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12675054/ZOOKEEPER-2052-v5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12675054/ZOOKEEPER-2052-v5.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1631280.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2392//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2392//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2392//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2392//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2392//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2392//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14173911" author="hdeng" created="Thu, 16 Oct 2014 16:22:11 +0000"  >&lt;p&gt;My local jenkins job showed the branch34 patch also passed.&lt;/p&gt;</comment>
                            <comment id="14176045" author="hdeng" created="Sat, 18 Oct 2014 15:45:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;fpj&lt;/a&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;rakeshr&lt;/a&gt;&lt;br/&gt;
The two patches for trunk and branch-3.4 has been uploaded and tested.&lt;br/&gt;
Please take a time to review it.&lt;/p&gt;</comment>
                            <comment id="14176076" author="rakeshr" created="Sat, 18 Oct 2014 18:37:08 +0000"  >&lt;p&gt;+1, the latest patch looks good to me.&lt;/p&gt;</comment>
                            <comment id="14184004" author="rakeshr" created="Sat, 25 Oct 2014 06:48:21 +0000"  >&lt;p&gt;I think &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;fpj&lt;/a&gt; has already given +1. Please feel free to stop me if anything else&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I&apos;ll commit this tomorrow sometime. Thanks everyone for the reviews!&lt;/p&gt;</comment>
                            <comment id="14186351" author="rakeshr" created="Tue, 28 Oct 2014 04:40:58 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hdeng&quot; class=&quot;user-hover&quot; rel=&quot;hdeng&quot;&gt;hdeng&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yipng&quot; class=&quot;user-hover&quot; rel=&quot;yipng&quot;&gt;yipng&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Committed to trunk : &lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1634776&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1634776&lt;/a&gt;&lt;br/&gt;
Committed to br3.4 : &lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1634777&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1634777&lt;/a&gt;&lt;br/&gt;
Committed to br3.5 : &lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1634778&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1634778&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14186700" author="hudson" created="Tue, 28 Oct 2014 11:10:52 +0000"  >&lt;p&gt;FAILURE: Integrated in ZooKeeper-trunk #2484 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/2484/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/2484/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2052&quot; title=&quot;Unable to delete a node when the node has no children&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2052&quot;&gt;&lt;del&gt;ZOOKEEPER-2052&lt;/del&gt;&lt;/a&gt; Unable to delete a node when the node has no children (Hongchao Deng and Yip Ng via rakeshr) (rakeshr: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1634776&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1634776&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/server/PrepRequestProcessorTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/test/MultiTransactionTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12546846">ZOOKEEPER-1424</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12673530" name="ZOOKEEPER-2052-v2.patch" size="20004" author="hdeng" created="Wed, 8 Oct 2014 05:31:11 +0000"/>
                            <attachment id="12673707" name="ZOOKEEPER-2052-v3-release.patch" size="19659" author="hdeng" created="Wed, 8 Oct 2014 21:01:35 +0000"/>
                            <attachment id="12673687" name="ZOOKEEPER-2052-v3.patch" size="19142" author="hdeng" created="Wed, 8 Oct 2014 20:08:53 +0000"/>
                            <attachment id="12673758" name="ZOOKEEPER-2052-v4.patch" size="19348" author="hdeng" created="Wed, 8 Oct 2014 23:34:57 +0000"/>
                            <attachment id="12675053" name="ZOOKEEPER-2052-v5-branch34.patch" size="17935" author="hdeng" created="Wed, 15 Oct 2014 17:22:39 +0000"/>
                            <attachment id="12675054" name="ZOOKEEPER-2052-v5.patch" size="18849" author="hdeng" created="Wed, 15 Oct 2014 17:22:47 +0000"/>
                            <attachment id="12673165" name="ZOOKEEPER-2052.patch" size="9596" author="yipng" created="Mon, 6 Oct 2014 19:04:56 +0000"/>
                            <attachment id="12673056" name="ZOOKEEPER-2052.patch" size="7469" author="yipng" created="Mon, 6 Oct 2014 04:44:59 +0000"/>
                            <attachment id="12672951" name="ZOOKEEPER-2052.patch" size="7385" author="yipng" created="Sat, 4 Oct 2014 20:34:35 +0000"/>
                            <attachment id="12673516" name="test-jenkins.patch" size="12772" author="hdeng" created="Wed, 8 Oct 2014 03:37:42 +0000"/>
                            <attachment id="12672505" name="zookeeper.log" size="30481" author="yipng" created="Thu, 2 Oct 2014 07:09:42 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i20pr3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>