<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:01:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[ZOOKEEPER-2251] Add Client side packet response timeout to avoid infinite wait.</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-2251</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;I came across one issue related to Client side packet response timeout In my cluster many packet drops happened for some time.&lt;/p&gt;

&lt;p&gt;One observation is the zookeeper client got hanged. As per the thread dump it is waiting for the response/ACK for the operation performed (synchronous API used here).&lt;br/&gt;
I am using zookeeper.serverCnxnFactory=org.apache.zookeeper.server.NIOServerCnxnFactory&lt;/p&gt;

&lt;p&gt;Since only few packets missed there is no DISCONNECTED event occurred.&lt;/p&gt;

&lt;p&gt;Need add a &quot;response time out&quot; for the operations or packets.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Comments from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;rakeshr&lt;/a&gt;&lt;/b&gt;&lt;br/&gt;
My observation about the problem:-&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Can use tools like &apos;Wireshark&apos; to simulate the artificial packet loss.&lt;/li&gt;
	&lt;li&gt;Assume there is only one packet in the &apos;outgoingQueue&apos; and unfortunately the server response packet lost. Now, client will enter into infinite waiting. &lt;a href=&quot;https://github.com/apache/zookeeper/blob/trunk/src/java/main/org/apache/zookeeper/ClientCnxn.java#L1515&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/blob/trunk/src/java/main/org/apache/zookeeper/ClientCnxn.java#L1515&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Probably we can discuss more about this problem and possible solutions(add packet ACK timeout or another better approach) in the jira.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12857097">ZOOKEEPER-2251</key>
            <summary>Add Client side packet response timeout to avoid infinite wait.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="arshad.mohammad">Mohammad Arshad</assignee>
                                    <reporter username="nijel">nijel</reporter>
                        <labels>
                            <label>fault</label>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 19 Aug 2015 02:47:03 +0000</created>
                <updated>Wed, 27 Sep 2023 08:27:44 +0000</updated>
                            <resolved>Fri, 27 Jul 2018 03:16:40 +0000</resolved>
                                    <version>3.4.9</version>
                    <version>3.5.2</version>
                    <version>3.4.11</version>
                                    <fixVersion>3.6.0</fixVersion>
                    <fixVersion>3.5.5</fixVersion>
                                    <component>java client</component>
                        <due></due>
                            <votes>4</votes>
                                    <watches>18</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="12600">3.5h</timespent>
                                <comments>
                            <comment id="14706468" author="suda" created="Fri, 21 Aug 2015 09:38:23 +0000"  >&lt;p&gt;Hello, I&apos;m trying to reproduce this bug.&lt;/p&gt;

&lt;p&gt;However I&apos;m not sure about the meaning of &quot;only few packets missed&quot;.&lt;br/&gt;
If some IP packets were lost, TCP layer (in the OS kernel) should be able to detect and retransmit lost packets.&lt;br/&gt;
So I guess the lost packets are eventually delivered to the client OS, but ZK client get hangs due to unexpected delay of the delivered packets.&lt;/p&gt;

&lt;p&gt;Could you please share your client workload and its thread dump?&lt;/p&gt;

&lt;p&gt;BTW, for partial packet loss simulation, &lt;a href=&quot;http://www.linuxfoundation.org/collaborate/workgroups/networking/netem#Packet_loss&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Linux netem&lt;/a&gt; or my &lt;a href=&quot;http://osrg.github.io/earthquake/post/zookeeper-2212/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Earthquake tool&lt;/a&gt;(found &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2212&quot; title=&quot;distributed race condition related to QV version&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2212&quot;&gt;&lt;del&gt;ZOOKEEPER-2212&lt;/del&gt;&lt;/a&gt;, and perhaps also reproduced &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2080&quot; title=&quot;Fix deadlock in dynamic reconfiguration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2080&quot;&gt;&lt;del&gt;ZOOKEEPER-2080&lt;/del&gt;&lt;/a&gt;) might be useful. &lt;br/&gt;
(Wireshark is a packet analyzer, and doesn&apos;t provide any network simulation feature.)&lt;/p&gt;</comment>
                            <comment id="14728996" author="nijel" created="Thu, 3 Sep 2015 13:00:20 +0000"  >&lt;p&gt;hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=suda&quot; class=&quot;user-hover&quot; rel=&quot;suda&quot;&gt;suda&lt;/a&gt;&lt;br/&gt;
i got this issue from one of our site. The issue is from ResourceManager.&lt;br/&gt;
I could get very few info. The thread which got blocked is as follows&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;StandByTransitionThread Handler&quot; daemon prio=10 tid=0x000000000119a800 nid=0x641e3 in &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait() [0x00007ff3f67ab000]
1836    java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: WAITING (on object monitor)
1837     at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(Native Method)
1838     - waiting on &amp;lt;0x00000007855f2010&amp;gt; (a org.apache.zookeeper.ClientCnxn$Packet)
1839     at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.java:503)
1840     at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1414)
1841     - locked &amp;lt;0x00000007855f2010&amp;gt; (a org.apache.zookeeper.ClientCnxn$Packet)
1842     at org.apache.zookeeper.ClientCnxn.close(ClientCnxn.java:1386)
1843     at org.apache.zookeeper.ZooKeeper.close(ZooKeeper.java:677)
1844     - locked &amp;lt;0x000000078660daf0&amp;gt; (a org.apache.zookeeper.ZooKeeper)
1845     at org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore.closeZkClients(ZKRMStateStore.java:360)
1846     - locked &amp;lt;0x0000000781087940&amp;gt; (a org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore)
1847     at org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore.closeInternal(ZKRMStateStore.java:382)
1848     - locked &amp;lt;0x0000000781087940&amp;gt; (a org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore)
1849     at org.apache.hadoop.yarn.server.resourcemanager.recovery.RMStateStore.serviceStop(RMStateStore.java:486)
1850     at org.apache.hadoop.service.AbstractService.stop(AbstractService.java:221)
1851     - locked &amp;lt;0x00000007823b2a80&amp;gt; (a java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;)
1852     at org.apache.hadoop.service.AbstractService.close(AbstractService.java:250)
1853     at org.apache.hadoop.yarn.server.resourcemanager.ResourceManager$RMActiveServices.serviceStop(ResourceManager.java:549)
1854     at org.apache.hadoop.service.AbstractService.stop(AbstractService.java:221)
1855     - locked &amp;lt;0x00000007823d0610&amp;gt; (a java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;)
1856     at org.apache.hadoop.yarn.server.resourcemanager.ResourceManager.stopActiveServices(ResourceManager.java:958)
1857     at org.apache.hadoop.yarn.server.resourcemanager.ResourceManager.transitionToStandby(ResourceManager.java:1018)
1858     - locked &amp;lt;0x0000000780059c60&amp;gt; (a org.apache.hadoop.yarn.server.resourcemanager.ResourceManager)
1859     at org.apache.hadoop.yarn.server.resourcemanager.ResourceManager.handleTransitionToStandBy(ResourceManager.java:703)
1860     at org.apache.hadoop.yarn.server.resourcemanager.recovery.RMStateStore$StandByTransitionThread.run(RMStateStore.java:884)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;My analysis is that it is waiting for the packet response&lt;br/&gt;
Hope this helps&lt;/p&gt;</comment>
                            <comment id="14730278" author="suda" created="Fri, 4 Sep 2015 03:54:03 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nijel&quot; class=&quot;user-hover&quot; rel=&quot;nijel&quot;&gt;nijel&lt;/a&gt;, thank you for the information.&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;https://github.com/apache/zookeeper/blob/7f10f9c53a48b296dd27c7a104b303b10b045a89/src/java/main/org/apache/zookeeper/ClientCnxn.java#L1515&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;wait()&lt;/tt&gt;&lt;/a&gt; might be waiting for this &lt;a href=&quot;https://github.com/apache/zookeeper/blob/7f10f9c53a48b296dd27c7a104b303b10b045a89/src/java/main/org/apache/zookeeper/ClientCnxn.java#L736&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;notifyAll()&lt;/tt&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;A typical call stack for the notifyAll() is as follows:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;tt&gt;Object.notifyAll()&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/zookeeper/blob/7f10f9c53a48b296dd27c7a104b303b10b045a89/src/java/main/org/apache/zookeeper/ClientCnxn.java#L736&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;ClientCnxn.finishPacket()&lt;/tt&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/zookeeper/blob/7f10f9c53a48b296dd27c7a104b303b10b045a89/src/java/main/org/apache/zookeeper/ClientCnxn.java#L948&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;ClientCnxn$SendThread.readResponse()&lt;/tt&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/zookeeper/blob/7f10f9c53a48b296dd27c7a104b303b10b045a89/src/java/main/org/apache/zookeeper/ClientCnxnSocketNIO.java#L99&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;ClientCnxnSocketNIO.doIO()&lt;/tt&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/zookeeper/blob/7f10f9c53a48b296dd27c7a104b303b10b045a89/src/java/main/org/apache/zookeeper/ClientCnxnSocketNIO.java#L361&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;ClientCnxnSocketNIO.doTransport()&lt;/tt&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/zookeeper/blob/7f10f9c53a48b296dd27c7a104b303b10b045a89/src/java/main/org/apache/zookeeper/ClientCnxn.java#L1236&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;ClientCnxn$SendThread.run()&lt;/tt&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;If you can still reproduce the bug, could you please add some logs for the above methods and share the result (plus ZooKeeper version and YARN version)?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="14946850" author="arshad.mohammad" created="Wed, 7 Oct 2015 13:32:44 +0000"  >&lt;p&gt;How to reproduce the:&lt;br/&gt;
From the logs it is very clear that Client is waiting in &lt;tt&gt;org.apache.zookeeper.ClientCnxn.submitRequest()&lt;/tt&gt; on Packet object.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (packet) {
    &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (!packet.finished) {
        packet.wait();
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Above wait ends when packet.notifyAll() is called from &lt;tt&gt;org.apache.zookeeper.ClientCnxn.finishPacket(Packet)&lt;/tt&gt;&lt;br/&gt;
To reproduce client hang scenario through test we can override the &lt;tt&gt;org.apache.zookeeper.ClientCnxn.finishPacket(Packet)&lt;/tt&gt; method, so that it does not call packet.notifyAll(). &lt;/p&gt;</comment>
                            <comment id="14946857" author="arshad.mohammad" created="Wed, 7 Oct 2015 13:38:59 +0000"  >&lt;p&gt;Submitting a patch to fix this issue.&lt;br/&gt;
Implementation summary:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;time out handling is done for sync API&lt;/li&gt;
	&lt;li&gt;added zookeeper.request.timeout property, default value is 120000 milliseconds(2 minute)&lt;/li&gt;
	&lt;li&gt;added new error code TIMEOUT (-122);&lt;/li&gt;
	&lt;li&gt;added new exception TimeoutException&lt;/li&gt;
	&lt;li&gt;added test case&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="14946889" author="hadoopqa" created="Wed, 7 Oct 2015 14:02:44 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12765389/ZOOKEEPER-2251-01.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12765389/ZOOKEEPER-2251-01.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1706631.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2905//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2905//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2905//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2905//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2905//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2905//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14948067" author="arshad.mohammad" created="Thu, 8 Oct 2015 04:42:44 +0000"  >&lt;p&gt;In previous patch, I had missed the test cases. Submitting &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2251&quot; title=&quot;Add Client side packet response timeout to avoid infinite wait.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2251&quot;&gt;&lt;del&gt;ZOOKEEPER-2251&lt;/del&gt;&lt;/a&gt;-02.patch with test case included&lt;/p&gt;</comment>
                            <comment id="14948082" author="hadoopqa" created="Thu, 8 Oct 2015 05:07:52 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12765520/ZOOKEEPER-2251-02.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12765520/ZOOKEEPER-2251-02.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1706631.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2906//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2906//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2906//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2906//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2906//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2906//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14948352" author="nijel" created="Thu, 8 Oct 2015 09:19:35 +0000"  >&lt;p&gt;thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arshad.mohammad&quot; class=&quot;user-hover&quot; rel=&quot;arshad.mohammad&quot;&gt;arshad.mohammad&lt;/a&gt; for the patch&lt;br/&gt;
overall looks good&lt;/p&gt;

&lt;p&gt;few comments&lt;br/&gt;
1. The log message &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;{} configured value is {}.&quot;&lt;/span&gt;, ZOOKEEPER_REQUEST_TIMEOUT,
148	                    requestTimeoutProp);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;can be written after the value is read. Or in invalid case duplicate logs will come&lt;/p&gt;

&lt;p&gt;2. Change test class and test method name to reflect timeout feature&lt;/p&gt;

&lt;p&gt;3. Number format exception logs looks like not a complete sentence.&lt;/p&gt;

</comment>
                            <comment id="14948362" author="nijel" created="Thu, 8 Oct 2015 09:26:34 +0000"  >&lt;p&gt;One more comment&lt;br/&gt;
can you add this config in document as well ?&lt;/p&gt;</comment>
                            <comment id="14948758" author="eribeiro" created="Thu, 8 Oct 2015 14:36:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arshad.mohammad&quot; class=&quot;user-hover&quot; rel=&quot;arshad.mohammad&quot;&gt;arshad.mohammad&lt;/a&gt;, the patch looks good, congrats. One question: why &lt;tt&gt;ZKClientHangTest&lt;/tt&gt; creates 3 servers if the core of the test needs just one (&lt;tt&gt;clientPorts&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;/tt&gt;) that the client connects to? More servers are more time to wait for the unit test to run, slowing things down.&lt;/p&gt;</comment>
                            <comment id="14950237" author="arshad.mohammad" created="Fri, 9 Oct 2015 11:23:44 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eribeiro&quot; class=&quot;user-hover&quot; rel=&quot;eribeiro&quot;&gt;eribeiro&lt;/a&gt;for looking into the patch. Quorum servers are required because this patch also hits the logic of reconnect.&lt;br/&gt;
now connecting to all the servers.&lt;/p&gt;</comment>
                            <comment id="14950508" author="arshad.mohammad" created="Fri, 9 Oct 2015 14:50:17 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nijel&quot; class=&quot;user-hover&quot; rel=&quot;nijel&quot;&gt;nijel&lt;/a&gt; for your review comments. Submitting new patch &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2251&quot; title=&quot;Add Client side packet response timeout to avoid infinite wait.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2251&quot;&gt;&lt;del&gt;ZOOKEEPER-2251&lt;/del&gt;&lt;/a&gt;-03.patch which handles all the above comments. &lt;/p&gt;</comment>
                            <comment id="14950697" author="hadoopqa" created="Fri, 9 Oct 2015 16:57:05 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12765803/ZOOKEEPER-2251-03.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12765803/ZOOKEEPER-2251-03.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1706631.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2908//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2908//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14951011" author="eribeiro" created="Fri, 9 Oct 2015 18:59:53 +0000"  >&lt;p&gt;Oh, I see now. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Just a small review comment: give preference to use StringBuilder instead of StringBuffer, specially if the use is as a method variable, because StringBuffer methods are synchronized while StringBuilder methods are not.&lt;/p&gt;</comment>
                            <comment id="15054528" author="suda" created="Sat, 12 Dec 2015 18:39:41 +0000"  >&lt;p&gt;I recently experienced this bug in my cluster.&lt;br/&gt;
Any update?&lt;/p&gt;</comment>
                            <comment id="15055549" author="arshad.mohammad" created="Mon, 14 Dec 2015 07:07:50 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=suda&quot; class=&quot;user-hover&quot; rel=&quot;suda&quot;&gt;suda&lt;/a&gt; for sharing that you experienced this problem. &lt;br/&gt;
Regarding the status, implementation was done long back, review and commit is pending. Meanwhile many changes have happened so the current patch need to be rebased. I will soon rebase and submit new patch&lt;/p&gt;</comment>
                            <comment id="15055604" author="suda" created="Mon, 14 Dec 2015 08:10:44 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arshad.mohammad&quot; class=&quot;user-hover&quot; rel=&quot;arshad.mohammad&quot;&gt;arshad.mohammad&lt;/a&gt;, thank you for the response.&lt;/p&gt;

&lt;p&gt;The attached patch assumes that a response packet can be &quot;lost&quot;.&lt;br/&gt;
But I&apos;m still not sure what &quot;lost&quot; means.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2251?focusedCommentId=14706468&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14706468&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/ZOOKEEPER-2251?focusedCommentId=14706468&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14706468&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If TCP packets are actually lost, Linux kernel (on the server) should retransmit packets.&lt;br/&gt;
If even retransmitted packets are lost, client kernel should raise &lt;tt&gt;ETIMEDOUT&lt;/tt&gt; after 924.6 seconds by default. (It depends on the value of &lt;tt&gt;/proc/sys/net/ipv4/tcp_retries2&lt;/tt&gt;.)&lt;/p&gt;

&lt;p&gt;So I think infinite wait should not happen even if packets are lost.&lt;/p&gt;

&lt;p&gt;I can come up with following possibilities:&lt;/p&gt;

&lt;p&gt;1. Client kernel raised &lt;tt&gt;ETIMEDOUT&lt;/tt&gt;, and JVM raised a corresponding &lt;tt&gt;java.lang.IOException&lt;/tt&gt;. But client ZK did not catch the &lt;tt&gt;IOException&lt;/tt&gt; correctly. It&apos;s a bug of client.&lt;/p&gt;

&lt;p&gt;2. Server sent a TCP FIN packet. Client received the TCP FIN packet and raised &lt;tt&gt;IOException&lt;/tt&gt;, but client ZK did not catch the &lt;tt&gt;IOException&lt;/tt&gt; correctly. It&apos;s a bug of client.&lt;/p&gt;

&lt;p&gt;3. No TCP FIN packet were sent. It&apos;s a bug of server.&lt;/p&gt;

&lt;p&gt;4. Bug of kernel or JVM.&lt;/p&gt;


&lt;p&gt;I think we should dig out what really happens when we hit the bug, before merging the patch and closing the JIRA.&lt;/p&gt;

&lt;p&gt;(No matter what is the real cause of the bug, the patch is useful! Because non-privileged users cannot modify &lt;tt&gt;/proc/sys/net/ipv4/*&lt;/tt&gt;.)&lt;/p&gt;

&lt;p&gt;I would like to hear your comments.&lt;/p&gt;

&lt;p&gt;I&apos;m also trying to reproduce the bug again, and digging out what are really happening.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="15056085" author="arshad.mohammad" created="Mon, 14 Dec 2015 15:14:45 +0000"  >&lt;p&gt;I think irrespective of the reason, why packet(server response) not received, there should be some time-out. Can not keep waiting infinitely&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (packet) {
    &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (!packet.finished) {
        packet.wait();
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Seems you have good system understanding. please share if you find the reason.&lt;/p&gt;</comment>
                            <comment id="15063503" author="nijel" created="Fri, 18 Dec 2015 05:36:23 +0000"  >&lt;p&gt;hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marshad&quot; class=&quot;user-hover&quot; rel=&quot;marshad&quot;&gt;marshad&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=suda&quot; class=&quot;user-hover&quot; rel=&quot;suda&quot;&gt;suda&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I observed this when i am doing reliability test for a banking customer&lt;br/&gt;
Here we test for any network abnormality and packet drop.&lt;/p&gt;

&lt;p&gt;Here in the scenario packet is sent and wait for ever. Even if the server is not responding due to any reason, this issue can happen&lt;/p&gt;

&lt;p&gt;so my opinion is to have this time out since many services&apos; high availability solution depends on zookeeper.&lt;/p&gt;
</comment>
                            <comment id="15063517" author="hadoopqa" created="Fri, 18 Dec 2015 05:41:43 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12765803/ZOOKEEPER-2251-03.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12765803/ZOOKEEPER-2251-03.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1720227.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2999//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2999//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15063565" author="suda" created="Fri, 18 Dec 2015 06:21:06 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arshad.mohammad&quot; class=&quot;user-hover&quot; rel=&quot;arshad.mohammad&quot;&gt;arshad.mohammad&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nijel&quot; class=&quot;user-hover&quot; rel=&quot;nijel&quot;&gt;nijel&lt;/a&gt;,&lt;br/&gt;
Thank you for comments,&lt;br/&gt;
and sorry for that I&apos;m still not able to identify the root cause of the bug.&lt;/p&gt;

&lt;p&gt;I&apos;m ok for having this timeout.&lt;br/&gt;
I would like to respect committers&apos; decision.&lt;/p&gt;

&lt;p&gt;Cc: &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rgs&quot; class=&quot;user-hover&quot; rel=&quot;rgs&quot;&gt;rgs&lt;/a&gt; (zktraffic author), could you please look on this?&lt;/p&gt;</comment>
                            <comment id="15182726" author="arshad.mohammad" created="Mon, 7 Mar 2016 08:05:33 +0000"  >&lt;p&gt;Submitting new patch as previous patch had a deadlock scenario&lt;/p&gt;</comment>
                            <comment id="15182742" author="hadoopqa" created="Mon, 7 Mar 2016 08:26:48 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12791733/ZOOKEEPER-2251-04.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12791733/ZOOKEEPER-2251-04.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1733679.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3091//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3091//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3091//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3091//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3091//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3091//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15495374" author="adamwhitney" created="Fri, 16 Sep 2016 04:52:07 +0000"  >&lt;p&gt;I think I&apos;m seeing this problem using activemq with replicated leveldb ... every once in a while our network loses some packets when zookeeper server is acking back to the zookeeper client in activemq, and intermittently it seems to lead to a hang on the activemq side. Unfortunately, I don&apos;t have the ability yet to get a thread dump, so I can&apos;t tell for sure, but the cause and symptoms of my issue match very well with this bug. It looks like this bug has passed all the reviews ... is there any reason why it is not yet merged?&lt;/p&gt;</comment>
                            <comment id="15495560" author="hadoopqa" created="Fri, 16 Sep 2016 06:46:04 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12791733/ZOOKEEPER-2251-04.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12791733/ZOOKEEPER-2251-04.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision b2a484cfe743116d2531fe5d1e1d78b3960c511e.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3434//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3434//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15702561" author="m.martinez" created="Mon, 28 Nov 2016 17:25:16 +0000"  >&lt;p&gt;Hi.  We are definitely running into what looks to be this problem and I was wondering if there was any movement towards incorporating the fix into a release version?&lt;/p&gt;

&lt;p&gt;I&apos;ve worked around the issue in one part of our code by wrapping my own timeout around the call that is vulnerable to the deadlock.&lt;/p&gt;

&lt;p&gt;However, this isn&apos;t possible in some cases where 3rd party code (in our case, Accumulo client &amp;amp; Thrift libraries) call down into the ZooKeeper client code and hit this.&lt;/p&gt;

&lt;p&gt;This has become a pretty critical issue for us. &lt;/p&gt;</comment>
                            <comment id="15702576" author="hadoopqa" created="Mon, 28 Nov 2016 17:29:46 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12791733/ZOOKEEPER-2251-04.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12791733/ZOOKEEPER-2251-04.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision d72f27279a13986ee0c011e1e5b34edf3a310da9.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3534//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3534//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15702711" author="m.martinez" created="Mon, 28 Nov 2016 18:24:30 +0000"  >&lt;p&gt;Is the problem simply that the patch needs to be updated to match the latest code?&lt;/p&gt;</comment>
                            <comment id="15713491" author="hanm" created="Fri, 2 Dec 2016 00:09:49 +0000"  >&lt;blockquote&gt;&lt;p&gt;Is the problem simply that the patch needs to be updated to match the latest code?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=m.martinez&quot; class=&quot;user-hover&quot; rel=&quot;m.martinez&quot;&gt;m.martinez&lt;/a&gt; Thanks for bumping this up. Community has been working on a couple of high priority issues to prepare incoming 3.4.10 and 3.5.3 releases. This issue was not labelled with version info so it does not get much visibility in the queue. Just updated the JIRA and reviewing the patch.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;We are definitely running into what looks to be this problem&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=m.martinez&quot; class=&quot;user-hover&quot; rel=&quot;m.martinez&quot;&gt;m.martinez&lt;/a&gt; Which version of ZooKeeper you are running?&lt;/p&gt;

&lt;p&gt;On a side note, the patch does look outdated (i.e. the doc changes refer to 3.5.2 which is released already) and needs to be rebased. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arshad.mohammad&quot; class=&quot;user-hover&quot; rel=&quot;arshad.mohammad&quot;&gt;arshad.mohammad&lt;/a&gt; Do you mind update the patch and send a pull request on git? We can start iterating from there.&lt;/p&gt;</comment>
                            <comment id="15713743" author="m.martinez" created="Fri, 2 Dec 2016 02:00:29 +0000"  >&lt;p&gt;Michael Han - we are using version 3.4.5.  &lt;/p&gt;

&lt;p&gt;We would almost certainly upgrade to a newer version if we knew this problem would be addressed. &lt;/p&gt;
</comment>
                            <comment id="15723037" author="githubbot" created="Mon, 5 Dec 2016 18:58:42 +0000"  >&lt;p&gt;GitHub user arshadmohammad opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/119&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/119&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2251&quot; title=&quot;Add Client side packet response timeout to avoid infinite wait.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2251&quot;&gt;&lt;del&gt;ZOOKEEPER-2251&lt;/del&gt;&lt;/a&gt;:Add Client side packet response timeout to avoid infinite wait.&lt;/p&gt;

&lt;p&gt;    Add Client side packet response timeout to avoid infinite wait.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/arshadmohammad/zookeeper&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/arshadmohammad/zookeeper&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2251&quot; title=&quot;Add Client side packet response timeout to avoid infinite wait.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2251&quot;&gt;&lt;del&gt;ZOOKEEPER-2251&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/119.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/119.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #119&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit b4ac9f9f7f3742ac2bd08e383c9650cbf4962691&lt;br/&gt;
Author: arshadmohammad &amp;lt;arshad.mohammad.k@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-12-05T18:55:10Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2251&quot; title=&quot;Add Client side packet response timeout to avoid infinite wait.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2251&quot;&gt;&lt;del&gt;ZOOKEEPER-2251&lt;/del&gt;&lt;/a&gt;:Add Client side packet response timeout to avoid infinite wait.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15723058" author="m.martinez" created="Mon, 5 Dec 2016 19:06:11 +0000"  >&lt;p&gt;Is &apos;master&apos; the correct integration branch to point that pull request to?  &lt;/p&gt;

&lt;p&gt;I&apos;m not familiar with the ZooKeeper project&apos;s branch strategy so I&apos;m just asking.&lt;/p&gt;</comment>
                            <comment id="15723085" author="hadoopqa" created="Mon, 5 Dec 2016 19:19:26 +0000"  >&lt;p&gt;+1 overall.  GitHub Pull Request  Build&lt;/p&gt;


&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/101//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/101//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/101//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/101//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/101//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/101//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15725558" author="eribeiro" created="Tue, 6 Dec 2016 14:00:20 +0000"  >&lt;p&gt;AFAIK, if the JIRA issue states that it fixes 3.4.10, 3.5.3, and 3.6.0 then you should point to the earliest branch (branch-3.4). When applying the PR the committer can port it to branch-3.5 and master. By the way, I advise you to see if the patch applies cleanly on branch-3.4, branch-3.5 and master so you can save committer time (that is scarce) from having to deal with conflicts. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Please&lt;/em&gt;, correct me if I am wrong, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;fpj&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rgs&quot; class=&quot;user-hover&quot; rel=&quot;rgs&quot;&gt;rgs&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=breed&quot; class=&quot;user-hover&quot; rel=&quot;breed&quot;&gt;breed&lt;/a&gt;. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15734533" author="githubbot" created="Fri, 9 Dec 2016 06:58:38 +0000"  >&lt;p&gt;Github user hanm commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/119#discussion_r91666999&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/119#discussion_r91666999&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/docs/src/documentation/content/xdocs/zookeeperProgrammers.xml &amp;#8212;&lt;br/&gt;
    @@ -1538,6 +1538,24 @@ public abstract class ServerAuthenticationProvider implements AuthenticationProv&lt;br/&gt;
                         &amp;lt;para&amp;gt;Specifies path to kinit binary. Default is &quot;/usr/bin/kinit&quot;.&amp;lt;/para&amp;gt;&lt;br/&gt;
                     &amp;lt;/listitem&amp;gt;&lt;br/&gt;
                 &amp;lt;/varlistentry&amp;gt;&lt;br/&gt;
    +            &amp;lt;varlistentry&amp;gt;&lt;br/&gt;
    +                &amp;lt;term&amp;gt;zookeeper.request.timeout&amp;lt;/term&amp;gt;&lt;br/&gt;
    +                &amp;lt;listitem&amp;gt;&lt;br/&gt;
    +                &amp;lt;para&amp;gt;&lt;br/&gt;
    +                    &amp;lt;emphasis role=&quot;bold&quot;&amp;gt;New in 3.5.3:&amp;lt;/emphasis&amp;gt;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    This probably would not make to 3.5.3. 3.6.0 would be a more realistic value.&lt;/p&gt;</comment>
                            <comment id="15734534" author="githubbot" created="Fri, 9 Dec 2016 06:58:38 +0000"  >&lt;p&gt;Github user hanm commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/119#discussion_r91666945&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/119#discussion_r91666945&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/KeeperException.java &amp;#8212;&lt;br/&gt;
    @@ -387,6 +389,8 @@ public void setCode(int code) {&lt;br/&gt;
             EPHEMERALONLOCALSESSION (EphemeralOnLocalSession),&lt;br/&gt;
             /** Attempts to remove a non-existing watcher */&lt;br/&gt;
             NOWATCHER (-121),&lt;br/&gt;
    +        /** Not received packet timely */&lt;br/&gt;
    +        TIMEOUT (-122),&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Similar error code needs to be added to C client to make both client library compatible.&lt;/p&gt;</comment>
                            <comment id="15734535" author="githubbot" created="Fri, 9 Dec 2016 06:58:38 +0000"  >&lt;p&gt;Github user hanm commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/119#discussion_r91666647&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/119#discussion_r91666647&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java &amp;#8212;&lt;br/&gt;
    @@ -1495,10 +1504,21 @@ public ReplyHeader submitRequest(RequestHeader h, Record request,&lt;br/&gt;
             Packet packet = queuePacket(h, r, request, response, null, null, null,&lt;br/&gt;
                     null, watchRegistration, watchDeregistration);&lt;br/&gt;
             synchronized (packet) {&lt;br/&gt;
    +            long waitStartTime = System.currentTimeMillis();&lt;br/&gt;
                 while (!packet.finished) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;packet.wait();&lt;br/&gt;
    +                packet.wait(requestTimeout);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    This unconditionally adds a timeout is a pretty significant semantic change. Whether or not we should wait indefinitely is a separate issue to discuss later, but from a compatibility point of view we&apos;d at least provide a configuration option to let user opt in this feature rather than having this turned on by default. So by default there is no timeout and client still waits indefinitely, user who wants to opt in to turn on the timeout needs to explicit say so and provide a value they think make sense to them. Otherwise, we&apos;d have to solve the problem of what the default timeout value we should set in ZK config if this feature is turned on by default, and that problem is hard and very likely there is no default value that makes everyone happy.&lt;/p&gt;</comment>
                            <comment id="15734548" author="hanm" created="Fri, 9 Dec 2016 07:06:20 +0000"  >&lt;p&gt;Has anyone that watching this issue able to have a deterministic reproduce of the issue? The timeout solution is trivial but it&apos;s important to try to figure out root cause of packet loss otherwise we could just fix the surface and then have unexpected bug bite us. &lt;/p&gt;</comment>
                            <comment id="15734817" author="githubbot" created="Fri, 9 Dec 2016 09:39:06 +0000"  >&lt;p&gt;Github user wuwen5 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/119#discussion_r91682496&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/119#discussion_r91682496&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java &amp;#8212;&lt;br/&gt;
    @@ -1495,10 +1504,21 @@ public ReplyHeader submitRequest(RequestHeader h, Record request,&lt;br/&gt;
             Packet packet = queuePacket(h, r, request, response, null, null, null,&lt;br/&gt;
                     null, watchRegistration, watchDeregistration);&lt;br/&gt;
             synchronized (packet) {&lt;br/&gt;
    +            long waitStartTime = System.currentTimeMillis();&lt;br/&gt;
                 while (!packet.finished) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;packet.wait();&lt;br/&gt;
    +                packet.wait(requestTimeout);&lt;br/&gt;
    +                if (!packet.finished &amp;amp;&amp;amp; ((System.currentTimeMillis()
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    System.currentTimeMillis() is dependent on System clock. It probably micro-corrected by an external programme..&lt;/p&gt;

&lt;p&gt;    I think using System.nanoTime() to measure elapsed time is the correct solution.&lt;/p&gt;</comment>
                            <comment id="15749214" author="m.martinez" created="Wed, 14 Dec 2016 19:23:52 +0000"  >&lt;p&gt;Unfortunately I don&apos;t have a simple deterministic test.  But we had an environment where two of our zookeeper servers were sharing their nodes with another cpu &amp;amp; memory (&amp;amp; thread) hungry process and this seemed to result in a lot of zookeepertimeoutexceptions at the client as well as unfortunately frequent hits on this particular deadlock (which does get caught in jvisualvm thread dumps).   We could not run more than a day or two on our sustained ingest tests without hitting this.&lt;/p&gt;

&lt;p&gt;We&apos;ve moved the two zookeepers to dedicated nodes  (the third already was on it&apos;s own node) and things have looked stable so far (on this particular issue), but my management is rightfully concerned that we should have this fix in place.&lt;/p&gt;

&lt;p&gt;We would be perfectly fine with a parameterized wait time option and a default of the current indefinite wait.&lt;/p&gt;</comment>
                            <comment id="15750059" author="hanm" created="Thu, 15 Dec 2016 01:43:38 +0000"  >&lt;p&gt;Thanks for the info, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=m.martinez&quot; class=&quot;user-hover&quot; rel=&quot;m.martinez&quot;&gt;m.martinez&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;On a side note about sharing ZK with other processes: it is generally advised to have ZK deployed on dedicated resource - sometimes you might even want to have dedicated device for storing transaction log files. &lt;/p&gt;</comment>
                            <comment id="15750088" author="githubbot" created="Thu, 15 Dec 2016 01:55:52 +0000"  >&lt;p&gt;Github user hanm commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/119#discussion_r92530333&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/119#discussion_r92530333&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java &amp;#8212;&lt;br/&gt;
    @@ -1495,10 +1504,21 @@ public ReplyHeader submitRequest(RequestHeader h, Record request,&lt;br/&gt;
             Packet packet = queuePacket(h, r, request, response, null, null, null,&lt;br/&gt;
                     null, watchRegistration, watchDeregistration);&lt;br/&gt;
             synchronized (packet) {&lt;br/&gt;
    +            long waitStartTime = System.currentTimeMillis();&lt;br/&gt;
                 while (!packet.finished) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;packet.wait();&lt;br/&gt;
    +                packet.wait(requestTimeout);&lt;br/&gt;
    +                if (!packet.finished &amp;amp;&amp;amp; ((System.currentTimeMillis()
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Yes, and actually we have a Time class which we can use here that uses nanoTime internally for exact same reason. &lt;/p&gt;</comment>
                            <comment id="15751475" author="m.martinez" created="Thu, 15 Dec 2016 14:12:00 +0000"  >&lt;p&gt;Yes, we&apos;ve been figuring this out.&lt;/p&gt;

&lt;p&gt;Unfortunately, customer deployment requirements can sometimes limit our control over the environment.  We are trying to make things as robust and fault tolerant as possible while still allowing for as much flexibility in how things are deployed.  There are obviously limits to that!&lt;/p&gt;</comment>
                            <comment id="15816184" author="m.martinez" created="Tue, 10 Jan 2017 21:05:40 +0000"  >&lt;p&gt;Bumping this.   We&apos;ve put in lots of mitigations around this, but we consider this still an important issue for us that needs to be resolved.   Really hope this can make it into 3.4.10.&lt;/p&gt;
</comment>
                            <comment id="15817267" author="hanm" created="Wed, 11 Jan 2017 05:44:35 +0000"  >&lt;p&gt;The PR needs some update to address review comments before we can commit this. In particular, it would be good to have a feature flag that controls the on / off of client side timeout (for reasons commented in PR), also C client side work.&lt;/p&gt;

&lt;p&gt;Not sure if &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arshad.mohammad&quot; class=&quot;user-hover&quot; rel=&quot;arshad.mohammad&quot;&gt;arshad.mohammad&lt;/a&gt; still on this but if not, maybe &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=m.martinez&quot; class=&quot;user-hover&quot; rel=&quot;m.martinez&quot;&gt;m.martinez&lt;/a&gt; you can start driving this by contributing a patch? &lt;/p&gt;</comment>
                            <comment id="15819610" author="m.martinez" created="Thu, 12 Jan 2017 00:07:19 +0000"  >&lt;p&gt;I&apos;ll have to go through Lab protocols for approval to submit a patch.  I&apos;ll look into it.  &lt;/p&gt;

&lt;p&gt;I&apos;ll need to set up to build with Ivy against our internal Nexus as well since I&apos;m behind a firewall.    Sigh ... busywork.  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/biggrin.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15820232" author="hanm" created="Thu, 12 Jan 2017 05:34:44 +0000"  >&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="15878608" author="m.martinez" created="Wed, 22 Feb 2017 16:18:01 +0000"  >&lt;p&gt;Update:  I&apos;m sorry, but I&apos;ve been pulled away from this in my tasking.   This is still a real concern for us, and I think I&apos;ll eventually be able to get back to it, but it won&apos;t happen real quick.&lt;/p&gt;</comment>
                            <comment id="16385516" author="awkejiang" created="Mon, 5 Mar 2018 03:00:56 +0000"  >&lt;p&gt;what&apos;s the release plan for this patch?&lt;/p&gt;</comment>
                            <comment id="16387776" author="andorm" created="Tue, 6 Mar 2018 13:34:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=awkejiang&quot; class=&quot;user-hover&quot; rel=&quot;awkejiang&quot;&gt;awkejiang&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I believe that &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hanm&quot; class=&quot;user-hover&quot; rel=&quot;hanm&quot;&gt;hanm&lt;/a&gt;&apos;s concerns have to be addressed first on GitHub.&lt;/p&gt;</comment>
                            <comment id="16547209" author="hadoopqa" created="Tue, 17 Jul 2018 23:20:54 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12791733/ZOOKEEPER-2251-04.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12791733/ZOOKEEPER-2251-04.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision cea251a185435e88f54efc5defb92ec9584fc80f.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3697//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3697//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16550168" author="hadoopqa" created="Fri, 20 Jul 2018 03:21:13 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12791733/ZOOKEEPER-2251-04.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12791733/ZOOKEEPER-2251-04.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 4c12f75a9dd546032eafb2d2840061399c2a6a5e.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3698//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3698//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16552300" author="hadoopqa" created="Mon, 23 Jul 2018 03:56:54 +0000"  >&lt;p&gt;+1 overall.  GitHub Pull Request  Build&lt;/p&gt;


&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1986//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1986//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1986//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1986//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1986//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1986//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16559185" author="hanm" created="Fri, 27 Jul 2018 03:16:40 +0000"  >&lt;p&gt;Issue resolved by pull request 119&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/zookeeper/pull/119&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/119&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16559223" author="hudson" created="Fri, 27 Jul 2018 04:14:18 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build ZooKeeper-trunk #122 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/122/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/122/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2251&quot; title=&quot;Add Client side packet response timeout to avoid infinite wait.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2251&quot;&gt;&lt;del&gt;ZOOKEEPER-2251&lt;/del&gt;&lt;/a&gt;: Add Client side packet response timeout to avoid (hanm: rev 9f82798415351a20136ceb1640b1781723e51cc1)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(add) src/java/test/org/apache/zookeeper/ClientRequestTimeoutTest.java&lt;/li&gt;
	&lt;li&gt;(edit) zookeeper-docs/src/documentation/content/xdocs/zookeeperProgrammers.xml&lt;/li&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/ZooKeeper.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/client/ZKClientConfig.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/ClientCnxn.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/KeeperException.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13552144">ZOOKEEPER-4749</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12765389" name="ZOOKEEPER-2251-01.patch" size="7825" author="arshad.mohammad" created="Wed, 7 Oct 2015 13:38:59 +0000"/>
                            <attachment id="12765520" name="ZOOKEEPER-2251-02.patch" size="14073" author="arshad.mohammad" created="Thu, 8 Oct 2015 04:42:44 +0000"/>
                            <attachment id="12765803" name="ZOOKEEPER-2251-03.patch" size="11304" author="arshad.mohammad" created="Fri, 9 Oct 2015 14:50:17 +0000"/>
                            <attachment id="12791733" name="ZOOKEEPER-2251-04.patch" size="16861" author="arshad.mohammad" created="Mon, 7 Mar 2016 08:05:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 16 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2j31z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>