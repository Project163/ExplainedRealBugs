<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:57:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[ZOOKEEPER-2211] PurgeTxnLog does not correctly purge when snapshots and logs are at different locations</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-2211</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;PurgeTxnLog does not work when snapshots and transaction logs are at different file paths. The argument handling is buggy and only works when both snap and datalog dirs are given, and datalog dir contains both logs and snaps (snap is ignored).&lt;/p&gt;</description>
                <environment>&lt;p&gt;Ubuntu 12.04, Java 1.7.&lt;/p&gt;</environment>
        <key id="12836651">ZOOKEEPER-2211</key>
            <summary>PurgeTxnLog does not correctly purge when snapshots and logs are at different locations</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="arshad.mohammad">Mohammad Arshad</assignee>
                                    <reporter username="wesc">Wesley Chow</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Jun 2015 20:45:57 +0000</created>
                <updated>Thu, 21 Jul 2016 20:18:40 +0000</updated>
                            <resolved>Fri, 4 Dec 2015 04:20:38 +0000</resolved>
                                    <version>3.4.6</version>
                    <version>3.5.0</version>
                                    <fixVersion>3.4.8</fixVersion>
                    <fixVersion>3.5.2</fixVersion>
                    <fixVersion>3.6.0</fixVersion>
                                    <component>scripts</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14579539" author="wesc" created="Tue, 9 Jun 2015 20:47:06 +0000"  >&lt;p&gt;Patch applies cleanly against 3.4.6 and trunk.&lt;/p&gt;</comment>
                            <comment id="14579546" author="hadoopqa" created="Tue, 9 Jun 2015 20:51:50 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12738654/txn_purge.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12738654/txn_purge.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1683878.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2757//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2757//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14579553" author="rgs" created="Tue, 9 Jun 2015 20:57:13 +0000"  >&lt;p&gt;Thanks for the patch &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=wesc&quot; class=&quot;user-hover&quot; rel=&quot;wesc&quot;&gt;wesc&lt;/a&gt;. To generate a patch from git you should use --no-prefix, i.e.:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;$ git diff --no-prefix HEAD~1.. &amp;gt; ZOOKEEPER-2211.patch
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Mind regenerating and uploading again?&lt;/p&gt;</comment>
                            <comment id="14579557" author="rgs" created="Tue, 9 Jun 2015 20:58:44 +0000"  >&lt;p&gt;(otherwise, CI does not know how to apply it.) &lt;/p&gt;</comment>
                            <comment id="14579560" author="rgs" created="Tue, 9 Jun 2015 21:00:59 +0000"  >&lt;p&gt;Also, see &lt;a href=&quot;http://wiki.apache.org/hadoop/ZooKeeper/HowToContribute&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://wiki.apache.org/hadoop/ZooKeeper/HowToContribute&lt;/a&gt;. The convention for patch naming is ZOOKEEPER-NNNN.patch (i.e.: in this case &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2211&quot; title=&quot;PurgeTxnLog does not correctly purge when snapshots and logs are at different locations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2211&quot;&gt;&lt;del&gt;ZOOKEEPER-2211&lt;/del&gt;&lt;/a&gt;.patch). &lt;/p&gt;</comment>
                            <comment id="14579567" author="wesc" created="Tue, 9 Jun 2015 21:09:59 +0000"  >&lt;p&gt;The &quot;how to contribute&quot; wiki page says that after fixing a failed patch I should select &quot;resume progress&quot;, but I don&apos;t see that as an option? Do I cancel patch and resubmit?&lt;/p&gt;</comment>
                            <comment id="14579574" author="hadoopqa" created="Tue, 9 Jun 2015 21:18:33 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12738664/ZOOKEEPER-2211.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12738664/ZOOKEEPER-2211.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1683878.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 1 new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2758//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2758//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2758//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2758//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2758//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2758//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14579583" author="rgs" created="Tue, 9 Jun 2015 21:24:04 +0000"  >&lt;p&gt;yeah, that usually works (i think). &lt;/p&gt;</comment>
                            <comment id="14579586" author="rgs" created="Tue, 9 Jun 2015 21:25:09 +0000"  >&lt;p&gt;the failure looks pretty unrelated:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;org.apache.zookeeper.test.ClientPortBindTest.testBindByAddress

java.net.SocketException: No such device
	at java.net.NetworkInterface.isLoopback0(Native Method)
	at java.net.NetworkInterface.isLoopback(NetworkInterface.java:382)
	at org.apache.zookeeper.test.ClientPortBindTest.testBindByAddress(ClientPortBindTest.java:61)
	at org.apache.zookeeper.JUnit4ZKTestRunner$LoggedInvokeMethod.evaluate(JUnit4ZKTestRunner.java:55)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14579589" author="wesc" created="Tue, 9 Jun 2015 21:28:29 +0000"  >&lt;p&gt;Hudson reran the tests without me resubmitting the patch. It&apos;s failing a core test and a findbugs run, neither of which are related to this code. Should I just ignore? Also, I&apos;m not sure if I have time to write tests, and my java fu is pretty rusty. Is that necessary before being accepted?&lt;/p&gt;</comment>
                            <comment id="14579594" author="rgs" created="Tue, 9 Jun 2015 21:29:57 +0000"  >&lt;p&gt;Yeah, we can just ignore it. I think this is find since it&apos;s cmdline parsing. So +1, I&apos;ll merge in a bit. Thanks ! &lt;/p&gt;</comment>
                            <comment id="14579601" author="wesc" created="Tue, 9 Jun 2015 21:36:58 +0000"  >&lt;p&gt;Great, looking forward to it!&lt;/p&gt;</comment>
                            <comment id="14579690" author="rgs" created="Tue, 9 Jun 2015 22:34:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=wesc&quot; class=&quot;user-hover&quot; rel=&quot;wesc&quot;&gt;wesc&lt;/a&gt;: actually, the patch is wrong so -1. You are just missing -n which is mandatory, that&apos;s why it checks for 3 (datadir -n count) or 4 args (datadir snapdir -n count). &lt;/p&gt;</comment>
                            <comment id="14579693" author="rgs" created="Tue, 9 Jun 2015 22:35:12 +0000"  >&lt;p&gt;That being said, that parsing code should be cleaned up. &lt;/p&gt;</comment>
                            <comment id="14579717" author="wesc" created="Tue, 9 Jun 2015 23:04:48 +0000"  >&lt;p&gt;Oh no, you&apos;re right. I think we copied an incorrect example for our systems that omitted the -n, and I just didn&apos;t think about it when reading the code. I&apos;ll readjust.&lt;/p&gt;</comment>
                            <comment id="14580103" author="rakeshr" created="Wed, 10 Jun 2015 06:30:33 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=wesc&quot; class=&quot;user-hover&quot; rel=&quot;wesc&quot;&gt;wesc&lt;/a&gt; for the contribution. It would be great if you can add unit tests in &lt;tt&gt;org.apache.zookeeper.server.PurgeTxnTest&lt;/tt&gt; class. Probably you can directly call  &lt;tt&gt;PurgeTxnLog#main(String [] args)&lt;/tt&gt; in the tests by giving the &lt;tt&gt;args&lt;/tt&gt; array. This will help to cover the parsing logic.&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;Note:&lt;/ins&gt; Please don&apos;t delete the old patch which you already attached in the jira because previous attachments would help as a reference for the reviewers. You can attach a new patch to the jira, our jenkins will automatically picks up the latest one and run the test.&lt;/p&gt;</comment>
                            <comment id="14708519" author="rgs" created="Sun, 23 Aug 2015 20:08:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chowwesley&quot; class=&quot;user-hover&quot; rel=&quot;chowwesley&quot;&gt;chowwesley&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;rakeshr&lt;/a&gt;: are you still interesting in cleaning up that parsing code or should we close this is as invalid (given it isn&apos;t a bug per se)? Thanks!&lt;/p&gt;</comment>
                            <comment id="14717537" author="wesc" created="Thu, 27 Aug 2015 21:11:31 +0000"  >&lt;p&gt;I&apos;m really sorry I haven&apos;t had time to get to this. I would just go ahead and close it as invalid and perhaps I&apos;ll be inspired to come back to this later.&lt;/p&gt;</comment>
                            <comment id="14721046" author="arshad.mohammad" created="Sat, 29 Aug 2015 10:11:24 +0000"  >&lt;p&gt;Submitting new patch with all review comment fixed.&lt;/p&gt;</comment>
                            <comment id="14721672" author="hadoopqa" created="Sun, 30 Aug 2015 18:55:54 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12753132/ZOOKEEPER-2211-02.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12753132/ZOOKEEPER-2211-02.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1698058.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2848//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2848//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2848//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2848//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2848//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2848//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14907609" author="rakeshr" created="Fri, 25 Sep 2015 05:33:51 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arshad.mohammad&quot; class=&quot;user-hover&quot; rel=&quot;arshad.mohammad&quot;&gt;arshad.mohammad&lt;/a&gt; for taking this ahead. Patch looks overall fine, just few comments:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Please add one more validation to check the &lt;tt&gt;-n&lt;/tt&gt; argument name. If user pass an argument other than &quot;-n&quot;, then should fail. Since its not using command line parser, we could add a simple check like  &quot;-n&quot;.equals(argOption)&lt;/li&gt;
	&lt;li&gt;instead of &lt;tt&gt;minimum value is 3&lt;/tt&gt;, can you rephrase it to &lt;tt&gt;greater than 3&lt;/tt&gt;.
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;\tcount -- the number of old snaps/logs you want to keep, value should be greater than 3&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="14908578" author="arshad.mohammad" created="Fri, 25 Sep 2015 19:55:14 +0000"  >&lt;p&gt;Thanks a lot  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;rakeshr&lt;/a&gt; for your review comments&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;handled&lt;/li&gt;
	&lt;li&gt;Here &quot;greater than 3&quot; means at least 4, but as per the existing functionality even 3 snap/logs can be retained.  So I think message &quot;greater than 3&quot; will be misleading. IMHO,  &quot;greater than or equal to 3&quot; will be more appropriate message. Changed the message to 
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;\tcount -- the number of old snaps/logs you want to keep, value should be greater than or equal to 3&quot;&lt;/span&gt;);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;is this OK?&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="14908581" author="arshad.mohammad" created="Fri, 25 Sep 2015 19:56:40 +0000"  >&lt;p&gt;Submitting new patch&lt;/p&gt;</comment>
                            <comment id="14908704" author="hadoopqa" created="Fri, 25 Sep 2015 21:28:42 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12762442/ZOOKEEPER-2211-03.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12762442/ZOOKEEPER-2211-03.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1705225.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2886//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2886//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2886//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2886//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2886//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2886//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14909977" author="rgs" created="Mon, 28 Sep 2015 02:10:51 +0000"  >&lt;p&gt;Thanks for the patch &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arshad.mohammad&quot; class=&quot;user-hover&quot; rel=&quot;arshad.mohammad&quot;&gt;arshad.mohammad&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;A few nits:&lt;/p&gt;

&lt;p&gt;In:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; countOption = &quot;&quot;;
+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (args.length == 3) {
+            countOption = args[1];
+            num = &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.parseInt(args[2]);
+        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
+            snapDir = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(args[1]);
+            countOption = args[2];
+            num = &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.parseInt(args[3]);
+        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;you should catch NumberFormatException for each parseInt called (and show usage and exit).&lt;/p&gt;

&lt;p&gt;Also, testPurgeTxnLogWithDataDir() and testPurgeTxnLogWithoutDataDir are almost the same except for String [] args and the assert calls. I think you can extract that into a helper method and call that from both tests (with the needed params).&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="14933361" author="arshad.mohammad" created="Mon, 28 Sep 2015 14:30:24 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rgs&quot; class=&quot;user-hover&quot; rel=&quot;rgs&quot;&gt;rgs&lt;/a&gt; for your comments.&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Handled  NumberFormatException&lt;/li&gt;
	&lt;li&gt;Added file exist validation for snap and log directory&lt;/li&gt;
	&lt;li&gt;Apart from args following things also are different
	&lt;ol&gt;
		&lt;li&gt;comments&lt;/li&gt;
		&lt;li&gt;snapshot creation directory&lt;/li&gt;
		&lt;li&gt;assertion&lt;br/&gt;
I think if extracted to a method it will increase the code complexity, code will be less understandable. at least four places need to add if else. So not changing&lt;br/&gt;
is it ok?&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Submitting patch &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2211&quot; title=&quot;PurgeTxnLog does not correctly purge when snapshots and logs are at different locations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2211&quot;&gt;&lt;del&gt;ZOOKEEPER-2211&lt;/del&gt;&lt;/a&gt;-04.patch&lt;/p&gt;</comment>
                            <comment id="14933408" author="hadoopqa" created="Mon, 28 Sep 2015 14:56:36 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12764025/ZOOKEEPER-2211-04.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12764025/ZOOKEEPER-2211-04.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1705482.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2891//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2891//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2891//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2891//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2891//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2891//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14995816" author="rgs" created="Sun, 8 Nov 2015 21:25:32 +0000"  >&lt;p&gt;Merged for trunk and 3.5:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/zookeeper/commit/f16133d015603e97f893f91b99a6e5353e90f9df&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/commit/f16133d015603e97f893f91b99a6e5353e90f9df&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/zookeeper/commit/f6f5eb505fc2994d971c0b1150c16c8e43e877e6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/commit/f6f5eb505fc2994d971c0b1150c16c8e43e877e6&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arshad.mohammad&quot; class=&quot;user-hover&quot; rel=&quot;arshad.mohammad&quot;&gt;arshad.mohammad&lt;/a&gt;: the patch doesn&apos;t apply cleanly to 3.4, do you mind rebasing the patch for that branch? Thanks! (and, sorry for the delayed merge!)&lt;/p&gt;</comment>
                            <comment id="14995846" author="hudson" created="Sun, 8 Nov 2015 22:30:24 +0000"  >&lt;p&gt;FAILURE: Integrated in ZooKeeper-trunk #2811 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/2811/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/2811/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2211&quot; title=&quot;PurgeTxnLog does not correctly purge when snapshots and logs are at different locations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2211&quot;&gt;&lt;del&gt;ZOOKEEPER-2211&lt;/del&gt;&lt;/a&gt;: PurgeTxnLog does not correctly purge when snapshots and&lt;br/&gt;
logs are at different locations (Arshad Mohammad via rgs) (rgs: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1713296&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1713296&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;trunk/src/java/main/org/apache/zookeeper/server/PurgeTxnLog.java&lt;/li&gt;
	&lt;li&gt;trunk/src/java/test/org/apache/zookeeper/server/PurgeTxnTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14996646" author="arshad.mohammad" created="Mon, 9 Nov 2015 14:49:32 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rgs&quot; class=&quot;user-hover&quot; rel=&quot;rgs&quot;&gt;rgs&lt;/a&gt; for committing the patch. Submitted &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2211&quot; title=&quot;PurgeTxnLog does not correctly purge when snapshots and logs are at different locations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2211&quot;&gt;&lt;del&gt;ZOOKEEPER-2211&lt;/del&gt;&lt;/a&gt;-04_br_3_4.patch for branch-3.4.&lt;/p&gt;</comment>
                            <comment id="14996655" author="hadoopqa" created="Mon, 9 Nov 2015 14:52:26 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12771356/ZOOKEEPER-2211-04_br_3_4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12771356/ZOOKEEPER-2211-04_br_3_4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1713320.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2952//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2952//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15039727" author="rgs" created="Fri, 4 Dec 2015 04:20:38 +0000"  >&lt;p&gt;Merged for 3.4: &lt;a href=&quot;https://github.com/apache/zookeeper/commit/6bd4d67b8bda8bdb9f2ba168cf273c806f4c303b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/commit/6bd4d67b8bda8bdb9f2ba168cf273c806f4c303b&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arshad.mohammad&quot; class=&quot;user-hover&quot; rel=&quot;arshad.mohammad&quot;&gt;arshad.mohammad&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12753132" name="ZOOKEEPER-2211-02.patch" size="6409" author="arshad.mohammad" created="Sat, 29 Aug 2015 10:11:24 +0000"/>
                            <attachment id="12762442" name="ZOOKEEPER-2211-03.patch" size="7081" author="arshad.mohammad" created="Fri, 25 Sep 2015 19:56:40 +0000"/>
                            <attachment id="12764025" name="ZOOKEEPER-2211-04.patch" size="8513" author="arshad.mohammad" created="Mon, 28 Sep 2015 14:30:24 +0000"/>
                            <attachment id="12771356" name="ZOOKEEPER-2211-04_br_3_4.patch" size="8849" author="arshad.mohammad" created="Mon, 9 Nov 2015 14:46:59 +0000"/>
                            <attachment id="12738664" name="ZOOKEEPER-2211.patch" size="1528" author="wesc" created="Tue, 9 Jun 2015 21:07:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 50 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ful3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>