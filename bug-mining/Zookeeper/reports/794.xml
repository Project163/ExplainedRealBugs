<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:59:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[ZOOKEEPER-2574] PurgeTxnLog can inadvertently delete required txn log files</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-2574</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;As part of the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1797&quot; title=&quot;PurgeTxnLog may delete data logs during roll&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1797&quot;&gt;&lt;del&gt;ZOOKEEPER-1797&lt;/del&gt;&lt;/a&gt;, the call to FileTxnSnapLog.getSnapshotLogs() was removed from PurgeTxnLog.java.  As a result, some old-looking but required txn log files can be deleted, resulting in data corruption or loss.&lt;/p&gt;

&lt;p&gt;For example, consider the following:&lt;/p&gt;

&lt;p&gt;1. Configuration:&lt;br/&gt;
autopurge.snapRetainCount=3&lt;/p&gt;

&lt;p&gt;2. Following files exist:&lt;br/&gt;
log.100 spans transactions from zxid=100 till zxid=140 (inclusive)&lt;br/&gt;
snapshot.110 - snapshot as of zxid=110&lt;br/&gt;
snapshot.120 - snapshot as of zxid=120&lt;br/&gt;
snapshot.130 - snapshot as of zxid=130&lt;/p&gt;

&lt;p&gt;Above scenario is possible when snapshotting has happened multiple times but without accompanying log rollover, which is possible if the server was running as a learner.&lt;/p&gt;

&lt;p&gt;3. PurgeTxnLog retains all snapshots but deletes log.100 because its zxid is older than the zxid of the oldest snapshot (110).  This results in loss of transactions in the range 131-140.&lt;/p&gt;

&lt;p&gt;Before the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1797&quot; title=&quot;PurgeTxnLog may delete data logs during roll&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1797&quot;&gt;&lt;del&gt;ZOOKEEPER-1797&lt;/del&gt;&lt;/a&gt;, this was avoided by the call to FileTxnSnapLog.getSnapshotLogs() which finds and retains the newest txn log file with starting zxid &amp;lt; oldest retained snapshot&apos;s highest zxid.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Zookeeper 3.4.8, standalone, and 3-server quorum&lt;/p&gt;</environment>
        <key id="13003962">ZOOKEEPER-2574</key>
            <summary>PurgeTxnLog can inadvertently delete required txn log files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="abhishekrai">Abhishek Rai</assignee>
                                    <reporter username="abhishekrai">Abhishek Rai</reporter>
                        <labels>
                    </labels>
                <created>Fri, 9 Sep 2016 20:20:40 +0000</created>
                <updated>Wed, 15 Nov 2017 21:29:01 +0000</updated>
                            <resolved>Mon, 23 Jan 2017 01:31:22 +0000</resolved>
                                    <version>3.4.7</version>
                    <version>3.4.8</version>
                    <version>3.5.0</version>
                    <version>3.5.1</version>
                    <version>3.5.2</version>
                                    <fixVersion>3.4.10</fixVersion>
                    <fixVersion>3.5.3</fixVersion>
                    <fixVersion>3.6.0</fixVersion>
                                    <component>server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="15480684" author="phunt" created="Sun, 11 Sep 2016 00:09:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abhishekrai&quot; class=&quot;user-hover&quot; rel=&quot;abhishekrai&quot;&gt;abhishekrai&lt;/a&gt; I&apos;ve upped the priority to blocker. Any chance you could submit a test (or test and fix) that reproduces this issue? Thanks.&lt;/p&gt;</comment>
                            <comment id="15480686" author="phunt" created="Sun, 11 Sep 2016 00:10:01 +0000"  >&lt;p&gt;FYI &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=michim&quot; class=&quot;user-hover&quot; rel=&quot;michim&quot;&gt;michim&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;rakeshr&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15481124" author="abhishekrai" created="Sun, 11 Sep 2016 05:55:15 +0000"  >&lt;p&gt;Fix and unittest for &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2574&quot; title=&quot;PurgeTxnLog can inadvertently delete required txn log files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2574&quot;&gt;&lt;del&gt;ZOOKEEPER-2574&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15481129" author="abhishekrai" created="Sun, 11 Sep 2016 05:58:11 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=phunt&quot; class=&quot;user-hover&quot; rel=&quot;phunt&quot;&gt;phunt&lt;/a&gt;, I&apos;ve uploaded a fix and unittest.  Without the fix, the unittest fails in the assertion below, thanks.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;        /**
         * Verify that the last znode that was created above exists.  This znode&apos;s creation was
         * captured by the transaction log which was created before any of the above
         * SNAP_RETAIN_COUNT snapshots were created, but it&apos;s not captured in any of these
         * snapshots.  So for it it exist, the (only) existing log file should not have been purged.
         */
        final String lastZnode = &quot;/snap-&quot; + (unique - 1);
        final Stat stat = zk.exists(lastZnode, false);
        Assert.assertNotNull(&quot;Last znode does not exist: &quot; + lastZnode, stat);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15481132" author="hadoopqa" created="Sun, 11 Sep 2016 05:59:26 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12827917/ZOOKEEPER-2574.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12827917/ZOOKEEPER-2574.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1759917.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3408//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3408//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15481163" author="hadoopqa" created="Sun, 11 Sep 2016 06:21:00 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12827918/ZOOKEEPER-2574.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12827918/ZOOKEEPER-2574.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1759917.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    -1 javac.  The patch appears to cause tar ant target to fail.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3409//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3409//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3409//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3409//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3409//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3409//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15481188" author="abhishekrai" created="Sun, 11 Sep 2016 06:37:38 +0000"  >&lt;p&gt;Uploading patch for trunk, previous patch does not work on trunk (works on 3.4.8 and 3.5.2).&lt;/p&gt;</comment>
                            <comment id="15481196" author="hadoopqa" created="Sun, 11 Sep 2016 06:41:02 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12827920/ZOOKEEPER-2574.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12827920/ZOOKEEPER-2574.2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1759917.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    -1 javac.  The patch appears to cause tar ant target to fail.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3410//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3410//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3410//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3410//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3410//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3410//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15481246" author="hadoopqa" created="Sun, 11 Sep 2016 07:11:17 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12827921/ZOOKEEPER-2574.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12827921/ZOOKEEPER-2574.2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1759917.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3411//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3411//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3411//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3411//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3411//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3411//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15481700" author="arshad.mohammad" created="Sun, 11 Sep 2016 12:45:55 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abhishekrai&quot; class=&quot;user-hover&quot; rel=&quot;abhishekrai&quot;&gt;abhishekrai&lt;/a&gt; for working on this issue. &lt;br/&gt;
The solution looks good to me. I can see FileTxnLog.getLogFiles has the logic to retain highest transaction log which is less than the leastZxidToBeRetain. &lt;br/&gt;
Few comments&lt;br/&gt;
1) can we rename exclude to retainedTxnLogs or some thing similar. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Set&amp;lt;File&amp;gt; exclude = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashSet&amp;lt;File&amp;gt;();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;2) FileTxnSnapLog.getSnapshotLogs(long) javadoc does not have complete information.&lt;br/&gt;
can you update it to indicate that it also returns &quot;one snapshot log which is highest but less than the given zxid&quot;&lt;/p&gt;</comment>
                            <comment id="15482106" author="abhishekrai" created="Sun, 11 Sep 2016 17:26:02 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arshad.mohammad&quot; class=&quot;user-hover&quot; rel=&quot;arshad.mohammad&quot;&gt;arshad.mohammad&lt;/a&gt; for the review.  I&apos;ve applied your suggestions and uploaded the latest patch.&lt;/p&gt;

&lt;p&gt;Also, I noticed that on Hadoop QA, a test is failing (org.apache.zookeeper.test.QuorumTest) but I cannot reproduce this failure locally and it also seems unrelated.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="15482129" author="hadoopqa" created="Sun, 11 Sep 2016 17:46:23 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12827931/ZOOKEEPER-2574.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12827931/ZOOKEEPER-2574.3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1759917.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3414//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3414//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3414//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3414//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3414//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3414//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15482179" author="arshad.mohammad" created="Sun, 11 Sep 2016 18:15:35 +0000"  >&lt;p&gt;Latest patch LGTM +1(non-binding)&lt;/p&gt;</comment>
                            <comment id="15483048" author="rakeshr" created="Mon, 12 Sep 2016 04:39:04 +0000"  >&lt;p&gt;Good catch, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abhishekrai&quot; class=&quot;user-hover&quot; rel=&quot;abhishekrai&quot;&gt;abhishekrai&lt;/a&gt;. Thanks for the proposed patch with good unit testing.&lt;/p&gt;

&lt;p&gt;I agree the following scenario will occur in learner side, where snapshotting has happened multiple times without accompanying log rollover, &lt;a href=&quot;https://github.com/apache/zookeeper/blob/branch-3.4/src/java/main/org/apache/zookeeper/server/quorum/Learner.java#L439&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;refer source code&lt;/a&gt;. I think there is mismatch in the zookeeper documentation, it says &quot;This snapshot supercedes all previous logs&quot;, &lt;a href=&quot;https://zookeeper.apache.org/doc/r3.4.9/zookeeperAdmin.html#Ongoing+Data+Directory+Cleanup&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;please refer zk doc&lt;/a&gt;. But in this particular case the latest transactions after snapshotting is gong to the existing transaction log file, which is behind if we look at the naming(zxid part). I&apos;m not sure whether this is intentionally implemented?. Again, iiuc, recovery will use a snapshot file + delta taken from the transaction log file name after snapshotted zxid, but in this case admins need to consider the log file just before, the snapshot file. Should we need to make the snapshot file and log file consistent to avoid any corner cases in future?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=phunt&quot; class=&quot;user-hover&quot; rel=&quot;phunt&quot;&gt;phunt&lt;/a&gt;, any thoughts?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2. Following files exist:
log.100 spans transactions from zxid=100 till zxid=140 (inclusive)
snapshot.110 - snapshot as of zxid=110
snapshot.120 - snapshot as of zxid=120
snapshot.130 - snapshot as of zxid=130
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="15483721" author="abhishekrai" created="Mon, 12 Sep 2016 10:12:20 +0000"  >&lt;p&gt;Thanks for the references &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;rakeshr&lt;/a&gt;.  The learner writes the snapshot in response to the NEWLEADER message received from the leader.  Based on my understanding, this is because the leader could be ahead of the learner - meaning that the learner is missing some transactions that the leader has.  So receiving a snapshot and committing it locally is a valid option for the learner to catch up and join the quorum.  However, going forward it will receive subsequent transactions, which as you mentioned get appended to the existing txn log file.  It seems a log rollover could have been done before snapshotting in the learner, but perhaps changing behaviors at this point is not worth it given the need to support old behavior too?&lt;/p&gt;</comment>
                            <comment id="15486135" author="hadoopqa" created="Tue, 13 Sep 2016 03:41:46 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12827931/ZOOKEEPER-2574.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12827931/ZOOKEEPER-2574.3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision b2a484cfe743116d2531fe5d1e1d78b3960c511e.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3422//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3422//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3422//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3422//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3422//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3422//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15494661" author="abrahamfine" created="Thu, 15 Sep 2016 22:09:34 +0000"  >&lt;p&gt;A couple minor questions:&lt;/p&gt;

&lt;p&gt;PurgeTxnTest.java:224 Can we change  ArrayList&amp;lt;File&amp;gt; logsToPurge back to  List&amp;lt;File&amp;gt; logsToPurge?&lt;/p&gt;

&lt;p&gt;PurgeTxnLog.java:138 Do we need to use the FileFilter here since we do &quot;filtering&quot; on line 142?&lt;/p&gt;

&lt;p&gt;PurgeTxnLog.java:148 We do logging and System.out.println for the same String, do we need both?&lt;/p&gt;</comment>
                            <comment id="15501416" author="abhishekrai" created="Sun, 18 Sep 2016 18:24:15 +0000"  >&lt;p&gt;Thanks for the review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abrahamfine&quot; class=&quot;user-hover&quot; rel=&quot;abrahamfine&quot;&gt;abrahamfine&lt;/a&gt;.  I&apos;ve applied your comments and uploaded a new patch set, please take another look.&lt;/p&gt;

&lt;p&gt;&amp;gt; PurgeTxnTest.java:224 Can we change ArrayList&amp;lt;File&amp;gt; logsToPurge back to List&amp;lt;File&amp;gt; logsToPurge?&lt;br/&gt;
I switched logsToPurge from a List&amp;lt;File&amp;gt; to an ArrayList&amp;lt;File&amp;gt; so I can simply use remove(0) to remove the first element in the list on line 239.  However, as you pointed out, this is probably not obvious given that all other lists around it are List&amp;lt;File&amp;gt;, so I&apos;ve added a comment explaining the choice.&lt;/p&gt;

&lt;p&gt;&amp;gt; PurgeTxnLog.java:138 Do we need to use the FileFilter here since we do &quot;filtering&quot; on line 142?&lt;br/&gt;
Both filtering are required.  The FileFilter used in lines 134-138 are useful for listing all snapshot and log files with zxid &amp;gt;= leastZxidToBeRetain.  The check on 142 is to skip deletion of the newest log file that comes before the oldest retained snapshot.  However, I agree that the logic would be simpler if all filtering logic is in one place, in MyFileFilter.accept().  I&apos;ve moved it there now.&lt;/p&gt;

&lt;p&gt;&amp;gt; PurgeTxnLog.java:148 We do logging and System.out.println for the same String, do we need both?&lt;/p&gt;

&lt;p&gt;My goal here was to capture the output in the log file generated by the ant test run.  System.out.println wasn&apos;t useful in this context.  However, I needed to retain System.out.println cause PurgeTxnLog can also be invoked interactively from a console.  Is there a way to achieve both goals, logging and console output (preferably stdout) without any duplication.&lt;/p&gt;</comment>
                            <comment id="15501456" author="hadoopqa" created="Sun, 18 Sep 2016 18:46:13 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12829119/ZOOKEEPER-2574.4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12829119/ZOOKEEPER-2574.4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision b2a484cfe743116d2531fe5d1e1d78b3960c511e.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3441//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3441//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3441//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3441//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3441//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3441//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15504796" author="abrahamfine" created="Mon, 19 Sep 2016 21:52:11 +0000"  >&lt;p&gt;&amp;gt; I switched logsToPurge from a List&amp;lt;File&amp;gt; to an ArrayList&amp;lt;File&amp;gt; so I can simply use remove(0) to remove the first element in the list on line 239&lt;br/&gt;
I think I must be missing something as all of the lists are ArrayLists.  For example, this still passes:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        List&amp;lt;File&amp;gt; snapsToPurge = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;File&amp;gt;();
        List&amp;lt;File&amp;gt; snaps = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;File&amp;gt;();
        List&amp;lt;File&amp;gt; logs = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;File&amp;gt;();
        List&amp;lt;File&amp;gt; snapsAboveRecentFiles = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;File&amp;gt;();
        List&amp;lt;File&amp;gt; logsAboveRecentFiles = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;File&amp;gt;();
        List&amp;lt;File&amp;gt; logsToPurge = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;File&amp;gt;();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&amp;gt; However, I agree that the logic would be simpler if all filtering logic is in one place, in MyFileFilter.accept(). I&apos;ve moved it there now.&lt;br/&gt;
Agreed&lt;/p&gt;

&lt;p&gt;&amp;gt; Is there a way to achieve both goals, logging and console output (preferably stdout) without any duplication.&lt;br/&gt;
I&apos;m not sure, perhaps system.err?&lt;/p&gt;
</comment>
                            <comment id="15504902" author="abhishekrai" created="Mon, 19 Sep 2016 22:34:11 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abrahamfine&quot; class=&quot;user-hover&quot; rel=&quot;abrahamfine&quot;&gt;abrahamfine&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&amp;gt;&amp;gt; I switched logsToPurge from a List&amp;lt;File&amp;gt; to an ArrayList&amp;lt;File&amp;gt; so I can simply use remove(0) to remove the first element in the list on line 239&lt;br/&gt;
&amp;gt; I think I must be missing something as all of the lists are ArrayLists. For example, this still passes:&lt;/p&gt;

&lt;p&gt;Sorry I was confused about something, fixed the usage of logsToPurge as you suggested, thanks for persisting.&lt;/p&gt;

&lt;p&gt;&amp;gt;&amp;gt; Is there a way to achieve both goals, logging and console output (preferably stdout) without any duplication.&lt;br/&gt;
&amp;gt; I&apos;m not sure, perhaps system.err?&lt;/p&gt;

&lt;p&gt;I tried System.err.println, but then this output comes at the end of the test log under &quot;stderr&quot; section.  It may have limited utility in debugging since it&apos;s not inline with other related logging.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="15505152" author="hadoopqa" created="Tue, 20 Sep 2016 00:33:57 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12829284/ZOOKEEPER-2574.5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12829284/ZOOKEEPER-2574.5.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision ec20c5434cc8a334b3fd25e27d26dccf4793c8f3.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3443//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3443//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3443//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3443//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3443//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3443//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15568287" author="rakeshr" created="Wed, 12 Oct 2016 10:07:12 +0000"  >&lt;p&gt;Should we update the &lt;a href=&quot;https://zookeeper.apache.org/doc/r3.4.9/zookeeperAdmin.html#Ongoing+Data+Directory+Cleanup&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;zk docs&lt;/a&gt; part, &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;As changes are made to the znodes these changes are appended to a transaction log, occasionally, when a log grows large, a snapshot of the current state of all znodes will be written to the filesystem. This snapshot supercedes all previous logs&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; It looks like conveying wrong behavior, right?&lt;/p&gt;</comment>
                            <comment id="15570246" author="abhishekrai" created="Wed, 12 Oct 2016 23:44:38 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;rakeshr&lt;/a&gt;.  I&apos;ve updated the doc now, please take another look.  Thanks&lt;/p&gt;</comment>
                            <comment id="15570304" author="hadoopqa" created="Thu, 13 Oct 2016 00:04:38 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12833002/ZOOKEEPER-2574.6.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12833002/ZOOKEEPER-2574.6.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision f78061aafb19b102c37cb6d744ec6258d5f5b66e.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3488//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3488//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3488//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3488//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3488//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3488//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15643171" author="rakeshr" created="Mon, 7 Nov 2016 05:29:43 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abhishekrai&quot; class=&quot;user-hover&quot; rel=&quot;abhishekrai&quot;&gt;abhishekrai&lt;/a&gt;. I could see there are few more corrections required in the &lt;a href=&quot;https://zookeeper.apache.org/doc/r3.4.9/zookeeperAdmin.html#The+Log+Directory&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;zookeeperAdmin.html#The+Log+Directory&lt;/a&gt;, right?. I&apos;d suggest you to read the &lt;tt&gt;ZooKeeper transaction log and snapshot&lt;/tt&gt; related sections in the ZK docs and do necessary changes. Appreciate your time &amp;amp; efforts.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;The Log Directory:

A &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; log file is started each time a snapshot is begun. The log file&apos;s suffix is the first zxid written to that log
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Could you please create a pull request for the proposed patch, that will be used for code reviews and commits.&lt;/p&gt;

&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;fpj&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=phunt&quot; class=&quot;user-hover&quot; rel=&quot;phunt&quot;&gt;phunt&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rgs&quot; class=&quot;user-hover&quot; rel=&quot;rgs&quot;&gt;rgs&lt;/a&gt;. As part of this jira we have came across a situation &lt;tt&gt;&quot;where snapshotting has happened multiple times without accompanying log rollover&quot;&lt;/tt&gt;, this is contradicting with the ZooKeeper docs. I think, this would be a serious concern in the view of disaster recovery scripts. If someone has written a script blindly following that &quot;A new log file is started each time a snapshot is begun&quot;. It would be really helpful if you could pitch in and give your thoughts on this problem. Thanks!&lt;/p&gt;</comment>
                            <comment id="15655700" author="hanm" created="Fri, 11 Nov 2016 00:52:53 +0000"  >&lt;p&gt;This JIRA sounds like a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2420&quot; title=&quot;Autopurge deletes log file prior to oldest retained snapshot even though restore may need it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2420&quot;&gt;&lt;del&gt;ZOOKEEPER-2420&lt;/del&gt;&lt;/a&gt;. &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abhishekrai&quot; class=&quot;user-hover&quot; rel=&quot;abhishekrai&quot;&gt;abhishekrai&lt;/a&gt;: Could you please take a look at &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2420&quot; title=&quot;Autopurge deletes log file prior to oldest retained snapshot even though restore may need it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2420&quot;&gt;&lt;del&gt;ZOOKEEPER-2420&lt;/del&gt;&lt;/a&gt; and confirm if it&apos;s solving the same problem as this JIRA? If so, we probably should remove this issue from release blockers as the consensus so far in &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2420&quot; title=&quot;Autopurge deletes log file prior to oldest retained snapshot even though restore may need it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2420&quot;&gt;&lt;del&gt;ZOOKEEPER-2420&lt;/del&gt;&lt;/a&gt; is that the issue is better to be fixed but we will be fine live with it for a while, given no real issues being reported from prod (with reasons stated in &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2420&quot; title=&quot;Autopurge deletes log file prior to oldest retained snapshot even though restore may need it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2420&quot;&gt;&lt;del&gt;ZOOKEEPER-2420&lt;/del&gt;&lt;/a&gt;) so far.&lt;/p&gt;</comment>
                            <comment id="15662873" author="rakeshr" created="Mon, 14 Nov 2016 06:03:03 +0000"  >&lt;p&gt;Good catch &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hanm&quot; class=&quot;user-hover&quot; rel=&quot;hanm&quot;&gt;hanm&lt;/a&gt;. Yes, both are addressing same problem. Thanks a lot &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=EdRowe&quot; class=&quot;user-hover&quot; rel=&quot;EdRowe&quot;&gt;EdRowe&lt;/a&gt; for the good number of unit test cases in your patch and working on this major issue. &lt;/p&gt;

&lt;p&gt;After looking at &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2420&quot; title=&quot;Autopurge deletes log file prior to oldest retained snapshot even though restore may need it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2420&quot;&gt;&lt;del&gt;ZOOKEEPER-2420&lt;/del&gt;&lt;/a&gt; patch, it looks to me that the proposed fix in &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2574&quot; title=&quot;PurgeTxnLog can inadvertently delete required txn log files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2574&quot;&gt;&lt;del&gt;ZOOKEEPER-2574&lt;/del&gt;&lt;/a&gt; jira is simple and with less code complexity. Just a suggestion from me, we could club these two patches together to make a good solution. (1) Merge the test cases and (2) FileSnap#findNRecentSnapshots() changes from &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2420&quot; title=&quot;Autopurge deletes log file prior to oldest retained snapshot even though restore may need it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2420&quot;&gt;&lt;del&gt;ZOOKEEPER-2420&lt;/del&gt;&lt;/a&gt; patch to this jira proposal patch. Does this makes sense to you?&lt;/p&gt;

&lt;p&gt;Also, I&apos;d like to re-iterate some of the discussions regarding ZK docs made earlier in this jira &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2574?focusedCommentId=15483048&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15483048&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;comment1&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2574?focusedCommentId=15643171&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15643171&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;comment2&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15668505" author="hanm" created="Tue, 15 Nov 2016 21:54:02 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;rakeshr&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;we could club these two patches together to make a good solution.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Sounds good! Also, a late LGTM on the patch attached to this JIRA after incorporating tests from &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2420&quot; title=&quot;Autopurge deletes log file prior to oldest retained snapshot even though restore may need it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2420&quot;&gt;&lt;del&gt;ZOOKEEPER-2420&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I think, this would be a serious concern in the view of disaster recovery scripts. If someone has written a script blindly following that &quot;A new log file is started each time a snapshot is begun&quot;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Would the doc fix proposed in this patch address this concern? With the new doc it is clearly stated that the prior one transaction log should be retained / required.&lt;/p&gt;</comment>
                            <comment id="15668508" author="hanm" created="Tue, 15 Nov 2016 21:55:23 +0000"  >&lt;p&gt;I am also changing priority of this from Blocker to Major per discussions in &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2420&quot; title=&quot;Autopurge deletes log file prior to oldest retained snapshot even though restore may need it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2420&quot;&gt;&lt;del&gt;ZOOKEEPER-2420&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15675807" author="rakeshr" created="Fri, 18 Nov 2016 05:16:51 +0000"  >&lt;p&gt;How about keeping only one jira open and close the other one. That way, we will try to converge the discussions into one place. I&apos;m OK to close any one of these two jira issues&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Could you please look at &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2574?focusedCommentId=15662873&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15662873&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;my previous comment&lt;/a&gt; and do necessary src &amp;amp; test code merge from ZK-2420. Appreciate creating a pull request for the same. Thanks!&lt;/p&gt;</comment>
                            <comment id="15675825" author="rakeshr" created="Fri, 18 Nov 2016 05:24:47 +0000"  >&lt;p&gt;Yes, I&apos;ve identified few occurrences in the doc. One more &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2574?focusedCommentId=15643171&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15643171&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;comment&lt;/a&gt; is open and has to be fixed. Probably, we could do more detailed reviews and all such cases has to be re-phrased as there was a behavioral change due to the &lt;a href=&quot;https://github.com/apache/zookeeper/blob/branch-3.4/src/java/main/org/apache/zookeeper/server/quorum/Learner.java#L439&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Learner snapshotting logic&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15679478" author="githubbot" created="Sat, 19 Nov 2016 16:04:33 +0000"  >&lt;p&gt;GitHub user abhishekrai opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/111&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/111&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2574&quot; title=&quot;PurgeTxnLog can inadvertently delete required txn log files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2574&quot;&gt;&lt;del&gt;ZOOKEEPER-2574&lt;/del&gt;&lt;/a&gt;: PurgeTxnLog can inadvertently delete required txn log files&lt;/p&gt;

&lt;p&gt;    &#8230; files&lt;/p&gt;

&lt;p&gt;    This fix includes patch from Ed Rowe for &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2420&quot; title=&quot;Autopurge deletes log file prior to oldest retained snapshot even though restore may need it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2420&quot;&gt;&lt;del&gt;ZOOKEEPER-2420&lt;/del&gt;&lt;/a&gt;, which is the same&lt;br/&gt;
    issue as &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2574&quot; title=&quot;PurgeTxnLog can inadvertently delete required txn log files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2574&quot;&gt;&lt;del&gt;ZOOKEEPER-2574&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/abhishekrai/zookeeper&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/abhishekrai/zookeeper&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2574&quot; title=&quot;PurgeTxnLog can inadvertently delete required txn log files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2574&quot;&gt;&lt;del&gt;ZOOKEEPER-2574&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/111.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/111.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #111&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 4bc4a77800c25ab5bcdaf1149c28b1912d29064f&lt;br/&gt;
Author: Abhishek Rai &amp;lt;abhishek@thoughtspot.com&amp;gt;&lt;br/&gt;
Date:   2016-11-18T18:42:51Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2574&quot; title=&quot;PurgeTxnLog can inadvertently delete required txn log files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2574&quot;&gt;&lt;del&gt;ZOOKEEPER-2574&lt;/del&gt;&lt;/a&gt;: PurgeTxnLog can inadvertently delete required txn log files&lt;/p&gt;

&lt;p&gt;    This fix includes patch from Ed Rowe for &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2420&quot; title=&quot;Autopurge deletes log file prior to oldest retained snapshot even though restore may need it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2420&quot;&gt;&lt;del&gt;ZOOKEEPER-2420&lt;/del&gt;&lt;/a&gt;, which is the same&lt;br/&gt;
    issue as &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2574&quot; title=&quot;PurgeTxnLog can inadvertently delete required txn log files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2574&quot;&gt;&lt;del&gt;ZOOKEEPER-2574&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15679486" author="abhishekrai" created="Sat, 19 Nov 2016 16:08:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hanm&quot; class=&quot;user-hover&quot; rel=&quot;hanm&quot;&gt;hanm&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;rakeshr&lt;/a&gt;, thanks for finding the relation to &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2420&quot; title=&quot;Autopurge deletes log file prior to oldest retained snapshot even though restore may need it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2420&quot;&gt;&lt;del&gt;ZOOKEEPER-2420&lt;/del&gt;&lt;/a&gt; and thanks for your guidance.&lt;/p&gt;

&lt;p&gt;I&apos;ve created a pull request as per your suggestion with the following changes:&lt;br/&gt;
(1) Patch previously uploaded containing fix and tests.&lt;br/&gt;
(2) Tests from &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2420&quot; title=&quot;Autopurge deletes log file prior to oldest retained snapshot even though restore may need it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2420&quot;&gt;&lt;del&gt;ZOOKEEPER-2420&lt;/del&gt;&lt;/a&gt; and enabling code.&lt;br/&gt;
(3) Documentation fixes.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;rakeshr&lt;/a&gt; great call on documentation review, as I went through it I found multiple inconsistencies about the snapshot-log dependency.  I&apos;ve fixed all that I could find in the docs/ directory.&lt;/p&gt;</comment>
                            <comment id="15679498" author="hadoopqa" created="Sat, 19 Nov 2016 16:17:47 +0000"  >&lt;p&gt;-1 overall.  GitHub Pull Request  Build&lt;/p&gt;


&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 20 new Findbugs (version 3.0.1) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/82//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/82//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/82//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/82//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/82//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/82//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15701053" author="githubbot" created="Mon, 28 Nov 2016 06:12:58 +0000"  >&lt;p&gt;Github user lvfangmin commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/111&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/111&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    minor comments, others look good to me.&lt;/p&gt;</comment>
                            <comment id="15701054" author="githubbot" created="Mon, 28 Nov 2016 06:13:09 +0000"  >&lt;p&gt;Github user lvfangmin commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/111#discussion_r89722055&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/111#discussion_r89722055&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/PurgeTxnLog.java &amp;#8212;&lt;br/&gt;
    @@ -108,9 +141,11 @@ public boolean accept(File f){&lt;br/&gt;
             // remove the old files&lt;br/&gt;
             for(File f: files)&lt;br/&gt;
             {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;System.out.println(&quot;Removing file: &quot;+&lt;br/&gt;
    +            final String msg = &quot;Removing file: &quot;+&lt;br/&gt;
                     DateFormat.getDateTimeInstance().format(f.lastModified())+&lt;/li&gt;
	&lt;li&gt;&quot;\t&quot;+f.getPath());&lt;br/&gt;
    +                &quot;\t&quot;+f.getPath();&lt;br/&gt;
    +            LOG.info(msg);&lt;br/&gt;
    +            System.out.println(msg);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    do we need to keep both system.out and log4j logging? &lt;/p&gt;</comment>
                            <comment id="15701055" author="githubbot" created="Mon, 28 Nov 2016 06:13:09 +0000"  >&lt;p&gt;Github user lvfangmin commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/111#discussion_r89721901&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/111#discussion_r89721901&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: docs/zookeeperAdmin.html &amp;#8212;&lt;br/&gt;
    @@ -1201,8 +1205,10 @@ &amp;lt;h3 class=&quot;h4&quot;&amp;gt;Configuration Parameters&amp;lt;/h3&amp;gt;&lt;br/&gt;
     &amp;lt;p&amp;gt;(Java system property: &amp;lt;strong&amp;gt;zookeeper.snapCount&amp;lt;/strong&amp;gt;)&amp;lt;/p&amp;gt;&lt;br/&gt;
     &amp;lt;p&amp;gt;ZooKeeper logs transactions to a transaction&lt;br/&gt;
                   log. After snapCount transactions are written to a log&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;file a snapshot is started and a new transaction log&lt;/li&gt;
	&lt;li&gt;file is created. The default snapCount is&lt;br/&gt;
    +              file a snapshot is started. It also influences rollover&lt;br/&gt;
    +			  of the current transaction log to a new file. However,
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    keep indention?&lt;/p&gt;</comment>
                            <comment id="15745007" author="githubbot" created="Tue, 13 Dec 2016 12:15:56 +0000"  >&lt;p&gt;Github user abhishekrai commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/111#discussion_r92156748&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/111#discussion_r92156748&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: docs/zookeeperAdmin.html &amp;#8212;&lt;br/&gt;
    @@ -1201,8 +1205,10 @@ &amp;lt;h3 class=&quot;h4&quot;&amp;gt;Configuration Parameters&amp;lt;/h3&amp;gt;&lt;br/&gt;
     &amp;lt;p&amp;gt;(Java system property: &amp;lt;strong&amp;gt;zookeeper.snapCount&amp;lt;/strong&amp;gt;)&amp;lt;/p&amp;gt;&lt;br/&gt;
     &amp;lt;p&amp;gt;ZooKeeper logs transactions to a transaction&lt;br/&gt;
                   log. After snapCount transactions are written to a log&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;file a snapshot is started and a new transaction log&lt;/li&gt;
	&lt;li&gt;file is created. The default snapCount is&lt;br/&gt;
    +              file a snapshot is started. It also influences rollover&lt;br/&gt;
    +			  of the current transaction log to a new file. However,
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Done, thanks.&lt;/p&gt;</comment>
                            <comment id="15745011" author="githubbot" created="Tue, 13 Dec 2016 12:17:41 +0000"  >&lt;p&gt;Github user abhishekrai commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/111#discussion_r92156972&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/111#discussion_r92156972&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/PurgeTxnLog.java &amp;#8212;&lt;br/&gt;
    @@ -108,9 +141,11 @@ public boolean accept(File f){&lt;br/&gt;
             // remove the old files&lt;br/&gt;
             for(File f: files)&lt;br/&gt;
             {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;System.out.println(&quot;Removing file: &quot;+&lt;br/&gt;
    +            final String msg = &quot;Removing file: &quot;+&lt;br/&gt;
                     DateFormat.getDateTimeInstance().format(f.lastModified())+&lt;/li&gt;
	&lt;li&gt;&quot;\t&quot;+f.getPath());&lt;br/&gt;
    +                &quot;\t&quot;+f.getPath();&lt;br/&gt;
    +            LOG.info(msg);&lt;br/&gt;
    +            System.out.println(msg);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    It&apos;s not ideal but they both serve a purpose that the other cannot as far as I can tell.&lt;/p&gt;

&lt;p&gt;    System.out.println is useful when this is invoked directly through CLI.  The old behavior was to provide just this.&lt;br/&gt;
    LOG.info is useful in that it&apos;s visible in the server log.  The old behavior did not log this info which makes debugging through server logs harder.&lt;/p&gt;</comment>
                            <comment id="15745012" author="githubbot" created="Tue, 13 Dec 2016 12:18:25 +0000"  >&lt;p&gt;Github user abhishekrai commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/111&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/111&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for the review, I&apos;ve updated the commit.&lt;/p&gt;</comment>
                            <comment id="15745037" author="hadoopqa" created="Tue, 13 Dec 2016 12:30:16 +0000"  >&lt;p&gt;-1 overall.  GitHub Pull Request  Build&lt;/p&gt;


&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/113//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/113//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/113//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/113//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/113//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/113//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15833782" author="githubbot" created="Mon, 23 Jan 2017 01:14:04 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/111&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/111&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15833791" author="hadoopqa" created="Mon, 23 Jan 2017 01:29:56 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12833002/ZOOKEEPER-2574.6.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12833002/ZOOKEEPER-2574.6.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 762f4af65bb1056a582a6f36183a9e28fe0ccab8.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3565//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3565//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15833792" author="githubbot" created="Mon, 23 Jan 2017 01:30:00 +0000"  >&lt;p&gt;Github user hanm commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/111&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/111&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Merged to 3.4, 3.5, and master. Thanks for your contribution @abhishekrai !&lt;/p&gt;</comment>
                            <comment id="15833793" author="hanm" created="Mon, 23 Jan 2017 01:31:22 +0000"  >&lt;p&gt;Resolving JIRA manually as Fixed, because there was a merge conflict in branch-3.4 while using merge script commit flow.&lt;/p&gt;</comment>
                            <comment id="15833799" author="hudson" created="Mon, 23 Jan 2017 01:45:01 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build ZooKeeper-trunk #3247 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/3247/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/3247/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2574&quot; title=&quot;PurgeTxnLog can inadvertently delete required txn log files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2574&quot;&gt;&lt;del&gt;ZOOKEEPER-2574&lt;/del&gt;&lt;/a&gt;: PurgeTxnLog can inadvertently delete required txn log (hanm: rev 762f4af65bb1056a582a6f36183a9e28fe0ccab8)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/server/persistence/FileSnap.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/server/PurgeTxnLog.java&lt;/li&gt;
	&lt;li&gt;(edit) docs/zookeeperAdmin.html&lt;/li&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/server/persistence/FileTxnSnapLog.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/test/org/apache/zookeeper/server/PurgeTxnTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15833883" author="githubbot" created="Mon, 23 Jan 2017 04:18:30 +0000"  >&lt;p&gt;Github user abhishekrai commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/111&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/111&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks @hanm!&lt;/p&gt;</comment>
                            <comment id="15859266" author="arshad.mohammad" created="Thu, 9 Feb 2017 09:45:51 +0000"  >&lt;p&gt;Document changes are done in generated html, docs/zookeeperAdmin.html. When the document is generated again these changes will be overridden. &lt;br/&gt;
Changes should have been done in src/docs/src/documentation/content/xdocs/zookeeperAdmin.xml.&lt;br/&gt;
May be we can raise new jira an port the changes&lt;/p&gt;</comment>
                            <comment id="15860051" author="hanm" created="Thu, 9 Feb 2017 19:36:41 +0000"  >&lt;p&gt;Good catch &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arshad.mohammad&quot; class=&quot;user-hover&quot; rel=&quot;arshad.mohammad&quot;&gt;arshad.mohammad&lt;/a&gt; - created &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2690&quot; title=&quot;Update documentation source for ZOOKEEPER-2574&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2690&quot;&gt;&lt;del&gt;ZOOKEEPER-2690&lt;/del&gt;&lt;/a&gt; to track the work. Obviously I missed this during review. Mark it as minor priority because the doc change was cosmetic.&lt;/p&gt;</comment>
                            <comment id="16218935" author="hadoopqa" created="Wed, 25 Oct 2017 15:50:27 +0000"  >&lt;p&gt;-1 overall.  GitHub Pull Request  Build&lt;/p&gt;


&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +0 tests included.  The patch appears to be a documentation patch that doesn&apos;t require tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1119//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1119//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1119//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1119//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1119//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1119//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16254228" author="hudson" created="Wed, 15 Nov 2017 21:29:01 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build ZooKeeper-trunk #3609 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/3609/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/3609/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2690&quot; title=&quot;Update documentation source for ZOOKEEPER-2574&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2690&quot;&gt;&lt;del&gt;ZOOKEEPER-2690&lt;/del&gt;&lt;/a&gt;: Update documentation source for &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2574&quot; title=&quot;PurgeTxnLog can inadvertently delete required txn log files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2574&quot;&gt;&lt;del&gt;ZOOKEEPER-2574&lt;/del&gt;&lt;/a&gt; (phunt: rev efeebd0a1ba7f6be3b4ffe262ab4045656bb1eb3)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) docs/index.pdf&lt;/li&gt;
	&lt;li&gt;(edit) docs/zookeeperOver.pdf&lt;/li&gt;
	&lt;li&gt;(edit) docs/zookeeperStarted.pdf&lt;/li&gt;
	&lt;li&gt;(edit) docs/linkmap.pdf&lt;/li&gt;
	&lt;li&gt;(edit) docs/zookeeperJMX.pdf&lt;/li&gt;
	&lt;li&gt;(edit) docs/zookeeperHierarchicalQuorums.pdf&lt;/li&gt;
	&lt;li&gt;(edit) src/docs/src/documentation/content/xdocs/zookeeperAdmin.xml&lt;/li&gt;
	&lt;li&gt;(edit) docs/javaExample.pdf&lt;/li&gt;
	&lt;li&gt;(edit) docs/zookeeperProgrammers.pdf&lt;/li&gt;
	&lt;li&gt;(edit) docs/zookeeperTutorial.pdf&lt;/li&gt;
	&lt;li&gt;(edit) docs/zookeeperObservers.pdf&lt;/li&gt;
	&lt;li&gt;(edit) docs/zookeeperAdmin.html&lt;/li&gt;
	&lt;li&gt;(edit) docs/zookeeperReconfig.pdf&lt;/li&gt;
	&lt;li&gt;(edit) docs/zookeeperInternals.pdf&lt;/li&gt;
	&lt;li&gt;(edit) docs/zookeeperQuotas.pdf&lt;/li&gt;
	&lt;li&gt;(edit) docs/recipes.pdf&lt;/li&gt;
	&lt;li&gt;(edit) docs/zookeeperAdmin.pdf&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12964204">ZOOKEEPER-2420</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13036947">ZOOKEEPER-2671</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12674567">ZOOKEEPER-1797</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12827921" name="ZOOKEEPER-2574.2.patch" size="10489" author="abhishekrai" created="Sun, 11 Sep 2016 06:43:28 +0000"/>
                            <attachment id="12827931" name="ZOOKEEPER-2574.3.patch" size="11375" author="abhishekrai" created="Sun, 11 Sep 2016 17:26:01 +0000"/>
                            <attachment id="12829119" name="ZOOKEEPER-2574.4.patch" size="12985" author="abhishekrai" created="Sun, 18 Sep 2016 18:24:15 +0000"/>
                            <attachment id="12829284" name="ZOOKEEPER-2574.5.patch" size="11397" author="abhishekrai" created="Mon, 19 Sep 2016 22:34:11 +0000"/>
                            <attachment id="12833002" name="ZOOKEEPER-2574.6.patch" size="12602" author="abhishekrai" created="Wed, 12 Oct 2016 23:44:38 +0000"/>
                            <attachment id="12827918" name="ZOOKEEPER-2574.patch" size="10896" author="abhishekrai" created="Sun, 11 Sep 2016 06:12:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33glz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>