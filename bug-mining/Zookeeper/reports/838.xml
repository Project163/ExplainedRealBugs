<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:00:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[ZOOKEEPER-2836] QuorumCnxManager.Listener Thread Better handling of SocketTimeoutException</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-2836</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;QuorumCnxManager Listener thread blocks SocketServer on accept but we are getting SocketTimeoutException  on our boxes after 49days 17 hours . As per current code there is a 3 times retry and after that it says &quot;&lt;em&gt;As I&apos;m leaving the listener thread, I won&apos;t be able to participate in leader election any longer: $&amp;lt;hostname&amp;gt;/$&amp;lt;ip&amp;gt;:3888&lt;/em&gt;_&quot; , Once server nodes reache this state and we restart or add a new node ,it fails to join cluster and logs &apos;WARN  QuorumPeer&amp;lt;myid=1&amp;gt;/0:0:0:0:0:0:0:0:2181:QuorumCnxManager@383 - Cannot open channel to 3 at election address $&amp;lt;hostname&amp;gt;/$&amp;lt;ip&amp;gt;:3888&apos; .&lt;/p&gt;


&lt;p&gt;        As there is no timeout specified for ServerSocket it should never timeout but there are some already discussed issues where people have seen this issue and added checks for SocketTimeoutException explicitly like &lt;a href=&quot;https://issues.apache.org/jira/browse/KARAF-3325&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KARAF-3325&lt;/a&gt; . &lt;/p&gt;

&lt;p&gt;        I think we need to handle SocketTimeoutException on similar lines for zookeeper as well &lt;/p&gt;</description>
                <environment>&lt;p&gt;Machine: Linux 3.2.0-4-amd64 #1 SMP Debian 3.2.78-1 x86_64 GNU/Linux&lt;br/&gt;
Java Version: jdk64/jdk1.8.0_40&lt;br/&gt;
zookeeper version:  3.4.6.2.3.2.0-2950 &lt;/p&gt;</environment>
        <key id="13084519">ZOOKEEPER-2836</key>
            <summary>QuorumCnxManager.Listener Thread Better handling of SocketTimeoutException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gaoshu">gaoshu</assignee>
                                    <reporter username="amarjeet_singh">Amarjeet Singh</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 4 Jul 2017 11:50:53 +0000</created>
                <updated>Sun, 28 Mar 2021 08:54:27 +0000</updated>
                            <resolved>Tue, 31 Mar 2020 10:28:24 +0000</resolved>
                                    <version>3.4.6</version>
                                    <fixVersion>3.7.0</fixVersion>
                                    <component>leaderElection</component>
                    <component>quorum</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>9</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="16123064" author="githubbot" created="Fri, 11 Aug 2017 09:12:05 +0000"  >&lt;p&gt;GitHub user bitgaoshu opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/334&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/334&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2836&quot; title=&quot;QuorumCnxManager.Listener Thread Better handling of SocketTimeoutException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2836&quot;&gt;&lt;del&gt;ZOOKEEPER-2836&lt;/del&gt;&lt;/a&gt; SocketTimeoutException&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/bitgaoshu/zookeeper&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/bitgaoshu/zookeeper&lt;/a&gt; fix/&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2836&quot; title=&quot;QuorumCnxManager.Listener Thread Better handling of SocketTimeoutException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2836&quot;&gt;&lt;del&gt;ZOOKEEPER-2836&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/334.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/334.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #334&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 313406fdb0bd247c897409d8dbf800f6a6d62ce4&lt;br/&gt;
Author: fengwei &amp;lt;fengwei@oneapm.com&amp;gt;&lt;br/&gt;
Date:   2017-08-11T09:10:06Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2836&quot; title=&quot;QuorumCnxManager.Listener Thread Better handling of SocketTimeoutException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2836&quot;&gt;&lt;del&gt;ZOOKEEPER-2836&lt;/del&gt;&lt;/a&gt; SocketTimeoutException&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16123067" author="githubbot" created="Fri, 11 Aug 2017 09:13:27 +0000"  >&lt;p&gt;Github user bitgaoshu closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/334&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/334&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16124606" author="githubbot" created="Sat, 12 Aug 2017 15:43:24 +0000"  >&lt;p&gt;Github user maoling commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/334#discussion_r132820615&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/334#discussion_r132820615&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/quorum/QuorumCnxManager.java &amp;#8212;&lt;br/&gt;
    @@ -647,11 +648,11 @@ public void run() &lt;/p&gt;
{
                             numRetries = 0;
                         }
&lt;p&gt;                     } catch (IOException e) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (shutdown) 
{
    -                        break;
    -                    }
&lt;p&gt;                         LOG.error(&quot;Exception while listening&quot;, e);&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;numRetries++;&lt;br/&gt;
    +                    if (!(e instanceof SocketTimeoutException)) 
{
    +                        numRetries++;
    +                    }
&lt;p&gt;    +                }finally &lt;/p&gt;
{
    --- End diff --
    
    1. add a space between **}
&lt;p&gt;** and *&lt;b&gt;finally&lt;/b&gt;*&lt;br/&gt;
    2. why we need to move some codes about closing *&lt;b&gt;ServerSocket&lt;/b&gt;* in *&lt;b&gt;catch&lt;/b&gt;* code block to *&lt;b&gt;finally&lt;/b&gt;* code block? this will &lt;br/&gt;
       make codes in *&lt;b&gt;Line677-Line685&lt;/b&gt;* redundant&lt;br/&gt;
    3. If *&lt;b&gt;numRetries&lt;/b&gt;* don&apos;t count *&lt;b&gt;SocketTimeoutExceptions&lt;/b&gt;*.is this code facing an endless loop if SocketTimeoutExceptions always happen for a long time? this way of handling SocketTimeoutException is appropriate?&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16125184" author="githubbot" created="Mon, 14 Aug 2017 03:33:56 +0000"  >&lt;p&gt;Github user bitgaoshu commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/334#discussion_r132868731&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/334#discussion_r132868731&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/quorum/QuorumCnxManager.java &amp;#8212;&lt;br/&gt;
    @@ -647,11 +648,11 @@ public void run() &lt;/p&gt;
{
                             numRetries = 0;
                         }
&lt;p&gt;                     } catch (IOException e) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (shutdown) 
{
    -                        break;
    -                    }
&lt;p&gt;                         LOG.error(&quot;Exception while listening&quot;, e);&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;numRetries++;&lt;br/&gt;
    +                    if (!(e instanceof SocketTimeoutException)) 
{
    +                        numRetries++;
    +                    }
&lt;p&gt;    +                }finally {&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    1. i had removed *&lt;b&gt;finally&lt;/b&gt;* code block in my newest code.&lt;br/&gt;
    2. according to jira , the *&lt;b&gt;SocketTimeoutException&lt;/b&gt;* was likely thrown every about 49days, maybe unsigned int -1. Or, we can follow &lt;span class=&quot;error&quot;&gt;&amp;#91;Karaf&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/KARAF-3325l&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KARAF-3325l&lt;/a&gt;) to fix this code. but i think it was thrown too often.&lt;/p&gt;</comment>
                            <comment id="16125320" author="githubbot" created="Mon, 14 Aug 2017 07:19:38 +0000"  >&lt;p&gt;GitHub user bitgaoshu opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/336&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/336&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2836&quot; title=&quot;QuorumCnxManager.Listener Thread Better handling of SocketTimeoutException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2836&quot;&gt;&lt;del&gt;ZOOKEEPER-2836&lt;/del&gt;&lt;/a&gt; fix SocketTimeoutException&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/bitgaoshu/zookeeper&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/bitgaoshu/zookeeper&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2836&quot; title=&quot;QuorumCnxManager.Listener Thread Better handling of SocketTimeoutException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2836&quot;&gt;&lt;del&gt;ZOOKEEPER-2836&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/336.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/336.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #336&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 3653e6ddc21589355fb06c98aa60665fce4a4e24&lt;br/&gt;
Author: bitgaoshu &amp;lt;bitgaoshu@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-08-14T07:02:16Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2836&quot; title=&quot;QuorumCnxManager.Listener Thread Better handling of SocketTimeoutException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2836&quot;&gt;&lt;del&gt;ZOOKEEPER-2836&lt;/del&gt;&lt;/a&gt; fix SocketTimeoutException&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16125335" author="githubbot" created="Mon, 14 Aug 2017 07:31:08 +0000"  >&lt;p&gt;Github user bitgaoshu commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/334#discussion_r132887998&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/334#discussion_r132887998&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/quorum/QuorumCnxManager.java &amp;#8212;&lt;br/&gt;
    @@ -647,11 +648,11 @@ public void run() &lt;/p&gt;
{
                             numRetries = 0;
                         }
&lt;p&gt;                     } catch (IOException e) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (shutdown) 
{
    -                        break;
    -                    }
&lt;p&gt;                         LOG.error(&quot;Exception while listening&quot;, e);&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;numRetries++;&lt;br/&gt;
    +                    if (!(e instanceof SocketTimeoutException)) 
{
    +                        numRetries++;
    +                    }
&lt;p&gt;    +                }finally {&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    it&apos;s my first time to commit code on github. i open a new  &lt;span class=&quot;error&quot;&gt;&amp;#91;pr&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/apache/zookeeper/pull/336&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/336&lt;/a&gt;), which has fixed according to your opinion.  I am sorry for my inconvenience. &lt;/p&gt;</comment>
                            <comment id="16125339" author="hadoopqa" created="Mon, 14 Aug 2017 07:41:11 +0000"  >&lt;p&gt;+1 overall.  GitHub Pull Request  Build&lt;/p&gt;


&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +0 tests included.  The patch appears to be a documentation patch that doesn&apos;t require tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/941//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/941//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/941//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/941//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/941//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/941//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16131577" author="githubbot" created="Fri, 18 Aug 2017 01:35:51 +0000"  >&lt;p&gt;Github user maoling commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/336#discussion_r133864927&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/336#discussion_r133864927&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/quorum/QuorumCnxManager.java &amp;#8212;&lt;br/&gt;
    @@ -647,11 +648,10 @@ public void run() &lt;/p&gt;
{
                             numRetries = 0;
                         }
&lt;p&gt;                     } catch (IOException e) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (shutdown) {
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    why we need to move code block *&lt;b&gt;Line650-Line652&lt;/b&gt;* to code block *&lt;b&gt;Line665-Line667&lt;/b&gt;* ?&lt;/p&gt;</comment>
                            <comment id="16131588" author="githubbot" created="Fri, 18 Aug 2017 01:43:08 +0000"  >&lt;p&gt;Github user maoling commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/336#discussion_r133865685&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/336#discussion_r133865685&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/quorum/QuorumCnxManager.java &amp;#8212;&lt;br/&gt;
    @@ -647,11 +648,10 @@ public void run() &lt;/p&gt;
{
                             numRetries = 0;
                         }
&lt;p&gt;                     } catch (IOException e) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (shutdown) 
{
    -                        break;
    -                    }
&lt;p&gt;                         LOG.error(&quot;Exception while listening&quot;, e);&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;numRetries++;&lt;br/&gt;
    +                    if (!(e instanceof SocketTimeoutException)) {
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;can we reproduce this issue?(haha,49days)? This should never happen theoretically.According to &lt;a href=&quot;https://issues.apache.org/jira/browse/KARAF-3325&quot; title=&quot;Karaf throws SocketTimeoutException and exits after 49 days&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KARAF-3325&quot;&gt;&lt;del&gt;KARAF-3325&lt;/del&gt;&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/KARAF-3325&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KARAF-3325&lt;/a&gt;) or &lt;span class=&quot;error&quot;&gt;&amp;#91;tomcat-56684&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://bz.apache.org/bugzilla/show_bug.cgi?id=56684),they&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bz.apache.org/bugzilla/show_bug.cgi?id=56684),they&lt;/a&gt; also  didn&apos;t find the root-cause,just do like &lt;span class=&quot;error&quot;&gt;&amp;#91;this&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/apache/karaf/pull/50/commits/0349d582c4899f19ad73ee37c8c688660cbc7354&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/karaf/pull/50/commits/0349d582c4899f19ad73ee37c8c688660cbc7354&lt;/a&gt;) to add some protections against this issue here.&lt;/li&gt;
	&lt;li&gt;One assumption is SocketServer.accept() use the default infinite value(2 ^ 32 -1=4294967295) without no timeout specified or setSoTimeout(0)&lt;br/&gt;
        &amp;gt; a call to accept() for this ServerSocket will block for only this amount of time. If the timeout expires, a java.net.SocketTimeoutException is raised, though the ServerSocket is still valid. The option must be enabled prior to entering the blocking operation to have effect. The timeout must be &amp;gt; 0. A timeout of zero is interpreted as an infinite timeout.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;       so this issuse always happended after 49days 17 hours(4294967295/1000/60/60/24=49.7days)&lt;/p&gt;</comment>
                            <comment id="16131691" author="hadoopqa" created="Fri, 18 Aug 2017 04:20:52 +0000"  >&lt;p&gt;+1 overall.  GitHub Pull Request  Build&lt;/p&gt;


&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +0 tests included.  The patch appears to be a documentation patch that doesn&apos;t require tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/943//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/943//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/943//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/943//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/943//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/943//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16131777" author="githubbot" created="Fri, 18 Aug 2017 06:04:09 +0000"  >&lt;p&gt;Github user bitgaoshu commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/336#discussion_r133885327&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/336#discussion_r133885327&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/quorum/QuorumCnxManager.java &amp;#8212;&lt;br/&gt;
    @@ -647,11 +648,10 @@ public void run() &lt;/p&gt;
{
                             numRetries = 0;
                         }
&lt;p&gt;                     } catch (IOException e) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (shutdown) 
{
    -                        break;
    -                    }
&lt;p&gt;                         LOG.error(&quot;Exception while listening&quot;, e);&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;numRetries++;&lt;br/&gt;
    +                    if (!(e instanceof SocketTimeoutException)) {
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;update&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;l checked the native method `java.net.PlainSocketImpl.socketAccept(Native Method)` in &lt;span class=&quot;error&quot;&gt;&amp;#91;openjdk&amp;#93;&lt;/span&gt;(&lt;a href=&quot;http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/9d617cfd6717/src/solaris/native/java/net/PlainSocketImpl.c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/9d617cfd6717/src/solaris/native/java/net/PlainSocketImpl.c&lt;/a&gt;), *&lt;b&gt;line709-721&lt;/b&gt;*, in which it changed from 0 to -1. and then timeout of -1 is interpreted as an infinite timeout.  In some cases, &lt;span class=&quot;error&quot;&gt;&amp;#91;-1 was interpreted as a larger positive integer&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://lwn.net/Articles/483078/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lwn.net/Articles/483078/&lt;/a&gt;). so this issue always happend after 49days. It&apos;s my wild conjecture.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16131788" author="githubbot" created="Fri, 18 Aug 2017 06:17:38 +0000"  >&lt;p&gt;Github user bitgaoshu commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/336#discussion_r133886561&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/336#discussion_r133886561&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/quorum/QuorumCnxManager.java &amp;#8212;&lt;br/&gt;
    @@ -647,11 +648,10 @@ public void run() &lt;/p&gt;
{
                             numRetries = 0;
                         }
&lt;p&gt;                     } catch (IOException e) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (shutdown) {
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Update. I used to consider that the `closeSocket(client); ` should also be executed when exception was thrown.&lt;/p&gt;</comment>
                            <comment id="16133137" author="githubbot" created="Fri, 18 Aug 2017 15:36:40 +0000"  >&lt;p&gt;Github user skamille commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/336#discussion_r133989279&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/336#discussion_r133989279&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/quorum/QuorumCnxManager.java &amp;#8212;&lt;br/&gt;
    @@ -638,13 +639,22 @@ public void run() {&lt;br/&gt;
                         LOG.info(&quot;My election bind port: &quot; + addr.toString());&lt;br/&gt;
                         setName(addr.toString());&lt;br/&gt;
                         ss.bind(addr);&lt;br/&gt;
    +                    ss.setSoTimeout(10 * 1000); // Ten seconds&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    By setting the timeout to 10s the timeout exception will fire potentially every 10s, is that what we want below?&lt;/p&gt;</comment>
                            <comment id="16133178" author="githubbot" created="Fri, 18 Aug 2017 15:57:54 +0000"  >&lt;p&gt;Github user skamille commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/336#discussion_r133994057&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/336#discussion_r133994057&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/quorum/QuorumCnxManager.java &amp;#8212;&lt;br/&gt;
    @@ -638,13 +639,22 @@ public void run() {&lt;br/&gt;
                         LOG.info(&quot;My election bind port: &quot; + addr.toString());&lt;br/&gt;
                         setName(addr.toString());&lt;br/&gt;
                         ss.bind(addr);&lt;br/&gt;
    +                    ss.setSoTimeout(10 * 1000); // Ten seconds&lt;br/&gt;
    +                    long acceptStartTime = System.currentTimeMillis();&lt;br/&gt;
                         while (!shutdown) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;client = ss.accept();&lt;/li&gt;
	&lt;li&gt;setSockOpts(client);&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;Received connection request &quot;&lt;/li&gt;
	&lt;li&gt;+ client.getRemoteSocketAddress());&lt;/li&gt;
	&lt;li&gt;receiveConnection(client);&lt;/li&gt;
	&lt;li&gt;numRetries = 0;&lt;br/&gt;
    +                        try 
{
    +                            client = ss.accept();
    +                            setSockOpts(client);
    +                            LOG.info(&quot;Received connection request &quot;
    +                                     + client.getRemoteSocketAddress());
    +                            receiveConnection(client);
    +                            numRetries = 0;
    +                        }
&lt;p&gt; catch (SocketTimeoutException e) {&lt;br/&gt;
    +                            LOG.warn(&quot;The socket is listening for the election accepted &quot;&lt;br/&gt;
    +                                     + &quot;an unexpected timeout [&quot;&lt;br/&gt;
    +                                     + (System.currentTimeMillis() - acceptStartTime) + &quot;]milliseconds&quot;&lt;br/&gt;
    +                                     + &quot;after the call to accept(). is this an instance of bug &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2836&quot; title=&quot;QuorumCnxManager.Listener Thread Better handling of SocketTimeoutException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2836&quot;&gt;&lt;del&gt;ZOOKEEPER-2836&lt;/del&gt;&lt;/a&gt;?&quot;);&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    I don&apos;t love this error message and it doesn&apos;t make sense because we&apos;ve set the socket timeout above so it will never time out based on that weird possible JVM error. So either we just continue after a timeout, or leave the timeout at 0 and leave a log statement that indicates it timed out unexpectedly but will retry, but the double fix doesn&apos;t really make sense to me.&lt;/p&gt;</comment>
                            <comment id="16133998" author="githubbot" created="Sat, 19 Aug 2017 07:29:54 +0000"  >&lt;p&gt;Github user bitgaoshu commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/336#discussion_r134085348&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/336#discussion_r134085348&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/quorum/QuorumCnxManager.java &amp;#8212;&lt;br/&gt;
    @@ -638,13 +639,22 @@ public void run() {&lt;br/&gt;
                         LOG.info(&quot;My election bind port: &quot; + addr.toString());&lt;br/&gt;
                         setName(addr.toString());&lt;br/&gt;
                         ss.bind(addr);&lt;br/&gt;
    +                    ss.setSoTimeout(10 * 1000); // Ten seconds&lt;br/&gt;
    +                    long acceptStartTime = System.currentTimeMillis();&lt;br/&gt;
                         while (!shutdown) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;client = ss.accept();&lt;/li&gt;
	&lt;li&gt;setSockOpts(client);&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;Received connection request &quot;&lt;/li&gt;
	&lt;li&gt;+ client.getRemoteSocketAddress());&lt;/li&gt;
	&lt;li&gt;receiveConnection(client);&lt;/li&gt;
	&lt;li&gt;numRetries = 0;&lt;br/&gt;
    +                        try 
{
    +                            client = ss.accept();
    +                            setSockOpts(client);
    +                            LOG.info(&quot;Received connection request &quot;
    +                                     + client.getRemoteSocketAddress());
    +                            receiveConnection(client);
    +                            numRetries = 0;
    +                        }
&lt;p&gt; catch (SocketTimeoutException e) {&lt;br/&gt;
    +                            LOG.warn(&quot;The socket is listening for the election accepted &quot;&lt;br/&gt;
    +                                     + &quot;an unexpected timeout [&quot;&lt;br/&gt;
    +                                     + (System.currentTimeMillis() - acceptStartTime) + &quot;]milliseconds&quot;&lt;br/&gt;
    +                                     + &quot;after the call to accept(). is this an instance of bug &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2836&quot; title=&quot;QuorumCnxManager.Listener Thread Better handling of SocketTimeoutException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2836&quot;&gt;&lt;del&gt;ZOOKEEPER-2836&lt;/del&gt;&lt;/a&gt;?&quot;);&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    I agree.  I will leave the timeout at 0 by default and leave a log statement.&lt;/p&gt;</comment>
                            <comment id="16134000" author="githubbot" created="Sat, 19 Aug 2017 07:30:10 +0000"  >&lt;p&gt;Github user bitgaoshu commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/336#discussion_r134085352&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/336#discussion_r134085352&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/quorum/QuorumCnxManager.java &amp;#8212;&lt;br/&gt;
    @@ -638,13 +639,22 @@ public void run() {&lt;br/&gt;
                         LOG.info(&quot;My election bind port: &quot; + addr.toString());&lt;br/&gt;
                         setName(addr.toString());&lt;br/&gt;
                         ss.bind(addr);&lt;br/&gt;
    +                    ss.setSoTimeout(10 * 1000); // Ten seconds&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    i also think the timeout not need to be set. i just follow &lt;span class=&quot;error&quot;&gt;&amp;#91;this&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/apache/karaf/pull/50/commits/0349d582c4899f19ad73ee37c8c688660cbc7354&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/karaf/pull/50/commits/0349d582c4899f19ad73ee37c8c688660cbc7354&lt;/a&gt;)  simply.&lt;/p&gt;</comment>
                            <comment id="16134030" author="hadoopqa" created="Sat, 19 Aug 2017 08:57:09 +0000"  >&lt;p&gt;+1 overall.  GitHub Pull Request  Build&lt;/p&gt;


&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +0 tests included.  The patch appears to be a documentation patch that doesn&apos;t require tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/949//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/949//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/949//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/949//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/949//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/949//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16137653" author="githubbot" created="Wed, 23 Aug 2017 00:16:57 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/336&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/336&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16137655" author="githubbot" created="Wed, 23 Aug 2017 00:17:07 +0000"  >&lt;p&gt;Github user skamille commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/336&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/336&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    +1 merging&lt;/p&gt;</comment>
                            <comment id="16137737" author="hudson" created="Wed, 23 Aug 2017 01:35:29 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build ZooKeeper-trunk #3509 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/3509/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/3509/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2836&quot; title=&quot;QuorumCnxManager.Listener Thread Better handling of SocketTimeoutException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2836&quot;&gt;&lt;del&gt;ZOOKEEPER-2836&lt;/del&gt;&lt;/a&gt;: fix SocketTimeoutException (camille: rev 52aff3eca439bba70f2b4d175ce331754dcd03db)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/server/quorum/QuorumCnxManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16138773" author="githubbot" created="Wed, 23 Aug 2017 17:58:37 +0000"  >&lt;p&gt;Github user skamille commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/336&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/336&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @bitgaoshu if you could make this patch apply to the 3.5 branch I will commit it there as well. Unfortunately that branch has a significant divergence from master and I suspect we want this fix in before we release 3.6&lt;/p&gt;</comment>
                            <comment id="16139558" author="githubbot" created="Thu, 24 Aug 2017 05:04:05 +0000"  >&lt;p&gt;Github user hanm commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/336&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/336&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @bitgaoshu What&apos;s your username on JIRA (&lt;a href=&quot;https://issues.apache.org/jira/projects/ZOOKEEPER)?&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/projects/ZOOKEEPER)?&lt;/a&gt; Please create an account on JIRA if you haven&apos;t and let me know the user name. Since you contributed the patch, I should assign the JIRA issue to you so you get the credits on your contribution.&lt;/p&gt;</comment>
                            <comment id="16139862" author="githubbot" created="Thu, 24 Aug 2017 10:15:22 +0000"  >&lt;p&gt;GitHub user bitgaoshu opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/344&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/344&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2836&quot; title=&quot;QuorumCnxManager.Listener Thread Better handling of SocketTimeoutException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2836&quot;&gt;&lt;del&gt;ZOOKEEPER-2836&lt;/del&gt;&lt;/a&gt;: Fix SocketTimeoutException&lt;/p&gt;

&lt;p&gt;    apply patch from master to branch-3.5&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/bitgaoshu/zookeeper&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/bitgaoshu/zookeeper&lt;/a&gt; branch-3.5&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/344.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/344.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #344&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 86701965dba3dac9aad9cc5263661e09255c766a&lt;br/&gt;
Author: bitgaoshu &amp;lt;bitgaoshu@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-08-24T06:23:32Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2836&quot; title=&quot;QuorumCnxManager.Listener Thread Better handling of SocketTimeoutException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2836&quot;&gt;&lt;del&gt;ZOOKEEPER-2836&lt;/del&gt;&lt;/a&gt;: Fix SocketTimeoutException&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16139863" author="githubbot" created="Thu, 24 Aug 2017 10:16:27 +0000"  >&lt;p&gt;Github user bitgaoshu commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/336&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/336&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    ok, i had made this patch apply to the 3.5. &lt;span class=&quot;error&quot;&gt;&amp;#91;PR&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/apache/zookeeper/pull/344&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/344&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="16139864" author="githubbot" created="Thu, 24 Aug 2017 10:18:53 +0000"  >&lt;p&gt;Github user bitgaoshu commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/336&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/336&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    gaoshu, thank you very much. @hanm &lt;/p&gt;</comment>
                            <comment id="16139876" author="hadoopqa" created="Thu, 24 Aug 2017 10:41:49 +0000"  >&lt;p&gt;+1 overall.  GitHub Pull Request  Build&lt;/p&gt;


&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +0 tests included.  The patch appears to be a documentation patch that doesn&apos;t require tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/962//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/962//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/962//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/962//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/962//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/962//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16695441" author="mkedwards" created="Thu, 22 Nov 2018 01:08:14 +0000"  >&lt;p&gt;Fix needed for 3.5.5?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 51 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3h2qv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>