<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:01:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[ZOOKEEPER-2926] Data inconsistency issue due to the flaw in the session management</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-2926</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;The local session upgrading feature will upgrade the session locally before receving a quorum commit of creating global session. It&apos;s possible that the server shutdown before the creating session request being sent to leader, if we retained the ZKDatabase or there is Snapshot happened just before shutdown, then only this server will have the global session. &lt;/p&gt;

&lt;p&gt;If that server didn&apos;t become leader, then it will have more global sessions than others, and those global sessions won&apos;t expire as the leader doesn&apos;t know it&apos;s existence. If the server became leader, it will accept the client renew session request and the client is allowed to create ephemeral nodes, which means other servers only have ephemeral nodes but not that global session. If there is follower going to have SNAP sync with it, then it will also have the global session. If the server without that global session becomes new leader, it will check and delete those dangling ephemeral node before serving traffic. These could introduce the issues that the ephemeral node being exist on some servers but not others. &lt;/p&gt;

&lt;p&gt;There is dangling global session issue even without local session feature, because on leader it will update the ZKDatabase when processing ConnectionRequest and in the PrepRequestProcessor before it&apos;s quorum committed, which also has this risk.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13112727">ZOOKEEPER-2926</key>
            <summary>Data inconsistency issue due to the flaw in the session management</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lvfangmin">Fangmin Lv</assignee>
                                    <reporter username="lvfangmin">Fangmin Lv</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 27 Oct 2017 23:23:08 +0000</created>
                <updated>Wed, 8 Aug 2018 07:22:15 +0000</updated>
                            <resolved>Wed, 8 Aug 2018 04:21:56 +0000</resolved>
                                    <version>3.5.3</version>
                    <version>3.6.0</version>
                                    <fixVersion>3.6.0</fixVersion>
                                    <component>server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="11400">3h 10m</timespent>
                                <comments>
                            <comment id="16319086" author="githubbot" created="Tue, 9 Jan 2018 20:24:52 +0000"  >&lt;p&gt;GitHub user lvfangmin opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/447&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/447&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2926&quot; title=&quot;Data inconsistency issue due to the flaw in the session management&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2926&quot;&gt;&lt;del&gt;ZOOKEEPER-2926&lt;/del&gt;&lt;/a&gt; Fix potential data consistency issue due to the session management bug&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/lvfangmin/zookeeper&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/lvfangmin/zookeeper&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2926&quot; title=&quot;Data inconsistency issue due to the flaw in the session management&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2926&quot;&gt;&lt;del&gt;ZOOKEEPER-2926&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/447.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/447.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #447&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 04ec15841c5d164f1212eea9cdfd02e10aa4478e&lt;br/&gt;
Author: Fangmin Lyu &amp;lt;allenlyu@...&amp;gt;&lt;br/&gt;
Date:   2018-01-09T06:58:32Z&lt;/p&gt;

&lt;p&gt;    fix potential data consistency issue due to global session added too early&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16319101" author="hadoopqa" created="Tue, 9 Jan 2018 20:41:24 +0000"  >&lt;p&gt;-1 overall.  GitHub Pull Request  Build&lt;/p&gt;


&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 26 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1403//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1403//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1403//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1403//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1403//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1403//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16322340" author="githubbot" created="Thu, 11 Jan 2018 14:39:55 +0000"  >&lt;p&gt;Github user anmolnar commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/447#discussion_r160972325&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/447#discussion_r160972325&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/ZooKeeperServer.java &amp;#8212;&lt;br/&gt;
    @@ -1187,13 +1187,8 @@ private ProcessTxnResult processTxn(Request request, TxnHeader hdr,&lt;br/&gt;
             if (opCode == OpCode.createSession) {&lt;br/&gt;
                 if (hdr != null &amp;amp;&amp;amp; txn instanceof CreateSessionTxn) &lt;/p&gt;
{
                     CreateSessionTxn cst = (CreateSessionTxn) txn;
    -                sessionTracker.addGlobalSession(sessionId, cst.getTimeOut());
    -            }
&lt;p&gt; else if (request != null &amp;amp;&amp;amp; request.isLocalSession()) &lt;/p&gt;
{
    -                request.request.rewind();
    -                int timeout = request.request.getInt();
    -                request.request.rewind();
    -                sessionTracker.addSession(request.sessionId, timeout);
    -            }
&lt;p&gt; else &lt;/p&gt;
{
    +                sessionTracker.commitSession(sessionId, cst.getTimeOut());
    +            }
&lt;p&gt; else if (request == null || !request.isLocalSession()) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Do you need this check here?&lt;br/&gt;
    Basically you removed the part of requesting localSession creation, because it has already happened in PrepRequestProcessor and it&apos;s safe to leave the default &apos;else&apos; handler as it was.&lt;/p&gt;</comment>
                            <comment id="16322341" author="githubbot" created="Thu, 11 Jan 2018 14:39:55 +0000"  >&lt;p&gt;Github user anmolnar commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/447#discussion_r160970304&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/447#discussion_r160970304&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java &amp;#8212;&lt;br/&gt;
    @@ -579,13 +579,8 @@ protected void pRequest2Txn(int type, long zxid, Request request,&lt;br/&gt;
                     int to = request.request.getInt();&lt;br/&gt;
                     request.setTxn(new CreateSessionTxn(to));&lt;br/&gt;
                     request.request.rewind();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (request.isLocalSession()) 
{
    -                    // This will add to local session tracker if it is enabled
    -                    zks.sessionTracker.addSession(request.sessionId, to);
    -                }
&lt;p&gt; else &lt;/p&gt;
{
    -                    // Explicitly add to global session if the flag is not set
    -                    zks.sessionTracker.addGlobalSession(request.sessionId, to);
    -                }
&lt;p&gt;    +                // only add the global session tracker but not to ZKDb&lt;br/&gt;
    +                zks.sessionTracker.addGlobalSession(request.sessionId, to);&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    You could remove this check safely, because effectively there was no difference between `addSession()` and `addGlobalSession()` calls.&lt;/p&gt;</comment>
                            <comment id="16322342" author="githubbot" created="Thu, 11 Jan 2018 14:39:55 +0000"  >&lt;p&gt;Github user anmolnar commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/447#discussion_r160971106&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/447#discussion_r160971106&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/SessionTrackerImpl.java &amp;#8212;&lt;br/&gt;
    @@ -280,6 +278,12 @@ public synchronized boolean addSession(long id, int sessionTimeout) &lt;/p&gt;
{
             return added;
         }

&lt;p&gt;    +    public synchronized boolean commitSession(long id, int sessionTimeout) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    `sessionsWithTimeout` is a Map within ZKdb, so adding sessions to it is equivalent to persisting them.&lt;/p&gt;

&lt;p&gt;    I think you could also remove the `addGlobalSession()` method completely, because it doesn&apos;t do anything special than forwarding the call to `addSession()`.&lt;/p&gt;</comment>
                            <comment id="16322343" author="githubbot" created="Thu, 11 Jan 2018 14:39:55 +0000"  >&lt;p&gt;Github user anmolnar commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/447#discussion_r160976160&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/447#discussion_r160976160&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/quorum/LearnerSessionTracker.java &amp;#8212;&lt;br/&gt;
    @@ -102,32 +101,42 @@ public boolean isGlobalSession(long sessionId) {&lt;br/&gt;
         }&lt;/p&gt;

&lt;p&gt;         public boolean addGlobalSession(long sessionId, int sessionTimeout) {&lt;br/&gt;
    +        // no global session tracker, do nothing&lt;br/&gt;
    +        return false;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Is it possible to throw UnsupportedOperationException instead?&lt;/p&gt;</comment>
                            <comment id="16324395" author="githubbot" created="Fri, 12 Jan 2018 19:01:51 +0000"  >&lt;p&gt;Github user lvfangmin commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/447#discussion_r161296493&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/447#discussion_r161296493&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java &amp;#8212;&lt;br/&gt;
    @@ -579,13 +579,8 @@ protected void pRequest2Txn(int type, long zxid, Request request,&lt;br/&gt;
                     int to = request.request.getInt();&lt;br/&gt;
                     request.setTxn(new CreateSessionTxn(to));&lt;br/&gt;
                     request.request.rewind();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (request.isLocalSession()) 
{
    -                    // This will add to local session tracker if it is enabled
    -                    zks.sessionTracker.addSession(request.sessionId, to);
    -                }
&lt;p&gt; else &lt;/p&gt;
{
    -                    // Explicitly add to global session if the flag is not set
    -                    zks.sessionTracker.addGlobalSession(request.sessionId, to);
    -                }
&lt;p&gt;    +                // only add the global session tracker but not to ZKDb&lt;br/&gt;
    +                zks.sessionTracker.addGlobalSession(request.sessionId, to);&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    On LeaderSessionTracker, we need to differentiate add local session or global session, but since we only call createSession when add local session, I think I can simplify the interface more by removing addGlobalSession and rename addSession to trackSession.&lt;/p&gt;</comment>
                            <comment id="16324396" author="githubbot" created="Fri, 12 Jan 2018 19:01:51 +0000"  >&lt;p&gt;Github user lvfangmin commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/447#discussion_r161300774&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/447#discussion_r161300774&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/ZooKeeperServer.java &amp;#8212;&lt;br/&gt;
    @@ -1187,13 +1187,8 @@ private ProcessTxnResult processTxn(Request request, TxnHeader hdr,&lt;br/&gt;
             if (opCode == OpCode.createSession) {&lt;br/&gt;
                 if (hdr != null &amp;amp;&amp;amp; txn instanceof CreateSessionTxn) &lt;/p&gt;
{
                     CreateSessionTxn cst = (CreateSessionTxn) txn;
    -                sessionTracker.addGlobalSession(sessionId, cst.getTimeOut());
    -            }
&lt;p&gt; else if (request != null &amp;amp;&amp;amp; request.isLocalSession()) &lt;/p&gt;
{
    -                request.request.rewind();
    -                int timeout = request.request.getInt();
    -                request.request.rewind();
    -                sessionTracker.addSession(request.sessionId, timeout);
    -            }
&lt;p&gt; else &lt;/p&gt;
{
    +                sessionTracker.commitSession(sessionId, cst.getTimeOut());
    +            }
&lt;p&gt; else if (request == null || !request.isLocalSession()) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Local session creation is happened in ZooKeeperServer when the when processing connection request, PrepRequestProcessor only deals with the global sessions.&lt;/p&gt;

&lt;p&gt;    Local session creation will also send a createSession op into the processor pipeline, so if we remove the else check, a lot of warning log will show for local session createSession op, that&apos;s not what we wanted.&lt;/p&gt;</comment>
                            <comment id="16324397" author="githubbot" created="Fri, 12 Jan 2018 19:01:52 +0000"  >&lt;p&gt;Github user lvfangmin commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/447#discussion_r161296695&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/447#discussion_r161296695&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/main/org/apache/zookeeper/server/SessionTrackerImpl.java &amp;#8212;&lt;br/&gt;
    @@ -280,6 +278,12 @@ public synchronized boolean addSession(long id, int sessionTimeout) &lt;/p&gt;
{
             return added;
         }

&lt;p&gt;    +    public synchronized boolean commitSession(long id, int sessionTimeout) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Yes, that&apos;s kind of commit changes to ZkDB, like the usual txns commit to DataTree in ZkDB.&lt;/p&gt;</comment>
                            <comment id="16324478" author="hadoopqa" created="Fri, 12 Jan 2018 19:57:50 +0000"  >&lt;p&gt;-1 overall.  GitHub Pull Request  Build&lt;/p&gt;


&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 26 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1411//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1411//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1411//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1411//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1411//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1411//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16324503" author="githubbot" created="Fri, 12 Jan 2018 20:11:03 +0000"  >&lt;p&gt;Github user anmolnar commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/447&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/447&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @lvfangmin Have you amended your commit?&lt;br/&gt;
    I see a lot of changes since I last reviewed this PR.&lt;/p&gt;</comment>
                            <comment id="16324707" author="githubbot" created="Fri, 12 Jan 2018 23:09:17 +0000"  >&lt;p&gt;Github user lvfangmin commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/447&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/447&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @anmolnar I changed the code based on your comments and did amend, is this the right process?&lt;/p&gt;</comment>
                            <comment id="16325703" author="githubbot" created="Sun, 14 Jan 2018 18:14:38 +0000"  >&lt;p&gt;Github user anmolnar commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/447&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/447&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @lvfangmin Got it. Recently we talked about why multiple commits are better for review over squashing. Now I see why.&lt;/p&gt;</comment>
                            <comment id="16325706" author="githubbot" created="Sun, 14 Jan 2018 18:16:11 +0000"  >&lt;p&gt;Github user anmolnar commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/447#discussion_r161405611&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/447#discussion_r161405611&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/test/org/apache/zookeeper/test/SessionTrackerCheckTest.java &amp;#8212;&lt;br/&gt;
    @@ -185,8 +182,8 @@ public void testLeaderSessionTracker() throws Exception {&lt;br/&gt;
                     TICK_TIME, expirer.sid, false, testZKSListener());&lt;/p&gt;

&lt;p&gt;             // Global session&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;sessionId = 0xdeadbeef;&lt;/li&gt;
	&lt;li&gt;tracker.addSession(sessionId, CONNECTION_TIMEOUT);&lt;br/&gt;
    +        sessionId = 0xdeadbef0;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Why have you changed this? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16327596" author="githubbot" created="Tue, 16 Jan 2018 19:05:08 +0000"  >&lt;p&gt;Github user lvfangmin commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/447#discussion_r161855408&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/447#discussion_r161855408&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: src/java/test/org/apache/zookeeper/test/SessionTrackerCheckTest.java &amp;#8212;&lt;br/&gt;
    @@ -185,8 +182,8 @@ public void testLeaderSessionTracker() throws Exception {&lt;br/&gt;
                     TICK_TIME, expirer.sid, false, testZKSListener());&lt;/p&gt;

&lt;p&gt;             // Global session&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;sessionId = 0xdeadbeef;&lt;/li&gt;
	&lt;li&gt;tracker.addSession(sessionId, CONNECTION_TIMEOUT);&lt;br/&gt;
    +        sessionId = 0xdeadbef0;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    I think this is not changed by intention, might happen when merge patch, I&apos;ll get this fixed.&lt;/p&gt;</comment>
                            <comment id="16327601" author="githubbot" created="Tue, 16 Jan 2018 19:07:06 +0000"  >&lt;p&gt;Github user lvfangmin commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/zookeeper/pull/447&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/447&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @anmolnar I also find it&apos;s hard to track when using overwriting the commit, I&apos;ll use stack instead.&lt;/p&gt;

&lt;p&gt;    For the tests, I need to inject some failure in the Quorum being set up, that&apos;s why I need the customized way I&apos;m doing in my code, I think I prefer to create a separate test class.&lt;/p&gt;</comment>
                            <comment id="16550299" author="hadoopqa" created="Fri, 20 Jul 2018 06:47:59 +0000"  >&lt;p&gt;+1 overall.  GitHub Pull Request  Build&lt;/p&gt;


&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 20 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1974//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1974//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1974//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1974//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1974//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1974//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16572657" author="hanm" created="Wed, 8 Aug 2018 04:21:56 +0000"  >&lt;p&gt;Issue resolved by pull request 447&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/zookeeper/pull/447&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/zookeeper/pull/447&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16572791" author="hudson" created="Wed, 8 Aug 2018 07:22:15 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build ZooKeeper-trunk #143 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/143/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/143/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-2926&quot; title=&quot;Data inconsistency issue due to the flaw in the session management&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-2926&quot;&gt;&lt;del&gt;ZOOKEEPER-2926&lt;/del&gt;&lt;/a&gt;: Fix potential data consistency issue due to the session (hanm: rev cd209456b67cde5aba771b1a240ebe5607398459)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) src/java/test/org/apache/zookeeper/test/ClientBase.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/server/SessionTrackerImpl.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/test/org/apache/zookeeper/server/MockServerCnxn.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/server/SessionTracker.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/server/quorum/LearnerSessionTracker.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/test/org/apache/zookeeper/server/PrepRequestProcessorTest.java&lt;/li&gt;
	&lt;li&gt;(add) src/java/test/org/apache/zookeeper/server/quorum/SessionUpgradeQuorumTest.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/test/org/apache/zookeeper/test/QuorumBase.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/server/ZooKeeperServer.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/test/org/apache/zookeeper/server/SessionTrackerTest.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/test/org/apache/zookeeper/test/SessionTrackerCheckTest.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/server/quorum/LocalSessionTracker.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/server/ServerCnxn.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/server/quorum/LeaderSessionTracker.java&lt;/li&gt;
	&lt;li&gt;(edit) src/java/main/org/apache/zookeeper/server/quorum/UpgradeableSessionTracker.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 15 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ltdr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>