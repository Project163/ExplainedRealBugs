<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:48:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[ZOOKEEPER-508] proposals and commits for DIFF and Truncate messages from the leader to followers is buggy.</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-508</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;The proposals and commits sent by the leader after it asks the followers to truncate there logs or starts sending a diff has missing messages which causes out of order commits messages and causes the followers to shutdown because of these out of order commits.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12433256">ZOOKEEPER-508</key>
            <summary>proposals and commits for DIFF and Truncate messages from the leader to followers is buggy.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mahadev">Mahadev Konar</assignee>
                                    <reporter username="mahadev">Mahadev Konar</reporter>
                        <labels>
                    </labels>
                <created>Mon, 17 Aug 2009 18:39:08 +0000</created>
                <updated>Sat, 5 Sep 2009 22:36:20 +0000</updated>
                            <resolved>Tue, 25 Aug 2009 05:56:53 +0000</resolved>
                                                    <fixVersion>3.2.1</fixVersion>
                    <fixVersion>3.3.0</fixVersion>
                                    <component>quorum</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12744802" author="mahadev" created="Wed, 19 Aug 2009 00:34:21 +0000"  >&lt;p&gt;this fixes the issue so that we sent the right packets when a follower syncs with the leader. also includes &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-483&quot; title=&quot;ZK fataled on me, and ugly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-483&quot;&gt;&lt;del&gt;ZOOKEEPER-483&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12745296" author="breed" created="Thu, 20 Aug 2009 03:55:51 +0000"  >&lt;p&gt;added a testcase for the DIFF problem. still not fixed.&lt;/p&gt;</comment>
                            <comment id="12745683" author="mahadev" created="Thu, 20 Aug 2009 21:51:54 +0000"  >&lt;p&gt;i fugured out the reason why it fails on the assertion errors != 0. The whole scenario of 483 fialing with truncate is this&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the test case shutdowns all the followers&lt;/li&gt;
	&lt;li&gt;the leader does not realize that its lost the leadership, becasue the time we ping to see if the leader is still the leader (maybe 1 sec) is greater than the time hte followers actually take to shutdown and get back and in sync with the leader&lt;/li&gt;
	&lt;li&gt;so the leader never shutsdown any of its stuff (no NIO rejection or nething else)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;so in your case, sometimes the client conencts to the leader and will never see errors. On the other hand sometimes it may pas s on connection to other followers and your testcase will pass. So we cannot really say that your test case is fool proof.&lt;/p&gt;
</comment>
                            <comment id="12745706" author="mahadev" created="Thu, 20 Aug 2009 22:43:24 +0000"  >&lt;p&gt;this patch includes fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-508&quot; title=&quot;proposals and commits for DIFF and Truncate messages from the leader to followers is buggy.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-508&quot;&gt;&lt;del&gt;ZOOKEEPER-508&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-509&quot; title=&quot;Truncating of logs does not work right at the followers.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-509&quot;&gt;&lt;del&gt;ZOOKEEPER-509&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-483&quot; title=&quot;ZK fataled on me, and ugly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-483&quot;&gt;&lt;del&gt;ZOOKEEPER-483&lt;/del&gt;&lt;/a&gt;. It also includes the test cases for each of them.&lt;/p&gt;</comment>
                            <comment id="12745733" author="mahadev" created="Fri, 21 Aug 2009 00:05:28 +0000"  >&lt;p&gt;I have a patch for the 3.2 branch, will upload is as soon as hudson is done running this patch.&lt;/p&gt;</comment>
                            <comment id="12745755" author="hadoopqa" created="Fri, 21 Aug 2009 00:57:01 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12417189/ZOOKEEPER-508.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12417189/ZOOKEEPER-508.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 803300.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    -1 release audit.  The applied patch generated 178 release audit warnings (more than the trunk&apos;s current 177 warnings).&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/188/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/188/testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/188/artifact/trunk/patchprocess/releaseAuditDiffWarnings.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/188/artifact/trunk/patchprocess/releaseAuditDiffWarnings.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/188/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/188/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/188/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/188/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12745757" author="mahadev" created="Fri, 21 Aug 2009 01:04:38 +0000"  >&lt;p&gt;attached missing header to the file.&lt;/p&gt;</comment>
                            <comment id="12746172" author="hadoopqa" created="Fri, 21 Aug 2009 19:20:16 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12417207/ZOOKEEPER-508.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12417207/ZOOKEEPER-508.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 803300.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/189/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/189/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/189/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/189/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/189/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/189/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12746333" author="mahadev" created="Fri, 21 Aug 2009 22:57:16 +0000"  >&lt;p&gt;patch for 3.2&lt;/p&gt;

&lt;p&gt;fixes all the issues, also the new one found by hudson running the tests.&lt;/p&gt;</comment>
                            <comment id="12746334" author="mahadev" created="Fri, 21 Aug 2009 22:57:40 +0000"  >&lt;p&gt;patch for trunk. &lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;fixes all the issues with tests.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12746400" author="hadoopqa" created="Sat, 22 Aug 2009 03:05:33 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12417339/ZOOKEEPER-508.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12417339/ZOOKEEPER-508.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 803300.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/190/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/190/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/190/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/190/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/190/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/190/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12747155" author="breed" created="Tue, 25 Aug 2009 00:17:26 +0000"  >&lt;p&gt;+1 looks good. simple fix! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12747230" author="mahadev" created="Tue, 25 Aug 2009 05:56:53 +0000"  >&lt;p&gt;I just committed this.&lt;/p&gt;</comment>
                            <comment id="12747366" author="hudson" created="Tue, 25 Aug 2009 11:53:32 +0000"  >&lt;p&gt;Integrated in ZooKeeper-trunk #426 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/426/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/426/&lt;/a&gt;)&lt;br/&gt;
    . proposals and commits for DIFF and Truncate messages from the leader to the followers is buggy. (mahadev and ben via mahadev)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12433490">ZOOKEEPER-509</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12431300">ZOOKEEPER-483</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12417339" name="ZOOKEEPER-508.patch" size="22477" author="mahadev" created="Fri, 21 Aug 2009 22:57:40 +0000"/>
                            <attachment id="12417207" name="ZOOKEEPER-508.patch" size="22448" author="mahadev" created="Fri, 21 Aug 2009 01:04:38 +0000"/>
                            <attachment id="12417189" name="ZOOKEEPER-508.patch" size="21622" author="mahadev" created="Thu, 20 Aug 2009 22:43:24 +0000"/>
                            <attachment id="12417095" name="ZOOKEEPER-508.patch" size="20746" author="breed" created="Thu, 20 Aug 2009 03:55:51 +0000"/>
                            <attachment id="12416937" name="ZOOKEEPER-508.patch" size="14951" author="mahadev" created="Wed, 19 Aug 2009 00:34:21 +0000"/>
                            <attachment id="12417338" name="ZOOKEEPER-508.patch-3.2" size="22340" author="mahadev" created="Fri, 21 Aug 2009 22:57:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>47762</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 14 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i060mn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33033</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>includes the fix for  &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-483&quot; title=&quot;ZK fataled on me, and ugly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-483&quot;&gt;&lt;strike&gt;ZOOKEEPER-483&lt;/strike&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-509&quot; title=&quot;Truncating of logs does not work right at the followers.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-509&quot;&gt;&lt;strike&gt;ZOOKEEPER-509&lt;/strike&gt;&lt;/a&gt;.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>