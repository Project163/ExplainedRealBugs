<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:56:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[ZOOKEEPER-1366] Zookeeper should be tolerant of clock adjustments</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-1366</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;If you want to wreak havoc on a ZK based system just do &lt;span class=&quot;error&quot;&gt;&amp;#91;date -s &amp;quot;+1hour&amp;quot;&amp;#93;&lt;/span&gt; and watch the mayhem as all sessions expire at once.&lt;/p&gt;

&lt;p&gt;This shouldn&apos;t happen.  Zookeeper could easily know handle elapsed times as elapsed times rather than as differences between absolute times.  The absolute times are subject to adjustment when the clock is set while a timer is not subject to this problem.  In Java, System.currentTimeMillis() gives you absolute time while System.nanoTime() gives you time based on a timer from an arbitrary epoch.&lt;/p&gt;

&lt;p&gt;I have done this and have been running tests now for some tens of minutes with no failures.  I will set up a test machine to redo the build again on Ubuntu and post a patch here for discussion.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12538929">ZOOKEEPER-1366</key>
            <summary>Zookeeper should be tolerant of clock adjustments</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hdeng">Hongchao Deng</assignee>
                                    <reporter username="tdunning">Ted Dunning</reporter>
                        <labels>
                    </labels>
                <created>Thu, 19 Jan 2012 07:00:43 +0000</created>
                <updated>Thu, 11 May 2017 20:34:32 +0000</updated>
                            <resolved>Fri, 6 Feb 2015 05:19:36 +0000</resolved>
                                                    <fixVersion>3.5.1</fixVersion>
                    <fixVersion>3.6.0</fixVersion>
                                        <due></due>
                            <votes>7</votes>
                                    <watches>32</watches>
                                                                                                                                                            <comments>
                            <comment id="13188974" author="tdunning" created="Thu, 19 Jan 2012 07:35:11 +0000"  >&lt;p&gt;See &lt;a href=&quot;https://github.com/tdunning/zookeeper&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tdunning/zookeeper&lt;/a&gt; for a work in progress.&lt;/p&gt;

&lt;p&gt;Tests seem good except for ReadOnlyModeTest.  That may be failing due to unrelated issues.&lt;/p&gt;</comment>
                            <comment id="13188981" author="tdunning" created="Thu, 19 Jan 2012 08:05:31 +0000"  >&lt;p&gt;The ReadOnlyModeTest failure was an environmental fluke.  It passes on Ubuntu and OSX.&lt;/p&gt;

&lt;p&gt;Patch coming up.&lt;/p&gt;</comment>
                            <comment id="13188986" author="tdunning" created="Thu, 19 Jan 2012 08:08:41 +0000"  >&lt;p&gt;This patch changes to using relative time everywhere that System.currentTimeMillis was previously used.&lt;/p&gt;</comment>
                            <comment id="13189038" author="fpj" created="Thu, 19 Jan 2012 10:11:07 +0000"  >&lt;p&gt;Hi Ted, I was wondering if this change fits into the framework of &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-702&quot; title=&quot;GSoC 2010: Failure Detector Model&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-702&quot;&gt;ZOOKEEPER-702&lt;/a&gt;. &lt;/p&gt;</comment>
                            <comment id="13189265" author="tdunning" created="Thu, 19 Jan 2012 18:29:03 +0000"  >&lt;p&gt;I don&apos;t think so.  This change makes ZK work better.  It doesn&apos;t detect failures.&lt;/p&gt;
</comment>
                            <comment id="13189284" author="fpj" created="Thu, 19 Jan 2012 18:54:22 +0000"  >&lt;p&gt;You&apos;re talking about timers in your description, and we use timers for failure detection. The main problem is getting that patch in, there hasn&apos;t been enough agreement to get it committed. &lt;/p&gt;</comment>
                            <comment id="13189336" author="tdunning" created="Thu, 19 Jan 2012 19:45:34 +0000"  >&lt;p&gt;Yes.  You are correct.  Both bugs mention timers.&lt;/p&gt;

&lt;p&gt;That doesn&apos;t make them all that related.  The recent &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1239&quot; title=&quot;add logging/stats to identify fsync stalls&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1239&quot;&gt;&lt;del&gt;ZOOKEEPER-1239&lt;/del&gt;&lt;/a&gt; uses timers as well, but it isn&apos;t really all that related to either &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-702&quot; title=&quot;GSoC 2010: Failure Detector Model&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-702&quot;&gt;ZOOKEEPER-702&lt;/a&gt; or this issue.&lt;/p&gt;

&lt;p&gt;As I read it &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-702&quot; title=&quot;GSoC 2010: Failure Detector Model&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-702&quot;&gt;ZOOKEEPER-702&lt;/a&gt; is about failure detection.  This bug is about making zookeeper work correct even when the system clock is advanced or retarded.  It has nothing to do with failure detection and &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-702&quot; title=&quot;GSoC 2010: Failure Detector Model&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-702&quot;&gt;ZOOKEEPER-702&lt;/a&gt; has really nothing to do with this issue.&lt;/p&gt;</comment>
                            <comment id="13189488" author="breed" created="Thu, 19 Jan 2012 23:21:13 +0000"  >&lt;p&gt;+1 nice patch. i vaguely remember a duplicate issue on this. i think ted is right, this is about how we detect time. any idea how we can test this ted? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13189505" author="zhihyu@ebaysf.com" created="Thu, 19 Jan 2012 23:53:01 +0000"  >&lt;p&gt;The following would be replaced with Apache License header, I assume:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+/**
+ * Created by IntelliJ IDEA.
+ * User: tdunning
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13189535" author="tdunning" created="Fri, 20 Jan 2012 00:34:39 +0000"  >&lt;p&gt;Yes.&lt;/p&gt;

&lt;p&gt;The correct response on my part is &quot;Ooops&quot;.&lt;/p&gt;

&lt;p&gt;On Thu, Jan 19, 2012 at 11:54 PM, Zhihong Yu (Commented) (JIRA) &amp;lt;&lt;/p&gt;
</comment>
                            <comment id="13189538" author="breed" created="Fri, 20 Jan 2012 00:37:07 +0000"  >&lt;p&gt;good catch zhihong! i wish hudson would check that for us...&lt;/p&gt;</comment>
                            <comment id="13189539" author="tdunning" created="Fri, 20 Jan 2012 00:37:56 +0000"  >&lt;p&gt;Here is an updated patch that fixes the header.&lt;/p&gt;</comment>
                            <comment id="13189543" author="tdunning" created="Fri, 20 Jan 2012 00:41:07 +0000"  >&lt;p&gt;Ben,&lt;/p&gt;

&lt;p&gt;Regarding the header, I think that RAT can do something like that.  Also, I can configure IntelliJ to do the right thing by default (I have that set for Mahout... forgot on ZK).&lt;/p&gt;

&lt;p&gt;Regarding testing, I have been unable to come up with a substantive unit test.  It is trivial to test the Time.currentElapsedTime method, but that provides little information.  &lt;/p&gt;

&lt;p&gt;A manual test is easy.  Start a client that creates an ephemeral.  Set system time +1hour.  Note that ephemeral vanishes and client goes away in shame because it&apos;s session is marked as expired.  Now repeat with patch.&lt;/p&gt;

&lt;p&gt;I will do the test and attach a transcript.&lt;/p&gt;</comment>
                            <comment id="13189557" author="henryr" created="Fri, 20 Jan 2012 01:11:41 +0000"  >&lt;p&gt;The nice thing is that this is a small step towards a properly mockable time API in ZK, which would a) make tests much faster and b) make tests much more deterministic. There&apos;s a way to go still because of Thread.sleep and other complications, but this is a good first step. &lt;/p&gt;</comment>
                            <comment id="13189560" author="henryr" created="Fri, 20 Jan 2012 01:15:36 +0000"  >&lt;p&gt;Oh, and my main concern here was non-monotonicity across cores, but &lt;a href=&quot;http://juliusdavies.ca/posix_clocks/clock_realtime_linux_faq.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this page&lt;/a&gt; alleviates that concern for modern Linux kernels:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;1. Is clock_gettime(CLOCK_REALTIME) consistent across all processors/cores?&lt;br/&gt;
&amp;gt;    (Does arch matter?  e.g. ppc, arm, x86, amd64, sparc).&lt;br/&gt;
It &lt;b&gt;should&lt;/b&gt; or it&apos;s considered buggy.&lt;/p&gt;

&lt;p&gt;However, on x86/x86_64, it is possible to see unsynced or variable freq TSCs cause time inconsistencies. 2.4 kernels really had no protection against this, and early 2.6 kernels didn&apos;t do too well here either. As of 2.6.18 and up the logic for detecting this is better and we&apos;ll usually fall back to a safe clocksource.&lt;/p&gt;

&lt;p&gt;ppc always has a synced timebase, so that shouldn&apos;t be an issue.&lt;/p&gt;

&lt;p&gt;arm, i&apos;m not so familiar with, but i assume they do the right thing (i&apos;ve not seen many arm bugs on this issue).&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="13189573" author="tdunning" created="Fri, 20 Jan 2012 02:15:20 +0000"  >&lt;p&gt;For the test, I have created a branch in my github fork of zookeeper called timer-test and one called ZK-1366.  Both have the test case below but only ZK-1366 has the fix.&lt;/p&gt;

&lt;p&gt;The test procedure is to do this in one window:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;git checkout timer-test
ant clean compile-test
echo build/test/lib/*.jar build/lib/*.jar build/classes build/test/classes | sed -e &lt;span class=&quot;code-quote&quot;&gt;&apos;s/ /:/g&apos;&lt;/span&gt; &amp;gt; cp
java -cp $(cat cp) org.apache.zookeeper.common.TimeTest | tee log-without-patch
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;After the test program starts, in a second window, do these commands separated by a second or three&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;date -s &lt;span class=&quot;code-quote&quot;&gt;&apos;+1hour&apos;&lt;/span&gt;
date -s &lt;span class=&quot;code-quote&quot;&gt;&apos;-1hour&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This will produce output that looks like this&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ubuntu@ip-10-113-27-85:~/zookeeper$ java -cp $(cat cp) org.apache.zookeeper.common.TimeTest | tee log-without-patch
1
log4j:WARN No appenders could be found &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; logger (org.apache.zookeeper.PortAssignment).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http:&lt;span class=&quot;code-comment&quot;&gt;//logging.apache.org/log4j/1.2/faq.html#noconfig &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; more info.
&lt;/span&gt;after construct
server start
client
1       &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
1       &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
0       &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
1       &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
3600000 event = WatchedEvent state:Disconnected type:None path:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
3600001 event = WatchedEvent state:Disconnected type:None path:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
3600001 event = WatchedEvent state:Disconnected type:None path:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
3600001 event = WatchedEvent state:Disconnected type:None path:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
3600001 event = WatchedEvent state:Disconnected type:None path:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
3600001 event = WatchedEvent state:Disconnected type:None path:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
3600001 event = WatchedEvent state:Disconnected type:None path:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
3600001 event = WatchedEvent state:Expired type:None path:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
3600001 event = WatchedEvent state:Expired type:None path:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
3600001 event = WatchedEvent state:Expired type:None path:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
3600001 event = WatchedEvent state:Expired type:None path:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
3600001 event = WatchedEvent state:Expired type:None path:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The number is the time discrepancy between the system clock and the elapsed time from start of the program.&lt;/p&gt;

&lt;p&gt;With the patch,&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;git checkout ZK-1366
ant clean compile-test
echo build/test/lib/*.jar build/lib/*.jar build/classes build/test/classes | sed -e &lt;span class=&quot;code-quote&quot;&gt;&apos;s/ /:/g&apos;&lt;/span&gt; &amp;gt; cp
java -cp $(cat cp) org.apache.zookeeper.common.TimeTest | tee log-with-patch
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The output looks like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ubuntu@ip-10-113-27-85:~/zookeeper$ less log-with-patch 
1
after construct
server start
client
0       &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
0       &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
1       &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
0       &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
1       &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
0       &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
0       &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
3600000 &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
3600000 &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
3600000 &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
3600000 &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
0       &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
0       &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
0       &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
0       &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
-3600000        &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
-3600001        &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
-3600000        &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
-1      &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
-1      &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
-1      &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
-1      &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As you can see, the timing discrepancy goes up and down but the ephemerals never disappear.&lt;/p&gt;

&lt;p&gt;I will update the patch shortly to match the ZK-1366 branch on my github clone.&lt;/p&gt;</comment>
                            <comment id="13189580" author="tdunning" created="Fri, 20 Jan 2012 02:38:16 +0000"  >&lt;p&gt;Contains the manual and a trivial automated test.&lt;/p&gt;</comment>
                            <comment id="13189593" author="tdunning" created="Fri, 20 Jan 2012 03:04:42 +0000"  >&lt;p&gt;Updated to current version of trunk&lt;/p&gt;</comment>
                            <comment id="13189609" author="tdunning" created="Fri, 20 Jan 2012 03:49:47 +0000"  >&lt;p&gt;Here is a patch against the 3.3.3 release if desired.  This had to be done by restarting the edits since I couldn&apos;t come close to cherry picking the final commit to trunk.  I was able to cherry pick the test/timer code, however. &lt;/p&gt;</comment>
                            <comment id="13190832" author="fournc" created="Mon, 23 Jan 2012 00:17:18 +0000"  >&lt;p&gt;The test in TimerTest is missing the @Test annotation which I presume is an oversight.&lt;/p&gt;</comment>
                            <comment id="13190837" author="fournc" created="Mon, 23 Jan 2012 00:27:19 +0000"  >&lt;p&gt;So in general, I think this is a good patch and a very good thing for us to do. But I feel like Henry&apos;s comment is most interesting:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;The nice thing is that this is a small step towards a properly mockable time API in ZK, which would a) make tests much faster and b) make tests much more deterministic. There&apos;s a way to go still because of Thread.sleep and other complications, but this is a good first step.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We really aren&apos;t doing all that much towards that end by replacing one static method call with another. You still can&apos;t mock that in mockito. So the only question I have here is, if we&apos;re going to touch all those places anyway, should we just be creating an actual thin object that wraps &quot;time&quot; and use non-static methods on that object to make these calls, in order to allow more mocking of timing issues in the future? Or should we save that for another patch?&lt;/p&gt;</comment>
                            <comment id="13191371" author="phunt" created="Mon, 23 Jan 2012 19:29:59 +0000"  >&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-366&quot; title=&quot;Session timeout detection can go wrong if the leader system time changes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-366&quot;&gt;&lt;del&gt;ZOOKEEPER-366&lt;/del&gt;&lt;/a&gt; for a previous discussion/solution for this issue. Would be good to close that one out if this is addressing the issue more directly.&lt;/p&gt;</comment>
                            <comment id="13191376" author="henryr" created="Mon, 23 Jan 2012 19:36:18 +0000"  >&lt;p&gt;My feeling is that Ted&apos;s fixing a legitimate issue here, so we shouldn&apos;t hold up the patch for a separate effort. Reworking how we deal with time is going to be a big effort (Thread.sleep really does complicate things, plus there&apos;s the question of how to actually inject a mock clock - as you say, such method calls would need to be non-static but then we need to figure out how to get the right implementation behind those methods). This patch doesn&apos;t get in the way of doing a better job with time, and gives us the beginnings of a nice integration point to mock clocks out. &lt;/p&gt;

&lt;p&gt;So I&apos;ll file a separate JIRA to track being able to change our clock implementation, and we can evaluate this on its own merits (might be nice to run a soak test for a few hours here to make sure that there are no weird edge cases that somehow got broken). Sound good?&lt;/p&gt;</comment>
                            <comment id="13191384" author="mahadev" created="Mon, 23 Jan 2012 19:43:56 +0000"  >&lt;p&gt;@Ted,&lt;br/&gt;
 Seems like a good change, only one issue I see here. I&apos;d like this to go into trunk and not into 3.4 unless its really a bug. I think 3.4 will take sometime to stabilize and would really like to avoid big changes in 3.4. Thoughts?&lt;/p&gt;</comment>
                            <comment id="13191396" author="fournc" created="Mon, 23 Jan 2012 19:55:01 +0000"  >&lt;p&gt;@Henry: I am fine with doing it as a separate ticket. I do think it&apos;s pretty trivial to rework this and get ourselves far down the road with a non-static impl, and not sure that we need to address Thread.sleep() to get a lot of mileage out of the solution. But I don&apos;t think I&apos;ll have time to rework this patch to do that so might as well do it in a separate ticket if Ted doesn&apos;t want to worry about that.&lt;/p&gt;</comment>
                            <comment id="13191403" author="tdunning" created="Mon, 23 Jan 2012 20:01:16 +0000"  >&lt;p&gt;@Mahadev,&lt;/p&gt;

&lt;p&gt;I will produce patches for several versions as well as pre-built tar files.  This will include trunk, 3.4, 3.3.3 and 3.3.2.&lt;/p&gt;

&lt;p&gt;The rate at which we encounter this kind of problem even at facilities that are pretty sophisticated says to me that even if this isn&apos;t strictly a bug, then it seriously decreases the probability that ZK will function well averaged over all plausible users.  Developers and users then think ZK is seriously buggy.&lt;/p&gt;

&lt;p&gt;As such, we view this internally as a required fix that we will be deploying as a patch on our current production version of ZK.  Whether the ZK community views it that way relative to 3.4 is an entirely separate question, of course.&lt;/p&gt;

&lt;p&gt;@Pat, @Henry,&lt;/p&gt;

&lt;p&gt;I really do think that doing the simple small thing (this patch) is important without waiting on the resolution of the larger more comprehensive fix (fixing time management in general).  Thanks for your efforts in that vein.&lt;/p&gt;

&lt;p&gt;@Camille,&lt;/p&gt;

&lt;p&gt;I will have a slightly revised set of patches by tonight that fix the @Test issue.  &lt;/p&gt;

&lt;p&gt;I also think that mocking was not at all the point of this patch.  The only way that this makes mocking easier is that we now have a (slightly) more distinctive string to search for but as you point out, that isn&apos;t the real issue anyway.  Mocking static functions is becoming a more common capability, but I would rather do it right when we do it.&lt;/p&gt;</comment>
                            <comment id="13191409" author="phunt" created="Mon, 23 Jan 2012 20:10:43 +0000"  >&lt;p&gt;@Ted my comment has nothing to do with Henry&apos;s suggestion re refactoring - I was pointing out that there is a similar JIRA to this that should probably be closed out - please see &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-366&quot; title=&quot;Session timeout detection can go wrong if the leader system time changes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-366&quot;&gt;&lt;del&gt;ZOOKEEPER-366&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13191412" author="phunt" created="Mon, 23 Jan 2012 20:12:50 +0000"  >&lt;p&gt;I have similar concerns as Mahadev re stability - this is a big change to introduce into a fix release. I&apos;d rather see it go into trunk.&lt;/p&gt;</comment>
                            <comment id="13191706" author="tdunning" created="Tue, 24 Jan 2012 00:59:27 +0000"  >&lt;p&gt;@Pat,&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-366&quot; title=&quot;Session timeout detection can go wrong if the leader system time changes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-366&quot;&gt;&lt;del&gt;ZOOKEEPER-366&lt;/del&gt;&lt;/a&gt; is essentially the same issue except that the suggested solution is weaker since it doesn&apos;t handle the problem of time jumping backwards, nor suggest a method to detect the time jumps.&lt;/p&gt;

&lt;p&gt;The numerological coincidence on the issue number is quite striking.&lt;/p&gt;</comment>
                            <comment id="13191917" author="phunt" created="Tue, 24 Jan 2012 06:11:39 +0000"  >&lt;p&gt;Ted - ha I thought the same thing (re #) &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13193471" author="breed" created="Thu, 26 Jan 2012 00:28:42 +0000"  >&lt;p&gt;once the @Test annotation is in, i think this is good to go. right? did we decide if this was going to be applied to any branches?&lt;/p&gt;</comment>
                            <comment id="13193482" author="phunt" created="Thu, 26 Jan 2012 00:42:54 +0000"  >&lt;p&gt;I don&apos;t think so Ben (on both counts). &lt;/p&gt;

&lt;p&gt;Has this been reviewed fully? I&apos;m looking at it now for the first time and I notice a pretty serious issue right off the bat.&lt;/p&gt;

&lt;p&gt;Given the docs say the following for nanotime &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;This method can only be used to measure elapsed time and is not related to any other notion of system or wall-clock time.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;the following is going to be a major headache:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;                 cnxn.updateStatsForResponse(request.cxid, request.zxid, lastOp,
-                        request.createTime, System.currentTimeMillis());
+                        request.createTime, Time.currentElapsedTime());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We shouldn&apos;t be using nanotime in any place where we display a date/time to a user. (ie ONLY use it to measure elapsed time)&lt;/p&gt;


&lt;p&gt;I think we should just put this into trunk only.&lt;/p&gt;</comment>
                            <comment id="13193540" author="tdunning" created="Thu, 26 Jan 2012 03:53:24 +0000"  >&lt;p&gt;Pat is right that this should not be used as a substitute for elapsed time.&lt;/p&gt;

&lt;p&gt;I think that the right ways to proceed are to either&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;mark all of the changes with TODO&apos;s that can be removed progressively (risk of not finishing)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;do a comprehensive review now&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Option 1 should only be committed to trunk and only back ported when done.  Option 2 delays the commit for an important operational issue.&lt;/p&gt;</comment>
                            <comment id="13193557" author="phunt" created="Thu, 26 Jan 2012 05:23:47 +0000"  >&lt;p&gt;This issue has been in the code base since day one, a few weeks or even months spent getting it right aren&apos;t going to hurt anything. Also given the &quot;devil you know&quot; aspect of this, the fact it&apos;s so cross-cutting, i&apos;d push this into trunk and only consider it for backporting into a fix release once it&apos;s been well proven.&lt;/p&gt;</comment>
                            <comment id="13193558" author="breed" created="Thu, 26 Jan 2012 05:39:50 +0000"  >&lt;p&gt;i don&apos;t think we should commit with TODO&apos;s. it shouldn&apos;t be hard to go through them before we commit.&lt;/p&gt;

&lt;p&gt;in the line that pat identified, it is passing the correct thing operationally, but it does mess up the last response time. do we want to add a System.currentTimeMillis() just to get the correct last response time? we could actually convert the time in getLastResponseTime() using System.currentTimeMillis() - (Time.currentElapsedTime()-lastResponseTime), so that the extra call to currentTimeMillis would only happen on getLastResponseTime, which happens very infrequently.&lt;/p&gt;</comment>
                            <comment id="13193571" author="phunt" created="Thu, 26 Jan 2012 05:54:48 +0000"  >&lt;p&gt;It seems like Timer/elapsedTime should be wrapped with some abstraction that keeps this problem from happening w/o making it explicit. Rather than passing a long around say, it would instead have a &quot;TimerStart startElapsedTime()&quot; pass TimerStart around, then eventually &quot;timerStart.elapsed()&quot; which returns a long. This would keep us from making the same mistake in other places (well, w/o making it explicit).&lt;/p&gt;</comment>
                            <comment id="13194005" author="breed" created="Thu, 26 Jan 2012 17:27:57 +0000"  >&lt;p&gt;i don&apos;t like that idea. if we have to go that direction i would much rather use Date in cases where it will be human readable, but i&apos;m not really a fan of that either. there are very few places that we need System.currentTimeMillis() lets just fix those. did we just put getLastResponseTime in the connection statistics because we happened to have it or because someone requested it?&lt;/p&gt;</comment>
                            <comment id="13194231" author="jiraposter@reviews.apache.org" created="Thu, 26 Jan 2012 22:39:40 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/3648/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/3648/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for zookeeper.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1366&quot; title=&quot;Zookeeper should be tolerant of clock adjustments&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1366&quot;&gt;&lt;del&gt;ZOOKEEPER-1366&lt;/del&gt;&lt;/a&gt;. Zookeeper should be tolerant of clock adjustments&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1366&quot; title=&quot;Zookeeper should be tolerant of clock adjustments&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1366&quot;&gt;&lt;del&gt;ZOOKEEPER-1366&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1366&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/ZOOKEEPER-1366&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  src/java/main/org/apache/zookeeper/ClientCnxn.java 6c25e40 &lt;br/&gt;
  src/java/main/org/apache/zookeeper/ClientCnxnSocket.java 269f8e8 &lt;br/&gt;
  src/java/main/org/apache/zookeeper/Login.java 6d2a38c &lt;br/&gt;
  src/java/main/org/apache/zookeeper/Shell.java f2c899a &lt;br/&gt;
  src/java/main/org/apache/zookeeper/ZKUtil.java 4713a08 &lt;br/&gt;
  src/java/main/org/apache/zookeeper/common/Time.java PRE-CREATION &lt;br/&gt;
  src/java/main/org/apache/zookeeper/server/FinalRequestProcessor.java 9721f7c &lt;br/&gt;
  src/java/main/org/apache/zookeeper/server/Request.java c6a2249 &lt;br/&gt;
  src/java/main/org/apache/zookeeper/server/ServerStats.java acbc97c &lt;br/&gt;
  src/java/main/org/apache/zookeeper/server/SessionTrackerImpl.java cbae57a &lt;br/&gt;
  src/java/main/org/apache/zookeeper/server/ZooKeeperServer.java 14f8c8f &lt;br/&gt;
  src/java/main/org/apache/zookeeper/server/quorum/AuthFastLeaderElection.java 8ba12c5 &lt;br/&gt;
  src/java/main/org/apache/zookeeper/server/quorum/FastLeaderElection.java 473d01e &lt;br/&gt;
  src/java/main/org/apache/zookeeper/server/quorum/Follower.java 29ef3f9 &lt;br/&gt;
  src/java/main/org/apache/zookeeper/server/quorum/Leader.java 27a5d20 &lt;br/&gt;
  src/java/systest/org/apache/zookeeper/test/system/GenerateLoad.java 57d0dcb &lt;br/&gt;
  src/java/systest/org/apache/zookeeper/test/system/InstanceManager.java 809fa48 &lt;br/&gt;
  src/java/systest/org/apache/zookeeper/test/system/SimpleSysTest.java 9cdf4d9 &lt;br/&gt;
  src/java/test/org/apache/zookeeper/common/TimeTest.java PRE-CREATION &lt;br/&gt;
  src/java/test/org/apache/zookeeper/server/quorum/QuorumPeerMainTest.java c2cfd7a &lt;br/&gt;
  src/java/test/org/apache/zookeeper/test/ClientBase.java 02638a1 &lt;br/&gt;
  src/java/test/org/apache/zookeeper/test/ClientHammerTest.java b807dbb &lt;br/&gt;
  src/java/test/org/apache/zookeeper/test/CnxManagerTest.java fd59403 &lt;br/&gt;
  src/java/test/org/apache/zookeeper/test/LoadFromLogTest.java 8e0b0eb &lt;br/&gt;
  src/java/test/org/apache/zookeeper/test/ReadOnlyModeTest.java c705a7b &lt;br/&gt;
  src/java/test/org/apache/zookeeper/test/StaticHostProviderTest.java 1fed88a &lt;br/&gt;
  src/java/test/org/apache/zookeeper/test/TestHammer.java 09a678b &lt;br/&gt;
  src/java/test/org/apache/zookeeper/test/ZooKeeperTestClient.java cc82c87 &lt;br/&gt;
  src/recipes/queue/src/c/tests/Util.cc 26a9a09 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/3648/diff&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/3648/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Benjamin&lt;/p&gt;
</comment>
                            <comment id="13194248" author="breed" created="Thu, 26 Jan 2012 23:01:01 +0000"  >&lt;p&gt;for some reason the review board comments didn&apos;t come through, but they are on review board.&lt;/p&gt;

&lt;p&gt;i think Login.java should all be based on wall time since i think that is what kerberos is based on. perhaps eugene can comment on this.&lt;/p&gt;

&lt;p&gt;in ZooKeeperServer.java getTime() should return the wall time since that is used for the mtime.&lt;/p&gt;

&lt;p&gt;in GenerateLoad.java when we print the timestamp we probably should be doing wall time, but since we don&apos;t format it, it probably doesn&apos;t matter much.&lt;/p&gt;

&lt;p&gt;in LoadFromLogTest.java when we do datatree ops, usually the second to the last parameter is the wall time.&lt;/p&gt;

&lt;p&gt;you missed one change to elapsed time in the ReadOnlyModeTest.java&lt;/p&gt;

&lt;p&gt;one file that isn&apos;t in the patch that we need to fix is ServerCnxn.java. i think lastResponseTime should have a comment to say that it is the system time and we can make getLastResponseTime() return the wall time using &quot;return System.currentMillis() - (Time.currentElapsedTime() - lastResponseTime);&quot;&lt;/p&gt;

&lt;p&gt;after crawling through everything, i think it would be nice if Time also had Time.currentWallTime() that did System.currentMillis(). that way if we saw an instance of System.currentMillis() in the code it would be a flag that the use should be reviewed.&lt;/p&gt;

&lt;p&gt;oh and we should probably create a jira to fix the C client.&lt;/p&gt;</comment>
                            <comment id="13194251" author="tdunning" created="Thu, 26 Jan 2012 23:04:23 +0000"  >&lt;p&gt;I can put another method in Time that is the same as currentTimeMillis, but which does the time skew thing (sounds like Rocky Horror to me)&lt;/p&gt;</comment>
                            <comment id="13194296" author="phunt" created="Thu, 26 Jan 2012 23:59:30 +0000"  >&lt;p&gt;Hi Ben:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;i don&apos;t like that idea.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;why not? it would make it explicit and keep this from happening again. (one would hope) Similar to Date, except in this case we&apos;re capturing the concept of elapsed time. It seems like it might also make things more testable (the impl could be mucked with, mocked, etc...).&lt;/p&gt;</comment>
                            <comment id="13194300" author="phunt" created="Fri, 27 Jan 2012 00:07:28 +0000"  >&lt;p&gt;Here&apos;s an example from Hadoop, specifically to enable what i&apos;m talking about - testability: org/apache/hadoop/mapred/Clock.java&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;/**
 * A clock class - can be mocked out for testing.
 */
class Clock {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13195026" author="mahadev" created="Fri, 27 Jan 2012 19:11:03 +0000"  >&lt;p&gt;Pat/Ben,&lt;br/&gt;
 I think the issue here is the api with Clock. The static api is one that ruins mocking in it. In Hadoop we make sure we pass around the same clock object when creating all the sub sequent objects (the constructs in MR next gen are more DI compliant). We could try doing that here but again I think its a bit of an effort (should be manual work). But as Henry/Camille mentioned we could do that in another jira. I think thats the right solution instead of creating another layer which hides the longs (as Pat suggested).&lt;/p&gt;</comment>
                            <comment id="13203309" author="breed" created="Wed, 8 Feb 2012 06:28:51 +0000"  >&lt;p&gt;agreed. i think also that you can still mock a static api if you provide a method and interface to allow the implementation to get the time from a user provided object. but again that is a different issue.&lt;/p&gt;

&lt;p&gt;for now i would really really like to get this in asap. it&apos;s a shame that it missed the next release since this is a real problem that we have a fix for. even without the C client, the big problem is what happens at the server with the session timeouts and this patch fixes that problem.&lt;/p&gt;</comment>
                            <comment id="13203348" author="tdunning" created="Wed, 8 Feb 2012 08:06:13 +0000"  >&lt;p&gt;On the off topic of mocking, I was just able to mock System.nanoTime directly using jmockit.  Very easy to do.&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://github.com/tdunning/storm-counts/blob/master/src/test/java/com/mapr/storm/Fake.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tdunning/storm-counts/blob/master/src/test/java/com/mapr/storm/Fake.java&lt;/a&gt; especially Fake.clock near the bottom.  Fake.clock() returns an object that adjusts the value that is returned by System.nanoTime().  I haven&apos;t verified that the effect goes away at the end of the test, but jmockit usually handles that correctly.&lt;/p&gt;
</comment>
                            <comment id="13500520" author="tdunning" created="Mon, 19 Nov 2012 19:16:19 +0000"  >&lt;p&gt;This patch never got committed.  It should have been committed long ago.&lt;/p&gt;

&lt;p&gt;I am happy to resurrect it.  Which branches should I generate patches for?&lt;/p&gt;</comment>
                            <comment id="13500642" author="marshall" created="Mon, 19 Nov 2012 20:50:46 +0000"  >&lt;p&gt;I think there are changes in the C client that should be made as well to make it more resilent to clock adjustments as well. Doesn&apos;t look like any of those were accounted for under this patch.&lt;/p&gt;</comment>
                            <comment id="13559003" author="cmccabe" created="Mon, 21 Jan 2013 19:19:33 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think there are changes in the C client that should be made as well to make it more resilent to clock adjustments as well. Doesn&apos;t look like any of those were accounted for under this patch.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I filed &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1626&quot; title=&quot;Zookeeper C client should be tolerant of clock adjustments &quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1626&quot;&gt;&lt;del&gt;ZOOKEEPER-1626&lt;/del&gt;&lt;/a&gt; to deal with the C client changes.&lt;/p&gt;</comment>
                            <comment id="13575664" author="breed" created="Mon, 11 Feb 2013 08:07:01 +0000"  >&lt;p&gt;i was just reviewing this issue and reading my comments that i had recently made. and they sounded like me but i couldn&apos;t remember making them last month. then i realized that i made them in 2012!!! we really need to get this patch in. is someone working on it?&lt;/p&gt;</comment>
                            <comment id="13583950" author="marshall" created="Fri, 22 Feb 2013 06:13:04 +0000"  >&lt;p&gt;This has become a blocker issues for us, so I&apos;m resurrecting this patch so it applies cleanly to the tip of trunk (r1448845). &lt;/p&gt;

&lt;p&gt;Three issues:&lt;/p&gt;

&lt;p&gt;(1) A few unit tests are failing (on my local machine at least) and I can&apos;t readily tell what&apos;s wrong. I would really like Ted (or someone else) to look at these failures.&lt;/p&gt;

&lt;p&gt;(2) I did NOT go through and find other uses of System.currentTimeMillis to see if they should be converted to Time.currentElapsedTime(). I think someone more knowledgeable should look these over with a fine tooth comb.&lt;/p&gt;

&lt;p&gt;(3) Ted&apos;s original patch made changes to SessionTrackerImpl.java but those parts of that file that were originally patched don&apos;t seem to be present anymore. It looks to me like that code was moved into ExpiryQueue.java. I&apos;d really like some to take a close look at that as well.&lt;/p&gt;

&lt;p&gt;Any assistance with these three issues is extremely appreciated!!&lt;/p&gt;</comment>
                            <comment id="13583970" author="hadoopqa" created="Fri, 22 Feb 2013 06:45:21 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12570423/ZOOKEEPER-1366.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12570423/ZOOKEEPER-1366.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1448007.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 49 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1403//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1403//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1403//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1403//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1403//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1403//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13583975" author="marshall" created="Fri, 22 Feb 2013 06:52:33 +0000"  >&lt;p&gt;This should fix the failing TimeTest that was missing @Test.&lt;/p&gt;</comment>
                            <comment id="13584031" author="hadoopqa" created="Fri, 22 Feb 2013 07:02:46 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12570427/ZOOKEEPER-1366.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12570427/ZOOKEEPER-1366.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1448007.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 49 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    -1 javac.  The patch appears to cause tar ant target to fail.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1404//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1404//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1404//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1404//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1404//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1404//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13584515" author="marshall" created="Fri, 22 Feb 2013 18:31:06 +0000"  >&lt;p&gt;Fix compile failure in TestTime&lt;/p&gt;</comment>
                            <comment id="13584557" author="hadoopqa" created="Fri, 22 Feb 2013 19:09:09 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12570508/ZOOKEEPER-1366.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12570508/ZOOKEEPER-1366.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1448007.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 49 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1405//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1405//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1405//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1405//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1405//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1405//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13584559" author="marshall" created="Fri, 22 Feb 2013 19:10:36 +0000"  >&lt;p&gt;My latest patch fixes all the unit test failures. &lt;/p&gt;

&lt;p&gt;My prior two statements still apply:&lt;/p&gt;</comment>
                            <comment id="13584560" author="marshall" created="Fri, 22 Feb 2013 19:11:03 +0000"  >&lt;p&gt;My prior two caveats still apply:&lt;/p&gt;

&lt;p&gt;(2) I did NOT go through and find other uses of System.currentTimeMillis to see if they should be converted to Time.currentElapsedTime(). I think someone more knowledgeable should look these over with a fine tooth comb.&lt;/p&gt;

&lt;p&gt;(3) Ted&apos;s original patch made changes to SessionTrackerImpl.java but those parts of that file that were originally patched don&apos;t seem to be present anymore. It looks to me like that code was moved into ExpiryQueue.java. I&apos;d really like some to take a close look at that as well.&lt;br/&gt;
Any assistance with these three issues is extremely appreciated!!&lt;/p&gt;</comment>
                            <comment id="13586081" author="hadoopqa" created="Mon, 25 Feb 2013 18:19:21 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12570508/ZOOKEEPER-1366.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12570508/ZOOKEEPER-1366.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1448007.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 49 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1408//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1408//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1408//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1408//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1408//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1408//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13710776" author="yehangjun" created="Wed, 17 Jul 2013 06:28:08 +0000"  >&lt;p&gt;Not committed yet?&lt;/p&gt;</comment>
                            <comment id="13729938" author="cls" created="Mon, 5 Aug 2013 21:06:02 +0000"  >&lt;p&gt;This issue has hit critical mass for us as well and we need the fix applied against a current stable release tree. I took the patch from 2013-02-22-10:31 and applied it to the 3.4.5 tree.  &lt;/p&gt;

&lt;p&gt;I looked at the remaining System.currentTimeMillis() calls and fixed a couple of instances.  The remaining calls are made in: &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;the MergedLogSource() console output&lt;/li&gt;
	&lt;li&gt;the LeaderElectionSupportTest.java test which uses the value as part of a unique identifier&lt;/li&gt;
	&lt;li&gt;the TimeTest.java test which makes sure that Time.currentElapsedTime() works as advertised.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So far, I&apos;ve only done the simple &lt;span class=&quot;error&quot;&gt;&amp;#91;date -s &amp;quot;+1hour&amp;quot;&amp;#93;&lt;/span&gt; test and that passed. I&apos;ll let you know if we hit any other issues.&lt;/p&gt;</comment>
                            <comment id="13729942" author="hadoopqa" created="Mon, 5 Aug 2013 21:07:45 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12596213/zookeeper-3.4.5-ZK1366-SC01.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12596213/zookeeper-3.4.5-ZK1366-SC01.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1503101.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 52 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1527//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1527//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13757211" author="asadpanda" created="Tue, 3 Sep 2013 23:10:50 +0000"  >&lt;p&gt;These patches will break Kerberos login. It mixes monotonic and actual time.&lt;/p&gt;</comment>
                            <comment id="13757489" author="tdunning" created="Wed, 4 Sep 2013 06:11:18 +0000"  >&lt;p&gt;Why do you say this?&lt;/p&gt;

&lt;p&gt;What scenario would cause a breakage?&lt;/p&gt;
</comment>
                            <comment id="13759315" author="asadpanda" created="Thu, 5 Sep 2013 18:56:15 +0000"  >&lt;p&gt;A few issues with this patch. It is much broader than it should be.&lt;/p&gt;

&lt;p&gt;In Login.java: 2 timesources are being utilized and incorrectly compared:&lt;br/&gt;
Time.currentElapsedTime is not compatible with the (KerberosTicket).getEndTime which will return the expiry based on the system time. The 2 time values are compared in the following block&lt;/p&gt;

&lt;p&gt;&amp;#8211;&lt;br/&gt;
                        if (nextRefresh &amp;gt; expiry) {&lt;br/&gt;
                            LOG.error(&quot;next refresh: &quot; + nextRefreshDate + &quot; is later than expiry &quot; + expiryDate&lt;br/&gt;
                                    + &quot;. This may indicate a clock skew problem. Check that this host and the KDC&apos;s &quot;&lt;br/&gt;
                                    + &quot;hosts&apos; clocks are in sync. Exiting refresh thread.&quot;);&lt;br/&gt;
                            return;&lt;br/&gt;
&amp;#8211;&lt;/p&gt;

&lt;p&gt;ZookeeperServer::getTime: Utilization of Time.currentElapsedTime here will lead to unusable timestamps for the mtime and ctime for nodes. DataTree::processTxn uses the TxnHeader.time to populate the Stat structure. TxnHeader.time is assigned by PrepRequestProcessor::pRequest2Txn using ZookeeperServer.getTime.&lt;/p&gt;</comment>
                            <comment id="13978948" author="michim" created="Wed, 23 Apr 2014 21:41:12 +0000"  >&lt;p&gt;Updated the patch so that it applies cleanly, and addressed Asad&apos;s comment.&lt;/p&gt;</comment>
                            <comment id="13978959" author="michim" created="Wed, 23 Apr 2014 21:52:17 +0000"  >&lt;p&gt;review: &lt;a href=&quot;https://reviews.apache.org/r/20635/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/20635/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We should fix this in 3.5.&lt;/p&gt;</comment>
                            <comment id="13978968" author="rgs" created="Wed, 23 Apr 2014 21:59:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=michim&quot; class=&quot;user-hover&quot; rel=&quot;michim&quot;&gt;michim&lt;/a&gt;: I think the RB is missing some new files (i.e.: Time.java), no?&lt;/p&gt;</comment>
                            <comment id="13978977" author="michim" created="Wed, 23 Apr 2014 22:04:06 +0000"  >&lt;p&gt;... that&apos;s what I get for not using &apos;svn patch&apos; command. Thanks for catching Raul. I&apos;ll re-upload the patch to reviewboard.&lt;/p&gt;</comment>
                            <comment id="13979013" author="hadoopqa" created="Wed, 23 Apr 2014 22:25:07 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12641585/ZOOKEEPER-1366.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12641585/ZOOKEEPER-1366.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1588584.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 48 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2056//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2056//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2056//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2056//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2056//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2056//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13979040" author="hadoopqa" created="Wed, 23 Apr 2014 22:49:30 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12641585/ZOOKEEPER-1366.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12641585/ZOOKEEPER-1366.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1588584.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 48 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2057//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2057//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2057//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2057//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2057//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2057//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14074676" author="hadoopqa" created="Fri, 25 Jul 2014 17:55:20 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12641585/ZOOKEEPER-1366.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12641585/ZOOKEEPER-1366.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1613474.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 48 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2236//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2236//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14074973" author="phunt" created="Fri, 25 Jul 2014 21:36:31 +0000"  >&lt;p&gt;Minor update to address conflict.&lt;/p&gt;</comment>
                            <comment id="14075021" author="rgs" created="Fri, 25 Jul 2014 22:08:06 +0000"  >&lt;p&gt;Some nits:&lt;/p&gt;

&lt;p&gt;Lines too long (&amp;gt; 80):&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+    /**
+     * Returns time in milliseconds as does System.currentTimeMillis(), but uses elapsed time from an arbitrary epoch
+     * more like System.nanoTime().  The difference is that if somebody changes the system clock, Time.currentElapsedTime
+     * will change but nanoTime won&apos;t.  On the other hand, all of ZK assumes that time is measured in milliseconds.
+     * @return  The time in milliseconds from some arbitrary point in time.
+     */
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Might as well put the comment outside of the method:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;     long getTime() {
+        // This method doesn&apos;t use Time.currentElapsedTime() because it&apos;s used
+        // to set znode ctime and mtime.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Long lines:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+        Assert.assertEquals(Time.currentElapsedTime() - nt0, System.currentTimeMillis() - mt0, 10);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+     * While running this, try changing the clock forward using something like [date -s &quot;+1hour&quot;].
+     * On a zookeeper that uses currentTimeMillis(), this will cause all ephemerals to be deleted
+     * due to session expiration.  With the use of nanoTime instead, zookeeper is unphased.
+     *
+     * @param args  Not used.
+     * @throws Exception Not really.  In fact, the only exceptions are InterruptedException, KeeperException
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ditto:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+            System.out.printf(&quot;%d\t%s\n&quot;, discrepancy(), zk.exists(&quot;/ephemeral&quot;, watchCount.get() == 0 ? createWatcher() : null) != null);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Consistent spaces around + operator:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+            LOG.info(&quot;Elapsed &quot;+(end - start) + &quot; ms: &quot; + message);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14075064" author="hadoopqa" created="Fri, 25 Jul 2014 22:32:38 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12657908/ZOOKEEPER-1366.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12657908/ZOOKEEPER-1366.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1613474.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 49 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2237//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2237//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2237//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2237//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2237//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2237//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14075128" author="phunt" created="Fri, 25 Jul 2014 23:28:00 +0000"  >&lt;p&gt;It looks like some additional uses of System.currentTimeMillis has come into the code since this patch was last updated.&lt;/p&gt;

&lt;p&gt;We&apos;ll need to investigate that as well as incorporating Raul&apos;s feedback.&lt;/p&gt;</comment>
                            <comment id="14075158" author="phunt" created="Sat, 26 Jul 2014 00:18:47 +0000"  >&lt;p&gt;Updated with Raul&apos;s formatting comments, but still need to address use of System.currentTimeMillis in the code. (new uses? see my recent comment)&lt;/p&gt;</comment>
                            <comment id="14299708" author="rakeshr" created="Sat, 31 Jan 2015 07:29:34 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tdunning&quot; class=&quot;user-hover&quot; rel=&quot;tdunning&quot;&gt;tdunning&lt;/a&gt; for the patch, have you had a chance to consider the last batch of comments? &lt;/p&gt;</comment>
                            <comment id="14300826" author="tdunning" created="Mon, 2 Feb 2015 02:29:56 +0000"  >

&lt;p&gt;Actually, no.  I hadn&apos;t considered them.  In fact, I had pretty much given up on this patch since it was ignored for two years after it caused a major P1 outage at multiple sites.  I figured it was just me that considered it important enough to try to fix.&lt;/p&gt;

&lt;p&gt;And at this point, I don&apos;t have time to update the patch.  Check with Patrick or Michi.&lt;/p&gt;


&lt;p&gt;(I am only vaguely sorry about being snippy here.  This was an egregious case of ignoring a fairly valid patch on an important issue).&lt;/p&gt;</comment>
                            <comment id="14300877" author="rakeshr" created="Mon, 2 Feb 2015 04:51:57 +0000"  >&lt;p&gt;Thanks again &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tdunning&quot; class=&quot;user-hover&quot; rel=&quot;tdunning&quot;&gt;tdunning&lt;/a&gt; for the reply and the effort you had put so far. I feel this is important, will see the opinion from others as well.&lt;/p&gt;</comment>
                            <comment id="14300878" author="rakeshr" created="Mon, 2 Feb 2015 04:52:01 +0000"  >&lt;p&gt;Thanks again &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tdunning&quot; class=&quot;user-hover&quot; rel=&quot;tdunning&quot;&gt;tdunning&lt;/a&gt; for the reply and the effort you had put so far. I feel this is important, will see the opinion from others as well.&lt;/p&gt;</comment>
                            <comment id="14300879" author="rakeshr" created="Mon, 2 Feb 2015 04:52:01 +0000"  >&lt;p&gt;Thanks again &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tdunning&quot; class=&quot;user-hover&quot; rel=&quot;tdunning&quot;&gt;tdunning&lt;/a&gt; for the reply and the effort you had put so far. I feel this is important, will see the opinion from others as well.&lt;/p&gt;</comment>
                            <comment id="14301589" author="fpj" created="Mon, 2 Feb 2015 18:22:47 +0000"  >&lt;p&gt;This is a pretty long jira, and it is unfortunate that it has been cooking for so long. Perhaps someone else could pick it up and finish the patch, since Ted is already burned out (understandably)?&lt;/p&gt;</comment>
                            <comment id="14301887" author="marshall" created="Mon, 2 Feb 2015 20:44:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;fpj&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=phunt&quot; class=&quot;user-hover&quot; rel=&quot;phunt&quot;&gt;phunt&lt;/a&gt; - I would be happy to take the lead on this Jira as it&apos;s very important to us internally. My current week is rather swamped with other things, but I think I&apos;d be able to pick this up after things quiet down here in the next week or so. If someone else has more time and wants to take this before I have the opportunity they are welcome to. Otherwise in the next week or so when things quiet down I&apos;ll look at taking this Jira.&lt;/p&gt;</comment>
                            <comment id="14301972" author="fpj" created="Mon, 2 Feb 2015 21:33:07 +0000"  >&lt;p&gt;Since this jira has been sitting here for so long, a couple of weeks won&apos;t make much of a difference. But sure, let&apos;s keep it open for others to pick it up until you&apos;re free, and thanks for volunteering in any case, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marshall&quot; class=&quot;user-hover&quot; rel=&quot;marshall&quot;&gt;marshall&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14302095" author="hdeng" created="Mon, 2 Feb 2015 22:49:31 +0000"  >&lt;p&gt;I realized there is still a few calls of currentTimeMillis() after applying the patch.&lt;br/&gt;
The patch is almost done. I would like to investigate those calls and come down with a new patch.&lt;/p&gt;</comment>
                            <comment id="14302605" author="phunt" created="Tue, 3 Feb 2015 01:05:33 +0000"  >&lt;p&gt;It should be ok to have calls to currentTimeMillis - if the call is associated with wall clock time (like the time/datestamp of a znode creation). nanoTime should be used whenever these is &quot;elapsed time&quot; to consider. E.g. session expiration.&lt;/p&gt;

&lt;p&gt;Would be great to see someone pick this up - would be a great addition to 3.5.&lt;/p&gt;</comment>
                            <comment id="14302775" author="rakeshr" created="Tue, 3 Feb 2015 05:02:28 +0000"  >&lt;p&gt;+1 pushing to 3.5 branch. I&apos;m happy to help you in reviews and push this in.&lt;/p&gt;</comment>
                            <comment id="14303761" author="hadoopqa" created="Tue, 3 Feb 2015 18:57:12 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12696230/ZOOKEEPER-1366.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12696230/ZOOKEEPER-1366.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1656167.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 46 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2505//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2505//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2505//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2505//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2505//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2505//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14303789" author="hdeng" created="Tue, 3 Feb 2015 19:14:26 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I have uploaded my patch to review board: &lt;a href=&quot;https://reviews.apache.org/r/30573/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/30573/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Most of the code are based on previous patch. I made the changes to the System.currentTimeMillis() added after previous patch and checked them out with Patrick. Added some docs. And renamed all System.currentTimeMillis() to Time.currentWallTime() to make it explicit.&lt;/p&gt;

&lt;p&gt;The tests are irrelevant. Though one is added by me and it&apos;s really flaky now... I will try to fix it at the Netty part.&lt;/p&gt;</comment>
                            <comment id="14303791" author="hdeng" created="Tue, 3 Feb 2015 19:16:14 +0000"  >&lt;p&gt;Please help review the code and give feedback. Thanks!&lt;/p&gt;</comment>
                            <comment id="14303795" author="hdeng" created="Tue, 3 Feb 2015 19:20:58 +0000"  >&lt;p&gt;I have also tested with Ted&apos;s command line program mentioned above.&lt;/p&gt;</comment>
                            <comment id="14304692" author="hdeng" created="Wed, 4 Feb 2015 06:24:33 +0000"  >&lt;p&gt;RB: &lt;a href=&quot;https://reviews.apache.org/r/30573/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/30573/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Can anyone help review this?&lt;/p&gt;</comment>
                            <comment id="14304731" author="hadoopqa" created="Wed, 4 Feb 2015 07:16:13 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12696393/ZOOKEEPER-1366.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12696393/ZOOKEEPER-1366.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1656167.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 46 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2506//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2506//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2506//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2506//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2506//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2506//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14304763" author="marshall" created="Wed, 4 Feb 2015 08:02:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hdeng&quot; class=&quot;user-hover&quot; rel=&quot;hdeng&quot;&gt;hdeng&lt;/a&gt; - I will be happy to help review this tomorrow. It&apos;s important to us to pick up this fix as well so I&apos;d love to see this rolled into the 3.5 release. I&apos;ll make sure to review this and add comments to the review tomorrow.&lt;/p&gt;</comment>
                            <comment id="14306017" author="hdeng" created="Wed, 4 Feb 2015 21:40:26 +0000"  >&lt;p&gt;Addressed Rakesh&apos;s comments and uploaded a new patch.&lt;/p&gt;

&lt;p&gt;Great to have you to review, thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marshall&quot; class=&quot;user-hover&quot; rel=&quot;marshall&quot;&gt;marshall&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="14306132" author="hadoopqa" created="Wed, 4 Feb 2015 22:38:00 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12696567/ZOOKEEPER-1366.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12696567/ZOOKEEPER-1366.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1656167.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 46 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2507//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2507//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2507//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2507//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2507//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2507//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14306264" author="hadoopqa" created="Thu, 5 Feb 2015 00:06:11 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12696597/ZOOKEEPER-1366.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12696597/ZOOKEEPER-1366.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1656167.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 46 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2508//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2508//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2508//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2508//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2508//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2508//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14306323" author="hdeng" created="Thu, 5 Feb 2015 00:38:49 +0000"  >&lt;p&gt;Some whitespace fix too.&lt;/p&gt;

&lt;p&gt;RB: &lt;a href=&quot;https://reviews.apache.org/r/30573/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/30573/diff/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14306389" author="hadoopqa" created="Thu, 5 Feb 2015 01:27:03 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12696625/ZOOKEEPER-1366.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12696625/ZOOKEEPER-1366.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1656167.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 46 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2509//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2509//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2509//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2509//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2509//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2509//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14307477" author="marshall" created="Thu, 5 Feb 2015 16:13:53 +0000"  >&lt;p&gt;I reviewed this on review board as well. Only a couple of minor comments. Overall looks very very good. +1.&lt;/p&gt;</comment>
                            <comment id="14307623" author="hdeng" created="Thu, 5 Feb 2015 17:37:50 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marshall&quot; class=&quot;user-hover&quot; rel=&quot;marshall&quot;&gt;marshall&lt;/a&gt; for the comments.&lt;br/&gt;
Fix it and upload a new patch.&lt;/p&gt;

&lt;p&gt;I messed up with previous RB. So opened a new one:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/30677/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/30677/diff/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14307646" author="marshall" created="Thu, 5 Feb 2015 17:53:40 +0000"  >&lt;p&gt;Latest version looks great to me. &lt;/p&gt;</comment>
                            <comment id="14307674" author="hdeng" created="Thu, 5 Feb 2015 18:09:35 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;rakeshr&lt;/a&gt;.&lt;br/&gt;
Can you help take a review too?&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/30677/diff/G&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/30677/diff/G&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14307701" author="hadoopqa" created="Thu, 5 Feb 2015 18:25:48 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12696794/ZOOKEEPER-1366.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12696794/ZOOKEEPER-1366.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1656167.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 46 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2512//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2512//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2512//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2512//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2512//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2512//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14307758" author="rakeshr" created="Thu, 5 Feb 2015 18:51:31 +0000"  >&lt;p&gt;+1 latest patch looks good to me&lt;/p&gt;</comment>
                            <comment id="14308524" author="hdeng" created="Fri, 6 Feb 2015 03:08:15 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=michim&quot; class=&quot;user-hover&quot; rel=&quot;michim&quot;&gt;michim&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Thanks for your attention to the issue. Patch on RB:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/30677/diff/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/30677/diff/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You are cordially welcome to review and give feedback.&lt;/p&gt;</comment>
                            <comment id="14308633" author="michim" created="Fri, 6 Feb 2015 05:16:04 +0000"  >&lt;p&gt;+1 Thanks Hongchao!&lt;/p&gt;</comment>
                            <comment id="14308639" author="michim" created="Fri, 6 Feb 2015 05:19:36 +0000"  >&lt;p&gt;trunk: &lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1657745&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1657745&lt;/a&gt;&lt;br/&gt;
branch-3.5: &lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1657746&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1657746&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14308687" author="rakeshr" created="Fri, 6 Feb 2015 06:22:44 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hdeng&quot; class=&quot;user-hover&quot; rel=&quot;hdeng&quot;&gt;hdeng&lt;/a&gt;, all others for quickly fixing this issue.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=michim&quot; class=&quot;user-hover&quot; rel=&quot;michim&quot;&gt;michim&lt;/a&gt; there is one subtask in OPEN state for changing C library part - &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1626&quot; title=&quot;Zookeeper C client should be tolerant of clock adjustments &quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1626&quot;&gt;&lt;del&gt;ZOOKEEPER-1626&lt;/del&gt;&lt;/a&gt;. I feel its good to keep the parent jira in open state until all the sub-tasks is completed.  Either we can re-open this parent jira task or will move the sub-task &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1626&quot; title=&quot;Zookeeper C client should be tolerant of clock adjustments &quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1626&quot;&gt;&lt;del&gt;ZOOKEEPER-1626&lt;/del&gt;&lt;/a&gt; to a main jira and work on until it is closed. Whats your opinion?&lt;/p&gt;</comment>
                            <comment id="14308985" author="hudson" created="Fri, 6 Feb 2015 11:15:24 +0000"  >&lt;p&gt;FAILURE: Integrated in ZooKeeper-trunk #2587 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/2587/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/2587/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1366&quot; title=&quot;Zookeeper should be tolerant of clock adjustments&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1366&quot;&gt;&lt;del&gt;ZOOKEEPER-1366&lt;/del&gt;&lt;/a&gt; Zookeeper should be tolerant of clock adjustments (Hongchao Deng via michim) (michim: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1657745&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1657745&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/ClientCnxn.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/ClientCnxnSocket.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/Login.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/Shell.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/ZKUtil.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/common/Time.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/ConnectionBean.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/ExpiryQueue.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/FinalRequestProcessor.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/RateLogger.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/Request.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/ServerStats.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/SessionTrackerImpl.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/WorkerService.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/ZKDatabase.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/ZooKeeperServer.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/quorum/AuthFastLeaderElection.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/quorum/FastLeaderElection.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/quorum/Follower.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/quorum/Leader.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/quorum/LearnerSnapshotThrottler.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/quorum/QuorumPeer.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/systest/org/apache/zookeeper/test/system/GenerateLoad.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/systest/org/apache/zookeeper/test/system/InstanceManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/systest/org/apache/zookeeper/test/system/SimpleSysTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/common/TimeTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/server/quorum/QuorumPeerMainTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/test/ClientBase.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/test/ClientHammerTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/test/CnxManagerTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/test/LoadFromLogTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/test/ReadOnlyModeTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/test/StaticHostProviderTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/test/TestHammer.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/test/ZooKeeperTestClient.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12422019">ZOOKEEPER-366</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12626687">ZOOKEEPER-1616</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12628594">ZOOKEEPER-1626</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="13069006">ZOOKEEPER-2774</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12511220" name="ZOOKEEPER-1366-3.3.3.patch" size="10758" author="tdunning" created="Fri, 20 Jan 2012 03:49:47 +0000"/>
                            <attachment id="12696794" name="ZOOKEEPER-1366.patch" size="61691" author="hdeng" created="Thu, 5 Feb 2015 17:31:57 +0000"/>
                            <attachment id="12696625" name="ZOOKEEPER-1366.patch" size="59373" author="hdeng" created="Thu, 5 Feb 2015 00:38:49 +0000"/>
                            <attachment id="12696597" name="ZOOKEEPER-1366.patch" size="58376" author="hdeng" created="Wed, 4 Feb 2015 23:15:39 +0000"/>
                            <attachment id="12696567" name="ZOOKEEPER-1366.patch" size="58074" author="hdeng" created="Wed, 4 Feb 2015 21:39:34 +0000"/>
                            <attachment id="12696393" name="ZOOKEEPER-1366.patch" size="56756" author="hdeng" created="Wed, 4 Feb 2015 06:24:33 +0000"/>
                            <attachment id="12696230" name="ZOOKEEPER-1366.patch" size="56392" author="hdeng" created="Tue, 3 Feb 2015 17:59:58 +0000"/>
                            <attachment id="12657952" name="ZOOKEEPER-1366.patch" size="45717" author="phunt" created="Sat, 26 Jul 2014 00:18:47 +0000"/>
                            <attachment id="12657908" name="ZOOKEEPER-1366.patch" size="45250" author="phunt" created="Fri, 25 Jul 2014 21:36:31 +0000"/>
                            <attachment id="12641585" name="ZOOKEEPER-1366.patch" size="47657" author="michim" created="Wed, 23 Apr 2014 21:41:12 +0000"/>
                            <attachment id="12570508" name="ZOOKEEPER-1366.patch" size="46548" author="marshall" created="Fri, 22 Feb 2013 18:31:06 +0000"/>
                            <attachment id="12570427" name="ZOOKEEPER-1366.patch" size="46179" author="marshall" created="Fri, 22 Feb 2013 06:52:33 +0000"/>
                            <attachment id="12570423" name="ZOOKEEPER-1366.patch" size="46167" author="marshall" created="Fri, 22 Feb 2013 06:13:04 +0000"/>
                            <attachment id="12511217" name="ZOOKEEPER-1366.patch" size="48095" author="tdunning" created="Fri, 20 Jan 2012 03:04:41 +0000"/>
                            <attachment id="12511214" name="ZOOKEEPER-1366.patch" size="47999" author="tdunning" created="Fri, 20 Jan 2012 02:38:16 +0000"/>
                            <attachment id="12511200" name="ZOOKEEPER-1366.patch" size="44202" author="tdunning" created="Fri, 20 Jan 2012 00:37:56 +0000"/>
                            <attachment id="12511104" name="ZOOKEEPER-1366.patch" size="43538" author="tdunning" created="Thu, 19 Jan 2012 08:08:41 +0000"/>
                            <attachment id="12596213" name="zookeeper-3.4.5-ZK1366-SC01.patch" size="56427" author="cls" created="Mon, 5 Aug 2013 21:06:02 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12628594">ZOOKEEPER-1626</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>224432</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 41 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05xx3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32594</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>