{"url":"https://api.github.com/repos/sirupsen/logrus/issues/716","repository_url":"https://api.github.com/repos/sirupsen/logrus","labels_url":"https://api.github.com/repos/sirupsen/logrus/issues/716/labels{/name}","comments_url":"https://api.github.com/repos/sirupsen/logrus/issues/716/comments","events_url":"https://api.github.com/repos/sirupsen/logrus/issues/716/events","html_url":"https://github.com/sirupsen/logrus/issues/716","id":299856985,"node_id":"MDU6SXNzdWUyOTk4NTY5ODU=","number":716,"title":"Optionally remove dependency on golang.org/x/sys/unix without \"appengine\" build tag","user":{"login":"gracenoah","id":36455668,"node_id":"MDQ6VXNlcjM2NDU1NjY4","avatar_url":"https://avatars.githubusercontent.com/u/36455668?v=4","gravatar_id":"","url":"https://api.github.com/users/gracenoah","html_url":"https://github.com/gracenoah","followers_url":"https://api.github.com/users/gracenoah/followers","following_url":"https://api.github.com/users/gracenoah/following{/other_user}","gists_url":"https://api.github.com/users/gracenoah/gists{/gist_id}","starred_url":"https://api.github.com/users/gracenoah/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gracenoah/subscriptions","organizations_url":"https://api.github.com/users/gracenoah/orgs","repos_url":"https://api.github.com/users/gracenoah/repos","events_url":"https://api.github.com/users/gracenoah/events{/privacy}","received_events_url":"https://api.github.com/users/gracenoah/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2018-02-23T21:33:09Z","updated_at":"2018-02-28T21:44:19Z","closed_at":"2018-02-28T21:44:19Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I'm trying to use [gopherjs](https://github.com/gopherjs/gopherjs) to compile some Go code into JS. It works great for everything I've tried so far except logrus. The issue is that logrus depends on `golang.org/x/sys/unix` through `golang.org/x/crypto/ssh/terminal`. If we can use a compile tag to disable this dependency, that would be awesome.\r\n\r\nI see that setting `--tags appengine` does fix the problem for logrus, but it interferes with building of other dependencies we have. (we are obviously not using appengine)\r\n\r\nExample for testing:\r\n\r\n`main.go:`\r\n```go\r\npackage main\r\n\r\nimport (\r\n\t\"github.com/gopherjs/gopherjs/js\"\r\n\t\"github.com/sirupsen/logrus\"\r\n)\r\n\r\nfunc main() {\r\n\tjs.Global.Set(\"run\", func() {\r\n\t\tlogrus.Info(\"example\")\r\n\t})\r\n\tjs.Global.Call(\"run\")\r\n}\r\n```\r\n\r\n`gopherjs build main.go`\r\n```\r\n../vendor/golang.org/x/sys/unix/syscall_unix.go:153:38: undeclared name: _Socklen\r\n../vendor/golang.org/x/sys/unix/affinity_linux.go:13:20: undeclared name: _CPU_SETSIZE\r\n../vendor/golang.org/x/sys/unix/affinity_linux.go:13:35: undeclared name: _NCPUBITS\r\n../vendor/golang.org/x/sys/unix/affinity_linux.go:16:25: undeclared name: cpuMask\r\n../vendor/golang.org/x/sys/unix/affinity_linux.go:49:27: undeclared name: cpuMask\r\n../vendor/golang.org/x/sys/unix/flock.go:13:30: undeclared name: SYS_FCNTL\r\n../vendor/golang.org/x/sys/unix/flock.go:16:42: undeclared name: Flock_t\r\n../vendor/golang.org/x/sys/unix/sockcmsg_linux.go:14:29: undeclared name: Ucred\r\n../vendor/golang.org/x/sys/unix/sockcmsg_unix.go:43:9: undeclared name: Cmsghdr\r\n../vendor/golang.org/x/sys/unix/sockcmsg_linux.go:27:54: undeclared name: Ucred\r\n../vendor/golang.org/x/sys/unix/sockcmsg_linux.go:27:54: too many errors\r\n```\r\n\r\n`gopherjs build main.go --tags appengine`\r\n(success)\r\n\r\nPR coming up. I'll add another build tag, \"gopherjs\" and it will work the same way as the appengine tag, but won't cause breakage for us by forcing us to compile other dependencies with the appengine tag.","closed_by":{"login":"stevvooe","id":120601,"node_id":"MDQ6VXNlcjEyMDYwMQ==","avatar_url":"https://avatars.githubusercontent.com/u/120601?v=4","gravatar_id":"","url":"https://api.github.com/users/stevvooe","html_url":"https://github.com/stevvooe","followers_url":"https://api.github.com/users/stevvooe/followers","following_url":"https://api.github.com/users/stevvooe/following{/other_user}","gists_url":"https://api.github.com/users/stevvooe/gists{/gist_id}","starred_url":"https://api.github.com/users/stevvooe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevvooe/subscriptions","organizations_url":"https://api.github.com/users/stevvooe/orgs","repos_url":"https://api.github.com/users/stevvooe/repos","events_url":"https://api.github.com/users/stevvooe/events{/privacy}","received_events_url":"https://api.github.com/users/stevvooe/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sirupsen/logrus/issues/716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sirupsen/logrus/issues/716/timeline","performed_via_github_app":null,"state_reason":"completed"}