[{"id":18428976627,"node_id":"ITAE_lADOAPphoM6-dYUzzwAAAARKc93z","url":"https://api.github.com/repos/neovim/neovim/issues/events/18428976627","actor":{"login":"konradmalik","id":13033392,"node_id":"MDQ6VXNlcjEzMDMzMzky","avatar_url":"https://avatars.githubusercontent.com/u/13033392?v=4","gravatar_id":"","url":"https://api.github.com/users/konradmalik","html_url":"https://github.com/konradmalik","followers_url":"https://api.github.com/users/konradmalik/followers","following_url":"https://api.github.com/users/konradmalik/following{/other_user}","gists_url":"https://api.github.com/users/konradmalik/gists{/gist_id}","starred_url":"https://api.github.com/users/konradmalik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/konradmalik/subscriptions","organizations_url":"https://api.github.com/users/konradmalik/orgs","repos_url":"https://api.github.com/users/konradmalik/repos","events_url":"https://api.github.com/users/konradmalik/events{/privacy}","received_events_url":"https://api.github.com/users/konradmalik/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"issue_type_added","commit_id":null,"commit_url":null,"created_at":"2025-07-02T10:15:49Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/3027298708","html_url":"https://github.com/neovim/neovim/issues/34730#issuecomment-3027298708","issue_url":"https://api.github.com/repos/neovim/neovim/issues/34730","id":3027298708,"node_id":"IC_kwDOAPphoM60cOmU","user":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-07-02T10:19:57Z","updated_at":"2025-07-02T10:20:39Z","body":"the ENOENT is a side effect of a particular plugin, not really the core issue.\n\nsee\n\n- https://github.com/neovim/neovim/pull/33955#issuecomment-3016434780\n- https://github.com/lewis6991/gitsigns.nvim/pull/1350","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/3027298708/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":18429047527,"node_id":"LE_lADOAPphoM6-dYUzzwAAAARKdPLn","url":"https://api.github.com/repos/neovim/neovim/issues/events/18429047527","actor":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2025-07-02T10:20:14Z","label":{"name":"environment","color":"c5def5"},"performed_via_github_app":null},{"id":18429066006,"node_id":"RTE_lADOAPphoM6-dYUzzwAAAARKdTsW","url":"https://api.github.com/repos/neovim/neovim/issues/events/18429066006","actor":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2025-07-02T10:21:25Z","rename":{"from":"NixOS-specific (?) ENOENT: no such file or directory in gitsigns after 731e616","to":"NixOS-specific (?) ENOENT in gitsigns after vim.system `clear_env=true` change"},"performed_via_github_app":null},{"actor":{"login":"konradmalik","id":13033392,"node_id":"MDQ6VXNlcjEzMDMzMzky","avatar_url":"https://avatars.githubusercontent.com/u/13033392?v=4","gravatar_id":"","url":"https://api.github.com/users/konradmalik","html_url":"https://github.com/konradmalik","followers_url":"https://api.github.com/users/konradmalik/followers","following_url":"https://api.github.com/users/konradmalik/following{/other_user}","gists_url":"https://api.github.com/users/konradmalik/gists{/gist_id}","starred_url":"https://api.github.com/users/konradmalik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/konradmalik/subscriptions","organizations_url":"https://api.github.com/users/konradmalik/orgs","repos_url":"https://api.github.com/users/konradmalik/repos","events_url":"https://api.github.com/users/konradmalik/events{/privacy}","received_events_url":"https://api.github.com/users/konradmalik/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-07-02T10:25:02Z","updated_at":"2025-07-02T10:25:02Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/issues/1350","repository_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim","labels_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/issues/1350/labels{/name}","comments_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/issues/1350/comments","events_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/issues/1350/events","html_url":"https://github.com/lewis6991/gitsigns.nvim/pull/1350","id":3185815697,"node_id":"PR_kwDOEi8Moc6ckHtp","number":1350,"title":"Version guard `clear_env = true` in `git_command`","user":{"login":"arminfro","id":19491237,"node_id":"MDQ6VXNlcjE5NDkxMjM3","avatar_url":"https://avatars.githubusercontent.com/u/19491237?v=4","gravatar_id":"","url":"https://api.github.com/users/arminfro","html_url":"https://github.com/arminfro","followers_url":"https://api.github.com/users/arminfro/followers","following_url":"https://api.github.com/users/arminfro/following{/other_user}","gists_url":"https://api.github.com/users/arminfro/gists{/gist_id}","starred_url":"https://api.github.com/users/arminfro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arminfro/subscriptions","organizations_url":"https://api.github.com/users/arminfro/orgs","repos_url":"https://api.github.com/users/arminfro/repos","events_url":"https://api.github.com/users/arminfro/events{/privacy}","received_events_url":"https://api.github.com/users/arminfro/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2025-06-29T06:44:16Z","updated_at":"2025-07-03T14:36:25Z","closed_at":"2025-07-03T14:36:25Z","author_association":"NONE","active_lock_reason":null,"draft":false,"repository":{"id":305073313,"node_id":"MDEwOlJlcG9zaXRvcnkzMDUwNzMzMTM=","name":"gitsigns.nvim","full_name":"lewis6991/gitsigns.nvim","private":false,"owner":{"login":"lewis6991","id":7904185,"node_id":"MDQ6VXNlcjc5MDQxODU=","avatar_url":"https://avatars.githubusercontent.com/u/7904185?v=4","gravatar_id":"","url":"https://api.github.com/users/lewis6991","html_url":"https://github.com/lewis6991","followers_url":"https://api.github.com/users/lewis6991/followers","following_url":"https://api.github.com/users/lewis6991/following{/other_user}","gists_url":"https://api.github.com/users/lewis6991/gists{/gist_id}","starred_url":"https://api.github.com/users/lewis6991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lewis6991/subscriptions","organizations_url":"https://api.github.com/users/lewis6991/orgs","repos_url":"https://api.github.com/users/lewis6991/repos","events_url":"https://api.github.com/users/lewis6991/events{/privacy}","received_events_url":"https://api.github.com/users/lewis6991/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/lewis6991/gitsigns.nvim","description":"Git integration for buffers","fork":false,"url":"https://api.github.com/repos/lewis6991/gitsigns.nvim","forks_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/forks","keys_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/keys{/key_id}","collaborators_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/teams","hooks_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/hooks","issue_events_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/issues/events{/number}","events_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/events","assignees_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/assignees{/user}","branches_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/branches{/branch}","tags_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/tags","blobs_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/git/refs{/sha}","trees_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/git/trees{/sha}","statuses_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/statuses/{sha}","languages_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/languages","stargazers_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/stargazers","contributors_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/contributors","subscribers_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/subscribers","subscription_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/subscription","commits_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/commits{/sha}","git_commits_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/git/commits{/sha}","comments_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/comments{/number}","issue_comment_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/issues/comments{/number}","contents_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/contents/{+path}","compare_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/compare/{base}...{head}","merges_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/merges","archive_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/downloads","issues_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/issues{/number}","pulls_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/pulls{/number}","milestones_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/milestones{/number}","notifications_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/labels{/name}","releases_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/releases{/id}","deployments_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/deployments","created_at":"2020-10-18T10:14:43Z","updated_at":"2025-11-09T14:21:28Z","pushed_at":"2025-10-19T15:42:23Z","git_url":"git://github.com/lewis6991/gitsigns.nvim.git","ssh_url":"git@github.com:lewis6991/gitsigns.nvim.git","clone_url":"https://github.com/lewis6991/gitsigns.nvim.git","svn_url":"https://github.com/lewis6991/gitsigns.nvim","homepage":"","size":2421,"stargazers_count":6322,"watchers_count":6322,"language":"Lua","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":244,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":45,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["git","lua","neovim","neovim-lua-plugin","neovim-plugin","nvim"],"visibility":"public","forks":244,"open_issues":45,"watchers":6322,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/pulls/1350","html_url":"https://github.com/lewis6991/gitsigns.nvim/pull/1350","diff_url":"https://github.com/lewis6991/gitsigns.nvim/pull/1350.diff","patch_url":"https://github.com/lewis6991/gitsigns.nvim/pull/1350.patch","merged_at":null},"body":"Since some recent updates I'm getting an error on gitsigns attach event: `nvim/runtime/lua/vim/_system.lua:249: ENOENT: no such file or directory`.\r\n\r\nI've found the `clear_env` setting in `git_command` was causing this. Version guarding the set works for me.\r\n\r\n```\r\nError  08:00:12 msg_show.lua_error vim.schedule callback: ...unwrapped-nightly/share/nvim/runtime/lua/vim/_system.lua:249: ENOENT: no such file or directory\r\nstack traceback:\r\n [thread: 0x7fad240f1df8] [C]: in function 'asystem'\r\n [thread: 0x7fad240f1df8] ...zyvim-nix-plugins/gitsigns.nvim/lua/gitsigns/git/cmd.lua:58: in function 'git_command'\r\n [thread: 0x7fad240f1df8] ...yvim-nix-plugins/gitsigns.nvim/lua/gitsigns/git/repo.lua:213: in function 'get_info'\r\n [thread: 0x7fad240f1df8] ...yvim-nix-plugins/gitsigns.nvim/lua/gitsigns/git/repo.lua:126: in function 'get'\r\n [thread: 0x7fad240f1df8] ...4-lazyvim-nix-plugins/gitsigns.nvim/lua/gitsigns/git.lua:243: in function 'new'\r\n [thread: 0x7fad240f1df8] ...azyvim-nix-plugins/gitsigns.nvim/lua/gitsigns/attach.lua:217: in function 'fn'\r\n [thread: 0x7fad240f1df8] ...yvim-nix-plugins/gitsigns.nvim/lua/gitsigns/debounce.lua:78: in function 'attach_throttled'\r\n [thread: 0x7fad240f1df8] ...azyvim-nix-plugins/gitsigns.nvim/lua/gitsigns/attach.lua:363: in function <...azyvim-nix-plugins/gitsigns.nvim/lua/gitsigns/attach.lua:362>\r\nstack traceback:\r\n [C]: in function 'error'\r\n ...lazyvim-nix-plugins/gitsigns.nvim/lua/gitsigns/async.lua:229: in function '_finish'\r\n ...lazyvim-nix-plugins/gitsigns.nvim/lua/gitsigns/async.lua:322: in function '_resume'\r\n ...lazyvim-nix-plugins/gitsigns.nvim/lua/gitsigns/async.lua:317: in function <...lazyvim-nix-plugins/gitsigns.nvim/lua/gitsigns/async.lua:307>\r\n```\r\n\r\nbtw, thanks for this great plugin, happily using it since a long time :)\r\n","reactions":{"url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/issues/1350/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/lewis6991/gitsigns.nvim/issues/1350/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/3027374237","html_url":"https://github.com/neovim/neovim/issues/34730#issuecomment-3027374237","issue_url":"https://api.github.com/repos/neovim/neovim/issues/34730","id":3027374237,"node_id":"IC_kwDOAPphoM60chCd","user":{"login":"lewis6991","id":7904185,"node_id":"MDQ6VXNlcjc5MDQxODU=","avatar_url":"https://avatars.githubusercontent.com/u/7904185?v=4","gravatar_id":"","url":"https://api.github.com/users/lewis6991","html_url":"https://github.com/lewis6991","followers_url":"https://api.github.com/users/lewis6991/followers","following_url":"https://api.github.com/users/lewis6991/following{/other_user}","gists_url":"https://api.github.com/users/lewis6991/gists{/gist_id}","starred_url":"https://api.github.com/users/lewis6991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lewis6991/subscriptions","organizations_url":"https://api.github.com/users/lewis6991/orgs","repos_url":"https://api.github.com/users/lewis6991/repos","events_url":"https://api.github.com/users/lewis6991/events{/privacy}","received_events_url":"https://api.github.com/users/lewis6991/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-07-02T10:46:01Z","updated_at":"2025-07-02T10:49:56Z","body":"https://github.com/neovim/neovim/pull/33955 does seem to change behaviour in a way that's not well understood.\n\nI've left a comment on #33955, but basically gitsigns is passing `{ env = nil, clear_env = true }`, which previously resulted in `env = nil` being sent to `vim.uv.spawn()`, and AFAIK is correct, as `vim.uv.spawn()` will just use the current env as is. Now `{ env = nil, clear_env = true }` passes `vim.env` in the form `{ 'VAR1=1', 'VAR2=2' }`.\n\nSince the the only bug reports are coming from nix uses, my guess is that `vim.fn.environ.PATH` is different to `PATH` when `env=nil`, and thus results in `ENOENT` errors.\n\nEither:\n- We accept this new behaviour change where `vim.system()` strictly uses the env defined in `vim.fn.environ`\n- We add a special case for `{ env = nil, clear_env = true}` causing `env = nil`, like previously. ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/3027374237/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lewis6991","id":7904185,"node_id":"MDQ6VXNlcjc5MDQxODU=","avatar_url":"https://avatars.githubusercontent.com/u/7904185?v=4","gravatar_id":"","url":"https://api.github.com/users/lewis6991","html_url":"https://github.com/lewis6991","followers_url":"https://api.github.com/users/lewis6991/followers","following_url":"https://api.github.com/users/lewis6991/following{/other_user}","gists_url":"https://api.github.com/users/lewis6991/gists{/gist_id}","starred_url":"https://api.github.com/users/lewis6991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lewis6991/subscriptions","organizations_url":"https://api.github.com/users/lewis6991/orgs","repos_url":"https://api.github.com/users/lewis6991/repos","events_url":"https://api.github.com/users/lewis6991/events{/privacy}","received_events_url":"https://api.github.com/users/lewis6991/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/3027421207","html_url":"https://github.com/neovim/neovim/issues/34730#issuecomment-3027421207","issue_url":"https://api.github.com/repos/neovim/neovim/issues/34730","id":3027421207,"node_id":"IC_kwDOAPphoM60csgX","user":{"login":"lewis6991","id":7904185,"node_id":"MDQ6VXNlcjc5MDQxODU=","avatar_url":"https://avatars.githubusercontent.com/u/7904185?v=4","gravatar_id":"","url":"https://api.github.com/users/lewis6991","html_url":"https://github.com/lewis6991","followers_url":"https://api.github.com/users/lewis6991/followers","following_url":"https://api.github.com/users/lewis6991/following{/other_user}","gists_url":"https://api.github.com/users/lewis6991/gists{/gist_id}","starred_url":"https://api.github.com/users/lewis6991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lewis6991/subscriptions","organizations_url":"https://api.github.com/users/lewis6991/orgs","repos_url":"https://api.github.com/users/lewis6991/repos","events_url":"https://api.github.com/users/lewis6991/events{/privacy}","received_events_url":"https://api.github.com/users/lewis6991/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-07-02T10:59:52Z","updated_at":"2025-07-02T11:00:30Z","body":"Ok I understand this now. #33955 now causes `{env = nil, clear_env = true}` to pass `env = {}`, which I think goes against the documentation:\n\n```\n                   â€¢ clear_env: (boolean) `env` defines the job environment\n                     exactly, instead of merging current environment.\n```\n\nHere I interpret that if `env` is passed as `nil`, it should be passed as `nil` to `vim.us.spawn`.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/3027421207/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lewis6991","id":7904185,"node_id":"MDQ6VXNlcjc5MDQxODU=","avatar_url":"https://avatars.githubusercontent.com/u/7904185?v=4","gravatar_id":"","url":"https://api.github.com/users/lewis6991","html_url":"https://github.com/lewis6991","followers_url":"https://api.github.com/users/lewis6991/followers","following_url":"https://api.github.com/users/lewis6991/following{/other_user}","gists_url":"https://api.github.com/users/lewis6991/gists{/gist_id}","starred_url":"https://api.github.com/users/lewis6991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lewis6991/subscriptions","organizations_url":"https://api.github.com/users/lewis6991/orgs","repos_url":"https://api.github.com/users/lewis6991/repos","events_url":"https://api.github.com/users/lewis6991/events{/privacy}","received_events_url":"https://api.github.com/users/lewis6991/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":18429932425,"node_id":"REFE_lADOAPphoM6-dYUzzwAAAARKgnOJ","url":"https://api.github.com/repos/neovim/neovim/issues/events/18429932425","actor":{"login":"lewis6991","id":7904185,"node_id":"MDQ6VXNlcjc5MDQxODU=","avatar_url":"https://avatars.githubusercontent.com/u/7904185?v=4","gravatar_id":"","url":"https://api.github.com/users/lewis6991","html_url":"https://github.com/lewis6991","followers_url":"https://api.github.com/users/lewis6991/followers","following_url":"https://api.github.com/users/lewis6991/following{/other_user}","gists_url":"https://api.github.com/users/lewis6991/gists{/gist_id}","starred_url":"https://api.github.com/users/lewis6991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lewis6991/subscriptions","organizations_url":"https://api.github.com/users/lewis6991/orgs","repos_url":"https://api.github.com/users/lewis6991/repos","events_url":"https://api.github.com/users/lewis6991/events{/privacy}","received_events_url":"https://api.github.com/users/lewis6991/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"8e2f64dc596651b4907ce104f0a5a1b674ce2db2","commit_url":"https://api.github.com/repos/lewis6991/neovim/commits/8e2f64dc596651b4907ce104f0a5a1b674ce2db2","created_at":"2025-07-02T11:14:03Z","performed_via_github_app":null},{"actor":{"login":"lewis6991","id":7904185,"node_id":"MDQ6VXNlcjc5MDQxODU=","avatar_url":"https://avatars.githubusercontent.com/u/7904185?v=4","gravatar_id":"","url":"https://api.github.com/users/lewis6991","html_url":"https://github.com/lewis6991","followers_url":"https://api.github.com/users/lewis6991/followers","following_url":"https://api.github.com/users/lewis6991/following{/other_user}","gists_url":"https://api.github.com/users/lewis6991/gists{/gist_id}","starred_url":"https://api.github.com/users/lewis6991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lewis6991/subscriptions","organizations_url":"https://api.github.com/users/lewis6991/orgs","repos_url":"https://api.github.com/users/lewis6991/repos","events_url":"https://api.github.com/users/lewis6991/events{/privacy}","received_events_url":"https://api.github.com/users/lewis6991/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-07-02T11:14:04Z","updated_at":"2025-07-02T11:14:04Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/neovim/neovim/issues/34732","repository_url":"https://api.github.com/repos/neovim/neovim","labels_url":"https://api.github.com/repos/neovim/neovim/issues/34732/labels{/name}","comments_url":"https://api.github.com/repos/neovim/neovim/issues/34732/comments","events_url":"https://api.github.com/repos/neovim/neovim/issues/34732/events","html_url":"https://github.com/neovim/neovim/pull/34732","id":3195539052,"node_id":"PR_kwDOAPphoM6dEM4l","number":34732,"title":"fix(vim.system): env=nil passes env=nil to uv.spawn","user":{"login":"lewis6991","id":7904185,"node_id":"MDQ6VXNlcjc5MDQxODU=","avatar_url":"https://avatars.githubusercontent.com/u/7904185?v=4","gravatar_id":"","url":"https://api.github.com/users/lewis6991","html_url":"https://github.com/lewis6991","followers_url":"https://api.github.com/users/lewis6991/followers","following_url":"https://api.github.com/users/lewis6991/following{/other_user}","gists_url":"https://api.github.com/users/lewis6991/gists{/gist_id}","starred_url":"https://api.github.com/users/lewis6991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lewis6991/subscriptions","organizations_url":"https://api.github.com/users/lewis6991/orgs","repos_url":"https://api.github.com/users/lewis6991/repos","events_url":"https://api.github.com/users/lewis6991/events{/privacy}","received_events_url":"https://api.github.com/users/lewis6991/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":8431892071,"node_id":"LA_kwDOAPphoM8AAAAB9pR2Zw","url":"https://api.github.com/repos/neovim/neovim/labels/ci:backport%20release-0.11","name":"ci:backport release-0.11","color":"0052CC","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2025-07-02T11:14:03Z","updated_at":"2025-07-02T16:11:16Z","closed_at":"2025-07-02T16:01:30Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":16408992,"node_id":"MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==","name":"neovim","full_name":"neovim/neovim","private":false,"owner":{"login":"neovim","id":6471485,"node_id":"MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6471485?v=4","gravatar_id":"","url":"https://api.github.com/users/neovim","html_url":"https://github.com/neovim","followers_url":"https://api.github.com/users/neovim/followers","following_url":"https://api.github.com/users/neovim/following{/other_user}","gists_url":"https://api.github.com/users/neovim/gists{/gist_id}","starred_url":"https://api.github.com/users/neovim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/neovim/subscriptions","organizations_url":"https://api.github.com/users/neovim/orgs","repos_url":"https://api.github.com/users/neovim/repos","events_url":"https://api.github.com/users/neovim/events{/privacy}","received_events_url":"https://api.github.com/users/neovim/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/neovim/neovim","description":"Vim-fork focused on extensibility and usability","fork":false,"url":"https://api.github.com/repos/neovim/neovim","forks_url":"https://api.github.com/repos/neovim/neovim/forks","keys_url":"https://api.github.com/repos/neovim/neovim/keys{/key_id}","collaborators_url":"https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/neovim/neovim/teams","hooks_url":"https://api.github.com/repos/neovim/neovim/hooks","issue_events_url":"https://api.github.com/repos/neovim/neovim/issues/events{/number}","events_url":"https://api.github.com/repos/neovim/neovim/events","assignees_url":"https://api.github.com/repos/neovim/neovim/assignees{/user}","branches_url":"https://api.github.com/repos/neovim/neovim/branches{/branch}","tags_url":"https://api.github.com/repos/neovim/neovim/tags","blobs_url":"https://api.github.com/repos/neovim/neovim/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/neovim/neovim/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/neovim/neovim/git/refs{/sha}","trees_url":"https://api.github.com/repos/neovim/neovim/git/trees{/sha}","statuses_url":"https://api.github.com/repos/neovim/neovim/statuses/{sha}","languages_url":"https://api.github.com/repos/neovim/neovim/languages","stargazers_url":"https://api.github.com/repos/neovim/neovim/stargazers","contributors_url":"https://api.github.com/repos/neovim/neovim/contributors","subscribers_url":"https://api.github.com/repos/neovim/neovim/subscribers","subscription_url":"https://api.github.com/repos/neovim/neovim/subscription","commits_url":"https://api.github.com/repos/neovim/neovim/commits{/sha}","git_commits_url":"https://api.github.com/repos/neovim/neovim/git/commits{/sha}","comments_url":"https://api.github.com/repos/neovim/neovim/comments{/number}","issue_comment_url":"https://api.github.com/repos/neovim/neovim/issues/comments{/number}","contents_url":"https://api.github.com/repos/neovim/neovim/contents/{+path}","compare_url":"https://api.github.com/repos/neovim/neovim/compare/{base}...{head}","merges_url":"https://api.github.com/repos/neovim/neovim/merges","archive_url":"https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/neovim/neovim/downloads","issues_url":"https://api.github.com/repos/neovim/neovim/issues{/number}","pulls_url":"https://api.github.com/repos/neovim/neovim/pulls{/number}","milestones_url":"https://api.github.com/repos/neovim/neovim/milestones{/number}","notifications_url":"https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/neovim/neovim/labels{/name}","releases_url":"https://api.github.com/repos/neovim/neovim/releases{/id}","deployments_url":"https://api.github.com/repos/neovim/neovim/deployments","created_at":"2014-01-31T13:39:22Z","updated_at":"2025-11-10T01:49:31Z","pushed_at":"2025-11-10T01:49:25Z","git_url":"git://github.com/neovim/neovim.git","ssh_url":"git@github.com:neovim/neovim.git","clone_url":"https://github.com/neovim/neovim.git","svn_url":"https://github.com/neovim/neovim","homepage":"https://neovim.io","size":350662,"stargazers_count":94128,"watchers_count":94128,"language":"Vim Script","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":6408,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2074,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["api","c","lua","neovim","nvim","text-editor","vim"],"visibility":"public","forks":6408,"open_issues":2074,"watchers":94128,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/neovim/neovim/pulls/34732","html_url":"https://github.com/neovim/neovim/pull/34732","diff_url":"https://github.com/neovim/neovim/pull/34732.diff","patch_url":"https://github.com/neovim/neovim/pull/34732.patch","merged_at":"2025-07-02T16:01:30Z"},"body":"731e616a79 made it so passing `{env = nil, clear_env = true }` would\r\npass `{env = {}}` to `vim.uv.spawn`.\r\n\r\nHowever this is not what `clear_env` is (arguably) supposed to do.\r\nIf `env=nil` then that implies the uses wants `vim.uv.spawn()` to use\r\nthe default environment. Adding `clear_env = true` simply prevents\r\n`NVIM` (the base environment) from being added.\r\n\r\nFixes #34730\r\n\r\n<!--\r\n  Thank you for contributing to Neovim!\r\n  If this is your first time, check out https://github.com/neovim/neovim/blob/master/CONTRIBUTING.md#pull-requests-prs\r\n  for our PR guidelines.\r\n-->\r\n","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/34732/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/neovim/neovim/issues/34732/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":18430152501,"node_id":"REFE_lADOAPphoM6-dYUzzwAAAARKhc81","url":"https://api.github.com/repos/neovim/neovim/issues/events/18430152501","actor":{"login":"lewis6991","id":7904185,"node_id":"MDQ6VXNlcjc5MDQxODU=","avatar_url":"https://avatars.githubusercontent.com/u/7904185?v=4","gravatar_id":"","url":"https://api.github.com/users/lewis6991","html_url":"https://github.com/lewis6991","followers_url":"https://api.github.com/users/lewis6991/followers","following_url":"https://api.github.com/users/lewis6991/following{/other_user}","gists_url":"https://api.github.com/users/lewis6991/gists{/gist_id}","starred_url":"https://api.github.com/users/lewis6991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lewis6991/subscriptions","organizations_url":"https://api.github.com/users/lewis6991/orgs","repos_url":"https://api.github.com/users/lewis6991/repos","events_url":"https://api.github.com/users/lewis6991/events{/privacy}","received_events_url":"https://api.github.com/users/lewis6991/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"61aba09c8e379aa4f52d42f2322f8808cc579ce8","commit_url":"https://api.github.com/repos/lewis6991/neovim/commits/61aba09c8e379aa4f52d42f2322f8808cc579ce8","created_at":"2025-07-02T11:28:00Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/3027518063","html_url":"https://github.com/neovim/neovim/issues/34730#issuecomment-3027518063","issue_url":"https://api.github.com/repos/neovim/neovim/issues/34730","id":3027518063,"node_id":"IC_kwDOAPphoM60dEJv","user":{"login":"lewis6991","id":7904185,"node_id":"MDQ6VXNlcjc5MDQxODU=","avatar_url":"https://avatars.githubusercontent.com/u/7904185?v=4","gravatar_id":"","url":"https://api.github.com/users/lewis6991","html_url":"https://github.com/lewis6991","followers_url":"https://api.github.com/users/lewis6991/followers","following_url":"https://api.github.com/users/lewis6991/following{/other_user}","gists_url":"https://api.github.com/users/lewis6991/gists{/gist_id}","starred_url":"https://api.github.com/users/lewis6991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lewis6991/subscriptions","organizations_url":"https://api.github.com/users/lewis6991/orgs","repos_url":"https://api.github.com/users/lewis6991/repos","events_url":"https://api.github.com/users/lewis6991/events{/privacy}","received_events_url":"https://api.github.com/users/lewis6991/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-07-02T11:29:16Z","updated_at":"2025-07-02T11:29:16Z","body":"Raised #34732","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/3027518063/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lewis6991","id":7904185,"node_id":"MDQ6VXNlcjc5MDQxODU=","avatar_url":"https://avatars.githubusercontent.com/u/7904185?v=4","gravatar_id":"","url":"https://api.github.com/users/lewis6991","html_url":"https://github.com/lewis6991","followers_url":"https://api.github.com/users/lewis6991/followers","following_url":"https://api.github.com/users/lewis6991/following{/other_user}","gists_url":"https://api.github.com/users/lewis6991/gists{/gist_id}","starred_url":"https://api.github.com/users/lewis6991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lewis6991/subscriptions","organizations_url":"https://api.github.com/users/lewis6991/orgs","repos_url":"https://api.github.com/users/lewis6991/repos","events_url":"https://api.github.com/users/lewis6991/events{/privacy}","received_events_url":"https://api.github.com/users/lewis6991/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":18431070522,"node_id":"UE_lADOAPphoM6-dYUzzwAAAARKk9E6","url":"https://api.github.com/repos/neovim/neovim/issues/events/18431070522","actor":{"login":"nenahp","id":154880267,"node_id":"U_kgDOCTtJCw","avatar_url":"https://avatars.githubusercontent.com/u/154880267?v=4","gravatar_id":"","url":"https://api.github.com/users/nenahp","html_url":"https://github.com/nenahp","followers_url":"https://api.github.com/users/nenahp/followers","following_url":"https://api.github.com/users/nenahp/following{/other_user}","gists_url":"https://api.github.com/users/nenahp/gists{/gist_id}","starred_url":"https://api.github.com/users/nenahp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nenahp/subscriptions","organizations_url":"https://api.github.com/users/nenahp/orgs","repos_url":"https://api.github.com/users/nenahp/repos","events_url":"https://api.github.com/users/nenahp/events{/privacy}","received_events_url":"https://api.github.com/users/nenahp/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unsubscribed","commit_id":null,"commit_url":null,"created_at":"2025-07-02T12:25:22Z","performed_via_github_app":null},{"id":18435215966,"node_id":"CE_lADOAPphoM6-dYUzzwAAAARK0xJe","url":"https://api.github.com/repos/neovim/neovim/issues/events/18435215966","actor":{"login":"lewis6991","id":7904185,"node_id":"MDQ6VXNlcjc5MDQxODU=","avatar_url":"https://avatars.githubusercontent.com/u/7904185?v=4","gravatar_id":"","url":"https://api.github.com/users/lewis6991","html_url":"https://github.com/lewis6991","followers_url":"https://api.github.com/users/lewis6991/followers","following_url":"https://api.github.com/users/lewis6991/following{/other_user}","gists_url":"https://api.github.com/users/lewis6991/gists{/gist_id}","starred_url":"https://api.github.com/users/lewis6991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lewis6991/subscriptions","organizations_url":"https://api.github.com/users/lewis6991/orgs","repos_url":"https://api.github.com/users/lewis6991/repos","events_url":"https://api.github.com/users/lewis6991/events{/privacy}","received_events_url":"https://api.github.com/users/lewis6991/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2025-07-02T16:01:31Z","state_reason":null,"performed_via_github_app":null},{"id":18435270714,"node_id":"REFE_lADOAPphoM6-dYUzzwAAAARK0-g6","url":"https://api.github.com/repos/neovim/neovim/issues/events/18435270714","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"a42b8e1c3c02b639642c369e4b9308730e65305c","commit_url":"https://api.github.com/repos/neovim/neovim/commits/a42b8e1c3c02b639642c369e4b9308730e65305c","created_at":"2025-07-02T16:04:56Z","performed_via_github_app":null},{"id":18435272328,"node_id":"REFE_lADOAPphoM6-dYUzzwAAAARK0-6I","url":"https://api.github.com/repos/neovim/neovim/issues/events/18435272328","actor":{"login":"silvercircle","id":815360,"node_id":"MDQ6VXNlcjgxNTM2MA==","avatar_url":"https://avatars.githubusercontent.com/u/815360?v=4","gravatar_id":"","url":"https://api.github.com/users/silvercircle","html_url":"https://github.com/silvercircle","followers_url":"https://api.github.com/users/silvercircle/followers","following_url":"https://api.github.com/users/silvercircle/following{/other_user}","gists_url":"https://api.github.com/users/silvercircle/gists{/gist_id}","starred_url":"https://api.github.com/users/silvercircle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/silvercircle/subscriptions","organizations_url":"https://api.github.com/users/silvercircle/orgs","repos_url":"https://api.github.com/users/silvercircle/repos","events_url":"https://api.github.com/users/silvercircle/events{/privacy}","received_events_url":"https://api.github.com/users/silvercircle/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"4eebc46930008d7cf47491121556ee201e1f4860","commit_url":"https://api.github.com/repos/silvercircle/neovim/commits/4eebc46930008d7cf47491121556ee201e1f4860","created_at":"2025-07-02T16:05:02Z","performed_via_github_app":null},{"id":18436089548,"node_id":"REFE_lADOAPphoM6-dYUzzwAAAARK4GbM","url":"https://api.github.com/repos/neovim/neovim/issues/events/18436089548","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"e732cbe36c803aaf6c9ba6d42a36b7341c6c26da","commit_url":"https://api.github.com/repos/neovim/neovim/commits/e732cbe36c803aaf6c9ba6d42a36b7341c6c26da","created_at":"2025-07-02T16:53:27Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/3030551844","html_url":"https://github.com/neovim/neovim/issues/34730#issuecomment-3030551844","issue_url":"https://api.github.com/repos/neovim/neovim/issues/34730","id":3030551844,"node_id":"IC_kwDOAPphoM60oo0k","user":{"login":"BirdeeHub","id":85372418,"node_id":"MDQ6VXNlcjg1MzcyNDE4","avatar_url":"https://avatars.githubusercontent.com/u/85372418?v=4","gravatar_id":"","url":"https://api.github.com/users/BirdeeHub","html_url":"https://github.com/BirdeeHub","followers_url":"https://api.github.com/users/BirdeeHub/followers","following_url":"https://api.github.com/users/BirdeeHub/following{/other_user}","gists_url":"https://api.github.com/users/BirdeeHub/gists{/gist_id}","starred_url":"https://api.github.com/users/BirdeeHub/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BirdeeHub/subscriptions","organizations_url":"https://api.github.com/users/BirdeeHub/orgs","repos_url":"https://api.github.com/users/BirdeeHub/repos","events_url":"https://api.github.com/users/BirdeeHub/events{/privacy}","received_events_url":"https://api.github.com/users/BirdeeHub/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-07-03T03:47:01Z","updated_at":"2025-07-03T03:55:51Z","body":"I am having trouble figuring out where `vim.fn.environ` comes into the equation\n\nhttps://github.com/neovim/neovim/blob/535e2924365752c7dcb80d0d32101c746975bcd1/runtime/lua/vim/_system.lua#L365\n\nIt appears to me that the change was\n\nprior to the change, passing `env = nil, clear_env = true` would set `uv.spawn({}, { env = nil })` and now it sets `uv.spawn({}, { env = {} })`\n\nI am unsure where `uv.spawn` calls `vim.fn.environ` I was under the impression that uv.spawn comes straight from uv and thus shouldn't call any vim functions?\n\nI do agree though that it does change it in a way that isn't well understood though, and the behavior when `env = nil` should probably be restored.\n\nEdit: upon more reading, it seems you agree.\n\nAlso, FWIW I also use nix, and haven't experienced such issues. Although I do use my [own framework](https://github.com/BirdeeHub/nixCats-nvim) for that which prides itself in working as exactly like normal as possible so that may be part of why I haven't","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/3030551844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"BirdeeHub","id":85372418,"node_id":"MDQ6VXNlcjg1MzcyNDE4","avatar_url":"https://avatars.githubusercontent.com/u/85372418?v=4","gravatar_id":"","url":"https://api.github.com/users/BirdeeHub","html_url":"https://github.com/BirdeeHub","followers_url":"https://api.github.com/users/BirdeeHub/followers","following_url":"https://api.github.com/users/BirdeeHub/following{/other_user}","gists_url":"https://api.github.com/users/BirdeeHub/gists{/gist_id}","starred_url":"https://api.github.com/users/BirdeeHub/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BirdeeHub/subscriptions","organizations_url":"https://api.github.com/users/BirdeeHub/orgs","repos_url":"https://api.github.com/users/BirdeeHub/repos","events_url":"https://api.github.com/users/BirdeeHub/events{/privacy}","received_events_url":"https://api.github.com/users/BirdeeHub/received_events","type":"User","user_view_type":"public","site_admin":false}}]