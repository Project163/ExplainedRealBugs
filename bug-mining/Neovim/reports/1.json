{"url":"https://api.github.com/repos/neovim/neovim/issues/26135","repository_url":"https://api.github.com/repos/neovim/neovim","labels_url":"https://api.github.com/repos/neovim/neovim/issues/26135/labels{/name}","comments_url":"https://api.github.com/repos/neovim/neovim/issues/26135/comments","events_url":"https://api.github.com/repos/neovim/neovim/issues/26135/events","html_url":"https://github.com/neovim/neovim/issues/26135","id":2004236603,"node_id":"I_kwDOAPphoM53djk7","number":26135,"title":"bug: rendering performance regression due to signcolumn","user":{"login":"fdschmidt93","id":39233597,"node_id":"MDQ6VXNlcjM5MjMzNTk3","avatar_url":"https://avatars.githubusercontent.com/u/39233597?v=4","gravatar_id":"","url":"https://api.github.com/users/fdschmidt93","html_url":"https://github.com/fdschmidt93","followers_url":"https://api.github.com/users/fdschmidt93/followers","following_url":"https://api.github.com/users/fdschmidt93/following{/other_user}","gists_url":"https://api.github.com/users/fdschmidt93/gists{/gist_id}","starred_url":"https://api.github.com/users/fdschmidt93/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fdschmidt93/subscriptions","organizations_url":"https://api.github.com/users/fdschmidt93/orgs","repos_url":"https://api.github.com/users/fdschmidt93/repos","events_url":"https://api.github.com/users/fdschmidt93/events{/privacy}","received_events_url":"https://api.github.com/users/fdschmidt93/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":101930601,"node_id":"MDU6TGFiZWwxMDE5MzA2MDE=","url":"https://api.github.com/repos/neovim/neovim/labels/performance","name":"performance","color":"FEF2C0","default":false,"description":"performance, latency, cpu/memory usage"},{"id":619474658,"node_id":"MDU6TGFiZWw2MTk0NzQ2NTg=","url":"https://api.github.com/repos/neovim/neovim/labels/bug-regression","name":"bug-regression","color":"f9d0c4","default":false,"description":"wrong behavior that was introduced in a previous commit (please bisect)"},{"id":1481421490,"node_id":"MDU6TGFiZWwxNDgxNDIxNDkw","url":"https://api.github.com/repos/neovim/neovim/labels/has:bisected","name":"has:bisected","color":"0E8A16","default":false,"description":"issue has been tracked to a specific commit"},{"id":1680119719,"node_id":"MDU6TGFiZWwxNjgwMTE5NzE5","url":"https://api.github.com/repos/neovim/neovim/labels/marks","name":"marks","color":"c5def5","default":false,"description":"marks, extmarks, decorations, virtual text"},{"id":2962322085,"node_id":"MDU6TGFiZWwyOTYyMzIyMDg1","url":"https://api.github.com/repos/neovim/neovim/labels/column","name":"column","color":"c5def5","default":false,"description":"sign/number column"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/neovim/neovim/milestones/36","html_url":"https://github.com/neovim/neovim/milestone/36","labels_url":"https://api.github.com/repos/neovim/neovim/milestones/36/labels","id":8997654,"node_id":"MI_kwDOAPphoM4AiUsW","number":36,"title":"0.10","description":"","creator":{"login":"bfredl","id":1363104,"node_id":"MDQ6VXNlcjEzNjMxMDQ=","avatar_url":"https://avatars.githubusercontent.com/u/1363104?v=4","gravatar_id":"","url":"https://api.github.com/users/bfredl","html_url":"https://github.com/bfredl","followers_url":"https://api.github.com/users/bfredl/followers","following_url":"https://api.github.com/users/bfredl/following{/other_user}","gists_url":"https://api.github.com/users/bfredl/gists{/gist_id}","starred_url":"https://api.github.com/users/bfredl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bfredl/subscriptions","organizations_url":"https://api.github.com/users/bfredl/orgs","repos_url":"https://api.github.com/users/bfredl/repos","events_url":"https://api.github.com/users/bfredl/events{/privacy}","received_events_url":"https://api.github.com/users/bfredl/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":440,"state":"closed","created_at":"2023-02-02T14:11:43Z","updated_at":"2025-01-05T13:24:13Z","due_on":"2024-05-12T07:00:00Z","closed_at":"2024-05-16T14:11:42Z"},"comments":0,"created_at":"2023-11-21T13:00:08Z","updated_at":"2023-11-21T14:32:20Z","closed_at":"2023-11-21T14:32:19Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Problem\r\n\r\nFor me df87266b23b32b96d1e3d4d26eb721a9dd63c2a4 seems to have introduced performance regressions for rendering.\r\n\r\nThe below config works smoothly prior to that commit and but quickly freezes `nvim` when opening a reasonably long (250+ lines) Python file for which `pyright` sets signs from that commit onward.\r\n\r\n### Steps to reproduce\r\n\r\nMinimal `init.lua`\r\n\r\n```lua\r\nvim.cmd [[set runtimepath=$VIMRUNTIME]]\r\nvim.cmd [[set packpath=/tmp/nvim/site]]\r\nlocal package_root = \"/tmp/nvim/site/pack\"\r\nlocal lazypath = package_root .. \"/lazy/lazy.nvim\"\r\nlocal pluginpath = package_root .. \"/plugins/\"\r\nif not vim.loop.fs_stat(lazypath) then\r\n  print \"Installing 'folke/lazy.nvim'...\"\r\n  vim.fn.system { \"git\", \"clone\", \"https://github.com/folke/lazy.nvim.git\", lazypath }\r\nend\r\nvim.opt.rtp:prepend(lazypath)\r\n\r\nlocal opt = vim.opt\r\nopt.signcolumn = \"auto:1-4\" -- needs varying length signcolumn\r\n-- opt.signcolumn = \"yes:2\" -- does not occur with fixed signcolumn length\r\n-- some options that slow down rendering\r\n--  disabling some can help avoid / reduce freezing\r\nopt.wrap = true\r\nopt.linebreak = true\r\nopt.showbreak = [[â†ª ]]\r\nopt.cursorline = true\r\nopt.scrolloff = 10\r\nopt.termguicolors = true\r\n\r\n-- LSP / plugins that frequently\r\n-- render signs \r\nrequire(\"lazy\").setup({\r\n  {\r\n    \"lewis6991/gitsigns.nvim\",\r\n    event = \"VeryLazy\",\r\n    config = function() require(\"gitsigns\").setup {} end,\r\n  },\r\n  {\r\n    \"neovim/nvim-lspconfig\",\r\n    config = function()\r\n      -- Most likely LSP required\r\n      -- that frequently sets many signs\r\n      require \"lspconfig\".pyright.setup {}\r\n    end,\r\n  },\r\n}, { root = pluginpath })\r\n````\r\n\r\n1. `nvim -u minimal_init.lua $SOME_FILE_WITH_MANY_SIGNS.py`\r\n2. Hold `j` or `k` to scroll say 10-20 lines\r\n3. Observe freezing / slow down in rendering\r\n\r\nCommenting out\r\n```lua\r\nopt.signcolumn = \"auto:1-4\" -- needs varying length signcolumn\r\n```\r\nfixes the problem.\r\n\r\nCommenting out groups (e.g., `opt.wrap .. opt.showbreak`, `opts.cursorline`) alleviates the issue and potentially fixes it. Similar with disabling `gitsigns` or LSP.\r\n\r\n### Expected behavior\r\n\r\nSmooth rendering without freezes.\r\n\r\n### Neovim version (nvim -v)\r\n\r\nNVIM v0.10.0-dev-1613+g585eeacb24\r\n\r\n### Vim (not Nvim) behaves the same?\r\n\r\nno, doesn't have signcolumn refactor\r\n\r\n### Operating system/version\r\n\r\nArch Linux\r\n\r\n### Terminal name/version\r\n\r\nkitty 0.31.0 \r\n\r\n### $TERM environment variable\r\n\r\nxterm-kitty\r\n\r\n### Installation\r\n\r\nbuild from repo","closed_by":{"login":"lewis6991","id":7904185,"node_id":"MDQ6VXNlcjc5MDQxODU=","avatar_url":"https://avatars.githubusercontent.com/u/7904185?v=4","gravatar_id":"","url":"https://api.github.com/users/lewis6991","html_url":"https://github.com/lewis6991","followers_url":"https://api.github.com/users/lewis6991/followers","following_url":"https://api.github.com/users/lewis6991/following{/other_user}","gists_url":"https://api.github.com/users/lewis6991/gists{/gist_id}","starred_url":"https://api.github.com/users/lewis6991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lewis6991/subscriptions","organizations_url":"https://api.github.com/users/lewis6991/orgs","repos_url":"https://api.github.com/users/lewis6991/repos","events_url":"https://api.github.com/users/lewis6991/events{/privacy}","received_events_url":"https://api.github.com/users/lewis6991/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/26135/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/neovim/neovim/issues/26135/timeline","performed_via_github_app":null,"state_reason":"completed"}