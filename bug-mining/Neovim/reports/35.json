{"url":"https://api.github.com/repos/neovim/neovim/issues/29932","repository_url":"https://api.github.com/repos/neovim/neovim","labels_url":"https://api.github.com/repos/neovim/neovim/issues/29932/labels{/name}","comments_url":"https://api.github.com/repos/neovim/neovim/issues/29932/comments","events_url":"https://api.github.com/repos/neovim/neovim/issues/29932/events","html_url":"https://github.com/neovim/neovim/issues/29932","id":2440957530,"node_id":"I_kwDOAPphoM6Rfg5a","number":29932,"title":"xdg-open doesn't like being run by vim.system","user":{"login":"a3ng7n","id":4608714,"node_id":"MDQ6VXNlcjQ2MDg3MTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4608714?v=4","gravatar_id":"","url":"https://api.github.com/users/a3ng7n","html_url":"https://github.com/a3ng7n","followers_url":"https://api.github.com/users/a3ng7n/followers","following_url":"https://api.github.com/users/a3ng7n/following{/other_user}","gists_url":"https://api.github.com/users/a3ng7n/gists{/gist_id}","starred_url":"https://api.github.com/users/a3ng7n/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/a3ng7n/subscriptions","organizations_url":"https://api.github.com/users/a3ng7n/orgs","repos_url":"https://api.github.com/users/a3ng7n/repos","events_url":"https://api.github.com/users/a3ng7n/events{/privacy}","received_events_url":"https://api.github.com/users/a3ng7n/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":182884815,"node_id":"MDU6TGFiZWwxODI4ODQ4MTU=","url":"https://api.github.com/repos/neovim/neovim/labels/job-control","name":"job-control","color":"c5def5","default":false,"description":"OS processes, spawn"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2024-07-31T21:08:28Z","updated_at":"2024-08-12T07:03:49Z","closed_at":"2024-08-12T07:03:49Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Problem\r\n\r\nWhen running `xdg-open https://google.com` via `vim.system` nothing seems to happen. But the command outside of nvim and in either zsh or bash seems to work. A summary:\r\n1. (in nvim) `:lua vim.system({'xdg-open', 'https://google.com'}, {text = true, detach = true})` doesn't work - no errors reported, etc.\r\n2. (in nvim) `:! xdg-open https://google.com` doesn't work - no errors\r\n3. (in nvim) `:! xdg-open https://google.com 1>/dev/null 2>&1` *does* work\r\n4. (in nvim) ~`:lua vim.system({'xdg-open', 'https://google.com', '1>/dev/null', '2>&1'}, {text = true, detach = true})` doesn't work, and when examining the output via `...vim.system(...):wait().stderr` it shows \"xdg-open: unexpected argument '1>/dev/null' Try 'xdg-open --help' for more information.\", which I imagine means I'm not passing `1>/dev/null` etc. to the shell/process correctly?~\r\n**update:** `:lua vim.system({'bash', '-c', 'xdg-open https://google.com 1>/dev/null 2>&1'}, {text = true, detach = true})` does work, albeit with no output\r\n6. (outside of vim) `$ xdg-open https://google.com` works, but notably shows a bunch of \"Gtk-WARNING\"s etc. in stderr\r\n7. (outside of vim) `$ firefox https://google.com` works, and shows the exact same \"Gtk-WARNING\"s\r\n8. (in nvim) `:lua vim.system({'firefox', 'https://google.com'}, {text = true, detach = true})` does work, and when examining the output via `...vim.system(...):wait().stderr` it shows the same \"Gtk-WARNING\"s\r\n\r\nI don't quite understand all the internals, but I'm guessing xdg-open returns an exit code before the spawned process writes to stderr, whereas firefox returns an exit code after - and given my naiive understanding about `vim.system` it closes the stdout/stderr pipes once it gets a successful exit code, which causes xdg-open's spawn'ed process to not work?\r\n\r\nOddly enough I put `xdg-open $@ 1>/dev/null 2>&1` in test.sh, and running the following works `:lua vim.system({'bash', 'test.sh', 'https://google.com'}, {text = true, detach = true})` albeit with no output of any kind.\r\n\r\n### Steps to reproduce\r\n\r\n(in nvim) `:lua vim.system({'xdg-open', 'https://google.com'}, {text = true, detach = true})`\r\n\r\n### Expected behavior\r\n\r\nExpect browser to open, but nothing happens.\r\n\r\n### Neovim version (nvim -v)\r\n\r\nv0.11.0-dev\r\n\r\n### Vim (not Nvim) behaves the same?\r\n\r\nYes\r\n\r\n### Operating system/version\r\n\r\nUbuntu 24.04\r\n\r\n### Terminal name/version\r\n\r\nkitty 0.32.2\r\n\r\n### $TERM environment variable\r\n\r\nxterm-kitty\r\n\r\n### Installation\r\n\r\nsudo apt install neovim","closed_by":{"login":"zeertzjq","id":35768171,"node_id":"MDQ6VXNlcjM1NzY4MTcx","avatar_url":"https://avatars.githubusercontent.com/u/35768171?v=4","gravatar_id":"","url":"https://api.github.com/users/zeertzjq","html_url":"https://github.com/zeertzjq","followers_url":"https://api.github.com/users/zeertzjq/followers","following_url":"https://api.github.com/users/zeertzjq/following{/other_user}","gists_url":"https://api.github.com/users/zeertzjq/gists{/gist_id}","starred_url":"https://api.github.com/users/zeertzjq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zeertzjq/subscriptions","organizations_url":"https://api.github.com/users/zeertzjq/orgs","repos_url":"https://api.github.com/users/zeertzjq/repos","events_url":"https://api.github.com/users/zeertzjq/events{/privacy}","received_events_url":"https://api.github.com/users/zeertzjq/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/29932/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/neovim/neovim/issues/29932/timeline","performed_via_github_app":null,"state_reason":"completed"}