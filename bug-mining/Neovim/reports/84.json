{"url":"https://api.github.com/repos/neovim/neovim/issues/35116","repository_url":"https://api.github.com/repos/neovim/neovim","labels_url":"https://api.github.com/repos/neovim/neovim/issues/35116/labels{/name}","comments_url":"https://api.github.com/repos/neovim/neovim/issues/35116/comments","events_url":"https://api.github.com/repos/neovim/neovim/issues/35116/events","html_url":"https://github.com/neovim/neovim/issues/35116","id":3279509933,"node_id":"I_kwDOAPphoM7DeVmt","number":35116,"title":"regression: statusline of p causes zero division","user":{"login":"e-kwsm","id":11627708,"node_id":"MDQ6VXNlcjExNjI3NzA4","avatar_url":"https://avatars.githubusercontent.com/u/11627708?v=4","gravatar_id":"","url":"https://api.github.com/users/e-kwsm","html_url":"https://github.com/e-kwsm","followers_url":"https://api.github.com/users/e-kwsm/followers","following_url":"https://api.github.com/users/e-kwsm/following{/other_user}","gists_url":"https://api.github.com/users/e-kwsm/gists{/gist_id}","starred_url":"https://api.github.com/users/e-kwsm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/e-kwsm/subscriptions","organizations_url":"https://api.github.com/users/e-kwsm/orgs","repos_url":"https://api.github.com/users/e-kwsm/repos","events_url":"https://api.github.com/users/e-kwsm/events{/privacy}","received_events_url":"https://api.github.com/users/e-kwsm/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/neovim/neovim/milestones/52","html_url":"https://github.com/neovim/neovim/milestone/52","labels_url":"https://api.github.com/repos/neovim/neovim/milestones/52/labels","id":13265074,"node_id":"MI_kwDOAPphoM4Aymiy","number":52,"title":"0.11.4","description":"","creator":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":53,"state":"closed","created_at":"2025-07-14T12:16:41Z","updated_at":"2025-09-02T18:21:54Z","due_on":null,"closed_at":"2025-09-02T18:21:54Z"},"comments":5,"created_at":"2025-07-31T08:02:05Z","updated_at":"2025-08-17T22:15:16Z","closed_at":"2025-08-17T21:32:55Z","author_association":"CONTRIBUTOR","type":{"id":597163,"node_id":"IT_kwDOAGK_Pc4ACRyr","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-25T10:10:19Z","updated_at":"2024-07-26T10:12:30Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Problem\n\nZero division occurs at  \nhttps://github.com/neovim/neovim/blob/b79ff967ac91dce40f3598ea407c5ccaa2929250/src/nvim/statusline.c#L1471-L1473\n\nThis bisects to b79ff967ac91dce40f3598ea407c5ccaa2929250 (#33723).\n\n### Steps to reproduce\n\nPrepare init.lua\n\n```lua\n-- min.lua\nfor name, url in pairs({\n  \"https://github.com/neovim/nvim-lspconfig\",\n}) do\n  local install_path = vim.fn.fnamemodify(\"nvim_issue/\" .. name, \":p\")\n  if vim.fn.isdirectory(install_path) == 0 then\n    vim.fn.system({ \"git\", \"clone\", \"--depth=1\", url, install_path })\n  end\n  vim.opt.runtimepath:append(install_path)\nend\n\nvim.lsp.enable(\"clangd\")\nvim.o.statusline = '%p'  -- XXX\n```\n\nand a C file named a.c:\n\n```c\n#include <stdio.h>\n```\n\n1. `nvim -u min.lua a.c`\n2. ~`Ctrl-]` → now opens `/usr/include/stdio.h`~ not necessary\n3. `:bw` → SIGFPE\n\n```gdb\nProgram terminated with signal SIGFPE, Arithmetic exception.\n#0  0x0000555fa4c8876d in build_stl_str_hl (wp=0x555fe2e1c860, out=0x7ffdc9f84860 \"\\327\\270\", outlen=4096, fmt=0x555fe2e30050 \"%p\",\n    opt_idx=kOptStatusline, opt_scope=0, fillchar=32, maxwidth=136, hltab=0x7ffdc9f84818, hltab_len=0x0, tabtab=0x7ffdc9f84820,\n    stcp=0x0) at neovim/src/nvim/statusline.c:1472\n1472          num = ((wp->w_cursor.lnum * 100) / wp->w_buffer->b_ml.ml_line_count);\n(gdb) print wp->w_buffer->b_ml.ml_line_count\n$1 = 0\n```\n\n### Expected behavior\n\nNo crash.\n\n### Nvim version (nvim -v)\n\nv0.12.0-dev-b79ff96\n\n### Vim (not Nvim) behaves the same?\n\nn/a\n\n### Operating system/version\n\nEndeavourOS\n\n### Terminal name/version\n\nghostty 1.1.3\n\n### $TERM environment variable\n\nxterm-ghostty\n\n### Installation\n\nbuild from repo","closed_by":{"login":"seandewar","id":6256228,"node_id":"MDQ6VXNlcjYyNTYyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/6256228?v=4","gravatar_id":"","url":"https://api.github.com/users/seandewar","html_url":"https://github.com/seandewar","followers_url":"https://api.github.com/users/seandewar/followers","following_url":"https://api.github.com/users/seandewar/following{/other_user}","gists_url":"https://api.github.com/users/seandewar/gists{/gist_id}","starred_url":"https://api.github.com/users/seandewar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seandewar/subscriptions","organizations_url":"https://api.github.com/users/seandewar/orgs","repos_url":"https://api.github.com/users/seandewar/repos","events_url":"https://api.github.com/users/seandewar/events{/privacy}","received_events_url":"https://api.github.com/users/seandewar/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/35116/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/neovim/neovim/issues/35116/timeline","performed_via_github_app":null,"state_reason":"completed"}