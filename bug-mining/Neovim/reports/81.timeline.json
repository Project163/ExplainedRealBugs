[{"id":15535289866,"node_id":"LE_lADOAPphoM6iFG_EzwAAAAOd-bYK","url":"https://api.github.com/repos/neovim/neovim/issues/events/15535289866","actor":{"login":"ofseed","id":61115159,"node_id":"MDQ6VXNlcjYxMTE1MTU5","avatar_url":"https://avatars.githubusercontent.com/u/61115159?v=4","gravatar_id":"","url":"https://api.github.com/users/ofseed","html_url":"https://github.com/ofseed","followers_url":"https://api.github.com/users/ofseed/followers","following_url":"https://api.github.com/users/ofseed/following{/other_user}","gists_url":"https://api.github.com/users/ofseed/gists{/gist_id}","starred_url":"https://api.github.com/users/ofseed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofseed/subscriptions","organizations_url":"https://api.github.com/users/ofseed/orgs","repos_url":"https://api.github.com/users/ofseed/repos","events_url":"https://api.github.com/users/ofseed/events{/privacy}","received_events_url":"https://api.github.com/users/ofseed/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-12-05T03:54:16Z","label":{"name":"enhancement","color":"c2e0c6"},"performed_via_github_app":null},{"id":15535290689,"node_id":"LE_lADOAPphoM6iFG_EzwAAAAOd-blB","url":"https://api.github.com/repos/neovim/neovim/issues/events/15535290689","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-12-05T03:54:25Z","label":{"name":"lsp","color":"c5def5"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2519035316","html_url":"https://github.com/neovim/neovim/issues/31453#issuecomment-2519035316","issue_url":"https://api.github.com/repos/neovim/neovim/issues/31453","id":2519035316,"node_id":"IC_kwDOAPphoM6WJW20","user":{"login":"ofseed","id":61115159,"node_id":"MDQ6VXNlcjYxMTE1MTU5","avatar_url":"https://avatars.githubusercontent.com/u/61115159?v=4","gravatar_id":"","url":"https://api.github.com/users/ofseed","html_url":"https://github.com/ofseed","followers_url":"https://api.github.com/users/ofseed/followers","following_url":"https://api.github.com/users/ofseed/following{/other_user}","gists_url":"https://api.github.com/users/ofseed/gists{/gist_id}","starred_url":"https://api.github.com/users/ofseed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofseed/subscriptions","organizations_url":"https://api.github.com/users/ofseed/orgs","repos_url":"https://api.github.com/users/ofseed/repos","events_url":"https://api.github.com/users/ofseed/events{/privacy}","received_events_url":"https://api.github.com/users/ofseed/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-05T03:57:00Z","updated_at":"2024-12-05T03:57:00Z","body":"If this is considered a viable strategy, I would like to convert this issue into a tracking issue and proceed with refactoring related functionalities, starting with `lsp/_folding_range.lua`, then `lsp/codelens.lua`, finally `lsp/inlay_hint.lua`.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2519035316/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ofseed","id":61115159,"node_id":"MDQ6VXNlcjYxMTE1MTU5","avatar_url":"https://avatars.githubusercontent.com/u/61115159?v=4","gravatar_id":"","url":"https://api.github.com/users/ofseed","html_url":"https://github.com/ofseed","followers_url":"https://api.github.com/users/ofseed/followers","following_url":"https://api.github.com/users/ofseed/following{/other_user}","gists_url":"https://api.github.com/users/ofseed/gists{/gist_id}","starred_url":"https://api.github.com/users/ofseed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofseed/subscriptions","organizations_url":"https://api.github.com/users/ofseed/orgs","repos_url":"https://api.github.com/users/ofseed/repos","events_url":"https://api.github.com/users/ofseed/events{/privacy}","received_events_url":"https://api.github.com/users/ofseed/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":15543133722,"node_id":"LE_lADOAPphoM6iFG_EzwAAAAOecWYa","url":"https://api.github.com/repos/neovim/neovim/issues/events/15543133722","actor":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-12-05T12:08:59Z","label":{"name":"architecture","color":"C5DEF5"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2520194382","html_url":"https://github.com/neovim/neovim/issues/31453#issuecomment-2520194382","issue_url":"https://api.github.com/repos/neovim/neovim/issues/31453","id":2520194382,"node_id":"IC_kwDOAPphoM6WNx1O","user":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-05T12:31:47Z","updated_at":"2024-12-05T12:31:47Z","body":"Will be helpful to to existing code that will be replaced/lifted into this architecture.\n\n> Use this module for the methods mentioned above to avoid relying on nil-checks (which might mask bugs) and automatically creating tables via metatable methods (which can be difficult to debug).\n\nSounds like a benefit. What are the costs, i.e. why wouldn't we do this?\n\np.s. is https://github.com/neovim/neovim/issues/31454 related?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2520194382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":15543423791,"node_id":"MIE_lADOAPphoM6iFG_EzwAAAAOeddMv","url":"https://api.github.com/repos/neovim/neovim/issues/events/15543423791","actor":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2024-12-05T12:32:03Z","milestone":{"title":"backlog"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2520732316","html_url":"https://github.com/neovim/neovim/issues/31453#issuecomment-2520732316","issue_url":"https://api.github.com/repos/neovim/neovim/issues/31453","id":2520732316,"node_id":"IC_kwDOAPphoM6WP1Kc","user":{"login":"ofseed","id":61115159,"node_id":"MDQ6VXNlcjYxMTE1MTU5","avatar_url":"https://avatars.githubusercontent.com/u/61115159?v=4","gravatar_id":"","url":"https://api.github.com/users/ofseed","html_url":"https://github.com/ofseed","followers_url":"https://api.github.com/users/ofseed/followers","following_url":"https://api.github.com/users/ofseed/following{/other_user}","gists_url":"https://api.github.com/users/ofseed/gists{/gist_id}","starred_url":"https://api.github.com/users/ofseed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofseed/subscriptions","organizations_url":"https://api.github.com/users/ofseed/orgs","repos_url":"https://api.github.com/users/ofseed/repos","events_url":"https://api.github.com/users/ofseed/events{/privacy}","received_events_url":"https://api.github.com/users/ofseed/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-05T15:59:09Z","updated_at":"2024-12-05T16:08:47Z","body":"> What are the costs, i.e. why wouldn't we do this?\n\nMy concern is the risk of regression of already stable and usable features, as refactoring involves some rewriting of the code. My familiarity with the code is not as high as that of the maintainers, so I am unsure if I have enough experience to address this issue, but I am willing to try it myself if others do not. Therefore, the roadmap I currently have is relatively low-risk:\n\n1. Refine the state management part in `_folding_range.lua` and extract state management into a separate module/function.\n2. Change the API of `codelens.lua` to be similar to `inlay_hint.lua`, that is, `vim.lsp.codelens.enable()`.\n\nI was already very interested in the goals above before my recent PRs, but it seems that they are currently blocked by the state management strategy. The priority for refactoring `inlay_hint.lua` is not high, as it should currently be a relatively stable API, and there is no compelling reason to refactor it at this time.\n\n> p.s. is https://github.com/neovim/neovim/issues/31454 related?\n\nI hadn't looked at `vim.lsp.diagnostic` in detail before, but it seems to be quite relevant. Interestingly, I mentioned in the chat that I experienced significant lag when modifying `vim.lsp.buf`, which seems to be the reason described in this issue. I can explore further, and if it is indeed related, I can solve them together.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2520732316/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ofseed","id":61115159,"node_id":"MDQ6VXNlcjYxMTE1MTU5","avatar_url":"https://avatars.githubusercontent.com/u/61115159?v=4","gravatar_id":"","url":"https://api.github.com/users/ofseed","html_url":"https://github.com/ofseed","followers_url":"https://api.github.com/users/ofseed/followers","following_url":"https://api.github.com/users/ofseed/following{/other_user}","gists_url":"https://api.github.com/users/ofseed/gists{/gist_id}","starred_url":"https://api.github.com/users/ofseed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofseed/subscriptions","organizations_url":"https://api.github.com/users/ofseed/orgs","repos_url":"https://api.github.com/users/ofseed/repos","events_url":"https://api.github.com/users/ofseed/events{/privacy}","received_events_url":"https://api.github.com/users/ofseed/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"tris203","id":18444302,"node_id":"MDQ6VXNlcjE4NDQ0MzAy","avatar_url":"https://avatars.githubusercontent.com/u/18444302?v=4","gravatar_id":"","url":"https://api.github.com/users/tris203","html_url":"https://github.com/tris203","followers_url":"https://api.github.com/users/tris203/followers","following_url":"https://api.github.com/users/tris203/following{/other_user}","gists_url":"https://api.github.com/users/tris203/gists{/gist_id}","starred_url":"https://api.github.com/users/tris203/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tris203/subscriptions","organizations_url":"https://api.github.com/users/tris203/orgs","repos_url":"https://api.github.com/users/tris203/repos","events_url":"https://api.github.com/users/tris203/events{/privacy}","received_events_url":"https://api.github.com/users/tris203/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-06T20:21:06Z","updated_at":"2024-12-06T20:21:06Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/neovim/neovim/issues/31483","repository_url":"https://api.github.com/repos/neovim/neovim","labels_url":"https://api.github.com/repos/neovim/neovim/issues/31483/labels{/name}","comments_url":"https://api.github.com/repos/neovim/neovim/issues/31483/comments","events_url":"https://api.github.com/repos/neovim/neovim/issues/31483/events","html_url":"https://github.com/neovim/neovim/pull/31483","id":2723463042,"node_id":"PR_kwDOAPphoM6EWV6I","number":31483,"title":"fix(lsp): cancel pending requests before refreshing","user":{"login":"tris203","id":18444302,"node_id":"MDQ6VXNlcjE4NDQ0MzAy","avatar_url":"https://avatars.githubusercontent.com/u/18444302?v=4","gravatar_id":"","url":"https://api.github.com/users/tris203","html_url":"https://github.com/tris203","followers_url":"https://api.github.com/users/tris203/followers","following_url":"https://api.github.com/users/tris203/following{/other_user}","gists_url":"https://api.github.com/users/tris203/gists{/gist_id}","starred_url":"https://api.github.com/users/tris203/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tris203/subscriptions","organizations_url":"https://api.github.com/users/tris203/orgs","repos_url":"https://api.github.com/users/tris203/repos","events_url":"https://api.github.com/users/tris203/events{/privacy}","received_events_url":"https://api.github.com/users/tris203/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":101930601,"node_id":"MDU6TGFiZWwxMDE5MzA2MDE=","url":"https://api.github.com/repos/neovim/neovim/labels/performance","name":"performance","color":"FEF2C0","default":false,"description":"performance, latency, cpu/memory usage"},{"id":662566370,"node_id":"MDU6TGFiZWw2NjI1NjYzNzA=","url":"https://api.github.com/repos/neovim/neovim/labels/lsp","name":"lsp","color":"c5def5","default":false,"description":null},{"id":7460580876,"node_id":"LA_kwDOAPphoM8AAAABvK9uDA","url":"https://api.github.com/repos/neovim/neovim/labels/needs:backport","name":"needs:backport","color":"FBCA04","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2024-12-06T16:28:09Z","updated_at":"2024-12-07T12:28:39Z","closed_at":"2024-12-07T10:08:33Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":16408992,"node_id":"MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==","name":"neovim","full_name":"neovim/neovim","private":false,"owner":{"login":"neovim","id":6471485,"node_id":"MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6471485?v=4","gravatar_id":"","url":"https://api.github.com/users/neovim","html_url":"https://github.com/neovim","followers_url":"https://api.github.com/users/neovim/followers","following_url":"https://api.github.com/users/neovim/following{/other_user}","gists_url":"https://api.github.com/users/neovim/gists{/gist_id}","starred_url":"https://api.github.com/users/neovim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/neovim/subscriptions","organizations_url":"https://api.github.com/users/neovim/orgs","repos_url":"https://api.github.com/users/neovim/repos","events_url":"https://api.github.com/users/neovim/events{/privacy}","received_events_url":"https://api.github.com/users/neovim/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/neovim/neovim","description":"Vim-fork focused on extensibility and usability","fork":false,"url":"https://api.github.com/repos/neovim/neovim","forks_url":"https://api.github.com/repos/neovim/neovim/forks","keys_url":"https://api.github.com/repos/neovim/neovim/keys{/key_id}","collaborators_url":"https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/neovim/neovim/teams","hooks_url":"https://api.github.com/repos/neovim/neovim/hooks","issue_events_url":"https://api.github.com/repos/neovim/neovim/issues/events{/number}","events_url":"https://api.github.com/repos/neovim/neovim/events","assignees_url":"https://api.github.com/repos/neovim/neovim/assignees{/user}","branches_url":"https://api.github.com/repos/neovim/neovim/branches{/branch}","tags_url":"https://api.github.com/repos/neovim/neovim/tags","blobs_url":"https://api.github.com/repos/neovim/neovim/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/neovim/neovim/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/neovim/neovim/git/refs{/sha}","trees_url":"https://api.github.com/repos/neovim/neovim/git/trees{/sha}","statuses_url":"https://api.github.com/repos/neovim/neovim/statuses/{sha}","languages_url":"https://api.github.com/repos/neovim/neovim/languages","stargazers_url":"https://api.github.com/repos/neovim/neovim/stargazers","contributors_url":"https://api.github.com/repos/neovim/neovim/contributors","subscribers_url":"https://api.github.com/repos/neovim/neovim/subscribers","subscription_url":"https://api.github.com/repos/neovim/neovim/subscription","commits_url":"https://api.github.com/repos/neovim/neovim/commits{/sha}","git_commits_url":"https://api.github.com/repos/neovim/neovim/git/commits{/sha}","comments_url":"https://api.github.com/repos/neovim/neovim/comments{/number}","issue_comment_url":"https://api.github.com/repos/neovim/neovim/issues/comments{/number}","contents_url":"https://api.github.com/repos/neovim/neovim/contents/{+path}","compare_url":"https://api.github.com/repos/neovim/neovim/compare/{base}...{head}","merges_url":"https://api.github.com/repos/neovim/neovim/merges","archive_url":"https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/neovim/neovim/downloads","issues_url":"https://api.github.com/repos/neovim/neovim/issues{/number}","pulls_url":"https://api.github.com/repos/neovim/neovim/pulls{/number}","milestones_url":"https://api.github.com/repos/neovim/neovim/milestones{/number}","notifications_url":"https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/neovim/neovim/labels{/name}","releases_url":"https://api.github.com/repos/neovim/neovim/releases{/id}","deployments_url":"https://api.github.com/repos/neovim/neovim/deployments","created_at":"2014-01-31T13:39:22Z","updated_at":"2025-11-10T01:49:31Z","pushed_at":"2025-11-10T01:49:25Z","git_url":"git://github.com/neovim/neovim.git","ssh_url":"git@github.com:neovim/neovim.git","clone_url":"https://github.com/neovim/neovim.git","svn_url":"https://github.com/neovim/neovim","homepage":"https://neovim.io","size":350662,"stargazers_count":94128,"watchers_count":94128,"language":"Vim Script","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":6408,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2074,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["api","c","lua","neovim","nvim","text-editor","vim"],"visibility":"public","forks":6408,"open_issues":2074,"watchers":94128,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/neovim/neovim/pulls/31483","html_url":"https://github.com/neovim/neovim/pull/31483","diff_url":"https://github.com/neovim/neovim/pull/31483.diff","patch_url":"https://github.com/neovim/neovim/pull/31483.patch","merged_at":"2024-12-07T10:08:33Z"},"body":"Problem:\r\nDiagnostics and inlay hints can be expensive to calculate, and we shouldn't stack them as this can cause noticeable lag.\r\n\r\nSolution:\r\nCheck for duplicate inflight requests and cancel them before issuing a new one. This ensures that only the latest request is processed, improving performance and preventing potential conflicts.\r\n\r\nThis is part of an issue uncovered here:\r\nhttps://github.com/seblj/roslyn.nvim/issues/93\r\n\r\nOpen as draft whilst some more people test it","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/31483/reactions","total_count":12,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":6,"rocket":5,"eyes":1},"timeline_url":"https://api.github.com/repos/neovim/neovim/issues/31483/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":15565542675,"node_id":"SE_lADOAPphoM6iFG_EzwAAAAOfx1UT","url":"https://api.github.com/repos/neovim/neovim/issues/events/15565542675","actor":{"login":"dbuch","id":1972049,"node_id":"MDQ6VXNlcjE5NzIwNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1972049?v=4","gravatar_id":"","url":"https://api.github.com/users/dbuch","html_url":"https://github.com/dbuch","followers_url":"https://api.github.com/users/dbuch/followers","following_url":"https://api.github.com/users/dbuch/following{/other_user}","gists_url":"https://api.github.com/users/dbuch/gists{/gist_id}","starred_url":"https://api.github.com/users/dbuch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbuch/subscriptions","organizations_url":"https://api.github.com/users/dbuch/orgs","repos_url":"https://api.github.com/users/dbuch/repos","events_url":"https://api.github.com/users/dbuch/events{/privacy}","received_events_url":"https://api.github.com/users/dbuch/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-12-06T20:41:59Z","performed_via_github_app":null},{"actor":{"login":"tris203","id":18444302,"node_id":"MDQ6VXNlcjE4NDQ0MzAy","avatar_url":"https://avatars.githubusercontent.com/u/18444302?v=4","gravatar_id":"","url":"https://api.github.com/users/tris203","html_url":"https://github.com/tris203","followers_url":"https://api.github.com/users/tris203/followers","following_url":"https://api.github.com/users/tris203/following{/other_user}","gists_url":"https://api.github.com/users/tris203/gists{/gist_id}","starred_url":"https://api.github.com/users/tris203/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tris203/subscriptions","organizations_url":"https://api.github.com/users/tris203/orgs","repos_url":"https://api.github.com/users/tris203/repos","events_url":"https://api.github.com/users/tris203/events{/privacy}","received_events_url":"https://api.github.com/users/tris203/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-06T20:56:10Z","updated_at":"2024-12-06T20:56:10Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/neovim/neovim/issues/31454","repository_url":"https://api.github.com/repos/neovim/neovim","labels_url":"https://api.github.com/repos/neovim/neovim/issues/31454/labels{/name}","comments_url":"https://api.github.com/repos/neovim/neovim/issues/31454/comments","events_url":"https://api.github.com/repos/neovim/neovim/issues/31454/events","html_url":"https://github.com/neovim/neovim/issues/31454","id":2719432608,"node_id":"I_kwDOAPphoM6iFz-g","number":31454,"title":"LSP: Improve textDocument/diagnostic performance by conforming to LSP spec","user":{"login":"molostovvs","id":86685532,"node_id":"MDQ6VXNlcjg2Njg1NTMy","avatar_url":"https://avatars.githubusercontent.com/u/86685532?v=4","gravatar_id":"","url":"https://api.github.com/users/molostovvs","html_url":"https://github.com/molostovvs","followers_url":"https://api.github.com/users/molostovvs/followers","following_url":"https://api.github.com/users/molostovvs/following{/other_user}","gists_url":"https://api.github.com/users/molostovvs/gists{/gist_id}","starred_url":"https://api.github.com/users/molostovvs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/molostovvs/subscriptions","organizations_url":"https://api.github.com/users/molostovvs/orgs","repos_url":"https://api.github.com/users/molostovvs/repos","events_url":"https://api.github.com/users/molostovvs/events{/privacy}","received_events_url":"https://api.github.com/users/molostovvs/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":101930601,"node_id":"MDU6TGFiZWwxMDE5MzA2MDE=","url":"https://api.github.com/repos/neovim/neovim/labels/performance","name":"performance","color":"FEF2C0","default":false,"description":"performance, latency, cpu/memory usage"},{"id":662566370,"node_id":"MDU6TGFiZWw2NjI1NjYzNzA=","url":"https://api.github.com/repos/neovim/neovim/labels/lsp","name":"lsp","color":"c5def5","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/neovim/neovim/milestones/9","html_url":"https://github.com/neovim/neovim/milestone/9","labels_url":"https://api.github.com/repos/neovim/neovim/milestones/9/labels","id":881978,"node_id":"MDk6TWlsZXN0b25lODgxOTc4","number":9,"title":"needs-owner","description":"We don't plan to work on this, but will accept high quality contributions from someone who will own the feature and follow up on bug reports.","creator":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":355,"closed_issues":297,"state":"open","created_at":"2014-11-26T22:13:11Z","updated_at":"2025-11-04T03:06:49Z","due_on":null,"closed_at":null},"comments":2,"created_at":"2024-12-05T06:09:13Z","updated_at":"2025-04-26T16:09:22Z","closed_at":"2025-04-26T16:09:21Z","author_association":"NONE","type":{"id":597167,"node_id":"IT_kwDOAGK_Pc4ACRyv","name":"Enhancement","description":"A request, idea, or new functionality","color":"blue","created_at":"2024-01-25T10:10:19Z","updated_at":"2024-07-26T10:12:30Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":16408992,"node_id":"MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==","name":"neovim","full_name":"neovim/neovim","private":false,"owner":{"login":"neovim","id":6471485,"node_id":"MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6471485?v=4","gravatar_id":"","url":"https://api.github.com/users/neovim","html_url":"https://github.com/neovim","followers_url":"https://api.github.com/users/neovim/followers","following_url":"https://api.github.com/users/neovim/following{/other_user}","gists_url":"https://api.github.com/users/neovim/gists{/gist_id}","starred_url":"https://api.github.com/users/neovim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/neovim/subscriptions","organizations_url":"https://api.github.com/users/neovim/orgs","repos_url":"https://api.github.com/users/neovim/repos","events_url":"https://api.github.com/users/neovim/events{/privacy}","received_events_url":"https://api.github.com/users/neovim/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/neovim/neovim","description":"Vim-fork focused on extensibility and usability","fork":false,"url":"https://api.github.com/repos/neovim/neovim","forks_url":"https://api.github.com/repos/neovim/neovim/forks","keys_url":"https://api.github.com/repos/neovim/neovim/keys{/key_id}","collaborators_url":"https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/neovim/neovim/teams","hooks_url":"https://api.github.com/repos/neovim/neovim/hooks","issue_events_url":"https://api.github.com/repos/neovim/neovim/issues/events{/number}","events_url":"https://api.github.com/repos/neovim/neovim/events","assignees_url":"https://api.github.com/repos/neovim/neovim/assignees{/user}","branches_url":"https://api.github.com/repos/neovim/neovim/branches{/branch}","tags_url":"https://api.github.com/repos/neovim/neovim/tags","blobs_url":"https://api.github.com/repos/neovim/neovim/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/neovim/neovim/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/neovim/neovim/git/refs{/sha}","trees_url":"https://api.github.com/repos/neovim/neovim/git/trees{/sha}","statuses_url":"https://api.github.com/repos/neovim/neovim/statuses/{sha}","languages_url":"https://api.github.com/repos/neovim/neovim/languages","stargazers_url":"https://api.github.com/repos/neovim/neovim/stargazers","contributors_url":"https://api.github.com/repos/neovim/neovim/contributors","subscribers_url":"https://api.github.com/repos/neovim/neovim/subscribers","subscription_url":"https://api.github.com/repos/neovim/neovim/subscription","commits_url":"https://api.github.com/repos/neovim/neovim/commits{/sha}","git_commits_url":"https://api.github.com/repos/neovim/neovim/git/commits{/sha}","comments_url":"https://api.github.com/repos/neovim/neovim/comments{/number}","issue_comment_url":"https://api.github.com/repos/neovim/neovim/issues/comments{/number}","contents_url":"https://api.github.com/repos/neovim/neovim/contents/{+path}","compare_url":"https://api.github.com/repos/neovim/neovim/compare/{base}...{head}","merges_url":"https://api.github.com/repos/neovim/neovim/merges","archive_url":"https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/neovim/neovim/downloads","issues_url":"https://api.github.com/repos/neovim/neovim/issues{/number}","pulls_url":"https://api.github.com/repos/neovim/neovim/pulls{/number}","milestones_url":"https://api.github.com/repos/neovim/neovim/milestones{/number}","notifications_url":"https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/neovim/neovim/labels{/name}","releases_url":"https://api.github.com/repos/neovim/neovim/releases{/id}","deployments_url":"https://api.github.com/repos/neovim/neovim/deployments","created_at":"2014-01-31T13:39:22Z","updated_at":"2025-11-10T01:49:31Z","pushed_at":"2025-11-10T01:49:25Z","git_url":"git://github.com/neovim/neovim.git","ssh_url":"git@github.com:neovim/neovim.git","clone_url":"https://github.com/neovim/neovim.git","svn_url":"https://github.com/neovim/neovim","homepage":"https://neovim.io","size":350662,"stargazers_count":94128,"watchers_count":94128,"language":"Vim Script","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":6408,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2074,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["api","c","lua","neovim","nvim","text-editor","vim"],"visibility":"public","forks":6408,"open_issues":2074,"watchers":94128,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"### Problem\n\nUsers of the Roslyn LSP (used for C# in VS Code) have encountered significant delays when retrieving pull diagnostics in large documents while using Neovim. For instance, diagnostics in a 2000-line .cs file can take over 20 seconds to display after edits in Neovim, whereas in VS Code, diagnostics for the same file are displayed almost instantly.\n\nAs [@mparq noted](https://github.com/seblj/roslyn.nvim/issues/93#issuecomment-2508940330) in https://github.com/seblj/roslyn.nvim/issues/93, VS Code leverages additional parameters specified in the [LSP documentation for textDocument/diagnostic](https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#documentDiagnosticParams), specifically:\n\n- previousResultId\n- identifier\n\n\n### Expected behavior\n\nWhen requesting diagnostics, Neovim should include the `previousResultId` and `identifier` parameters as part of the request.\nThese parameters enable the server to utilize caching and return incremental results.\n\nSupport for maintaining state is already present in the [textDocument/semanticTokens implementation](https://github.com/neovim/neovim/blob/8f84167c30692555d3332565605e8a625aebc43c/runtime/lua/vim/lsp/semantic_tokens.lua#L289).\nA similar mechanism could probably be implemented in `textDocument/diagnostic` handler.","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/31454/reactions","total_count":18,"+1":18,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/neovim/neovim/issues/31454/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2526272977","html_url":"https://github.com/neovim/neovim/issues/31453#issuecomment-2526272977","issue_url":"https://api.github.com/repos/neovim/neovim/issues/31453","id":2526272977,"node_id":"IC_kwDOAPphoM6Wk93R","user":{"login":"ribru17","id":55766287,"node_id":"MDQ6VXNlcjU1NzY2Mjg3","avatar_url":"https://avatars.githubusercontent.com/u/55766287?v=4","gravatar_id":"","url":"https://api.github.com/users/ribru17","html_url":"https://github.com/ribru17","followers_url":"https://api.github.com/users/ribru17/followers","following_url":"https://api.github.com/users/ribru17/following{/other_user}","gists_url":"https://api.github.com/users/ribru17/gists{/gist_id}","starred_url":"https://api.github.com/users/ribru17/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ribru17/subscriptions","organizations_url":"https://api.github.com/users/ribru17/orgs","repos_url":"https://api.github.com/users/ribru17/repos","events_url":"https://api.github.com/users/ribru17/events{/privacy}","received_events_url":"https://api.github.com/users/ribru17/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-08T17:25:38Z","updated_at":"2024-12-08T17:27:23Z","body":"Would it be bad to keep folding data in a more generalized place (such that it is not specific to LSP folds)? I dream of a way in the future to set something like \n\n```scm\n((import_statement)+ @fold \n  (#set! foldkind.imports))\n```\n\nusing tree-sitter queries, and then users can just set some simple config option to auto-fold imports which will work regardless of whether a certain filetype is using TS or LSP folding\n\nI assume this is relevant because the current LSP way does this by iterating through the LSP's own cache of folds, checking fold type (and TS has its own separate fold cache)","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2526272977/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ribru17","id":55766287,"node_id":"MDQ6VXNlcjU1NzY2Mjg3","avatar_url":"https://avatars.githubusercontent.com/u/55766287?v=4","gravatar_id":"","url":"https://api.github.com/users/ribru17","html_url":"https://github.com/ribru17","followers_url":"https://api.github.com/users/ribru17/followers","following_url":"https://api.github.com/users/ribru17/following{/other_user}","gists_url":"https://api.github.com/users/ribru17/gists{/gist_id}","starred_url":"https://api.github.com/users/ribru17/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ribru17/subscriptions","organizations_url":"https://api.github.com/users/ribru17/orgs","repos_url":"https://api.github.com/users/ribru17/repos","events_url":"https://api.github.com/users/ribru17/events{/privacy}","received_events_url":"https://api.github.com/users/ribru17/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2526327027","html_url":"https://github.com/neovim/neovim/issues/31453#issuecomment-2526327027","issue_url":"https://api.github.com/repos/neovim/neovim/issues/31453","id":2526327027,"node_id":"IC_kwDOAPphoM6WlLDz","user":{"login":"lewis6991","id":7904185,"node_id":"MDQ6VXNlcjc5MDQxODU=","avatar_url":"https://avatars.githubusercontent.com/u/7904185?v=4","gravatar_id":"","url":"https://api.github.com/users/lewis6991","html_url":"https://github.com/lewis6991","followers_url":"https://api.github.com/users/lewis6991/followers","following_url":"https://api.github.com/users/lewis6991/following{/other_user}","gists_url":"https://api.github.com/users/lewis6991/gists{/gist_id}","starred_url":"https://api.github.com/users/lewis6991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lewis6991/subscriptions","organizations_url":"https://api.github.com/users/lewis6991/orgs","repos_url":"https://api.github.com/users/lewis6991/repos","events_url":"https://api.github.com/users/lewis6991/events{/privacy}","received_events_url":"https://api.github.com/users/lewis6991/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-08T18:54:52Z","updated_at":"2024-12-08T18:54:52Z","body":"I think mixing folding for both LSP and treesitter would be way too complex, and thus out of scope, unless there is a strong argument. These are just different backends","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2526327027/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lewis6991","id":7904185,"node_id":"MDQ6VXNlcjc5MDQxODU=","avatar_url":"https://avatars.githubusercontent.com/u/7904185?v=4","gravatar_id":"","url":"https://api.github.com/users/lewis6991","html_url":"https://github.com/lewis6991","followers_url":"https://api.github.com/users/lewis6991/followers","following_url":"https://api.github.com/users/lewis6991/following{/other_user}","gists_url":"https://api.github.com/users/lewis6991/gists{/gist_id}","starred_url":"https://api.github.com/users/lewis6991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lewis6991/subscriptions","organizations_url":"https://api.github.com/users/lewis6991/orgs","repos_url":"https://api.github.com/users/lewis6991/repos","events_url":"https://api.github.com/users/lewis6991/events{/privacy}","received_events_url":"https://api.github.com/users/lewis6991/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2526975033","html_url":"https://github.com/neovim/neovim/issues/31453#issuecomment-2526975033","issue_url":"https://api.github.com/repos/neovim/neovim/issues/31453","id":2526975033,"node_id":"IC_kwDOAPphoM6WnpQ5","user":{"login":"ofseed","id":61115159,"node_id":"MDQ6VXNlcjYxMTE1MTU5","avatar_url":"https://avatars.githubusercontent.com/u/61115159?v=4","gravatar_id":"","url":"https://api.github.com/users/ofseed","html_url":"https://github.com/ofseed","followers_url":"https://api.github.com/users/ofseed/followers","following_url":"https://api.github.com/users/ofseed/following{/other_user}","gists_url":"https://api.github.com/users/ofseed/gists{/gist_id}","starred_url":"https://api.github.com/users/ofseed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofseed/subscriptions","organizations_url":"https://api.github.com/users/ofseed/orgs","repos_url":"https://api.github.com/users/ofseed/repos","events_url":"https://api.github.com/users/ofseed/events{/privacy}","received_events_url":"https://api.github.com/users/ofseed/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-09T05:35:17Z","updated_at":"2024-12-09T05:35:17Z","body":"> Would it be bad to keep folding data in a more generalized place (such that it is not specific to LSP folds)? I dream of a way in the future to set something like\n\nMy personal recommendation is to implement a server with a backend based on tree-sitter, providing folding data through LSP (after all, it is an interface). I should have implemented basic support for multiple servers. This may not be closely related to the scope of this issue. I mainly want to find a reliable way to save the result of the LSP response (not only folding ranges but also inlay hints or code lenses) instead of handling it and immediately discarding it here.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2526975033/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ofseed","id":61115159,"node_id":"MDQ6VXNlcjYxMTE1MTU5","avatar_url":"https://avatars.githubusercontent.com/u/61115159?v=4","gravatar_id":"","url":"https://api.github.com/users/ofseed","html_url":"https://github.com/ofseed","followers_url":"https://api.github.com/users/ofseed/followers","following_url":"https://api.github.com/users/ofseed/following{/other_user}","gists_url":"https://api.github.com/users/ofseed/gists{/gist_id}","starred_url":"https://api.github.com/users/ofseed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofseed/subscriptions","organizations_url":"https://api.github.com/users/ofseed/orgs","repos_url":"https://api.github.com/users/ofseed/repos","events_url":"https://api.github.com/users/ofseed/events{/privacy}","received_events_url":"https://api.github.com/users/ofseed/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":15583071793,"node_id":"SE_lADOAPphoM6iFG_EzwAAAAOg0s4x","url":"https://api.github.com/repos/neovim/neovim/issues/events/15583071793","actor":{"login":"mike325","id":4576770,"node_id":"MDQ6VXNlcjQ1NzY3NzA=","avatar_url":"https://avatars.githubusercontent.com/u/4576770?v=4","gravatar_id":"","url":"https://api.github.com/users/mike325","html_url":"https://github.com/mike325","followers_url":"https://api.github.com/users/mike325/followers","following_url":"https://api.github.com/users/mike325/following{/other_user}","gists_url":"https://api.github.com/users/mike325/gists{/gist_id}","starred_url":"https://api.github.com/users/mike325/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mike325/subscriptions","organizations_url":"https://api.github.com/users/mike325/orgs","repos_url":"https://api.github.com/users/mike325/repos","events_url":"https://api.github.com/users/mike325/events{/privacy}","received_events_url":"https://api.github.com/users/mike325/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-12-09T13:11:47Z","performed_via_github_app":null},{"id":15586425437,"node_id":"SE_lADOAPphoM6iFG_EzwAAAAOhBfpd","url":"https://api.github.com/repos/neovim/neovim/issues/events/15586425437","actor":{"login":"lucy","id":1666345,"node_id":"MDQ6VXNlcjE2NjYzNDU=","avatar_url":"https://avatars.githubusercontent.com/u/1666345?v=4","gravatar_id":"","url":"https://api.github.com/users/lucy","html_url":"https://github.com/lucy","followers_url":"https://api.github.com/users/lucy/followers","following_url":"https://api.github.com/users/lucy/following{/other_user}","gists_url":"https://api.github.com/users/lucy/gists{/gist_id}","starred_url":"https://api.github.com/users/lucy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucy/subscriptions","organizations_url":"https://api.github.com/users/lucy/orgs","repos_url":"https://api.github.com/users/lucy/repos","events_url":"https://api.github.com/users/lucy/events{/privacy}","received_events_url":"https://api.github.com/users/lucy/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-12-09T16:16:02Z","performed_via_github_app":null},{"id":15597104167,"node_id":"SE_lADOAPphoM6iFG_EzwAAAAOhqOwn","url":"https://api.github.com/repos/neovim/neovim/issues/events/15597104167","actor":{"login":"tris203","id":18444302,"node_id":"MDQ6VXNlcjE4NDQ0MzAy","avatar_url":"https://avatars.githubusercontent.com/u/18444302?v=4","gravatar_id":"","url":"https://api.github.com/users/tris203","html_url":"https://github.com/tris203","followers_url":"https://api.github.com/users/tris203/followers","following_url":"https://api.github.com/users/tris203/following{/other_user}","gists_url":"https://api.github.com/users/tris203/gists{/gist_id}","starred_url":"https://api.github.com/users/tris203/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tris203/subscriptions","organizations_url":"https://api.github.com/users/tris203/orgs","repos_url":"https://api.github.com/users/tris203/repos","events_url":"https://api.github.com/users/tris203/events{/privacy}","received_events_url":"https://api.github.com/users/tris203/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-12-10T08:58:43Z","performed_via_github_app":null},{"id":15605685214,"node_id":"UE_lADOAPphoM6iFG_EzwAAAAOiK9ve","url":"https://api.github.com/repos/neovim/neovim/issues/events/15605685214","actor":{"login":"lewis6991","id":7904185,"node_id":"MDQ6VXNlcjc5MDQxODU=","avatar_url":"https://avatars.githubusercontent.com/u/7904185?v=4","gravatar_id":"","url":"https://api.github.com/users/lewis6991","html_url":"https://github.com/lewis6991","followers_url":"https://api.github.com/users/lewis6991/followers","following_url":"https://api.github.com/users/lewis6991/following{/other_user}","gists_url":"https://api.github.com/users/lewis6991/gists{/gist_id}","starred_url":"https://api.github.com/users/lewis6991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lewis6991/subscriptions","organizations_url":"https://api.github.com/users/lewis6991/orgs","repos_url":"https://api.github.com/users/lewis6991/repos","events_url":"https://api.github.com/users/lewis6991/events{/privacy}","received_events_url":"https://api.github.com/users/lewis6991/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unsubscribed","commit_id":null,"commit_url":null,"created_at":"2024-12-10T18:39:46Z","performed_via_github_app":null},{"id":15605685413,"node_id":"UE_lADOAPphoM6iFG_EzwAAAAOiK9yl","url":"https://api.github.com/repos/neovim/neovim/issues/events/15605685413","actor":{"login":"lewis6991","id":7904185,"node_id":"MDQ6VXNlcjc5MDQxODU=","avatar_url":"https://avatars.githubusercontent.com/u/7904185?v=4","gravatar_id":"","url":"https://api.github.com/users/lewis6991","html_url":"https://github.com/lewis6991","followers_url":"https://api.github.com/users/lewis6991/followers","following_url":"https://api.github.com/users/lewis6991/following{/other_user}","gists_url":"https://api.github.com/users/lewis6991/gists{/gist_id}","starred_url":"https://api.github.com/users/lewis6991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lewis6991/subscriptions","organizations_url":"https://api.github.com/users/lewis6991/orgs","repos_url":"https://api.github.com/users/lewis6991/repos","events_url":"https://api.github.com/users/lewis6991/events{/privacy}","received_events_url":"https://api.github.com/users/lewis6991/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unsubscribed","commit_id":null,"commit_url":null,"created_at":"2024-12-10T18:39:48Z","performed_via_github_app":null},{"id":16038973239,"node_id":"SE_lADOAPphoM6iFG_EzwAAAAO7_083","url":"https://api.github.com/repos/neovim/neovim/issues/events/16038973239","actor":{"login":"mcauley-penney","id":59481467,"node_id":"MDQ6VXNlcjU5NDgxNDY3","avatar_url":"https://avatars.githubusercontent.com/u/59481467?v=4","gravatar_id":"","url":"https://api.github.com/users/mcauley-penney","html_url":"https://github.com/mcauley-penney","followers_url":"https://api.github.com/users/mcauley-penney/followers","following_url":"https://api.github.com/users/mcauley-penney/following{/other_user}","gists_url":"https://api.github.com/users/mcauley-penney/gists{/gist_id}","starred_url":"https://api.github.com/users/mcauley-penney/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mcauley-penney/subscriptions","organizations_url":"https://api.github.com/users/mcauley-penney/orgs","repos_url":"https://api.github.com/users/mcauley-penney/repos","events_url":"https://api.github.com/users/mcauley-penney/events{/privacy}","received_events_url":"https://api.github.com/users/mcauley-penney/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2025-01-23T06:35:32Z","performed_via_github_app":null},{"id":16190691958,"node_id":"SE_lADOAPphoM6iFG_EzwAAAAPFClp2","url":"https://api.github.com/repos/neovim/neovim/issues/events/16190691958","actor":{"login":"tomashruska1","id":82532992,"node_id":"MDQ6VXNlcjgyNTMyOTky","avatar_url":"https://avatars.githubusercontent.com/u/82532992?v=4","gravatar_id":"","url":"https://api.github.com/users/tomashruska1","html_url":"https://github.com/tomashruska1","followers_url":"https://api.github.com/users/tomashruska1/followers","following_url":"https://api.github.com/users/tomashruska1/following{/other_user}","gists_url":"https://api.github.com/users/tomashruska1/gists{/gist_id}","starred_url":"https://api.github.com/users/tomashruska1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomashruska1/subscriptions","organizations_url":"https://api.github.com/users/tomashruska1/orgs","repos_url":"https://api.github.com/users/tomashruska1/repos","events_url":"https://api.github.com/users/tomashruska1/events{/privacy}","received_events_url":"https://api.github.com/users/tomashruska1/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2025-02-05T08:32:34Z","performed_via_github_app":null},{"actor":{"login":"ofseed","id":61115159,"node_id":"MDQ6VXNlcjYxMTE1MTU5","avatar_url":"https://avatars.githubusercontent.com/u/61115159?v=4","gravatar_id":"","url":"https://api.github.com/users/ofseed","html_url":"https://github.com/ofseed","followers_url":"https://api.github.com/users/ofseed/followers","following_url":"https://api.github.com/users/ofseed/following{/other_user}","gists_url":"https://api.github.com/users/ofseed/gists{/gist_id}","starred_url":"https://api.github.com/users/ofseed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofseed/subscriptions","organizations_url":"https://api.github.com/users/ofseed/orgs","repos_url":"https://api.github.com/users/ofseed/repos","events_url":"https://api.github.com/users/ofseed/events{/privacy}","received_events_url":"https://api.github.com/users/ofseed/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-02-11T11:32:18Z","updated_at":"2025-02-11T11:32:18Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/neovim/neovim/issues/32247","repository_url":"https://api.github.com/repos/neovim/neovim","labels_url":"https://api.github.com/repos/neovim/neovim/issues/32247/labels{/name}","comments_url":"https://api.github.com/repos/neovim/neovim/issues/32247/comments","events_url":"https://api.github.com/repos/neovim/neovim/issues/32247/events","html_url":"https://github.com/neovim/neovim/issues/32247","id":2818377612,"node_id":"I_kwDOAPphoM6n_QeM","number":32247,"title":"LSP: diagnostics for current buffer are cleared after :edit","user":{"login":"ckipp01","id":13974112,"node_id":"MDQ6VXNlcjEzOTc0MTEy","avatar_url":"https://avatars.githubusercontent.com/u/13974112?v=4","gravatar_id":"","url":"https://api.github.com/users/ckipp01","html_url":"https://github.com/ckipp01","followers_url":"https://api.github.com/users/ckipp01/followers","following_url":"https://api.github.com/users/ckipp01/following{/other_user}","gists_url":"https://api.github.com/users/ckipp01/gists{/gist_id}","starred_url":"https://api.github.com/users/ckipp01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ckipp01/subscriptions","organizations_url":"https://api.github.com/users/ckipp01/orgs","repos_url":"https://api.github.com/users/ckipp01/repos","events_url":"https://api.github.com/users/ckipp01/events{/privacy}","received_events_url":"https://api.github.com/users/ckipp01/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":662566370,"node_id":"MDU6TGFiZWw2NjI1NjYzNzA=","url":"https://api.github.com/repos/neovim/neovim/labels/lsp","name":"lsp","color":"c5def5","default":false,"description":null},{"id":3361645105,"node_id":"MDU6TGFiZWwzMzYxNjQ1MTA1","url":"https://api.github.com/repos/neovim/neovim/labels/diagnostic","name":"diagnostic","color":"C5DEF5","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/neovim/neovim/milestones/6","html_url":"https://github.com/neovim/neovim/milestone/6","labels_url":"https://api.github.com/repos/neovim/neovim/milestones/6/labels","id":655037,"node_id":"MDk6TWlsZXN0b25lNjU1MDM3","number":6,"title":"backlog","description":"Low priority items. We plan to work on this but don't have a target date.","creator":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":637,"closed_issues":749,"state":"open","created_at":"2014-05-10T20:43:04Z","updated_at":"2025-11-04T00:12:22Z","due_on":null,"closed_at":null},"comments":12,"created_at":"2025-01-29T14:25:50Z","updated_at":"2025-02-13T08:34:33Z","closed_at":null,"author_association":"CONTRIBUTOR","type":{"id":597163,"node_id":"IT_kwDOAGK_Pc4ACRyr","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-25T10:10:19Z","updated_at":"2024-07-26T10:12:30Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":16408992,"node_id":"MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==","name":"neovim","full_name":"neovim/neovim","private":false,"owner":{"login":"neovim","id":6471485,"node_id":"MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6471485?v=4","gravatar_id":"","url":"https://api.github.com/users/neovim","html_url":"https://github.com/neovim","followers_url":"https://api.github.com/users/neovim/followers","following_url":"https://api.github.com/users/neovim/following{/other_user}","gists_url":"https://api.github.com/users/neovim/gists{/gist_id}","starred_url":"https://api.github.com/users/neovim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/neovim/subscriptions","organizations_url":"https://api.github.com/users/neovim/orgs","repos_url":"https://api.github.com/users/neovim/repos","events_url":"https://api.github.com/users/neovim/events{/privacy}","received_events_url":"https://api.github.com/users/neovim/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/neovim/neovim","description":"Vim-fork focused on extensibility and usability","fork":false,"url":"https://api.github.com/repos/neovim/neovim","forks_url":"https://api.github.com/repos/neovim/neovim/forks","keys_url":"https://api.github.com/repos/neovim/neovim/keys{/key_id}","collaborators_url":"https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/neovim/neovim/teams","hooks_url":"https://api.github.com/repos/neovim/neovim/hooks","issue_events_url":"https://api.github.com/repos/neovim/neovim/issues/events{/number}","events_url":"https://api.github.com/repos/neovim/neovim/events","assignees_url":"https://api.github.com/repos/neovim/neovim/assignees{/user}","branches_url":"https://api.github.com/repos/neovim/neovim/branches{/branch}","tags_url":"https://api.github.com/repos/neovim/neovim/tags","blobs_url":"https://api.github.com/repos/neovim/neovim/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/neovim/neovim/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/neovim/neovim/git/refs{/sha}","trees_url":"https://api.github.com/repos/neovim/neovim/git/trees{/sha}","statuses_url":"https://api.github.com/repos/neovim/neovim/statuses/{sha}","languages_url":"https://api.github.com/repos/neovim/neovim/languages","stargazers_url":"https://api.github.com/repos/neovim/neovim/stargazers","contributors_url":"https://api.github.com/repos/neovim/neovim/contributors","subscribers_url":"https://api.github.com/repos/neovim/neovim/subscribers","subscription_url":"https://api.github.com/repos/neovim/neovim/subscription","commits_url":"https://api.github.com/repos/neovim/neovim/commits{/sha}","git_commits_url":"https://api.github.com/repos/neovim/neovim/git/commits{/sha}","comments_url":"https://api.github.com/repos/neovim/neovim/comments{/number}","issue_comment_url":"https://api.github.com/repos/neovim/neovim/issues/comments{/number}","contents_url":"https://api.github.com/repos/neovim/neovim/contents/{+path}","compare_url":"https://api.github.com/repos/neovim/neovim/compare/{base}...{head}","merges_url":"https://api.github.com/repos/neovim/neovim/merges","archive_url":"https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/neovim/neovim/downloads","issues_url":"https://api.github.com/repos/neovim/neovim/issues{/number}","pulls_url":"https://api.github.com/repos/neovim/neovim/pulls{/number}","milestones_url":"https://api.github.com/repos/neovim/neovim/milestones{/number}","notifications_url":"https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/neovim/neovim/labels{/name}","releases_url":"https://api.github.com/repos/neovim/neovim/releases{/id}","deployments_url":"https://api.github.com/repos/neovim/neovim/deployments","created_at":"2014-01-31T13:39:22Z","updated_at":"2025-11-10T01:49:31Z","pushed_at":"2025-11-10T01:49:25Z","git_url":"git://github.com/neovim/neovim.git","ssh_url":"git@github.com:neovim/neovim.git","clone_url":"https://github.com/neovim/neovim.git","svn_url":"https://github.com/neovim/neovim","homepage":"https://neovim.io","size":350662,"stargazers_count":94128,"watchers_count":94128,"language":"Vim Script","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":6408,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2074,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["api","c","lua","neovim","nvim","text-editor","vim"],"visibility":"public","forks":6408,"open_issues":2074,"watchers":94128,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"### Problem\n\nI have an inkling that this might be your desired behavior, but I thought I'd create this anyways as it was reported to my extension [here](https://github.com/scalameta/nvim-metals/discussions/709) and I thought at least this would provide some clarity around the topic. The scenario is that if you have a workspace where diagnostics have already been reported, nothing changes and you simply do a `:e` you lose the diagnostics for that buffer and can't get them back until you trigger a compile or do something for the server to return them again. However, this doesn't seem to be what other clients I've tested do. I've tested this with both Zed and VS Code and if you send a `didClose` event and then open the file again the diagnostics are persisted. While uncommon, this can create some weird scenarios where you're navigating a large code base, close a buffer to not have a ton of them open, then re-open it later to expect to still see the same diagnostic because not state has changed... and it's just gone in Nvim. Is there a reason this is done? Like I said in the other clients I've tested this isn't the case. You re-open and if no state changes happened, you see your diagnostics.\n\n### Steps to reproduce using \"nvim -u minimal_init.lua\"\n\nYou can reproduce this, but you'd need a few things installed\n\n- The Scala language server [Metals](https://scalameta.org/metals/) (most easily done with [cs install metals](https://get-coursier.io/)\n- set up an sbt project with the following structure:\n\n```\n build.sbt\n project\n    build.properties\n src\n     main\n        scala\n            example\n                Hello.scala\n```\n\nInside of these files:\n\n`build.sbt`\n\n```scala\nThisBuild / scalaVersion     := \"2.13.16\"\nThisBuild / version          := \"0.1.0-SNAPSHOT\"\n\nlazy val root = (project in file(\".\"))\n  .settings(\n    name := \"Scala Seed Project\"\n  )\n```\n`build.properties`\n```scala\nsbt.version=1.10.7\n```\n`Hello.scala`\n```scala\npackage example\n\nobject Hello extends App {\n  val hello: String = 3\n}\n```\n\nThe minimal init file looks like this:\n\n```lua\nlocal pattern = 'scala'\nlocal cmd = {'metals'}\n-- Add files/folders here that indicate the root of a project\nlocal root_markers = {'build.sbt'}\n-- Change to table with settings if required\nlocal settings = vim.empty_dict()\n\nvim.api.nvim_create_autocmd('FileType', {\n  pattern = pattern,\n  callback = function(args)\n    local match = vim.fs.find(root_markers, { path = args.file, upward = true })[1]\n    local root_dir = match and vim.fn.fnamemodify(match, ':p:h') or nil\n    vim.lsp.start({\n      name = 'metals',\n      cmd = cmd,\n      root_dir = root_dir,\n      settings = settings\n    })\n  end\n})\n```\n\nOnce you open `Hello.scala` you should see Metals kick in and a single error appear under `3`. Then just do a `:e` and see the diagnostic disappear.\n\n### Expected behavior\n\nWhile in an LSP project I'd expect my workspace diagnostics to not just disappear because I closed and re-opened the file.\n\n### Nvim version (nvim -v)\n\nNVIM v0.10.4\n\n### Language server name/version\n\nmetals 1.5.1\n\n### Operating system/version\n\nMac OS but any has the same\n\n### Log file\n\n_No response_","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/32247/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/neovim/neovim/issues/32247/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":16651559531,"node_id":"SE_lADOAPphoM6iFG_EzwAAAAPggqJr","url":"https://api.github.com/repos/neovim/neovim/issues/events/16651559531","actor":{"login":"Kazy","id":59063,"node_id":"MDQ6VXNlcjU5MDYz","avatar_url":"https://avatars.githubusercontent.com/u/59063?v=4","gravatar_id":"","url":"https://api.github.com/users/Kazy","html_url":"https://github.com/Kazy","followers_url":"https://api.github.com/users/Kazy/followers","following_url":"https://api.github.com/users/Kazy/following{/other_user}","gists_url":"https://api.github.com/users/Kazy/gists{/gist_id}","starred_url":"https://api.github.com/users/Kazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kazy/subscriptions","organizations_url":"https://api.github.com/users/Kazy/orgs","repos_url":"https://api.github.com/users/Kazy/repos","events_url":"https://api.github.com/users/Kazy/events{/privacy}","received_events_url":"https://api.github.com/users/Kazy/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2025-03-10T09:56:18Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2723868118","html_url":"https://github.com/neovim/neovim/issues/31453#issuecomment-2723868118","issue_url":"https://api.github.com/repos/neovim/neovim/issues/31453","id":2723868118,"node_id":"IC_kwDOAPphoM6iWu3W","user":{"login":"ofseed","id":61115159,"node_id":"MDQ6VXNlcjYxMTE1MTU5","avatar_url":"https://avatars.githubusercontent.com/u/61115159?v=4","gravatar_id":"","url":"https://api.github.com/users/ofseed","html_url":"https://github.com/ofseed","followers_url":"https://api.github.com/users/ofseed/followers","following_url":"https://api.github.com/users/ofseed/following{/other_user}","gists_url":"https://api.github.com/users/ofseed/gists{/gist_id}","starred_url":"https://api.github.com/users/ofseed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofseed/subscriptions","organizations_url":"https://api.github.com/users/ofseed/orgs","repos_url":"https://api.github.com/users/ofseed/repos","events_url":"https://api.github.com/users/ofseed/events{/privacy}","received_events_url":"https://api.github.com/users/ofseed/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-03-14T07:34:25Z","updated_at":"2025-03-14T07:34:25Z","body":"Among all the implemented features that require state management (including semantic highlighting, diagnostics, inlay hints, and folding range), the model we use is that buffer data has client data to facilitate garbage collection when the buffer is deleted.\n\nHowever, https://github.com/neovim/neovim/issues/32247 indicates that there may be some client data in LSP that needs to persist even after the buffer is deleted. This makes me a bit worried about thoroughly addressing this issue based on the current model.\n\nFortunately, the issue reported in the above issue seems to be a flaw of LSP itself. I suspect it may be due to the fact that vscode's OOP model manages data primarily through the client class, which may lead them to adopt a strategy where client data owns buffer data. This ambiguous and flawed definition in LSP is very likely something they added as a private addition to directly describe vscode's erroneous behavior.\n\nLeave this comment as a reminder.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2723868118/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ofseed","id":61115159,"node_id":"MDQ6VXNlcjYxMTE1MTU5","avatar_url":"https://avatars.githubusercontent.com/u/61115159?v=4","gravatar_id":"","url":"https://api.github.com/users/ofseed","html_url":"https://github.com/ofseed","followers_url":"https://api.github.com/users/ofseed/followers","following_url":"https://api.github.com/users/ofseed/following{/other_user}","gists_url":"https://api.github.com/users/ofseed/gists{/gist_id}","starred_url":"https://api.github.com/users/ofseed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofseed/subscriptions","organizations_url":"https://api.github.com/users/ofseed/orgs","repos_url":"https://api.github.com/users/ofseed/repos","events_url":"https://api.github.com/users/ofseed/events{/privacy}","received_events_url":"https://api.github.com/users/ofseed/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"ofseed","id":61115159,"node_id":"MDQ6VXNlcjYxMTE1MTU5","avatar_url":"https://avatars.githubusercontent.com/u/61115159?v=4","gravatar_id":"","url":"https://api.github.com/users/ofseed","html_url":"https://github.com/ofseed","followers_url":"https://api.github.com/users/ofseed/followers","following_url":"https://api.github.com/users/ofseed/following{/other_user}","gists_url":"https://api.github.com/users/ofseed/gists{/gist_id}","starred_url":"https://api.github.com/users/ofseed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofseed/subscriptions","organizations_url":"https://api.github.com/users/ofseed/orgs","repos_url":"https://api.github.com/users/ofseed/repos","events_url":"https://api.github.com/users/ofseed/events{/privacy}","received_events_url":"https://api.github.com/users/ofseed/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-03-18T07:29:11Z","updated_at":"2025-03-18T07:29:11Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/neovim/neovim/issues/32035","repository_url":"https://api.github.com/repos/neovim/neovim","labels_url":"https://api.github.com/repos/neovim/neovim/issues/32035/labels{/name}","comments_url":"https://api.github.com/repos/neovim/neovim/issues/32035/comments","events_url":"https://api.github.com/repos/neovim/neovim/issues/32035/events","html_url":"https://github.com/neovim/neovim/issues/32035","id":2790057913,"node_id":"I_kwDOAPphoM6mTOe5","number":32035,"title":"reframe :help \"Run with g==\" hints as codelenses","user":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":117905553,"node_id":"MDU6TGFiZWwxMTc5MDU1NTM=","url":"https://api.github.com/repos/neovim/neovim/labels/plugin","name":"plugin","color":"c5def5","default":false,"description":""},{"id":120251370,"node_id":"MDU6TGFiZWwxMjAyNTEzNzA=","url":"https://api.github.com/repos/neovim/neovim/labels/runtime","name":"runtime","color":"c5def5","default":false,"description":"funtime"},{"id":662566370,"node_id":"MDU6TGFiZWw2NjI1NjYzNzA=","url":"https://api.github.com/repos/neovim/neovim/labels/lsp","name":"lsp","color":"c5def5","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/neovim/neovim/milestones/6","html_url":"https://github.com/neovim/neovim/milestone/6","labels_url":"https://api.github.com/repos/neovim/neovim/milestones/6/labels","id":655037,"node_id":"MDk6TWlsZXN0b25lNjU1MDM3","number":6,"title":"backlog","description":"Low priority items. We plan to work on this but don't have a target date.","creator":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":637,"closed_issues":749,"state":"open","created_at":"2014-05-10T20:43:04Z","updated_at":"2025-11-04T00:12:22Z","due_on":null,"closed_at":null},"comments":4,"created_at":"2025-01-15T14:50:33Z","updated_at":"2025-07-02T08:57:32Z","closed_at":null,"author_association":"MEMBER","type":{"id":597167,"node_id":"IT_kwDOAGK_Pc4ACRyv","name":"Enhancement","description":"A request, idea, or new functionality","color":"blue","created_at":"2024-01-25T10:10:19Z","updated_at":"2024-07-26T10:12:30Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":16408992,"node_id":"MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==","name":"neovim","full_name":"neovim/neovim","private":false,"owner":{"login":"neovim","id":6471485,"node_id":"MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6471485?v=4","gravatar_id":"","url":"https://api.github.com/users/neovim","html_url":"https://github.com/neovim","followers_url":"https://api.github.com/users/neovim/followers","following_url":"https://api.github.com/users/neovim/following{/other_user}","gists_url":"https://api.github.com/users/neovim/gists{/gist_id}","starred_url":"https://api.github.com/users/neovim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/neovim/subscriptions","organizations_url":"https://api.github.com/users/neovim/orgs","repos_url":"https://api.github.com/users/neovim/repos","events_url":"https://api.github.com/users/neovim/events{/privacy}","received_events_url":"https://api.github.com/users/neovim/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/neovim/neovim","description":"Vim-fork focused on extensibility and usability","fork":false,"url":"https://api.github.com/repos/neovim/neovim","forks_url":"https://api.github.com/repos/neovim/neovim/forks","keys_url":"https://api.github.com/repos/neovim/neovim/keys{/key_id}","collaborators_url":"https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/neovim/neovim/teams","hooks_url":"https://api.github.com/repos/neovim/neovim/hooks","issue_events_url":"https://api.github.com/repos/neovim/neovim/issues/events{/number}","events_url":"https://api.github.com/repos/neovim/neovim/events","assignees_url":"https://api.github.com/repos/neovim/neovim/assignees{/user}","branches_url":"https://api.github.com/repos/neovim/neovim/branches{/branch}","tags_url":"https://api.github.com/repos/neovim/neovim/tags","blobs_url":"https://api.github.com/repos/neovim/neovim/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/neovim/neovim/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/neovim/neovim/git/refs{/sha}","trees_url":"https://api.github.com/repos/neovim/neovim/git/trees{/sha}","statuses_url":"https://api.github.com/repos/neovim/neovim/statuses/{sha}","languages_url":"https://api.github.com/repos/neovim/neovim/languages","stargazers_url":"https://api.github.com/repos/neovim/neovim/stargazers","contributors_url":"https://api.github.com/repos/neovim/neovim/contributors","subscribers_url":"https://api.github.com/repos/neovim/neovim/subscribers","subscription_url":"https://api.github.com/repos/neovim/neovim/subscription","commits_url":"https://api.github.com/repos/neovim/neovim/commits{/sha}","git_commits_url":"https://api.github.com/repos/neovim/neovim/git/commits{/sha}","comments_url":"https://api.github.com/repos/neovim/neovim/comments{/number}","issue_comment_url":"https://api.github.com/repos/neovim/neovim/issues/comments{/number}","contents_url":"https://api.github.com/repos/neovim/neovim/contents/{+path}","compare_url":"https://api.github.com/repos/neovim/neovim/compare/{base}...{head}","merges_url":"https://api.github.com/repos/neovim/neovim/merges","archive_url":"https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/neovim/neovim/downloads","issues_url":"https://api.github.com/repos/neovim/neovim/issues{/number}","pulls_url":"https://api.github.com/repos/neovim/neovim/pulls{/number}","milestones_url":"https://api.github.com/repos/neovim/neovim/milestones{/number}","notifications_url":"https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/neovim/neovim/labels{/name}","releases_url":"https://api.github.com/repos/neovim/neovim/releases{/id}","deployments_url":"https://api.github.com/repos/neovim/neovim/deployments","created_at":"2014-01-31T13:39:22Z","updated_at":"2025-11-10T01:49:31Z","pushed_at":"2025-11-10T01:49:25Z","git_url":"git://github.com/neovim/neovim.git","ssh_url":"git@github.com:neovim/neovim.git","clone_url":"https://github.com/neovim/neovim.git","svn_url":"https://github.com/neovim/neovim","homepage":"https://neovim.io","size":350662,"stargazers_count":94128,"watchers_count":94128,"language":"Vim Script","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":6408,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2074,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["api","c","lua","neovim","nvim","text-editor","vim"],"visibility":"public","forks":6408,"open_issues":2074,"watchers":94128,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"# Problem\n\nCurrently the \"Run with ...\" pseudo-codelenses in `:help` buffers don't have an interface for enabling/disabling them.\n\n# Proposal\n\n_Originally posted by @mfussenegger in https://github.com/neovim/neovim/issues/31947#issuecomment-2592420466_\n\n> Conceptually the \"Run with ...\" virtual-text is similar to either LSP inlay hints or codelens, both can have a executable command. (we currently don't support that for inlay-hints, but for codelens we have `vim.lsp.codelens.run`. Some servers provide exactly this type of code lens for test cases (Run Test | Debug Test)\n> \n> This has me wonder if we either:\n> \n> - Could have a vim.lsp.server for vim help files, and provide the info as codelens and make it executable via `codelens.run()`\n> - Have a codelens abstraction sitting between virtual-text/lines and LSP\n> \n> \n> This would give users a more consistent interface and user experience in that if it looks like a code-lens it acts like a code lens. Same keymaps, same options to enable/disable.\n","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/32035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/neovim/neovim/issues/32035/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-04-21T14:11:27Z","updated_at":"2025-04-21T14:11:27Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/neovim/neovim/issues/33440","repository_url":"https://api.github.com/repos/neovim/neovim","labels_url":"https://api.github.com/repos/neovim/neovim/issues/33440/labels{/name}","comments_url":"https://api.github.com/repos/neovim/neovim/issues/33440/comments","events_url":"https://api.github.com/repos/neovim/neovim/issues/33440/events","html_url":"https://github.com/neovim/neovim/pull/33440","id":2990715922,"node_id":"PR_kwDOAPphoM6SXbkD","number":33440,"title":"feat(lsp): support `textDocument/documentColor`","user":{"login":"MariaSolOs","id":62502207,"node_id":"MDQ6VXNlcjYyNTAyMjA3","avatar_url":"https://avatars.githubusercontent.com/u/62502207?v=4","gravatar_id":"","url":"https://api.github.com/users/MariaSolOs","html_url":"https://github.com/MariaSolOs","followers_url":"https://api.github.com/users/MariaSolOs/followers","following_url":"https://api.github.com/users/MariaSolOs/following{/other_user}","gists_url":"https://api.github.com/users/MariaSolOs/gists{/gist_id}","starred_url":"https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MariaSolOs/subscriptions","organizations_url":"https://api.github.com/users/MariaSolOs/orgs","repos_url":"https://api.github.com/users/MariaSolOs/repos","events_url":"https://api.github.com/users/MariaSolOs/events{/privacy}","received_events_url":"https://api.github.com/users/MariaSolOs/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":662566370,"node_id":"MDU6TGFiZWw2NjI1NjYzNzA=","url":"https://api.github.com/repos/neovim/neovim/labels/lsp","name":"lsp","color":"c5def5","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2025-04-12T20:56:30Z","updated_at":"2025-04-25T09:33:36Z","closed_at":"2025-04-24T16:48:19Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":16408992,"node_id":"MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==","name":"neovim","full_name":"neovim/neovim","private":false,"owner":{"login":"neovim","id":6471485,"node_id":"MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6471485?v=4","gravatar_id":"","url":"https://api.github.com/users/neovim","html_url":"https://github.com/neovim","followers_url":"https://api.github.com/users/neovim/followers","following_url":"https://api.github.com/users/neovim/following{/other_user}","gists_url":"https://api.github.com/users/neovim/gists{/gist_id}","starred_url":"https://api.github.com/users/neovim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/neovim/subscriptions","organizations_url":"https://api.github.com/users/neovim/orgs","repos_url":"https://api.github.com/users/neovim/repos","events_url":"https://api.github.com/users/neovim/events{/privacy}","received_events_url":"https://api.github.com/users/neovim/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/neovim/neovim","description":"Vim-fork focused on extensibility and usability","fork":false,"url":"https://api.github.com/repos/neovim/neovim","forks_url":"https://api.github.com/repos/neovim/neovim/forks","keys_url":"https://api.github.com/repos/neovim/neovim/keys{/key_id}","collaborators_url":"https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/neovim/neovim/teams","hooks_url":"https://api.github.com/repos/neovim/neovim/hooks","issue_events_url":"https://api.github.com/repos/neovim/neovim/issues/events{/number}","events_url":"https://api.github.com/repos/neovim/neovim/events","assignees_url":"https://api.github.com/repos/neovim/neovim/assignees{/user}","branches_url":"https://api.github.com/repos/neovim/neovim/branches{/branch}","tags_url":"https://api.github.com/repos/neovim/neovim/tags","blobs_url":"https://api.github.com/repos/neovim/neovim/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/neovim/neovim/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/neovim/neovim/git/refs{/sha}","trees_url":"https://api.github.com/repos/neovim/neovim/git/trees{/sha}","statuses_url":"https://api.github.com/repos/neovim/neovim/statuses/{sha}","languages_url":"https://api.github.com/repos/neovim/neovim/languages","stargazers_url":"https://api.github.com/repos/neovim/neovim/stargazers","contributors_url":"https://api.github.com/repos/neovim/neovim/contributors","subscribers_url":"https://api.github.com/repos/neovim/neovim/subscribers","subscription_url":"https://api.github.com/repos/neovim/neovim/subscription","commits_url":"https://api.github.com/repos/neovim/neovim/commits{/sha}","git_commits_url":"https://api.github.com/repos/neovim/neovim/git/commits{/sha}","comments_url":"https://api.github.com/repos/neovim/neovim/comments{/number}","issue_comment_url":"https://api.github.com/repos/neovim/neovim/issues/comments{/number}","contents_url":"https://api.github.com/repos/neovim/neovim/contents/{+path}","compare_url":"https://api.github.com/repos/neovim/neovim/compare/{base}...{head}","merges_url":"https://api.github.com/repos/neovim/neovim/merges","archive_url":"https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/neovim/neovim/downloads","issues_url":"https://api.github.com/repos/neovim/neovim/issues{/number}","pulls_url":"https://api.github.com/repos/neovim/neovim/pulls{/number}","milestones_url":"https://api.github.com/repos/neovim/neovim/milestones{/number}","notifications_url":"https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/neovim/neovim/labels{/name}","releases_url":"https://api.github.com/repos/neovim/neovim/releases{/id}","deployments_url":"https://api.github.com/repos/neovim/neovim/deployments","created_at":"2014-01-31T13:39:22Z","updated_at":"2025-11-10T01:49:31Z","pushed_at":"2025-11-10T01:49:25Z","git_url":"git://github.com/neovim/neovim.git","ssh_url":"git@github.com:neovim/neovim.git","clone_url":"https://github.com/neovim/neovim.git","svn_url":"https://github.com/neovim/neovim","homepage":"https://neovim.io","size":350662,"stargazers_count":94128,"watchers_count":94128,"language":"Vim Script","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":6408,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2074,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["api","c","lua","neovim","nvim","text-editor","vim"],"visibility":"public","forks":6408,"open_issues":2074,"watchers":94128,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/neovim/neovim/pulls/33440","html_url":"https://github.com/neovim/neovim/pull/33440","diff_url":"https://github.com/neovim/neovim/pull/33440.diff","patch_url":"https://github.com/neovim/neovim/pull/33440.patch","merged_at":"2025-04-24T16:48:19Z"},"body":"<!--\r\n  Thank you for contributing to Neovim!\r\n  If this is your first time, check out https://github.com/neovim/neovim/blob/master/CONTRIBUTING.md#pull-requests-prs\r\n  for our PR guidelines.\r\n-->\r\nCloses https://github.com/neovim/neovim/issues/32920.\r\n\r\n### Cheeky previews\r\n`'background'` style (the default)\r\n<img width=\"283\" alt=\"image\" src=\"https://github.com/user-attachments/assets/7e6f3f2d-5c10-42e8-a7f7-1d19fa2b113b\" />\r\n\r\n`'foreground'` style\r\n<img width=\"265\" alt=\"image\" src=\"https://github.com/user-attachments/assets/417edf28-3663-47c5-9222-789c2e5b6292\" />\r\n\r\n`'virtual'` style (similar to VS C*de's [inline square](https://code.visualstudio.com/docs/languages/css#_syntax-coloring-color-preview))\r\n<img width=\"318\" alt=\"image\" src=\"https://github.com/user-attachments/assets/2ac7d22e-2ac4-4a62-a75f-df63cdef5f81\" />\r\n\r\nPending items:\r\n- [x] Add tests.\r\n- ~[ ] Refactor common logic with #32138~ I think it will be better to move this to a later refactor PR.\r\n","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/33440/reactions","total_count":147,"+1":42,"-1":0,"laugh":0,"hooray":3,"confused":0,"heart":49,"rocket":51,"eyes":2},"timeline_url":"https://api.github.com/repos/neovim/neovim/issues/33440/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":17403641566,"node_id":"SE_lADOAPphoM6iFG_EzwAAAAQNVn7e","url":"https://api.github.com/repos/neovim/neovim/issues/events/17403641566","actor":{"login":"lithammer","id":177685,"node_id":"MDQ6VXNlcjE3NzY4NQ==","avatar_url":"https://avatars.githubusercontent.com/u/177685?v=4","gravatar_id":"","url":"https://api.github.com/users/lithammer","html_url":"https://github.com/lithammer","followers_url":"https://api.github.com/users/lithammer/followers","following_url":"https://api.github.com/users/lithammer/following{/other_user}","gists_url":"https://api.github.com/users/lithammer/gists{/gist_id}","starred_url":"https://api.github.com/users/lithammer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lithammer/subscriptions","organizations_url":"https://api.github.com/users/lithammer/orgs","repos_url":"https://api.github.com/users/lithammer/repos","events_url":"https://api.github.com/users/lithammer/events{/privacy}","received_events_url":"https://api.github.com/users/lithammer/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2025-04-25T09:46:30Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2935466244","html_url":"https://github.com/neovim/neovim/issues/31453#issuecomment-2935466244","issue_url":"https://api.github.com/repos/neovim/neovim/issues/31453","id":2935466244,"node_id":"IC_kwDOAPphoM6u96kE","user":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-06-03T14:11:46Z","updated_at":"2025-06-03T14:11:46Z","body":"Copying comment from https://github.com/neovim/neovim/discussions/34254#discussioncomment-13356500 : \n\n> introduce an internal module (or modify `lsp/client.lua`) that enables each LSP client to store independent buffer-level data. The key challenge is ensuring proper cleanup when a client detaches or a buffer is deleted, to prevent memory leaks.\n\nThe main goal is to find *something* that can be shared amongst all the existing use-cases in the lsp modules. Initially, it will just be a frankenstein in `runtime/lua/vim/lsp/util.lua` or `_util.lua` , and internal-only. This initial step will tell us whether it can be further generalized. Then we can refine the interface.\n\nGoing a bit further, it's worth seeing if https://github.com/neovim/neovim/issues/12544#issuecomment-1116794687 could be useful here, and maybe we want to implement that in this gsoc project.\n\nWe want:\n\n- the \"key\" for stored items is caller-defined. some callers may want to key on namespace+bufnr, others may need something else?\n- cleanup on buf-delete and other events (as you mentioned)\n- no memory leaks; Lua \"weak table\" may be useful.\n- visibility (so :checkhealth can print something like `1031 items in lsp cache`)\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2935466244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2935964811","html_url":"https://github.com/neovim/neovim/issues/31453#issuecomment-2935964811","issue_url":"https://api.github.com/repos/neovim/neovim/issues/31453","id":2935964811,"node_id":"IC_kwDOAPphoM6u_0SL","user":{"login":"ofseed","id":61115159,"node_id":"MDQ6VXNlcjYxMTE1MTU5","avatar_url":"https://avatars.githubusercontent.com/u/61115159?v=4","gravatar_id":"","url":"https://api.github.com/users/ofseed","html_url":"https://github.com/ofseed","followers_url":"https://api.github.com/users/ofseed/followers","following_url":"https://api.github.com/users/ofseed/following{/other_user}","gists_url":"https://api.github.com/users/ofseed/gists{/gist_id}","starred_url":"https://api.github.com/users/ofseed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofseed/subscriptions","organizations_url":"https://api.github.com/users/ofseed/orgs","repos_url":"https://api.github.com/users/ofseed/repos","events_url":"https://api.github.com/users/ofseed/events{/privacy}","received_events_url":"https://api.github.com/users/ofseed/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-06-03T15:26:21Z","updated_at":"2025-06-04T01:13:44Z","body":"I wonder if OOP(specifically, using abstract classes and inheritance) is a viable option. `:h dev-lua` indicates that elaborate OOP design should be avoided.\n\nThe benefits of using OOP are as follows:\n\n- Code can be shared through abstract classes and inheritance while keeping flexibility by overriding, or at least, interfaces can be clearly defined. Wherever `bufstate` is used, there is boilerplate code.\n- A general benefit of OOP design is to solve the problem of inconsistent state. In our case, I mean all functions that use `bufstate` should be methods of the `bufstate`(or other name, like `FeatureProvider`) object so that we can avoid nil-checks. This can prevent data from being inconsistent with expectations.\n- We currently have a fairly successful example in `lsp/semantic_tokens.lua`, which is an OOP implementation managing its own \"`bufstate`\" (`STHighlighter`).\n\nMy rough idea at the moment is to convert these places using `bufstate` into an OOP design, similar to `vim.lsp.semantic_tokens`, and extract reusable parts as an abstract class to reuse code. Moreover, the existence of a unified parent class might share implementation for the following missing feature:\n\n- `partialResultParams`\n- `dynamicRegistration`\n-  >visibility (so :checkhealth can print something like `1031 items in lsp cache`)\n\n   This can also be done, just like printing active clients by `:checkhealth vim.lsp`(`client.lua` is also based on OOP design).\n\n\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2935964811/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ofseed","id":61115159,"node_id":"MDQ6VXNlcjYxMTE1MTU5","avatar_url":"https://avatars.githubusercontent.com/u/61115159?v=4","gravatar_id":"","url":"https://api.github.com/users/ofseed","html_url":"https://github.com/ofseed","followers_url":"https://api.github.com/users/ofseed/followers","following_url":"https://api.github.com/users/ofseed/following{/other_user}","gists_url":"https://api.github.com/users/ofseed/gists{/gist_id}","starred_url":"https://api.github.com/users/ofseed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofseed/subscriptions","organizations_url":"https://api.github.com/users/ofseed/orgs","repos_url":"https://api.github.com/users/ofseed/repos","events_url":"https://api.github.com/users/ofseed/events{/privacy}","received_events_url":"https://api.github.com/users/ofseed/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2940643831","html_url":"https://github.com/neovim/neovim/issues/31453#issuecomment-2940643831","issue_url":"https://api.github.com/repos/neovim/neovim/issues/31453","id":2940643831,"node_id":"IC_kwDOAPphoM6vRqn3","user":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-06-04T16:22:02Z","updated_at":"2025-06-04T16:22:02Z","body":"We can try that. Primary goal is to find some sort of pattern that can be shared. OOP usually isn't necessary since behavior and state can be shared in other ways, but it's not a blocker in this phase.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/comments/2940643831/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"ofseed","id":61115159,"node_id":"MDQ6VXNlcjYxMTE1MTU5","avatar_url":"https://avatars.githubusercontent.com/u/61115159?v=4","gravatar_id":"","url":"https://api.github.com/users/ofseed","html_url":"https://github.com/ofseed","followers_url":"https://api.github.com/users/ofseed/followers","following_url":"https://api.github.com/users/ofseed/following{/other_user}","gists_url":"https://api.github.com/users/ofseed/gists{/gist_id}","starred_url":"https://api.github.com/users/ofseed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofseed/subscriptions","organizations_url":"https://api.github.com/users/ofseed/orgs","repos_url":"https://api.github.com/users/ofseed/repos","events_url":"https://api.github.com/users/ofseed/events{/privacy}","received_events_url":"https://api.github.com/users/ofseed/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-06-12T13:37:04Z","updated_at":"2025-06-12T13:37:04Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/neovim/neovim/issues/34469","repository_url":"https://api.github.com/repos/neovim/neovim","labels_url":"https://api.github.com/repos/neovim/neovim/issues/34469/labels{/name}","comments_url":"https://api.github.com/repos/neovim/neovim/issues/34469/comments","events_url":"https://api.github.com/repos/neovim/neovim/issues/34469/events","html_url":"https://github.com/neovim/neovim/pull/34469","id":3140336054,"node_id":"PR_kwDOAPphoM6aOI30","number":34469,"title":"refactor(lsp): migrate LSP folding to an oop design","user":{"login":"ofseed","id":61115159,"node_id":"MDQ6VXNlcjYxMTE1MTU5","avatar_url":"https://avatars.githubusercontent.com/u/61115159?v=4","gravatar_id":"","url":"https://api.github.com/users/ofseed","html_url":"https://github.com/ofseed","followers_url":"https://api.github.com/users/ofseed/followers","following_url":"https://api.github.com/users/ofseed/following{/other_user}","gists_url":"https://api.github.com/users/ofseed/gists{/gist_id}","starred_url":"https://api.github.com/users/ofseed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofseed/subscriptions","organizations_url":"https://api.github.com/users/ofseed/orgs","repos_url":"https://api.github.com/users/ofseed/repos","events_url":"https://api.github.com/users/ofseed/events{/privacy}","received_events_url":"https://api.github.com/users/ofseed/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":106949155,"node_id":"MDU6TGFiZWwxMDY5NDkxNTU=","url":"https://api.github.com/repos/neovim/neovim/labels/refactor","name":"refactor","color":"C5DEF5","default":false,"description":"changes that are not features or bugfixes"},{"id":662566370,"node_id":"MDU6TGFiZWw2NjI1NjYzNzA=","url":"https://api.github.com/repos/neovim/neovim/labels/lsp","name":"lsp","color":"c5def5","default":false,"description":null},{"id":834483397,"node_id":"MDU6TGFiZWw4MzQ0ODMzOTc=","url":"https://api.github.com/repos/neovim/neovim/labels/gsoc","name":"gsoc","color":"F3A62E","default":false,"description":"community: Google Summer of Code project"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2025-06-12T13:37:03Z","updated_at":"2025-07-21T08:06:31Z","closed_at":"2025-06-19T13:23:40Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":16408992,"node_id":"MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==","name":"neovim","full_name":"neovim/neovim","private":false,"owner":{"login":"neovim","id":6471485,"node_id":"MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6471485?v=4","gravatar_id":"","url":"https://api.github.com/users/neovim","html_url":"https://github.com/neovim","followers_url":"https://api.github.com/users/neovim/followers","following_url":"https://api.github.com/users/neovim/following{/other_user}","gists_url":"https://api.github.com/users/neovim/gists{/gist_id}","starred_url":"https://api.github.com/users/neovim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/neovim/subscriptions","organizations_url":"https://api.github.com/users/neovim/orgs","repos_url":"https://api.github.com/users/neovim/repos","events_url":"https://api.github.com/users/neovim/events{/privacy}","received_events_url":"https://api.github.com/users/neovim/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/neovim/neovim","description":"Vim-fork focused on extensibility and usability","fork":false,"url":"https://api.github.com/repos/neovim/neovim","forks_url":"https://api.github.com/repos/neovim/neovim/forks","keys_url":"https://api.github.com/repos/neovim/neovim/keys{/key_id}","collaborators_url":"https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/neovim/neovim/teams","hooks_url":"https://api.github.com/repos/neovim/neovim/hooks","issue_events_url":"https://api.github.com/repos/neovim/neovim/issues/events{/number}","events_url":"https://api.github.com/repos/neovim/neovim/events","assignees_url":"https://api.github.com/repos/neovim/neovim/assignees{/user}","branches_url":"https://api.github.com/repos/neovim/neovim/branches{/branch}","tags_url":"https://api.github.com/repos/neovim/neovim/tags","blobs_url":"https://api.github.com/repos/neovim/neovim/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/neovim/neovim/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/neovim/neovim/git/refs{/sha}","trees_url":"https://api.github.com/repos/neovim/neovim/git/trees{/sha}","statuses_url":"https://api.github.com/repos/neovim/neovim/statuses/{sha}","languages_url":"https://api.github.com/repos/neovim/neovim/languages","stargazers_url":"https://api.github.com/repos/neovim/neovim/stargazers","contributors_url":"https://api.github.com/repos/neovim/neovim/contributors","subscribers_url":"https://api.github.com/repos/neovim/neovim/subscribers","subscription_url":"https://api.github.com/repos/neovim/neovim/subscription","commits_url":"https://api.github.com/repos/neovim/neovim/commits{/sha}","git_commits_url":"https://api.github.com/repos/neovim/neovim/git/commits{/sha}","comments_url":"https://api.github.com/repos/neovim/neovim/comments{/number}","issue_comment_url":"https://api.github.com/repos/neovim/neovim/issues/comments{/number}","contents_url":"https://api.github.com/repos/neovim/neovim/contents/{+path}","compare_url":"https://api.github.com/repos/neovim/neovim/compare/{base}...{head}","merges_url":"https://api.github.com/repos/neovim/neovim/merges","archive_url":"https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/neovim/neovim/downloads","issues_url":"https://api.github.com/repos/neovim/neovim/issues{/number}","pulls_url":"https://api.github.com/repos/neovim/neovim/pulls{/number}","milestones_url":"https://api.github.com/repos/neovim/neovim/milestones{/number}","notifications_url":"https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/neovim/neovim/labels{/name}","releases_url":"https://api.github.com/repos/neovim/neovim/releases{/id}","deployments_url":"https://api.github.com/repos/neovim/neovim/deployments","created_at":"2014-01-31T13:39:22Z","updated_at":"2025-11-10T01:49:31Z","pushed_at":"2025-11-10T01:49:25Z","git_url":"git://github.com/neovim/neovim.git","ssh_url":"git@github.com:neovim/neovim.git","clone_url":"https://github.com/neovim/neovim.git","svn_url":"https://github.com/neovim/neovim","homepage":"https://neovim.io","size":350662,"stargazers_count":94128,"watchers_count":94128,"language":"Vim Script","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":6408,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2074,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["api","c","lua","neovim","nvim","text-editor","vim"],"visibility":"public","forks":6408,"open_issues":2074,"watchers":94128,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/neovim/neovim/pulls/34469","html_url":"https://github.com/neovim/neovim/pull/34469","diff_url":"https://github.com/neovim/neovim/pull/34469.diff","patch_url":"https://github.com/neovim/neovim/pull/34469.patch","merged_at":"2025-06-19T13:23:40Z"},"body":"To address #31453, I plan to try introducing more OOP design. My planned roadmap is:\r\n\r\n- Refactor `_folding_range.lua` into an OOP design by adding the `FRProvider` class (this PR);\r\n- Compare `STHighlighter` in `semantic_token.lua`, extract the overlapping logic with `FRProvider` (mainly lifecycle-related), and create a common parent class, tentatively named `FeatureProvider` or `Provider`;\r\n- With the common parent class, some new features can be provided, such as displaying which `FeatureProvider`s are enabled, in which buffers, which clients have enabled them, and the current version or of the displayed data via `:checkhealth vim.lsp`;\r\n- More refactoring, such as refactoring `inlay_hint.lua`, or re-implementing old features, such as `codelens.lua`;\r\n\r\nThis PR does not add any new explicit logic but fixes #34202, because the non-nil assertion issue mentioned in that issue can be avoided with this kind of OOP design. Therefore, I think this PR is ready to be merged, even if the shared superclass approach was not eventually used.","reactions":{"url":"https://api.github.com/repos/neovim/neovim/issues/34469/reactions","total_count":3,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":3,"eyes":0},"timeline_url":"https://api.github.com/repos/neovim/neovim/issues/34469/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"}]