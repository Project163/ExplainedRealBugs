diff --git a/src/main/java/spoon/reflect/declaration/CtElement.java b/src/main/java/spoon/reflect/declaration/CtElement.java
index 865010c55..d7858e955 100644
--- a/src/main/java/spoon/reflect/declaration/CtElement.java
+++ b/src/main/java/spoon/reflect/declaration/CtElement.java
@@ -91,6 +91,11 @@ public interface CtElement extends FactoryAccessor, CtVisitable {
 	 */
 	SourcePosition getPosition();
 
+	/**
+	 * Replaces this element by another one.
+	 */
+	void replace(CtElement element);
+
 	/**
 	 * Add an annotation for this element
 	 *
diff --git a/src/main/java/spoon/support/reflect/declaration/CtElementImpl.java b/src/main/java/spoon/support/reflect/declaration/CtElementImpl.java
index eaed16623..8fe0938c7 100644
--- a/src/main/java/spoon/support/reflect/declaration/CtElementImpl.java
+++ b/src/main/java/spoon/support/reflect/declaration/CtElementImpl.java
@@ -387,7 +387,8 @@ public abstract class CtElementImpl implements CtElement, Serializable, Comparab
 		LOGGER.setLevel(factory.getEnvironment().getLevel());
 	}
 
-	protected void replace(CtElement element) {
+	@Override
+	public void replace(CtElement element) {
 		try {
 			replaceIn(this, element, getParent());
 		} catch (CtUncomparableException e1) {
diff --git a/src/main/java/spoon/support/template/SubstitutionVisitor.java b/src/main/java/spoon/support/template/SubstitutionVisitor.java
index a66fade11..f4b315317 100644
--- a/src/main/java/spoon/support/template/SubstitutionVisitor.java
+++ b/src/main/java/spoon/support/template/SubstitutionVisitor.java
@@ -347,10 +347,8 @@ public class SubstitutionVisitor extends CtScanner {
 						// replace
 						// the return
 						((CtReturn<?>) invocation.getParent()).replace((CtStatement) r);
-					} else if (r instanceof CtExpression) {
-						invocation.replace((CtExpression<T>) r);
-					} else if (r instanceof CtStatement) {
-						invocation.replace((CtStatement) r);
+					} else {
+						invocation.replace(r);
 					}
 				}
 				// do not visit the invocation if replaced
diff --git a/src/test/java/spoon/test/template/TemplateTest.java b/src/test/java/spoon/test/template/TemplateTest.java
index 3f2b340d4..e60d74357 100644
--- a/src/test/java/spoon/test/template/TemplateTest.java
+++ b/src/test/java/spoon/test/template/TemplateTest.java
@@ -4,7 +4,9 @@ import org.junit.Test;
 import spoon.Launcher;
 import spoon.compiler.SpoonResourceHelper;
 import spoon.reflect.code.CtIf;
+import spoon.reflect.code.CtInvocation;
 import spoon.reflect.code.CtStatement;
+import spoon.reflect.code.CtTry;
 import spoon.reflect.declaration.CtClass;
 import spoon.reflect.declaration.CtField;
 import spoon.reflect.declaration.CtMethod;
@@ -16,9 +18,14 @@ import spoon.support.template.Parameters;
 import spoon.template.Substitution;
 import spoon.template.TemplateMatcher;
 
+import java.io.File;
 import java.util.Date;
 
-import static org.junit.Assert.*;
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertFalse;
+import static org.junit.Assert.assertNotNull;
+import static org.junit.Assert.assertTrue;
+import static org.junit.Assert.fail;
 
 public class TemplateTest {
 
@@ -224,10 +231,21 @@ public class TemplateTest {
 		launcher.addInputResource("./src/test/java/spoon/test/template/LoggerTemplate.java");
 		launcher.setSourceOutputDirectory("./target/trash");
 		launcher.addProcessor(new LoggerTemplateProcessor());
+		launcher.getEnvironment().setSourceClasspath(System.getProperty("java.class.path").split(File.pathSeparator));
 		try {
 			launcher.run();
 		} catch (ClassCastException ignored) {
 			fail();
 		}
+
+		final CtClass<Logger> aLogger = launcher.getFactory().Class().get(Logger.class);
+		final CtMethod aMethod = aLogger.getMethodsByName("enter").get(0);
+		assertTrue(aMethod.getBody().getStatement(0) instanceof CtTry);
+		final CtTry aTry = (CtTry) aMethod.getBody().getStatement(0);
+		assertTrue(aTry.getFinalizer().getStatement(0) instanceof CtInvocation);
+		assertEquals("spoon.test.template.Logger.exit(\"enter\")", aTry.getFinalizer().getStatement(0).toString());
+		assertTrue(aTry.getBody().getStatement(0) instanceof CtInvocation);
+		assertEquals("spoon.test.template.Logger.enter(\"Logger\", \"enter\")", aTry.getBody().getStatement(0).toString());
+		assertTrue(aTry.getBody().getStatements().size() > 1);
 	}
 }
