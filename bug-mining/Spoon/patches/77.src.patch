diff --git a/src/main/java/spoon/reflect/visitor/CtScanner.java b/src/main/java/spoon/reflect/visitor/CtScanner.java
index 3301f6d85..79ce443ab 100644
--- a/src/main/java/spoon/reflect/visitor/CtScanner.java
+++ b/src/main/java/spoon/reflect/visitor/CtScanner.java
@@ -115,13 +115,6 @@ public abstract class CtScanner implements CtVisitor {
 	protected void enter(CtElement e) {
 	}
 
-	/**
-	 * This method is upcalled by the scanner when entering a scanned element
-	 * reference. To be overridden to implement specific scanners.
-	 */
-	protected void enterReference(CtReference e) {
-	}
-
 	/**
 	 * This method is upcalled by the scanner when exiting a scanned element. To
 	 * be overridden to implement specific scanners.
@@ -129,13 +122,6 @@ public abstract class CtScanner implements CtVisitor {
 	protected void exit(CtElement e) {
 	}
 
-	/**
-	 * This method is upcalled by the scanner when exiting a scanned element
-	 * reference. To be overridden to implement specific scanners.
-	 */
-	protected void exitReference(CtReference e) {
-	}
-
 	/**
 	 * Generically scans a collection of meta-model elements.
 	 */
@@ -224,12 +210,12 @@ public abstract class CtScanner implements CtVisitor {
 	}
 
 	public <T> void visitCtArrayTypeReference(CtArrayTypeReference<T> reference) {
-		enterReference(reference);
+		enter(reference);
 		scan(reference.getDeclaringType());
 		scan(reference.getPackage());
 		scan(reference.getComponentType());
 		scan(reference.getActualTypeArguments());
-		exitReference(reference);
+		exit(reference);
 	}
 
 	@Override
@@ -356,11 +342,11 @@ public abstract class CtScanner implements CtVisitor {
 
 	public <T> void visitCtExecutableReference(
 			CtExecutableReference<T> reference) {
-		enterReference(reference);
+		enter(reference);
 		scan(reference.getDeclaringType());
 		scan(reference.getType());
 		scan(reference.getActualTypeArguments());
-		exitReference(reference);
+		exit(reference);
 	}
 
 	public <T> void visitCtField(CtField<T> f) {
@@ -392,10 +378,10 @@ public abstract class CtScanner implements CtVisitor {
 	}
 
 	public <T> void visitCtFieldReference(CtFieldReference<T> reference) {
-		enterReference(reference);
+		enter(reference);
 		scan(reference.getDeclaringType());
 		scan(reference.getType());
-		exitReference(reference);
+		exit(reference);
 	}
 
 	public void visitCtFor(CtFor forLoop) {
@@ -440,7 +426,6 @@ public abstract class CtScanner implements CtVisitor {
 	public <T> void visitCtInvocation(CtInvocation<T> invocation) {
 		enter(invocation);
 		scan(invocation.getAnnotations());
-		scan(invocation.getType());
 		scan(invocation.getTypeCasts());
 		scan(invocation.getTarget());
 		scan(invocation.getExecutable());
@@ -467,9 +452,9 @@ public abstract class CtScanner implements CtVisitor {
 
 	public <T> void visitCtLocalVariableReference(
 			CtLocalVariableReference<T> reference) {
-		enterReference(reference);
+		enter(reference);
 		scan(reference.getType());
-		exitReference(reference);
+		exit(reference);
 	}
 
 	public <T> void visitCtCatchVariable(CtCatchVariable<T> catchVariable) {
@@ -480,9 +465,9 @@ public abstract class CtScanner implements CtVisitor {
 	}
 
 	public <T> void visitCtCatchVariableReference(CtCatchVariableReference<T> reference) {
-		enterReference(reference);
+		enter(reference);
 		scan(reference.getType());
-		exitReference(reference);
+		exit(reference);
 	}
 
 	public <T> void visitCtMethod(CtMethod<T> m) {
@@ -572,8 +557,8 @@ public abstract class CtScanner implements CtVisitor {
 	}
 
 	public void visitCtPackageReference(CtPackageReference reference) {
-		enterReference(reference);
-		exitReference(reference);
+		enter(reference);
+		exit(reference);
 	}
 
 	public <T> void visitCtParameter(CtParameter<T> parameter) {
@@ -584,9 +569,9 @@ public abstract class CtScanner implements CtVisitor {
 	}
 
 	public <T> void visitCtParameterReference(CtParameterReference<T> reference) {
-		enterReference(reference);
+		enter(reference);
 		scan(reference.getType());
-		exitReference(reference);
+		exit(reference);
 	}
 
 	public <R> void visitCtReturn(CtReturn<R> returnStatement) {
@@ -654,20 +639,20 @@ public abstract class CtScanner implements CtVisitor {
 	}
 
 	public void visitCtTypeParameterReference(CtTypeParameterReference ref) {
-		enterReference(ref);
+		enter(ref);
 		scan(ref.getPackage());
 		scan(ref.getDeclaringType());
 		scan(ref.getActualTypeArguments());
 		scan(ref.getBounds());
-		exitReference(ref);
+		exit(ref);
 	}
 
 	public <T> void visitCtTypeReference(CtTypeReference<T> reference) {
-		enterReference(reference);
+		enter(reference);
 		scan(reference.getPackage());
 		scan(reference.getDeclaringType());
 		scan(reference.getActualTypeArguments());
-		exitReference(reference);
+		exit(reference);
 	}
 
 	@Override
diff --git a/src/main/java/spoon/reflect/visitor/CtStackScanner.java b/src/main/java/spoon/reflect/visitor/CtStackScanner.java
index d5b99c51f..b0208750b 100644
--- a/src/main/java/spoon/reflect/visitor/CtStackScanner.java
+++ b/src/main/java/spoon/reflect/visitor/CtStackScanner.java
@@ -17,10 +17,9 @@
 
 package spoon.reflect.visitor;
 
-import java.util.Stack;
-
 import spoon.reflect.declaration.CtElement;
-import spoon.reflect.reference.CtReference;
+
+import java.util.Stack;
 
 /**
  * This class defines a scanner that maintains a scanning stack for contextual
@@ -39,11 +38,6 @@ public class CtStackScanner extends CtScanner {
 	 */
 	protected Stack<CtElement> elementStack = new Stack<CtElement>();
 
-	/**
-	 * The stack of element references.
-	 */
-	protected Stack<CtReference> referenceStack = new Stack<CtReference>();
-
 	/**
 	 * Pops the element.
 	 */
@@ -55,17 +49,6 @@ public class CtStackScanner extends CtScanner {
 		super.exit(e);
 	}
 
-	/**
-	 * Pops the element reference.
-	 */
-	protected void exitReference(CtReference e) {
-		CtReference ret = referenceStack.pop();
-		if (ret != e) {
-			throw new RuntimeException("Unconsitant Stack");
-		}
-		super.exitReference(e);
-	}
-
 	/**
 	 * Pushes the element.
 	 */
@@ -73,12 +56,4 @@ public class CtStackScanner extends CtScanner {
 		elementStack.push(e);
 		super.enter(e);
 	}
-
-	/**
-	 * Pushes the element reference.
-	 */
-	protected void enterReference(CtReference e) {
-		referenceStack.push(e);
-		super.enterReference(e);
-	}
 }
diff --git a/src/main/java/spoon/reflect/visitor/ImportScannerImpl.java b/src/main/java/spoon/reflect/visitor/ImportScannerImpl.java
index 120c86ad5..447cf072e 100644
--- a/src/main/java/spoon/reflect/visitor/ImportScannerImpl.java
+++ b/src/main/java/spoon/reflect/visitor/ImportScannerImpl.java
@@ -43,23 +43,23 @@ public class ImportScannerImpl extends CtScanner implements ImportScanner {
 
 	@Override
 	public <T> void visitCtFieldReference(CtFieldReference<T> reference) {
-		enterReference(reference);
+		enter(reference);
 		scan(reference.getDeclaringType());
 		// scan(reference.getType());
-		exitReference(reference);
+		exit(reference);
 	}
 
 	@Override
 	public <T> void visitCtExecutableReference(
 			CtExecutableReference<T> reference) {
-		enterReference(reference);
+		enter(reference);
 		if (reference.getDeclaringType() != null
 				&& reference.getDeclaringType().getDeclaringType() == null) {
 			addImport(reference.getDeclaringType());
 		}
 		scan(reference.getType());
 		scan(reference.getActualTypeArguments());
-		exitReference(reference);
+		exit(reference);
 	}
 
 	@Override
diff --git a/src/main/java/spoon/reflect/visitor/ModelConsistencyChecker.java b/src/main/java/spoon/reflect/visitor/ModelConsistencyChecker.java
index 55e1cd740..1a476fbc2 100644
--- a/src/main/java/spoon/reflect/visitor/ModelConsistencyChecker.java
+++ b/src/main/java/spoon/reflect/visitor/ModelConsistencyChecker.java
@@ -17,13 +17,13 @@
 
 package spoon.reflect.visitor;
 
-import java.util.Stack;
-
 import org.apache.log4j.Level;
 import spoon.compiler.Environment;
 import spoon.reflect.declaration.CtElement;
 import spoon.reflect.declaration.CtNamedElement;
 
+import java.util.Stack;
+
 /**
  * This scanner checks that a program model is consistent with regards to the
  * parent elements (children must have the right parent). This class can be used
@@ -65,10 +65,6 @@ public class ModelConsistencyChecker extends CtScanner {
 		if (!stack.isEmpty()) {
 			if (!element.isParentInitialized() || element.getParent() != stack.peek()) {
 				if ((!element.isParentInitialized() && fixNullParents) || (element.getParent() != stack.peek() && fixInconsistencies)) {
-					// System.out.println("fixing inconsistent parent: "
-					// + element.getClass() + " - "
-					// + element.getPosition() + " - "
-					// + stack.peek().getPosition());
 					element.setParent(stack.peek());
 				} else {
 					final String name = element instanceof CtNamedElement ? " - " + ((CtNamedElement) element).getSimpleName() : "";
diff --git a/src/main/java/spoon/support/DefaultCoreFactory.java b/src/main/java/spoon/support/DefaultCoreFactory.java
index cdd914c3c..5f251ade5 100644
--- a/src/main/java/spoon/support/DefaultCoreFactory.java
+++ b/src/main/java/spoon/support/DefaultCoreFactory.java
@@ -238,7 +238,7 @@ public class DefaultCoreFactory implements CoreFactory, Serializable {
 							for (Entry<?, ?> e : ((Map<?, ?>) fieldValue).entrySet()) {
 								m.put(e.getKey(), clone(e.getValue(), cloningContext));
 							}
-						} else if ((object instanceof CtReference) && (fieldValue instanceof CtElement)) {
+						} else if ((object instanceof CtReference) && (fieldValue instanceof CtElement) && !(fieldValue instanceof CtReference)) {
 							f.set(result, fieldValue);
 						} else {
 							f.set(result, clone(f.get(object), cloningContext));
diff --git a/src/main/java/spoon/support/SerializationModelStreamer.java b/src/main/java/spoon/support/SerializationModelStreamer.java
index 1cec51019..96ec4aa5b 100644
--- a/src/main/java/spoon/support/SerializationModelStreamer.java
+++ b/src/main/java/spoon/support/SerializationModelStreamer.java
@@ -17,19 +17,18 @@
 
 package spoon.support;
 
-import java.io.IOException;
-import java.io.InputStream;
-import java.io.ObjectInputStream;
-import java.io.ObjectOutputStream;
-import java.io.OutputStream;
-
 import spoon.Launcher;
 import spoon.reflect.ModelStreamer;
 import spoon.reflect.declaration.CtElement;
 import spoon.reflect.factory.Factory;
-import spoon.reflect.reference.CtReference;
 import spoon.reflect.visitor.CtScanner;
 
+import java.io.IOException;
+import java.io.InputStream;
+import java.io.ObjectInputStream;
+import java.io.ObjectOutputStream;
+import java.io.OutputStream;
+
 /**
  * This class provides a regular Java serialization-based implementation of the
  * model streamer.
@@ -58,12 +57,6 @@ public class SerializationModelStreamer implements ModelStreamer {
 					e.setFactory(f);
 					super.enter(e);
 				}
-
-				@Override
-				protected void enterReference(CtReference e) {
-					e.setFactory(f);
-					super.enterReference(e);
-				}
 			}.scan(f.Package().getAll());
 			ois.close();
 			return f;
diff --git a/src/main/java/spoon/support/gui/SpoonTreeBuilder.java b/src/main/java/spoon/support/gui/SpoonTreeBuilder.java
index 520e2abf7..b99728c4e 100644
--- a/src/main/java/spoon/support/gui/SpoonTreeBuilder.java
+++ b/src/main/java/spoon/support/gui/SpoonTreeBuilder.java
@@ -17,15 +17,13 @@
 
 package spoon.support.gui;
 
-import java.util.Stack;
-
-import javax.swing.tree.DefaultMutableTreeNode;
-
 import spoon.reflect.declaration.CtElement;
 import spoon.reflect.declaration.CtNamedElement;
-import spoon.reflect.reference.CtReference;
 import spoon.reflect.visitor.CtScanner;
 
+import javax.swing.tree.DefaultMutableTreeNode;
+import java.util.Stack;
+
 public class SpoonTreeBuilder extends CtScanner {
 	Stack<DefaultMutableTreeNode> nodes;
 
@@ -69,18 +67,6 @@ public class SpoonTreeBuilder extends CtScanner {
 		super.enter(element);
 	}
 
-	@Override
-	public void enterReference(CtReference e) {
-		createNode(e);
-		super.enterReference(e);
-	}
-
-	@Override
-	public void exitReference(CtReference e) {
-		nodes.pop();
-		super.exitReference(e);
-	}
-
 	@Override
 	public void exit(CtElement element) {
 		nodes.pop();
diff --git a/src/main/java/spoon/support/template/SubstitutionVisitor.java b/src/main/java/spoon/support/template/SubstitutionVisitor.java
index f9f410f35..ee6e2c35d 100644
--- a/src/main/java/spoon/support/template/SubstitutionVisitor.java
+++ b/src/main/java/spoon/support/template/SubstitutionVisitor.java
@@ -445,7 +445,7 @@ public class SubstitutionVisitor extends CtScanner {
 				if (o instanceof Class) {
 					t = factory.Type().createReference(((Class<?>) o));
 				} else if (o instanceof CtTypeReference) {
-					t = (CtTypeReference<?>) o;
+					t = factory.Core().clone((CtTypeReference<?>) o);
 					reference.setActualTypeArguments(t.getActualTypeArguments());
 				} else {
 					throw new RuntimeException(
diff --git a/src/main/java/spoon/support/visitor/TypeReferenceScanner.java b/src/main/java/spoon/support/visitor/TypeReferenceScanner.java
index 81efbf553..179a5431b 100644
--- a/src/main/java/spoon/support/visitor/TypeReferenceScanner.java
+++ b/src/main/java/spoon/support/visitor/TypeReferenceScanner.java
@@ -68,10 +68,10 @@ public class TypeReferenceScanner extends CtScanner {
 
 	@Override
 	public <T> void visitCtFieldReference(CtFieldReference<T> reference) {
-		enterReference(reference);
+		enter(reference);
 		scan(reference.getDeclaringType());
 		// scan(reference.getType());
-		exitReference(reference);
+		exit(reference);
 	}
 
 	//	public <T> boolean isImported(CtTypeReference<T> ref) {
@@ -86,9 +86,9 @@ public class TypeReferenceScanner extends CtScanner {
 	@Override
 	public <T> void visitCtExecutableReference(
 			CtExecutableReference<T> reference) {
-		enterReference(reference);
+		enter(reference);
 		scan(reference.getActualTypeArguments());
-		exitReference(reference);
+		exit(reference);
 	}
 
 	@Override
