diff --git a/src/main/java/spoon/support/reflect/code/CtBlockImpl.java b/src/main/java/spoon/support/reflect/code/CtBlockImpl.java
index c10520d90..32f3786bd 100644
--- a/src/main/java/spoon/support/reflect/code/CtBlockImpl.java
+++ b/src/main/java/spoon/support/reflect/code/CtBlockImpl.java
@@ -84,7 +84,10 @@ public class CtBlockImpl<R> extends CtStatementImpl implements CtBlock<R> {
 					statements.getStatements().size()
 							+ BLOCK_STATEMENTS_CONTAINER_DEFAULT_CAPACITY);
 		}
-		this.statements.addAll(0, statements.getStatements());
+		for (CtStatement statement : statements.getStatements()) {
+			statement.setParent(this);
+			this.statements.add(0, statement);
+		}
 		return (T) this;
 	}
 
@@ -107,6 +110,7 @@ public class CtBlockImpl<R> extends CtStatementImpl implements CtBlock<R> {
 			// CtBlock hasn't a parent. So, it isn't in a constructor.
 		}
 		ensureModifiableStatementsList();
+		statement.setParent(this);
 		this.statements.add(0, statement);
 		return (T) this;
 	}
diff --git a/src/main/java/spoon/support/reflect/code/CtStatementImpl.java b/src/main/java/spoon/support/reflect/code/CtStatementImpl.java
index 44f034b63..f46f27954 100644
--- a/src/main/java/spoon/support/reflect/code/CtStatementImpl.java
+++ b/src/main/java/spoon/support/reflect/code/CtStatementImpl.java
@@ -58,18 +58,8 @@ public abstract class CtStatementImpl extends CtCodeElementImpl implements CtSta
 		if (e instanceof CtExecutable) {
 			throw new RuntimeException("cannot insert in this context (use insertEnd?)");
 		}
-		CtStatementList parentStatementList = (CtStatementList) e;
-		int i = 0;
-		for (CtStatement s : parentStatementList.getStatements()) {
-			i++;
-			if (s == target) {
-				break;
-			}
-		}
-		for (int j = statements.getStatements().size() - 1; j >= 0; j--) {
-			CtStatement s = statements.getStatements().get(j);
-			parentStatementList.getStatements().add(i, s);
-		}
+
+		new InsertVisitor(target, statements, InsertType.AFTER).scan(e);
 	}
 
 	public static void insertBefore(CtStatement target, CtStatement statement)
@@ -95,23 +85,25 @@ public abstract class CtStatementImpl extends CtCodeElementImpl implements CtSta
 						"cannot insert a statement before a super or this invocation.");
 			}
 		}
-		new InsertBeforeVisitor(target, statementsToBeInserted).scan(targetParent);
+		new InsertVisitor(target, statementsToBeInserted, InsertType.BEFORE).scan(targetParent);
 	}
 
-	private static class InsertBeforeVisitor extends CtInheritanceScanner {
-		private CtStatement target;
-		private CtStatementList statementsToBeInserted;
+	private static class InsertVisitor extends CtInheritanceScanner {
+		private final CtStatement target;
+		private final CtStatementList statementsToBeInserted;
+		private final InsertType insertType;
 
-		InsertBeforeVisitor(CtStatement target, CtStatementList statementsToBeInserted) {
+		InsertVisitor(CtStatement target, CtStatementList statementsToBeInserted, InsertType insertType) {
 			this.target = target;
 			this.statementsToBeInserted = statementsToBeInserted;
+			this.insertType = insertType;
 		}
 
 		@Override
 		public <R> void visitCtBlock(CtBlock<R> e) {
 			super.visitCtBlock(e);
 
-			insertFromFirstStatement(e);
+			insertType.insertFromFirstStatement(e, target, statementsToBeInserted);
 		}
 
 		@Override
@@ -128,7 +120,7 @@ public abstract class CtStatementImpl extends CtCodeElementImpl implements CtSta
 				throw new IllegalArgumentException("should not happen");
 			}
 			if (stat instanceof CtBlock) {
-				insertBegin((CtBlock<?>) stat);
+				insertType.insert((CtBlock<?>) stat, statementsToBeInserted);
 			} else {
 				CtBlock<?> block = insertNewBlock(stat);
 				if (inThen) {
@@ -149,7 +141,7 @@ public abstract class CtStatementImpl extends CtCodeElementImpl implements CtSta
 				}
 			}
 
-			insertFromLastStatement(e.getCases());
+			insertType.insertFromLastStatement(e.getCases(), target, statementsToBeInserted);
 		}
 
 		@Override
@@ -157,7 +149,7 @@ public abstract class CtStatementImpl extends CtCodeElementImpl implements CtSta
 			super.visitCtCase(e);
 
 			target.setParent(e);
-			insertFromLastStatement(e.getStatements());
+			insertType.insertFromLastStatement(e.getStatements(), target, statementsToBeInserted);
 		}
 
 		@Override
@@ -166,7 +158,7 @@ public abstract class CtStatementImpl extends CtCodeElementImpl implements CtSta
 
 			CtStatement stat = loop.getBody();
 			if (stat instanceof CtBlock) {
-				insertBegin((CtBlock<?>) stat);
+				insertType.insert((CtBlock<?>) stat, statementsToBeInserted);
 			} else {
 				CtBlock<?> block = insertNewBlock(stat);
 				target.setParent(block);
@@ -174,45 +166,69 @@ public abstract class CtStatementImpl extends CtCodeElementImpl implements CtSta
 			}
 		}
 
-		private void insertBegin(CtBlock<?> block) {
-			block.insertBegin(statementsToBeInserted);
-		}
-
 		private CtBlock<?> insertNewBlock(CtStatement stat) {
 			CtBlock<?> block = target.getFactory().Core().createBlock();
 			block.addStatement(stat);
-			insertFromFirstStatement(block);
+			insertType.insertFromFirstStatement(block, target, statementsToBeInserted);
 			return block;
 		}
+	}
+
+	private enum InsertType {
+		BEFORE {
+			@Override
+			void insert(CtBlock<?> block, CtStatementList statementsToBeInserted) {
+				block.insertBegin(statementsToBeInserted);
+			}
 
-		private void insertFromFirstStatement(CtBlock<?> block) {
-			int indexOfTargetElement = 0;
-			for (CtStatement s : block.getStatements()) {
-				if (s == target) {
-					break;
+			@Override
+			void insertFromFirstStatement(CtBlock<?> block, CtStatement target, CtStatementList statementsToBeInserted) {
+				int indexOfTargetElement = block.getStatements().indexOf(target);
+				for (CtStatement s : statementsToBeInserted) {
+					s.setParent(block);
+					block.getStatements().add(indexOfTargetElement++, s);
 				}
-				indexOfTargetElement++;
 			}
-			for (CtStatement s : statementsToBeInserted) {
-				s.setParent(block);
-				block.getStatements().add(indexOfTargetElement++, s);
+
+			@Override
+			<T extends CtElement> void insertFromLastStatement(List<T> statements, CtStatement target, CtStatementList statementsToBeInserted) {
+				int indexOfTargetElement = statements.indexOf(target);
+				for (int j = statementsToBeInserted.getStatements().size() - 1; j >= 0; j--) {
+					final CtStatement newStatement = statementsToBeInserted.getStatements().get(j);
+					newStatement.setParent(statements.get(indexOfTargetElement).getParent());
+					statements.add(indexOfTargetElement, (T) newStatement);
+				}
+			}
+		},
+		AFTER {
+			@Override
+			void insert(CtBlock<?> block, CtStatementList statementsToBeInserted) {
+				block.insertEnd(statementsToBeInserted);
 			}
-		}
 
-		private <T extends CtElement> void insertFromLastStatement(List<T> statements) {
-			int i = 0;
-			for (T s : statements) {
-				if (s == target) {
-					break;
+			@Override
+			void insertFromFirstStatement(CtBlock<?> block, CtStatement target, CtStatementList statementsToBeInserted) {
+				int indexOfTargetElement = block.getStatements().indexOf(target);
+				for (CtStatement s : statementsToBeInserted) {
+					s.setParent(block);
+					block.getStatements().add(++indexOfTargetElement, s);
 				}
-				i++;
 			}
-			for (int j = statementsToBeInserted.getStatements().size() - 1; j >= 0; j--) {
-				final CtStatement newStatement = statementsToBeInserted.getStatements().get(j);
-				newStatement.setParent(statements.get(i).getParent());
-				statements.add(i, (T) newStatement);
+
+			@Override
+			<T extends CtElement> void insertFromLastStatement(List<T> statements, CtStatement target, CtStatementList statementsToBeInserted) {
+				int indexOfTargetElement = statements.indexOf(target) + 1;
+				for (int j = statementsToBeInserted.getStatements().size() - 1; j >= 0; j--) {
+					final CtStatement newStatement = statementsToBeInserted.getStatements().get(j);
+					newStatement.setParent(target.getParent());
+					statements.add(indexOfTargetElement, (T) newStatement);
+				}
 			}
-		}
+		};
+
+		abstract void insert(CtBlock<?> block, CtStatementList statementsToBeInserted);
+		abstract void insertFromFirstStatement(CtBlock<?> block, CtStatement target, CtStatementList statementsToBeInserted);
+		abstract <T extends CtElement> void insertFromLastStatement(List<T> statements, CtStatement target, CtStatementList statementsToBeInserted);
 	}
 
 	@Override
diff --git a/src/test/java/spoon/test/intercession/insertBefore/InsertBeforeExample.java b/src/test/java/spoon/test/intercession/insertBefore/InsertBeforeExample.java
index aa6d44e16..235f8f9dc 100644
--- a/src/test/java/spoon/test/intercession/insertBefore/InsertBeforeExample.java
+++ b/src/test/java/spoon/test/intercession/insertBefore/InsertBeforeExample.java
@@ -1,6 +1,10 @@
 package spoon.test.intercession.insertBefore;
 
 class InsertBeforeExample {
+    public InsertBeforeExample() {
+        super();
+    }
+
     int ifWithoutBraces() {
         // without braces
         if (1==0+1)
diff --git a/src/test/java/spoon/test/intercession/insertBefore/InsertBeforeTest.java b/src/test/java/spoon/test/intercession/insertBefore/InsertBeforeTest.java
deleted file mode 100644
index 3c5f5bb4f..000000000
--- a/src/test/java/spoon/test/intercession/insertBefore/InsertBeforeTest.java
+++ /dev/null
@@ -1,194 +0,0 @@
-package spoon.test.intercession.insertBefore;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertSame;
-import static org.junit.Assert.assertTrue;
-
-import java.util.List;
-
-import org.junit.Before;
-import org.junit.Test;
-
-import spoon.Launcher;
-import spoon.compiler.SpoonResourceHelper;
-import spoon.reflect.code.CtBlock;
-import spoon.reflect.code.CtCase;
-import spoon.reflect.code.CtCodeSnippetStatement;
-import spoon.reflect.code.CtIf;
-import spoon.reflect.code.CtLiteral;
-import spoon.reflect.code.CtStatement;
-import spoon.reflect.code.CtSwitch;
-import spoon.reflect.code.CtWhile;
-import spoon.reflect.declaration.CtClass;
-import spoon.reflect.declaration.CtElement;
-import spoon.reflect.declaration.CtMethod;
-import spoon.reflect.factory.Factory;
-import spoon.reflect.visitor.Query;
-import spoon.reflect.visitor.filter.NameFilter;
-import spoon.reflect.visitor.filter.TypeFilter;
-
-public class InsertBeforeTest {
-
-	Factory factory;
-
-	@Before
-	public void setup() throws Exception {
-		Launcher spoon = new Launcher();
-		factory = spoon.createFactory();
-		spoon.createCompiler(
-				factory,
-				SpoonResourceHelper
-						.resources("./src/test/java/spoon/test/intercession/insertBefore/InsertBeforeExample.java"))
-				.build();
-	}
-
-    @Test
-    public void testInsertBefore() {
-        CtClass<?> clazz = factory
-                .Code()
-                .createCodeSnippetStatement(
-                        "" + "class X {" + "public void foo() {" + " int x=0;"
-                                + " int y=0;" + " int z=x+y;" + "}" + "};")
-                .compile();
-        CtMethod<?> foo = (CtMethod<?>) clazz.getMethods().toArray()[0];
-
-        CtBlock<?> body = foo.getBody();
-        assertEquals(3, body.getStatements().size());
-
-        CtStatement s = body.getStatements().get(2);
-        assertEquals("int z = x + y", s.toString());
-
-        // adding a new statement;
-        CtCodeSnippetStatement stmt = factory.Core()
-                .createCodeSnippetStatement();
-        stmt.setValue("System.out.println(x);");
-        s.insertBefore(stmt);
-        assertEquals(4, body.getStatements().size());
-        assertSame(stmt, body.getStatements().get(2));
-    }
-
-    // test for a bug found by Maxime Clement
-    @Test
-    public void testInsertBeforeBrace() throws Exception {
-        CtClass<?> foo = factory.Package().get("spoon.test.intercession.insertBefore")
-                .getType("InsertBeforeExample");
-
-        {
-        CtMethod<?> ifWithoutBraces_m = foo.getElements(
-                new NameFilter<CtMethod<?>>("ifWithoutBraces")).get(0);
-
-        // replace the return
-        CtCodeSnippetStatement s = factory.Code().createCodeSnippetStatement("return 2");
-
-        CtIf ifWithoutBraces = ifWithoutBraces_m.getElements(
-                new TypeFilter<>(CtIf.class)).get(0);
-
-        // Inserts a s before the then statement
-        ifWithoutBraces.getThenStatement().insertBefore(s);
-
-        assertTrue(ifWithoutBraces.getThenStatement() instanceof CtBlock);
-        assertEquals(s, ((CtBlock<?>) ifWithoutBraces.getThenStatement()).getStatement(0));
-        //System.out.println("end 1");
-
-        }
-
-        {
-        CtMethod<?> ifWithBraces_m = foo.getElements(
-                new NameFilter<CtMethod<?>>("ifWithBraces")).get(0);
-
-        // replace the return
-        CtCodeSnippetStatement s = factory.Code().createCodeSnippetStatement("return 2");
-
-        CtIf ifWithBraces = ifWithBraces_m.getElements(
-                new TypeFilter<CtIf>(CtIf.class)).get(0);
-
-        // Inserts a s before the then statement
-        ifWithBraces.getThenStatement().insertBefore(s);
-        assertTrue(ifWithBraces.getThenStatement() instanceof CtBlock);
-        assertEquals(s, ((CtBlock<?>) ifWithBraces.getThenStatement()).getStatement(0));
-        }
-    }
-
-    @Test
-    public void testInsertBeforeSwitchCase() throws Exception {
-        CtClass<?> foo = factory.Package().get("spoon.test.intercession.insertBefore")
-                .getType("InsertBeforeExample");
-
-        {
-            CtMethod<?> sm = foo.getElements(
-                    new NameFilter<CtMethod<?>>("switchMethod")).get(0);
-
-            CtCase<Object> caseElem = factory.Core().createCase();
-            CtLiteral<Object> literal = factory.Core().createLiteral();
-            literal.setValue(1);
-            caseElem.setCaseExpression(literal);
-
-            CtSwitch<?> sw = sm.getElements(
-                    new TypeFilter<CtSwitch<?>>(CtSwitch.class)).get(0);
-
-            CtCase<?> ctCase1 = (CtCase<?>) sw.getCases().get(2);
-            CtCase<?> ctCase2= (CtCase<?>) sw.getCases().get(3);
-            CtCodeSnippetStatement snippet = factory.Code().createCodeSnippetStatement("System.out.println(\"foo\")");
-            ctCase1.getStatements().get(0).insertBefore(snippet);
-            ctCase2.getStatements().get(1).insertBefore(snippet);
-            assertEquals(snippet, ctCase1.getStatements().get(0));
-            assertEquals(snippet, ctCase2.getStatements().get(1));
-
-            CtCase<?> ctCase = (CtCase<?>) sw.getCases().get(1);
-            
-            // here we may call either insertBefore(CtStatement) or insertBefore(CtStatementList)
-            // ctCase.insertBefore(caseElem);
-            // so force the correct insert            
-            CtStatement stmt = caseElem;
-            ctCase.insertBefore(stmt);
-
-            assertEquals(5, sw.getCases().size());
-            assertEquals(caseElem, sw.getCases().get(1));
-            assertEquals(ctCase, sw.getCases().get(2));
-            
-        }
-    }
-
-    @Test
-    public void insertBeforeAndUpdateParent() throws Exception {
-    	/**
-    	 * if (condition)
-    	 *     while (loop_condition)
-    	 * 
-    	 * In this case the 'while' is not inside a block, but
-    	 * when we insert a new statement
-    	 * 
-    	 * if (condition) {
-    	 *     newStatement
-    	 *     while (loop_condition)
-    	 *     ...
-    	 * }
-    	 * 
-    	 * Now the while is inside a block.
-    	 */
-    	Launcher spoon = new Launcher();
-		Factory factory = spoon.createFactory();
-		spoon.createCompiler(factory, SpoonResourceHelper.resources("./src/test/resources/spoon/test/intercession/insertBefore/InsertBeforeExample2.java")).build();
-		
-		// Get the 'while'
-		List<CtWhile> elements = Query.getElements(factory, new TypeFilter<CtWhile>(CtWhile.class));
-		assertTrue(1 == elements.size());
-		CtWhile theWhile = elements.get(0);
-		
-		// We make sure the parent of the while is the CtIf and not the block
-		CtElement parent = theWhile.getParent();
-		assertTrue(CtIf.class.isInstance(parent));
-		CtIf ifParent = (CtIf) parent;
-		
-		// Create a new statement to be inserted before the while
-		CtStatement insert = factory.Code().createCodeSnippetStatement("System.out.println()");
-		
-		// Insertion of the new statement
-		theWhile.insertBefore(insert);
-		
-		// We make sure the parent of the while is updated
-		CtElement newParent = theWhile.getParent();
-		assertTrue(newParent != ifParent);
-		assertTrue(CtBlock.class.isInstance(newParent));
-    }
-}
diff --git a/src/test/java/spoon/test/intercession/insertBefore/InsertMethodsTest.java b/src/test/java/spoon/test/intercession/insertBefore/InsertMethodsTest.java
new file mode 100644
index 000000000..65a30f79a
--- /dev/null
+++ b/src/test/java/spoon/test/intercession/insertBefore/InsertMethodsTest.java
@@ -0,0 +1,270 @@
+package spoon.test.intercession.insertBefore;
+
+import org.junit.Before;
+import org.junit.Test;
+import spoon.Launcher;
+import spoon.compiler.SpoonResourceHelper;
+import spoon.reflect.code.CtBlock;
+import spoon.reflect.code.CtCase;
+import spoon.reflect.code.CtCodeSnippetStatement;
+import spoon.reflect.code.CtIf;
+import spoon.reflect.code.CtLiteral;
+import spoon.reflect.code.CtStatement;
+import spoon.reflect.code.CtSwitch;
+import spoon.reflect.code.CtWhile;
+import spoon.reflect.declaration.CtClass;
+import spoon.reflect.declaration.CtElement;
+import spoon.reflect.declaration.CtMethod;
+import spoon.reflect.factory.Factory;
+import spoon.reflect.visitor.Query;
+import spoon.reflect.visitor.filter.NameFilter;
+import spoon.reflect.visitor.filter.TypeFilter;
+
+import java.util.List;
+
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertSame;
+import static org.junit.Assert.assertTrue;
+
+public class InsertMethodsTest {
+
+	Factory factory;
+	;
+	private CtClass<?> assignmentClass;
+	private CtClass<?> insertExampleClass;
+
+	@Before
+	public void setup() throws Exception {
+		Launcher spoon = new Launcher();
+		factory = spoon.createFactory();
+		spoon.createCompiler(factory, SpoonResourceHelper.resources("./src/test/java/spoon/test/intercession/insertBefore/InsertBeforeExample.java")).build();
+		assignmentClass = factory.Code().createCodeSnippetStatement(//
+				"class X {" //
+						+ "public void foo() {" //
+						+ "  int x=0;" //
+						+ "  int y=0;" //
+						+ "  int z=x+y;" //
+						+ " }" //
+						+ "};").compile();
+		insertExampleClass = factory.Package().get("spoon.test.intercession.insertBefore").getType("InsertBeforeExample");
+	}
+
+	@Test
+	public void testInsertBefore() {
+		CtMethod<Void> foo = (CtMethod<Void>) assignmentClass.getMethods().toArray()[0];
+
+		CtBlock<?> body = foo.getBody();
+		assertEquals(3, body.getStatements().size());
+
+		CtStatement s = body.getStatements().get(2);
+		assertEquals("int z = x + y", s.toString());
+
+		// adding a new statement;
+		CtCodeSnippetStatement stmt = factory.Core().createCodeSnippetStatement();
+		stmt.setValue("System.out.println(x);");
+		s.insertBefore(stmt);
+		assertEquals(4, body.getStatements().size());
+		assertSame(stmt, body.getStatements().get(2));
+		assertEquals(s.getParent(), stmt.getParent());
+	}
+
+	@Test
+	public void testInsertAfter() throws Exception {
+		CtMethod<Void> foo = (CtMethod<Void>) assignmentClass.getMethods().toArray()[0];
+
+		CtBlock<?> body = foo.getBody();
+		assertEquals(3, body.getStatements().size());
+
+		CtStatement s = body.getStatements().get(2);
+		assertEquals("int z = x + y", s.toString());
+
+		// adding a new statement;
+		CtCodeSnippetStatement stmt = factory.Core().createCodeSnippetStatement();
+		stmt.setValue("System.out.println(x);");
+		s.insertAfter(stmt);
+		assertEquals(4, body.getStatements().size());
+		assertSame(stmt, body.getStatements().get(3));
+		assertEquals(body, stmt.getParent());
+	}
+
+	@Test
+	public void testInsertBeforeWithoutBrace() throws Exception {
+		CtMethod<?> ifWithoutBraces_m = insertExampleClass.getElements(new NameFilter<CtMethod<?>>("ifWithoutBraces")).get(0);
+
+		// replace the return
+		CtCodeSnippetStatement s = factory.Code().createCodeSnippetStatement("return 2");
+
+		CtIf ifWithoutBraces = ifWithoutBraces_m.getElements(new TypeFilter<>(CtIf.class)).get(0);
+
+		// Inserts a s before the then statement
+		ifWithoutBraces.getThenStatement().insertBefore(s);
+
+		assertTrue(ifWithoutBraces.getThenStatement() instanceof CtBlock);
+		assertEquals(s, ((CtBlock<?>) ifWithoutBraces.getThenStatement()).getStatement(0));
+		assertEquals(ifWithoutBraces.getThenStatement(), s.getParent());
+	}
+
+	@Test
+	public void testInsertBeforeWithBrace() throws Exception {
+		CtMethod<?> ifWithBraces_m = insertExampleClass.getElements(new NameFilter<CtMethod<?>>("ifWithBraces")).get(0);
+
+		// replace the return
+		CtCodeSnippetStatement s = factory.Code().createCodeSnippetStatement("return 2");
+
+		CtIf ifWithBraces = ifWithBraces_m.getElements(new TypeFilter<CtIf>(CtIf.class)).get(0);
+
+		// Inserts a s before the then statement
+		ifWithBraces.getThenStatement().insertBefore(s);
+		assertTrue(ifWithBraces.getThenStatement() instanceof CtBlock);
+		assertEquals(s, ((CtBlock<?>) ifWithBraces.getThenStatement()).getStatement(0));
+		assertEquals(ifWithBraces.getThenStatement(), s.getParent());
+	}
+
+	@Test
+	public void testInsertAfterWithoutBrace() throws Exception {
+		CtMethod<?> ifWithoutBraces_m = insertExampleClass.getElements(new NameFilter<CtMethod<?>>("ifWithoutBraces")).get(0);
+
+		// replace the return
+		CtCodeSnippetStatement s = factory.Code().createCodeSnippetStatement("return 2");
+
+		CtIf ifWithoutBraces = ifWithoutBraces_m.getElements(new TypeFilter<>(CtIf.class)).get(0);
+
+		// Inserts a s before the then statement
+		ifWithoutBraces.getThenStatement().insertAfter(s);
+
+		assertTrue(ifWithoutBraces.getThenStatement() instanceof CtBlock);
+		assertEquals(s, ((CtBlock<?>) ifWithoutBraces.getThenStatement()).getStatement(1));
+		assertEquals(ifWithoutBraces.getThenStatement(), s.getParent());
+	}
+
+	@Test
+	public void testInsertAfterWithBrace() throws Exception {
+		CtMethod<?> ifWithBraces_m = insertExampleClass.getElements(new NameFilter<CtMethod<?>>("ifWithBraces")).get(0);
+
+		// replace the return
+		CtCodeSnippetStatement s = factory.Code().createCodeSnippetStatement("return 2");
+
+		CtIf ifWithBraces = ifWithBraces_m.getElements(new TypeFilter<CtIf>(CtIf.class)).get(0);
+
+		// Inserts a s before the then statement
+		ifWithBraces.getThenStatement().insertAfter(s);
+		assertTrue(ifWithBraces.getThenStatement() instanceof CtBlock);
+		assertEquals(s, ((CtBlock<?>) ifWithBraces.getThenStatement()).getStatement(1));
+		assertEquals(ifWithBraces.getThenStatement(), s.getParent());
+	}
+
+	@Test
+	public void testInsertBeforeSwitchCase() throws Exception {
+		CtMethod<?> sm = insertExampleClass.getElements(new NameFilter<CtMethod<?>>("switchMethod")).get(0);
+
+		// Adds a new snippet in a case.
+		CtSwitch<?> sw = sm.getElements(new TypeFilter<CtSwitch<?>>(CtSwitch.class)).get(0);
+
+		CtCase<?> ctCase1 = sw.getCases().get(2);
+		CtCase<?> ctCase2 = sw.getCases().get(3);
+		CtCodeSnippetStatement snippet = factory.Code().createCodeSnippetStatement("System.out.println(\"foo\")");
+		ctCase1.getStatements().get(0).insertBefore(snippet);
+		assertEquals(snippet, ctCase1.getStatements().get(0));
+		assertEquals(ctCase1, snippet.getParent());
+
+		CtCodeSnippetStatement snippet2 = factory.Core().clone(snippet);
+		ctCase2.getStatements().get(1).insertBefore(snippet2);
+		assertEquals(snippet2, ctCase2.getStatements().get(1));
+		assertEquals(ctCase2, snippet2.getParent());
+
+		// Creates a new case.
+		CtCase<Object> caseElem = factory.Core().createCase();
+		CtLiteral<Object> literal = factory.Core().createLiteral();
+		literal.setValue(1);
+		caseElem.setCaseExpression(literal);
+		// here we may call either insertBefore(CtStatement) or insertBefore(CtStatementList)
+		// ctCase.insertBefore(caseElem);
+		// so force the correct insert
+		CtCase<?> ctCase = sw.getCases().get(1);
+		ctCase.insertBefore((CtStatement) caseElem);
+
+		assertEquals(5, sw.getCases().size());
+		assertEquals(caseElem, sw.getCases().get(1));
+		assertEquals(ctCase, sw.getCases().get(2));
+		assertEquals(sw, caseElem.getParent());
+	}
+
+	@Test
+	public void testInsertAfterSwitchCase() throws Exception {
+		CtMethod<?> sm = insertExampleClass.getElements(new NameFilter<CtMethod<?>>("switchMethod")).get(0);
+
+		// Adds a new snippet in a case.
+		CtSwitch<?> sw = sm.getElements(new TypeFilter<CtSwitch<?>>(CtSwitch.class)).get(0);
+
+		CtCase<?> ctCase1 = sw.getCases().get(2);
+		CtCase<?> ctCase2 = sw.getCases().get(3);
+		CtCodeSnippetStatement snippet = factory.Code().createCodeSnippetStatement("System.out.println(\"foo\")");
+		ctCase1.getStatements().get(0).insertAfter(snippet);
+		assertEquals(snippet, ctCase1.getStatements().get(1));
+		assertEquals(ctCase1, snippet.getParent());
+
+		CtCodeSnippetStatement snippet2 = factory.Core().clone(snippet);
+		ctCase2.getStatements().get(1).insertAfter(snippet2);
+		assertEquals(snippet2, ctCase2.getStatements().get(2));
+		assertEquals(ctCase2, snippet2.getParent());
+
+		// Creates a new case.
+		CtCase<Object> caseElem = factory.Core().createCase();
+		CtLiteral<Object> literal = factory.Core().createLiteral();
+		literal.setValue(1);
+		caseElem.setCaseExpression(literal);
+		// here we may call either insertAfter(CtStatement) or insertAfter(CtStatementList)
+		// ctCase.insertAfter(caseElem);
+		// so force the correct insert
+		CtCase<?> ctCase = sw.getCases().get(1);
+		ctCase.insertAfter((CtStatement) caseElem);
+
+		assertEquals(5, sw.getCases().size());
+		assertEquals(caseElem, sw.getCases().get(2));
+		assertEquals(ctCase, sw.getCases().get(1));
+		assertEquals(sw, caseElem.getParent());
+	}
+
+	@Test
+	public void insertBeforeAndUpdateParent() throws Exception {
+		/**
+		 * if (condition)
+		 *     while (loop_condition)
+		 *
+		 * In this case the 'while' is not inside a block, but
+		 * when we insert a new statement
+		 *
+		 * if (condition) {
+		 *     newStatement
+		 *     while (loop_condition)
+		 *     ...
+		 * }
+		 *
+		 * Now the while is inside a block.
+		 */
+		Launcher spoon = new Launcher();
+		Factory factory = spoon.createFactory();
+		spoon.createCompiler(factory, SpoonResourceHelper.resources("./src/test/resources/spoon/test/intercession/insertBefore/InsertBeforeExample2.java")).build();
+
+		// Get the 'while'
+		List<CtWhile> elements = Query.getElements(factory, new TypeFilter<CtWhile>(CtWhile.class));
+		assertTrue(1 == elements.size());
+		CtWhile theWhile = elements.get(0);
+
+		// We make sure the parent of the while is the CtIf and not the block
+		CtElement parent = theWhile.getParent();
+		assertTrue(CtIf.class.isInstance(parent));
+		CtIf ifParent = (CtIf) parent;
+
+		// Create a new statement to be inserted before the while
+		CtStatement insert = factory.Code().createCodeSnippetStatement("System.out.println()");
+
+		// Insertion of the new statement
+		theWhile.insertBefore(insert);
+
+		// We make sure the parent of the while is updated
+		CtElement newParent = theWhile.getParent();
+		assertTrue(newParent != ifParent);
+		assertTrue(CtBlock.class.isInstance(newParent));
+	}
+}
