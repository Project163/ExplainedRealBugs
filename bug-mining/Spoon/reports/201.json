{"url":"https://api.github.com/repos/INRIA/spoon/issues/1307","repository_url":"https://api.github.com/repos/INRIA/spoon","labels_url":"https://api.github.com/repos/INRIA/spoon/issues/1307/labels{/name}","comments_url":"https://api.github.com/repos/INRIA/spoon/issues/1307/comments","events_url":"https://api.github.com/repos/INRIA/spoon/issues/1307/events","html_url":"https://github.com/INRIA/spoon/issues/1307","id":229710774,"node_id":"MDU6SXNzdWUyMjk3MTA3NzQ=","number":1307,"title":"The fully qualified name of an annotation on a method inside an anonymous inner class is sometimes not completely correct","user":{"login":"zhongxingyu","id":11764226,"node_id":"MDQ6VXNlcjExNzY0MjI2","avatar_url":"https://avatars.githubusercontent.com/u/11764226?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongxingyu","html_url":"https://github.com/zhongxingyu","followers_url":"https://api.github.com/users/zhongxingyu/followers","following_url":"https://api.github.com/users/zhongxingyu/following{/other_user}","gists_url":"https://api.github.com/users/zhongxingyu/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongxingyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongxingyu/subscriptions","organizations_url":"https://api.github.com/users/zhongxingyu/orgs","repos_url":"https://api.github.com/users/zhongxingyu/repos","events_url":"https://api.github.com/users/zhongxingyu/events{/privacy}","received_events_url":"https://api.github.com/users/zhongxingyu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":64529851,"node_id":"MDU6TGFiZWw2NDUyOTg1MQ==","url":"https://api.github.com/repos/INRIA/spoon/labels/bug","name":"bug","color":"fef2c0","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2017-05-18T15:17:10Z","updated_at":"2017-05-19T18:17:38Z","closed_at":"2017-05-19T18:17:38Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I use spoon (the latest version) to get the annotations present in the following java file (in Github project ehcache/ehcache3)\r\n\r\n```java\r\npackage org.ehcache.core;\r\n\r\nimport org.ehcache.Cache;\r\nimport org.ehcache.core.spi.store.Store;\r\nimport org.ehcache.core.spi.store.StoreAccessException;\r\n\r\nimport java.util.Iterator;\r\n\r\n/**\r\n * This implementation could change depending on <a href=\"https://github.com/jsr107/jsr107spec/issues/337\">jsr107spec issue #337</a>\r\n * as letting next() return true might not be such a great idea, and too strict accounting of stats in the TCK\r\n * preventing a look-ahead iterator implementation.\r\n *\r\n * @author Ludovic Orban\r\n */\r\nclass SpecIterator<K, V> implements Iterator<Cache.Entry<K, V>> {\r\n\r\n  private final Jsr107Cache<K, V> cache;\r\n  private final Store.Iterator<Cache.Entry<K, Store.ValueHolder<V>>> iterator;\r\n  private Cache.Entry<K, Store.ValueHolder<V>> current;\r\n\r\n  public SpecIterator(Jsr107Cache<K, V> cache, Store<K, V> store) {\r\n    this.cache = cache;\r\n    this.iterator = store.iterator();\r\n  }\r\n\r\n  @Override\r\n  public boolean hasNext() {\r\n    return iterator.hasNext();\r\n  }\r\n\r\n  @Override\r\n  public Cache.Entry<K, V> next() {\r\n    try {\r\n      Cache.Entry<K, Store.ValueHolder<V>> next = iterator.next();\r\n      final K nextKey = next.getKey();\r\n      Store.ValueHolder<V> nextValueHolder = next.getValue();\r\n\r\n      // call Cache.get() here to check for expiry *and* account for a get in the stats, without using the loader\r\n      if (cache.getNoLoader(nextKey) == null) {\r\n        current = null;\r\n        return null;\r\n      }\r\n\r\n      current = next;\r\n\r\n      final V nextValue = nextValueHolder.value();\r\n      return new Cache.Entry<K, V>() {\r\n        @Override\r\n        public K getKey() {\r\n          return nextKey;\r\n        }\r\n\r\n        @Override\r\n        public V getValue() {\r\n          return nextValue;\r\n        }\r\n      };\r\n    } catch (StoreAccessException sae) {\r\n      current = null;\r\n      return null;\r\n    }\r\n  }\r\n\r\n  @Override\r\n  public void remove() {\r\n    if (current == null) {\r\n      throw new IllegalStateException();\r\n    }\r\n    cache.remove(current.getKey());\r\n    current = null;\r\n  }\r\n}\r\n```\r\n\r\nHowever, the returned names for the @Override annotation inside the anonymous inner class is org.ehcache.core.Override. ","closed_by":{"login":"monperrus","id":803666,"node_id":"MDQ6VXNlcjgwMzY2Ng==","avatar_url":"https://avatars.githubusercontent.com/u/803666?v=4","gravatar_id":"","url":"https://api.github.com/users/monperrus","html_url":"https://github.com/monperrus","followers_url":"https://api.github.com/users/monperrus/followers","following_url":"https://api.github.com/users/monperrus/following{/other_user}","gists_url":"https://api.github.com/users/monperrus/gists{/gist_id}","starred_url":"https://api.github.com/users/monperrus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/monperrus/subscriptions","organizations_url":"https://api.github.com/users/monperrus/orgs","repos_url":"https://api.github.com/users/monperrus/repos","events_url":"https://api.github.com/users/monperrus/events{/privacy}","received_events_url":"https://api.github.com/users/monperrus/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/INRIA/spoon/issues/1307/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/INRIA/spoon/issues/1307/timeline","performed_via_github_app":null,"state_reason":"completed"}