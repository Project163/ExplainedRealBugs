{"url":"https://api.github.com/repos/INRIA/spoon/issues/776","repository_url":"https://api.github.com/repos/INRIA/spoon","labels_url":"https://api.github.com/repos/INRIA/spoon/issues/776/labels{/name}","comments_url":"https://api.github.com/repos/INRIA/spoon/issues/776/comments","events_url":"https://api.github.com/repos/INRIA/spoon/issues/776/events","html_url":"https://github.com/INRIA/spoon/issues/776","id":169925497,"node_id":"MDU6SXNzdWUxNjk5MjU0OTc=","number":776,"title":"proper support for creating internal classes  (within methods) with the intercession API","user":{"login":"monperrus","id":803666,"node_id":"MDQ6VXNlcjgwMzY2Ng==","avatar_url":"https://avatars.githubusercontent.com/u/803666?v=4","gravatar_id":"","url":"https://api.github.com/users/monperrus","html_url":"https://github.com/monperrus","followers_url":"https://api.github.com/users/monperrus/followers","following_url":"https://api.github.com/users/monperrus/following{/other_user}","gists_url":"https://api.github.com/users/monperrus/gists{/gist_id}","starred_url":"https://api.github.com/users/monperrus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/monperrus/subscriptions","organizations_url":"https://api.github.com/users/monperrus/orgs","repos_url":"https://api.github.com/users/monperrus/repos","events_url":"https://api.github.com/users/monperrus/events{/privacy}","received_events_url":"https://api.github.com/users/monperrus/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2016-08-08T13:39:38Z","updated_at":"2016-09-26T14:40:04Z","closed_at":"2016-09-26T14:40:04Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"possible bug reported [on stackoverflow](http://stackoverflow.com/questions/38783040/generating-a-class-within-a-method-with-spoon)\n\nI've been working on a processor that injects an inner class _inside_ a method, and I'm having a lot of trouble figuring out just how to generate the class and accompanying object initialization without incurring auto-generation of an incorrect fully-qualified name.\n\nFor example, I've been processing stuff like:\nI've been making a new class:\n\n```\nCtClass internal = getFactory().Core().createClass();\n```\n\nand then inserting it before an element within a method\n\n```\nelement.insertBefore(internal);\n```\n\nbut when I make an initialization statement:\n\n```\nCtConstructorCall call = getFactory().Core().createConstructorCall();\ncall.setType(internal);\ninternal.insertAfter(call);\n```\n\nI get a call that looks like:\n\n```\nMain.internal initializedInternalObject = new Main.internal();\n```\n\nWhere `Main` is the name of the overall class that everything is inside, even though `internal` is declared only inside a specific method. I've tried using getFactory().Class().create() method for internal classes, but that method only seems to be targeted toward classes nested within classes, as opposed to classes delcared within methods. \n","closed_by":{"login":"tdurieux","id":5577568,"node_id":"MDQ6VXNlcjU1Nzc1Njg=","avatar_url":"https://avatars.githubusercontent.com/u/5577568?v=4","gravatar_id":"","url":"https://api.github.com/users/tdurieux","html_url":"https://github.com/tdurieux","followers_url":"https://api.github.com/users/tdurieux/followers","following_url":"https://api.github.com/users/tdurieux/following{/other_user}","gists_url":"https://api.github.com/users/tdurieux/gists{/gist_id}","starred_url":"https://api.github.com/users/tdurieux/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tdurieux/subscriptions","organizations_url":"https://api.github.com/users/tdurieux/orgs","repos_url":"https://api.github.com/users/tdurieux/repos","events_url":"https://api.github.com/users/tdurieux/events{/privacy}","received_events_url":"https://api.github.com/users/tdurieux/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/INRIA/spoon/issues/776/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/INRIA/spoon/issues/776/timeline","performed_via_github_app":null,"state_reason":"completed"}