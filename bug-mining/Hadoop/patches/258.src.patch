diff --git a/CHANGES.txt b/CHANGES.txt
index ad5a7799ac2..ead2d3f88a9 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -100,6 +100,9 @@ Trunk (unreleased changes)
     HADOOP-7131. Exceptions thrown by Text methods should include the causing
     exception. (Uma Maheswara Rao G via todd)
 
+    HADOOP-6912. Guard against NPE when calling UGI.isLoginKeytabBased().
+    (Kan Zhang via jitendra)
+
 Release 0.22.0 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/src/java/org/apache/hadoop/security/UserGroupInformation.java b/src/java/org/apache/hadoop/security/UserGroupInformation.java
index 9908f3d09c5..085ce61719e 100644
--- a/src/java/org/apache/hadoop/security/UserGroupInformation.java
+++ b/src/java/org/apache/hadoop/security/UserGroupInformation.java
@@ -811,8 +811,8 @@ private boolean hasSufficientTimeElapsed(long now) {
    * Did the login happen via keytab
    * @return true or false
    */
-  public synchronized static boolean isLoginKeytabBased() {
-    return loginUser.isKeytab;
+  public synchronized static boolean isLoginKeytabBased() throws IOException {
+    return getLoginUser().isKeytab;
   }
 
   /**
