diff --git a/CHANGES.txt b/CHANGES.txt
index e48a0084f86..84d91126584 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -517,6 +517,9 @@ Trunk (unreleased changes)
     HADOOP-6224. Add a method to WritableUtils performing a bounded read of an
     encoded String. (Jothi Padmanabhan via cdouglas)
 
+    HADOOP-6231. Allow caching of filesystem instances to be disabled on a
+    per-instance basis. (tomwhite)
+
   OPTIMIZATIONS
 
     HADOOP-5595. NameNode does not need to run a replicator to choose a
diff --git a/src/java/core-default.xml b/src/java/core-default.xml
index 6361636851f..146a0238a3e 100644
--- a/src/java/core-default.xml
+++ b/src/java/core-default.xml
@@ -202,6 +202,12 @@
   <description>The filesystem for Hadoop archives. </description>
 </property>
 
+<property>
+  <name>fs.har.impl.disable.cache</name>
+  <value>true</value>
+  <description>Don't cache 'har' filesystem instances.</description>
+</property>
+
 <property>
   <name>fs.checkpoint.dir</name>
   <value>${hadoop.tmp.dir}/dfs/namesecondary</value>
diff --git a/src/java/org/apache/hadoop/fs/FileSystem.java b/src/java/org/apache/hadoop/fs/FileSystem.java
index 8e20e5aab0a..ca05ff4f4c8 100644
--- a/src/java/org/apache/hadoop/fs/FileSystem.java
+++ b/src/java/org/apache/hadoop/fs/FileSystem.java
@@ -181,6 +181,11 @@ public static FileSystem get(URI uri, Configuration conf) throws IOException {
         return get(defaultUri, conf);              // return default
       }
     }
+    
+    String disableCacheName = String.format("fs.%s.impl.disable.cache", scheme);
+    if (conf.getBoolean(disableCacheName, false)) {
+      return createFileSystem(uri, conf);
+    }
 
     return CACHE.get(uri, conf);
   }
diff --git a/src/test/core/org/apache/hadoop/fs/TestFileSystem.java b/src/test/core/org/apache/hadoop/fs/TestFileSystem.java
new file mode 100644
index 00000000000..9ef0ab5164b
--- /dev/null
+++ b/src/test/core/org/apache/hadoop/fs/TestFileSystem.java
@@ -0,0 +1,50 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.hadoop.fs;
+
+import static junit.framework.Assert.assertSame;
+import static junit.framework.Assert.assertNotSame;
+
+import java.net.URI;
+
+import org.apache.hadoop.conf.Configuration;
+import org.junit.Test;
+
+public class TestFileSystem {
+
+  @Test
+  public void testCacheEnabled() throws Exception {
+    Configuration conf = new Configuration();
+    conf.set("fs.cachedfile.impl", conf.get("fs.file.impl"));
+    FileSystem fs1 = FileSystem.get(new URI("cachedfile://a"), conf);
+    FileSystem fs2 = FileSystem.get(new URI("cachedfile://a"), conf);
+    assertSame(fs1, fs2);
+  }
+  
+  @Test
+  public void testCacheDisabled() throws Exception {
+    Configuration conf = new Configuration();
+    conf.set("fs.uncachedfile.impl", conf.get("fs.file.impl"));
+    conf.setBoolean("fs.uncachedfile.impl.disable.cache", true);
+    FileSystem fs1 = FileSystem.get(new URI("uncachedfile://a"), conf);
+    FileSystem fs2 = FileSystem.get(new URI("uncachedfile://a"), conf);
+    assertNotSame(fs1, fs2);
+  }
+
+}
