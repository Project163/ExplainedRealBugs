diff --git a/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/compress/BlockCompressorStream.java b/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/compress/BlockCompressorStream.java
index 434183bbc25..3e6826afc85 100644
--- a/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/compress/BlockCompressorStream.java
+++ b/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/compress/BlockCompressorStream.java
@@ -54,7 +54,11 @@ public class BlockCompressorStream extends CompressorStream {
   public BlockCompressorStream(OutputStream out, Compressor compressor, 
                                int bufferSize, int compressionOverhead) {
     super(out, compressor, bufferSize);
-    MAX_INPUT_SIZE = bufferSize - compressionOverhead;
+    if (bufferSize - compressionOverhead >= 0) {
+      MAX_INPUT_SIZE = bufferSize - compressionOverhead;
+    } else {
+      throw new IllegalArgumentException("buffer size is less than compression overhead");
+    }
   }
 
   /**
