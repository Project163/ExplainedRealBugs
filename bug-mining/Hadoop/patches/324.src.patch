diff --git a/common/CHANGES.txt b/common/CHANGES.txt
index a74fa5daddc..675d9567975 100644
--- a/common/CHANGES.txt
+++ b/common/CHANGES.txt
@@ -355,6 +355,9 @@ Trunk (unreleased changes)
     HADOOP-7442. Docs in core-default.xml still reference deprecated config
     "topology.script.file.name" (atm)
 
+    HADOOP-7419. new hadoop-config.sh doesn't manage classpath for
+    HADOOP_CONF_DIR correctly. (Bing Zheng and todd via todd)
+
 Release 0.22.0 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/common/bin/hadoop-config.sh b/common/bin/hadoop-config.sh
index 7a559039938..6b5520219b1 100644
--- a/common/bin/hadoop-config.sh
+++ b/common/bin/hadoop-config.sh
@@ -285,7 +285,7 @@ if [ -d "${HADOOP_HDFS_HOME}" ]; then
     CLASSPATH=${CLASSPATH}:$HADOOP_HDFS_HOME
   fi
   
-  if [ -d "${HADOOP_HDFS_HOME}/conf" ]; then
+  if [ ! -d "${HADOOP_CONF_DIR}" ] && [ -d "${HADOOP_HDFS_HOME}/conf" ]; then
     CLASSPATH=${CLASSPATH}:${HADOOP_HDFS_HOME}/conf
   fi
   
@@ -323,7 +323,7 @@ if [ -d "${HADOOP_MAPRED_HOME}" ]; then
     CLASSPATH=${CLASSPATH}:$HADOOP_MAPRED_HOME
   fi
 
-  if [ -d "${HADOOP_MAPRED_HOME}/conf" ]; then
+  if [ ! -d "${HADOOP_CONF_DIR}" ] && [ -d "${HADOOP_MAPRED_HOME}/conf" ]; then
     CLASSPATH=${CLASSPATH}:${HADOOP_MAPRED_HOME}/conf
   fi
   
