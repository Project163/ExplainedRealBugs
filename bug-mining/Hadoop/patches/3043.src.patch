diff --git a/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/ipc/TestRPC.java b/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/ipc/TestRPC.java
index 645432acdc5..4d650161a4a 100644
--- a/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/ipc/TestRPC.java
+++ b/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/ipc/TestRPC.java
@@ -702,6 +702,8 @@ public void testAuthorization() throws Exception {
 
     // Expect to succeed
     myConf.set(ACL_CONFIG, "*");
+    RPC.setProtocolEngine(myConf, TestRpcService.class, ProtobufRpcEngine2.class);
+
     doRPCs(myConf, false);
 
     // Reset authorization to expect failure
