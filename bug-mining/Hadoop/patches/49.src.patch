diff --git a/CHANGES.txt b/CHANGES.txt
index 879c6beec05..ec5b5ae4a28 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1142,6 +1142,9 @@ Release 0.21.0 - Unreleased
     HADOOP-6344. Fix rm and rmr immediately delete files rather than sending 
     to trash, if a user is over-quota. (Jakob Homan via suresh)
 
+    HADOOP-6347. run-test-core-fault-inject runs a test case twice if
+    -Dtestcase is set (cos)
+
 Release 0.20.2 - Unreleased
 
   NEW FEATURES
diff --git a/build.xml b/build.xml
index fb1a30a66ba..df6c944acf0 100644
--- a/build.xml
+++ b/build.xml
@@ -443,7 +443,8 @@
   <!-- Compile test code                                                  --> 
   <!-- ================================================================== -->
   <!-- This is a wrapper for fault-injection needs-->
-  <target name="compile-tests" depends="compile-core-test"/> 
+  <target name="-classes-compilation"
+    depends="compile-core-classes, compile-core-test"/> 
 
   <target name="compile-core-test" depends="compile-core-classes, ivy-retrieve-test, generate-test-records, generate-avro-records">
     <mkdir dir="${test.core.build.classes}"/>
@@ -573,10 +574,14 @@
       <isset property="testcase" />
     </and>
   </condition>
+  <condition property="tests.testcaseonly">
+    <istrue value="${special.fi.testcasesonly}" />
+  </condition>
   <condition property="tests.testcase.fi">
     <and>
       <istrue value="${test.fault.inject}" />
       <isset property="testcase" />
+      <isfalse value="${special.fi.testcasesonly}" />
     </and>
   </condition>
 	     
@@ -643,8 +648,7 @@
       </batchtest>
       <!--The following batch is for very special occasions only when
       a non-FI tests are needed to be executed against FI-environment -->
-      <batchtest todir="${test.build.dir}" if="special.fi.testcasesonly">
-        <fileset dir="${test.src.dir}/aop" includes="**/${testcase}.java"/>
+      <batchtest todir="${test.build.dir}" if="tests.testcaseonly">
         <fileset dir="${test.src.dir}/core" includes="**/${testcase}.java"/>
       </batchtest>
     </junit>
diff --git a/src/test/aop/build/aop.xml b/src/test/aop/build/aop.xml
index 8391bf0feee..050e78d5af8 100644
--- a/src/test/aop/build/aop.xml
+++ b/src/test/aop/build/aop.xml
@@ -31,8 +31,10 @@
   	Later on one can run 'ant jar-fault-inject' to create
   	Hadoop jar file with instrumented classes
   -->
-  <target name="compile-fault-inject" 
-  	depends="compile-core-classes, compile-tests">
+  <!-- Target -classes-compilation has to be defined in build.xml and
+  needs to depend on classes compilation and test classes compilation
+  targets. This is a poor man parametrization for targets -->
+  <target name="compile-fault-inject" depends="-classes-compilation" >
     <!-- AspectJ task definition -->
     <taskdef
       resource="org/aspectj/tools/ant/taskdefs/aspectjTaskdefs.properties">
