diff --git a/CHANGES.txt b/CHANGES.txt
index 942d5fe0469..68273bdaa3f 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -108,6 +108,9 @@ Trunk (unreleased changes)
     that Avro can read FileSystem data.
     (Aaron Kimball via cutting)
 
+    HADOOP-6495.  Identifier should be serialized after the password is
+     created In Token constructor (jnp via boryas)
+
   OPTIMIZATIONS
 
   BUG FIXES
diff --git a/src/java/org/apache/hadoop/security/token/SecretManager.java b/src/java/org/apache/hadoop/security/token/SecretManager.java
index 7517fe38579..e350211de7c 100644
--- a/src/java/org/apache/hadoop/security/token/SecretManager.java
+++ b/src/java/org/apache/hadoop/security/token/SecretManager.java
@@ -45,10 +45,11 @@ public InvalidToken(String msg) {
   
   /**
    * Create the password for the given identifier.
+   * identifier may be modified inside this method.
    * @param identifier the identifier to use
    * @return the new password
    */
-  public abstract byte[] createPassword(T identifier);
+  protected abstract byte[] createPassword(T identifier);
   
   /**
    * Retrieve the password for the given token identifier. Should check the date
diff --git a/src/java/org/apache/hadoop/security/token/Token.java b/src/java/org/apache/hadoop/security/token/Token.java
index 2fa1a93f8cf..743db4428ff 100644
--- a/src/java/org/apache/hadoop/security/token/Token.java
+++ b/src/java/org/apache/hadoop/security/token/Token.java
@@ -42,8 +42,8 @@ public class Token<T extends TokenIdentifier> implements Writable {
    * @param mgr the secret manager
    */
   public Token(T id, SecretManager<T> mgr) {
-    identifier = id.getBytes();
     password = mgr.createPassword(id);
+    identifier = id.getBytes();
     kind = id.getKind();
     service = new Text();
   }
