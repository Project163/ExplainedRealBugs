<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:43:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-9481] Broken conditional logic with HADOOP_SNAPPY_LIBRARY</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-9481</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;The problem is a regression introduced by recent fix &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-8562&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HADOOP-8562&lt;/a&gt; .&lt;br/&gt;
That fix makes some improvements for Windows platform, but breaks native code work on Unix.&lt;br/&gt;
Namely, let&apos;s see the diff &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-8562&quot; title=&quot;Enhancements to support Hadoop on Windows Server and Windows Azure environments&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-8562&quot;&gt;&lt;del&gt;HADOOP-8562&lt;/del&gt;&lt;/a&gt; of the file hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.c :  &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;--- hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.c
+++ hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.c
@@ -16,12 +16,18 @@
  * limitations under the License.
  */

-#include &amp;lt;dlfcn.h&amp;gt;
+
+#if defined HADOOP_SNAPPY_LIBRARY
+
 #include &amp;lt;stdio.h&amp;gt;
 #include &amp;lt;stdlib.h&amp;gt;
 #include &amp;lt;string.h&amp;gt;

+#ifdef UNIX
+#include &amp;lt;dlfcn.h&amp;gt;
 #include &quot;config.h&quot;
+#endif // UNIX
+
 #include &quot;org_apache_hadoop_io_compress_snappy.h&quot;
 #include &quot;org_apache_hadoop_io_compress_snappy_SnappyCompressor.h&quot;

@@ -81,7 +87,7 @@ JNIEXPORT jint JNICALL Java_org_apache_hadoop_io_compress_snappy_SnappyCompresso
   UNLOCK_CLASS(env, clazz, &quot;SnappyCompressor&quot;);

   if (uncompressed_bytes == 0) {
-    return 0;
+    return (jint)0;
   }

   // Get the output direct buffer
@@ -90,7 +96,7 @@ JNIEXPORT jint JNICALL Java_org_apache_hadoop_io_compress_snappy_SnappyCompresso
   UNLOCK_CLASS(env, clazz, &quot;SnappyCompressor&quot;);

   if (compressed_bytes == 0) {
-    return 0;
+    return (jint)0;
   }

   /* size_t should always be 4 bytes or larger. */
@@ -109,3 +115,5 @@ JNIEXPORT jint JNICALL Java_org_apache_hadoop_io_compress_snappy_SnappyCompresso
   (*env)-&amp;gt;SetIntField(env, thisj, SnappyCompressor_uncompressedDirectBufLen, 0);
   return (jint)buf_len;
 }
+
+#endif //define HADOOP_SNAPPY_LIBRARY
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here we see that all the class implementation got enclosed into &quot;if defined HADOOP_SNAPPY_LIBRARY&quot; directive, and the point is that &quot;HADOOP_SNAPPY_LIBRARY&quot; is &lt;b&gt;not&lt;/b&gt; defined. &lt;br/&gt;
This causes the class implementation to be effectively empty, what, in turn, causes the UnsatisfiedLinkError to be thrown in the runtime upon any attempt to invoke the native methods implemented there.&lt;br/&gt;
The actual intention of the authors of &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-8562&quot; title=&quot;Enhancements to support Hadoop on Windows Server and Windows Azure environments&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-8562&quot;&gt;&lt;del&gt;HADOOP-8562&lt;/del&gt;&lt;/a&gt; was (as we suppose) to invoke &quot;include config.h&quot;, where &quot;HADOOP_SNAPPY_LIBRARY&quot; is defined. But currently it is &lt;b&gt;not&lt;/b&gt; included because it resides &lt;b&gt;inside&lt;/b&gt; &quot;if defined HADOOP_SNAPPY_LIBRARY&quot; block.&lt;/p&gt;

&lt;p&gt;Similar situation with &quot;ifdef UNIX&quot;, because UNIX or WINDOWS variables are defined in &quot;org_apache_hadoop.h&quot;, which is indirectly included through &quot;include &quot;org_apache_hadoop_io_compress_snappy.h&quot;&quot;, and in the current code this is done &lt;b&gt;after&lt;/b&gt; code &quot;ifdef UNIX&quot;, so in the current code the block &quot;ifdef UNIX&quot; is &lt;b&gt;not&lt;/b&gt; executed on UNIX.&lt;/p&gt;

&lt;p&gt;The suggested patch fixes the described problems by reordering the &quot;include&quot; and &quot;if&quot; preprocessor directives accordingly, bringing the methods of class org.apache.hadoop.io.compress.snappy.SnappyCompressor back to work again.&lt;/p&gt;

&lt;p&gt;Of course, Snappy native libraries must be installed to build and invoke snappy native methods.&lt;/p&gt;

&lt;p&gt;(Note: there was a mistype in commit message: 8952 written in place of 8562: &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-8952&quot; title=&quot;Command-line option to see replicated size of a file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-8952&quot;&gt;HADOOP-8952&lt;/a&gt;. Enhancements to support Hadoop on Windows Server and Windows Azure environments. Contributed by Ivan Mitic, Chuan Liu, Ramya Sunil, Bikas Saha, Kanna Karanam, John Gordon, Brandon Li, Chris Nauroth, David Lao, Sumadhur Reddy Bolli, Arpit Agarwal, Ahmed El Baz, Mike Liddell, Jing Zhao, Thejas Nair, Steve Maine, Ganeshan Iyer, Raja Aluri, Giridharan Kesavan, Ramya Bharathi Nimmagadda.&lt;br/&gt;
   git-svn-id: &lt;a href=&quot;https://svn.apache.org/repos/asf/hadoop/common/trunk@1453486&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/asf/hadoop/common/trunk@1453486&lt;/a&gt; 13f79535-47bb-0310-9956-ffa450edef68&lt;br/&gt;
)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12642922">HADOOP-9481</key>
            <summary>Broken conditional logic with HADOOP_SNAPPY_LIBRARY</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vbondarev">Vadim Bondarev</assignee>
                                    <reporter username="vbondarev">Vadim Bondarev</reporter>
                        <labels>
                    </labels>
                <created>Wed, 17 Apr 2013 13:07:39 +0000</created>
                <updated>Thu, 12 May 2016 18:23:17 +0000</updated>
                            <resolved>Fri, 10 May 2013 21:18:22 +0000</resolved>
                                    <version>2.1.0-beta</version>
                    <version>3.0.0-alpha1</version>
                                    <fixVersion>2.1.0-beta</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>12</watches>
                                                                                                                <comments>
                            <comment id="13634039" author="vbondarev" created="Wed, 17 Apr 2013 13:56:23 +0000"  >&lt;p&gt;Since commit 102f2e3ea007f8cda041f9df7358098482e5f3e2 in classes SnappyCompressor.c/SnappyDecompressor.c was added includes and conditional logic (if defined),&lt;br/&gt;
But his order make classes (SnappyCompressor/SnappyDecompressor) with empty body after compilation in so file.&lt;br/&gt;
This easy to prove with this test method:&lt;/p&gt;

&lt;p&gt;SnappyCompressor compressor = new SnappyCompressor();&lt;br/&gt;
compressor.compress(compressed, 0, compressed.length);&lt;/p&gt;

&lt;p&gt;Call method compress() was fail with java.lang.UnsatisfiedLinkError: org.apache.hadoop.io.compress.snappy.SnappyCompressor.compressBytesDirect()I&lt;/p&gt;
</comment>
                            <comment id="13634044" author="vbondarev" created="Wed, 17 Apr 2013 14:01:07 +0000"  >&lt;p&gt;Its has affected on patch &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9225&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HADOOP-9225&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13634096" author="hadoopqa" created="Wed, 17 Apr 2013 14:46:44 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12579129/HADOOP-9481-trunk--N1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12579129/HADOOP-9481-trunk--N1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-common-project/hadoop-common.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/2452//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/2452//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/2452//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/2452//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13635523" author="cmccabe" created="Thu, 18 Apr 2013 18:52:24 +0000"  >&lt;p&gt;I don&apos;t understand what problem is being fixed here, even after looking at the patch.  Can you add a description?&lt;/p&gt;

&lt;p&gt;Also, have you installed snappy locally?  If you have not, compiling without snappy is the correct course of action, and not a problem.&lt;/p&gt;</comment>
                            <comment id="13636310" author="iveselovsky" created="Fri, 19 Apr 2013 12:07:37 +0000"  >&lt;p&gt;The patch verification complains about not added/changed tests. We don&apos;t add tests there in this patch since comprehensive tests for Snappy are suggested in another patch: &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9225&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HADOOP-9225&lt;/a&gt; .  So, these 2 fixes can be reviewed and applied together.&lt;/p&gt;</comment>
                            <comment id="13636542" author="cnauroth" created="Fri, 19 Apr 2013 16:18:03 +0000"  >&lt;p&gt;Hi, Vadim.  I thought cmake was taking care of defining HADOOP_SNAPPY_LIBRARY when building with Snappy.  (See src/CMakeLists.txt and src/config.h.cmake.)  I&apos;m curious if the cmake piece is somehow not working correctly for your builds.&lt;/p&gt;</comment>
                            <comment id="13636596" author="iveselovsky" created="Fri, 19 Apr 2013 16:58:00 +0000"  >&lt;p&gt;Hi, Chris, &lt;br/&gt;
what version of cmake do you use? We use cmake 2.8.8.&lt;/p&gt;</comment>
                            <comment id="13636607" author="iveselovsky" created="Fri, 19 Apr 2013 17:05:48 +0000"  >&lt;p&gt;In our experiments &quot;config.h&quot; is generated by cmake and its content is okay.&lt;br/&gt;
The problem is that &quot;config.h&quot; is not included into &quot;hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.c&quot; because &quot;if defined HADOOP_SNAPPY_LIBRARY&quot; condition is false (see desription).&lt;/p&gt;</comment>
                            <comment id="13637457" author="cnauroth" created="Sun, 21 Apr 2013 03:08:43 +0000"  >&lt;p&gt;Ivan, thank you for the further explanation.  I understand the problem now.&lt;/p&gt;

&lt;p&gt;I think a simpler fix would be to add &lt;tt&gt;#include &quot;org_apache_hadoop.h&quot;&lt;/tt&gt; as the first line of SnappyCompressor.c and SnappyDecompressor.c.  Can you check if that would work?&lt;/p&gt;

&lt;p&gt;Right now, this gets included transitively through &lt;tt&gt;#include &quot;org_apache_hadoop_io_compress_snappy.h&quot;&lt;/tt&gt;, but that&apos;s too late.  Including it explicitly as the first line would guarantee that &lt;tt&gt;UNIX&lt;/tt&gt; or &lt;tt&gt;WINDOWS&lt;/tt&gt; gets defined before any other header or code processing.  This also would guarantee that config.h gets included for &lt;tt&gt;UNIX&lt;/tt&gt;, and therefore &lt;tt&gt;HADOOP_SNAPPY_LIBRARY&lt;/tt&gt; would be defined.  This is the same approach used in NativeIO.c.&lt;/p&gt;

&lt;p&gt;In general, both the .h and .c files are structured such that they expect &lt;tt&gt;UNIX&lt;/tt&gt;, &lt;tt&gt;WINDOWS&lt;/tt&gt;, &lt;tt&gt;HADOOP_SNAPPY_LIBRARY&lt;/tt&gt;, and other build configuration dependencies to be defined before the preprocessor handles anything else.  Therefore, I think it&apos;s best that we always &lt;tt&gt;#include &quot;org_apache_hadoop.h&quot;&lt;/tt&gt; as the first line in any file.&lt;/p&gt;

&lt;p&gt;BTW, I have build environments for both Linux and Windows ready to go, so I can volunteer to test the patch cross-platform after we resolve this feedback.  I don&apos;t have any test jobs ready to go that use Snappy, so I can&apos;t fully verify that, but I assume you already tested that part before submitting the patch.&lt;/p&gt;

&lt;p&gt;Thank you for addressing this!&lt;/p&gt;</comment>
                            <comment id="13637844" author="vbondarev" created="Mon, 22 Apr 2013 08:53:48 +0000"  >&lt;p&gt;Chris, yes it&apos;s looks simpler. I add #include &quot;org_apache_hadoop.h&quot; as the first line of SnappyCompressor.c/SnappyDecompressor.c. and check for work. &lt;br/&gt;
Test methods in TestSnappyCompressorDecompressor was passed. New version patch in attachments.&lt;/p&gt;</comment>
                            <comment id="13637846" author="vbondarev" created="Mon, 22 Apr 2013 08:58:40 +0000"  >&lt;p&gt;TestSnappyCompressorDecompressor it&apos;s a class from &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9225&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HADOOP-9225&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13637863" author="hadoopqa" created="Mon, 22 Apr 2013 09:26:49 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12579801/HADOOP-9481-trunk--N4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12579801/HADOOP-9481-trunk--N4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-common-project/hadoop-common.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/2465//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/2465//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/2465//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/2465//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13638214" author="cnauroth" created="Mon, 22 Apr 2013 17:45:12 +0000"  >&lt;p&gt;+1 for the patch.  (Including org_apache_hadoop_io_compress_snappy.h first transitively includes org_apache_hadoop.h first, so it has the same effect as my earlier suggestion.)  I verified successful builds on Ubuntu and Windows.  Thank you for the pointer to the new test on &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9225&quot; title=&quot;Cover package org.apache.hadoop.compress.Snappy&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9225&quot;&gt;&lt;del&gt;HADOOP-9225&lt;/del&gt;&lt;/a&gt;.  I ran that successfully on the Ubuntu machine.&lt;/p&gt;

&lt;p&gt;Thank you, Vadim!&lt;/p&gt;</comment>
                            <comment id="13639383" author="cmccabe" created="Tue, 23 Apr 2013 18:46:14 +0000"  >&lt;p&gt;thanks for the explanation.  I would prefer that you explicitly include config.h prior to doing the test for &lt;tt&gt;HADOOP_SNAPPY_LIBRARY&lt;/tt&gt;, rather than relying on a chain of includes.  aside from that, looks good to me.&lt;/p&gt;</comment>
                            <comment id="13640300" author="vbondarev" created="Wed, 24 Apr 2013 09:52:51 +0000"  >&lt;p&gt;First patch version do explicitly include config.h prior to doing the test for HADOOP_SNAPPY_LIBRARY, you can use it more preferable&lt;/p&gt;</comment>
                            <comment id="13654848" author="atm" created="Fri, 10 May 2013 21:15:19 +0000"  >&lt;p&gt;Colin told me offline that he doesn&apos;t mind the way the current patch is re: the chain of includes.&lt;/p&gt;

&lt;p&gt;+1, the latest patch looks good to me. I confirmed that this fixes the Hadoop snappy build on my box.&lt;/p&gt;

&lt;p&gt;I&apos;m going to commit this momentarily.&lt;/p&gt;</comment>
                            <comment id="13654851" author="atm" created="Fri, 10 May 2013 21:18:22 +0000"  >&lt;p&gt;I&apos;ve just committed this to trunk. Thanks a lot for the contribution, Vadim, and thanks also to Colin for the reviews.&lt;/p&gt;</comment>
                            <comment id="13654853" author="atm" created="Fri, 10 May 2013 21:18:46 +0000"  >&lt;p&gt;(Whoops, thanks also to Chris for the review as well.)&lt;/p&gt;</comment>
                            <comment id="13654861" author="hudson" created="Fri, 10 May 2013 21:25:10 +0000"  >&lt;p&gt;Integrated in Hadoop-trunk-Commit #3740 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-trunk-Commit/3740/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-trunk-Commit/3740/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9481&quot; title=&quot;Broken conditional logic with HADOOP_SNAPPY_LIBRARY&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9481&quot;&gt;&lt;del&gt;HADOOP-9481&lt;/del&gt;&lt;/a&gt;. Broken conditional logic with HADOOP_SNAPPY_LIBRARY. Contributed by Vadim Bondarev. (Revision 1481191)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
atm : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1481191&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1481191&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.c&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/io/compress/snappy/SnappyDecompressor.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13655224" author="hudson" created="Sat, 11 May 2013 10:49:16 +0000"  >&lt;p&gt;Integrated in Hadoop-Yarn-trunk #206 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Yarn-trunk/206/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Yarn-trunk/206/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9481&quot; title=&quot;Broken conditional logic with HADOOP_SNAPPY_LIBRARY&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9481&quot;&gt;&lt;del&gt;HADOOP-9481&lt;/del&gt;&lt;/a&gt;. Broken conditional logic with HADOOP_SNAPPY_LIBRARY. Contributed by Vadim Bondarev. (Revision 1481191)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
atm : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1481191&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1481191&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.c&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/io/compress/snappy/SnappyDecompressor.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13655253" author="hudson" created="Sat, 11 May 2013 13:12:09 +0000"  >&lt;p&gt;Integrated in Hadoop-Hdfs-trunk #1395 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1395/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1395/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9481&quot; title=&quot;Broken conditional logic with HADOOP_SNAPPY_LIBRARY&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9481&quot;&gt;&lt;del&gt;HADOOP-9481&lt;/del&gt;&lt;/a&gt;. Broken conditional logic with HADOOP_SNAPPY_LIBRARY. Contributed by Vadim Bondarev. (Revision 1481191)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
atm : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1481191&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1481191&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.c&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/io/compress/snappy/SnappyDecompressor.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13655281" author="hudson" created="Sat, 11 May 2013 14:06:21 +0000"  >&lt;p&gt;Integrated in Hadoop-Mapreduce-trunk #1422 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1422/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1422/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9481&quot; title=&quot;Broken conditional logic with HADOOP_SNAPPY_LIBRARY&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9481&quot;&gt;&lt;del&gt;HADOOP-9481&lt;/del&gt;&lt;/a&gt;. Broken conditional logic with HADOOP_SNAPPY_LIBRARY. Contributed by Vadim Bondarev. (Revision 1481191)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
atm : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1481191&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1481191&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.c&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/io/compress/snappy/SnappyDecompressor.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13673897" author="hudson" created="Tue, 4 Jun 2013 01:11:15 +0000"  >&lt;p&gt;Integrated in Hadoop-trunk-Commit #3851 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-trunk-Commit/3851/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-trunk-Commit/3851/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9481&quot; title=&quot;Broken conditional logic with HADOOP_SNAPPY_LIBRARY&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9481&quot;&gt;&lt;del&gt;HADOOP-9481&lt;/del&gt;&lt;/a&gt;. Move from trunk to release 2.1.0 section (Revision 1489261)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
suresh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1489261&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1489261&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13674242" author="hudson" created="Tue, 4 Jun 2013 10:50:24 +0000"  >&lt;p&gt;Integrated in Hadoop-Yarn-trunk #230 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Yarn-trunk/230/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Yarn-trunk/230/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9481&quot; title=&quot;Broken conditional logic with HADOOP_SNAPPY_LIBRARY&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9481&quot;&gt;&lt;del&gt;HADOOP-9481&lt;/del&gt;&lt;/a&gt;. Move from trunk to release 2.1.0 section (Revision 1489261)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
suresh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1489261&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1489261&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13674333" author="hudson" created="Tue, 4 Jun 2013 13:03:27 +0000"  >&lt;p&gt;Integrated in Hadoop-Hdfs-trunk #1420 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1420/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1420/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9481&quot; title=&quot;Broken conditional logic with HADOOP_SNAPPY_LIBRARY&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9481&quot;&gt;&lt;del&gt;HADOOP-9481&lt;/del&gt;&lt;/a&gt;. Move from trunk to release 2.1.0 section (Revision 1489261)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
suresh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1489261&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1489261&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13674401" author="hudson" created="Tue, 4 Jun 2013 14:06:28 +0000"  >&lt;p&gt;Integrated in Hadoop-Mapreduce-trunk #1446 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1446/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1446/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9481&quot; title=&quot;Broken conditional logic with HADOOP_SNAPPY_LIBRARY&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9481&quot;&gt;&lt;del&gt;HADOOP-9481&lt;/del&gt;&lt;/a&gt;. Move from trunk to release 2.1.0 section (Revision 1489261)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
suresh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1489261&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1489261&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12597618">HADOOP-8562</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12579129" name="HADOOP-9481-trunk--N1.patch" size="1894" author="vbondarev" created="Wed, 17 Apr 2013 14:09:53 +0000"/>
                            <attachment id="12579801" name="HADOOP-9481-trunk--N4.patch" size="1790" author="vbondarev" created="Mon, 22 Apr 2013 08:47:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>323332</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 25 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1js9z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>323677</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>