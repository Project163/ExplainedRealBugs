<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:47:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-11604] Prevent ConcurrentModificationException while closing domain sockets during shutdown of DomainSocketWatcher thread.</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-11604</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;Our product cluster hit the Xceiver limit even w/ &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-10404&quot; title=&quot;Some accesses to DomainSocketWatcher#closed are not protected by lock&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-10404&quot;&gt;&lt;del&gt;HADOOP-10404&lt;/del&gt;&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-11333&quot; title=&quot;Fix deadlock in DomainSocketWatcher when the notification pipe is full&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-11333&quot;&gt;&lt;del&gt;HADOOP-11333&lt;/del&gt;&lt;/a&gt;, i found it was caused by DomainSocketWatcher.watcherThread gone. Attached is a possible fix, please review, thanks&lt;/p&gt;</description>
                <environment></environment>
        <key id="12775344">HADOOP-11604</key>
            <summary>Prevent ConcurrentModificationException while closing domain sockets during shutdown of DomainSocketWatcher thread.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cnauroth">Chris Nauroth</assignee>
                                    <reporter username="xieliang007">Liang Xie</reporter>
                        <labels>
                            <label>2.6.1-candidate</label>
                    </labels>
                <created>Mon, 16 Feb 2015 11:49:37 +0000</created>
                <updated>Tue, 30 Aug 2016 01:31:00 +0000</updated>
                            <resolved>Fri, 20 Feb 2015 21:12:12 +0000</resolved>
                                    <version>2.6.0</version>
                                    <fixVersion>2.6.1</fixVersion>
                    <fixVersion>2.7.0</fixVersion>
                    <fixVersion>3.0.0-alpha1</fixVersion>
                                    <component>net</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="14322696" author="hadoopqa" created="Mon, 16 Feb 2015 12:15:14 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12699082/HADOOP-11604-001.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12699082/HADOOP-11604-001.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision ab0b958.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;&lt;/font&gt;-1 javac&lt;font color=&quot;red&quot;&gt;&lt;/font&gt;.  The patch appears to cause the build to fail.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5713//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5713//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14323949" author="ozawa" created="Tue, 17 Feb 2015 08:56:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xieliang007&quot; class=&quot;user-hover&quot; rel=&quot;xieliang007&quot;&gt;xieliang007&lt;/a&gt; thank you for taking this JIRA.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;          &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(100);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There is a unhandled exception here. Could you fix it?&lt;/p&gt;</comment>
                            <comment id="14324218" author="xieliang007" created="Tue, 17 Feb 2015 14:16:49 +0000"  >&lt;p&gt;Thanks for review, uploaded a new patch to address comment.&lt;br/&gt;
xceiver reached the upper limit because no thread to signal processedCond after the watcherThread die. then all xceiver threads hung always at processedCond.await&lt;/p&gt;</comment>
                            <comment id="14324320" author="hadoopqa" created="Tue, 17 Feb 2015 15:34:44 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12699264/HADOOP-11604-002.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12699264/HADOOP-11604-002.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision 2f0f756.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  There were no new javadoc warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests in hadoop-common-project/hadoop-common:&lt;/p&gt;

&lt;p&gt;                  org.apache.hadoop.net.unix.TestDomainSocketWatcher&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5722//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5722//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5722//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5722//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14324657" author="cmccabe" created="Tue, 17 Feb 2015 18:46:22 +0000"  >&lt;p&gt;This isn&apos;t quite right.  If the DSW thread terminated unexpectedly, sockets will be leaked permanently.&lt;/p&gt;

&lt;p&gt;We should figure out why the DSW thread is terminating and fix that.  Do you have any information about this?&lt;/p&gt;</comment>
                            <comment id="14326242" author="cnauroth" created="Wed, 18 Feb 2015 17:38:38 +0000"  >&lt;p&gt;I may have also seen this thread exit prematurely, even after the recent fixes.  I don&apos;t have complete information though, so I can&apos;t say for sure.&lt;/p&gt;

&lt;p&gt;One potential problem is that the thread does not explicitly handle logging for unchecked exceptions, thrown either from the try body or the finally body.  Without an uncaught exception handler, the default behavior would be to log the stack trace to the console, which is likely getting redirected to a .out file instead of the normal DataNode daemon log.  An operator might not think to check the .out log.  Liang, do you still have a .out file from this incident?  If not, then a good first step might be to patch the logging so that we either set an uncaught exception handler to do the logging, or just catch and log &lt;tt&gt;Throwable&lt;/tt&gt; explicitly.&lt;/p&gt;

&lt;p&gt;I agree that we need to find root cause before attempting a fix.&lt;/p&gt;</comment>
                            <comment id="14326933" author="cmccabe" created="Thu, 19 Feb 2015 02:59:29 +0000"  >&lt;p&gt;Catching &lt;tt&gt;Throwable&lt;/tt&gt; and logging it would be nice.&lt;/p&gt;</comment>
                            <comment id="14327005" author="xieliang007" created="Thu, 19 Feb 2015 05:12:28 +0000"  >&lt;p&gt;Thanks for all the valuable comments. After checking the out file, i saw the ConcurrentModificationException be thrown at inside the finally block:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Entry entry : entries.values()) {      &amp;lt;&amp;lt;&amp;lt;&amp;lt; HERE
          sendCallback(&lt;span class=&quot;code-quote&quot;&gt;&quot;close&quot;&lt;/span&gt;, entries, fdSet, entry.getDomainSocket().fd);
        }
        entries.clear();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the log is sth like:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-25&quot;&lt;/span&gt; java.util.ConcurrentModificationException
        at java.util.TreeMap$PrivateEntryIterator.nextEntry(TreeMap.java:1100)
        at java.util.TreeMap$ValueIterator.next(TreeMap.java:1145)
        at org.apache.hadoop.net.unix.DomainSocketWatcher$1.run(DomainSocketWatcher.java:484)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:662)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;so the root cause in our case should be the non thread-safe pattern: foreach &lt;/p&gt;
{treemap.remove}
&lt;p&gt;.&lt;/p&gt;</comment>
                            <comment id="14327930" author="cnauroth" created="Thu, 19 Feb 2015 18:43:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xieliang007&quot; class=&quot;user-hover&quot; rel=&quot;xieliang007&quot;&gt;xieliang007&lt;/a&gt;, thanks for looking into the .out file and sharing the stack trace.  This makes sense now.&lt;/p&gt;

&lt;p&gt;I&apos;m attaching a patch that avoids mutating the &lt;tt&gt;TreeMap&lt;/tt&gt; during the iteration in the &lt;tt&gt;finally&lt;/tt&gt; block.  It&apos;s not important to remove as we iterate, because after the loop, we &lt;tt&gt;clear&lt;/tt&gt; the whole map anyway and let it drop out of scope.  I don&apos;t have a unit test for this.  I still need to look into whether or not that&apos;s feasible.  My intuition is that it won&apos;t be possible to repro the problem reliably in a unit test, because throwing &lt;tt&gt;ConcurrentModificationException&lt;/tt&gt; is a best-effort check, not a guarantee.&lt;/p&gt;

&lt;p&gt;For the logging problem, I decided to go with the approach of setting an uncaught exception handler.  The &lt;tt&gt;run&lt;/tt&gt; method is already very deeply nested, and I think wrapping the whole thing in another try-catch for logging &lt;tt&gt;Throwable&lt;/tt&gt; would hurt readability.&lt;/p&gt;

&lt;p&gt;Liang, I hope I&apos;m not intruding by posting a patch on an issue assigned to you.  I basically had to write this patch though while researching, so I&apos;d rather share it than toss the work away.  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14328012" author="hadoopqa" created="Thu, 19 Feb 2015 19:45:37 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12699717/HADOOP-11604.003.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12699717/HADOOP-11604.003.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision f0f2992.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  There were no new javadoc warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-common-project/hadoop-common.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5744//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5744//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5744//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5744//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14328835" author="xieliang007" created="Fri, 20 Feb 2015 11:39:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cnauroth&quot; class=&quot;user-hover&quot; rel=&quot;cnauroth&quot;&gt;cnauroth&lt;/a&gt;, np&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; i am happy to see this issue is clear and will be resolve soon and feel free to assign it to you. i am taking a vacation and just skim through the latest patch and lgtm so far. All guys, Happy Spring Festival!&lt;/p&gt;</comment>
                            <comment id="14329413" author="cnauroth" created="Fri, 20 Feb 2015 19:35:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xieliang007&quot; class=&quot;user-hover&quot; rel=&quot;xieliang007&quot;&gt;xieliang007&lt;/a&gt;, Happy Spring Festival to you too!  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I&apos;m attaching patch v004.  This adds a test, which was a bit tricky to write.  It was pretty easy to force the &lt;tt&gt;ConcurrentModificationException&lt;/tt&gt;.  I&apos;ve added &lt;tt&gt;testCloseSocketOnWatcherClose&lt;/tt&gt; to do this.  However, the exception gets thrown on a separate thread from JUnit&apos;s execution, so it wouldn&apos;t actually cause the test to fail.  I&apos;ve modified the test suite so that for every test, we track whether or not the thread terminated with an unexpected exception.  The new test fails without my changes in &lt;tt&gt;DomainSocketWatcher&lt;/tt&gt;, and then it passes after I apply the fix.&lt;/p&gt;

&lt;p&gt;It occurs to me that we still probably don&apos;t know the real root cause of what happened in Liang&apos;s cluster.  Why did the thread exit prematurely?  This &lt;tt&gt;ConcurrentModificationException&lt;/tt&gt; thrown from the &lt;tt&gt;finally&lt;/tt&gt; block would have masked any exception thrown from the &lt;tt&gt;try&lt;/tt&gt; body.  Probably the best we can do at this point is to get in this fix, and then watch for additional reports of the problem afterwards.&lt;/p&gt;</comment>
                            <comment id="14329510" author="hadoopqa" created="Fri, 20 Feb 2015 20:35:32 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12699918/HADOOP-11604.004.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12699918/HADOOP-11604.004.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision ce5bf92.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 1 new or modified test files.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  There were no new javadoc warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-common-project/hadoop-common.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5749//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5749//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5749//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5749//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14329516" author="cmccabe" created="Fri, 20 Feb 2015 20:36:15 +0000"  >&lt;p&gt;Thanks, guys.  I am +1 on &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cnauroth&quot; class=&quot;user-hover&quot; rel=&quot;cnauroth&quot;&gt;cnauroth&lt;/a&gt;&apos;s patch 004.  I think it is a good improvement.&lt;/p&gt;

&lt;p&gt;I agree that it does not fix the root cause, here, though.  We still don&apos;t know why the thread exited.  However, this is a good step forward that will hopefully allow us to get more information later if necessary, as Chris commented.&lt;/p&gt;</comment>
                            <comment id="14329551" author="cnauroth" created="Fri, 20 Feb 2015 21:05:53 +0000"  >&lt;p&gt;Thanks for the review, Colin.  I&apos;m updating the title to state more accurately that this fixes one particular bug, perhaps different from the original reported issue&apos;s root cause.&lt;/p&gt;</comment>
                            <comment id="14329562" author="cnauroth" created="Fri, 20 Feb 2015 21:12:12 +0000"  >&lt;p&gt;I have committed this to trunk and branch-2.  Liang, thank you for the bug report.  Colin, thanks again for the code review.&lt;/p&gt;</comment>
                            <comment id="14329575" author="hudson" created="Fri, 20 Feb 2015 21:22:53 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-trunk-Commit #7168 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-trunk-Commit/7168/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-trunk-Commit/7168/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-11604&quot; title=&quot;Prevent ConcurrentModificationException while closing domain sockets during shutdown of DomainSocketWatcher thread.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-11604&quot;&gt;&lt;del&gt;HADOOP-11604&lt;/del&gt;&lt;/a&gt;. Prevent ConcurrentModificationException while closing domain sockets during shutdown of DomainSocketWatcher thread. Contributed by Chris Nauroth. (cnauroth: rev 3c5ff0759c4f4e10c97c6d9036add00edb8be2b5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/net/unix/DomainSocketWatcher.java&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/net/unix/TestDomainSocketWatcher.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14330157" author="hudson" created="Sat, 21 Feb 2015 11:42:50 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Yarn-trunk-Java8 #111 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Yarn-trunk-Java8/111/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Yarn-trunk-Java8/111/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-11604&quot; title=&quot;Prevent ConcurrentModificationException while closing domain sockets during shutdown of DomainSocketWatcher thread.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-11604&quot;&gt;&lt;del&gt;HADOOP-11604&lt;/del&gt;&lt;/a&gt;. Prevent ConcurrentModificationException while closing domain sockets during shutdown of DomainSocketWatcher thread. Contributed by Chris Nauroth. (cnauroth: rev 3c5ff0759c4f4e10c97c6d9036add00edb8be2b5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/net/unix/DomainSocketWatcher.java&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/net/unix/TestDomainSocketWatcher.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14330189" author="hudson" created="Sat, 21 Feb 2015 12:19:55 +0000"  >&lt;p&gt;SUCCESS: Integrated in Hadoop-Yarn-trunk #845 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Yarn-trunk/845/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Yarn-trunk/845/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-11604&quot; title=&quot;Prevent ConcurrentModificationException while closing domain sockets during shutdown of DomainSocketWatcher thread.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-11604&quot;&gt;&lt;del&gt;HADOOP-11604&lt;/del&gt;&lt;/a&gt;. Prevent ConcurrentModificationException while closing domain sockets during shutdown of DomainSocketWatcher thread. Contributed by Chris Nauroth. (cnauroth: rev 3c5ff0759c4f4e10c97c6d9036add00edb8be2b5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/net/unix/TestDomainSocketWatcher.java&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/net/unix/DomainSocketWatcher.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14330297" author="hudson" created="Sat, 21 Feb 2015 15:34:11 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Hdfs-trunk #2043 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-trunk/2043/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-trunk/2043/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-11604&quot; title=&quot;Prevent ConcurrentModificationException while closing domain sockets during shutdown of DomainSocketWatcher thread.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-11604&quot;&gt;&lt;del&gt;HADOOP-11604&lt;/del&gt;&lt;/a&gt;. Prevent ConcurrentModificationException while closing domain sockets during shutdown of DomainSocketWatcher thread. Contributed by Chris Nauroth. (cnauroth: rev 3c5ff0759c4f4e10c97c6d9036add00edb8be2b5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/net/unix/TestDomainSocketWatcher.java&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/net/unix/DomainSocketWatcher.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14330318" author="hudson" created="Sat, 21 Feb 2015 15:51:54 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Hdfs-trunk-Java8 #102 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-trunk-Java8/102/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-trunk-Java8/102/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-11604&quot; title=&quot;Prevent ConcurrentModificationException while closing domain sockets during shutdown of DomainSocketWatcher thread.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-11604&quot;&gt;&lt;del&gt;HADOOP-11604&lt;/del&gt;&lt;/a&gt;. Prevent ConcurrentModificationException while closing domain sockets during shutdown of DomainSocketWatcher thread. Contributed by Chris Nauroth. (cnauroth: rev 3c5ff0759c4f4e10c97c6d9036add00edb8be2b5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/net/unix/DomainSocketWatcher.java&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/net/unix/TestDomainSocketWatcher.java&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14332205" author="hudson" created="Sun, 22 Feb 2015 14:58:20 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Mapreduce-trunk-Java8 #112 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Java8/112/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Java8/112/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-11604&quot; title=&quot;Prevent ConcurrentModificationException while closing domain sockets during shutdown of DomainSocketWatcher thread.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-11604&quot;&gt;&lt;del&gt;HADOOP-11604&lt;/del&gt;&lt;/a&gt;. Prevent ConcurrentModificationException while closing domain sockets during shutdown of DomainSocketWatcher thread. Contributed by Chris Nauroth. (cnauroth: rev 3c5ff0759c4f4e10c97c6d9036add00edb8be2b5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/net/unix/DomainSocketWatcher.java&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/net/unix/TestDomainSocketWatcher.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14332233" author="hudson" created="Sun, 22 Feb 2015 15:25:41 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Mapreduce-trunk #2062 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/2062/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/2062/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-11604&quot; title=&quot;Prevent ConcurrentModificationException while closing domain sockets during shutdown of DomainSocketWatcher thread.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-11604&quot;&gt;&lt;del&gt;HADOOP-11604&lt;/del&gt;&lt;/a&gt;. Prevent ConcurrentModificationException while closing domain sockets during shutdown of DomainSocketWatcher thread. Contributed by Chris Nauroth. (cnauroth: rev 3c5ff0759c4f4e10c97c6d9036add00edb8be2b5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/net/unix/DomainSocketWatcher.java&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/net/unix/TestDomainSocketWatcher.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14334275" author="cmccabe" created="Tue, 24 Feb 2015 02:24:36 +0000"  >&lt;p&gt;thanks, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cnauroth&quot; class=&quot;user-hover&quot; rel=&quot;cnauroth&quot;&gt;cnauroth&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14725827" author="vinodkv" created="Tue, 1 Sep 2015 18:14:28 +0000"  >&lt;p&gt;Pulled this into 2.6.1 after &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ajisakaa&quot; class=&quot;user-hover&quot; rel=&quot;ajisakaa&quot;&gt;ajisakaa&lt;/a&gt; verified that the patch applies cleanly. Ran compilation and TestDomainSocketWatcher before the push.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12775343">HDFS-7802</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12757325">HADOOP-11333</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12700885">HADOOP-10404</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12699082" name="HADOOP-11604-001.txt" size="1089" author="xieliang007" created="Mon, 16 Feb 2015 11:51:03 +0000"/>
                            <attachment id="12699264" name="HADOOP-11604-002.txt" size="2069" author="xieliang007" created="Tue, 17 Feb 2015 14:16:49 +0000"/>
                            <attachment id="12699717" name="HADOOP-11604.003.patch" size="3658" author="cnauroth" created="Thu, 19 Feb 2015 18:43:55 +0000"/>
                            <attachment id="12699918" name="HADOOP-11604.004.patch" size="8890" author="cnauroth" created="Fri, 20 Feb 2015 19:35:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 12 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i25obj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12327583">2.7.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>