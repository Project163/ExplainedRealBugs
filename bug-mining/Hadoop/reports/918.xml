<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:43:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-9707] Fix register lists for crc32c inline assembly</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-9707</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;The inline assembly used for the crc32 instructions has an incorrect clobber list: the computed CRC values are &quot;in-out&quot; variables and thus need to use the &quot;matching constraint&quot; syntax in the clobber list.&lt;/p&gt;

&lt;p&gt;This doesn&apos;t seem to cause a problem now in Hadoop, but may break in a different compiler version which allocates registers differently, or may break when the same code is used in another context.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12656639">HADOOP-9707</key>
            <summary>Fix register lists for crc32c inline assembly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tlipcon">Todd Lipcon</assignee>
                                    <reporter username="tlipcon">Todd Lipcon</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Jul 2013 17:46:54 +0000</created>
                <updated>Thu, 12 May 2016 18:27:29 +0000</updated>
                            <resolved>Mon, 15 Jul 2013 18:20:14 +0000</resolved>
                                    <version>2.1.0-beta</version>
                    <version>3.0.0-alpha1</version>
                                    <fixVersion>2.1.0-beta</fixVersion>
                                    <component>util</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13702236" author="hadoopqa" created="Mon, 8 Jul 2013 18:26:55 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12591237/hadoop-9707.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12591237/hadoop-9707.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-common-project/hadoop-common.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/2749//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/2749//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/2749//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/2749//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13702563" author="kihwal" created="Mon, 8 Jul 2013 22:46:51 +0000"  >&lt;p&gt;The clobber lists are actually okay. Your change is to the templates. It affects register allocation, but not in this case because of the nature of the instruction. I don&apos;t think it has anything to do with correctness.  At the RTL-level and in the binary, I see the two pieces of generated code are identical, but there are extra information in RTL.  If code was written in a way that the link between source and assembly code is confusing, this can be helpful. But it still does not affect the actual code being executed.&lt;/p&gt;

&lt;p&gt;Without turning the compiler optimization on, the input and output variables are copied in and out inside the loop, which starves the pipeline. Even in this case, all outputs are copied out because the template specifies all of them.&lt;/p&gt;

&lt;p&gt;The patch is okay. I am curious whether you have seen any cases in which it breaks.&lt;/p&gt;</comment>
                            <comment id="13702872" author="tlipcon" created="Tue, 9 Jul 2013 04:06:03 +0000"  >&lt;p&gt;Hey Kihwal. We did see a case where this code was put into another project and it caused problems. It was a few months ago, and now I can&apos;t remember whether the issue was incorrect results or some kind of crash. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bockelman&quot; class=&quot;user-hover&quot; rel=&quot;bockelman&quot;&gt;bockelman&lt;/a&gt; also mentioned this to me, that he&apos;d lifted this code into another program and ran into an issue where the results for &apos;crc1&apos; ended up writing over &apos;crc2&apos;.&lt;/p&gt;</comment>
                            <comment id="13704135" author="bockelman" created="Wed, 10 Jul 2013 02:26:35 +0000"  >&lt;p&gt;Hi - &lt;/p&gt;

&lt;p&gt;This resulted in an incorrect result for me when I was incorporating this code into a separate (appropriately licensed, open-source) project.  I verified that the patch results in correct behavior.&lt;/p&gt;


&lt;p&gt;To quote the GCC docs (&lt;a href=&quot;http://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html):&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html):&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Only a number in the constraint can guarantee that one operand is in the same place as another. The mere fact that foo is the value of both operands is not enough to guarantee that they are in the same place in the generated assembler code. The following does not work reliably:&lt;/p&gt;

&lt;p&gt;     asm (&quot;combine %2,%0&quot; : &quot;=r&quot; (foo) : &quot;r&quot; (foo), &quot;g&quot; (bar));&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Hope this helps.&lt;/p&gt;</comment>
                            <comment id="13704523" author="kihwal" created="Wed, 10 Jul 2013 13:06:04 +0000"  >&lt;p&gt;Sorry I thought I posted +1 almong with my findings yesterday. &lt;/p&gt;

&lt;p&gt;+1 for the patch. &lt;/p&gt;

&lt;p&gt;I also looked at the documentation Brian quoteded. I tried many things to make compilers generate a problematic RTL, but was unsuccessful until the loop unrolling was enabled. I could clearly see the defect in there. &lt;/p&gt;

&lt;p&gt;Thanks for finding and providing the fix. &lt;/p&gt;</comment>
                            <comment id="13708770" author="kihwal" created="Mon, 15 Jul 2013 18:20:14 +0000"  >&lt;p&gt;Thanks for the patch, Todd. And also thanks for the input, Brian. I&apos;ve committed this to branch-2, branch-2.1-beta and trunk.&lt;/p&gt;</comment>
                            <comment id="13708778" author="hudson" created="Mon, 15 Jul 2013 18:25:27 +0000"  >&lt;p&gt;SUCCESS: Integrated in Hadoop-trunk-Commit #4084 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-trunk-Commit/4084/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-trunk-Commit/4084/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9707&quot; title=&quot;Fix register lists for crc32c inline assembly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9707&quot;&gt;&lt;del&gt;HADOOP-9707&lt;/del&gt;&lt;/a&gt;. Fix register lists for crc32c inline assembly. Contributed by Todd Lipcon. (kihwal: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1503390&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1503390&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/util/bulk_crc32.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13709674" author="hudson" created="Tue, 16 Jul 2013 10:58:44 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Yarn-trunk #272 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Yarn-trunk/272/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Yarn-trunk/272/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9707&quot; title=&quot;Fix register lists for crc32c inline assembly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9707&quot;&gt;&lt;del&gt;HADOOP-9707&lt;/del&gt;&lt;/a&gt;. Fix register lists for crc32c inline assembly. Contributed by Todd Lipcon. (kihwal: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1503390&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1503390&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/util/bulk_crc32.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13709752" author="hudson" created="Tue, 16 Jul 2013 13:19:09 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Hdfs-trunk #1462 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1462/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1462/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9707&quot; title=&quot;Fix register lists for crc32c inline assembly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9707&quot;&gt;&lt;del&gt;HADOOP-9707&lt;/del&gt;&lt;/a&gt;. Fix register lists for crc32c inline assembly. Contributed by Todd Lipcon. (kihwal: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1503390&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1503390&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/util/bulk_crc32.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13709816" author="hudson" created="Tue, 16 Jul 2013 14:40:33 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Mapreduce-trunk #1489 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1489/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1489/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9707&quot; title=&quot;Fix register lists for crc32c inline assembly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9707&quot;&gt;&lt;del&gt;HADOOP-9707&lt;/del&gt;&lt;/a&gt;. Fix register lists for crc32c inline assembly. Contributed by Todd Lipcon. (kihwal: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1503390&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1503390&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/util/bulk_crc32.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12591237" name="hadoop-9707.txt" size="2729" author="tlipcon" created="Mon, 8 Jul 2013 17:50:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>336862</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 19 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1m3sf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>337185</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>