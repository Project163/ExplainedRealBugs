<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:37:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-8310] FileContext#checkPath should handle URIs with no port</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-8310</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;AbstractFileSystem#checkPath is used to verify that a given path is for the same file system as represented by the AbstractFileSystem instance.&lt;/p&gt;

&lt;p&gt;The original intent of the code was to allow for no port to be provided in the checked path, if the default port was being used by the AbstractFileSystem instance. However, before performing port handling, AFS#checkPath compares the full URI authorities for equality. Since the URI authority includes the port, the port handling code is never reached, and thus valid paths may be erroneously considered invalid.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12552265">HADOOP-8310</key>
            <summary>FileContext#checkPath should handle URIs with no port</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="atm">Aaron Myers</assignee>
                                    <reporter username="atm">Aaron Myers</reporter>
                        <labels>
                    </labels>
                <created>Tue, 24 Apr 2012 08:10:08 +0000</created>
                <updated>Tue, 2 Oct 2012 12:41:34 +0000</updated>
                            <resolved>Thu, 26 Apr 2012 18:28:09 +0000</resolved>
                                    <version>2.0.0-alpha</version>
                                    <fixVersion>2.0.0-alpha</fixVersion>
                    <fixVersion>0.23.4</fixVersion>
                                    <component>fs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="13260357" author="atm" created="Tue, 24 Apr 2012 08:34:46 +0000"  >&lt;p&gt;Here&apos;s a patch which fixes the issue, by strictly comparing initially only the host components of the URIs, instead of the full authorities.&lt;/p&gt;</comment>
                            <comment id="13260367" author="hadoopqa" created="Tue, 24 Apr 2012 08:56:00 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12523944/HADOOP-8310.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12523944/HADOOP-8310.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 1 new or modified test files.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 eclipse:eclipse.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                  org.apache.hadoop.fs.viewfs.TestViewFsTrash&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/884//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/884//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/884//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/884//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13260633" author="johnvijoe" created="Tue, 24 Apr 2012 14:54:44 +0000"  >&lt;p&gt;Good catch Aaron. +1 as long as the test failure is unrelated.&lt;/p&gt;</comment>
                            <comment id="13260752" author="atm" created="Tue, 24 Apr 2012 17:52:07 +0000"  >&lt;p&gt;Thanks a lot for the review, John. I&apos;m confident that the test failure of TestViewFsTrash is unrelated.&lt;/p&gt;

&lt;p&gt;I should also mention that I discovered this issue because without this fix one cannot view the conf page of a running MR2 job in a cluster whose fs.default.name is configured without a port. I manually verified that with this fix, one can get to the page just fine.&lt;/p&gt;

&lt;p&gt;I also ran the full HDFS test suite with this patch applied and everything passed.&lt;/p&gt;</comment>
                            <comment id="13260773" author="daryn" created="Tue, 24 Apr 2012 18:14:15 +0000"  >&lt;p&gt;&lt;tt&gt;AbstractFileSystem&lt;/tt&gt; should use the same implementation as &lt;tt&gt;FileSystem&lt;/tt&gt;.  This patch doesn&apos;t appear to support canonicalization correctly.&lt;/p&gt;</comment>
                            <comment id="13260827" author="atm" created="Tue, 24 Apr 2012 18:57:51 +0000"  >&lt;blockquote&gt;&lt;p&gt;AbstractFileSystem should use the same implementation as FileSystem.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The same implementation of checkPath?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;This patch doesn&apos;t appear to support canonicalization correctly.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I don&apos;t follow. This patch doesn&apos;t change canonicalization at all.&lt;/p&gt;</comment>
                            <comment id="13260887" author="daryn" created="Tue, 24 Apr 2012 19:54:01 +0000"  >&lt;blockquote&gt;&lt;p&gt;The same implementation of checkPath?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, &lt;tt&gt;FileSystem#checkPath&lt;/tt&gt; has code to handle host canonicalization that works in conjunction with host-based tokens.  It&apos;s an oversight on my part that it didn&apos;t make it into &lt;tt&gt;FileContext&lt;/tt&gt;...&lt;/p&gt;</comment>
                            <comment id="13260890" author="johnvijoe" created="Tue, 24 Apr 2012 20:00:24 +0000"  >&lt;p&gt;@Daryn - do you think that should be handled as part of another JIRA since this specifically addresses a different issue?&lt;/p&gt;</comment>
                            <comment id="13261050" author="atm" created="Tue, 24 Apr 2012 21:39:13 +0000"  >&lt;blockquote&gt;&lt;p&gt;@Daryn - do you think that should be handled as part of another JIRA since this specifically addresses a different issue?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That would be my preference as well. Making FC use FS&apos;s checkPath implementation is a bigger, potentially more destabilizing change. It&apos;s also not obvious to me that such a change would be entirely compatible, consdering FS#checkPath currently throws IllegalArgEx, whereas FC throws InvalidPathEx.&lt;/p&gt;

&lt;p&gt;Perhaps we can commit this patch as-is, and open another JIRA to make the two methods share code.&lt;/p&gt;

&lt;p&gt;Is that OK by you, Daryn?&lt;/p&gt;</comment>
                            <comment id="13261644" author="daryn" created="Wed, 25 Apr 2012 13:44:00 +0000"  >&lt;p&gt;They actually are related.  When I changed the &lt;tt&gt;FileSystem#checkPath&lt;/tt&gt; handling, I also removed &lt;tt&gt;DistributedFileSystem#checkPath&lt;/tt&gt; due to redundancy with the improved &lt;tt&gt;FileSystem#checkPath&lt;/tt&gt;.  Part of the change specifically involved having &lt;tt&gt;FileSystem#checkPath&lt;/tt&gt; handle default ports.  That change is probably what broke &lt;tt&gt;FileContext&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;FileContext&lt;/tt&gt; really should have identical URI handling to &lt;tt&gt;FileSystem&lt;/tt&gt;, sans the exception types.  &lt;tt&gt;InvalidPathException&lt;/tt&gt; derives from &lt;tt&gt;IllegalArgumentException&lt;/tt&gt; so the difference won&apos;t matter esp. since &lt;tt&gt;FileContext&lt;/tt&gt; can continue to throw the path exception.&lt;/p&gt;

&lt;p&gt;+0 All that said, I&apos;m very reluctantly willing to let this patch go as-is if there is a followup jira.&lt;/p&gt;</comment>
                            <comment id="13262267" author="tlipcon" created="Thu, 26 Apr 2012 00:13:02 +0000"  >&lt;p&gt;+1 for this small fix in lieu of reworking the whole thing.&lt;/p&gt;</comment>
                            <comment id="13262827" author="atm" created="Thu, 26 Apr 2012 18:27:58 +0000"  >&lt;p&gt;Thanks a lot for the review, Todd. I&apos;ve just committed this to trunk and branch-2.&lt;/p&gt;

&lt;p&gt;Daryn: I&apos;ve filed &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-8320&quot; title=&quot;FileSystem#checkPath and AbstractFileSystem#checkPath should share code&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-8320&quot;&gt;HADOOP-8320&lt;/a&gt; as a follow-up JIRA.&lt;/p&gt;</comment>
                            <comment id="13263635" author="hudson" created="Fri, 27 Apr 2012 13:04:13 +0000"  >&lt;p&gt;Integrated in Hadoop-Hdfs-trunk #1027 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1027/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1027/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-8310&quot; title=&quot;FileContext#checkPath should handle URIs with no port&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-8310&quot;&gt;&lt;del&gt;HADOOP-8310&lt;/del&gt;&lt;/a&gt;. FileContext#checkPath should handle URIs with no port. Contributed by Aaron T. Myers. (Revision 1331007)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
atm : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1331007&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1331007&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/AbstractFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/TestAfsCheckPath.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13263672" author="hudson" created="Fri, 27 Apr 2012 14:03:34 +0000"  >&lt;p&gt;Integrated in Hadoop-Mapreduce-trunk #1062 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1062/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1062/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-8310&quot; title=&quot;FileContext#checkPath should handle URIs with no port&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-8310&quot;&gt;&lt;del&gt;HADOOP-8310&lt;/del&gt;&lt;/a&gt;. FileContext#checkPath should handle URIs with no port. Contributed by Aaron T. Myers. (Revision 1331007)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
atm : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1331007&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1331007&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/AbstractFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/TestAfsCheckPath.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13467209" author="jlowe" created="Mon, 1 Oct 2012 21:25:08 +0000"  >&lt;p&gt;Thanks Aaron, I pulled this into branch-0.23.&lt;/p&gt;</comment>
                            <comment id="13467672" author="hudson" created="Tue, 2 Oct 2012 12:41:34 +0000"  >&lt;p&gt;Integrated in Hadoop-Hdfs-0.23-Build #392 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-0.23-Build/392/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-0.23-Build/392/&lt;/a&gt;)&lt;br/&gt;
    svn merge -c 1331007 FIXES: &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-8310&quot; title=&quot;FileContext#checkPath should handle URIs with no port&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-8310&quot;&gt;&lt;del&gt;HADOOP-8310&lt;/del&gt;&lt;/a&gt;. FileContext#checkPath should handle URIs with no port. Contributed by Aaron T. Myers. (Revision 1392622)&lt;/p&gt;

&lt;p&gt;     Result = UNSTABLE&lt;br/&gt;
jlowe : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1392622&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1392622&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/AbstractFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/TestAfsCheckPath.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12523944" name="HADOOP-8310.patch" size="7433" author="atm" created="Tue, 24 Apr 2012 08:34:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>236646</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 8 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02i9j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12560</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12320352">2.0.0-alpha</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>