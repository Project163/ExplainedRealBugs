<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:56:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-17812] NPE in S3AInputStream read() after failure to reconnect to store</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-17812</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;when&#160;&lt;a href=&quot;https://github.com/apache/hadoop/blob/rel/release-3.2.0/hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/S3AInputStream.java#L450&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;reading from S3a storage&lt;/a&gt;, SSLException (which extends IOException) happens, which will trigger&#160;&lt;a href=&quot;https://github.com/apache/hadoop/blob/rel/release-3.2.0/hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/S3AInputStream.java#L458&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;onReadFailure&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;onReadFailure calls &quot;reopen&quot;. it will first close the original&#160;&lt;b&gt;wrappedStream&lt;/b&gt;&#160;and set&#160;&lt;b&gt;wrappedStream = null&lt;/b&gt;, and then it will try to&#160;&lt;a href=&quot;https://github.com/apache/hadoop/blob/rel/release-3.2.0/hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/S3AInputStream.java#L184&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;re-get&#160;&lt;b&gt;wrappedStream&lt;/b&gt;&lt;/a&gt;. But what if the previous code&#160;&lt;a href=&quot;https://github.com/apache/hadoop/blob/rel/release-3.2.0/hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/S3AInputStream.java#L183&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;obtaining S3Object&lt;/a&gt;&#160;throw exception, then &quot;wrappedStream&quot; will be null.&lt;/p&gt;

&lt;p&gt;And the&#160;&lt;a href=&quot;https://github.com/apache/hadoop/blob/rel/release-3.2.0/hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/S3AInputStream.java#L446&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;retry&lt;/a&gt;&#160;mechanism may re-execute the&#160;&lt;a href=&quot;https://github.com/apache/hadoop/blob/rel/release-3.2.0/hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/S3AInputStream.java#L450&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;wrappedStream.read&lt;/a&gt;&#160;and cause NPE.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;For more details, please refer to&#160;&lt;a href=&quot;https://github.com/NVIDIA/spark-rapids/issues/2915&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/NVIDIA/spark-rapids/issues/2915&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13391226">HADOOP-17812</key>
            <summary>NPE in S3AInputStream read() after failure to reconnect to store</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="wbo4958">Bobby Wang</assignee>
                                    <reporter username="wbo4958">Bobby Wang</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 22 Jul 2021 01:04:58 +0000</created>
                <updated>Mon, 23 Aug 2021 11:24:45 +0000</updated>
                            <resolved>Fri, 30 Jul 2021 19:06:56 +0000</resolved>
                                    <version>3.2.2</version>
                    <version>3.3.1</version>
                                    <fixVersion>3.4.0</fixVersion>
                    <fixVersion>3.3.2</fixVersion>
                                    <component>fs/s3</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="16800">4h 40m</timespent>
                                <comments>
                            <comment id="17385373" author="stevel@apache.org" created="Thu, 22 Jul 2021 09:25:53 +0000"  >&lt;p&gt;stack&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
17:22:13  Caused by: java.lang.NullPointerException
17:22:13  	at org.apache.hadoop.fs.s3a.S3AInputStream.lambda$read$3(S3AInputStream.java:450)
17:22:13  	at org.apache.hadoop.fs.s3a.Invoker.once(Invoker.java:109)
17:22:13  	at org.apache.hadoop.fs.s3a.Invoker.lambda$retry$3(Invoker.java:265)
17:22:13  	at org.apache.hadoop.fs.s3a.Invoker.retryUntranslated(Invoker.java:322)
17:22:13  	at org.apache.hadoop.fs.s3a.Invoker.retry(Invoker.java:261)
17:22:13  	at org.apache.hadoop.fs.s3a.Invoker.retry(Invoker.java:236)
17:22:13  	at org.apache.hadoop.fs.s3a.S3AInputStream.read(S3AInputStream.java:446)
17:22:13  	at java.io.DataInputStream.readFully(DataInputStream.java:195)
17:22:13  	at com.nvidia.spark.rapids.ParquetPartitionReaderBase.copyDataRange(GpuParquetScan.scala:509)
17:22:13  	at com.nvidia.spark.rapids.ParquetPartitionReaderBase.copyDataRange$(GpuParquetScan.scala:497)
17:22:13  	at com.nvidia.spark.rapids.MultiFileCloudParquetPartitionReader.copyDataRange(GpuParquetScan.scala:975)
17:22:13  	at com.nvidia.spark.rapids.ParquetPartitionReaderBase.$anonfun$copyBlocksData$3(GpuParquetScan.scala:580)
17:22:13  	at com.nvidia.spark.rapids.ParquetPartitionReaderBase.$anonfun$copyBlocksData$3$adapted(GpuParquetScan.scala:580)
17:22:13  	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17385384" author="stevel@apache.org" created="Thu, 22 Jul 2021 09:46:08 +0000"  >&lt;p&gt;Hi, which version of hadoop JARs are you using?&lt;/p&gt;</comment>
                            <comment id="17385899" author="wbo4958" created="Fri, 23 Jul 2021 03:15:29 +0000"  >&lt;p&gt;Hi Steve, I was using hadoop-3.2.0 and the issue should exist in all branches since I can repro it with below patch to simulating the exceptions&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/NVIDIA/spark-rapids/issues/2915#issuecomment-884568475&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch to repro by simulating the exceptions&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="17386204" author="stevel@apache.org" created="Fri, 23 Jul 2021 12:14:33 +0000"  >&lt;blockquote&gt;&lt;p&gt;I was using hadoop-3.2.0 and the issue should exist in all branches since I can repro it with below patch to simulating the exceptions&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;There&apos;s a field in the JIRA for it; I&apos;ve updated it for you.&lt;/p&gt;

&lt;p&gt;FWIW, I dont&apos; expect a fix to go into anything other than 3.3.2. 3.2.x is pretty old and s3a code is one place where there has been significant change since then&lt;/p&gt;</comment>
                            <comment id="17386993" author="wbo4958" created="Mon, 26 Jul 2021 01:51:45 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stevel%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;stevel@apache.org&quot;&gt;stevel@apache.org&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thx for your comments on the PR and the JIRA, I modified the unit test to include the repro step described in this JIRA, and the unit tests all passed.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I followed the step to run the Integration Test on our internal s3 storage and seems some tests failed. And I was told some failed tests were expected, So I just uploaded the&#160;failsafe-report.html in the attachment named with s3a-test.tar.gz, Could you help to check if the failed test cases are expected?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;BTW, I just configured the below items in the auth-keys.xml,&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;lt;configuration&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;test.fs.s3a.name&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;s3a://testawss3a/&amp;lt;/value&amp;gt;&lt;br/&gt;
 &amp;lt;/property&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;fs.contract.test.fs.s3a&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;${test.fs.s3a.name}&amp;lt;/value&amp;gt;&lt;br/&gt;
 &amp;lt;/property&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;fs.s3a.access.key&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;XXX&amp;lt;/value&amp;gt;&lt;br/&gt;
 &amp;lt;/property&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;fs.s3a.secret.key&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;XXXXXX&amp;lt;/value&amp;gt;&lt;br/&gt;
 &amp;lt;/property&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;fs.s3a.endpoint&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;XXXXX&amp;lt;/value&amp;gt;&lt;br/&gt;
 &amp;lt;/property&amp;gt;&lt;/p&gt;

&lt;p&gt; &amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;fs.s3a.path.style.access&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;true&amp;lt;/value&amp;gt;&lt;br/&gt;
 &amp;lt;/property&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;/configuration&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="17387983" author="stevel@apache.org" created="Tue, 27 Jul 2021 11:24:31 +0000"  >&lt;p&gt;thanks for the test results. &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;the only detail we worry about is endpoint, e.g &quot;us-east-1&quot;; it&apos;s also good to include maven command line, eg. &quot;-Dparallel-tests -DtestsThreadCount=5 -Dmarkers=delete -Dscale &quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;distcp timeout is a recurrent one. I need to fix that test by reducing the #of files/dirs copied. Too brittle and also hurts abfs test&lt;/li&gt;
	&lt;li&gt;the landsat tests are new, caused by AWS locking their landsat-pds bucket. I had hoped it was going to stay readable, at least with the gz file. Must have happened this week, and you are the first person to hit it. unrelated, but it is stopping the full scale random IO tests from working, which is a PITA.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17389239" author="wbo4958" created="Thu, 29 Jul 2021 03:41:32 +0000"  >&lt;p&gt;Hi Steve,&lt;/p&gt;

&lt;p&gt;I just found an aws account from my colleague and did the integration test, The result can be found in attachment named&#160;&#160;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13031176/13031176_failsafe-report.html.gz&quot; title=&quot;failsafe-report.html.gz attached to HADOOP-17812&quot;&gt;failsafe-report.html.gz&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The auth-keys.xml I used is like that&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;configuration&amp;gt;
&amp;lt;property&amp;gt;
 &amp;lt;name&amp;gt;test.fs.s3a.name&amp;lt;/name&amp;gt;
 &amp;lt;value&amp;gt;s3a:&lt;span class=&quot;code-comment&quot;&gt;//testawss3a/&amp;lt;/value&amp;gt;
&lt;/span&gt; &amp;lt;/property&amp;gt;
&amp;lt;property&amp;gt;
 &amp;lt;name&amp;gt;fs.contract.test.fs.s3a&amp;lt;/name&amp;gt;
 &amp;lt;value&amp;gt;${test.fs.s3a.name}&amp;lt;/value&amp;gt;
 &amp;lt;/property&amp;gt;
&amp;lt;property&amp;gt;
 &amp;lt;name&amp;gt;fs.s3a.access.key&amp;lt;/name&amp;gt;
 &amp;lt;description&amp;gt;AWS access key ID. Omit &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; IAM role-based authentication.&amp;lt;/description&amp;gt;
 &amp;lt;value&amp;gt;XXXXXXX&amp;lt;/value&amp;gt;
 &amp;lt;/property&amp;gt;
&amp;lt;property&amp;gt;
 &amp;lt;name&amp;gt;fs.s3a.secret.key&amp;lt;/name&amp;gt;
 &amp;lt;description&amp;gt;AWS secret key. Omit &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; IAM role-based authentication.&amp;lt;/description&amp;gt;
 &amp;lt;value&amp;gt;XXXXX&amp;lt;/value&amp;gt;
 &amp;lt;/property&amp;gt;
&amp;lt;property&amp;gt;
 &amp;lt;name&amp;gt;fs.s3a.scale.test.csvfile&amp;lt;/name&amp;gt;
 &amp;lt;value&amp;gt;s3a:&lt;span class=&quot;code-comment&quot;&gt;//landsat-pds/scene_list.gz&amp;lt;/value&amp;gt;
&lt;/span&gt; &amp;lt;/property&amp;gt;

 &amp;lt;property&amp;gt;
 &amp;lt;name&amp;gt;test.sts.endpoint&amp;lt;/name&amp;gt;
 &amp;lt;description&amp;gt;Specific endpoint to use &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; STS requests.&amp;lt;/description&amp;gt;
 &amp;lt;value&amp;gt;sts.amazonaws.com&amp;lt;/value&amp;gt;
 &amp;lt;/property&amp;gt;

 &amp;lt;property&amp;gt;
 &amp;lt;name&amp;gt;fs.s3a.path.style.access&amp;lt;/name&amp;gt;
 &amp;lt;value&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;lt;/value&amp;gt;
 &amp;lt;/property&amp;gt;
&amp;lt;/configuration&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The tests that failed in&#160;&lt;b&gt;ITestS3ADeleteCost&lt;/b&gt; and&#160;&lt;b&gt;ITestS3ARenameCost&lt;/b&gt;&#160; and &lt;b&gt;ITestS3AFileOperationCost&lt;/b&gt; are because of `DynamoDB table &apos;testawss3a&apos; does not exist in region us-west-2; auto-creation is turned off`&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;one test&#160;&lt;b&gt;testCustomSignerAndInitializer&lt;/b&gt; failed is because of NPE&lt;/p&gt;

&lt;p&gt;&lt;em&gt;java.lang.NullPointerException at org.apache.hadoop.fs.s3a.auth.ITestCustomSigner$CustomSignerInitializer$StoreValue.access$200(ITestCustomSigner.java:255) at org.apache.hadoop.fs.s3a.auth.ITestCustomSigner$CustomSigner.sign(ITestCustomSigner.java:187) at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeOneRequest(AmazonHttpClient.java:1305) at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1145) at com.amazonaws.http.AmazonHttpClient$RequestExecutor.doExecute(AmazonHttpClient.java:802) at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeWithTimer(AmazonHttpClient.java:770) at com.amazonaws.http.AmazonHttpClient$RequestExecutor.execute(AmazonHttpClient.java:744) at com.amazonaws.http.AmazonHttpClient$RequestExecutor.access$500(AmazonHttpClient.java:704) at com.amazonaws.http.AmazonHttpClient$RequestExecutionBuilderImpl.execute(AmazonHttpClient.java:686) at com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:550) at com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:530) at com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:5437) at com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:5384) at com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:5378) at com.amazonaws.services.s3.AmazonS3Client.listObjectsV2(AmazonS3Client.java:970) at org.apache.hadoop.fs.s3a.S3AFileSystem.lambda$listObjects$11(S3AFileSystem.java:2490) at org.apache.hadoop.fs.statistics.impl.IOStatisticsBinding.lambda$trackDurationOfOperation$5(IOStatisticsBinding.java:499) at org.apache.hadoop.fs.s3a.Invoker.retryUntranslated(Invoker.java:414) at org.apache.hadoop.fs.s3a.Invoker.retryUntranslated(Invoker.java:377) at org.apache.hadoop.fs.s3a.S3AFileSystem.listObjects(S3AFileSystem.java:2481) at org.apache.hadoop.fs.s3a.S3AFileSystem.s3GetFileStatus(S3AFileSystem.java:3720) at org.apache.hadoop.fs.s3a.S3AFileSystem.innerGetFileStatus(S3AFileSystem.java:3583) at org.apache.hadoop.fs.s3a.S3AFileSystem$MkdirOperationCallbacksImpl.probePathStatus(S3AFileSystem.java:3350) at org.apache.hadoop.fs.s3a.impl.MkdirOperation.probePathStatusOrNull(MkdirOperation.java:135) at org.apache.hadoop.fs.s3a.impl.MkdirOperation.getPathStatusExpectingDir(MkdirOperation.java:150) at org.apache.hadoop.fs.s3a.impl.MkdirOperation.execute(MkdirOperation.java:80) at org.apache.hadoop.fs.s3a.impl.MkdirOperation.execute(MkdirOperation.java:45)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;and&#160;&lt;b&gt;testDistCpWithIterator&lt;/b&gt; failed is because of Timeout&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;the detailed information can be found in the attachment.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Please help to check it. I really appreciate it.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thx&lt;/p&gt;</comment>
                            <comment id="17390751" author="stevel@apache.org" created="Fri, 30 Jul 2021 19:01:45 +0000"  >&lt;p&gt;Thanks. distcp test has a fix in progress&lt;/p&gt;

&lt;p&gt;the NPE is new; we should just disable that test against a custom endpoint: &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-17824&quot; title=&quot;ITestCustomSigner fails with NPE against private endpoint&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-17824&quot;&gt;&lt;del&gt;HADOOP-17824&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17390752" author="stevel@apache.org" created="Fri, 30 Jul 2021 19:06:56 +0000"  >&lt;p&gt;fixed in 3.4; backport to 3.3.2 planned&lt;/p&gt;</comment>
                            <comment id="17391079" author="wbo4958" created="Sun, 1 Aug 2021 00:47:34 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stevel%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;stevel@apache.org&quot;&gt;stevel@apache.org&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I just cherry-picked the patch to branch-3.3 and re-ran the integration tests. And one new test&#160;&lt;b&gt;testUnbufferMultipleReads&lt;/b&gt; failed. It seems the failure test was not caused by my patch, since I can repro it even without my patch. I uploaded the result to the attachment. Please refer to&#160;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13031321/13031321_3.3-branch-failsafe-report.html.gz&quot; title=&quot;3.3-branch-failsafe-report.html.gz attached to HADOOP-17812&quot;&gt;3.3-branch-failsafe-report.html.gz&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.AssertionError: failed to read expected number of bytes from stream. This may be &lt;span class=&quot;code-keyword&quot;&gt;transient&lt;/span&gt; expected:&amp;lt;128&amp;gt; but was:&amp;lt;93&amp;gt; at org.junit.Assert.fail(Assert.java:89) at org.junit.Assert.failNotEquals(Assert.java:835) at org.junit.Assert.assertEquals(Assert.java:647) at org.apache.hadoop.fs.contract.AbstractContractUnbufferTest.validateFileContents(AbstractContractUnbufferTest.java:139) at org.apache.hadoop.fs.contract.AbstractContractUnbufferTest.testUnbufferMultipleReads(AbstractContractUnbufferTest.java:111) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299) at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17392259" author="stevel@apache.org" created="Tue, 3 Aug 2021 11:58:14 +0000"  >&lt;p&gt;As the unbuffer test says &quot;this may be transient&quot;; if the read buffer isn&apos;t full it will underreport. Intermittent -don&apos;t worry&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310760">
                    <name>Testing</name>
                                            <outwardlinks description="Testing discovered">
                                        <issuelink>
            <issuekey id="13392813">HADOOP-17824</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="13384133">HADOOP-17764</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13031321" name="3.3-branch-failsafe-report.html.gz" size="76642" author="wbo4958" created="Sun, 1 Aug 2021 00:46:46 +0000"/>
                            <attachment id="13031176" name="failsafe-report.html.gz" size="77432" author="wbo4958" created="Thu, 29 Jul 2021 03:27:38 +0000"/>
                            <attachment id="13031029" name="s3a-test.tar.gz" size="108427" author="wbo4958" created="Mon, 26 Jul 2021 01:43:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 15 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0t7v4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>