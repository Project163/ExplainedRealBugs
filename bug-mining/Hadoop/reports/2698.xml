<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:56:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-17142] Fix outdated properties of journal node when perform rollback</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-17142</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;When rollback HDFS cluster, properties in JNStorage won&apos;t be refreshed after the storage dir changed. It leads to exceptions when starting namenode.&lt;/p&gt;

&lt;p&gt;The exception like:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2020-07-09 19:04:12,810 FATAL [IPC Server handler 105 on 8022] org.apache.hadoop.hdfs.server.namenode.FSEditLog: Error: recoverUnfinalizedSegments failed &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; required journal (JournalAndStream(mgr=QJM to [10.0.118.217:8485, 10.0.117.208:8485, 10.0.118.179:8485], stream=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;))
org.apache.hadoop.hdfs.qjournal.client.QuorumException: Got too many exceptions to achieve quorum size 2/3. 3 exceptions thrown:
10.0.118.217:8485: Incompatible namespaceID &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; journal Storage Directory /mnt/vdc-11176G-0/dfs/jn/nameservicetest1: NameNode has nsId 647617129 but storage has nsId 0
	at org.apache.hadoop.hdfs.qjournal.server.JNStorage.checkConsistentNamespace(JNStorage.java:236)
	at org.apache.hadoop.hdfs.qjournal.server.Journal.newEpoch(Journal.java:300)
	at org.apache.hadoop.hdfs.qjournal.server.JournalNodeRpcServer.newEpoch(JournalNodeRpcServer.java:136)
	at org.apache.hadoop.hdfs.qjournal.protocolPB.QJournalProtocolServerSideTranslatorPB.newEpoch(QJournalProtocolServerSideTranslatorPB.java:133)
	at org.apache.hadoop.hdfs.qjournal.protocol.QJournalProtocolProtos$QJournalProtocolService$2.callBlockingMethod(QJournalProtocolProtos.java:25417)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:617)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1073)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2278)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2274)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1924)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2274)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13318405">HADOOP-17142</key>
            <summary>Fix outdated properties of journal node when perform rollback</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="Deegue">Deegue</assignee>
                                    <reporter username="Deegue">Deegue</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Jul 2020 06:38:29 +0000</created>
                <updated>Mon, 12 Feb 2024 07:04:46 +0000</updated>
                            <resolved>Mon, 17 May 2021 02:56:49 +0000</resolved>
                                                    <fixVersion>3.2.2</fixVersion>
                    <fixVersion>3.3.1</fixVersion>
                    <fixVersion>3.4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17239975" author="hexiaoqiao" created="Sat, 28 Nov 2020 13:22:38 +0000"  >&lt;p&gt;backport to branch-3.2.2.&lt;/p&gt;</comment>
                            <comment id="17345839" author="jojochuang" created="Mon, 17 May 2021 02:55:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hexiaoqiao&quot; class=&quot;user-hover&quot; rel=&quot;hexiaoqiao&quot;&gt;hexiaoqiao&lt;/a&gt; looks like there&apos;s a discrepancy between jira and git history.&lt;/p&gt;

&lt;p&gt;I see this commit landing in branch-3.3 (3.3.1) but no patch file attached in the jira. Fix version doesn&apos;t have 3.4.0 nor 3.3.1, and resolution is abandoned.&lt;/p&gt;</comment>
                            <comment id="17345845" author="hexiaoqiao" created="Mon, 17 May 2021 03:16:14 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=weichiu&quot; class=&quot;user-hover&quot; rel=&quot;weichiu&quot;&gt;weichiu&lt;/a&gt; involve me here.&lt;br/&gt;
IIRC, this is backported when release 3.2.2. But I don&apos;t recall why there is no patch file attached here. Just check this git history as following. cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eelliiss&quot; class=&quot;user-hover&quot; rel=&quot;eelliiss&quot;&gt;eelliiss&lt;/a&gt; any ideas?&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;commit 5b2c7c82d3572299b6879dfe8629110739bb7278&lt;br/&gt;
Author: Yizhong Zhang &amp;lt;zyzzxycj@163.com&amp;gt;&lt;br/&gt;
Date:   Wed Nov 11 01:11:31 2020 +0800&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-17142&quot; title=&quot;Fix outdated properties of journal node when perform rollback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-17142&quot;&gt;&lt;del&gt;HADOOP-17142&lt;/del&gt;&lt;/a&gt;. Fix outdated properties of JournalNode when performing rollback. Contributed by Deegue.&lt;/p&gt;

&lt;p&gt;    (cherry picked from commit 82de07c794fe119946bec2e563c1937f312e8ac9)&lt;br/&gt;
    (cherry picked from commit 12bfd9194a1b6ff89fb31f1f49e69c727f844155)&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="17345847" author="hexiaoqiao" created="Mon, 17 May 2021 03:20:56 +0000"  >&lt;p&gt;Linked this github link here.&lt;/p&gt;</comment>
                            <comment id="17345862" author="jojochuang" created="Mon, 17 May 2021 04:12:06 +0000"  >&lt;p&gt;Found it: &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-15485&quot; title=&quot;Fix outdated properties of JournalNode when performing rollback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-15485&quot;&gt;&lt;del&gt;HDFS-15485&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13318411">HDFS-15485</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 26 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0h1co:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>