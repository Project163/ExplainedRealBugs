<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:34:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-6900] FileSystem#listLocatedStatus should not throw generic RuntimeException to indicate error conditions</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-6900</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-6870&quot; title=&quot;Blocks and INodes could leak for Rename with overwrite flag&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-6870&quot;&gt;&lt;del&gt;HDFS-6870&lt;/del&gt;&lt;/a&gt; introduced FileSystem#listLocatedStatus(), that returns an Iterator to iterate through LocatedFileStatus for files under a directory or recursively under a sub-directory. Iterator currently throws generic RuntimeException to indicate error conditions. API needs to be changed to throw appropriate exceptions to indicate error conditions.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12470847">HADOOP-6900</key>
            <summary>FileSystem#listLocatedStatus should not throw generic RuntimeException to indicate error conditions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hairong">Hairong Kuang</assignee>
                                    <reporter username="sureshms">Suresh Srinivas</reporter>
                        <labels>
                    </labels>
                <created>Wed, 4 Aug 2010 23:29:46 +0000</created>
                <updated>Mon, 12 Dec 2011 06:19:31 +0000</updated>
                            <resolved>Wed, 11 Aug 2010 04:45:26 +0000</resolved>
                                                    <fixVersion>0.22.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="12895470" author="sureshms" created="Wed, 4 Aug 2010 23:40:16 +0000"  >&lt;p&gt;Iterator#hasNext() has to indicate the following error conditions:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;next element exists - returns true&lt;/li&gt;
	&lt;li&gt;next element does not exist - returns false&lt;/li&gt;
	&lt;li&gt;could not get status for the next element, because a directory that was available before iteration started does not exist any more.&lt;/li&gt;
	&lt;li&gt;could not talk to the remote server to get status.&lt;/li&gt;
	&lt;li&gt;remote server throws IOException due to an error while getting the status.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;For the last 3 conditions, currently RuntimeException is thrown. Throwing RTE forces application to catch it, to handle the error condition. This results in application catching other RTE as well. Worse still, an application that does not catch RTE might exit.&lt;/p&gt;

&lt;p&gt;The problem is, Java Iterator interface is not suitable for implementation that use RPC underneath. We should have a different interface, which could indicate error conditions more clearly.&lt;/p&gt;

&lt;p&gt;Additionally I feel when a directory gets deleted in the middle of iteration, we should ignore it, or add provision to the iterator to ignore it.&lt;/p&gt;</comment>
                            <comment id="12895852" author="hairong" created="Thu, 5 Aug 2010 22:42:13 +0000"  >&lt;p&gt;Suresh, good idea! I appreciate your thoughts on this.&lt;/p&gt;

&lt;p&gt;I will create a new Iterator interface that throws IOException on next() and hasNext().&lt;/p&gt;

&lt;p&gt;I will make listFiles, listLocatedStatus, AND listStatus to return this new iterator iterface. How does this sound to you?&lt;/p&gt;</comment>
                            <comment id="12895883" author="hairong" created="Fri, 6 Aug 2010 00:03:51 +0000"  >&lt;p&gt;A patch for review.&lt;/p&gt;</comment>
                            <comment id="12896701" author="hairong" created="Mon, 9 Aug 2010 21:34:54 +0000"  >&lt;p&gt;&amp;gt; Additionally I feel when a directory gets deleted in the middle of iteration, we should ignore it, or add provision to the iterator to ignore it.&lt;/p&gt;

&lt;p&gt;Unfortunately not allowing concurrent modification on the input directories is the semantics that map/reduce has it now. I do not want to introduce an incompatible change for now.&lt;/p&gt;</comment>
                            <comment id="12896747" author="hairong" created="Tue, 10 Aug 2010 00:19:33 +0000"  >&lt;p&gt;This patch adds more comments and changes some FileContext tests to use the new listStatus interface.&lt;/p&gt;</comment>
                            <comment id="12897088" author="sureshms" created="Wed, 11 Aug 2010 00:00:06 +0000"  >&lt;p&gt;+ 1 for the patch.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Unfortunately not allowing concurrent modification on the input directories is the semantics that map/reduce has it now. I do not want to introduce an incompatible change for now.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Given that this is a new API, I am not sure handling concurrent modification and ignoring deleted directories is a real backward compatibility issue for mapreduce. Mapreduce folks can comment about what is more suitable. We can address this issue in a separate jira though.&lt;/p&gt;</comment>
                            <comment id="12897092" author="sanjay.radia" created="Wed, 11 Aug 2010 00:18:37 +0000"  >&lt;p&gt;&amp;gt;I do not want to introduce an incompatible change for now.&lt;br/&gt;
I don&apos;t understand the compatibility argument since this is new API.&lt;/p&gt;

&lt;p&gt;We could add a parameter to indicate whether or not continue if a change in the sub-tree has occurred. &lt;br/&gt;
I can live with that as long as folks not interpret it to mean that the list returned is atomic - if a subdir&apos;s content has been &lt;br/&gt;
returned then the iterator will not detect it.&lt;br/&gt;
Hairong&apos;s patch can go though as Suresh has suggested and we can file another one to finalize this API. &lt;/p&gt;

</comment>
                            <comment id="12897099" author="hairong" created="Wed, 11 Aug 2010 00:26:06 +0000"  >&lt;p&gt;&amp;gt; I don&apos;t understand the compatibility argument since this is new API.&lt;/p&gt;

&lt;p&gt;Even though this is a new API, but mapreduce already has some logic in their code traversing the input directories and getting file status/block locations. Existing code does not allow any concurrent modification to input directories.&lt;/p&gt;

&lt;p&gt;I agree that allowing concurrent modification could be an option, but lets do it in a different jira.&lt;/p&gt;</comment>
                            <comment id="12897132" author="hairong" created="Wed, 11 Aug 2010 04:26:35 +0000"  >&lt;p&gt;Ant test-patch result:&lt;/p&gt;

&lt;p&gt;     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; -1 overall.  &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 @author.  The patch does not contain any @author tags.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 tests included.  The patch appears to include 12 new or modified tests.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     -1 javadoc.  The javadoc tool appears to have generated 1 warning messages.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 javac.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;   The applied patch does not increase the total number of javac compiler warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;Javadoc warnings are not related to this patch.&lt;/p&gt;

&lt;p&gt;Ant test:&lt;br/&gt;
BUILD SUCCESSFUL&lt;br/&gt;
Total time: 11 minutes 2 seconds&lt;/p&gt;</comment>
                            <comment id="12897135" author="hairong" created="Wed, 11 Aug 2010 04:45:26 +0000"  >&lt;p&gt;I&apos;ve just committed this!&lt;/p&gt;</comment>
                            <comment id="12897142" author="hudson" created="Wed, 11 Aug 2010 05:10:13 +0000"  >&lt;p&gt;Integrated in Hadoop-Common-trunk-Commit #356 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Common-trunk-Commit/356/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Common-trunk-Commit/356/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-6900&quot; title=&quot;FileSystem#listLocatedStatus should not throw generic RuntimeException to indicate error conditions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-6900&quot;&gt;&lt;del&gt;HADOOP-6900&lt;/del&gt;&lt;/a&gt;. Make the iterator returned by FileSystem#listLocatedStatus to throw IOException rather than RuntimeException when there is an IO error fetching the next file. Contributed by Hairong Kuang.&lt;/p&gt;</comment>
                            <comment id="12897389" author="shv" created="Wed, 11 Aug 2010 18:57:46 +0000"  >&lt;p&gt;Hairong. You changed the prototype of &lt;tt&gt;AbstractFileSystem.listStatusIterator(Path)&lt;/tt&gt; but did not change its overloaded version &lt;tt&gt;Hdfs.listStatusIterator(Path)&lt;/tt&gt;. Could you please fix it, as current build is broken as it is.&lt;/p&gt;</comment>
                            <comment id="12897437" author="hairong" created="Wed, 11 Aug 2010 20:31:46 +0000"  >&lt;p&gt;Yes, I can not change HDFS in common but have to do it in &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-202&quot; title=&quot;Add a bulk FIleSystem.getFileBlockLocations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-202&quot;&gt;&lt;del&gt;HDFS-202&lt;/del&gt;&lt;/a&gt;. This is side effect of having fs in common. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12469859">HADOOP-6870</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12451397" name="listFilesIO.patch" size="20733" author="hairong" created="Fri, 6 Aug 2010 00:03:51 +0000"/>
                            <attachment id="12451636" name="listFilesIO1.patch" size="25938" author="hairong" created="Tue, 10 Aug 2010 00:19:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>77611</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 15 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hytb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>102902</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>