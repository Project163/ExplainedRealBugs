<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:47:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-11523] StorageException complaining &quot; no lease ID&quot; when updating FolderLastModifiedTime in WASB</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-11523</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;In current WASB (Windows Azure Storage - Blob) implementation, when rename operation succeeds, WASB will update the parent folder&apos;s &quot;last modified time&quot; property. By default we do not acquire lease on this folder when updating its property and simply pass &quot;null&quot; to it.&lt;/p&gt;

&lt;p&gt;In HBase scenario, when doing distributed log splitting, there might be a case that multiple processes from different region servers will access the same folder, and randomly we will see this exception in regionserver&apos;s log, which makes log splitting fail.&lt;/p&gt;

&lt;p&gt;So we should acquire the lease when updating the folder property rather than pass &quot;null&quot; to it.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR org.apache.hadoop.hbase.regionserver.wal.HLogSplitter: Couldn&apos;t rename wasb:&lt;span class=&quot;code-comment&quot;&gt;//xxx/hbase/data/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/tdelrowtbl/3c842e8823c192d1028dc72ac3f22886/recovered.edits/0000000000000000015.temp to wasb://xxx/hbase/data/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/tdelrowtbl/3c842e8823c192d1028dc72ac3f22886/recovered.edits/0000000000000000015
&lt;/span&gt;org.apache.hadoop.fs.azure.AzureException: com.microsoft.windowsazure.storage.StorageException: There is currently a lease on the blob and no lease ID was specified in the request.
	at org.apache.hadoop.fs.azurenative.AzureNativeFileSystemStore.updateFolderLastModifiedTime(AzureNativeFileSystemStore.java:2558)
	at org.apache.hadoop.fs.azurenative.AzureNativeFileSystemStore.updateFolderLastModifiedTime(AzureNativeFileSystemStore.java:2569)
	at org.apache.hadoop.fs.azurenative.NativeAzureFileSystem.updateParentFolderLastModifiedTime(NativeAzureFileSystem.java:2016)
	at org.apache.hadoop.fs.azurenative.NativeAzureFileSystem.rename(NativeAzureFileSystem.java:1983)
	at org.apache.hadoop.hbase.regionserver.wal.HLogSplitter$LogRecoveredEditsOutputSink$2.call(HLogSplitter.java:1161)
	at org.apache.hadoop.hbase.regionserver.wal.HLogSplitter$LogRecoveredEditsOutputSink$2.call(HLogSplitter.java:1121)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12771082">HADOOP-11523</key>
            <summary>StorageException complaining &quot; no lease ID&quot; when updating FolderLastModifiedTime in WASB</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="onpduo">Duo Xu</assignee>
                                    <reporter username="onpduo">Duo Xu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Jan 2015 18:57:37 +0000</created>
                <updated>Thu, 22 Oct 2015 00:48:25 +0000</updated>
                            <resolved>Fri, 30 Jan 2015 01:08:39 +0000</resolved>
                                                    <fixVersion>2.7.0</fixVersion>
                                    <component>tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14297388" author="onpduo" created="Thu, 29 Jan 2015 19:17:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cnauroth&quot; class=&quot;user-hover&quot; rel=&quot;cnauroth&quot;&gt;cnauroth&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Could you take a look?&lt;/p&gt;</comment>
                            <comment id="14297422" author="thomas.jungblut" created="Thu, 29 Jan 2015 19:42:00 +0000"  >&lt;p&gt;Good catch Duo. Thanks for fixing this.&lt;/p&gt;</comment>
                            <comment id="14297468" author="hadoopqa" created="Thu, 29 Jan 2015 20:03:54 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12695335/HADOOP-11523.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12695335/HADOOP-11523.1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 89b0749.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  There were no new javadoc warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;        &lt;font color=&quot;red&quot;&gt;-1 release audit&lt;/font&gt;.  The applied patch generated 1 release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-tools/hadoop-azure.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5536//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5536//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5536//artifact/patchprocess/patchReleaseAuditProblems.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5536//artifact/patchprocess/patchReleaseAuditProblems.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5536//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5536//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14297656" author="cnauroth" created="Thu, 29 Jan 2015 20:57:59 +0000"  >&lt;p&gt;Hi Duo.  Thank you for the patch.&lt;/p&gt;

&lt;p&gt;The current patch would acquire the lease for all &lt;tt&gt;rename&lt;/tt&gt; operations, covering both block blobs and page blobs.  During initial development of atomic rename, we were careful to limit the scope to only page blobs (typically used by HBase logs).  Existing applications using block blobs might not be expecting the leases, so I think we need to make sure the lease acquisition only happens after checking &lt;tt&gt;AzureNativeFileSystemStore#isAtomicRenameKey&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;In the error handling, if an exception is thrown from the try block, and then another exception is also thrown from freeing the lease, then this would drop the original exception and throw the exception from freeing the lease.  I suspect in general the main exception from the try block is going to be more interesting for root cause analysis, so I recommend throwing that one and just logging the one from freeing the lease, like so:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
          &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (lease != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
              lease.free();
            }
          } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
            LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unable to free lease on &quot;&lt;/span&gt; + parentKey, e);
          }
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In addition to the unit tests, I ran the test suite against a live Azure storage account and confirmed that everything passed.&lt;/p&gt;

&lt;p&gt;The release audit warning from Jenkins is unrelated to this patch.&lt;/p&gt;</comment>
                            <comment id="14297697" author="onpduo" created="Thu, 29 Jan 2015 21:19:46 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cnauroth&quot; class=&quot;user-hover&quot; rel=&quot;cnauroth&quot;&gt;cnauroth&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Current HBase clusters in Azure, our configuration is&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;Name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;fs.azure.page.blob.dir&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;Value&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;\/hbase\/WALs,\/hbase\/oldWALs&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the exception above, WASB tried to update folder/blob &quot;hbase/data/default/tdelrowtbl/3c842e8823c192d1028dc72ac3f22886/recovered.edits&quot;. This is apparently not a page blob. So lease acquisition is needed in block blob, at least for HBase.&lt;/p&gt;

&lt;p&gt;For the error handling, agree and I have attached a new patch.&lt;/p&gt;</comment>
                            <comment id="14297724" author="cnauroth" created="Thu, 29 Jan 2015 21:36:29 +0000"  >&lt;blockquote&gt;&lt;p&gt;This is apparently not a page blob.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sorry, I mixed up 2 different concepts: page blobs and atomic rename.  If a path is configured for atomic rename, that doesn&apos;t necessarily imply that it&apos;s a page blob.&lt;/p&gt;

&lt;p&gt;What is your setting for &lt;tt&gt;fs.azure.atomic.rename.dir&lt;/tt&gt;?  I suspect it covers the path that you mentioned.  This is why I suggested a check on &lt;tt&gt;AzureNativeFileSystemStore#isAtomicRenameKey&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="14297764" author="hadoopqa" created="Thu, 29 Jan 2015 21:54:07 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12695364/HADOOP-11523.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12695364/HADOOP-11523.2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision ad55083.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  There were no new javadoc warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;        &lt;font color=&quot;red&quot;&gt;-1 release audit&lt;/font&gt;.  The applied patch generated 1 release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-tools/hadoop-azure.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5537//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5537//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5537//artifact/patchprocess/patchReleaseAuditProblems.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5537//artifact/patchprocess/patchReleaseAuditProblems.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5537//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5537//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14297781" author="onpduo" created="Thu, 29 Jan 2015 22:02:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cnauroth&quot; class=&quot;user-hover&quot; rel=&quot;cnauroth&quot;&gt;cnauroth&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I looked at AzureNativeFileSystemStore#isAtomicRenameKey, it will check if the key is in the set of atomicRenameDirs. And from AzureNativeFileSystemStore#initialize, I saw it will add hbase root dir into it. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;      &lt;span class=&quot;code-comment&quot;&gt;// Add to &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; the hbase root directory, or /hbase is that is not set.
&lt;/span&gt;      hbaseRoot = verifyAndConvertToStandardFormat(
          sessionConfiguration.get(&lt;span class=&quot;code-quote&quot;&gt;&quot;hbase.rootdir&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;hbase&quot;&lt;/span&gt;));
      atomicRenameDirs.add(hbaseRoot);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This means all HBase folders are eligible for atomic rename, right? For fs.azure.atomic.rename.dir, in our PROD clusters, it is not set. So atomicRenameDirs only contains &quot;/hbase&quot;.&lt;/p&gt;

&lt;p&gt;In this way, I am OK to add it, so that lease acquisition e will only apply to folders under /hbase.&lt;/p&gt;

&lt;p&gt;I have updated the patch.&lt;/p&gt;</comment>
                            <comment id="14297835" author="hadoopqa" created="Thu, 29 Jan 2015 22:43:50 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12695371/HADOOP-11523.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12695371/HADOOP-11523.3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision ad55083.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  There were no new javadoc warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;        &lt;font color=&quot;red&quot;&gt;-1 release audit&lt;/font&gt;.  The applied patch generated 1 release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-tools/hadoop-azure.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5538//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5538//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5538//artifact/patchprocess/patchReleaseAuditProblems.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5538//artifact/patchprocess/patchReleaseAuditProblems.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5538//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5538//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14297916" author="cnauroth" created="Thu, 29 Jan 2015 23:46:09 +0000"  >&lt;p&gt;Thanks, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=onpduo&quot; class=&quot;user-hover&quot; rel=&quot;onpduo&quot;&gt;onpduo&lt;/a&gt;.  I have just 2 more minor nitpicks.  I suggest changing this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;              LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unable to free lease on &quot;&lt;/span&gt; + parentKey);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;to this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;              LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unable to free lease on &quot;&lt;/span&gt; + parentKey, e);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This way, we&apos;ll log the full stack trace on lease free errors and have more information for troubleshooting.&lt;/p&gt;

&lt;p&gt;This is just a minor style point, but for the following, the keyword should be inline with the closing brace.  Instead of this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;          }
          &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We do this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;          } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Instead of this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        }
        &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We do this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14297926" author="onpduo" created="Thu, 29 Jan 2015 23:52:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cnauroth&quot; class=&quot;user-hover&quot; rel=&quot;cnauroth&quot;&gt;cnauroth&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks for pointing these out. I have updated the patch.&lt;/p&gt;</comment>
                            <comment id="14297930" author="cnauroth" created="Thu, 29 Jan 2015 23:53:38 +0000"  >&lt;p&gt;+1 for patch v4 pending a fresh Jenkins run.&lt;/p&gt;</comment>
                            <comment id="14297964" author="hadoopqa" created="Fri, 30 Jan 2015 00:34:04 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12695400/HADOOP-11523.4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12695400/HADOOP-11523.4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision e36ef3b.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  There were no new javadoc warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;        &lt;font color=&quot;red&quot;&gt;-1 release audit&lt;/font&gt;.  The applied patch generated 1 release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-tools/hadoop-azure.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5541//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5541//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5541//artifact/patchprocess/patchReleaseAuditProblems.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5541//artifact/patchprocess/patchReleaseAuditProblems.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/5541//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/5541//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14298011" author="cnauroth" created="Fri, 30 Jan 2015 01:08:39 +0000"  >&lt;p&gt;I have committed this to trunk and branch-2.  Duo, thank you for the contribution.&lt;/p&gt;</comment>
                            <comment id="14298020" author="hudson" created="Fri, 30 Jan 2015 01:15:14 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-trunk-Commit #6968 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-trunk-Commit/6968/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-trunk-Commit/6968/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-11523&quot; title=&quot;StorageException complaining &amp;quot; no lease ID&amp;quot; when updating FolderLastModifiedTime in WASB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-11523&quot;&gt;&lt;del&gt;HADOOP-11523&lt;/del&gt;&lt;/a&gt;. StorageException complaining &quot; no lease ID&quot; when updating FolderLastModifiedTime in WASB. Contributed by Duo Xu. (cnauroth: rev f2c91098c400da6db0f5e8e49e9bf0e6444af531)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;hadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azure/NativeAzureFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14298456" author="hudson" created="Fri, 30 Jan 2015 10:41:08 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Yarn-trunk-Java8 #89 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Yarn-trunk-Java8/89/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Yarn-trunk-Java8/89/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-11523&quot; title=&quot;StorageException complaining &amp;quot; no lease ID&amp;quot; when updating FolderLastModifiedTime in WASB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-11523&quot;&gt;&lt;del&gt;HADOOP-11523&lt;/del&gt;&lt;/a&gt;. StorageException complaining &quot; no lease ID&quot; when updating FolderLastModifiedTime in WASB. Contributed by Duo Xu. (cnauroth: rev f2c91098c400da6db0f5e8e49e9bf0e6444af531)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;hadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azure/NativeAzureFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14298474" author="hudson" created="Fri, 30 Jan 2015 10:44:22 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Yarn-trunk #823 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Yarn-trunk/823/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Yarn-trunk/823/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-11523&quot; title=&quot;StorageException complaining &amp;quot; no lease ID&amp;quot; when updating FolderLastModifiedTime in WASB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-11523&quot;&gt;&lt;del&gt;HADOOP-11523&lt;/del&gt;&lt;/a&gt;. StorageException complaining &quot; no lease ID&quot; when updating FolderLastModifiedTime in WASB. Contributed by Duo Xu. (cnauroth: rev f2c91098c400da6db0f5e8e49e9bf0e6444af531)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azure/NativeAzureFileSystem.java&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14298655" author="hudson" created="Fri, 30 Jan 2015 14:15:34 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Hdfs-trunk #2021 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-trunk/2021/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-trunk/2021/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-11523&quot; title=&quot;StorageException complaining &amp;quot; no lease ID&amp;quot; when updating FolderLastModifiedTime in WASB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-11523&quot;&gt;&lt;del&gt;HADOOP-11523&lt;/del&gt;&lt;/a&gt;. StorageException complaining &quot; no lease ID&quot; when updating FolderLastModifiedTime in WASB. Contributed by Duo Xu. (cnauroth: rev f2c91098c400da6db0f5e8e49e9bf0e6444af531)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azure/NativeAzureFileSystem.java&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14298672" author="hudson" created="Fri, 30 Jan 2015 14:18:37 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Hdfs-trunk-Java8 #86 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-trunk-Java8/86/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-trunk-Java8/86/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-11523&quot; title=&quot;StorageException complaining &amp;quot; no lease ID&amp;quot; when updating FolderLastModifiedTime in WASB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-11523&quot;&gt;&lt;del&gt;HADOOP-11523&lt;/del&gt;&lt;/a&gt;. StorageException complaining &quot; no lease ID&quot; when updating FolderLastModifiedTime in WASB. Contributed by Duo Xu. (cnauroth: rev f2c91098c400da6db0f5e8e49e9bf0e6444af531)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;hadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azure/NativeAzureFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14298714" author="hudson" created="Fri, 30 Jan 2015 15:05:47 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Mapreduce-trunk-Java8 #90 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Java8/90/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Java8/90/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-11523&quot; title=&quot;StorageException complaining &amp;quot; no lease ID&amp;quot; when updating FolderLastModifiedTime in WASB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-11523&quot;&gt;&lt;del&gt;HADOOP-11523&lt;/del&gt;&lt;/a&gt;. StorageException complaining &quot; no lease ID&quot; when updating FolderLastModifiedTime in WASB. Contributed by Duo Xu. (cnauroth: rev f2c91098c400da6db0f5e8e49e9bf0e6444af531)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;hadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azure/NativeAzureFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14298749" author="hudson" created="Fri, 30 Jan 2015 15:26:51 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Mapreduce-trunk #2040 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/2040/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/2040/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-11523&quot; title=&quot;StorageException complaining &amp;quot; no lease ID&amp;quot; when updating FolderLastModifiedTime in WASB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-11523&quot;&gt;&lt;del&gt;HADOOP-11523&lt;/del&gt;&lt;/a&gt;. StorageException complaining &quot; no lease ID&quot; when updating FolderLastModifiedTime in WASB. Contributed by Duo Xu. (cnauroth: rev f2c91098c400da6db0f5e8e49e9bf0e6444af531)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;hadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azure/NativeAzureFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12780188">HADOOP-11685</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12837910">HADOOP-12089</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12695335" name="HADOOP-11523.1.patch" size="1801" author="onpduo" created="Thu, 29 Jan 2015 19:16:01 +0000"/>
                            <attachment id="12695364" name="HADOOP-11523.2.patch" size="1729" author="onpduo" created="Thu, 29 Jan 2015 21:17:48 +0000"/>
                            <attachment id="12695371" name="HADOOP-11523.3.patch" size="1890" author="onpduo" created="Thu, 29 Jan 2015 22:02:12 +0000"/>
                            <attachment id="12695400" name="HADOOP-11523.4.patch" size="1873" author="onpduo" created="Thu, 29 Jan 2015 23:51:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 42 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i24yt3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12327583">2.7.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>