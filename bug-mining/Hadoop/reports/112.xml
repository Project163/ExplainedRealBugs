<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:32:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-6521] FsPermission:SetUMask not updated to use new-style umask setting.</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-6521</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;FsPermission:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;221   &lt;span class=&quot;code-comment&quot;&gt;/** Set the user file creation mask (umask) */&lt;/span&gt;
222   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void setUMask(Configuration conf, FsPermission umask) {                                    
223     conf.setInt(UMASK_LABEL, umask.toShort());
224   }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Needs to be updated to not use a decimal value. This is a bug introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-6234&quot; title=&quot;Permission configuration files should use octal and symbolic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-6234&quot;&gt;&lt;del&gt;HADOOP-6234&lt;/del&gt;&lt;/a&gt;.  &lt;/p&gt;</description>
                <environment></environment>
        <key id="12447039">HADOOP-6521</key>
            <summary>FsPermission:SetUMask not updated to use new-style umask setting.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sureshms">Suresh Srinivas</assignee>
                                    <reporter username="jghoman">Jakob Homan</reporter>
                        <labels>
                    </labels>
                <created>Fri, 29 Jan 2010 19:26:56 +0000</created>
                <updated>Thu, 2 May 2013 02:29:30 +0000</updated>
                            <resolved>Sat, 24 Apr 2010 00:02:17 +0000</resolved>
                                    <version>0.21.0</version>
                    <version>0.22.0</version>
                                    <fixVersion>0.21.0</fixVersion>
                                    <component>fs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="12828306" author="sureshms" created="Mon, 1 Feb 2010 22:21:39 +0000"  >&lt;p&gt;Patch for release 20 attached. The approach is:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;To ensure backward compatibility, when applications use the old key &quot;dfs.umask&quot; and the server default has &quot;dfs.umaskmode&quot;, old key overrides the new key. That is first the old key is used for getting umask and then the new key.&lt;/li&gt;
	&lt;li&gt;FsPermission.setUMask(Configuration conf, FsPermission umask) currently has a bug. When setting the &quot;dfs.umaskmode&quot; param in the configuration, it should convert the umask decimal value to octal.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;This patch is not applicable to release 21, since it uses deprecation mechanism introduced in Hadoop-6105 and more work is needed to make this solution work in that realm.&lt;/p&gt;</comment>
                            <comment id="12828312" author="sureshms" created="Mon, 1 Feb 2010 22:37:45 +0000"  >&lt;p&gt;Ran some manual tests just to verify the fix. Set in the hdfs-site.xml &quot;dfs.umaskmode&quot; as 077 and run the following tests:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;bin/hadoop dfs -put /tmp/test /tmp/test; bin/hadoop dfs -ls /tmp/test;bin/hadoop dfs -rmr /tmp/test
	&lt;ul&gt;
		&lt;li&gt;File mode should be &lt;tt&gt;&amp;#45;rw-------&lt;/tt&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;bin/hadoop dfs -Ddfs.umask=18 -put /tmp/test /tmp/test; bin/hadoop dfs -ls /tmp/test;bin/hadoop dfs -rmr /tmp/test
	&lt;ul&gt;
		&lt;li&gt;File mode should be &lt;tt&gt;&amp;#45;rw-r-&amp;#45;r--&lt;/tt&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;bin/hadoop dfs -Ddfs.umaskmode=222 -put /tmp/test /tmp/test; bin/hadoop dfs -ls /tmp/test;bin/hadoop dfs -rmr /tmp/test
	&lt;ul&gt;
		&lt;li&gt;File mode should be &lt;tt&gt;&amp;#45;r-&amp;#45;r-&amp;#45;r--&lt;/tt&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ol&gt;


</comment>
                            <comment id="12828317" author="szetszwo" created="Mon, 1 Feb 2010 22:53:28 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I think it is better to update both UMASK_LABEL and DEPRECATED_UMASK_LABEL in setUMask(..).&lt;/li&gt;
	&lt;li&gt;Also when both UMASK_LABEL and DEPRECATED_UMASK_LABEL are set in conf and they have different values, should we throw an exception?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12828328" author="sureshms" created="Mon, 1 Feb 2010 23:27:13 +0000"  >&lt;p&gt;&amp;gt; I think it is better to update both UMASK_LABEL and DEPRECATED_UMASK_LABEL in setUMask(..).&lt;br/&gt;
sounds reasonable. Though only one of them is going to be used&lt;/p&gt;

&lt;p&gt;&amp;gt; Also when both UMASK_LABEL and DEPRECATED_UMASK_LABEL are set in conf and they have different values, should we throw an exception?&lt;br/&gt;
In release 20, the server config will be setup with UMASK_LABEL. The user can override the default by:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Calling FsPermission.setUMask() (this has been addressed)&lt;/li&gt;
	&lt;li&gt;By setting configuration param either by calling conf.set() or by specifying umask in command line (see manual tests posted above).&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Given that I think we should allow these two configurations to have separate value. Further, giving higher priority to deprecated key, assuming the user is likely to use it is the right choice. If the user happens to use the new key there is no conflict.&lt;/p&gt;</comment>
                            <comment id="12828331" author="sureshms" created="Mon, 1 Feb 2010 23:30:07 +0000"  >&lt;p&gt;New patch addresses comments from Nicholas.&lt;/p&gt;</comment>
                            <comment id="12828337" author="jghoman" created="Mon, 1 Feb 2010 23:47:34 +0000"  >&lt;p&gt;Setting both is a good approach, but will have the unfortunate side effect that if the user is correctly using the new key, the old key will also be set and the user will then get undeserved deprecation warnings.  An offline discussion c/ Nicholas and Suresh suggests that comparing the values of both the old and new keys may miss some valid cases where a warning is warranted, but will avoid invalid warnings. This is probably the best approach to take.&lt;/p&gt;</comment>
                            <comment id="12828340" author="sureshms" created="Mon, 1 Feb 2010 23:57:13 +0000"  >&lt;p&gt;New patch addresses comments from Jakob and Nicholas.&lt;/p&gt;</comment>
                            <comment id="12828352" author="sureshms" created="Tue, 2 Feb 2010 00:08:45 +0000"  >&lt;p&gt;New patch.&lt;/p&gt;</comment>
                            <comment id="12828365" author="szetszwo" created="Tue, 2 Feb 2010 00:17:57 +0000"  >&lt;p&gt;+1 the new patch looks good.&lt;/p&gt;</comment>
                            <comment id="12857612" author="sureshms" created="Fri, 16 Apr 2010 00:25:58 +0000"  >&lt;p&gt;Changes in the patch:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Symbolic and octal umask mode was added configurable with param name &quot;dfs.umaskmode&quot;. It deprecates the old param &quot;dfs.umask&quot;. Previously for backward compatibility new deprecation mechanism introduced in 0.21 was used. This mechanism is useful when a config param name changes, to map the old config name to the new. However in case of umask, the semantics of the param also changes. Old param expects decimal value and the new param  expects symbolic or octal value. The deprecation mechanism in addition to mapping old to new names, must also translated the old value to new value. Given the lack of this capability, umask will no longer use config deprecation mechanism.&lt;/li&gt;
&lt;/ol&gt;


&lt;ol&gt;
	&lt;li&gt;Following changes from 0.20 version of the patch is carried forward, with the exception of test changes. Test changes are needed in HDFS. I will created a separate jira for that.
&lt;blockquote&gt;
&lt;p&gt;    1.  To ensure backward compatibility, when applications use the old key &quot;dfs.umask&quot; and the server default has &quot;dfs.umaskmode&quot;, old key overrides the new key. That is first the old key is used for getting umask and then the new key.&lt;br/&gt;
   2. FsPermission.setUMask(Configuration conf, FsPermission umask) currently has a bug. When setting the &quot;dfs.umaskmode&quot; param in the configuration, it should convert the umask decimal value to octal.&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="12860338" author="jghoman" created="Fri, 23 Apr 2010 18:12:07 +0000"  >&lt;p&gt;If we&apos;re - correctly - not using the deprecatedKeyWasSet method, and this was the only place it was used and it&apos;s not yet been released, might we just as well remove it?  Otherwise it&apos;s an unused, potentially buggy API.  Otherwise, +1.&lt;/p&gt;</comment>
                            <comment id="12860382" author="sureshms" created="Fri, 23 Apr 2010 21:26:45 +0000"  >&lt;p&gt;Removed deprecateKeyWasSet() method and related tests.&lt;/p&gt;</comment>
                            <comment id="12860389" author="hadoopqa" created="Fri, 23 Apr 2010 21:43:32 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12442708/hadoop-6521.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12442708/hadoop-6521.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 937183.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/50/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/50/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/50/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/50/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/50/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/50/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/50/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/50/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12860400" author="sureshms" created="Fri, 23 Apr 2010 22:08:10 +0000"  >&lt;p&gt;Attaching the right patch.&lt;/p&gt;</comment>
                            <comment id="12860404" author="hadoopqa" created="Fri, 23 Apr 2010 22:23:58 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12442715/hadoop-6521.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12442715/hadoop-6521.1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 937183.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/51/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/51/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/51/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/51/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/51/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/51/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/51/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/51/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12860432" author="sureshms" created="Sat, 24 Apr 2010 00:02:17 +0000"  >&lt;p&gt;I committed this change.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12401189">HADOOP-6234</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12462200">HDFS-1099</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12441897" name="ASF.LICENSE.NOT.GRANTED--hadoop-6521.patch" size="6127" author="sureshms" created="Fri, 16 Apr 2010 00:25:58 +0000"/>
                            <attachment id="12442715" name="hadoop-6521.1.patch" size="8326" author="sureshms" created="Fri, 23 Apr 2010 22:08:10 +0000"/>
                            <attachment id="12442708" name="hadoop-6521.patch" size="22743" author="sureshms" created="Fri, 23 Apr 2010 21:26:45 +0000"/>
                            <attachment id="12434469" name="hadoop-6521.rel20.1.patch" size="4261" author="sureshms" created="Tue, 2 Feb 2010 00:08:45 +0000"/>
                            <attachment id="12434458" name="hadoop-6521.rel20.patch" size="4224" author="sureshms" created="Mon, 1 Feb 2010 23:57:13 +0000"/>
                            <attachment id="12434450" name="hadoop-6521.rel20.patch" size="4224" author="sureshms" created="Mon, 1 Feb 2010 23:30:07 +0000"/>
                            <attachment id="12434443" name="hadoop-6521.rel20.patch" size="4224" author="sureshms" created="Mon, 1 Feb 2010 22:21:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37176</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 31 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02rlj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>14072</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>