<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:58:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-19339] OutofBounds Exception due to assumption about buffer size in BlockCompressorStream</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-19339</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;h3&gt;&lt;a name=&quot;WhatHappened%3A%C2%A0&quot;&gt;&lt;/a&gt;What Happened:&#160;&lt;/h3&gt;

&lt;p&gt;Got an OutofBounds exception when io.compression.codec.snappy.buffersize is set to 7. BlockCompressorStream assumes that the buffer size will always be greater than the compression overhead, and consequently MAX_INPUT_SIZE will always be greater than or equal to 0.&#160;&lt;/p&gt;
&lt;h3&gt;&lt;a name=&quot;BuggyCode%3A%C2%A0&quot;&gt;&lt;/a&gt;Buggy Code:&#160;&lt;/h3&gt;

&lt;p&gt;When io.compression.codec.snappy.buffersize is set to 7, compressionOverhead is 33 and MAX_INPUT_SIZE is -26.&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; BlockCompressorStream(OutputStream out, Compressor compressor, 
                             &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; bufferSize, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; compressionOverhead) {
  &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;(out, compressor, bufferSize);
  MAX_INPUT_SIZE = bufferSize - compressionOverhead; &lt;span class=&quot;code-comment&quot;&gt;// -&amp;gt; Assumes bufferSize is always greater than compressionOverhead and MAX_INPUT_SIZE is non-negative. 
&lt;/span&gt;} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;h3&gt;&lt;a name=&quot;StackTrace%3A%C2%A0&quot;&gt;&lt;/a&gt;Stack Trace:&#160;&lt;/h3&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.ArrayIndexOutOfBoundsException
&#160; &#160; &#160; &#160; at org.apache.hadoop.io.compress.snappy.SnappyCompressor.setInput(SnappyCompressor.java:86)
&#160; &#160; &#160; &#160; at org.apache.hadoop.io.compress.BlockCompressorStream.write(BlockCompressorStream.java:112) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;h3&gt;&lt;a name=&quot;HowtoReproduce%3A%C2%A0&quot;&gt;&lt;/a&gt;How to Reproduce:&#160;&lt;/h3&gt;

&lt;p&gt;(1) Set io.compression.codec.snappy.buffersize to 7&lt;/p&gt;

&lt;p&gt;(2) Run test: org.apache.hadoop.io.compress.TestCodec#testSnappyMapFile&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13599057">HADOOP-19339</key>
            <summary>OutofBounds Exception due to assumption about buffer size in BlockCompressorStream</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="FuzzingTeam">ConfX</assignee>
                                    <reporter username="FuzzingTeam">ConfX</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 18 Nov 2024 01:53:50 +0000</created>
                <updated>Sun, 8 Dec 2024 10:44:50 +0000</updated>
                            <resolved>Sun, 8 Dec 2024 10:44:38 +0000</resolved>
                                    <version>3.4.1</version>
                                    <fixVersion>3.5.0</fixVersion>
                                    <component>common</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17903872" author="githubbot" created="Sun, 8 Dec 2024 10:44:07 +0000"  >&lt;p&gt;Hexiaoqiao merged PR #7167:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/hadoop/pull/7167&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hadoop/pull/7167&lt;/a&gt;&lt;/p&gt;

</comment>
                            <comment id="17903873" author="githubbot" created="Sun, 8 Dec 2024 10:44:23 +0000"  >&lt;p&gt;Hexiaoqiao commented on PR #7167:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/hadoop/pull/7167#issuecomment-2525584743&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hadoop/pull/7167#issuecomment-2525584743&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   Committed to trunk. Thanks @teamconfx &lt;/p&gt;

</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            48 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1slv4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12354173">3.4.1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>