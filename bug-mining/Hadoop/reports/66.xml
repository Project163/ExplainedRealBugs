<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:32:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-5901] FileSystem.fixName() has unexpected behaviour</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-5901</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;&lt;tt&gt;FileSystem.fixName()&lt;/tt&gt; tries to patch up fs.default.name values, but I&apos;m not sure it helps that well. &lt;/p&gt;

&lt;p&gt;Has it been warning about deprecated values for long enough for it to be turned off? &lt;/p&gt;</description>
                <environment></environment>
        <key id="12426148">HADOOP-5901</key>
            <summary>FileSystem.fixName() has unexpected behaviour</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="kimballa">Aaron Kimball</assignee>
                                    <reporter username="stevel@apache.org">Steve Loughran</reporter>
                        <labels>
                            <label>newbie</label>
                    </labels>
                <created>Fri, 22 May 2009 20:26:15 +0000</created>
                <updated>Tue, 22 Jul 2014 19:59:09 +0000</updated>
                                            <version>0.21.0</version>
                                                    <component>fs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                                                                <comments>
                            <comment id="12712239" author="steve_l" created="Fri, 22 May 2009 20:29:05 +0000"  >&lt;p&gt;examples&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;fixName(&quot;&quot;) = &quot;hdfs://&quot; // invalid URI at parse time&lt;br/&gt;
fixName(&quot;/something-with-a-slash&quot;)  = &quot;/something-with-a-slash&quot; // invalid URI at parse time&lt;/p&gt;

&lt;p&gt;where it does work is mapping &quot;local&quot; to &quot;file:///&quot; and  fixName(&quot;real-hostname&quot;) -&amp;gt; &quot;hdfs://real-hostname&quot;. &lt;/p&gt;

&lt;p&gt;If it is to be retained, the empty string and / handing should be looked at and ideally dropped. &lt;/p&gt;</comment>
                            <comment id="12768917" author="kimballa" created="Thu, 22 Oct 2009 21:24:42 +0000"  >&lt;p&gt;Worse than that &amp;#8211; setting &lt;tt&gt;fs.default.name&lt;/tt&gt; to &lt;tt&gt;&quot;/foo&quot;&lt;/tt&gt; actually causes a stack overflow in FileSystem.get(). It never makes it to &lt;tt&gt;fixName()&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="12768920" author="cutting" created="Thu, 22 Oct 2009 21:31:57 +0000"  >&lt;p&gt;I think this has been generating warnings long enough.  Setting fs.default.name to a URI with a null scheme should be an error.&lt;/p&gt;</comment>
                            <comment id="12768922" author="kimballa" created="Thu, 22 Oct 2009 21:35:01 +0000"  >&lt;p&gt;Anyway, given that &lt;tt&gt;fs.default.name&lt;/tt&gt; itself is deprecated at this point, I&apos;m +1 on removing the whole &lt;tt&gt;fixName()&lt;/tt&gt; method.&lt;/p&gt;

&lt;p&gt;I&apos;ll submit a patch which makes FileSystem in general a bit more strict about its inputs, and fixes the aforementioned stack overflow.&lt;/p&gt;</comment>
                            <comment id="12768989" author="kimballa" created="Fri, 23 Oct 2009 00:21:16 +0000"  >&lt;p&gt;Attaching a patch which removes &lt;tt&gt;fixName&lt;/tt&gt; and adds &lt;tt&gt;checkName&lt;/tt&gt; in its place. Added unit tests that check a variety of potential default fs URLs and make sure that &lt;tt&gt;FileSystem.get()&lt;/tt&gt; still returns something reasonable (e.g., the FileSystem associated with the &lt;tt&gt;DEFAULT_FS&lt;/tt&gt; URI).&lt;/p&gt;

&lt;p&gt;The aforementioned stack overflow is prevented by this patch.&lt;/p&gt;

&lt;p&gt;Locally, I get the following from test-patch:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;     [exec] +1 overall.  
     [exec] 
     [exec]     +1 @author.  The patch does not contain any @author tags.
     [exec] 
     [exec]     +1 tests included.  The patch appears to include 3 &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; or modified tests.
     [exec] 
     [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.
     [exec] 
     [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.
     [exec] 
     [exec]     +1 findbugs.  The patch does not introduce any &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Findbugs warnings.
     [exec] 
     [exec]     +1 release audit.  The applied patch does not increase the total number of release audit warnings.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12769013" author="hadoopqa" created="Fri, 23 Oct 2009 01:28:24 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12422974/HADOOP-5901.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12422974/HADOOP-5901.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 828886.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/103/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/103/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/103/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/103/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/103/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/103/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/103/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/103/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12769168" author="vinodkv" created="Fri, 23 Oct 2009 10:32:47 +0000"  >&lt;blockquote&gt;&lt;p&gt;Worse than that - setting fs.default.name to &quot;/foo&quot; actually causes a stack overflow in FileSystem.get(). It never makes it to fixName(). &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Aaron, can you please see if &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-51&quot; title=&quot;dfs client throws java.lang.StackOverflowError in a corner case.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-51&quot;&gt;&lt;del&gt;HDFS-51&lt;/del&gt;&lt;/a&gt; is the same issue? If yes, can you close that as duplicate? One less open issue &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Thanks!&lt;/p&gt;</comment>
                            <comment id="12769360" author="kimballa" created="Fri, 23 Oct 2009 18:52:35 +0000"  >&lt;p&gt;Good catch. I tested &amp;#8211; this patch fixes that error as well.&lt;/p&gt;</comment>
                            <comment id="12769571" author="shv" created="Sat, 24 Oct 2009 02:03:45 +0000"  >&lt;ol&gt;
	&lt;li&gt;In &lt;tt&gt;setDefaultURI()&lt;/tt&gt; you catch an IOException and throw the IllegalArgumentException instead. We shouldn&apos;t be throwing RunTimeExceptions from the code because this means a bug in the code itself. Here you want to report a bad configuration parameter. Therefore, you should just let the IOException flow up. Especially if in your case the IOExceptions contain more information than mere &quot;Invalid uri in setDefaultUri()&quot;.&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;checkName()&lt;/tt&gt; should be declared void.&lt;/li&gt;
	&lt;li&gt;Also in &lt;tt&gt;checkName()&lt;/tt&gt; the {{else
{...}
&lt;p&gt;}} part can be dropped, I mean not the internals but the enclosing brackets. This is a style thing, but simplifies code imho.&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;I really liked a bunch of new tests for the file system parameter. Please check if you need to close all successfully opened file systems.&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="12769995" author="steve_l" created="Mon, 26 Oct 2009 11:38:23 +0000"  >&lt;p&gt;I liked the tests too, but there is a lot of cut-and paste replication in those tests which could be replaced by a couple of methods. Test code is code to maintain too, so a quick &quot;replace with method&quot; operation in the IDE would be nice&lt;/p&gt;</comment>
                            <comment id="12770181" author="kimballa" created="Mon, 26 Oct 2009 20:38:07 +0000"  >&lt;p&gt;Konstantin, changing &lt;tt&gt;setDefaultURI()&lt;/tt&gt; to throw an IOException is an incompatible interface change for &lt;tt&gt;FileSystem&lt;/tt&gt;. I&apos;m not strictly against doing this, but I thought that it was frowned upon. Code in other places (e.g., &lt;tt&gt;GenericOptionsParser&lt;/tt&gt;) which uses &lt;tt&gt;setDefaultURI&lt;/tt&gt; will need to be modified at the same time. I had spoken with Doug offline and he suggested converting to IllegalArgumentException for that reason. Do you still think the public interface change is a good idea?&lt;/p&gt;</comment>
                            <comment id="12770303" author="kimballa" created="Tue, 27 Oct 2009 00:05:24 +0000"  >&lt;p&gt;Here&apos;s a new patch that includes the &lt;tt&gt;throws IOException&lt;/tt&gt; on &lt;tt&gt;setDefaultURI&lt;/tt&gt;. This changes the implementation of GenericOptionsParser slightly to continue compiling.&lt;/p&gt;

&lt;p&gt;Also refactors tests per Steve&apos;s suggestion. There should not be a need to explicitly close filesystems; the tests instantiate LocalFileSystem instances.&lt;/p&gt;</comment>
                            <comment id="12770305" author="hadoopqa" created="Tue, 27 Oct 2009 00:27:08 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12423267/HADOOP-5901.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12423267/HADOOP-5901.2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 829289.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/104/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/104/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/104/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/104/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/104/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/104/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/104/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/104/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12770312" author="shv" created="Tue, 27 Oct 2009 00:36:59 +0000"  >&lt;p&gt;&amp;gt; ... Doug offline suggested converting to IllegalArgumentException for that reason.&lt;/p&gt;

&lt;p&gt;I see.&lt;/p&gt;

&lt;p&gt;&amp;gt; Do you still think the public interface change is a good idea?&lt;/p&gt;

&lt;p&gt;I think it is a good change in this case. Throwing a runtime exception in public api would be worse.&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12770606" author="cutting" created="Tue, 27 Oct 2009 18:55:59 +0000"  >&lt;p&gt;&amp;gt; We shouldn&apos;t be throwing RunTimeExceptions from the code because this means a bug in the code itself.&lt;/p&gt;

&lt;p&gt;FileSystem, Path and FileContext currently throw IllegalArgumentException for path problems like this.&lt;/p&gt;</comment>
                            <comment id="12771043" author="kimballa" created="Wed, 28 Oct 2009 18:35:05 +0000"  >&lt;p&gt;Konstantin: are you still in favor of the IOE? If so, what&apos;s your opinion on patch #2?&lt;/p&gt;</comment>
                            <comment id="12771172" author="shv" created="Wed, 28 Oct 2009 22:44:34 +0000"  >&lt;p&gt;&amp;gt; FileSystem, Path and FileContext currently throw IllegalArgumentException for path problems like this.&lt;/p&gt;

&lt;p&gt;I know, and I don&apos;t think this is right.&lt;br/&gt;
Also this case is a bit different. Patch #1 was catching IOException and converting it to IllegalArgumentException.&lt;/p&gt;

&lt;p&gt;&amp;gt; what&apos;s your opinion on patch #2? &lt;/p&gt;

&lt;p&gt;My plus one was related to your last patch. It looks good to me.&lt;/p&gt;</comment>
                            <comment id="12790451" author="tomwhite" created="Mon, 14 Dec 2009 23:37:57 +0000"  >&lt;p&gt;This patch no longer applies cleanly.&lt;/p&gt;</comment>
                            <comment id="12790521" author="kimballa" created="Tue, 15 Dec 2009 01:58:17 +0000"  >&lt;p&gt;New patch synced with trunk.&lt;/p&gt;</comment>
                            <comment id="12790548" author="hadoopqa" created="Tue, 15 Dec 2009 03:47:02 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12427993/HADOOP-5901.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12427993/HADOOP-5901.3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 890588.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/205/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/205/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/205/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/205/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/205/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/205/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/205/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/205/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12790571" author="tomwhite" created="Tue, 15 Dec 2009 05:43:17 +0000"  >&lt;p&gt;I&apos;ve just committed this. Thanks Aaron!&lt;/p&gt;</comment>
                            <comment id="12790576" author="hudson" created="Tue, 15 Dec 2009 06:00:17 +0000"  >&lt;p&gt;Integrated in Hadoop-Common-trunk-Commit #115 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Common-trunk-Commit/115/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Common-trunk-Commit/115/&lt;/a&gt;)&lt;br/&gt;
    . FileSystem.fixName() has unexpected behaviour. Contributed by Aaron Kimball.&lt;/p&gt;</comment>
                            <comment id="12790665" author="hudson" created="Tue, 15 Dec 2009 11:10:17 +0000"  >&lt;p&gt;Integrated in Hadoop-Common-trunk #188 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Common-trunk/188/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Common-trunk/188/&lt;/a&gt;)&lt;br/&gt;
    . FileSystem.fixName() has unexpected behaviour. Contributed by Aaron Kimball.&lt;/p&gt;</comment>
                            <comment id="12790885" author="tomwhite" created="Tue, 15 Dec 2009 19:00:34 +0000"  >&lt;p&gt;I&apos;ve just reverted this change, since FileSystem.setDefaultUri(conf, &quot;file:///&quot;) fails.&lt;/p&gt;</comment>
                            <comment id="12790897" author="hudson" created="Tue, 15 Dec 2009 19:09:48 +0000"  >&lt;p&gt;Integrated in Hadoop-Common-trunk-Commit #116 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Common-trunk-Commit/116/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Common-trunk-Commit/116/&lt;/a&gt;)&lt;br/&gt;
    Reverting . FileSystem.fixName() has unexpected behaviour.&lt;/p&gt;</comment>
                            <comment id="12790912" author="cos" created="Tue, 15 Dec 2009 19:41:47 +0000"  >&lt;p&gt;The proposed changes (namely throwing &lt;tt&gt;IOException&lt;/tt&gt; from &lt;tt&gt;setDefaultUri&lt;/tt&gt; method) will break other parts of Hadoop. E.g. in MR MiniMRCluster&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;342:     FileSystem.setDefaultUri(result, namenode);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;will surely fail because now &lt;tt&gt;IOException&lt;/tt&gt; has to be caught. So, the patch has to, at very least, address such issues. I&apos;ll link &lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-1297&quot; title=&quot;MiniMRCluster.java compilation failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-1297&quot;&gt;MAPREDUCE-1297&lt;/a&gt; with this JIRA for tracking purposes.&lt;/p&gt;</comment>
                            <comment id="12790914" author="cos" created="Tue, 15 Dec 2009 19:42:19 +0000"  >&lt;p&gt;This seems to be caused by the modification in question.&lt;/p&gt;</comment>
                            <comment id="12790989" author="kimballa" created="Tue, 15 Dec 2009 22:21:21 +0000"  >&lt;p&gt;Yes, changing the signature for &lt;tt&gt;FileSystem.setDefaultUri(Configuration, String)&lt;/tt&gt; to throw an IOException if it cannot create a proper URI from the String argument would be an incompatible change.&lt;/p&gt;

&lt;p&gt;Digging into the changes necessary in the MapReduce codebase, it appears that  (&lt;tt&gt;MiniMRCluster.configureJobConf()&lt;/tt&gt;) is the only use of FileSystem.setDefaultUri(). So that could be changed to itself throw IOException easily enough. But that is called by &lt;tt&gt;MiniMRCluster.createJobConf()&lt;/tt&gt; which is used in several dozen places throughout the test codebase.&lt;/p&gt;

&lt;p&gt;On the HDFS codebase side, it looks as though all the uses of setDefaultUri are in test cases which can all be modified to throw more exceptions than they do now in a straightforward way; or else in places where the URI is generated programmatically and we know that it&apos;s going to be valid. (Hence we can swallow the IOException.)&lt;/p&gt;

&lt;p&gt;So I think our options are as follows:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Modify &lt;tt&gt;MiniMRCluster.createJobConf()&lt;/tt&gt; to also throw IOException and modify all call-sites to catch IOException.&lt;/li&gt;
	&lt;li&gt;Early in this patch&apos;s development I was throwing an IllegalArgumentException (unchecked) for this reason (preventing incompatibility). Konstantin S: Are you still pro-IOException here?&lt;/li&gt;
	&lt;li&gt;Make the &lt;tt&gt;FileSystem.checkName()&lt;/tt&gt; method public. The &lt;tt&gt;namenode&lt;/tt&gt; argument in MiniMRCluster which is used to format the URI is passed into MiniMRCluster&apos;s constructor. With a public checkName, we could call &lt;tt&gt;checkName(namenode)&lt;/tt&gt; in the MiniMRCluster constructor, which already throws IOException, so clients already trap that. Then we could swallow the exception (maybe with a log4j message) in &lt;tt&gt;createJobConf()&lt;/tt&gt;, knowing that it should never be thrown since we already verified the URI&apos;s sanity. This increases the size of the public static FileSystem API.&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="12791322" author="hudson" created="Wed, 16 Dec 2009 11:10:38 +0000"  >&lt;p&gt;Integrated in Hadoop-Common-trunk #189 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Common-trunk/189/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Common-trunk/189/&lt;/a&gt;)&lt;br/&gt;
    Reverting . FileSystem.fixName() has unexpected behaviour.&lt;/p&gt;</comment>
                            <comment id="12799697" author="steve_l" created="Wed, 13 Jan 2010 11:37:30 +0000"  >&lt;p&gt;Reviewing this, throwing an &lt;tt&gt;IllegalArgumentException&lt;/tt&gt; would be compile-time and Java-methodology compatible, and consistent with the other file APIs. &lt;/p&gt;</comment>
                            <comment id="12800470" author="kimballa" created="Fri, 15 Jan 2010 00:43:02 +0000"  >&lt;p&gt;Here&apos;s another take at this with IllegalArgumentException behavior restored.&lt;/p&gt;

&lt;p&gt;MapReduce compilation is ok with this since it does not change the statically-typed API. (If this is committed, &lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-1297&quot; title=&quot;MiniMRCluster.java compilation failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-1297&quot;&gt;MAPREDUCE-1297&lt;/a&gt; should be resolved as Invalid.)&lt;/p&gt;

&lt;p&gt;I&apos;ve posted a patch at &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-835&quot; title=&quot;TestDefaultNameNodePort.testGetAddressFromConf fails with an unsupported formate error &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-835&quot;&gt;&lt;del&gt;HDFS-835&lt;/del&gt;&lt;/a&gt; to handle the HDFS test failure that occurred the first time this was committed. If this patch is committed, &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-835&quot; title=&quot;TestDefaultNameNodePort.testGetAddressFromConf fails with an unsupported formate error &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-835&quot;&gt;&lt;del&gt;HDFS-835&lt;/del&gt;&lt;/a&gt; should be committed as well.&lt;/p&gt;</comment>
                            <comment id="12800489" author="hadoopqa" created="Fri, 15 Jan 2010 01:34:29 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12430328/HADOOP-5901.4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12430328/HADOOP-5901.4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 898740.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/37/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/37/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/37/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/37/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/37/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/37/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/37/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/37/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12928651" author="hadoopqa" created="Fri, 5 Nov 2010 16:15:12 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12430328/HADOOP-5901.4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12430328/HADOOP-5901.4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1031422.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/74//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/74//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12928743" author="hadoopqa" created="Fri, 5 Nov 2010 18:40:45 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12430328/HADOOP-5901.4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12430328/HADOOP-5901.4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1031675.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/75//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/75//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12996921" author="hadoopqa" created="Sat, 19 Feb 2011 22:47:03 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12430328/HADOOP-5901.4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12430328/HADOOP-5901.4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1071364.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/292//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/292//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13195580" author="revans2" created="Sat, 28 Jan 2012 17:23:23 +0000"  >&lt;p&gt;Canceling this patch as it is over a year old and no longer applies to trunk.&lt;/p&gt;</comment>
                            <comment id="14070791" author="aw" created="Tue, 22 Jul 2014 19:59:09 +0000"  >&lt;p&gt;This should really get revisited to finish this up.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12443447">HDFS-835</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12443407">MAPREDUCE-1297</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12423267" name="HADOOP-5901.2.patch" size="9815" author="kimballa" created="Tue, 27 Oct 2009 00:05:24 +0000"/>
                            <attachment id="12427993" name="HADOOP-5901.3.patch" size="8834" author="kimballa" created="Tue, 15 Dec 2009 01:58:17 +0000"/>
                            <attachment id="12430328" name="HADOOP-5901.4.patch" size="10037" author="kimballa" created="Fri, 15 Jan 2010 00:43:02 +0000"/>
                            <attachment id="12422974" name="HADOOP-5901.patch" size="10198" author="kimballa" created="Fri, 23 Oct 2009 00:21:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>262</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 18 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hwf3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>102514</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>