<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:55:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-16581] ValueQueue does not trigger an async refill when number of values falls below watermark</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-16581</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;The ValueQueue facility was designed to cache EDEKs for KMS KeyProviders so that EDEKs could be served quickly, while the cache is replenished in a background thread.&lt;/p&gt;

&lt;p&gt;The existing code for triggering an asynchronous refill is only triggered when a key queue becomes empty, rather than when it falls below the configured watermark.&lt;/p&gt;

&lt;p&gt;This is a relatively minor fix in the main code, however, most of the tests require some changes as they verify the previous unintended behavior.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13257207">HADOOP-16581</key>
            <summary>ValueQueue does not trigger an async refill when number of values falls below watermark</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yuvaldeg">Yuval Degani</assignee>
                                    <reporter username="yuvaldeg">Yuval Degani</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Sep 2019 20:27:53 +0000</created>
                <updated>Mon, 23 Sep 2019 22:00:10 +0000</updated>
                            <resolved>Fri, 20 Sep 2019 17:19:01 +0000</resolved>
                                    <version>2.7.4</version>
                    <version>3.2.0</version>
                                    <fixVersion>2.10.0</fixVersion>
                    <fixVersion>3.3.0</fixVersion>
                    <fixVersion>3.1.4</fixVersion>
                    <fixVersion>3.2.2</fixVersion>
                                    <component>common</component>
                    <component>kms</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="16932659" author="xkrogen" created="Wed, 18 Sep 2019 16:50:40 +0000"  >&lt;p&gt;The change LGTM, ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xiaochen&quot; class=&quot;user-hover&quot; rel=&quot;xiaochen&quot;&gt;xiaochen&lt;/a&gt; who I see has some previous commits in this file, and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anu&quot; class=&quot;user-hover&quot; rel=&quot;anu&quot;&gt;anu&lt;/a&gt; / &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daryn&quot; class=&quot;user-hover&quot; rel=&quot;daryn&quot;&gt;daryn&lt;/a&gt; / &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kihwal&quot; class=&quot;user-hover&quot; rel=&quot;kihwal&quot;&gt;kihwal&lt;/a&gt; who I believe have some experience with the KMS.&lt;/p&gt;</comment>
                            <comment id="16933525" author="xkrogen" created="Thu, 19 Sep 2019 15:44:44 +0000"  >&lt;p&gt;Got a clean Jenkins run. +1 from me, will give one more day before committing for anyone else to chime in.&lt;/p&gt;

&lt;p&gt;Ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aengineer&quot; class=&quot;user-hover&quot; rel=&quot;aengineer&quot;&gt;aengineer&lt;/a&gt; since it looks like I messed up the tag in my last comment.&lt;/p&gt;</comment>
                            <comment id="16934568" author="xkrogen" created="Fri, 20 Sep 2019 16:56:42 +0000"  >&lt;p&gt;Just merged this to trunk based on +1 from Anu and myself. Thanks for the contribution &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yuvaldeg&quot; class=&quot;user-hover&quot; rel=&quot;yuvaldeg&quot;&gt;yuvaldeg&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="16934582" author="hudson" created="Fri, 20 Sep 2019 17:09:11 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build Hadoop-trunk-Commit #17343 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-trunk-Commit/17343/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-trunk-Commit/17343/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-16581&quot; title=&quot;ValueQueue does not trigger an async refill when number of values falls below watermark&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-16581&quot;&gt;&lt;del&gt;HADOOP-16581&lt;/del&gt;&lt;/a&gt;. Revise ValueQueue to correctly replenish queues that go (xkrogen: rev dd0834696a694564af65a1355c9d13275f44df51)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/crypto/key/TestValueQueue.java&lt;/li&gt;
	&lt;li&gt;(edit) hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/crypto/key/kms/ValueQueue.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16934591" author="xkrogen" created="Fri, 20 Sep 2019 17:18:54 +0000"  >&lt;p&gt;Also backported to branch-3.2, branch-3.1, and branch-2. There was a minor change I needed to make to the test case in branch-2 due to the lack of Java 8 support (removed the lambda, made some parameters final). Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yuvaldeg&quot; class=&quot;user-hover&quot; rel=&quot;yuvaldeg&quot;&gt;yuvaldeg&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="16934615" author="yuvaldeg" created="Fri, 20 Sep 2019 17:47:07 +0000"  >&lt;p&gt;Thanks for reviewing and merging, folks!&lt;/p&gt;</comment>
                            <comment id="16935214" author="iwasakims" created="Sun, 22 Sep 2019 05:25:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xkrogen&quot; class=&quot;user-hover&quot; rel=&quot;xkrogen&quot;&gt;xkrogen&lt;/a&gt; branch-2 build failed due to lambda left in the backported fix. &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.1:testCompile (default-testCompile) on project hadoop-common: Compilation failure
[ERROR] /ext/srcs/hadoop-branch-2/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/crypto/key/TestValueQueue.java:[67,33] lambda expressions are not supported in -source 1.7
[ERROR]   (use -source 8 or higher to enable lambda expressions)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16935220" author="iwasakims" created="Sun, 22 Sep 2019 05:35:25 +0000"  >&lt;p&gt;I attached addendum patch to fix the build failure in branch-2.&lt;/p&gt;</comment>
                            <comment id="16935957" author="xkrogen" created="Mon, 23 Sep 2019 15:18:55 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=iwasakims&quot; class=&quot;user-hover&quot; rel=&quot;iwasakims&quot;&gt;iwasakims&lt;/a&gt;! I had prepared the same patch and thought I included it in the commit I pushed, but it seems it was sitting in my local directory only &#128531; I just pushed up the fix.&lt;/p&gt;</comment>
                            <comment id="16936220" author="iwasakims" created="Mon, 23 Sep 2019 22:00:10 +0000"  >&lt;p&gt;Thanks, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xkrogen&quot; class=&quot;user-hover&quot; rel=&quot;xkrogen&quot;&gt;xkrogen&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12980988" name="HADOOP-16581-branch-2.001.addendum.patch" size="1574" author="iwasakims" created="Sun, 22 Sep 2019 05:34:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 8 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z06qeo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>