<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:34:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-6663] BlockDecompressorStream get EOF exception when decompressing the file compressed from empty file</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-6663</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;An empty file can be compressed using BlockDecompressorStream, which is for block-based compressiong algorithm such as LZO. However, when decompressing the compressed file, BlockDecompressorStream get EOF exception.&lt;/p&gt;

&lt;p&gt;Here is a typical exception stack:&lt;/p&gt;

&lt;p&gt;java.io.EOFException&lt;br/&gt;
at org.apache.hadoop.io.compress.BlockDecompressorStream.rawReadInt(BlockDecompressorStream.java:125)&lt;br/&gt;
at org.apache.hadoop.io.compress.BlockDecompressorStream.getCompressedData(BlockDecompressorStream.java:96)&lt;br/&gt;
at org.apache.hadoop.io.compress.BlockDecompressorStream.decompress(BlockDecompressorStream.java:82)&lt;br/&gt;
at org.apache.hadoop.io.compress.DecompressorStream.read(DecompressorStream.java:74)&lt;br/&gt;
at java.io.InputStream.read(InputStream.java:85)&lt;br/&gt;
at org.apache.hadoop.util.LineReader.readLine(LineReader.java:134)&lt;br/&gt;
at org.apache.hadoop.mapred.LineRecordReader.next(LineRecordReader.java:134)&lt;br/&gt;
at org.apache.hadoop.mapred.LineRecordReader.next(LineRecordReader.java:39)&lt;br/&gt;
at org.apache.hadoop.mapred.MapTask$TrackedRecordReader.moveToNext(MapTask.java:186)&lt;br/&gt;
at org.apache.hadoop.mapred.MapTask$TrackedRecordReader.next(MapTask.java:170)&lt;br/&gt;
at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:48)&lt;br/&gt;
at org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:18)&lt;br/&gt;
at org.apache.hadoop.mapred.MapTask.run(MapTask.java:334)&lt;br/&gt;
at org.apache.hadoop.mapred.Child.main(Child.java:196)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12460512">HADOOP-6663</key>
            <summary>BlockDecompressorStream get EOF exception when decompressing the file compressed from empty file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xiaokang">Xiaokang Yang</assignee>
                                    <reporter username="xiaokang">Xiaokang Yang</reporter>
                        <labels>
                            <label>BlockDecompressorStream</label>
                            <label>compress</label>
                            <label>hadoop</label>
                            <label>io</label>
                    </labels>
                <created>Mon, 29 Mar 2010 08:17:29 +0000</created>
                <updated>Mon, 12 Dec 2011 06:20:02 +0000</updated>
                            <resolved>Thu, 28 Oct 2010 17:18:07 +0000</resolved>
                                    <version>0.20.2</version>
                                    <fixVersion>0.22.0</fixVersion>
                                    <component>io</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12850835" author="xiaokang" created="Mon, 29 Mar 2010 08:40:15 +0000"  >&lt;p&gt;The EOF exception caused as follow:&lt;/p&gt;

&lt;p&gt;BlockCompressorStream compresses the input data block-by-block. For each block, the uncopressed block length is first written to the underlying output stream, followed by compressed chunks, each consists of a chuck-length and compressed chunk-data. &lt;/p&gt;

&lt;p&gt;So BlockCompressorStream writes an int of 0 to the underlying output stream when compressing empty file, without any following chunks. &lt;/p&gt;

&lt;p&gt;BlockDecompressorStream decompresses the underlying compressed input stream block by block. For each block, it reads the uncompressed block length and then reads the chunk length and compressed chunk. &lt;/p&gt;

&lt;p&gt;So BlockDecompressorStream read 0 and get EOF exception trying to read chunk length when decompressing previous compressed empty file.&lt;/p&gt;
</comment>
                            <comment id="12850839" author="xiaokang" created="Mon, 29 Mar 2010 08:50:01 +0000"  >&lt;p&gt;Patch attached.&lt;/p&gt;

&lt;p&gt;Return -1 to indicate EOF when reading a 0 block length.&lt;/p&gt;</comment>
                            <comment id="12853152" author="xiaokang" created="Sat, 3 Apr 2010 16:21:51 +0000"  >&lt;p&gt;New patch attached, including test case.&lt;/p&gt;</comment>
                            <comment id="12853192" author="tlipcon" created="Sat, 3 Apr 2010 20:17:30 +0000"  >&lt;p&gt;+1, I&apos;ve seen this issue in production as well. Fix and test case look good, except please add the apache header to the test case, and preferably update the test case to JUnit 4 style&lt;/p&gt;</comment>
                            <comment id="12853703" author="xiaokang" created="Tue, 6 Apr 2010 02:27:08 +0000"  >&lt;p&gt;Thank you for your advice. &lt;/p&gt;

&lt;p&gt;New patch attached with apache header and JUnit 4 style test case.&lt;/p&gt;</comment>
                            <comment id="12853991" author="hadoopqa" created="Tue, 6 Apr 2010 14:18:41 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12440828/BlockDecompressorStream.java.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12440828/BlockDecompressorStream.java.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 930096.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/443/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/443/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/443/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/443/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/443/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/443/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/443/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/443/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12924783" author="tomwhite" created="Mon, 25 Oct 2010 23:37:01 +0000"  >&lt;p&gt;I&apos;ve just committed this. Thanks Kang Xiao!&lt;/p&gt;</comment>
                            <comment id="12924785" author="tomwhite" created="Mon, 25 Oct 2010 23:57:39 +0000"  >&lt;p&gt;Re-opening as there was a compilation problem.&lt;/p&gt;</comment>
                            <comment id="12924788" author="tomwhite" created="Mon, 25 Oct 2010 23:58:52 +0000"  >&lt;p&gt;Running updated patch through Hudson.&lt;/p&gt;</comment>
                            <comment id="12924795" author="hudson" created="Tue, 26 Oct 2010 00:22:32 +0000"  >&lt;p&gt;Integrated in Hadoop-Common-trunk-Commit #399 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Hadoop-Common-trunk-Commit/399/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Hadoop-Common-trunk-Commit/399/&lt;/a&gt;)&lt;br/&gt;
    Reverting &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-6663&quot; title=&quot;BlockDecompressorStream get EOF exception when decompressing the file compressed from empty file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-6663&quot;&gt;&lt;del&gt;HADOOP-6663&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-6663&quot; title=&quot;BlockDecompressorStream get EOF exception when decompressing the file compressed from empty file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-6663&quot;&gt;&lt;del&gt;HADOOP-6663&lt;/del&gt;&lt;/a&gt;.  BlockDecompressorStream get EOF exception when decompressing the file compressed from empty file.  Contributed by Kang Xiao.&lt;/p&gt;</comment>
                            <comment id="12924954" author="hudson" created="Tue, 26 Oct 2010 13:06:42 +0000"  >&lt;p&gt;Integrated in Hadoop-Common-trunk #493 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Hadoop-Common-trunk/493/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Hadoop-Common-trunk/493/&lt;/a&gt;)&lt;br/&gt;
    Reverting &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-6663&quot; title=&quot;BlockDecompressorStream get EOF exception when decompressing the file compressed from empty file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-6663&quot;&gt;&lt;del&gt;HADOOP-6663&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-6663&quot; title=&quot;BlockDecompressorStream get EOF exception when decompressing the file compressed from empty file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-6663&quot;&gt;&lt;del&gt;HADOOP-6663&lt;/del&gt;&lt;/a&gt;.  BlockDecompressorStream get EOF exception when decompressing the file compressed from empty file.  Contributed by Kang Xiao.&lt;/p&gt;</comment>
                            <comment id="12925875" author="tomwhite" created="Thu, 28 Oct 2010 17:16:11 +0000"  >&lt;p&gt;I ran the tests and test-patch manually:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;     [exec] +1 overall. 
     [exec]
     [exec]     +1 @author.  The patch does not contain any @author tags.
     [exec]
     [exec]     +1 tests included.  The patch appears to include 4 new or modified tests.
     [exec]
     [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.
     [exec]
     [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.
     [exec]
     [exec]     +1 findbugs.  The patch does not introduce any new Findbugs warnings.
     [exec]
     [exec]     +1 release audit.  The applied patch does not increase the total number of release audit warnings.
     [exec]
     [exec]     +1 system tests framework.  The patch passed system tests framework compile.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12925877" author="tomwhite" created="Thu, 28 Oct 2010 17:18:07 +0000"  >&lt;p&gt;I&apos;ve just committed this.&lt;/p&gt;</comment>
                            <comment id="12925888" author="hudson" created="Thu, 28 Oct 2010 17:38:03 +0000"  >&lt;p&gt;Integrated in Hadoop-Common-trunk-Commit #404 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Hadoop-Common-trunk-Commit/404/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Hadoop-Common-trunk-Commit/404/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-6663&quot; title=&quot;BlockDecompressorStream get EOF exception when decompressing the file compressed from empty file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-6663&quot;&gt;&lt;del&gt;HADOOP-6663&lt;/del&gt;&lt;/a&gt;.  BlockDecompressorStream get EOF exception when decompressing the file compressed from empty file.  Contributed by Kang Xiao.&lt;/p&gt;</comment>
                            <comment id="12926240" author="hudson" created="Fri, 29 Oct 2010 11:21:52 +0000"  >&lt;p&gt;Integrated in Hadoop-Common-trunk #496 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Hadoop-Common-trunk/496/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Hadoop-Common-trunk/496/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-6663&quot; title=&quot;BlockDecompressorStream get EOF exception when decompressing the file compressed from empty file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-6663&quot;&gt;&lt;del&gt;HADOOP-6663&lt;/del&gt;&lt;/a&gt;.  BlockDecompressorStream get EOF exception when decompressing the file compressed from empty file.  Contributed by Kang Xiao.&lt;/p&gt;</comment>
                            <comment id="12968641" author="bennies" created="Tue, 7 Dec 2010 09:28:25 +0000"  >&lt;p&gt;Copied the same change Kang Xiao made to 0.20.2 since I needed it for that version.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12440828" name="BlockDecompressorStream.java.patch" size="6470" author="xiaokang" created="Tue, 6 Apr 2010 02:27:08 +0000"/>
                            <attachment id="12440696" name="BlockDecompressorStream.java.patch" size="5633" author="xiaokang" created="Sat, 3 Apr 2010 16:21:51 +0000"/>
                            <attachment id="12440049" name="BlockDecompressorStream.patch" size="638" author="xiaokang" created="Mon, 29 Mar 2010 08:50:01 +0000"/>
                            <attachment id="12465676" name="HADOOP-6663-0.20.2.patch" size="638" author="bennies" created="Tue, 7 Dec 2010 09:28:25 +0000"/>
                            <attachment id="12458023" name="HADOOP-6663.patch" size="6494" author="tomwhite" created="Mon, 25 Oct 2010 23:58:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37003</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 51 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02q4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>13835</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fix EOF exception in BlockDecompressorStream when decompressing previous compressed empty file</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>hadoop io compress BlockDecompressorStream</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>