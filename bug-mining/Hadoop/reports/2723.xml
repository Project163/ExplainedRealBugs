<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:56:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-16080] hadoop-aws does not work with hadoop-client-api</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-16080</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;I attempted to use Accumulo and S3a with the following jars on the classpath.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;hadoop-client-api-3.1.1.jar&lt;/li&gt;
	&lt;li&gt;hadoop-client-runtime-3.1.1.jar&lt;/li&gt;
	&lt;li&gt;hadoop-aws-3.1.1.jar&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This failed with the following exception.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Exception in thread &quot;init&quot; java.lang.NoSuchMethodError: org.apache.hadoop.util.SemaphoredDelegatingExecutor.&amp;lt;init&amp;gt;(Lcom/google/common/util/concurrent/ListeningExecutorService;IZ)V
    at org.apache.hadoop.fs.s3a.S3AFileSystem.create(S3AFileSystem.java:769)
    at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1169)
    at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1149)
    at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1108)
    at org.apache.hadoop.fs.FileSystem.createNewFile(FileSystem.java:1413)
    at org.apache.accumulo.server.fs.VolumeManagerImpl.createNewFile(VolumeManagerImpl.java:184)
    at org.apache.accumulo.server.init.Initialize.initDirs(Initialize.java:479)
    at org.apache.accumulo.server.init.Initialize.initFileSystem(Initialize.java:487)
    at org.apache.accumulo.server.init.Initialize.initialize(Initialize.java:370)
    at org.apache.accumulo.server.init.Initialize.doInit(Initialize.java:348)
    at org.apache.accumulo.server.init.Initialize.execute(Initialize.java:967)
    at org.apache.accumulo.start.Main.lambda$execKeyword$0(Main.java:129)
    at java.lang.Thread.run(Thread.java:748)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The problem is that &lt;tt&gt;S3AFileSystem.create()&lt;/tt&gt; looks for &lt;tt&gt;SemaphoredDelegatingExecutor(com.google.common.util.concurrent.ListeningExecutorService)&lt;/tt&gt; which does not exist in hadoop-client-api-3.1.1.jar.  What does exist is &lt;tt&gt;SemaphoredDelegatingExecutor(org.apache.hadoop.shaded.com.google.common.util.concurrent.ListeningExecutorService)&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;To work around this issue I created a version of hadoop-aws-3.1.1.jar that relocated references to Guava.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13212344">HADOOP-16080</key>
            <summary>hadoop-aws does not work with hadoop-client-api</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="csun">Chao Sun</assignee>
                                    <reporter username="kturner">Keith Turner</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 28 Jan 2019 22:05:14 +0000</created>
                <updated>Wed, 10 Mar 2021 10:18:29 +0000</updated>
                            <resolved>Fri, 4 Dec 2020 00:14:23 +0000</resolved>
                                    <version>3.2.0</version>
                    <version>3.1.1</version>
                    <version>3.4.0</version>
                                    <fixVersion>3.2.2</fixVersion>
                    <fixVersion>3.3.1</fixVersion>
                    <fixVersion>3.4.0</fixVersion>
                                    <component>fs/s3</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>15</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="29400">8h 10m</timespent>
                                <comments>
                            <comment id="16754412" author="kturner" created="Mon, 28 Jan 2019 22:27:44 +0000"  >&lt;p&gt;This gist contains the pom file that I used to created a relocated version of hadoop-aws.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://gist.github.com/keith-turner/f6dcbd33342732e42695d66509239983&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gist.github.com/keith-turner/f6dcbd33342732e42695d66509239983&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16754430" author="kturner" created="Mon, 28 Jan 2019 22:59:18 +0000"  >&lt;p&gt;Seems like ideally the hadoop-aws module would avoid using any hadoop APIs with non-hadoop/relocated types.&lt;/p&gt;</comment>
                            <comment id="16754943" author="stevel@apache.org" created="Tue, 29 Jan 2019 12:18:49 +0000"  >&lt;p&gt;keith. I appreciate your concerns. What we really want is an object store dependency which contains all the store connectors with shaded dependencies, &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-15387&quot; title=&quot;Produce a shaded hadoop-cloud-storage JAR for applications to use&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-15387&quot;&gt;HADOOP-15387&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;Nobody has volunteered to do this -yet. &lt;/p&gt;

&lt;p&gt;You&apos;ve actually started this, which makes this a more viable proposition than &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-15387&quot; title=&quot;Produce a shaded hadoop-cloud-storage JAR for applications to use&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-15387&quot;&gt;HADOOP-15387&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;Do you want to take on the challenge of a hadoop-cloud-storage-shaded artifact? I think we&apos;ll all have to help with the testing (summary: it&apos;ll be hard) but it will be appreciated by all those downstream projects.&lt;/p&gt;</comment>
                            <comment id="16755146" author="kturner" created="Tue, 29 Jan 2019 15:51:40 +0000"  >&lt;p&gt;&amp;gt; Do you want to take on the challenge of a hadoop-cloud-storage-shaded artifact?&lt;/p&gt;

&lt;p&gt;No, I am quite busy and &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-15387&quot; title=&quot;Produce a shaded hadoop-cloud-storage JAR for applications to use&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-15387&quot;&gt;HADOOP-15387&lt;/a&gt; feels like the wrong direction.  The envisioned hadoop-cloudstorage artifact seems misaligned with the communities and dependencies.  Seems a better structure would be that hadoop-aws is an independent artifact that only uses public/stable hadoop APIs. I took a look at SemaphoredDelegatingExecutor and noticed that is marked InterfaceAudience.Private, so it seems like hadoop-aws should just not use it.  However, maybe its not feasible for hadoop-aws to only use public/stable APIs. If I magically had the time I would explore making hadoop-aws more independent instead of more dependent. &lt;/p&gt;
</comment>
                            <comment id="16755264" author="stevel@apache.org" created="Tue, 29 Jan 2019 18:15:59 +0000"  >&lt;blockquote&gt;&lt;p&gt;No, I am quite busy &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That is the problem we all have, I&apos;m afraid.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The envisioned hadoop-cloudstorage artifact seems misaligned with the communities and dependencies. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Why so? &lt;/p&gt;

&lt;p&gt;Spark has a declared dependency on the unshaded hadoop-cloud-storage JAR: &lt;a href=&quot;https://github.com/apache/spark/blob/master/hadoop-cloud/pom.xml#L208&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/spark/blob/master/hadoop-cloud/pom.xml#L208&lt;/a&gt;; so does Tez, and some other projects. Having a shaded offering would only need a change in those declarations and cover all the stores.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Seems a better structure would be that hadoop-aws is an independent artifact that only uses public/stable hadoop APIs. I took a look at SemaphoredDelegatingExecutor and noticed that is marked InterfaceAudience.Private, so it seems like hadoop-aws should just not use it&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;SemaphoredDelegatingExecutor actually arrived in hadoop-aws first, &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-13560&quot; title=&quot;S3ABlockOutputStream to support huge (many GB) file writes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-13560&quot;&gt;&lt;del&gt;HADOOP-13560&lt;/del&gt;&lt;/a&gt;; pulled up into hadoop-common by &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-15309&quot; title=&quot;default maven in path under start-build-env.sh is the wrong one&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-15309&quot;&gt;&lt;del&gt;HADOOP-15309&lt;/del&gt;&lt;/a&gt; so that it could be shared by the other object stores. It&apos;s private &lt;b&gt;within Hadoop itself&lt;/b&gt;. By tagging as such, we retain the option of making incompatible changes. Similarly, we keep a lot of implementation stuff in hadoop-common, and share test suites of FS behaviours in hadoop-common-tests. That keeps maintenance costs down (do I really have to have a copy and paste of SemaphoredDelegatingExecutor? What about EtagChecksum? or all the new fs.impl stuff I&apos;m adding in &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-15229&quot; title=&quot;Add FileSystem builder-based openFile() API to match createFile(); S3A to implement S3 Select through this API.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-15229&quot;&gt;&lt;del&gt;HADOOP-15229&lt;/del&gt;&lt;/a&gt; for async IO?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;If I magically had the time I would explore making hadoop-aws more independent instead of more dependent.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The other aspect of a shaded cloud moduleis that it would also be able to hide transitive dependencies. &lt;br/&gt;
You&apos;ve avoided seeing that problem because you already had SLF4J, commons-*, etc on the CP, of compatible versions, and as we&apos;ve switched to the shaded AWS SDK, so you don&apos;t have to worry about the jackson and httpclient problems which are complex enough that we are going to have to stop making Hadoop 2.7.x releases. But hadoop-azure does pass on its unshaded dependencies, as do some others -and I do get to deal with those problems. If we can produce a single JAR &quot;depend on this and you won&apos;t have classpath problems&quot;, people will be happy. It that which tends to be the most traumatic.&lt;/p&gt;</comment>
                            <comment id="17238930" author="dongjoon" created="Wed, 25 Nov 2020 20:33:18 +0000"  >&lt;p&gt;Hi, All.&lt;br/&gt;
Is there any update on this JIRA? Otherwise, can we increase the `Priority` from `Major` to `Blocker`?&lt;/p&gt;</comment>
                            <comment id="17239423" author="stevel@apache.org" created="Thu, 26 Nov 2020 21:11:32 +0000"  >&lt;p&gt;the way to address the issue would be to do a shaded-cloud-connectors module, not the proposed &quot;lets only use the hadoop-client API&quot; policy.&lt;/p&gt;

&lt;p&gt;I&apos;ve not had a chance to do that, if you want to begin instead&lt;/p&gt;</comment>
                            <comment id="17241009" author="csun" created="Mon, 30 Nov 2020 19:57:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stevel%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;stevel@apache.org&quot;&gt;stevel@apache.org&lt;/a&gt; One other issue here is that, even though the APIs are private within Hadoop itself, should we avoid using Guava in the APIs themselves? this will allow Hadoop modules fit better with each other.&lt;/p&gt;</comment>
                            <comment id="17243741" author="hexiaoqiao" created="Fri, 4 Dec 2020 06:15:00 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=csun&quot; class=&quot;user-hover&quot; rel=&quot;csun&quot;&gt;csun&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stevel%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;stevel@apache.org&quot;&gt;stevel@apache.org&lt;/a&gt; for your works.&lt;br/&gt;
Committed to branch-3.2.2, backport, compile and check at local passed.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13343497">SPARK-33618</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13197933">HADOOP-15924</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13363499">HADOOP-17573</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13152666">HADOOP-15387</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 49 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|yi0ehs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12342984">3.1.1</customfieldvalue>
    <customfieldvalue id="12346149">3.2.2</customfieldvalue>
    <customfieldvalue id="12346894">3.4.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>