<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:34:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-7101] UserGroupInformation.getCurrentUser() fails when called from non-Hadoop JAAS context</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-7101</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;If a Hadoop client is run from inside a container like Tomcat, and the current AccessControlContext has a Subject associated with it that is not created by Hadoop, then UserGroupInformation.getCurrentUser() will throw NoSuchElementException, since it assumes that any Subject will have a hadoop User principal.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12495329">HADOOP-7101</key>
            <summary>UserGroupInformation.getCurrentUser() fails when called from non-Hadoop JAAS context</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tlipcon">Todd Lipcon</assignee>
                                    <reporter username="tlipcon">Todd Lipcon</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Jan 2011 02:26:16 +0000</created>
                <updated>Tue, 28 May 2013 16:29:22 +0000</updated>
                            <resolved>Fri, 14 Jan 2011 07:17:24 +0000</resolved>
                                    <version>0.22.0</version>
                                    <fixVersion>1.2.0</fixVersion>
                    <fixVersion>0.23.0</fixVersion>
                                    <component>security</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>16</watches>
                                                                                                                <comments>
                            <comment id="12980524" author="hadoopqa" created="Wed, 12 Jan 2011 02:53:23 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12468097/hadoop-7101.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12468097/hadoop-7101.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1057970.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;    +1 system test framework.  The patch passed system test framework compile.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/172//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/172//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/172//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/172//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/172//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/172//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12981598" author="kzhang" created="Fri, 14 Jan 2011 01:32:18 +0000"  >&lt;p&gt;I should note that the original code has an inconsistency in that the caller of getCurrentUser() never knows whether the returned currentUser is actually associated with the current AccessControlContext. If it is called in a doAs() block, then the returned currentUser is associated with the current AccessControlContext. Whereas if it is not called in a doAs() block, loginUser is returned (login is performed if needed) and this loginUser is NOT associated with the current AccessControlContext. This matters when we want to invoke, for example, Java GSS/Kerberos library, since these Java libraries will only check the current AccessControlContext for credentials. A cleaner approach would have been returning null when we&apos;re not in a doAs() block, to say that there is no currentUser being associated with current AccessControlContext. And if the caller wants to use the credentials of the loginUser, call loginUser.doAs() explicitly.&lt;/p&gt;

&lt;p&gt;It&apos;s not the purpose of this patch to fix the above inconsistency. This patch simply extends the current semantics. So +1.&lt;/p&gt;</comment>
                            <comment id="12981603" author="kzhang" created="Fri, 14 Jan 2011 01:43:13 +0000"  >&lt;p&gt;&amp;gt; And if the caller wants to use the credentials of the loginUser, call loginUser.doAs() explicitly.&lt;/p&gt;

&lt;p&gt;I meant &quot;call getLoginUser().doAs() explicitly&quot;.&lt;/p&gt;</comment>
                            <comment id="12981648" author="tlipcon" created="Fri, 14 Jan 2011 07:13:34 +0000"  >&lt;p&gt;Yes, I agree the whole concept of loginUser fallback feels wrong... but like you said, outside the scope of this patch.&lt;/p&gt;

&lt;p&gt;To add a datapoint about testing - the user who was experiencing this issue inside tomcat tested the patch and reports the problem is indeed fixed.&lt;/p&gt;

&lt;p&gt;I&apos;ll commit to 0.22 and trunk shortly.&lt;/p&gt;</comment>
                            <comment id="12981693" author="hudson" created="Fri, 14 Jan 2011 09:44:40 +0000"  >&lt;p&gt;Integrated in Hadoop-Common-22-branch #15 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Hadoop-Common-22-branch/15/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Hadoop-Common-22-branch/15/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-7101&quot; title=&quot;UserGroupInformation.getCurrentUser() fails when called from non-Hadoop JAAS context&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-7101&quot;&gt;&lt;del&gt;HADOOP-7101&lt;/del&gt;&lt;/a&gt;. UserGroupInformation.getCurrentUser() fails when called from non-Hadoop JAAS context. Contributed by Todd Lipcon&lt;/p&gt;</comment>
                            <comment id="12981720" author="hudson" created="Fri, 14 Jan 2011 11:14:23 +0000"  >&lt;p&gt;Integrated in Hadoop-Common-trunk #576 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Hadoop-Common-trunk/576/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Hadoop-Common-trunk/576/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-7101&quot; title=&quot;UserGroupInformation.getCurrentUser() fails when called from non-Hadoop JAAS context&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-7101&quot;&gt;&lt;del&gt;HADOOP-7101&lt;/del&gt;&lt;/a&gt;. UserGroupInformation.getCurrentUser() fails when called from non-Hadoop JAAS context. Contributed by Todd Lipcon&lt;/p&gt;</comment>
                            <comment id="12983571" author="hudson" created="Wed, 19 Jan 2011 07:13:27 +0000"  >&lt;p&gt;Integrated in Hadoop-Common-trunk-Commit #479 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Hadoop-Common-trunk-Commit/479/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Hadoop-Common-trunk-Commit/479/&lt;/a&gt;)&lt;/p&gt;
</comment>
                            <comment id="13201592" author="vicaya" created="Mon, 6 Feb 2012 21:13:27 +0000"  >&lt;p&gt;We should probably fix this in 1.0 branch as well.&lt;/p&gt;</comment>
                            <comment id="13568842" author="tmielke" created="Fri, 1 Feb 2013 16:16:58 +0000"  >&lt;p&gt;Any idea why this bug got never fixed on any 1.x release? &lt;br/&gt;
When running inside an OSGi container one also suffers this bug. &lt;br/&gt;
1.x is the latest stable release but does not contain this fix which is almost a year old. &lt;/p&gt;

&lt;p&gt;Or will you release 2.0 some time soon? &lt;/p&gt;
</comment>
                            <comment id="13571114" author="davsclaus" created="Tue, 5 Feb 2013 07:25:54 +0000"  >&lt;p&gt;I logged a new ticket &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9280&quot; title=&quot;HADOOP-7101 was never merged from 0.23.x to the 1.x branch&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9280&quot;&gt;&lt;del&gt;HADOOP-9280&lt;/del&gt;&lt;/a&gt; as this is critical problem for people trying to upgrade from 0.2 to 1.x&lt;/p&gt;</comment>
                            <comment id="13571644" author="sureshms" created="Tue, 5 Feb 2013 19:34:21 +0000"  >&lt;blockquote&gt;&lt;p&gt;I logged a new ticket &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9280&quot; title=&quot;HADOOP-7101 was never merged from 0.23.x to the 1.x branch&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9280&quot;&gt;&lt;del&gt;HADOOP-9280&lt;/del&gt;&lt;/a&gt; as this is critical problem for people trying to upgrade from 0.2 to 1.x&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;What do you mean by 0.2 to 1.x?&lt;/p&gt;</comment>
                            <comment id="13573281" author="davsclaus" created="Thu, 7 Feb 2013 07:44:13 +0000"  >&lt;p&gt;I mean when people uses Hadoop 0.2 and it works. Then if they upgrade to Hadoop 1.x and it no longer works.&lt;br/&gt;
eg the fix only went into the 0.2 code branch, and not the 1.x code branch.&lt;/p&gt;</comment>
                            <comment id="13597662" author="sureshms" created="Fri, 8 Mar 2013 23:00:01 +0000"  >&lt;p&gt;Claus, when you say 0.2, I am thrown off. 0.2 is the release from probably 6 years ago. Do you mean 0.20?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;eg the fix only went into the 0.2 code branch&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Can you tell me the branch name and commit revision for this?&lt;/p&gt;</comment>
                            <comment id="13598632" author="tmielke" created="Mon, 11 Mar 2013 08:19:30 +0000"  >&lt;p&gt;Filling in for Claus Ibsen here as well: &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Can you tell me the branch name and commit revision for this?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The latest 0.23.5 release has this fix included. &lt;br/&gt;
However we did not find any 1.x release that contains this code fix. See my comment from 01/Feb/13.&lt;br/&gt;
I checked the source code of all relevant 1.x releases and did not see the fix. &lt;br/&gt;
The fix is present in 2.0 branch however there has not been any release of 2.0 yet. &lt;/p&gt;

&lt;p&gt;So trying to use the Hadoop client libs of any 1.x version when running inside another container (e.g. OSGi) fails.&lt;/p&gt;</comment>
                            <comment id="13600428" author="farrellee" created="Tue, 12 Mar 2013 20:24:19 +0000"  >&lt;p&gt;I&apos;ve posted a port of &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-7101&quot; title=&quot;UserGroupInformation.getCurrentUser() fails when called from non-Hadoop JAAS context&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-7101&quot;&gt;&lt;del&gt;HADOOP-7101&lt;/del&gt;&lt;/a&gt; over on &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9280&quot; title=&quot;HADOOP-7101 was never merged from 0.23.x to the 1.x branch&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9280&quot;&gt;&lt;del&gt;HADOOP-9280&lt;/del&gt;&lt;/a&gt;. Let&apos;s continue the discussion there, instead of on this CLOSED issue.&lt;/p&gt;</comment>
                            <comment id="13600908" author="sureshms" created="Wed, 13 Mar 2013 07:18:37 +0000"  >&lt;blockquote&gt;&lt;p&gt;Let&apos;s continue the discussion there, instead of on this CLOSED issue.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Sure. Generally if the port is straightforward, this issue could also be opened to attach the branch-1 patch.&lt;/p&gt;</comment>
                            <comment id="13600916" author="sureshms" created="Wed, 13 Mar 2013 07:30:48 +0000"  >&lt;p&gt;Here is a branch-1 patch for this issue.&lt;/p&gt;</comment>
                            <comment id="13600928" author="szetszwo" created="Wed, 13 Mar 2013 07:48:24 +0000"  >&lt;p&gt;+1 the branch-1 patch looks good.&lt;/p&gt;</comment>
                            <comment id="13601051" author="farrellee" created="Wed, 13 Mar 2013 11:50:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sureshms&quot; class=&quot;user-hover&quot; rel=&quot;sureshms&quot;&gt;sureshms&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Re CLOSED - ok, my background w/ workflows is that once CLOSED leave closed, open a new issue&lt;/p&gt;

&lt;p&gt;Re version - I&apos;ve only been able to find the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-7101&quot; title=&quot;UserGroupInformation.getCurrentUser() fails when called from non-Hadoop JAAS context&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-7101&quot;&gt;&lt;del&gt;HADOOP-7101&lt;/del&gt;&lt;/a&gt; on the 0.23.* and 2.0.* release tags. That may mean this issue was not actually fixed in 0.22.0. However, I&apos;m not familiar enough with the version streams to say for sure.&lt;/p&gt;</comment>
                            <comment id="13601165" author="sureshms" created="Wed, 13 Mar 2013 14:08:13 +0000"  >&lt;p&gt;Changing the fix version from 0.22 to 0.23. I also changed CHANGES.txt in the current branches of development to reflect this.&lt;/p&gt;</comment>
                            <comment id="13601196" author="sureshms" created="Wed, 13 Mar 2013 14:37:48 +0000"  >&lt;p&gt;I committed the patch to branch-1 and branch-1.2.&lt;/p&gt;</comment>
                            <comment id="13668376" author="yetanothercoder" created="Tue, 28 May 2013 15:38:35 +0000"  >&lt;p&gt;0.23.x - OK, but current maven hadoop version (1.1.2) still has this bug, I got it in OSGI with hbase + hadoop-core.&lt;/p&gt;</comment>
                            <comment id="13668416" author="sureshms" created="Tue, 28 May 2013 16:29:22 +0000"  >&lt;blockquote&gt;&lt;p&gt;OK, but current maven hadoop version (1.1.2) &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes. The change is not in 1.1.2. It is in next minor release 1.2.0.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12493713">HADOOP-7070</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12597774">HADOOP-8572</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="12630821">HADOOP-9280</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12573485" name="hadoop-7101.branch-1.patch" size="2454" author="sureshms" created="Wed, 13 Mar 2013 07:30:48 +0000"/>
                            <attachment id="12468097" name="hadoop-7101.txt" size="2604" author="tlipcon" created="Wed, 12 Jan 2011 02:38:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36981</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 26 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02pyv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>13808</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12321659">1.2.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>