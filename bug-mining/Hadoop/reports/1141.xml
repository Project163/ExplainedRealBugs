<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:44:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-10540] Datanode upgrade in Windows fails with hardlink error.</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-10540</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;I try to upgrade Hadoop from 1.x and 2.4, but DataNode failed to start due to hard link exception.&lt;br/&gt;
Repro steps:&lt;br/&gt;
*Installed Hadoop 1.x&lt;br/&gt;
*hadoop dfsadmin -safemode enter&lt;br/&gt;
*hadoop dfsadmin -saveNamespace&lt;br/&gt;
*hadoop namenode -finalize&lt;br/&gt;
*Stop all services&lt;br/&gt;
*Uninstall Hadoop 1.x &lt;br/&gt;
*Install Hadoop 2.4 &lt;br/&gt;
*Start namenode with -upgrade option&lt;br/&gt;
*Try to start datanode, begin to see Hardlink exception in datanode service log.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2014-04-10 22:47:11,655 INFO org.apache.hadoop.ipc.Server: IPC Server listener on 8010: starting
2014-04-10 22:47:11,656 INFO org.apache.hadoop.ipc.Server: IPC Server Responder: starting
2014-04-10 22:47:11,999 INFO org.apache.hadoop.hdfs.server.common.Storage: Data-node version: -55 and name-node layout version: -56
2014-04-10 22:47:12,008 INFO org.apache.hadoop.hdfs.server.common.Storage: Lock on d:\hadoop\data\hdfs\dn\in_use.lock acquired by nodename 7268@myhost
2014-04-10 22:47:12,011 INFO org.apache.hadoop.hdfs.server.common.Storage: Recovering storage directory D:\hadoop\data\hdfs\dn from previous upgrade
2014-04-10 22:47:12,017 INFO org.apache.hadoop.hdfs.server.common.Storage: Upgrading storage directory d:\hadoop\data\hdfs\dn.
   old LV = -44; old CTime = 0.
   &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LV = -55; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CTime = 1397168400373
2014-04-10 22:47:12,021 INFO org.apache.hadoop.hdfs.server.common.Storage: Formatting block pool BP-39008719-10.0.0.1-1397168400092 directory d:\hadoop\data\hdfs\dn\current\BP-39008719-10.0.0.1-1397168400092\current
2014-04-10 22:47:12,254 FATAL org.apache.hadoop.hdfs.server.datanode.DataNode: Initialization failed &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; block pool Block pool &amp;lt;registering&amp;gt; (Datanode Uuid unassigned) service to myhost/10.0.0.1:8020
java.io.IOException: Usage: hardlink create [LINKNAME] [FILENAME] |Incorrect command line arguments.
	at org.apache.hadoop.fs.HardLink.createHardLinkMult(HardLink.java:479)
	at org.apache.hadoop.fs.HardLink.createHardLinkMult(HardLink.java:416)
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.linkBlocks(DataStorage.java:816)
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.linkAllBlocks(DataStorage.java:759)
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.doUpgrade(DataStorage.java:566)
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.doTransition(DataStorage.java:486)
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.recoverTransitionRead(DataStorage.java:225)
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.recoverTransitionRead(DataStorage.java:249)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.initStorage(DataNode.java:929)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.initBlockPool(DataNode.java:900)
	at org.apache.hadoop.hdfs.server.datanode.BPOfferService.verifyAndSetNamespaceInfo(BPOfferService.java:274)
	at org.apache.hadoop.hdfs.server.datanode.BPServiceActor.connectToNNAndHandshake(BPServiceActor.java:220)
	at org.apache.hadoop.hdfs.server.datanode.BPServiceActor.run(BPServiceActor.java:815)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:722)
2014-04-10 22:47:12,258 WARN org.apache.hadoop.hdfs.server.datanode.DataNode: Ending block pool service &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;: Block pool &amp;lt;registering&amp;gt; (Datanode Uuid unassigned) service to myhost/10.0.0.1:8020
2014-04-10 22:47:12,359 WARN org.apache.hadoop.hdfs.server.datanode.DataNode: Block pool ID needed, but service not yet registered with NN
java.lang.Exception: trace
	at org.apache.hadoop.hdfs.server.datanode.BPOfferService.getBlockPoolId(BPOfferService.java:143)
	at org.apache.hadoop.hdfs.server.datanode.BlockPoolManager.remove(BlockPoolManager.java:91)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.shutdownBlockPool(DataNode.java:859)
	at org.apache.hadoop.hdfs.server.datanode.BPOfferService.shutdownActor(BPOfferService.java:350)
	at org.apache.hadoop.hdfs.server.datanode.BPServiceActor.cleanUp(BPServiceActor.java:619)
	at org.apache.hadoop.hdfs.server.datanode.BPServiceActor.run(BPServiceActor.java:837)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:722)
2014-04-10 22:47:12,359 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: Removed Block pool &amp;lt;registering&amp;gt; (Datanode Uuid unassigned)
2014-04-10 22:47:12,360 WARN org.apache.hadoop.hdfs.server.datanode.DataNode: Block pool ID needed, but service not yet registered with NN
java.lang.Exception: trace
	at org.apache.hadoop.hdfs.server.datanode.BPOfferService.getBlockPoolId(BPOfferService.java:143)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.shutdownBlockPool(DataNode.java:861)
	at org.apache.hadoop.hdfs.server.datanode.BPOfferService.shutdownActor(BPOfferService.java:350)
	at org.apache.hadoop.hdfs.server.datanode.BPServiceActor.cleanUp(BPServiceActor.java:619)
	at org.apache.hadoop.hdfs.server.datanode.BPServiceActor.run(BPServiceActor.java:837)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:722)
2014-04-10 22:47:14,360 WARN org.apache.hadoop.hdfs.server.datanode.DataNode: Exiting Datanode
2014-04-10 22:47:14,361 INFO org.apache.hadoop.util.ExitUtil: Exiting with status 0
2014-04-10 22:47:14,362 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: SHUTDOWN_MSG: 
/************************************************************
SHUTDOWN_MSG: Shutting down DataNode at myhost/10.0.0.1
************************************************************/
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;Windows + JDK7. The issue was hit while upgrading from 1.x to 2.4.&lt;/p&gt;</environment>
        <key id="12707877">HADOOP-10540</key>
            <summary>Datanode upgrade in Windows fails with hardlink error.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="arp">Arpit Agarwal</assignee>
                                    <reporter username="hhuang2014">Huan Huang</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Apr 2014 05:14:07 +0000</created>
                <updated>Wed, 3 Sep 2014 20:36:30 +0000</updated>
                            <resolved>Fri, 25 Apr 2014 03:13:05 +0000</resolved>
                                    <version>2.4.0</version>
                                    <fixVersion>2.5.0</fixVersion>
                                    <component>tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="13966246" author="arpitagarwal" created="Fri, 11 Apr 2014 05:21:29 +0000"  >&lt;p&gt;The &quot;1&amp;gt;NUL&quot; is passed as a parameter to the winutils command instead of the being interpreted by the shell. The simplest fix is to just remove it.&lt;/p&gt;</comment>
                            <comment id="13966257" author="cnauroth" created="Fri, 11 Apr 2014 05:46:20 +0000"  >&lt;p&gt;+1 for the patch, pending Jenkins run.  Thanks a lot for tracking down this tricky bug!&lt;/p&gt;</comment>
                            <comment id="13966258" author="arpitagarwal" created="Fri, 11 Apr 2014 05:46:31 +0000"  >&lt;p&gt;Initial patch, I will probably add a unit test before its ready for review.&lt;/p&gt;</comment>
                            <comment id="13966259" author="arpitagarwal" created="Fri, 11 Apr 2014 05:47:47 +0000"  >&lt;p&gt;Our comments crossed, thanks for the quick review Chris! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I&apos;d also like to add a unit test, will look into it tomorrow.&lt;/p&gt;</comment>
                            <comment id="13966263" author="cnauroth" created="Fri, 11 Apr 2014 05:54:24 +0000"  >&lt;p&gt;Good point.  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  Thanks again.&lt;/p&gt;</comment>
                            <comment id="13966272" author="szetszwo" created="Fri, 11 Apr 2014 06:10:31 +0000"  >&lt;p&gt;Please also change HardLink.createHardLinkMult so that if the command fails, include hardLinkCommand to the exception message.&lt;/p&gt;</comment>
                            <comment id="13966275" author="hadoopqa" created="Fri, 11 Apr 2014 06:15:26 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12639738/HDFS-6233.01.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12639738/HDFS-6233.01.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  There were no new javadoc warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests in hadoop-common-project/hadoop-common:&lt;/p&gt;

&lt;p&gt;                  org.apache.hadoop.fs.TestHardLink&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HDFS-Build/6649//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HDFS-Build/6649//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HDFS-Build/6649//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HDFS-Build/6649//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13967093" author="cnauroth" created="Fri, 11 Apr 2014 20:59:44 +0000"  >&lt;p&gt;Another problem discovered during testing is that the external process launched to make the hardlink can hang.  On Windows, it&apos;s important for the launching process to fully consume stdout and stderr.  Otherwise, the process never really exits.  This is a fundamental problem with the JDK &lt;tt&gt;Process&lt;/tt&gt; class.  Fortunately, our own &lt;tt&gt;Shell&lt;/tt&gt; class already implements the right workarounds, so it&apos;s easy to fix by converting &lt;tt&gt;HardLink&lt;/tt&gt; to use &lt;tt&gt;Shell&lt;/tt&gt; instead of &lt;tt&gt;Process&lt;/tt&gt;.  I&apos;m attaching a patch that combines that fix with Arpit&apos;s original fix.&lt;/p&gt;</comment>
                            <comment id="13967145" author="arpitagarwal" created="Fri, 11 Apr 2014 21:47:52 +0000"  >&lt;p&gt;+1 from me, however perhaps it will be appropriate for another committer to +1 it too.&lt;/p&gt;

&lt;p&gt;I&apos;ve tested the updated patch on OS X and Windows and it fixes the hang.&lt;/p&gt;</comment>
                            <comment id="13967147" author="hadoopqa" created="Fri, 11 Apr 2014 21:50:32 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12639865/HDFS-6233.02.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12639865/HDFS-6233.02.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 1 new or modified test files.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  There were no new javadoc warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-common-project/hadoop-common.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HDFS-Build/6654//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HDFS-Build/6654//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HDFS-Build/6654//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HDFS-Build/6654//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13967153" author="jingzhao" created="Fri, 11 Apr 2014 21:55:32 +0000"  >&lt;p&gt;+1 the patch looks good to me. Thanks for the fix &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cnauroth&quot; class=&quot;user-hover&quot; rel=&quot;cnauroth&quot;&gt;cnauroth&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arpitagarwal&quot; class=&quot;user-hover&quot; rel=&quot;arpitagarwal&quot;&gt;arpitagarwal&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="13967177" author="szetszwo" created="Fri, 11 Apr 2014 22:26:11 +0000"  >&lt;p&gt;Questions:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;hardLinkMultPrefix uses &quot;cmd&quot; but getLinkMultArgLength uses &quot;cmd.exe&quot;.  Do they have to be matched?  If it is a bug, we should use the static variables to construct the string.&lt;/li&gt;
	&lt;li&gt;Why there is a trailing space in the line below
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+              + Shell.WINUTILS + &lt;span class=&quot;code-quote&quot;&gt;&quot; hardlink create \\%f %f &quot;&lt;/span&gt;).length();
                                                           ^
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;Do we have a unit test covering this method?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;If you are going to update the patch, please add hardLinkCommand to all the exception messages.  It will be much easy to debug.  Otherwise, we may change this in a separated JIRA.&lt;/p&gt;

&lt;p&gt;(I also suggest to change winutils for better error messages later on.  Before this patch, it outputs &quot;Usage: hardlink create [LINKNAME] [FILENAME] |Incorrect command line arguments.&quot; which is created by concatenating the first line of the usage string shown below with &quot;Incorrect command line arguments.&quot;  Such concatenation seems arbitrary.  We should change the error message to be more specific, e.g. &quot;Incorrect number of command line arguments, expect 3 or 4 but actually number is 5.  The input command is ...&quot;)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;//hardlink.c
&lt;/span&gt;void HardlinkUsage()
{
    fwprintf(stdout, L&quot;\
Usage: hardlink create [LINKNAME] [FILENAME] |\n\
       hardlink stat [FILENAME]\n\
Creates a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; hardlink on the existing file or displays the number of links\n\
&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the given file\n&quot;);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13967179" author="szetszwo" created="Fri, 11 Apr 2014 22:29:06 +0000"  >&lt;p&gt;&amp;gt; ... expect 3 or 4 but actually number is 5 ...&lt;/p&gt;

&lt;p&gt;For hardlink create, it must be 4.  So it should be &quot;... expect 4 but actually number is 5 ...&quot;&lt;/p&gt;</comment>
                            <comment id="13967341" author="szetszwo" created="Sat, 12 Apr 2014 01:47:59 +0000"  >&lt;p&gt;If there are bugs in getLinkMultArgLength but the bugs do not affect upgrade, we may fix them separately.&lt;/p&gt;</comment>
                            <comment id="13979209" author="szetszwo" created="Thu, 24 Apr 2014 02:39:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cnauroth&quot; class=&quot;user-hover&quot; rel=&quot;cnauroth&quot;&gt;cnauroth&lt;/a&gt;/&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arpitagarwal&quot; class=&quot;user-hover&quot; rel=&quot;arpitagarwal&quot;&gt;arpitagarwal&lt;/a&gt;, any update?&lt;/p&gt;</comment>
                            <comment id="13980554" author="arpitagarwal" created="Fri, 25 Apr 2014 00:35:10 +0000"  >&lt;p&gt;Updated patch to address most of the feedback from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=szetszwo&quot; class=&quot;user-hover&quot; rel=&quot;szetszwo&quot;&gt;szetszwo&lt;/a&gt;. I also updated the exception message for createHardLink to include the failed command. Let&apos;s address hardlink.c issues in a separate JIRA.&lt;/p&gt;

&lt;p&gt;We have existing unit tests but they did not catch this failure. There appears to be some environment/JDK version issue that we were not able to figure out.&lt;/p&gt;

&lt;p&gt;Longer term we should just deprecate all this code and use &lt;a href=&quot;http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#createLink%28java.nio.file.Path,%20java.nio.file.Path%29&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Files.createLink&lt;/a&gt; if we detect Java 7+. It will be much more efficient than launching a new process for each file.&lt;/p&gt;</comment>
                            <comment id="13980592" author="szetszwo" created="Fri, 25 Apr 2014 01:13:53 +0000"  >&lt;p&gt;+1 patch looks good.&lt;/p&gt;</comment>
                            <comment id="13980604" author="hadoopqa" created="Fri, 25 Apr 2014 01:26:59 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12641844/HDFS-6233.03.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12641844/HDFS-6233.03.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 1 new or modified test files.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  There were no new javadoc warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests in hadoop-common-project/hadoop-common:&lt;/p&gt;

&lt;p&gt;                  org.apache.hadoop.metrics2.impl.TestMetricsSystemImpl&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HDFS-Build/6726//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HDFS-Build/6726//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HDFS-Build/6726//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HDFS-Build/6726//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13980657" author="arpitagarwal" created="Fri, 25 Apr 2014 03:13:05 +0000"  >&lt;p&gt;The &lt;tt&gt;TestMetricsSystemImpl&lt;/tt&gt; failure looks unrelated to this patch.&lt;/p&gt;

&lt;p&gt;Thanks for the reviews &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=szetszwo&quot; class=&quot;user-hover&quot; rel=&quot;szetszwo&quot;&gt;szetszwo&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jingzhao&quot; class=&quot;user-hover&quot; rel=&quot;jingzhao&quot;&gt;jingzhao&lt;/a&gt;; and also thanks to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cnauroth&quot; class=&quot;user-hover&quot; rel=&quot;cnauroth&quot;&gt;cnauroth&lt;/a&gt; for co-authoring the patch. I committed this to trunk and branch-2.&lt;/p&gt;</comment>
                            <comment id="13980658" author="hudson" created="Fri, 25 Apr 2014 03:23:41 +0000"  >&lt;p&gt;SUCCESS: Integrated in Hadoop-trunk-Commit #5569 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-trunk-Commit/5569/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-trunk-Commit/5569/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-10540&quot; title=&quot;Datanode upgrade in Windows fails with hardlink error.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-10540&quot;&gt;&lt;del&gt;HADOOP-10540&lt;/del&gt;&lt;/a&gt;. Datanode upgrade in Windows fails with hardlink error. (Contributed by Chris Nauroth and Arpit Agarwal) (arp: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1589923&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1589923&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HardLink.java&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/TestHardLink.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13980920" author="hudson" created="Fri, 25 Apr 2014 12:03:21 +0000"  >&lt;p&gt;SUCCESS: Integrated in Hadoop-Yarn-trunk #551 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Yarn-trunk/551/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Yarn-trunk/551/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-10540&quot; title=&quot;Datanode upgrade in Windows fails with hardlink error.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-10540&quot;&gt;&lt;del&gt;HADOOP-10540&lt;/del&gt;&lt;/a&gt;. Datanode upgrade in Windows fails with hardlink error. (Contributed by Chris Nauroth and Arpit Agarwal) (arp: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1589923&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1589923&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HardLink.java&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/TestHardLink.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13980983" author="hudson" created="Fri, 25 Apr 2014 13:33:34 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Mapreduce-trunk #1768 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1768/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1768/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-10540&quot; title=&quot;Datanode upgrade in Windows fails with hardlink error.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-10540&quot;&gt;&lt;del&gt;HADOOP-10540&lt;/del&gt;&lt;/a&gt;. Datanode upgrade in Windows fails with hardlink error. (Contributed by Chris Nauroth and Arpit Agarwal) (arp: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1589923&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1589923&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HardLink.java&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/TestHardLink.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13981012" author="hudson" created="Fri, 25 Apr 2014 13:40:15 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Hdfs-trunk #1742 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1742/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1742/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-10540&quot; title=&quot;Datanode upgrade in Windows fails with hardlink error.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-10540&quot;&gt;&lt;del&gt;HADOOP-10540&lt;/del&gt;&lt;/a&gt;. Datanode upgrade in Windows fails with hardlink error. (Contributed by Chris Nauroth and Arpit Agarwal) (arp: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1589923&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1589923&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HardLink.java&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/TestHardLink.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12639738" name="HDFS-6233.01.patch" size="1551" author="arp" created="Fri, 11 Apr 2014 05:21:29 +0000"/>
                            <attachment id="12639865" name="HDFS-6233.02.patch" size="7126" author="cnauroth" created="Fri, 11 Apr 2014 20:59:44 +0000"/>
                            <attachment id="12641844" name="HDFS-6233.03.patch" size="8556" author="arp" created="Fri, 25 Apr 2014 00:35:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>386200</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 30 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1uj47:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>386465</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12326263">2.5.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>