<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:51:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-13717] Normalize daemonization behavior of the diskbalancer with balancer and mover</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-13717</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;Issue found when working with the HDFS balancer.&lt;/p&gt;

&lt;p&gt;In &lt;tt&gt;hadoop_daemon_handler&lt;/tt&gt;, it calls &lt;tt&gt;hadoop_verify_logdir&lt;/tt&gt; even for the &quot;default&quot; case which calls &lt;tt&gt;hadoop_start_daemon&lt;/tt&gt;. &lt;tt&gt;daemon_outfile&lt;/tt&gt; which specifies the log location isn&apos;t even used here, since the command is being started in the foreground.&lt;/p&gt;

&lt;p&gt;I think we can push the &lt;tt&gt;hadoop_verify_logdir&lt;/tt&gt; call down into &lt;tt&gt;hadoop_start_daemon_wrapper&lt;/tt&gt; instead, which does use the outfile.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13011817">HADOOP-13717</key>
            <summary>Normalize daemonization behavior of the diskbalancer with balancer and mover</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="andrew.wang">Andrew Wang</assignee>
                                    <reporter username="andrew.wang">Andrew Wang</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Oct 2016 22:16:09 +0000</created>
                <updated>Wed, 2 Nov 2016 21:00:22 +0000</updated>
                            <resolved>Wed, 2 Nov 2016 20:47:11 +0000</resolved>
                                    <version>3.0.0-alpha1</version>
                                                    <component>scripts</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15570041" author="andrew.wang" created="Wed, 12 Oct 2016 22:16:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aw&quot; class=&quot;user-hover&quot; rel=&quot;aw&quot;&gt;aw&lt;/a&gt;, does the problem in the JIRA description make sense to you? If so, I can try a simple patch.&lt;/p&gt;</comment>
                            <comment id="15570046" author="aw" created="Wed, 12 Oct 2016 22:19:15 +0000"  >&lt;p&gt;The log directory may still get used, depending upon the log4j settings.&lt;/p&gt;

&lt;p&gt;(An example would be the HDFS audit log.)&lt;/p&gt;</comment>
                            <comment id="15570101" author="andrew.wang" created="Wed, 12 Oct 2016 22:44:22 +0000"  >&lt;p&gt;For a bit more context, we have some code that starts the balancer in the foreground, without a log4j.properties file or setting $HADOOP_LOG_DIR. verify_logdir then checks the default location ($HADOOP_HOME/logs), which is not writable, and fails.&lt;/p&gt;

&lt;p&gt;Other commands that do not support daemonization skip all these checks. In this case, I&apos;m not  trying to run the balancer as a daemon. Is it reasonable to also skip these checks in this situation? Looking more at the code, I think what I want is to go directly to hadoop_java_exec rather than the daemon logic.&lt;/p&gt;</comment>
                            <comment id="15572596" author="aw" created="Thu, 13 Oct 2016 17:22:55 +0000"  >&lt;p&gt;Ah, OK. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Is it reasonable to also skip these checks in this situation?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In the general daemon case we definitely need to leave the hadoop_verify_logdir in place.  This will get followed up with verifying the pid dir as well.  This is needed because many folks run the daemon commands &quot;interactively&quot; from a shell code perspective but do their own daemonization from init.  There&apos;s also the docker case where individual daemons are in their own containers.   etc, etc. We&apos;re almost always better checking for the existence of this dirs rather than letting Java go haywire.&lt;/p&gt;

&lt;p&gt;But balancer (and mover and probably a handful of others) are, in many ways, special.&lt;/p&gt;

&lt;p&gt;We effectively have a problem of history. sbin/start-balancer.sh was added way back when as a convenience  to background the balancer.  When the rewrite happened, balancer was added to the commands that could be daemonized as a result.   &lt;/p&gt;

&lt;p&gt;There might also be a privilege problem here too.  I don&apos;t think balancer can be run as by a non-privileged user, usually making the log and pid dir verification (usually) safe and somewhat required if we want all of our daemons to function in the same way (consistency!).  The pid check at the UNIX level definitely helps prevent multiple instances running on the same host way faster (and somewhat more reliably!) than the Java checks. &lt;/p&gt;

&lt;p&gt;To me, the questions become:&lt;/p&gt;

&lt;p&gt;a) should balancer stay as a daemon? what about the other not-really-daemons-but-can-run-in-daemon-mode subcommands?&lt;br/&gt;
b) should instead there be logic to say that failing logdir and piddir are optionally fatal?&lt;br/&gt;
c) should a local override be used instead? (e.g., define a shell profile that replaces the hdfs balancer command)&lt;/p&gt;
</comment>
                            <comment id="15573587" author="andrew.wang" created="Fri, 14 Oct 2016 00:01:05 +0000"  >&lt;p&gt;Besides the Mover, I&apos;d also include the new intra-DN balancer in the collection of special commands. It&apos;s currently not daemon-enabled.&lt;/p&gt;

&lt;p&gt;I don&apos;t have strong opinions here, but it seems like if someone is not specifying the &quot;--daemon&quot; flag, then they don&apos;t care about daemon things like pid files and log dirs for stdout/stderr. The audit log is an interesting case, but I think app-specific logging should be checked in the app, not the shell scripts (which are generic).&lt;/p&gt;

&lt;p&gt;I think some combination of a) and b) is appropriate.&lt;/p&gt;

&lt;p&gt;Regarding a), I don&apos;t think the balancer is commonly run in the background; Bigtop and CDH don&apos;t have balancer init scripts for instance. So can remove daemonization, also for Mover if it has it.&lt;/p&gt;

&lt;p&gt;Regarding b), I&apos;d prefer to short-circuit to hadoop_java_exec, but b) is alright too. I think there should be some generic fix for when &quot;--daemon&quot; isn&apos;t specified, because of user expectations.&lt;/p&gt;

&lt;p&gt;Happy to try a patch if you agree.&lt;/p&gt;</comment>
                            <comment id="15576304" author="aw" created="Fri, 14 Oct 2016 19:48:25 +0000"  >&lt;blockquote&gt;&lt;p&gt;it seems like if someone is not specifying the &quot;--daemon&quot; flag, then they don&apos;t care about daemon things like pid files and log dirs for stdout/stderr.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;They do, actually.  The inconsistent behavior of the hadoop daemons was a big sticking point amongst quite a few admins I had talked to.  &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The audit log is an interesting case, but I think app-specific logging should be checked in the app, not the shell scripts (which are generic).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;d love to see pid and log dir handling out of the scripts.  It greatly over-complicates them. One thing to keep in mind that doing it prior to Java launch means that we get extremely fast fail: there&apos;s no Java classpath work and no Java initialization costs.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Bigtop and CDH don&apos;t have balancer init scripts for instance.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sorry, I think I may have miscommunicated this point.  start-balancer is geared towards manual usage but running it in the background and catching it&apos;s IO as it can run for very long times on large and/or extremely misbalanced clusters.  It&apos;s not a daemon in the traditional sense.   It really is a convience script so that those that aren&apos;t familiar with bash don&apos;t have to remember how to catch stdout/stderr, or use disown or whatever.   I&apos;d be very surprised if there actually was an init script.&lt;/p&gt;

&lt;p&gt;It&apos;s fun to note that the start-balancer script only appears to be documented in the Balancer javadoc and the only place that Javadoc is really exposed is on Cloudera&apos;s website. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I think there should be some generic fix for when &quot;--daemon&quot; isn&apos;t specified, because of user expectations.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;As stated above, user expectation is consistency.  No consistency will mean we&apos;ll also need to remove the --daemon status capability since it will be unreliable.&lt;/p&gt;
</comment>
                            <comment id="15576337" author="aw" created="Fri, 14 Oct 2016 19:59:27 +0000"  >&lt;p&gt;I think it&apos;s important to point out that this ...&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;For a bit more context, we have some code that starts the balancer in the foreground, without a log4j.properties file or setting $HADOOP_LOG_DIR. verify_logdir then checks the default location ($HADOOP_HOME/logs), which is not writable, and fails.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;... is an edge case.&lt;/p&gt;

&lt;p&gt;Most users of hadoop almost certainly have a log4j.properties file and HADOOP_LOG_DIR is set somewhere writable at installation time.&lt;/p&gt;</comment>
                            <comment id="15576443" author="andrew.wang" created="Fri, 14 Oct 2016 20:49:14 +0000"  >&lt;p&gt;Man, the balancer is a can of worms. Not a daemon, but runs awkwardly longer than other normal commands. This is the root of potential differences in expectations.&lt;/p&gt;

&lt;p&gt;What do you propose we do? Minimally, we should make sure all the members of the balancer family have the same daemonization behavior, which is currently untrue.&lt;/p&gt;

&lt;p&gt;If part of the answer is that the balancer family are daemons and need a HADOOP_LOG_DIR and a log4j.properties, that&apos;s fine with me. Not a hard change on our side.&lt;/p&gt;</comment>
                            <comment id="15576821" author="aw" created="Fri, 14 Oct 2016 23:03:03 +0000"  >&lt;blockquote&gt;&lt;p&gt;Man, the balancer is a can of worms. Not a daemon, but runs awkwardly longer than other normal commands. This is the root of potential differences in expectations.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yup. Completely agree. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;What do you propose we do? Minimally, we should make sure all the members of the balancer family have the same daemonization behavior, which is currently untrue.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, we probably should make sure they are treated the same in the hdfs script if they aren&apos;t.  We should definitely avoid adding more sbin scripts.  My hope is that in 4.x we can wipe out most of sbin and reduce our code footprint.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;If part of the answer is that the balancer family are daemons and need a HADOOP_LOG_DIR and a log4j.properties, that&apos;s fine with me. Not a hard change on our side.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I was thinking about what kind of interfaces/guarantees we provide 3rd parties. We make no promises about the content of log4j that I could find, so that&apos;s an easy one. But if a non-ASF jar gets added to the classpath via shellprofile what would the expectations on HADOOP_LOG_DIR and -Dhadoop.log.dir be?  The key might be hadoop-env.sh:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;# Where (primarily) daemon log files are stored.
# ${HADOOP_HOME}/logs by &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;.
# Java property: hadoop.log.dir
# export HADOOP_LOG_DIR=${HADOOP_HOME}/logs
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It&apos;s pretty clear that HADOOP_LOG_DIR is expected to point somewhere valid when we run as a daemon. HADOOP_LOG_DIR needs to work then on daemons. That leads me to we basically have three choices:&lt;/p&gt;

&lt;p&gt;1. If there is a general agreement amongst the community that balancer and friends should run with HADOOP_SUBCMD_SUPPORTDAEMONIZATION=true, then HADOOP_LOG_DIR should be set to something writable (e.g., /tmp) when it is being executed.&lt;/p&gt;

&lt;p&gt;2. If balancer should be run with HADOOP_SUBCMD_SUPPORTDAEMONIZATION=false, it now becomes a normal client command and sbin/start-balancer goes away.  HADOOP_LOG_DIR, etc, now become irrelevant.&lt;/p&gt;

&lt;p&gt;3. Some third state needs to get introduced and all of the accompanying support code added so that we can support it in all of the user-executable scripts.&lt;/p&gt;

&lt;p&gt;At this point, yes, I think the easiest path forward really is #1: HADOOP_LOG_DIR must point somewhere writable.  All of the other options have a lot more pain involved, for us and/or the end users.&lt;/p&gt;</comment>
                            <comment id="15583594" author="andrew.wang" created="Mon, 17 Oct 2016 21:48:29 +0000"  >&lt;p&gt;Sounds good. Attaching a trivial patch which makes the intra-DN balancer also support daemonization.&lt;/p&gt;</comment>
                            <comment id="15583656" author="hadoopqa" created="Mon, 17 Oct 2016 22:10:03 +0000"  >&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;b&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;&lt;/b&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;&lt;br class=&quot;atl-forced-newline&quot; /&gt;
&lt;br class=&quot;atl-forced-newline&quot; /&gt;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Vote &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Subsystem &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Runtime &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Comment &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;blue&quot;&gt;0&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;blue&quot;&gt; reexec &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;blue&quot;&gt;  0m 17s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;blue&quot;&gt; Docker mode activated. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; @author &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  0m  0s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; The patch does not contain any @author tags. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;red&quot;&gt; test4tests &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;red&quot;&gt;  0m  0s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;red&quot;&gt; The patch doesn&apos;t appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; mvninstall &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  7m 11s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; trunk passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; mvnsite &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  0m 55s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; trunk passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; mvnsite &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  0m 50s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; shellcheck &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  0m 12s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; The patch generated 0 new + 74 unchanged - 1 fixed = 74 total (was 75) &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; shelldocs &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  0m 11s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; There were no new shelldocs issues. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; whitespace &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  0m  0s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; The patch has no whitespace issues. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; unit &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  0m 46s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; hadoop-hdfs in the patch passed. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; asflicense &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  0m 18s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; The patch does not generate ASF License warnings. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt;&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt; &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt; 11m 39s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt; &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;&lt;br class=&quot;atl-forced-newline&quot; /&gt;
&lt;br class=&quot;atl-forced-newline&quot; /&gt;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Subsystem &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Report/Notes &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Docker &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  Image:yetus/hadoop:9560f25 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; JIRA Issue &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-13717&quot; title=&quot;Normalize daemonization behavior of the diskbalancer with balancer and mover&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-13717&quot;&gt;&lt;del&gt;HADOOP-13717&lt;/del&gt;&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; JIRA Patch URL &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12833812/HADOOP-13717.001.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12833812/HADOOP-13717.001.patch&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Optional Tests &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  asflicense  mvnsite  unit  shellcheck  shelldocs  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; uname &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Linux de1528f26471 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Build tool &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; maven &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Personality &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; /testptch/hadoop/patchprocess/precommit/personality/provided.sh &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; git revision &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; trunk / f5d9235 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; shellcheck &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; v0.4.4 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  Test Results &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/10815/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/10815/testReport/&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; modules &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; C: hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project/hadoop-hdfs &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Console output &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/10815/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/10815/console&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Powered by &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Apache Yetus 0.4.0-SNAPSHOT   &lt;a href=&quot;http://yetus.apache.org&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://yetus.apache.org&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;



&lt;p&gt;This message was automatically generated.&lt;/p&gt;
</comment>
                            <comment id="15623204" author="andrew.wang" created="Mon, 31 Oct 2016 20:05:58 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aw&quot; class=&quot;user-hover&quot; rel=&quot;aw&quot;&gt;aw&lt;/a&gt; could I get a review? Trivial one.&lt;/p&gt;</comment>
                            <comment id="15626431" author="aw" created="Tue, 1 Nov 2016 19:29:18 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="15627095" author="andrew.wang" created="Tue, 1 Nov 2016 23:49:38 +0000"  >&lt;p&gt;Thanks Allen for discussion and review, I&apos;ve committed this to trunk.&lt;/p&gt;</comment>
                            <comment id="15627123" author="hudson" created="Wed, 2 Nov 2016 00:01:23 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #10749 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-trunk-Commit/10749/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-trunk-Commit/10749/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-13717&quot; title=&quot;Normalize daemonization behavior of the diskbalancer with balancer and mover&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-13717&quot;&gt;&lt;del&gt;HADOOP-13717&lt;/del&gt;&lt;/a&gt;. Normalize daemonization behavior of the diskbalancer with (wang: rev bd7f5911c726c505a654d5d30b7dc5a92dca05bd)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15629744" author="anu" created="Wed, 2 Nov 2016 17:32:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andrew.wang&quot; class=&quot;user-hover&quot; rel=&quot;andrew.wang&quot;&gt;andrew.wang&lt;/a&gt;  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aw&quot; class=&quot;user-hover&quot; rel=&quot;aw&quot;&gt;aw&lt;/a&gt; Sorry to comment on this late.  Just saw it when I was looking at the git log. The DiskBalancerCLI runs but for a brief moment when planning and writes a plan file out. Then when you submit plan it reads the plan file and sends it datanode via RPC. Both of those AFAIK does not qualify as a daemon behaviour. So why classify this as a daemon ?  &lt;/p&gt;

&lt;p&gt;I agree with the balancer comments, it does run for a long time. All long running activity for diskbalancer is confined within the datanode, Perhaps I am missing something here ? &lt;/p&gt;</comment>
                            <comment id="15630422" author="andrew.wang" created="Wed, 2 Nov 2016 20:46:06 +0000"  >&lt;p&gt;Thanks for the info Anu, I wrongly assumed the diskbalancer CLI worked like the balancer. I&apos;ll revert this change and close as WONTFIX.&lt;/p&gt;</comment>
                            <comment id="15630426" author="andrew.wang" created="Wed, 2 Nov 2016 20:47:13 +0000"  >&lt;p&gt;Reverted and reclosing, thanks again Anu for catching this.&lt;/p&gt;</comment>
                            <comment id="15630448" author="anu" created="Wed, 2 Nov 2016 20:50:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andrew.wang&quot; class=&quot;user-hover&quot; rel=&quot;andrew.wang&quot;&gt;andrew.wang&lt;/a&gt;Thanks for reverting it. &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aw&quot; class=&quot;user-hover&quot; rel=&quot;aw&quot;&gt;aw&lt;/a&gt; Would this be a good time for us to see if we should fix how to discover which commands are daemons and which are normal commands in hdfs command set ? &lt;/p&gt;</comment>
                            <comment id="15630483" author="hudson" created="Wed, 2 Nov 2016 21:00:22 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #10755 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-trunk-Commit/10755/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-trunk-Commit/10755/&lt;/a&gt;)&lt;br/&gt;
Revert &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-13717&quot; title=&quot;Normalize daemonization behavior of the diskbalancer with balancer and mover&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-13717&quot;&gt;&lt;del&gt;HADOOP-13717&lt;/del&gt;&lt;/a&gt;. Normalize daemonization behavior of the (wang: rev f2800f523d4a4f9ff9c3286f9a839d081dcb5b96)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12833812" name="HADOOP-13717.001.patch" size="528" author="andrew.wang" created="Mon, 17 Oct 2016 21:48:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 2 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i34szr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12337975">3.0.0-alpha2</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>