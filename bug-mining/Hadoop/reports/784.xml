<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:42:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-9124] SortedMapWritable violates contract of Map interface for equals() and hashCode()</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-9124</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;This issue is similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-7153&quot; title=&quot;MapWritable violates contract of Map interface for equals() and hashCode()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-7153&quot;&gt;&lt;del&gt;HADOOP-7153&lt;/del&gt;&lt;/a&gt;. It was found when using MRUnit - see &lt;a href=&quot;https://issues.apache.org/jira/browse/MRUNIT-158&quot; title=&quot;withOutput doesn&amp;#39;t generate useful information with MapWritable on error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MRUNIT-158&quot;&gt;&lt;del&gt;MRUNIT-158&lt;/del&gt;&lt;/a&gt;, specifically &lt;a href=&quot;https://issues.apache.org/jira/browse/MRUNIT-158?focusedCommentId=13501985&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13501985&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/MRUNIT-158?focusedCommentId=13501985&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13501985&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&amp;#8211;&lt;br/&gt;
o.a.h.io.SortedMapWritable implements the java.util.Map interface, however it does not define an implementation of the equals() or hashCode() methods; instead the default implementations in java.lang.Object are used.&lt;/p&gt;

&lt;p&gt;This violates the contract of the Map interface which defines different behaviour for equals() and hashCode() than Object does. More information here: &lt;a href=&quot;http://download.oracle.com/javase/6/docs/api/java/util/Map.html#equals(java.lang.Object&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://download.oracle.com/javase/6/docs/api/java/util/Map.html#equals(java.lang.Object&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;The practical consequence is that SortedMapWritables containing equal entries cannot be compared properly. We were bitten by this when trying to write an MRUnit test for a Mapper that outputs MapWritables; the MRUnit driver cannot test the equality of the expected and actual MapWritable objects.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12622997">HADOOP-9124</key>
            <summary>SortedMapWritable violates contract of Map interface for equals() and hashCode()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="snihalani">Surenkumar Nihalani</assignee>
                                    <reporter username="phunt">Patrick D. Hunt</reporter>
                        <labels>
                    </labels>
                <created>Sat, 8 Dec 2012 00:55:59 +0000</created>
                <updated>Fri, 15 Feb 2013 13:12:37 +0000</updated>
                            <resolved>Thu, 7 Feb 2013 10:43:43 +0000</resolved>
                                    <version>1.1.1</version>
                    <version>2.0.2-alpha</version>
                                    <fixVersion>1.2.0</fixVersion>
                    <fixVersion>2.0.3-alpha</fixVersion>
                    <fixVersion>0.23.7</fixVersion>
                                    <component>io</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="13534503" author="snihalani" created="Tue, 18 Dec 2012 01:20:37 +0000"  >&lt;p&gt;SortedMapWritable uses a TreeMap internally. TreeMap inherits the needed implementation of equals() and hashCode() from AbstractMap. I am planning to write corresponding wrapper methods. Is there a better way to implement this?&lt;/p&gt;</comment>
                            <comment id="13534546" author="snihalani" created="Tue, 18 Dec 2012 02:23:17 +0000"  >&lt;p&gt;Request for code review.&lt;/p&gt;</comment>
                            <comment id="13534604" author="hadoopqa" created="Tue, 18 Dec 2012 03:43:58 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12561403/HADOOP-9124.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12561403/HADOOP-9124.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-common-project/hadoop-common.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/1905//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/1905//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/1905//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/1905//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13534633" author="kkambatl" created="Tue, 18 Dec 2012 04:33:19 +0000"  >&lt;p&gt;Hi Surenkumar,&lt;/p&gt;

&lt;p&gt;Thanks for working on this. The patch looks good - it would be great to have an associated unit test too.&lt;/p&gt;
</comment>
                            <comment id="13534669" author="snihalani" created="Tue, 18 Dec 2012 05:38:57 +0000"  >&lt;p&gt;Hey Karthik,&lt;/p&gt;

&lt;p&gt;sure. I&apos;ll add code that will test equals and hashCode.&lt;/p&gt;

&lt;p&gt;Do I add testcases in hadoop-trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/io/TestSortedMapWritable.java or I create another test file?&lt;/p&gt;

&lt;p&gt;sorry for noob question. This is my first contribution.&lt;/p&gt;
</comment>
                            <comment id="13534690" author="kkambatl" created="Tue, 18 Dec 2012 06:18:43 +0000"  >&lt;p&gt;Suren, Having all the tests corresponding to SortedMapWritable in TestSortedMapWritable is more convenient, easy to find.&lt;/p&gt;</comment>
                            <comment id="13534806" author="snihalani" created="Tue, 18 Dec 2012 10:20:33 +0000"  >&lt;p&gt;Added unit tests.&lt;/p&gt;</comment>
                            <comment id="13534807" author="snihalani" created="Tue, 18 Dec 2012 10:21:07 +0000"  >&lt;p&gt;Request for code review.&lt;/p&gt;</comment>
                            <comment id="13534812" author="hadoopqa" created="Tue, 18 Dec 2012 10:24:35 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12561459/HADOOP-9124.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12561459/HADOOP-9124.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/1908//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/1908//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13534824" author="hadoopqa" created="Tue, 18 Dec 2012 11:06:57 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12561462/HADOOP-9124.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12561462/HADOOP-9124.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 1 new or modified test files.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-common-project/hadoop-common.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/1909//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/1909//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/1909//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/1909//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13537202" author="kkambatl" created="Thu, 20 Dec 2012 17:58:54 +0000"  >&lt;p&gt;Thanks Suren for the updated patch. It looks mostly good, but for some nits.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;It is nicer to import only used methods in Assert and not Assert.*&lt;/li&gt;
	&lt;li&gt;Tests should have timeouts&lt;/li&gt;
	&lt;li&gt;The failure reasons for equals and hashcode should be different - should a test fail, the message should be clear enough.&lt;/li&gt;
	&lt;li&gt;assertFalse(condition) can be used in places with assertTrue(!condition)&lt;/li&gt;
	&lt;li&gt;Though basic null checks might not be required; if we are checking for mapA not null, we should check for mapB also to be not null&lt;/li&gt;
&lt;/ol&gt;

</comment>
                            <comment id="13537281" author="snihalani" created="Thu, 20 Dec 2012 19:19:51 +0000"  >&lt;p&gt;Can you clarify on fifth point? I seem to have checked for (not null) on both maps. This patch should address the rest of the points.&lt;/p&gt;</comment>
                            <comment id="13537310" author="hadoopqa" created="Thu, 20 Dec 2012 19:48:29 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12561963/HADOOP-9124.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12561963/HADOOP-9124.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 1 new or modified test files.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-common-project/hadoop-common.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/1915//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/1915//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/1915//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/1915//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13537415" author="kkambatl" created="Thu, 20 Dec 2012 21:56:01 +0000"  >&lt;p&gt;Thanks Suren - the fifth point seems to have already been addressed.&lt;/p&gt;

&lt;p&gt;Few more nits (hopefully the last &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; ):&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;We can be a little conservative on the test timeouts - they shouldn&apos;t timeout just because we run them on a slow/loaded machine. Do you think 200 ms is conservative enough? If not, we can may be bump it up to 1s.&lt;/li&gt;
	&lt;li&gt;The indentation seems to be off on a few lines.&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="13537578" author="snihalani" created="Fri, 21 Dec 2012 00:58:04 +0000"  >&lt;p&gt;So, the sole purpose of timeout is to have a timeout/sanity? there is not much logic behind the timeout value, right? &lt;br/&gt;
It&apos;s just enough that method completes?&lt;/p&gt;</comment>
                            <comment id="13537595" author="kkambatl" created="Fri, 21 Dec 2012 01:20:49 +0000"  >&lt;p&gt;Yes. The timeout should be high enough that we don&apos;t hit on expected runs of the test even on slow systems, and low enough to bail out early if there is something terribly wrong going on with the test.&lt;/p&gt;</comment>
                            <comment id="13537606" author="hadoopqa" created="Fri, 21 Dec 2012 01:37:32 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12562018/HADOOP-9124.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12562018/HADOOP-9124.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/1916//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/1916//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13538421" author="hadoopqa" created="Fri, 21 Dec 2012 21:17:43 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12562134/HADOOP-9124.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12562134/HADOOP-9124.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 1 new or modified test files.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-common-project/hadoop-common.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/1921//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/1921//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/1921//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/1921//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13538430" author="kkambatl" created="Fri, 21 Dec 2012 21:29:22 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13539320" author="kkambatl" created="Mon, 24 Dec 2012 20:18:27 +0000"  >&lt;p&gt;Hi Suren,&lt;/p&gt;

&lt;p&gt;In &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9154&quot; title=&quot;SortedMapWritable#putAll() doesn&amp;#39;t add key/value classes to the map&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9154&quot;&gt;&lt;del&gt;HADOOP-9154&lt;/del&gt;&lt;/a&gt;, I propose moving implementation of &lt;tt&gt;Map&lt;/tt&gt; methods from &lt;tt&gt;(Sorted)MapWritable&lt;/tt&gt; to &lt;tt&gt;AbstractMapWritable&lt;/tt&gt;. The preliminary patch addresses this issue as well. Do you want to work together on that patch to add the required tests and get it in.&lt;/p&gt;

&lt;p&gt;I am also very much open to getting this in first, and finishing the other JIRA.&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Karthik&lt;/p&gt;</comment>
                            <comment id="13539389" author="snihalani" created="Tue, 25 Dec 2012 09:23:06 +0000"  >&lt;p&gt;Hey Karthik,&lt;/p&gt;

&lt;p&gt;I would love to work together. I am continuing the discussion on &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9154&quot; title=&quot;SortedMapWritable#putAll() doesn&amp;#39;t add key/value classes to the map&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9154&quot;&gt;&lt;del&gt;HADOOP-9154&lt;/del&gt;&lt;/a&gt;. There is no point on getting this in first if &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9154&quot; title=&quot;SortedMapWritable#putAll() doesn&amp;#39;t add key/value classes to the map&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9154&quot;&gt;&lt;del&gt;HADOOP-9154&lt;/del&gt;&lt;/a&gt; already addresses it. &lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Suren.&lt;/p&gt;</comment>
                            <comment id="13560635" author="tomwhite" created="Wed, 23 Jan 2013 12:20:04 +0000"  >&lt;p&gt;The implementation of equals will work, but it doesn&apos;t optimize for the case when an object is being compared to itself by checking with ==. &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-7153&quot; title=&quot;MapWritable violates contract of Map interface for equals() and hashCode()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-7153&quot;&gt;&lt;del&gt;HADOOP-7153&lt;/del&gt;&lt;/a&gt; solved the same problem for MapWritable so it probably makes sense to use the same fix. &lt;/p&gt;

&lt;p&gt;The following assertion in the test is not guaranteed by the contract for hashCode. It might happen to pass, but we should not have it as a part of the test.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+    failureReason = &quot;Two SortedMapWritables with different data have same hashCode&quot;;
+    assertFalse(failureReason, mapA.hashCode() == mapB.hashCode());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13562258" author="kkambatl" created="Fri, 25 Jan 2013 01:36:30 +0000"  >&lt;p&gt;On second thought, I think &lt;tt&gt;#equals()&lt;/tt&gt; should verify if &lt;tt&gt;classToIdMap.keySet()&lt;/tt&gt; and &lt;tt&gt;idToClassMap.values()&lt;/tt&gt; should match for the two objects being compared. No?&lt;/p&gt;</comment>
                            <comment id="13562652" author="snihalani" created="Fri, 25 Jan 2013 13:20:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tomwhite&quot; class=&quot;user-hover&quot; rel=&quot;tomwhite&quot;&gt;tomwhite&lt;/a&gt;, I agree about that test. That case is neither likely to happen nor useful. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kkambatl&quot; class=&quot;user-hover&quot; rel=&quot;kkambatl&quot;&gt;kkambatl&lt;/a&gt;, I am not sure of the purpose of &lt;tt&gt;classToIdMap&lt;/tt&gt; and &lt;tt&gt;idToClassMap&lt;/tt&gt; . Can you elaborate?&lt;/p&gt;

&lt;p&gt;I&apos;ll update and upload the patch once Karthik&apos;s point is clear.&lt;/p&gt;</comment>
                            <comment id="13562874" author="kkambatl" created="Fri, 25 Jan 2013 17:54:12 +0000"  >&lt;p&gt;As I understand, both &lt;tt&gt;SortedMapWritable&lt;/tt&gt; and &lt;tt&gt;MapWritable&lt;/tt&gt; keep track of the classes being used as keys and values to facilitate writing/reading to/from streams (disk).&lt;/p&gt;

&lt;p&gt;If we are comparing mapA and mapB, I am not certain if the bytes written to disk through &lt;tt&gt;#write()&lt;/tt&gt; need to be identical. If they are supposed to be, then we need to compare &lt;tt&gt;classToIdMap&lt;/tt&gt; and &lt;tt&gt;idToClassMap&lt;/tt&gt;. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tomwhite&quot; class=&quot;user-hover&quot; rel=&quot;tomwhite&quot;&gt;tomwhite&lt;/a&gt;, what do you think?&lt;/p&gt;</comment>
                            <comment id="13562961" author="snihalani" created="Fri, 25 Jan 2013 19:50:54 +0000"  >&lt;p&gt;I was looking at the &lt;tt&gt;equals(Object o)&lt;/tt&gt; implementation of &lt;tt&gt;AbstractMap&lt;/tt&gt; here. It iterates through and checks if each Key and Value mapping is in the map to checked.&lt;br/&gt;
Now, each Key and Value would rely on instanceof to check if the class is there. So, I believe we should be good.&lt;/p&gt;

&lt;p&gt;I was looking at &lt;tt&gt;AbstractMapWritable&lt;/tt&gt;, the class id is just an auto incremented byte. So, different &lt;tt&gt;*MapWritables&lt;/tt&gt; have added &lt;tt&gt;Writables&lt;/tt&gt; in different order won&apos;t lead to same class-id mappings. Also, After a mapping is removed, there is no reference counting to remove the class-id mapping that is no longer needed. Hence, we should not check &lt;tt&gt;classToIdMap&lt;/tt&gt; &amp;amp; &lt;tt&gt;idToClassMap&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Let me know if I missed any edge case or anything.&lt;/p&gt;</comment>
                            <comment id="13563721" author="snihalani" created="Sun, 27 Jan 2013 03:16:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kkambatl&quot; class=&quot;user-hover&quot; rel=&quot;kkambatl&quot;&gt;kkambatl&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tomwhite&quot; class=&quot;user-hover&quot; rel=&quot;tomwhite&quot;&gt;tomwhite&lt;/a&gt;, What do you think?&lt;/p&gt;</comment>
                            <comment id="13564177" author="tomwhite" created="Mon, 28 Jan 2013 10:23:56 +0000"  >&lt;blockquote&gt;
&lt;p&gt;So, different *MapWritables have added Writables in different order won&apos;t lead to same class-id mappings. Also, After a mapping is removed, there is no reference counting to remove the class-id mapping that is no longer needed. Hence, we should not check classToIdMap &amp;amp; idToClassMap&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I agree. According to &lt;a href=&quot;http://docs.oracle.com/javase/6/docs/api/java/util/Map.html#equals(java.lang.Object)&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.oracle.com/javase/6/docs/api/java/util/Map.html#equals(java.lang.Object)&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;two maps &lt;tt&gt;m1&lt;/tt&gt; and &lt;tt&gt;m2&lt;/tt&gt; represent the same mappings if &lt;tt&gt;m1.entrySet().equals(m2.entrySet())&lt;/tt&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;So only the values of the entry set should be used for the basis for testing equality. &lt;/p&gt;</comment>
                            <comment id="13564432" author="snihalani" created="Mon, 28 Jan 2013 17:40:26 +0000"  >&lt;p&gt;Patch ready for review.&lt;/p&gt;</comment>
                            <comment id="13564473" author="hadoopqa" created="Mon, 28 Jan 2013 18:15:28 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12566787/HADOOP-9124.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12566787/HADOOP-9124.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 1 new or modified test files.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-common-project/hadoop-common.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/2103//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/2103//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/2103//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/2103//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13564484" author="kkambatl" created="Mon, 28 Jan 2013 18:21:30 +0000"  >&lt;p&gt;Thanks for the clarification, Tom. Suren - the patch looks good to me. Thanks.&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13564726" author="kkambatl" created="Mon, 28 Jan 2013 21:55:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=snihalani&quot; class=&quot;user-hover&quot; rel=&quot;snihalani&quot;&gt;snihalani&lt;/a&gt;, looks like this applies to branch-1 as well. &lt;/p&gt;</comment>
                            <comment id="13564799" author="snihalani" created="Mon, 28 Jan 2013 22:51:26 +0000"  >&lt;p&gt;I didn&apos;t know about branches in any of the HowToContribute wiki pages. Where can I read up on them?&lt;/p&gt;</comment>
                            <comment id="13565369" author="tomwhite" created="Tue, 29 Jan 2013 13:51:50 +0000"  >&lt;p&gt;What about my comment above about mirroring the change from &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-7153&quot; title=&quot;MapWritable violates contract of Map interface for equals() and hashCode()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-7153&quot;&gt;&lt;del&gt;HADOOP-7153&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="13565397" author="snihalani" created="Tue, 29 Jan 2013 14:19:38 +0000"  >&lt;p&gt;Sorry about that &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tomwhite&quot; class=&quot;user-hover&quot; rel=&quot;tomwhite&quot;&gt;tomwhite&lt;/a&gt;. Updated.&lt;/p&gt;</comment>
                            <comment id="13565398" author="hadoopqa" created="Tue, 29 Jan 2013 14:22:00 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12566969/HADOOP-9124.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12566969/HADOOP-9124.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/2112//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/2112//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13565421" author="hadoopqa" created="Tue, 29 Jan 2013 14:57:45 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12566975/HADOOP-9124.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12566975/HADOOP-9124.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 1 new or modified test files.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-common-project/hadoop-common.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/2113//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/2113//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/2113//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/2113//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13567709" author="tomwhite" created="Thu, 31 Jan 2013 15:16:07 +0000"  >&lt;p&gt;Thanks Suren. I&apos;ve attached a patch with a modification to SortedMapWritable&apos;s equals method so that it is similar to the one in MapWritable. Does this look OK to you?&lt;/p&gt;</comment>
                            <comment id="13567739" author="hadoopqa" created="Thu, 31 Jan 2013 15:56:29 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12567368/HADOOP-9124.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12567368/HADOOP-9124.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 1 new or modified test files.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-common-project/hadoop-common.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/2125//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/2125//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/2125//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/2125//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13567803" author="snihalani" created="Thu, 31 Jan 2013 16:58:48 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13568782" author="tomwhite" created="Fri, 1 Feb 2013 15:06:37 +0000"  >&lt;p&gt;I just committed this. Thanks Suren for the contribution, and Karthik for the reviews.&lt;/p&gt;</comment>
                            <comment id="13568795" author="hudson" created="Fri, 1 Feb 2013 15:14:44 +0000"  >&lt;p&gt;Integrated in Hadoop-trunk-Commit #3310 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-trunk-Commit/3310/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-trunk-Commit/3310/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9124&quot; title=&quot;SortedMapWritable violates contract of Map interface for equals() and hashCode()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9124&quot;&gt;&lt;del&gt;HADOOP-9124&lt;/del&gt;&lt;/a&gt;. SortedMapWritable violates contract of Map interface for equals() and hashCode(). Contributed by Surenkumar Nihalani (Revision 1441475)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tomwhite : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1441475&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1441475&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/SortedMapWritable.java&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/io/TestSortedMapWritable.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13568880" author="kkambatl" created="Fri, 1 Feb 2013 17:13:48 +0000"  >&lt;p&gt;Thanks Tom for committing this.&lt;/p&gt;

&lt;p&gt;Suren - sorry for the delay. branch-1 is the dev branch for 1.x.y releases. Similarly, branch-2 is for 2.x.y. The directory structure for trunk, branch-2 and branch-0.23 is the same, but branch-1 is different. Hence, the need for a separate branch-1 patch.&lt;/p&gt;

&lt;p&gt;I have copied the changes from here verbatim to branch-1, verified the test passes. Suren - are you OK with this?&lt;/p&gt;

&lt;p&gt;Tom - can you commit this to branch-1?&lt;/p&gt;</comment>
                            <comment id="13568908" author="kkambatl" created="Fri, 1 Feb 2013 17:51:54 +0000"  >&lt;p&gt;Reopening for branch-1&lt;/p&gt;</comment>
                            <comment id="13568916" author="snihalani" created="Fri, 1 Feb 2013 18:04:42 +0000"  >&lt;p&gt;There is a very small issue: &lt;br/&gt;
My latest attachment had this: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+    &lt;span class=&quot;code-comment&quot;&gt;// entrySets are now same
&lt;/span&gt;+    failureReason = &lt;span class=&quot;code-quote&quot;&gt;&quot;Two SortedMapWritables with same entry sets formed in different order have different hashcode&quot;&lt;/span&gt;;
+    assertEquals(failureReason, mapA.hashCode(), mapB.hashCode());
+    failureReason = &lt;span class=&quot;code-quote&quot;&gt;&quot;Two SortedMapWritables with same entry sets formed in different order are no longer equal&quot;&lt;/span&gt;;
+    assertEquals(failureReason, mapA, mapB);
+    assertEquals(failureReason, mapB, mapA);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;while Karthik and Tom, your latest attachments have this,&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-comment&quot;&gt;// entrySets are now same
&lt;/span&gt;+    failureReason = &lt;span class=&quot;code-quote&quot;&gt;&quot;Two SortedMapWritables with same entry sets formed in different order are now different&quot;&lt;/span&gt;;
+    assertEquals(failureReason, mapA.hashCode(), mapB.hashCode());
+    assertTrue(failureReason, mapA.equals(mapB));
+    assertTrue(failureReason, mapB.equals(mapA));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I don&apos;t know how branches end up merging, but, since &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kkambatl&quot; class=&quot;user-hover&quot; rel=&quot;kkambatl&quot;&gt;kkambatl&lt;/a&gt; mentioned it during code review, so, I thought it was worth to point out.&lt;/p&gt;</comment>
                            <comment id="13568941" author="tgraves" created="Fri, 1 Feb 2013 18:29:49 +0000"  >&lt;p&gt;I merged this into branch-0.23&lt;/p&gt;</comment>
                            <comment id="13569015" author="kkambatl" created="Fri, 1 Feb 2013 19:48:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=snihalani&quot; class=&quot;user-hover&quot; rel=&quot;snihalani&quot;&gt;snihalani&lt;/a&gt;, now that the patch is committed to trunk and branch-0.23, I think it would be best not to change it.&lt;/p&gt;</comment>
                            <comment id="13569501" author="hudson" created="Sat, 2 Feb 2013 10:46:59 +0000"  >&lt;p&gt;Integrated in Hadoop-Yarn-trunk #115 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Yarn-trunk/115/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Yarn-trunk/115/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9124&quot; title=&quot;SortedMapWritable violates contract of Map interface for equals() and hashCode()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9124&quot;&gt;&lt;del&gt;HADOOP-9124&lt;/del&gt;&lt;/a&gt;. SortedMapWritable violates contract of Map interface for equals() and hashCode(). Contributed by Surenkumar Nihalani (Revision 1441475)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tomwhite : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1441475&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1441475&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/SortedMapWritable.java&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/io/TestSortedMapWritable.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13569520" author="hudson" created="Sat, 2 Feb 2013 12:40:30 +0000"  >&lt;p&gt;Integrated in Hadoop-Hdfs-0.23-Build #513 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-0.23-Build/513/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-0.23-Build/513/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9124&quot; title=&quot;SortedMapWritable violates contract of Map interface for equals() and hashCode()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9124&quot;&gt;&lt;del&gt;HADOOP-9124&lt;/del&gt;&lt;/a&gt;. SortedMapWritable violates contract of Map interface for equals() and hashCode(). (Surenkumar Nihalani via tgraves) (Revision 1441575)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tgraves : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1441575&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1441575&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/SortedMapWritable.java&lt;/li&gt;
	&lt;li&gt;/hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/io/TestSortedMapWritable.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13569536" author="hudson" created="Sat, 2 Feb 2013 13:02:52 +0000"  >&lt;p&gt;Integrated in Hadoop-Hdfs-trunk #1304 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1304/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1304/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9124&quot; title=&quot;SortedMapWritable violates contract of Map interface for equals() and hashCode()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9124&quot;&gt;&lt;del&gt;HADOOP-9124&lt;/del&gt;&lt;/a&gt;. SortedMapWritable violates contract of Map interface for equals() and hashCode(). Contributed by Surenkumar Nihalani (Revision 1441475)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tomwhite : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1441475&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1441475&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/SortedMapWritable.java&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/io/TestSortedMapWritable.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13569553" author="hudson" created="Sat, 2 Feb 2013 14:04:12 +0000"  >&lt;p&gt;Integrated in Hadoop-Mapreduce-trunk #1332 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1332/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1332/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9124&quot; title=&quot;SortedMapWritable violates contract of Map interface for equals() and hashCode()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9124&quot;&gt;&lt;del&gt;HADOOP-9124&lt;/del&gt;&lt;/a&gt;. SortedMapWritable violates contract of Map interface for equals() and hashCode(). Contributed by Surenkumar Nihalani (Revision 1441475)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tomwhite : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1441475&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1441475&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/SortedMapWritable.java&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/io/TestSortedMapWritable.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13573383" author="tomwhite" created="Thu, 7 Feb 2013 10:43:43 +0000"  >&lt;p&gt;Committed to branch 1.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12624410">HADOOP-9154</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12615558">MRUNIT-158</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12499474">HADOOP-7153</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12567368" name="HADOOP-9124.patch" size="4618" author="tomwhite" created="Thu, 31 Jan 2013 15:16:07 +0000"/>
                            <attachment id="12566975" name="HADOOP-9124.patch" size="4676" author="snihalani" created="Tue, 29 Jan 2013 14:24:13 +0000"/>
                            <attachment id="12566969" name="HADOOP-9124.patch" size="4436" author="snihalani" created="Tue, 29 Jan 2013 14:19:38 +0000"/>
                            <attachment id="12566787" name="HADOOP-9124.patch" size="4642" author="snihalani" created="Mon, 28 Jan 2013 17:40:26 +0000"/>
                            <attachment id="12562134" name="HADOOP-9124.patch" size="4799" author="snihalani" created="Fri, 21 Dec 2012 20:42:09 +0000"/>
                            <attachment id="12562018" name="HADOOP-9124.patch" size="4559" author="snihalani" created="Fri, 21 Dec 2012 00:55:47 +0000"/>
                            <attachment id="12561963" name="HADOOP-9124.patch" size="4793" author="snihalani" created="Thu, 20 Dec 2012 19:19:51 +0000"/>
                            <attachment id="12561462" name="HADOOP-9124.patch" size="4019" author="snihalani" created="Tue, 18 Dec 2012 10:28:42 +0000"/>
                            <attachment id="12561459" name="HADOOP-9124.patch" size="3803" author="snihalani" created="Tue, 18 Dec 2012 10:20:33 +0000"/>
                            <attachment id="12561403" name="HADOOP-9124.patch" size="638" author="snihalani" created="Tue, 18 Dec 2012 02:23:17 +0000"/>
                            <attachment id="12567603" name="hadoop-9124-branch1.patch" size="4248" author="kkambatl" created="Fri, 1 Feb 2013 17:13:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>296587</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 41 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14adz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>233146</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12321659">1.2.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>