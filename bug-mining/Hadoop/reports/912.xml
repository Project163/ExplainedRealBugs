<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:43:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-9681] FileUtil.unTarUsingJava() should close the InputStream upon finishing</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-9681</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;In &lt;tt&gt;FileUtil.unTarUsingJava()&lt;/tt&gt; method, we did not close input steams explicitly upon finish. This could lead to a file handle leak on Windows.&lt;/p&gt;

&lt;p&gt;I discovered this when investigating the unit test case failure of &lt;tt&gt;TestFSDownload.testDownloadArchive()&lt;/tt&gt;. FSDownload class will use &lt;tt&gt;FileUtil.unTarUsingJava()&lt;/tt&gt; to unpack some temporary archive file. Later, the temporary file should be deleted. Because of the file handle leak, the &lt;tt&gt;File.delete()&lt;/tt&gt; method fails. The test case then fails because it assert the temporary file should not exist.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12655639">HADOOP-9681</key>
            <summary>FileUtil.unTarUsingJava() should close the InputStream upon finishing</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chuanliu">Chuan Liu</assignee>
                                    <reporter username="chuanliu">Chuan Liu</reporter>
                        <labels>
                    </labels>
                <created>Mon, 1 Jul 2013 18:52:30 +0000</created>
                <updated>Thu, 12 May 2016 18:25:31 +0000</updated>
                            <resolved>Tue, 2 Jul 2013 19:41:30 +0000</resolved>
                                    <version>1-win</version>
                    <version>2.1.0-beta</version>
                    <version>3.0.0-alpha1</version>
                                    <fixVersion>1-win</fixVersion>
                    <fixVersion>2.1.0-beta</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13697074" author="chuanliu" created="Mon, 1 Jul 2013 19:03:04 +0000"  >&lt;p&gt;Attaching a patch that closes the input streams in the &lt;tt&gt;unTarUsingJava&lt;/tt&gt; method.&lt;/p&gt;</comment>
                            <comment id="13697101" author="cnauroth" created="Mon, 1 Jul 2013 19:46:56 +0000"  >&lt;p&gt;Good catch.  Thanks, Chuan!&lt;/p&gt;

&lt;p&gt;Can you please close these streams in a finally block to guarantee that they get closed even if there are exceptions?  Also, using &lt;tt&gt;IOUtils#cleanup&lt;/tt&gt; would shorten the code a bit.&lt;/p&gt;

&lt;p&gt;This method also exists in branch-1-win with the same bug.  Can you post a branch-1-win patch too?&lt;/p&gt;</comment>
                            <comment id="13697143" author="chuanliu" created="Mon, 1 Jul 2013 20:32:35 +0000"  >&lt;p&gt;Thanks for the suggestion, Chris! A new patch using &lt;tt&gt;IOUtils#cleanup&lt;/tt&gt; is attached. I will prepare a branch-1-win patch shortly.&lt;/p&gt;</comment>
                            <comment id="13697174" author="chuanliu" created="Mon, 1 Jul 2013 21:03:18 +0000"  >&lt;p&gt;Attach a branch-1-win patch.&lt;/p&gt;</comment>
                            <comment id="13698108" author="cnauroth" created="Tue, 2 Jul 2013 19:11:23 +0000"  >&lt;p&gt;+1 for the patch.  Thanks for incorporating the feedback.  I verified that the tests pass on both Mac and Windows for both branches.  I&apos;ll commit this.&lt;/p&gt;</comment>
                            <comment id="13698126" author="hudson" created="Tue, 2 Jul 2013 19:35:34 +0000"  >&lt;p&gt;Integrated in Hadoop-trunk-Commit #4032 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-trunk-Commit/4032/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-trunk-Commit/4032/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9681&quot; title=&quot;FileUtil.unTarUsingJava() should close the InputStream upon finishing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9681&quot;&gt;&lt;del&gt;HADOOP-9681&lt;/del&gt;&lt;/a&gt;. FileUtil.unTarUsingJava() should close the InputStream upon finishing. Contributed by Chuan Liu. (Revision 1499069)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
cnauroth : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1499069&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1499069&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileUtil.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13698133" author="cnauroth" created="Tue, 2 Jul 2013 19:41:30 +0000"  >&lt;p&gt;I commmitted this to trunk, branch-2, branch-2.1-beta, and branch-1-win.  Thank you for contributing the fix, Chuan.&lt;/p&gt;</comment>
                            <comment id="13698822" author="hudson" created="Wed, 3 Jul 2013 10:55:17 +0000"  >&lt;p&gt;Integrated in Hadoop-Yarn-trunk #259 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Yarn-trunk/259/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Yarn-trunk/259/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9681&quot; title=&quot;FileUtil.unTarUsingJava() should close the InputStream upon finishing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9681&quot;&gt;&lt;del&gt;HADOOP-9681&lt;/del&gt;&lt;/a&gt;. FileUtil.unTarUsingJava() should close the InputStream upon finishing. Contributed by Chuan Liu. (Revision 1499069)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
cnauroth : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1499069&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1499069&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileUtil.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13698924" author="hudson" created="Wed, 3 Jul 2013 13:03:25 +0000"  >&lt;p&gt;Integrated in Hadoop-Hdfs-trunk #1449 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1449/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1449/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9681&quot; title=&quot;FileUtil.unTarUsingJava() should close the InputStream upon finishing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9681&quot;&gt;&lt;del&gt;HADOOP-9681&lt;/del&gt;&lt;/a&gt;. FileUtil.unTarUsingJava() should close the InputStream upon finishing. Contributed by Chuan Liu. (Revision 1499069)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
cnauroth : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1499069&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1499069&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileUtil.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13698996" author="hudson" created="Wed, 3 Jul 2013 14:09:15 +0000"  >&lt;p&gt;Integrated in Hadoop-Mapreduce-trunk #1476 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1476/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1476/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9681&quot; title=&quot;FileUtil.unTarUsingJava() should close the InputStream upon finishing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9681&quot;&gt;&lt;del&gt;HADOOP-9681&lt;/del&gt;&lt;/a&gt;. FileUtil.unTarUsingJava() should close the InputStream upon finishing. Contributed by Chuan Liu. (Revision 1499069)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
cnauroth : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1499069&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1499069&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileUtil.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12597618">HADOOP-8562</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12643846">YARN-597</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12590302" name="HADOOP-9681-branch-1-win.patch" size="1468" author="chuanliu" created="Mon, 1 Jul 2013 21:03:18 +0000"/>
                            <attachment id="12590299" name="HADOOP-9681-trunk.2.patch" size="1591" author="chuanliu" created="Mon, 1 Jul 2013 20:32:35 +0000"/>
                            <attachment id="12590286" name="HADOOP-9681-trunk.patch" size="673" author="chuanliu" created="Mon, 1 Jul 2013 19:03:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>335914</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 20 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1lxy7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>336238</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12320361">1-win</customfieldvalue>
    <customfieldvalue id="12324030">2.1.0-beta</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>