<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:43:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-9757] Har metadata cache can grow without limit</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-9757</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-2459&quot; title=&quot;Cache HAR filesystem metadata&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-2459&quot;&gt;&lt;del&gt;MAPREDUCE-2459&lt;/del&gt;&lt;/a&gt; added a metadata cache to the har filesystem, but the cache has no upper limits.  A long-running process that accesses many har archives will eventually run out of memory due to a har metadata cache that never retires entries.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12659107">HADOOP-9757</key>
            <summary>Har metadata cache can grow without limit</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cabad">Cristina L. Abad</assignee>
                                    <reporter username="jlowe">Jason Darrell Lowe</reporter>
                        <labels>
                    </labels>
                <created>Mon, 22 Jul 2013 14:54:41 +0000</created>
                <updated>Thu, 12 May 2016 18:22:11 +0000</updated>
                            <resolved>Fri, 9 Aug 2013 19:53:15 +0000</resolved>
                                    <version>2.0.4-alpha</version>
                    <version>0.23.9</version>
                    <version>3.0.0-alpha1</version>
                                    <fixVersion>0.23.10</fixVersion>
                    <fixVersion>2.1.1-beta</fixVersion>
                                    <component>fs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="13720000" author="cabad" created="Thu, 25 Jul 2013 20:19:17 +0000"  >&lt;p&gt;Here is a patch (including a unit test) for branch 23. If OK&apos;d, then I can port it to branch 2.&lt;/p&gt;</comment>
                            <comment id="13725348" author="daryn" created="Wed, 31 Jul 2013 15:32:52 +0000"  >&lt;p&gt;I suppose this approach improves the issue.  It still leaks, but just leaks less.  I think this can be greatly simplified to just removing the class static cache.&lt;/p&gt;

&lt;p&gt;The har AFS delegates to the standard har FS which uses a cached fs.  Which means the class static cache is technically unnecessary.&lt;/p&gt;</comment>
                            <comment id="13725368" author="cabad" created="Wed, 31 Jul 2013 15:55:56 +0000"  >&lt;p&gt;Daryn, thanks for the feedback. Can you please clarify your comment?&lt;/p&gt;

&lt;p&gt;(1) I am not completely sure what you mean by it &quot;still leaks&quot;. The new cache has a fixed size, set by default to a small value, and it will never grow beyond that. Do you mean that some HAR entries that may not be needed anymore will stay in the cache? This would happen only if the HAR FS is rarely used. In that case, yes, those references will stay indefinitely. I don&apos;t think this should be problematic in practice, but I can gladly add functionality to deal with this. Do you have a suggestion on how to get around this?&lt;/p&gt;

&lt;p&gt;(2) &quot;The har AFS delegates to the standard har FS which uses a cached fs. Which means the class static cache is technically unnecessary.&quot; Is there another HAR FS cache that I am not aware of? If so, please point me to the right place to find it. The class static cache modified in this patch is the HAR metadata chache that was added in &lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-2459&quot; title=&quot;Cache HAR filesystem metadata&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-2459&quot;&gt;&lt;del&gt;MAPREDUCE-2459&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13725577" author="knoguchi" created="Wed, 31 Jul 2013 18:41:47 +0000"  >&lt;p&gt;Hi Daryn,&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The har AFS delegates to the standard har FS which uses a cached fs.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m not fully sure if I understand your point but please note that HarFileSystem does not use FileSystem.CACHE. We have fs.har.impl.disable.cache=true inside core-default.xml. &lt;br/&gt;
(&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-6097&quot; title=&quot;Multiple bugs w/ Hadoop archives&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-6097&quot;&gt;&lt;del&gt;HADOOP-6097&lt;/del&gt;&lt;/a&gt; and  &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-6231&quot; title=&quot;Allow caching of filesystem instances to be disabled on a per-instance basis&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-6231&quot;&gt;&lt;del&gt;HADOOP-6231&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="13729727" author="daryn" created="Mon, 5 Aug 2013 17:59:57 +0000"  >&lt;p&gt;+1 I&apos;m not thrilled with the way har works, but I suppose this is the best we can for now to fix the leak.&lt;/p&gt;</comment>
                            <comment id="13729896" author="cabad" created="Mon, 5 Aug 2013 20:29:37 +0000"  >&lt;p&gt;Attaching patches for trunk and branch 2 (they are identical; the patch for branch 23 is slightly different but just due to changes in line # where hunks are applied). Also made sure that patch for branch 23 still applies without errors.&lt;/p&gt;</comment>
                            <comment id="13729996" author="hadoopqa" created="Mon, 5 Aug 2013 21:42:04 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12596209/HADOOP_9757.trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12596209/HADOOP_9757.trunk.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 1 new or modified test files.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-common-project/hadoop-common.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/2924//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/2924//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/2924//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/2924//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13735202" author="daryn" created="Fri, 9 Aug 2013 19:53:15 +0000"  >&lt;p&gt;Thanks Cristina!  I&apos;ve committed to trunk/2/2.1/0.23&lt;/p&gt;</comment>
                            <comment id="13735208" author="hudson" created="Fri, 9 Aug 2013 20:01:41 +0000"  >&lt;p&gt;SUCCESS: Integrated in Hadoop-trunk-Commit #4238 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-trunk-Commit/4238/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-trunk-Commit/4238/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9757&quot; title=&quot;Har metadata cache can grow without limit&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9757&quot;&gt;&lt;del&gt;HADOOP-9757&lt;/del&gt;&lt;/a&gt;. Har metadata cache can grow without limit (Cristina Abad via daryn) (daryn: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1512465&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1512465&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HarFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/TestHarFileSystemBasics.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13735847" author="hudson" created="Sat, 10 Aug 2013 10:56:22 +0000"  >&lt;p&gt;SUCCESS: Integrated in Hadoop-Yarn-trunk #297 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Yarn-trunk/297/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Yarn-trunk/297/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9757&quot; title=&quot;Har metadata cache can grow without limit&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9757&quot;&gt;&lt;del&gt;HADOOP-9757&lt;/del&gt;&lt;/a&gt;. Har metadata cache can grow without limit (Cristina Abad via daryn) (daryn: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1512465&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1512465&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HarFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/TestHarFileSystemBasics.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13735868" author="hudson" created="Sat, 10 Aug 2013 11:33:37 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Hdfs-trunk #1487 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1487/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1487/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9757&quot; title=&quot;Har metadata cache can grow without limit&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9757&quot;&gt;&lt;del&gt;HADOOP-9757&lt;/del&gt;&lt;/a&gt;. Har metadata cache can grow without limit (Cristina Abad via daryn) (daryn: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1512465&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1512465&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HarFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/TestHarFileSystemBasics.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13735870" author="hudson" created="Sat, 10 Aug 2013 11:33:44 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Hdfs-0.23-Build #695 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-0.23-Build/695/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-0.23-Build/695/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9757&quot; title=&quot;Har metadata cache can grow without limit&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9757&quot;&gt;&lt;del&gt;HADOOP-9757&lt;/del&gt;&lt;/a&gt;. Har metadata cache can grow without limit (Cristina Abad via daryn) (daryn: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1512470&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1512470&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HarFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/TestHarFileSystemBasics.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13735903" author="hudson" created="Sat, 10 Aug 2013 13:04:17 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Mapreduce-trunk #1514 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1514/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1514/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9757&quot; title=&quot;Har metadata cache can grow without limit&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9757&quot;&gt;&lt;del&gt;HADOOP-9757&lt;/del&gt;&lt;/a&gt;. Har metadata cache can grow without limit (Cristina Abad via daryn) (daryn: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1512465&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1512465&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HarFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/TestHarFileSystemBasics.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12505740">MAPREDUCE-2459</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12596208" name="HADOOP_9757.branch-2.patch" size="6441" author="cabad" created="Mon, 5 Aug 2013 20:29:37 +0000"/>
                            <attachment id="12594259" name="HADOOP_9757.branch23.patch" size="6407" author="cabad" created="Thu, 25 Jul 2013 20:19:17 +0000"/>
                            <attachment id="12596209" name="HADOOP_9757.trunk.patch" size="6441" author="cabad" created="Mon, 5 Aug 2013 20:29:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>339300</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 15 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1misv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>339620</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>