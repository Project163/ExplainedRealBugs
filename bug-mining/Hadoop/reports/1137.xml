<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:44:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-10527] Fix incorrect return code and allow more retries on EINTR</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-10527</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;After &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-10522&quot; title=&quot;JniBasedUnixGroupMapping mishandles errors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-10522&quot;&gt;&lt;del&gt;HADOOP-10522&lt;/del&gt;&lt;/a&gt;, user/group look-up will only try up to 5 times on EINTR.  More retries should be allowed just in case.&lt;/p&gt;

&lt;p&gt;Also, when a user/group lookup returns no entries, the wrapper methods are returning EIO, instead of ENOENT.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12709632">HADOOP-10527</key>
            <summary>Fix incorrect return code and allow more retries on EINTR</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kihwal">Kihwal Lee</assignee>
                                    <reporter username="kihwal">Kihwal Lee</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 Apr 2014 21:55:18 +0000</created>
                <updated>Thu, 4 Sep 2014 01:13:42 +0000</updated>
                            <resolved>Wed, 23 Apr 2014 13:30:38 +0000</resolved>
                                                    <fixVersion>2.4.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13976130" author="cmccabe" created="Mon, 21 Apr 2014 22:33:05 +0000"  >&lt;p&gt;Kihwal wrote:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I don&apos;t think it is correct to throw a RuntimeException when a user is not found (ENOENT).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We can&apos;t throw an IOException because the JNI function does not declare &quot;&lt;tt&gt;throws IOException&lt;/tt&gt;&quot;  Throwing an exception not in the throw spec causes undefined behavior.  If you want to change the throw spec, that would also work.&lt;/p&gt;

&lt;p&gt;You can see in JniBasedUnixGroupsMapping.java that the JNI function is declared like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] getGroupsForUser(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; username);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(There is no &quot;&lt;tt&gt;throws IOException&lt;/tt&gt;&quot;)&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The patch does not use errno. It explicitly use the return value. The code before my patch used errno.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;OK, I missed the part where you removed this line:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;-    } &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; ((!pwd) &amp;amp;&amp;amp; (errno == EINTR));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;That was indeed a good line to remove.&lt;/p&gt;

&lt;p&gt;However, your patch adds these lines:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+    &lt;span class=&quot;code-comment&quot;&gt;// The following call returns errno. Reading the global errno wihtout
&lt;/span&gt;+    &lt;span class=&quot;code-comment&quot;&gt;// locking is not thread-safe.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is doubly wrong because&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;getpwnam_r&lt;/tt&gt; doesn&apos;t set errno &amp;#8211; it returns the error code as a result&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;errno&lt;/tt&gt; is not global and is always thread-safe&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So we need to remove this comment.&lt;/p&gt;

&lt;p&gt;I think we need to get rid of &lt;tt&gt;MAX_USER_LOOKUP_TRIES&lt;/tt&gt; and replace it with a maximum buffer size that we don&apos;t go over when we get &lt;tt&gt;ERANGE&lt;/tt&gt;.  The problem with the current scheme is that it doesn&apos;t actually put a limit on buffer size since we don&apos;t consider this in our decision to multiply the buffer size by 2x or not.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+      &lt;span class=&quot;code-object&quot;&gt;char&lt;/span&gt; buf[128];
+      snprintf(buf, sizeof(buf), &lt;span class=&quot;code-quote&quot;&gt;&quot;getgrouplist: error looking up user. %d (%s)&quot;&lt;/span&gt;,
+               ret, terror(ret));
+      THROW(env, &lt;span class=&quot;code-quote&quot;&gt;&quot;java/lang/RuntimeException&quot;&lt;/span&gt;, buf);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Should use either &lt;tt&gt;newRuntimeException&lt;/tt&gt; or &lt;tt&gt;newIOException&lt;/tt&gt; here.&lt;/p&gt;</comment>
                            <comment id="13976146" author="kihwal" created="Mon, 21 Apr 2014 22:56:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;We can&apos;t throw an IOException because ...&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I am not suggesting that. If a lookup successfully returns no result, it is supposed to return an empty collection without throwing any exception.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;So we need to remove this comment.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Agreed. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I think we need to get rid of MAX_USER_LOOKUP_TRIES and replace it with a maximum buffer size....&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;What do you think is the reasonable buffer size?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Should use either newRuntimeException or newIOException here.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think I misread your earlier comment in &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-10522&quot; title=&quot;JniBasedUnixGroupMapping mishandles errors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-10522&quot;&gt;&lt;del&gt;HADOOP-10522&lt;/del&gt;&lt;/a&gt;. I understand now. &lt;/p&gt;</comment>
                            <comment id="13976153" author="hadoopqa" created="Mon, 21 Apr 2014 23:04:00 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12641130/hadoop-10527.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12641130/hadoop-10527.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  There were no new javadoc warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-common-project/hadoop-common.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/3823//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/3823//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/3823//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/3823//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13976199" author="kihwal" created="Mon, 21 Apr 2014 23:39:37 +0000"  >&lt;p&gt;The new patch sets the buffer size limit to 64K.&lt;/p&gt;</comment>
                            <comment id="13976223" author="hadoopqa" created="Tue, 22 Apr 2014 00:18:22 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12641147/hadoop-10527.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12641147/hadoop-10527.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;&lt;/font&gt;-1 javac&lt;font color=&quot;red&quot;&gt;&lt;/font&gt;.  The patch appears to cause the build to fail.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/3824//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/3824//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13976908" author="kihwal" created="Tue, 22 Apr 2014 15:23:59 +0000"  >&lt;p&gt;Sorry, a wrong version of patch was attached.  Here is the right one.&lt;/p&gt;</comment>
                            <comment id="13976986" author="hadoopqa" created="Tue, 22 Apr 2014 16:19:34 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12641258/hadoop-10527.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12641258/hadoop-10527.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  There were no new javadoc warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-common-project/hadoop-common.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/3831//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/3831//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/3831//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/3831//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13977128" author="cmccabe" created="Tue, 22 Apr 2014 18:02:20 +0000"  >&lt;p&gt;Looks better.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+  &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (ret = 0, buf_sz = uinfo-&amp;gt;buf_sz;  buf_sz &amp;lt; MAX_USER_BUFFER_SIZE;) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This means that once &lt;tt&gt;uinfo-&amp;gt;buf_sz&lt;/tt&gt; reaches &lt;tt&gt;MAX_USER_BUFFER_SIZE&lt;/tt&gt;, we&apos;ll never run the loop again.  This doesn&apos;t seem like what you intended.  How about a do... while loop?&lt;/p&gt;

&lt;p&gt;Also, please remove the comments about errno not being thread-safe.&lt;/p&gt;</comment>
                            <comment id="13977538" author="kihwal" created="Tue, 22 Apr 2014 22:07:43 +0000"  >&lt;p&gt;&amp;gt;  This doesn&apos;t seem like what you intended.&lt;br/&gt;
Rearranged the code. Since the terminal condition of the loop has changed (no more fixed limit on # of iterations), I moved realloc() back to after the sys/lib calls.  Compared to pre-&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-10522&quot; title=&quot;JniBasedUnixGroupMapping mishandles errors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-10522&quot;&gt;&lt;del&gt;HADOOP-10522&lt;/del&gt;&lt;/a&gt;, it uses single loop instead of nested loop and return code/error handling was modified.&lt;/p&gt;

&lt;p&gt;&amp;gt; Also, please remove the comments about errno not being thread-safe.&lt;br/&gt;
They were removed in the previous patch. For a second, I though I screwed up and posted an old patch again!&lt;/p&gt;

&lt;p&gt;Here is something new about this patch.  &lt;/p&gt;

&lt;p&gt;I thought about what the reasonable initial buffer size and the limit would be.  For user lookups, the buffer can be relatively small and &lt;tt&gt;_SC_GETPW_R_SIZE_MAX&lt;/tt&gt; won&apos;t be too big. So the max buffer size here will mostly be for avoiding infinite lookup loop caused by a bug in library.  I think 32KB is far more than enough for containing a single user&apos;s passwd entry. So I set the buffer size limit to 32KB.  I did not change the initial buffer size as &lt;tt&gt;_SC_GETPW_R_SIZE_MAX&lt;/tt&gt; won&apos;t be excessively big and using it as the initial buffer size will avoid realloc() in most cases, if not all.&lt;/p&gt;

&lt;p&gt;Group lookups are different.The number of members in the group can vary a lot. &lt;tt&gt;_SC_GETGR_R_SIZE_MAX&lt;/tt&gt; is usually very big and allocating this much upfront may not be ideal.  So I set the initial buffer to be 8KB and allowed it to grow up to 2MB. Assuming average user name length of 15 bytes, 8KB will be large enough to store a group with about 500 members. 2MB will be large enough for a group with about 130K members.&lt;/p&gt;

&lt;p&gt;What do you think about the new initial buffer size and the limit?&lt;/p&gt;</comment>
                            <comment id="13977617" author="cmccabe" created="Tue, 22 Apr 2014 23:30:14 +0000"  >&lt;blockquote&gt;&lt;p&gt;Rearranged the code. Since the terminal condition of the loop has changed (no more fixed limit on # of iterations), I moved realloc() back to after the sys/lib calls. Compared to pre-&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-10522&quot; title=&quot;JniBasedUnixGroupMapping mishandles errors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-10522&quot;&gt;&lt;del&gt;HADOOP-10522&lt;/del&gt;&lt;/a&gt;, it uses single loop instead of nested loop and return code/error handling was modified.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This looks good.  Thanks.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;[the comments about errno] were removed in the previous patch. For a second, I though I screwed up and posted an old patch again!&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Oh, you&apos;re right.  Sorry, I feel dumb now.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Group lookups are different.The number of members in the group can vary a lot. _SC_GETGR_R_SIZE_MAX is usually very big and allocating this much upfront may not be ideal. So I set the initial buffer to be 8KB and allowed it to grow up to 2MB.... What do you think about the new initial buffer size and the limit?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I was curious about this myself, so I ran the following program:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;unistd.h&amp;gt;

&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; main(void) {
  fprintf(stderr, &lt;span class=&quot;code-quote&quot;&gt;&quot;%lld\n&quot;&lt;/span&gt;, (&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;)sysconf(_SC_GETGR_R_SIZE_MAX));
  &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; 0;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For me, it returned 1024.  So I don&apos;t think &lt;tt&gt;_SC_GETGR_R_SIZE_MAX&lt;/tt&gt; is usually very big.  Apparently the value of &lt;tt&gt;_SC_GETGR_R_SIZE_MAX&lt;/tt&gt; is merely &quot;an initial suggested size&quot; and not the actual maximum (as you might think by reading its name).  At least according to this:&lt;br/&gt;
&lt;a href=&quot;http://tomlee.co/2012/10/problems-with-large-linux-unix-groups-and-getgrgid_r-getgrnam_r/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://tomlee.co/2012/10/problems-with-large-linux-unix-groups-and-getgrgid_r-getgrnam_r/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Anyway, I think your new starting size is good, because it will prevent re-allocation in most cases.  So I am +1 on the patch as-is.  Thanks for looking into this, Kihwal.&lt;/p&gt;</comment>
                            <comment id="13977657" author="hadoopqa" created="Wed, 23 Apr 2014 00:26:07 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12641356/hadoop-10527.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12641356/hadoop-10527.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  There were no new javadoc warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-common-project/hadoop-common.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/3834//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/3834//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/3834//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/3834//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13978181" author="kihwal" created="Wed, 23 Apr 2014 13:24:37 +0000"  >&lt;p&gt;The information I looked at was based on POSIX.1-2001. In POSIX.1-2008, it was revised like this:&lt;/p&gt;
&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt; A call to sysconf(_SC_GETGR_R_SIZE_MAX) returns either -1 without &lt;br/&gt;
 changing errno or an initial value suggested for the size of this buffer.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Thanks for the reviews, Colin.&lt;/p&gt;</comment>
                            <comment id="13978184" author="kihwal" created="Wed, 23 Apr 2014 13:30:38 +0000"  >&lt;p&gt;I&apos;ve committed this to trunk, branch-2 and branch-2.4.&lt;/p&gt;</comment>
                            <comment id="13978194" author="hudson" created="Wed, 23 Apr 2014 13:39:08 +0000"  >&lt;p&gt;SUCCESS: Integrated in Hadoop-trunk-Commit #5553 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-trunk-Commit/5553/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-trunk-Commit/5553/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-10527&quot; title=&quot;Fix incorrect return code and allow more retries on EINTR&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-10527&quot;&gt;&lt;del&gt;HADOOP-10527&lt;/del&gt;&lt;/a&gt;. Fix incorrect return code and allow more retries on EINTR. Contributed by Kihwal Lee. (kihwal: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1589405&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1589405&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/security/JniBasedUnixGroupsMapping.c&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/security/hadoop_group_info.c&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/security/hadoop_user_info.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13979594" author="hudson" created="Thu, 24 Apr 2014 11:29:42 +0000"  >&lt;p&gt;ABORTED: Integrated in Hadoop-Yarn-trunk #550 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Yarn-trunk/550/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Yarn-trunk/550/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-10527&quot; title=&quot;Fix incorrect return code and allow more retries on EINTR&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-10527&quot;&gt;&lt;del&gt;HADOOP-10527&lt;/del&gt;&lt;/a&gt;. Fix incorrect return code and allow more retries on EINTR. Contributed by Kihwal Lee. (kihwal: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1589405&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1589405&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/security/JniBasedUnixGroupsMapping.c&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/security/hadoop_group_info.c&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/security/hadoop_user_info.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13979712" author="hudson" created="Thu, 24 Apr 2014 13:31:59 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Mapreduce-trunk #1767 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1767/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1767/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-10527&quot; title=&quot;Fix incorrect return code and allow more retries on EINTR&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-10527&quot;&gt;&lt;del&gt;HADOOP-10527&lt;/del&gt;&lt;/a&gt;. Fix incorrect return code and allow more retries on EINTR. Contributed by Kihwal Lee. (kihwal: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1589405&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1589405&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/security/JniBasedUnixGroupsMapping.c&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/security/hadoop_group_info.c&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/security/hadoop_user_info.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13981021" author="hudson" created="Fri, 25 Apr 2014 13:40:16 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Hdfs-trunk #1742 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1742/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1742/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-10527&quot; title=&quot;Fix incorrect return code and allow more retries on EINTR&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-10527&quot;&gt;&lt;del&gt;HADOOP-10527&lt;/del&gt;&lt;/a&gt;. Fix incorrect return code and allow more retries on EINTR. Contributed by Kihwal Lee. (kihwal: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1589405&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1589405&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/security/JniBasedUnixGroupsMapping.c&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/security/hadoop_group_info.c&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/security/hadoop_user_info.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12709359">HADOOP-10522</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12641356" name="hadoop-10527.patch" size="7867" author="kihwal" created="Tue, 22 Apr 2014 22:08:00 +0000"/>
                            <attachment id="12641258" name="hadoop-10527.patch" size="5239" author="kihwal" created="Tue, 22 Apr 2014 15:23:59 +0000"/>
                            <attachment id="12641147" name="hadoop-10527.patch" size="5256" author="kihwal" created="Mon, 21 Apr 2014 23:39:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>387954</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 30 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1utwv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>388213</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12326695">2.4.1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>