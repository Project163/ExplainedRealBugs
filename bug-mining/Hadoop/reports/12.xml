<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:31:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-6132] RPC client opens an extra connection for VersionedProtocol</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-6132</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;RPC client caches connections per protocol. However, since all of our real protocols are subclasses of VersionedProtocol, a bug in the implementation makes the client opens an extra connection just for the VersionedProtocol, which is not needed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12429849">HADOOP-6132</key>
            <summary>RPC client opens an extra connection for VersionedProtocol</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kzhang">Kan Zhang</assignee>
                                    <reporter username="kzhang">Kan Zhang</reporter>
                        <labels>
                    </labels>
                <created>Wed, 8 Jul 2009 20:31:03 +0000</created>
                <updated>Tue, 24 Aug 2010 20:38:56 +0000</updated>
                            <resolved>Thu, 23 Jul 2009 22:29:34 +0000</resolved>
                                                    <fixVersion>0.21.0</fixVersion>
                                    <component>ipc</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="12728886" author="kzhang" created="Wed, 8 Jul 2009 20:33:40 +0000"  >&lt;p&gt;attaching a patch. Manually verified that the client only opens one connection per protocol.&lt;/p&gt;</comment>
                            <comment id="12728893" author="kzhang" created="Wed, 8 Jul 2009 20:41:33 +0000"  >&lt;p&gt;added a link to &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-4853&quot; title=&quot;Improvement to IPC&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-4853&quot;&gt;&lt;del&gt;HADOOP-4853&lt;/del&gt;&lt;/a&gt;. The current patch only fixes the bug identified in this JIRA (in a compatible way). It doesn&apos;t address the issue raised in &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-4853&quot; title=&quot;Improvement to IPC&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-4853&quot;&gt;&lt;del&gt;HADOOP-4853&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12728895" author="owen.omalley" created="Wed, 8 Jul 2009 20:46:09 +0000"  >&lt;p&gt;Shouldn&apos;t the protocol be defined as:&lt;/p&gt;

&lt;p&gt;Class&amp;lt;? extends VersionedProtocol&amp;gt; protocol;&lt;/p&gt;
</comment>
                            <comment id="12728922" author="kzhang" created="Wed, 8 Jul 2009 21:54:52 +0000"  >&lt;p&gt;Absolutely. An updated patch attached.&lt;/p&gt;</comment>
                            <comment id="12729558" author="hadoopqa" created="Fri, 10 Jul 2009 07:34:43 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12412921/2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12412921/2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 792812.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/561/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/561/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/561/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/561/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/561/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/561/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/561/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/561/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12732218" author="kzhang" created="Thu, 16 Jul 2009 22:47:20 +0000"  >&lt;p&gt;The manual verification I used was running a test that involves the RPC layer (e.g., a test that uses the MiniDFSCluster), with log level of ipc.Server set to debug. Without this patch, one would observe the following line in the log, which means the client is establishing a connection for the VersionedProtocol. It happens whenever a client sets up the first connection for a protocol (e.g., ClientProtocol or DatanodeProtocol). When the bug is fixed, no connection for the VersionedProtocol should ever be set up. Hence, no such log messages should have been observed in the log.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2009-07-16 15:41:37,763 DEBUG ipc.Server (Server.java:readAndProcess(861)) - Successfully authorized org.apache.hadoop.ipc.VersionedProtocol-......
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12732327" author="rangadi" created="Fri, 17 Jul 2009 03:50:03 +0000"  >&lt;p&gt;+1 for the fix.&lt;/p&gt;

&lt;p&gt;There is another instance of use of getDelaringClass() in the same file (though that part of the code is not used except in some tests). &lt;br/&gt;
We need to fix that.&lt;/p&gt;</comment>
                            <comment id="12732743" author="kzhang" created="Fri, 17 Jul 2009 21:25:21 +0000"  >&lt;p&gt;&amp;gt; There is another instance of use of getDelaringClass() in the same file&lt;/p&gt;

&lt;p&gt;Yes, it is used in a public static convenience method whereby users can make a call by passing only the method. Unless we want to change the &lt;br/&gt;
interface contract and require the user to pass the protocol as well, we have to use getDeclaringClass() to figure out the protocol. I&apos;m not sure &lt;br/&gt;
what the original purpose of this interface was. But I feel it serves some purpose (as long as users are aware of the twist of using &lt;br/&gt;
getDeclaringClass()) and since it is only used in tests, I don&apos;t feel making the changes in this patch. What do you think?&lt;/p&gt;</comment>
                            <comment id="12733381" author="rangadi" created="Mon, 20 Jul 2009 22:33:26 +0000"  >&lt;p&gt;sure. That is fine. If someone actually ends up using the interface, they will be similarly surprised. But for now I guess it is fine. If we want to fix it, we need to make the interface take class object as one of the arguments (since that is part of definition of what a connection is).&lt;/p&gt;

&lt;p&gt;+1.&lt;/p&gt;</comment>
                            <comment id="12734820" author="rangadi" created="Thu, 23 Jul 2009 22:29:34 +0000"  >&lt;p&gt;I just committed this. Thanks Kan.&lt;/p&gt;</comment>
                            <comment id="12794484" author="jnp" created="Thu, 24 Dec 2009 19:21:32 +0000"  >&lt;p&gt;Patch for hadoop 20 added.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12410547">HADOOP-4853</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12412907" name="1.patch" size="1807" author="kzhang" created="Wed, 8 Jul 2009 20:35:15 +0000"/>
                            <attachment id="12412921" name="2.patch" size="3974" author="kzhang" created="Wed, 8 Jul 2009 21:54:52 +0000"/>
                            <attachment id="12428925" name="HADOOP-6132-0_20.1.patch" size="4086" author="jnp" created="Thu, 24 Dec 2009 19:21:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37211</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 48 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02ruf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>14112</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>RPC</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>