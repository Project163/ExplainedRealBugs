<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:32:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-6452] Hadoop JSP pages don&apos;t work under a security manager</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-6452</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;When you run Hadoop under a security manager that says &quot;yes&quot; to all security checks, you get stack traces when Jetty tries to initialise the JSP engine. Which implies you can&apos;t use Jasper under a security manager&lt;/p&gt;</description>
                <environment></environment>
        <key id="12423705">HADOOP-6452</key>
            <summary>Hadoop JSP pages don&apos;t work under a security manager</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stevel@apache.org">Steve Loughran</assignee>
                                    <reporter username="stevel@apache.org">Steve Loughran</reporter>
                        <labels>
                    </labels>
                <created>Fri, 24 Apr 2009 15:11:13 +0000</created>
                <updated>Tue, 24 Aug 2010 20:41:21 +0000</updated>
                            <resolved>Wed, 23 Dec 2009 12:12:36 +0000</resolved>
                                    <version>0.21.0</version>
                                    <fixVersion>0.21.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12702405" author="steve_l" created="Fri, 24 Apr 2009 15:11:57 +0000"  >&lt;p&gt;Stack trace&lt;br/&gt;
&lt;tt&gt;code&lt;/tt&gt;&lt;br/&gt;
09/04/24 15:47:49 &lt;span class=&quot;error&quot;&gt;&amp;#91;JobTracker&amp;#93;&lt;/span&gt; INFO http.HttpServer : Jetty bound to port 50030&lt;br/&gt;
09/04/24 15:47:49 &lt;span class=&quot;error&quot;&gt;&amp;#91;JobTracker&amp;#93;&lt;/span&gt; INFO mortbay.log : jetty-6.1.14&lt;br/&gt;
09/04/24 15:47:49 &lt;span class=&quot;error&quot;&gt;&amp;#91;JobTracker&amp;#93;&lt;/span&gt; INFO mortbay.log : Extract jar:&lt;a href=&quot;file:/home/slo/.ivy/cache/org.apache.hadoop/hadoop-core/jars/hadoop-core-0.21.0-alpha-9.jar!/webapps/job&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/home/slo/.ivy/cache/org.apache.hadoop/hadoop-core/jars/hadoop-core-0.21.0-alpha-9.jar!/webapps/job&lt;/a&gt; to work/Jetty_0_0_0_0_50030_job____yn7qmk/webapp&lt;br/&gt;
09/04/24 15:47:49 &lt;span class=&quot;error&quot;&gt;&amp;#91;JobTracker&amp;#93;&lt;/span&gt; ERROR / : Security Init for context failed&lt;br/&gt;
java.lang.SecurityException: attempt to add a Permission to a readonly Permissions object&lt;br/&gt;
	at java.security.Permissions.add(Permissions.java:110)&lt;br/&gt;
	at java.security.Policy$UnsupportedEmptyCollection.add(Policy.java:790)&lt;br/&gt;
	at org.apache.jasper.compiler.JspRuntimeContext.initSecurity(JspRuntimeContext.java:564)&lt;br/&gt;
	at org.apache.jasper.compiler.JspRuntimeContext.&amp;lt;init&amp;gt;(JspRuntimeContext.java:198)&lt;br/&gt;
	at org.apache.jasper.servlet.JspServlet.init(JspServlet.java:150)&lt;br/&gt;
	at org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:431)&lt;br/&gt;
	at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:263)&lt;br/&gt;
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)&lt;br/&gt;
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:643)&lt;br/&gt;
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)&lt;br/&gt;
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1234)&lt;br/&gt;
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517)&lt;br/&gt;
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:460)&lt;br/&gt;
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)&lt;br/&gt;
	at org.mortbay.jetty.handler.HandlerCollection.doStart(HandlerCollection.java:152)&lt;br/&gt;
	at org.mortbay.jetty.handler.ContextHandlerCollection.doStart(ContextHandlerCollection.java:156)&lt;br/&gt;
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)&lt;br/&gt;
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)&lt;br/&gt;
	at org.mortbay.jetty.Server.doStart(Server.java:222)&lt;br/&gt;
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)&lt;br/&gt;
	at org.apache.hadoop.http.HttpServer.start(HttpServer.java:454)&lt;br/&gt;
	at org.apache.hadoop.mapred.JobTracker.innerStart(JobTracker.java:1482)&lt;br/&gt;
	at org.apache.hadoop.util.Service.start(Service.java:186)&lt;br/&gt;
&lt;tt&gt;code&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="12702407" author="steve_l" created="Fri, 24 Apr 2009 15:13:14 +0000"  >&lt;p&gt;1. This could be the same Jasper one we are seeing in hadoop&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/bugzilla/show_bug.cgi?id=41509&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://issues.apache.org/bugzilla/show_bug.cgi?id=41509&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;2. Discussion from Sun about how java6 changed part of the classloaders to return an immutable collection&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/incubator-river-user/200810.mbox/%3C20081015181649.GB4649@east%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mail-archives.apache.org/mod_mbox/incubator-river-user/200810.mbox/%3C20081015181649.GB4649@east%3E&lt;/a&gt; &lt;/p&gt;

&lt;p&gt;Assuming these are released, Sun broke things in Java 6. &lt;/p&gt;</comment>
                            <comment id="12702408" author="steve_l" created="Fri, 24 Apr 2009 15:13:36 +0000"  >&lt;p&gt;s/released/r/related&lt;/p&gt;</comment>
                            <comment id="12702462" author="steve_l" created="Fri, 24 Apr 2009 17:34:53 +0000"  >&lt;p&gt;Probable cause for this is that ConfiguredPolicy doesnt override &lt;tt&gt;PermissionCollection getPermissions(CodeSource codesource)&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;In Java5 Policy.getPermissions(CodeSource codesource) returned a mutable PermissionCollection, but in Java6 that method returns an immutable one.&lt;/p&gt;

&lt;p&gt;This will be easy to test without running under a security manager, so easy to test that an overridden version of the method does the right thing&lt;/p&gt;</comment>
                            <comment id="12702510" author="arren" created="Fri, 24 Apr 2009 19:53:56 +0000"  >&lt;p&gt;IIRC from my (once reasonable) knowledge of the Java security API, no assumptions are made by the Java security implementation about &lt;em&gt;any&lt;/em&gt; returned value from any implementation of Policy, and (importantly for my previous work) the Policy is even free to return different values on each call. In contrast with (almost all) formal analyses of the model, the methods aren&apos;t even guaranteed to be called, depending on the dynamic context of the security check. &lt;/p&gt;

&lt;p&gt;Although I agree with the linked mail that Sun definitely changed the world, I suspect making assumptions about the behaviour of methods on Policy is dangerous. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12703159" author="steve_l" created="Mon, 27 Apr 2009 15:06:39 +0000"  >&lt;p&gt;Both jetty and RMI make assumptions that aren&apos;t valid, and as as they are code that isnt in the hadoop repository, it is up to the hadoop code to be changed to come to terms with their (mistaken) assumptions. &lt;/p&gt;

&lt;p&gt;I&apos;m also adding  my own code that tests the current policy and tries to add to it, printing out some diagnostics (including the classname) if it isn&apos;t writable. This is handy as the current policy may change over time. &lt;/p&gt;

&lt;p&gt;Is it ok to return a new empty permission collection on the getPermissions(CodeSource) call? It won&apos;t impact hadoop&apos;s own code.&lt;/p&gt;</comment>
                            <comment id="12703688" author="steve_l" created="Tue, 28 Apr 2009 15:48:57 +0000"  >&lt;p&gt;Already committed to the 3628 branch, this makes the codebase permission writable, and so passes a simple unit tests. Not yet tested under a proper security manager&lt;/p&gt;</comment>
                            <comment id="12703691" author="arren" created="Tue, 28 Apr 2009 15:56:56 +0000"  >&lt;blockquote&gt;&lt;p&gt;Is it ok to return a new empty permission collection on the getPermissions(CodeSource) call? It won&apos;t impact hadoop&apos;s own code.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In general, this will cause a SecurityManager to fail any permissions check involving code in a ProtectionDomain which was instantiated over that CodeSource. A CodeSource is (approximately) a URI, and a ProtectionDomain is effectively a Set of classes loaded from that URI with a common set of permissions.&lt;/p&gt;

&lt;p&gt;Forgive my lack of deep understanding of this specific instance of the application of the security manager, but in general, if ANY frame on the stack (AccessControlContext being a list of ProtectionDomains) has a PermssionCollection which does not contain the required permission, then the security check will fail. You might better relay or delegate the call and make a writable copy of the returned value from the underlying policy, otherwise you will break a great number of things very badly for anybody who does require a SecurityManager.&lt;/p&gt;

&lt;p&gt;With a little more understanding of the instance, I could be much more helpful. I am sorry that time forbids random speculative interest, but if you are stuck, I will gladly look further into it.&lt;/p&gt;</comment>
                            <comment id="12703697" author="steve_l" created="Tue, 28 Apr 2009 16:12:28 +0000"  >&lt;p&gt;Hadoop doesn&apos;t work at all with a proper security manager, noted in &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-5731&quot; title=&quot;IPC call can raise security exceptions when the remote node is running under a security manager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-5731&quot;&gt;&lt;del&gt;HADOOP-5731&lt;/del&gt;&lt;/a&gt;, caused by the service level auth of &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-4348&quot; title=&quot;Adding service-level authorization to Hadoop&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-4348&quot;&gt;&lt;del&gt;HADOOP-4348&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;Even if you switch to a minimal security manager that blocks System.exit() calls (see &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-8&quot; title=&quot;Interrupting the namenode thread triggers System.exit()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-8&quot;&gt;&lt;del&gt;HADOOP-4532&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-351&quot; title=&quot;Could FSEditLog report problems more elegantly than with System.exit(-1)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-351&quot;&gt;&lt;del&gt;HADOOP-5453&lt;/del&gt;&lt;/a&gt;) but doesnt delegate authorisation to the normal sun policy-driven code doesn&apos;t work, because libraries in Hadoop (here, jetty) and elsewhere RMI both check for a security manager being present, and if so, get the codebase&apos;s policy and add rights to it. That is, they assume that they can do this, and that it is needed. &lt;/p&gt;

&lt;p&gt;This patch lets both libraries get away with setting permissions, without paying any attention to the values. It is not a step towards hosting Hadoop under a fully functional security manager, but should be enough to run Hadoop under a simple manager that blocks exit calls unless asked very nicely. &lt;/p&gt;

&lt;p&gt;Now, ultimately, I would like to work with a Security Manager, but fixing that is going to require way more effort. &lt;/p&gt;</comment>
                            <comment id="12703701" author="steve_l" created="Tue, 28 Apr 2009 16:21:30 +0000"  >&lt;p&gt;This makes the permissions collection writable, so does not trigger failures in jetty or RMI code when trying to run with a security manager and a ConfiguredPolicy as the current (static, system-wide) policy. &lt;/p&gt;</comment>
                            <comment id="12704425" author="hadoopqa" created="Thu, 30 Apr 2009 00:46:16 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12406650/hadoop-5740.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12406650/hadoop-5740.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 769923.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 Eclipse classpath. The patch retains Eclipse classpath integrity.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    -1 contrib tests.  The patch failed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/261/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/261/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/261/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/261/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/261/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/261/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/261/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/261/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12704541" author="steve_l" created="Thu, 30 Apr 2009 09:18:34 +0000"  >&lt;p&gt;The test that failed is &lt;br/&gt;
org.apache.hadoop.mapred.TestQueueCapacities.testSingleQueue&lt;br/&gt;
Error Message&lt;/p&gt;

&lt;p&gt;Timeout occurred. Please note the time in the report does not reflect the time until the timeout.&lt;/p&gt;


&lt;p&gt;-I don&apos;t see how that could be related to the overriding of a new (and previously unused) method in the Policy subclass&lt;/p&gt;</comment>
                            <comment id="12747870" author="chris.douglas" created="Wed, 26 Aug 2009 09:49:55 +0000"  >&lt;p&gt;The patch needs to be regenerated&lt;/p&gt;</comment>
                            <comment id="12748003" author="steve_l" created="Wed, 26 Aug 2009 16:08:08 +0000"  >&lt;p&gt;yes, I will do this. The code is checked in to my branch of hadoop-common; nothing complex&lt;/p&gt;</comment>
                            <comment id="12791317" author="steve_l" created="Wed, 16 Dec 2009 11:04:59 +0000"  >&lt;p&gt;Updated patch. Although this bug is filed under MAPREDUCE, and surfaces there and in hdfs, the patch is actually for hadoop-common source&lt;/p&gt;</comment>
                            <comment id="12791427" author="hadoopqa" created="Wed, 16 Dec 2009 16:09:00 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12428156/mapreduce-439-2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12428156/mapreduce-439-2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 891111.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Mapreduce-Patch-h3.grid.sp2.yahoo.net/202/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Mapreduce-Patch-h3.grid.sp2.yahoo.net/202/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12791783" author="hadoopqa" created="Thu, 17 Dec 2009 04:45:10 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12428156/mapreduce-439-2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12428156/mapreduce-439-2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 891511.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/215/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/215/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/215/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/215/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/215/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/215/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/215/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/215/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12792742" author="tomwhite" created="Sat, 19 Dec 2009 01:13:50 +0000"  >&lt;p&gt;This looks reasonable to me. Is it possible to write a test for it? If not, can you describe the manual test you ran please?&lt;/p&gt;</comment>
                            <comment id="12792844" author="steve_l" created="Sat, 19 Dec 2009 14:04:18 +0000"  >&lt;p&gt;Trying to run under a security manager is a bit convoluted; you&apos;d need to bring up a process under one. You can&apos;t assume your unit test suite is allowed to play with security managers as IDEs and even &amp;lt;junit&amp;gt; may use them to stop calls to System.exit() working. &lt;/p&gt;

&lt;p&gt;What I could test for is what triggered the problem in the stack trace, the attempt to add permissions to the permissions object retrieved with getPermissions(). That object has to support addPermissions(), which the default clearly does not. This test should fit into a normal unit test method&lt;/p&gt;</comment>
                            <comment id="12793214" author="steve_l" created="Mon, 21 Dec 2009 14:32:18 +0000"  >&lt;p&gt;I have a test for this, this is the test failure you get before the patch to ConfiguredPolicy is applied &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Testsuite: org.apache.hadoop.security.authorize.TestConfiguredPolicy
Tests run: 3, Failures: 0, Errors: 1, Time elapsed: 0.532 sec
------------- Standard Output ---------------
2009-12-21 14:30:00,089 WARN  conf.Configuration (Configuration.java:&amp;lt;clinit&amp;gt;(347)) - DEPRECATED: hadoop-site.xml found in the classpath. Usage of hadoop-site.xml is deprecated. Instead use core-site.xml, mapred-site.xml and hdfs-site.xml to override properties of core-&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;.xml, mapred-&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;.xml and hdfs-&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;.xml respectively
2009-12-21 14:30:00,265 INFO  authorize.ServiceAuthorizationManager (ServiceAuthorizationManager.java:run(92)) - Authorization failed &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; joe,users
java.security.AccessControlException: access denied ConnectionPermission(org.apache.hadoop.security.authorize.TestConfiguredPolicy$Protocol2)
	at java.security.AccessControlContext.checkPermission(AccessControlContext.java:323)
	at java.security.AccessController.checkPermission(AccessController.java:546)
	at org.apache.hadoop.security.authorize.ServiceAuthorizationManager$1.run(ServiceAuthorizationManager.java:89)
	at org.apache.hadoop.security.authorize.ServiceAuthorizationManager$1.run(ServiceAuthorizationManager.java:84)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:396)
	at org.apache.hadoop.security.authorize.ServiceAuthorizationManager.checkPermission(ServiceAuthorizationManager.java:83)
	at org.apache.hadoop.security.authorize.ServiceAuthorizationManager.authorize(ServiceAuthorizationManager.java:68)
	at org.apache.hadoop.security.authorize.TestConfiguredPolicy.testConfiguredPolicy(TestConfiguredPolicy.java:79)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at junit.framework.TestCase.runTest(TestCase.java:168)
	at junit.framework.TestCase.runBare(TestCase.java:134)
	at junit.framework.TestResult$1.protect(TestResult.java:110)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.framework.TestResult.run(TestResult.java:113)
	at junit.framework.TestCase.run(TestCase.java:124)
	at junit.framework.TestSuite.runTest(TestSuite.java:232)
	at junit.framework.TestSuite.run(TestSuite.java:227)
	at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:79)
	at junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:921)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:778)
------------- ---------------- ---------------

Testcase: testConfiguredPolicy took 0.294 sec
Testcase: testPolicyWriteable took 0.127 sec
	Caused an ERROR
attempt to add a Permission to a readonly Permissions object
java.lang.SecurityException: attempt to add a Permission to a readonly Permissions object
	at java.security.Permissions.add(Permissions.java:110)
	at java.security.Policy$UnsupportedEmptyCollection.add(Policy.java:790)
	at org.apache.hadoop.security.authorize.TestConfiguredPolicy.assertWriteable(TestConfiguredPolicy.java:115)
	at org.apache.hadoop.security.authorize.TestConfiguredPolicy.testPolicyWriteable(TestConfiguredPolicy.java:127)

Testcase: testProtectionDomainPolicyWriteable took 0.092 sec
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12793310" author="steve_l" created="Mon, 21 Dec 2009 19:34:06 +0000"  >&lt;p&gt;patch with a test&lt;/p&gt;</comment>
                            <comment id="12793325" author="hadoopqa" created="Mon, 21 Dec 2009 20:04:39 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12428645/HADOOP-6452-2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12428645/HADOOP-6452-2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 892113.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/228/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/228/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/228/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/228/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/228/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/228/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/228/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/228/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12793448" author="tomwhite" created="Tue, 22 Dec 2009 01:00:46 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;A nit: there are a couple of places where the indentation introduced by the patch isn&apos;t correct.&lt;/p&gt;</comment>
                            <comment id="12794031" author="steve_l" created="Wed, 23 Dec 2009 12:12:36 +0000"  >&lt;p&gt;Committed with the whitespace sorted out. I need to keep an eye on the IDE.&lt;/p&gt;</comment>
                            <comment id="12794039" author="hudson" created="Wed, 23 Dec 2009 12:43:58 +0000"  >&lt;p&gt;Integrated in Hadoop-Common-trunk-Commit #126 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Common-trunk-Commit/126/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Common-trunk-Commit/126/&lt;/a&gt;)&lt;br/&gt;
     Hadoop JSP pages don&apos;t work under a security manager&lt;/p&gt;</comment>
                            <comment id="12794053" author="steve_l" created="Wed, 23 Dec 2009 14:00:32 +0000"  >&lt;p&gt;This is the patch as applied, same as -2 but with the whitespace corrected.&lt;/p&gt;</comment>
                            <comment id="12794385" author="hudson" created="Thu, 24 Dec 2009 11:13:44 +0000"  >&lt;p&gt;Integrated in Hadoop-Common-trunk #197 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Common-trunk/197/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Common-trunk/197/&lt;/a&gt;)&lt;br/&gt;
     Hadoop JSP pages don&apos;t work under a security manager&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12428645" name="HADOOP-6452-2.patch" size="5425" author="steve_l" created="Mon, 21 Dec 2009 19:34:06 +0000"/>
                            <attachment id="12428821" name="HADOOP-6452-3.patch" size="5014" author="steve_l" created="Wed, 23 Dec 2009 14:00:32 +0000"/>
                            <attachment id="12406650" name="hadoop-5740.patch" size="2483" author="steve_l" created="Tue, 28 Apr 2009 15:48:57 +0000"/>
                            <attachment id="12428156" name="mapreduce-439-2.patch" size="1737" author="steve_l" created="Wed, 16 Dec 2009 11:04:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>77715</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 48 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0d2b3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>74150</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>