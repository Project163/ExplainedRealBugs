<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:56:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-17032] Handle an internal dir in viewfs having multiple children mount points pointing to different filesystems</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-17032</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;In case the viefs mount table is configured in a way where multiple child mount points are pointing to different file systems, the getContentSummary or getStatus don&apos;t return the expected result&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
mount link /a/b/ &#8594; hdfs:&lt;span class=&quot;code-comment&quot;&gt;//nn1/a/b
&lt;/span&gt; mount link /a/d/ &#8594; file:&lt;span class=&quot;code-comment&quot;&gt;///nn2/c/d&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;b has two files and d has 1 file. So getContentSummary on / should return 3 files.&lt;/p&gt;

&lt;p&gt;It also fails for the following scenario:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
mount link&#160; /internalDir -&amp;gt;&#160;/internalDir/linternalDir2
mount link&#160; /internalDir -&amp;gt;&#160;/internalDir/linkToDir2 -&amp;gt; hdfs:&lt;span class=&quot;code-comment&quot;&gt;//nn1/dir2&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Exception:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.io.IOException: Internal implementation error: expected file name to be /java.io.IOException: Internal implementation error: expected file name to be /
 at org.apache.hadoop.fs.viewfs.InternalDirOfViewFs.checkPathIsSlash(InternalDirOfViewFs.java:88) at org.apache.hadoop.fs.viewfs.InternalDirOfViewFs.getFileStatus(InternalDirOfViewFs.java:154) at org.apache.hadoop.fs.FileSystem.getContentSummary(FileSystem.java:1684) at org.apache.hadoop.fs.FileSystem.getContentSummary(FileSystem.java:1695) at org.apache.hadoop.fs.viewfs.ViewFileSystem.getContentSummary(ViewFileSystem.java:918) at org.apache.hadoop.fs.viewfs.ViewFileSystemBaseTest.testGetContentSummary(ViewFileSystemBaseTest.java:1106)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13302973">HADOOP-17032</key>
            <summary>Handle an internal dir in viewfs having multiple children mount points pointing to different filesystems</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="abhishekd">Abhishek Das</assignee>
                                    <reporter username="abhishekd">Abhishek Das</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 May 2020 21:42:01 +0000</created>
                <updated>Thu, 10 Jun 2021 07:57:04 +0000</updated>
                            <resolved>Wed, 1 Jul 2020 07:29:47 +0000</resolved>
                                                    <fixVersion>3.2.2</fixVersion>
                    <fixVersion>3.3.1</fixVersion>
                    <fixVersion>3.4.0</fixVersion>
                                    <component>fs</component>
                    <component>viewfs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="17100634" author="stevel@apache.org" created="Wed, 6 May 2020 09:49:52 +0000"  >&lt;p&gt;Are you proposing recursive listing across multiple file systems? That is potentially trouble.&lt;/p&gt;</comment>
                            <comment id="17127483" author="abhishekd" created="Sun, 7 Jun 2020 02:53:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stevel%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;stevel@apache.org&quot;&gt;stevel@apache.org&lt;/a&gt;&#160;There would be recursive call, but that won&apos;t go from one file system to another. I should also mention ViewFs in the title of the Jira to avoid confusion.&lt;/p&gt;

&lt;p&gt;In case of multiple leaf nodes pointing to different filesystems, the current&#160;implementation of ViewFileSystem resolves the path only once and calls&#160;getContentSummary for the resolved filesystem.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Override
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; ContentSummary getContentSummary(Path f) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
 InodeTree.ResolveResult&amp;lt;FileSystem&amp;gt; res =
 fsState.resolve(getUriPath(f), &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
 &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; res.targetFileSystem.getContentSummary(res.remainingPath);
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So, for a non-leaf nodes, the it cannot invoke the the method of corresponding fileSystem pointed by the leaf node.&lt;/p&gt;

&lt;p&gt;For the same reason, the current implementation fails for the following scenario scenario:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ContentSummary summary = fsView.getContentSummary(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/internalDir&quot;&lt;/span&gt;));&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;where &quot;/internalDir&quot; is a non-leaf directory and it has two children&lt;/p&gt;

&lt;p&gt;&quot;/internalDir/linternalDir2&quot; (a non-leaf node) and&#160;/internalDir/linkToDir2 (a leaf node) that points to dir2&lt;/p&gt;</comment>
                            <comment id="17127487" author="abhishekd" created="Sun, 7 Jun 2020 03:01:26 +0000"  >&lt;p&gt;Created PR for this&#160;&lt;a href=&quot;https://github.com/apache/hadoop/pull/2060&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hadoop/pull/2060&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=umamaheswararao&quot; class=&quot;user-hover&quot; rel=&quot;umamaheswararao&quot;&gt;umamaheswararao&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stevel%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;stevel@apache.org&quot;&gt;stevel@apache.org&lt;/a&gt;&#160;please take a look at the PR when you get a chance. Thanks in advance.&lt;/p&gt;</comment>
                            <comment id="17141806" author="umamaheswararao" created="Mon, 22 Jun 2020 08:13:44 +0000"  >&lt;p&gt;Sorry &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abhishekd&quot; class=&quot;user-hover&quot; rel=&quot;abhishekd&quot;&gt;abhishekd&lt;/a&gt; for late, could not get into this yet.&#160;&lt;/p&gt;

&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ayushtkn&quot; class=&quot;user-hover&quot; rel=&quot;ayushtkn&quot;&gt;ayushtkn&lt;/a&gt;, could you please take a look at this PR ( since you have already worked on this fix in other Jira) ? Thanks.&lt;/p&gt;</comment>
                            <comment id="17149187" author="ayushtkn" created="Wed, 1 Jul 2020 07:29:48 +0000"  >&lt;p&gt;Meged PR. Thanx &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abhishekd&quot; class=&quot;user-hover&quot; rel=&quot;abhishekd&quot;&gt;abhishekd&lt;/a&gt; for the contribution&lt;/p&gt;</comment>
                            <comment id="17149193" author="hudson" created="Wed, 1 Jul 2020 07:44:24 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #18398 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-trunk-Commit/18398/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-trunk-Commit/18398/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-17032&quot; title=&quot;Handle an internal dir in viewfs having multiple children mount points pointing to different filesystems&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-17032&quot;&gt;&lt;del&gt;HADOOP-17032&lt;/del&gt;&lt;/a&gt;. Fix getContentSummary in ViewFileSystem to handle multiple (github: rev 3b8d0f803f1c6277f2c17a73cf4803ab0bd9954b)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/viewfs/ViewFileSystemBaseTest.java&lt;/li&gt;
	&lt;li&gt;(edit) hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/viewfs/ViewFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13312689">HDFS-15426</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13299780">HDFS-15289</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 19 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0eesw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>