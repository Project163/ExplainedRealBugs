<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:45:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-10780] hadoop_user_info_alloc fails on FreeBSD due to incorrect sysconf use</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-10780</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;I am trying hadoop-2.4.1 on FreeBSD-10/stable.&lt;br/&gt;
namenode starts up, but after first datanode contacts it, it throws an exception.&lt;br/&gt;
All limits seem to be high enough:&lt;/p&gt;

&lt;p&gt;% limits -a&lt;br/&gt;
Resource limits (current):&lt;br/&gt;
  cputime              infinity secs&lt;br/&gt;
  filesize             infinity kB&lt;br/&gt;
  datasize             33554432 kB&lt;br/&gt;
  stacksize              524288 kB&lt;br/&gt;
  coredumpsize         infinity kB&lt;br/&gt;
  memoryuse            infinity kB&lt;br/&gt;
  memorylocked         infinity kB&lt;br/&gt;
  maxprocesses           122778&lt;br/&gt;
  openfiles              140000&lt;br/&gt;
  sbsize               infinity bytes&lt;br/&gt;
  vmemoryuse           infinity kB&lt;br/&gt;
  pseudo-terminals     infinity&lt;br/&gt;
  swapuse              infinity kB&lt;/p&gt;

&lt;p&gt;14944  1  S        0:06.59 /usr/local/openjdk7/bin/java -Dproc_namenode -Xmx1000m -Dhadoop.log.dir=/var/log/hadoop -Dhadoop.log.file=hadoop-hdfs-namenode-nezabudka3-00.log -Dhadoop.home.dir=/usr/local -Dhadoop.id.str=hdfs -Dhadoop.root.logger=INFO,RFA -Dhadoop.policy.file=hadoop-policy.xml -Djava.net.preferIPv4Stack=true -Xmx32768m -Xms32768m -Djava.library.path=/usr/local/lib -Xmx32768m -Xms32768m -Djava.library.path=/usr/local/lib -Xmx32768m -Xms32768m -Djava.library.path=/usr/local/lib -Dhadoop.security.logger=INFO,RFAS org.apache.hadoop.hdfs.server.namenode.NameNode&lt;/p&gt;


&lt;p&gt;From the namenode&apos;s log:&lt;/p&gt;

&lt;p&gt;2014-07-03 23:28:15,070 WARN  &lt;span class=&quot;error&quot;&gt;&amp;#91;IPC Server handler 5 on 8020&amp;#93;&lt;/span&gt; ipc.Server (Server.java:run(2032)) - IPC Server handler 5 on 8020, call org.apache.hadoop.hdfs.server.protocol.Datano&lt;br/&gt;
deProtocol.versionRequest from 5.255.231.209:57749 Call#842 Retry#0&lt;br/&gt;
java.lang.OutOfMemoryError&lt;br/&gt;
        at org.apache.hadoop.security.JniBasedUnixGroupsMapping.getGroupsForUser(Native Method)&lt;br/&gt;
        at org.apache.hadoop.security.JniBasedUnixGroupsMapping.getGroups(JniBasedUnixGroupsMapping.java:80)&lt;br/&gt;
        at org.apache.hadoop.security.JniBasedUnixGroupsMappingWithFallback.getGroups(JniBasedUnixGroupsMappingWithFallback.java:50)&lt;br/&gt;
        at org.apache.hadoop.security.Groups.getGroups(Groups.java:139)&lt;br/&gt;
        at org.apache.hadoop.security.UserGroupInformation.getGroupNames(UserGroupInformation.java:1417)&lt;br/&gt;
        at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.&amp;lt;init&amp;gt;(FSPermissionChecker.java:81)&lt;br/&gt;
        at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getPermissionChecker(FSNamesystem.java:3331)&lt;br/&gt;
        at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.checkSuperuserPrivilege(FSNamesystem.java:5491)&lt;br/&gt;
        at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.versionRequest(NameNodeRpcServer.java:1082)&lt;br/&gt;
        at org.apache.hadoop.hdfs.protocolPB.DatanodeProtocolServerSideTranslatorPB.versionRequest(DatanodeProtocolServerSideTranslatorPB.java:234)&lt;br/&gt;
        at org.apache.hadoop.hdfs.protocol.proto.DatanodeProtocolProtos$DatanodeProtocolService$2.callBlockingMethod(DatanodeProtocolProtos.java:28069)&lt;br/&gt;
        at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:585)&lt;br/&gt;
        at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:928)&lt;br/&gt;
        at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2013)&lt;br/&gt;
        at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2009)&lt;br/&gt;
        at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
        at javax.security.auth.Subject.doAs(Subject.java:415)&lt;br/&gt;
        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1556)&lt;br/&gt;
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2007)&lt;/p&gt;


&lt;p&gt;I did not have such an issue with hadoop-1.2.1.&lt;/p&gt;</description>
                <environment>&lt;p&gt;FreeBSD-10/stable&lt;br/&gt;
openjdk version &quot;1.7.0_60&quot;&lt;br/&gt;
OpenJDK Runtime Environment (build 1.7.0_60-b19)&lt;br/&gt;
OpenJDK 64-Bit Server VM (build 24.60-b09, mixed mode)&lt;/p&gt;</environment>
        <key id="12725363">HADOOP-10780</key>
            <summary>hadoop_user_info_alloc fails on FreeBSD due to incorrect sysconf use</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="trtrmitya">Dmitry Sivachenko</assignee>
                                    <reporter username="trtrmitya">Dmitry Sivachenko</reporter>
                        <labels>
                    </labels>
                <created>Thu, 3 Jul 2014 19:32:43 +0000</created>
                <updated>Mon, 1 Dec 2014 03:09:36 +0000</updated>
                            <resolved>Mon, 14 Jul 2014 17:59:49 +0000</resolved>
                                    <version>2.4.1</version>
                                    <fixVersion>2.6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14052197" author="trtrmitya" created="Fri, 4 Jul 2014 06:34:13 +0000"  >&lt;p&gt;This is because of incorrect type of buf_sz variable in &lt;br/&gt;
hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/security/hadoop_user_info.c,&lt;br/&gt;
function hadoop_user_info_alloc(void):&lt;/p&gt;

&lt;p&gt;Currently it&apos;s type is size_t (which is unsigned), and during assignment&lt;br/&gt;
buf_sz = sysconf(_SC_GETPW_R_SIZE_MAX);&lt;br/&gt;
syscont() can return -1 (and it does on FreeBSD).  So buf_sz gets very large positive value (equivalent of signed -1), and then malloc() fails with OutOfMemory.&lt;/p&gt;

&lt;p&gt;The correct solution will be to change type of buf_sz to long (because sysconf() returns long).&lt;/p&gt;</comment>
                            <comment id="14053934" author="cmccabe" created="Mon, 7 Jul 2014 17:57:43 +0000"  >&lt;p&gt;Thanks for that analysis, Dmitry.  I think you&apos;re right.  Can you post a patch for us to review?&lt;/p&gt;</comment>
                            <comment id="14054840" author="trtrmitya" created="Tue, 8 Jul 2014 11:18:34 +0000"  >&lt;p&gt;Here is a patch in standard format for review.&lt;/p&gt;</comment>
                            <comment id="14055488" author="cmccabe" created="Tue, 8 Jul 2014 20:38:08 +0000"  >&lt;p&gt;this one looks very straightforward.  +1.&lt;/p&gt;

&lt;p&gt;Will commit tomorrow if no further comments&lt;/p&gt;</comment>
                            <comment id="14060951" author="hudson" created="Mon, 14 Jul 2014 18:03:15 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-trunk-Commit #5876 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-trunk-Commit/5876/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-trunk-Commit/5876/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-10780&quot; title=&quot;hadoop_user_info_alloc fails on FreeBSD due to incorrect sysconf use&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-10780&quot;&gt;&lt;del&gt;HADOOP-10780&lt;/del&gt;&lt;/a&gt;. hadoop_user_info_alloc fails on FreeBSD due to incorrect sysconf use (trtrmitya via cmccabe) (cmccabe: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1610470&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1610470&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/security/hadoop_user_info.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14061925" author="hudson" created="Tue, 15 Jul 2014 10:37:30 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Yarn-trunk #613 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Yarn-trunk/613/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Yarn-trunk/613/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-10780&quot; title=&quot;hadoop_user_info_alloc fails on FreeBSD due to incorrect sysconf use&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-10780&quot;&gt;&lt;del&gt;HADOOP-10780&lt;/del&gt;&lt;/a&gt;. hadoop_user_info_alloc fails on FreeBSD due to incorrect sysconf use (trtrmitya via cmccabe) (cmccabe: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1610470&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1610470&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/security/hadoop_user_info.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14062068" author="hudson" created="Tue, 15 Jul 2014 13:50:07 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Hdfs-trunk #1805 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1805/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1805/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-10780&quot; title=&quot;hadoop_user_info_alloc fails on FreeBSD due to incorrect sysconf use&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-10780&quot;&gt;&lt;del&gt;HADOOP-10780&lt;/del&gt;&lt;/a&gt;. hadoop_user_info_alloc fails on FreeBSD due to incorrect sysconf use (trtrmitya via cmccabe) (cmccabe: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1610470&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1610470&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/security/hadoop_user_info.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14062166" author="hudson" created="Tue, 15 Jul 2014 14:57:07 +0000"  >&lt;p&gt;SUCCESS: Integrated in Hadoop-Mapreduce-trunk #1832 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1832/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1832/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-10780&quot; title=&quot;hadoop_user_info_alloc fails on FreeBSD due to incorrect sysconf use&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-10780&quot;&gt;&lt;del&gt;HADOOP-10780&lt;/del&gt;&lt;/a&gt;. hadoop_user_info_alloc fails on FreeBSD due to incorrect sysconf use (trtrmitya via cmccabe) (cmccabe: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1610470&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1610470&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/src/org/apache/hadoop/security/hadoop_user_info.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12726047">HADOOP-10796</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12654570" name="buf_sz.patch" size="390" author="trtrmitya" created="Tue, 8 Jul 2014 11:18:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>403523</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 19 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1xg7z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>403568</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12327179">2.6.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>