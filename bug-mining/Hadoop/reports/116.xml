<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:32:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-6701]  Incorrect exit codes for &quot;dfs -chown&quot;, &quot;dfs -chgrp&quot;</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-6701</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;ravi@localhost:~$ hadoop dfs -chgrp abcd /; echo $?&lt;br/&gt;
chgrp: changing ownership of&lt;br/&gt;
&apos;hdfs://localhost/&apos;:org.apache.hadoop.security.AccessControlException: Permission denied&lt;br/&gt;
0&lt;/p&gt;

&lt;p&gt;ravi@localhost:~$ hadoop dfs -chown  abcd /; echo $?&lt;br/&gt;
chown: changing ownership of&lt;br/&gt;
&apos;hdfs://localhost/&apos;:org.apache.hadoop.security.AccessControlException: Permission denied&lt;br/&gt;
0&lt;/p&gt;

&lt;p&gt;ravi@localhost:~$ hadoop dfs -chmod 755 /DOESNTEXIST; echo $?&lt;br/&gt;
chmod: could not get status for &apos;/DOESNTEXIST&apos;: File does not exist: /DOESNTEXIST&lt;br/&gt;
0&lt;/p&gt;

&lt;p&gt;-&lt;/p&gt;

&lt;p&gt;Exit codes for both of the above invocations should be non-zero to indicate that the command failed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12461890">HADOOP-6701</key>
            <summary> Incorrect exit codes for &quot;dfs -chown&quot;, &quot;dfs -chgrp&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="raviphulari">Ravi Phulari</assignee>
                                    <reporter username="raviphulari">Ravi Phulari</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Apr 2010 18:30:06 +0000</created>
                <updated>Wed, 9 Mar 2011 15:36:06 +0000</updated>
                            <resolved>Wed, 28 Apr 2010 17:32:56 +0000</resolved>
                                    <version>0.19.1</version>
                    <version>0.20.0</version>
                    <version>0.20.1</version>
                    <version>0.20.2</version>
                                    <fixVersion>0.20.3</fixVersion>
                    <fixVersion>0.21.0</fixVersion>
                                    <component>fs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12856109" author="raviphulari" created="Mon, 12 Apr 2010 18:34:53 +0000"  >&lt;p&gt;Attaching simple patch for fixing exit codes for -ch(mod/grp/own)  commands.&lt;/p&gt;</comment>
                            <comment id="12856117" author="raviphulari" created="Mon, 12 Apr 2010 18:49:41 +0000"  >&lt;p&gt;Attaching patch for trunk.&lt;/p&gt;</comment>
                            <comment id="12856188" author="cos" created="Mon, 12 Apr 2010 21:36:21 +0000"  >&lt;p&gt;Looks like the patch is incomplete because it the case with &lt;tt&gt;chmod&lt;/tt&gt;. The other two seem intact to me. &lt;/p&gt;</comment>
                            <comment id="12856614" author="raviphulari" created="Tue, 13 Apr 2010 21:02:21 +0000"  >&lt;p&gt;Attaching patch to fix exit codes for &lt;tt&gt;fs -ch(own/mod/grp)&lt;/tt&gt;.  Patch includes unit tests for theses issues.&lt;/p&gt;

&lt;p&gt;This patch does not fix bug for incorrect exit code when wild card input is given to the &lt;tt&gt;fs -ch(own/mod/grp)&lt;/tt&gt;. &lt;br/&gt;
There is bug in &lt;tt&gt;FsShell.java&lt;/tt&gt; which causes incorrect exit codes when wildcard inputs are given to -ch*  commands.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;Bar.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i=startIndex; i&amp;lt;args.length; i++) {
      Path srcPath = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(args[i]);
      FileSystem srcFs = srcPath.getFileSystem(getConf());
      Path[] paths = FileUtil.stat2Paths(srcFs.globStatus(srcPath), srcPath);
      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;(Path path : paths) {
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I will open new Jira to fix this issue.&lt;/p&gt;</comment>
                            <comment id="12858024" author="raviphulari" created="Fri, 16 Apr 2010 22:06:47 +0000"  >&lt;p&gt;Attaching patch for hadoop 20.s .&lt;/p&gt;</comment>
                            <comment id="12858028" author="raviphulari" created="Fri, 16 Apr 2010 22:07:12 +0000"  >&lt;p&gt;Patch for trunk . &lt;/p&gt;</comment>
                            <comment id="12860356" author="raviphulari" created="Fri, 23 Apr 2010 19:27:56 +0000"  >&lt;p&gt;This fix will change the way &lt;tt&gt;ch(mod/own/grp)&lt;/tt&gt; returns exit codes.  &lt;/p&gt;

&lt;p&gt;Failure to execute chmod, chown, chgrp commands will return non zero exit code with an error message. &lt;/p&gt;</comment>
                            <comment id="12860378" author="raviphulari" created="Fri, 23 Apr 2010 21:17:47 +0000"  >&lt;p&gt;Patch for 0.20.&lt;/p&gt;</comment>
                            <comment id="12860395" author="sureshms" created="Fri, 23 Apr 2010 21:58:50 +0000"  >&lt;p&gt;+1 for the patch.&lt;/p&gt;</comment>
                            <comment id="12860410" author="raviphulari" created="Fri, 23 Apr 2010 22:53:32 +0000"  >&lt;p&gt;&lt;b&gt;This patch changes exit codes returned from  chmod, chgrp and chown operations&lt;/b&gt;&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Old Behavior  of &lt;tt&gt;chmod,chown,chgrp&lt;/tt&gt; operation.
	&lt;ul&gt;
		&lt;li&gt;If operation is successful then - exit code 0 and no error message.&lt;/li&gt;
		&lt;li&gt;If operation is unsuccessful then - exit code 0 and error message printed.
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; 
*If files does not exist and with globbed input*
[rphulari@statepick-lm]&amp;gt; bin/hadoop fs -chmod 777 st*; echo $?
0

*If files does not exist without globbed input*
[rphulari@statepick-lm]&amp;gt; bin/hadoop fs -chmod 777 st; echo $?
chmod: could not get status for &apos;st&apos;: File does not exist: st
0

*If user does not have permission to change file-permission*
ravi@localhost:~$ hadoop dfs -chgrp abcd /; echo $?
chgrp: changing ownership of
&apos;hdfs://localhost/&apos;:org.apache.hadoop.security.AccessControlException: Permission denied
0

*If user does not have permission to change file-permission*
ravi@localhost:~$ hadoop dfs -chown abcd /; echo $?
chown: changing ownership of
&apos;hdfs://localhost/&apos;:org.apache.hadoop.security.AccessControlException: Permission denied
0

*If user has permission to change file-permission and file does not exist*
ravi@localhost:~$ hadoop dfs -chmod 755 /DOESNTEXIST; echo $?
chmod: could not get status for &apos;/DOESNTEXIST&apos;: File does not exist: /DOESNTEXIST
0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; &lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;New Behavior  of &lt;tt&gt;chmod,chown,chgrp&lt;/tt&gt; operation.
	&lt;ul&gt;
		&lt;li&gt;If operation is successful then - exit code 0 is returned and no error message.&lt;/li&gt;
		&lt;li&gt;If operation is unsuccessful then - exit code 1 is returned and error message printed.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; 
*If file does not exist*
[rphulari@lm]&amp;gt; bin/hadoop fs -chown rphulari:users est; echo $?
chown: could not get status for &apos;est&apos;: File does not exist: est
1

*If files does not exist and with globbed input*
[rphulari@statepick-lm]&amp;gt; bin/hadoop fs -chown rphulari:users est\*; echo $?
chown: could not get status for &apos;est*&apos;
1

*If file exist and operation is successful*
[rphulari@statepick-lm]&amp;gt; bin/hadoop fs -chmod 700 test; echo $?
0


*If file/dir with glob pattern exits and operation is successful*
[rphulari@statepick-lm]&amp;gt; bin/hadoop fs -chmod 777 test*; echo $?
0
[rphulari@statepick-lm]&amp;gt; bin/hadoop fs -ls 
Found 2 items
-rw-rw-rw-   1 admin    supergroup          0 2010-04-15 13:54 /user/rphulari/t
drwxrwxrwx   - rphulari userss              0 2010-03-30 23:39 /user/rphulari/test

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;&lt;b&gt;Unchanged behavior - need to be fixed in different Jira&lt;/b&gt;&lt;br/&gt;
Because following bug is due to Permissions code we will change it in separate Jira .&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; 
*If user does not have permission to change file-permission*
ravi@localhost:~$ hadoop dfs -chown abcd /; echo $?
chown: changing ownership of
&apos;hdfs://localhost/&apos;:org.apache.hadoop.security.AccessControlException: Permission denied
0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="12861678" author="sureshms" created="Wed, 28 Apr 2010 05:34:00 +0000"  >&lt;p&gt;Refreshing the patch for hudson to pickup.&lt;/p&gt;</comment>
                            <comment id="12861730" author="hadoopqa" created="Wed, 28 Apr 2010 08:48:25 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12443038/HADOOP-6701-trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12443038/HADOOP-6701-trunk.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 938788.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/486/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/486/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/486/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/486/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/486/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/486/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/486/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/486/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12861860" author="sureshms" created="Wed, 28 Apr 2010 17:32:54 +0000"  >&lt;p&gt;I committed the patch. Thank you Ravi.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12461987">HADOOP-6702</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                            <outwardlinks description="requires">
                                        <issuelink>
            <issuekey id="12500819">HDFS-1736</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12443038" name="HADOOP-6701-trunk.patch" size="11550" author="sureshms" created="Wed, 28 Apr 2010 05:34:00 +0000"/>
                            <attachment id="12442988" name="HADOOP-6701-trunk.patch" size="11550" author="raviphulari" created="Tue, 27 Apr 2010 18:46:29 +0000"/>
                            <attachment id="12442987" name="HADOOP-6701-v20.patch" size="11535" author="raviphulari" created="Tue, 27 Apr 2010 18:46:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37042</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10342"><![CDATA[Incompatible change]]></customfieldvalue>
    <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 30 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02qj3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>13899</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Commands chmod, chown and chgrp now returns non zero exit code and an error message on failure instead of returning zero.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>yahoo 20.10</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>