<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:56:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-17686] Avoid potential NPE by using Path#getParentPath API in hadoop-huaweicloud</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-17686</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;Hello,&lt;br/&gt;
Our code analyses found a following potential NPE:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Path getParent() {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; path = uri.getPath();
    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; lastSlash = path.lastIndexOf(&lt;span class=&quot;code-quote&quot;&gt;&apos;/&apos;&lt;/span&gt;);
    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; start = startPositionWithoutWindowsDrive(path);
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((path.length() == start) ||               &lt;span class=&quot;code-comment&quot;&gt;// empty path
&lt;/span&gt;        (lastSlash == start &amp;amp;&amp;amp; path.length() == start+1)) { &lt;span class=&quot;code-comment&quot;&gt;// at root
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; &amp;lt;--- Null returned
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void getDirectories(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; key, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; sourceKey,
      &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Set&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; directories) {
    Path p = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(key);
    Path sourcePath = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(sourceKey);
    &lt;span class=&quot;code-comment&quot;&gt;// directory must add first
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (key.endsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;) &amp;amp;&amp;amp; p.compareTo(sourcePath) &amp;gt; 0) {
      directories.add(p.toString());
    }
    &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (p.compareTo(sourcePath) &amp;gt; 0) {
      p = p.getParent(); &amp;lt;--- NPE
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (p.isRoot() || p.compareTo(sourcePath) == 0) {
        &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Given a root path, it will lead to NPE at method getDirectories&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Full trace:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;1. Return null to caller&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/hadoop/blob/f40e3eb0590f85bb42d2471992bf5d524628fdd6/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/Path.java#L432&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hadoop/blob/f40e3eb0590f85bb42d2471992bf5d524628fdd6/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/Path.java#L432&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;2. Function getParent executes and returns&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/hadoop/blob/f40e3eb0590f85bb42d2471992bf5d524628fdd6/hadoop-cloud-storage-project/hadoop-huaweicloud/src/main/java/org/apache/hadoop/fs/obs/OBSObjectBucketUtils.java#L875&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hadoop/blob/f40e3eb0590f85bb42d2471992bf5d524628fdd6/hadoop-cloud-storage-project/hadoop-huaweicloud/src/main/java/org/apache/hadoop/fs/obs/OBSObjectBucketUtils.java#L875&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;3. The return value of function getParent is passed as the this pointer to function isRoot (the return value of function getParent can be null)&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/hadoop/blob/f40e3eb0590f85bb42d2471992bf5d524628fdd6/hadoop-cloud-storage-project/hadoop-huaweicloud/src/main/java/org/apache/hadoop/fs/obs/OBSObjectBucketUtils.java#L876&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hadoop/blob/f40e3eb0590f85bb42d2471992bf5d524628fdd6/hadoop-cloud-storage-project/hadoop-huaweicloud/src/main/java/org/apache/hadoop/fs/obs/OBSObjectBucketUtils.java#L876&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Commit: f40e3eb0590f85bb42d2471992bf5d524628fdd6&lt;/p&gt;</description>
                <environment></environment>
        <key id="13377135">HADOOP-17686</key>
            <summary>Avoid potential NPE by using Path#getParentPath API in hadoop-huaweicloud</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vjasani">Viraj Jasani</assignee>
                                    <reporter username="ErrReporter">Error Reporter</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 7 May 2021 03:54:04 +0000</created>
                <updated>Wed, 12 May 2021 01:36:01 +0000</updated>
                            <resolved>Wed, 12 May 2021 01:36:00 +0000</resolved>
                                                    <fixVersion>3.4.0</fixVersion>
                                    <component>fs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="7200">2h</timespent>
                                <comments>
                            <comment id="17341662" author="vjasani" created="Mon, 10 May 2021 04:57:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brahmareddy&quot; class=&quot;user-hover&quot; rel=&quot;brahmareddy&quot;&gt;brahmareddy&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brahma&quot; class=&quot;user-hover&quot; rel=&quot;brahma&quot;&gt;brahma&lt;/a&gt; Could you please take a look when you get time?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="17341788" author="vjasani" created="Mon, 10 May 2021 09:14:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smeng&quot; class=&quot;user-hover&quot; rel=&quot;smeng&quot;&gt;smeng&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tasanuma&quot; class=&quot;user-hover&quot; rel=&quot;tasanuma&quot;&gt;tasanuma&lt;/a&gt;&#160;Would you like to take a look at PR? It&apos;s a small fix. If you are fine with approach, I can provide PR for&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-17689&quot; title=&quot;Avoid Potential NPE in org.apache.hadoop.fs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-17689&quot;&gt;&lt;del&gt;HADOOP-17689&lt;/del&gt;&lt;/a&gt;&#160;as well which has similar analysis.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="17342353" author="vjasani" created="Tue, 11 May 2021 07:03:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aajisaka&quot; class=&quot;user-hover&quot; rel=&quot;aajisaka&quot;&gt;aajisaka&lt;/a&gt;&#160;Would you like to take a look? It&apos;s a small fix. Thanks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 27 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0qt34:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>