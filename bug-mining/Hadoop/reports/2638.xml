<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:56:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-17060] listStatus and getFileStatus behave inconsistent in the case of ViewFs implementation for isDirectory</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-17060</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;listStatus implementation in ViewFs and getFileStatus does not return consistent values for an element on isDirectory value.&#160;listStatus returns isDirectory of all softlinks as false and&#160;getFileStatus returns isDirectory as true.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[hdfs@c3121-node2 ~]$ /usr/jdk64/jdk1.8.0_112/bin/java -cp `hadoop classpath`:./hdfs-append-1.0-SNAPSHOT.jar LauncherGetFileStatus &lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;
FileStatus of viewfs:&lt;span class=&quot;code-comment&quot;&gt;//c3121/testme21may isDirectory:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
&lt;/span&gt;FileStatus of viewfs:&lt;span class=&quot;code-comment&quot;&gt;//c3121/tmp isDirectory:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
&lt;/span&gt;FileStatus of viewfs:&lt;span class=&quot;code-comment&quot;&gt;//c3121/foo isDirectory:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
&lt;/span&gt;FileStatus of viewfs:&lt;span class=&quot;code-comment&quot;&gt;//c3121/tmp21may isDirectory:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
&lt;/span&gt;FileStatus of viewfs:&lt;span class=&quot;code-comment&quot;&gt;//c3121/testme isDirectory:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
&lt;/span&gt;FileStatus of viewfs:&lt;span class=&quot;code-comment&quot;&gt;//c3121/testme2 isDirectory:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &amp;lt;--- returns &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
&lt;/span&gt;FileStatus of / isDirectory:&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
[hdfs@c3121-node2 ~]$ /usr/jdk64/jdk1.8.0_112/bin/java -cp `hadoop classpath`:./hdfs-append-1.0-SNAPSHOT.jar LauncherGetFileStatus /testme2
FileStatus of viewfs:&lt;span class=&quot;code-comment&quot;&gt;//c3121/testme2/dist-copynativelibs.sh isDirectory:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
&lt;/span&gt;FileStatus of viewfs:&lt;span class=&quot;code-comment&quot;&gt;//c3121/testme2/newfolder isDirectory:&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/span&gt;FileStatus of /testme2 isDirectory:&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; &amp;lt;--- returns &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
[hdfs@c3121-node2 ~]$ &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13306502">HADOOP-17060</key>
            <summary>listStatus and getFileStatus behave inconsistent in the case of ViewFs implementation for isDirectory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="umamaheswararao">Uma Maheswara Rao G</assignee>
                                    <reporter username="smajeti">Srinivasu Majeti</reporter>
                        <labels>
                            <label>viewfs</label>
                    </labels>
                <created>Thu, 21 May 2020 13:38:05 +0000</created>
                <updated>Thu, 10 Jun 2021 07:56:48 +0000</updated>
                            <resolved>Wed, 10 Jun 2020 22:01:44 +0000</resolved>
                                    <version>3.0.0</version>
                    <version>3.1.0</version>
                                    <fixVersion>3.2.2</fixVersion>
                    <fixVersion>3.3.1</fixVersion>
                    <fixVersion>3.4.0</fixVersion>
                                    <component>viewfs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                                                                <comments>
                            <comment id="17113760" author="umamaheswararao" created="Fri, 22 May 2020 05:22:34 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smajeti&quot; class=&quot;user-hover&quot; rel=&quot;smajeti&quot;&gt;smajeti&lt;/a&gt;&#160;for reporting it. I think you are right, in listStatus we have checks for isLink but we don&apos;t have it for getFileStatus.&lt;/p&gt;

&lt;p&gt;I think the motivation of showing the isDir as false was probably due to the fact that they are links. By not representing link as regular directories in ls, would create less confusions on navigating in tree. If any others remembers the motivations why it was done like that please feel free to comment.&lt;/p&gt;

&lt;p&gt;Coming to getFileStatus, I think we can make it similar to listStatus.&lt;/p&gt;

&lt;p&gt;&#160;ListStatus checks:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (inode.isLink()) {
&#160; &#160; &#160; &#160; &#160; INodeLink&amp;lt;FileSystem&amp;gt; link = (INodeLink&amp;lt;FileSystem&amp;gt;) inode;
&#160;
&#160; &#160; &#160; &#160; &#160; result[i++] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileStatus(0, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, 0, 0,
&#160; &#160; &#160; &#160; &#160; &#160; creationTime, creationTime, PERMISSION_555,
&#160; &#160; &#160; &#160; &#160; &#160; ugi.getShortUserName(), ugi.getPrimaryGroupName(),
&#160; &#160; &#160; &#160; &#160; &#160; link.getTargetLink(),
&#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(inode.fullPath).makeQualified(
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; myUri, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;));
&#160; &#160; &#160; &#160; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&#160; &#160; &#160; &#160; &#160; result[i++] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileStatus(0, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, 0, 0,
&#160; &#160; &#160; &#160; &#160; &#160; creationTime, creationTime, PERMISSION_555,
&#160; &#160; &#160; &#160; &#160; &#160; ugi.getShortUserName(), ugi.getGroupNames()[0],
&#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(inode.fullPath).makeQualified(
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; myUri, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;));
&#160; &#160; &#160; &#160; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;GetFileStatus:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileStatus(0, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, 0, 0, creationTime, creationTime,
&#160; &#160; &#160; &#160; &#160; PERMISSION_555, ugi.getShortUserName(), ugi.getPrimaryGroupName(),
&#160;
&#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(theInternalDir.fullPath).makeQualified(
&#160; &#160; &#160; &#160; &#160; &#160; &#160; myUri, ROOT_PATH));
&#160;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17113764" author="smajeti" created="Fri, 22 May 2020 05:34:29 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=umamaheswararao&quot; class=&quot;user-hover&quot; rel=&quot;umamaheswararao&quot;&gt;umamaheswararao&lt;/a&gt;&#160;for your quick confirmation.&lt;/p&gt;

&lt;p&gt;So right now , i have two clarifications in this viewfs context:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Do we support symlink creation only in this usecase of viewfs to actual namespace&#160; (&#160;which is actually targeting only directories really in the target namespace ) through core-site.xml ? Or we can do it for files also ? Dont remember if there is any other way to do it .&#160;&lt;/li&gt;
	&lt;li&gt;So we get isSymlink() as true only for&#160;symlink_name (as configured in fs.viewfs.mounttable.fsname.link./symlink_name=hdfs://namespace/target_dir) though core-site customisation and no other hdfs cli or feature does it right ?&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="17116927" author="umamaheswararao" created="Tue, 26 May 2020 17:43:32 +0000"  >&lt;p&gt;Let me put out some summary about the original issue here first:&lt;br/&gt;
Take an example of mount link: /testme --&amp;gt; /a/b/c&lt;br/&gt;
&#160; Current behaviors: &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&#160; &#160; &#160; listStatus &quot;/&quot; would return FileStatus(path=&quot;/testme&quot;,&#160;&lt;b&gt;isDir=false&lt;/b&gt;, ...... )&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&#160;&lt;/li&gt;
	&lt;li&gt;&#160; &#160; &#160; getFileStatus(&quot;/testme&quot;) would return FileStatus(path=&quot;/testme&quot;,&#160;&lt;b&gt;isDir=true,&lt;/b&gt; ....)&lt;br/&gt;
&#160;&lt;br/&gt;
&#160;From the implementation perspective, when doing the above operation on the link directory directly, they will execute this operation on targetFileSystem. Since getFileStatus runs on link, i.e &quot;/testme&quot;, it is executing on target fs, which was initialized with the directory &quot;/a/b/c&quot;. Above listStatus call is running on &quot;/&quot; which is not link, but it&apos;s an internal directory. So, when executing ls on the internal directory, we are having the following checks .&lt;br/&gt;
&#160;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
listStatus(Path path){
&#160; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;&#160;(inode.isLink()) {
&#160; &#160; &#160;&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;&#160;FileStatus(path, isDir=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, ...)
&#160; &#160;} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;{
&#160; &#160; &#160;&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; FileStatus(path, isDir=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, .....)
&#160; &#160;}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;br/&gt;
I think the correct behavior should be when it is link, it should get fileStatus on target fs and return that directory status, instead of hardcoding always as isDir=false.&lt;br/&gt;
&lt;b&gt;Proposed pseudo code:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt; InternalDirViewFS{ FileStatus[] listStatus(Path path){
&#160; &#160;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;&#160;(inode.isLink()) {
&#160; &#160; &#160; &#160;&lt;span class=&quot;code-comment&quot;&gt;//gets the status from target link
&lt;/span&gt;&#160; &#160; &#160; &#160;FileStatus&#160;fileStatus&#160;=&#160;link.targetFileSystem
&#160; &#160; &#160; &#160; &#160; &#160; &#160;&#160;.getFileStatus(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;&#160;Path(link.targetFileSystem.getUri()));
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;&#160;FileStatus(path,&#160;isDir= fileStatus.isDirectory(),.....);
&#160; &#160; &#160;} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;{
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;//&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; is InternalDir. It&apos;s alway isDir &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/span&gt;&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; FileStatus(path, isDir=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;,...);
&#160; &#160; &#160; }
&#160; &#160; }
&#160;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Let me know if this make sense to you.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Coming to your questions:&lt;/b&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt; Question 1: &lt;br/&gt;
Do we support symlink creation only in this usecase of viewfs to actual namespace&#160; (&#160;which is actually targeting only directories really in the target namespace ) through core-site.xml ? Or we can do it for files also ? Dont remember if there is any other way to do it .&#160;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;There are two things mixing up here. One is mount link and other is actual filesystem symlink. In viewFS perspective, we are trying show the mount links as symlinks in FIleStatus. When targetFS supports it fs level symlinks, it just honor that symlink behavior. Once target resolved from ViewFS, the target fs behavior will not change.&lt;/p&gt;

&lt;p&gt;For ViewFS, yes we have support only via xml config file. For target fs, if that supports FileSystem level symlink APIs, we will just continue to support.&lt;br/&gt;
For ViewFS, you cannot create regular symlinks via API.&#160;&lt;br/&gt;
&#160; &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  /**
&#160;&#160; * See {@link FileContext#createSymlink(Path, Path, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)}.
&#160;&#160; */
&#160; *&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt;* *void* createSymlink(*&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt;* Path target, *&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt;* Path link,
&#160; &#160; &#160; *&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt;* *&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;* createParent) *&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt;* AccessControlException,
&#160; &#160; &#160; FileAlreadyExistsException, FileNotFoundException,
&#160; &#160; &#160; ParentNotDirectoryException, UnsupportedFileSystemException,
&#160; &#160; &#160; IOException {
&#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;// Supporting filesystems should override &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; method
&lt;/span&gt;&#160; &#160; *&lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt;* *&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;* UnsupportedOperationException(
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;Filesystem does not support symlinks!&quot;&lt;/span&gt;);
&#160; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We support mount links via configuration and we represent them as symlinks in FileStatus.&lt;br/&gt;
To know whether a particular fs supports actual symlinks, you can use this API and check.&#160;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; supportsSymlinks()&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&#160;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Question 2: &lt;br/&gt;
So we get isSymlink() as true only for&#160;symlink_name (as configured in fs.viewfs.mounttable.fsname.link./symlink_name=hdfs://namespace/target_dir) though core-site customisation and no other hdfs cli or feature does it right ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;yes. From ViewFS perspective. Coming to target fs (that is in hdfs case), it will support symlinks and many other fs might not support. Ex: S3aFileSystem we are not supporting.&lt;br/&gt;
DistributedFileSystem.java#supportedSymlinks()&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  @Override
&#160; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; supportsSymlinks() {
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
&#160; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Hope this answers will help. Thank you.&lt;br/&gt;
&#160;&lt;/p&gt;</comment>
                            <comment id="17120934" author="smajeti" created="Mon, 1 Jun 2020 11:07:37 +0000"  >&lt;p&gt;Thank you for the quick clarification &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=umamaheswararao&quot; class=&quot;user-hover&quot; rel=&quot;umamaheswararao&quot;&gt;umamaheswararao&lt;/a&gt;&#160;. Can we take this up for further review and have it resolved as we see Ambari Files View is blocked due to this for ViewFS .&#160;&lt;/p&gt;

&lt;p&gt;CC &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arpaga&quot; class=&quot;user-hover&quot; rel=&quot;arpaga&quot;&gt;arpaga&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17123998" author="umamaheswararao" created="Tue, 2 Jun 2020 16:18:36 +0000"  >&lt;p&gt;HI &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smajeti&quot; class=&quot;user-hover&quot; rel=&quot;smajeti&quot;&gt;smajeti&lt;/a&gt;&#160;thank you for checking. I am just waiting for&#160;&lt;a href=&quot;https://github.com/apache/hadoop/pull/2019&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hadoop/pull/2019&lt;/a&gt;&#160;to go in as&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-17029&quot; title=&quot;ViewFS does not return correct user/group and ACL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-17029&quot;&gt;&lt;del&gt;HADOOP-17029&lt;/del&gt;&lt;/a&gt;&#160;also changing the same code lines. I reviewed that Jira and provided my comments there.&lt;/p&gt;</comment>
                            <comment id="17124002" author="smajeti" created="Tue, 2 Jun 2020 16:20:53 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=umamaheswararao&quot; class=&quot;user-hover&quot; rel=&quot;umamaheswararao&quot;&gt;umamaheswararao&lt;/a&gt;&#160;!&lt;/p&gt;</comment>
                            <comment id="17129736" author="umamaheswararao" created="Tue, 9 Jun 2020 19:29:53 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smajeti&quot; class=&quot;user-hover&quot; rel=&quot;smajeti&quot;&gt;smajeti&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Copied my PR comment here:&lt;/p&gt;

&lt;p&gt;I have verified symlinks behavior in HDFS.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testSymlinkOnHDFS() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
&#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;// add ur hdfs uri here: ex hdfs://10.0.1.75:9000
&lt;/span&gt;&#160; &#160; URI hdfsURI = dfs.getUri();
&#160; &#160; FileSystem.enableSymlinks();
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (FileSystem hdfs = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DistributedFileSystem()) {
&#160; &#160; &#160; hdfs.initialize(hdfsURI, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HdfsConfiguration());
&#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Path targetLinkDir = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/user&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;targetRegularDir&quot;&lt;/span&gt;);
&#160; &#160; &#160; hdfs.mkdirs(targetLinkDir)
&#160; &#160; &#160; Path symLinkDir = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/links/linkDir&quot;&lt;/span&gt;);
&#160; &#160; &#160; hdfs.createSymlink(targetLinkDir, symLinkDir, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
&#160; &#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;// ListStatus Test
&lt;/span&gt;&#160; &#160; &#160; FileStatus[] listStatus = hdfs.listStatus(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/links&quot;&lt;/span&gt;));
&#160; &#160; &#160; FileStatus fsFromLs = listStatus[0]; &lt;span class=&quot;code-comment&quot;&gt;// FileStatus of /links/linkDir
&lt;/span&gt;&#160; &#160; &#160; Assert.assertEquals(fsFromLs.isDirectory(), &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
&#160; &#160; &#160; Assert.assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;/links/linkDir&quot;&lt;/span&gt;,
&#160; &#160; &#160; &#160; &#160; Path.getPathWithoutSchemeAndAuthority(fsFromLs.getPath()).toString());
&#160; &#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;// GetFileStatus test
&lt;/span&gt;&#160; &#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;// FileStatus of /links/linkDir
&lt;/span&gt;&#160; &#160; &#160; FileStatus fileStatus = hdfs.getFileStatus(symLinkDir);
&#160; &#160; &#160; Assert.assertEquals(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, fileStatus.isDirectory());
&#160; &#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;// resolved to FileStatus of /user/targetRegularDir
&lt;/span&gt;&#160; &#160; &#160; Assert.assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;/user/targetRegularDir&quot;&lt;/span&gt;, Path
&#160; &#160; &#160; &#160; &#160; .getPathWithoutSchemeAndAuthority(fileStatus.getPath()).toString());
&#160; &#160; }
&#160; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It turns out that the behavior of listStatus and GetFileStatus are different. They both returning different FileStatus. Same behavior in ViewFS also.&lt;/p&gt;

&lt;p&gt;GetFileStatus(/test), just runs on resolved path directly. So, it will not be represented as symLink.&lt;br/&gt;
 ListStatus&#160;gets /test as children FileStatus object. But that represents as symLink.&lt;/p&gt;

&lt;p&gt;Probably we should just clarify the behavior in user guide and API docs about the behaviors in symlinks case? Otherwise fixing this needs to be done all other places and it will be incompatible change across.&lt;br/&gt;
 One advantage I see with the existing behavior is that, with listStatus we can know wether dir is symlink. If one wants to know targetFs details, then issue GetFileStatus on that path will resolved to targetFS and gets the FileStatus at targetFS.&lt;br/&gt;
 I will also check with Sanjay on this and update here.&lt;/p&gt;</comment>
                            <comment id="17132751" author="umamaheswararao" created="Wed, 10 Jun 2020 22:01:44 +0000"  >&lt;p&gt;Clarified the behaviors in Javadocs of ListStatus and GetFileStatus. &lt;/p&gt;</comment>
                            <comment id="17132761" author="hudson" created="Wed, 10 Jun 2020 22:17:57 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #18345 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-trunk-Commit/18345/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-trunk-Commit/18345/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-17060&quot; title=&quot;listStatus and getFileStatus behave inconsistent in the case of ViewFs implementation for isDirectory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-17060&quot;&gt;&lt;del&gt;HADOOP-17060&lt;/del&gt;&lt;/a&gt;. Clarify listStatus and getFileStatus behaviors (github: rev 93b121a9717bb4ef5240fda877ebb5275f6446b4)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/viewfs/ViewFileSystem.java&lt;/li&gt;
	&lt;li&gt;(edit) hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/viewfs/ViewFs.java&lt;/li&gt;
	&lt;li&gt;(edit) hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/fs/Hdfs.java&lt;/li&gt;
	&lt;li&gt;(edit) hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/hdfs/DistributedFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13299780">HDFS-15289</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13302959">HADOOP-17029</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 22 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0f09c:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>