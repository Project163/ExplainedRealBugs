<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:57:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-13500] Synchronizing iteration of Configuration properties object</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-13500</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;It is possible to encounter a ConcurrentModificationException while trying to iterate a Configuration object.  The iterator method tries to walk the underlying Property object without proper synchronization, so another thread simultaneously calling the set method can trigger it.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12997694">HADOOP-13500</key>
            <summary>Synchronizing iteration of Configuration properties object</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dbadaya">Dhananjay Badaya</assignee>
                                    <reporter username="jlowe">Jason Darrell Lowe</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 16 Aug 2016 19:49:07 +0000</created>
                <updated>Tue, 4 Jan 2022 22:42:56 +0000</updated>
                            <resolved>Fri, 17 Dec 2021 16:09:17 +0000</resolved>
                                                    <fixVersion>3.4.0</fixVersion>
                    <fixVersion>2.10.2</fixVersion>
                    <fixVersion>3.2.3</fixVersion>
                    <fixVersion>3.3.2</fixVersion>
                                    <component>conf</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>18</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="7800">2h 10m</timespent>
                                <comments>
                            <comment id="15423284" author="jlowe" created="Tue, 16 Aug 2016 19:51:23 +0000"  >&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/TEZ-3413&quot; title=&quot;ConcurrentModificationException in HistoryEventTimelineConversion for AppLaunchedEvent&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TEZ-3413&quot;&gt;&lt;del&gt;TEZ-3413&lt;/del&gt;&lt;/a&gt; for a sample backtrace.  I believe the fix is to simply lock the Property object while iterating it within the Configuration#iterator method, but I haven&apos;t thought through all of the potential interactions to see if we don&apos;t also have to lock the Configuration object itself as well or do something even more complicated.&lt;/p&gt;</comment>
                            <comment id="16183478" author="sershe" created="Thu, 28 Sep 2017 00:06:53 +0000"  >&lt;p&gt;Hive is also hitting this issue with a different call stack&lt;/p&gt;</comment>
                            <comment id="16183481" author="sershe" created="Thu, 28 Sep 2017 00:08:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jnp&quot; class=&quot;user-hover&quot; rel=&quot;jnp&quot;&gt;jnp&lt;/a&gt; can we fix get this fixed eventually? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16183499" author="jnp" created="Thu, 28 Sep 2017 00:40:08 +0000"  >&lt;p&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lmccay&quot; class=&quot;user-hover&quot; rel=&quot;lmccay&quot;&gt;lmccay&lt;/a&gt; had a patch for this, IIRC.&lt;/p&gt;</comment>
                            <comment id="16423241" author="vinodkv" created="Mon, 2 Apr 2018 22:46:58 +0000"  >&lt;p&gt;Already fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-13556&quot; title=&quot;Change Configuration.getPropsWithPrefix to use getProps instead of iterator&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-13556&quot;&gt;&lt;del&gt;HADOOP-13556&lt;/del&gt;&lt;/a&gt;. Closing as a dup. Please reopen if that isn&apos;t the case.&lt;/p&gt;</comment>
                            <comment id="16424089" author="jlowe" created="Tue, 3 Apr 2018 14:20:54 +0000"  >&lt;p&gt;This is not a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-13556&quot; title=&quot;Change Configuration.getPropsWithPrefix to use getProps instead of iterator&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-13556&quot;&gt;&lt;del&gt;HADOOP-13556&lt;/del&gt;&lt;/a&gt;.  That JIRA only changed the getPropsWithPrefix method which was not involved in the error reported by this JIRA or &lt;a href=&quot;https://issues.apache.org/jira/browse/TEZ-3413&quot; title=&quot;ConcurrentModificationException in HistoryEventTimelineConversion for AppLaunchedEvent&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TEZ-3413&quot;&gt;&lt;del&gt;TEZ-3413&lt;/del&gt;&lt;/a&gt;.  AFAICT iterating a shared configuration object is still unsafe.&lt;/p&gt;</comment>
                            <comment id="16976369" author="john smith" created="Mon, 18 Nov 2019 08:51:00 +0000"  >&lt;p&gt;Hi, is someone still work on this? And I want to know if there is a definition how thread-safe the class Configuration is?&lt;/p&gt;</comment>
                            <comment id="17441534" author="JIRAUSER279802" created="Wed, 10 Nov 2021 07:15:44 +0000"  >&lt;p&gt;Encountered this with Hive&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.util.ConcurrentModificationException at java.util.Hashtable$Enumerator.next(Hashtable.java:1387) at org.apache.hadoop.conf.Configuration.iterator(Configuration.java:2625) at org.apache.hadoop.hive.conf.HiveConf.getProperties(HiveConf.java:4047) at org.apache.hadoop.hive.conf.HiveConf.getAllProperties(HiveConf.java:4043) at org.apache.hadoop.hive.conf.HiveConf.getChangedProperties(HiveConf.java:4362) at org.apache.hadoop.hive.ql.exec.Utilities.isDefaultNameNode(Utilities.java:3572) at org.apache.hadoop.hive.ql.plan.CreateTableDesc.toTable(CreateTableDesc.java:795) at org.apache.hadoop.hive.ql.exec.DDLTask.createTable(DDLTask.java:4321) at org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:354) at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:199) at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:100)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jlowe&quot; class=&quot;user-hover&quot; rel=&quot;jlowe&quot;&gt;jlowe&lt;/a&gt; mentioned earlier, the fix could be to wrap &lt;a href=&quot;https://github.com/apache/hadoop/blob/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/conf/Configuration.java#L2964&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this&lt;/a&gt; for loop in a &lt;b&gt;synchronized (properties)&lt;/b&gt; block.&lt;/p&gt;

&lt;p&gt;If this solution looks acceptable then I will be happy to provide a patch for this.&lt;/p&gt;</comment>
                            <comment id="17454383" author="ajisakaa" created="Tue, 7 Dec 2021 05:51:57 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dbadaya&quot; class=&quot;user-hover&quot; rel=&quot;dbadaya&quot;&gt;dbadaya&lt;/a&gt;, I think this solution looks acceptable. Would you provide a patch? Thanks.&lt;/p&gt;</comment>
                            <comment id="17461238" author="ajisakaa" created="Fri, 17 Dec 2021 07:19:52 +0000"  >&lt;p&gt;Merged PR 3775 into trunk, branch-3.3, and branch-3.2.&lt;/p&gt;</comment>
                            <comment id="17461534" author="ajisakaa" created="Fri, 17 Dec 2021 16:09:17 +0000"  >&lt;p&gt;Merged PR 3776 into branch-2.10.&lt;/p&gt;</comment>
                            <comment id="17461535" author="ajisakaa" created="Fri, 17 Dec 2021 16:09:31 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dbadaya&quot; class=&quot;user-hover&quot; rel=&quot;dbadaya&quot;&gt;dbadaya&lt;/a&gt; for your contribution.&lt;/p&gt;</comment>
                            <comment id="17461558" author="brahmareddy" created="Fri, 17 Dec 2021 16:48:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aajisaka&quot; class=&quot;user-hover&quot; rel=&quot;aajisaka&quot;&gt;aajisaka&lt;/a&gt;&#160; will you cherry-pick to branch-3.2.3 also..? Or shall I do..?&lt;/p&gt;</comment>
                            <comment id="17461579" author="ajisakaa" created="Fri, 17 Dec 2021 17:25:36 +0000"  >&lt;p&gt;I&apos;ll cherry-pick this. Thanks&lt;/p&gt;</comment>
                            <comment id="17461580" author="ajisakaa" created="Fri, 17 Dec 2021 17:26:32 +0000"  >&lt;p&gt;Cherry-picked to branch-3.2.3.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12997418">TEZ-3413</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13149607">YARN-8109</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 47 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i32dyv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>