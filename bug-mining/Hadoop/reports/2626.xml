<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:56:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-17024] ListStatus on ViewFS root (ls &quot;/&quot;) should list the linkFallBack root (configured target root).</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-17024</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;As part of the design doc &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-15289&quot; title=&quot;Allow viewfs mounts with HDFS/HCFS scheme and centralized mount table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-15289&quot;&gt;HDFS-15289&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sanjay.radia&quot; class=&quot;user-hover&quot; rel=&quot;sanjay.radia&quot;&gt;sanjay.radia&lt;/a&gt;&#160;and me discussed the following scenarios when fallback enabled.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Behavior when fallback enabled:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Assume FS trees and mount mappings like below:&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;mount link /a/b/c/d&#160; &#8594; hdfs://nn1/a/b&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;mount link /a/p/q/r&#160; &#8594; hdfs://nn2/a/b&#160;&#160;&#160;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;fallback &#8594; hdfs://nn3/&#160; $&#160; /a/c&lt;br/&gt;
 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; /x/z&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Open(/x/y) then it goes to nn3 (fallback)&#160; &#160; &#160; - WORKS&lt;/li&gt;
	&lt;li&gt;Create(/x/foo) then foo is created in nn3 in dir /x &#160; - WORKS&lt;/li&gt;
	&lt;li&gt;ls /&#160; should list &#160; /a&#160; /x .Today this does not work and IT IS A BUG!!! Because it conflicts with the open(/x/y)&lt;/li&gt;
	&lt;li&gt;Create /y&#160; : fails&#160; - also fails when not using&#160; fallback&#160; - WORKS&lt;/li&gt;
	&lt;li&gt;Create /a/z : fails - also fails when not using&#160; fallback - WORKS&lt;/li&gt;
	&lt;li&gt;ls /a should list /b /p&#160; as expected and will not show fallback in nn3 - WORKS&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This Jira will fix issue of #3. So, when fallback enabled it should show merged ls view with mount links + fallback root. ( this will only be at root level)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13302246">HADOOP-17024</key>
            <summary>ListStatus on ViewFS root (ls &quot;/&quot;) should list the linkFallBack root (configured target root).</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="abhishekd">Abhishek Das</assignee>
                                    <reporter username="umamaheswararao">Uma Maheswara Rao G</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 May 2020 01:52:49 +0000</created>
                <updated>Thu, 10 Jun 2021 07:56:27 +0000</updated>
                            <resolved>Tue, 19 May 2020 05:32:34 +0000</resolved>
                                    <version>3.2.2</version>
                                    <fixVersion>3.2.2</fixVersion>
                    <fixVersion>3.3.1</fixVersion>
                    <fixVersion>3.4.0</fixVersion>
                                    <component>fs</component>
                    <component>viewfs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="17098647" author="umamaheswararao" created="Mon, 4 May 2020 04:11:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=virajith&quot; class=&quot;user-hover&quot; rel=&quot;virajith&quot;&gt;virajith&lt;/a&gt;&#160;Did you notice this scenario? What do you guys think about this case?&lt;/p&gt;</comment>
                            <comment id="17099157" author="virajith" created="Mon, 4 May 2020 17:24:50 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=umamaheswararao&quot; class=&quot;user-hover&quot; rel=&quot;umamaheswararao&quot;&gt;umamaheswararao&lt;/a&gt;, yes, we saw this issue. Can you clarify the mount table in your example? IIUC, I agree that an ls on / here should list whatever is configured in the &lt;tt&gt;/linkFallBack&lt;/tt&gt; as well.&lt;/p&gt;

&lt;p&gt;cc: &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cliang&quot; class=&quot;user-hover&quot; rel=&quot;cliang&quot;&gt;cliang&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abhishekd&quot; class=&quot;user-hover&quot; rel=&quot;abhishekd&quot;&gt;abhishekd&lt;/a&gt;.&#160;&lt;/p&gt;</comment>
                            <comment id="17099162" author="virajith" created="Mon, 4 May 2020 17:29:12 +0000"  >&lt;p&gt;We also saw other issues where some aggregation/recursive calls like&#160;&#160;&lt;tt&gt;contentSummary&lt;/tt&gt;&#160;may not give the right result when called on Inodes in the mount table. We wanted to a few enhancements to ViewFS &#8211;&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cliang&quot; class=&quot;user-hover&quot; rel=&quot;cliang&quot;&gt;cliang&lt;/a&gt;/&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abhishekd&quot; class=&quot;user-hover&quot; rel=&quot;abhishekd&quot;&gt;abhishekd&lt;/a&gt;,&#160; can you file JIRAs for these? thanks!&lt;/p&gt;</comment>
                            <comment id="17099175" author="umamaheswararao" created="Mon, 4 May 2020 17:46:33 +0000"  >&lt;p&gt;Yes, please file these issues. Thanks&lt;/p&gt;

&lt;p&gt;I have provided example mount links in description.&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; &#160; &#160;mount link /a/b/c/d&#160; &#8594; hdfs://nn1/a/b&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;mount link /a/p/q/r&#160; &#8594; hdfs://nn2/a/b&#160;&#160;&#160;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;fallback &#8594; hdfs://nn3/&#160; $&#160; /a/c&lt;br/&gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;/x/z&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160;ls /&#160; should list &#160; /a&#160; /x .Today this does not work and IT IS A BUG!!! Because it conflicts with the open(/x/y)&lt;/p&gt;

&lt;p&gt;Here when we do ls on root, currently it is showing only mount links ( fallback will not have source path), that is /a.&lt;/p&gt;

&lt;p&gt;But fallback also has /a and /x on root. So, we feel that it should list mount links + fallback root ls.&lt;/p&gt;

&lt;p&gt;If same directories available in fallback, in this example /a is there as regular link and also a top level directory in fallback. Fallback /a can be shaded by mount link /a. Probably we should log that shaded delta in warning.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17099460" author="vagarychen" created="Tue, 5 May 2020 01:06:16 +0000"  >&lt;p&gt;Thanks for filing this &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=umamaheswararao&quot; class=&quot;user-hover&quot; rel=&quot;umamaheswararao&quot;&gt;umamaheswararao&lt;/a&gt;! We went across this exact issue recently and have been discussing internally as well. Glad to see we both have interests on improving this &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.  There are a couple other issues regarding viewfs we found, will be filing Jiras&lt;/p&gt;</comment>
                            <comment id="17100275" author="abhishekd" created="Tue, 5 May 2020 21:44:23 +0000"  >&lt;p&gt;Filed&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-17032&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;HADOOP-17032&lt;/a&gt; and&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-17029&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;HADOOP-17029&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17101342" author="abhishekd" created="Thu, 7 May 2020 03:25:06 +0000"  >&lt;p&gt;I can start working on this. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=umamaheswararao&quot; class=&quot;user-hover&quot; rel=&quot;umamaheswararao&quot;&gt;umamaheswararao&lt;/a&gt;&#160;please let me know if I can assign this to myself&lt;/p&gt;</comment>
                            <comment id="17105057" author="umamaheswararao" created="Tue, 12 May 2020 04:25:26 +0000"  >&lt;p&gt;Sure. Thank you for filing them. &lt;br/&gt;
I left it unassigned for that purpose if some one wants to take it. Thanks for working on it.&lt;/p&gt;</comment>
                            <comment id="17105064" author="umamaheswararao" created="Tue, 12 May 2020 04:49:58 +0000"  >&lt;p&gt;I have added you in contributors list and assigned this Jira to you. Thanks&lt;/p&gt;</comment>
                            <comment id="17105651" author="abhishekd" created="Tue, 12 May 2020 18:16:10 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=umamaheswararao&quot; class=&quot;user-hover&quot; rel=&quot;umamaheswararao&quot;&gt;umamaheswararao&lt;/a&gt;. I have raised the PR in github but not able to add any reviewers.&#160; Would really appreciate any help with the review. cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=virajith&quot; class=&quot;user-hover&quot; rel=&quot;virajith&quot;&gt;virajith&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vagarychen&quot; class=&quot;user-hover&quot; rel=&quot;vagarychen&quot;&gt;vagarychen&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17105929" author="umamaheswararao" created="Wed, 13 May 2020 03:11:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abhishekd&quot; class=&quot;user-hover&quot; rel=&quot;abhishekd&quot;&gt;abhishekd&lt;/a&gt;&#160;Thanks for the PR. I have added few comments in PR.&lt;/p&gt;</comment>
                            <comment id="17110867" author="umamaheswararao" created="Tue, 19 May 2020 05:32:35 +0000"  >&lt;p&gt;Thank you&#160;&lt;a href=&quot;https://github.com/abhishekdas99&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;@abhishekdas99&lt;/a&gt;&#160;for the contribution. I have just committed this to trunk.&lt;/p&gt;</comment>
                            <comment id="17110869" author="hudson" created="Tue, 19 May 2020 05:41:23 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #18274 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-trunk-Commit/18274/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-trunk-Commit/18274/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-17024&quot; title=&quot;ListStatus on ViewFS root (ls &amp;quot;/&amp;quot;) should list the linkFallBack root (configured target root).&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-17024&quot;&gt;&lt;del&gt;HADOOP-17024&lt;/del&gt;&lt;/a&gt;. ListStatus on ViewFS root (ls &quot;/&quot;) should list the (github: rev ce4ec7445345eb94c6741d416814a4eac319f0a6)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/viewfs/InodeTree.java&lt;/li&gt;
	&lt;li&gt;(edit) hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/viewfs/ViewFileSystem.java&lt;/li&gt;
	&lt;li&gt;(edit) hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/fs/viewfs/TestViewFileSystemLinkFallback.java&lt;/li&gt;
	&lt;li&gt;(edit) hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/viewfs/ViewFs.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13299780">HDFS-15289</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10342"><![CDATA[Incompatible change]]></customfieldvalue>
    <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 26 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0eab4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>ViewFS#listStatus on root(&amp;quot;/&amp;quot;) considers listing from fallbackLink if available. If the same directory name is present in configured mount path as well as in fallback link, then only the configured mount path will be listed in the returned result.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12346894">3.4.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>