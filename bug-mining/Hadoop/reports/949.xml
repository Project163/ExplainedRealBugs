<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:43:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-9868] Server must not advertise kerberos realm</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-9868</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9789&quot; title=&quot;Support server advertised kerberos principals&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9789&quot;&gt;&lt;del&gt;HADOOP-9789&lt;/del&gt;&lt;/a&gt; broke kerberos authentication by making the RPC server advertise the kerberos service principal realm.  SASL clients and servers do not support specifying a realm, so it must be removed from the advertisement.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12663425">HADOOP-9868</key>
            <summary>Server must not advertise kerberos realm</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="daryn">Daryn Sharp</assignee>
                                    <reporter username="daryn">Daryn Sharp</reporter>
                        <labels>
                    </labels>
                <created>Tue, 13 Aug 2013 13:40:49 +0000</created>
                <updated>Thu, 12 May 2016 18:22:53 +0000</updated>
                            <resolved>Thu, 15 Aug 2013 19:43:30 +0000</resolved>
                                    <version>2.1.1-beta</version>
                    <version>3.0.0-alpha1</version>
                                    <fixVersion>2.1.1-beta</fixVersion>
                                    <component>ipc</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="13738213" author="daryn" created="Tue, 13 Aug 2013 13:43:28 +0000"  >&lt;p&gt;Passes our internal QA tests with kerberos enabled.&lt;/p&gt;</comment>
                            <comment id="13738291" author="hadoopqa" created="Tue, 13 Aug 2013 14:29:49 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12597721/HADOOP-9868.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12597721/HADOOP-9868.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 2 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to introduce 2 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in hadoop-common-project/hadoop-common.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/2974//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/2974//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/2974//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-common.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/2974//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-common.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/2974//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/2974//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13738362" author="tucu00" created="Tue, 13 Aug 2013 15:27:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daryn&quot; class=&quot;user-hover&quot; rel=&quot;daryn&quot;&gt;daryn&lt;/a&gt;, I&apos;m a bit puzzled by this &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9789&quot; title=&quot;Support server advertised kerberos principals&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9789&quot;&gt;&lt;del&gt;HADOOP-9789&lt;/del&gt;&lt;/a&gt;. While I understand the reasoning for it, doesn&apos;t that weaken security? An impersonator can publish an alternate principal for which it has a keytab for. &lt;/p&gt;</comment>
                            <comment id="13741375" author="kihwal" created="Thu, 15 Aug 2013 19:16:21 +0000"  >&lt;blockquote&gt;&lt;p&gt;Daryn Sharp, I&apos;m a bit puzzled by this &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9789&quot; title=&quot;Support server advertised kerberos principals&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9789&quot;&gt;&lt;del&gt;HADOOP-9789&lt;/del&gt;&lt;/a&gt;. While I understand the reasoning for it, doesn&apos;t that weaken security? An impersonator can publish an alternate principal for which it has a keytab for.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Please note that server advertised principals won&apos;t be honored by default. &lt;/p&gt;

&lt;p&gt;In order for the scenario you mentioned to happen, the client needs to connect to the fake service. It means DNS or the server is compromised or something like man-in-the-middle. If this happens, one can pretend to be a service, regardless of &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9789&quot; title=&quot;Support server advertised kerberos principals&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9789&quot;&gt;&lt;del&gt;HADOOP-9789&lt;/del&gt;&lt;/a&gt;. For client-side exploits, if the client-side is compromised, a fake server address and a wide open SPN pattern may be placed in the config to trick the client. But if the system is compromised to this level, one can trick the client in many different ways anyway.&lt;/p&gt;
</comment>
                            <comment id="13741376" author="kihwal" created="Thu, 15 Aug 2013 19:18:14 +0000"  >&lt;p&gt;+1 I&apos;ve verified the patch in a secure cluster.&lt;/p&gt;</comment>
                            <comment id="13741389" author="hudson" created="Thu, 15 Aug 2013 19:39:48 +0000"  >&lt;p&gt;SUCCESS: Integrated in Hadoop-trunk-Commit #4272 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-trunk-Commit/4272/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-trunk-Commit/4272/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9868&quot; title=&quot;Server must not advertise kerberos realm&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9868&quot;&gt;&lt;del&gt;HADOOP-9868&lt;/del&gt;&lt;/a&gt;. Server must not advertise kerberos realm. Contributed by Daryn Sharp. (kihwal: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1514448&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1514448&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/security/SaslRpcServer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13741393" author="kihwal" created="Thu, 15 Aug 2013 19:43:30 +0000"  >&lt;p&gt;The patch has been committed to trunk, branch-2 and branch-2.1-beta.&lt;/p&gt;</comment>
                            <comment id="13741887" author="tucu00" created="Fri, 16 Aug 2013 04:03:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kihwal&quot; class=&quot;user-hover&quot; rel=&quot;kihwal&quot;&gt;kihwal&lt;/a&gt;, the scenario I&apos;m thinking does not require a compromised DNS. It is the following:&lt;/p&gt;

&lt;p&gt;real service listening at host1:10000 with principal foo/host1 crashes.&lt;br/&gt;
fake service starts listening at host1:10000 with principal bar/host1, and it advertises its principal is bar/host1.&lt;/p&gt;

&lt;p&gt;granted this requires a bar/host1 keytab.&lt;/p&gt;

&lt;p&gt;I have not looked at the patch, so I don&apos;t know what safeguards it has. Can you confirm the behavior in the following 2 scenarios?&lt;/p&gt;

&lt;p&gt;1. Does the client accept an arbitrary principal without a service host name? the server advertising &apos;bar&apos; as principal, no hostname.&lt;/p&gt;

&lt;p&gt;I think the client should not accept this alternate.&lt;/p&gt;

&lt;p&gt;2. Does the client accept an alternate advertised with the a different shortname than one used originally by the client? using example above: original server principal submitted by the client foo/host1, advertised server principal bar/host1.&lt;/p&gt;

&lt;p&gt;I think we should reject that scenario, as it would cover the case when keytabs for foo/* principals are not compromised. So an alternate o foo/host1a would be ok but a bar/host1 would not.&lt;/p&gt;</comment>
                            <comment id="13742086" author="hudson" created="Fri, 16 Aug 2013 10:57:31 +0000"  >&lt;p&gt;SUCCESS: Integrated in Hadoop-Yarn-trunk #303 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Yarn-trunk/303/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Yarn-trunk/303/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9868&quot; title=&quot;Server must not advertise kerberos realm&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9868&quot;&gt;&lt;del&gt;HADOOP-9868&lt;/del&gt;&lt;/a&gt;. Server must not advertise kerberos realm. Contributed by Daryn Sharp. (kihwal: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1514448&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1514448&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/security/SaslRpcServer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13742201" author="hudson" created="Fri, 16 Aug 2013 13:29:12 +0000"  >&lt;p&gt;SUCCESS: Integrated in Hadoop-Hdfs-trunk #1493 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1493/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1493/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9868&quot; title=&quot;Server must not advertise kerberos realm&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9868&quot;&gt;&lt;del&gt;HADOOP-9868&lt;/del&gt;&lt;/a&gt;. Server must not advertise kerberos realm. Contributed by Daryn Sharp. (kihwal: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1514448&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1514448&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/security/SaslRpcServer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13742273" author="hudson" created="Fri, 16 Aug 2013 14:44:48 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Mapreduce-trunk #1520 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1520/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1520/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9868&quot; title=&quot;Server must not advertise kerberos realm&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9868&quot;&gt;&lt;del&gt;HADOOP-9868&lt;/del&gt;&lt;/a&gt;. Server must not advertise kerberos realm. Contributed by Daryn Sharp. (kihwal: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1514448&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1514448&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/security/SaslRpcServer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12597721" name="HADOOP-9868.patch" size="873" author="daryn" created="Tue, 13 Aug 2013 13:43:28 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343426</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 14 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1n84v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343731</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12324807">2.1.1-beta</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>