<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:34:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-7087] SequenceFile.createWriter ignores FileSystem parameter</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-7087</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;The SequenceFile.createWriter methods that take a FileSystem ignore this parameter after &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-6856&quot; title=&quot;SequenceFile and MapFile need cleanup to remove redundant constructors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-6856&quot;&gt;&lt;del&gt;HADOOP-6856&lt;/del&gt;&lt;/a&gt;. This is causing some MR tests to fail and is a breaking change when users pass unqualified paths to these calls.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12494791">HADOOP-7087</key>
            <summary>SequenceFile.createWriter ignores FileSystem parameter</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tlipcon">Todd Lipcon</assignee>
                                    <reporter username="tlipcon">Todd Lipcon</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Jan 2011 01:12:34 +0000</created>
                <updated>Thu, 2 May 2013 02:29:35 +0000</updated>
                            <resolved>Tue, 11 Jan 2011 18:37:37 +0000</resolved>
                                    <version>0.22.0</version>
                                    <fixVersion>0.22.0</fixVersion>
                                    <component>io</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="12978072" author="tlipcon" created="Thu, 6 Jan 2011 01:41:27 +0000"  >&lt;p&gt;Attached patch fixes MR trunk build&lt;/p&gt;</comment>
                            <comment id="12978177" author="owen.omalley" created="Thu, 6 Jan 2011 07:01:45 +0000"  >&lt;p&gt;Rather than add a FileSystem option and then using it, create a method that makes a fully qualified path from a filesystem and a path. It seems like there is already one out there and that won&apos;t introduce an option that isn&apos;t forward compatible.&lt;/p&gt;</comment>
                            <comment id="12978202" author="hadoopqa" created="Thu, 6 Jan 2011 07:59:10 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12467603/hadoop-7087.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12467603/hadoop-7087.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1055206.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    -1 javac.  The applied patch generated 1049 javac compiler warnings (more than the trunk&apos;s current 1048 warnings).&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;    +1 system test framework.  The patch passed system test framework compile.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/160//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/160//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/160//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/160//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/160//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/160//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12978210" author="tlipcon" created="Thu, 6 Jan 2011 08:21:54 +0000"  >&lt;p&gt;Hi Owen. That&apos;s the original direction I went with this patch, but then I thought more about it, and decided that it is not quite correct - for example, RawLocalFileSystem and LocalFileSystem (checksummed) both use &lt;a href=&quot;file:///&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:///&lt;/a&gt; URLs. But &lt;tt&gt;path.getFileSystem(conf)&lt;/tt&gt; will always return the checksummed version. So using &lt;tt&gt;fs.makeQualified(path)&lt;/tt&gt; in these wrapper functions fails to preserve the user&apos;s choice of file system when they explicitly want the non-checksummed version.&lt;/p&gt;

&lt;p&gt;What do you mean by &quot;an option that isn&apos;t forward compatible&quot;? Are you referring to the FileSystem API going out of style in favor of FileContext?&lt;/p&gt;</comment>
                            <comment id="12978919" author="owen.omalley" created="Fri, 7 Jan 2011 19:02:03 +0000"  >&lt;p&gt;But the point is that we are moving away from FileSystem and it particular are pulling it out of interfaces. As we move to FileContext, we don&apos;t want to have to change all of the public interfaces. Even before FileContext, we have been ignoring FileSystem parameters in most of the MapReduce APIs.&lt;/p&gt;

&lt;p&gt;Moving forward, we should just use paths. Using FileSystem and path is a very confusing pattern.&lt;/p&gt;

&lt;p&gt;You do have a valid point that we can&apos;t distinguish between checksum and raw filesystems. I suspect the fix for that is to define a new prefix for one of them.&lt;/p&gt;</comment>
                            <comment id="12978940" author="tlipcon" created="Fri, 7 Jan 2011 20:12:02 +0000"  >&lt;p&gt;So would you be OK with this patch if I change the filesystem Option to be private, marked for removal when the createWriter methods are gone?&lt;/p&gt;</comment>
                            <comment id="12979032" author="owen.omalley" created="Sat, 8 Jan 2011 00:23:30 +0000"  >&lt;p&gt;Why not just do:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; createWriter(conf, Writer.file(name.makeQualified(fs)), Writer.keyClass(keyClass),
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;then all of the code will be removed when the deprecated constructors are removed. We won&apos;t need to worry about the private FileSystem option being forgotten.&lt;/p&gt;</comment>
                            <comment id="12979049" author="tlipcon" created="Sat, 8 Jan 2011 01:05:28 +0000"  >&lt;p&gt;Like I said, this breaks the RawLocalFileSystem vs ChecksumLocalFileSystem distinction which is a very big performance difference. Sure, some day, we want to fix that, but this patch is currently a regression from previous behavior and also breaking the MR trunk build, so I don&apos;t think we should block it on fixing the URI schemes of Raw vs Checksum FS.&lt;/p&gt;</comment>
                            <comment id="12979650" author="owen.omalley" created="Mon, 10 Jan 2011 17:11:55 +0000"  >&lt;p&gt;I&apos;ve never seen user code actually write a SequenceFile to the RawLocalFileSystem, so the performance loss would only effect unit tests. &lt;b&gt;smile&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;It seems much better to leave the compatibility code in the deprecated methods rather than pushing it into mainline code. To make it worse, it would be good to remove the internal use of FileSystem all together to ensure that FileContext is working well. I think it would be wise to minimize the amount of new code using it.&lt;/p&gt;</comment>
                            <comment id="12979664" author="tlipcon" created="Mon, 10 Jan 2011 17:47:14 +0000"  >&lt;p&gt;What about also marking the FileSystem Option both private and @deprecated then?&lt;/p&gt;

&lt;p&gt;I&apos;m 100% in agreement we should move our internal usage to FileContext, but that&apos;s way outside the scope of this bug.&lt;/p&gt;</comment>
                            <comment id="12979688" author="nidaley" created="Mon, 10 Jan 2011 19:06:29 +0000"  >&lt;p&gt;Given it looks like &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-6856&quot; title=&quot;SequenceFile and MapFile need cleanup to remove redundant constructors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-6856&quot;&gt;&lt;del&gt;HADOOP-6856&lt;/del&gt;&lt;/a&gt; changed the semantics of a public API (no matter how insignificant you think that incompatibility might be) then either that incompatibility should be reverted or this should be a blocker.  Marking it as such for now.&lt;/p&gt;</comment>
                            <comment id="12979798" author="owen.omalley" created="Mon, 10 Jan 2011 22:10:29 +0000"  >&lt;blockquote&gt;
&lt;p&gt;What about also marking the FileSystem Option both private and @deprecated then?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Please also include documentation in the Javadoc about it only being used for backwards compatibility. I still think the other solution is better, less code, and introduces less noise, but it does introduce a slight incompatibility. &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;I&apos;m 100% in agreement we should move our internal usage to FileContext, but that&apos;s way outside the scope of this bug.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I wasn&apos;t asking you too, just pointing out that eventual migration away from FileSystem means introducing new APIs with FileSystem parameters is increasing the technical debt.&lt;/p&gt;</comment>
                            <comment id="12979881" author="tlipcon" created="Tue, 11 Jan 2011 00:55:42 +0000"  >&lt;p&gt;New version of the patch makes the filesystem Option private, removes it from the public options in the util package, and marks it deprecated both by javadoc and annotations.&lt;/p&gt;</comment>
                            <comment id="12979895" author="hadoopqa" created="Tue, 11 Jan 2011 01:16:13 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12467945/hadoop-7087.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12467945/hadoop-7087.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1056006.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    -1 javac.  The applied patch generated 1049 javac compiler warnings (more than the trunk&apos;s current 1048 warnings).&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;    +1 system test framework.  The patch passed system test framework compile.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/167//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/167//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/167//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/167//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/167//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/167//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12980190" author="owen.omalley" created="Tue, 11 Jan 2011 17:15:23 +0000"  >&lt;p&gt;+1, although I don&apos;t see what the javadoc warning is coming from.&lt;/p&gt;</comment>
                            <comment id="12980221" author="tlipcon" created="Tue, 11 Jan 2011 18:14:01 +0000"  >&lt;p&gt;I think the new 1 warning is the test case calling the deprecated createWriter API. Will commit shortly.&lt;/p&gt;</comment>
                            <comment id="12980638" author="hudson" created="Wed, 12 Jan 2011 09:44:21 +0000"  >&lt;p&gt;Integrated in Hadoop-Common-22-branch #13 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Hadoop-Common-22-branch/13/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Hadoop-Common-22-branch/13/&lt;/a&gt;)&lt;/p&gt;
</comment>
                            <comment id="12980664" author="hudson" created="Wed, 12 Jan 2011 11:14:04 +0000"  >&lt;p&gt;Integrated in Hadoop-Common-trunk #574 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Hadoop-Common-trunk/574/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Hadoop-Common-trunk/574/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-7087&quot; title=&quot;SequenceFile.createWriter ignores FileSystem parameter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-7087&quot;&gt;&lt;del&gt;HADOOP-7087&lt;/del&gt;&lt;/a&gt;. SequenceFile.createWriter ignores FileSystem parameter. Contributed by Todd Lipcon&lt;/p&gt;</comment>
                            <comment id="12983573" author="hudson" created="Wed, 19 Jan 2011 07:13:28 +0000"  >&lt;p&gt;Integrated in Hadoop-Common-trunk-Commit #479 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Hadoop-Common-trunk-Commit/479/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Hadoop-Common-trunk-Commit/479/&lt;/a&gt;)&lt;/p&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12468937">HADOOP-6856</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12476995">MAPREDUCE-2121</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12467945" name="hadoop-7087.txt" size="8070" author="tlipcon" created="Tue, 11 Jan 2011 00:55:42 +0000"/>
                            <attachment id="12467603" name="hadoop-7087.txt" size="8640" author="tlipcon" created="Thu, 6 Jan 2011 01:41:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>77553</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 44 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i09kn3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>53777</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>