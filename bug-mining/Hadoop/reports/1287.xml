<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:45:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HADOOP-9989] Bug introduced in HADOOP-9374, which parses the -tokenCacheFile as binary file but set it to the configuration as JSON file.</title>
                <link>https://issues.apache.org/jira/browse/HADOOP-9989</link>
                <project id="12310240" key="HADOOP">Hadoop Common</project>
                    <description>&lt;p&gt;The code in JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9374&quot; title=&quot;Add tokens from -tokenCacheFile into UGI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9374&quot;&gt;&lt;del&gt;HADOOP-9374&lt;/del&gt;&lt;/a&gt;&apos;s patch introduced a bug, where the value of the &lt;br/&gt;
tokenCacheFile parameter is being parsed as a binary file and set it to the&lt;br/&gt;
mapreduce.job.credentials.json parameter in GenericOptionsParser, which cannot be parsed by JobSubmitter when it gets the value.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Red Hat Enterprise 6 with Sun Java 1.7 and IBM Java 1.6&lt;/p&gt;</environment>
        <key id="12669768">HADOOP-9989</key>
            <summary>Bug introduced in HADOOP-9374, which parses the -tokenCacheFile as binary file but set it to the configuration as JSON file.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zxu">Zhihai Xu</assignee>
                                    <reporter username="jwang302">Jinghui Wang</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 Sep 2013 22:54:34 +0000</created>
                <updated>Wed, 11 Feb 2015 12:07:12 +0000</updated>
                            <resolved>Wed, 10 Sep 2014 05:28:20 +0000</resolved>
                                    <version>2.1.0-beta</version>
                                    <fixVersion>2.6.0</fixVersion>
                                    <component>security</component>
                    <component>util</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                    <workratio workratioPercent="0"/>
                                                                    <timeoriginalestimate seconds="0">0h</timeoriginalestimate>
                            <timeestimate seconds="0">0h</timeestimate>
                                        <comments>
                            <comment id="13773565" author="jwang302" created="Fri, 20 Sep 2013 22:55:50 +0000"  >&lt;p&gt;Based on how JobSubmitter process the value of the mapreduce.job.credentials.json key, the tokenCacheFile passed in with the command line should be a JSON file, which makes sense as the GenericOptionsParser reads the value of this file and set it to the mapreduce.job.credentials.json in the configuration originally. Attached patch is based on the assumption that the tokenCacheFile is a JSON file.&lt;/p&gt;</comment>
                            <comment id="13850184" author="liusheng" created="Tue, 17 Dec 2013 06:46:32 +0000"  >&lt;p&gt;+1 I have the same issue, mrv1 in CDH also needs &quot;mapreduce.job.credentials.json&quot; be a json file&lt;/p&gt;</comment>
                            <comment id="13939394" author="daryn" created="Tue, 18 Mar 2014 15:40:15 +0000"  >&lt;p&gt;A polite -1.  We have use cases where fetchdt is used to create a token cache file that will be used in conjunction with -tokenCacheFile.  We might consider something like using the file suffix to determine if it&apos;s json.&lt;/p&gt;

&lt;p&gt;Out of curiosity, what generates a json token cache file?&lt;/p&gt;</comment>
                            <comment id="14112608" author="zxu" created="Wed, 27 Aug 2014 18:34:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daryn&quot; class=&quot;user-hover&quot; rel=&quot;daryn&quot;&gt;daryn&lt;/a&gt; I think there is another way to fix this problem using &quot;mapreduce.job.credentials.binary&quot; instead of &quot;mapreduce.job.credentials.json&quot; for &lt;br/&gt;
 -tokenCacheFile in the following code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;     UserGroupInformation.getCurrentUser().addCredentials(
          Credentials.readTokenStorageFile(p, conf));
      conf.set(&lt;span class=&quot;code-quote&quot;&gt;&quot;mapreduce.job.credentials.json&quot;&lt;/span&gt;, p.toString(),
               &lt;span class=&quot;code-quote&quot;&gt;&quot;from -tokenCacheFile command line option&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Currently the -tokenCacheFile option is broken for both MapReduce MR2 and MR1:&lt;br/&gt;
The following code in JobSubmitter.java will parse the file from  -tokenCacheFile as JSON file not as binary file.&lt;br/&gt;
But Credentials.readTokenStorageFile(p, conf) will expect it as binary file not  JSON file.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; tokensFileName = conf.get(&lt;span class=&quot;code-quote&quot;&gt;&quot;mapreduce.job.credentials.json&quot;&lt;/span&gt;);
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(tokensFileName != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
      LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;loading user&apos;s secret keys from &quot;&lt;/span&gt; + tokensFileName);
      &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; localFileName = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(tokensFileName).toUri().getPath();

      &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; json_error = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
      &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
        &lt;span class=&quot;code-comment&quot;&gt;// read JSON
&lt;/span&gt;        ObjectMapper mapper = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ObjectMapper();
        Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; nm = 
          mapper.readValue(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(localFileName), Map.class);

        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;(Map.Entry&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; ent: nm.entrySet()) {
          credentials.addSecretKey(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Text(ent.getKey()), ent.getValue()
              .getBytes(Charsets.UTF_8));
        }
      } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (JsonMappingException e) {
        json_error = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
      } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (JsonParseException e) {
        json_error = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
      }
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(json_error)
        LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;couldn&apos;t parse Token Cache JSON file with user secret keys&quot;&lt;/span&gt;);
    }
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14113177" author="zxu" created="Thu, 28 Aug 2014 01:29:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daryn&quot; class=&quot;user-hover&quot; rel=&quot;daryn&quot;&gt;daryn&lt;/a&gt; Are you OK with the second solution, I uploaded a patch &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9989&quot; title=&quot;Bug introduced in HADOOP-9374, which parses the -tokenCacheFile as binary file but set it to the configuration as JSON file.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9989&quot;&gt;&lt;del&gt;HADOOP-9989&lt;/del&gt;&lt;/a&gt;.001.patch&quot; for this&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; UserGroupInformation.getCurrentUser().addCredentials(
          Credentials.readTokenStorageFile(p, conf));
      conf.set(&lt;span class=&quot;code-quote&quot;&gt;&quot;mapreduce.job.credentials.binary&quot;&lt;/span&gt;, p.toString(),
               &lt;span class=&quot;code-quote&quot;&gt;&quot;from -tokenCacheFile command line option&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think use binary file for -tokenCacheFile option is good, because most other hadoop token related command use binary file.&lt;br/&gt;
For example: hadoop fetchdt (hdfs fetchdt --renew).&lt;/p&gt;</comment>
                            <comment id="14113217" author="hadoopqa" created="Thu, 28 Aug 2014 02:10:17 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12664793/HADOOP-9989.001.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12664793/HADOOP-9989.001.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 1 new or modified test files.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  There were no new javadoc warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 eclipse:eclipse&lt;/font&gt;.  The patch built with eclipse:eclipse.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests in hadoop-common-project/hadoop-common:&lt;/p&gt;

&lt;p&gt;                  org.apache.hadoop.security.token.delegation.web.TestWebDelegationToken&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 contrib tests&lt;/font&gt;.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/4560//testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/4560//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HADOOP-Build/4560//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HADOOP-Build/4560//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14113361" author="zxu" created="Thu, 28 Aug 2014 05:32:38 +0000"  >&lt;p&gt;The test failure is not related to this change:&lt;/p&gt;

&lt;p&gt;Running org.apache.hadoop.security.token.delegation.web.TestWebDelegationToken&lt;br/&gt;
Tests run: 9, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 7.193 sec &amp;lt;&amp;lt;&amp;lt; FAILURE! - in org.apache.hadoop.security.token.delegation.web.TestWebDelegationToken&lt;br/&gt;
testDelegationTokenAuthenticationURLWithNoDTFilter(org.apache.hadoop.security.token.delegation.web.TestWebDelegationToken)  Time elapsed: 0.152 sec  &amp;lt;&amp;lt;&amp;lt; ERROR!&lt;br/&gt;
java.net.BindException: Address already in use&lt;/p&gt;

&lt;p&gt;The test is passed in my local build.&lt;br/&gt;
-------------------------------------------------------&lt;br/&gt;
 T E S T S&lt;br/&gt;
-------------------------------------------------------&lt;br/&gt;
Running org.apache.hadoop.security.token.delegation.web.TestWebDelegationToken&lt;br/&gt;
Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 6.528 sec - in org.apache.hadoop.security.token.delegation.web.TestWebDelegationToken&lt;/p&gt;

&lt;p&gt;Results :&lt;/p&gt;

&lt;p&gt;Tests run: 9, Failures: 0, Errors: 0, Skipped: 0&lt;/p&gt;</comment>
                            <comment id="14127174" author="daryn" created="Tue, 9 Sep 2014 16:20:03 +0000"  >&lt;p&gt;I&apos;m ok with the current patch but I&apos;m not sure if setting the conf is even necessary.  This is common code that contains a reference to a mapreduce conf key which I believe is a relic.  MR passes tokens in the UGI context during job submission which is why the prior line is reading the credentials from the cmdline option into the UGI.  If you&apos;ve found other references outside of job submission, or feel it&apos;s too risky, the current patch is ok.&lt;/p&gt;
</comment>
                            <comment id="14127528" author="zxu" created="Tue, 9 Sep 2014 20:46:57 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daryn&quot; class=&quot;user-hover&quot; rel=&quot;daryn&quot;&gt;daryn&lt;/a&gt;, thanks for agreeing to my patch(&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9989&quot; title=&quot;Bug introduced in HADOOP-9374, which parses the -tokenCacheFile as binary file but set it to the configuration as JSON file.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9989&quot;&gt;&lt;del&gt;HADOOP-9989&lt;/del&gt;&lt;/a&gt;.001.patch).&lt;br/&gt;
It will be safe to keep the mapreduce configuration which will be save in JobContextImpl.credentials by JobSubmitter.java.&lt;br/&gt;
tnanks&lt;br/&gt;
zhihai&lt;/p&gt;</comment>
                            <comment id="14127608" author="tucu00" created="Tue, 9 Sep 2014 21:43:22 +0000"  >&lt;p&gt;After poking Zhiahi offline for a bit on this I think I understand the whole story here. My concern was that this would be an incompatible change, but it is safe to change from json to binary the property because MR submitter code handles both.&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14128085" author="tucu00" created="Wed, 10 Sep 2014 05:28:20 +0000"  >&lt;p&gt;Thanks Zhihai and Daryn for reviewing it. &lt;/p&gt;

&lt;p&gt;Committed to trunk and branch-2.&lt;/p&gt;</comment>
                            <comment id="14128360" author="hudson" created="Wed, 10 Sep 2014 11:23:33 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Yarn-trunk #676 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Yarn-trunk/676/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Yarn-trunk/676/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9989&quot; title=&quot;Bug introduced in HADOOP-9374, which parses the -tokenCacheFile as binary file but set it to the configuration as JSON file.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9989&quot;&gt;&lt;del&gt;HADOOP-9989&lt;/del&gt;&lt;/a&gt;. Bug introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9374&quot; title=&quot;Add tokens from -tokenCacheFile into UGI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9374&quot;&gt;&lt;del&gt;HADOOP-9374&lt;/del&gt;&lt;/a&gt;, which parses the -tokenCacheFile as binary file but set it to the configuration as JSON file. (zxu via tucu) (tucu: rev b100949404843ed245ef4e118291f55b3fdc81b8)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/GenericOptionsParser.java&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/util/TestGenericOptionsParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14128497" author="hudson" created="Wed, 10 Sep 2014 14:04:17 +0000"  >&lt;p&gt;SUCCESS: Integrated in Hadoop-Hdfs-trunk #1867 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1867/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Hdfs-trunk/1867/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9989&quot; title=&quot;Bug introduced in HADOOP-9374, which parses the -tokenCacheFile as binary file but set it to the configuration as JSON file.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9989&quot;&gt;&lt;del&gt;HADOOP-9989&lt;/del&gt;&lt;/a&gt;. Bug introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9374&quot; title=&quot;Add tokens from -tokenCacheFile into UGI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9374&quot;&gt;&lt;del&gt;HADOOP-9374&lt;/del&gt;&lt;/a&gt;, which parses the -tokenCacheFile as binary file but set it to the configuration as JSON file. (zxu via tucu) (tucu: rev b100949404843ed245ef4e118291f55b3fdc81b8)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/GenericOptionsParser.java&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/util/TestGenericOptionsParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14128918" author="hudson" created="Wed, 10 Sep 2014 18:45:36 +0000"  >&lt;p&gt;FAILURE: Integrated in Hadoop-Mapreduce-trunk #1892 (See &lt;a href=&quot;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1892/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1892/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9989&quot; title=&quot;Bug introduced in HADOOP-9374, which parses the -tokenCacheFile as binary file but set it to the configuration as JSON file.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9989&quot;&gt;&lt;del&gt;HADOOP-9989&lt;/del&gt;&lt;/a&gt;. Bug introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9374&quot; title=&quot;Add tokens from -tokenCacheFile into UGI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9374&quot;&gt;&lt;del&gt;HADOOP-9374&lt;/del&gt;&lt;/a&gt;, which parses the -tokenCacheFile as binary file but set it to the configuration as JSON file. (zxu via tucu) (tucu: rev b100949404843ed245ef4e118291f55b3fdc81b8)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/GenericOptionsParser.java&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/util/TestGenericOptionsParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14129474" author="zxu" created="Thu, 11 Sep 2014 01:22:43 +0000"  >&lt;p&gt;Thanks a lot &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tucu00&quot; class=&quot;user-hover&quot; rel=&quot;tucu00&quot;&gt;tucu00&lt;/a&gt;&lt;br/&gt;
Many thanks to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daryn&quot; class=&quot;user-hover&quot; rel=&quot;daryn&quot;&gt;daryn&lt;/a&gt; for the review and comments.&lt;/p&gt;</comment>
                            <comment id="14131747" author="zxu" created="Fri, 12 Sep 2014 17:01:10 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tucu00&quot; class=&quot;user-hover&quot; rel=&quot;tucu00&quot;&gt;tucu00&lt;/a&gt;, I just found out the &quot;mapreduce.job.credentials.binary&quot; configuration parameter need a path name without URI Scheme. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; binaryTokenFilename =
      conf.get(&lt;span class=&quot;code-quote&quot;&gt;&quot;mapreduce.job.credentials.binary&quot;&lt;/span&gt;);
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (binaryTokenFilename != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
      Credentials binary = Credentials.readTokenStorageFile(
          &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;file:&lt;span class=&quot;code-comment&quot;&gt;///&quot;&lt;/span&gt; + binaryTokenFilename), conf);
&lt;/span&gt;      credentials.addAll(binary);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;the MR will add scheme &quot;file:///&quot; to the parameter,&lt;br/&gt;
I update a new patch &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9989&quot; title=&quot;Bug introduced in HADOOP-9374, which parses the -tokenCacheFile as binary file but set it to the configuration as JSON file.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9989&quot;&gt;&lt;del&gt;HADOOP-9989&lt;/del&gt;&lt;/a&gt;.addendum0.patch to fix this issue:&lt;br/&gt;
use p.toUri().getPath() to remove the URI Scheme.&lt;br/&gt;
Please review it.&lt;br/&gt;
thanks&lt;br/&gt;
zhihai&lt;/p&gt;</comment>
                            <comment id="14131775" author="tucu00" created="Fri, 12 Sep 2014 17:24:36 +0000"  >&lt;p&gt;Zhihai,&lt;/p&gt;

&lt;p&gt;Please open a new JIRA to handle all URIs properly. Also, it would be great if we can test all possible URIs work: absolute and relative URIs, if the code is prepending &quot;file://&apos;, we should convert the URIs to absolute (and the prepending should use 2 &apos;/&apos;, not 3).&lt;/p&gt;</comment>
                            <comment id="14131776" author="tucu00" created="Fri, 12 Sep 2014 17:25:14 +0000"  >&lt;p&gt;also, is possible to use non-local FS URIs?  if so, then the code does not handle that currently, right?&lt;/p&gt;</comment>
                            <comment id="14131839" author="zxu" created="Fri, 12 Sep 2014 18:01:39 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Alejandro+Abdelnur&quot; class=&quot;user-hover&quot; rel=&quot;Alejandro Abdelnur&quot;&gt;Alejandro Abdelnur&lt;/a&gt;, That is a good question. It is not possible to use non-local FS URIs in &quot;-tokenCacheFile&quot; option parameter&lt;br/&gt;
The current code in GenericOptionsParser.java  will always suppose the &quot;-tokenCacheFile&quot; option parameter is local file, &lt;br/&gt;
otherwise It will throw an exception at &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;      FileSystem localFs = FileSystem.getLocal(conf);
      Path p = localFs.makeQualified(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(fileName));
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!localFs.exists(p)) {
          &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileNotFoundException(&lt;span class=&quot;code-quote&quot;&gt;&quot;File &quot;&lt;/span&gt;+fileName+&lt;span class=&quot;code-quote&quot;&gt;&quot; does not exist.&quot;&lt;/span&gt;);
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;You gave a good suggestion to change  &quot;mapreduce.job.credentials.binary&quot; configuration to support all path format absolute and relative URIs.&lt;br/&gt;
I will create a separate JIRAs for this and I will also test all possible path name.&lt;/p&gt;

&lt;p&gt;And also if we want to support non-local FS URIs in &quot;-tokenCacheFile&quot; option parameter, we can change  &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!localFs.exists(p)) {
          &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileNotFoundException(&lt;span class=&quot;code-quote&quot;&gt;&quot;File &quot;&lt;/span&gt;+fileName+&lt;span class=&quot;code-quote&quot;&gt;&quot; does not exist.&quot;&lt;/span&gt;);
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!p.getFileSystem(conf).exists(p)) {
          &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileNotFoundException(&lt;span class=&quot;code-quote&quot;&gt;&quot;File &quot;&lt;/span&gt;+fileName+&lt;span class=&quot;code-quote&quot;&gt;&quot; does not exist.&quot;&lt;/span&gt;);
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14131937" author="zxu" created="Fri, 12 Sep 2014 18:55:34 +0000"  >&lt;p&gt;I created a JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-6086&quot; title=&quot;mapreduce.job.credentials.binary should allow all URIs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-6086&quot;&gt;&lt;del&gt;MAPREDUCE-6086&lt;/del&gt;&lt;/a&gt; to handle all URIs properly in &quot;mapreduce.job.credentials.binary&quot; configuration&lt;/p&gt;</comment>
                            <comment id="14132447" author="zxu" created="Sat, 13 Sep 2014 01:33:50 +0000"  >&lt;p&gt;I uploaded a patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-6086&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;MAPREDUCE-6086 &lt;/a&gt;. With &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12668484/MAPREDUCE-6086.000.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;that patch &lt;/a&gt;, we don&apos;t need this addendum patch (&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9989&quot; title=&quot;Bug introduced in HADOOP-9374, which parses the -tokenCacheFile as binary file but set it to the configuration as JSON file.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9989&quot;&gt;&lt;del&gt;HADOOP-9989&lt;/del&gt;&lt;/a&gt;.addendum0.patch).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12635661">HADOOP-9374</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12664793" name="HADOOP-9989.001.patch" size="1745" author="zxu" created="Thu, 28 Aug 2014 01:18:15 +0000"/>
                            <attachment id="12668381" name="HADOOP-9989.addendum0.patch" size="1825" author="zxu" created="Fri, 12 Sep 2014 16:53:34 +0000"/>
                            <attachment id="12604334" name="HADOOP-9989.patch" size="6344" author="jwang302" created="Fri, 20 Sep 2013 22:56:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>349696</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 10 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1oapj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>349994</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12325254">2.3.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>