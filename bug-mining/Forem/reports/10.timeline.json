[{"url":"https://api.github.com/repos/forem/forem/issues/comments/912460990","html_url":"https://github.com/forem/forem/issues/14664#issuecomment-912460990","issue_url":"https://api.github.com/repos/forem/forem/issues/14664","id":912460990,"node_id":"IC_kwDOBGPKJs42Ywy-","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2021-09-03T11:15:47Z","updated_at":"2021-09-03T11:15:47Z","body":"Thanks for the issue, we will take it into consideration! Our team of engineers is busy working on many types of features, please give us time to get back to you.\n\nFeature requests that require more discussion may be closed. Read more about our [feature request process](https://forem.dev/foremteam/internal-rfc-process-and-forem-dev-discussions-3gl4) on forem.dev.\n\nTo our amazing contributors: issues labeled `type: bug` are always up for grabs, but for feature requests, please wait until we add a `ready for dev` before starting to work on it.\n\nTo claim an issue to work on, please leave a comment. If you've claimed the issue and need help, please ping @forem/oss. The OSS Community Manager or the engineers on OSS rotation will follow up.\n\nFor full info on how to contribute, please check out our [contributors guide](https://github.com/forem/forem/blob/main/CONTRIBUTING.md).","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/forem/forem/issues/comments/912460990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false}},{"actor":{"login":"akhil-naidu","id":11688537,"node_id":"MDQ6VXNlcjExNjg4NTM3","avatar_url":"https://avatars.githubusercontent.com/u/11688537?v=4","gravatar_id":"","url":"https://api.github.com/users/akhil-naidu","html_url":"https://github.com/akhil-naidu","followers_url":"https://api.github.com/users/akhil-naidu/followers","following_url":"https://api.github.com/users/akhil-naidu/following{/other_user}","gists_url":"https://api.github.com/users/akhil-naidu/gists{/gist_id}","starred_url":"https://api.github.com/users/akhil-naidu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akhil-naidu/subscriptions","organizations_url":"https://api.github.com/users/akhil-naidu/orgs","repos_url":"https://api.github.com/users/akhil-naidu/repos","events_url":"https://api.github.com/users/akhil-naidu/events{/privacy}","received_events_url":"https://api.github.com/users/akhil-naidu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-03T11:23:20Z","updated_at":"2021-09-03T11:23:20Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/leewardslope/t2d-ui/issues/28","repository_url":"https://api.github.com/repos/leewardslope/t2d-ui","labels_url":"https://api.github.com/repos/leewardslope/t2d-ui/issues/28/labels{/name}","comments_url":"https://api.github.com/repos/leewardslope/t2d-ui/issues/28/comments","events_url":"https://api.github.com/repos/leewardslope/t2d-ui/issues/28/events","html_url":"https://github.com/leewardslope/t2d-ui/pull/28","id":986747362,"node_id":"MDExOlB1bGxSZXF1ZXN0NzI1OTIzODI3","number":28,"title":"Forem Installation via Ansible","user":{"login":"akhil-naidu","id":11688537,"node_id":"MDQ6VXNlcjExNjg4NTM3","avatar_url":"https://avatars.githubusercontent.com/u/11688537?v=4","gravatar_id":"","url":"https://api.github.com/users/akhil-naidu","html_url":"https://github.com/akhil-naidu","followers_url":"https://api.github.com/users/akhil-naidu/followers","following_url":"https://api.github.com/users/akhil-naidu/following{/other_user}","gists_url":"https://api.github.com/users/akhil-naidu/gists{/gist_id}","starred_url":"https://api.github.com/users/akhil-naidu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akhil-naidu/subscriptions","organizations_url":"https://api.github.com/users/akhil-naidu/orgs","repos_url":"https://api.github.com/users/akhil-naidu/repos","events_url":"https://api.github.com/users/akhil-naidu/events{/privacy}","received_events_url":"https://api.github.com/users/akhil-naidu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2021-09-02T13:42:02Z","updated_at":"2021-09-03T17:14:29Z","closed_at":"2021-09-03T17:14:29Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":394953800,"node_id":"MDEwOlJlcG9zaXRvcnkzOTQ5NTM4MDA=","name":"t2d-ui","full_name":"leewardslope/t2d-ui","private":false,"owner":{"login":"leewardslope","id":58496339,"node_id":"MDEyOk9yZ2FuaXphdGlvbjU4NDk2MzM5","avatar_url":"https://avatars.githubusercontent.com/u/58496339?v=4","gravatar_id":"","url":"https://api.github.com/users/leewardslope","html_url":"https://github.com/leewardslope","followers_url":"https://api.github.com/users/leewardslope/followers","following_url":"https://api.github.com/users/leewardslope/following{/other_user}","gists_url":"https://api.github.com/users/leewardslope/gists{/gist_id}","starred_url":"https://api.github.com/users/leewardslope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leewardslope/subscriptions","organizations_url":"https://api.github.com/users/leewardslope/orgs","repos_url":"https://api.github.com/users/leewardslope/repos","events_url":"https://api.github.com/users/leewardslope/events{/privacy}","received_events_url":"https://api.github.com/users/leewardslope/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/leewardslope/t2d-ui","description":"Web UI for Dokku","fork":false,"url":"https://api.github.com/repos/leewardslope/t2d-ui","forks_url":"https://api.github.com/repos/leewardslope/t2d-ui/forks","keys_url":"https://api.github.com/repos/leewardslope/t2d-ui/keys{/key_id}","collaborators_url":"https://api.github.com/repos/leewardslope/t2d-ui/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/leewardslope/t2d-ui/teams","hooks_url":"https://api.github.com/repos/leewardslope/t2d-ui/hooks","issue_events_url":"https://api.github.com/repos/leewardslope/t2d-ui/issues/events{/number}","events_url":"https://api.github.com/repos/leewardslope/t2d-ui/events","assignees_url":"https://api.github.com/repos/leewardslope/t2d-ui/assignees{/user}","branches_url":"https://api.github.com/repos/leewardslope/t2d-ui/branches{/branch}","tags_url":"https://api.github.com/repos/leewardslope/t2d-ui/tags","blobs_url":"https://api.github.com/repos/leewardslope/t2d-ui/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/leewardslope/t2d-ui/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/leewardslope/t2d-ui/git/refs{/sha}","trees_url":"https://api.github.com/repos/leewardslope/t2d-ui/git/trees{/sha}","statuses_url":"https://api.github.com/repos/leewardslope/t2d-ui/statuses/{sha}","languages_url":"https://api.github.com/repos/leewardslope/t2d-ui/languages","stargazers_url":"https://api.github.com/repos/leewardslope/t2d-ui/stargazers","contributors_url":"https://api.github.com/repos/leewardslope/t2d-ui/contributors","subscribers_url":"https://api.github.com/repos/leewardslope/t2d-ui/subscribers","subscription_url":"https://api.github.com/repos/leewardslope/t2d-ui/subscription","commits_url":"https://api.github.com/repos/leewardslope/t2d-ui/commits{/sha}","git_commits_url":"https://api.github.com/repos/leewardslope/t2d-ui/git/commits{/sha}","comments_url":"https://api.github.com/repos/leewardslope/t2d-ui/comments{/number}","issue_comment_url":"https://api.github.com/repos/leewardslope/t2d-ui/issues/comments{/number}","contents_url":"https://api.github.com/repos/leewardslope/t2d-ui/contents/{+path}","compare_url":"https://api.github.com/repos/leewardslope/t2d-ui/compare/{base}...{head}","merges_url":"https://api.github.com/repos/leewardslope/t2d-ui/merges","archive_url":"https://api.github.com/repos/leewardslope/t2d-ui/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/leewardslope/t2d-ui/downloads","issues_url":"https://api.github.com/repos/leewardslope/t2d-ui/issues{/number}","pulls_url":"https://api.github.com/repos/leewardslope/t2d-ui/pulls{/number}","milestones_url":"https://api.github.com/repos/leewardslope/t2d-ui/milestones{/number}","notifications_url":"https://api.github.com/repos/leewardslope/t2d-ui/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/leewardslope/t2d-ui/labels{/name}","releases_url":"https://api.github.com/repos/leewardslope/t2d-ui/releases{/id}","deployments_url":"https://api.github.com/repos/leewardslope/t2d-ui/deployments","created_at":"2021-08-11T10:42:23Z","updated_at":"2022-08-26T06:29:02Z","pushed_at":"2021-09-25T15:02:38Z","git_url":"git://github.com/leewardslope/t2d-ui.git","ssh_url":"git@github.com:leewardslope/t2d-ui.git","clone_url":"https://github.com/leewardslope/t2d-ui.git","svn_url":"https://github.com/leewardslope/t2d-ui","homepage":"https://selfhost.dev","size":10191,"stargazers_count":1,"watchers_count":1,"language":"JavaScript","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":4,"license":null,"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":4,"watchers":1,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/leewardslope/t2d-ui/pulls/28","html_url":"https://github.com/leewardslope/t2d-ui/pull/28","diff_url":"https://github.com/leewardslope/t2d-ui/pull/28.diff","patch_url":"https://github.com/leewardslope/t2d-ui/pull/28.patch","merged_at":"2021-09-03T17:14:29Z"},"body":"With this, both frontend and backend are linked for install Forem.\r\n\r\n### Limitations\r\n- Second-time build will fail because of clashing in app name (duplication) \r\n- Delete button will only delete the UI elements and not the real app\r\n- User should pre-configure his DNS (Build will fail and cannot rebuild)\r\n- User can only use one SSH key (in case of wrong details, need to create a new account)\r\n\r\n> Simply speaking, the installation process will only work if the user entered the correct details. In case of failure, everything should be started afresh, including the digital ocean droplet.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/leewardslope/t2d-ui/issues/28/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/leewardslope/t2d-ui/issues/28/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":5253717329,"node_id":"LE_lADOBGPKJs463pw0zwAAAAE5JV1R","url":"https://api.github.com/repos/forem/forem/issues/events/5253717329","actor":{"login":"djuber","id":1237369,"node_id":"MDQ6VXNlcjEyMzczNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1237369?v=4","gravatar_id":"","url":"https://api.github.com/users/djuber","html_url":"https://github.com/djuber","followers_url":"https://api.github.com/users/djuber/followers","following_url":"https://api.github.com/users/djuber/following{/other_user}","gists_url":"https://api.github.com/users/djuber/gists{/gist_id}","starred_url":"https://api.github.com/users/djuber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/djuber/subscriptions","organizations_url":"https://api.github.com/users/djuber/orgs","repos_url":"https://api.github.com/users/djuber/repos","events_url":"https://api.github.com/users/djuber/events{/privacy}","received_events_url":"https://api.github.com/users/djuber/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2021-09-03T14:03:33Z","label":{"name":"bug","color":"E99695"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/forem/forem/issues/comments/912565051","html_url":"https://github.com/forem/forem/issues/14664#issuecomment-912565051","issue_url":"https://api.github.com/repos/forem/forem/issues/14664","id":912565051,"node_id":"IC_kwDOBGPKJs42ZKM7","user":{"login":"djuber","id":1237369,"node_id":"MDQ6VXNlcjEyMzczNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1237369?v=4","gravatar_id":"","url":"https://api.github.com/users/djuber","html_url":"https://github.com/djuber","followers_url":"https://api.github.com/users/djuber/followers","following_url":"https://api.github.com/users/djuber/following{/other_user}","gists_url":"https://api.github.com/users/djuber/gists{/gist_id}","starred_url":"https://api.github.com/users/djuber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/djuber/subscriptions","organizations_url":"https://api.github.com/users/djuber/orgs","repos_url":"https://api.github.com/users/djuber/repos","events_url":"https://api.github.com/users/djuber/events{/privacy}","received_events_url":"https://api.github.com/users/djuber/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-03T14:04:18Z","updated_at":"2021-09-03T14:05:14Z","body":"I think this might have to do with the way ruby3 treats keyword arguments - [the code in question](https://github.com/forem/forem/blob/main/db/migrate/20200731033002_drop_user_optional_fields.rb) looks like this \r\n\r\n```ruby\r\n\r\n  INDEX = [:user_optional_fields, [:label, :user_id], unique: true].freeze\r\n  def up\r\n    drop_table :user_optional_fields\r\n\r\n    remove_index(*INDEX) if index_exists?(*INDEX)\r\n  end\r\n```\r\n\r\nThe remove index you're seeing the error raised on may be the issue - the last item in the array, {unique: true} is being seen as a positional argument rather than a keyword hash - this was [a change](https://www.ruby-lang.org/en/news/2019/12/12/separation-of-positional-and-keyword-arguments-in-ruby-3-0/) in ruby3's argument passing rules.\r\n\r\nThis wouldn't happen in an environment where you had already run this migration on ruby 2, then upgraded to ruby 3, but might happen on a clean deploy or if you dropped and recreated the db, then migrated.\r\n\r\nSmallest reproduction (raises the same error in development): \r\n\r\n```\r\nbundle exec rails db:drop\r\nRAILS_ENV=development bundle exec rails db:create\r\nRAILS_ENV=development bundle exec rails db:migrate\r\n\r\n== 20200731033002 DropUserOptionalFields: migrating ===========================\r\n-- drop_table(:user_optional_fields)\r\n   -> 0.0049s\r\n-- index_exists?(:user_optional_fields, [:label, :user_id], {:unique=>true})\r\nrails aborted!\r\nStandardError: An error has occurred, this and all later migrations canceled:\r\n\r\nwrong number of arguments (given 3, expected 2)\r\n/home/djuber/src/foremclean/vendor/cache/ruby/3.0.0/gems/activerecord-6.1.4.1/lib/active_record/connection_adapters/abstract/schema_statements.rb:99:in `index_exists?'\r\n```\r\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/forem/forem/issues/comments/912565051/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"djuber","id":1237369,"node_id":"MDQ6VXNlcjEyMzczNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1237369?v=4","gravatar_id":"","url":"https://api.github.com/users/djuber","html_url":"https://github.com/djuber","followers_url":"https://api.github.com/users/djuber/followers","following_url":"https://api.github.com/users/djuber/following{/other_user}","gists_url":"https://api.github.com/users/djuber/gists{/gist_id}","starred_url":"https://api.github.com/users/djuber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/djuber/subscriptions","organizations_url":"https://api.github.com/users/djuber/orgs","repos_url":"https://api.github.com/users/djuber/repos","events_url":"https://api.github.com/users/djuber/events{/privacy}","received_events_url":"https://api.github.com/users/djuber/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":5253797853,"node_id":"REFE_lADOBGPKJs463pw0zwAAAAE5Jpfd","url":"https://api.github.com/repos/forem/forem/issues/events/5253797853","actor":{"login":"djuber","id":1237369,"node_id":"MDQ6VXNlcjEyMzczNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1237369?v=4","gravatar_id":"","url":"https://api.github.com/users/djuber","html_url":"https://github.com/djuber","followers_url":"https://api.github.com/users/djuber/followers","following_url":"https://api.github.com/users/djuber/following{/other_user}","gists_url":"https://api.github.com/users/djuber/gists{/gist_id}","starred_url":"https://api.github.com/users/djuber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/djuber/subscriptions","organizations_url":"https://api.github.com/users/djuber/orgs","repos_url":"https://api.github.com/users/djuber/repos","events_url":"https://api.github.com/users/djuber/events{/privacy}","received_events_url":"https://api.github.com/users/djuber/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"adb9cafcd0baf11396c3eecb147ea4f6750c3887","commit_url":"https://api.github.com/repos/forem/forem/commits/adb9cafcd0baf11396c3eecb147ea4f6750c3887","created_at":"2021-09-03T14:18:07Z","performed_via_github_app":null},{"actor":{"login":"djuber","id":1237369,"node_id":"MDQ6VXNlcjEyMzczNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1237369?v=4","gravatar_id":"","url":"https://api.github.com/users/djuber","html_url":"https://github.com/djuber","followers_url":"https://api.github.com/users/djuber/followers","following_url":"https://api.github.com/users/djuber/following{/other_user}","gists_url":"https://api.github.com/users/djuber/gists{/gist_id}","starred_url":"https://api.github.com/users/djuber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/djuber/subscriptions","organizations_url":"https://api.github.com/users/djuber/orgs","repos_url":"https://api.github.com/users/djuber/repos","events_url":"https://api.github.com/users/djuber/events{/privacy}","received_events_url":"https://api.github.com/users/djuber/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-03T14:18:32Z","updated_at":"2021-09-03T14:18:32Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/forem/forem/issues/14666","repository_url":"https://api.github.com/repos/forem/forem","labels_url":"https://api.github.com/repos/forem/forem/issues/14666/labels{/name}","comments_url":"https://api.github.com/repos/forem/forem/issues/14666/comments","events_url":"https://api.github.com/repos/forem/forem/issues/14666/events","html_url":"https://github.com/forem/forem/pull/14666","id":987818108,"node_id":"MDExOlB1bGxSZXF1ZXN0NzI2ODQ5MzI5","number":14666,"title":"Replace splatted constant with its value","user":{"login":"djuber","id":1237369,"node_id":"MDQ6VXNlcjEyMzczNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1237369?v=4","gravatar_id":"","url":"https://api.github.com/users/djuber","html_url":"https://github.com/djuber","followers_url":"https://api.github.com/users/djuber/followers","following_url":"https://api.github.com/users/djuber/following{/other_user}","gists_url":"https://api.github.com/users/djuber/gists{/gist_id}","starred_url":"https://api.github.com/users/djuber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/djuber/subscriptions","organizations_url":"https://api.github.com/users/djuber/orgs","repos_url":"https://api.github.com/users/djuber/repos","events_url":"https://api.github.com/users/djuber/events{/privacy}","received_events_url":"https://api.github.com/users/djuber/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1123882148,"node_id":"MDU6TGFiZWwxMTIzODgyMTQ4","url":"https://api.github.com/repos/forem/forem/labels/PR:%20merged","name":"PR: merged","color":"6a737d","default":false,"description":"bot applied label for PR's that are merged"},{"id":2468119502,"node_id":"MDU6TGFiZWwyNDY4MTE5NTAy","url":"https://api.github.com/repos/forem/forem/labels/merge%20by%20any%20core","name":"merge by any core","color":"c91dd6","default":false,"description":"This tag is a signal that you are okay with any core team member merging your code for you."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-09-03T14:18:31Z","updated_at":"2022-07-06T22:21:38Z","closed_at":"2021-09-03T16:49:20Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":73648678,"node_id":"MDEwOlJlcG9zaXRvcnk3MzY0ODY3OA==","name":"forem","full_name":"forem/forem","private":false,"owner":{"login":"forem","id":65030610,"node_id":"MDEyOk9yZ2FuaXphdGlvbjY1MDMwNjEw","avatar_url":"https://avatars.githubusercontent.com/u/65030610?v=4","gravatar_id":"","url":"https://api.github.com/users/forem","html_url":"https://github.com/forem","followers_url":"https://api.github.com/users/forem/followers","following_url":"https://api.github.com/users/forem/following{/other_user}","gists_url":"https://api.github.com/users/forem/gists{/gist_id}","starred_url":"https://api.github.com/users/forem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/forem/subscriptions","organizations_url":"https://api.github.com/users/forem/orgs","repos_url":"https://api.github.com/users/forem/repos","events_url":"https://api.github.com/users/forem/events{/privacy}","received_events_url":"https://api.github.com/users/forem/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/forem/forem","description":"For empowering community ðŸŒ±","fork":false,"url":"https://api.github.com/repos/forem/forem","forks_url":"https://api.github.com/repos/forem/forem/forks","keys_url":"https://api.github.com/repos/forem/forem/keys{/key_id}","collaborators_url":"https://api.github.com/repos/forem/forem/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/forem/forem/teams","hooks_url":"https://api.github.com/repos/forem/forem/hooks","issue_events_url":"https://api.github.com/repos/forem/forem/issues/events{/number}","events_url":"https://api.github.com/repos/forem/forem/events","assignees_url":"https://api.github.com/repos/forem/forem/assignees{/user}","branches_url":"https://api.github.com/repos/forem/forem/branches{/branch}","tags_url":"https://api.github.com/repos/forem/forem/tags","blobs_url":"https://api.github.com/repos/forem/forem/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/forem/forem/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/forem/forem/git/refs{/sha}","trees_url":"https://api.github.com/repos/forem/forem/git/trees{/sha}","statuses_url":"https://api.github.com/repos/forem/forem/statuses/{sha}","languages_url":"https://api.github.com/repos/forem/forem/languages","stargazers_url":"https://api.github.com/repos/forem/forem/stargazers","contributors_url":"https://api.github.com/repos/forem/forem/contributors","subscribers_url":"https://api.github.com/repos/forem/forem/subscribers","subscription_url":"https://api.github.com/repos/forem/forem/subscription","commits_url":"https://api.github.com/repos/forem/forem/commits{/sha}","git_commits_url":"https://api.github.com/repos/forem/forem/git/commits{/sha}","comments_url":"https://api.github.com/repos/forem/forem/comments{/number}","issue_comment_url":"https://api.github.com/repos/forem/forem/issues/comments{/number}","contents_url":"https://api.github.com/repos/forem/forem/contents/{+path}","compare_url":"https://api.github.com/repos/forem/forem/compare/{base}...{head}","merges_url":"https://api.github.com/repos/forem/forem/merges","archive_url":"https://api.github.com/repos/forem/forem/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/forem/forem/downloads","issues_url":"https://api.github.com/repos/forem/forem/issues{/number}","pulls_url":"https://api.github.com/repos/forem/forem/pulls{/number}","milestones_url":"https://api.github.com/repos/forem/forem/milestones{/number}","notifications_url":"https://api.github.com/repos/forem/forem/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/forem/forem/labels{/name}","releases_url":"https://api.github.com/repos/forem/forem/releases{/id}","deployments_url":"https://api.github.com/repos/forem/forem/deployments","created_at":"2016-11-13T23:02:13Z","updated_at":"2025-11-10T03:30:54Z","pushed_at":"2025-11-08T23:08:51Z","git_url":"git://github.com/forem/forem.git","ssh_url":"git@github.com:forem/forem.git","clone_url":"https://github.com/forem/forem.git","svn_url":"https://github.com/forem/forem","homepage":"https://forem.com","size":1724987,"stargazers_count":22508,"watchers_count":22508,"language":"Ruby","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":4150,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":606,"license":{"key":"agpl-3.0","name":"GNU Affero General Public License v3.0","spdx_id":"AGPL-3.0","url":"https://api.github.com/licenses/agpl-3.0","node_id":"MDc6TGljZW5zZTE="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["community","discussion","feedback","hacktoberfest","open-source","rails","ruby"],"visibility":"public","forks":4150,"open_issues":606,"watchers":22508,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/forem/forem/pulls/14666","html_url":"https://github.com/forem/forem/pull/14666","diff_url":"https://github.com/forem/forem/pull/14666.diff","patch_url":"https://github.com/forem/forem/pull/14666.patch","merged_at":"2021-09-03T16:49:20Z"},"body":"\r\n## What type of PR is this? (check all applicable)\r\n\r\n- [ ] Refactor\r\n- [ ] Feature\r\n- [x] Bug Fix\r\n- [ ] Optimization\r\n- [ ] Documentation Update\r\n\r\n## Description\r\n\r\nA community member reported migrations failing when the following conditions were true\r\n- running ruby 3 \r\n- starting with a clean database, rather than from a db where migrations were already run under ruby 2\r\n\r\nI was able to replicate this by db:drop, db:create, db:migrate, and an error about the number of positional arguments passed to the [`:index_exists?`](https://apidock.com/rails/v6.1.3.1/ActiveRecord/ConnectionAdapters/SchemaStatements/index_exists%3F) method being 3, not 2, was seen.\r\n\r\nReplace the splatted constant for INDEX with its contents (making the code more repetitive and less clean, but functional) to avoid the ruby3 keyword splatting rules.\r\n\r\nThis was not observed in testing because we use db:schema:load (so migrations are not run in the test suite, only locally in a developer's environment, where almost everyone had started from ruby 2.7 or earlier when they ran this migration). \r\n\r\n## Related Tickets & Documents\r\n\r\nFixes #14664\r\n\r\n## QA Instructions, Screenshots, Recordings\r\n\r\nThis fails on main, passes on the branch:\r\n\r\n```\r\nbundle exec rails db:drop\r\nbundle exec rails db:create\r\nbundle exec rails db:migrate\r\n```\r\n\r\n### UI accessibility concerns?\r\n\r\nNone\r\n\r\n## Added/updated tests?\r\n\r\n- [ ] Yes\r\n- [x] No, and this is why: refactor existing migration\r\n- [ ] I need help with writing tests\r\n\r\n## [Forem core team only] How will this change be communicated?\r\n\r\n_Will this PR introduce a change that impacts Forem members or creators, the\r\ndevelopment process, or any of our internal teams? If so, please note how you\r\nwill share this change with the people who need to know about it._\r\n\r\n- [ ] I've updated the [Developer Docs](https://developers.forem.com) and/or\r\n      [Admin Guide](https://admin.forem.com/), or\r\n      [Storybook](https://storybook.forem.com/) (for Crayons components)\r\n- [ ] I've updated the README or added inline documentation\r\n- [ ] I've added an entry to\r\n      [`CHANGELOG.md`](https://github.com/forem/forem/tree/main/CHANGELOG.md)\r\n- [ ] I will share this change in a [Changelog](https://forem.dev/t/changelog)\r\n      or in a [forem.dev](http://forem.dev) post\r\n- [ ] I will share this change internally with the appropriate teams\r\n- [ ] I'm not sure how best to communicate this change and need help\r\n- [x] This change does not need to be communicated, and this is why not: bugfix\r\n\r\n## [optional] Are there any post deployment tasks we need to perform?\r\n\r\n## [optional] What gif best describes this PR or how it makes you feel?\r\n\r\n![keywords?](https://user-images.githubusercontent.com/1237369/132020996-14aab323-e844-4786-b572-24c97d82e135.png)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/forem/forem/issues/14666/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/forem/forem/issues/14666/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":5253837318,"node_id":"AE_lADOBGPKJs463pw0zwAAAAE5JzIG","url":"https://api.github.com/repos/forem/forem/issues/events/5253837318","actor":{"login":"djuber","id":1237369,"node_id":"MDQ6VXNlcjEyMzczNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1237369?v=4","gravatar_id":"","url":"https://api.github.com/users/djuber","html_url":"https://github.com/djuber","followers_url":"https://api.github.com/users/djuber/followers","following_url":"https://api.github.com/users/djuber/following{/other_user}","gists_url":"https://api.github.com/users/djuber/gists{/gist_id}","starred_url":"https://api.github.com/users/djuber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/djuber/subscriptions","organizations_url":"https://api.github.com/users/djuber/orgs","repos_url":"https://api.github.com/users/djuber/repos","events_url":"https://api.github.com/users/djuber/events{/privacy}","received_events_url":"https://api.github.com/users/djuber/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2021-09-03T14:25:15Z","assignee":{"login":"djuber","id":1237369,"node_id":"MDQ6VXNlcjEyMzczNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1237369?v=4","gravatar_id":"","url":"https://api.github.com/users/djuber","html_url":"https://github.com/djuber","followers_url":"https://api.github.com/users/djuber/followers","following_url":"https://api.github.com/users/djuber/following{/other_user}","gists_url":"https://api.github.com/users/djuber/gists{/gist_id}","starred_url":"https://api.github.com/users/djuber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/djuber/subscriptions","organizations_url":"https://api.github.com/users/djuber/orgs","repos_url":"https://api.github.com/users/djuber/repos","events_url":"https://api.github.com/users/djuber/events{/privacy}","received_events_url":"https://api.github.com/users/djuber/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"url":"https://api.github.com/repos/forem/forem/issues/comments/912589844","html_url":"https://github.com/forem/forem/issues/14664#issuecomment-912589844","issue_url":"https://api.github.com/repos/forem/forem/issues/14664","id":912589844,"node_id":"IC_kwDOBGPKJs42ZQQU","user":{"login":"djuber","id":1237369,"node_id":"MDQ6VXNlcjEyMzczNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1237369?v=4","gravatar_id":"","url":"https://api.github.com/users/djuber","html_url":"https://github.com/djuber","followers_url":"https://api.github.com/users/djuber/followers","following_url":"https://api.github.com/users/djuber/following{/other_user}","gists_url":"https://api.github.com/users/djuber/gists{/gist_id}","starred_url":"https://api.github.com/users/djuber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/djuber/subscriptions","organizations_url":"https://api.github.com/users/djuber/orgs","repos_url":"https://api.github.com/users/djuber/repos","events_url":"https://api.github.com/users/djuber/events{/privacy}","received_events_url":"https://api.github.com/users/djuber/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-03T14:39:43Z","updated_at":"2021-09-03T14:39:43Z","body":"Also, thank you so much @akhil-naidu for doing the (too often thankless) work of testing the possible scenarios to narrow this down. That made tracking this down, and validating my guess much faster.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/forem/forem/issues/comments/912589844/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"djuber","id":1237369,"node_id":"MDQ6VXNlcjEyMzczNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1237369?v=4","gravatar_id":"","url":"https://api.github.com/users/djuber","html_url":"https://github.com/djuber","followers_url":"https://api.github.com/users/djuber/followers","following_url":"https://api.github.com/users/djuber/following{/other_user}","gists_url":"https://api.github.com/users/djuber/gists{/gist_id}","starred_url":"https://api.github.com/users/djuber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/djuber/subscriptions","organizations_url":"https://api.github.com/users/djuber/orgs","repos_url":"https://api.github.com/users/djuber/repos","events_url":"https://api.github.com/users/djuber/events{/privacy}","received_events_url":"https://api.github.com/users/djuber/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":5253915495,"node_id":"MEE_lADOBGPKJs463pw0zwAAAAE5KGNn","url":"https://api.github.com/repos/forem/forem/issues/events/5253915495","actor":{"login":"akhil-naidu","id":11688537,"node_id":"MDQ6VXNlcjExNjg4NTM3","avatar_url":"https://avatars.githubusercontent.com/u/11688537?v=4","gravatar_id":"","url":"https://api.github.com/users/akhil-naidu","html_url":"https://github.com/akhil-naidu","followers_url":"https://api.github.com/users/akhil-naidu/followers","following_url":"https://api.github.com/users/akhil-naidu/following{/other_user}","gists_url":"https://api.github.com/users/akhil-naidu/gists{/gist_id}","starred_url":"https://api.github.com/users/akhil-naidu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akhil-naidu/subscriptions","organizations_url":"https://api.github.com/users/akhil-naidu/orgs","repos_url":"https://api.github.com/users/akhil-naidu/repos","events_url":"https://api.github.com/users/akhil-naidu/events{/privacy}","received_events_url":"https://api.github.com/users/akhil-naidu/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-09-03T14:39:44Z","performed_via_github_app":null},{"id":5253915499,"node_id":"SE_lADOBGPKJs463pw0zwAAAAE5KGNr","url":"https://api.github.com/repos/forem/forem/issues/events/5253915499","actor":{"login":"akhil-naidu","id":11688537,"node_id":"MDQ6VXNlcjExNjg4NTM3","avatar_url":"https://avatars.githubusercontent.com/u/11688537?v=4","gravatar_id":"","url":"https://api.github.com/users/akhil-naidu","html_url":"https://github.com/akhil-naidu","followers_url":"https://api.github.com/users/akhil-naidu/followers","following_url":"https://api.github.com/users/akhil-naidu/following{/other_user}","gists_url":"https://api.github.com/users/akhil-naidu/gists{/gist_id}","starred_url":"https://api.github.com/users/akhil-naidu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akhil-naidu/subscriptions","organizations_url":"https://api.github.com/users/akhil-naidu/orgs","repos_url":"https://api.github.com/users/akhil-naidu/repos","events_url":"https://api.github.com/users/akhil-naidu/events{/privacy}","received_events_url":"https://api.github.com/users/akhil-naidu/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-09-03T14:39:44Z","performed_via_github_app":null},{"id":5254576800,"node_id":"CE_lADOBGPKJs463pw0zwAAAAE5Mnqg","url":"https://api.github.com/repos/forem/forem/issues/events/5254576800","actor":{"login":"djuber","id":1237369,"node_id":"MDQ6VXNlcjEyMzczNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1237369?v=4","gravatar_id":"","url":"https://api.github.com/users/djuber","html_url":"https://github.com/djuber","followers_url":"https://api.github.com/users/djuber/followers","following_url":"https://api.github.com/users/djuber/following{/other_user}","gists_url":"https://api.github.com/users/djuber/gists{/gist_id}","starred_url":"https://api.github.com/users/djuber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/djuber/subscriptions","organizations_url":"https://api.github.com/users/djuber/orgs","repos_url":"https://api.github.com/users/djuber/repos","events_url":"https://api.github.com/users/djuber/events{/privacy}","received_events_url":"https://api.github.com/users/djuber/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-09-03T16:49:20Z","state_reason":null,"performed_via_github_app":null},{"id":5254576965,"node_id":"REFE_lADOBGPKJs463pw0zwAAAAE5MntF","url":"https://api.github.com/repos/forem/forem/issues/events/5254576965","actor":{"login":"djuber","id":1237369,"node_id":"MDQ6VXNlcjEyMzczNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1237369?v=4","gravatar_id":"","url":"https://api.github.com/users/djuber","html_url":"https://github.com/djuber","followers_url":"https://api.github.com/users/djuber/followers","following_url":"https://api.github.com/users/djuber/following{/other_user}","gists_url":"https://api.github.com/users/djuber/gists{/gist_id}","starred_url":"https://api.github.com/users/djuber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/djuber/subscriptions","organizations_url":"https://api.github.com/users/djuber/orgs","repos_url":"https://api.github.com/users/djuber/repos","events_url":"https://api.github.com/users/djuber/events{/privacy}","received_events_url":"https://api.github.com/users/djuber/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"c6cb4c9573fc1607c280a469c9e70bc909994216","commit_url":"https://api.github.com/repos/forem/forem/commits/c6cb4c9573fc1607c280a469c9e70bc909994216","created_at":"2021-09-03T16:49:23Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/forem/forem/issues/comments/913300217","html_url":"https://github.com/forem/forem/issues/14664#issuecomment-913300217","issue_url":"https://api.github.com/repos/forem/forem/issues/14664","id":913300217,"node_id":"IC_kwDOBGPKJs42b9r5","user":{"login":"citizen428","id":47985,"node_id":"MDQ6VXNlcjQ3OTg1","avatar_url":"https://avatars.githubusercontent.com/u/47985?v=4","gravatar_id":"","url":"https://api.github.com/users/citizen428","html_url":"https://github.com/citizen428","followers_url":"https://api.github.com/users/citizen428/followers","following_url":"https://api.github.com/users/citizen428/following{/other_user}","gists_url":"https://api.github.com/users/citizen428/gists{/gist_id}","starred_url":"https://api.github.com/users/citizen428/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/citizen428/subscriptions","organizations_url":"https://api.github.com/users/citizen428/orgs","repos_url":"https://api.github.com/users/citizen428/repos","events_url":"https://api.github.com/users/citizen428/events{/privacy}","received_events_url":"https://api.github.com/users/citizen428/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-06T02:58:30Z","updated_at":"2021-09-06T02:58:46Z","body":"@akhil-naidu Thanks a lot for this. But just to be very clear: you don't generally need to run all migrations when setting up a new Forem instance, `rails db:setup` will re-create the database from `db/schema.rb`. ","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/forem/forem/issues/comments/913300217/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"citizen428","id":47985,"node_id":"MDQ6VXNlcjQ3OTg1","avatar_url":"https://avatars.githubusercontent.com/u/47985?v=4","gravatar_id":"","url":"https://api.github.com/users/citizen428","html_url":"https://github.com/citizen428","followers_url":"https://api.github.com/users/citizen428/followers","following_url":"https://api.github.com/users/citizen428/following{/other_user}","gists_url":"https://api.github.com/users/citizen428/gists{/gist_id}","starred_url":"https://api.github.com/users/citizen428/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/citizen428/subscriptions","organizations_url":"https://api.github.com/users/citizen428/orgs","repos_url":"https://api.github.com/users/citizen428/repos","events_url":"https://api.github.com/users/citizen428/events{/privacy}","received_events_url":"https://api.github.com/users/citizen428/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":5258374951,"node_id":"MEE_lADOBGPKJs463pw0zwAAAAE5bG8n","url":"https://api.github.com/repos/forem/forem/issues/events/5258374951","actor":{"login":"akhil-naidu","id":11688537,"node_id":"MDQ6VXNlcjExNjg4NTM3","avatar_url":"https://avatars.githubusercontent.com/u/11688537?v=4","gravatar_id":"","url":"https://api.github.com/users/akhil-naidu","html_url":"https://github.com/akhil-naidu","followers_url":"https://api.github.com/users/akhil-naidu/followers","following_url":"https://api.github.com/users/akhil-naidu/following{/other_user}","gists_url":"https://api.github.com/users/akhil-naidu/gists{/gist_id}","starred_url":"https://api.github.com/users/akhil-naidu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akhil-naidu/subscriptions","organizations_url":"https://api.github.com/users/akhil-naidu/orgs","repos_url":"https://api.github.com/users/akhil-naidu/repos","events_url":"https://api.github.com/users/akhil-naidu/events{/privacy}","received_events_url":"https://api.github.com/users/akhil-naidu/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-09-06T02:58:31Z","performed_via_github_app":null},{"id":5258374952,"node_id":"SE_lADOBGPKJs463pw0zwAAAAE5bG8o","url":"https://api.github.com/repos/forem/forem/issues/events/5258374952","actor":{"login":"akhil-naidu","id":11688537,"node_id":"MDQ6VXNlcjExNjg4NTM3","avatar_url":"https://avatars.githubusercontent.com/u/11688537?v=4","gravatar_id":"","url":"https://api.github.com/users/akhil-naidu","html_url":"https://github.com/akhil-naidu","followers_url":"https://api.github.com/users/akhil-naidu/followers","following_url":"https://api.github.com/users/akhil-naidu/following{/other_user}","gists_url":"https://api.github.com/users/akhil-naidu/gists{/gist_id}","starred_url":"https://api.github.com/users/akhil-naidu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akhil-naidu/subscriptions","organizations_url":"https://api.github.com/users/akhil-naidu/orgs","repos_url":"https://api.github.com/users/akhil-naidu/repos","events_url":"https://api.github.com/users/akhil-naidu/events{/privacy}","received_events_url":"https://api.github.com/users/akhil-naidu/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-09-06T02:58:31Z","performed_via_github_app":null}]