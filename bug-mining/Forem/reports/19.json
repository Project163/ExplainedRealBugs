{"url":"https://api.github.com/repos/forem/forem/issues/15962","repository_url":"https://api.github.com/repos/forem/forem","labels_url":"https://api.github.com/repos/forem/forem/issues/15962/labels{/name}","comments_url":"https://api.github.com/repos/forem/forem/issues/15962/comments","events_url":"https://api.github.com/repos/forem/forem/issues/15962/events","html_url":"https://github.com/forem/forem/issues/15962","id":1094518773,"node_id":"I_kwDOBGPKJs5BPQf1","number":15962,"title":"Disabled Google Analytics JavaScript when gaTrackingCode is blank","user":{"login":"michael-tharrington","id":16007075,"node_id":"MDQ6VXNlcjE2MDA3MDc1","avatar_url":"https://avatars.githubusercontent.com/u/16007075?v=4","gravatar_id":"","url":"https://api.github.com/users/michael-tharrington","html_url":"https://github.com/michael-tharrington","followers_url":"https://api.github.com/users/michael-tharrington/followers","following_url":"https://api.github.com/users/michael-tharrington/following{/other_user}","gists_url":"https://api.github.com/users/michael-tharrington/gists{/gist_id}","starred_url":"https://api.github.com/users/michael-tharrington/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/michael-tharrington/subscriptions","organizations_url":"https://api.github.com/users/michael-tharrington/orgs","repos_url":"https://api.github.com/users/michael-tharrington/repos","events_url":"https://api.github.com/users/michael-tharrington/events{/privacy}","received_events_url":"https://api.github.com/users/michael-tharrington/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"jeremyf","id":2130,"node_id":"MDQ6VXNlcjIxMzA=","avatar_url":"https://avatars.githubusercontent.com/u/2130?v=4","gravatar_id":"","url":"https://api.github.com/users/jeremyf","html_url":"https://github.com/jeremyf","followers_url":"https://api.github.com/users/jeremyf/followers","following_url":"https://api.github.com/users/jeremyf/following{/other_user}","gists_url":"https://api.github.com/users/jeremyf/gists{/gist_id}","starred_url":"https://api.github.com/users/jeremyf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeremyf/subscriptions","organizations_url":"https://api.github.com/users/jeremyf/orgs","repos_url":"https://api.github.com/users/jeremyf/repos","events_url":"https://api.github.com/users/jeremyf/events{/privacy}","received_events_url":"https://api.github.com/users/jeremyf/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"jeremyf","id":2130,"node_id":"MDQ6VXNlcjIxMzA=","avatar_url":"https://avatars.githubusercontent.com/u/2130?v=4","gravatar_id":"","url":"https://api.github.com/users/jeremyf","html_url":"https://github.com/jeremyf","followers_url":"https://api.github.com/users/jeremyf/followers","following_url":"https://api.github.com/users/jeremyf/following{/other_user}","gists_url":"https://api.github.com/users/jeremyf/gists{/gist_id}","starred_url":"https://api.github.com/users/jeremyf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeremyf/subscriptions","organizations_url":"https://api.github.com/users/jeremyf/orgs","repos_url":"https://api.github.com/users/jeremyf/repos","events_url":"https://api.github.com/users/jeremyf/events{/privacy}","received_events_url":"https://api.github.com/users/jeremyf/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":1,"created_at":"2022-01-05T16:15:35Z","updated_at":"2022-01-06T17:21:07Z","closed_at":"2022-01-06T17:21:07Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Describe the bug**\r\n\r\nAs a Forem admin, I don't currently have the ability to globally remove the Google Analytics JavaScript.\r\n\r\n**Expected behavior**\r\n\r\nAs a Forem admin, if I leave the input box blank for **View ID** located in `/admin/customization/config` > **Google Analytics** I'd expect this to disable the Google Analytics JavaScript.\r\n\r\nIn other words, if no GA code is enabled, we should not enable the script.\r\n\r\n**Additional context**\r\n\r\nFrom speaking with @benhalpern: \r\n\r\n> We should be able to return early from this function if `gaTrackingCode` is blank:\r\n>\r\n> Very straightforward change and this should be the intended behavior â€” pending additional customization of tracking perhaps in the future.\r\n\r\n```\r\nfunction initializeBaseTracking() {\r\n  var wait = 0;\r\n  var addedGA = false;\r\n  var gaTrackingCode = document.body.dataset.gaTracking;\r\n  var waitingOnGA = setInterval(function() {\r\n    if (!addedGA) {\r\n      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\r\n      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\r\n      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\r\n      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');\r\n    }\r\n    addedGA = true;\r\n    wait++;\r\n    if (window.ga && ga.create) {\r\n      ga('create', gaTrackingCode, 'auto');\r\n      ga('set', 'anonymizeIp', true);\r\n      ga('send', 'pageview', location.pathname + location.search);\r\n      clearInterval(waitingOnGA);\r\n    }\r\n    if (wait > 85) {\r\n      clearInterval(waitingOnGA);\r\n      fallbackActivityRecording();\r\n    }\r\n  }, 25);\r\n  eventListening();\r\n  trackCustomImpressions();\r\n}\r\n```","closed_by":{"login":"jeremyf","id":2130,"node_id":"MDQ6VXNlcjIxMzA=","avatar_url":"https://avatars.githubusercontent.com/u/2130?v=4","gravatar_id":"","url":"https://api.github.com/users/jeremyf","html_url":"https://github.com/jeremyf","followers_url":"https://api.github.com/users/jeremyf/followers","following_url":"https://api.github.com/users/jeremyf/following{/other_user}","gists_url":"https://api.github.com/users/jeremyf/gists{/gist_id}","starred_url":"https://api.github.com/users/jeremyf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeremyf/subscriptions","organizations_url":"https://api.github.com/users/jeremyf/orgs","repos_url":"https://api.github.com/users/jeremyf/repos","events_url":"https://api.github.com/users/jeremyf/events{/privacy}","received_events_url":"https://api.github.com/users/jeremyf/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/forem/forem/issues/15962/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/forem/forem/issues/15962/timeline","performed_via_github_app":null,"state_reason":"completed"}