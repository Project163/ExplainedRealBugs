{"url":"https://api.github.com/repos/heartcombo/devise/issues/1375","repository_url":"https://api.github.com/repos/heartcombo/devise","labels_url":"https://api.github.com/repos/heartcombo/devise/issues/1375/labels{/name}","comments_url":"https://api.github.com/repos/heartcombo/devise/issues/1375/comments","events_url":"https://api.github.com/repos/heartcombo/devise/issues/1375/events","html_url":"https://github.com/heartcombo/devise/issues/1375","id":1880100,"node_id":"MDU6SXNzdWUxODgwMTAw","number":1375,"title":"Controllers use flash for paranoid_mode messages but do not redirect","user":{"login":"jimherz","id":259890,"node_id":"MDQ6VXNlcjI1OTg5MA==","avatar_url":"https://avatars.githubusercontent.com/u/259890?v=4","gravatar_id":"","url":"https://api.github.com/users/jimherz","html_url":"https://github.com/jimherz","followers_url":"https://api.github.com/users/jimherz/followers","following_url":"https://api.github.com/users/jimherz/following{/other_user}","gists_url":"https://api.github.com/users/jimherz/gists{/gist_id}","starred_url":"https://api.github.com/users/jimherz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimherz/subscriptions","organizations_url":"https://api.github.com/users/jimherz/orgs","repos_url":"https://api.github.com/users/jimherz/repos","events_url":"https://api.github.com/users/jimherz/events{/privacy}","received_events_url":"https://api.github.com/users/jimherz/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2011-10-11T19:35:17Z","updated_at":"2011-10-15T08:52:19Z","closed_at":"2011-10-15T08:52:19Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Hi,\n\nWe would like to use paranoid mode, specifically for the passwords controller so that we don't leak existence/non-existence of account information when users are submitting the forgot password page.  However, there is a subtle problem with how devise implements paranoid mode.  For instance, here is the create action from the passwords controller:\n\n```\ndef create\n  self.resource = resource_class.send_reset_password_instructions(params[resource_name])\n\n  if successful_and_sane?(resource)\n    set_flash_message(:notice, :send_instructions) if is_navigational_format?\n    respond_with({}, :location => after_sending_reset_password_instructions_path_for(resource_name))\n  else\n    respond_with_navigational(resource){ render_with_scope :new }\n  end\nend\n```\n\nsuccessful_and_sane? adds the :send_paranoid_instructions to flash when in paranoid mode, but it returns false.  Hence, the action falls through to the else case and merely re-renders the new template.  Since there is no redirect, the flash sticks around for an additional request.  And that can be a little messy if the user, for instance, clicks on the link in the forgot password email and it takes them to the session in the same browser...they see the \"You will receive an email...\" at the top of the password reset page, which is not ideal.\n\nIt seems like paranoid mode messages should either use flash.now, or the paranoid mode response should be a redirect.  Personally, I think the redirect makes more sense because a paranoid mode response should appear in all ways to the user like a successful response.\n\nOr, perhaps we are not understanding the correct usage of paranoid mode.  If so, please explain.\n\nThanks!\n","closed_by":{"login":"josevalim","id":9582,"node_id":"MDQ6VXNlcjk1ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9582?v=4","gravatar_id":"","url":"https://api.github.com/users/josevalim","html_url":"https://github.com/josevalim","followers_url":"https://api.github.com/users/josevalim/followers","following_url":"https://api.github.com/users/josevalim/following{/other_user}","gists_url":"https://api.github.com/users/josevalim/gists{/gist_id}","starred_url":"https://api.github.com/users/josevalim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/josevalim/subscriptions","organizations_url":"https://api.github.com/users/josevalim/orgs","repos_url":"https://api.github.com/users/josevalim/repos","events_url":"https://api.github.com/users/josevalim/events{/privacy}","received_events_url":"https://api.github.com/users/josevalim/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/heartcombo/devise/issues/1375/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/heartcombo/devise/issues/1375/timeline","performed_via_github_app":null,"state_reason":"completed"}