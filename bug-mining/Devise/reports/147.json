{"url":"https://api.github.com/repos/heartcombo/devise/issues/3624","repository_url":"https://api.github.com/repos/heartcombo/devise","labels_url":"https://api.github.com/repos/heartcombo/devise/issues/3624/labels{/name}","comments_url":"https://api.github.com/repos/heartcombo/devise/issues/3624/comments","events_url":"https://api.github.com/repos/heartcombo/devise/issues/3624/events","html_url":"https://github.com/heartcombo/devise/issues/3624","id":85911976,"node_id":"MDU6SXNzdWU4NTkxMTk3Ng==","number":3624,"title":"undefined method `encrypted_password_changed?'","user":{"login":"Startouf","id":7388889,"node_id":"MDQ6VXNlcjczODg4ODk=","avatar_url":"https://avatars.githubusercontent.com/u/7388889?v=4","gravatar_id":"","url":"https://api.github.com/users/Startouf","html_url":"https://github.com/Startouf","followers_url":"https://api.github.com/users/Startouf/followers","following_url":"https://api.github.com/users/Startouf/following{/other_user}","gists_url":"https://api.github.com/users/Startouf/gists{/gist_id}","starred_url":"https://api.github.com/users/Startouf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Startouf/subscriptions","organizations_url":"https://api.github.com/users/Startouf/orgs","repos_url":"https://api.github.com/users/Startouf/repos","events_url":"https://api.github.com/users/Startouf/events{/privacy}","received_events_url":"https://api.github.com/users/Startouf/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":40645,"node_id":"MDU6TGFiZWw0MDY0NQ==","url":"https://api.github.com/repos/heartcombo/devise/labels/Bug","name":"Bug","color":"ededed","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/heartcombo/devise/milestones/9","html_url":"https://github.com/heartcombo/devise/milestone/9","labels_url":"https://api.github.com/repos/heartcombo/devise/milestones/9/labels","id":1739180,"node_id":"MDk6TWlsZXN0b25lMTczOTE4MA==","number":9,"title":"4.2.0","description":"","creator":{"login":"lucasmazza","id":80978,"node_id":"MDQ6VXNlcjgwOTc4","avatar_url":"https://avatars.githubusercontent.com/u/80978?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasmazza","html_url":"https://github.com/lucasmazza","followers_url":"https://api.github.com/users/lucasmazza/followers","following_url":"https://api.github.com/users/lucasmazza/following{/other_user}","gists_url":"https://api.github.com/users/lucasmazza/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasmazza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasmazza/subscriptions","organizations_url":"https://api.github.com/users/lucasmazza/orgs","repos_url":"https://api.github.com/users/lucasmazza/repos","events_url":"https://api.github.com/users/lucasmazza/events{/privacy}","received_events_url":"https://api.github.com/users/lucasmazza/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":9,"state":"closed","created_at":"2016-04-29T19:22:04Z","updated_at":"2019-04-01T17:40:13Z","due_on":null,"closed_at":"2019-04-01T17:40:13Z"},"comments":9,"created_at":"2015-06-07T15:38:40Z","updated_at":"2016-07-01T17:15:21Z","closed_at":"2016-07-01T17:15:21Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I just upgraded from devise 3.4.1 to 3.5.1 and when I try in the console\n\n``` ruby\nUser.last.send_confirmation_instructions\n```\n\nI get \n\n```\nMOPED: 127.0.0.1:27017 QUERY        database=intranet_rails_development collection=users selector={\"$query\"=>{}, \"$orderby\"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5683ms\n  MOPED: 127.0.0.1:27017 QUERY        database=intranet_rails_development collection=users selector={\"$query\"=>{\"confirmation_token\"=>\"c6af56a23525aae830e77072d65713c17b39c3cfd309f3c3e532fc60c81b71cd\"}, \"$orderby\"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3963ms\nNoMethodError: undefined method `encrypted_password_changed?' for #<User:0xc0d0668>\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/devise-3.5.1/lib/devise/models/recoverable.rb:35:in `block (2 levels) in <module:Recoverable>'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/activesupport-4.2.1/lib/active_support/callbacks.rb:446:in `instance_exec'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/activesupport-4.2.1/lib/active_support/callbacks.rb:446:in `block in make_lambda'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/activesupport-4.2.1/lib/active_support/callbacks.rb:164:in `call'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/activesupport-4.2.1/lib/active_support/callbacks.rb:164:in `block in halting'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/activesupport-4.2.1/lib/active_support/callbacks.rb:504:in `call'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/activesupport-4.2.1/lib/active_support/callbacks.rb:504:in `block in call'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/activesupport-4.2.1/lib/active_support/callbacks.rb:504:in `each'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/activesupport-4.2.1/lib/active_support/callbacks.rb:504:in `call'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/activesupport-4.2.1/lib/active_support/callbacks.rb:92:in `_run_callbacks'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/activesupport-4.2.1/lib/active_support/callbacks.rb:776:in `_run_save_callbacks'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/activesupport-4.2.1/lib/active_support/callbacks.rb:81:in `run_callbacks'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/mongoid-4.0.2/lib/mongoid/interceptable.rb:138:in `run_callbacks'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/mongoid-4.0.2/lib/mongoid/persistable/updatable.rb:116:in `prepare_update'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/mongoid-4.0.2/lib/mongoid/persistable/updatable.rb:139:in `update_document'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/mongoid-4.0.2/lib/mongoid/persistable/savable.rb:25:in `save'\n... 13 levels...\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/activesupport-4.2.1/lib/active_support/dependencies.rb:268:in `load'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/activesupport-4.2.1/lib/active_support/dependencies.rb:268:in `block in load'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/activesupport-4.2.1/lib/active_support/dependencies.rb:240:in `load_dependency'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/activesupport-4.2.1/lib/active_support/dependencies.rb:268:in `load'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/spring-1.3.6/lib/spring/commands/rails.rb:6:in `call'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/spring-1.3.6/lib/spring/command_wrapper.rb:38:in `call'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/spring-1.3.6/lib/spring/application.rb:183:in `block in serve'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/spring-1.3.6/lib/spring/application.rb:156:in `fork'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/spring-1.3.6/lib/spring/application.rb:156:in `serve'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/spring-1.3.6/lib/spring/application.rb:131:in `block in run'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/spring-1.3.6/lib/spring/application.rb:125:in `loop'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/spring-1.3.6/lib/spring/application.rb:125:in `run'\n        from /var/www/intranet_rails_test/shared/bundle/ruby/2.0.0/gems/spring-1.3.6/lib/spring/application/boot.rb:18:in `<top (required)>'\n        from /usr/local/rvm/rubies/ruby-2.0.0-p353/lib/ruby/site_ruby/2.0.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n        from /usr/local/rvm/rubies/ruby-2.0.0-p353/lib/ruby/site_ruby/2.0.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n```\n\nUsing Mongoid and `devise :ldap_authenticatable, :registerable, :recoverable, :rememberable, :trackable, :confirmable`\n\nNow what is weird\nIf I do\n\n``` ruby\nu = User.last\nu.send_confirmation_instructions\n# The first time it will crash like above\nu.send_confirmation_instructions\n# The second time the function is called, it works ....\n# I can repeat the above as many times as I want, same results...\n```\n\nExact version of Ruby used is `ruby 2.0.0p353`\n","closed_by":{"login":"lucasmazza","id":80978,"node_id":"MDQ6VXNlcjgwOTc4","avatar_url":"https://avatars.githubusercontent.com/u/80978?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasmazza","html_url":"https://github.com/lucasmazza","followers_url":"https://api.github.com/users/lucasmazza/followers","following_url":"https://api.github.com/users/lucasmazza/following{/other_user}","gists_url":"https://api.github.com/users/lucasmazza/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasmazza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasmazza/subscriptions","organizations_url":"https://api.github.com/users/lucasmazza/orgs","repos_url":"https://api.github.com/users/lucasmazza/repos","events_url":"https://api.github.com/users/lucasmazza/events{/privacy}","received_events_url":"https://api.github.com/users/lucasmazza/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/heartcombo/devise/issues/3624/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/heartcombo/devise/issues/3624/timeline","performed_via_github_app":null,"state_reason":"completed"}