{"url":"https://api.github.com/repos/heartcombo/devise/issues/2606","repository_url":"https://api.github.com/repos/heartcombo/devise","labels_url":"https://api.github.com/repos/heartcombo/devise/issues/2606/labels{/name}","comments_url":"https://api.github.com/repos/heartcombo/devise/issues/2606/comments","events_url":"https://api.github.com/repos/heartcombo/devise/issues/2606/events","html_url":"https://github.com/heartcombo/devise/issues/2606","id":18868185,"node_id":"MDU6SXNzdWUxODg2ODE4NQ==","number":2606,"title":"Inconsistency between sign_out and timeout when config.sign_out_all_scopes = true","user":{"login":"leods92","id":879395,"node_id":"MDQ6VXNlcjg3OTM5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/879395?v=4","gravatar_id":"","url":"https://api.github.com/users/leods92","html_url":"https://github.com/leods92","followers_url":"https://api.github.com/users/leods92/followers","following_url":"https://api.github.com/users/leods92/following{/other_user}","gists_url":"https://api.github.com/users/leods92/gists{/gist_id}","starred_url":"https://api.github.com/users/leods92/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leods92/subscriptions","organizations_url":"https://api.github.com/users/leods92/orgs","repos_url":"https://api.github.com/users/leods92/repos","events_url":"https://api.github.com/users/leods92/events{/privacy}","received_events_url":"https://api.github.com/users/leods92/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2013-09-02T14:41:27Z","updated_at":"2013-11-06T20:07:48Z","closed_at":"2013-11-06T20:07:48Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I believe I've found a bug. I've identified it in version 2.2.7 and I'm not sure whether other versions are affected. Maybe this is a Warden's issue or the way Devise and Warden work together.\n\nAnyway, when config.sign_out_all_scopes is true (default) and one manually signs out, the whole session is emptied (not only the scopes). I personally disagree with this behaviour because if something in session is not inside an authentication scope it shouldn't be emptied.\n\nThe problem is that when authentication times out, only session's scope data is cleared.\nI haven't tested with multiple authentication scopes as it'd be a bit complex, but it seems Warden's timing out logic is only taking care of session's scoped data.\n\nWarden's timing out behaviour makes more sense to me but I understand there are security concerns by not emptying the whole session.\nRegardless of the chosen approach, it should be consistent across signing out events.\n\nI'd be glad to hear @josevalim thoughts on this.\nMaybe I'm missing something here.\n","closed_by":{"login":"josevalim","id":9582,"node_id":"MDQ6VXNlcjk1ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9582?v=4","gravatar_id":"","url":"https://api.github.com/users/josevalim","html_url":"https://github.com/josevalim","followers_url":"https://api.github.com/users/josevalim/followers","following_url":"https://api.github.com/users/josevalim/following{/other_user}","gists_url":"https://api.github.com/users/josevalim/gists{/gist_id}","starred_url":"https://api.github.com/users/josevalim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/josevalim/subscriptions","organizations_url":"https://api.github.com/users/josevalim/orgs","repos_url":"https://api.github.com/users/josevalim/repos","events_url":"https://api.github.com/users/josevalim/events{/privacy}","received_events_url":"https://api.github.com/users/josevalim/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/heartcombo/devise/issues/2606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/heartcombo/devise/issues/2606/timeline","performed_via_github_app":null,"state_reason":"completed"}