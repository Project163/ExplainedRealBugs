{"url":"https://api.github.com/repos/heartcombo/devise/issues/1515","repository_url":"https://api.github.com/repos/heartcombo/devise","labels_url":"https://api.github.com/repos/heartcombo/devise/issues/1515/labels{/name}","comments_url":"https://api.github.com/repos/heartcombo/devise/issues/1515/comments","events_url":"https://api.github.com/repos/heartcombo/devise/issues/1515/events","html_url":"https://github.com/heartcombo/devise/issues/1515","id":2616816,"node_id":"MDU6SXNzdWUyNjE2ODE2","number":1515,"title":"Devise 2.0, reconfirmable and a new user","user":{"login":"mrship","id":14839,"node_id":"MDQ6VXNlcjE0ODM5","avatar_url":"https://avatars.githubusercontent.com/u/14839?v=4","gravatar_id":"","url":"https://api.github.com/users/mrship","html_url":"https://github.com/mrship","followers_url":"https://api.github.com/users/mrship/followers","following_url":"https://api.github.com/users/mrship/following{/other_user}","gists_url":"https://api.github.com/users/mrship/gists{/gist_id}","starred_url":"https://api.github.com/users/mrship/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrship/subscriptions","organizations_url":"https://api.github.com/users/mrship/orgs","repos_url":"https://api.github.com/users/mrship/repos","events_url":"https://api.github.com/users/mrship/events{/privacy}","received_events_url":"https://api.github.com/users/mrship/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2011-12-20T19:10:40Z","updated_at":"2011-12-20T20:12:37Z","closed_at":"2011-12-20T19:55:09Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I've just upgraded to 2.0.RC primarily to use the new reconfirmable logic for changing an email. However, when I sign up as a new user, the `confirm!` method in `Confirmable` fails to save the newly confirmed user with validation messages about the lack of a password. Looking at the code: (line 47 of confirmable.rb)\n\n```\nif self.class.reconfirmable\n  @bypass_postpone = true\n  self.email = unconfirmed_email if unconfirmed_email.present?\n  self.unconfirmed_email = nil\n  save\nelse\n  save(:validate => false)\nend\n```\n\nthe reconfirmable path is validating the new user, whereas the non-reconfirmable path is not. That appears to be causing the validation error. Is it intentional that the validation is required for the reconfirmable path? As far as I can tell there is no way that the password is going to validate as we don't have the password attribute to validate on at that stage.\n\nI may be missing something, but should this not call `save(:validate => false)` in both instances?\n","closed_by":{"login":"josevalim","id":9582,"node_id":"MDQ6VXNlcjk1ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9582?v=4","gravatar_id":"","url":"https://api.github.com/users/josevalim","html_url":"https://github.com/josevalim","followers_url":"https://api.github.com/users/josevalim/followers","following_url":"https://api.github.com/users/josevalim/following{/other_user}","gists_url":"https://api.github.com/users/josevalim/gists{/gist_id}","starred_url":"https://api.github.com/users/josevalim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/josevalim/subscriptions","organizations_url":"https://api.github.com/users/josevalim/orgs","repos_url":"https://api.github.com/users/josevalim/repos","events_url":"https://api.github.com/users/josevalim/events{/privacy}","received_events_url":"https://api.github.com/users/josevalim/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/heartcombo/devise/issues/1515/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/heartcombo/devise/issues/1515/timeline","performed_via_github_app":null,"state_reason":"completed"}