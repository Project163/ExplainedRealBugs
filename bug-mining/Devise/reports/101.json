{"url":"https://api.github.com/repos/heartcombo/devise/issues/2122","repository_url":"https://api.github.com/repos/heartcombo/devise","labels_url":"https://api.github.com/repos/heartcombo/devise/issues/2122/labels{/name}","comments_url":"https://api.github.com/repos/heartcombo/devise/issues/2122/comments","events_url":"https://api.github.com/repos/heartcombo/devise/issues/2122/events","html_url":"https://github.com/heartcombo/devise/issues/2122","id":8010159,"node_id":"MDU6SXNzdWU4MDEwMTU5","number":2122,"title":"Sign in with JSON loses stored location URL for redirection","user":{"login":"gabetax","id":149842,"node_id":"MDQ6VXNlcjE0OTg0Mg==","avatar_url":"https://avatars.githubusercontent.com/u/149842?v=4","gravatar_id":"","url":"https://api.github.com/users/gabetax","html_url":"https://github.com/gabetax","followers_url":"https://api.github.com/users/gabetax/followers","following_url":"https://api.github.com/users/gabetax/following{/other_user}","gists_url":"https://api.github.com/users/gabetax/gists{/gist_id}","starred_url":"https://api.github.com/users/gabetax/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabetax/subscriptions","organizations_url":"https://api.github.com/users/gabetax/orgs","repos_url":"https://api.github.com/users/gabetax/repos","events_url":"https://api.github.com/users/gabetax/events{/privacy}","received_events_url":"https://api.github.com/users/gabetax/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2012-10-31T17:56:20Z","updated_at":"2012-11-05T07:49:43Z","closed_at":"2012-11-05T07:49:43Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"When successfully signing into our resource with a normal HTML, devise uses a `responds_with` `:location` parameter to redirect the user to their original page, stored in the session. However, if we're signing in with a JSON format when using an AJAX request, the originally requested data is not sent in the JSON response to the user, and the URL is immediately removed from the session by the call to `stored_location_for`\n\nIt would be convenient if either:\n1. The location could be included in the JSON response to the user, so the on-page Javascript can redirect as necessary.\n2. The original path could not be purged from the request for non-`is_navigational_format?` pages, such that a future page could perform the redirection as necessary.\n\nhttps://github.com/plataformatec/devise/blob/master/app/controllers/devise/sessions_controller.rb#L18\n","closed_by":{"login":"josevalim","id":9582,"node_id":"MDQ6VXNlcjk1ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9582?v=4","gravatar_id":"","url":"https://api.github.com/users/josevalim","html_url":"https://github.com/josevalim","followers_url":"https://api.github.com/users/josevalim/followers","following_url":"https://api.github.com/users/josevalim/following{/other_user}","gists_url":"https://api.github.com/users/josevalim/gists{/gist_id}","starred_url":"https://api.github.com/users/josevalim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/josevalim/subscriptions","organizations_url":"https://api.github.com/users/josevalim/orgs","repos_url":"https://api.github.com/users/josevalim/repos","events_url":"https://api.github.com/users/josevalim/events{/privacy}","received_events_url":"https://api.github.com/users/josevalim/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/heartcombo/devise/issues/2122/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/heartcombo/devise/issues/2122/timeline","performed_via_github_app":null,"state_reason":"completed"}