{"url":"https://api.github.com/repos/heartcombo/devise/issues/234","repository_url":"https://api.github.com/repos/heartcombo/devise","labels_url":"https://api.github.com/repos/heartcombo/devise/issues/234/labels{/name}","comments_url":"https://api.github.com/repos/heartcombo/devise/issues/234/comments","events_url":"https://api.github.com/repos/heartcombo/devise/issues/234/events","html_url":"https://github.com/heartcombo/devise/issues/234","id":180713,"node_id":"MDU6SXNzdWUxODA3MTM=","number":234,"title":"Return 401 and basic authentication realm on non-html requests","user":{"login":"devwout","id":149323,"node_id":"MDQ6VXNlcjE0OTMyMw==","avatar_url":"https://avatars.githubusercontent.com/u/149323?v=4","gravatar_id":"","url":"https://api.github.com/users/devwout","html_url":"https://github.com/devwout","followers_url":"https://api.github.com/users/devwout/followers","following_url":"https://api.github.com/users/devwout/following{/other_user}","gists_url":"https://api.github.com/users/devwout/gists{/gist_id}","starred_url":"https://api.github.com/users/devwout/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/devwout/subscriptions","organizations_url":"https://api.github.com/users/devwout/orgs","repos_url":"https://api.github.com/users/devwout/repos","events_url":"https://api.github.com/users/devwout/events{/privacy}","received_events_url":"https://api.github.com/users/devwout/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2010-04-27T10:43:05Z","updated_at":"2010-06-24T13:31:10Z","closed_at":"2010-05-16T17:13:55Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Using rails 2.3 and devise 1.0.6.\n\nFor serving private RSS feeds and ical data, we use basic authentication. However, both vienna and iCal do not work when the user is not authenticated. Warden redirects the user to the login page, which cannot be interpreted by these applications.\n\nFor our application, it seemed logical that all non-html requests that require authentication should be answered with a 401 and basic authentication realm. Implemented as follows.\n\n```\nclass HttpAuthenticatableNonHtml < Devise::Strategies::HttpAuthenticatable\n  def valid?\n    not request_format.html? or super\n  end\n  def http_authentication\n    super or ''\n  end\nend\nWarden::Strategies.add(:http_auth_non_html, HttpAuthenticatableNonHtml)\n\n# Inside Devise.setup\nconfig.warden do |manager|\n    manager.default_strategies.unshift :http_auth_non_html\nend\n```\n\nIs this the right solution to the problem or is there some devise/warden functionality we are overlooking?\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/heartcombo/devise/issues/234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/heartcombo/devise/issues/234/timeline","performed_via_github_app":null,"state_reason":"completed"}