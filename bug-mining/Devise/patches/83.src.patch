diff --git a/.gitignore b/.gitignore
index 5bdc389f..0ff77427 100644
--- a/.gitignore
+++ b/.gitignore
@@ -1,5 +1,5 @@
-**/*/log/*
-**/*/tmp/*
+test/rails_app/log/*
+test/rails_app/tmp/*
 *~
 coverage/*
 *.sqlite3
diff --git a/devise.gemspec b/devise.gemspec
index 74b38906..58be5857 100644
--- a/devise.gemspec
+++ b/devise.gemspec
@@ -14,8 +14,8 @@ Gem::Specification.new do |s|
 
   s.rubyforge_project = "devise"
 
-  s.files         = Dir["CHANGELOG.rdoc", "MIT-LICENSE", "README.rdoc", "app/**/*", "config/**/*", "lib/**/*"]
-  s.test_files    = Dir["test/**/*"]
+  s.files         = `git ls-files`.split("\n")
+  s.test_files    = `git ls-files -- test/*`.split("\n")
   s.require_paths = ["lib"]
 
   s.add_dependency("warden", "~> 1.1")
