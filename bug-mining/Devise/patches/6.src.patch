diff --git a/lib/devise.rb b/lib/devise.rb
index 938a1830..6a9ee2ee 100644
--- a/lib/devise.rb
+++ b/lib/devise.rb
@@ -157,13 +157,10 @@ module Devise
   # Register a model in Devise. You can call this manually if you don't want
   # to use devise routes. Check devise_for in routes to know which options
   # are available.
-  def self.register(resource, options)
+  def self.add_model(resource, options)
     mapping = Devise::Mapping.new(resource, options)
     self.mappings[mapping.name] = mapping
     self.default_scope ||= mapping.name
-
-    warden_config.default_scope ||= mapping.name
-    warden_config.scope_defaults mapping.name, :strategies => mapping.strategies
     mapping
   end
 
@@ -233,6 +230,15 @@ module Devise
   # A method used internally to setup warden manager from the Rails initialize
   # block.
   def self.configure_warden! #:nodoc:
+    return unless warden_config
+
+    warden_config.failure_app   = Devise::FailureApp
+    warden_config.default_scope = Devise.default_scope
+
+    Devise.mappings.each_value do |mapping|
+      warden_config.scope_defaults mapping.name, :strategies => mapping.strategies
+    end
+
     @@warden_config_block.try :call, Devise.warden_config
   end
 
diff --git a/lib/devise/rails.rb b/lib/devise/rails.rb
index cced18b5..dcd5cd7f 100644
--- a/lib/devise/rails.rb
+++ b/lib/devise/rails.rb
@@ -5,11 +5,14 @@ module Devise
   class Engine < ::Rails::Engine
     config.devise = Devise
 
+    initializer "devise.ensure_routes_are_loaded", :before => :load_app_classes, :after => :load_config_initializers do |app|
+      app.reload_routes!
+    end
+
     initializer "devise.add_middleware" do |app|
       app.config.middleware.use Warden::Manager do |config|
         Devise.warden_config = config
-        config.failure_app   = Devise::FailureApp
-        config.default_scope = Devise.default_scope
+        Devise.configure_warden!
       end
     end
 
diff --git a/lib/devise/rails/routes.rb b/lib/devise/rails/routes.rb
index 3bb0db65..8b39cce5 100644
--- a/lib/devise/rails/routes.rb
+++ b/lib/devise/rails/routes.rb
@@ -89,7 +89,7 @@ module ActionDispatch::Routing
       resources.map!(&:to_sym)
 
       resources.each do |resource|
-        mapping = Devise.register(resource, options)
+        mapping = Devise.add_model(resource, options)
 
         unless mapping.to.respond_to?(:devise)
           raise "#{mapping.to.name} does not respond to 'devise' method. This usually means you haven't " <<
diff --git a/test/integration/database_authenticatable_test.rb b/test/integration/database_authenticatable_test.rb
index aa0da0e2..4bbb2b31 100644
--- a/test/integration/database_authenticatable_test.rb
+++ b/test/integration/database_authenticatable_test.rb
@@ -265,24 +265,6 @@ class AuthenticationTest < ActionController::IntegrationTest
     assert_contain 'Welcome to "sessions/new" view!'
   end
 
-  # Custom strategy invoking custom!
-  test 'custom strategy invoking custom on sign up bevahes as expected' do
-    Warden::Strategies.add(:custom) do
-      def authenticate!
-        custom!([401, {"Content-Type" => "text/html"}, ["Custom strategy"]])
-      end
-    end
-
-    begin
-      Devise.warden_config.default_strategies(:scope => :user).unshift(:custom)
-      sign_in_as_user
-      assert_equal 401, status
-      assert_contain 'Custom strategy'
-    ensure
-      Devise.warden_config.default_strategies(:scope => :user).shift
-    end
-  end
-
   # Access
   test 'render 404 on roles without routes' do
     assert_raise ActionController::RoutingError do
diff --git a/test/rails_app/app/controllers/application_controller.rb b/test/rails_app/app/controllers/application_controller.rb
index 46621e88..a76ef15f 100644
--- a/test/rails_app/app/controllers/application_controller.rb
+++ b/test/rails_app/app/controllers/application_controller.rb
@@ -5,4 +5,5 @@ class ApplicationController < ActionController::Base
   protect_from_forgery
 
   before_filter :current_user
+  before_filter :authenticate_user!, :if => :devise_controller?
 end
