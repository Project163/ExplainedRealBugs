diff --git a/core/src/main/java/com/google/googlejavaformat/java/JavaInputAstVisitor.java b/core/src/main/java/com/google/googlejavaformat/java/JavaInputAstVisitor.java
index 44f57eb..f06377a 100644
--- a/core/src/main/java/com/google/googlejavaformat/java/JavaInputAstVisitor.java
+++ b/core/src/main/java/com/google/googlejavaformat/java/JavaInputAstVisitor.java
@@ -1757,21 +1757,26 @@ public final class JavaInputAstVisitor extends TreePathScanner<Void, Void> {
         if (!first) {
           builder.forcedBreak();
         }
-        VariableTree variableTree = (VariableTree) resource;
-        declareOne(
-            DeclarationKind.PARAMETER,
-            fieldAnnotationDirection(variableTree.getModifiers()),
-            Optional.of(variableTree.getModifiers()),
-            variableTree.getType(),
-            VarArgsOrNot.NO,
-            ImmutableList.<AnnotationTree>of(),
-            variableTree.getName(),
-            "",
-            "=",
-            Optional.fromNullable(variableTree.getInitializer()),
-            Optional.<String>absent(),
-            Optional.<ExpressionTree>absent(),
-            Optional.<TypeWithDims>absent());
+        if (resource instanceof VariableTree) {
+          VariableTree variableTree = (VariableTree) resource;
+          declareOne(
+              DeclarationKind.PARAMETER,
+              fieldAnnotationDirection(variableTree.getModifiers()),
+              Optional.of(variableTree.getModifiers()),
+              variableTree.getType(),
+              VarArgsOrNot.NO,
+              ImmutableList.<AnnotationTree>of(),
+              variableTree.getName(),
+              "",
+              "=",
+              Optional.fromNullable(variableTree.getInitializer()),
+              Optional.<String>absent(),
+              Optional.<ExpressionTree>absent(),
+              Optional.<TypeWithDims>absent());
+        } else {
+          // TODO(cushon): think harder about what to do with `try (resource1; resource2) {}`
+          scan(resource, null);
+        }
         if (builder.peekToken().equals(Optional.of(";"))) {
           token(";");
           builder.space();
diff --git a/core/src/test/resources/com/google/googlejavaformat/java/testdata/i155.input b/core/src/test/resources/com/google/googlejavaformat/java/testdata/i155.input
new file mode 100644
index 0000000..1a525de
--- /dev/null
+++ b/core/src/test/resources/com/google/googlejavaformat/java/testdata/i155.input
@@ -0,0 +1,5 @@
+class I155 {
+  void walkAndClose(Stream<?> stream) {
+    try (stream) {}
+  }
+}
diff --git a/core/src/test/resources/com/google/googlejavaformat/java/testdata/i155.output b/core/src/test/resources/com/google/googlejavaformat/java/testdata/i155.output
new file mode 100644
index 0000000..1a525de
--- /dev/null
+++ b/core/src/test/resources/com/google/googlejavaformat/java/testdata/i155.output
@@ -0,0 +1,5 @@
+class I155 {
+  void walkAndClose(Stream<?> stream) {
+    try (stream) {}
+  }
+}
