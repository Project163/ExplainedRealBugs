<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:28:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-4803] UrlDecoder should log a message when invalid input is provided</title>
                <link>https://issues.apache.org/jira/browse/WICKET-4803</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;In the class: org.apache.wicket.protocol.http.WicketURLDecoder there are two IllegalArgumentException which should be wrapped in WicketRuntimeException, otherwise they are caught by the exception handler form the servlet container (jetty, tomcat, ...) which then uses their http 500 error code configuration instead of the exception handling of wicket.&lt;/p&gt;

&lt;p&gt;Wrapping them would be good for consistency and help manage runtime exceptions. &lt;br/&gt;
These are the two exceptions:&lt;br/&gt;
throw new IllegalArgumentException(&quot;URLDecoder: Incomplete trailing escape (%) pattern&quot;); &lt;br/&gt;
throw new IllegalArgumentException(&quot;URLDecoder: Illegal hex characters in escape (%) pattern - &quot; + e.getMessage()); &lt;/p&gt;</description>
                <environment></environment>
        <key id="12610355">WICKET-4803</key>
            <summary>UrlDecoder should log a message when invalid input is provided</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgrigorov">Martin Tzvetanov Grigorov</assignee>
                                    <reporter username="johanh@dns.be">Johan Heylen</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 Oct 2012 16:35:49 +0000</created>
                <updated>Mon, 4 Mar 2013 08:32:29 +0000</updated>
                            <resolved>Wed, 20 Feb 2013 08:14:03 +0000</resolved>
                                    <version>1.5.8</version>
                    <version>6.5.0</version>
                                    <fixVersion>1.5.10</fixVersion>
                    <fixVersion>6.7.0</fixVersion>
                    <fixVersion>1.4.22</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13476867" author="mgrigorov" created="Tue, 16 Oct 2012 09:12:09 +0000"  >&lt;p&gt;There is a problem with your test. It expects that both WicketRuntimeException is being thrown and that InternalErrorPage is rendered. Those are mutual exclusive.&lt;/p&gt;

&lt;p&gt;Some details:&lt;/p&gt;

&lt;p&gt;The stack trace is:&lt;br/&gt;
ain@1, prio=5, in group &apos;main&apos;, status: &apos;RUNNING&apos;&lt;br/&gt;
	  at org.apache.wicket.request.UrlDecoder.decode(UrlDecoder.java:89)&lt;br/&gt;
	  at org.apache.wicket.request.UrlDecoder.decode(UrlDecoder.java:76)&lt;br/&gt;
	  at org.apache.wicket.request.Url.decodeParameter(Url.java:601)&lt;br/&gt;
	  at org.apache.wicket.request.Url.parseQueryParameter(Url.java:108)&lt;br/&gt;
	  at org.apache.wicket.request.Url.parse(Url.java:243)&lt;br/&gt;
	  at org.apache.wicket.util.tester.BaseWicketTester.executeUrl(BaseWicketTester.java:2675)&lt;br/&gt;
	  at be.dns.wicket.TestHomePage.homepageRendersSuccessfullyPageParamWithPercentSignIncorrectUsage(TestHomePage.java:48)&lt;br/&gt;
.....&lt;/p&gt;

&lt;p&gt;WicketRuntimeException is in wicket-core.jar. In the stack trace the only class from -core is BaseWicketTester. Url and UrlDecoder are in wicket-request which do not see WicketRuntimeException.&lt;br/&gt;
Even re-working BaseWicketTester to handle this it will be a change in the behavior which will affect many applications. Currently they may expect that an exception is being thrown in some erroneous case but with this change there wont be an exception anymore but normal return with lastRenderedPage == InternalErrorPage.&lt;br/&gt;
I agree that InternalErrorPage is more correct but it is a bit late to change this behavior.&lt;/p&gt;</comment>
                            <comment id="13575858" author="jriehn" created="Mon, 11 Feb 2013 16:01:59 +0000"  >&lt;p&gt;Hej Martin,&lt;/p&gt;

&lt;p&gt;maybe the problem is not well demonstrated. this issue can be reconstructed using the wicket 1.5.9 quickstart &lt;a href=&quot;http://wicket.apache.org/start/quickstart.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://wicket.apache.org/start/quickstart.html&lt;/a&gt;. An invalid request like &quot;http://localhost:8080/?%%%&quot; throws the following exception:&lt;/p&gt;

&lt;p&gt;java.lang.IllegalArgumentException: URLDecoder: Illegal hex characters in escape (%) pattern - For input string: &quot;%%&quot;&lt;br/&gt;
	at org.apache.wicket.request.UrlDecoder.decode(UrlDecoder.java:162)&lt;br/&gt;
	at org.apache.wicket.request.UrlDecoder.decode(UrlDecoder.java:76)&lt;br/&gt;
	at org.apache.wicket.request.Url.decodeParameter(Url.java:601)&lt;br/&gt;
	at org.apache.wicket.request.Url.parseQueryParameter(Url.java:104)&lt;br/&gt;
	at org.apache.wicket.request.Url.parse(Url.java:243)&lt;br/&gt;
	at org.apache.wicket.protocol.http.servlet.ServletWebRequest.getContextRelativeUrl(ServletWebRequest.java:222)&lt;br/&gt;
	at org.apache.wicket.protocol.http.servlet.ServletWebRequest.&amp;lt;init&amp;gt;(ServletWebRequest.java:126)&lt;br/&gt;
	at org.apache.wicket.protocol.http.servlet.ServletWebRequest.&amp;lt;init&amp;gt;(ServletWebRequest.java:83)&lt;br/&gt;
	at org.apache.wicket.protocol.http.WebApplication.newWebRequest(WebApplication.java:413)&lt;br/&gt;
	at org.apache.wicket.protocol.http.WebApplication.createWebRequest(WebApplication.java:458)&lt;br/&gt;
	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:183)&lt;br/&gt;
	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:244)&lt;br/&gt;
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1326)&lt;br/&gt;
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:479)&lt;br/&gt;
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)&lt;br/&gt;
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:520)&lt;br/&gt;
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:227)&lt;br/&gt;
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:940)&lt;br/&gt;
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:409)&lt;br/&gt;
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:186)&lt;br/&gt;
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:874)&lt;br/&gt;
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117)&lt;br/&gt;
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:110)&lt;br/&gt;
	at org.eclipse.jetty.server.Server.handle(Server.java:349)&lt;br/&gt;
	at org.eclipse.jetty.server.HttpConnection.handleRequest(HttpConnection.java:441)&lt;br/&gt;
	at org.eclipse.jetty.server.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:904)&lt;br/&gt;
	at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:565)&lt;br/&gt;
	at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:217)&lt;br/&gt;
	at org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:50)&lt;br/&gt;
	at org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(SocketConnector.java:245)&lt;br/&gt;
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:598)&lt;br/&gt;
	at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:533)&lt;br/&gt;
	at java.lang.Thread.run(Unknown Source)&lt;/p&gt;

&lt;p&gt;Is there any advice on how to handle such invalid requests?&lt;/p&gt;</comment>
                            <comment id="13581356" author="mgrigorov" created="Tue, 19 Feb 2013 15:20:11 +0000"  >&lt;p&gt;I&apos;m not sure Wicket can do something about this.&lt;/p&gt;

&lt;p&gt;Issuing &lt;a href=&quot;http://localhost:8080/%%%%&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8080/%%%%&lt;/a&gt; (note the missing &apos;?&apos;) leads to :&lt;br/&gt;
java.lang.NumberFormatException: %%&lt;br/&gt;
	at org.eclipse.jetty.util.TypeUtil.parseInt(TypeUtil.java:320)&lt;br/&gt;
	at org.eclipse.jetty.http.HttpURI.getDecodedPath(HttpURI.java:560)&lt;br/&gt;
	at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:440)&lt;br/&gt;
	at org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:47)&lt;br/&gt;
	at org.eclipse.jetty.server.AbstractHttpConnection.headerComplete(AbstractHttpConnection.java:884)&lt;br/&gt;
	at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.headerComplete(AbstractHttpConnection.java:938)&lt;br/&gt;
	at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:630)&lt;br/&gt;
	at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:230)&lt;br/&gt;
	at org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:66)&lt;br/&gt;
	at org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(SocketConnector.java:254)&lt;br/&gt;
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:603)&lt;br/&gt;
	at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:538)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:662)&lt;/p&gt;

&lt;p&gt;i.e. again error 500.&lt;/p&gt;

&lt;p&gt;The only way to show a Wicket page as a handler is to add:&lt;br/&gt;
 &amp;lt;error-page&amp;gt;&lt;br/&gt;
                &amp;lt;error-code&amp;gt;500&amp;lt;/error-code&amp;gt;&lt;br/&gt;
                &amp;lt;location&amp;gt;/error&amp;lt;/location&amp;gt;&lt;br/&gt;
        &amp;lt;/error-page&amp;gt;&lt;/p&gt;

&lt;p&gt;to web.xml and &lt;br/&gt;
#mountPage(&quot;error&quot;, getApplicationSettings().getInternalErrorPage());&lt;/p&gt;</comment>
                            <comment id="13581433" author="jriehn" created="Tue, 19 Feb 2013 16:47:43 +0000"  >&lt;p&gt;you figured out an specific web container issue. using a tomcat, you&apos;ll receive a bad request (http-status 400). the NumberFormatException, respectively the IllegalArgumentException, could be detected by wicket.&lt;br/&gt;
sorry, that i lead you astray - it&apos;s not the question, how to offer an error page for this behavior, but whether this behavior of wicket is desired.&lt;/p&gt;</comment>
                            <comment id="13581437" author="mgrigorov" created="Tue, 19 Feb 2013 16:56:02 +0000"  >&lt;p&gt;Well, it has been like this since several years.&lt;br/&gt;
I&apos;m not sure whether this behavior is correct. I&apos;ll test with pure servlet to see what is the behavior.&lt;/p&gt;

&lt;p&gt;Maybe we should change this to log a warning instead of throwing this unhandleable exception.&lt;/p&gt;</comment>
                            <comment id="13581576" author="mgrigorov" created="Tue, 19 Feb 2013 20:01:31 +0000"  >&lt;p&gt;With Servlet it is the same:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Jetty throws exception:&lt;br/&gt;
java.lang.IllegalArgumentException: !hex:25&lt;br/&gt;
	at org.eclipse.jetty.util.TypeUtil.convertHexDigit(TypeUtil.java:364)&lt;br/&gt;
	at org.eclipse.jetty.util.UrlEncoded.decodeUtf8To(UrlEncoded.java:329)&lt;br/&gt;
	at org.eclipse.jetty.http.HttpURI.decodeQueryTo(HttpURI.java:638)&lt;br/&gt;
	at org.eclipse.jetty.server.Request.extractParameters(Request.java:213)&lt;br/&gt;
	at org.eclipse.jetty.server.Request.getParameter(Request.java:679)&lt;br/&gt;
	at com.example.EchoServlet.handle(EchoServlet.java:29)&lt;br/&gt;
	at com.example.EchoServlet.doGet(EchoServlet.java:24)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)&lt;br/&gt;
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:565)&lt;br/&gt;
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:479)&lt;br/&gt;
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)&lt;br/&gt;
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:524)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Tomcat does nothing, just ignores the broken part of the query string&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The requested url is: &lt;a href=&quot;http://localhost:8080/echo?a=c%%%b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8080/echo?a=c%%%b&lt;/a&gt; and Tomcat says that the value for parameter &apos;a&apos; is null.&lt;/p&gt;</comment>
                            <comment id="13582025" author="mgrigorov" created="Wed, 20 Feb 2013 08:14:03 +0000"  >&lt;p&gt;From now on an info message will be logged and the problematic % character will be ignored.&lt;/p&gt;

&lt;p&gt;The problem with the thrown exception is that the application logs can be easily flooded by an attacker.&lt;/p&gt;</comment>
                            <comment id="13582062" author="jriehn" created="Wed, 20 Feb 2013 10:08:02 +0000"  >&lt;p&gt;Hej Martin,&lt;/p&gt;

&lt;p&gt;this is also my preferred solution. Thank you!&lt;/p&gt;

&lt;p&gt;Regards,&lt;/p&gt;

&lt;p&gt;Jan&lt;/p&gt;</comment>
                            <comment id="13592065" author="mgrigorov" created="Mon, 4 Mar 2013 08:32:29 +0000"  >&lt;p&gt;Here is a link to a discussion in Tomcat dev@ mailing list about changing this behavior: &lt;a href=&quot;http://markmail.org/thread/aymssrjhextkraip&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://markmail.org/thread/aymssrjhextkraip&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12550610">WICKET-4493</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12547779" name="WICKET-4803-quickstart-testcase-and-example.zip" size="45279" author="johanh@dns.be" created="Thu, 4 Oct 2012 16:36:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>240484</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 37 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i011xz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4081</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>