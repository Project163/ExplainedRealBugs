[{"url":"https://api.github.com/repos/microsoft/playwright/issues/comments/1932899296","html_url":"https://github.com/microsoft/playwright/issues/29402#issuecomment-1932899296","issue_url":"https://api.github.com/repos/microsoft/playwright/issues/29402","id":1932899296,"node_id":"IC_kwDODTssw85zNbPg","user":{"login":"zakiRefai","id":94134112,"node_id":"U_kgDOBZxfYA","avatar_url":"https://avatars.githubusercontent.com/u/94134112?v=4","gravatar_id":"","url":"https://api.github.com/users/zakiRefai","html_url":"https://github.com/zakiRefai","followers_url":"https://api.github.com/users/zakiRefai/followers","following_url":"https://api.github.com/users/zakiRefai/following{/other_user}","gists_url":"https://api.github.com/users/zakiRefai/gists{/gist_id}","starred_url":"https://api.github.com/users/zakiRefai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zakiRefai/subscriptions","organizations_url":"https://api.github.com/users/zakiRefai/orgs","repos_url":"https://api.github.com/users/zakiRefai/repos","events_url":"https://api.github.com/users/zakiRefai/events{/privacy}","received_events_url":"https://api.github.com/users/zakiRefai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-07T21:05:40Z","updated_at":"2024-02-07T21:05:40Z","body":"I ran the debugger and added a breakpoint at the `Write storage state to json` step. When the error occurs, Playwright seems to be opening a new tab in the browser showing the actions during the test. This only occurs when the `frame may be detached` error occurs. Could it be detaching itself from the current page?","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/microsoft/playwright/issues/comments/1932899296/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zakiRefai","id":94134112,"node_id":"U_kgDOBZxfYA","avatar_url":"https://avatars.githubusercontent.com/u/94134112?v=4","gravatar_id":"","url":"https://api.github.com/users/zakiRefai","html_url":"https://github.com/zakiRefai","followers_url":"https://api.github.com/users/zakiRefai/followers","following_url":"https://api.github.com/users/zakiRefai/following{/other_user}","gists_url":"https://api.github.com/users/zakiRefai/gists{/gist_id}","starred_url":"https://api.github.com/users/zakiRefai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zakiRefai/subscriptions","organizations_url":"https://api.github.com/users/zakiRefai/orgs","repos_url":"https://api.github.com/users/zakiRefai/repos","events_url":"https://api.github.com/users/zakiRefai/events{/privacy}","received_events_url":"https://api.github.com/users/zakiRefai/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/microsoft/playwright/issues/comments/1933121194","html_url":"https://github.com/microsoft/playwright/issues/29402#issuecomment-1933121194","issue_url":"https://api.github.com/repos/microsoft/playwright/issues/29402","id":1933121194,"node_id":"IC_kwDODTssw85zORaq","user":{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-07T23:40:57Z","updated_at":"2024-02-07T23:40:57Z","body":"@zakiRefai When saving storage state, Playwright internally uses a temporary page - that's probably the one you see when stopped on a breakpoint. I think the error comes from that page. However, I am not really sure what could trigger this error.\r\n\r\nWhat APIs do you call on the `BrowserContext`? `addInitScript` by any chance? Maybe something else? I wonder if you do something interesting that might hint at the origin of the bug.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/microsoft/playwright/issues/comments/1933121194/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11739124408,"node_id":"MEE_lADODTssw85-lGb5zwAAAAK7tNK4","url":"https://api.github.com/repos/microsoft/playwright/issues/events/11739124408","actor":{"login":"zakiRefai","id":94134112,"node_id":"U_kgDOBZxfYA","avatar_url":"https://avatars.githubusercontent.com/u/94134112?v=4","gravatar_id":"","url":"https://api.github.com/users/zakiRefai","html_url":"https://github.com/zakiRefai","followers_url":"https://api.github.com/users/zakiRefai/followers","following_url":"https://api.github.com/users/zakiRefai/following{/other_user}","gists_url":"https://api.github.com/users/zakiRefai/gists{/gist_id}","starred_url":"https://api.github.com/users/zakiRefai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zakiRefai/subscriptions","organizations_url":"https://api.github.com/users/zakiRefai/orgs","repos_url":"https://api.github.com/users/zakiRefai/repos","events_url":"https://api.github.com/users/zakiRefai/events{/privacy}","received_events_url":"https://api.github.com/users/zakiRefai/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-02-07T23:40:58Z","performed_via_github_app":null},{"id":11739124414,"node_id":"SE_lADODTssw85-lGb5zwAAAAK7tNK-","url":"https://api.github.com/repos/microsoft/playwright/issues/events/11739124414","actor":{"login":"zakiRefai","id":94134112,"node_id":"U_kgDOBZxfYA","avatar_url":"https://avatars.githubusercontent.com/u/94134112?v=4","gravatar_id":"","url":"https://api.github.com/users/zakiRefai","html_url":"https://github.com/zakiRefai","followers_url":"https://api.github.com/users/zakiRefai/followers","following_url":"https://api.github.com/users/zakiRefai/following{/other_user}","gists_url":"https://api.github.com/users/zakiRefai/gists{/gist_id}","starred_url":"https://api.github.com/users/zakiRefai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zakiRefai/subscriptions","organizations_url":"https://api.github.com/users/zakiRefai/orgs","repos_url":"https://api.github.com/users/zakiRefai/repos","events_url":"https://api.github.com/users/zakiRefai/events{/privacy}","received_events_url":"https://api.github.com/users/zakiRefai/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-02-07T23:40:58Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/microsoft/playwright/issues/comments/1933128642","html_url":"https://github.com/microsoft/playwright/issues/29402#issuecomment-1933128642","issue_url":"https://api.github.com/repos/microsoft/playwright/issues/29402","id":1933128642,"node_id":"IC_kwDODTssw85zOTPC","user":{"login":"zakiRefai","id":94134112,"node_id":"U_kgDOBZxfYA","avatar_url":"https://avatars.githubusercontent.com/u/94134112?v=4","gravatar_id":"","url":"https://api.github.com/users/zakiRefai","html_url":"https://github.com/zakiRefai","followers_url":"https://api.github.com/users/zakiRefai/followers","following_url":"https://api.github.com/users/zakiRefai/following{/other_user}","gists_url":"https://api.github.com/users/zakiRefai/gists{/gist_id}","starred_url":"https://api.github.com/users/zakiRefai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zakiRefai/subscriptions","organizations_url":"https://api.github.com/users/zakiRefai/orgs","repos_url":"https://api.github.com/users/zakiRefai/repos","events_url":"https://api.github.com/users/zakiRefai/events{/privacy}","received_events_url":"https://api.github.com/users/zakiRefai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-07T23:49:32Z","updated_at":"2024-02-07T23:51:07Z","body":"Can you elaborate on the APIs you are mentioning? I do not believe we are using any APIs on `BrowserContext`. The whole process of signing a user in from start to finish is detailed within the code I supplied. We call other APIs in between, but they do not apply to the `BrowserContext`; they only help facilitate logging in the user. \r\n\r\nDo you have any other suggestions as to what it might be? What kind of information can I provide more of to help get to the root cause of this issue?","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/microsoft/playwright/issues/comments/1933128642/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zakiRefai","id":94134112,"node_id":"U_kgDOBZxfYA","avatar_url":"https://avatars.githubusercontent.com/u/94134112?v=4","gravatar_id":"","url":"https://api.github.com/users/zakiRefai","html_url":"https://github.com/zakiRefai","followers_url":"https://api.github.com/users/zakiRefai/followers","following_url":"https://api.github.com/users/zakiRefai/following{/other_user}","gists_url":"https://api.github.com/users/zakiRefai/gists{/gist_id}","starred_url":"https://api.github.com/users/zakiRefai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zakiRefai/subscriptions","organizations_url":"https://api.github.com/users/zakiRefai/orgs","repos_url":"https://api.github.com/users/zakiRefai/repos","events_url":"https://api.github.com/users/zakiRefai/events{/privacy}","received_events_url":"https://api.github.com/users/zakiRefai/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/microsoft/playwright/issues/comments/1934436729","html_url":"https://github.com/microsoft/playwright/issues/29402#issuecomment-1934436729","issue_url":"https://api.github.com/repos/microsoft/playwright/issues/29402","id":1934436729,"node_id":"IC_kwDODTssw85zTSl5","user":{"login":"zakiRefai","id":94134112,"node_id":"U_kgDOBZxfYA","avatar_url":"https://avatars.githubusercontent.com/u/94134112?v=4","gravatar_id":"","url":"https://api.github.com/users/zakiRefai","html_url":"https://github.com/zakiRefai","followers_url":"https://api.github.com/users/zakiRefai/followers","following_url":"https://api.github.com/users/zakiRefai/following{/other_user}","gists_url":"https://api.github.com/users/zakiRefai/gists{/gist_id}","starred_url":"https://api.github.com/users/zakiRefai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zakiRefai/subscriptions","organizations_url":"https://api.github.com/users/zakiRefai/orgs","repos_url":"https://api.github.com/users/zakiRefai/repos","events_url":"https://api.github.com/users/zakiRefai/events{/privacy}","received_events_url":"https://api.github.com/users/zakiRefai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-08T16:00:40Z","updated_at":"2024-02-08T16:00:40Z","body":"@dgozman After some tinkering, I decided to go a different route with grabbing the storage state. I only need some items from localStorage so I have re-written the \"Write storage state to JSON\" to be like this:\r\n\r\n```javascript\r\nawait test.step('Write storage state to json', async () => {\r\n      // const storageState = await page.context().storageState({path: <path>});\r\n      const localStorage = await page.evaluate(() => window.localStorage);\r\n      console.log(localStorage);\r\n      // TODO: create a function to build the storage state file.\r\n    });\r\n```\r\n\r\nI intend to wrap the local storage returned here into the correct format that `await page.context().storageState({path: <path>});` normally outputs. Is this something you would recommend? Or should I do it some other way? It seems like I won't be able to fix what is going on with using `context().storageState({...})`, so maybe not using it is the next best solution.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/microsoft/playwright/issues/comments/1934436729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zakiRefai","id":94134112,"node_id":"U_kgDOBZxfYA","avatar_url":"https://avatars.githubusercontent.com/u/94134112?v=4","gravatar_id":"","url":"https://api.github.com/users/zakiRefai","html_url":"https://github.com/zakiRefai","followers_url":"https://api.github.com/users/zakiRefai/followers","following_url":"https://api.github.com/users/zakiRefai/following{/other_user}","gists_url":"https://api.github.com/users/zakiRefai/gists{/gist_id}","starred_url":"https://api.github.com/users/zakiRefai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zakiRefai/subscriptions","organizations_url":"https://api.github.com/users/zakiRefai/orgs","repos_url":"https://api.github.com/users/zakiRefai/repos","events_url":"https://api.github.com/users/zakiRefai/events{/privacy}","received_events_url":"https://api.github.com/users/zakiRefai/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11747947231,"node_id":"MEE_lADODTssw85-lGb5zwAAAAK8O3Lf","url":"https://api.github.com/repos/microsoft/playwright/issues/events/11747947231","actor":{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-02-08T16:00:42Z","performed_via_github_app":null},{"id":11747947253,"node_id":"SE_lADODTssw85-lGb5zwAAAAK8O3L1","url":"https://api.github.com/repos/microsoft/playwright/issues/events/11747947253","actor":{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-02-08T16:00:42Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/microsoft/playwright/issues/comments/1937849460","html_url":"https://github.com/microsoft/playwright/issues/29402#issuecomment-1937849460","issue_url":"https://api.github.com/repos/microsoft/playwright/issues/29402","id":1937849460,"node_id":"IC_kwDODTssw85zgTx0","user":{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-11T19:42:46Z","updated_at":"2024-02-11T19:42:46Z","body":"@zakiRefai Another idea we had: do you have a service worker on your page? Perhaps it is interfering with `storageState()`. We'll look into it.\r\n\r\n> Is this something you would recommend?\r\n\r\nIf you only care about the local storage on a single origin, that is a good workaround. That said, we'd prefer to fix the issue instead ðŸ˜„ Any chance for a repro? Perhaps you can isolate the issue and/or partially share your page/tests?","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/microsoft/playwright/issues/comments/1937849460/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11768054603,"node_id":"MEE_lADODTssw85-lGb5zwAAAAK9bkNL","url":"https://api.github.com/repos/microsoft/playwright/issues/events/11768054603","actor":{"login":"zakiRefai","id":94134112,"node_id":"U_kgDOBZxfYA","avatar_url":"https://avatars.githubusercontent.com/u/94134112?v=4","gravatar_id":"","url":"https://api.github.com/users/zakiRefai","html_url":"https://github.com/zakiRefai","followers_url":"https://api.github.com/users/zakiRefai/followers","following_url":"https://api.github.com/users/zakiRefai/following{/other_user}","gists_url":"https://api.github.com/users/zakiRefai/gists{/gist_id}","starred_url":"https://api.github.com/users/zakiRefai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zakiRefai/subscriptions","organizations_url":"https://api.github.com/users/zakiRefai/orgs","repos_url":"https://api.github.com/users/zakiRefai/repos","events_url":"https://api.github.com/users/zakiRefai/events{/privacy}","received_events_url":"https://api.github.com/users/zakiRefai/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-02-11T19:42:47Z","performed_via_github_app":null},{"id":11768054608,"node_id":"SE_lADODTssw85-lGb5zwAAAAK9bkNQ","url":"https://api.github.com/repos/microsoft/playwright/issues/events/11768054608","actor":{"login":"zakiRefai","id":94134112,"node_id":"U_kgDOBZxfYA","avatar_url":"https://avatars.githubusercontent.com/u/94134112?v=4","gravatar_id":"","url":"https://api.github.com/users/zakiRefai","html_url":"https://github.com/zakiRefai","followers_url":"https://api.github.com/users/zakiRefai/followers","following_url":"https://api.github.com/users/zakiRefai/following{/other_user}","gists_url":"https://api.github.com/users/zakiRefai/gists{/gist_id}","starred_url":"https://api.github.com/users/zakiRefai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zakiRefai/subscriptions","organizations_url":"https://api.github.com/users/zakiRefai/orgs","repos_url":"https://api.github.com/users/zakiRefai/repos","events_url":"https://api.github.com/users/zakiRefai/events{/privacy}","received_events_url":"https://api.github.com/users/zakiRefai/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-02-11T19:42:47Z","performed_via_github_app":null},{"id":11782840609,"node_id":"AE_lADODTssw85-lGb5zwAAAAK-T-Eh","url":"https://api.github.com/repos/microsoft/playwright/issues/events/11782840609","actor":{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2024-02-13T03:26:23Z","assignee":{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"id":11782840889,"node_id":"LE_lADODTssw85-lGb5zwAAAAK-T-I5","url":"https://api.github.com/repos/microsoft/playwright/issues/events/11782840889","actor":{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-02-13T03:26:27Z","label":{"name":"v1.43","color":"000000"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/microsoft/playwright/issues/comments/1944030708","html_url":"https://github.com/microsoft/playwright/issues/29402#issuecomment-1944030708","issue_url":"https://api.github.com/repos/microsoft/playwright/issues/29402","id":1944030708,"node_id":"IC_kwDODTssw85z3430","user":{"login":"zakiRefai","id":94134112,"node_id":"U_kgDOBZxfYA","avatar_url":"https://avatars.githubusercontent.com/u/94134112?v=4","gravatar_id":"","url":"https://api.github.com/users/zakiRefai","html_url":"https://github.com/zakiRefai","followers_url":"https://api.github.com/users/zakiRefai/followers","following_url":"https://api.github.com/users/zakiRefai/following{/other_user}","gists_url":"https://api.github.com/users/zakiRefai/gists{/gist_id}","starred_url":"https://api.github.com/users/zakiRefai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zakiRefai/subscriptions","organizations_url":"https://api.github.com/users/zakiRefai/orgs","repos_url":"https://api.github.com/users/zakiRefai/repos","events_url":"https://api.github.com/users/zakiRefai/events{/privacy}","received_events_url":"https://api.github.com/users/zakiRefai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-14T15:11:09Z","updated_at":"2024-02-14T15:11:09Z","body":"@dgozman We do have a service work attached to our app. Some context, our app runs on vite ^4.2.1. We use it for the [PWA](https://vite-pwa-org.netlify.app/) so that users can download our app from the web. It handles assets and such.\r\n\r\nI attempted to run playwright on a local build WITHOUT the PWA enabled, thus removing the service worker from the equation. I also updated the \"Write storage state to json\" step to include `page.context().storageState({...})`. \r\n\r\nI did NOT encounter the `frame may be detached...` error when running our setup functions for logging in our users. However, I did experience the same issue during some of our authenticated tests. We can repro the issue accurately and I will detail it below. Unfortunately, I still cannot give a reproducible example as this would involve giving you access to our QA environment with a QA account. I will try my best to explain everything occurring though.\r\n\r\nAs I said before, our setup functions log in our users, create a storage state file, and we then use those files at the start of our tests that require authentication. These are the steps that occur when our authenticated tests throw the `frame may be detached...` error:\r\n\r\n```javascript\r\n// Step 1: Use the storage state file\r\ntest.use({ storageState: <path_to_file> });\r\n\r\n// Step 2: Go to auth home\r\nawait test.step('Go to auth home page', async () => {\r\n    await authHomePage.goTo();\r\n});\r\n\r\n// Step 3: Go to a different part of the app via URL\r\nawait test.step('Go to cabinet page', async () => {\r\n    await cabinetPage.goTo();\r\n});\r\n``` \r\n\r\nThe `cabinetPage.goTo()` looks like this in our page object model:\r\n```javascript\r\nasync goTo() {\r\n   await this.page.goto('/cabinet');\r\n}\r\n````\r\n\r\nThe `frame may be detached...` error is thrown when `await cabinetPage.goTo();` is run. I can get this issue to occur reliably when I run the full suite of our tests. I can also get it to trigger sometimes when I run the test individually. This is occurring while the service worker has been removed.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/microsoft/playwright/issues/comments/1944030708/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zakiRefai","id":94134112,"node_id":"U_kgDOBZxfYA","avatar_url":"https://avatars.githubusercontent.com/u/94134112?v=4","gravatar_id":"","url":"https://api.github.com/users/zakiRefai","html_url":"https://github.com/zakiRefai","followers_url":"https://api.github.com/users/zakiRefai/followers","following_url":"https://api.github.com/users/zakiRefai/following{/other_user}","gists_url":"https://api.github.com/users/zakiRefai/gists{/gist_id}","starred_url":"https://api.github.com/users/zakiRefai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zakiRefai/subscriptions","organizations_url":"https://api.github.com/users/zakiRefai/orgs","repos_url":"https://api.github.com/users/zakiRefai/repos","events_url":"https://api.github.com/users/zakiRefai/events{/privacy}","received_events_url":"https://api.github.com/users/zakiRefai/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11803186973,"node_id":"MEE_lADODTssw85-lGb5zwAAAAK_hlcd","url":"https://api.github.com/repos/microsoft/playwright/issues/events/11803186973","actor":{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-02-14T15:11:10Z","performed_via_github_app":null},{"id":11803187063,"node_id":"SE_lADODTssw85-lGb5zwAAAAK_hld3","url":"https://api.github.com/repos/microsoft/playwright/issues/events/11803187063","actor":{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-02-14T15:11:10Z","performed_via_github_app":null},{"actor":{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-12T23:15:24Z","updated_at":"2024-03-12T23:15:24Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/microsoft/playwright/issues/29915","repository_url":"https://api.github.com/repos/microsoft/playwright","labels_url":"https://api.github.com/repos/microsoft/playwright/issues/29915/labels{/name}","comments_url":"https://api.github.com/repos/microsoft/playwright/issues/29915/comments","events_url":"https://api.github.com/repos/microsoft/playwright/issues/29915/events","html_url":"https://github.com/microsoft/playwright/pull/29915","id":2182835872,"node_id":"PR_kwDODTssw85pcZVB","number":29915,"title":"fix(storageState): try to collect storage state on existing pages first","user":{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-03-12T23:15:24Z","updated_at":"2024-03-13T02:20:36Z","closed_at":"2024-03-13T02:20:36Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":221981891,"node_id":"MDEwOlJlcG9zaXRvcnkyMjE5ODE4OTE=","name":"playwright","full_name":"microsoft/playwright","private":false,"owner":{"login":"microsoft","id":6154722,"node_id":"MDEyOk9yZ2FuaXphdGlvbjYxNTQ3MjI=","avatar_url":"https://avatars.githubusercontent.com/u/6154722?v=4","gravatar_id":"","url":"https://api.github.com/users/microsoft","html_url":"https://github.com/microsoft","followers_url":"https://api.github.com/users/microsoft/followers","following_url":"https://api.github.com/users/microsoft/following{/other_user}","gists_url":"https://api.github.com/users/microsoft/gists{/gist_id}","starred_url":"https://api.github.com/users/microsoft/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/microsoft/subscriptions","organizations_url":"https://api.github.com/users/microsoft/orgs","repos_url":"https://api.github.com/users/microsoft/repos","events_url":"https://api.github.com/users/microsoft/events{/privacy}","received_events_url":"https://api.github.com/users/microsoft/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/microsoft/playwright","description":"Playwright is a framework for Web Testing and Automation. It allows testing Chromium, Firefox and WebKit with a single API. ","fork":false,"url":"https://api.github.com/repos/microsoft/playwright","forks_url":"https://api.github.com/repos/microsoft/playwright/forks","keys_url":"https://api.github.com/repos/microsoft/playwright/keys{/key_id}","collaborators_url":"https://api.github.com/repos/microsoft/playwright/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/microsoft/playwright/teams","hooks_url":"https://api.github.com/repos/microsoft/playwright/hooks","issue_events_url":"https://api.github.com/repos/microsoft/playwright/issues/events{/number}","events_url":"https://api.github.com/repos/microsoft/playwright/events","assignees_url":"https://api.github.com/repos/microsoft/playwright/assignees{/user}","branches_url":"https://api.github.com/repos/microsoft/playwright/branches{/branch}","tags_url":"https://api.github.com/repos/microsoft/playwright/tags","blobs_url":"https://api.github.com/repos/microsoft/playwright/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/microsoft/playwright/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/microsoft/playwright/git/refs{/sha}","trees_url":"https://api.github.com/repos/microsoft/playwright/git/trees{/sha}","statuses_url":"https://api.github.com/repos/microsoft/playwright/statuses/{sha}","languages_url":"https://api.github.com/repos/microsoft/playwright/languages","stargazers_url":"https://api.github.com/repos/microsoft/playwright/stargazers","contributors_url":"https://api.github.com/repos/microsoft/playwright/contributors","subscribers_url":"https://api.github.com/repos/microsoft/playwright/subscribers","subscription_url":"https://api.github.com/repos/microsoft/playwright/subscription","commits_url":"https://api.github.com/repos/microsoft/playwright/commits{/sha}","git_commits_url":"https://api.github.com/repos/microsoft/playwright/git/commits{/sha}","comments_url":"https://api.github.com/repos/microsoft/playwright/comments{/number}","issue_comment_url":"https://api.github.com/repos/microsoft/playwright/issues/comments{/number}","contents_url":"https://api.github.com/repos/microsoft/playwright/contents/{+path}","compare_url":"https://api.github.com/repos/microsoft/playwright/compare/{base}...{head}","merges_url":"https://api.github.com/repos/microsoft/playwright/merges","archive_url":"https://api.github.com/repos/microsoft/playwright/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/microsoft/playwright/downloads","issues_url":"https://api.github.com/repos/microsoft/playwright/issues{/number}","pulls_url":"https://api.github.com/repos/microsoft/playwright/pulls{/number}","milestones_url":"https://api.github.com/repos/microsoft/playwright/milestones{/number}","notifications_url":"https://api.github.com/repos/microsoft/playwright/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/microsoft/playwright/labels{/name}","releases_url":"https://api.github.com/repos/microsoft/playwright/releases{/id}","deployments_url":"https://api.github.com/repos/microsoft/playwright/deployments","created_at":"2019-11-15T18:32:42Z","updated_at":"2025-11-09T20:37:29Z","pushed_at":"2025-11-08T00:38:15Z","git_url":"git://github.com/microsoft/playwright.git","ssh_url":"git@github.com:microsoft/playwright.git","clone_url":"https://github.com/microsoft/playwright.git","svn_url":"https://github.com/microsoft/playwright","homepage":"https://playwright.dev","size":219054,"stargazers_count":79140,"watchers_count":79140,"language":"TypeScript","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4802,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":564,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":true,"topics":["automation","chrome","chromium","e2e-testing","electron","end-to-end-testing","firefox","javascript","playwright","test","test-automation","testing","testing-tools","web","webkit"],"visibility":"public","forks":4802,"open_issues":564,"watchers":79140,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/microsoft/playwright/pulls/29915","html_url":"https://github.com/microsoft/playwright/pull/29915","diff_url":"https://github.com/microsoft/playwright/pull/29915.diff","patch_url":"https://github.com/microsoft/playwright/pull/29915.patch","merged_at":"2024-03-13T02:20:36Z"},"body":"This helps in a case where navigating to an origin fails for some reason, for example because a registered service worker loads some content into the supposedly blank page.\r\n\r\nFixes #29402.","reactions":{"url":"https://api.github.com/repos/microsoft/playwright/issues/29915/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/microsoft/playwright/issues/29915/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":12096948767,"node_id":"CE_lADODTssw85-lGb5zwAAAALRCMof","url":"https://api.github.com/repos/microsoft/playwright/issues/events/12096948767","actor":{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2024-03-13T02:20:37Z","state_reason":null,"performed_via_github_app":null},{"id":12096948807,"node_id":"REFE_lADODTssw85-lGb5zwAAAALRCMpH","url":"https://api.github.com/repos/microsoft/playwright/issues/events/12096948807","actor":{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"349b25e61a4814c7a7fc6f9d3bef4c3fdf7d505c","commit_url":"https://api.github.com/repos/microsoft/playwright/commits/349b25e61a4814c7a7fc6f9d3bef4c3fdf7d505c","created_at":"2024-03-13T02:20:37Z","performed_via_github_app":null}]