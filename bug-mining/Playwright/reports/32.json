{"url":"https://api.github.com/repos/microsoft/playwright/issues/29926","repository_url":"https://api.github.com/repos/microsoft/playwright","labels_url":"https://api.github.com/repos/microsoft/playwright/issues/29926/labels{/name}","comments_url":"https://api.github.com/repos/microsoft/playwright/issues/29926/comments","events_url":"https://api.github.com/repos/microsoft/playwright/issues/29926/events","html_url":"https://github.com/microsoft/playwright/issues/29926","id":2184360329,"node_id":"I_kwDODTssw86CMrGJ","number":29926,"title":"[REGRESSION]: JSON files no longer importable","user":{"login":"jm-mailosaur","id":29382899,"node_id":"MDQ6VXNlcjI5MzgyODk5","avatar_url":"https://avatars.githubusercontent.com/u/29382899?v=4","gravatar_id":"","url":"https://api.github.com/users/jm-mailosaur","html_url":"https://github.com/jm-mailosaur","followers_url":"https://api.github.com/users/jm-mailosaur/followers","following_url":"https://api.github.com/users/jm-mailosaur/following{/other_user}","gists_url":"https://api.github.com/users/jm-mailosaur/gists{/gist_id}","starred_url":"https://api.github.com/users/jm-mailosaur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jm-mailosaur/subscriptions","organizations_url":"https://api.github.com/users/jm-mailosaur/orgs","repos_url":"https://api.github.com/users/jm-mailosaur/repos","events_url":"https://api.github.com/users/jm-mailosaur/events{/privacy}","received_events_url":"https://api.github.com/users/jm-mailosaur/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":3932717508,"node_id":"LA_kwDODTssw87qaIHE","url":"https://api.github.com/repos/microsoft/playwright/labels/feature-components","name":"feature-components","color":"D4C5F9","default":false,"description":""},{"id":6122462647,"node_id":"LA_kwDODTssw88AAAABbO1dtw","url":"https://api.github.com/repos/microsoft/playwright/labels/v1.43","name":"v1.43","color":"000000","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"pavelfeldman","id":883973,"node_id":"MDQ6VXNlcjg4Mzk3Mw==","avatar_url":"https://avatars.githubusercontent.com/u/883973?v=4","gravatar_id":"","url":"https://api.github.com/users/pavelfeldman","html_url":"https://github.com/pavelfeldman","followers_url":"https://api.github.com/users/pavelfeldman/followers","following_url":"https://api.github.com/users/pavelfeldman/following{/other_user}","gists_url":"https://api.github.com/users/pavelfeldman/gists{/gist_id}","starred_url":"https://api.github.com/users/pavelfeldman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavelfeldman/subscriptions","organizations_url":"https://api.github.com/users/pavelfeldman/orgs","repos_url":"https://api.github.com/users/pavelfeldman/repos","events_url":"https://api.github.com/users/pavelfeldman/events{/privacy}","received_events_url":"https://api.github.com/users/pavelfeldman/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"pavelfeldman","id":883973,"node_id":"MDQ6VXNlcjg4Mzk3Mw==","avatar_url":"https://avatars.githubusercontent.com/u/883973?v=4","gravatar_id":"","url":"https://api.github.com/users/pavelfeldman","html_url":"https://github.com/pavelfeldman","followers_url":"https://api.github.com/users/pavelfeldman/followers","following_url":"https://api.github.com/users/pavelfeldman/following{/other_user}","gists_url":"https://api.github.com/users/pavelfeldman/gists{/gist_id}","starred_url":"https://api.github.com/users/pavelfeldman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavelfeldman/subscriptions","organizations_url":"https://api.github.com/users/pavelfeldman/orgs","repos_url":"https://api.github.com/users/pavelfeldman/repos","events_url":"https://api.github.com/users/pavelfeldman/events{/privacy}","received_events_url":"https://api.github.com/users/pavelfeldman/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":1,"created_at":"2024-03-13T15:54:29Z","updated_at":"2024-03-25T14:41:55Z","closed_at":"2024-03-25T14:41:55Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Version\r\n\r\n1.41.1\r\n\r\n### Steps to reproduce\r\n\r\nReproduction steps:\r\n1. Create an empty folder and init a Playwright project:\r\n\r\n```sh\r\nmkdir pw && cd pw\r\nnpm init playwright@latest -- --ct # Accept all defaults\r\n```\r\n\r\n2. Install dependencies:\r\n\r\n```sh\r\nnpm install react react-dom\r\n```\r\n\r\n3. Create an empty folder and add some test data:\r\n\r\n```sh\r\nmkdir -p tests/fixtures\r\necho '{\"foo\": \"bar\"}' > tests/fixtures/data.json\r\n```\r\n\r\n4. Create a file called `tests/example.spec.ts` and paste in this content:\r\n\r\n```ts\r\nimport { expect, test } from \"@playwright/experimental-ct-react\"; // eslint-disable-line import/no-restricted-paths\r\n\r\nimport data from \"./fixtures/data.json\";\r\n\r\ntest(\"basic first time usage\", async () => {\r\n  expect(data.foo).toContain(\"bar\");\r\n});\r\n```\r\n\r\n7. Run the tests and note that they fail on the latest version (currently 1.42.1):\r\n\r\n```sh\r\nnpm run test-ct\r\n```\r\n\r\n8. Now run this command to revert to 1.40.1 and note that the same tests pass:\r\n\r\n```sh\r\nnpm install @playwright/experimental-ct-react@1.40.1 && rm -rf playwright/.cache && npm run test-ct\r\n```\r\n\r\n8. Upgrade back to 1.41.1 and note that the tests now fail:\r\n\r\n```sh\r\nnpm install @playwright/experimental-ct-react@1.41.1 && rm -rf playwright/.cache && npm run test-ct\r\n```\r\n\r\nThe failure appears to be related to how 1.41.1 and above is importing the JSON file:\r\n\r\n```sh\r\nExpected value:  \"bar\"\r\nReceived object: {\"__pw_type\": \"importRef\", \"id\": \"__fixtures_data_json\", \"property\": \"foo\"}\r\n```\r\n\r\n### Expected behavior\r\n\r\nJson file should be imported correctly and so the value assertion should pass.\r\n\r\n### Actual behavior\r\n\r\nExpected value:  \"bar\"\r\nReceived object: {\"__pw_type\": \"importRef\", \"id\": \"__fixtures_data_json\", \"property\": \"foo\"}\r\n\r\n### Additional context\r\n\r\n_No response_\r\n\r\n### Environment\r\n\r\n```shell\r\nSystem:\r\n    OS: macOS 14.4\r\n    CPU: (10) arm64 Apple M1 Max\r\n    Memory: 5.75 GB / 64.00 GB\r\n  Binaries:\r\n    Node: 20.10.0 - ~/.nvm/versions/node/v20.10.0/bin/node\r\n    npm: 10.2.3 - ~/.nvm/versions/node/v20.10.0/bin/npm\r\n  IDEs:\r\n    VSCode: 1.87.2 - /usr/local/bin/code\r\n  Languages:\r\n    Bash: 3.2.57 - /bin/bash\r\n  npmPackages:\r\n    @playwright/experimental-ct-react: ^1.42.1 => 1.42.1\r\n```\r\n","closed_by":{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/microsoft/playwright/issues/29926/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/microsoft/playwright/issues/29926/timeline","performed_via_github_app":null,"state_reason":"completed"}