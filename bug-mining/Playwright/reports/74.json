{"url":"https://api.github.com/repos/microsoft/playwright/issues/32103","repository_url":"https://api.github.com/repos/microsoft/playwright","labels_url":"https://api.github.com/repos/microsoft/playwright/issues/32103/labels{/name}","comments_url":"https://api.github.com/repos/microsoft/playwright/issues/32103/comments","events_url":"https://api.github.com/repos/microsoft/playwright/issues/32103/events","html_url":"https://github.com/microsoft/playwright/issues/32103","id":2458366396,"node_id":"I_kwDODTssw86Sh7G8","number":32103,"title":"[Bug]: UI Mode restart doesn't restart server with `reuseExistingServer: false`","user":{"login":"karlhorky","id":1935696,"node_id":"MDQ6VXNlcjE5MzU2OTY=","avatar_url":"https://avatars.githubusercontent.com/u/1935696?v=4","gravatar_id":"","url":"https://api.github.com/users/karlhorky","html_url":"https://github.com/karlhorky","followers_url":"https://api.github.com/users/karlhorky/followers","following_url":"https://api.github.com/users/karlhorky/following{/other_user}","gists_url":"https://api.github.com/users/karlhorky/gists{/gist_id}","starred_url":"https://api.github.com/users/karlhorky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karlhorky/subscriptions","organizations_url":"https://api.github.com/users/karlhorky/orgs","repos_url":"https://api.github.com/users/karlhorky/repos","events_url":"https://api.github.com/users/karlhorky/events{/privacy}","received_events_url":"https://api.github.com/users/karlhorky/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":7211038747,"node_id":"LA_kwDODTssw88AAAABrc-4Gw","url":"https://api.github.com/repos/microsoft/playwright/labels/v1.47","name":"v1.47","color":"000000","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":2,"created_at":"2024-08-09T17:32:35Z","updated_at":"2024-09-30T12:20:42Z","closed_at":"2024-08-22T12:48:32Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Version\r\n\r\n1.46.0\r\n\r\n### Steps to reproduce\r\n\r\n1. Make sure you have `reuseExistingServer: false` configured (this is the default if unconfigured in `playwright.config.ts`)\r\n2. Start [Playwright UI Mode](https://playwright.dev/docs/test-ui-mode#errors) with `playwright test --ui`\r\n3. Wait for server to start\r\n4. Click on the \"Reload\" button (screenshot below)\r\n   ![Screenshot 2024-08-09 at 19 23 28](https://github.com/user-attachments/assets/2a39c47f-b6df-4e11-a3cb-53689853e0fa)\r\n5. Click on the \"Toggle Output\" button (screenshot below)\r\n   ![Screenshot 2024-08-09 at 19 32 49](https://github.com/user-attachments/assets/155cb7b9-0c99-488c-8f8e-a9f7204ba688)\r\n6. Observe the \"already used\" error message(s)\r\n   ```\r\n   $ NODE_ENV=test yarn start\r\n   [WebServer] Listening at http://localhost:3000\r\n   warning package.json: No license field\r\n   $ NODE_ENV=test yarn start\r\n   warning package.json: No license field\r\n   [WebServer] Listening at http://localhost:3010\r\n   [WebServer] GET /icons/icon-48x48.png?v=dad84ffd6565cb5f517328c25c456b99 302 3.466 ms - 28\r\n   [WebServer] GET /login 200 2.570 ms - 460184\r\n\r\n   Error: http://localhost:3000 is already used, make sure that nothing is running on the port/url or set reuseExistingServer:true in config.webServer.\r\n\r\n   Error: http://localhost:3000 is already used, make sure that nothing is running on the port/url or set reuseExistingServer:true in config.webServer.\r\n   ```\r\n   \r\n   ![Screenshot 2024-08-09 at 19 16 14](https://github.com/user-attachments/assets/f524c054-c5f3-47eb-beb1-78a7e2ba6cd9)\r\n\r\n\r\nAlternative step 4 (after macOS system sleep):\r\n\r\n4. Sleep the macOS system (apple menu -> Sleep) and re-wake. Click on \"Reload the page\" link in the \"UI Mode disconnected\" screen:\r\n   ![Screenshot 2024-08-09 at 19 17 33](https://github.com/user-attachments/assets/c36d0cc6-7248-45b2-97b9-d627b76bb01d)   \r\n\r\n### Expected behavior\r\n\r\nServers are also restarted when clicking on \"Reload\" button or \"Reload the page\" if `reuseExistingServer: false`\r\n\r\n### Actual behavior\r\n\r\nServers are not restarted when clicking on \"Reload\" button or \"Reload the page\" if `reuseExistingServer: false`, leading to \"already used\" errors described above\r\n\r\n### Additional context\r\n\r\n_No response_\r\n\r\n### Environment\r\n\r\n```shell\r\nSystem:\r\n    OS: macOS 14.6.1\r\n    CPU: (8) arm64 Apple M1\r\n    Memory: 70.97 MB / 16.00 GB\r\n  Binaries:\r\n    Node: 20.15.0 - /opt/homebrew/bin/node\r\n    Yarn: 1.22.22 - /opt/homebrew/bin/yarn\r\n    npm: 10.7.0 - /opt/homebrew/bin/npm\r\n    bun: 1.1.21 - /opt/homebrew/bin/bun\r\n  IDEs:\r\n    VSCode: 1.92.1 - /opt/homebrew/bin/code\r\n  Languages:\r\n    Bash: 5.2.0 - /opt/homebrew/bin/bash\r\n```\r\n","closed_by":{"login":"dgozman","id":9881434,"node_id":"MDQ6VXNlcjk4ODE0MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9881434?v=4","gravatar_id":"","url":"https://api.github.com/users/dgozman","html_url":"https://github.com/dgozman","followers_url":"https://api.github.com/users/dgozman/followers","following_url":"https://api.github.com/users/dgozman/following{/other_user}","gists_url":"https://api.github.com/users/dgozman/gists{/gist_id}","starred_url":"https://api.github.com/users/dgozman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgozman/subscriptions","organizations_url":"https://api.github.com/users/dgozman/orgs","repos_url":"https://api.github.com/users/dgozman/repos","events_url":"https://api.github.com/users/dgozman/events{/privacy}","received_events_url":"https://api.github.com/users/dgozman/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/microsoft/playwright/issues/32103/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/microsoft/playwright/issues/32103/timeline","performed_via_github_app":null,"state_reason":"completed"}