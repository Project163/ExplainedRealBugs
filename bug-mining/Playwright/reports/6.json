{"url":"https://api.github.com/repos/microsoft/playwright/issues/28702","repository_url":"https://api.github.com/repos/microsoft/playwright","labels_url":"https://api.github.com/repos/microsoft/playwright/issues/28702/labels{/name}","comments_url":"https://api.github.com/repos/microsoft/playwright/issues/28702/comments","events_url":"https://api.github.com/repos/microsoft/playwright/issues/28702/events","html_url":"https://github.com/microsoft/playwright/issues/28702","id":2047161622,"node_id":"I_kwDODTssw856BTUW","number":28702,"title":"[Feature] Make expect configurable when not using test runner","user":{"login":"Georgegriff","id":9056958,"node_id":"MDQ6VXNlcjkwNTY5NTg=","avatar_url":"https://avatars.githubusercontent.com/u/9056958?v=4","gravatar_id":"","url":"https://api.github.com/users/Georgegriff","html_url":"https://github.com/Georgegriff","followers_url":"https://api.github.com/users/Georgegriff/followers","following_url":"https://api.github.com/users/Georgegriff/following{/other_user}","gists_url":"https://api.github.com/users/Georgegriff/gists{/gist_id}","starred_url":"https://api.github.com/users/Georgegriff/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Georgegriff/subscriptions","organizations_url":"https://api.github.com/users/Georgegriff/orgs","repos_url":"https://api.github.com/users/Georgegriff/repos","events_url":"https://api.github.com/users/Georgegriff/events{/privacy}","received_events_url":"https://api.github.com/users/Georgegriff/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2167339959,"node_id":"MDU6TGFiZWwyMTY3MzM5OTU5","url":"https://api.github.com/repos/microsoft/playwright/labels/P3-collecting-feedback","name":"P3-collecting-feedback","color":"0e8a16","default":false,"description":""},{"id":5070007614,"node_id":"LA_kwDODTssw88AAAABLjItPg","url":"https://api.github.com/repos/microsoft/playwright/labels/open-to-a-pull-request","name":"open-to-a-pull-request","color":"C2E0C6","default":false,"description":"The feature request looks good, we are open to reviewing a PR"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2023-12-18T17:54:50Z","updated_at":"2023-12-19T18:55:07Z","closed_at":"2023-12-19T18:55:06Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"We are starting to use artillery with its playwright engine https://github.com/artilleryio/artillery/tree/main/packages/artillery-engine-playwright.\r\n\r\nArtillery has its own runner so it does not interact with playwright within a test. This means we cannot use the playwright.config.ts or use features that only work inside of a test.\r\n\r\nWe have lots of existing page object models with lots of use of `expect` from `@playwright/test` we want to re-use as much as possible, things are working really well except for we cannot configure:\r\n\r\n```ts\r\n{\r\nexpect: {\r\n    timeout: 15000,\r\n}\r\n}\r\n```\r\n\r\nI know we can call `.configure` and create our own modified expect but this does not seem to work for locators.\r\n```ts\r\nexport const expect = baseExpect.configure({\r\n  timeout: 15000,\r\n});\r\n```\r\ni tried this and updated all our imports to use this and it seems to have no effect\r\n![image](https://github.com/microsoft/playwright/assets/9056958/88b6a2c9-cc74-4c35-8b64-c7bd66d3be8b)\r\n\r\n\r\nI think this is happening here: https://github.com/microsoft/playwright/blob/e2c335a40cc49edbfc7a0b0596f71d4058f8dcfb/packages/playwright/src/matchers/expect.ts#L246 it seems there is no way to get the expect configuration into here.\r\nI wonder if the early return could respect this setting by moving this code?\r\n![image](https://github.com/microsoft/playwright/assets/9056958/ee948858-d618-49af-8306-9bb666c106f7)\r\n\r\n\r\nI'm not sure if this is locator-specific or not.\r\n\r\nI suppose i could override and proxy every matcher we use, but that wouldn't be ideal, and i'm not sure i'd even be able to because the built-in matches aren't exposed in the package exports which would leave some horrible Proxy solution","closed_by":{"login":"pavelfeldman","id":883973,"node_id":"MDQ6VXNlcjg4Mzk3Mw==","avatar_url":"https://avatars.githubusercontent.com/u/883973?v=4","gravatar_id":"","url":"https://api.github.com/users/pavelfeldman","html_url":"https://github.com/pavelfeldman","followers_url":"https://api.github.com/users/pavelfeldman/followers","following_url":"https://api.github.com/users/pavelfeldman/following{/other_user}","gists_url":"https://api.github.com/users/pavelfeldman/gists{/gist_id}","starred_url":"https://api.github.com/users/pavelfeldman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavelfeldman/subscriptions","organizations_url":"https://api.github.com/users/pavelfeldman/orgs","repos_url":"https://api.github.com/users/pavelfeldman/repos","events_url":"https://api.github.com/users/pavelfeldman/events{/privacy}","received_events_url":"https://api.github.com/users/pavelfeldman/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/microsoft/playwright/issues/28702/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/microsoft/playwright/issues/28702/timeline","performed_via_github_app":null,"state_reason":"completed"}