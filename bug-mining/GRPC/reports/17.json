{"url":"https://api.github.com/repos/grpc/grpc/issues/34844","repository_url":"https://api.github.com/repos/grpc/grpc","labels_url":"https://api.github.com/repos/grpc/grpc/issues/34844/labels{/name}","comments_url":"https://api.github.com/repos/grpc/grpc/issues/34844/comments","events_url":"https://api.github.com/repos/grpc/grpc/issues/34844/events","html_url":"https://github.com/grpc/grpc/issues/34844","id":1972046230,"node_id":"I_kwDOAacf2M51iwmW","number":34844,"title":"assertion path != nullptr in LoadBalancedCall::PickSubchannelImpl()","user":{"login":"segoon","id":160934,"node_id":"MDQ6VXNlcjE2MDkzNA==","avatar_url":"https://avatars.githubusercontent.com/u/160934?v=4","gravatar_id":"","url":"https://api.github.com/users/segoon","html_url":"https://github.com/segoon","followers_url":"https://api.github.com/users/segoon/followers","following_url":"https://api.github.com/users/segoon/following{/other_user}","gists_url":"https://api.github.com/users/segoon/gists{/gist_id}","starred_url":"https://api.github.com/users/segoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/segoon/subscriptions","organizations_url":"https://api.github.com/users/segoon/orgs","repos_url":"https://api.github.com/users/segoon/repos","events_url":"https://api.github.com/users/segoon/events{/privacy}","received_events_url":"https://api.github.com/users/segoon/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":155504842,"node_id":"MDU6TGFiZWwxNTU1MDQ4NDI=","url":"https://api.github.com/repos/grpc/grpc/labels/kind/bug","name":"kind/bug","color":"93732c","default":false,"description":null},{"id":166332908,"node_id":"MDU6TGFiZWwxNjYzMzI5MDg=","url":"https://api.github.com/repos/grpc/grpc/labels/lang/c++","name":"lang/c++","color":"fad8c7","default":false,"description":null},{"id":360790193,"node_id":"MDU6TGFiZWwzNjA3OTAxOTM=","url":"https://api.github.com/repos/grpc/grpc/labels/priority/P2","name":"priority/P2","color":"dd7172","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"markdroth","id":18664614,"node_id":"MDQ6VXNlcjE4NjY0NjE0","avatar_url":"https://avatars.githubusercontent.com/u/18664614?v=4","gravatar_id":"","url":"https://api.github.com/users/markdroth","html_url":"https://github.com/markdroth","followers_url":"https://api.github.com/users/markdroth/followers","following_url":"https://api.github.com/users/markdroth/following{/other_user}","gists_url":"https://api.github.com/users/markdroth/gists{/gist_id}","starred_url":"https://api.github.com/users/markdroth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markdroth/subscriptions","organizations_url":"https://api.github.com/users/markdroth/orgs","repos_url":"https://api.github.com/users/markdroth/repos","events_url":"https://api.github.com/users/markdroth/events{/privacy}","received_events_url":"https://api.github.com/users/markdroth/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"markdroth","id":18664614,"node_id":"MDQ6VXNlcjE4NjY0NjE0","avatar_url":"https://avatars.githubusercontent.com/u/18664614?v=4","gravatar_id":"","url":"https://api.github.com/users/markdroth","html_url":"https://github.com/markdroth","followers_url":"https://api.github.com/users/markdroth/followers","following_url":"https://api.github.com/users/markdroth/following{/other_user}","gists_url":"https://api.github.com/users/markdroth/gists{/gist_id}","starred_url":"https://api.github.com/users/markdroth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markdroth/subscriptions","organizations_url":"https://api.github.com/users/markdroth/orgs","repos_url":"https://api.github.com/users/markdroth/repos","events_url":"https://api.github.com/users/markdroth/events{/privacy}","received_events_url":"https://api.github.com/users/markdroth/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":9,"created_at":"2023-11-01T09:51:35Z","updated_at":"2024-01-31T16:45:16Z","closed_at":"2024-01-31T16:45:16Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### What version of gRPC and what language are you using?\r\nC++ 1.54.2\r\n\r\n### What operating system (Linux, Windows,...) and version?\r\nUbuntu 20.04\r\n\r\n### What runtime / compiler are you using (e.g. python version or version of gcc)\r\nclang 14\r\n\r\n### What did you do?\r\nI use grpc in a backend application with 1000-2000 RPS. From time to time I get assertion failed as in the stacktrace below. The same happens in several other services with lower RPS.\r\n\r\n### What did you expect to see?\r\n\r\n\r\n### What did you see instead?\r\n```\r\n(gdb) where\r\n#0  0x00007fb7ac56ce87 in raise () from /lib/x86_64-linux-gnu/libc.so.6\r\n#1  0x00007fb7ac56e7f1 in abort () from /lib/x86_64-linux-gnu/libc.so.6\r\n#2  0x0000000009cb6f42 in grpc_core::Crash(std::__y1::basic_string_view<char, std::__y1::char_traits<char>>, grpc_core::SourceLocation) (message=\"ASSERTION FAILED: path != nullptr\", location=...)\r\n    at /-S/contrib/libs/grpc/src/core/lib/gprpp/crash.cc:42\r\n#3  0x0000000009cb5f0d in gpr_assertion_failed (\r\n    filename=0x30540c \"/place/sandbox-data/tasks/3/7/1949778773/__FUSE/mount_path_e568179a-04ce-4ce7-90b8-146c601ef4f7/trunk/arcadia/contrib/libs/grpc/src/core/ext/filters/client_channel/client_channel.cc\", line=2675,\r\n    message=0x31e4c1 \"path != nullptr\") at /-S/contrib/libs/grpc/src/core/lib/gpr/log.cc:53\r\n#4  0x0000000009e0ac5b in grpc_core::ClientChannel::LoadBalancedCall::PickSubchannelImpl (\r\n    this=this@entry=0x7fb723b34f10, picker=0x7fb7328004c0, error=error@entry=0x7fb73d762208)\r\n    at /-S/contrib/libs/grpc/src/core/ext/filters/client_channel/client_channel.cc:2675\r\n#5  0x0000000009e0a5e5 in grpc_core::ClientChannel::LoadBalancedCall::PickSubchannel (this=this@entry=0x7fb723b34f10,\r\n    was_queued=false) at /-S/contrib/libs/grpc/src/core/ext/filters/client_channel/client_channel.cc:2632\r\n#6  0x0000000009e0c937 in grpc_core::ClientChannel::FilterBasedLoadBalancedCall::TryPick (\r\n    this=this@entry=0x7fb723b34f10, was_queued=false)\r\n    at /-S/contrib/libs/grpc/src/core/ext/filters/client_channel/client_channel.cc:3155\r\n#7  0x0000000009e0bf15 in grpc_core::ClientChannel::FilterBasedLoadBalancedCall::StartTransportStreamOpBatch (\r\n    this=0x7fb723b34f10, batch=0x7fb723b35088)\r\n    at /-S/contrib/libs/grpc/src/core/ext/filters/client_channel/client_channel.cc:3015\r\n#8  0x0000000009cdc44d in exec_ctx_run (closure=0x7fb723b350a8)\r\n    at /-S/contrib/libs/grpc/src/core/lib/iomgr/exec_ctx.cc:45\r\n#9  grpc_core::ExecCtx::Flush (this=0x7fb73d7623c0) at /-S/contrib/libs/grpc/src/core/lib/iomgr/exec_ctx.cc:72\r\n#10 0x0000000009cb5777 in grpc_core::ExecCtx::~ExecCtx (this=0x2)\r\n    at /-S/contrib/libs/grpc/src/core/lib/iomgr/exec_ctx.h:117\r\n#11 0x0000000009e225cb in grpc_core::(anonymous namespace)::RetryFilter::CallData::StartRetryTimer(std::__y1::optional<grpc_core::Duration>)::$_5::operator()() const (this=<optimized out>)\r\n    at /-S/contrib/libs/grpc/src/core/ext/filters/client_channel/retry_filter.cc:2594\r\n#12 decltype(static_cast<grpc_core::(anonymous namespace)::RetryFilter::CallData::StartRetryTimer(std::__y1::optional<gr--Type <RET> for more, q to quit, c to continue without paging--c\r\npc_core::Duration>)::$_5&>(fp)()) std::__y1::__invoke<grpc_core::(anonymous namespace)::RetryFilter::CallData::StartRetryTimer(std::__y1::optional<grpc_core::Duration>)::$_5&>(grpc_core::(anonymous namespace)::RetryFilter::CallData::StartRetryTimer(std::__y1::optional<grpc_core::Duration>)::$_5&) (__f=...)\r\n    at /-S/contrib/libs/cxxsupp/libcxx/include/type_traits:3663\r\n#13 std::__y1::invoke_result<grpc_core::(anonymous namespace)::RetryFilter::CallData::StartRetryTimer(std::__y1::optional<grpc_core::Duration>)::$_5&>::type std::__y1::invoke<grpc_core::(anonymous namespace)::RetryFilter::CallData::StartRetryTimer(std::__y1::optional<grpc_core::Duration>)::$_5&>(grpc_core::(anonymous namespace)::RetryFilter::CallData::StartRetryTimer(std::__y1::optional<grpc_core::Duration>)::$_5&) (__f=...)\r\n    at /-S/contrib/libs/cxxsupp/libcxx/include/__functional/invoke.h:93\r\n#14 void y_absl::lts_y_20230802::internal_any_invocable::InvokeR<void, grpc_core::(anonymous namespace)::RetryFilter::CallData::StartRetryTimer(std::__y1::optional<grpc_core::Duration>)::$_5&, void>(grpc_core::(anonymous namespace)::RetryFilter::CallData::StartRetryTimer(std::__y1::optional<grpc_core::Duration>)::$_5&) (f=...)\r\n    at /-S/contrib/restricted/abseil-cpp-tstring/y_absl/functional/internal/any_invocable.h:132\r\n#15 void y_absl::lts_y_20230802::internal_any_invocable::LocalInvoker<false, void, grpc_core::(anonymous namespace)::RetryFilter::CallData::StartRetryTimer(std::__y1::optional<grpc_core::Duration>)::$_5&>(y_absl::lts_y_20230802::internal_any_invocable::TypeErasedState*) (state=<optimized out>)\r\n    at /-S/contrib/restricted/abseil-cpp-tstring/y_absl/functional/internal/any_invocable.h:310\r\n#16 0x0000000009d10a7a in y_absl::lts_y_20230802::internal_any_invocable::Impl<void ()>::operator()() (\r\n    this=0x7fb725807950) at /-S/contrib/restricted/abseil-cpp-tstring/y_absl/functional/internal/any_invocable.h:868\r\n#17 grpc_event_engine::experimental::PosixEventEngine::ClosureData::Run (this=0x7fb725807940)\r\n    at /-S/contrib/libs/grpc/src/core/lib/event_engine/posix_engine/posix_engine.cc:413\r\n#18 0x0000000009d25998 in y_absl::lts_y_20230802::internal_any_invocable::Impl<void ()>::operator()() (\r\n    this=0x7fb73d762480) at /-S/contrib/restricted/abseil-cpp-tstring/y_absl/functional/internal/any_invocable.h:868\r\n#19 grpc_event_engine::experimental::ThreadPool::Queue::Step (this=0x7fb761c3a018)\r\n    at /-S/contrib/libs/grpc/src/core/lib/event_engine/thread_pool.cc:170\r\n#20 0x0000000009d25768 in grpc_event_engine::experimental::ThreadPool::ThreadFunc (\r\n    state=std::__y1::shared_ptr (count 67, weak 0) = 0x7fb761c3a018)\r\n    at /-S/contrib/libs/grpc/src/core/lib/event_engine/thread_pool.cc:140\r\n#21 0x0000000009d266a9 in grpc_event_engine::experimental::ThreadPool::StartThread(std::__y1::shared_ptr<grpc_event_engine::experimental::ThreadPool::State>, grpc_event_engine::experimental::ThreadPool::StartThreadReason)::$_0::operator()(void*) const (this=<optimized out>, arg=<optimized out>)\r\n    at /-S/contrib/libs/grpc/src/core/lib/event_engine/thread_pool.cc:132\r\n#22 grpc_event_engine::experimental::ThreadPool::StartThread(std::__y1::shared_ptr<grpc_event_engine::experimental::ThreadPool::State>, grpc_event_engine::experimental::ThreadPool::StartThreadReason)::$_0::__invoke(void*) (\r\n    arg=0x7fb761c023e0) at /-S/contrib/libs/grpc/src/core/lib/event_engine/thread_pool.cc:113\r\n#23 0x0000000009cf650c in grpc_core::(anonymous namespace)::ThreadInternalsPosix::ThreadInternalsPosix(char const*, void (*)(void*), void*, bool*, grpc_core::Thread::Options const&)::'lambda'(void*)::operator()(void*) const (\r\n    v=<optimized out>, this=<optimized out>) at /-S/contrib/libs/grpc/src/core/lib/gprpp/posix/thd.cc:135\r\n#24 grpc_core::(anonymous namespace)::ThreadInternalsPosix::ThreadInternalsPosix(char const*, void (*)(void*), void*, bool*, grpc_core::Thread::Options const&)::'lambda'(void*)::__invoke(void*) (v=<optimized out>)\r\n    at /-S/contrib/libs/grpc/src/core/lib/gprpp/posix/thd.cc:117\r\n#25 0x00007fb7acb5e6db in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#26 0x00007fb7ac64f61f in clone () from /lib/x86_64-linux-gnu/libc.so.6\r\n```\r\n\r\n\r\n### Anything else we should know about your project / environment?\r\n","closed_by":{"login":"copybara-service[bot]","id":56741989,"node_id":"MDM6Qm90NTY3NDE5ODk=","avatar_url":"https://avatars.githubusercontent.com/in/44061?v=4","gravatar_id":"","url":"https://api.github.com/users/copybara-service%5Bbot%5D","html_url":"https://github.com/apps/copybara-service","followers_url":"https://api.github.com/users/copybara-service%5Bbot%5D/followers","following_url":"https://api.github.com/users/copybara-service%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/copybara-service%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/copybara-service%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/copybara-service%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/copybara-service%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/copybara-service%5Bbot%5D/repos","events_url":"https://api.github.com/users/copybara-service%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/copybara-service%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/grpc/grpc/issues/34844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/grpc/grpc/issues/34844/timeline","performed_via_github_app":null,"state_reason":"completed"}