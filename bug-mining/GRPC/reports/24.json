{"url":"https://api.github.com/repos/grpc/grpc/issues/37306","repository_url":"https://api.github.com/repos/grpc/grpc","labels_url":"https://api.github.com/repos/grpc/grpc/issues/37306/labels{/name}","comments_url":"https://api.github.com/repos/grpc/grpc/issues/37306/comments","events_url":"https://api.github.com/repos/grpc/grpc/issues/37306/events","html_url":"https://github.com/grpc/grpc/issues/37306","id":2427707354,"node_id":"I_kwDOAacf2M6Qs9_a","number":37306,"title":"Temporary DNS error reported with status code `UNKNOWN`","user":{"login":"coryan","id":6241635,"node_id":"MDQ6VXNlcjYyNDE2MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6241635?v=4","gravatar_id":"","url":"https://api.github.com/users/coryan","html_url":"https://github.com/coryan","followers_url":"https://api.github.com/users/coryan/followers","following_url":"https://api.github.com/users/coryan/following{/other_user}","gists_url":"https://api.github.com/users/coryan/gists{/gist_id}","starred_url":"https://api.github.com/users/coryan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coryan/subscriptions","organizations_url":"https://api.github.com/users/coryan/orgs","repos_url":"https://api.github.com/users/coryan/repos","events_url":"https://api.github.com/users/coryan/events{/privacy}","received_events_url":"https://api.github.com/users/coryan/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":155504842,"node_id":"MDU6TGFiZWwxNTU1MDQ4NDI=","url":"https://api.github.com/repos/grpc/grpc/labels/kind/bug","name":"kind/bug","color":"93732c","default":false,"description":null},{"id":218696181,"node_id":"MDU6TGFiZWwyMTg2OTYxODE=","url":"https://api.github.com/repos/grpc/grpc/labels/lang/core","name":"lang/core","color":"fad8c7","default":false,"description":""},{"id":360790193,"node_id":"MDU6TGFiZWwzNjA3OTAxOTM=","url":"https://api.github.com/repos/grpc/grpc/labels/priority/P2","name":"priority/P2","color":"dd7172","default":false,"description":""},{"id":3940839694,"node_id":"LA_kwDOAacf2M7q5HEO","url":"https://api.github.com/repos/grpc/grpc/labels/untriaged","name":"untriaged","color":"c2e0c6","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"yijiem","id":5663878,"node_id":"MDQ6VXNlcjU2NjM4Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/5663878?v=4","gravatar_id":"","url":"https://api.github.com/users/yijiem","html_url":"https://github.com/yijiem","followers_url":"https://api.github.com/users/yijiem/followers","following_url":"https://api.github.com/users/yijiem/following{/other_user}","gists_url":"https://api.github.com/users/yijiem/gists{/gist_id}","starred_url":"https://api.github.com/users/yijiem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yijiem/subscriptions","organizations_url":"https://api.github.com/users/yijiem/orgs","repos_url":"https://api.github.com/users/yijiem/repos","events_url":"https://api.github.com/users/yijiem/events{/privacy}","received_events_url":"https://api.github.com/users/yijiem/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"yijiem","id":5663878,"node_id":"MDQ6VXNlcjU2NjM4Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/5663878?v=4","gravatar_id":"","url":"https://api.github.com/users/yijiem","html_url":"https://github.com/yijiem","followers_url":"https://api.github.com/users/yijiem/followers","following_url":"https://api.github.com/users/yijiem/following{/other_user}","gists_url":"https://api.github.com/users/yijiem/gists{/gist_id}","starred_url":"https://api.github.com/users/yijiem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yijiem/subscriptions","organizations_url":"https://api.github.com/users/yijiem/orgs","repos_url":"https://api.github.com/users/yijiem/repos","events_url":"https://api.github.com/users/yijiem/events{/privacy}","received_events_url":"https://api.github.com/users/yijiem/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":3,"created_at":"2024-07-24T14:11:32Z","updated_at":"2024-08-05T20:30:53Z","closed_at":"2024-08-05T20:30:53Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### What version of gRPC and what language are you using?\r\n\r\nC++, v1.65.1\r\n\r\n### What operating system (Linux, Windows,...) and version?\r\n\r\nLinux.\r\n\r\n### What runtime / compiler are you using (e.g. python version or version of gcc)\r\n\r\nGCC 13.2\r\n\r\n### What did you do?\r\n\r\nI am running integration tests for `google-cloud-cpp` on my workstation.  The test creates a client-side streaming RPC call on a newly created channel.  In this environment, I am using user credentials.\r\n\r\n### What did you expect to see?\r\n\r\nA successful RPC, or many a transient error.\r\n\r\n### What did you see instead?\r\n\r\nThe request fails with `UNKNOWN`.  AFAIK, this is not a retryable error.  My log shows:\r\n\r\n```\r\nE0724 13:38:09.832511018      12 oauth2_credentials.cc:238]            oauth_fetch: UNKNOWN:C-ares status is not ARES_SUCCESS qtype=A name=oauth2.googleapis.com is_balancer=0: Could not contact DNS servers {file:\"external/grpc~/src/core/lib/transport/error_utils.cc\", file_line:151, created_time:\"2024-07-24T13:38:09.832386798+00:00\", grpc_status:2}\r\n```\r\n\r\nor in full:\r\n\r\n```\r\n2024-07-24T13:38:09.829844529Z [DEBUG] <140239836356096> AsyncWriteObject(1) (google/cloud/storage/internal/storage_logging_decorator.cc:511)\r\n2024-07-24T13:38:09.830496518Z [DEBUG] <140239836356096> Start(1) << (./google/cloud/internal/async_streaming_write_rpc_logging.h:48)\r\nE0724 13:38:09.832511018      12 oauth2_credentials.cc:238]            oauth_fetch: UNKNOWN:C-ares status is not ARES_SUCCESS qtype=A name=oauth2.googleapis.com is_balancer=0: Could not contact DNS servers {file:\"external/grpc~/src/core/lib/transport/error_utils.cc\", file_line:151, created_time:\"2024-07-24T13:38:09.832386798+00:00\", grpc_status:2}\r\n2024-07-24T13:38:09.833915438Z [DEBUG] <140239737665216> Start(1) >> false (./google/cloud/internal/async_streaming_write_rpc_logging.h:51)\r\n2024-07-24T13:38:09.834533378Z [DEBUG] <140239737665216> Finish(1) << (./google/cloud/internal/async_streaming_write_rpc_logging.h:80)\r\n2024-07-24T13:38:09.835094248Z [DEBUG] <140239737665216> Finish(1) >> status=UNKNOWN: C-ares status is not ARES_SUCCESS qtype=A name=oauth2.googleapis.com is_balancer=0: Could not contact DNS servers (./google/cloud/internal/async_streaming_write_rpc_logging.h:87)\r\ngoogle/cloud/storage/tests/async_client_integration_test.cc:90: Failure\r\nValue of: insert\r\nExpected: code is equal to OK and message is anything\r\n  Actual: 312-byte object <C0-3E 23-00 10-51 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 ... 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00 00-00>, whose status is UNKNOWN: Permanent error, with a last message of C-ares status is not ARES_SUCCESS qtype=A name=oauth2.googleapis.com is_balancer=0: Could not contact DNS servers error_info={reason=, domain=, metadata={gcloud-cpp.retry.function=InsertObject, gcloud-cpp.retry.reason=permanent-error, gcloud-cpp.retry.original-message=C-ares status is not ARES_SUCCESS qtype=A name=oauth2.googleapis.com is_balancer=0: Could not contact DNS servers}}, with a code that isn't equal to OK, but a message that is anything\r\n\r\n```\r\n\r\nYou may be able to repro this with:\r\n\r\n```\r\nbazel test --jobs=32 --config=asan --runs_per_test=256 --test_env=HOME=$HOME \\\r\n  --test_env=CLOUD_STORAGE_ENABLE_TRACING=rpc,rpc-streams \\\r\n   --test_env=GOOGLE_CLOUD_CPP_ENABLE_TRACING=rpc \\\r\n    --test_env=GOOGLE_CLOUD_CPP_ENABLE_CLOG=Y \\\r\n    --test_env=GOOGLE_CLOUD_CPP_STORAGE_TEST_BUCKET_NAME=$MY_BUCKET  //google/cloud/storage/tests:async_client_integration_test-default\r\n```\r\n\r\n### Anything else we should know about your project / environment?\r\n","closed_by":{"login":"copybara-service[bot]","id":56741989,"node_id":"MDM6Qm90NTY3NDE5ODk=","avatar_url":"https://avatars.githubusercontent.com/in/44061?v=4","gravatar_id":"","url":"https://api.github.com/users/copybara-service%5Bbot%5D","html_url":"https://github.com/apps/copybara-service","followers_url":"https://api.github.com/users/copybara-service%5Bbot%5D/followers","following_url":"https://api.github.com/users/copybara-service%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/copybara-service%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/copybara-service%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/copybara-service%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/copybara-service%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/copybara-service%5Bbot%5D/repos","events_url":"https://api.github.com/users/copybara-service%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/copybara-service%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/grpc/grpc/issues/37306/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/grpc/grpc/issues/37306/timeline","performed_via_github_app":null,"state_reason":"completed"}