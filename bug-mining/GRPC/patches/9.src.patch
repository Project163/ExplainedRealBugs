diff --git a/src/compiler/csharp_generator_helpers.h b/src/compiler/csharp_generator_helpers.h
index 94ba152231..6d98099342 100644
--- a/src/compiler/csharp_generator_helpers.h
+++ b/src/compiler/csharp_generator_helpers.h
@@ -26,6 +26,7 @@ namespace grpc_csharp_generator {
 
 inline bool ServicesFilename(const grpc::protobuf::FileDescriptor* file,
                              const std::string& file_suffix,
+                             const bool base_namespace_present,
                              const std::string& base_namespace,
                              std::string& out_file, std::string* error) {
   // Support for base_namespace option is **experimental**.
@@ -36,7 +37,7 @@ inline bool ServicesFilename(const grpc::protobuf::FileDescriptor* file,
   // make a difference (only files with punctuation or numbers in the
   // name.)
   // Otherwise the behavior remains the same as before.
-  if (base_namespace.empty()) {
+  if (!base_namespace_present) {
     out_file = grpc_generator::FileNameInUpperCamel(file, false) + file_suffix;
   } else {
     out_file = GRPC_CUSTOM_CSHARP_GETOUTPUTFILE(file, file_suffix, true,
diff --git a/src/compiler/csharp_plugin.cc b/src/compiler/csharp_plugin.cc
index 0136f4bea4..b4fdb39c35 100644
--- a/src/compiler/csharp_plugin.cc
+++ b/src/compiler/csharp_plugin.cc
@@ -44,6 +44,7 @@ class CSharpGrpcGenerator : public grpc::protobuf::compiler::CodeGenerator {
     bool generate_server = true;
     bool internal_access = false;
     std::string base_namespace = "";
+    bool base_namespace_present = false;
 
     // the suffix that will get appended to the name generated from the name
     // of the original .proto file
@@ -62,6 +63,7 @@ class CSharpGrpcGenerator : public grpc::protobuf::compiler::CodeGenerator {
         // The option may be removed or file names generated may change
         // in the future.
         base_namespace = options[i].second;
+        base_namespace_present = true;
       } else {
         *error = "Unknown generator option: " + options[i].first;
         return false;
@@ -77,7 +79,8 @@ class CSharpGrpcGenerator : public grpc::protobuf::compiler::CodeGenerator {
     // Get output file name.
     std::string file_name;
     if (!grpc_csharp_generator::ServicesFilename(
-            file, file_suffix, base_namespace, file_name, error)) {
+            file, file_suffix, base_namespace_present, base_namespace,
+            file_name, error)) {
       return false;
     }
     std::unique_ptr<grpc::protobuf::io::ZeroCopyOutputStream> output(
diff --git a/test/csharp/codegen/csharp_codegen_base_namespace_test.sh b/test/csharp/codegen/csharp_codegen_base_namespace_test.sh
index f0f85877ee..e86a7beea9 100755
--- a/test/csharp/codegen/csharp_codegen_base_namespace_test.sh
+++ b/test/csharp/codegen/csharp_codegen_base_namespace_test.sh
@@ -67,6 +67,41 @@ ls -lR ./proto_out
     exit 1
 }
 
+# Run again with base_namespace option set to empty value to check that the files
+# are created under a full directory structure defined by the namespace
+rm -rf ${PROTO_OUT}
+mkdir -p ${PROTO_OUT}
+
+$PROTOC \
+    --plugin=protoc-gen-grpc-csharp=$PLUGIN \
+    --csharp_out=${PROTO_OUT} \
+    --grpc-csharp_out=${PROTO_OUT} \
+    --csharp_opt=base_namespace= \
+    --grpc-csharp_opt=base_namespace= \
+    -I ${DATA_DIR}/proto \
+    ${DATA_DIR}/proto/namespacetest.proto
+
+# log the files generated
+ls -lR ./proto_out
+
+# Verify the output files exist in the right location.
+
+# The C# namespace option in the proto file of "Example.V1.CodegenTest"
+# combined with the command line options above should mean the generated files
+# are created in the output directory "Example/V1/CodegenTest"
+
+# First file is generated by protoc.
+[ -e ${PROTO_OUT}/Example/V1/CodegenTest/Namespacetest.cs ] || {
+    echo >&2 "missing generated output, expecting Example/V1/CodegenTest/Namespacetest.cs"
+    exit 1
+}
+
+# Second file is generated by the plugin.
+[ -e ${PROTO_OUT}/Example/V1/CodegenTest/NamespacetestGrpc.cs ] || {
+    echo >&2 "missing generated output, expecting Example/V1/CodegenTest/NamespacetestGrpc.cs"
+    exit 1
+}
+
 # Run again without the base_namespace options to check the files are created
 # in the root of the output directory
 
