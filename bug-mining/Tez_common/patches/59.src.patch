diff --git a/tez-common/src/main/java/org/apache/tez/common/TezUtilsInternal.java b/tez-common/src/main/java/org/apache/tez/common/TezUtilsInternal.java
index 5ba2972ea..5d7aea372 100644
--- a/tez-common/src/main/java/org/apache/tez/common/TezUtilsInternal.java
+++ b/tez-common/src/main/java/org/apache/tez/common/TezUtilsInternal.java
@@ -238,7 +238,7 @@ public class TezUtilsInternal {
     if (bits == null) {
       return null;
     }
-    byte[] bytes = new byte[bits.length() / 8 + 1];
+    byte[] bytes = new byte[(bits.length() + 7) / 8];
     for (int i = 0; i < bits.length(); i++) {
       if (bits.get(i)) {
         bytes[(bytes.length) - (i / 8) - 1] |= 1 << (i % 8);
diff --git a/tez-common/src/test/java/org/apache/tez/common/TestTezUtils.java b/tez-common/src/test/java/org/apache/tez/common/TestTezUtils.java
index 16efc8f52..04eb2c0d9 100644
--- a/tez-common/src/test/java/org/apache/tez/common/TestTezUtils.java
+++ b/tez-common/src/test/java/org/apache/tez/common/TestTezUtils.java
@@ -81,11 +81,11 @@ public class TestTezUtils {
   public void testBitSetToByteArray() {
     BitSet bitSet = createBitSet(0);
     byte[] bytes = TezUtilsInternal.toByteArray(bitSet);
-    Assert.assertTrue(bytes.length == ((bitSet.length() / 8) + 1));
+    Assert.assertEquals(bytes.length, (bitSet.length() + 7) / 8);
 
     bitSet = createBitSet(1000);
     bytes = TezUtilsInternal.toByteArray(bitSet);
-    Assert.assertTrue(bytes.length == ((bitSet.length() / 8) + 1));
+    Assert.assertEquals(bytes.length, (bitSet.length() + 7) / 8);
   }
 
   @Test (timeout=2000)
