diff --git a/tez-common/src/main/java/org/apache/tez/dag/records/TezDAGID.java b/tez-common/src/main/java/org/apache/tez/dag/records/TezDAGID.java
index 27cc7518e..382889022 100644
--- a/tez-common/src/main/java/org/apache/tez/dag/records/TezDAGID.java
+++ b/tez-common/src/main/java/org/apache/tez/dag/records/TezDAGID.java
@@ -177,17 +177,26 @@ public class TezDAGID extends TezID {
   }
 
   public static TezDAGID fromString(String dagId) {
+    int id = 0;
+    int appId = 0;
+    String[] split = dagId.split("_");
+    if (split.length != 4 || !dagId.startsWith(DAG + "_")) {
+      throw new IllegalArgumentException("Invalid DAG Id format : " + dagId);
+    }
+    String rmId = split[1];
+    try {
+      appId = Integer.parseInt(split[2]);
+    } catch (NumberFormatException e) {
+      throw new IllegalArgumentException("Error while parsing App Id '"
+          + split[2] + "' of DAG Id : " + dagId);
+    }
     try {
-      String[] split = dagId.split("_");
-      String rmId = split[1];
-      int appId = tezAppIdFormat.get().parse(split[2]).intValue();
-      int id;
-      id = tezDagIdFormat.get().parse(split[3]).intValue();
-      return TezDAGID.getInstance(rmId, appId, id);
-    } catch (Exception e) {
-      e.printStackTrace();
+      id = Integer.parseInt(split[3]);
+    } catch (NumberFormatException e) {
+      throw new IllegalArgumentException("Error while parsing Id '" + split[3]
+          + "' of DAG Id : " + dagId);
     }
-    return null;
+    return TezDAGID.getInstance(rmId, appId, id);
   }
 
   /**
diff --git a/tez-common/src/test/java/org/apache/tez/dag/records/TestTezIds.java b/tez-common/src/test/java/org/apache/tez/dag/records/TestTezIds.java
index 41d6d0fcb..04a2b3500 100644
--- a/tez-common/src/test/java/org/apache/tez/dag/records/TestTezIds.java
+++ b/tez-common/src/test/java/org/apache/tez/dag/records/TestTezIds.java
@@ -108,4 +108,43 @@ public class TestTezIds {
     verifyAttemptId(taIdStr, taId);
   }
 
+  @Test(timeout=5000)
+  public void testInvalidDagIds() {
+    String dagIdStr = "aaa_111_1_1";
+    TezDAGID dagId;
+    try {
+      dagId = TezDAGID.fromString(dagIdStr);
+      Assert.fail("Expected failure for invalid dagId=" + dagIdStr);
+    } catch (IllegalArgumentException e) {
+      Assert.assertTrue(e.getMessage().contains("Invalid DAG Id format"));
+    }
+
+    dagIdStr = "dag_111_11";
+    try {
+      dagId = TezDAGID.fromString(dagIdStr);
+      Assert.fail("Expected failure for invalid dagId=" + dagIdStr);
+    } catch (IllegalArgumentException e) {
+      Assert.assertTrue(e.getMessage().contains("Invalid DAG Id format"));
+    }
+
+    dagIdStr = "dag_111_11_aa";
+    try {
+      dagId = TezDAGID.fromString(dagIdStr);
+      Assert.fail("Expected failure for invalid dagId=" + dagIdStr);
+    } catch (IllegalArgumentException e) {
+      Assert.assertTrue(e.getMessage().contains("Error while parsing"));
+    }
+
+    dagIdStr = "dag_111_aa_1";
+    try {
+      dagId = TezDAGID.fromString(dagIdStr);
+      Assert.fail("Expected failure for invalid dagId=" + dagIdStr);
+    } catch (IllegalArgumentException e) {
+      Assert.assertTrue(e.getMessage().contains("Error while parsing"));
+    }
+
+  }
+
+
+
 }
