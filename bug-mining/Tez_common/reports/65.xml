<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:54:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TEZ-4388] Asynchttpclient can cause stuck TezChild processes</title>
                <link>https://issues.apache.org/jira/browse/TEZ-4388</link>
                <project id="12314426" key="TEZ">Apache Tez</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
laszlobodor      96935   0.0  1.6  8398064 553604 s001  S     2:14PM   0:06.21 /Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/bin/java -Xmx819m -server -Djava.net.preferIPv4Stack=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; -Dhadoop.metrics.log.level=WARN -XX:+PrintGCDetails -verbose:gc -XX:+PrintGCTimeStamps -XX:+UseNUMA -XX:+UseParallelGC -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=/Users/laszlobodor/apache/tez/tez-tests/target/tmp/org.apache.tez.test.TestSecureShuffle-withoutssl/yarn-466119913/org.apache.tez.test.TestSecureShuffle-withoutssl-logDir-nm-0_0/application_1644930832286_0002/container_1644930832286_0002_01_000002 -Dtez.root.logger=INFO,CLA -Djava.io.tmpdir=/Users/laszlobodor/apache/tez/tez-tests/target/tmp/org.apache.tez.test.TestSecureShuffle-withoutssl/yarn-466119913/org.apache.tez.test.TestSecureShuffle-withoutssl-localDir-nm-0_0/usercache/laszlobodor/appcache/application_1644930832286_0002/container_1644930832286_0002_01_000002/tmp org.apache.tez.runtime.task.TezChild 192.168.0.52 55541 container_1644930832286_0002_01_000002 application_1644930832286_0002 1

laszlobodor      96789   0.0  1.5  8136944 487980 s001  S     2:13PM   0:06.06 /Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/bin/java -Xmx819m -server -Djava.net.preferIPv4Stack=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; -Dhadoop.metrics.log.level=WARN -XX:+PrintGCDetails -verbose:gc -XX:+PrintGCTimeStamps -XX:+UseNUMA -XX:+UseParallelGC -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=/Users/laszlobodor/apache/tez/tez-tests/target/tmp/org.apache.tez.test.TestSecureShuffle-withoutssl/yarn-466119913/org.apache.tez.test.TestSecureShuffle-withoutssl-logDir-nm-0_0/application_1644930832286_0001/container_1644930832286_0001_01_000002 -Dtez.root.logger=INFO,CLA -Djava.io.tmpdir=/Users/laszlobodor/apache/tez/tez-tests/target/tmp/org.apache.tez.test.TestSecureShuffle-withoutssl/yarn-466119913/org.apache.tez.test.TestSecureShuffle-withoutssl-localDir-nm-0_0/usercache/laszlobodor/appcache/application_1644930832286_0001/container_1644930832286_0001_01_000002/tmp org.apache.tez.runtime.task.TezChild 192.168.0.52 55519 container_1644930832286_0001_01_000002 application_1644930832286_0001 1

laszlobodor      96282   0.0  1.4  8258788 474648 s001  S     2:12PM   0:06.69 /Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/bin/java -Xmx819m -server -Djava.net.preferIPv4Stack=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; -Dhadoop.metrics.log.level=WARN -XX:+PrintGCDetails -verbose:gc -XX:+PrintGCTimeStamps -XX:+UseNUMA -XX:+UseParallelGC -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=/Users/laszlobodor/apache/tez/tez-tests/target/tmp/org.apache.tez.test.TestSecureShuffle-withssl/yarn-466021610/org.apache.tez.test.TestSecureShuffle-withssl-logDir-nm-0_0/application_1644930734009_0002/container_1644930734009_0002_01_000002 -Dtez.root.logger=INFO,CLA -Djava.io.tmpdir=/Users/laszlobodor/apache/tez/tez-tests/target/tmp/org.apache.tez.test.TestSecureShuffle-withssl/yarn-466021610/org.apache.tez.test.TestSecureShuffle-withssl-localDir-nm-0_0/usercache/laszlobodor/appcache/application_1644930734009_0002/container_1644930734009_0002_01_000002/tmp org.apache.tez.runtime.task.TezChild 192.168.0.52 55452 container_1644930734009_0002_01_000002 application_1644930734009_0002 1

laszlobodor      96129   0.0  1.5  8402248 500904 s001  S     2:12PM   0:06.89 /Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/bin/java -Xmx819m -server -Djava.net.preferIPv4Stack=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; -Dhadoop.metrics.log.level=WARN -XX:+PrintGCDetails -verbose:gc -XX:+PrintGCTimeStamps -XX:+UseNUMA -XX:+UseParallelGC -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=/Users/laszlobodor/apache/tez/tez-tests/target/tmp/org.apache.tez.test.TestSecureShuffle-withssl/yarn-466021610/org.apache.tez.test.TestSecureShuffle-withssl-logDir-nm-0_0/application_1644930734009_0001/container_1644930734009_0001_01_000002 -Dtez.root.logger=INFO,CLA -Djava.io.tmpdir=/Users/laszlobodor/apache/tez/tez-tests/target/tmp/org.apache.tez.test.TestSecureShuffle-withssl/yarn-466021610/org.apache.tez.test.TestSecureShuffle-withssl-localDir-nm-0_0/usercache/laszlobodor/appcache/application_1644930734009_0001/container_1644930734009_0001_01_000002/tmp org.apache.tez.runtime.task.TezChild 192.168.0.52 55410 container_1644930734009_0001_01_000002 application_1644930734009_0001 1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;after some investigation, I can see that the issue comes in case of async-http client cases, regardless of ssl/non-ssl or positive/negative testcases&lt;/p&gt;</description>
                <environment></environment>
        <key id="13428577">TEZ-4388</key>
            <summary>Asynchttpclient can cause stuck TezChild processes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="abstractdog">L&#225;szl&#243; Bodor</assignee>
                                    <reporter username="abstractdog">L&#225;szl&#243; Bodor</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Feb 2022 13:19:56 +0000</created>
                <updated>Tue, 22 Feb 2022 09:33:50 +0000</updated>
                            <resolved>Tue, 22 Feb 2022 09:33:50 +0000</resolved>
                                                    <fixVersion>0.9.3</fixVersion>
                    <fixVersion>0.10.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="7800">2h 10m</timespent>
                                <comments>
                            <comment id="17492682" author="abstractdog" created="Tue, 15 Feb 2022 15:39:43 +0000"  >&lt;p&gt;looks like the this thread runs forever in the JVM:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;AsyncHttpClient-3-1&quot;&lt;/span&gt; #38 prio=5 os_prio=31 tid=0x00007ff3cf981800 nid=0x9603 runnable [0x0000700007f8b000]
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: RUNNABLE
	at sun.nio.ch.KQueueArrayWrapper.kevent0(Native Method)
	at sun.nio.ch.KQueueArrayWrapper.poll(KQueueArrayWrapper.java:198)
	at sun.nio.ch.KQueueSelectorImpl.doSelect(KQueueSelectorImpl.java:117)
	at sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:86)
	- locked &amp;lt;0x00000007b6f85bd0&amp;gt; (a io.netty.channel.nio.SelectedSelectionKeySet)
	- locked &amp;lt;0x00000007b6f85be8&amp;gt; (a java.util.Collections$UnmodifiableSet)
	- locked &amp;lt;0x00000007b6f85b80&amp;gt; (a sun.nio.ch.KQueueSelectorImpl)
	at sun.nio.ch.SelectorImpl.select(SelectorImpl.java:97)
	at sun.nio.ch.SelectorImpl.select(SelectorImpl.java:101)
	at io.netty.channel.nio.SelectedSelectionKeySetSelector.select(SelectedSelectionKeySetSelector.java:68)
	at io.netty.channel.nio.NioEventLoop.select(NioEventLoop.java:813)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:460)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)

&lt;span class=&quot;code-quote&quot;&gt;&quot;AsyncHttpClient-timer-1-1&quot;&lt;/span&gt; #37 prio=5 os_prio=31 tid=0x00007ff3cebad800 nid=0x6903 waiting on condition [0x0000700007e88000]
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: TIMED_WAITING (sleeping)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(Native Method)
	at io.netty.util.HashedWheelTimer$Worker.waitForNextTick(HashedWheelTimer.java:600)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:496)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think HashedWheelTimer ignores interrupted exception and expects an explicit stop through the async http client&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; waitForNextTick() {
...
                &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
                    &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(sleepTimeMs);
                } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (InterruptedException ignored) {
                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (WORKER_STATE_UPDATER.get(HashedWheelTimer.&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;) == WORKER_STATE_SHUTDOWN) {
                        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;.MIN_VALUE;
                    }
                }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;so this is not only testing bug, I guess the very same applies silently in production too&lt;/p&gt;</comment>
                            <comment id="17495975" author="abstractdog" created="Tue, 22 Feb 2022 09:33:44 +0000"  >&lt;p&gt;merged to master and pushed manually to branch-0.9&lt;br/&gt;
thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rbalamohan&quot; class=&quot;user-hover&quot; rel=&quot;rbalamohan&quot;&gt;rbalamohan&lt;/a&gt; for the review!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13429048">TEZ-4390</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13040047" name="jstack.log" size="7156" author="abstractdog" created="Tue, 15 Feb 2022 14:59:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 37 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0zle0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>