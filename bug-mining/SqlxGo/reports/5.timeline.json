[{"url":"https://api.github.com/repos/jmoiron/sqlx/issues/comments/28819814","html_url":"https://github.com/jmoiron/sqlx/issues/26#issuecomment-28819814","issue_url":"https://api.github.com/repos/jmoiron/sqlx/issues/26","id":28819814,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODE5ODE0","user":{"login":"jmoiron","id":218132,"node_id":"MDQ6VXNlcjIxODEzMg==","avatar_url":"https://avatars.githubusercontent.com/u/218132?v=4","gravatar_id":"","url":"https://api.github.com/users/jmoiron","html_url":"https://github.com/jmoiron","followers_url":"https://api.github.com/users/jmoiron/followers","following_url":"https://api.github.com/users/jmoiron/following{/other_user}","gists_url":"https://api.github.com/users/jmoiron/gists{/gist_id}","starred_url":"https://api.github.com/users/jmoiron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmoiron/subscriptions","organizations_url":"https://api.github.com/users/jmoiron/orgs","repos_url":"https://api.github.com/users/jmoiron/repos","events_url":"https://api.github.com/users/jmoiron/events{/privacy}","received_events_url":"https://api.github.com/users/jmoiron/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2013-11-19T18:48:07Z","updated_at":"2013-11-19T18:48:07Z","body":"Can you verify that your `Get()` call was returning an error that looks like it came [somewhere in this code](https://github.com/jmoiron/sqlx/blob/master/sqlx.go#L850-L876)?  I might add a `defer r.rows.Close()` to this code, since if you do not have the `Row` object in question you can lose the connection indefinitely.\n\n`row.Scan` [closes its rows](https://github.com/jmoiron/sqlx/blob/master/sqlx.go#L78-L111), so if the row actually gets scanned, the rows will get closed.\n","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/jmoiron/sqlx/issues/comments/28819814/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jmoiron","id":218132,"node_id":"MDQ6VXNlcjIxODEzMg==","avatar_url":"https://avatars.githubusercontent.com/u/218132?v=4","gravatar_id":"","url":"https://api.github.com/users/jmoiron","html_url":"https://github.com/jmoiron","followers_url":"https://api.github.com/users/jmoiron/followers","following_url":"https://api.github.com/users/jmoiron/following{/other_user}","gists_url":"https://api.github.com/users/jmoiron/gists{/gist_id}","starred_url":"https://api.github.com/users/jmoiron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmoiron/subscriptions","organizations_url":"https://api.github.com/users/jmoiron/orgs","repos_url":"https://api.github.com/users/jmoiron/repos","events_url":"https://api.github.com/users/jmoiron/events{/privacy}","received_events_url":"https://api.github.com/users/jmoiron/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/jmoiron/sqlx/issues/comments/28828306","html_url":"https://github.com/jmoiron/sqlx/issues/26#issuecomment-28828306","issue_url":"https://api.github.com/repos/jmoiron/sqlx/issues/26","id":28828306,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODI4MzA2","user":{"login":"prenagha","id":194250,"node_id":"MDQ6VXNlcjE5NDI1MA==","avatar_url":"https://avatars.githubusercontent.com/u/194250?v=4","gravatar_id":"","url":"https://api.github.com/users/prenagha","html_url":"https://github.com/prenagha","followers_url":"https://api.github.com/users/prenagha/followers","following_url":"https://api.github.com/users/prenagha/following{/other_user}","gists_url":"https://api.github.com/users/prenagha/gists{/gist_id}","starred_url":"https://api.github.com/users/prenagha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prenagha/subscriptions","organizations_url":"https://api.github.com/users/prenagha/orgs","repos_url":"https://api.github.com/users/prenagha/repos","events_url":"https://api.github.com/users/prenagha/events{/privacy}","received_events_url":"https://api.github.com/users/prenagha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2013-11-19T20:13:19Z","updated_at":"2013-11-19T20:13:19Z","body":"Message was `reflect.Value.Interface: cannot return value obtained from unexported field or method`\nStack trace was\n\n```\npkg/reflect/value.go:982  valueInterface: panic(\"reflect.Value.Interface: cannot return value obtained from unexported field or method\")\npkg/reflect/value.go:971  Value.Interface: return valueInterface(v, true)\ngithub.com/jmoiron/sqlx/sqlx.go:823  com/jmoiron/sqlx.setValues: _, isScanner := v.Addr().Interface().(sql.Scanner)\ngithub.com/jmoiron/sqlx/sqlx.go:878  com/jmoiron/sqlx.(*Row).StructScan: setValues(fields, reflect.Indirect(v), values)\ngithub.com/jmoiron/sqlx/sqlx.go:612  com/jmoiron/sqlx.Get: return r.StructScan(dest)\ngithub.com/jmoiron/sqlx/sqlx.go:337  com/jmoiron/sqlx.(*Tx).Get: return Get(tx, dest, query, args...)\n```\n\nSo from Get -> StructScan -> setValues and into reflect package is where error comes from\n\nAnd also looking at Get it seems to ignore an error returned from QueryRowX. Shouldn't Get look something like\n\n```\nfunc Get(q Queryer, dest interface{}, query string, args ...interface{}) error {\n  r := q.QueryRowx(query, args...)\n  if r.err != nil {\n    return r.err\n  }\n  defer r.rows.Close()\n  return r.StructScan(dest)\n}\n```\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/jmoiron/sqlx/issues/comments/28828306/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"prenagha","id":194250,"node_id":"MDQ6VXNlcjE5NDI1MA==","avatar_url":"https://avatars.githubusercontent.com/u/194250?v=4","gravatar_id":"","url":"https://api.github.com/users/prenagha","html_url":"https://github.com/prenagha","followers_url":"https://api.github.com/users/prenagha/followers","following_url":"https://api.github.com/users/prenagha/following{/other_user}","gists_url":"https://api.github.com/users/prenagha/gists{/gist_id}","starred_url":"https://api.github.com/users/prenagha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prenagha/subscriptions","organizations_url":"https://api.github.com/users/prenagha/orgs","repos_url":"https://api.github.com/users/prenagha/repos","events_url":"https://api.github.com/users/prenagha/events{/privacy}","received_events_url":"https://api.github.com/users/prenagha/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/jmoiron/sqlx/issues/comments/28833825","html_url":"https://github.com/jmoiron/sqlx/issues/26#issuecomment-28833825","issue_url":"https://api.github.com/repos/jmoiron/sqlx/issues/26","id":28833825,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODMzODI1","user":{"login":"jmoiron","id":218132,"node_id":"MDQ6VXNlcjIxODEzMg==","avatar_url":"https://avatars.githubusercontent.com/u/218132?v=4","gravatar_id":"","url":"https://api.github.com/users/jmoiron","html_url":"https://github.com/jmoiron","followers_url":"https://api.github.com/users/jmoiron/followers","following_url":"https://api.github.com/users/jmoiron/following{/other_user}","gists_url":"https://api.github.com/users/jmoiron/gists{/gist_id}","starred_url":"https://api.github.com/users/jmoiron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmoiron/subscriptions","organizations_url":"https://api.github.com/users/jmoiron/orgs","repos_url":"https://api.github.com/users/jmoiron/repos","events_url":"https://api.github.com/users/jmoiron/events{/privacy}","received_events_url":"https://api.github.com/users/jmoiron/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2013-11-19T20:50:48Z","updated_at":"2013-11-19T20:50:48Z","body":"I think this comes about because `Row.StructScan` has some behavior that is different from `Row.Scan`, and since Scan is the standard, I'll adjust StructScan to behave like it.\n\nIn my opinion, `Get` is written correctly presently, and the problem is the behavior of StructScan.  Firstly, at the top of Row.StructScan, it should check `r.err` and return immediately if set (as `Row.Scan` does);  this is the right behavior, and would make checking the error directly after the QueryRowx in your Get code above redundant.\n\nSecondly, `StructScan` should otherwise defer a `r.rows.Close()` to ensure that the rows are always closed if it is called.  This will clash with `r.Scan`'s, but I believe it's safe to call twice.\n","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/jmoiron/sqlx/issues/comments/28833825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jmoiron","id":218132,"node_id":"MDQ6VXNlcjIxODEzMg==","avatar_url":"https://avatars.githubusercontent.com/u/218132?v=4","gravatar_id":"","url":"https://api.github.com/users/jmoiron","html_url":"https://github.com/jmoiron","followers_url":"https://api.github.com/users/jmoiron/followers","following_url":"https://api.github.com/users/jmoiron/following{/other_user}","gists_url":"https://api.github.com/users/jmoiron/gists{/gist_id}","starred_url":"https://api.github.com/users/jmoiron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmoiron/subscriptions","organizations_url":"https://api.github.com/users/jmoiron/orgs","repos_url":"https://api.github.com/users/jmoiron/repos","events_url":"https://api.github.com/users/jmoiron/events{/privacy}","received_events_url":"https://api.github.com/users/jmoiron/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/jmoiron/sqlx/issues/comments/28856563","html_url":"https://github.com/jmoiron/sqlx/issues/26#issuecomment-28856563","issue_url":"https://api.github.com/repos/jmoiron/sqlx/issues/26","id":28856563,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODU2NTYz","user":{"login":"prenagha","id":194250,"node_id":"MDQ6VXNlcjE5NDI1MA==","avatar_url":"https://avatars.githubusercontent.com/u/194250?v=4","gravatar_id":"","url":"https://api.github.com/users/prenagha","html_url":"https://github.com/prenagha","followers_url":"https://api.github.com/users/prenagha/followers","following_url":"https://api.github.com/users/prenagha/following{/other_user}","gists_url":"https://api.github.com/users/prenagha/gists{/gist_id}","starred_url":"https://api.github.com/users/prenagha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prenagha/subscriptions","organizations_url":"https://api.github.com/users/prenagha/orgs","repos_url":"https://api.github.com/users/prenagha/repos","events_url":"https://api.github.com/users/prenagha/events{/privacy}","received_events_url":"https://api.github.com/users/prenagha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2013-11-20T01:32:04Z","updated_at":"2013-11-20T01:32:04Z","body":"Sounds good. I of course defer to you on where the close and error handling go, those spots sound right and solve the problem from a library client point of view. Thanks.\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/jmoiron/sqlx/issues/comments/28856563/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"prenagha","id":194250,"node_id":"MDQ6VXNlcjE5NDI1MA==","avatar_url":"https://avatars.githubusercontent.com/u/194250?v=4","gravatar_id":"","url":"https://api.github.com/users/prenagha","html_url":"https://github.com/prenagha","followers_url":"https://api.github.com/users/prenagha/followers","following_url":"https://api.github.com/users/prenagha/following{/other_user}","gists_url":"https://api.github.com/users/prenagha/gists{/gist_id}","starred_url":"https://api.github.com/users/prenagha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prenagha/subscriptions","organizations_url":"https://api.github.com/users/prenagha/orgs","repos_url":"https://api.github.com/users/prenagha/repos","events_url":"https://api.github.com/users/prenagha/events{/privacy}","received_events_url":"https://api.github.com/users/prenagha/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":76982123,"node_id":"MDExOkNsb3NlZEV2ZW50NzY5ODIxMjM=","url":"https://api.github.com/repos/jmoiron/sqlx/issues/events/76982123","actor":{"login":"jmoiron","id":218132,"node_id":"MDQ6VXNlcjIxODEzMg==","avatar_url":"https://avatars.githubusercontent.com/u/218132?v=4","gravatar_id":"","url":"https://api.github.com/users/jmoiron","html_url":"https://github.com/jmoiron","followers_url":"https://api.github.com/users/jmoiron/followers","following_url":"https://api.github.com/users/jmoiron/following{/other_user}","gists_url":"https://api.github.com/users/jmoiron/gists{/gist_id}","starred_url":"https://api.github.com/users/jmoiron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmoiron/subscriptions","organizations_url":"https://api.github.com/users/jmoiron/orgs","repos_url":"https://api.github.com/users/jmoiron/repos","events_url":"https://api.github.com/users/jmoiron/events{/privacy}","received_events_url":"https://api.github.com/users/jmoiron/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"902725cd909b407220376258f3baaaaf5a195cfa","commit_url":"https://api.github.com/repos/jmoiron/sqlx/commits/902725cd909b407220376258f3baaaaf5a195cfa","created_at":"2013-11-20T03:09:09Z","state_reason":null,"performed_via_github_app":null},{"id":12747725799,"node_id":"REFE_lADOAHgzFc4BXeNlzwAAAAL30tvn","url":"https://api.github.com/repos/jmoiron/sqlx/issues/events/12747725799","actor":{"login":"ideaspaper","id":14331925,"node_id":"MDQ6VXNlcjE0MzMxOTI1","avatar_url":"https://avatars.githubusercontent.com/u/14331925?v=4","gravatar_id":"","url":"https://api.github.com/users/ideaspaper","html_url":"https://github.com/ideaspaper","followers_url":"https://api.github.com/users/ideaspaper/followers","following_url":"https://api.github.com/users/ideaspaper/following{/other_user}","gists_url":"https://api.github.com/users/ideaspaper/gists{/gist_id}","starred_url":"https://api.github.com/users/ideaspaper/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ideaspaper/subscriptions","organizations_url":"https://api.github.com/users/ideaspaper/orgs","repos_url":"https://api.github.com/users/ideaspaper/repos","events_url":"https://api.github.com/users/ideaspaper/events{/privacy}","received_events_url":"https://api.github.com/users/ideaspaper/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"902725cd909b407220376258f3baaaaf5a195cfa","commit_url":"https://api.github.com/repos/ideadev-go/sqlx/commits/902725cd909b407220376258f3baaaaf5a195cfa","created_at":"2024-05-08T18:26:08Z","performed_via_github_app":null}]