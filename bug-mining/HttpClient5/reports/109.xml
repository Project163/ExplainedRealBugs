<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:22:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCLIENT-2302] Examples ClientCustomSSL and AsyncClientCustomSSL are misleading and insecure</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-2302</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                    <description>&lt;p&gt;The examples &lt;a href=&quot;https://github.com/apache/httpcomponents-client/blob/rel/v5.2.1/httpclient5/src/test/java/org/apache/hc/client5/http/examples/ClientCustomSSL.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ClientCustomSSL&lt;/a&gt; and &lt;a href=&quot;https://github.com/apache/httpcomponents-client/blob/rel/v5.2.1/httpclient5/src/test/java/org/apache/hc/client5/http/examples/AsyncClientCustomSSL.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;AsyncClientCustomSSL&lt;/a&gt; both have a Javadoc comment which says:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;This example demonstrates how to create secure connections with a custom SSL context.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;However, this is misleading or even incorrect because the code below does the following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
.loadTrustMaterial((chain, authType) -&amp;gt; {
    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; X509Certificate cert = chain[0];
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;CN=httpbin.org&quot;&lt;/span&gt;.equalsIgnoreCase(cert.getSubjectDN().getName());
})
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This accepts the certificate as long as the subject matches, without properly validating it at all, allowing man-in-the-middle attacks.&lt;/p&gt;

&lt;p&gt;This can for example be seen with the various &lt;a href=&quot;https://badssl.com/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://badssl.com/&lt;/a&gt; subdomains. For example changing in the example the URL to &lt;a href=&quot;https://self-signed.badssl.com/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://self-signed.badssl.com/&lt;/a&gt; and changing the expected subject to &lt;tt&gt;&quot;CN=*.badssl.com, O=BadSSL, L=San Francisco, ST=California, C=US&quot;&lt;/tt&gt; still successfully creates the connection, even though the certificate is self-signed and could have been issued by a malicious actor performing a MITM attack.&lt;/p&gt;

&lt;p&gt;Ideally this section with the custom &lt;tt&gt;TrustStrategy&lt;/tt&gt; should be removed because it is not even necessary for this example to work.&lt;br/&gt;
Or if you want to keep this, then there should be a big &quot;WARNING: ...&quot; comment in this line. Otherwise users might erroneously think a custom &lt;tt&gt;TrustStrategy&lt;/tt&gt; is needed for TLS to work, or they might just keep this example code because their code &quot;works&quot;, without understanding the consequences of this.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13552572">HTTPCLIENT-2302</key>
            <summary>Examples ClientCustomSSL and AsyncClientCustomSSL are misleading and insecure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10008">Information Provided</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="Marcono1234">Marcono1234</reporter>
                        <labels>
                    </labels>
                <created>Sun, 1 Oct 2023 12:13:39 +0000</created>
                <updated>Thu, 12 Oct 2023 13:49:25 +0000</updated>
                            <resolved>Mon, 2 Oct 2023 11:05:50 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3600">1h</timespent>
                                <comments>
                            <comment id="17770859" author="olegk" created="Sun, 1 Oct 2023 12:39:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Marcono1234&quot; class=&quot;user-hover&quot; rel=&quot;Marcono1234&quot;&gt;Marcono1234&lt;/a&gt; These examples demonstrate how to use HC APIs to customize various TLS aspects, not how to verify the hostname of the opposite endpoint. Feel free to contribute a big &quot;WARNING&quot; as a PR at GitHub. Otherwise I will close this issue as invalid.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17770860" author="olegk" created="Sun, 1 Oct 2023 12:45:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Marcono1234&quot; class=&quot;user-hover&quot; rel=&quot;Marcono1234&quot;&gt;Marcono1234&lt;/a&gt; By the way, custom {{&lt;tt&gt;TrustStrategy&lt;/tt&gt;}}s do &lt;em&gt;NOT&lt;/em&gt; disable the hostname verification, so the purported MITM would not succeed anyway.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17770922" author="marcono1234" created="Sun, 1 Oct 2023 20:29:48 +0000"  >&lt;blockquote&gt;
&lt;p&gt;do &lt;em&gt;NOT&lt;/em&gt; disable the hostname verification, so the purported MITM would not succeed anyway&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;But hostname verification only makes sure the hostname specified in the certificate matches the hostname of the target server, it doesn&apos;t validate the certificate chain. Does it?&lt;/p&gt;

&lt;p&gt;With the httpbin.org example above; what prevents an attacker from performing a man-in-the-middle attack and providing their own certificate which has httpbin.org as &lt;tt&gt;subjectAltName&lt;/tt&gt;? I don&apos;t think anything is preventing this, which can be seen with the &lt;a href=&quot;https://self-signed.badssl.com/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://self-signed.badssl.com/&lt;/a&gt; example above, where only checking &lt;tt&gt;getSubjectDN()&lt;/tt&gt; allows the connection despite the self-signed certificate. So anyone could have created that certificate, even an attacker.&lt;/p&gt;</comment>
                            <comment id="17770929" author="olegk" created="Sun, 1 Oct 2023 21:35:20 +0000"  >&lt;p&gt;&amp;gt; &#160;So anyone could have created that certificate, even an attacker.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Marcono1234&quot; class=&quot;user-hover&quot; rel=&quot;Marcono1234&quot;&gt;Marcono1234&lt;/a&gt; And then what? They would also need to hijack httpbin.org and replace the original key and the certificate on the target server or at the very least hijack the DNS resolution on the client side, would not they? You might as well get green men from Mars involved in that attack.&lt;/p&gt;

&lt;p&gt;Again, these examples of HttpClient APi usage and not a tutorial how to do certificate validation correctly.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17771248" author="marcono1234" created="Mon, 2 Oct 2023 18:55:12 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Marcono1234 And then what? They would also need to hijack httpbin.org and replace the original key and the certificate on the target server or at the very least hijack the DNS resolution on the client side, would not they? You might as well get green men from Mars involved in that attack.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;No you don&apos;t, you would have to perform a man-in-the-middle attack; unless I am overlooking something here, in that case please point that out. That does not involve hijacking any servers; in the easiest case the user connects to an open unprotected network and you can intercept their traffic. I am not going to start a general discussion here about how likely / easy or not it is to perform a man-in-the-middle attack; my point is that this would allow a man-in-the-middle attack.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Again, these examples of HttpClient APi usage and not a tutorial how to do certificate validation correctly.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;My points are:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;The usage of &lt;tt&gt;TrustStrategy&lt;/tt&gt; is not needed for the example to work; it might just confuse the user because and make them erroneously believe it is necessary to use a &lt;tt&gt;TrustStrategy&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;The &lt;tt&gt;TrustStrategy&lt;/tt&gt; is used without any comment and without explaining the security implications&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;It is not really clear to me why you are so repulsing; if any of my previous messages sounded rude, then that was not my intention.&lt;br/&gt;
If you want I can provide a PR for adjusting the examples; I would prefer to remove the &lt;tt&gt;TrustStrategy&lt;/tt&gt; usage, but if you really want to keep it then I would at least like to add a comment there.&lt;/p&gt;</comment>
                            <comment id="17771260" author="olegk" created="Mon, 2 Oct 2023 20:18:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Marcono1234&quot; class=&quot;user-hover&quot; rel=&quot;Marcono1234&quot;&gt;Marcono1234&lt;/a&gt; I do not take kindly bug reports that are not bug reports. However I am willing to go to great lengths to work with people who are willing to contribute. You are welcome to propose a PR but please do not remove &lt;tt&gt;TrustStrategy&lt;/tt&gt; because a major point of those examples is to demonstrate how one can inject custom trust verification.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17774418" author="jira-bot" created="Thu, 12 Oct 2023 10:24:36 +0000"  >&lt;p&gt;Commit 6b16ec17677dcdc2fe793e968008ee2f66a161a0 in httpcomponents-client&apos;s branch refs/heads/master from Marcono1234&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=6b16ec176&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=6b16ec176&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2302&quot; title=&quot;Examples ClientCustomSSL and AsyncClientCustomSSL are misleading and insecure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2302&quot;&gt;&lt;del&gt;HTTPCLIENT-2302&lt;/del&gt;&lt;/a&gt;: Add comment to TrustStrategy usage in examples (#492)&lt;/p&gt;
</comment>
                            <comment id="17774529" author="jira-bot" created="Thu, 12 Oct 2023 13:45:32 +0000"  >&lt;p&gt;Commit 19f3922b37369431d379ce57fa187740b22436cf in httpcomponents-client&apos;s branch refs/heads/master from Marcono1234&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=19f3922b3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=19f3922b3&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2302&quot; title=&quot;Examples ClientCustomSSL and AsyncClientCustomSSL are misleading and insecure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2302&quot;&gt;&lt;del&gt;HTTPCLIENT-2302&lt;/del&gt;&lt;/a&gt;: Add comment to TrustStrategy usage in examples (#492)&lt;/p&gt;</comment>
                            <comment id="17774531" author="jira-bot" created="Thu, 12 Oct 2023 13:49:25 +0000"  >&lt;p&gt;Commit 32ce98d70403e59356928f0bf3b6151240d373a9 in httpcomponents-client&apos;s branch refs/heads/5.2.x from Marcono1234&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=32ce98d70&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=32ce98d70&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2302&quot; title=&quot;Examples ClientCustomSSL and AsyncClientCustomSSL are misleading and insecure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2302&quot;&gt;&lt;del&gt;HTTPCLIENT-2302&lt;/del&gt;&lt;/a&gt;: Add comment to TrustStrategy usage in examples (#492)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 4 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1komo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>