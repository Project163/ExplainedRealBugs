<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:22:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCLIENT-2182] [CloseableHttpAsyncClient] HttpVersionPolicy.NEGOTIATE Not working with Open JDK &gt;= 16</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-2182</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                    <description>&lt;p&gt;CloseableHttpAsyncClient with&#160; HttpVersionPolicy.NEGOTIATE is NOT working with Open JDK greater or equals 16. When we force&#160;HttpVersionPolicy to&#160;HTTP_1 or HTTP_2, we do not face any issue. The issue happens only with&#160;HttpVersionPolicy.NEGOTIATE.&lt;/p&gt;

&lt;p&gt;We have the Following exception :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Executing request GET https:&lt;span class=&quot;code-comment&quot;&gt;//nghttp2.org/httpbin/
&lt;/span&gt;GET https:&lt;span class=&quot;code-comment&quot;&gt;//nghttp2.org/httpbin/-&amp;gt;org.apache.hc.core5.http.ConnectionClosedException: Connection closed by peer
&lt;/span&gt;Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; java.util.concurrent.ExecutionException: org.apache.hc.core5.http.ConnectionClosedException: Connection closed by peer
	at org.apache.hc.core5.concurrent.BasicFuture.getResult(BasicFuture.java:72)
	at org.apache.hc.core5.concurrent.BasicFuture.get(BasicFuture.java:85)
	at org.apache.hc.client5.http.examples.main(AsyncClientTlsAlpn.java:85)
Caused by: org.apache.hc.core5.http.ConnectionClosedException: Connection closed by peer
	at org.apache.hc.core5.http.impl.nio.AbstractHttp1StreamDuplexer.onInput(AbstractHttp1StreamDuplexer.java:341)
	at org.apache.hc.core5.http.impl.nio.AbstractHttp1IOEventHandler.inputReady(AbstractHttp1IOEventHandler.java:64)
	at org.apache.hc.core5.http.impl.nio.ClientHttp1IOEventHandler.inputReady(ClientHttp1IOEventHandler.java:39)
	at org.apache.hc.core5.reactor.ssl.SSLIOSession.decryptData(SSLIOSession.java:549)
	at org.apache.hc.core5.reactor.ssl.SSLIOSession.access$400(SSLIOSession.java:72)
	at org.apache.hc.core5.reactor.ssl.SSLIOSession$1.inputReady(SSLIOSession.java:172)
	at org.apache.hc.core5.reactor.InternalDataChannel.onIOEvent(InternalDataChannel.java:131)
	at org.apache.hc.core5.reactor.InternalChannel.handleIOEvent(InternalChannel.java:51)
	at org.apache.hc.core5.reactor.SingleCoreIOReactor.processEvents(SingleCoreIOReactor.java:178)
	at org.apache.hc.core5.reactor.SingleCoreIOReactor.doExecute(SingleCoreIOReactor.java:127)
	at org.apache.hc.core5.reactor.AbstractSingleCoreIOReactor.execute(AbstractSingleCoreIOReactor.java:85)
	at org.apache.hc.core5.reactor.IOReactorWorker.run(IOReactorWorker.java:44)
	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:833)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In order to reproduce :&#160;&lt;/p&gt;

&lt;p&gt;Execute the following java class (&lt;a href=&quot;https://raw.githubusercontent.com/apache/httpcomponents-client/5.1.x/httpclient5/src/test/java/org/apache/hc/client5/http/examples/AsyncClientTlsAlpn.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&#160;https://raw.githubusercontent.com/apache/httpcomponents-client/5.1.x/httpclient5/src/test/java/org/apache/hc/client5/http/examples/AsyncClientTlsAlpn.java&lt;/a&gt;&#160;) with a version of &lt;em&gt;OpenJDK &amp;lt;= 15&lt;/em&gt; then you will succesfully get the result. After, execute the same class with&#160;&lt;em&gt;OpenJDK 17,&lt;/em&gt; then you you will face the issue.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13405941">HTTPCLIENT-2182</key>
            <summary>[CloseableHttpAsyncClient] HttpVersionPolicy.NEGOTIATE Not working with Open JDK &gt;= 16</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ymaiga">Youssouf Maiga</reporter>
                        <labels>
                    </labels>
                <created>Mon, 11 Oct 2021 13:50:00 +0000</created>
                <updated>Mon, 30 May 2022 14:29:14 +0000</updated>
                            <resolved>Wed, 13 Oct 2021 09:50:30 +0000</resolved>
                                    <version>5.1</version>
                                    <fixVersion>5.2-alpha1</fixVersion>
                                    <component>HttpClient (async)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17427591" author="olegk" created="Tue, 12 Oct 2021 09:41:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ymaiga&quot; class=&quot;user-hover&quot; rel=&quot;ymaiga&quot;&gt;ymaiga&lt;/a&gt; What exact version of HttpClient are you using?&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17427596" author="olegk" created="Tue, 12 Oct 2021 09:55:23 +0000"  >&lt;p&gt;I can reproduce the issue with the latest 5.1 snapshot. I am looking into it.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17428115" author="jira-bot" created="Wed, 13 Oct 2021 09:51:13 +0000"  >&lt;p&gt;Commit 29d6caac55e1caae6ff41ecdae59e490a4287a15 in httpcomponents-client&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=29d6caa&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=29d6caa&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2182&quot; title=&quot;[CloseableHttpAsyncClient] HttpVersionPolicy.NEGOTIATE Not working with Open JDK &amp;gt;= 16&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2182&quot;&gt;&lt;del&gt;HTTPCLIENT-2182&lt;/del&gt;&lt;/a&gt;: access to SSLSession attributes via reflection disallowed as of Java 16. Core TLS functions now use new Java 1.8 API introduced by 8u251 update&lt;/p&gt;</comment>
                            <comment id="17428119" author="olegk" created="Wed, 13 Oct 2021 09:56:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ymaiga&quot; class=&quot;user-hover&quot; rel=&quot;ymaiga&quot;&gt;ymaiga&lt;/a&gt; The problem is quite simple and is not really a bug in HttpClient. As of Java 16 access to internal classes such as SSLSession via reflection is disallowed. HttpClient 5.2 now can use new Java 1.8 APIs introduced by 8u251 update. HttpClient 5.1 cannot do that as it is still bound to Java 1.7 compatibility.&lt;/p&gt;

&lt;p&gt;Uncomment this block of code in the AsyncClientTlsAlpn and it will work with Java 16 and 17.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/*
.setTlsDetailsFactory(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Factory&amp;lt;SSLEngine, TlsDetails&amp;gt;() {

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; TlsDetails create(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; SSLEngine sslEngine) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TlsDetails(sslEngine.getSession(), sslEngine.getApplicationProtocol());
    }
})
*/
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17428191" author="ymaiga" created="Wed, 13 Oct 2021 12:42:04 +0000"  >&lt;p&gt;It works, thanks for your support&lt;/p&gt;</comment>
                            <comment id="17428235" author="jira-bot" created="Wed, 13 Oct 2021 13:52:11 +0000"  >&lt;p&gt;Commit 97a7caf04a2247998226701f2fc8873c0969abcd in httpcomponents-client&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=97a7caf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=97a7caf&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2182&quot; title=&quot;[CloseableHttpAsyncClient] HttpVersionPolicy.NEGOTIATE Not working with Open JDK &amp;gt;= 16&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2182&quot;&gt;&lt;del&gt;HTTPCLIENT-2182&lt;/del&gt;&lt;/a&gt;: access to SSLSession attributes via reflection disallowed as of Java 16. Core TLS functions now use new Java 1.8 API introduced by 8u251 update&lt;/p&gt;</comment>
                            <comment id="17433313" author="jira-bot" created="Sat, 23 Oct 2021 16:34:47 +0000"  >&lt;p&gt;Commit 8b73f6b83ca85193662b26204cf57d8d025a8465 in httpcomponents-client&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=8b73f6b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=8b73f6b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2182&quot; title=&quot;[CloseableHttpAsyncClient] HttpVersionPolicy.NEGOTIATE Not working with Open JDK &amp;gt;= 16&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2182&quot;&gt;&lt;del&gt;HTTPCLIENT-2182&lt;/del&gt;&lt;/a&gt;: access to SSLSession attributes via reflection disallowed as of Java 16. Core TLS functions now use new Java 1.8 API introduced by 8u251 update&lt;/p&gt;</comment>
                            <comment id="17543973" author="JIRAUSER290213" created="Mon, 30 May 2022 14:29:14 +0000"  >&lt;p&gt;Another workaround is using --add-opens=java.base/sun.security.ssl=ALL-UNNAMED jvm runtime flag&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>Java</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 23 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0vqn4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>