<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:22:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCLIENT-2242] HttpHost.address not used when httpHost is specified without port</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-2242</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                    <description>&lt;p&gt;I am passing &lt;tt&gt;HttpHost&lt;/tt&gt; instance with predefined IP to &lt;tt&gt;execute&lt;/tt&gt; method of CloseableAsyncHttpClient.&lt;/p&gt;

&lt;p&gt;This works and the dns resolver is not used for the request. But it only works if port is specified in the HttpHost. When I specify -1 as a port, then default is correctly used, but IP address from HttpHost is lost during request preprocessing -&amp;gt; DnsResolver is called and IP is resolved again.&lt;/p&gt;

&lt;p&gt;I think the problem is within the &lt;tt&gt;org.apache.hc.client5.http.routing.RoutingSupport#normalize&lt;/tt&gt; method. Here the port is set to default, according to scheme, but the &lt;tt&gt;address&lt;/tt&gt; field is not transferred to the newly created &lt;tt&gt;HttpHost&lt;/tt&gt; instance&lt;/p&gt;

&lt;p&gt;Simple testing example:&lt;br/&gt;
Here when port is set to -1, dns resolving happens and custom dns resolver is called - NOK&lt;br/&gt;
When port is set to be &amp;gt; 0, dns resolving is correctly skipped and predefined localhost address is used - OK&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args)
      &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; UnknownHostException, ExecutionException, InterruptedException {
    PoolingAsyncClientConnectionManager connectionManager =
        PoolingAsyncClientConnectionManagerBuilder.create()
            .setDnsResolver(
                &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DnsResolver() {
                  @Override
                  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; InetAddress[] resolve(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; host) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; UnknownHostException {
                    &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UnknownHostException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Trying to resolve IP address&quot;&lt;/span&gt;);
                  }

                  @Override
                  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; resolveCanonicalHostname(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; host) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; UnknownHostException {
                    &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UnknownHostException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Trying to resolve IP address&quot;&lt;/span&gt;);
                  }
                })
            .build();

    CloseableHttpAsyncClient client =
        HttpAsyncClients.custom().setConnectionManager(connectionManager).build();
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
      client.start();

      SimpleHttpRequest request = SimpleHttpRequest.create(&lt;span class=&quot;code-quote&quot;&gt;&quot;GET&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;);

      HttpHost httpHost = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HttpHost(&lt;span class=&quot;code-quote&quot;&gt;&quot;https&quot;&lt;/span&gt;, InetAddress.getLocalHost(), &lt;span class=&quot;code-quote&quot;&gt;&quot;google.com&quot;&lt;/span&gt;, -1);

      HttpClientContext context = HttpClientContext.create();

      SimpleResponseConsumer responseConsumer = SimpleResponseConsumer.create();

      client
          .execute(
              httpHost,
              SimpleRequestProducer.create(request),
              responseConsumer,
              &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,
              context,
              &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
          .get();

    } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
      client.close(CloseMode.GRACEFUL);
    }
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Thanks for checking&lt;/p&gt;</description>
                <environment></environment>
        <key id="13491260">HTTPCLIENT-2242</key>
            <summary>HttpHost.address not used when httpHost is specified without port</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="lando">Lubos Kolarik</reporter>
                        <labels>
                    </labels>
                <created>Tue, 25 Oct 2022 10:14:02 +0000</created>
                <updated>Mon, 7 Nov 2022 12:54:30 +0000</updated>
                            <resolved>Sun, 6 Nov 2022 10:27:22 +0000</resolved>
                                    <version>5.1.3</version>
                                    <fixVersion>5.1.4</fixVersion>
                    <fixVersion>5.2</fixVersion>
                                    <component>HttpClient (async)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17623965" author="olegk" created="Tue, 25 Oct 2022 18:10:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lando&quot; class=&quot;user-hover&quot; rel=&quot;lando&quot;&gt;lando&lt;/a&gt; Feel free to raise a PR at GitHub with the fix you are proposing.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17629443" author="jira-bot" created="Sun, 6 Nov 2022 10:19:44 +0000"  >&lt;p&gt;Commit 16b2cf467dec08a6f8f0db790f0b6e4157dacb92 in httpcomponents-client&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=16b2cf467&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=16b2cf467&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2242&quot; title=&quot;HttpHost.address not used when httpHost is specified without port&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2242&quot;&gt;&lt;del&gt;HTTPCLIENT-2242&lt;/del&gt;&lt;/a&gt;: RoutingSupport fails to copy InetAddress when normalizing HttpHost&lt;/p&gt;</comment>
                            <comment id="17629444" author="jira-bot" created="Sun, 6 Nov 2022 10:26:54 +0000"  >&lt;p&gt;Commit f4bd8c8235d49371c8cd6ca6e45bc1b6e34d2450 in httpcomponents-client&apos;s branch refs/heads/5.1.x from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=f4bd8c823&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=f4bd8c823&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2242&quot; title=&quot;HttpHost.address not used when httpHost is specified without port&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2242&quot;&gt;&lt;del&gt;HTTPCLIENT-2242&lt;/del&gt;&lt;/a&gt;: RoutingSupport fails to copy InetAddress when normalizing HttpHost&lt;/p&gt;</comment>
                            <comment id="17629447" author="jira-bot" created="Sun, 6 Nov 2022 11:07:55 +0000"  >&lt;p&gt;Commit fd295c0cded884e54b07b5749ecff255db0a8365 in httpcomponents-client&apos;s branch refs/heads/5.1.x from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=fd295c0cd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=fd295c0cd&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2242&quot; title=&quot;HttpHost.address not used when httpHost is specified without port&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2242&quot;&gt;&lt;del&gt;HTTPCLIENT-2242&lt;/del&gt;&lt;/a&gt;: RoutingSupport fails to copy InetAddress when normalizing HttpHost&lt;/p&gt;</comment>
                            <comment id="17629801" author="JIRAUSER296328" created="Mon, 7 Nov 2022 12:54:30 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt; . I planned to open the PR, but did&apos;t found the time soon enough&lt;br/&gt;
Thanks a lot for the fix.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1a7sg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>