<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:23:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCLIENT-2361] Use of multiple &quot;Cookie&quot; headers leads to exception</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-2361</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                    <description>&lt;p&gt;Using multiple Cookie headers leads to exception. In my case&#160; they were set by apache-cxf:4.0.1, using&#160; &lt;em&gt;WebClient.getConfig(cxfClientProxy).getHttpConduit().getCookies().put()&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: org.apache.hc.core5.http.ProtocolException: multiple &lt;span class=&quot;code-quote&quot;&gt;&apos;Cookie&apos;&lt;/span&gt; headers found
&#160; &#160; at org.apache.hc.core5.http.message.HeaderGroup.getHeader(HeaderGroup.java:267)
&#160; &#160; at org.apache.hc.client5.http.protocol.RequestAddCookies.process(RequestAddCookies.java:94)
&#160; &#160; at org.apache.hc.core5.http.protocol.DefaultHttpProcessor.process(DefaultHttpProcessor.java:107)
&#160; &#160; at org.apache.hc.client5.http.impl.async.HttpAsyncMainClientExec$1.produceRequest(HttpAsyncMainClientExec.java:153)
&#160; &#160; at org.apache.hc.core5.http.impl.nio.ClientHttp1StreamHandler.produceOutput(ClientHttp1StreamHandler.java:186)
&#160; &#160; at org.apache.hc.core5.http.impl.nio.ClientHttp1StreamDuplexer.execute(ClientHttp1StreamDuplexer.java:326)
&#160; &#160; at org.apache.hc.core5.http.impl.nio.AbstractHttp1StreamDuplexer.processCommands(AbstractHttp1StreamDuplexer.java:242)
&#160; &#160; at org.apache.hc.core5.http.impl.nio.AbstractHttp1StreamDuplexer.onOutput(AbstractHttp1StreamDuplexer.java:389)
&#160; &#160; at org.apache.hc.core5.http.impl.nio.AbstractHttp1IOEventHandler.outputReady(AbstractHttp1IOEventHandler.java:73)
&#160; &#160; at org.apache.hc.core5.http.impl.nio.ClientHttp1IOEventHandler.outputReady(ClientHttp1IOEventHandler.java:41)
&#160; &#160; at org.apache.hc.core5.reactor.InternalDataChannel.onIOEvent(InternalDataChannel.java:153)
&#160; &#160; at org.apache.hc.core5.reactor.InternalChannel.handleIOEvent(InternalChannel.java:51)
&#160; &#160; at org.apache.hc.core5.reactor.SingleCoreIOReactor.processEvents(SingleCoreIOReactor.java:176)
&#160; &#160; at org.apache.hc.core5.reactor.SingleCoreIOReactor.doExecute(SingleCoreIOReactor.java:125)
&#160; &#160; at org.apache.hc.core5.reactor.AbstractSingleCoreIOReactor.execute(AbstractSingleCoreIOReactor.java:92)
&#160; &#160; at org.apache.hc.core5.reactor.IOReactorWorker.run(IOReactorWorker.java:44)
&#160; &#160; at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:833) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I think that this code should use &lt;em&gt;getHeaders(name)&lt;/em&gt;&#160;instead:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://hc.apache.org/httpcomponents-client-5.4.x/5.4.1/httpclient5/xref/org/apache/hc/client5/http/protocol/RequestAddCookies.html#L94&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hc.apache.org/httpcomponents-client-5.4.x/5.4.1/httpclient5/xref/org/apache/hc/client5/http/protocol/RequestAddCookies.html#L94&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13607447">HTTPCLIENT-2361</key>
            <summary>Use of multiple &quot;Cookie&quot; headers leads to exception</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="shpelda">shpelda</reporter>
                        <labels>
                    </labels>
                <created>Wed, 5 Feb 2025 14:15:12 +0000</created>
                <updated>Thu, 6 Feb 2025 12:17:53 +0000</updated>
                            <resolved>Thu, 6 Feb 2025 07:59:37 +0000</resolved>
                                    <version>5.4.2</version>
                                    <fixVersion>5.4.3</fixVersion>
                    <fixVersion>5.5-alpha1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17924089" author="abernal" created="Wed, 5 Feb 2025 14:23:45 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shpelda&quot; class=&quot;user-hover&quot; rel=&quot;shpelda&quot;&gt;shpelda&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc6265#section-5.4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;RFC 6265 Section 5.4&lt;/a&gt; clearly states that user agents MUST NOT attach more than one Cookie header field. In other words, all cookie pairs should be concatenated into a single Cookie header. Using getHeader(name) (which assumes only one such header) can therefore trigger a ProtocolException if multiple headers are present. &lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="17924152" author="olegk" created="Wed, 5 Feb 2025 16:09:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abernal&quot; class=&quot;user-hover&quot; rel=&quot;abernal&quot;&gt;abernal&lt;/a&gt; You are absolutely correct. There should be only a single `Cookie` header and our own cookie policy should generate only a single one but we should not be stopping the users from sticking more `Cookie`s into a request if they are so inclined.&#160;&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17924155" author="jira-bot" created="Wed, 5 Feb 2025 16:24:01 +0000"  >&lt;p&gt;Commit b7ece752eb52450c6190ae002ae84293ac56b5a9 in httpcomponents-client&apos;s branch refs/heads/&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2361&quot; title=&quot;Use of multiple &amp;quot;Cookie&amp;quot; headers leads to exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2361&quot;&gt;&lt;del&gt;HTTPCLIENT-2361&lt;/del&gt;&lt;/a&gt; from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=b7ece752e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=b7ece752e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2361&quot; title=&quot;Use of multiple &amp;quot;Cookie&amp;quot; headers leads to exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2361&quot;&gt;&lt;del&gt;HTTPCLIENT-2361&lt;/del&gt;&lt;/a&gt;: Tolerate multiple `Cookie` headers added by the caller&lt;/p&gt;</comment>
                            <comment id="17924156" author="olegk" created="Wed, 5 Feb 2025 16:25:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shpelda&quot; class=&quot;user-hover&quot; rel=&quot;shpelda&quot;&gt;shpelda&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abernal&quot; class=&quot;user-hover&quot; rel=&quot;abernal&quot;&gt;abernal&lt;/a&gt; Please review the proposed fix&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/httpcomponents-client/compare/5.4.x...HTTPCLIENT-2361&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/httpcomponents-client/compare/5.4.x...HTTPCLIENT-2361&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17924204" author="abernal" created="Wed, 5 Feb 2025 18:28:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;LGTM&lt;/p&gt;</comment>
                            <comment id="17924401" author="jira-bot" created="Thu, 6 Feb 2025 07:55:58 +0000"  >&lt;p&gt;Commit b7ece752eb52450c6190ae002ae84293ac56b5a9 in httpcomponents-client&apos;s branch refs/heads/5.4.x from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=b7ece752e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=b7ece752e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2361&quot; title=&quot;Use of multiple &amp;quot;Cookie&amp;quot; headers leads to exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2361&quot;&gt;&lt;del&gt;HTTPCLIENT-2361&lt;/del&gt;&lt;/a&gt;: Tolerate multiple `Cookie` headers added by the caller&lt;/p&gt;</comment>
                            <comment id="17924402" author="jira-bot" created="Thu, 6 Feb 2025 07:59:21 +0000"  >&lt;p&gt;Commit a1243ed22fdc3284468411073203774ba56815ee in httpcomponents-client&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=a1243ed22&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=a1243ed22&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2361&quot; title=&quot;Use of multiple &amp;quot;Cookie&amp;quot; headers leads to exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2361&quot;&gt;&lt;del&gt;HTTPCLIENT-2361&lt;/del&gt;&lt;/a&gt;: Tolerate multiple `Cookie` headers added by the caller&lt;/p&gt;</comment>
                            <comment id="17924445" author="reschke" created="Thu, 6 Feb 2025 09:38:50 +0000"  >&lt;p&gt;&lt;del&gt;FWIW, see:&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;&lt;del&gt;&lt;a href=&quot;https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-rfc6265bis#section-4.2.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-rfc6265bis#section-4.2.1&lt;/a&gt;&lt;/del&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;del&gt;Servers MUST be tolerant of multiple cookie headers. For example, an HTTP/2 &lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc9113]&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;[RFC9113&lt;/a&gt; or HTTP/3 &lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc9114]&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;[RFC9114&lt;/a&gt; client or intermediary might split a cookie header to improve compression. Servers are free to determine what form this tolerance takes. For example, the server could process each cookie header individually or the server could concatenate all the cookie headers into one and then process that final, single, header. The server should be mindful of any header field limits when deciding which approach to take.&lt;/del&gt;&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="17924452" author="abernal" created="Thu, 6 Feb 2025 09:50:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reschke&quot; class=&quot;user-hover&quot; rel=&quot;reschke&quot;&gt;reschke&lt;/a&gt;&#160; per RFC 6265 Section 5.4, a user agent must not attach more than one Cookie header field. Since we&apos;re the client, we need to adhere to that spec strictly. or what I&apos;m missing?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17924480" author="olegk" created="Thu, 6 Feb 2025 10:51:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abernal&quot; class=&quot;user-hover&quot; rel=&quot;abernal&quot;&gt;abernal&lt;/a&gt; You are not missing anything. HttpClient 5.4 conforms to RFC 6265 and not any other RFC or a draft.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17924519" author="reschke" created="Thu, 6 Feb 2025 12:17:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abernal&quot; class=&quot;user-hover&quot; rel=&quot;abernal&quot;&gt;abernal&lt;/a&gt; - yes, sorry, I linked to the wrong section.&lt;/p&gt;

&lt;p&gt;See &amp;lt;&lt;a href=&quot;https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-rfc6265bis#section-5.8.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-rfc6265bis#section-5.8.1&lt;/a&gt;&amp;gt;:&lt;/p&gt;

&lt;p&gt;&lt;cite&gt;Note: Previous versions of this specification required that only one Cookie header field be sent in requests. This is no longer a requirement. While this specification requires that a single cookie-string be produced, some user agents may split that string across multiple cookie header fields. For examples, see &lt;a href=&quot;https://rfc-editor.org/rfc/rfc9113#section-8.2.3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Section 8.2.3&lt;/a&gt; of &lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc9113]&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;[RFC9113&lt;/a&gt; and &lt;a href=&quot;https://rfc-editor.org/rfc/rfc9114#section-4.2.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Section 4.2.1&lt;/a&gt; of &lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc9114]&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;[RFC9114&lt;/a&gt;.&lt;/cite&gt;&lt;/p&gt;

&lt;p&gt;So the MUST-level requirement is gone, because components may have good reasons to split the field value. A server indeed has to handle this case anyway.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt; - I&apos;m aware that you have a different understanding of how the standards process in the IETF works (and what spec revision applies to what). Let&apos;s not have that discussion again.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            39 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1u1c8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>