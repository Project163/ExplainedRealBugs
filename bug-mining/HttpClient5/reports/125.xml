<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:23:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCLIENT-2357] HttpClient is not releasing connections when a proxy returns status codes  != 200</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-2357</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                    <description>&lt;p&gt;HttpClient is not releasing connections when a proxy returns status codes != 200.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;How to reproduce:&lt;/b&gt;&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Set up a proxy server that will respond with e.g.: &lt;tt&gt;403 Forbidden&lt;/tt&gt; status code.&lt;br/&gt;
It can simply be an HTTP server that responds with `&lt;tt&gt;HTTP/1.1 403 Forbidden&lt;/tt&gt;`.&lt;/li&gt;
	&lt;li&gt;Set up HttpClient v5 to use the proxy:&lt;/li&gt;
	&lt;li&gt;```&lt;br/&gt;
&lt;tt&gt;CloseableHttpClient client = HttpClients.custom()&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;.setProxy(HttpHost.create(PROXY_URL))&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;.build();&lt;/tt&gt;&lt;br/&gt;
```&lt;/li&gt;
	&lt;li&gt;Set DEBUG log level for &lt;tt&gt;org.apache.hc.client5.http.impl.io.PoolingHttpClientConnectionManager&lt;/tt&gt; to see lease/release logs.&lt;/li&gt;
	&lt;li&gt;Make requests to e.g.: `&lt;a href=&quot;https://atlassian.com/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://atlassian.com&lt;/a&gt;`:&lt;br/&gt;
```&lt;br/&gt;
&lt;tt&gt;client.execute(new HttpPost(&quot;https://atlassian.com&quot;), response -&amp;gt; response);&lt;/tt&gt;&lt;br/&gt;
```&lt;/li&gt;
	&lt;li&gt;Connections are not released, eventually making the client reach the total limit.&#160;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&#160;&lt;br/&gt;
The faulty code was introduced in `&lt;tt&gt;215571a0bdb08849dcee315d456f4ecc93b89863&lt;/tt&gt;` commit in &lt;tt&gt;org.apache.hc.client5.http.impl.classic.ConnectExec&lt;/tt&gt; class.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13605633">HTTPCLIENT-2357</key>
            <summary>HttpClient is not releasing connections when a proxy returns status codes  != 200</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tomaszzasada">Tomasz Zasada</reporter>
                        <labels>
                            <label>regresion</label>
                    </labels>
                <created>Mon, 20 Jan 2025 15:32:54 +0000</created>
                <updated>Wed, 5 Feb 2025 10:29:09 +0000</updated>
                            <resolved>Tue, 21 Jan 2025 19:58:03 +0000</resolved>
                                    <version>5.4-beta1</version>
                    <version>5.4</version>
                    <version>5.4.1</version>
                                    <fixVersion>5.4.2</fixVersion>
                    <fixVersion>5.5-alpha1</fixVersion>
                                    <component>HttpClient (classic)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17914731" author="jira-bot" created="Mon, 20 Jan 2025 17:04:04 +0000"  >&lt;p&gt;Commit f558b7b7727ea6a396d2e693bd5abbc2b94be91d in httpcomponents-client&apos;s branch refs/heads/&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2357&quot; title=&quot;HttpClient is not releasing connections when a proxy returns status codes  != 200&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2357&quot;&gt;&lt;del&gt;HTTPCLIENT-2357&lt;/del&gt;&lt;/a&gt; from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=f558b7b77&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=f558b7b77&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2357&quot; title=&quot;HttpClient is not releasing connections when a proxy returns status codes  != 200&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2357&quot;&gt;&lt;del&gt;HTTPCLIENT-2357&lt;/del&gt;&lt;/a&gt;: (regression) classic HttpClient fails to release connect in case of a proxy authentication failure&lt;/p&gt;</comment>
                            <comment id="17914735" author="olegk" created="Mon, 20 Jan 2025 17:12:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tomaszzasada&quot; class=&quot;user-hover&quot; rel=&quot;tomaszzasada&quot;&gt;tomaszzasada&lt;/a&gt; Silly one liner, easily avoidable if we all got replaced by AI.&lt;/p&gt;

&lt;p&gt;Please review / test the proposed fix:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/httpcomponents-client/compare/HTTPCLIENT-2357&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/httpcomponents-client/compare/HTTPCLIENT-2357&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;

&lt;p&gt;Just a remark:&lt;/p&gt;

&lt;p&gt;This regression is also a great example that unit tests do little to help catch this type of regressions, as it is very tempting to adjust existing unit tests to match functional changes.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17914768" author="JIRAUSER308425" created="Mon, 20 Jan 2025 18:36:03 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Looks like it solves the issue &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;

&lt;p&gt;Do you know when we can expect 5.4.2 to be released?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17914794" author="olegk" created="Mon, 20 Jan 2025 21:01:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tomaszzasada&quot; class=&quot;user-hover&quot; rel=&quot;tomaszzasada&quot;&gt;tomaszzasada&lt;/a&gt; I will try to make it fast, but we will need a release of core components first. It will take a few weeks in total.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17914919" author="JIRAUSER308425" created="Tue, 21 Jan 2025 09:34:08 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17915818" author="jira-bot" created="Tue, 21 Jan 2025 19:54:56 +0000"  >&lt;p&gt;Commit ff87bf0075c92527c77931f93433894046e367c9 in httpcomponents-client&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=ff87bf007&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=ff87bf007&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2357&quot; title=&quot;HttpClient is not releasing connections when a proxy returns status codes  != 200&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2357&quot;&gt;&lt;del&gt;HTTPCLIENT-2357&lt;/del&gt;&lt;/a&gt;, regression: Classic HttpClient fails to release connect in case of a proxy authentication failure&lt;/p&gt;</comment>
                            <comment id="17915821" author="jira-bot" created="Tue, 21 Jan 2025 19:57:26 +0000"  >&lt;p&gt;Commit 7f56b8e4c49f67af6f7695914c11d59f68fc8e13 in httpcomponents-client&apos;s branch refs/heads/5.4.x from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=7f56b8e4c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=7f56b8e4c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2357&quot; title=&quot;HttpClient is not releasing connections when a proxy returns status codes  != 200&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2357&quot;&gt;&lt;del&gt;HTTPCLIENT-2357&lt;/del&gt;&lt;/a&gt;, regression: Classic HttpClient fails to release connect in case of a proxy authentication failure&lt;/p&gt;</comment>
                            <comment id="17915822" author="olegk" created="Tue, 21 Jan 2025 19:58:03 +0000"  >&lt;p&gt;Fixed in 5.4.x and master&lt;/p&gt;</comment>
                            <comment id="17923994" author="jira-bot" created="Wed, 5 Feb 2025 10:19:26 +0000"  >&lt;p&gt;Commit ff87bf0075c92527c77931f93433894046e367c9 in httpcomponents-client&apos;s branch refs/heads/dependabot/maven/org.junit-junit-bom-5.11.4 from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=ff87bf007&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=ff87bf007&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2357&quot; title=&quot;HttpClient is not releasing connections when a proxy returns status codes  != 200&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2357&quot;&gt;&lt;del&gt;HTTPCLIENT-2357&lt;/del&gt;&lt;/a&gt;, regression: Classic HttpClient fails to release connect in case of a proxy authentication failure&lt;/p&gt;</comment>
                            <comment id="17923999" author="jira-bot" created="Wed, 5 Feb 2025 10:22:36 +0000"  >&lt;p&gt;Commit ff87bf0075c92527c77931f93433894046e367c9 in httpcomponents-client&apos;s branch refs/heads/dependabot/maven/log4j.version-2.24.3 from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=ff87bf007&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=ff87bf007&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2357&quot; title=&quot;HttpClient is not releasing connections when a proxy returns status codes  != 200&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2357&quot;&gt;&lt;del&gt;HTTPCLIENT-2357&lt;/del&gt;&lt;/a&gt;, regression: Classic HttpClient fails to release connect in case of a proxy authentication failure&lt;/p&gt;</comment>
                            <comment id="17924004" author="jira-bot" created="Wed, 5 Feb 2025 10:24:12 +0000"  >&lt;p&gt;Commit ff87bf0075c92527c77931f93433894046e367c9 in httpcomponents-client&apos;s branch refs/heads/dependabot/maven/testcontainers.version-1.20.4 from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=ff87bf007&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=ff87bf007&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2357&quot; title=&quot;HttpClient is not releasing connections when a proxy returns status codes  != 200&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2357&quot;&gt;&lt;del&gt;HTTPCLIENT-2357&lt;/del&gt;&lt;/a&gt;, regression: Classic HttpClient fails to release connect in case of a proxy authentication failure&lt;/p&gt;</comment>
                            <comment id="17924010" author="jira-bot" created="Wed, 5 Feb 2025 10:29:09 +0000"  >&lt;p&gt;Commit ff87bf0075c92527c77931f93433894046e367c9 in httpcomponents-client&apos;s branch refs/heads/dependabot/maven/com.googlecode.maven-download-plugin-download-maven-plugin-1.13.0 from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=ff87bf007&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=ff87bf007&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2357&quot; title=&quot;HttpClient is not releasing connections when a proxy returns status codes  != 200&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2357&quot;&gt;&lt;del&gt;HTTPCLIENT-2357&lt;/del&gt;&lt;/a&gt;, regression: Classic HttpClient fails to release connect in case of a proxy authentication failure&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10431"><![CDATA[Important]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            39 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1tq5s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>