<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:22:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCLIENT-2203] Credentials not sent when using preemptive auth</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-2203</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                    <description>&lt;p&gt;After version 5.0.3, preemptive auth appears to be broken, with the &lt;tt&gt;Authorization&lt;/tt&gt; header missing from requests sent. I wonder if this may be related to the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2147&quot; title=&quot;authPreemptive and authPreemptiveProxy do not work in fluent api&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2147&quot;&gt;&lt;del&gt;HTTPCLIENT-2147&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I was able to reproduce this problem using the &lt;a href=&quot;https://github.com/apache/httpcomponents-client/blob/5.1.x/httpclient5/src/test/java/org/apache/hc/client5/http/examples/ClientPreemptiveBasicAuthentication.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Preemptive Authentication example&lt;/a&gt; provided in the &lt;a href=&quot;https://github.com/apache/httpcomponents-client&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;httpcomponents-client&lt;/a&gt; GitHub repo. Below I outline the differences between the behaviour of HttpClient 5.0.3 and 5.1.1+ (using the Preemptive Authentication example, and Java 15.0.1). Nothing besides the HttpClient version was altered between the two cases.&lt;/p&gt;
&lt;h2&gt;&lt;a name=&quot;HttpClient5.0.3&quot;&gt;&lt;/a&gt;&lt;b&gt;HttpClient 5.0.3&lt;/b&gt;&lt;/h2&gt;

&lt;p&gt;Preemptive Authentication example works as expected.&lt;/p&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Executing request GET http:&lt;span class=&quot;code-comment&quot;&gt;//httpbin.org/hidden-basic-auth/user/passwd
&lt;/span&gt;----------------------------------------
200 OK
{
  &lt;span class=&quot;code-quote&quot;&gt;&quot;authenticated&quot;&lt;/span&gt;: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, 
  &lt;span class=&quot;code-quote&quot;&gt;&quot;user&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;user&quot;&lt;/span&gt;
}

----------------------------------------
200 OK
{
  &lt;span class=&quot;code-quote&quot;&gt;&quot;authenticated&quot;&lt;/span&gt;: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, 
  &lt;span class=&quot;code-quote&quot;&gt;&quot;user&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;user&quot;&lt;/span&gt;
}

----------------------------------------
200 OK
{
  &lt;span class=&quot;code-quote&quot;&gt;&quot;authenticated&quot;&lt;/span&gt;: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, 
  &lt;span class=&quot;code-quote&quot;&gt;&quot;user&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;user&quot;&lt;/span&gt;
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Debugging showed that, at &lt;a href=&quot;https://github.com/apache/httpcomponents-client/blob/5.0.x/httpclient5/src/main/java/org/apache/hc/client5/http/impl/classic/RedirectExec.java#L118&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;RedirectExec.java, line 118&lt;/a&gt;, &lt;tt&gt;currentRequest&lt;/tt&gt; has 5 headers, including the &lt;tt&gt;Authorization&lt;/tt&gt; header with Basic credentials. (Frames: RedirectExec.java, execute:118; ExecChainElement, execute:51; InternalHttpClient, doExecute:178; ClosableHttpClient, execute:75; ClientPreemptiveBasicAuthentication, main:66)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;h2&gt;&lt;a name=&quot;andabove&quot;&gt;&lt;/a&gt;&lt;b&gt;&lt;font color=&quot;#172b4d&quot;&gt;HttpClient 5.1.1&lt;/font&gt; and above&lt;/b&gt;&lt;/h2&gt;

&lt;p&gt;Credentials are not sent with requests in the Preemptive Authentication example.&lt;/p&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Executing request GET http:&lt;span class=&quot;code-comment&quot;&gt;//httpbin.org/hidden-basic-auth/user/passwd
&lt;/span&gt;----------------------------------------
404 NOT FOUND

----------------------------------------
404 NOT FOUND

----------------------------------------
404 NOT FOUND &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Note: Not sure why the response is 404 with this URL; it is an authorisation issue and other URLs tend to return 403.&lt;/p&gt;

&lt;p&gt;Debugging showed that, at &lt;a href=&quot;https://github.com/apache/httpcomponents-client/blob/5.1.x/httpclient5/src/main/java/org/apache/hc/client5/http/impl/classic/RedirectExec.java#L117&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;RedirectExec.java, line 117&lt;/a&gt; (which is equivalent to line 118 in 5.0.x), &lt;tt&gt;currentRequest&lt;/tt&gt; has 4 headers, NOT including the &lt;tt&gt;Authorization&lt;/tt&gt; header. (Frames: RedirectExec.java, execute:117; ExecChainElement, execute:51; InternalHttpClient, doExecute:170; ClosableHttpClient, execute:75; ClientPreemptiveBasicAuthentication, main:66)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13427645">HTTPCLIENT-2203</key>
            <summary>Credentials not sent when using preemptive auth</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="SHowlett">S Howlett</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Feb 2022 04:20:37 +0000</created>
                <updated>Sun, 13 Feb 2022 19:22:33 +0000</updated>
                            <resolved>Sun, 13 Feb 2022 19:22:33 +0000</resolved>
                                    <version>5.1.1</version>
                    <version>5.1.2</version>
                    <version>5.1.3</version>
                                    <fixVersion>5.1.4</fixVersion>
                    <fixVersion>5.2-beta1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17490287" author="olegk" created="Thu, 10 Feb 2022 14:25:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=SHowlett&quot; class=&quot;user-hover&quot; rel=&quot;SHowlett&quot;&gt;SHowlett&lt;/a&gt; What is broken is the port normalization in the request target, not the preemptive authentication as such. When executing the same code against &lt;tt&gt;&lt;a href=&quot;http://httpbin.org:80/hidden-basic-auth/user/passwd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://httpbin.org:80/hidden-basic-auth/user/passwd&lt;/a&gt;&lt;/tt&gt;, everything should work as expected.&lt;/p&gt;

&lt;p&gt;&amp;gt; Note: Not sure why the response is 404 with this URL&lt;/p&gt;

&lt;p&gt;This is likely because the target endpoint is hidden.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17491662" author="jira-bot" created="Sun, 13 Feb 2022 18:44:17 +0000"  >&lt;p&gt;Commit 7de526741ac2c0fa918a1331ed9419687463ce8a in httpcomponents-client&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=7de5267&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=7de5267&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2203&quot; title=&quot;Credentials not sent when using preemptive auth&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2203&quot;&gt;&lt;del&gt;HTTPCLIENT-2203&lt;/del&gt;&lt;/a&gt;: Corrected target host normalization by the request execution interceptors; added ContextBuilder with support for preemptive authentication initialization&lt;/p&gt;</comment>
                            <comment id="17491668" author="jira-bot" created="Sun, 13 Feb 2022 19:03:52 +0000"  >&lt;p&gt;Commit 224622f7291c221fb6b2806e695a7b1d1e3f93e9 in httpcomponents-client&apos;s branch refs/heads/5.1.x from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=224622f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=224622f&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2203&quot; title=&quot;Credentials not sent when using preemptive auth&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2203&quot;&gt;&lt;del&gt;HTTPCLIENT-2203&lt;/del&gt;&lt;/a&gt;: Corrected target host normalization by the request execution interceptors&lt;/p&gt;</comment>
                            <comment id="17491671" author="jira-bot" created="Sun, 13 Feb 2022 19:17:37 +0000"  >&lt;p&gt;Commit 19626731c0016f6a0dccaabad8ff2eac00c416a3 in httpcomponents-client&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=1962673&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=1962673&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2203&quot; title=&quot;Credentials not sent when using preemptive auth&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2203&quot;&gt;&lt;del&gt;HTTPCLIENT-2203&lt;/del&gt;&lt;/a&gt;: Corrected target host normalization by the request execution interceptors; added ContextBuilder with support for preemptive authentication initialization&lt;/p&gt;</comment>
                            <comment id="17491672" author="olegk" created="Sun, 13 Feb 2022 19:22:33 +0000"  >&lt;p&gt;Fixed in 5.1.x and master.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 38 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0zfmw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>