<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:21:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCLIENT-1934] H2TlsStrategy does not handle proxy connections correctly</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-1934</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                    <description>&lt;p&gt;I&apos;m setting up a&#160;CloseableHttpAsyncClient with an AsyncClientConnectionManager that sets up an H2TlsStrategy for the https scheme. In my integration tests, I have one test that calls a target host, &lt;a href=&quot;https://localhost:8444/,&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://localhost:8444/,&lt;/a&gt;&#160;over a proxy located at&#160;127.0.0.7:8900. This mostly works: the client sends a CONNECT request to 127.0.0.7:8900 to set up a tunnel, and then sends a ClientHello to the target via the tunnel.&lt;/p&gt;

&lt;p&gt;The problem is that my HostnameVerifier is getting called back with the wrong hostname: instead of the target hostname (&quot;localhost&quot;), it is getting called back with the proxy hostname (&quot;127.0.0.7&quot;), and this then causes hostname verification to fail.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13172536">HTTPCLIENT-1934</key>
            <summary>H2TlsStrategy does not handle proxy connections correctly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="olegk">Oleg Kalnichevski</assignee>
                                    <reporter username="rschmitt">Ryan Schmitt</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Jul 2018 01:28:19 +0000</created>
                <updated>Thu, 19 Jul 2018 16:07:12 +0000</updated>
                            <resolved>Tue, 17 Jul 2018 09:40:22 +0000</resolved>
                                    <version>5.0 Beta1</version>
                                    <fixVersion>5.0 Beta2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="16546266" author="jira-bot" created="Tue, 17 Jul 2018 09:38:51 +0000"  >&lt;p&gt;Commit 50802106f6a3893029de66acdea8c0d07dc4bac9 in httpcomponents-client&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=httpcomponents-client.git;h=5080210&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=httpcomponents-client.git;h=5080210&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-1934&quot; title=&quot;H2TlsStrategy does not handle proxy connections correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-1934&quot;&gt;&lt;del&gt;HTTPCLIENT-1934&lt;/del&gt;&lt;/a&gt;: H2 TLS strategy passes wrong hostname to the hostname verifier&lt;/p&gt;</comment>
                            <comment id="16546269" author="olegk" created="Tue, 17 Jul 2018 09:40:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rschmitt&quot; class=&quot;user-hover&quot; rel=&quot;rschmitt&quot;&gt;rschmitt&lt;/a&gt; I committed a patch to master, which should fix the issue. Please verify / re-test and close the issue.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="16547015" author="rschmitt" created="Tue, 17 Jul 2018 19:25:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt; This patch seems to work. I noticed in the debugger that the SSLSession instance passed to the HostnameVerifier still shows the proxy information, not the target information, as the peer host and port, but I don&apos;t know if that&apos;s intentional or not.&lt;/p&gt;</comment>
                            <comment id="16547018" author="rschmitt" created="Tue, 17 Jul 2018 19:28:38 +0000"  >&lt;p&gt;I&apos;ll leave this open until you have a chance to comment on my SSLSession observation, just to be safe.&lt;/p&gt;</comment>
                            <comment id="16547516" author="olegk" created="Wed, 18 Jul 2018 08:02:54 +0000"  >&lt;blockquote&gt;&lt;p&gt;I noticed in the debugger that the SSLSession instance passed to the HostnameVerifier still shows the proxy information, not the target information, as the peer host and port, but I don&apos;t know if that&apos;s intentional or not&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;You are absolutely right. Corrected in HttpCore&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/httpcomponents-core/commit/6d32d7af&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/httpcomponents-core/commit/6d32d7af&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16548222" author="rschmitt" created="Wed, 18 Jul 2018 18:27:03 +0000"  >&lt;p&gt;This fixes it, although I had to patch additional classes (e.g. LoggingIOSession and&#160;DefaultManagedAsyncClientConnection) in order to get them to compile against the new&#160;TransportSecurityLayer interface.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 17 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3vygf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>