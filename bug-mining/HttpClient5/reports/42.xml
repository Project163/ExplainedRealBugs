<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:22:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCLIENT-1997] SSLPeerUnverifiedException on matching wildcard certificate</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-1997</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                    <description>&lt;p&gt;The step from httpclient 4.5.8 to 4.5.9 seems to have changed the behaviour of the &lt;tt&gt;DefaultHostNameVerifier&lt;/tt&gt;. I now receive an&#160;&lt;tt&gt;SSLPeerUnverifiedException&lt;/tt&gt; when trying to connect to a server that uses a wildcard server certificate. This used to work in 4.5.8.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
javax.net.ssl.SSLPeerUnverifiedException: Certificate &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &amp;lt;service.apps.dev.b.cloud.a&amp;gt; doesn&apos;t match any of the subject alternative names: [dev.b.cloud.a, *.system.dev.b.cloud.a, *.&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;.dev.b.cloud.a, *.login.system.dev.b.cloud.a, *.uaa.system.dev.b.cloud.a, *.apps.dev.b.cloud.a, *.ext.dev.b.cloud.a, CertreqId-12345]
&#160;&#160;&#160; at org.apache.http.conn.ssl.SSLConnectionSocketFactory.verifyHostname(SSLConnectionSocketFactory.java:507)
&#160;&#160;&#160; at org.apache.http.conn.ssl.SSLConnectionSocketFactory.createLayeredSocket(SSLConnectionSocketFactory.java:437)
&#160;&#160;&#160; at org.apache.http.conn.ssl.SSLConnectionSocketFactory.connectSocket(SSLConnectionSocketFactory.java:384)
&#160;&#160;&#160; at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:142)
&#160;&#160;&#160; at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:374)
&#160;&#160;&#160; at org.apache.http.impl.execchain.MainClientExec.establishRoute(MainClientExec.java:393)
&#160;&#160;&#160; at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:236)
&#160;&#160;&#160; at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:186)
&#160;&#160;&#160; at org.apache.http.impl.execchain.RetryExec.execute(RetryExec.java:89)
&#160;&#160;&#160; at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)
&#160;&#160;&#160; at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:185)
&#160;&#160;&#160; at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:83)
&#160;&#160;&#160; at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:56)
&#160;&#160;&#160; at org.springframework.http.client.HttpComponentsClientHttpRequest.executeInternal(HttpComponentsClientHttpRequest.java:87)
    ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;b&gt;Expected:&lt;/b&gt; The host name verifier should accept the subject alternative name&#160;&lt;tt&gt;*.apps.dev.b.cloud.a&lt;/tt&gt; for the server &lt;tt&gt;service.apps.dev.b.cloud.a&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;I suspect the issue to be related to &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-1991&quot; title=&quot;PublicSuffixMatcher invalid behaviour&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-1991&quot;&gt;&lt;del&gt;HTTPCLIENT-1991&lt;/del&gt;&lt;/a&gt;. It changed&#160;&lt;tt&gt;PublicSuffixMatcher&lt;/tt&gt; which is used by &lt;tt&gt;DefaultHostNameVerifier&lt;/tt&gt;. In the debugger I found that &lt;tt&gt;DefaultHostNameVerifier&lt;/tt&gt;.&lt;tt&gt;verify(String, SSLSession)&lt;/tt&gt; fails to verify the host/x509 certificate combination in line 99.&lt;/p&gt;</description>
                <environment>Oracle Java 11 on Mac OS 10.14.5&lt;br/&gt;
as well as Open JDK 11 on Pivotal Cloud Foundry/Linux 4.15.0-50-generic x86_64&lt;br/&gt;
&lt;br/&gt;
Spring Boot 2.1.6 wich uses httpclient 4.5.9</environment>
        <key id="13241527">HTTPCLIENT-1997</key>
            <summary>SSLPeerUnverifiedException on matching wildcard certificate</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="marclayer">Marc Layer</reporter>
                        <labels>
                    </labels>
                <created>Tue, 25 Jun 2019 16:19:58 +0000</created>
                <updated>Mon, 15 Jul 2019 14:50:26 +0000</updated>
                            <resolved>Thu, 27 Jun 2019 15:39:59 +0000</resolved>
                                    <version>4.5.9</version>
                                    <fixVersion>4.5.10</fixVersion>
                    <fixVersion>5.0 Beta5</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="16873000" author="marclayer" created="Wed, 26 Jun 2019 06:52:00 +0000"  >&lt;p&gt;When using the deprecated &lt;tt&gt;StrictHostnameVerifier&lt;/tt&gt;, the server certificate described above is accepted.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
HttpClient client = HttpClientBuilder.create()
        .setHostNameVerifier(StrictHostNameVerifier.INSTANCE)
        .build();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16873193" author="olegk" created="Wed, 26 Jun 2019 10:30:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marclayer&quot; class=&quot;user-hover&quot; rel=&quot;marclayer&quot;&gt;marclayer&lt;/a&gt; &lt;tt&gt;.a&lt;/tt&gt; is not on the public domain suffix list. Before I can confirm this is a regression I would like to understand what the correct behavior should be.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="16873245" author="marclayer" created="Wed, 26 Jun 2019 11:29:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt; You are right, it&apos;s an internal domain in my company&apos;s network. I did not realize that &lt;tt&gt;PublicSuffixMatcher&lt;/tt&gt; is just meant to match public TLDs. It may not be the culprit then, after all. It was just the only change from the release notes that struck me.&lt;/p&gt;

&lt;p&gt;Still, I would expect it to accept my &lt;tt&gt;service.apps.dev.b.cloud.a&lt;/tt&gt; as a match of &lt;tt&gt;*.apps.dev.b.cloud.a&lt;/tt&gt;. The certificate&apos;s CA (a company-internal CA) has been added to the trust managers of the &lt;tt&gt;SSLContext&lt;/tt&gt;. Or is &lt;tt&gt;DefaultHostNameVerifier&lt;/tt&gt; now meant to only accept public TLDs?&lt;/p&gt;</comment>
                            <comment id="16873326" author="michael-o" created="Wed, 26 Jun 2019 13:15:04 +0000"  >&lt;p&gt;Why are you susing made up domain names? Why don&apos;t register the domain and have the rest privately resolved? This what my company is doing with tens of TLDs.&lt;/p&gt;</comment>
                            <comment id="16873943" author="jira-bot" created="Thu, 27 Jun 2019 09:16:03 +0000"  >&lt;p&gt;Commit b6c9688e21a3b55677913aeacc1eb80aabc86b4b in httpcomponents-client&apos;s branch refs/heads/&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-1997&quot; title=&quot;SSLPeerUnverifiedException on matching wildcard certificate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-1997&quot;&gt;&lt;del&gt;HTTPCLIENT-1997&lt;/del&gt;&lt;/a&gt; from jeromedemangel&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=b6c9688&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=b6c9688&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-1997&quot; title=&quot;SSLPeerUnverifiedException on matching wildcard certificate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-1997&quot;&gt;&lt;del&gt;HTTPCLIENT-1997&lt;/del&gt;&lt;/a&gt;: Return the last domain segment instead of normalized domain name from PublicSuffixMatcher#getDomainRoot in case of there is no match&lt;/p&gt;</comment>
                            <comment id="16874003" author="marclayer" created="Thu, 27 Jun 2019 11:05:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=michael-o&quot; class=&quot;user-hover&quot; rel=&quot;michael-o&quot;&gt;michael-o&lt;/a&gt; Private internal domains have been in use for years around here. It was designed by the network admins like that. Huge company btw., so I would hope that this approach is not too outlandish. But I cannot really comment on this, I&apos;m just using the existing infrastructure and it&apos;s not going to be changed just for me. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/biggrin.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16874061" author="michael-o" created="Thu, 27 Jun 2019 12:09:44 +0000"  >&lt;p&gt;This is probably the first line in the network handbook, don&apos;t design with private domains. Even Microsoft AD handbook recommends using public ones even if you are routing those hosts. So is here with &amp;gt; 100 000 clients.&lt;/p&gt;</comment>
                            <comment id="16874257" author="jira-bot" created="Thu, 27 Jun 2019 15:33:33 +0000"  >&lt;p&gt;Commit 19a87e0c772558231e571f99e0a05c0f32ff18eb in httpcomponents-client&apos;s branch refs/heads/master from jeromedemangel&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=19a87e0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=19a87e0&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-1997&quot; title=&quot;SSLPeerUnverifiedException on matching wildcard certificate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-1997&quot;&gt;&lt;del&gt;HTTPCLIENT-1997&lt;/del&gt;&lt;/a&gt;: Return the last domain segment instead of normalized domain name from PublicSuffixMatcher#getDomainRoot in case there is no match&lt;/p&gt;</comment>
                            <comment id="16874261" author="jira-bot" created="Thu, 27 Jun 2019 15:38:36 +0000"  >&lt;p&gt;Commit c1e2339f0f70dd241898521eac2f1ff143987b57 in httpcomponents-client&apos;s branch refs/heads/4.5.x from jeromedemangel&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=c1e2339&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=c1e2339&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-1997&quot; title=&quot;SSLPeerUnverifiedException on matching wildcard certificate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-1997&quot;&gt;&lt;del&gt;HTTPCLIENT-1997&lt;/del&gt;&lt;/a&gt;: Return the last domain segment instead of normalized domain name from PublicSuffixMatcher#getDomainRoot in case there is no match&lt;/p&gt;</comment>
                            <comment id="16874264" author="olegk" created="Thu, 27 Jun 2019 15:39:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marclayer&quot; class=&quot;user-hover&quot; rel=&quot;marclayer&quot;&gt;marclayer&lt;/a&gt; Fixed in 4.5.x and master. Please review / re-test.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="16874811" author="marclayer" created="Fri, 28 Jun 2019 09:29:44 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt;, looks good to me. SSL handshake succeeds now in our environment. Thanks for the quick fix!&lt;/p&gt;

&lt;p&gt;Cheers,&lt;br/&gt;
Marc&lt;/p&gt;</comment>
                            <comment id="16884665" author="jira-bot" created="Sun, 14 Jul 2019 12:30:17 +0000"  >&lt;p&gt;Commit 19a87e0c772558231e571f99e0a05c0f32ff18eb in httpcomponents-client&apos;s branch refs/heads/JDK-8212885 from jeromedemangel&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=19a87e0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=19a87e0&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-1997&quot; title=&quot;SSLPeerUnverifiedException on matching wildcard certificate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-1997&quot;&gt;&lt;del&gt;HTTPCLIENT-1997&lt;/del&gt;&lt;/a&gt;: Return the last domain segment instead of normalized domain name from PublicSuffixMatcher#getDomainRoot in case there is no match&lt;/p&gt;</comment>
                            <comment id="16884682" author="jira-bot" created="Sun, 14 Jul 2019 13:52:34 +0000"  >&lt;p&gt;Commit 19a87e0c772558231e571f99e0a05c0f32ff18eb in httpcomponents-client&apos;s branch refs/heads/httpcore-5.0b8-upgrade from jeromedemangel&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=19a87e0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=19a87e0&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-1997&quot; title=&quot;SSLPeerUnverifiedException on matching wildcard certificate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-1997&quot;&gt;&lt;del&gt;HTTPCLIENT-1997&lt;/del&gt;&lt;/a&gt;: Return the last domain segment instead of normalized domain name from PublicSuffixMatcher#getDomainRoot in case there is no match&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="13243435">HTTPCLIENT-2000</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13244986">HTTPCLIENT-2003</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 17 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0439s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>