<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:22:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCLIENT-2116] request http website via proxy, the cookie don&apos;t work well</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-2116</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                    <description>&lt;p&gt;I write the code to&#160;exhibiting the problem:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    CookieStore cookieStore = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BasicCookieStore();
    BasicClientCookie cookie = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BasicClientCookie(&lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;);
    cookie.setDomain(&lt;span class=&quot;code-quote&quot;&gt;&quot;cn.bing.com&quot;&lt;/span&gt;);
    cookie.setPath(&lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;);
    cookieStore.addCookie(cookie);

    log.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;request no proxy: &quot;&lt;/span&gt;);

    Request request = Request.get(&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//cn.bing.com&quot;&lt;/span&gt;);
&lt;/span&gt;    Executor.newInstance()
            .use(cookieStore)
            .execute(request);

    log.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;request with proxy: &quot;&lt;/span&gt;);

    Request requestThroughProxy = Request.get(&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//cn.bing.com&quot;&lt;/span&gt;)
&lt;/span&gt;            .viaProxy(&lt;span class=&quot;code-quote&quot;&gt;&quot;192.168.31.145:10809&quot;&lt;/span&gt;);
    Executor.newInstance()
            .use(cookieStore)
            .execute(requestThroughProxy);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;the debug log only take the&#160;org.apache.hc.client5.http.headers:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2020-09-05 23:11:38.532  INFO 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] xyz.darrenluo.front.IndexController      : request no proxy: 
2020-09-05 23:11:38.762 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;gt;&amp;gt; GET / HTTP/1.1
2020-09-05 23:11:38.762 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;gt;&amp;gt; Accept-Encoding: gzip, x-gzip, deflate
2020-09-05 23:11:38.763 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;gt;&amp;gt; Host: cn.bing.com
2020-09-05 23:11:38.763 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;gt;&amp;gt; Connection: keep-alive
2020-09-05 23:11:38.763 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;gt;&amp;gt; User-Agent: Apache-HttpClient/5.0.1 (Java/14.0.2)
2020-09-05 23:11:38.763 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;gt;&amp;gt; Cookie: test=test
2020-09-05 23:11:38.865 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;lt;&amp;lt; HTTP/1.1 200 OK
2020-09-05 23:11:38.865 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;lt;&amp;lt; Cache-Control: &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt;, max-age=0
2020-09-05 23:11:38.865 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;lt;&amp;lt; Content-Length: 50197
2020-09-05 23:11:38.865 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;lt;&amp;lt; Content-Type: text/html; charset=utf-8
2020-09-05 23:11:38.865 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;lt;&amp;lt; Content-Encoding: gzip
2020-09-05 23:11:38.865 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;lt;&amp;lt; Vary: Accept-Encoding
2020-09-05 23:11:38.865 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;lt;&amp;lt; P3P: CP=&lt;span class=&quot;code-quote&quot;&gt;&quot;NON UNI COM NAV STA LOC CURa DEVa PSAa PSDa OUR IND&quot;&lt;/span&gt;
2020-09-05 23:11:38.865 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;lt;&amp;lt; Set-Cookie: SRCHD=AF=NOFORM; domain=.bing.com; expires=Mon, 05-Sep-2022 15:12:13 GMT; path=/
2020-09-05 23:11:38.865 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;lt;&amp;lt; Set-Cookie: SRCHUID=V=2&amp;amp;GUID=E44E11C37DE441DFA5940BAE884596BC&amp;amp;dmnchg=1; domain=.bing.com; expires=Mon, 05-Sep-2022 15:12:13 GMT; path=/
2020-09-05 23:11:38.865 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;lt;&amp;lt; Set-Cookie: SRCHUSR=DOB=20200905; domain=.bing.com; expires=Mon, 05-Sep-2022 15:12:13 GMT; path=/
2020-09-05 23:11:38.865 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;lt;&amp;lt; Set-Cookie: _SS=SID=2E8C407D0B98662F2D5F4F410AB6672F; domain=.bing.com; path=/
2020-09-05 23:11:38.866 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;lt;&amp;lt; X-MSEdge-Ref: Ref A: BE500D3E6E4540FC8ACB3C378D68DB63 Ref B: BJ1EDGE0211 Ref C: 2020-09-05T15:12:13Z
2020-09-05 23:11:38.866 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;lt;&amp;lt; Set-Cookie: _EDGE_S=F=1&amp;amp;SID=2E8C407D0B98662F2D5F4F410AB6672F; path=/; httponly; domain=bing.com
2020-09-05 23:11:38.866 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;lt;&amp;lt; Set-Cookie: _EDGE_V=1; path=/; httponly; expires=Thu, 30-Sep-2021 15:12:13 GMT; domain=bing.com
2020-09-05 23:11:38.866 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;lt;&amp;lt; Set-Cookie: MUID=0AFCAD618379630E0B1CA25D825762D3; samesite=none; path=/; secure; expires=Thu, 30-Sep-2021 15:12:13 GMT; domain=bing.com
2020-09-05 23:11:38.866 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;lt;&amp;lt; Set-Cookie: MUIDB=0AFCAD618379630E0B1CA25D825762D3; path=/; httponly; expires=Thu, 30-Sep-2021 15:12:13 GMT
2020-09-05 23:11:38.866 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-0 &amp;lt;&amp;lt; Date: Sat, 05 Sep 2020 15:12:13 GMT
2020-09-05 23:11:38.887  INFO 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] xyx.darrenluo.front.IndexController      : request with proxy: 
2020-09-05 23:11:45.729 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;gt;&amp;gt; GET http:&lt;span class=&quot;code-comment&quot;&gt;//cn.bing.com/ HTTP/1.1
&lt;/span&gt;2020-09-05 23:11:45.729 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;gt;&amp;gt; Accept-Encoding: gzip, x-gzip, deflate
2020-09-05 23:11:45.729 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;gt;&amp;gt; Host: cn.bing.com
2020-09-05 23:11:45.729 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;gt;&amp;gt; User-Agent: Apache-HttpClient/5.0.1 (Java/14.0.2)
2020-09-05 23:11:47.396 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; HTTP/1.1 200 OK
2020-09-05 23:11:47.396 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; Content-Length: 50189
2020-09-05 23:11:47.396 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; Cache-Control: &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt;, max-age=0
2020-09-05 23:11:47.396 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; Connection: keep-alive
2020-09-05 23:11:47.396 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; Content-Encoding: gzip
2020-09-05 23:11:47.396 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; Content-Type: text/html; charset=utf-8
2020-09-05 23:11:47.397 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; Date: Sat, 05 Sep 2020 15:12:21 GMT
2020-09-05 23:11:47.397 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; Keep-Alive: timeout=4
2020-09-05 23:11:47.397 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; P3p: CP=&lt;span class=&quot;code-quote&quot;&gt;&quot;NON UNI COM NAV STA LOC CURa DEVa PSAa PSDa OUR IND&quot;&lt;/span&gt;
2020-09-05 23:11:47.397 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; Proxy-Connection: keep-alive
2020-09-05 23:11:47.397 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; Set-Cookie: SRCHD=AF=NOFORM; domain=.bing.com; expires=Mon, 05-Sep-2022 15:12:21 GMT; path=/
2020-09-05 23:11:47.397 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; Set-Cookie: SRCHUID=V=2&amp;amp;GUID=CC885652695145E887299DF256097783&amp;amp;dmnchg=1; domain=.bing.com; expires=Mon, 05-Sep-2022 15:12:21 GMT; path=/
2020-09-05 23:11:47.397 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; Set-Cookie: SRCHUSR=DOB=20200905; domain=.bing.com; expires=Mon, 05-Sep-2022 15:12:21 GMT; path=/
2020-09-05 23:11:47.397 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; Set-Cookie: _SS=SID=01BC6F54CDD16E6A04936068CC5A6F68; domain=.bing.com; path=/
2020-09-05 23:11:47.397 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; Set-Cookie: _EDGE_S=F=1&amp;amp;SID=01BC6F54CDD16E6A04936068CC5A6F68; path=/; httponly; domain=bing.com
2020-09-05 23:11:47.397 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; Set-Cookie: _EDGE_V=1; path=/; httponly; expires=Thu, 30-Sep-2021 15:12:21 GMT; domain=bing.com
2020-09-05 23:11:47.397 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; Set-Cookie: MUID=2AE7B0BA15D560010AA3BF86145E6103; samesite=none; path=/; secure; expires=Thu, 30-Sep-2021 15:12:21 GMT; domain=bing.com
2020-09-05 23:11:47.398 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; Set-Cookie: MUIDB=2AE7B0BA15D560010AA3BF86145E6103; path=/; httponly; expires=Thu, 30-Sep-2021 15:12:21 GMT
2020-09-05 23:11:47.398 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; Vary: Accept-Encoding
2020-09-05 23:11:47.398 DEBUG 10485 --- [lication &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] org.apache.hc.client5.http.headers       : http-outgoing-1 &amp;lt;&amp;lt; X-Msedge-Ref: Ref A: E5AD174CC4AA4832BC8F8D750AD30CA9 Ref B: SG2EDGE1120 Ref C: 2020-09-05T15:12:21Z&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;only with no proxy have&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
http-outgoing-0 &amp;gt;&amp;gt; Cookie: test=test&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and I try to fix this problem, look the github&#160;&lt;a href=&quot;https://github.com/apache/httpcomponents-client/pull/254&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;pr&lt;/a&gt;&lt;/p&gt;</description>
                <environment>operating system: macOS 10.15.6&lt;br/&gt;
httpclient version: 5.0.1</environment>
        <key id="13326157">HTTPCLIENT-2116</key>
            <summary>request http website via proxy, the cookie don&apos;t work well</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="darrenluo">Darrenluo</reporter>
                        <labels>
                    </labels>
                <created>Sat, 5 Sep 2020 15:52:01 +0000</created>
                <updated>Wed, 24 Feb 2021 21:02:21 +0000</updated>
                            <resolved>Sat, 19 Sep 2020 13:44:27 +0000</resolved>
                                    <version>5.0.1</version>
                    <version>5.0</version>
                                    <fixVersion>5.0.2</fixVersion>
                    <fixVersion>5.1-beta1</fixVersion>
                                    <component>HttpClient (classic)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17191090" author="olegk" created="Sat, 5 Sep 2020 16:41:05 +0000"  >&lt;p&gt;Thank you for the detailed report. I will look into it the next week.&lt;br/&gt;
Oleg&lt;/p&gt;</comment>
                            <comment id="17193608" author="olegk" created="Thu, 10 Sep 2020 12:55:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=darrenluo&quot; class=&quot;user-hover&quot; rel=&quot;darrenluo&quot;&gt;darrenluo&lt;/a&gt; It turned out to be quite a nasty bug. I am looking into it.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17195160" author="darrenluo" created="Mon, 14 Sep 2020 02:51:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt;&#160;I try to resolve this problem&#65292;in this pr &lt;a href=&quot;https://github.com/apache/httpcomponents-client/pull/254&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/httpcomponents-client/pull/254&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;i don&apos;t know if this change will cause other problems&lt;/p&gt;</comment>
                            <comment id="17195329" author="olegk" created="Mon, 14 Sep 2020 09:23:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=darrenluo&quot; class=&quot;user-hover&quot; rel=&quot;darrenluo&quot;&gt;darrenluo&lt;/a&gt;&#160;I am well aware of your PR but it does not quite do the right thing and it does cause compatibility issues with the Squid proxy server, for instance. Please bear with me. I am working on a fix.&lt;/p&gt;

&lt;p&gt;Oleg&#160;&lt;/p&gt;</comment>
                            <comment id="17196856" author="olegk" created="Wed, 16 Sep 2020 10:25:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=darrenluo&quot; class=&quot;user-hover&quot; rel=&quot;darrenluo&quot;&gt;darrenluo&lt;/a&gt; Please see the fix I am proposing to solve the issue. Please review / test with your code.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/ok2c/httpcomponents-client/commit/76103744086bf2158a9d497ebc8f7a0e3d8a71d4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ok2c/httpcomponents-client/commit/76103744086bf2158a9d497ebc8f7a0e3d8a71d4&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17198735" author="jira-bot" created="Sat, 19 Sep 2020 13:43:42 +0000"  >&lt;p&gt;Commit ae6725056cc4eac6606931471866ce41dbe4ae74 in httpcomponents-client&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=ae67250&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=ae67250&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2116&quot; title=&quot;request http website via proxy, the cookie don&amp;#39;t work well&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2116&quot;&gt;&lt;del&gt;HTTPCLIENT-2116&lt;/del&gt;&lt;/a&gt;: Incorrect request message composition when routing requests via a proxy&lt;/p&gt;</comment>
                            <comment id="17289447" author="vadam" created="Wed, 24 Feb 2021 00:27:22 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Is there any chance this got backported to 4.5.x ? I&apos;m trying to add User-Agent header to requests that go through an HTTP proxy, and it looks like HttpClient just uses its own one there instead of the one set on the request.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="17289948" author="olegk" created="Wed, 24 Feb 2021 14:10:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vadam&quot; class=&quot;user-hover&quot; rel=&quot;vadam&quot;&gt;vadam&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&amp;gt; Is there any chance this got backported to 4.5.x ?&lt;/p&gt;

&lt;p&gt;The bug is question was a regression in 5.x. The 4.5.x series has not been affected.&lt;/p&gt;

&lt;p&gt;&amp;gt; I&apos;m trying to add User-Agent header to requests that go through an HTTP proxy, and it looks like HttpClient just uses its own one there instead of the one set on the request&lt;/p&gt;

&lt;p&gt;I am not sure I understand what is stopping you from setting a custom `User-Agent` value through `HttpClientBuilder`.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17290231" author="vadam" created="Wed, 24 Feb 2021 20:04:41 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks for the quick reply!&lt;/p&gt;

&lt;p&gt;Looking at the 4.5.x implementation, it looks to me that if you set the `User-Agent` header on a request object (not the client) then the proxy code will not copy those over when doing the HTTP CONNECT request. Is that expected?&lt;/p&gt;

&lt;p&gt;I can probably provide a test demonstrating the issue if that helps?&lt;/p&gt;

&lt;p&gt;Thanks, Viktor&lt;/p&gt;</comment>
                            <comment id="17290259" author="olegk" created="Wed, 24 Feb 2021 20:52:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vadam&quot; class=&quot;user-hover&quot; rel=&quot;vadam&quot;&gt;vadam&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;&amp;gt;&#160;&#160;you set the `User-Agent` header on a request object (not the client) then the proxy code will not copy those over when doing the HTTP CONNECT request. Is that expected?&lt;/p&gt;

&lt;p&gt;This is expected because it is not supposed to.&lt;/p&gt;

&lt;p&gt;Please configure custom `User-Agent` value through&#160;HttpClientBuilder.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17290263" author="vadam" created="Wed, 24 Feb 2021 21:02:21 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt;, I&apos;ll try that.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 37 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0id1c:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>