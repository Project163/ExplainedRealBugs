<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:21:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCLIENT-1716] DefaultRedirectStrategy seems to disregard HTTP spec for PUT/POST/DELETE request redirects</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-1716</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                    <description>&lt;p&gt;Observed on &lt;tt&gt;trunk&lt;/tt&gt; branch that has 5.0-alpha2-SNAPSHOT mvn version.&lt;/p&gt;

&lt;p&gt;The docs for &lt;tt&gt;DefaultRedirectStrategy&lt;/tt&gt; correctly state:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;This strategy honors the restrictions on automatic redirection of entity enclosing methods such as POST and PUT imposed by the HTTP specification. {@code 302 Moved Temporarily}, {@code 301 Moved Permanently} and {@code 307 Temporary Redirect} status codes will result in an automatic redirect of HEAD and GET methods only. POST and PUT methods will not be automatically redirected as requiring user confirmation.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;(NB: in fact to be more precise I think DELETE requests should also be &lt;b&gt;not&lt;/b&gt; automatically redirected)&lt;/p&gt;

&lt;p&gt;However the actual implementation does not seem to follow this, whereby &lt;tt&gt;isRedirected&lt;/tt&gt; pretty much lets all requests through:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; (statusCode) {
            &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; HttpStatus.SC_MOVED_PERMANENTLY:
            &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; HttpStatus.SC_MOVED_TEMPORARILY:
            &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; HttpStatus.SC_SEE_OTHER:
            &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; HttpStatus.SC_TEMPORARY_REDIRECT:
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
            &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;:
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A simple failing test case that confirms the problem for a PUT request resulting with 302 (PUT should only be redirected automatically for 303):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testIsRedirectedForTemporaryRedirectPut() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; DefaultRedirectStrategy redirectStrategy = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DefaultRedirectStrategy();
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; HttpResponse response = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BasicHttpResponse(HttpVersion.HTTP_1_1,
                HttpStatus.SC_TEMPORARY_REDIRECT, &lt;span class=&quot;code-quote&quot;&gt;&quot;Temporary Redirect&quot;&lt;/span&gt;);
        response.addHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;Location&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//localhost/stuff&quot;&lt;/span&gt;);
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; HttpContext context = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BasicHttpContext();
        assertFalse(redirectStrategy.isRedirected(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HttpPut(&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//localhost/&quot;&lt;/span&gt;), response, context));
&lt;/span&gt;    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12934680">HTTPCLIENT-1716</key>
            <summary>DefaultRedirectStrategy seems to disregard HTTP spec for PUT/POST/DELETE request redirects</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kordzik">Dariusz Kordonski</reporter>
                        <labels>
                    </labels>
                <created>Thu, 28 Jan 2016 04:30:04 +0000</created>
                <updated>Thu, 4 May 2017 09:49:18 +0000</updated>
                            <resolved>Thu, 28 Jan 2016 16:17:54 +0000</resolved>
                                    <version>5.0 Alpha1</version>
                                    <fixVersion>5.0 Alpha2</fixVersion>
                                    <component>HttpClient (classic)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="15121060" author="olegk" created="Thu, 28 Jan 2016 08:58:09 +0000"  >&lt;p&gt;My understanding of &lt;a href=&quot;https://tools.ietf.org/html/rfc7231#section-6.4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;RFC7231&lt;/a&gt; is that those restrictions no longer apply. In some cases non-safe methods such as POST need to be converted to GET, but PUT but being idempotent is considered safe.&lt;/p&gt;

&lt;p&gt;Javadocs are clearly out of sync with code, but this can happen in the ALPHA phase.&lt;/p&gt;

&lt;p&gt;Oleg &lt;/p&gt;</comment>
                            <comment id="15121266" author="kordzik" created="Thu, 28 Jan 2016 11:49:11 +0000"  >&lt;p&gt;Hi Oleg,&lt;/p&gt;

&lt;p&gt;thanks for pointing that out, I wasn&apos;t aware of the new revision of HTTP 1.1, I was basing my comments on the outdated docs and what I read on the web. I guess in such case it&apos;s definitely not a bug, although my reading of &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Automatic redirection needs to done with care for methods not known to be safe, as defined in Section 4.2.1, since the user might not wish to redirect an unsafe request.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;is that idempotent methods are not necessarily always OK to automatically redirect (as opposed to safe methods, to which PUT does not belong as per 4.2.1). &lt;/p&gt;

&lt;p&gt;However I don&apos;t have much expertise in interpreting specifications and I raised this issue with the &quot;traditional&quot; interpretation of 3xx restrictions in mind, so feel free to close it (with the hope that the docs of &lt;tt&gt;DefaultRedirectStrategy&lt;/tt&gt; will be updated at some point).&lt;/p&gt;

&lt;p&gt;Best regards,&lt;br/&gt;
Dariusz Kordonski&lt;/p&gt;</comment>
                            <comment id="15121811" author="olegk" created="Thu, 28 Jan 2016 16:17:54 +0000"  >&lt;p&gt;Fixed in SVN trunk. Please review.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 42 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2s2nb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>