<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:22:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCLIENT-2292] SOCKS proxy configuration is not working</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-2292</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                    <description>&lt;h3&gt;&lt;a name=&quot;Currentbehaviour&quot;&gt;&lt;/a&gt;Current behaviour&lt;/h3&gt;

&lt;p&gt;A SOCKS proxy can be configured via the &lt;tt&gt;PoolingHttpClientConnectionManagerBuilder. setDefaultSocketConfig()&lt;/tt&gt; method which accepts &lt;tt&gt;SocketConfig.setSocksProxyAddress(socksaddr)&lt;/tt&gt; configuration.&lt;/p&gt;

&lt;p&gt;*&lt;b&gt;The &lt;tt&gt;socksProxyAddress&lt;/tt&gt; configuration is ignored in class HttpClient&lt;/b&gt;*&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Expectedbehaviour&quot;&gt;&lt;/a&gt;Expected behaviour&lt;/h3&gt;

&lt;ul&gt;
	&lt;li&gt;Proxy aware socket instances are instantiated by the &lt;tt&gt;Socket(Proxy proxy)&lt;/tt&gt; constructor.&lt;/li&gt;
	&lt;li&gt;Sockets are created via the &lt;tt&gt;ConnectionSocketFactory.createSocket()&lt;/tt&gt; method.&lt;/li&gt;
	&lt;li&gt;The &lt;tt&gt;DefaultHttpClientConnectionOperator.connect()&lt;/tt&gt; method, which holds aforementioned configuration, calls the socket factory.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So, we need to pass the proxy address from the operator into the socket factory method.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13547618">HTTPCLIENT-2292</key>
            <summary>SOCKS proxy configuration is not working</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="vkuzel">V&#225;clav Ku&#382;el</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Aug 2023 18:45:10 +0000</created>
                <updated>Wed, 10 Jan 2024 20:17:02 +0000</updated>
                            <resolved>Fri, 15 Sep 2023 09:37:42 +0000</resolved>
                                    <version>5.2.2</version>
                                    <fixVersion>5.2.3</fixVersion>
                    <fixVersion>5.3</fixVersion>
                                    <component>HttpClient (classic)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3600">1h</timespent>
                                <comments>
                            <comment id="17760986" author="jira-bot" created="Thu, 31 Aug 2023 14:57:58 +0000"  >&lt;p&gt;Commit 32ecc6aa7d1c83e9498c08d0e8b43bd86cf62728 in httpcomponents-client&apos;s branch refs/heads/&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2292&quot; title=&quot;SOCKS proxy configuration is not working&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2292&quot;&gt;&lt;del&gt;HTTPCLIENT-2292&lt;/del&gt;&lt;/a&gt; from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=32ecc6aa7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=32ecc6aa7&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2292&quot; title=&quot;SOCKS proxy configuration is not working&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2292&quot;&gt;&lt;del&gt;HTTPCLIENT-2292&lt;/del&gt;&lt;/a&gt;: HttpClient ignores socketConfig#getSocksProxyAddress&lt;/p&gt;</comment>
                            <comment id="17760990" author="jira-bot" created="Thu, 31 Aug 2023 15:01:17 +0000"  >&lt;p&gt;Commit aa5a7c7fe043935164729d2c92d00860f8c7afc8 in httpcomponents-client&apos;s branch refs/heads/&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2292&quot; title=&quot;SOCKS proxy configuration is not working&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2292&quot;&gt;&lt;del&gt;HTTPCLIENT-2292&lt;/del&gt;&lt;/a&gt; from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=aa5a7c7fe&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=aa5a7c7fe&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2292&quot; title=&quot;SOCKS proxy configuration is not working&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2292&quot;&gt;&lt;del&gt;HTTPCLIENT-2292&lt;/del&gt;&lt;/a&gt;: HttpClient ignores socketConfig#getSocksProxyAddress&lt;/p&gt;</comment>
                            <comment id="17760991" author="olegk" created="Thu, 31 Aug 2023 15:02:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vkuzel&quot; class=&quot;user-hover&quot; rel=&quot;vkuzel&quot;&gt;vkuzel&lt;/a&gt; Please review / test the proposed fix:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/httpcomponents-client/commit/aa5a7c7fe043935164729d2c92d00860f8c7afc8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/httpcomponents-client/commit/aa5a7c7fe043935164729d2c92d00860f8c7afc8&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17765526" author="jira-bot" created="Fri, 15 Sep 2023 09:28:09 +0000"  >&lt;p&gt;Commit aa5a7c7fe043935164729d2c92d00860f8c7afc8 in httpcomponents-client&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=aa5a7c7fe&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=aa5a7c7fe&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2292&quot; title=&quot;SOCKS proxy configuration is not working&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2292&quot;&gt;&lt;del&gt;HTTPCLIENT-2292&lt;/del&gt;&lt;/a&gt;: HttpClient ignores socketConfig#getSocksProxyAddress&lt;/p&gt;</comment>
                            <comment id="17765528" author="jira-bot" created="Fri, 15 Sep 2023 09:34:40 +0000"  >&lt;p&gt;Commit 404a3ab83e569f4fcdb24337bcd1b52f57992a8f in httpcomponents-client&apos;s branch refs/heads/5.2.x from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=404a3ab83&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=404a3ab83&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2292&quot; title=&quot;SOCKS proxy configuration is not working&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2292&quot;&gt;&lt;del&gt;HTTPCLIENT-2292&lt;/del&gt;&lt;/a&gt;: HttpClient ignores socketConfig#getSocksProxyAddress&lt;/p&gt;</comment>
                            <comment id="17789846" author="mmoayyed" created="Sun, 26 Nov 2023 20:24:47 +0000"  >&lt;p&gt;This seems to have caused a regression in 5.2.2.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.IllegalArgumentException: Invalid Proxy
&#160; &#160; at java.base/java.net.Socket.&amp;lt;init&amp;gt;(Socket.java:216)
&#160; &#160; at org.apache.hc.client5.http.ssl.SSLConnectionSocketFactory.createSocket(SSLConnectionSocketFactory.java:208)
&#160; &#160; at org.apache.hc.client5.http.impl.io.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:158)
&#160; &#160; at org.apache.hc.client5.http.impl.io.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:447)
&#160; &#160; at org.apache.hc.client5.http.impl.classic.InternalExecRuntime.connectEndpoint(InternalExecRuntime.java:162)
&#160; &#160; at org.apache.hc.client5.http.impl.classic.InternalExecRuntime.connectEndpoint(InternalExecRuntime.java:172) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;When the proxy is undefined or set to null,&#160;DefaultHttpClientConnectionOperator does the following:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Timeout soTimeout = socketConfig.getSoTimeout();
SocketAddress socksProxyAddress = socketConfig.getSocksProxyAddress();
Proxy proxy = socksProxyAddress != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; ? &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Proxy(Type.SOCKS, socksProxyAddress) : &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The proxy object above is then null, which means the following call:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Socket sock = sf.createSocket(proxy, context); &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;...will eventually pass down to SSLConnectionSocketFactory which does this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Socket createSocket(Proxy proxy, HttpContext context) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Socket(proxy); &lt;span class=&quot;code-comment&quot;&gt;//&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; proxy cannot be &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
&lt;/span&gt;} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;br/&gt;
I think the code needs to do something like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (proxy != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
      Socket sock = sf.createSocket(proxy, context);  
} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
      Socket sock = sf.createSocket(context); 
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I should mention that in the above case,&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;No SOCKS proxy is ever configured via the &lt;tt&gt;PoolingHttpClientConnectionManagerBuilder. setDefaultSocketConfig()&lt;/tt&gt; method&#160;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;No&#160; &lt;tt&gt;SocketConfig.setSocksProxyAddress(socksaddr)&lt;/tt&gt; exists and is always null.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17789852" author="mmoayyed" created="Sun, 26 Nov 2023 20:40:13 +0000"  >&lt;p&gt;Please see &lt;a href=&quot;https://github.com/apache/httpcomponents-client/pull/512&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/httpcomponents-client/pull/512&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17790130" author="garydgregory" created="Mon, 27 Nov 2023 15:24:43 +0000"  >&lt;p&gt;I updated the version to show that the problem occurs in 5.2.2, not 5.2.1 and will be fixed in 5.2.3.&lt;/p&gt;</comment>
                            <comment id="17792528" author="JIRAUSER300541" created="Sun, 3 Dec 2023 13:34:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggregory&quot; class=&quot;user-hover&quot; rel=&quot;ggregory&quot;&gt;ggregory&lt;/a&gt; There still seems to be an issue / regression that was not fixed with 5.2.3. See &lt;a href=&quot;https://github.com/jenkinsci/docker-plugin/issues/1032&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jenkinsci/docker-plugin/issues/1032&lt;/a&gt; &lt;/p&gt;

&lt;p&gt;I&apos;m currently trying to reproduce this, but some help would be greatly appreciated.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 48 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1ju28:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>