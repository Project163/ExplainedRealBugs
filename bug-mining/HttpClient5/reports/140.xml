<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:23:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCLIENT-2393] Authorization header contains rspauth</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-2393</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                    <description>&lt;p&gt;After upgrading to HttpClient 5, one of our services stopped working with Digest Authentication.&lt;/p&gt;

&lt;p&gt;We traced this to a recent change where the client now includes an rspauth parameter in the Authorization header during the authentication request.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/httpcomponents-client/pull/594&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/httpcomponents-client/pull/594&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Is this behaviour in HttpClient 5 intentional and correct according to the Digest Authentication specification?&lt;/p&gt;

&lt;p&gt;According to our reading of RFC 7616, rspauth is generated by the server and sent in the Authentication-Info header &#8212; not calculated or sent by the client in the Authorization header. Based on this, we would have expected the client never to send rspauth.&lt;/p&gt;
&lt;h4&gt;&lt;a name=&quot;Minimalreproducibleexample%3A&quot;&gt;&lt;/a&gt;Minimal reproducible example:&lt;/h4&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; urlPattern = &lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//httpbin.org/digest-auth/auth/{0}/{1}&quot;&lt;/span&gt;;
&lt;/span&gt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; user = &lt;span class=&quot;code-quote&quot;&gt;&quot;myUser&quot;&lt;/span&gt;;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; pwd = &lt;span class=&quot;code-quote&quot;&gt;&quot;myPassword&quot;&lt;/span&gt;;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; url = MessageFormat.format(urlPattern, user, pwd);
BasicCredentialsProvider credsProvider = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BasicCredentialsProvider();
AuthScope anyScope = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AuthScope(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, -1, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt; credentials = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UsernamePasswordCredentials(user, pwd.toCharArray());
credsProvider.setCredentials(anyScope, credentials);
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (CloseableHttpClient httpclient = HttpClients.custom()
&#160; &#160; .setDefaultCredentialsProvider(credsProvider)
&#160; &#160; .build()){
&#160; HttpGet httpget = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HttpGet(url);
&#160; httpclient.execute(httpget, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BasicHttpClientResponseHandler());
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;h4&gt;&lt;a name=&quot;Logoutput%3A&quot;&gt;&lt;/a&gt;Log output:&lt;/h4&gt;

&lt;p&gt;&lt;tt&gt;14:42:52.888 DEBUG org.apache.hc.client5.http.headers &#8212; http-outgoing-0 &amp;gt;&amp;gt; GET /digest-auth/auth/myUser/myPassword HTTP/1.1&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;...&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;14:42:59.793 DEBUG org.apache.hc.client5.http.headers &#8212; http-outgoing-0 &amp;lt;&amp;lt; HTTP/1.1 401 UNAUTHORIZED&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;...&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;14:42:59.793 DEBUG org.apache.hc.client5.http.headers &#8212; http-outgoing-0 &amp;lt;&amp;lt; WWW-Authenticate: Digest realm=&quot;me@kennethreitz.com&quot;, nonce=&quot;09e5c615468a6399e864f90c760fcb38&quot;, qop=&quot;auth&quot;, opaque=&quot;1ce2920b3602651c3ccbc3cc5b999db7&quot;, algorithm=MD5, stale=FALSE&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;...&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;14:42:59.812 DEBUG org.apache.hc.client5.http.headers &#8212; http-outgoing-0 &amp;gt;&amp;gt; GET /digest-auth/auth/myUser/myPassword HTTP/1.1&lt;/tt&gt;&lt;br/&gt;
&lt;b&gt;&lt;tt&gt;14:42:59.812 DEBUG org.apache.hc.client5.http.headers &#8212; http-outgoing-0 &amp;gt;&amp;gt; Authorization: Digest username=&quot;myUser&quot;, realm=&quot;me@kennethreitz.com&quot;, nonce=&quot;09e5c615468a6399e864f90c760fcb38&quot;, uri=&quot;/digest-auth/auth/myUser/myPassword&quot;, response=&quot;ac4314896b80485aaaeb385332d7d313&quot;, qop=auth, nc=00000001, cnonce=&quot;5c8c75560f7e62157d1c34b12158a770&quot;, &lt;font color=&quot;#de350b&quot;&gt;rspauth=&quot;0f0cb5f8cd0e5d5c0386588543a20c67&quot;&lt;/font&gt;, algorithm=MD5, opaque=&quot;1ce2920b3602651c3ccbc3cc5b999db7&quot;&lt;/tt&gt;&lt;/b&gt;&lt;br/&gt;
&lt;tt&gt;...&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13627560">HTTPCLIENT-2393</key>
            <summary>Authorization header contains rspauth</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="andyypsilon">Andreas Knops</reporter>
                        <labels>
                    </labels>
                <created>Thu, 28 Aug 2025 12:09:37 +0000</created>
                <updated>Sun, 14 Sep 2025 17:17:06 +0000</updated>
                            <resolved>Sun, 14 Sep 2025 16:38:24 +0000</resolved>
                                                    <fixVersion>5.6-alpha1</fixVersion>
                                    <component>HttpClient (classic)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3600">1h</timespent>
                                <comments>
                            <comment id="18016767" author="garydgregory" created="Thu, 28 Aug 2025 12:19:56 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andyypsilon&quot; class=&quot;user-hover&quot; rel=&quot;andyypsilon&quot;&gt;andyypsilon&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc7616&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://datatracker.ietf.org/doc/html/rfc7616&lt;/a&gt;, I read:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The optional response digest in the rspauth parameter supports&lt;br/&gt;
      mutual authentication&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;   For historical reasons, a sender MUST only generate the quoted string&lt;br/&gt;
   syntax for the following parameters: nextnonce, rspauth, and cnonce.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arturobernalg&quot; class=&quot;user-hover&quot; rel=&quot;arturobernalg&quot;&gt;arturobernalg&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="18016771" author="JIRAUSER310837" created="Thu, 28 Aug 2025 12:38:19 +0000"  >&lt;p&gt;Thanks for your response &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggregory&quot; class=&quot;user-hover&quot; rel=&quot;ggregory&quot;&gt;ggregory&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Our problem is, that the &lt;b&gt;rspauth&lt;/b&gt; parameter is supposed to be calculated by the &lt;b&gt;server&lt;/b&gt; and returned to the client in the &lt;b&gt;Authentication-Info&lt;/b&gt; header.&lt;/p&gt;

&lt;p&gt;Right now, we&#8217;re seeing the opposite: the client is generating &lt;tt&gt;rspauth&lt;/tt&gt; and sending it in the &lt;b&gt;Authorization&lt;/b&gt; header.&lt;/p&gt;

&lt;p&gt;The parameter is defined in section 3.5 &lt;em&gt;The Authentication-Info and Proxy-Authentication-Info Header&lt;/em&gt; and the spec states that &lt;em&gt;&#8220;the server proves that it knows the user&apos;s secret&#8221;.&lt;/em&gt;&lt;/p&gt;</comment>
                            <comment id="18016782" author="abernal" created="Thu, 28 Aug 2025 13:07:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andyypsilon&quot; class=&quot;user-hover&quot; rel=&quot;andyypsilon&quot;&gt;andyypsilon&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;Looks like a regression: &lt;tt&gt;rspauth&lt;/tt&gt; is server-side (&lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc7616#section-3.5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;RFC 7616&lt;/a&gt;), not part of client &lt;tt&gt;Authorization&lt;/tt&gt;. I&#8217;ll dig into it today and, if confirmed, submit a fix PR with a regression test.&lt;/p&gt;</comment>
                            <comment id="18016835" author="abernal" created="Thu, 28 Aug 2025 17:22:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andyypsilon&quot; class=&quot;user-hover&quot; rel=&quot;andyypsilon&quot;&gt;andyypsilon&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;I&#8217;ve pushed a fix that removes rspauth from the request; it&#8217;s now handled only from Authentication-Info. Please test with &#160;&lt;a href=&quot;https://github.com/apache/httpcomponents-client/pull/716&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/httpcomponents-client/pull/716&lt;/a&gt;&#160; and confirm it solves your case.&lt;/p&gt;</comment>
                            <comment id="18017412" author="JIRAUSER310837" created="Mon, 1 Sep 2025 11:18:00 +0000"  >&lt;p&gt;I have tested the fix.&lt;/p&gt;

&lt;p&gt;The &lt;tt&gt;rspauth&lt;/tt&gt; parameter is no longer generated. Authentication now works as expected in our use case.&lt;/p&gt;

&lt;p&gt;Thank you very much, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abernal&quot; class=&quot;user-hover&quot; rel=&quot;abernal&quot;&gt;abernal&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="18020176" author="jira-bot" created="Sun, 14 Sep 2025 16:37:15 +0000"  >&lt;p&gt;Commit 89da74220a11341b42ec455324b36094cc29f225 in httpcomponents-client&apos;s branch refs/heads/master from Arturo Bernal&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=89da74220&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=89da74220&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2393&quot; title=&quot;Authorization header contains rspauth&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2393&quot;&gt;&lt;del&gt;HTTPCLIENT-2393&lt;/del&gt;&lt;/a&gt; - remove rspauth from Authorization (#716)&lt;/p&gt;

&lt;p&gt;RFC 7616 compliance: rspauth is server-side (Authentication-Info &#167;3.5) only.&lt;/p&gt;</comment>
                            <comment id="18020179" author="jira-bot" created="Sun, 14 Sep 2025 17:17:03 +0000"  >&lt;p&gt;Commit 4466cca4a1021820586789e6bfeb885643451b58 in httpcomponents-client&apos;s branch refs/heads/5.5.x from Arturo Bernal&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=4466cca4a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=4466cca4a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2393&quot; title=&quot;Authorization header contains rspauth&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2393&quot;&gt;&lt;del&gt;HTTPCLIENT-2393&lt;/del&gt;&lt;/a&gt; - remove rspauth from Authorization (#716)&lt;/p&gt;

&lt;p&gt;RFC 7616 compliance: rspauth is server-side (Authentication-Info &#167;3.5) only.&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 89da74220a11341b42ec455324b36094cc29f225)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1xgm0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>