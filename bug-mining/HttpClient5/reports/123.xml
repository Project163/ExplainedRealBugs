<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:23:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCLIENT-2353] Incorrect IDN-hostname validation from TLS-certificates</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-2353</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                    <description>&lt;p&gt;Default HttpClient created by&#160;&lt;tt&gt;HttpClientBuilder.create().build()&lt;/tt&gt; cannot validate some IDN-hostname from TLS-certificates and throws exception:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; javax.net.ssl.SSLPeerUnverifiedException: Certificate &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &amp;lt;&#1087;&#1086;&#1080;&#1089;&#1082;-&#1089;&#1083;&#1086;&#1074;.&#1088;&#1092;&amp;gt; doesn&apos;t match any of the subject alternative names: [www.xn----dtbqigoecuc.xn--p1ai, xn----dtbqigoecuc.xn--p1ai]
	at org.apache.hc.client5.http.ssl.DefaultHostnameVerifier.matchDNSName(DefaultHostnameVerifier.java:171)
	at org.apache.hc.client5.http.ssl.DefaultHostnameVerifier.verify(DefaultHostnameVerifier.java:129)
	at org.apache.hc.client5.http.ssl.AbstractClientTlsStrategy.verifySession(AbstractClientTlsStrategy.java:316)
	at org.apache.hc.client5.http.ssl.AbstractClientTlsStrategy.verifySession(AbstractClientTlsStrategy.java:194)
	at org.apache.hc.client5.http.ssl.AbstractClientTlsStrategy.executeHandshake(AbstractClientTlsStrategy.java:253)
	at org.apache.hc.client5.http.ssl.AbstractClientTlsStrategy.upgrade(AbstractClientTlsStrategy.java:210)
	at org.apache.hc.client5.http.ssl.DefaultClientTlsStrategy.upgrade(DefaultClientTlsStrategy.java:48)
	at org.apache.hc.client5.http.impl.io.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:231)
	at org.apache.hc.client5.http.impl.io.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:490)
	at org.apache.hc.client5.http.impl.classic.InternalExecRuntime.connectEndpoint(InternalExecRuntime.java:164)
	at org.apache.hc.client5.http.impl.classic.InternalExecRuntime.connectEndpoint(InternalExecRuntime.java:174)
	at org.apache.hc.client5.http.impl.classic.ConnectExec.execute(ConnectExec.java:144)
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51)
	at org.apache.hc.client5.http.impl.classic.ProtocolExec.execute(ProtocolExec.java:192)
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51)
	at org.apache.hc.client5.http.impl.classic.ContentCompressionExec.execute(ContentCompressionExec.java:150)
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51)
	at org.apache.hc.client5.http.impl.classic.HttpRequestRetryExec.execute(HttpRequestRetryExec.java:113)
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51)
	at org.apache.hc.client5.http.impl.classic.RedirectExec.execute(RedirectExec.java:110)
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51)
	at org.apache.hc.client5.http.impl.classic.InternalHttpClient.doExecute(InternalHttpClient.java:174)
	at org.apache.hc.client5.http.impl.classic.CloseableHttpClient.execute(CloseableHttpClient.java:245)
	at org.apache.hc.client5.http.impl.classic.CloseableHttpClient.execute(CloseableHttpClient.java:188)
	at org.apache.hc.client5.http.impl.classic.CloseableHttpClient.execute(CloseableHttpClient.java:162)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I didn&apos;t test behaviour on other IDN-hostnames but this error occurs on hostname &lt;tt&gt;&#1087;&#1086;&#1080;&#1089;&#1082;-&#1089;&#1083;&#1086;&#1074;.&#1088;&#1092;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Cetrificate of this websize contains two alternative subject names:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;www.xn&amp;#45;&amp;#45;&amp;#45;&amp;#45;dtbqigoecuc.xn-p1ai&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;xn&amp;#45;&amp;#45;&amp;#45;&amp;#45;dtbqigoecuc.xn--p1ai&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;tt&gt;xn&amp;#45;&amp;#45;&amp;#45;&amp;#45;dtbqigoecuc.xn--p1ai&lt;/tt&gt; equals to encoded &lt;tt&gt;&#1087;&#1086;&#1080;&#1089;&#1082;-&#1089;&#1083;&#1086;&#1074;.&#1088;&#1092;&lt;/tt&gt;, but &lt;tt&gt;org.apache.hc.client5.http.ssl.DefaultHostnameVerifier.matchIdentity&lt;/tt&gt; compares host and identity via &lt;tt&gt;equalsIgnoreCase&lt;/tt&gt; and returns false&lt;/p&gt;

&lt;p&gt;Link to code in github: &lt;a href=&quot;https://github.com/apache/httpcomponents-client/blob/rel/v5.4.1/httpclient5/src/main/java/org/apache/hc/client5/http/ssl/DefaultHostnameVerifier.java#L260&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/httpcomponents-client/blob/rel/v5.4.1/httpclient5/src/main/java/org/apache/hc/client5/http/ssl/DefaultHostnameVerifier.java#L260&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13603786">HTTPCLIENT-2353</key>
            <summary>Incorrect IDN-hostname validation from TLS-certificates</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kadukm">Kaduk Mikhail</reporter>
                        <labels>
                    </labels>
                <created>Sat, 4 Jan 2025 11:08:52 +0000</created>
                <updated>Wed, 5 Feb 2025 10:29:08 +0000</updated>
                            <resolved>Mon, 6 Jan 2025 09:16:40 +0000</resolved>
                                    <version>5.4.1</version>
                                    <fixVersion>5.4.2</fixVersion>
                    <fixVersion>5.5-alpha1</fixVersion>
                                    <component>HttpClient (classic)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="9000">2.5h</timespent>
                                <comments>
                            <comment id="17909851" author="olegk" created="Sun, 5 Jan 2025 08:48:22 +0000"  >&lt;p&gt;I think we have a greater problem with IDN coding. If I try to execute a request against &lt;tt&gt;xn---&lt;del&gt;dtbqigoecuc.xn&lt;/del&gt;-p1ai&lt;/tt&gt;  I get&lt;br/&gt;
&#160;&lt;br/&gt;
```&lt;br/&gt;
Exception in thread &quot;main&quot; java.net.UnknownHostException: &#1087;&#1086;&#1080;&#1089;&#1082;-&#1089;&#1083;&#1086;&#1074;.&#1088;&#1092;: Name or service not known&lt;br/&gt;
```&lt;/p&gt;

&lt;p&gt;We normalize hostnames to Unicode internally and then feed the normalized host name to `InetAddress#getAllByName` that chokes on it. It looks like `InetAddress#getAllByName expects IDN encoded hostnames as input.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17910065" author="jira-bot" created="Mon, 6 Jan 2025 09:15:36 +0000"  >&lt;p&gt;Commit 9e3559ef931576256f73d8f36ee8cf9a8dd71ca3 in httpcomponents-client&apos;s branch refs/heads/master from Arturo Bernal&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=9e3559ef9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=9e3559ef9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2353&quot; title=&quot;Incorrect IDN-hostname validation from TLS-certificates&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2353&quot;&gt;&lt;del&gt;HTTPCLIENT-2353&lt;/del&gt;&lt;/a&gt;: Fix IDN hostname mismatch by normalizing identity  with IDN.toUnicode before comparison so that Unicode and punycode forms match correctly. (#607)&lt;/p&gt;
</comment>
                            <comment id="17910072" author="jira-bot" created="Mon, 6 Jan 2025 09:36:44 +0000"  >&lt;p&gt;Commit 3fa07f12cb818b8a6512989c407449929d53898a in httpcomponents-client&apos;s branch refs/heads/5.4.x from Arturo Bernal&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=3fa07f12c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=3fa07f12c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2353&quot; title=&quot;Incorrect IDN-hostname validation from TLS-certificates&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2353&quot;&gt;&lt;del&gt;HTTPCLIENT-2353&lt;/del&gt;&lt;/a&gt;: Fix IDN hostname mismatch by normalizing identity  with IDN.toUnicode before comparison so that Unicode and punycode forms match correctly. (#607)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 9e3559ef931576256f73d8f36ee8cf9a8dd71ca3)&lt;/p&gt;</comment>
                            <comment id="17911669" author="jira-bot" created="Thu, 9 Jan 2025 21:08:35 +0000"  >&lt;p&gt;Commit 9e3559ef931576256f73d8f36ee8cf9a8dd71ca3 in httpcomponents-client&apos;s branch refs/heads/dependabot/maven/log4j.version-2.24.3 from Arturo Bernal&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=9e3559ef9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=9e3559ef9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2353&quot; title=&quot;Incorrect IDN-hostname validation from TLS-certificates&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2353&quot;&gt;&lt;del&gt;HTTPCLIENT-2353&lt;/del&gt;&lt;/a&gt;: Fix IDN hostname mismatch by normalizing identity  with IDN.toUnicode before comparison so that Unicode and punycode forms match correctly. (#607)&lt;/p&gt;
</comment>
                            <comment id="17923991" author="jira-bot" created="Wed, 5 Feb 2025 10:19:25 +0000"  >&lt;p&gt;Commit 9e3559ef931576256f73d8f36ee8cf9a8dd71ca3 in httpcomponents-client&apos;s branch refs/heads/dependabot/maven/org.junit-junit-bom-5.11.4 from Arturo Bernal&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=9e3559ef9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=9e3559ef9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2353&quot; title=&quot;Incorrect IDN-hostname validation from TLS-certificates&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2353&quot;&gt;&lt;del&gt;HTTPCLIENT-2353&lt;/del&gt;&lt;/a&gt;: Fix IDN hostname mismatch by normalizing identity  with IDN.toUnicode before comparison so that Unicode and punycode forms match correctly. (#607)&lt;/p&gt;
</comment>
                            <comment id="17924001" author="jira-bot" created="Wed, 5 Feb 2025 10:24:11 +0000"  >&lt;p&gt;Commit 9e3559ef931576256f73d8f36ee8cf9a8dd71ca3 in httpcomponents-client&apos;s branch refs/heads/dependabot/maven/testcontainers.version-1.20.4 from Arturo Bernal&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=9e3559ef9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=9e3559ef9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2353&quot; title=&quot;Incorrect IDN-hostname validation from TLS-certificates&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2353&quot;&gt;&lt;del&gt;HTTPCLIENT-2353&lt;/del&gt;&lt;/a&gt;: Fix IDN hostname mismatch by normalizing identity  with IDN.toUnicode before comparison so that Unicode and punycode forms match correctly. (#607)&lt;/p&gt;
</comment>
                            <comment id="17924007" author="jira-bot" created="Wed, 5 Feb 2025 10:29:08 +0000"  >&lt;p&gt;Commit 9e3559ef931576256f73d8f36ee8cf9a8dd71ca3 in httpcomponents-client&apos;s branch refs/heads/dependabot/maven/com.googlecode.maven-download-plugin-download-maven-plugin-1.13.0 from Arturo Bernal&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=9e3559ef9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-client.git;h=9e3559ef9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2353&quot; title=&quot;Incorrect IDN-hostname validation from TLS-certificates&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCLIENT-2353&quot;&gt;&lt;del&gt;HTTPCLIENT-2353&lt;/del&gt;&lt;/a&gt;: Fix IDN hostname mismatch by normalizing identity  with IDN.toUnicode before comparison so that Unicode and punycode forms match correctly. (#607)&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            39 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1tesg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>