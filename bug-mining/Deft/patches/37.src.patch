diff --git a/src/main/java/org/deftserver/web/protocol/HttpRequest.java b/src/main/java/org/deftserver/web/protocol/HttpRequest.java
index a1291fe..ec91060 100644
--- a/src/main/java/org/deftserver/web/protocol/HttpRequest.java
+++ b/src/main/java/org/deftserver/web/protocol/HttpRequest.java
@@ -44,24 +44,28 @@ public class HttpRequest {
 	}
 	
 	public static HttpRequest of(ByteBuffer buffer) {
-		String raw = new String(buffer.array(), CHAR_SET);
-		String[] headersAndBody = raw.split("\\r\\n\\r\\n"); //TODO fix a better regexp for this
-		String[] headerFields = headersAndBody[0].split("\\r\\n");
-		headerFields = ArrayUtil.dropFromEndWhile(headerFields, "");
-		
-		String requestLine = headerFields[0];
-		Map<String, String> generalHeaders = new HashMap<String, String>();
-		for (int i = 1; i < headerFields.length; i++) {
-			String[] header = headerFields[i].split(": ");
-			generalHeaders.put(header[0], header[1]);
-		}
-		
-		String body = "";
-		for (int i=1; i<headersAndBody.length; ++i) { //First entry contains headers
-			body += headersAndBody[i];
+		try {
+			String raw = new String(buffer.array(), CHAR_SET);
+			String[] headersAndBody = raw.split("\\r\\n\\r\\n"); //TODO fix a better regexp for this
+			String[] headerFields = headersAndBody[0].split("\\r\\n");
+			headerFields = ArrayUtil.dropFromEndWhile(headerFields, "");
+
+			String requestLine = headerFields[0];
+			Map<String, String> generalHeaders = new HashMap<String, String>();
+			for (int i = 1; i < headerFields.length; i++) {
+				String[] header = headerFields[i].split(": ");
+				generalHeaders.put(header[0], header[1]);
+			}
+
+			String body = "";
+			for (int i=1; i<headersAndBody.length; ++i) { //First entry contains headers
+				body += headersAndBody[i];
+			}
+
+			return new HttpRequest(requestLine, generalHeaders, body);
+		} catch (Exception t) {
+			return MalFormedHttpRequest.instance;
 		}
-		
-		return new HttpRequest(requestLine, generalHeaders, body);
 	}
 
 	public String getRequestLine() {
diff --git a/src/main/java/org/deftserver/web/protocol/MalFormedHttpRequest.java b/src/main/java/org/deftserver/web/protocol/MalFormedHttpRequest.java
new file mode 100644
index 0000000..3cbd441
--- /dev/null
+++ b/src/main/java/org/deftserver/web/protocol/MalFormedHttpRequest.java
@@ -0,0 +1,15 @@
+package org.deftserver.web.protocol;
+
+import com.google.common.collect.Maps;
+
+
+public class MalFormedHttpRequest extends HttpRequest {
+
+	public static final MalFormedHttpRequest instance = new MalFormedHttpRequest();
+	
+	/* Dummy HttpRequest that represents a malformed client HTTP request */
+	private MalFormedHttpRequest() {
+		super("GET / Mal formed request\r\n", Maps.<String, String>newHashMap());
+	}
+
+}
diff --git a/src/test/java/org/deftserver/web/DeftSystemTest.java b/src/test/java/org/deftserver/web/DeftSystemTest.java
index 8ae9269..ef66d39 100644
--- a/src/test/java/org/deftserver/web/DeftSystemTest.java
+++ b/src/test/java/org/deftserver/web/DeftSystemTest.java
@@ -8,6 +8,9 @@ import java.io.BufferedReader;
 import java.io.IOException;
 import java.io.InputStream;
 import java.io.InputStreamReader;
+import java.net.InetSocketAddress;
+import java.nio.ByteBuffer;
+import java.nio.channels.SocketChannel;
 import java.util.Arrays;
 import java.util.HashMap;
 import java.util.LinkedList;
@@ -43,7 +46,7 @@ import org.junit.Test;
 public class DeftSystemTest {
 
 	private static final int PORT = 8081;
-	
+
 	public static final String expectedPayload = "hello test";
 
 	private static class ExampleRequestHandler extends RequestHandler {
@@ -52,14 +55,14 @@ public class DeftSystemTest {
 			response.write(expectedPayload);
 		}
 	}
-	
+
 	private static class WRequestHandler extends RequestHandler {
 		@Override
 		public void get(org.deftserver.web.protocol.HttpRequest request, org.deftserver.web.protocol.HttpResponse response) {
 			response.write("1");
 		}
 	}
-	
+
 	private static class WWRequestHandler extends RequestHandler {
 		@Override
 		public void get(org.deftserver.web.protocol.HttpRequest request, org.deftserver.web.protocol.HttpResponse response) {
@@ -67,7 +70,7 @@ public class DeftSystemTest {
 			response.write("2");
 		}
 	}
-	
+
 	private static class WWFWRequestHandler extends RequestHandler {
 		@Override
 		public void get(org.deftserver.web.protocol.HttpRequest request, org.deftserver.web.protocol.HttpResponse response) {
@@ -77,7 +80,7 @@ public class DeftSystemTest {
 			response.write("3");
 		}
 	}
-	
+
 	private static class WFWFRequestHandler extends RequestHandler {
 		@Override
 		public void get(org.deftserver.web.protocol.HttpRequest request, org.deftserver.web.protocol.HttpResponse response) {
@@ -87,7 +90,7 @@ public class DeftSystemTest {
 			response.flush();
 		}
 	}
-	
+
 	private static class DeleteRequestHandler extends RequestHandler {
 		@Override
 		public void delete(org.deftserver.web.protocol.HttpRequest request, org.deftserver.web.protocol.HttpResponse response) {
@@ -97,7 +100,7 @@ public class DeftSystemTest {
 			response.flush();
 		}
 	}
-	
+
 	private static class PostRequestHandler extends RequestHandler {
 		@Override
 		public void post(org.deftserver.web.protocol.HttpRequest request, org.deftserver.web.protocol.HttpResponse response) {
@@ -107,7 +110,7 @@ public class DeftSystemTest {
 			response.flush();
 		}
 	}
-	
+
 	private static class PutRequestHandler extends RequestHandler {
 		@Override
 		public void put(org.deftserver.web.protocol.HttpRequest request, org.deftserver.web.protocol.HttpResponse response) {
@@ -117,21 +120,21 @@ public class DeftSystemTest {
 			response.flush();
 		}
 	}
-	
+
 	private static class CapturingRequestRequestHandler extends RequestHandler {
 		@Override
 		public void get(org.deftserver.web.protocol.HttpRequest request, org.deftserver.web.protocol.HttpResponse response) {
 			response.write(request.getRequestedPath());
 		}
 	}
-	
+
 	private static class ThrowingHttpExceptionRequestHandler extends RequestHandler {
 		@Override
 		public void get(org.deftserver.web.protocol.HttpRequest request, org.deftserver.web.protocol.HttpResponse response) {
 			throw new HttpException(500, "exception message");
 		}
 	}
-	
+
 	private static class AsyncThrowingHttpExceptionRequestHandler extends RequestHandler {
 		@Asynchronous
 		@Override
@@ -139,14 +142,14 @@ public class DeftSystemTest {
 			throw new HttpException(500, "exception message");
 		}
 	}
-	
+
 	public static class NoBodyRequestHandler extends RequestHandler {
 		@Override
 		public void get(HttpRequest request, org.deftserver.web.protocol.HttpResponse response) {
 			response.setStatusCode(200);
 		}
 	}
-	
+
 	public static class MovedPermanentlyRequestHandler extends RequestHandler {
 		@Override
 		public void get(HttpRequest request, org.deftserver.web.protocol.HttpResponse response) {
@@ -154,7 +157,7 @@ public class DeftSystemTest {
 			response.setHeader("Location", "/");
 		}
 	}
-	
+
 	@BeforeClass
 	public static void setup() {
 		Map<String, RequestHandler> reqHandlers = new HashMap<String, RequestHandler>();
@@ -172,10 +175,10 @@ public class DeftSystemTest {
 		reqHandlers.put("/async_throw", new AsyncThrowingHttpExceptionRequestHandler());
 		reqHandlers.put("/no_body", new NoBodyRequestHandler());
 		reqHandlers.put("/moved_perm", new MovedPermanentlyRequestHandler());
-		
+
 		final Application application = new Application(reqHandlers);
 		application.setStaticContentDir("src/test/resources");
-		
+
 		// start deft instance from a new thread because the start invocation is blocking 
 		// (invoking thread will be I/O loop thread)
 		new Thread(new Runnable() {
@@ -208,11 +211,11 @@ public class DeftSystemTest {
 		for (String header : expectedHeaders) {
 			assertTrue(response.getFirstHeader(header) != null);
 		}
-		
+
 		assertEquals(expectedPayload, convertStreamToString(response.getEntity().getContent()).trim());
 		assertEquals(expectedPayload.length()+"", response.getFirstHeader("Content-Length").getValue());
 	}
-	
+
 	/**
 	 * Test a RH that does a single write
 	 * @throws ClientProtocolException
@@ -224,11 +227,11 @@ public class DeftSystemTest {
 		headers.add(new BasicHeader("Connection", "Close"));
 		HttpParams params = new BasicHttpParams();
 		params.setParameter("http.default-headers", headers);
-		
+
 		HttpClient httpclient = new DefaultHttpClient(params);
 		HttpGet httpget = new HttpGet("http://localhost:" + PORT + "/w");
 		HttpResponse response = httpclient.execute(httpget);
-		
+
 		assertNotNull(response);
 		assertEquals(200, response.getStatusLine().getStatusCode());
 		assertEquals(new ProtocolVersion("HTTP", 1, 1), response.getStatusLine().getProtocolVersion());
@@ -239,18 +242,18 @@ public class DeftSystemTest {
 		assertEquals("1", response.getFirstHeader("Content-Length").getValue());
 	}
 
-	
+
 	@Test
 	public void wwTest() throws ClientProtocolException, IOException {
 		List<Header> headers = new LinkedList<Header>();
 		headers.add(new BasicHeader("Connection", "Close"));
 		HttpParams params = new BasicHttpParams();
 		params.setParameter("http.default-headers", headers);
-		
+
 		HttpClient httpclient = new DefaultHttpClient(params);
 		HttpGet httpget = new HttpGet("http://localhost:" + PORT + "/ww");
 		HttpResponse response = httpclient.execute(httpget);
-		
+
 		assertNotNull(response);
 		assertEquals(200, response.getStatusLine().getStatusCode());
 		assertEquals(new ProtocolVersion("HTTP", 1, 1), response.getStatusLine().getProtocolVersion());
@@ -267,11 +270,11 @@ public class DeftSystemTest {
 		headers.add(new BasicHeader("Connection", "Close"));
 		HttpParams params = new BasicHttpParams();
 		params.setParameter("http.default-headers", headers);
-		
+
 		HttpClient httpclient = new DefaultHttpClient(params);
 		HttpGet httpget = new HttpGet("http://localhost:" + PORT + "/wwfw");
 		HttpResponse response = httpclient.execute(httpget);
-		
+
 		assertNotNull(response);
 		assertEquals(200, response.getStatusLine().getStatusCode());
 		assertEquals(new ProtocolVersion("HTTP", 1, 1), response.getStatusLine().getProtocolVersion());
@@ -280,18 +283,18 @@ public class DeftSystemTest {
 		assertEquals("123", payLoad);
 		assertEquals(3, response.getAllHeaders().length);
 	}
-	
+
 	@Test
 	public void wfwfTest() throws ClientProtocolException, IOException {
 		List<Header> headers = new LinkedList<Header>();
 		headers.add(new BasicHeader("Connection", "Close"));
 		HttpParams params = new BasicHttpParams();
 		params.setParameter("http.default-headers", headers);
-		
+
 		HttpClient httpclient = new DefaultHttpClient(params);
 		HttpGet httpget = new HttpGet("http://localhost:" + PORT + "/wfwf");
 		HttpResponse response = httpclient.execute(httpget);
-		
+
 		assertNotNull(response);
 		assertEquals(200, response.getStatusLine().getStatusCode());
 		assertEquals(new ProtocolVersion("HTTP", 1, 1), response.getStatusLine().getProtocolVersion());
@@ -307,11 +310,11 @@ public class DeftSystemTest {
 		headers.add(new BasicHeader("Connection", "Close"));
 		HttpParams params = new BasicHttpParams();
 		params.setParameter("http.default-headers", headers);
-		
+
 		HttpClient httpclient = new DefaultHttpClient(params);
 		HttpDelete httpdelete = new HttpDelete("http://localhost:" + PORT + "/delete");
 		HttpResponse response = httpclient.execute(httpdelete);
-		
+
 		assertNotNull(response);
 		assertEquals(200, response.getStatusLine().getStatusCode());
 		assertEquals(new ProtocolVersion("HTTP", 1, 1), response.getStatusLine().getProtocolVersion());
@@ -319,18 +322,18 @@ public class DeftSystemTest {
 		String payLoad = convertStreamToString(response.getEntity().getContent()).trim();
 		assertEquals("delete", payLoad);
 	}
-	
+
 	@Test
 	public void PostTest() throws ClientProtocolException, IOException {
 		List<Header> headers = new LinkedList<Header>();
 		headers.add(new BasicHeader("Connection", "Close"));
 		HttpParams params = new BasicHttpParams();
 		params.setParameter("http.default-headers", headers);
-		
+
 		HttpClient httpclient = new DefaultHttpClient(params);
 		HttpPost httppost = new HttpPost("http://localhost:" + PORT + "/post");
 		HttpResponse response = httpclient.execute(httppost);
-		
+
 		assertNotNull(response);
 		assertEquals(200, response.getStatusLine().getStatusCode());
 		assertEquals(new ProtocolVersion("HTTP", 1, 1), response.getStatusLine().getProtocolVersion());
@@ -338,18 +341,18 @@ public class DeftSystemTest {
 		String payLoad = convertStreamToString(response.getEntity().getContent()).trim();
 		assertEquals("post", payLoad);
 	}
-	
+
 	@Test
 	public void putTest() throws ClientProtocolException, IOException {
 		List<Header> headers = new LinkedList<Header>();
 		headers.add(new BasicHeader("Connection", "Close"));
 		HttpParams params = new BasicHttpParams();
 		params.setParameter("http.default-headers", headers);
-		
+
 		HttpClient httpclient = new DefaultHttpClient(params);
 		HttpPut httpput = new HttpPut("http://localhost:" + PORT + "/put");
 		HttpResponse response = httpclient.execute(httpput);
-		
+
 		assertNotNull(response);
 		assertEquals(200, response.getStatusLine().getStatusCode());
 		assertEquals(new ProtocolVersion("HTTP", 1, 1), response.getStatusLine().getProtocolVersion());
@@ -357,18 +360,18 @@ public class DeftSystemTest {
 		String payLoad = convertStreamToString(response.getEntity().getContent()).trim();
 		assertEquals("put", payLoad);
 	}
-	
+
 	@Test
 	public void capturingTest() throws ClientProtocolException, IOException {
 		List<Header> headers = new LinkedList<Header>();
 		headers.add(new BasicHeader("Connection", "Close"));
 		HttpParams params = new BasicHttpParams();
 		params.setParameter("http.default-headers", headers);
-		
+
 		HttpClient httpclient = new DefaultHttpClient(params);
 		HttpGet httpget = new HttpGet("http://localhost:" + PORT + "/capturing/1911");
 		HttpResponse response = httpclient.execute(httpget);
-		
+
 		assertNotNull(response);
 		assertEquals(200, response.getStatusLine().getStatusCode());
 		assertEquals(new ProtocolVersion("HTTP", 1, 1), response.getStatusLine().getProtocolVersion());
@@ -376,18 +379,18 @@ public class DeftSystemTest {
 		String payLoad = convertStreamToString(response.getEntity().getContent()).trim();
 		assertEquals("/capturing/1911", payLoad);
 	}
-	
+
 	@Test
 	public void erroneousCapturingTest() throws ClientProtocolException, IOException {
 		List<Header> headers = new LinkedList<Header>();
 		headers.add(new BasicHeader("Connection", "Close"));
 		HttpParams params = new BasicHttpParams();
 		params.setParameter("http.default-headers", headers);
-		
+
 		HttpClient httpclient = new DefaultHttpClient(params);
 		HttpGet httpget = new HttpGet("http://localhost:" + PORT + "/capturing/r1911");
 		HttpResponse response = httpclient.execute(httpget);
-		
+
 		assertNotNull(response);
 		assertEquals(404, response.getStatusLine().getStatusCode());
 		assertEquals(new ProtocolVersion("HTTP", 1, 1), response.getStatusLine().getProtocolVersion());
@@ -395,7 +398,7 @@ public class DeftSystemTest {
 		String payLoad = convertStreamToString(response.getEntity().getContent()).trim();
 		assertEquals("Requested URL: /capturing/r1911 was not found", payLoad);
 	}
-	
+
 	@Test
 	public void simpleConcurrentGetRequestTest() {
 		int nThreads = 8;
@@ -427,27 +430,27 @@ public class DeftSystemTest {
 			assertTrue("Did not finish " + nRequests + " # of requests", false);
 		}
 	}
-	
+
 	@Test
 	public void asynchronousRequestTest() throws ClientProtocolException, IllegalStateException, IOException {
 		for (int i = 1; i <= 40; i++) {
 			doAsynchronousRequestTest();
 		}
 	}
-	
+
 	private void doAsynchronousRequestTest() throws ClientProtocolException, IOException, IllegalStateException {
 		List<Header> headers = new LinkedList<Header>();
 		headers.add(new BasicHeader("Connection", "Close"));
 		HttpParams params = new BasicHttpParams();
 		params.setParameter("http.default-headers", headers);
-		
+
 		DefaultHttpClient httpclient = new DefaultHttpClient(params);
 		HttpConnectionParams.setConnectionTimeout(params, 40 * 1000);
 		HttpConnectionParams.setSoTimeout(params, 100 * 1000);
 
 		HttpGet httpget = new HttpGet("http://localhost:" + PORT + "/mySql");
 		HttpResponse response = httpclient.execute(httpget);
-		
+
 		assertNotNull(response);
 		assertEquals(200, response.getStatusLine().getStatusCode());
 		assertEquals(new ProtocolVersion("HTTP", 1, 1), response.getStatusLine().getProtocolVersion());
@@ -455,14 +458,14 @@ public class DeftSystemTest {
 		String payLoad = convertStreamToString(response.getEntity().getContent()).trim();
 		assertEquals("Name: Jim123", payLoad);
 	}
-	
+
 	@Test
 	public void keepAliveRequestTest() throws ClientProtocolException, IOException {
 		List<Header> headers = new LinkedList<Header>();
 		headers.add(new BasicHeader("Connection", "Keep-Alive"));
 		HttpParams params = new BasicHttpParams();
 		params.setParameter("http.default-headers", headers);
-		
+
 		DefaultHttpClient httpclient = new DefaultHttpClient(params);
 
 		for (int i = 1; i <= 25; i++) {
@@ -471,10 +474,10 @@ public class DeftSystemTest {
 	}
 
 	private void doKeepAliveRequestTest(DefaultHttpClient httpclient)
-			throws IOException, ClientProtocolException {
+	throws IOException, ClientProtocolException {
 		HttpGet httpget = new HttpGet("http://localhost:" + PORT + "/");
 		HttpResponse response = httpclient.execute(httpget);
-		
+
 		assertNotNull(response);
 		assertEquals(200, response.getStatusLine().getStatusCode());
 		assertEquals(new ProtocolVersion("HTTP", 1, 1), response.getStatusLine().getProtocolVersion());
@@ -483,7 +486,7 @@ public class DeftSystemTest {
 		String payLoad = convertStreamToString(response.getEntity().getContent()).trim();
 		assertEquals(expectedPayload, payLoad);
 	}
-	
+
 	@Test
 	public void HTTP_1_0_noConnectionHeaderTest() throws ClientProtocolException, IOException {
 		HttpParams params = new BasicHttpParams();
@@ -491,7 +494,7 @@ public class DeftSystemTest {
 		DefaultHttpClient httpclient = new DefaultHttpClient();
 		HttpGet httpget = new HttpGet("http://localhost:" + PORT + "/");
 		HttpResponse response = httpclient.execute(httpget);
-		
+
 		assertNotNull(response);
 		assertEquals(200, response.getStatusLine().getStatusCode());
 		assertEquals(new ProtocolVersion("HTTP", 1, 1), response.getStatusLine().getProtocolVersion());
@@ -500,14 +503,14 @@ public class DeftSystemTest {
 		String payLoad = convertStreamToString(response.getEntity().getContent()).trim();
 		assertEquals(expectedPayload, payLoad);
 	}
-	
+
 
 	@Test
 	public void httpExceptionTest() throws ClientProtocolException, IOException {
 		DefaultHttpClient httpclient = new DefaultHttpClient();
 		HttpGet httpget = new HttpGet("http://localhost:" + PORT + "/throw");
 		HttpResponse response = httpclient.execute(httpget);
-		
+
 		assertNotNull(response);
 		assertEquals(500, response.getStatusLine().getStatusCode());
 		assertEquals(new ProtocolVersion("HTTP", 1, 1), response.getStatusLine().getProtocolVersion());
@@ -522,7 +525,7 @@ public class DeftSystemTest {
 		DefaultHttpClient httpclient = new DefaultHttpClient();
 		HttpGet httpget = new HttpGet("http://localhost:" + PORT + "/async_throw");
 		HttpResponse response = httpclient.execute(httpget);
-		
+
 		assertNotNull(response);
 		assertEquals(500, response.getStatusLine().getStatusCode());
 		assertEquals(new ProtocolVersion("HTTP", 1, 1), response.getStatusLine().getProtocolVersion());
@@ -531,13 +534,13 @@ public class DeftSystemTest {
 		String payLoad = convertStreamToString(response.getEntity().getContent()).trim();
 		assertEquals("exception message", payLoad);
 	}
-	
+
 	@Test
 	public void staticFileRequestTest() throws ClientProtocolException, IOException {
 		DefaultHttpClient httpclient = new DefaultHttpClient();
 		HttpGet httpget = new HttpGet("http://localhost:" + PORT + "/src/test/resources/test.txt");
 		HttpResponse response = httpclient.execute(httpget);
-		
+
 		assertNotNull(response);
 		assertEquals(200, response.getStatusLine().getStatusCode());
 		assertEquals(new ProtocolVersion("HTTP", 1, 1), response.getStatusLine().getProtocolVersion());
@@ -546,13 +549,13 @@ public class DeftSystemTest {
 		String payLoad = convertStreamToString(response.getEntity().getContent()).trim();
 		assertEquals("test.txt", payLoad);
 	}
-	
+
 	@Test
 	public void pictureStaticFileRequestTest() throws ClientProtocolException, IOException {
 		DefaultHttpClient httpclient = new DefaultHttpClient();
 		HttpGet httpget = new HttpGet("http://localhost:" + PORT + "/src/test/resources/n792205362_2067.jpg");
 		HttpResponse response = httpclient.execute(httpget);
-		
+
 		assertNotNull(response);
 		assertEquals(200, response.getStatusLine().getStatusCode());
 		assertEquals(new ProtocolVersion("HTTP", 1, 1), response.getStatusLine().getProtocolVersion());
@@ -562,7 +565,7 @@ public class DeftSystemTest {
 		assertEquals("image/jpeg", response.getFirstHeader("Content-Type").getValue());
 		assertNotNull(response.getFirstHeader("Last-Modified"));
 	}
-	
+
 	@Test
 	public void noBodyRequest() throws ClientProtocolException, IOException {
 		HttpClient httpclient = new DefaultHttpClient();
@@ -579,11 +582,11 @@ public class DeftSystemTest {
 		for (String header : expectedHeaders) {
 			assertTrue(response.getFirstHeader(header) != null);
 		}
-		
+
 		assertEquals("", convertStreamToString(response.getEntity().getContent()).trim());
 		assertEquals("0", response.getFirstHeader("Content-Length").getValue());
 	}
-	
+
 	@Test
 	public void movedPermanentlyRequest() throws ClientProtocolException, IOException {
 		HttpClient httpclient = new DefaultHttpClient();
@@ -600,11 +603,23 @@ public class DeftSystemTest {
 		for (String header : expectedHeaders) {
 			assertTrue(response.getFirstHeader(header) != null);
 		}
-		
+
 		assertEquals(expectedPayload, convertStreamToString(response.getEntity().getContent()).trim());
 		assertEquals(expectedPayload.length()+"", response.getFirstHeader("Content-Length").getValue());
 	}
-	
+
+	@Test
+	public void sendGarbageTest() throws IOException {
+		InetSocketAddress socketAddress = new InetSocketAddress(PORT);
+		SocketChannel channel = SocketChannel.open(socketAddress);
+		channel.write(
+				ByteBuffer.wrap(
+						new byte[] {1, 1, 1, 1}	// garbage
+				)
+		);
+		channel.close();
+	}
+
 	public String convertStreamToString(InputStream is) throws IOException {
 		if (is != null) {
 			StringBuilder sb = new StringBuilder();
diff --git a/src/test/java/org/deftserver/web/HttpRequestTest.java b/src/test/java/org/deftserver/web/HttpRequestTest.java
index 4f28f30..e5fcf3e 100644
--- a/src/test/java/org/deftserver/web/HttpRequestTest.java
+++ b/src/test/java/org/deftserver/web/HttpRequestTest.java
@@ -21,7 +21,7 @@ import org.junit.Test;
 
 public class HttpRequestTest {
 
-	
+
 	@Test 
 	public void testDeserializeHttpGetRequest() {
 		HttpRequestHelper helper = new HttpRequestHelper();
@@ -29,7 +29,7 @@ public class HttpRequestTest {
 		helper.addHeader("User-Agent", "curl/7.19.5 (i386-apple-darwin10.0.0) libcurl/7.19.5 zlib/1.2.3");
 		helper.addHeader("Accept", "*/*");
 		ByteBuffer bb1 = helper.getRequestAsByteBuffer(); 
-		
+
 		helper = new HttpRequestHelper();
 		helper.addHeader("Host", "127.0.0.1:8080");
 		helper.addHeader("User-Agent", "Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; sv-SE; rv:1.9.2.2) Gecko/20100316 Firefox/3.6.2");
@@ -40,30 +40,30 @@ public class HttpRequestTest {
 		helper.addHeader("Keep-Alive", "115");
 		helper.addHeader("Connection", "keep-alve");
 		ByteBuffer bb2 = helper.getRequestAsByteBuffer();
-		
+
 		HttpRequest request1 = HttpRequest.of(bb1);
 		HttpRequest request2 = HttpRequest.of(bb2);
-		
+
 		assertEquals("GET / HTTP/1.1", request1.getRequestLine());
 		assertEquals("GET / HTTP/1.1", request2.getRequestLine());
-		
+
 		assertEquals(4, request1.getHeaders().size());
 		assertEquals(9, request2.getHeaders().size());
-		
+
 		List<String> expectedHeaderNamesInRequest1 = Arrays.asList(new String[]{"User-Agent", "Host", "Accept", "From"});
 		for (String expectedHeaderName : expectedHeaderNamesInRequest1) {
 			assertTrue(request1.getHeaders().containsKey(expectedHeaderName));
 		}
-		
+
 		List<String> expectedHeaderNamesInRequest2 = Arrays.asList(new String[]{"Host", "User-Agent", "Accept", "From",
 				"Accept-Language", "Accept-Encoding", "Accept-Charset", "Keep-Alive", "Connection"});
 		for (String expectedHeaderName : expectedHeaderNamesInRequest2) {
 			assertTrue(request2.getHeaders().containsKey(expectedHeaderName));
 		}
-		
+
 		// TODO RS 100920 verify that the headers exist
 	}
-	
+
 	public void testRemoveTrailingEmptyStrings() {
 		String fields1[] = new String[]{"a", "b", "c", "", ""};
 		String fields2[] = new String[]{"a", "b", "c"};
@@ -71,34 +71,34 @@ public class HttpRequestTest {
 		assertEquals(3, ArrayUtil.dropFromEndWhile(fields1, "").length);
 		assertEquals(3, ArrayUtil.dropFromEndWhile(fields2, "").length);
 	}
-	
+
 	@Test
 	public void testSingleGetParameter() {
 		HttpRequestHelper helper = new HttpRequestHelper();
 		helper.addGetParameter("firstname", "jim");
-		
+
 		HttpRequest request = HttpRequest.of(helper.getRequestAsByteBuffer());
-		
+
 		assertEquals(1, request.getParameters().size());
 		assertEquals("jim", request.getParameter("firstname"));
 	}
-	
+
 	@Test
 	public void testMultipleGetParameter() {
 		HttpRequestHelper helper = new HttpRequestHelper();
 		helper.addGetParameter("firstname", "jim");
 		helper.addGetParameter("lastname", "petersson");
 		helper.addGetParameter("city", "stockholm");
-		
+
 		HttpRequest request = HttpRequest.of(helper.getRequestAsByteBuffer());
 		Map<String, Collection<String>> params = request.getParameters();
-		
+
 		assertEquals(3, getSize(params));
 		assertEquals("jim", request.getParameter("firstname"));
 		assertEquals("petersson", request.getParameter("lastname"));
 		assertEquals("stockholm", request.getParameter("city"));
 	}
-	
+
 	private int getSize(Map<String, Collection<String>> mmap) {
 		int size = 0;
 		for (Collection<String> values : mmap.values()) {
@@ -106,33 +106,33 @@ public class HttpRequestTest {
 		}
 		return size;
 	}
-	
-	
+
+
 	@Test
 	public void testSingleParameterWithoutValue() {
 		HttpRequestHelper helper = new HttpRequestHelper();
 		helper.addGetParameter("firstname", null);
-	
+
 		HttpRequest request = HttpRequest.of(helper.getRequestAsByteBuffer());
 		Map<String, Collection<String>> params = request.getParameters();
 		assertEquals(0, getSize(params));
 		assertEquals(null, request.getParameter("firstname"));
 	}
-	
+
 	@Test
 	public void testMultipleParametersWithoutValue() {
 		HttpRequestHelper helper = new HttpRequestHelper();
 		helper.addGetParameter("firstname", null);
 		helper.addGetParameter("lastName", "");
-	
+
 		HttpRequest request = HttpRequest.of(helper.getRequestAsByteBuffer());
 		Map<String, Collection<String>> params = request.getParameters();
-		
+
 		assertEquals(0, getSize(params));
 		assertEquals(null, request.getParameter("firstname"));
 		assertEquals(null, request.getParameter("lastName"));
 	}
-	
+
 	@Test
 	public void testMultipleParametersWithAndWithoutValue() {
 		HttpRequestHelper helper = new HttpRequestHelper();
@@ -141,10 +141,10 @@ public class HttpRequestTest {
 		helper.addGetParameter("city", "");
 		helper.addGetParameter("phoneno", "12345");
 		helper.addGetParameter("age", "30");
-	
+
 		HttpRequest request = HttpRequest.of(helper.getRequestAsByteBuffer());
 		Map<String, Collection<String>> params = request.getParameters();
-		
+
 		assertEquals(3, getSize(params));
 		assertEquals(null, request.getParameter("firstname"));
 		assertEquals("petersson", request.getParameter("lastName"));
@@ -152,17 +152,17 @@ public class HttpRequestTest {
 		assertEquals("12345", request.getParameter("phoneno"));
 		assertEquals("30", request.getParameter("age"));
 	}
-	
+
 	@Test
 	public void testSingleGetParameterMultipleValues() {
 		HttpRequestHelper helper = new HttpRequestHelper();
 		helper.addGetParameter("letters", "x");
 		helper.addGetParameter("letters", "y");
 		helper.addGetParameter("letters", "z");
-		
+
 		HttpRequest request = HttpRequest.of(helper.getRequestAsByteBuffer());
 		Map<String, Collection<String>> params = request.getParameters();
-		
+
 		assertEquals(3, getSize(params));
 		Collection<String> values = params.get("letters");
 		assertEquals(3, values.size());
@@ -170,7 +170,7 @@ public class HttpRequestTest {
 		assertTrue(values.contains("y"));
 		assertTrue(values.contains("z"));
 	}
-	
+
 	@Test
 	public void testMultipleGetParametersMultipleValues() {
 		HttpRequestHelper helper = new HttpRequestHelper();
@@ -180,29 +180,29 @@ public class HttpRequestTest {
 		helper.addGetParameter("numbers", "23");
 		helper.addGetParameter("numbers", "54");
 		helper.addGetParameter("country", "swe");
-		
+
 		HttpRequest request = HttpRequest.of(helper.getRequestAsByteBuffer());
 		Map<String, Collection<String>> params = request.getParameters();
-		
+
 		assertEquals(6, getSize(params));
 		Collection<String> letters = params.get("letters");
 		Collection<String> numbers = params.get("numbers");
 		Collection<String> country = params.get("country");
-		
+
 		assertEquals(3, letters.size());
 		assertEquals(2, numbers.size());
 		assertEquals(1, country.size());
-		
+
 		assertTrue(letters.contains("x"));
 		assertTrue(letters.contains("y"));
 		assertTrue(letters.contains("z"));
-		
+
 		assertTrue(numbers.contains("23"));
 		assertTrue(numbers.contains("54"));
-		
+
 		assertTrue(country.contains("swe"));
 	}
-	
+
 	@Test
 	public void testSingleGetParameterMultipleValuesIncludingNull() {
 		HttpRequestHelper helper = new HttpRequestHelper();
@@ -210,10 +210,10 @@ public class HttpRequestTest {
 		helper.addGetParameter("letters", "y");
 		helper.addGetParameter("letters", null);
 		helper.addGetParameter("letters", "z");
-		
+
 		HttpRequest request = HttpRequest.of(helper.getRequestAsByteBuffer());
 		Map<String, Collection<String>> params = request.getParameters();
-		
+
 		assertEquals(3, getSize(params));
 		Collection<String> values = params.get("letters");
 		assertEquals(3, values.size());
@@ -221,7 +221,7 @@ public class HttpRequestTest {
 		assertTrue(values.contains("y"));
 		assertTrue(values.contains("z"));
 	}
-	
+
 	@Test
 	public void testEmptyParameters() {
 		HttpRequestHelper helper = new HttpRequestHelper();
@@ -230,17 +230,17 @@ public class HttpRequestTest {
 		assertNotNull(params);
 		assertEquals(0, getSize(params));
 	}
-	
+
 	@Test(expected=UnsupportedOperationException.class)
 	public void testImmutableParameters() {
 		HttpRequestHelper helper = new HttpRequestHelper();
 		helper.addGetParameter("letter", "x");
-		
+
 		HttpRequest request = HttpRequest.of(helper.getRequestAsByteBuffer());
 		Map<String, Collection<String>> params = request.getParameters();
 		params.put("not", new ArrayList<String>());	
 	}
-	
+
 	@Test
 	public void testHostVerification_exists_HTTP_1_0() {
 		HttpRequestHelper helper = new HttpRequestHelper();
@@ -249,7 +249,7 @@ public class HttpRequestTest {
 		boolean requestOk = HttpUtil.verifyRequest(request);
 		assertTrue(requestOk);
 	}
-	
+
 	@Test
 	public void testHostVerification_nonExisting_HTTP_1_0() {
 		HttpRequestHelper helper = new HttpRequestHelper();
@@ -259,7 +259,7 @@ public class HttpRequestTest {
 		boolean requestOk = HttpUtil.verifyRequest(request);
 		assertTrue(requestOk);
 	}
-	
+
 	@Test
 	public void testHostVerification_exists_HTTP_1_1() {
 		HttpRequestHelper helper = new HttpRequestHelper();
@@ -267,7 +267,7 @@ public class HttpRequestTest {
 		boolean requestOk = HttpUtil.verifyRequest(request);
 		assertTrue(requestOk);
 	}
-	
+
 	@Test
 	public void testHostVerification_nonExisting_HTTP_1_1() {
 		HttpRequestHelper helper = new HttpRequestHelper();
@@ -276,4 +276,11 @@ public class HttpRequestTest {
 		boolean requestOk = HttpUtil.verifyRequest(request);
 		assertFalse(requestOk);
 	}
+
+	@Test
+	public void testGarbageRequest() {
+		HttpRequest.of(ByteBuffer.wrap(
+				new byte[] {1, 1, 1, 1}	// garbage
+		));
+	}
 }
