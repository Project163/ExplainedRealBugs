<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 17:55:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-1039] multi-insert doesn&apos;t work for local directories</title>
                <link>https://issues.apache.org/jira/browse/HIVE-1039</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;As wd pointed out in hive-user, the following query only load data to the first local directory. Multi-insert to tables works fine. &lt;/p&gt;

&lt;p&gt;hive&amp;gt; from test&lt;br/&gt;
    &amp;gt; INSERT OVERWRITE LOCAL DIRECTORY &apos;/home/stefdong/tmp/0&apos; select *&lt;br/&gt;
where a = 1&lt;br/&gt;
    &amp;gt; INSERT OVERWRITE LOCAL DIRECTORY &apos;/home/stefdong/tmp/1&apos; select *&lt;br/&gt;
where a = 3;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12445206">HIVE-1039</key>
            <summary>multi-insert doesn&apos;t work for local directories</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nzhang">Ning Zhang</assignee>
                                    <reporter username="nzhang">Ning Zhang</reporter>
                        <labels>
                    </labels>
                <created>Mon, 11 Jan 2010 19:29:20 +0000</created>
                <updated>Sat, 17 Dec 2011 00:06:13 +0000</updated>
                            <resolved>Wed, 13 Jan 2010 00:13:10 +0000</resolved>
                                    <version>0.5.0</version>
                    <version>0.6.0</version>
                                    <fixVersion>0.5.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12798955" author="nzhang" created="Tue, 12 Jan 2010 00:22:55 +0000"  >&lt;p&gt;Uploading patch &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1039&quot; title=&quot;multi-insert doesn&amp;#39;t work for local directories&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1039&quot;&gt;&lt;del&gt;HIVE-1039&lt;/del&gt;&lt;/a&gt;.patch. This fixes the issue where only 1 moveTask was added when multipole local directories appear in a multi-insert.&lt;/p&gt;</comment>
                            <comment id="12799023" author="namit" created="Tue, 12 Jan 2010 02:20:07 +0000"  >&lt;p&gt;looks ok - but can you add the following tests:&lt;/p&gt;

&lt;p&gt;1. hive.merge.maptasks = true&lt;br/&gt;
multi table insert query (map only)&lt;/p&gt;

&lt;p&gt;2. hive.merge.maptasks = false&lt;br/&gt;
multi table insert query (map only)&lt;/p&gt;


&lt;p&gt;3. hive.merge.maptasks = true&lt;br/&gt;
multi directory insert query (map only)&lt;/p&gt;

&lt;p&gt;4. hive.merge.maptasks = false&lt;br/&gt;
multi directory insert query (map only)&lt;/p&gt;

&lt;p&gt;5. hive.merge.mapredtasks = true&lt;br/&gt;
multi table insert query (map-reduce)&lt;/p&gt;

&lt;p&gt;6. hive.merge.mapredtasks = false&lt;br/&gt;
multi table insert query (map-reduce)&lt;/p&gt;
</comment>
                            <comment id="12799100" author="nzhang" created="Tue, 12 Jan 2010 06:38:53 +0000"  >&lt;p&gt;Uploading new patch includes unit tests mentioned above. &lt;/p&gt;</comment>
                            <comment id="12799256" author="namit" created="Tue, 12 Jan 2010 16:30:41 +0000"  >&lt;p&gt;@Ning, can you test union for same table (map only) with a multi table insert also ?&lt;/p&gt;</comment>
                            <comment id="12799298" author="nzhang" created="Tue, 12 Jan 2010 18:05:55 +0000"  >&lt;p&gt;Namit, do you mean something like this?&lt;/p&gt;

&lt;p&gt;from (select * from src  union all select * from src) s&lt;br/&gt;
insert overwrite table src_multi1 select * where key &amp;lt; 10&lt;br/&gt;
insert overwrite table src_multi2 select * where key &amp;gt; 10 and key &amp;lt; 20;&lt;/p&gt;
</comment>
                            <comment id="12799336" author="namit" created="Tue, 12 Jan 2010 19:30:05 +0000"  >&lt;p&gt;This is needed for 0.5 also&lt;/p&gt;</comment>
                            <comment id="12799418" author="nzhang" created="Tue, 12 Jan 2010 22:05:43 +0000"  >&lt;p&gt;Discussed with Namit offline, and found a larger issue in multi-insert for table as well if hive.merge.mapfiles=false. The problem is that each TableScanOperator will create a new task as currTask. Any operator that takes multiple parent topOp should merge the tasks into one. Currently GenMRUnion1 does not merge currTask, that&apos;s why cause this problem. We decided to fix this issue in GenMRFileSink1() as it is now in this patch for 0.5.0 and I will file another JIRA for trunk to merge tasks in GenMRUnion1. &lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1039&quot; title=&quot;multi-insert doesn&amp;#39;t work for local directories&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1039&quot;&gt;&lt;del&gt;HIVE-1039&lt;/del&gt;&lt;/a&gt;_3.patch contains the fix for the broader problem mentioned above, and a minor fix for checking hive.merge.mapredfiles together with existance of reducer. Also more tests are added to cover multi-insert involving UNION and all combinations of the two hive.merge paramters. &lt;/p&gt;</comment>
                            <comment id="12799429" author="namit" created="Tue, 12 Jan 2010 22:14:00 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;looks good - will commit to both 0.5 and trunk if the tests pass&lt;/p&gt;</comment>
                            <comment id="12799487" author="namit" created="Wed, 13 Jan 2010 00:13:10 +0000"  >&lt;p&gt;Committed. Thanks Ning&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12429962" name="HIVE-1039.patch" size="2829" author="nzhang" created="Tue, 12 Jan 2010 00:22:55 +0000"/>
                            <attachment id="12429999" name="HIVE-1039_2.patch" size="47908" author="nzhang" created="Tue, 12 Jan 2010 06:38:53 +0000"/>
                            <attachment id="12430049" name="HIVE-1039_3.patch" size="134734" author="nzhang" created="Tue, 12 Jan 2010 22:05:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73138</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 46 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ld3j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122772</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>