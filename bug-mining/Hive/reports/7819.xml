<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:18:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-24373] Wrong predicate is pushed down for view with constant value projection.</title>
                <link>https://issues.apache.org/jira/browse/HIVE-24373</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;For below query the predicate pushed down for one of the table scan is not proper.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
set hive.explain.user=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
set hive.cbo.enable=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
set hive.optimize.ppd=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;DROP TABLE arc;

CREATE table arc(`dt_from` string, `dt_to` string);
CREATE table loc1(`dt_from` string, `dt_to` string);

CREATE
 VIEW view AS
     SELECT
        &lt;span class=&quot;code-quote&quot;&gt;&apos;9999&apos;&lt;/span&gt; as DT_FROM,
        uuid() as DT_TO
     FROM
       loc1
 UNION ALL
     SELECT
        dt_from as DT_FROM,
        uuid() as DT_TO
     FROM
       arc;

EXPLAIN
    SELECT
      dt_from, dt_to
    FROM
      view
    WHERE
      &lt;span class=&quot;code-quote&quot;&gt;&apos;2020&apos;&lt;/span&gt;  between dt_from and dt_to;


&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;For table&#160;loc1,&#160;&#160;DT_FROM is projected as &apos;9999&apos; so the predicate &quot;predicate: &apos;2020&apos; BETWEEN &apos;9999&apos; AND _col1 (type: boolean)&quot; is proper. But for table&#160;arc, the column is projected so the predicate should be &quot;predicate: &apos;2020&apos; BETWEEN _col0 (type: boolean) AND _col1 (type: boolean)&quot;.&lt;/p&gt;

&lt;p&gt;This is because the predicates are stored in a map for each expression. Here the expression is &quot;_col0&quot;. When the predicate is pushed down the union, the same predicate is used for creating the filter expression. Later when constant replacement is done, the first filter is overwriting the second one.&lt;/p&gt;

&lt;p&gt;So we should create a clone (as done at other places) before using the cached predicate for filter. This way the overwrite can be avoided.&#160; &#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13340123">HIVE-24373</key>
            <summary>Wrong predicate is pushed down for view with constant value projection.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="maheshk114">mahesh kumar behera</assignee>
                                    <reporter username="maheshk114">mahesh kumar behera</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 12 Nov 2020 05:42:01 +0000</created>
                <updated>Fri, 13 Nov 2020 11:24:50 +0000</updated>
                            <resolved>Fri, 13 Nov 2020 11:24:08 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="17231395" author="maheshk114" created="Fri, 13 Nov 2020 11:24:50 +0000"  >&lt;p&gt;Committed to master. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jcamachorodriguez&quot; class=&quot;user-hover&quot; rel=&quot;jcamachorodriguez&quot;&gt;jcamachorodriguez&lt;/a&gt;&#160;for review.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13015120" name="HIVE-24373-explain-paln.txt" size="2591" author="maheshk114" created="Thu, 12 Nov 2020 06:15:09 +0000"/>
                            <attachment id="13015123" name="HIVE-24373.patch" size="7845" author="maheshk114" created="Thu, 12 Nov 2020 06:44:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ki68:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>