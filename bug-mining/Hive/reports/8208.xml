<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:22:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-25970] Missing messages in HS2 operation logs</title>
                <link>https://issues.apache.org/jira/browse/HIVE-25970</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;After &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-22753&quot; title=&quot;Fix gradual mem leak: Operationlog related appenders should be cleared up on errors &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-22753&quot;&gt;&lt;del&gt;HIVE-22753&lt;/del&gt;&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-24590&quot; title=&quot;Operation Logging still leaks the log4j Appenders&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-24590&quot;&gt;&lt;del&gt;HIVE-24590&lt;/del&gt;&lt;/a&gt;, with some unlucky timing of events, operation log messages can get lost and never appear in the appropriate files.&lt;/p&gt;

&lt;p&gt;The changes in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-22753&quot; title=&quot;Fix gradual mem leak: Operationlog related appenders should be cleared up on errors &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-22753&quot;&gt;&lt;del&gt;HIVE-22753&lt;/del&gt;&lt;/a&gt; will prevent a &lt;tt&gt;HushableRandomAccessFileAppender&lt;/tt&gt; from being created if the latter refers to a file that has been closed in the last second. Preventing the creation of the appender also means that the message which triggered the creation will be lost forever. In fact any message (for the same query) that comes in the interval of 1 second will be lost forever.&lt;/p&gt;

&lt;p&gt;Before &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-24590&quot; title=&quot;Operation Logging still leaks the log4j Appenders&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-24590&quot;&gt;&lt;del&gt;HIVE-24590&lt;/del&gt;&lt;/a&gt; the appender/file was closed only once (explicitly by HS2) and thus the problem may be very hard to notice in practice. However, with the arrival of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-24590&quot; title=&quot;Operation Logging still leaks the log4j Appenders&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-24590&quot;&gt;&lt;del&gt;HIVE-24590&lt;/del&gt;&lt;/a&gt; appenders may close much more frequently (and not via HS2) making the issue reproducible rather easily. It suffices to set &lt;em&gt;hive.server2.operation.log.purgePolicy.timeToLive&lt;/em&gt; property very low and check the operation logs.&lt;/p&gt;

&lt;p&gt;The problem was discovered by investigating some intermittent failures in operation logging tests (e.g.,  TestOperationLoggingAPIWithTez).&lt;/p&gt;</description>
                <environment></environment>
        <key id="13429987">HIVE-25970</key>
            <summary>Missing messages in HS2 operation logs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zabetak">Stamatis Zampetakis</assignee>
                                    <reporter username="zabetak">Stamatis Zampetakis</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 22 Feb 2022 17:31:17 +0000</created>
                <updated>Thu, 17 Nov 2022 08:48:25 +0000</updated>
                            <resolved>Fri, 25 Feb 2022 17:31:54 +0000</resolved>
                                                    <fixVersion>4.0.0-alpha-1</fixVersion>
                                    <component>HiveServer2</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="2400">40m</timespent>
                                <comments>
                            <comment id="17498120" author="kgyrtkirk" created="Fri, 25 Feb 2022 13:01:40 +0000"  >&lt;p&gt;we just talked with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zabetak&quot; class=&quot;user-hover&quot; rel=&quot;zabetak&quot;&gt;zabetak&lt;/a&gt;; and &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-24590&quot; title=&quot;Operation Logging still leaks the log4j Appenders&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-24590&quot;&gt;&lt;del&gt;HIVE-24590&lt;/del&gt;&lt;/a&gt; makes &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-22753&quot; title=&quot;Fix gradual mem leak: Operationlog related appenders should be cleared up on errors &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-22753&quot;&gt;&lt;del&gt;HIVE-22753&lt;/del&gt;&lt;/a&gt; unneccessary - and it may only cause trouble (lost messages)&lt;/p&gt;</comment>
                            <comment id="17498230" author="zabetak" created="Fri, 25 Feb 2022 17:31:54 +0000"  >&lt;p&gt;Fixed in &lt;a href=&quot;https://github.com/apache/hive/commit/d3cd596aa15ebedd58f99628d43a03eb2f5f3909&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/commit/d3cd596aa15ebedd58f99628d43a03eb2f5f3909&lt;/a&gt;. Thanks for the review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kgyrtkirk&quot; class=&quot;user-hover&quot; rel=&quot;kgyrtkirk&quot;&gt;kgyrtkirk&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13350636">HIVE-24590</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13280654">HIVE-22753</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 37 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0zu14:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12343343">4.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>