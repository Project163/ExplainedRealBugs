<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:47:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-14411] selecting Hive on Hbase table may cause FileNotFoundException</title>
                <link>https://issues.apache.org/jira/browse/HIVE-14411</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;1. create a Hbase table hbase_table&lt;br/&gt;
2. create a external Hive table test_table mapping to the hbase table &lt;/p&gt;

&lt;p&gt;example: &lt;/p&gt;

&lt;p&gt;create &apos;hbase_t&apos; ,&lt;/p&gt;
{NAME=&amp;gt;&apos;cf&apos;,COMPRESSION=&amp;gt;&apos;snappy&apos;}
&lt;p&gt;,&lt;/p&gt;
{NUMREGIONS=&amp;gt;15,SPLITALGO=&amp;gt;&apos;HexStringSplit&apos;}

&lt;p&gt;create external table hbase_t_hive(key1 string,cf_train string,cf_flight string,cf_wbsw string,cf_wbxw string,cf_bgrz string,cf_bgtf string) &lt;br/&gt;
stored by &apos;org.apache.hadoop.hive.hbase.HBaseStorageHandler&apos; &lt;br/&gt;
with serdeproperties(&quot;hbase.columns.mapping&quot;=&quot;:key,cf:train,cf:flight,cf:wbsw,cf:wbxw,cf:bgrz,cf:bgtf&quot;) tblproperties(&quot;hbase.table.name&quot;=&quot;hbase_t&quot;);&lt;/p&gt;


&lt;p&gt;create table test3 as select * from hbase_t_hive where 1=2;&lt;/p&gt;

&lt;p&gt;====&lt;/p&gt;

&lt;p&gt;if hive.optimize.null.scan=true, it will return an FileNotFoundException&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12994561">HIVE-14411</key>
            <summary>selecting Hive on Hbase table may cause FileNotFoundException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="niklaus.xiao">Niklaus Xiao</assignee>
                                    <reporter username="LueChen">Rudd Chen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Aug 2016 11:27:45 +0000</created>
                <updated>Wed, 26 Jul 2017 03:30:19 +0000</updated>
                            <resolved>Fri, 5 Aug 2016 02:01:23 +0000</resolved>
                                    <version>1.3.0</version>
                                    <fixVersion>2.2.0</fixVersion>
                                    <component>Physical Optimizer</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15405760" author="luechen" created="Wed, 3 Aug 2016 11:29:06 +0000"  >&lt;p&gt;  @SuppressWarnings(&quot;rawtypes&quot;)&lt;br/&gt;
  private static Path createDummyFileForEmptyPartition(Path path, JobConf job, MapWork work,&lt;br/&gt;
      Path hiveScratchDir, String alias, int sequenceNumber)&lt;br/&gt;
          throws Exception {&lt;/p&gt;

&lt;p&gt;    String strPath = path.toString();&lt;/p&gt;

&lt;p&gt;    // The input file does not exist, replace it by a empty file&lt;br/&gt;
    PartitionDesc partDesc = work.getPathToPartitionInfo().get(strPath);&lt;br/&gt;
    if (partDesc.getTableDesc().isNonNative()) &lt;/p&gt;
{
      // if this isn&apos;t a hive table we can&apos;t create an empty file for it.
      return path;
    }

&lt;p&gt;    Properties props = SerDeUtils.createOverlayedProperties(&lt;br/&gt;
        partDesc.getTableDesc().getProperties(), partDesc.getProperties());&lt;br/&gt;
    HiveOutputFormat outFileFormat = HiveFileFormatUtils.getHiveOutputFormat(job, partDesc);&lt;/p&gt;

&lt;p&gt;    boolean oneRow = partDesc.getInputFileFormatClass() == OneNullRowInputFormat.class;&lt;/p&gt;

&lt;p&gt;    Path newPath = createEmptyFile(hiveScratchDir, outFileFormat, job,&lt;/p&gt;</comment>
                            <comment id="15405763" author="luechen" created="Wed, 3 Aug 2016 11:32:28 +0000"  >&lt;p&gt;when we are selecting a non native table, this method would return a strange path like &quot;-mr-10004default.hbase_t_hive{}&quot;,  and it would throw an exception like below when submitting the MapReduce Job.&lt;/p&gt;

&lt;p&gt;ava.io.FileNotFoundException: File does not exist: /user/admin/-mr-10004default.hbase_t_hive{}&lt;br/&gt;
	at org.apache.hadoop.hdfs.server.namenode.FSDirStatAndListingOp.getContentSummaryInt(FSDirStatAndListingOp.java:509)&lt;br/&gt;
	at org.apache.hadoop.hdfs.server.namenode.FSDirStatAndListingOp.getContentSummary(FSDirStatAndListingOp.java:140)&lt;br/&gt;
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getContentSummary(FSNamesystem.java:3862)&lt;br/&gt;
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.getContentSummary(NameNodeRpcServer.java:1230)&lt;br/&gt;
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.getContentSummary(ClientNamenodeProtocolServerSideTranslatorPB.java:887)&lt;br/&gt;
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)&lt;br/&gt;
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:616)&lt;br/&gt;
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:973)&lt;br/&gt;
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2089)&lt;br/&gt;
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2085)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
	at javax.security.auth.Subject.doAs(Subject.java:422)&lt;br/&gt;
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1711)&lt;br/&gt;
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2083)&lt;/p&gt;

&lt;p&gt;	at sun.reflect.GeneratedConstructorAccessor83.newInstance(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)&lt;br/&gt;
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)&lt;br/&gt;
	at org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:106)&lt;br/&gt;
	at org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:73)&lt;br/&gt;
	at org.apache.hadoop.hdfs.DFSClient.getContentSummary(DFSClient.java:2731)&lt;br/&gt;
	at org.apache.hadoop.hdfs.DistributedFileSystem$18.doCall(DistributedFileSystem.java:816)&lt;br/&gt;
	at org.apache.hadoop.hdfs.DistributedFileSystem$18.doCall(DistributedFileSystem.java:812)&lt;br/&gt;
	at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)&lt;br/&gt;
	at org.apache.hadoop.hdfs.DistributedFileSystem.getContentSummary(DistributedFileSystem.java:812)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.exec.mr.ExecDriver.getInputFileNum(ExecDriver.java:555)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.exec.mr.ExecDriver.checkFileNum(ExecDriver.java:535)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.exec.mr.ExecDriver.execute(ExecDriver.java:430)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.exec.mr.MapRedTask.execute(MapRedTask.java:137)&lt;/p&gt;</comment>
                            <comment id="15407591" author="niklaus.xiao" created="Thu, 4 Aug 2016 11:30:56 +0000"  >&lt;p&gt;We should not apply NullScanOptimizer for non-native table.&lt;/p&gt;

&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt; for code review.&lt;/p&gt;</comment>
                            <comment id="15408451" author="hiveqa" created="Thu, 4 Aug 2016 20:44:59 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12822041/HIVE-14411.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12822041/HIVE-14411.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 4 failed/errored test(s), 10425 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestMiniTezCliDriver-vectorization_16.q-schema_evol_text_vec_mapwork_part_all_complex.q-vector_acid3.q-and-12-more - did not produce a TEST-*.xml file
TestMsgBusConnection - did not produce a TEST-*.xml file
TestQueryLifeTimeHook - did not produce a TEST-*.xml file
org.apache.hive.jdbc.TestJdbcWithMiniHS2.testAddJarConstructorUnCaching
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/772/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/772/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/772/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/772/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-772/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-772/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 4 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12822041 - PreCommit-HIVE-MASTER-Build&lt;/p&gt;</comment>
                            <comment id="15408758" author="niklaus.xiao" created="Fri, 5 Aug 2016 01:50:43 +0000"  >&lt;p&gt;Test failures not related.&lt;/p&gt;</comment>
                            <comment id="15408759" author="ashutoshc" created="Fri, 5 Aug 2016 01:52:19 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="15408766" author="ashutoshc" created="Fri, 5 Aug 2016 02:01:23 +0000"  >&lt;p&gt;Pushed to master. Thanks, Niklaus!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12822041" name="HIVE-14411.1.patch" size="925" author="niklaus.xiao" created="Thu, 4 Aug 2016 11:28:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 15 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31un3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12335837">2.2.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>