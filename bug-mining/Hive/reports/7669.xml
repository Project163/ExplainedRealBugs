<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:17:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-22301] Hive lineage is not generated for insert overwrite queries on partitioned tables</title>
                <link>https://issues.apache.org/jira/browse/HIVE-22301</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Problem: When I run the below mentioned queries, the last query should have given the proper hive lineage info (through HookContext) from table_b to table_t.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Create table table_t (id int) partitioned by (dob date);&lt;/li&gt;
	&lt;li&gt;Create table table_b (id int) partitioned by (dob date);&lt;/li&gt;
	&lt;li&gt;from&#160;table_b&#160;a&#160;insert&#160;overwrite&#160;table&#160;table_t&#160;select&#160;a.id,a.dob;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Note : for CTAS query from a partitioned table , this issue is not seen. Only for insert queries like insert into &amp;lt;table&amp;gt; select * from &amp;lt;table&amp;gt; and query like above, issue is seen.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Technical Observations:&lt;/p&gt;

&lt;p&gt;At HookContext (passed from hive.ql.Driver to Hive Hook of Atlas through hookRunner.runPostExecHooks call) contains no outputs. Check below screenshot from IntelliJ.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12982437/12982437_ScreenShot+RunPostExecHook.png&quot; height=&quot;427&quot; width=&quot;728&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I found that the PrivateHookContext is getting created with proper outputs value as shown below initially:&lt;/p&gt;

&lt;p&gt;&#160; &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12982436/12982436_ScreenShot+HookContext.png&quot; height=&quot;541&quot; width=&quot;714&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;The same is passed properly to runBeforeExecutionHook as shown below:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12982435/12982435_ScreenShot+runBeforeExecution.png&quot; height=&quot;620&quot; width=&quot;719&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Later when we pass HookContext to runPostExecHooks, there is no output populated. Kindly check the reason and let me know if you need any further information from my end.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13260986">HIVE-22301</key>
            <summary>Hive lineage is not generated for insert overwrite queries on partitioned tables</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kgyrtkirk">Zoltan Haindrich</assignee>
                                    <reporter username="sidharthkmishra">Sidharth Kumar Mishra</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 8 Oct 2019 00:00:37 +0000</created>
                <updated>Tue, 27 Feb 2024 22:23:59 +0000</updated>
                            <resolved>Wed, 8 Jul 2020 14:52:00 +0000</resolved>
                                    <version>3.1.2</version>
                                    <fixVersion>4.0.0-alpha-1</fixVersion>
                                    <component>lineage</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="17151990" author="kgyrtkirk" created="Mon, 6 Jul 2020 12:34:45 +0000"  >&lt;p&gt;the &lt;a href=&quot;https://github.com/apache/hive/blob/ae6976b0b0a4b04ea1b2ee5906a3980ce7e1cddd/ql/src/java/org/apache/hadoop/hive/ql/Executor.java#L480&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;removal of these entities&lt;/a&gt;  seems to be intentionally introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1781&quot; title=&quot;outputs not populated for dynamic partitions at compile time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1781&quot;&gt;&lt;del&gt;HIVE-1781&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;it seems like they were avoiding to change the &quot;postexec&quot; hooks...&lt;/p&gt;</comment>
                            <comment id="17152176" author="jcamacho" created="Mon, 6 Jul 2020 17:10:24 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="17153665" author="kgyrtkirk" created="Wed, 8 Jul 2020 14:52:00 +0000"  >&lt;p&gt;pushed to master. Thank you Jesus and Denys for reviewing the changes!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12982436" name="ScreenShot HookContext.png" size="548236" author="sidharthkmishra" created="Mon, 7 Oct 2019 23:59:38 +0000"/>
                            <attachment id="12982437" name="ScreenShot RunPostExecHook.png" size="1428882" author="sidharthkmishra" created="Mon, 7 Oct 2019 23:59:19 +0000"/>
                            <attachment id="12982435" name="ScreenShot runBeforeExecution.png" size="602222" author="sidharthkmishra" created="Tue, 8 Oct 2019 00:00:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 19 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z07db4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>