<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 17:58:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-2095] auto convert map join bug</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2095</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;1) &lt;br/&gt;
when considering to choose one table as the big table candidate for a map join, if at compile time, hive can find out that the total known size of all other tables excluding the big table in consideration is bigger than a configured value, this big table candidate is a bad one, and should not put into plan. Otherwise, at runtime to filter this out may cause more time.&lt;/p&gt;

&lt;p&gt;2)&lt;br/&gt;
added a null check for back up tasks. Otherwise will see NullPointerException&lt;/p&gt;

&lt;p&gt;3)&lt;br/&gt;
CommonJoinResolver needs to know a full mapping of pathToAliases. Otherwise it will make wrong decision.&lt;/p&gt;

&lt;p&gt;4)&lt;br/&gt;
changes made to the ConditionalResolverCommonJoin: added pathToAliases, aliasToSize (alias&apos;s input size that is known at compile time, by inputSummary), and intermediate dir path.&lt;br/&gt;
So the logic is, go over all the pathToAliases, and for each path, if it is from intermediate dir path, add this path&apos;s size to all aliases. And finally based on the size information and others like aliasToTask to choose the big table. &lt;/p&gt;

&lt;p&gt;5)&lt;br/&gt;
Conditional task&apos;s children contains wrong options, which may cause join fail or incorrect results. Basically when getting all possible children for the conditional task, should use a whitelist of big tables. Only tables in this while list can be considered as a big table.&lt;br/&gt;
Here is the logic:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Get a list of big table candidates. Only the tables in the returned set can be used as big table in the join operation.&lt;/li&gt;
	&lt;li&gt;The logic here is to scan the join condition array from left to right.
	&lt;ul&gt;
		&lt;li&gt;If see a inner join and the bigTableCandidates is empty, add both side of this inner join to big table candidates.&lt;/li&gt;
		&lt;li&gt;If see a left outer join, and the bigTableCandidates is empty, add the left side to it, and&lt;/li&gt;
		&lt;li&gt;if the bigTableCandidates is not empty, do nothing (which means the bigTableCandidates is from left side).&lt;/li&gt;
		&lt;li&gt;If see a right outer join, clear the bigTableCandidates, and add right side to the bigTableCandidates, it means the right side of a right outer join always win.&lt;/li&gt;
		&lt;li&gt;If see a full outer join, return null immediately (no one can be the big table, can not do a mapjoin).&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12503460">HIVE-2095</key>
            <summary>auto convert map join bug</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="he yongqiang">He Yongqiang</assignee>
                                    <reporter username="he yongqiang">He Yongqiang</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Apr 2011 21:42:49 +0000</created>
                <updated>Mon, 12 Nov 2012 21:01:13 +0000</updated>
                            <resolved>Fri, 8 Apr 2011 22:00:09 +0000</resolved>
                                    <version>0.7.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13016871" author="liyin" created="Thu, 7 Apr 2011 15:19:16 +0000"  >&lt;p&gt;I will take a look&lt;/p&gt;</comment>
                            <comment id="13017049" author="namit" created="Thu, 7 Apr 2011 17:11:21 +0000"  >&lt;p&gt;Can you also create a review-board request ?&lt;/p&gt;</comment>
                            <comment id="13017064" author="he yongqiang" created="Thu, 7 Apr 2011 17:43:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/559/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/559/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13017208" author="liyin" created="Thu, 7 Apr 2011 23:59:41 +0000"  >&lt;p&gt;it looks good to me. Thanks Yongqiang&lt;/p&gt;</comment>
                            <comment id="13017291" author="he yongqiang" created="Fri, 8 Apr 2011 05:25:20 +0000"  >&lt;p&gt;Uploading a new patch to address namit&apos;s comments.&lt;/p&gt;

&lt;p&gt;Note, there is an existing bug in hive that cause results of auto_join29.q is not correct. &lt;br/&gt;
Let&apos;s file another jira for it.&lt;br/&gt;
basically, if the outer join filter is enabled, the query &quot;SELECT /&lt;b&gt;+mapjoin(src1, src2)&lt;/b&gt;/ * FROM src src1 RIGHT OUTER JOIN src src2 ON (src1.key = src2.key AND src1.key &amp;lt; 10 AND src2.key &amp;gt; 10) JOIN src src3 ON (src2.key = src3.key AND src3.key &amp;lt; 10) SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value;&quot; will give wrong results in today&apos;s hive.&lt;/p&gt;</comment>
                            <comment id="13017683" author="namit" created="Fri, 8 Apr 2011 22:00:09 +0000"  >&lt;p&gt;Committed. Thanks Yongqiang&lt;/p&gt;</comment>
                            <comment id="13449933" author="mkleiderman" created="Thu, 6 Sep 2012 18:48:30 +0000"  >&lt;p&gt;I think I&apos;m hitting this issue with an 0.7.1 installation - can you provide information about how big the tables need to be in order to trigger the NullPointerException?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12475691" name="HIVE-2095.1.patch" size="505711" author="he yongqiang" created="Thu, 7 Apr 2011 09:22:04 +0000"/>
                            <attachment id="12475785" name="HIVE-2095.2.patch" size="509331" author="he yongqiang" created="Fri, 8 Apr 2011 05:22:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72559</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 11 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0jwnr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114221</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>