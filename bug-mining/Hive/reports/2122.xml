<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:18:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-6648] Permissions are not inherited correctly when tables have multiple partition columns</title>
                <link>https://issues.apache.org/jira/browse/HIVE-6648</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;&lt;tt&gt;Warehouse.mkdirs()&lt;/tt&gt; always looks at the immediate parent of the path that it creates when determining what permissions to inherit. However, it may have created that parent directory as well, in which case it will have the default permissions and will not have inherited them.&lt;/p&gt;

&lt;p&gt;This is a problem when performing an &lt;tt&gt;INSERT&lt;/tt&gt; into a table with more than one partition column. E.g., in an empty table:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;INSERT INTO TABLE tbl PARTITION(p1=1, p2=2) ... &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A new subdirectory /p1=1/p2=2  will be created, and with permission inheritance (per &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2504&quot; title=&quot;Warehouse table subdirectories should inherit the group permissions of the warehouse parent directory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2504&quot;&gt;&lt;del&gt;HIVE-2504&lt;/del&gt;&lt;/a&gt;) enabled, the intention is presumably for both new directories to inherit the root table dir&apos;s permissions. However, &lt;tt&gt;mkdirs()&lt;/tt&gt; will only set the permission of the leaf directory (i.e. /p2=2/), and then only to the permissions of /p1=1/, which was just created.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; mkdirs(Path f) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; MetaException {
    FileSystem fs = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
      fs = getFs(f);
      LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Creating directory &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; it doesn&apos;t exist: &quot;&lt;/span&gt; + f);
      &lt;span class=&quot;code-comment&quot;&gt;//Check &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the directory already exists. We want to change the permission
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;//to that of the parent directory only &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; newly created directories.
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.inheritPerms) {
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
          &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; fs.getFileStatus(f).isDir();
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (FileNotFoundException ignore) {
        }
      }
      &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; success = fs.mkdirs(f);
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.inheritPerms &amp;amp;&amp;amp; success) {
        &lt;span class=&quot;code-comment&quot;&gt;// Set the permission of parent directory.
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// HNR: This is the bug - getParent() may refer to a just-created directory.
&lt;/span&gt;        fs.setPermission(f, fs.getFileStatus(f.getParent()).getPermission());
      }
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; success;
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {
      closeFs(fs);
      MetaStoreUtils.logAndThrowMetaException(e);
    }
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12701165">HIVE-6648</key>
            <summary>Permissions are not inherited correctly when tables have multiple partition columns</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="szehon">Szehon Ho</assignee>
                                    <reporter username="henryr">Henry Robinson</reporter>
                        <labels>
                    </labels>
                <created>Thu, 13 Mar 2014 05:53:51 +0000</created>
                <updated>Thu, 13 Nov 2014 19:44:10 +0000</updated>
                            <resolved>Thu, 10 Apr 2014 14:40:35 +0000</resolved>
                                    <version>0.12.0</version>
                    <version>0.13.0</version>
                                    <fixVersion>0.14.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="13963704" author="szehon" created="Wed, 9 Apr 2014 01:48:30 +0000"  >&lt;p&gt;This patch fixes the issue described.  After creating static partitions (insert into ... partition...), the partition directory and its intermediate-created directories now have the parent&apos;s permission.  See newly-added test case.&lt;/p&gt;

&lt;p&gt;One note- the fix is in Hive.copyFile().  This JIRA also describes another problematic method (Warehouse.mkdirs()).  It is actually not invoked in this particular code path, and probably I can take a look in a follow-up JIRA about it to fix cases where it is invoked.&lt;/p&gt;</comment>
                            <comment id="13964291" author="hiveqa" created="Wed, 9 Apr 2014 15:38:18 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12639322/HIVE-6648.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12639322/HIVE-6648.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 5556 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/2190/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/2190/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/2190/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/2190/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12639322&lt;/p&gt;</comment>
                            <comment id="13964640" author="brocknoland" created="Wed, 9 Apr 2014 20:39:43 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13965399" author="brocknoland" created="Thu, 10 Apr 2014 14:40:35 +0000"  >&lt;p&gt;Thank you Szehon! I have committed this to trunk!&lt;/p&gt;</comment>
                            <comment id="14211110" author="thejas" created="Thu, 13 Nov 2014 19:44:10 +0000"  >&lt;p&gt;This has been fixed in 0.14 release. Please open new jira if you see any issues.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12707839">HIVE-6892</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12639322" name="HIVE-6648.patch" size="6566" author="szehon" created="Wed, 9 Apr 2014 01:48:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>379511</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1te4n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>379802</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>