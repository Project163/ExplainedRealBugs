<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:24:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-8114] Type resolution for udf arguments of Decimal Type results in error</title>
                <link>https://issues.apache.org/jira/browse/HIVE-8114</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;select log (2, 10.5BD) from src;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;results in exception.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12741639">HIVE-8114</key>
            <summary>Type resolution for udf arguments of Decimal Type results in error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdere">Jason Dere</assignee>
                                    <reporter username="ashutoshc">Ashutosh Chauhan</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Sep 2014 00:47:04 +0000</created>
                <updated>Thu, 13 Nov 2014 19:40:32 +0000</updated>
                            <resolved>Thu, 25 Sep 2014 16:56:58 +0000</resolved>
                                    <version>0.13.0</version>
                    <version>0.13.1</version>
                                    <fixVersion>0.14.0</fixVersion>
                                    <component>Query Processor</component>
                    <component>Types</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14134774" author="ashutoshc" created="Tue, 16 Sep 2014 00:48:18 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR ql.Driver (SessionState.java:printError(824)) - FAILED: SemanticException [Error 10014]: Line 3:7 Wrong arguments &lt;span class=&quot;code-quote&quot;&gt;&apos;10.5BD&apos;&lt;/span&gt;: Ambiguous method &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.hadoop.hive.ql.udf.UDFLog with (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, decimal(3,1)). Possible choices: _FUNC_(decimal(38,18))  _FUNC_(decimal(38,18), decimal(38,18))  _FUNC_(decimal(38,18), &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)  _FUNC_(&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)  _FUNC_(&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;, decimal(38,18))  _FUNC_(&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
org.apache.hadoop.hive.ql.parse.SemanticException: Line 3:7 Wrong arguments &lt;span class=&quot;code-quote&quot;&gt;&apos;10.5BD&apos;&lt;/span&gt;: Ambiguous method &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.hadoop.hive.ql.udf.UDFLog with (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, decimal(3,1)). Possible choices: _FUNC_(decimal(38,18))  _FUNC_(decimal(38,18), decimal(38,18))  _FUNC_(decimal(38,18), &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)  _FUNC_(&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)  _FUNC_(&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;, decimal(38,18))  _FUNC_(&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
        at org.apache.hadoop.hive.ql.parse.TypeCheckProcFactory$DefaultExprProcessor.process(TypeCheckProcFactory.java:1162)
        at org.apache.hadoop.hive.ql.lib.DefaultRuleDispatcher.dispatch(DefaultRuleDispatcher.java:90)
        at org.apache.hadoop.hive.ql.lib.DefaultGraphWalker.dispatchAndReturn(DefaultGraphWalker.java:94)
        at org.apache.hadoop.hive.ql.lib.DefaultGraphWalker.dispatch(DefaultGraphWalker.java:78)
        at org.apache.hadoop.hive.ql.lib.DefaultGraphWalker.walk(DefaultGraphWalker.java:132)
        at org.apache.hadoop.hive.ql.lib.DefaultGraphWalker.startWalking(DefaultGraphWalker.java:109)
        at org.apache.hadoop.hive.ql.parse.TypeCheckProcFactory.genExprNode(TypeCheckProcFactory.java:189)
        at org.apache.hadoop.hive.ql.parse.TypeCheckProcFactory.genExprNode(TypeCheckProcFactory.java:142)
        at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genAllExprNodeDesc(SemanticAnalyzer.java:10264)
        at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genExprNodeDesc(SemanticAnalyzer.java:10220)
        at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genSelectPlan(SemanticAnalyzer.java:3553)
        at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genSelectPlan(SemanticAnalyzer.java:3334)
        at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:8779)
        at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:8734)
        at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:9566)
        at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:9889)
        at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:217)
        at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:407)
        at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:303)
        at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:1058)
        at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1128)
        at org.apache.hadoop.hive.ql.Driver.run(Driver.java:995)
        at org.apache.hadoop.hive.ql.Driver.run(Driver.java:985)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14146972" author="sershe" created="Wed, 24 Sep 2014 22:20:12 +0000"  >&lt;p&gt;Is this for CBO?&lt;/p&gt;</comment>
                            <comment id="14146975" author="ashutoshc" created="Wed, 24 Sep 2014 22:22:27 +0000"  >&lt;p&gt;Nopes, this happens without CBO on trunk. &lt;br/&gt;
cc: &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdere&quot; class=&quot;user-hover&quot; rel=&quot;jdere&quot;&gt;jdere&lt;/a&gt; who might know more.&lt;/p&gt;</comment>
                            <comment id="14147000" author="jdere" created="Wed, 24 Sep 2014 22:39:12 +0000"  >&lt;p&gt;UDFLog looks like it&apos;s implemented as an old-style UDF, and has an evaluate() method with Decimal parameters. Unfortunately Hive can&apos;t properly support evaluate() methods where the arguments are parameterized types (decimal, char, varchar). There are a couple of ways to resolve this:&lt;/p&gt;

&lt;p&gt;1. Convert UDF() to a GenericUDF&lt;br/&gt;
2. Remove the evaluate() methods from UDFLog which contain Decimal args. If the double version of evaluate() exists the parameters will be converted to use the double version. However this means that the result will be of type Double.&lt;/p&gt;</comment>
                            <comment id="14147019" author="jdere" created="Wed, 24 Sep 2014 22:47:38 +0000"  >&lt;p&gt;It looks like the underlying implementation of UDFLog() just uses double anyway, so it doesn&apos;t look like we are losing much if we drop the Decimal version of this function.&lt;/p&gt;</comment>
                            <comment id="14147029" author="ashutoshc" created="Wed, 24 Sep 2014 22:53:27 +0000"  >&lt;p&gt;I see. Thanks, Jason for taking a look.  I am fine with either option. Lets do 2) since that looks like less work.&lt;/p&gt;</comment>
                            <comment id="14147036" author="jdere" created="Wed, 24 Sep 2014 22:58:23 +0000"  >&lt;p&gt;Actually, it looks like this was supposed to work with Decimal, there were changes made with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6327&quot; title=&quot;A few mathematic functions don&amp;#39;t take decimal input&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6327&quot;&gt;&lt;del&gt;HIVE-6327&lt;/del&gt;&lt;/a&gt;. Let me take a look at what that change was doing.&lt;/p&gt;</comment>
                            <comment id="14147120" author="jdere" created="Wed, 24 Sep 2014 23:56:54 +0000"  >&lt;p&gt;UDFLog has 4 versions of evaluate(arg1, arg2):&lt;br/&gt;
evaluate(double, double)&lt;br/&gt;
evaluate(decimal, decimal)&lt;br/&gt;
evaluate(double, decimal)&lt;br/&gt;
evaluate(decimal, double)&lt;/p&gt;

&lt;p&gt;Looks like we need to get rid of the last 2 versions as they cause ambiguity when one of the arguments is not double or decimal.&lt;/p&gt;</comment>
                            <comment id="14147166" author="jdere" created="Thu, 25 Sep 2014 00:32:12 +0000"  >&lt;p&gt;Remove the extra evaluate() methods and add q file test.&lt;/p&gt;</comment>
                            <comment id="14147228" author="ashutoshc" created="Thu, 25 Sep 2014 01:34:06 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14147959" author="hiveqa" created="Thu, 25 Sep 2014 16:52:23 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12671101/HIVE-8114.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12671101/HIVE-8114.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 6347 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.ql.parse.TestParse.testParse_union
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/980/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/980/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/980/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/980/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-980/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-980/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12671101&lt;/p&gt;</comment>
                            <comment id="14147963" author="ashutoshc" created="Thu, 25 Sep 2014 16:56:58 +0000"  >&lt;p&gt;Committed to trunk. Thanks, Jason!&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vikram.dixit&quot; class=&quot;user-hover&quot; rel=&quot;vikram.dixit&quot;&gt;vikram.dixit&lt;/a&gt; It will be good to have this bug fix in 0.14 too&lt;/p&gt;</comment>
                            <comment id="14150240" author="vikram.dixit" created="Sat, 27 Sep 2014 00:12:00 +0000"  >&lt;p&gt;+1 for 0.14. Please go ahead and commit to 0.14.&lt;/p&gt;</comment>
                            <comment id="14150260" author="jdere" created="Sat, 27 Sep 2014 00:25:28 +0000"  >&lt;p&gt;Committed to 0.14 branch.&lt;/p&gt;</comment>
                            <comment id="14157659" author="lefty@hortonworks.com" created="Fri, 3 Oct 2014 04:10:17 +0000"  >&lt;p&gt;Doc note:  The wiki needs to be updated.  Currently it says &quot;log(DOUBLE base, DOUBLE a) &amp;#8211; Return the base-base logarithm of the argument d. Instead of DOUBLE this UDF also takes DECIMAL, both types can be mixed.&quot;  Hmm ... better change &quot;d&quot; to &quot;a&quot; in that.&lt;/p&gt;

&lt;p&gt;Since this was broken previously, can we just delete &quot;both types can be mixed&quot; without giving version &amp;amp; JIRA information?&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF#LanguageManualUDF-MathematicalFunctions&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Hive Operators and UDFs &amp;#8211; Mathematical Functions &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;A release note would also be good.&lt;/p&gt;</comment>
                            <comment id="14210373" author="thejas" created="Thu, 13 Nov 2014 19:40:32 +0000"  >&lt;p&gt;This has been fixed in 0.14 release. Please open new jira if you see any issues.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12671101" name="HIVE-8114.1.patch" size="9783" author="jdere" created="Thu, 25 Sep 2014 00:32:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i202nb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Removes mixed double/decimal versions of log(). log() will be resolved to one of the following versions, using type conversion where necessary:&lt;br/&gt;
&lt;br/&gt;
double log(double base, double a)&lt;br/&gt;
double log(decimal base, decimal a)</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>