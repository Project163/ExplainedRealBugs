<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:20:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-7232] VectorReduceSink is emitting incorrect JOIN keys</title>
                <link>https://issues.apache.org/jira/browse/HIVE-7232</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;After &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-7121&quot; title=&quot;Use murmur hash to distribute HiveKey&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-7121&quot;&gt;&lt;del&gt;HIVE-7121&lt;/del&gt;&lt;/a&gt;, tpc-h query5 has resulted in incorrect results.&lt;/p&gt;

&lt;p&gt;Thanks to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;navis&lt;/a&gt;, it has been tracked down to the auto-parallel settings which were initialized for ReduceSinkOperator, but not for VectorReduceSinkOperator. The vector version inherits, but doesn&apos;t call super.initializeOp() or set up the variable correctly from ReduceSinkDesc.&lt;/p&gt;

&lt;p&gt;The query is tpc-h query5, with extra NULL checks just to be sure.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ELECT n_name,
       sum(l_extendedprice * (1 - l_discount)) AS revenue
FROM customer,
     orders,
     lineitem,
     supplier,
     nation,
     region
WHERE c_custkey = o_custkey
  AND l_orderkey = o_orderkey
  AND l_suppkey = s_suppkey
  AND c_nationkey = s_nationkey
  AND s_nationkey = n_nationkey
  AND n_regionkey = r_regionkey
  AND r_name = &lt;span class=&quot;code-quote&quot;&gt;&apos;ASIA&apos;&lt;/span&gt;
  AND o_orderdate &amp;gt;= &lt;span class=&quot;code-quote&quot;&gt;&apos;1994-01-01&apos;&lt;/span&gt;
  AND o_orderdate &amp;lt; &lt;span class=&quot;code-quote&quot;&gt;&apos;1995-01-01&apos;&lt;/span&gt;
  and l_orderkey is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
  and c_custkey is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
  and l_suppkey is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
  and c_nationkey is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
  and s_nationkey is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
  and n_regionkey is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
GROUP BY n_name
ORDER BY revenue DESC;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The reducer which has the issue has the following plan&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Reducer 3
            Reduce Operator Tree:
              Join Operator
                condition map:
                     Inner Join 0 to 1
                condition expressions:
                  0 {KEY.reducesinkkey0} {VALUE._col2}
                  1 {VALUE._col0} {KEY.reducesinkkey0} {VALUE._col3}
                outputColumnNames: _col0, _col3, _col10, _col11, _col14
                Statistics: Num rows: 183333344 Data size: 95229140992 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col10 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                  sort order: +
                  Map-reduce partition columns: _col10 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                  Statistics: Num rows: 183333344 Data size: 95229140992 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col3 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col11 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col14 (type: string)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12721236">HIVE-7232</key>
            <summary>VectorReduceSink is emitting incorrect JOIN keys</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gopalv">Gopal Vijayaraghavan</assignee>
                                    <reporter username="gopalv">Gopal Vijayaraghavan</reporter>
                        <labels>
                    </labels>
                <created>Sat, 14 Jun 2014 07:50:51 +0000</created>
                <updated>Thu, 13 Nov 2014 19:41:56 +0000</updated>
                            <resolved>Thu, 26 Jun 2014 23:10:33 +0000</resolved>
                                    <version>0.14.0</version>
                                    <fixVersion>0.14.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14031791" author="ashutoshc" created="Sun, 15 Jun 2014 05:47:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gopalv&quot; class=&quot;user-hover&quot; rel=&quot;gopalv&quot;&gt;gopalv&lt;/a&gt; Is this resulting in wrong results (because NULL key got emitted incorrectly) or this resulting in lower perf (because it resulted in a skew towards NULL) ?&lt;/p&gt;</comment>
                            <comment id="14032033" author="gopalv" created="Sun, 15 Jun 2014 22:11:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt;: Incorrect results as well.&lt;/p&gt;

&lt;p&gt;Ran the same query with Tez &amp;amp; MR, got different results.&lt;/p&gt;

&lt;p&gt;MR doesn&apos;t hit the same scenario becuase of the empty Map task, which doesn&apos;t have any input columns named reducesinkkey0.&lt;/p&gt;

&lt;p&gt;Tez seems to hit a corner case where there are 2 shuffle joins one after the other - there is an input col named KEY.reducesinkkey0 and an output col named reducesinkkey0, which have no relation to each other.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;$ diff -y -W 72  results/q5.tez.txt results/q5.mr.txt 
CHINA   985314.0848                |    VIETNAM 1.897236998313891E10
INDIA   819113.4418000001          |    CHINA   1.894405687452681E10
VIETNAM 637407.2255                |    INDONESIA       1.89306456994551
JAPAN   523754.9791                |    JAPAN   1.892184676125508E10
INDONESIA       517900.1924        |    INDIA   1.886882412417209E10
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14032088" author="ashutoshc" created="Mon, 16 Jun 2014 03:09:45 +0000"  >&lt;p&gt;Seems like this also can get triggered  for MR path. I think latest patch on &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5771&quot; title=&quot;Constant propagation optimizer for Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5771&quot;&gt;&lt;del&gt;HIVE-5771&lt;/del&gt;&lt;/a&gt; is failing for test like subquery_in.q because they are hitting into this issue.&lt;/p&gt;</comment>
                            <comment id="14032106" author="navis" created="Mon, 16 Jun 2014 04:03:31 +0000"  >&lt;p&gt;Fail of  subquery_in.q in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5771&quot; title=&quot;Constant propagation optimizer for Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5771&quot;&gt;&lt;del&gt;HIVE-5771&lt;/del&gt;&lt;/a&gt; seemed not caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4867&quot; title=&quot;Deduplicate columns appearing in both the key list and value list of ReduceSinkOperator&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4867&quot;&gt;&lt;del&gt;HIVE-4867&lt;/del&gt;&lt;/a&gt; but strongly related with it because &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4867&quot; title=&quot;Deduplicate columns appearing in both the key list and value list of ReduceSinkOperator&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4867&quot;&gt;&lt;del&gt;HIVE-4867&lt;/del&gt;&lt;/a&gt; have (intentionally) broken internal assumption on keys/values of RS. With constant propagation optimizer, subquery_in.q is making different keys for each aliases of join, which seemed not valid.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;-- sq_1
Reduce Output Operator
  key expressions: _col1 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
  sort order: ++
  Map-reduce partition columns: _col1 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;-- others
Reduce Output Operator
  key expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
  sort order: ++
  Map-reduce partition columns: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14032108" author="navis" created="Mon, 16 Jun 2014 04:17:39 +0000"  >&lt;p&gt;For this problem, I cannot understand that the RS which is a child of JOIN can get ROW of format,&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;{&quot;reducesinkkey0&quot;:442}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In my reading, join would emit ROW and rowOI which is labeled with output columns, like below&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;_col0    {KEY.reducesinkkey0} 
_col3    {VALUE._col2}
_col10  {VALUE._col0}
_col11  {KEY.reducesinkkey0} 
_col14  {VALUE._col3}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I don&apos;t have environment for hadoop-2, so it&apos;s hard to verify, so it might take some time. &lt;/p&gt;</comment>
                            <comment id="14032123" author="gopalv" created="Mon, 16 Jun 2014 05:41:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;navis&lt;/a&gt;: I can run tests for you, if you have a patch file with log lines.&lt;/p&gt;

&lt;p&gt;I can reproduce this issue consistently for all recent runs of this query.&lt;/p&gt;</comment>
                            <comment id="14032176" author="navis" created="Mon, 16 Jun 2014 07:18:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gopalv&quot; class=&quot;user-hover&quot; rel=&quot;gopalv&quot;&gt;gopalv&lt;/a&gt; Could you attach full explain result and query? Explain result on my notebook is different with yours (For me, it&apos;s Reducer 6 not Reducer 3). Seemed hard to reproduce with small sized data (used factor 1).&lt;/p&gt;</comment>
                            <comment id="14032250" author="navis" created="Mon, 16 Jun 2014 09:22:17 +0000"  >&lt;p&gt;Could you print out whole row instead of keys?&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;x1.append(&quot;row=&quot;+ SerDeUtils.getJSONString(row, rowInspector));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Thanks,&lt;/p&gt;</comment>
                            <comment id="14032929" author="gopalv" created="Mon, 16 Jun 2014 20:52:13 +0000"  >&lt;p&gt;The queries, explain and logging patch attached.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;navis&lt;/a&gt;: This is the output for extra logging (logging patch, explain and query attached)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2014-06-16 13:46:44,716 WARN [TezChild] org.apache.hadoop.hive.serde2.objectinspector.StandardStructObjectInspector: Trying to access 1 fields inside a list of 5 elements: [184, 21, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, 184, 1994-07-02]
2014-06-16 13:46:44,716 WARN [TezChild] org.apache.hadoop.hive.serde2.objectinspector.StandardStructObjectInspector: ignoring similar errors.
2014-06-16 13:46:44,716 INFO [TezChild] org.apache.hadoop.hive.ql.exec.ReduceSinkOperator: GOPAL: numDistributionKeys = 1
&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; --&amp;gt; ExprNodeColumnEvaluator(_col10)
key_row={&lt;span class=&quot;code-quote&quot;&gt;&quot;reducesinkkey0&quot;&lt;/span&gt;:184}
full_row={&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;:184,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col3&quot;&lt;/span&gt;:21,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col10&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col11&quot;&lt;/span&gt;:184,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col14&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;1994-07-02&quot;&lt;/span&gt;}
col_names=reducesinkkey0,
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14033253" author="navis" created="Tue, 17 Jun 2014 00:35:33 +0000"  >&lt;p&gt;_col10 is null which is &quot;VALUE._col0&quot; of MAP2, which is again &quot;o_orderkey&quot;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Reduce Output Operator
  key expressions: o_custkey (type: int)
  sort order: +
  Map-reduce partition columns: o_custkey (type: int)
  Statistics: Num rows: 166666666 Data size: 86571942280 Basic stats: COMPLETE Column stats: NONE
  value expressions: o_orderkey (type: int), o_orderdate (type: string)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Is the table &quot;orders&quot; contains nulls?&lt;/p&gt;</comment>
                            <comment id="14033435" author="gopalv" created="Tue, 17 Jun 2014 04:50:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;navis&lt;/a&gt;: TPC-H data shouldn&apos;t have any NULLs in the join keys.&lt;/p&gt;

&lt;p&gt;I will re-run the scans tomorrow. I can see one case where the schema from &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-600&quot; title=&quot;Running TPC-H queries on Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-600&quot;&gt;HIVE-600&lt;/a&gt; might be completely broken. The Integer requirement in TPC-H requires only -2,147,483,646 to 2,147,483,647. &lt;/p&gt;

&lt;p&gt;Though rethinking this a bit, I think &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-600&quot; title=&quot;Running TPC-H queries on Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-600&quot;&gt;HIVE-600&lt;/a&gt;&apos;s schema a bug which assumed O_ORDERKEY would be an int (might not be 32-bit anymore at 1Tb scale). I will verify that we&apos;re not overflowing that integer limit at a higher scale tomorrow &amp;amp; producing nulls.&lt;/p&gt;

&lt;p&gt;I can confirm that. But that aside, I am more concerned about the difference in output between Tez &amp;amp; MR.&lt;/p&gt;

&lt;p&gt;In MR, no stage with a reduce sink will have a key row fed by a reduce input.  &lt;/p&gt;

&lt;p&gt;I will debug this more tomorrow to narrow down the query to a pair of shuffle-joins and compare output between MR &amp;amp; Tez plans.&lt;/p&gt;</comment>
                            <comment id="14034322" author="gopalv" created="Tue, 17 Jun 2014 20:31:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;navis&lt;/a&gt;: I found out that there are indeed o_orderkey entries which show up as 2148000000 in text, which lies outside the range of the TPC-H Identifier column spec.&lt;/p&gt;

&lt;p&gt;I will reload the data using bigint for o_orderkey soon.&lt;/p&gt;

&lt;p&gt;But I still want to locate and confirm the different results between MR and Tez here.&lt;/p&gt;</comment>
                            <comment id="14034675" author="navis" created="Wed, 18 Jun 2014 00:56:38 +0000"  >&lt;p&gt;Looks like something is wrong in broadcast join. I&apos;ll look into this.&lt;/p&gt;</comment>
                            <comment id="14034734" author="navis" created="Wed, 18 Jun 2014 02:37:15 +0000"  >&lt;p&gt;I&apos;ve reproduced the problem. It occurs on mapjoin + vetorization combination. &lt;/p&gt;</comment>
                            <comment id="14034859" author="navis" created="Wed, 18 Jun 2014 06:04:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gopalv&quot; class=&quot;user-hover&quot; rel=&quot;gopalv&quot;&gt;gopalv&lt;/a&gt; Could you try the query with pre &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-7121&quot; title=&quot;Use murmur hash to distribute HiveKey&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-7121&quot;&gt;&lt;del&gt;HIVE-7121&lt;/del&gt;&lt;/a&gt;? Seemed caused by that.&lt;/p&gt;</comment>
                            <comment id="14034869" author="gopalv" created="Wed, 18 Jun 2014 06:24:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;navis&lt;/a&gt;: I tested this with git commit id 50f517a3930 - it has been broken from before &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-7121&quot; title=&quot;Use murmur hash to distribute HiveKey&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-7121&quot;&gt;&lt;del&gt;HIVE-7121&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;$ hive --version
Hive 0.14.0-SNAPSHOT
Subversion git:&lt;span class=&quot;code-comment&quot;&gt;//cn041.l42scl.hortonworks.com/grid/5/dev/gopalv/tez-autobuild/hive -r 50f517a3930da0a987e6f6e908a91a7705bf9c60
&lt;/span&gt;Compiled by gopal on Tue Jun 17 23:16:51 PDT 2014
From source with checksum 8f75b133edadf23e29096f5e9b5d0f99
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Sorry about the reducesinkkey0 confusion. &lt;/p&gt;

&lt;p&gt;I have assigned this to myself for more investigation - will edit the bug tomorrow to the actual issue of incorrect results.&lt;/p&gt;</comment>
                            <comment id="14035929" author="gopalv" created="Wed, 18 Jun 2014 16:49:59 +0000"  >&lt;p&gt;updated bug report with analysis&lt;/p&gt;</comment>
                            <comment id="14037176" author="hiveqa" created="Thu, 19 Jun 2014 09:42:21 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12650983/HIVE-7232.1.patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12650983/HIVE-7232.1.patch.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 3 failed/errored test(s), 5654 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_root_dir_external_table
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_ctas
org.apache.hive.jdbc.miniHS2.TestHiveServer2.testConnection
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/513/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/513/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/513/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/513/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-513/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-513/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12650983&lt;/p&gt;</comment>
                            <comment id="14040565" author="ashutoshc" created="Mon, 23 Jun 2014 09:33:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gopalv&quot; class=&quot;user-hover&quot; rel=&quot;gopalv&quot;&gt;gopalv&lt;/a&gt; Do you want to review this one?&lt;/p&gt;</comment>
                            <comment id="14041575" author="gopalv" created="Tue, 24 Jun 2014 01:34:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt;: Yes, I will review this today.&lt;/p&gt;</comment>
                            <comment id="14041785" author="gopalv" created="Tue, 24 Jun 2014 06:55:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;navis&lt;/a&gt;: LGTM +1. I will commit this.&lt;/p&gt;

&lt;p&gt;As part of my review, I found that &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;--- ql/src/java/org/apache/hadoop/hive/ql/exec/vector/VectorReduceSinkOperator.java
+++ ql/src/java/org/apache/hadoop/hive/ql/exec/vector/VectorReduceSinkOperator.java
@@ -210,6 +210,9 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void assign(VectorExpressionWriter[] writers,
       &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (limit &amp;gt;= 0 &amp;amp;&amp;amp; memUsage &amp;gt; 0) {
         reducerHash.initialize(limit, memUsage, conf.isMapGroupBy(), &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;);
       }
+
+      autoParallel = conf.isAutoParallel();
+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;is the smallest patch needed to fix this issue.&lt;/p&gt;</comment>
                            <comment id="14041796" author="navis" created="Tue, 24 Jun 2014 07:10:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gopalv&quot; class=&quot;user-hover&quot; rel=&quot;gopalv&quot;&gt;gopalv&lt;/a&gt; Right. Others are included tracking the problem. I&apos;m good in either way.&lt;/p&gt;</comment>
                            <comment id="14044320" author="gopalv" created="Thu, 26 Jun 2014 03:44:49 +0000"  >&lt;p&gt;Need to rebase patch to match recent qtest changes made &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-7258&quot; title=&quot;Move qtest-Driver properties from pom to separate file  &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-7258&quot;&gt;&lt;del&gt;HIVE-7258&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14044397" author="hiveqa" created="Thu, 26 Jun 2014 06:56:55 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12652546/HIVE-7232.2.patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12652546/HIVE-7232.2.patch.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 5654 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_root_dir_external_table
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/594/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/594/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/594/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/594/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-594/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-594/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12652546&lt;/p&gt;</comment>
                            <comment id="14045308" author="gopalv" created="Thu, 26 Jun 2014 23:09:54 +0000"  >&lt;p&gt;Committed to trunk, thanks!&lt;/p&gt;</comment>
                            <comment id="14045309" author="gopalv" created="Thu, 26 Jun 2014 23:10:33 +0000"  >&lt;p&gt;Committed to trunk, thanks!&lt;/p&gt;</comment>
                            <comment id="14045391" author="navis" created="Fri, 27 Jun 2014 00:43:47 +0000"  >&lt;p&gt;The result of tez_join_hash.q seemed not updated after &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-7159&quot; title=&quot;For inner joins push a &amp;#39;is not null predicate&amp;#39; to the join sources for every non nullSafe join condition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-7159&quot;&gt;&lt;del&gt;HIVE-7159&lt;/del&gt;&lt;/a&gt;. I&apos;ll do that.&lt;/p&gt;</comment>
                            <comment id="14210661" author="thejas" created="Thu, 13 Nov 2014 19:41:56 +0000"  >&lt;p&gt;This has been fixed in 0.14 release. Please open new jira if you see any issues.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12650645" name="HIVE-7232-extra-logging.patch" size="3243" author="gopalv" created="Mon, 16 Jun 2014 20:52:13 +0000"/>
                            <attachment id="12650983" name="HIVE-7232.1.patch.txt" size="17863" author="navis" created="Wed, 18 Jun 2014 07:15:32 +0000"/>
                            <attachment id="12652546" name="HIVE-7232.2.patch.txt" size="17423" author="gopalv" created="Thu, 26 Jun 2014 04:06:15 +0000"/>
                            <attachment id="12650646" name="q5.explain.txt" size="14050" author="gopalv" created="Mon, 16 Jun 2014 20:52:13 +0000"/>
                            <attachment id="12650647" name="q5.sql" size="654" author="gopalv" created="Mon, 16 Jun 2014 20:52:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>399432</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1wrfr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>399541</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>VectorReduceSink is emitting incorrect JOIN keys (Navis, via Gopal V)</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>