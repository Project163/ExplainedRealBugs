<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:12:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-19994] Impala &quot;drop table&quot; fails with Hive Metastore exception</title>
                <link>https://issues.apache.org/jira/browse/HIVE-19994</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;&quot;drop table&quot; statement in Impala shell fails with the following exception:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;ImpalaRuntimeException: Error making &apos;dropTable&apos; RPC to Hive Metastore: CAUSED BY: MetaException: One or more instances could not be deleted&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Metastore&#160;log file shows that &quot;DELETE FROM `PARTITION_KEYS` WHERE `TBL_ID`=?&quot; statement fails because of foreign key violation (full stacktrace will be added):&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;Caused by: java.sql.BatchUpdateException: Cannot delete or update a parent row: a foreign key constraint fails (&quot;hivemetastore_emtig3vtq7qp1tiooo07sb70ud&quot;.&quot;COLUMNS_V2&quot;, CONSTRAINT &quot;COLUMNS_V2_FK1&quot; FOREIGN KEY (&quot;CD_ID&quot;) REFERENCES &quot;CDS&quot; (&quot;CD_ID&quot;))&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The table is created and then dropped as a part of ETL process executed every hour. Most of the time it works fine, the&#160;issue is not reproducible at will.&lt;/p&gt;

&lt;p&gt;Table creation script is:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;CREATE TABLE IF NOT EXISTS price_advisor_ouput.t_switching_coef_source&lt;/tt&gt;&lt;br/&gt;
{{( }}&lt;br/&gt;
&lt;tt&gt;...fields here...&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;PRIMARY KEY (...PK field here...)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;PARTITION BY HASH(matrix_pcd) PARTITIONS 3&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;STORED AS KUDU;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Not sure how to approach diagnostics and fix, so any input will be really appreciated.&#160;&lt;/p&gt;

&lt;p&gt;Thanks in advance,&#160;&lt;/p&gt;

&lt;p&gt;Rodion Myronov&lt;/p&gt;</description>
                <environment>&lt;p&gt;Hadoop distribution: CHD 5.14.2&lt;/p&gt;

&lt;p&gt;Hive version:&#160;&#160;1.1.0-cdh5.14.2&lt;/p&gt;

&lt;p&gt;Impala version: 2.11.0&lt;/p&gt;

&lt;p&gt;Kudu version: 1.6.0&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</environment>
        <key id="13168301">HIVE-19994</key>
            <summary>Impala &quot;drop table&quot; fails with Hive Metastore exception</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="karthik.manamcheri">Karthik Manamcheri</assignee>
                                    <reporter username="Rodion Myronov">Rodion Myronov</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Jun 2018 09:22:29 +0000</created>
                <updated>Thu, 17 Nov 2022 08:54:20 +0000</updated>
                            <resolved>Wed, 29 May 2019 16:33:52 +0000</resolved>
                                    <version>1.1.0</version>
                                    <fixVersion>4.0.0-alpha-1</fixVersion>
                                    <component>Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="16523542" author="pvary" created="Tue, 26 Jun 2018 10:37:26 +0000"  >&lt;p&gt;My guess would be, that somehow a new partition is added to the table concurrently, or something like that happened.&lt;/p&gt;

&lt;p&gt;This part of the code is responsible to set the CD to null before dropping a table:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/hive/blob/master/standalone-metastore/src/main/java/org/apache/hadoop/hive/metastore/ObjectStore.java#L1426&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/blob/master/standalone-metastore/src/main/java/org/apache/hadoop/hive/metastore/ObjectStore.java#L1426&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The method code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/**
* Called right before an action that would drop a storage descriptor.
* This function makes the SD&apos;s reference to a CD &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, and then deletes the CD
* &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; it no longer is referenced in the table.
* @param msd the storage descriptor to drop
*/
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void preDropStorageDescriptor(MStorageDescriptor msd) {
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (msd == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || msd.getCD() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
}
MColumnDescriptor mcd = msd.getCD();
&lt;span class=&quot;code-comment&quot;&gt;// Because there is a 1-N relationship between CDs and SDs,
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// we must set the SD&apos;s CD to &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; first before dropping the storage descriptor
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// to satisfy foreign key constraints.
&lt;/span&gt;msd.setCD(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
removeUnusedColumnDescriptor(mcd);
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16524650" author="rodion myronov" created="Wed, 27 Jun 2018 06:33:26 +0000"  >&lt;p&gt;Peter, thanks for the idea!&lt;/p&gt;

&lt;p&gt;I&apos;ve checked the logs and, unfortunately, found no concurrent activity neither in Impala nor in Metastore logs. Will keep monitoring and collecting information.&lt;/p&gt;</comment>
                            <comment id="16815482" author="hrishi123" created="Thu, 11 Apr 2019 14:59:30 +0000"  >&lt;p&gt;We had the same issue in one of our environment,&lt;/p&gt;

&lt;p&gt;&lt;b&gt;In Impala logs,&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;11:10:28.051355&#160; 4188 catalog-server.cc:70] ImpalaRuntimeException: Error making &apos;dropTable&apos; RPC to Hive Metastore:&lt;/p&gt;

&lt;p&gt;CAUSED BY: MetaException: One or more instances could not be deleted&lt;/p&gt;

&lt;p&gt;&lt;b&gt;In Metastore logs&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;java.sql.BatchUpdateException: Cannot delete or update a parent row: a foreign key constraint fails (&quot;HMS_abfgdffhsdhyshs&quot;.&quot;COLUMNS_V2&quot;, CONSTRAINT &quot;COLUMNS_V2_FK1&quot; FOREIGN KEY (&quot;CD_ID&quot;) REFERENCES &quot;CDS&quot; (&quot;CD_ID&quot;))&lt;/p&gt;

&lt;p&gt;Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Cannot delete or update a parent row: a foreign key constraint fails (&quot;HMS_abfgdffhsdhyshs&quot;.&quot;COLUMNS_V2&quot;, CONSTRAINT &quot;COLUMNS_V2_FK1&quot; FOREIGN KEY (&quot;CD_ID&quot;) REFERENCES &quot;CDS&quot; (&quot;CD_ID&quot;))&lt;/p&gt;

&lt;p&gt;We noticed that there was a long-running query being run on the HMS that resulted in higher CPU utilization on the database and this seems to have exacerbated the mentioned bug where a slightly degraded HMS performance resulted in drop tables/views not working to a higher occurrence. Following the termination of the query, we are seeing the drop table/view returning to normal.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Could you have a review of how the logic handles instances where the hive metastore performance is degraded slightly?&#160;&lt;/p&gt;</comment>
                            <comment id="16850147" author="karthik.manamcheri" created="Tue, 28 May 2019 20:56:28 +0000"  >&lt;p&gt;I think I understand what is happening, but I don&apos;t know why it is happening! Basically in my logs I can see that the table delete is proceeding normally until it tries to remove the MColumnDescriptor. Removal of MColumnDescriptor takes two SQL queries&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;DELETE FROM `COLUMNS_V2` WHERE `CD_ID`=757869&lt;br/&gt;
 DELETE FROM `CDS` WHERE `CD_ID`=757869&lt;/li&gt;
	&lt;li&gt;COLUMNS_V2 and CDS are related by a foreign key and the error happens here.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;My team&apos;s current thought is&#160;that the problem resides in the datanucleus layer and it&apos;s handling of the persistence during delete. One of the fixes we tried and it seems to help is to add &quot;&amp;lt;foreign-key name=&quot;COLUMNS_V2_FK&quot; delete-action=&quot;cascade&quot;/&amp;gt;&quot; to package.jdo and this forces the datanuclues layer to deal with the foreign key constraint. If you don&apos;t have this in package.jdo, it delegates the foreign key checks to the underlying db.&lt;/p&gt;</comment>
                            <comment id="16850504" author="hiveqa" created="Wed, 29 May 2019 05:00:51 +0000"  >&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;b&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;&lt;/b&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;&lt;br class=&quot;atl-forced-newline&quot; /&gt;
&lt;br class=&quot;atl-forced-newline&quot; /&gt;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Vote &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Subsystem &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Runtime &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Comment &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; &lt;font color=&quot;brown&quot;&gt; Prechecks &lt;/font&gt; &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; @author &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  0m  0s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; The patch does not contain any @author tags. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; &lt;font color=&quot;brown&quot;&gt; master Compile Tests &lt;/font&gt; &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; mvninstall &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  9m 53s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; master passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; javadoc &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  0m 22s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; master passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; &lt;font color=&quot;brown&quot;&gt; Patch Compile Tests &lt;/font&gt; &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; mvninstall &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  0m 37s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; whitespace &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  0m  0s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; The patch has no whitespace issues. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; javadoc &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  0m 23s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; &lt;font color=&quot;brown&quot;&gt; Other Tests &lt;/font&gt; &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; asflicense &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  0m 17s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; The patch does not generate ASF License warnings. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt;&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt; &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt; 11m 52s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt; &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;&lt;br class=&quot;atl-forced-newline&quot; /&gt;
&lt;br class=&quot;atl-forced-newline&quot; /&gt;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Subsystem &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Report/Notes &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Optional Tests &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  asflicense  javac  javadoc  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; uname &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Linux hiveptest-server-upstream 3.16.0-4-amd64 #1 SMP Debian 3.16.43-2+deb8u5 (2017-09-19) x86_64 GNU/Linux &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Build tool &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; maven &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Personality &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; /data/hiveptest/working/yetus_PreCommit-HIVE-Build-17334/dev-support/hive-personality.sh &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; git revision &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; master / a26dc36 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Default Java &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 1.8.0_111 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; modules &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; C: standalone-metastore/metastore-server U: standalone-metastore/metastore-server &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Console output &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;http://104.198.109.242/logs//PreCommit-HIVE-Build-17334/yetus.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs//PreCommit-HIVE-Build-17334/yetus.txt&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Powered by &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Apache Yetus    &lt;a href=&quot;http://yetus.apache.org&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://yetus.apache.org&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;



&lt;p&gt;This message was automatically generated.&lt;/p&gt;
</comment>
                            <comment id="16850529" author="hiveqa" created="Wed, 29 May 2019 06:07:58 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12970080/HIVE-19994.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12970080/HIVE-19994.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 16063 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/17334/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/17334/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/17334/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/17334/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-17334/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-17334/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.YetusPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12970080 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="16850999" author="karthik.manamcheri" created="Wed, 29 May 2019 15:51:57 +0000"  >&lt;p&gt;Code Review by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ngangam&quot; class=&quot;user-hover&quot; rel=&quot;ngangam&quot;&gt;ngangam&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=holleyism&quot; class=&quot;user-hover&quot; rel=&quot;holleyism&quot;&gt;holleyism&lt;/a&gt;.&#160;&lt;/p&gt;

&lt;p&gt;Naveen, can you merge this? Thanks.&lt;/p&gt;</comment>
                            <comment id="16851044" author="ngangam" created="Wed, 29 May 2019 16:33:52 +0000"  >&lt;p&gt;Fix committed to master. Thank you for your contribution &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=karthik.manamcheri&quot; class=&quot;user-hover&quot; rel=&quot;karthik.manamcheri&quot;&gt;karthik.manamcheri&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aholley&quot; class=&quot;user-hover&quot; rel=&quot;aholley&quot;&gt;aholley&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16895036" author="symious" created="Mon, 29 Jul 2019 08:04:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=karthik.manamcheri&quot; class=&quot;user-hover&quot; rel=&quot;karthik.manamcheri&quot;&gt;karthik.manamcheri&lt;/a&gt; Hello, after I added this patch, I still got the same error.&lt;br/&gt;
 Besides, I was wondering if the name of the foreign-key does matter, because in the error, the message is&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;a foreign key constraint fails (&quot;&lt;/span&gt;xxx&lt;span class=&quot;code-quote&quot;&gt;&quot;.&quot;&lt;/span&gt;COLUMNS_V2&lt;span class=&quot;code-quote&quot;&gt;&quot;, CONSTRAINT &quot;&lt;/span&gt;COLUMNS_V2_FK1&quot;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;And in the patch, it was &quot;COLUMNS_V2_FK&quot;.&lt;/p&gt;</comment>
                            <comment id="16895535" author="karthik.manamcheri" created="Mon, 29 Jul 2019 19:10:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Symious&quot; class=&quot;user-hover&quot; rel=&quot;Symious&quot;&gt;Symious&lt;/a&gt;&#160;You are correct that the name of the foreign-key does matter. Can you try adding&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;foreign-key name=&lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMNS_V2_FK1&quot;&lt;/span&gt; delete-action=&lt;span class=&quot;code-quote&quot;&gt;&quot;cascade&quot;&lt;/span&gt;/&amp;gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to your package.jdo?&lt;/p&gt;</comment>
                            <comment id="16895757" author="symious" created="Tue, 30 Jul 2019 04:17:25 +0000"  >&lt;p&gt;Added &quot;COLUMNS_V2_FK1&quot; and it fixed my problem, thanks very much.&lt;/p&gt;</comment>
                            <comment id="16895761" author="symious" created="Tue, 30 Jul 2019 04:24:37 +0000"  >&lt;p&gt;BTW, after added &quot;COLUMNS_V2_FK1&quot;, the old error disappeared, but some new errors emerged.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.sql.BatchUpdateException: Cannot delete or update a parent row: a foreign key constraint fails (&lt;span class=&quot;code-quote&quot;&gt;&quot;xxx&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;SDS&quot;&lt;/span&gt;, CONSTRAINT &lt;span class=&quot;code-quote&quot;&gt;&quot;SDS_FK2&quot;&lt;/span&gt; FOREIGN KEY (&lt;span class=&quot;code-quote&quot;&gt;&quot;CD_ID&quot;&lt;/span&gt;) REFERENCES &lt;span class=&quot;code-quote&quot;&gt;&quot;CDS&quot;&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&quot;CD_ID&quot;&lt;/span&gt;))
Caused by: java.sql.SQLIntegrityConstraintViolationException: Cannot delete or update a parent row: a foreign key constraint fails (&lt;span class=&quot;code-quote&quot;&gt;&quot;xxx&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;SDS&quot;&lt;/span&gt;, CONSTRAINT &lt;span class=&quot;code-quote&quot;&gt;&quot;SDS_FK2&quot;&lt;/span&gt; FOREIGN KEY (&lt;span class=&quot;code-quote&quot;&gt;&quot;CD_ID&quot;&lt;/span&gt;) REFERENCES &lt;span class=&quot;code-quote&quot;&gt;&quot;CDS&quot;&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&quot;CD_ID&quot;&lt;/span&gt;))

Caused by: java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (&lt;span class=&quot;code-quote&quot;&gt;&quot;xxx&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_PARAMS&quot;&lt;/span&gt;, CONSTRAINT &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_PARAMS_FK1&quot;&lt;/span&gt; FOREIGN KEY (&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt;) REFERENCES &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt;))
Caused by: java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (&lt;span class=&quot;code-quote&quot;&gt;&quot;xxx&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_PARAMS&quot;&lt;/span&gt;, CONSTRAINT &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_PARAMS_FK1&quot;&lt;/span&gt; FOREIGN KEY (&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt;) REFERENCES &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt;))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I was wondering if I can add a similar line under &quot;SDS&quot; in package.jdo.&lt;/p&gt;</comment>
                            <comment id="16896492" author="karthik.manamcheri" created="Tue, 30 Jul 2019 20:26:40 +0000"  >&lt;p&gt;Adding the foreign-key line to package.jdo should not affect functionality. It would affect performance because data nucleus cannot optimize effectively.&lt;/p&gt;</comment>
                            <comment id="17112885" author="ganeshas" created="Thu, 21 May 2020 07:50:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=karthik.manamcheri&quot; class=&quot;user-hover&quot; rel=&quot;karthik.manamcheri&quot;&gt;karthik.manamcheri&lt;/a&gt;&#160;&#160;FK constraint name is&#160;COLUMNS_V2_FK1 in all the metastore scripts. Shouldn&apos;t we specify FK constraint name as&#160;COLUMNS_V2_FK1 instead of&#160;COLUMNS_V2_FK in package.jdo?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13313222">HIVE-23756</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12970080" name="HIVE-19994.1.patch" size="708" author="karthik.manamcheri" created="Tue, 28 May 2019 21:30:41 +0000"/>
                            <attachment id="12929169" name="metastore_exception.txt" size="17663" author="Rodion Myronov" created="Tue, 26 Jun 2018 09:22:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 25 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3v8mv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>