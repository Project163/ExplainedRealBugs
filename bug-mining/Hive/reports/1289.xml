<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:06:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-4554] Failed to create a table from existing file if file path has spaces</title>
                <link>https://issues.apache.org/jira/browse/HIVE-4554</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;To reproduce the problem,&lt;/p&gt;

&lt;p&gt;1. Create a table, say, person_age (name STRING, age INT).&lt;br/&gt;
2. Create a file whose name has a space in it, say, &quot;data set.txt&quot;.&lt;br/&gt;
3. Try to load the date in the file to the table.&lt;/p&gt;

&lt;p&gt;The following error can be seen in the console:&lt;/p&gt;

&lt;p&gt;hive&amp;gt; LOAD DATA INPATH &apos;/home/xzhang/temp/data set.txt&apos; INTO TABLE person_age;&lt;br/&gt;
Loading data to table default.person_age&lt;br/&gt;
Failed with exception Wrong file format. Please check the file&apos;s format.&lt;br/&gt;
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MoveTask&lt;/p&gt;

&lt;p&gt;Note: the error message is confusing.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12647445">HIVE-4554</key>
            <summary>Failed to create a table from existing file if file path has spaces</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xuefuz">Xuefu Zhang</assignee>
                                    <reporter username="xuefuz">Xuefu Zhang</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 May 2013 04:37:54 +0000</created>
                <updated>Tue, 15 Oct 2013 23:28:46 +0000</updated>
                            <resolved>Thu, 6 Jun 2013 01:17:40 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.12.0</fixVersion>
                                    <component>CLI</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="13656723" author="xuefuz" created="Tue, 14 May 2013 04:43:30 +0000"  >&lt;p&gt;Patch attempting to fix the issue.&lt;/p&gt;</comment>
                            <comment id="13657374" author="xuefuz" created="Tue, 14 May 2013 18:53:48 +0000"  >&lt;p&gt;Updated the patch and added a test case.&lt;/p&gt;</comment>
                            <comment id="13672245" author="ashutoshc" created="Sat, 1 Jun 2013 21:33:31 +0000"  >&lt;p&gt;Few comments:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;In EximUtil.java changing relativeToAbsolutePath to return path instead of uri may not be a good idea. This function is also used by SemanticAnalyzer::createTable which uses it to get absolute location and then stores in metastore. If this is changed to return only path component we will loose scheme and authority.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Similarly LoadSemanticAnalyzer, line 149 its better to use toString, instead of path in error message, since location could be remote fs and hence scheme, authority, port etc. are useful info in the error message.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;At line 261, uri is not necessarily of local fs, so other components of url needs to be preserved, we shall use url here also.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I believe your test case will pass if you revert these changes and keep other changes. Can you test? Also, it will be better to create phabricator or RB entry for easier review.&lt;/p&gt;</comment>
                            <comment id="13672246" author="ashutoshc" created="Sat, 1 Jun 2013 21:34:41 +0000"  >&lt;p&gt;Canceling patch since there are review comments.&lt;/p&gt;</comment>
                            <comment id="13672512" author="xuefuz" created="Sun, 2 Jun 2013 13:57:55 +0000"  >&lt;p&gt;Thank you, Ashutosh.&lt;/p&gt;

&lt;p&gt;I have updated the batch using URIUtil.decode() to decode the special characters in the path instead of using getPath(), which does the decoding but causes the problems as you mentioned.&lt;/p&gt;</comment>
                            <comment id="13673680" author="xuefuz" created="Mon, 3 Jun 2013 22:18:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4554&quot; title=&quot;Failed to create a table from existing file if file path has spaces&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4554&quot;&gt;&lt;del&gt;HIVE-4554&lt;/del&gt;&lt;/a&gt;.patch.3 is the same as &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4554&quot; title=&quot;Failed to create a table from existing file if file path has spaces&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4554&quot;&gt;&lt;del&gt;HIVE-4554&lt;/del&gt;&lt;/a&gt;.patch.2 except that it includs the data input file for the new test case which was missing.&lt;/p&gt;

&lt;p&gt;All test case passed.&lt;/p&gt;

&lt;p&gt;RB request is here: &lt;a href=&quot;https://reviews.apache.org/r/11335/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/11335/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13673759" author="ashutoshc" created="Mon, 3 Jun 2013 23:15:38 +0000"  >&lt;p&gt;Comment on RB.&lt;/p&gt;</comment>
                            <comment id="13675305" author="xuefuz" created="Tue, 4 Jun 2013 21:50:08 +0000"  >&lt;p&gt;Patch is updated with new test case for loading HDFS file with special character (space) in the file name to a table.&lt;/p&gt;</comment>
                            <comment id="13675428" author="ashutoshc" created="Tue, 4 Jun 2013 23:37:46 +0000"  >&lt;p&gt;Thanks, Xuefu for testing that. &lt;br/&gt;
+1 will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13675985" author="ashutoshc" created="Wed, 5 Jun 2013 14:51:36 +0000"  >&lt;p&gt;TestMinimrCliDriver.schemeAuthority.q fails with exception {{ mkdir: cannot create directory hdfs:///tmp/test: File exists }} I think if you modify last line of your test to do dfs -rmr hdfs:///tmp/test that should be sufficient.&lt;/p&gt;</comment>
                            <comment id="13676463" author="xuefuz" created="Wed, 5 Jun 2013 23:16:44 +0000"  >&lt;p&gt;Patch is updated with the following change made to the test case in TestMinimrCliDriver:&lt;/p&gt;

&lt;p&gt;From:&lt;/p&gt;

&lt;p&gt;dfs -rmr hdfs:///tmp/test/load_file_with_space_in_the_name;&lt;/p&gt;

&lt;p&gt;to:&lt;/p&gt;

&lt;p&gt;dfs -rmr hdfs:///tmp/test;&lt;/p&gt;

&lt;p&gt;which should get ride of /tmp/test, allowing other test cases to create it again.&lt;/p&gt;</comment>
                            <comment id="13676568" author="ashutoshc" created="Thu, 6 Jun 2013 01:17:40 +0000"  >&lt;p&gt;Committed to trunk. Thanks, Xuefu!&lt;/p&gt;</comment>
                            <comment id="13676637" author="hudson" created="Thu, 6 Jun 2013 03:24:36 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #227 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/227/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/227/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4554&quot; title=&quot;Failed to create a table from existing file if file path has spaces&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4554&quot;&gt;&lt;del&gt;HIVE-4554&lt;/del&gt;&lt;/a&gt; : Failed to create a table from existing file if file path has spaces (Xuefu Zhang via Ashutosh Chauhan) (Revision 1490101)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
hashutosh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1490101&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1490101&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/build-common.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/person age.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/LoadSemanticAnalyzer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/load_file_with_space_in_the_name.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/load_hdfs_file_with_space_in_the_name.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/load_file_with_space_in_the_name.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/load_hdfs_file_with_space_in_the_name.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13677591" author="hudson" created="Thu, 6 Jun 2013 22:14:07 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #2131 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/2131/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/2131/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4554&quot; title=&quot;Failed to create a table from existing file if file path has spaces&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4554&quot;&gt;&lt;del&gt;HIVE-4554&lt;/del&gt;&lt;/a&gt; : Failed to create a table from existing file if file path has spaces (Xuefu Zhang via Ashutosh Chauhan) (Revision 1490101)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
hashutosh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1490101&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1490101&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/build-common.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/person age.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/LoadSemanticAnalyzer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/load_file_with_space_in_the_name.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/load_hdfs_file_with_space_in_the_name.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/load_file_with_space_in_the_name.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/load_hdfs_file_with_space_in_the_name.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13795805" author="ashutoshc" created="Tue, 15 Oct 2013 23:28:46 +0000"  >&lt;p&gt;This issue has been fixed and released as part of 0.12 release. If you find further issues, please create a new jira and link it to this one.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12583079" name="HIVE-4554.patch" size="746" author="xuefuz" created="Tue, 14 May 2013 04:43:30 +0000"/>
                            <attachment id="12583182" name="HIVE-4554.patch.1" size="4669" author="xuefuz" created="Tue, 14 May 2013 18:53:48 +0000"/>
                            <attachment id="12585759" name="HIVE-4554.patch.2" size="4199" author="xuefuz" created="Sun, 2 Jun 2013 13:54:35 +0000"/>
                            <attachment id="12585970" name="HIVE-4554.patch.3" size="4437" author="xuefuz" created="Mon, 3 Jun 2013 22:18:46 +0000"/>
                            <attachment id="12586187" name="HIVE-4554.patch.4" size="7954" author="xuefuz" created="Tue, 4 Jun 2013 21:50:08 +0000"/>
                            <attachment id="12586408" name="HIVE-4554.patch.5" size="7921" author="xuefuz" created="Wed, 5 Jun 2013 23:12:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>327801</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 6 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1kk3r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>328145</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>