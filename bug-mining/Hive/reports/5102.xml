<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:49:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-13278] Avoid FileNotFoundException when map/reduce.xml is not available</title>
                <link>https://issues.apache.org/jira/browse/HIVE-13278</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Many redundant &apos;File not found&apos; messages appeared in container log during query execution with Hive on Spark.&lt;br/&gt;
Certainly, it doesn&apos;t prevent the query from running successfully. So mark it as Minor currently.&lt;/p&gt;

&lt;p&gt;Error message example:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;16/03/14 01:45:06 INFO exec.Utilities: File not found: File does not exist: /tmp/hive/hadoop/2d378538-f5d3-493c-9276-c62dd6634fb4/hive_2016-03-14_01-44-16_835_623058724409492515-6/-mr-10010/0a6d0cae-1eb3-448c-883b-590b3b198a73/reduce.xml
        at org.apache.hadoop.hdfs.server.namenode.INodeFile.valueOf(INodeFile.java:66)
        at org.apache.hadoop.hdfs.server.namenode.INodeFile.valueOf(INodeFile.java:56)
        at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getBlockLocationsUpdateTimes(FSNamesystem.java:1932)
        at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getBlockLocationsInt(FSNamesystem.java:1873)
        at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getBlockLocations(FSNamesystem.java:1853)
        at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getBlockLocations(FSNamesystem.java:1825)
        at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.getBlockLocations(NameNodeRpcServer.java:565)
        at org.apache.hadoop.hdfs.server.namenode.AuthorizationProviderProxyClientProtocol.getBlockLocations(AuthorizationProviderProxyClientProtocol.java:87)
        at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.getBlockLocations(ClientNamenodeProtocolServerSideTranslatorPB.java:363)
        at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
        at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:617)
        at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1060)
        at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2086)
        at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2082)
        at java.security.AccessController.doPrivileged(Native Method)
        at javax.security.auth.Subject.doAs(Subject.java:415)
        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1671)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2080)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;Hive on Spark engine&lt;br/&gt;
Found based on :&lt;br/&gt;
Apache Hive 2.0.0&lt;br/&gt;
Apache Spark 1.6.0&lt;/p&gt;</environment>
        <key id="12949804">HIVE-13278</key>
            <summary>Avoid FileNotFoundException when map/reduce.xml is not available</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="csun">Chao Sun</assignee>
                                    <reporter username="xhao1">Xin Hao</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 Mar 2016 08:55:10 +0000</created>
                <updated>Fri, 21 Jul 2017 17:45:56 +0000</updated>
                            <resolved>Mon, 19 Dec 2016 23:45:37 +0000</resolved>
                                                    <fixVersion>2.3.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                                                                <comments>
                            <comment id="15194499" author="xuefuz" created="Tue, 15 Mar 2016 01:06:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xhao1&quot; class=&quot;user-hover&quot; rel=&quot;xhao1&quot;&gt;xhao1&lt;/a&gt;, to clarify, this problem doesn&apos;t prevent the query from running successfully, right? Thanks.&lt;/p&gt;</comment>
                            <comment id="15194503" author="xhao1" created="Tue, 15 Mar 2016 01:09:19 +0000"  >&lt;p&gt;Yes, this problem doesn&apos;t prevent the query from running successfully.&lt;/p&gt;</comment>
                            <comment id="15324449" author="belugabehr" created="Fri, 10 Jun 2016 13:25:33 +0000"  >&lt;p&gt;This problem does not seem specific to Spark.  I believe it happens when Hive starts a map-only MapReduce job. It doesn&apos;t generate a reduce.xml as there isn&apos;t a reduce phase, but later it tries to put reduce.xml in distributed cache when submitting the job, which cause this error.&lt;/p&gt;</comment>
                            <comment id="15355688" author="stakiar" created="Wed, 29 Jun 2016 19:17:24 +0000"  >&lt;p&gt;This was fixed in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11243&quot; title=&quot;Changing log level in Utilities.getBaseWork&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11243&quot;&gt;&lt;del&gt;HIVE-11243&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I don&apos;t have permissions to close this issue, but I think it can be resolved as Duplicate&lt;/p&gt;</comment>
                            <comment id="15356634" author="lirui" created="Thu, 30 Jun 2016 06:54:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11243&quot; title=&quot;Changing log level in Utilities.getBaseWork&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11243&quot;&gt;&lt;del&gt;HIVE-11243&lt;/del&gt;&lt;/a&gt; changes the log level. Is it possible to avoid such log?&lt;/p&gt;</comment>
                            <comment id="15357452" author="stakiar" created="Thu, 30 Jun 2016 16:49:49 +0000"  >&lt;p&gt;Ideally yes, but there are a few issues. The code that causes this exception is in the &lt;tt&gt;Utilities.getBaseWork&lt;/tt&gt; method. This method basically fetches the &lt;tt&gt;Path&lt;/tt&gt; to the plan file (e.g. &lt;tt&gt;reduce.xml&lt;/tt&gt;), and tries to de-serialize it. If the plan file does not exist, the code will throw a &lt;tt&gt;FileNotFoundException&lt;/tt&gt; which will then be caught and logged, and cause the method to return null. The problem is that the code doesn&apos;t differentiate between the scenarios where the plan file was accidentally deleted vs. no plan file was ever created in the first place (maybe a NPE gets thrown somewhere down the line, but there is guarantee). There is a comment in the code saying that the the &lt;tt&gt;FileNotFoundException&lt;/tt&gt; &quot;happens. e.g.: no reduce work.&quot;&lt;/p&gt;</comment>
                            <comment id="15358317" author="lirui" created="Fri, 1 Jul 2016 03:32:40 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stakiar&quot; class=&quot;user-hover&quot; rel=&quot;stakiar&quot;&gt;stakiar&lt;/a&gt; for the explanation. Then my question is can we avoid this on higher level? Specifically, why we need to call getReduceWork for map-only job?&lt;br/&gt;
One possible reason is we call &lt;tt&gt;HiveOutputFormatImpl.checkOutputSpecs -&amp;gt; Utilities.getMapRedWork&lt;/tt&gt;. I think that can be fixed, at least for HoS, because for HoS we shouldn&apos;t try to get both MapWork and ReduceWork from one JobConf.&lt;/p&gt;</comment>
                            <comment id="15361612" author="stakiar" created="Mon, 4 Jul 2016 17:14:56 +0000"  >&lt;p&gt;Yes, I agree avoiding this on a higher level would be best. Let me take a closer look into the code and see what I can find. Thanks!&lt;/p&gt;</comment>
                            <comment id="15363377" author="stakiar" created="Tue, 5 Jul 2016 22:15:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt; you are right. I debugged this some more, and found out the the &lt;tt&gt;FileNofFoundException&lt;/tt&gt; is caused by &lt;tt&gt;HiveOutputFormatImpl.checkOutputSpecs -&amp;gt; Utilities.getMapRedWork&lt;/tt&gt;. This happens even when running in MR mode.&lt;/p&gt;

&lt;p&gt;I can work on a fix, but I&apos;m not entirely sure how to modify the &lt;tt&gt;HiveOutputFormatImpl&lt;/tt&gt; class to fix this. Given a &lt;tt&gt;JobConf&lt;/tt&gt; object, is there any way to know if the current job corresponds to a Map-Only job?&lt;/p&gt;</comment>
                            <comment id="15363656" author="lirui" created="Wed, 6 Jul 2016 02:35:36 +0000"  >&lt;p&gt;My understanding is &lt;tt&gt;HiveOutputFormatImpl.checkOutputSpecs&lt;/tt&gt; only looks for FS operator. FS indicates the end of a job. So if we find FS in MapWork, it means this is a map-only job and then we don&apos;t have to look for ReduceWork.&lt;/p&gt;</comment>
                            <comment id="15364707" author="stakiar" created="Wed, 6 Jul 2016 17:35:19 +0000"  >&lt;p&gt;Makes sense! I will implement the change and create a Patch + RB!&lt;/p&gt;</comment>
                            <comment id="15364782" author="stakiar" created="Wed, 6 Jul 2016 18:13:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt; unfortunately, it seems that there are queries such as &lt;tt&gt;ANALYZE TABLE src COMPUTE STATISTICS&lt;/tt&gt; that spawn Map Only Jobs, but don&apos;t have a &lt;tt&gt;FileSinkOperator&lt;/tt&gt;. So I&apos;m not sure if that approach will work.&lt;/p&gt;

&lt;p&gt;Perhaps an alternative approach would be to set some type of flag in the &lt;tt&gt;JobConf&lt;/tt&gt; indicating if a job contains &lt;tt&gt;MapWork&lt;/tt&gt; or &lt;tt&gt;ReduceWork&lt;/tt&gt;. This way, a Job can know if it there is no reduce phase. This new logic can probably all be encapsulated in the &lt;tt&gt;Utilities&lt;/tt&gt; class.&lt;/p&gt;</comment>
                            <comment id="15365550" author="lirui" created="Thu, 7 Jul 2016 03:36:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stakiar&quot; class=&quot;user-hover&quot; rel=&quot;stakiar&quot;&gt;stakiar&lt;/a&gt; - it seems not worth the extra complexity to just avoid annoying logs. I suggest we just apply the current solution, which should fix most of the cases, right? We can figure out a complete fix if there&apos;s need in future. Makes sense?&lt;/p&gt;</comment>
                            <comment id="15366262" author="stakiar" created="Thu, 7 Jul 2016 15:14:53 +0000"  >&lt;p&gt;Yes, makes sense. The current solution should work for most cases.&lt;/p&gt;

&lt;p&gt;Thanks for all the help!&lt;/p&gt;</comment>
                            <comment id="15744091" author="xuefuz" created="Tue, 13 Dec 2016 04:09:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt;, I&apos;m not sure if I understand the conclusion here, so a summary would be great. Annoying log is one thing, but another, more important problem is that trying to read reduce.xml for map-only tasks puts load on namenode. I&apos;m wondering if it&apos;s possible to avoid making that call. Can you share your thoughts? Thanks.&lt;/p&gt;

&lt;p&gt;BTW, this seems happening to Hive on MR as well.&lt;/p&gt;</comment>
                            <comment id="15744366" author="lirui" created="Tue, 13 Dec 2016 06:45:24 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuefuz&quot; class=&quot;user-hover&quot; rel=&quot;xuefuz&quot;&gt;xuefuz&lt;/a&gt;, the conclusion is we somehow try to read reduce.xml for map-only job, and yes it happens to MR as well. The call path is &lt;tt&gt;HiveOutputFormatImpl.checkOutputSpecs -&amp;gt; Utilities.getMapRedWork&lt;/tt&gt;. The reason why HiveOutputFormatImpl needs to get the MapRedWork is it needs to do some check on all the FS operators. Since FS only exists at the end of a job, my suggestion is we firstly try to get MapWork. If the MapWork has an FS in it, it means this is a map-only job so we don&apos;t have to look for ReduceWork. But &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stakiar&quot; class=&quot;user-hover&quot; rel=&quot;stakiar&quot;&gt;stakiar&lt;/a&gt; found that some map-only job may not have FS in the MapWork, e.g. &lt;tt&gt;ANALYZE TABLE&lt;/tt&gt;. To have a complete fix, we&apos;ll need some flag in the JobConf indicating if this is map-only. Or we can use my solution, which solves the issue for most cases.&lt;/p&gt;

&lt;p&gt;Some special handling for HoS may be needed. For HoS, each map.xml and reduce.xml resides in a different path. We can use &lt;tt&gt;mapred.task.is.map&lt;/tt&gt; to determine whether the JobConf is for MapWork or ReduceWork. And then call getMapWork or getReduceWork respectively.&lt;/p&gt;</comment>
                            <comment id="15745219" author="xuefuz" created="Tue, 13 Dec 2016 13:53:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt;, thanks for the summary. Following your idea, can we first check if the mapwork ends a RS and use this to determine if reduce.xml is expected?&lt;/p&gt;</comment>
                            <comment id="15746813" author="csun" created="Wed, 14 Dec 2016 01:06:27 +0000"  >&lt;p&gt;I&apos;m also working on this issue and I think it&apos;s better to avoid unnecessary NN calls, especially the # of mappers is huge.&lt;br/&gt;
Attaching an initial patch, which adopts the idea of using a separate conf flag. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stakiar&quot; class=&quot;user-hover&quot; rel=&quot;stakiar&quot;&gt;stakiar&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ruili&quot; class=&quot;user-hover&quot; rel=&quot;ruili&quot;&gt;ruili&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuefuz&quot; class=&quot;user-hover&quot; rel=&quot;xuefuz&quot;&gt;xuefuz&lt;/a&gt; can you give a review on this?&lt;br/&gt;
(sorry I have to own this JIRA in order to attach).&lt;/p&gt;</comment>
                            <comment id="15746850" author="xuefuz" created="Wed, 14 Dec 2016 01:22:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stakiar&quot; class=&quot;user-hover&quot; rel=&quot;stakiar&quot;&gt;stakiar&lt;/a&gt;, let us know if you like to work on this. Otherwise, we will move this forward.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=csun&quot; class=&quot;user-hover&quot; rel=&quot;csun&quot;&gt;csun&lt;/a&gt;, thanks for working on this. I have two questions:&lt;br/&gt;
1. I saw ConditionalTask.hasReduce() is removed, which would change the semantics, right? I&apos;m not sure if this breaks anything.&lt;br/&gt;
2. For SparkTask, I assume it&apos;s possible to have two MapTasks: one ends at FS, while the other connects to a reduce task. Would the first MapTask is still going to hit hdfs for reduce.xml?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt;, please also take a look the approach. Thanks.&lt;/p&gt;</comment>
                            <comment id="15747021" author="hiveqa" created="Wed, 14 Dec 2016 02:44:01 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12843132/HIVE-13278.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12843132/HIVE-13278.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 39 failed/errored test(s), 10260 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestMiniLlapCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=133)
	[mapreduce2.q,orc_llap_counters1.q,bucket6.q,insert_into1.q,empty_dir_in_table.q,orc_merge1.q,script_env_var1.q,orc_merge_diff_fs.q,llapdecider.q,load_hdfs_file_with_space_in_the_name.q,llap_nullscan.q,orc_ppd_basic.q,transform_ppr1.q,rcfile_merge4.q,orc_merge3.q]
TestMiniLlapCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=134)
	[acid_bucket_pruning.q]
TestMiniLlapCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=135)
	[intersect_all.q,unionDistinct_1.q,orc_ppd_schema_evol_3a.q,table_nonprintable.q,tez_union_dynamic_partition.q,transform_ppr2.q,temp_table_external.q,global_limit.q,transform2.q,schemeAuthority.q,cte_2.q,rcfile_createas1.q,dynamic_partition_pruning_2.q,intersect_merge.q,transform1.q]
TestMiniLlapCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=136)
	[script_pipe.q,import_exported_table.q,except_distinct.q,orc_merge10.q,mapreduce1.q,explainuser_2.q,orc_merge4.q,rcfile_merge2.q,bucket5.q,llap_udf.q,external_table_with_space_in_location_path.q,load_fs2.q,script_env_var2.q,intersect_distinct.q,remote_script.q]
TestMiniLlapCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=137)
	[orc_merge2.q,insert_into2.q,reduce_deduplicate.q,orc_llap_counters.q,cte_4.q,schemeAuthority2.q,file_with_header_footer.q,rcfile_merge3.q]
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=138)
	[join1.q,schema_evol_orc_acidvec_table_update.q,vector_decimal_5.q,insert_values_tmp_table.q,join32_lessSize.q,escape1.q,orc_predicate_pushdown.q,tez_union2.q,cte_mat_5.q,cte_mat_4.q,groupby3.q,smb_mapjoin_19.q,join46.q,dynpart_sort_optimization2.q,tez_bmj_schema_evolution.q,bucketmapjoin4.q,vector_include_no_sel.q,uber_reduce.q,schema_evol_orc_nonvec_part_all_complex.q,vector_interval_arithmetic.q,bucketsortoptimize_insert_2.q,smb_mapjoin_17.q,auto_sortmerge_join_3.q,vectorization_9.q,merge2.q,join_nulls.q,bucketsortoptimize_insert_6.q,ctas.q,cbo_udf_udaf.q,bucketmapjoin2.q]
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=139)
	[skewjoinopt15.q,vector_coalesce.q,orc_ppd_decimal.q,cbo_rp_lineage2.q,insert_into_with_schema.q,join_emit_interval.q,load_dyn_part3.q,auto_sortmerge_join_14.q,vector_null_projection.q,vector_cast_constant.q,mapjoin2.q,bucket_map_join_tez2.q,correlationoptimizer4.q,vectorization_12.q,vector_number_compare_projection.q,orc_merge_incompat3.q,vector_leftsemi_mapjoin.q,update_all_non_partitioned.q,multi_column_in_single.q,schema_evol_orc_nonvec_table.q,cbo_rp_subq_in.q,cbo_rp_semijoin.q,tez_insert_overwrite_local_directory_1.q,schema_evol_text_vecrow_table.q,vector_count.q,auto_sortmerge_join_15.q,vector_if_expr.q,delete_whole_partition.q,vector_decimal_6.q,sample1.q]
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=140)
	[bucket3.q,schema_evol_text_nonvec_table.q,mrr.q,orc_ppd_schema_evol_2b.q,orc_analyze.q,schema_evol_orc_acidvec_part_update.q,cbo_simple_select.q,cbo_rp_udf_udaf_stats_opt.q,subquery_views.q,multi_column_in.q,vector_interval_1.q,tez_join_result_complex.q,groupby1.q,ptf_matchpath.q,cbo_rp_udf_udaf.q,vector_decimal_aggregate.q,constprog_dpp.q,leftsemijoin_mr.q,unionDistinct_2.q,vectorization_14.q,update_all_types.q,cbo_stats.q,auto_sortmerge_join_6.q,vector_decimal_3.q,vector_groupby4.q,ptf.q,update_where_non_partitioned.q,insert_dir_distcp.q,vectorized_nested_mapjoin.q,schema_evol_text_nonvec_part.q]
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=141)
	[insert_values_non_partitioned.q,union5.q,vectorized_math_funcs.q,vectorization_4.q,vectorization_2.q,vector_join_nulls.q,vector_decimal_math_funcs.q,vector_left_outer_join.q,tez_union_decimal.q,llap_partitioned.q,order_null.q,cbo_rp_views.q,smb_mapjoin_4.q,vector_date_1.q,lvj_mapjoin.q,partition_multilevels.q,varchar_udf1.q,select_dummy_source.q,limit_join_transpose.q,tez_multi_union.q,skewjoin.q,cte_mat_3.q,autoColumnStats_1.q,vector_decimal_round_2.q,semijoin.q,column_names_with_leading_and_trailing_spaces.q,update_two_cols.q,update_where_no_match.q,union_stats.q,authorization_2.q]
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=142)
	[acid_vectorization_missing_cols.q,orc_merge9.q,vector_acid3.q,delete_where_no_match.q,vector_reduce1.q,stats_only_null.q,vectorization_part_project.q,vectorization_6.q,count.q,tez_vector_dynpart_hashjoin_2.q,parallel.q,delete_all_non_partitioned.q,delete_all_partitioned.q,vectorization_10.q,insert1.q,custom_input_output_format.q,vectorized_bucketmapjoin1.q,cbo_rp_windowing_2.q,vector_reduce3.q,smb_cache.q,hybridgrace_hashjoin_1.q,vector_count_distinct.q,schema_evol_orc_acid_part.q,hybridgrace_hashjoin_2.q,cross_join.q,parquet_predicate_pushdown.q,vector_varchar_mapjoin1.q,tez_smb_main.q,quotedid_smb.q,vector_bucket.q]
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=143)
	[list_bucket_dml_10.q,mapjoin_emit_interval.q,acid_globallimit.q,vector_auto_smb_mapjoin_14.q,deleteAnalyze.q,database.q,smb_mapjoin_6.q,vector_reduce_groupby_decimal.q,vectorized_dynamic_partition_pruning.q,cbo_views.q,vectorization_part.q,auto_join30.q,dynamic_partition_pruning.q,cte_mat_1.q,cluster.q,vector_char_mapjoin1.q,bucketmapjoin7.q,vector_string_concat.q,cbo_rp_unionDistinct_2.q,limit_pushdown3.q,vector_outer_join2.q,smb_mapjoin_18.q,vector_varchar_4.q,vectorized_context.q,metadata_only_queries.q,ppd_union_view.q,union6.q,vector_decimal_4.q,cbo_subq_in.q,vectorized_timestamp_funcs.q]
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=144)
	[vectorized_rcfile_columnar.q,vector_elt.q,explainuser_1.q,multi_insert.q,tez_dml.q,vector_bround.q,schema_evol_orc_acid_table.q,vector_when_case_null.q,orc_ppd_schema_evol_1b.q,vector_join30.q,vectorization_11.q,cte_3.q,update_tmp_table.q,vector_decimal_cast.q,groupby_grouping_id2.q,vector_decimal_round.q,tez_smb_empty.q,orc_merge6.q,vector_decimal_trailing.q,cte_5.q,tez_union.q,cbo_rp_subq_not_in.q,vector_decimal_2.q,columnStatsUpdateForStatsOptimizer_1.q,vector_outer_join3.q,schema_evol_text_vec_part_all_complex.q,tez_dynpart_hashjoin_2.q,auto_sortmerge_join_12.q,offset_limit.q,tez_union_multiinsert.q]
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=145)
	[enforce_order.q,tez_dynpart_hashjoin_3.q,vectorization_7.q,tez_join.q,orc_ppd_schema_evol_1a.q,groupby_resolution.q,delete_where_non_partitioned.q,orc_merge11.q,subquery_exists.q,cbo_semijoin.q,schema_evol_orc_vec_table.q,mergejoin_3way.q,ppr_pushdown.q,orc_llap_nonvector.q,vector_reduce2.q,vector_interval_mapjoin.q,vectorization_16.q,tez_joins_explain.q,explainuser_4.q,create_merge_compressed.q,vector_aggregate_9.q,alter_merge_stats_orc.q,vectorization_not.q,windowing_gby.q,vectorization_part_varchar.q,having.q,vector_orderby_5.q,vector_outer_join6.q,delete_where_partitioned.q,union9.q]
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=146)
	[load_dyn_part5.q,vector_complex_join.q,orc_llap.q,vectorization_pushdown.q,cbo_gby_empty.q,vectorization_short_regress.q,cbo_gby.q,auto_sortmerge_join_1.q,lineage3.q,cross_product_check_1.q,cbo_join.q,vector_struct_in.q,bucketmapjoin3.q,current_date_timestamp.q,orc_ppd_schema_evol_2a.q,groupby2.q,schema_evol_text_vec_table.q,vectorized_join46.q,orc_ppd_date.q,multiMapJoin1.q,sample10.q,vector_outer_join1.q,vector_char_simple.q,dynpart_sort_optimization_acid.q,auto_sortmerge_join_2.q,bucketizedhiveinputformat.q,leftsemijoin.q,special_character_in_tabnames_1.q,cte_mat_2.q,vectorization_8.q]
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=147)
	[vectorized_parquet.q,vector_decimal_expressions.q,union_fast_stats.q,correlationoptimizer2.q,cbo_subq_not_in.q,identity_project_remove_skip.q,windowing.q,delete_tmp_table.q,bucket2.q,vector_aggregate_without_gby.q,schema_evol_text_nonvec_part_all_primitive.q,correlationoptimizer6.q,alter_table_invalidate_column_stats.q,union_remove_26.q,orc_create.q,vector_distinct_2.q,cbo_rp_limit.q,vectorization_13.q,mapjoin_mapjoin.q,update_all_partitioned.q,union2.q,vector_decimal_precision.q,dynpart_sort_opt_vectorization.q,exchgpartition2lel.q,dynpart_sort_optimization.q,vectorized_timestamp_ints_casts.q,tez_join_hash.q,multi_insert_lateral_view.q,non_native_window_udf.q,schema_evol_orc_vec_part_all_complex.q]
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=148)
	[bucketsortoptimize_insert_7.q,cbo_windowing.q,load_dyn_part2.q,parquet_types.q,vectorization_5.q,schema_evol_stats.q,mapjoin46.q,column_access_stats.q,vector_between_in.q,merge1.q,cbo_rp_join.q,vectorized_string_funcs.q,vectorization_1.q,vector_coalesce_3.q,stats_noscan_1.q,vector_partition_diff_num_cols.q,vector_decimal_10_0.q,orc_merge5.q,bucketmapjoin6.q,vector_udf1.q,schema_evol_text_vec_part.q,vector_groupby_reduce.q,union8.q,lineage2.q,auto_sortmerge_join_16.q,auto_join29.q,correlationoptimizer1.q,vector_decimal_mapjoin.q,ptf_streaming.q,vectorized_case.q]
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=149)
	[auto_sortmerge_join_13.q,union_top_level.q,vector_left_outer_join2.q,schema_evol_text_vecrow_part_all_primitive.q,constprog_semijoin.q,update_where_partitioned.q,drop_partition_with_stats.q,smb_mapjoin_14.q,skiphf_aggr.q,vectorized_ptf.q,auto_join_filters.q,join0.q,insert_orig_table.q,mergejoin.q,join_filters.q,orc_split_elimination.q,subquery_in.q,vector_outer_join0.q,schema_evol_text_vec_part_all_primitive.q,vector_complex_all.q,auto_sortmerge_join_4.q,bucket_many.q,vectorization_15.q,union3.q,vectorization_nested_udf.q,windowing_windowspec2.q,auto_smb_mapjoin_14.q,vector_mr_diff_schema_alias.q,vector_join_filters.q,reduce_deduplicate_extended.q]
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=150)
	[vector_interval_2.q,schema_evol_orc_acid_table_update.q,schema_evol_orc_acid_part_update.q,orc_ppd_varchar.q,metadataonly1.q,limit_pushdown.q,auto_join_nulls.q,metadata_only_queries_with_filters.q,vector_inner_join.q,subquery_notin.q,schema_evol_text_nonvec_part_all_complex.q,vector_coalesce_2.q,alter_merge_orc.q,vector_between_columns.q,vector_char_cast.q,table_access_keys_stats.q,udaf_collect_set_2.q,update_after_multiple_inserts.q,offset_limit_ppd_optimizer.q,mapjoin_decimal.q,orc_merge_incompat1.q,columnstats_part_coltype.q,vectorized_parquet_types.q,union7.q,vector_char_2.q,schema_evol_orc_acidvec_part.q,vector_groupby_3.q,cbo_rp_gby.q,extrapolate_part_stats_partial_ndv.q,auto_sortmerge_join_9.q]
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=151)
	[smb_mapjoin_15.q,insert_values_partitioned.q,selectDistinctStar.q,bucket4.q,vectorized_distinct_gby.q,vector_groupby_mapjoin.q,insert_values_dynamic_partitioned.q,vector_nvl.q,join_nullsafe.q,vectorized_mapjoin.q,schema_evol_orc_vec_part_all_primitive.q,vectorized_shufflejoin.q,tez_smb_1.q,cbo_union.q,tez_vector_dynpart_hashjoin_1.q,filter_join_breaktask2.q,vector_data_types.q,multiMapJoin2.q,filter_join_breaktask.q,schema_evol_orc_nonvec_part.q,alter_merge_2_orc.q,vectorization_3.q,union4.q,auto_sortmerge_join_8.q,stats_based_fetch_decision.q,disable_merge_for_bucketing.q,vectorized_date_funcs.q,auto_sortmerge_join_10.q,vector_varchar_simple.q,vector_decimal_udf2.q]
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=152)
	[tez_union_group_by.q,auto_join1.q,escape2.q,tez_dynpart_hashjoin_1.q,correlationoptimizer3.q,vectorized_timestamp.q,cbo_subq_exists.q,vector_binary_join_groupby.q,lateral_view.q,vectorization_0.q,infer_bucket_sort_bucketed_table.q,optimize_nullscan.q,nonmr_fetch_threshold.q,vectorization_decimal_date.q,vectorized_casts.q,schema_evol_orc_vec_part.q,tez_self_join.q,vector_partitioned_date_time.q,schema_evol_text_vecrow_part_all_complex.q,tez_fsstat.q,stats11.q,vector_mapjoin_reduce.q,tez_join_tests.q,join_acid_non_acid.q,empty_join.q,auto_join21.q,schema_evol_text_vecrow_part.q,orc_ppd_timestamp.q,vector_decimal_1.q,vector_adaptor_usage_mode.q]
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=153)
	[tez_schema_evolution.q,bucket_map_join_tez1.q,vector_multi_insert.q,insert_update_delete.q,temp_table.q,cross_product_check_2.q,cte_1.q,autoColumnStats_2.q,vectorization_17.q,orc_merge8.q,orc_merge_incompat2.q,bucket_groupby.q,vector_outer_join4.q,vector_nullsafe_join.q,orc_merge7.q,vector_decimal_udf.q,bucketpruning1.q,schema_evol_orc_acidvec_table.q,vector_grouping_sets.q,vector_outer_join5.q,vector_groupby6.q,bucketmapjoin1.q,smb_mapjoin_5.q,vector_char_4.q,auto_sortmerge_join_5.q,auto_join0.q,cbo_limit.q,load_dyn_part1.q,schema_evol_orc_nonvec_part_all_primitive.q,auto_sortmerge_join_11.q]
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=154)
	[auto_sortmerge_join_7.q,input16_cc.q]
TestVectorizedColumnReaderBase - did not produce a TEST-*.xml file (likely timed out) (batchId=251)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample2] (batchId=5)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample4] (batchId=15)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample6] (batchId=61)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample7] (batchId=60)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample9] (batchId=38)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.org.apache.hadoop.hive.cli.TestMiniTezCliDriver (batchId=92)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.org.apache.hadoop.hive.cli.TestMiniTezCliDriver (batchId=93)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query39] (batchId=222)
org.apache.hadoop.hive.ql.TestAcidOnTez.testMapJoinOnTez (batchId=203)
org.apache.hadoop.hive.ql.TestAcidOnTez.testMergeJoinOnTez (batchId=203)
org.apache.hadoop.hive.ql.TestAcidOnTezWithSplitUpdate.testMapJoinOnTez (batchId=206)
org.apache.hadoop.hive.ql.TestAcidOnTezWithSplitUpdate.testMergeJoinOnTez (batchId=206)
org.apache.hive.service.cli.operation.TestOperationLoggingAPIWithTez.testFetchResultsOfLogWithExecutionMode (batchId=211)
org.apache.hive.service.cli.operation.TestOperationLoggingAPIWithTez.testFetchResultsOfLogWithNoneMode (batchId=211)
org.apache.hive.service.cli.operation.TestOperationLoggingAPIWithTez.testFetchResultsOfLogWithPerformanceMode (batchId=211)
org.apache.hive.service.cli.operation.TestOperationLoggingAPIWithTez.testFetchResultsOfLogWithVerboseMode (batchId=211)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/2566/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/2566/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/2566/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/2566/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-2566/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-2566/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 39 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12843132 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15747031" author="lirui" created="Wed, 14 Dec 2016 02:51:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=csun&quot; class=&quot;user-hover&quot; rel=&quot;csun&quot;&gt;csun&lt;/a&gt;, thanks for the patch. I think Xuefu&apos;s concerns are valid. In SparkPlanGenerator, we clone JobConf for each BaseWork. So we can set the flag separately for each of them.&lt;br/&gt;
Actually I&apos;m still not very clear when will &lt;tt&gt;HiveOutputFormatImpl.checkOutputSpecs&lt;/tt&gt; be called. My understanding is, since HoS stores the plan file in different paths for different BaseWork, we can never get both MapWork and ReduceWork from a single JobConf. That means for HoS, we should always hit the FNF error. Or we should see FNF error for map.xml as well. It&apos;ll be better if we figure out these first.&lt;/p&gt;</comment>
                            <comment id="15747241" author="csun" created="Wed, 14 Dec 2016 04:38:50 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuefuz&quot; class=&quot;user-hover&quot; rel=&quot;xuefuz&quot;&gt;xuefuz&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt;, I think you are right. Let me revise the patch.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt;, to your question. I think for HoS the &lt;tt&gt;checkOutputSpecs&lt;/tt&gt; is only called in &lt;tt&gt;SparkPlanGenerator&lt;/tt&gt;, as discussed in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-10073&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-10073&lt;/a&gt;.&lt;br/&gt;
Also this only triggers for non-native storage (e.g., HBase), so we don&apos;t normally see it.&lt;/p&gt;
</comment>
                            <comment id="15747301" author="csun" created="Wed, 14 Dec 2016 05:12:20 +0000"  >&lt;p&gt;Actually for HoS besides &lt;tt&gt;checkOutputSpecs&lt;/tt&gt; I can&apos;t think of any case where we&apos;ll get the FileNotFoundException. &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xhao1&quot; class=&quot;user-hover&quot; rel=&quot;xhao1&quot;&gt;xhao1&lt;/a&gt;, do you still have the query that caused this issue? did this happen with some non-native storage such as HBase?&lt;/p&gt;</comment>
                            <comment id="15747342" author="xuefuz" created="Wed, 14 Dec 2016 05:33:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=csun&quot; class=&quot;user-hover&quot; rel=&quot;csun&quot;&gt;csun&lt;/a&gt;, please feel free to address MR case first if we need more time for HoS case. Thanks. &lt;/p&gt;</comment>
                            <comment id="15747376" author="stakiar" created="Wed, 14 Dec 2016 05:53:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=csun&quot; class=&quot;user-hover&quot; rel=&quot;csun&quot;&gt;csun&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuefuz&quot; class=&quot;user-hover&quot; rel=&quot;xuefuz&quot;&gt;xuefuz&lt;/a&gt; yes feel free to move this patch forward. Thanks.&lt;/p&gt;</comment>
                            <comment id="15747409" author="csun" created="Wed, 14 Dec 2016 06:10:10 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stakiar&quot; class=&quot;user-hover&quot; rel=&quot;stakiar&quot;&gt;stakiar&lt;/a&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15747436" author="lirui" created="Wed, 14 Dec 2016 06:25:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=csun&quot; class=&quot;user-hover&quot; rel=&quot;csun&quot;&gt;csun&lt;/a&gt;, I think the error is found in container&apos;s log. SparkPlanGenerator runs in AM in yarn-cluster mode. If we find the error in any container other than AM, it means we somehow call the method on task side. I think Spark may call it too, e.g. in &lt;tt&gt;PairRDDFunctions::saveAsHadoopDataset&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="15747467" author="hiveqa" created="Wed, 14 Dec 2016 06:42:24 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12843156/HIVE-13278.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12843156/HIVE-13278.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 12 failed/errored test(s), 10814 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestVectorizedColumnReaderBase - did not produce a TEST-*.xml file (likely timed out) (batchId=251)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample2] (batchId=5)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample4] (batchId=15)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample6] (batchId=61)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample7] (batchId=60)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample9] (batchId=38)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[orc_ppd_basic] (batchId=133)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[transform_ppr2] (batchId=135)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[metadataonly1] (batchId=150)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[stats_based_fetch_decision] (batchId=151)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=93)
org.apache.hive.service.server.TestHS2HttpServer.testContextRootUrlRewrite (batchId=186)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/2569/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/2569/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/2569/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/2569/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-2569/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-2569/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 12 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12843156 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15747588" author="hiveqa" created="Wed, 14 Dec 2016 07:51:32 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12843161/HIVE-13278.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12843161/HIVE-13278.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 13 failed/errored test(s), 10784 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=144)
	[vectorized_rcfile_columnar.q,vector_elt.q,explainuser_1.q,multi_insert.q,tez_dml.q,vector_bround.q,schema_evol_orc_acid_table.q,vector_when_case_null.q,orc_ppd_schema_evol_1b.q,vector_join30.q,vectorization_11.q,cte_3.q,update_tmp_table.q,vector_decimal_cast.q,groupby_grouping_id2.q,vector_decimal_round.q,tez_smb_empty.q,orc_merge6.q,vector_decimal_trailing.q,cte_5.q,tez_union.q,cbo_rp_subq_not_in.q,vector_decimal_2.q,columnStatsUpdateForStatsOptimizer_1.q,vector_outer_join3.q,schema_evol_text_vec_part_all_complex.q,tez_dynpart_hashjoin_2.q,auto_sortmerge_join_12.q,offset_limit.q,tez_union_multiinsert.q]
TestVectorizedColumnReaderBase - did not produce a TEST-*.xml file (likely timed out) (batchId=251)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample2] (batchId=5)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample4] (batchId=15)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample6] (batchId=61)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample7] (batchId=60)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample9] (batchId=38)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[orc_ppd_basic] (batchId=133)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[transform_ppr2] (batchId=135)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[metadataonly1] (batchId=150)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[stats_based_fetch_decision] (batchId=151)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=93)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_4] (batchId=93)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/2570/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/2570/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/2570/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/2570/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-2570/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-2570/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 13 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12843161 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15748950" author="csun" created="Wed, 14 Dec 2016 17:43:55 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt;. I think in Hive 2.x &lt;tt&gt;SparkPlanGenerator&lt;/tt&gt; is the only likely place where the FileNotFound issue could be triggered, while in older versions of Hive (e.g., 1.1.0) it could be triggered in some other places.&lt;br/&gt;
I&apos;ve attached a new patch, which I checked with some simple MR &amp;amp; Spark queries. Didn&apos;t see any FileNotFound message with the patch applied. Also, I don&apos;t think the test failures are related.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuefuz&quot; class=&quot;user-hover&quot; rel=&quot;xuefuz&quot;&gt;xuefuz&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stakiar&quot; class=&quot;user-hover&quot; rel=&quot;stakiar&quot;&gt;stakiar&lt;/a&gt;, could you take a look if you have time? Thanks.&lt;/p&gt;</comment>
                            <comment id="15749097" author="xuefuz" created="Wed, 14 Dec 2016 18:42:49 +0000"  >&lt;p&gt;I like the new patch, which takes a simpler, easy-to-understand approach. On the other hand, this approach requires that planner set the flags correctly in order to avoid FNF problem, which shouldn&apos;t be an issue.&lt;/p&gt;

&lt;p&gt;Though not essential, I noticed there are are a few cases where planers such as PartialScanTask.execute() set 0 as the number of reducers (no reducers), which might be better to set the flag as well. However, I think we can have a separate JIRA for thos.&lt;/p&gt;

&lt;p&gt;+1 on my side. Please also provide your review feedback, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt;. Thanks.&lt;/p&gt;</comment>
                            <comment id="15749236" author="csun" created="Wed, 14 Dec 2016 19:28:52 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuefuz&quot; class=&quot;user-hover&quot; rel=&quot;xuefuz&quot;&gt;xuefuz&lt;/a&gt;, I think you&apos;re right, for MR, we need to set the flag for any place where a &lt;tt&gt;submitJob&lt;/tt&gt; is called. Otherwise the control flow will go to &lt;tt&gt;checkOutputSpecs -&amp;gt; getMapRedWork()&lt;/tt&gt; and trigger FNF.&lt;br/&gt;
I think I missed two places: &lt;tt&gt;PartialScanTask&lt;/tt&gt; and &lt;tt&gt;ColumnTruncateTask&lt;/tt&gt;. Attaching patch v3 to address that.&lt;/p&gt;</comment>
                            <comment id="15749512" author="hiveqa" created="Wed, 14 Dec 2016 21:20:32 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12843278/HIVE-13278.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12843278/HIVE-13278.3.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 10 failed/errored test(s), 10813 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestVectorizedColumnReaderBase - did not produce a TEST-*.xml file (likely timed out) (batchId=251)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample2] (batchId=5)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample4] (batchId=15)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample6] (batchId=61)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample7] (batchId=60)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample9] (batchId=38)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[orc_ppd_schema_evol_3a] (batchId=135)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[transform_ppr2] (batchId=135)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[metadataonly1] (batchId=150)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[stats_based_fetch_decision] (batchId=151)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/2578/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/2578/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/2578/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/2578/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-2578/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-2578/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 10 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12843278 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15749533" author="xuefuz" created="Wed, 14 Dec 2016 21:25:42 +0000"  >&lt;p&gt;+1 on patch #3.&lt;/p&gt;</comment>
                            <comment id="15750452" author="lirui" created="Thu, 15 Dec 2016 05:39:18 +0000"  >&lt;p&gt;Sorry about the delay. I have a concern about using flag: it seems difficult to make it exhaustive and maintain. What about the solution Xuefu mentioned:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Following your idea, can we first check if the mapwork ends a RS and use this to determine if reduce.xml is expected?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Will this be cleaner and more reliable?&lt;/p&gt;</comment>
                            <comment id="15750533" author="xuefuz" created="Thu, 15 Dec 2016 06:24:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt;, the concern is valid and shared, but on the other hand the current approach is simple and easy to understand. At least, the could be new cases where the problem may appear, but this doesn&apos;t make it worse and we don&apos;t expect too many such cases now or in the future.&lt;/p&gt;

&lt;p&gt;Further thoughts?&lt;/p&gt;</comment>
                            <comment id="15750696" author="lirui" created="Thu, 15 Dec 2016 07:51:20 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuefuz&quot; class=&quot;user-hover&quot; rel=&quot;xuefuz&quot;&gt;xuefuz&lt;/a&gt;, I just think it&apos;ll be even simpler to go the checking RS way - we can constrain the fix in just one method &lt;tt&gt;HiveOutputFormatImpl.checkOutputSpecs&lt;/tt&gt;, rather than making changes to all these different tasks. Besides, with the flag it seems we&apos;re adding extra burden to ourselves to keep the logic consistent during plan generation.&lt;/p&gt;

&lt;p&gt;On the other hand, if we decide to add the flag, I also have one suggestion. We can make &lt;tt&gt;has.map/reduce.work&lt;/tt&gt; default to false. And we set them to true respectively in &lt;tt&gt;Utilities::setMapWork/setReduceWork&lt;/tt&gt;. The logic behind this is if you haven&apos;t set a work with the JobConf, you shouldn&apos;t try to get one from it. Does this make sense?&lt;/p&gt;</comment>
                            <comment id="15750793" author="csun" created="Thu, 15 Dec 2016 08:42:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt; sorry I didn&apos;t see your post about using the RS for this. I think this solution also looks good.&lt;br/&gt;
Note that for the flag approach is we can also set it in Task#initialize(), instead of setting it in different tasks.&lt;br/&gt;
This could make it cleaner.&lt;/p&gt;

&lt;p&gt;For setting the default value to false, I think it may interrupt some Tez queries, which also calls the &lt;tt&gt;getMapRedWork&lt;/tt&gt;&lt;br/&gt;
method. This patch doesn&apos;t handle Tez.&lt;/p&gt;</comment>
                            <comment id="15750856" author="lirui" created="Thu, 15 Dec 2016 09:13:41 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=csun&quot; class=&quot;user-hover&quot; rel=&quot;csun&quot;&gt;csun&lt;/a&gt;, I think Tez also calls setMapWork/setReduceWork to associate the work with the JobConf. Could you have a try? If it works, the fix will be transparent to different tasks. Thanks!&lt;/p&gt;</comment>
                            <comment id="15751899" author="xuefuz" created="Thu, 15 Dec 2016 17:11:56 +0000"  >&lt;p&gt;Yeah, let&apos;s try &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt;&apos;s idea to cover more cases if possible. It&apos;s important to note that the current patch is at least improving Hive (might incomplete) and does no harm.&lt;/p&gt;</comment>
                            <comment id="15752333" author="csun" created="Thu, 15 Dec 2016 19:49:34 +0000"  >&lt;p&gt;Thanks guys. Attaching patch v4 following &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt;&apos;s idea. Please take a look.&lt;/p&gt;</comment>
                            <comment id="15753034" author="hiveqa" created="Fri, 16 Dec 2016 00:59:22 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12843458/HIVE-13278.4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12843458/HIVE-13278.4.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 13 failed/errored test(s), 10788 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestDerbyConnector - did not produce a TEST-*.xml file (likely timed out) (batchId=234)
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=144)
	[vectorized_rcfile_columnar.q,vector_elt.q,explainuser_1.q,multi_insert.q,tez_dml.q,vector_bround.q,schema_evol_orc_acid_table.q,vector_when_case_null.q,orc_ppd_schema_evol_1b.q,vector_join30.q,vectorization_11.q,cte_3.q,update_tmp_table.q,vector_decimal_cast.q,groupby_grouping_id2.q,vector_decimal_round.q,tez_smb_empty.q,orc_merge6.q,vector_decimal_trailing.q,cte_5.q,tez_union.q,cbo_rp_subq_not_in.q,vector_decimal_2.q,columnStatsUpdateForStatsOptimizer_1.q,vector_outer_join3.q,schema_evol_text_vec_part_all_complex.q,tez_dynpart_hashjoin_2.q,auto_sortmerge_join_12.q,offset_limit.q,tez_union_multiinsert.q]
TestVectorizedColumnReaderBase - did not produce a TEST-*.xml file (likely timed out) (batchId=251)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample2] (batchId=5)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample4] (batchId=15)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample6] (batchId=61)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample7] (batchId=60)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample9] (batchId=38)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[udf_sort_array] (batchId=59)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[transform_ppr2] (batchId=135)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[metadataonly1] (batchId=150)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[stats_based_fetch_decision] (batchId=151)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=93)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/2599/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/2599/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/2599/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/2599/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-2599/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-2599/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 13 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12843458 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15753143" author="lirui" created="Fri, 16 Dec 2016 01:56:09 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=csun&quot; class=&quot;user-hover&quot; rel=&quot;csun&quot;&gt;csun&lt;/a&gt;, sorry maybe I was being misleading. What I have in mind is something like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-comment&quot;&gt;// In Utilities::setMapWork
&lt;/span&gt;  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Path setMapWork(Configuration conf, MapWork w, Path hiveScratchDir, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; useCache) {
    conf.setBoolean(HAS_MAP_WORK, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; setBaseWork(conf, w, hiveScratchDir, MAP_PLAN_NAME, useCache);
  }

  &lt;span class=&quot;code-comment&quot;&gt;// In Utilities::getMapWork
&lt;/span&gt;  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; MapWork getMapWork(Configuration conf) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!conf.getBoolean(HAS_MAP_WORK, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)) {
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
    }
    ....
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Similar for set/get ReduceWork. So if we haven&apos;t called set work, we&apos;ll just get null when getting the work. Do you think it makes sense?&lt;/p&gt;</comment>
                            <comment id="15755045" author="csun" created="Fri, 16 Dec 2016 17:41:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt; Yes I think this solution should work and is much more clean! Thanks for the suggestion. Attaching patch v5 to test.&lt;/p&gt;</comment>
                            <comment id="15755255" author="hiveqa" created="Fri, 16 Dec 2016 19:04:02 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12843621/HIVE-13278.5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12843621/HIVE-13278.5.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 20 failed/errored test(s), 10820 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestDerbyConnector - did not produce a TEST-*.xml file (likely timed out) (batchId=234)
TestVectorizedColumnReaderBase - did not produce a TEST-*.xml file (likely timed out) (batchId=251)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample2] (batchId=5)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample4] (batchId=15)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample6] (batchId=61)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample7] (batchId=60)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample9] (batchId=39)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[udf_sort_array] (batchId=59)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[transform_ppr2] (batchId=135)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[metadataonly1] (batchId=150)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[stats_based_fetch_decision] (batchId=151)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_1] (batchId=92)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=93)
org.apache.hadoop.hive.ql.io.orc.TestInputOutputFormat.testCombinationInputFormat (batchId=254)
org.apache.hadoop.hive.ql.io.orc.TestInputOutputFormat.testCombinationInputFormatWithAcid (batchId=254)
org.apache.hadoop.hive.ql.io.orc.TestInputOutputFormat.testVectorReaderFooterSerialize (batchId=254)
org.apache.hadoop.hive.ql.io.orc.TestInputOutputFormat.testVectorReaderNoFooterSerialize (batchId=254)
org.apache.hadoop.hive.ql.io.orc.TestInputOutputFormat.testVectorization (batchId=254)
org.apache.hadoop.hive.ql.io.orc.TestInputOutputFormat.testVectorizationWithAcid (batchId=254)
org.apache.hadoop.hive.ql.io.orc.TestInputOutputFormat.testVectorizationWithBuckets (batchId=254)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/2613/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/2613/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/2613/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/2613/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-2613/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-2613/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 20 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12843621 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15759684" author="hiveqa" created="Sun, 18 Dec 2016 23:27:14 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12843770/HIVE-13278.6.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12843770/HIVE-13278.6.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 13 failed/errored test(s), 10821 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestDerbyConnector - did not produce a TEST-*.xml file (likely timed out) (batchId=234)
TestVectorizedColumnReaderBase - did not produce a TEST-*.xml file (likely timed out) (batchId=251)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample2] (batchId=5)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample4] (batchId=15)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample6] (batchId=61)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample7] (batchId=60)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample9] (batchId=39)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[udf_sort_array] (batchId=59)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[orc_ppd_basic] (batchId=133)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[transform_ppr2] (batchId=135)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[stats_based_fetch_decision] (batchId=151)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=93)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_5] (batchId=92)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/2628/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/2628/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/2628/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/2628/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-2628/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-2628/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 13 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12843770 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15760001" author="lirui" created="Mon, 19 Dec 2016 03:10:49 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=csun&quot; class=&quot;user-hover&quot; rel=&quot;csun&quot;&gt;csun&lt;/a&gt; for the update. The latest patch looks good to me. +1&lt;br/&gt;
I also tried some test failures locally and they can&apos;t be reproduced.&lt;br/&gt;
An improvement is maybe we can make TestInputOutputFormat also use Utilities to set the MapWork? We can leave it as a follow on.&lt;/p&gt;</comment>
                            <comment id="15762668" author="csun" created="Mon, 19 Dec 2016 23:45:37 +0000"  >&lt;p&gt;Committed to master. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt; for the review!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12843132" name="HIVE-13278.1.patch" size="3031" author="csun" created="Wed, 14 Dec 2016 01:06:27 +0000"/>
                            <attachment id="12843161" name="HIVE-13278.2.patch" size="4035" author="csun" created="Wed, 14 Dec 2016 06:28:54 +0000"/>
                            <attachment id="12843278" name="HIVE-13278.3.patch" size="5357" author="csun" created="Wed, 14 Dec 2016 19:28:52 +0000"/>
                            <attachment id="12843458" name="HIVE-13278.4.patch" size="4982" author="csun" created="Thu, 15 Dec 2016 19:49:34 +0000"/>
                            <attachment id="12843621" name="HIVE-13278.5.patch" size="2526" author="csun" created="Fri, 16 Dec 2016 17:41:51 +0000"/>
                            <attachment id="12843770" name="HIVE-13278.6.patch" size="3214" author="csun" created="Sun, 18 Dec 2016 22:26:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 48 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ul6n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>