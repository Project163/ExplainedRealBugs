<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:22:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-26374] Query based compaction fails for tables with CDT and columns with Reserved Keywords</title>
                <link>https://issues.apache.org/jira/browse/HIVE-26374</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Query based compaction fails on Tables having complex data types with reserved keywords for columns. The compaction fails while creating a temporary table as it does not quote the columns correctly.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Below are the steps to reproduce the issue.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
create table complex_dt_compact2(col1 array&amp;lt;struct&amp;lt;arr_col1:&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, `timestamp`:string&amp;gt;&amp;gt;);
insert into complex_dt_compact2 SELECT ARRAY(NAMED_STRUCT(&lt;span class=&quot;code-quote&quot;&gt;&apos;arr_col1&apos;&lt;/span&gt;,1,&lt;span class=&quot;code-quote&quot;&gt;&apos;timestamp&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;2022-07-05 21:51:20.371&apos;&lt;/span&gt;));
insert into complex_dt_compact2 SELECT ARRAY(NAMED_STRUCT(&lt;span class=&quot;code-quote&quot;&gt;&apos;arr_col1&apos;&lt;/span&gt;,2,&lt;span class=&quot;code-quote&quot;&gt;&apos;timestamp&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;2022-07-05 21:51:20.371&apos;&lt;/span&gt;));
alter table complex_dt_compact2 compact &lt;span class=&quot;code-quote&quot;&gt;&apos;major&apos;&lt;/span&gt; and wait; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2022-07-05T22:15:47.710Z hiveserver2-0.hiveserver2-service.compute-1657056457-xkcx.svc.cluster.local hiveserver2 1 dbb4011d-c788-4b99-a31d-06bb6dd7182e [mdc@18060 class=&lt;span class=&quot;code-quote&quot;&gt;&quot;compactor.Worker&quot;&lt;/span&gt; level=&lt;span class=&quot;code-quote&quot;&gt;&quot;ERROR&quot;&lt;/span&gt; thread=&lt;span class=&quot;code-quote&quot;&gt;&quot;hiveserver2-0.hiveserver2-service.compute-1657056457-xkcx.svc.cluster.local-64_executor&quot;&lt;/span&gt;] Caught exception &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; trying to compact id:3,dbname:&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;,tableName:complex_dt_compact2,partName:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,state:,type:MAJOR,enqueueTime:0,start:0,properties:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,runAs:hive,tooManyAborts:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,hasOldAbort:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,highestWriteId:3,errorMessage:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,workerId: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,initiatorId: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,retryRetention0. Marking failed to avoid repeated failures
&#160; &#160; java.io.IOException: org.apache.hadoop.hive.ql.metadata.HiveException: Failed to run CREATE temporary external table default_tmp_compactor_complex_dt_compact2_1657059347578(`operation` &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, `originalTransaction` bigint, `bucket` &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, `rowId` bigint, `currentTransaction` bigint, `row` struct&amp;lt;`col1` :array&amp;lt;struct&amp;lt;arr_col1:&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,timestamp:string&amp;gt;&amp;gt;&amp;gt;) &#160;stored as orc LOCATION &lt;span class=&quot;code-quote&quot;&gt;&apos;s3a:&lt;span class=&quot;code-comment&quot;&gt;//obfuscated/clusters/obfuscated/obfuscated/warehouse/tablespace/managed/hive/complex_dt_compact2/base_0000003_v0000038&apos;&lt;/span&gt; TBLPROPERTIES (&lt;span class=&quot;code-quote&quot;&gt;&apos;compactiontable&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;transactional&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&apos;&lt;/span&gt;)
&lt;/span&gt;&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.txn.compactor.QueryCompactor.runCompactionQueries(QueryCompactor.java:120)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.txn.compactor.MajorQueryCompactor.runCompaction(MajorQueryCompactor.java:63)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.txn.compactor.Worker.findNextCompactionAndExecute(Worker.java:517)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.txn.compactor.Worker.lambda$run$0(Worker.java:120)
&#160; &#160; &#160; &#160; at java.util.concurrent.FutureTask.run(FutureTask.java:266)
&#160; &#160; &#160; &#160; at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
&#160; &#160; &#160; &#160; at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
&#160; &#160; &#160; &#160; at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:750)
&#160; &#160; Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Failed to run CREATE temporary external table default_tmp_compactor_complex_dt_compact2_1657059347578(`operation` &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, `originalTransaction` bigint, `bucket` &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, `rowId` bigint, `currentTransaction` bigint, `row` struct&amp;lt;`col1` :array&amp;lt;struct&amp;lt;arr_col1:&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,timestamp:string&amp;gt;&amp;gt;&amp;gt;) &#160;stored as orc LOCATION &lt;span class=&quot;code-quote&quot;&gt;&apos;s3a:&lt;span class=&quot;code-comment&quot;&gt;//obfuscated/clusters/obfuscated/obfuscated/warehouse/tablespace/managed/hive/complex_dt_compact2/base_0000003_v0000038&apos;&lt;/span&gt; TBLPROPERTIES (&lt;span class=&quot;code-quote&quot;&gt;&apos;compactiontable&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;transactional&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&apos;&lt;/span&gt;)
&lt;/span&gt;&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.DriverUtils.runOnDriver(DriverUtils.java:73)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.DriverUtils.runOnDriver(DriverUtils.java:50)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.txn.compactor.QueryCompactor.runCompactionQueries(QueryCompactor.java:113)
&#160; &#160; &#160; &#160; ... 7 more
&#160; &#160; Caused by: (responseCode = 40000, errorMessage = FAILED: ParseException line 1:241 cannot recognize input near &lt;span class=&quot;code-quote&quot;&gt;&apos;timestamp&apos;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;:&apos;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;string&apos;&lt;/span&gt; in column specification, SQLState = 42000, exception = line 1:241 cannot recognize input near &lt;span class=&quot;code-quote&quot;&gt;&apos;timestamp&apos;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;:&apos;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;string&apos;&lt;/span&gt; in column specification)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.DriverUtils.createProcessorException(DriverUtils.java:143)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.&lt;span class=&quot;code-object&quot;&gt;Compiler&lt;/span&gt;.handleException(&lt;span class=&quot;code-object&quot;&gt;Compiler&lt;/span&gt;.java:466)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.&lt;span class=&quot;code-object&quot;&gt;Compiler&lt;/span&gt;.compile(&lt;span class=&quot;code-object&quot;&gt;Compiler&lt;/span&gt;.java:122)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:197)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:636)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:694)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.Driver.run(Driver.java:526)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.Driver.run(Driver.java:515)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.DriverUtils.runOnDriver(DriverUtils.java:70)
&#160; &#160; &#160; &#160; ... 9 more&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13470421">HIVE-26374</key>
            <summary>Query based compaction fails for tables with CDT and columns with Reserved Keywords</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chiran54321">Chiran Ravani</assignee>
                                    <reporter username="chiran54321">Chiran Ravani</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 6 Jul 2022 21:28:03 +0000</created>
                <updated>Wed, 16 Nov 2022 13:50:23 +0000</updated>
                            <resolved>Fri, 15 Jul 2022 14:43:11 +0000</resolved>
                                    <version>3.1.3</version>
                    <version>4.0.0-alpha-1</version>
                                    <fixVersion>4.0.0-alpha-2</fixVersion>
                                    <component>Hive</component>
                    <component>Transactions</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="4800">1h 20m</timespent>
                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 18 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z16nxk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>