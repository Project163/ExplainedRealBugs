<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:01:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-3257] Fix avro_joins.q testcase failure when building hive on hadoop0.23</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3257</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;avro_joins.q is failing when building hive on hadoop0.23 for both MR1 and MR2. It has an execution exception:&lt;/p&gt;

&lt;p&gt;This query fails when execution:&lt;/p&gt;

&lt;p&gt;SELECT e.title, e.air_date, d.first_name, d.last_name, d.extra_field, e.air_date&lt;br/&gt;
FROM doctors4 d JOIN episodes e ON (d.number=e.doctor)&lt;br/&gt;
ORDER BY d.last_name, e.title&lt;/p&gt;


&lt;p&gt;Execution failed with exit status: 2&lt;br/&gt;
Obtaining error information&lt;br/&gt;
Task failed!&lt;br/&gt;
Task ID:&lt;br/&gt;
Stage-1&lt;br/&gt;
Logs:&lt;br/&gt;
/home/cloudera/Code/hive/build/ql/tmp//hive.log&lt;br/&gt;
FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.MapRedTask&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12598782">HIVE-3257</key>
            <summary>Fix avro_joins.q testcase failure when building hive on hadoop0.23</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zhenxiao">Zhenxiao Luo</assignee>
                                    <reporter username="zhenxiao">Zhenxiao Luo</reporter>
                        <labels>
                    </labels>
                <created>Sat, 14 Jul 2012 00:32:00 +0000</created>
                <updated>Thu, 2 May 2013 02:30:55 +0000</updated>
                            <resolved>Sat, 14 Jul 2012 12:53:57 +0000</resolved>
                                                    <fixVersion>0.10.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="13414212" author="zhenxiao" created="Sat, 14 Jul 2012 00:40:38 +0000"  >&lt;p&gt;The problem is in&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/io/avro/AvroGenericRecordReader.java:&lt;/p&gt;

&lt;p&gt;in getSchema(), the FileSplit does not have the scheme part of path URI, in this case, &quot;pfile:&quot;.&lt;/p&gt;

&lt;p&gt;The matching function pathIsInPartition() is checking whether the split starts with patitionPath.&lt;/p&gt;

&lt;p&gt;In hadoop0.23, partitionPath still holds pfile: prefix, while, FileSplit does not. So, pathIsInPartition() returns false.&lt;/p&gt;

&lt;p&gt;In hadoop0.20, both partitionPath and FileSplit hold pfile: prefix. So, pathIsInPartition() returns true.&lt;/p&gt;

&lt;p&gt;The root of the problem is in:&lt;br/&gt;
shims/src/common-secure/java/org/apache/hadoop/hive/shims/HadoopShimsSecure.java&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/io/CombineHiveInputFormat.java&lt;/p&gt;

&lt;p&gt;In getSplits(), hadoop0.23  removes scheme part of path URI in the CombineFileInputFormat, in this case &quot;pfile:&quot;. This diffs from hadoop0.20 behavior. &lt;/p&gt;

&lt;p&gt;The same problem happens in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2737&quot; title=&quot;CombineFileInputFormat fails if mapred.job.tracker is set to local with a sub-query&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2737&quot;&gt;HIVE-2737&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2778&quot; title=&quot;Fail on table sampling &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2778&quot;&gt;&lt;del&gt;HIVE-2778&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2784&quot; title=&quot;Integrating with MapReduce2 get NPE throwed when executing a query with a &amp;quot;TABLESAMPLE(x percent)&amp;quot; clause&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2784&quot;&gt;&lt;del&gt;HIVE-2784&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;We already committed patches, which have workaround including checking whether the path is schemeless or not.&lt;/p&gt;

&lt;p&gt;Will do the same thing for this AvroGenericRecordReader&lt;/p&gt;</comment>
                            <comment id="13414215" author="zhenxiao" created="Sat, 14 Jul 2012 00:46:32 +0000"  >&lt;p&gt;Review request submitted at:&lt;br/&gt;
&lt;a href=&quot;https://reviews.facebook.net/D4131&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D4131&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13414380" author="appodictic" created="Sat, 14 Jul 2012 12:25:26 +0000"  >&lt;p&gt;+1 will test and commit.&lt;/p&gt;</comment>
                            <comment id="13414388" author="appodictic" created="Sat, 14 Jul 2012 12:46:54 +0000"  >&lt;p&gt;Tests pass&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[edward@tablitha trunk]$ ant test -Dtestcase=TestCliDriver -Dqfile=avro_joins.q,avro_change_schema.q,avro_sanity_test.q,avro_schema_literal.q
    [junit] Done query: avro_schema_literal.q elapsedTime=0s
    [junit] Cleaning up TestCliDriver
    [junit] Tests run: 5, Failures: 0, Errors: 0, Time elapsed: 34.706 sec
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="13414393" author="appodictic" created="Sat, 14 Jul 2012 12:53:57 +0000"  >&lt;p&gt;Committed. Thanks Zhenxiao.&lt;/p&gt;</comment>
                            <comment id="13414462" author="hudson" created="Sat, 14 Jul 2012 17:52:31 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1541 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1541/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1541/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3257&quot; title=&quot;Fix avro_joins.q testcase failure when building hive on hadoop0.23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3257&quot;&gt;&lt;del&gt;HIVE-3257&lt;/del&gt;&lt;/a&gt; Fix avro_joins.q testcase failure when building hive on hadoop0.23. Zhenxiao Luo (via egc) (Revision 1361537)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
ecapriolo : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1361537&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1361537&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/io/avro/AvroGenericRecordReader.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13548333" author="hudson" created="Wed, 9 Jan 2013 10:25:19 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #54 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3257&quot; title=&quot;Fix avro_joins.q testcase failure when building hive on hadoop0.23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3257&quot;&gt;&lt;del&gt;HIVE-3257&lt;/del&gt;&lt;/a&gt; Fix avro_joins.q testcase failure when building hive on hadoop0.23. Zhenxiao Luo (via egc) (Revision 1361537)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
ecapriolo : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1361537&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1361537&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/io/avro/AvroGenericRecordReader.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13550103" author="ashutoshc" created="Thu, 10 Jan 2013 19:53:23 +0000"  >&lt;p&gt;This issue is fixed and released as part of 0.10.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12539495">HIVE-2737</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12541728">HIVE-2784</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12541359">HIVE-2778</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12600246">HIVE-3301</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12614451">HIVE-3651</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12536487" name="HIVE-3257.1.patch.txt" size="1450" author="zhenxiao" created="Sat, 14 Jul 2012 00:46:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>242375</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 45 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02u73:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>14493</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>