<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:09:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-5240] Column statistics on a partitioned column should fail early with proper error message</title>
                <link>https://issues.apache.org/jira/browse/HIVE-5240</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;When computing column statistics on a partitioned table, if one of the columns equals the partitioned column then IndexOutOfBoundsException is thrown. &lt;/p&gt;

&lt;p&gt;Following analyze query throws IndexOutOfBoundsException during semantic analysis phase&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; analyze table qlog_1m_part partition(year=5) compute statistics &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; columns year,month,week,type;
FAILED: IndexOutOfBoundsException Index: 1, Size: 0&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;If the partitioned column is specified at last like below then the same exception is thrown at runtime&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; analyze table qlog_1m_part partition(year=5) compute statistics &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; columns month,week,type,year;

Hadoop job information &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;: number of mappers: 0; number of reducers: 0
2013-09-06 18:05:06,587 &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; map = 0%,  reduce = 100%
Ended Job = job_local861862820_0001
Execution completed successfully
Mapred Local Task Succeeded . Convert the Join into MapJoin
java.lang.IndexOutOfBoundsException: Index: 3, Size: 3
	at java.util.LinkedList.entry(LinkedList.java:365)
	at java.util.LinkedList.get(LinkedList.java:315)
	at org.apache.hadoop.hive.ql.exec.ColumnStatsTask.constructColumnStatsFromPackedRow(ColumnStatsTask.java:262)
	at org.apache.hadoop.hive.ql.exec.ColumnStatsTask.persistPartitionStats(ColumnStatsTask.java:302)
	at org.apache.hadoop.hive.ql.exec.ColumnStatsTask.execute(ColumnStatsTask.java:345)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:151)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:65)
	at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1407)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1187)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1017)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:885)
	at org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:259)
	at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:216)
	at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:413)
	at org.apache.hadoop.hive.cli.CliDriver.executeDriver(CliDriver.java:781)
	at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:675)
	at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:614)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:160)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12667428">HIVE-5240</key>
            <summary>Column statistics on a partitioned column should fail early with proper error message</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="prasanth_j">Prasanth Jayachandran</assignee>
                                    <reporter username="prasanth_j">Prasanth Jayachandran</reporter>
                        <labels>
                            <label>statistics</label>
                    </labels>
                <created>Sat, 7 Sep 2013 01:15:25 +0000</created>
                <updated>Thu, 12 Sep 2013 19:24:51 +0000</updated>
                            <resolved>Thu, 12 Sep 2013 02:08:19 +0000</resolved>
                                    <version>0.12.0</version>
                                    <fixVersion>0.13.0</fixVersion>
                                    <component>Statistics</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13760843" author="prasanth_j" created="Sat, 7 Sep 2013 01:18:56 +0000"  >&lt;p&gt;The attached patch addresses the issue described in Description by failing fast in semantic analysis phase with proper error message. &lt;/p&gt;</comment>
                            <comment id="13761646" author="navis" created="Mon, 9 Sep 2013 06:25:13 +0000"  >&lt;p&gt;Should partition columns be ignored, instead of throwing exception?&lt;/p&gt;</comment>
                            <comment id="13762518" author="ashutoshc" created="Tue, 10 Sep 2013 00:38:57 +0000"  >&lt;p&gt;I think throwing exception is better in this case. If user has specified partition column in her query she is expecting that stats will be collected and stored for it in metastore, which is a wrong expectation. &lt;/p&gt;</comment>
                            <comment id="13762536" author="shreepadma" created="Tue, 10 Sep 2013 00:50:25 +0000"  >&lt;p&gt;There is already a JIRA for this issue - &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4426&quot; title=&quot;Support statistics collection for partitioning key&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4426&quot;&gt;&lt;del&gt;HIVE-4426&lt;/del&gt;&lt;/a&gt;. However, &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4426&quot; title=&quot;Support statistics collection for partitioning key&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4426&quot;&gt;&lt;del&gt;HIVE-4426&lt;/del&gt;&lt;/a&gt; aims to allow stats collection on the partitioning key. I think this can be useful. I&apos;ll be able to start working on &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4426&quot; title=&quot;Support statistics collection for partitioning key&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4426&quot;&gt;&lt;del&gt;HIVE-4426&lt;/del&gt;&lt;/a&gt; next week. Let me know if there&apos;s interest. Thanks!&lt;/p&gt;</comment>
                            <comment id="13762556" author="ashutoshc" created="Tue, 10 Sep 2013 01:15:53 +0000"  >&lt;p&gt;Thanks, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shreepadma&quot; class=&quot;user-hover&quot; rel=&quot;shreepadma&quot;&gt;shreepadma&lt;/a&gt; for chiming in. There is definitely interest in that. I will be happy to help review that work.&lt;/p&gt;</comment>
                            <comment id="13763363" author="shreepadma" created="Tue, 10 Sep 2013 19:02:07 +0000"  >&lt;p&gt;Thanks, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt;. &lt;/p&gt;</comment>
                            <comment id="13763807" author="navis" created="Wed, 11 Sep 2013 01:20:52 +0000"  >&lt;p&gt;LGTM. Lastly, could you change the method name &quot;validateColumnNames&quot; to more specific one? &lt;/p&gt;</comment>
                            <comment id="13763818" author="prasanth_j" created="Wed, 11 Sep 2013 01:27:26 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;navis&lt;/a&gt;. Renamed the method in the new patch. &lt;/p&gt;</comment>
                            <comment id="13763834" author="navis" created="Wed, 11 Sep 2013 01:39:12 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13764104" author="prasanth_j" created="Wed, 11 Sep 2013 08:16:38 +0000"  >
&lt;p&gt;just noticed that the earlier version of the patch missed out two small issues.&lt;br/&gt;
issue 1: case insensitive comparison of specified column name with partition name&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; analyze table qlog_1m_part partition(year=5) compute statistics &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; columns YEAR,month,week,type;
FAILED: IndexOutOfBoundsException Index: 1, Size: 0&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;issue 2: if partition name is not explicitly specified in the analyze query, then table level statistics will be computed. table level statistics on partition column is also not supported yet. Following query illustrates this case (it is same as the query in description except that partition is NOT explicitly specified)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; analyze table qlog_1m_part compute statistics &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; columns year,month,week,type;
FAILED: IndexOutOfBoundsException Index: 1, Size: 0&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This new patch addresses these two issues.&lt;/p&gt;</comment>
                            <comment id="13765089" author="navis" created="Thu, 12 Sep 2013 02:08:19 +0000"  >&lt;p&gt;Committed to trunk. Thanks, Prasanth!&lt;/p&gt;</comment>
                            <comment id="13765117" author="hudson" created="Thu, 12 Sep 2013 02:57:24 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-hadoop2 #423 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/423/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/423/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5240&quot; title=&quot;Column statistics on a partitioned column should fail early with proper error message&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5240&quot;&gt;&lt;del&gt;HIVE-5240&lt;/del&gt;&lt;/a&gt; : Column statistics on a partitioned column should fail early with proper error message (Prasanth J via Navis) (navis: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1522118&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1522118&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/ColumnStatsSemanticAnalyzer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13765643" author="hudson" created="Thu, 12 Sep 2013 17:21:14 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-hadoop2-ptest #96 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2-ptest/96/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2-ptest/96/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5240&quot; title=&quot;Column statistics on a partitioned column should fail early with proper error message&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5240&quot;&gt;&lt;del&gt;HIVE-5240&lt;/del&gt;&lt;/a&gt; : Column statistics on a partitioned column should fail early with proper error message (Prasanth J via Navis) (navis: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1522118&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1522118&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/ColumnStatsSemanticAnalyzer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13765660" author="hudson" created="Thu, 12 Sep 2013 17:30:05 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-hadoop1-ptest #163 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop1-ptest/163/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop1-ptest/163/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5240&quot; title=&quot;Column statistics on a partitioned column should fail early with proper error message&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5240&quot;&gt;&lt;del&gt;HIVE-5240&lt;/del&gt;&lt;/a&gt; : Column statistics on a partitioned column should fail early with proper error message (Prasanth J via Navis) (navis: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1522118&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1522118&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/ColumnStatsSemanticAnalyzer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13765795" author="hudson" created="Thu, 12 Sep 2013 19:24:51 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-h0.21 #2326 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/2326/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/2326/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5240&quot; title=&quot;Column statistics on a partitioned column should fail early with proper error message&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5240&quot;&gt;&lt;del&gt;HIVE-5240&lt;/del&gt;&lt;/a&gt; : Column statistics on a partitioned column should fail early with proper error message (Prasanth J via Navis) (navis: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1522118&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1522118&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/ColumnStatsSemanticAnalyzer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12602487" name="HIVE-5240.2.txt" size="2250" author="prasanth_j" created="Wed, 11 Sep 2013 01:26:50 +0000"/>
                            <attachment id="12602631" name="HIVE-5240.3.txt" size="2946" author="prasanth_j" created="Wed, 11 Sep 2013 18:56:03 +0000"/>
                            <attachment id="12601944" name="HIVE-5240.txt" size="2240" author="prasanth_j" created="Sat, 7 Sep 2013 01:16:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>347365</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 10 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1nwcn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>347664</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>