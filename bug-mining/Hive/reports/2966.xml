<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:28:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-4009] CLI Tests fail randomly due to MapReduce LocalJobRunner race condition</title>
                <link>https://issues.apache.org/jira/browse/HIVE-4009</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Hadoop has a race condition &lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-5001&quot; title=&quot;LocalJobRunner has race condition resulting in job failures &quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-5001&quot;&gt;&lt;del&gt;MAPREDUCE-5001&lt;/del&gt;&lt;/a&gt; which causes tests to fail randomly when using LocalJobRunner.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12631811">HIVE-4009</key>
            <summary>CLI Tests fail randomly due to MapReduce LocalJobRunner race condition</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="brocknoland">Brock Noland</assignee>
                                    <reporter username="brocknoland">Brock Noland</reporter>
                        <labels>
                    </labels>
                <created>Mon, 11 Feb 2013 20:58:36 +0000</created>
                <updated>Mon, 30 Oct 2017 21:05:30 +0000</updated>
                            <resolved>Tue, 25 Nov 2014 20:29:37 +0000</resolved>
                                                    <fixVersion>1.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13576125" author="brocknoland" created="Mon, 11 Feb 2013 21:08:16 +0000"  >
&lt;p&gt;Case 1 in JobClient.getJob():&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2013-02-08 08:26:16,132 FATAL conf.Configuration (Configuration.java:loadResource(2011)) - error parsing conf file:/home/hiveptest/hive/build/test/hadoop-hiveptest/mapred/staging/hiveptest1573470257/.staging/job_local1573470257_0001/job.xml
java.io.FileNotFoundException: /home/hiveptest/build/test/hadoop-hiveptest/mapred/staging/hiveptest1573470257/.staging/job_local1573470257_0001/job.xml (No such file or directory)
        at java.io.FileInputStream.open(Native Method)
        at java.io.FileInputStream.&amp;lt;init&amp;gt;(FileInputStream.java:120)
        at org.apache.hadoop.conf.Configuration.loadResource(Configuration.java:1924)
        at org.apache.hadoop.conf.Configuration.loadResources(Configuration.java:1877)
        at org.apache.hadoop.conf.Configuration.getProps(Configuration.java:1785)
        at org.apache.hadoop.conf.Configuration.get(Configuration.java:712)
        at org.apache.hadoop.mapred.JobConf.checkAndWarnDeprecation(JobConf.java:1951)
        at org.apache.hadoop.mapred.JobConf.&amp;lt;init&amp;gt;(JobConf.java:398)
        at org.apache.hadoop.mapred.JobConf.&amp;lt;init&amp;gt;(JobConf.java:388)
        at org.apache.hadoop.mapred.JobClient$NetworkedJob.&amp;lt;init&amp;gt;(JobClient.java:174)
        at org.apache.hadoop.mapred.JobClient.getJob(JobClient.java:655)
        at org.apache.hadoop.mapred.JobClient.getJob(JobClient.java:668)
        at org.apache.hadoop.hive.ql.exec.HadoopJobExecHelper.progress(HadoopJobExecHelper.java:282)
        at org.apache.hadoop.hive.ql.exec.HadoopJobExecHelper.progress(HadoopJobExecHelper.java:532)
        at org.apache.hadoop.hive.ql.exec.ExecDriver.execute(ExecDriver.java:453)
        at org.apache.hadoop.hive.ql.exec.ExecDriver.main(ExecDriver.java:689)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.hadoop.util.RunJar.main(RunJar.java:208)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Case 1 in JobClient.getMapTaskReports():&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    [junit] java.lang.RuntimeException: java.io.FileNotFoundException: /home/hiveptest/hive/build/test/hadoop-hiveptest/mapred/staging/hiveptest1743741198/.staging/job_local1743741198_0001/job.xml (No such file or directory)
    [junit] 	at org.apache.hadoop.conf.Configuration.loadResource(Configuration.java:2012)
    [junit] 	at org.apache.hadoop.conf.Configuration.loadResources(Configuration.java:1877)
    [junit] 	at org.apache.hadoop.conf.Configuration.getProps(Configuration.java:1785)
    [junit] 	at org.apache.hadoop.conf.Configuration.get(Configuration.java:712)
    [junit] 	at org.apache.hadoop.mapred.JobConf.checkAndWarnDeprecation(JobConf.java:1951)
    [junit] 	at org.apache.hadoop.mapred.JobConf.&amp;lt;init&amp;gt;(JobConf.java:398)
    [junit] 	at org.apache.hadoop.mapred.JobConf.&amp;lt;init&amp;gt;(JobConf.java:388)
    [junit] 	at org.apache.hadoop.mapreduce.Cluster.getJob(Cluster.java:186)
    [junit] 	at org.apache.hadoop.mapred.JobClient$2.run(JobClient.java:635)
    [junit] 	at org.apache.hadoop.mapred.JobClient$2.run(JobClient.java:633)
    [junit] 	at java.security.AccessController.doPrivileged(Native Method)
    [junit] 	at javax.security.auth.Subject.doAs(Subject.java:396)
    [junit] 	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1372)
    [junit] 	at org.apache.hadoop.mapred.JobClient.getJobUsingCluster(JobClient.java:633)
    [junit] 	at org.apache.hadoop.mapred.JobClient.getTaskReports(JobClient.java:687)
    [junit] 	at org.apache.hadoop.mapred.JobClient.getMapTaskReports(JobClient.java:681)
    [junit] 	at org.apache.hadoop.mapred.JobClient.getMapTaskReports(JobClient.java:700)
    [junit] 	at org.apache.hadoop.hive.ql.exec.HadoopJobExecHelper.progress(HadoopJobExecHelper.java:253)
    [junit] 	at org.apache.hadoop.hive.ql.exec.HadoopJobExecHelper.progress(HadoopJobExecHelper.java:532)
    [junit] 	at org.apache.hadoop.hive.ql.exec.ExecDriver.execute(ExecDriver.java:453)
    [junit] 	at org.apache.hadoop.hive.ql.exec.ExecDriver.main(ExecDriver.java:689)
    [junit] 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    [junit] 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    [junit] 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    [junit] 	at java.lang.reflect.Method.invoke(Method.java:597)
    [junit] 	at org.apache.hadoop.util.RunJar.main(RunJar.java:208)
    [junit] Caused by: java.io.FileNotFoundException: /home/hiveptest/hive/build/test/hadoop-hiveptest/mapred/staging/hiveptest1743741198/.staging/job_local1743741198_0001/job.xml (No such file or directory)
    [junit] 	at java.io.FileInputStream.open(Native Method)
    [junit] 	at java.io.FileInputStream.&amp;lt;init&amp;gt;(FileInputStream.java:120)
    [junit] 	at org.apache.hadoop.conf.Configuration.loadResource(Configuration.java:1924)
    [junit] 	... 25 more

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13576773" author="brocknoland" created="Tue, 12 Feb 2013 16:59:34 +0000"  >&lt;p&gt;Adding link to Phabricator:  &lt;a href=&quot;https://reviews.facebook.net/D8523&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D8523&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13591651" author="ashutoshc" created="Sun, 3 Mar 2013 06:01:27 +0000"  >&lt;p&gt;I never hit this in my CLI tests. Brock, can you describe the situation when you ran into it. Are these HiveServer2 tests?&lt;/p&gt;</comment>
                            <comment id="13685903" author="brocknoland" created="Mon, 17 Jun 2013 19:47:14 +0000"  >&lt;p&gt;Hey,&lt;/p&gt;

&lt;p&gt;I hit this with the parallel test tool. However, I think I was oversubscribing CPU quite a bit which caused this race more likely to be hit. After scaling back the number of threads of unit tests per host I have not hit it. However, since more parallel testing seems to be coming let&apos;s keep this open for the time being.&lt;/p&gt;</comment>
                            <comment id="13708110" author="brocknoland" created="Sun, 14 Jul 2013 19:55:18 +0000"  >&lt;p&gt;I haven&apos;t seen this reproduce in some time. Closing for now.&lt;/p&gt;</comment>
                            <comment id="14218748" author="brocknoland" created="Thu, 20 Nov 2014 00:06:09 +0000"  >&lt;p&gt;I&apos;ve seen this again. Time to fix it.&lt;/p&gt;</comment>
                            <comment id="14218751" author="brocknoland" created="Thu, 20 Nov 2014 00:08:30 +0000"  >&lt;p&gt;Too be clear, although &lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-5001&quot; title=&quot;LocalJobRunner has race condition resulting in job failures &quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-5001&quot;&gt;&lt;del&gt;MAPREDUCE-5001&lt;/del&gt;&lt;/a&gt; improves the situation in that an exception is not throw, it&apos;s still possible for LJR to return null an fail. This happens on hosts which are very busy. Let&apos;s just not the racy status section of code when in local mode.&lt;/p&gt;</comment>
                            <comment id="14222347" author="hiveqa" created="Sun, 23 Nov 2014 09:13:08 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12682533/HIVE-4009.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12682533/HIVE-4009.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 6651 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_optimize_nullscan
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1874/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1874/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1874/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1874/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1874/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1874/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12682533 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14223356" author="szehon" created="Mon, 24 Nov 2014 19:25:07 +0000"  >&lt;p&gt;Makes sense to me not to run the racy section for local-mode.  +1&lt;/p&gt;</comment>
                            <comment id="14225158" author="brocknoland" created="Tue, 25 Nov 2014 20:29:37 +0000"  >&lt;p&gt;Thank you Szehon! I hope this will improve test flakiness. I&apos;ve committed this to trunk.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12631810">MAPREDUCE-5001</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13113147">HIVE-17941</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12569007" name="HIVE-4009-0.patch" size="4738" author="brocknoland" created="Tue, 12 Feb 2013 17:02:04 +0000"/>
                            <attachment id="12682533" name="HIVE-4009.patch" size="4643" author="brocknoland" created="Thu, 20 Nov 2014 00:07:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>312307</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1hw93:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>312653</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>