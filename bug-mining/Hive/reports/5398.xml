<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:52:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-16024] MSCK Repair Requires nonstrict hive.mapred.mode</title>
                <link>https://issues.apache.org/jira/browse/HIVE-16024</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;MSCK repair fails when hive.mapred.mode is set to strict&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-13788&quot; title=&quot;hive msck listpartitions need to make use of directSQL instead of datanucleus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-13788&quot;&gt;&lt;del&gt;HIVE-13788&lt;/del&gt;&lt;/a&gt; modified the way we read up partitions for a table to improve performance. Unfortunately it is using PartitionPruner to load the partitions which in turn is checking hive.mapred.mode.&lt;br/&gt;
The previous code did not check hive.mapred.mode.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13045642">HIVE-16024</key>
            <summary>MSCK Repair Requires nonstrict hive.mapred.mode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zsombor.klara">Barna Zsombor Klara</assignee>
                                    <reporter username="zsombor.klara">Barna Zsombor Klara</reporter>
                        <labels>
                    </labels>
                <created>Thu, 23 Feb 2017 15:09:41 +0000</created>
                <updated>Fri, 21 Jul 2017 18:46:02 +0000</updated>
                            <resolved>Mon, 20 Mar 2017 16:10:42 +0000</resolved>
                                    <version>2.2.0</version>
                                    <fixVersion>2.3.0</fixVersion>
                                    <component>Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="15880622" author="zsombor.klara" created="Thu, 23 Feb 2017 15:19:09 +0000"  >&lt;p&gt;Modified HiveMetaStoreChecker to load partitions directly and not through the PartitionPruner.&lt;br/&gt;
Technically one could modify the PartitionPruner to not check hive.mapred.mode when called from HMSChecker, but I think this solution is cleaner even if is at the cost of a bit of code duplication.&lt;/p&gt;</comment>
                            <comment id="15880833" author="vihangk1" created="Thu, 23 Feb 2017 16:55:16 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zsombor.klara&quot; class=&quot;user-hover&quot; rel=&quot;zsombor.klara&quot;&gt;zsombor.klara&lt;/a&gt; for the patch. Took a quick look at the patch. Is the issue due to &lt;tt&gt;hive.strict.checks.large.query&lt;/tt&gt; instead of &lt;tt&gt;hive.mapred.mode&lt;/tt&gt;? Looks like the following code in PartitionPruner is throwing the exception which checks for a &lt;tt&gt;hive.strict.checks.large.query&lt;/tt&gt; instead of the config in description.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;if (!hasColumnExpr(prunerExpr)) {
      // If the &quot;strict&quot; mode is on, we have to provide partition pruner for each table.
      String error = StrictChecks.checkNoPartitionFilter(conf);
      if (error != null) {
        throw new SemanticException(error + &quot; No partition predicate for Alias \&quot;&quot;
            + alias + &quot;\&quot; Table \&quot;&quot; + tab.getTableName() + &quot;\&quot;&quot;);
      }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Also, Can you use &lt;tt&gt;PartitionPruner.getAllPartitions&lt;/tt&gt; method instead of &lt;tt&gt;hive.getAllPartitionsOf(table)&lt;/tt&gt;. It uses some performance logging which can be helpful. The other thing I noticed is that with the patch method will throw a HiveException instead of SemanticException at line. May not be a issue but worth investigating I think.&lt;/p&gt;</comment>
                            <comment id="15880990" author="vihangk1" created="Thu, 23 Feb 2017 18:35:12 +0000"  >&lt;p&gt;sorry my bad. Didn&apos;t realize &lt;tt&gt;PartitionPruner.getAllPartitions&lt;/tt&gt; is a private method. May be adding some perf logging instead would help in that case.&lt;/p&gt;</comment>
                            <comment id="15881462" author="hiveqa" created="Thu, 23 Feb 2017 22:42:09 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12854226/HIVE-16024.01.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12854226/HIVE-16024.01.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 6 failed/errored test(s), 10241 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestDerbyConnector - did not produce a TEST-*.xml file (likely timed out) (batchId=235)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_if_expr] (batchId=140)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=223)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query23] (batchId=223)
org.apache.hadoop.hive.cli.TestSparkCliDriver.org.apache.hadoop.hive.cli.TestSparkCliDriver (batchId=130)
org.apache.hive.beeline.TestBeeLineWithArgs.testQueryProgressParallel (batchId=211)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/3733/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/3733/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/3733/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/3733/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-3733/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-3733/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 6 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12854226 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15882473" author="zsombor.klara" created="Fri, 24 Feb 2017 11:21:50 +0000"  >&lt;p&gt;Thanks for taking a look at the patch &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vihangk1&quot; class=&quot;user-hover&quot; rel=&quot;vihangk1&quot;&gt;vihangk1&lt;/a&gt;.&lt;br/&gt;
The hive.strict.checks.large.query is driven by the setting of hive.mapred.mode. If the mapred mode is not strict then the strict checks are not performed. So we could say that both are causing the exception.&lt;br/&gt;
I have added the performance logging, you are right that this should be wrapping the metastore call.&lt;br/&gt;
I don&apos;t think however that the change in the thrown exception type is relevant. The original code before this regression was also throwing HiveException, we did not have a release with the SemanticException version and I don&apos;t see a benefit in wrapping the HiveException since I cannot provide any useful, context related information.&lt;br/&gt;
I am tempted a bit to make PartitionPruner#getAllPartitions public and to reuse that to reduce the code duplication, but I don&apos;t want to expose an API in the pruner that isn&apos;t pruning... what do you think?&lt;/p&gt;</comment>
                            <comment id="15883156" author="hiveqa" created="Fri, 24 Feb 2017 17:34:59 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12854451/HIVE-16024.02.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12854451/HIVE-16024.02.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 3 failed/errored test(s), 10258 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestDerbyConnector - did not produce a TEST-*.xml file (likely timed out) (batchId=235)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_if_expr] (batchId=140)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=223)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/3758/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/3758/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/3758/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/3758/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-3758/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-3758/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12854451 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15885475" author="zsombor.klara" created="Mon, 27 Feb 2017 09:53:48 +0000"  >&lt;p&gt;All 3 failures are well known flaky/failing tests:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;query14: &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-15744&quot; title=&quot;Flaky test: TestPerfCliDriver.query23, query14&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-15744&quot;&gt;&lt;del&gt;HIVE-15744&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;vector_if_expr: &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-15776&quot; title=&quot;Flaky test: TestMiniLlapLocalCliDriver vector_if_expr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-15776&quot;&gt;HIVE-15776&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;TestDerbyConnector: &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-15702&quot; title=&quot;Test timeout : TestDerbyConnector &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-15702&quot;&gt;&lt;del&gt;HIVE-15702&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15887606" author="pvary" created="Tue, 28 Feb 2017 09:00:22 +0000"  >&lt;p&gt;I think the second version of the code looks fine. I prefer not to expose the PartitionPruner#getAllPartitions, since the perflog wrapped Hive#getAllPartitions does the same, and it is not that much code duplication.&lt;/p&gt;

&lt;p&gt;LGTM (non-binding)&lt;/p&gt;</comment>
                            <comment id="15888395" author="spena" created="Tue, 28 Feb 2017 16:35:12 +0000"  >&lt;p&gt;Wouldn&apos;t there OOM errors if MSCK fetches a large number of partitions? This is a typical problem in Hive when attempting to read all partitions from the Metastore. The strict mode was added for that. Should the MSCK have a restriction on that as well?&lt;/p&gt;

&lt;p&gt;Should we use the &lt;tt&gt;PartitionIterable&lt;/tt&gt; class to get all partitions in batches to avoid OOM instead?&lt;/p&gt;</comment>
                            <comment id="15888596" author="stakiar" created="Tue, 28 Feb 2017 18:23:44 +0000"  >&lt;p&gt;We could do something similar to what the &lt;tt&gt;DDLTask.dropTable&lt;/tt&gt; method does?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; partitionBatchSize = HiveConf.getIntVar(conf,
        ConfVars.METASTORE_BATCH_RETRIEVE_TABLE_PARTITION_MAX);

    &lt;span class=&quot;code-comment&quot;&gt;// We should check that all the partitions of the table can be dropped
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (tbl != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; tbl.isPartitioned()) {
      List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; partitionNames = db.getPartitionNames(tbl.getDbName(), tbl.getTableName(), (&lt;span class=&quot;code-object&quot;&gt;short&lt;/span&gt;)-1);

      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i=0; i &amp;lt; partitionNames.size(); i+= partitionBatchSize) {
        List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; partNames = partitionNames.subList(i, &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.min(i+partitionBatchSize,
            partitionNames.size()));
        List&amp;lt;Partition&amp;gt; listPartitions = db.getPartitionsByNames(tbl, partNames);
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Partition p: listPartitions) {
          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!p.canDrop()) {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HiveException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Table &quot;&lt;/span&gt; + tbl.getTableName() +
                &lt;span class=&quot;code-quote&quot;&gt;&quot; Partition&quot;&lt;/span&gt; + p.getName() +
                &lt;span class=&quot;code-quote&quot;&gt;&quot; is &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; from being dropped&quot;&lt;/span&gt;);
          }
        }
      }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15890003" author="zsombor.klara" created="Wed, 1 Mar 2017 11:26:05 +0000"  >&lt;p&gt;As per &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=spena&quot; class=&quot;user-hover&quot; rel=&quot;spena&quot;&gt;spena&lt;/a&gt;&apos;s and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stakiar&quot; class=&quot;user-hover&quot; rel=&quot;stakiar&quot;&gt;stakiar&lt;/a&gt;&apos;s comments I&apos;ve refactored the code to use the PartitionIterable.&lt;/p&gt;</comment>
                            <comment id="15890401" author="spena" created="Wed, 1 Mar 2017 15:37:31 +0000"  >&lt;p&gt;Looks good.&lt;br/&gt;
+1&lt;/p&gt;</comment>
                            <comment id="15890409" author="hiveqa" created="Wed, 1 Mar 2017 15:45:11 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12855351/HIVE-16024.03.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12855351/HIVE-16024.03.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 4 failed/errored test(s), 10323 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_vec_table] (batchId=147)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_if_expr] (batchId=140)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=224)
org.apache.hive.beeline.TestBeeLineWithArgs.testQueryProgressParallel (batchId=212)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/3870/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/3870/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/3870/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/3870/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-3870/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-3870/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 4 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12855351 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15890482" author="zsombor.klara" created="Wed, 1 Mar 2017 16:26:06 +0000"  >&lt;p&gt;2 failures are well known flaky/failing tests:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;query14: &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-15744&quot; title=&quot;Flaky test: TestPerfCliDriver.query23, query14&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-15744&quot;&gt;&lt;del&gt;HIVE-15744&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;vector_if_expr: &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-15776&quot; title=&quot;Flaky test: TestMiniLlapLocalCliDriver vector_if_expr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-15776&quot;&gt;HIVE-15776&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;schema_evol_text_vec_table has been failing for 50+ builds and testQueryProgressParallel is passing locally.&lt;/p&gt;</comment>
                            <comment id="15890753" author="vihangk1" created="Wed, 1 Mar 2017 18:31:53 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zsombor.klara&quot; class=&quot;user-hover&quot; rel=&quot;zsombor.klara&quot;&gt;zsombor.klara&lt;/a&gt; for the patch. I can understand that tuning the performance (memory/runtime) of &lt;tt&gt;msck repair table&lt;/tt&gt; was not the original intent of this patch and we should probably take this up in a separate JIRA. I wonder if this patch is regressing the performance of &lt;tt&gt;MSCK REPAIR TABLE&lt;/tt&gt; queries esp. on S3. The original implementation was checking for the strict mode config and not allowing &lt;tt&gt;MSCK ..&lt;/tt&gt; to scan all the partitions if strict mode is set. But this implementation now switches to using &lt;tt&gt;PartitionIterable&lt;/tt&gt; for all the msck queries irrespective of whether it would have caused a OOM or not. According to documentation of &lt;tt&gt;PartitionIterable&lt;/tt&gt; &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;It is very likely that any calls to PartitionIterable are going to result in a large number of calls, so use sparingly only when the memory cost of fetching all the partitions in one shot is too prohibitive.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If we want to enable msck repair even for strict mode then it might be a good idea to invoke PartitionIterable only when user is setting the strict mode like original use-case. That would be a good middle ground I believe without causing performance regressions and causing OOM errors in pursuit of higher performance. What do you think?&lt;/p&gt;</comment>
                            <comment id="15891046" author="stakiar" created="Wed, 1 Mar 2017 21:12:00 +0000"  >&lt;p&gt;I think that &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-13788&quot; title=&quot;hive msck listpartitions need to make use of directSQL instead of datanucleus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-13788&quot;&gt;&lt;del&gt;HIVE-13788&lt;/del&gt;&lt;/a&gt; is actually a backwards incompatible change. Before &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-13788&quot; title=&quot;hive msck listpartitions need to make use of directSQL instead of datanucleus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-13788&quot;&gt;&lt;del&gt;HIVE-13788&lt;/del&gt;&lt;/a&gt; users could run msck without thinking about whether strict mode is on or off. After the patch, they could only run it if strict was is set to nonstrict. I&apos;m not sure if that was done intentionally in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-13788&quot; title=&quot;hive msck listpartitions need to make use of directSQL instead of datanucleus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-13788&quot;&gt;&lt;del&gt;HIVE-13788&lt;/del&gt;&lt;/a&gt; or not.&lt;/p&gt;</comment>
                            <comment id="15891050" author="spena" created="Wed, 1 Mar 2017 21:14:56 +0000"  >&lt;p&gt;Probably to avoid OOM issues when fetching a large number of partitions. But using PartitionIterable should help because it fetches only names, then it fetches all partition information in batches.&lt;/p&gt;</comment>
                            <comment id="15891937" author="zsombor.klara" created="Thu, 2 Mar 2017 09:40:39 +0000"  >&lt;p&gt;Refactored based on &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vihangk1&quot; class=&quot;user-hover&quot; rel=&quot;vihangk1&quot;&gt;vihangk1&lt;/a&gt;&apos;s comments. If strict mode is set, then we will lazily load the partitions, if strict mode is not not set then we load everything with the PartitionsPruner.&lt;br/&gt;
I think this is the best compromise we can achieve between safety and performance, while still enabling msck repair in every case.&lt;/p&gt;</comment>
                            <comment id="15892177" author="hiveqa" created="Thu, 2 Mar 2017 12:45:25 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12855587/HIVE-16024.04.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12855587/HIVE-16024.04.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 11 failed/errored test(s), 10283 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestCommandProcessorFactory - did not produce a TEST-*.xml file (likely timed out) (batchId=272)
TestDbTxnManager - did not produce a TEST-*.xml file (likely timed out) (batchId=272)
TestDummyTxnManager - did not produce a TEST-*.xml file (likely timed out) (batchId=272)
TestHiveInputSplitComparator - did not produce a TEST-*.xml file (likely timed out) (batchId=272)
TestIndexType - did not produce a TEST-*.xml file (likely timed out) (batchId=272)
TestSplitFilter - did not produce a TEST-*.xml file (likely timed out) (batchId=272)
org.apache.hadoop.hive.cli.TestBeeLineDriver.testCliDriver[escape_comments] (batchId=229)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_vec_table] (batchId=147)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_if_expr] (batchId=140)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query23] (batchId=224)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[vector_between_in] (batchId=119)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/3891/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/3891/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/3891/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/3891/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-3891/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-3891/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 11 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12855587 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15892462" author="zsombor.klara" created="Thu, 2 Mar 2017 16:05:44 +0000"  >&lt;p&gt;2 failures are well known flaky/failing tests:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;query23: &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-15744&quot; title=&quot;Flaky test: TestPerfCliDriver.query23, query14&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-15744&quot;&gt;&lt;del&gt;HIVE-15744&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;vector_if_expr: &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-15776&quot; title=&quot;Flaky test: TestMiniLlapLocalCliDriver vector_if_expr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-15776&quot;&gt;HIVE-15776&lt;/a&gt;&lt;br/&gt;
the rest have been failing for several builds:&lt;/li&gt;
	&lt;li&gt;schema_evol_text_vec_table - failing for 4 builds&lt;/li&gt;
	&lt;li&gt;escape_comments - failing for 5 builds&lt;/li&gt;
	&lt;li&gt;vector_between_in - failing for 16 builds&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15892579" author="vihangk1" created="Thu, 2 Mar 2017 16:44:27 +0000"  >&lt;p&gt;Looks like the failures are not related. Thanks for the change &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zsombor.klara&quot; class=&quot;user-hover&quot; rel=&quot;zsombor.klara&quot;&gt;zsombor.klara&lt;/a&gt; Looks good to me. +1 (non-binding)&lt;/p&gt;</comment>
                            <comment id="15892804" author="spena" created="Thu, 2 Mar 2017 19:08:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zsombor.klara&quot; class=&quot;user-hover&quot; rel=&quot;zsombor.klara&quot;&gt;zsombor.klara&lt;/a&gt; Could we add a comment on why we&apos;re using a different approach when HIVEMAPREDMODE is in strict mode? Developers would get confused, and they would want to use the PartitionIterable instead.&lt;/p&gt;</comment>
                            <comment id="15893193" author="spena" created="Thu, 2 Mar 2017 22:54:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zsombor.klara&quot; class=&quot;user-hover&quot; rel=&quot;zsombor.klara&quot;&gt;zsombor.klara&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I took a look at the code again, and I think there might be a OOM problem even if we fetch all partitions in batches (using PartitionIterable) when the strict mode is used. Here&apos;s the piece of code:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;void checkTable(Table table, PartitionIterable parts,
      boolean findUnknownPartitions, CheckResult result) throws IOException,
      HiveException {
...
Set&amp;lt;Path&amp;gt; partPaths = new HashSet&amp;lt;Path&amp;gt;();
...
for (Partition partition : parts) {
...
     if (!fs.exists(partPath)) {
        PartitionResult pr = new PartitionResult();
        pr.setPartitionName(partition.getName());
        pr.setTableName(partition.getTable().getTableName());
        result.getPartitionsNotOnFs().add(pr);
      }

      for (int i = 0; i &amp;lt; partition.getSpec().size(); i++) {
        partPaths.add(partPath.makeQualified(fs));
        partPath = partPath.getParent();
      }
}
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;My concern is that when running MSCK with million of partitions (fetched in batches), and none of the partitions exist on the filesystem, then the above code will add each partition name on the CheckResult object and partition locations on the partPaths temporary. There&apos;s no statistics, but still a concern about OOM. Should we refactor that code instead for handling partitions in batches on MSCK better?&lt;/p&gt;</comment>
                            <comment id="15893511" author="vihangk1" created="Fri, 3 Mar 2017 01:03:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=spena&quot; class=&quot;user-hover&quot; rel=&quot;spena&quot;&gt;spena&lt;/a&gt; Thats a good point. But I think each PartitionResult object is just a container of 2 String objects (PartitionName and TableName) which is probably more light-weight than Partition object. It will only be used when metastore knows about it and it not present in FS. That may be an uncommon case (reverse cases where partition is on FS and not present in Metastore might be more common). Another idea would be to use &lt;tt&gt;StringInternUtils.internUriStringsInPath(partPath)&lt;/tt&gt; like it was done by Misha in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-15882&quot; title=&quot;HS2 generating high memory pressure with many partitions and concurrent queries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-15882&quot;&gt;&lt;del&gt;HIVE-15882&lt;/del&gt;&lt;/a&gt; so that lots of duplicate strings are eliminated. These path objects might already have been interned when they were discovered or added the first time but doesn&apos;t hurt doing them again here. We should perhaps do some experiments to see when OOM happens for msck.&lt;/p&gt;</comment>
                            <comment id="15897994" author="spena" created="Mon, 6 Mar 2017 20:17:10 +0000"  >&lt;p&gt;As &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vihangk1&quot; class=&quot;user-hover&quot; rel=&quot;vihangk1&quot;&gt;vihangk1&lt;/a&gt; mentioned, seems this regression issue was introduced unintentionally by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-13788&quot; title=&quot;hive msck listpartitions need to make use of directSQL instead of datanucleus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-13788&quot;&gt;&lt;del&gt;HIVE-13788&lt;/del&gt;&lt;/a&gt;. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hsubramaniyan&quot; class=&quot;user-hover&quot; rel=&quot;hsubramaniyan&quot;&gt;hsubramaniyan&lt;/a&gt; Do you know if &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-13788&quot; title=&quot;hive msck listpartitions need to make use of directSQL instead of datanucleus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-13788&quot;&gt;&lt;del&gt;HIVE-13788&lt;/del&gt;&lt;/a&gt; was attempting to prevent a user to use MSCK when hive.mapred.mode was in strict mode? If we use strict mode, then users won&apos;t be allowed to recover unknown partitions unless they mention the partition, but they&apos;re unknown.&lt;/p&gt;</comment>
                            <comment id="15902708" author="zsombor.klara" created="Thu, 9 Mar 2017 08:58:47 +0000"  >&lt;p&gt;I think even if the strict mode check was introduced unintentionally, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=spena&quot; class=&quot;user-hover&quot; rel=&quot;spena&quot;&gt;spena&lt;/a&gt; is right in that we should keep guarding against OOMs. But maybe we could do it in a separate Jira and fix the regression in this one. As the author of the original Jira would you agree &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hsubramaniyan&quot; class=&quot;user-hover&quot; rel=&quot;hsubramaniyan&quot;&gt;hsubramaniyan&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="15904874" author="zsombor.klara" created="Fri, 10 Mar 2017 10:38:41 +0000"  >&lt;p&gt;As suggested &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;internalised the path strings&lt;/li&gt;
	&lt;li&gt;used fixed size collections for the results and added a negative qtest to verify it&lt;/li&gt;
	&lt;li&gt;confirmed that we are already using direct sql instead of DataNucleus when returning the partitions&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15905128" author="hiveqa" created="Fri, 10 Mar 2017 14:12:25 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12857304/HIVE-16024.05.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12857304/HIVE-16024.05.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 3 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 10344 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/4068/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/4068/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/4068/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/4068/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-4068/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-4068/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12857304 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15928315" author="zsombor.klara" created="Thu, 16 Mar 2017 15:56:23 +0000"  >&lt;p&gt;Updated the patch based on review board comments.&lt;/p&gt;</comment>
                            <comment id="15930096" author="zsombor.klara" created="Fri, 17 Mar 2017 15:05:51 +0000"  >&lt;p&gt;Reuploading patch because the pre-commit tests did not run.&lt;/p&gt;</comment>
                            <comment id="15932346" author="zsombor.klara" created="Mon, 20 Mar 2017 09:01:46 +0000"  >&lt;p&gt;Updated patch after RB comments. (Changed qtest)&lt;/p&gt;</comment>
                            <comment id="15932473" author="hiveqa" created="Mon, 20 Mar 2017 10:40:30 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12859516/HIVE-16024.07.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12859516/HIVE-16024.07.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 2 failed/errored test(s), 10449 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=12)
	[auto_join18.q,partition_coltype_literals.q,input1_limit.q,load_dyn_part3.q,autoColumnStats_4.q,correlationoptimizer8.q,auto_sortmerge_join_14.q,udf_array_contains.q,bucket_map_join_tez2.q,sample_islocalmode_hook.q,literal_decimal.q,constprog2.q,parquet_external_time.q,mapjoin_hook.q,schema_evol_orc_nonvec_table.q,cbo_rp_subq_in.q,authorization_view_disable_cbo_4.q,list_bucket_dml_2.q,input20.q,smb_join_partition_key.q,union_remove_14.q,non_ascii_literal2.q,udf_if.q,input38.q,load_fs_overwrite.q,input21.q,join_reorder.q,groupby_cube_multi_gby.q,bucketmapjoin8.q,union34.q]
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[comments] (batchId=35)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/4244/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/4244/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/4244/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/4244/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-4244/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-4244/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12859516 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15932477" author="zsombor.klara" created="Mon, 20 Mar 2017 10:43:07 +0000"  >&lt;p&gt;The test &quot;comments&quot; has been failing for 5 builds.&lt;/p&gt;</comment>
                            <comment id="15932874" author="spena" created="Mon, 20 Mar 2017 15:50:11 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zsombor.klara&quot; class=&quot;user-hover&quot; rel=&quot;zsombor.klara&quot;&gt;zsombor.klara&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Are those failing flaky tests already reported on another JIRA?&lt;/p&gt;</comment>
                            <comment id="15932907" author="zsombor.klara" created="Mon, 20 Mar 2017 15:59:09 +0000"  >&lt;p&gt;TestCliDriver&lt;span class=&quot;error&quot;&gt;&amp;#91;comments&amp;#93;&lt;/span&gt; didn&apos;t have a Jira yet. I raised &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-16256&quot; title=&quot;Flaky test: TestCliDriver.testCliDriver[comments]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-16256&quot;&gt;&lt;del&gt;HIVE-16256&lt;/del&gt;&lt;/a&gt; to cover it but based on the diff I&apos;m not sure if this is the fault of the test itself. I checked locally and I cannot reproduce it so it&apos;s not just that someone forgot to update the baseline.&lt;/p&gt;</comment>
                            <comment id="15932935" author="spena" created="Mon, 20 Mar 2017 16:10:42 +0000"  >&lt;p&gt;I committed this patch to master.&lt;br/&gt;
Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zsombor.klara&quot; class=&quot;user-hover&quot; rel=&quot;zsombor.klara&quot;&gt;zsombor.klara&lt;/a&gt; for your contribution. I see the tests are not related, and a JIRA is reported.&lt;/p&gt;</comment>
                            <comment id="15933647" author="lefty@hortonworks.com" created="Mon, 20 Mar 2017 21:49:39 +0000"  >&lt;p&gt;Does this need any documentation in the wiki?  It looks like a simple bug fix, but here are the relevant doc links just in case:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-RecoverPartitions(MSCKREPAIRTABLE)&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Recover Partitions (MSCK REPAIR TABLE) &lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.mapred.mode&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Configuration Properties &amp;#8211; hive.mapred.mode &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15940125" author="zsombor.klara" created="Fri, 24 Mar 2017 10:30:23 +0000"  >&lt;p&gt;Thanks for reminding me &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=leftylev&quot; class=&quot;user-hover&quot; rel=&quot;leftylev&quot;&gt;leftylev&lt;/a&gt;, but I think that this patch didn&apos;t change anything really worth documenting.&lt;/p&gt;</comment>
                            <comment id="15941580" author="lefty@hortonworks.com" created="Sat, 25 Mar 2017 05:02:00 +0000"  >&lt;p&gt;Okay, thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12854226" name="HIVE-16024.01.patch" size="2301" author="zsombor.klara" created="Thu, 23 Feb 2017 15:19:09 +0000"/>
                            <attachment id="12854451" name="HIVE-16024.02.patch" size="3582" author="zsombor.klara" created="Fri, 24 Feb 2017 11:21:50 +0000"/>
                            <attachment id="12855351" name="HIVE-16024.03.patch" size="4541" author="zsombor.klara" created="Wed, 1 Mar 2017 11:26:05 +0000"/>
                            <attachment id="12855587" name="HIVE-16024.04.patch" size="5579" author="zsombor.klara" created="Thu, 2 Mar 2017 09:40:39 +0000"/>
                            <attachment id="12857304" name="HIVE-16024.05.patch" size="17349" author="zsombor.klara" created="Fri, 10 Mar 2017 10:38:41 +0000"/>
                            <attachment id="12859308" name="HIVE-16024.06.patch" size="6042" author="zsombor.klara" created="Fri, 17 Mar 2017 15:05:51 +0000"/>
                            <attachment id="12859516" name="HIVE-16024.07.patch" size="6331" author="zsombor.klara" created="Mon, 20 Mar 2017 09:01:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 34 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3aikf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12335837">2.2.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>