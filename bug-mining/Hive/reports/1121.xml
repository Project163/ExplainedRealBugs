<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:04:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-3403] user should not specify mapjoin to perform sort-merge bucketed join</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3403</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Currently, in order to perform a sort merge bucketed join, the user needs&lt;br/&gt;
to set hive.optimize.bucketmapjoin.sortedmerge to true, and also specify the &lt;br/&gt;
mapjoin hint.&lt;/p&gt;

&lt;p&gt;The user should not specify any hints.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12604358">HIVE-3403</key>
            <summary>user should not specify mapjoin to perform sort-merge bucketed join</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="namit">Namit Jain</assignee>
                                    <reporter username="namit">Namit Jain</reporter>
                        <labels>
                            <label>TODOC11</label>
                    </labels>
                <created>Wed, 22 Aug 2012 10:12:40 +0000</created>
                <updated>Sun, 4 Dec 2016 05:48:51 +0000</updated>
                            <resolved>Tue, 19 Feb 2013 05:17:51 +0000</resolved>
                                                    <fixVersion>0.11.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                                                                <comments>
                            <comment id="13439418" author="namit" created="Wed, 22 Aug 2012 11:17:40 +0000"  >&lt;p&gt;If the input tables are bucketed/sorted on the join keys, and we convert&lt;br/&gt;
the join to sort-merge bucketed map join, the only drawback is that we will&lt;br/&gt;
use BucketizedHiveInputFormat (or one mapper per file), which may restrict the&lt;br/&gt;
parallelism if the input files are large.&lt;/p&gt;

&lt;p&gt;In most of the cases, the advantages of sort merge join (and no reducer) should&lt;br/&gt;
overweigh the reduced parallelism. I can add a configurable parameter for this&lt;br/&gt;
behavior to be triggered, if need be.&lt;/p&gt;

&lt;p&gt;In general, it seems a good idea to automatically use sort-merge join whenever possible.&lt;/p&gt;</comment>
                            <comment id="13452812" author="namit" created="Tue, 11 Sep 2012 08:08:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://reviews.facebook.net/D5325&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D5325&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13452814" author="namit" created="Tue, 11 Sep 2012 08:09:55 +0000"  >&lt;p&gt;This is a patch in progress.&lt;/p&gt;

&lt;p&gt;Please review.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;navis&lt;/a&gt;, it would be really helpful if you can review it thoroughly. Others are also welcome.&lt;br/&gt;
I will let &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3283&quot; title=&quot;bucket information should be used from the partition instead of the table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3283&quot;&gt;&lt;del&gt;HIVE-3283&lt;/del&gt;&lt;/a&gt; go in first.&lt;/p&gt;</comment>
                            <comment id="13459355" author="navis" created="Thu, 20 Sep 2012 05:17:34 +0000"  >&lt;p&gt;@Namit Jain;&lt;br/&gt;
I&apos;ve just released from &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3381&quot; title=&quot;Result of outer join is not valid&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3381&quot;&gt;&lt;del&gt;HIVE-3381&lt;/del&gt;&lt;/a&gt;. Let&apos;s start looking into this.&lt;/p&gt;

&lt;p&gt;I think this patch tries to solve two issues simultaneously. One is for merging two config to single one as mentioned above, and the other is for extending SMBOptimizer by additional conversion rule (JOIN to SMBJOIN directly), which is great. Is it possible to use it with hive.auto.convert.join=true? &lt;/p&gt;</comment>
                            <comment id="13459361" author="namit" created="Thu, 20 Sep 2012 05:45:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;navis&lt;/a&gt;, Thanks for looking into this.&lt;/p&gt;

&lt;p&gt;I like the idea of using it with hive.auto.convert.join.&lt;br/&gt;
But, do you think we should do it in a follow-up ? I mean, let this stabilize and then change.&lt;br/&gt;
But, then we will have a backward compatibility issue - OK, I will change it to use hive.auto.convert.join&lt;/p&gt;</comment>
                            <comment id="13459517" author="namit" created="Thu, 20 Sep 2012 11:16:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;navis&lt;/a&gt;, thinking more about it - I am not sure.&lt;br/&gt;
If we go the route of hive.auto.convert.join, do we risk deployment ?&lt;br/&gt;
I mean, hive.auto.convert.join is a very stable feature and should be set to true&lt;br/&gt;
in most of the installations. Do we want to risk a new functionality on this one ?&lt;/p&gt;

&lt;p&gt;I would say - let us have an additional config. for now, but once we are more confident of&lt;br/&gt;
it&apos;s functionality, we can add this behavior in hive.auto.convert.join.&lt;/p&gt;</comment>
                            <comment id="13479263" author="namit" created="Thu, 18 Oct 2012 19:14:09 +0000"  >&lt;p&gt;Had an offline review with Kevin - the following came out of that:&lt;/p&gt;

&lt;p&gt;1. The policy to choose the big table should take the average size of the partition into account.&lt;br/&gt;
   We dont need to change the existing policy, can add a new policy.&lt;br/&gt;
2. The new policy should give preference to a table with no partitions/ 1 partition.&lt;br/&gt;
3. If one of the tables is small enough to fit in memory, there is no need to perform sort-merge join. The&lt;br/&gt;
   policy should check that. Eventually, that check should be removed, and that should be handled by the physical&lt;br/&gt;
   optimizer - will file a new jira for that.&lt;/p&gt;</comment>
                            <comment id="13492110" author="mgrover" created="Wed, 7 Nov 2012 04:25:33 +0000"  >&lt;p&gt;Sorry for joining the party a little late.&lt;/p&gt;

&lt;p&gt;Just a thought: we already have a property hive.optimize.bucketmapjoin that deals with the same question - whether or not to use BucketizedHiveInputFormat. Would it make sense to use the same property? I would go as far as saying, most people who would want to auto-convert their joins to bucketed joins would be interested in converting their joins to sort-merge bucketed joins (if data is sorted per join keys).&lt;/p&gt;

&lt;p&gt;What do you think?&lt;/p&gt;</comment>
                            <comment id="13492282" author="namit" created="Wed, 7 Nov 2012 11:33:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mgrover&quot; class=&quot;user-hover&quot; rel=&quot;mgrover&quot;&gt;mgrover&lt;/a&gt;, typically we have erred on the side on having more configurable parameters in hive, rather than over-loading a parameter.&lt;br/&gt;
There is no correct answer for this, but I would prefer to have an additional conf. Moreover, hive.optimize.bucketmapjoin, only converts map-joins to&lt;br/&gt;
bucketized map joins, whenever possible. However, here, the user is not giving any hints, and we are converting the query to use sort-merge joins.&lt;/p&gt;</comment>
                            <comment id="13492451" author="mgrover" created="Wed, 7 Nov 2012 16:03:33 +0000"  >&lt;p&gt;Fair enough. I am ok with a new parameter.&lt;/p&gt;</comment>
                            <comment id="13493358" author="namit" created="Thu, 8 Nov 2012 18:13:52 +0000"  >&lt;p&gt;Added tests - this is ready for review&lt;/p&gt;</comment>
                            <comment id="13498326" author="kevinwilfong" created="Thu, 15 Nov 2012 20:54:15 +0000"  >&lt;p&gt;Comments on Phabricator.&lt;/p&gt;</comment>
                            <comment id="13501716" author="namit" created="Wed, 21 Nov 2012 06:07:32 +0000"  >&lt;p&gt;addressed comments&lt;/p&gt;</comment>
                            <comment id="13552501" author="namit" created="Mon, 14 Jan 2013 08:24:31 +0000"  >&lt;p&gt;If one of the tables is small enough to fit in memory, there is no need to perform sort-merge join. The&lt;br/&gt;
policy should check that. Eventually, that check should be removed, and that should be handled by the physical&lt;br/&gt;
optimizer - will file a new jira for that.&lt;/p&gt;

&lt;p&gt;I had filed &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3598&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-3598&lt;/a&gt; for that, but since sub-query support for map-joins&lt;br/&gt;
has gone in, this change is more complicated. Will do the backup task in a new jira.&lt;/p&gt;</comment>
                            <comment id="13552503" author="namit" created="Mon, 14 Jan 2013 08:25:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12564394/hive.3403.12.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12564394/hive.3403.12.patch&lt;/a&gt; contains the changes with the backup task.&lt;br/&gt;
Will clean it up, remove the backup task from &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3403&quot; title=&quot;user should not specify mapjoin to perform sort-merge bucketed join&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3403&quot;&gt;&lt;del&gt;HIVE-3403&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13552770" author="namit" created="Mon, 14 Jan 2013 15:11:29 +0000"  >&lt;p&gt;The tests run fine&lt;/p&gt;</comment>
                            <comment id="13552771" author="namit" created="Mon, 14 Jan 2013 15:11:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kevinwilfong&quot; class=&quot;user-hover&quot; rel=&quot;kevinwilfong&quot;&gt;kevinwilfong&lt;/a&gt;, can u take a look ?&lt;/p&gt;</comment>
                            <comment id="13555922" author="namit" created="Thu, 17 Jan 2013 06:49:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;navis&lt;/a&gt;, can you take a look at this patch, since you very familiar with join code ?&lt;/p&gt;</comment>
                            <comment id="13558826" author="namit" created="Mon, 21 Jan 2013 15:13:44 +0000"  >&lt;p&gt;The support for sub-queries has also been added in this.&lt;/p&gt;</comment>
                            <comment id="13562688" author="namit" created="Fri, 25 Jan 2013 13:51:58 +0000"  >&lt;p&gt;waiting for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3784&quot; title=&quot;de-emphasize mapjoin hint&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3784&quot;&gt;&lt;del&gt;HIVE-3784&lt;/del&gt;&lt;/a&gt; first&lt;/p&gt;</comment>
                            <comment id="13567412" author="namit" created="Thu, 31 Jan 2013 07:00:06 +0000"  >&lt;p&gt;To help	in review, the class hierarchy is:&lt;/p&gt;

&lt;p&gt;AbstractBucketJoinProc&lt;br/&gt;
       subclass1 : AbstractSMBJoinProc&lt;br/&gt;
             subclass1 : subclass1 : SortedMergeBucketMapjoinProc&lt;br/&gt;
             subclass1: subclass2: SortedMergeJoinProc&lt;br/&gt;
       subclass2: BucketMapjoinOptProc&lt;/p&gt;


&lt;p&gt;The context needed is:&lt;/p&gt;

&lt;p&gt;BucketJoinOptProcCtx&lt;br/&gt;
       subclass1: SortBucketJoinOptProcCtx&lt;/p&gt;

&lt;p&gt;Most of the code in AbstractBucketJoinProc and AbstractSMBJoinProc is old code moved.&lt;br/&gt;
BucketMapjoinOptProc is also old code &#8211; but there has been little refactoring to break it up into context.&lt;/p&gt;

&lt;p&gt;As such, the only new code is SortedMergeJoinProc. Due to the refactoring, I am	able to	re-use a lot of	code&lt;br/&gt;
between	map-join and join processing.&lt;/p&gt;</comment>
                            <comment id="13568377" author="namit" created="Fri, 1 Feb 2013 02:08:03 +0000"  >&lt;p&gt;All tests passed&lt;/p&gt;</comment>
                            <comment id="13569685" author="ashutoshc" created="Sun, 3 Feb 2013 01:28:09 +0000"  >&lt;p&gt;Left some comments on phabricator.&lt;/p&gt;</comment>
                            <comment id="13570045" author="namit" created="Mon, 4 Feb 2013 07:42:37 +0000"  >&lt;p&gt;comments addressed + tests pass&lt;/p&gt;</comment>
                            <comment id="13575262" author="ashutoshc" created="Sat, 9 Feb 2013 20:56:45 +0000"  >&lt;p&gt;I concur with Mark&apos;s above comments. I don&apos;t agree that erring on the side of more configs is a good idea. e.g., the if-else ladder after this patch will look like following:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; user specifies map join hint &amp;amp;&amp;amp; hive.optimize.bucketmapjoin is &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, than a map-join may be converted to BMJ.

&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; user specifies map join hint &amp;amp;&amp;amp; hive.optimize.bucketmapjoin is &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; &amp;amp;&amp;amp; hive.optimize.sortedmerge is &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, than a map-join may be converted to SMBJ.

&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; user doesn&apos;t specify map join hint &amp;amp;&amp;amp; hive.optimize.bucketmapjoin &amp;amp;&amp;amp; hive.optimize.sortedmerge is &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; &amp;amp;&amp;amp; hive.optimize.auto.convert.sortmerge.join is &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, than a regular may be converted may be converted to SMBJ.

... and than there is hive.auto.covert.join, hive.auto.convert.join.noconditionaltask and many others...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;instead of simplifying the life of user which I believe is the original goal of jira, we are making his life complicated by introducing even more config which he needs to understand. Btw, I am not 100% even if I got the above settings right. Further, the fact that default value for every optimization is false means user ends up in worst of both worlds where none of the optimization kicks in and query runs slow. &lt;br/&gt;
To improve from state of art, my suggestions are following:&lt;br/&gt;
a) Lets get rid of hints altogether, i.e., we never construct logical plan with a MapJoin/SMBJoin/BJoin operator but always with regular join operator. And than in optimization phase we convert regular join to most optimal join implementation depending on sorting/bucketing properties and sizes of tables. This will simplify the codebase since we always see regular join in our operator tree in logical phase, thus eliminating need of handling MapJoin operator at logical level. Also, this simplifies the interaction of hints and configs like user provided hint but config is off.. kind of scenarios...&lt;br/&gt;
b) We should compress all these different configs to lower number of configs.&lt;br/&gt;
c) We should set the default value true for all these configs.&lt;/p&gt;

&lt;p&gt;Namit, do you think its possible to do this or do you see any problem in this plan? &lt;/p&gt;</comment>
                            <comment id="13575336" author="ashutoshc" created="Sun, 10 Feb 2013 04:15:33 +0000"  >&lt;p&gt;Thinking more about my point a) above, there are three potential join optimization opportunities:&lt;br/&gt;
a) Convert a JoinOperator to non-bucketed MapJoinOperator.&lt;br/&gt;
b) Convert a JoinOperator to bucketed MapJoinOpperator.&lt;br/&gt;
c) Convert a JoinOperator to sort-merge-bucketed MapJoinOperator.&lt;/p&gt;

&lt;p&gt;Among these c) doesn&apos;t need to buffer data in memory, so can be determined completely at compile time, which this patch enables. a) and b) buffers data in memory so need to be done at run time. a) is already taken care of in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3784&quot; title=&quot;de-emphasize mapjoin hint&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3784&quot;&gt;&lt;del&gt;HIVE-3784&lt;/del&gt;&lt;/a&gt;. &lt;br/&gt;
So, we are left with b) now. With this patch, we will convert a Join Operator to bucketed MapJoin Operator at compile time by attempting to convert a map-join operator (which will be there because user provided the hint). But ideally this should also be done at runtime just like a). At run-time we should see first if tables are bucketed than check if the size of required buckets of smaller table can fit in memory and if they do than convert a JoinOperator to BMJ. If table is not bucketed than check size of whole of small table and than convert it into non-bucketed map-join. If we do this than we can completely get rid of map-join hints. If we get there, that will be advantageous to users since they never have to provide hints in their queries, hive optimizer will generate most optimal plan possible. It will be advantageous to hive devs since they will never have to bother about map-join operators in query compilation phase because map-join operator will never be part of plan at compile time. It will only appear at run-time if Join Operator is optimized to MapJoin Operator. This will simplify semantic analysis, plan generation and compile time optimizations a lot.&lt;br/&gt;
Namit, is this analysis correct? &lt;/p&gt;</comment>
                            <comment id="13575358" author="namit" created="Sun, 10 Feb 2013 06:32:22 +0000"  >&lt;p&gt;Yes, but we need to get there slowly - the idea is to get rid of the map-join hint eventually, and this jira is a step in that direction.&lt;br/&gt;
c) above will be achieved with this jira. &lt;/p&gt;

&lt;p&gt;With &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3891&quot; title=&quot;physical optimizer changes for auto sort-merge join&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3891&quot;&gt;&lt;del&gt;HIVE-3891&lt;/del&gt;&lt;/a&gt; (which is also patch available), a backup task will be created for the map-join, just like a) above.&lt;/p&gt;

&lt;p&gt;I agree, I am adding more config. variables right now - the idea behind them is to test them slowly in deployment.&lt;br/&gt;
In case there are bugs, it would be easy to turn them off. Although there are more configs, it is still much easier than&lt;br/&gt;
hints - once these configs are stabilized, we can change the defaults of these configs, and we dont need to specify anything&lt;br/&gt;
(hint) per query.&lt;/p&gt;

&lt;p&gt;Doing b) automatically requires most work, among a), b) and c), since we need to load all the buckets - theoritically, we can&lt;br/&gt;
load the largest bucket and decide based on that. That is definitely a big enough patch, and should not be part of this jira.&lt;/p&gt;</comment>
                            <comment id="13576873" author="ashutoshc" created="Tue, 12 Feb 2013 18:41:50 +0000"  >&lt;p&gt;Make sense. I am not suggesting to include all that in this jira, but wanted to make sure we are on same page as to where are heading.&lt;br/&gt;
Though, w.r.t, configs I can see your point about adding more configs, but I still think by default optimization configs should be on. Whole point of release is to ship stable codebase. By definition trunk is not considered stable (as stable as in making release out of it), so time we get between committing to trunk and releasing is for stablizing new codebase, but if by default configs are off, bugs lurking in new codebase will never be exposed.  &lt;/p&gt;</comment>
                            <comment id="13577198" author="vikram.dixit" created="Wed, 13 Feb 2013 00:10:38 +0000"  >&lt;p&gt;In the patch, the auto_sortmerge_join_6.q is missing.&lt;/p&gt;</comment>
                            <comment id="13577224" author="vikram.dixit" created="Wed, 13 Feb 2013 00:40:24 +0000"  >&lt;p&gt;I run with a modified version of the auto_sortmerge_join_1.q file (attached to the JIRA) and create a query where 2 of the tables in a join are sorted and bucketed and the 3rd table is not sorted. I have enabled the auto map join convert config. I am seeing this exception:&lt;/p&gt;

&lt;p&gt;FAILED: ClassCastException org.apache.hadoop.hive.ql.exec.SMBMapJ&lt;br/&gt;
oinOperator cannot be cast to org.apache.hadoop.hive.ql.exec.MapJoinOperator&lt;/p&gt;

&lt;p&gt;I do not see the exception if I set the noConditionalTask.size to a size greater than the size of the 2 small tables (src1 and small_table) for e.g. 500.&lt;/p&gt;</comment>
                            <comment id="13577315" author="namit" created="Wed, 13 Feb 2013 04:00:55 +0000"  >&lt;p&gt;Thanks Vikram, I will take a look.&lt;/p&gt;</comment>
                            <comment id="13577316" author="namit" created="Wed, 13 Feb 2013 04:01:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt;, I can change the default in a follow-up. Again, wanted to be conservative&lt;/p&gt;</comment>
                            <comment id="13578186" author="namit" created="Thu, 14 Feb 2013 06:38:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vikram.dixit&quot; class=&quot;user-hover&quot; rel=&quot;vikram.dixit&quot;&gt;vikram.dixit&lt;/a&gt;, I am still trying - not able to get to the root cause.&lt;/p&gt;</comment>
                            <comment id="13580449" author="namit" created="Mon, 18 Feb 2013 06:18:20 +0000"  >&lt;p&gt;Tests passed.&lt;/p&gt;

&lt;p&gt;Added a new test for the scenario encountered by Vikram&lt;/p&gt;</comment>
                            <comment id="13580458" author="ashutoshc" created="Mon, 18 Feb 2013 06:42:38 +0000"  >&lt;p&gt;What was the bug?&lt;/p&gt;</comment>
                            <comment id="13580477" author="namit" created="Mon, 18 Feb 2013 08:00:30 +0000"  >&lt;p&gt;Look at the changes in SMBJoinOperator.java.&lt;br/&gt;
Previously, SMB followed by Join was performed in 2MR jobs. With the cleanup, we can perform&lt;br/&gt;
that in a single MR.&lt;/p&gt;</comment>
                            <comment id="13580753" author="ashutoshc" created="Mon, 18 Feb 2013 18:35:40 +0000"  >&lt;p&gt;I see. We were unnecessarily dealing with SMBJOp in the mapper which was streaming through records for third table of Join. Ideally, each mapper(and reducer) should just have a plan for itself and not the global plan, ie mapper for third table shouldn&apos;t see SMBJOp at all. But thats a quite fundamental change, given that at the moment we generate uniform plan for whole of MR job. &lt;br/&gt;
This patch is already outstanding for more than 6 months. Lets get this in. &lt;br/&gt;
+1 Namit, can you commit this. &lt;br/&gt;
Also would you like to take up follow on &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3980&quot; title=&quot;Cleanup after HIVE-3403&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3980&quot;&gt;&lt;del&gt;HIVE-3980&lt;/del&gt;&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="13580978" author="namit" created="Tue, 19 Feb 2013 03:02:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt;, will address &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3980&quot; title=&quot;Cleanup after HIVE-3403&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3980&quot;&gt;&lt;del&gt;HIVE-3980&lt;/del&gt;&lt;/a&gt; after this ?&lt;/p&gt;</comment>
                            <comment id="13581021" author="namit" created="Tue, 19 Feb 2013 04:39:35 +0000"  >&lt;p&gt;Filed &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4038&quot; title=&quot;each mapper/reducer should have a plan for itself rather than the global plan&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4038&quot;&gt;HIVE-4038&lt;/a&gt; for the mapper/reducer individual plan.&lt;/p&gt;</comment>
                            <comment id="13581032" author="namit" created="Tue, 19 Feb 2013 05:17:51 +0000"  >&lt;p&gt;Committed. Thanks Ashutosh &lt;/p&gt;</comment>
                            <comment id="13581165" author="hudson" created="Tue, 19 Feb 2013 09:50:23 +0000"  >&lt;p&gt;Integrated in hive-trunk-hadoop1 #91 (See &lt;a href=&quot;https://builds.apache.org/job/hive-trunk-hadoop1/91/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/hive-trunk-hadoop1/91/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3403&quot; title=&quot;user should not specify mapjoin to perform sort-merge bucketed join&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3403&quot;&gt;&lt;del&gt;HIVE-3403&lt;/del&gt;&lt;/a&gt; user should not specify mapjoin to perform sort-merge bucketed join&lt;br/&gt;
(Namit Jain via Ashutosh) (Revision 1447593)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1447593&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1447593&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/conf/hive-default.xml.template&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/smallsrcsortbucket1outof4.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/smallsrcsortbucket2outof4.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/smallsrcsortbucket3outof4.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/smallsrcsortbucket4outof4.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FilterOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/SMBMapJoinOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/SelectOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/TableScanOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/AbstractBucketJoinProc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/AbstractSMBJoinProc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/AvgPartitionSizeBasedBigTableSelectorForAutoSMJ.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/BigTableSelectorForAutoSMJ.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/BucketJoinProcCtx.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/BucketMapJoinOptimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/BucketMapjoinProc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/LeftmostBigTableSelectorForAutoSMJ.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SizeBasedBigTableSelectorForAutoSMJ.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SortBucketJoinProcCtx.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SortedMergeBucketMapJoinOptimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SortedMergeBucketMapjoinProc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SortedMergeJoinProc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/TableSizeBasedBigTableSelectorForAutoSMJ.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinResolver.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/ParseContext.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/SMBJoinDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientnegative/smb_mapjoin_14.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_smb_mapjoin_14.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_10.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_2.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_3.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_4.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_5.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_6.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_7.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_8.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_9.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_smb_mapjoin_14.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_10.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_6.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_9.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13581588" author="hudson" created="Tue, 19 Feb 2013 20:19:05 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #128 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/128/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/128/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3403&quot; title=&quot;user should not specify mapjoin to perform sort-merge bucketed join&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3403&quot;&gt;&lt;del&gt;HIVE-3403&lt;/del&gt;&lt;/a&gt; user should not specify mapjoin to perform sort-merge bucketed join&lt;br/&gt;
(Namit Jain via Ashutosh) (Revision 1447593)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1447593&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1447593&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/conf/hive-default.xml.template&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/smallsrcsortbucket1outof4.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/smallsrcsortbucket2outof4.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/smallsrcsortbucket3outof4.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/smallsrcsortbucket4outof4.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FilterOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/SMBMapJoinOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/SelectOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/TableScanOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/AbstractBucketJoinProc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/AbstractSMBJoinProc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/AvgPartitionSizeBasedBigTableSelectorForAutoSMJ.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/BigTableSelectorForAutoSMJ.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/BucketJoinProcCtx.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/BucketMapJoinOptimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/BucketMapjoinProc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/LeftmostBigTableSelectorForAutoSMJ.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SizeBasedBigTableSelectorForAutoSMJ.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SortBucketJoinProcCtx.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SortedMergeBucketMapJoinOptimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SortedMergeBucketMapjoinProc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SortedMergeJoinProc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/TableSizeBasedBigTableSelectorForAutoSMJ.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinResolver.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/ParseContext.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/SMBJoinDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientnegative/smb_mapjoin_14.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_smb_mapjoin_14.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_10.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_2.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_3.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_4.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_5.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_6.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_7.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_8.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_9.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_smb_mapjoin_14.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_10.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_6.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_9.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13581656" author="hudson" created="Tue, 19 Feb 2013 21:46:02 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1976 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1976/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1976/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3403&quot; title=&quot;user should not specify mapjoin to perform sort-merge bucketed join&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3403&quot;&gt;&lt;del&gt;HIVE-3403&lt;/del&gt;&lt;/a&gt; user should not specify mapjoin to perform sort-merge bucketed join&lt;br/&gt;
(Namit Jain via Ashutosh) (Revision 1447593)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1447593&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1447593&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/conf/hive-default.xml.template&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/smallsrcsortbucket1outof4.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/smallsrcsortbucket2outof4.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/smallsrcsortbucket3outof4.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/smallsrcsortbucket4outof4.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FilterOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/SMBMapJoinOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/SelectOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/TableScanOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/AbstractBucketJoinProc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/AbstractSMBJoinProc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/AvgPartitionSizeBasedBigTableSelectorForAutoSMJ.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/BigTableSelectorForAutoSMJ.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/BucketJoinProcCtx.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/BucketMapJoinOptimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/BucketMapjoinProc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/LeftmostBigTableSelectorForAutoSMJ.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SizeBasedBigTableSelectorForAutoSMJ.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SortBucketJoinProcCtx.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SortedMergeBucketMapJoinOptimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SortedMergeBucketMapjoinProc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SortedMergeJoinProc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/TableSizeBasedBigTableSelectorForAutoSMJ.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinResolver.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/ParseContext.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/SMBJoinDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientnegative/smb_mapjoin_14.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_smb_mapjoin_14.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_10.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_2.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_3.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_4.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_5.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_6.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_7.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_8.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_sortmerge_join_9.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_smb_mapjoin_14.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_10.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_6.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_sortmerge_join_9.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15719384" author="lefty@hortonworks.com" created="Sun, 4 Dec 2016 05:48:51 +0000"  >&lt;p&gt;Doc note:  This adds &lt;b&gt;hive.auto.convert.sortmerge.join&lt;/b&gt; and &lt;b&gt;hive.auto.convert.sortmerge.join.bigtable.selection.policy&lt;/b&gt; to HiveConf.java in release 0.11.0, so they need to be documented in the wiki.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-QueryandDDLExecution&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Configuration Properties &amp;#8211; Query and DDL Execution &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Added a TODOC11 label.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                            <outwardlinks description="is a clone of">
                                        <issuelink>
            <issuekey id="12604357">HIVE-3402</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12623099">HIVE-3784</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12623099">HIVE-3784</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12599574">HIVE-3283</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12613846">HIVE-3633</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12627400">HIVE-3892</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12612477">HIVE-3598</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12627393">HIVE-3891</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12630612">HIVE-3980</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12569116" name="auto_sortmerge_join_1_modified.q" size="2471" author="vikram.dixit" created="Wed, 13 Feb 2013 00:40:24 +0000"/>
                            <attachment id="12545427" name="hive.3403.1.patch" size="230624" author="namit" created="Mon, 17 Sep 2012 15:09:53 +0000"/>
                            <attachment id="12564202" name="hive.3403.10.patch" size="421797" author="namit" created="Thu, 10 Jan 2013 17:22:57 +0000"/>
                            <attachment id="12564376" name="hive.3403.11.patch" size="424198" author="namit" created="Fri, 11 Jan 2013 08:01:02 +0000"/>
                            <attachment id="12564394" name="hive.3403.12.patch" size="424243" author="namit" created="Fri, 11 Jan 2013 11:31:48 +0000"/>
                            <attachment id="12564676" name="hive.3403.13.patch" size="315337" author="namit" created="Mon, 14 Jan 2013 09:06:50 +0000"/>
                            <attachment id="12564678" name="hive.3403.14.patch" size="318736" author="namit" created="Mon, 14 Jan 2013 09:52:43 +0000"/>
                            <attachment id="12565464" name="hive.3403.15.patch" size="318736" author="namit" created="Fri, 18 Jan 2013 10:52:26 +0000"/>
                            <attachment id="12565753" name="hive.3403.16.patch" size="417257" author="namit" created="Mon, 21 Jan 2013 09:01:30 +0000"/>
                            <attachment id="12565757" name="hive.3403.17.patch" size="416659" author="namit" created="Mon, 21 Jan 2013 09:56:12 +0000"/>
                            <attachment id="12567105" name="hive.3403.18.patch" size="416823" author="namit" created="Wed, 30 Jan 2013 04:46:00 +0000"/>
                            <attachment id="12567130" name="hive.3403.19.patch" size="390444" author="namit" created="Wed, 30 Jan 2013 12:06:23 +0000"/>
                            <attachment id="12551312" name="hive.3403.2.patch" size="236657" author="namit" created="Tue, 30 Oct 2012 07:14:23 +0000"/>
                            <attachment id="12567303" name="hive.3403.21.patch" size="415734" author="namit" created="Thu, 31 Jan 2013 05:30:41 +0000"/>
                            <attachment id="12567309" name="hive.3403.22.patch" size="499950" author="namit" created="Thu, 31 Jan 2013 06:56:33 +0000"/>
                            <attachment id="12567317" name="hive.3403.23.patch" size="499950" author="namit" created="Thu, 31 Jan 2013 08:21:05 +0000"/>
                            <attachment id="12567350" name="hive.3403.24.patch" size="500034" author="namit" created="Thu, 31 Jan 2013 11:56:47 +0000"/>
                            <attachment id="12567803" name="hive.3403.25.patch" size="501880" author="namit" created="Mon, 4 Feb 2013 05:58:50 +0000"/>
                            <attachment id="12567809" name="hive.3403.26.patch" size="534095" author="namit" created="Mon, 4 Feb 2013 07:05:48 +0000"/>
                            <attachment id="12569322" name="hive.3403.27.patch" size="567165" author="namit" created="Thu, 14 Feb 2013 08:13:34 +0000"/>
                            <attachment id="12569759" name="hive.3403.28.patch" size="566945" author="namit" created="Mon, 18 Feb 2013 04:54:35 +0000"/>
                            <attachment id="12569760" name="hive.3403.29.patch" size="565680" author="namit" created="Mon, 18 Feb 2013 05:00:07 +0000"/>
                            <attachment id="12552258" name="hive.3403.3.patch" size="430042" author="namit" created="Tue, 6 Nov 2012 10:45:42 +0000"/>
                            <attachment id="12569901" name="hive.3403.30.patch" size="565680" author="namit" created="Tue, 19 Feb 2013 03:39:12 +0000"/>
                            <attachment id="12552424" name="hive.3403.4.patch" size="429989" author="namit" created="Wed, 7 Nov 2012 06:25:47 +0000"/>
                            <attachment id="12552456" name="hive.3403.5.patch" size="442220" author="namit" created="Wed, 7 Nov 2012 11:35:43 +0000"/>
                            <attachment id="12552612" name="hive.3403.6.patch" size="484021" author="namit" created="Thu, 8 Nov 2012 04:45:47 +0000"/>
                            <attachment id="12552652" name="hive.3403.7.patch" size="502882" author="namit" created="Thu, 8 Nov 2012 11:47:25 +0000"/>
                            <attachment id="12552681" name="hive.3403.8.patch" size="413040" author="namit" created="Thu, 8 Nov 2012 18:13:27 +0000"/>
                            <attachment id="12554455" name="hive.3403.9.patch" size="413236" author="namit" created="Wed, 21 Nov 2012 06:07:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>249652</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 50 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ag5z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>58892</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>