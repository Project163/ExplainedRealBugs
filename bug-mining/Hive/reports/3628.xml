<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:34:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-10647] Hive on LLAP: Limit HS2 from overwhelming LLAP</title>
                <link>https://issues.apache.org/jira/browse/HIVE-10647</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;We want to restrict the number of queries that flow through LLAP. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12828127">HIVE-10647</key>
            <summary>Hive on LLAP: Limit HS2 from overwhelming LLAP</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vikram.dixit">Vikram Dixit K</assignee>
                                    <reporter username="vikram.dixit">Vikram Dixit K</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 May 2015 20:51:47 +0000</created>
                <updated>Wed, 17 Feb 2016 01:33:00 +0000</updated>
                            <resolved>Fri, 26 Jun 2015 00:13:03 +0000</resolved>
                                    <version>llap</version>
                                    <fixVersion>llap</fixVersion>
                                    <component>Tez</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14542963" author="thejas" created="Thu, 14 May 2015 00:13:22 +0000"  >&lt;p&gt;Clusters with more than one HS2 instances are going to be common, with the new rolling upgrade and high availability features in HS2.&lt;br/&gt;
This will not have the desired impact in such cases.&lt;/p&gt;</comment>
                            <comment id="14546183" author="hagleitn" created="Fri, 15 May 2015 21:15:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;thejas&lt;/a&gt; it will in a limited fashion, right? If you can limit each hs2 to have n concurrent llap queries you can still effectively protect llap from thrashing. It&apos;s not perfect but it&apos;s a start. Should we just create a follow up for the more involved case of multiple servers?&lt;/p&gt;</comment>
                            <comment id="14546197" author="hagleitn" created="Fri, 15 May 2015 21:26:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vikram.dixit&quot; class=&quot;user-hover&quot; rel=&quot;vikram.dixit&quot;&gt;vikram.dixit&lt;/a&gt;: &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;I think you should replace the BlockingArray&amp;lt;Boolean&amp;gt; with a counting semaphore.&lt;/li&gt;
	&lt;li&gt;The default for this value seems to be 1 - I think it should be unrestricted by default.&lt;/li&gt;
	&lt;li&gt;Since there&apos;s only one call to getLlapMode to TezWork you could just make this call cycle through basework instead of adding another bool to the class. If you really prefer the bool, I think TezWork should support the methods setLlapMode/clearLlap mode w/o params (since it&apos;s not a straight forward yay or nay).&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14546241" author="thejas" created="Fri, 15 May 2015 21:58:39 +0000"  >&lt;p&gt;I agree that even if there are multiple HS2 instances, this can still be used to limit the degree of parallelism. I think we should update the config description that the upper limit is actually that multiplied by number of HS2 instances.&lt;/p&gt;</comment>
                            <comment id="14575542" author="vikram.dixit" created="Sat, 6 Jun 2015 03:04:38 +0000"  >&lt;p&gt;Changed to use a semaphore. I do not see a specific need to grow the size beyond 1 in the default case because:&lt;/p&gt;

&lt;p&gt;1. If it is the cli mode, the user basically never lets go of the session and 1 is all they need.&lt;br/&gt;
2. If it is hs2, the user needs to configure this correctly anyways.&lt;/p&gt;

&lt;p&gt;I can change it to a large number but don&apos;t really see a good reason for it.&lt;/p&gt;</comment>
                            <comment id="14592851" author="hagleitn" created="Fri, 19 Jun 2015 01:34:02 +0000"  >&lt;p&gt;Change LGTM, but I&apos;m not sure I agree with the assessment of default == 1. I don&apos;t think you need to configure a large number. Just add a clause for num &amp;gt; 0 to the if statement for both acquire and release. For CLI 1 is enough, that&apos;s true. But unlimited doesn&apos;t hurt either.&lt;/p&gt;

&lt;p&gt;For hs2, user should configure it - agreed. But if you&apos;re just giving llap a spin, we should just let queries in. I think we would give a very bad experience out of the box if we left this at 1. Would look very slow to most ppl. If they just have a number of ppl kicking the tires, unlimited is probably fine. If you roll into prod you will probably restrict it based on cluster capacity.&lt;/p&gt;</comment>
                            <comment id="14596975" author="vikram.dixit" created="Tue, 23 Jun 2015 01:30:35 +0000"  >&lt;p&gt;Addressed comments.&lt;/p&gt;</comment>
                            <comment id="14602156" author="hagleitn" created="Fri, 26 Jun 2015 00:01:53 +0000"  >&lt;p&gt;i think you need the same check for both semaphore acquire as well as release. Otherwise you&apos;ll end up releasing it w/o having ever acquired.&lt;/p&gt;</comment>
                            <comment id="14602160" author="hagleitn" created="Fri, 26 Jun 2015 00:06:51 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14602166" author="vikram.dixit" created="Fri, 26 Jun 2015 00:13:03 +0000"  >&lt;p&gt;Committed to branch. Thanks Gunther for the review.&lt;/p&gt;</comment>
                            <comment id="14604361" author="lefty@hortonworks.com" created="Sat, 27 Jun 2015 20:50:10 +0000"  >&lt;p&gt;Doc note:  This adds configuration parameter &lt;b&gt;hive.server2.llap.concurrent.queries&lt;/b&gt; so I&apos;m linking to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-9850&quot; title=&quot;documentation for llap&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-9850&quot;&gt;HIVE-9850&lt;/a&gt; (documentation for llap).  When the llap branch merges to trunk, this parameter will need to be documented in the HiveServer2 section of Configuration Properties:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-HiveServer2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Configuration Properties &amp;#8211; HiveServer2 &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12779314">HIVE-9850</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12731263" name="HIVE-10647.1.patch" size="15388" author="vikram.dixit" created="Thu, 7 May 2015 20:52:49 +0000"/>
                            <attachment id="12738128" name="HIVE-10647.2.patch" size="14875" author="vikram.dixit" created="Sat, 6 Jun 2015 03:04:38 +0000"/>
                            <attachment id="12741187" name="HIVE-10647.3.patch" size="14694" author="vikram.dixit" created="Tue, 23 Jun 2015 00:58:35 +0000"/>
                            <attachment id="12741993" name="HIVE-10647.4.patch" size="14735" author="vikram.dixit" created="Fri, 26 Jun 2015 00:04:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 21 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2efw7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>