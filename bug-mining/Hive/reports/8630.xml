<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:25:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-27960] Invalid function error when using custom udaf</title>
                <link>https://issues.apache.org/jira/browse/HIVE-27960</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;When a permanent udaf used before over() function, hive will throw invalid function error.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;del&gt;In &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-12719&quot; title=&quot;As a hive user, I am facing issues using permanent UDAF&amp;#39;s.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-12719&quot;&gt;&lt;del&gt;HIVE-12719&lt;/del&gt;&lt;/a&gt; , it fix this issue for hive 3, but it can&apos;t work in hive 2.&lt;/del&gt;&#160;&lt;/p&gt;

&lt;p&gt;This issue reproduce on master.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;In hive 2, it should get FunctionInfo from FunctionRegistry before get&#160;WindowFunctionInfo same to hive 3. Because it will register window function to session. Then hive can get WindowFunctionInfo correctly.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;---------------------------- err detail ----------------------------&lt;/p&gt;

&lt;p&gt;register a permanent udaf:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
create function row_number2 as &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.hadoop.hive.ql.udf.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericUDAFRowNumber&apos;&lt;/span&gt;; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;execute query in a new cli session:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
select row_number2() over();&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;blew is error log:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
FAILED: SemanticException Failed to breakup Windowing invocations into Groups. At least 1 group must only depend on input columns. Also check &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; circular dependencies.Underlying error: Invalid function row_number22023-12-06T10:17:30,348 ERROR [0b7764ce-cde3-49c5-9d32-f96d61b20773 main] ql.Driver: FAILED: SemanticException Failed to breakup Windowing invocations into Groups. At least 1 group must only depend on input columns. Also check &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; circular dependencies.Underlying error: Invalid function row_number2org.apache.hadoop.hive.ql.parse.SemanticException: Failed to breakup Windowing invocations into Groups. At least 1 group must only depend on input columns. Also check &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; circular dependencies.Underlying error: Invalid function row_number2&#160; &#160; at org.apache.hadoop.hive.ql.parse.WindowingComponentizer.next(WindowingComponentizer.java:97)&#160; &#160; at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genWindowingPlan(SemanticAnalyzer.java:13270)&#160; &#160; at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:9685)&#160; &#160; at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:9644)&#160; &#160; at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:10549)&#160; &#160; at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:10427)&#160; &#160; at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genOPTree(SemanticAnalyzer.java:11125)&#160; &#160; at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:481)&#160; &#160; at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:11138)&#160; &#160; at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:286)&#160; &#160; at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:258)&#160; &#160; at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:512)&#160; &#160; at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:1317)&#160; &#160; at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1457)&#160; &#160; at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1237)&#160; &#160; at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1227)&#160; &#160; at org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:233)&#160; &#160; at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:184)&#160; &#160; at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:403)&#160; &#160; at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:336)&#160; &#160; at org.apache.hadoop.hive.cli.CliDriver.executeDriver(CliDriver.java:787)&#160; &#160; at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:759)&#160; &#160; at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:686)&#160; &#160; at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&#160; &#160; at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)&#160; &#160; at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&#160; &#160; at java.lang.reflect.Method.invoke(Method.java:498)&#160; &#160; at org.apache.hadoop.util.RunJar.run(RunJar.java:239)&#160; &#160; at org.apache.hadoop.util.RunJar.main(RunJar.java:153) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Aliyun emr hive 2.3.9&lt;/p&gt;</environment>
        <key id="13562209">HIVE-27960</key>
            <summary>Invalid function error when using custom udaf</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gaoxiong">gaoxiong</assignee>
                                    <reporter username="gaoxiong">gaoxiong</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 18 Dec 2023 13:29:25 +0000</created>
                <updated>Fri, 29 Mar 2024 17:49:56 +0000</updated>
                            <resolved>Sat, 20 Jan 2024 06:00:25 +0000</resolved>
                                    <version>2.3.9</version>
                    <version>4.0.0-beta-1</version>
                                    <fixVersion>4.0.0</fixVersion>
                                    <component>Hive</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17798215" author="JIRAUSER303544" created="Mon, 18 Dec 2023 14:01:30 +0000"  >&lt;p&gt;I have slove this issue. Please review the changes. Thanks.&lt;/p&gt;</comment>
                            <comment id="17808868" author="zhangbutao" created="Sat, 20 Jan 2024 06:00:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gaoxiong&quot; class=&quot;user-hover&quot; rel=&quot;gaoxiong&quot;&gt;gaoxiong&lt;/a&gt; Fix has been merged into the master branch. Thanks for your contribution!!!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 42 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1mbps:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>