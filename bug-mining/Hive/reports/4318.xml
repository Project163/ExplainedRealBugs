<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:42:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-12880] spark-assembly causes Hive class version problems</title>
                <link>https://issues.apache.org/jira/browse/HIVE-12880</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;It looks like spark-assembly contains versions of Hive classes (e.g. HiveConf), and these sometimes (always?) come from older versions of Hive.&lt;br/&gt;
We&apos;ve seen problems where depending on classpath perturbations, NoSuchField errors may be thrown for recently added ConfVars because the HiveConf class comes from spark-assembly.&lt;/p&gt;

&lt;p&gt;Would making sure spark-assembly comes last in the classpath solve the problem?&lt;br/&gt;
Otherwise, can we depend on something that does not package older Hive classes?&lt;/p&gt;

&lt;p&gt;Currently, &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-12179&quot; title=&quot;Add option to not add spark-assembly.jar to Hive classpath&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-12179&quot;&gt;&lt;del&gt;HIVE-12179&lt;/del&gt;&lt;/a&gt; provides a workaround (in non-Spark use case, at least; I am assuming this issue can also affect Hive-on-Spark).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12931568">HIVE-12880</key>
            <summary>spark-assembly causes Hive class version problems</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sershe">Sergey Shelukhin</assignee>
                                    <reporter username="huizane">Hui Zheng</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Jan 2016 20:28:12 +0000</created>
                <updated>Tue, 21 Jun 2016 15:53:03 +0000</updated>
                            <resolved>Sat, 20 Feb 2016 22:58:29 +0000</resolved>
                                                    <fixVersion>2.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15102423" author="sershe" created="Fri, 15 Jan 2016 20:29:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuefuz&quot; class=&quot;user-hover&quot; rel=&quot;xuefuz&quot;&gt;xuefuz&lt;/a&gt; fyi&lt;/p&gt;</comment>
                            <comment id="15102500" author="xuefuz" created="Fri, 15 Jan 2016 21:38:59 +0000"  >&lt;p&gt;I just checked my spark-assembly.jar, and it doesn&apos;t contain any hive classes. I&apos;m curious, wondering if the observation comes with spark installation. We recommend user to build their own spark-assembly excluding hive classes.&lt;/p&gt;</comment>
                            <comment id="15102565" author="sershe" created="Fri, 15 Jan 2016 22:13:19 +0000"  >&lt;p&gt;Hmm, let me see why this one contains Hive classes&lt;/p&gt;</comment>
                            <comment id="15105728" author="sershe" created="Mon, 18 Jan 2016 19:37:27 +0000"  >&lt;p&gt;It seems like the default spark-assembly built from Spark itself includes Hive.&lt;br/&gt;
This is what I&apos;d expect most independent users will have...&lt;br/&gt;
If I am correct about this (not very familiar with spark build), I wonder if it makes sense to either (1) add new published jar to Spark that excludes this spurious Hive version, and use that (2) disable the assembly being added by default with this in mind? On a higher level, we don&apos;t add e.g. Tez jars unless they are added explicitly (and they don&apos;t even package Hive &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;).&lt;/p&gt;</comment>
                            <comment id="15105735" author="sershe" created="Mon, 18 Jan 2016 19:43:46 +0000"  >&lt;p&gt;Looking further on the script, I see it tries to find Spark automatically and add the jar, which seems even worse, i.e. in my case I wasn&apos;t even trying to use Spark.&lt;/p&gt;</comment>
                            <comment id="15106155" author="xuefuz" created="Tue, 19 Jan 2016 02:46:34 +0000"  >&lt;p&gt;agreed that letting the script find the jar and add it automatically is bad. Myself didn&apos;t realized this behavior until the end of last year. This can be changed. Let&apos;s find the original JIRA that added this and undo the change.&lt;/p&gt;</comment>
                            <comment id="15113438" author="sershe" created="Sat, 23 Jan 2016 01:22:54 +0000"  >&lt;p&gt;The patch. spark-assembly will be added if either spark_home is set by user, or if we find spark_home AND skip is set to false by user.&lt;br/&gt;
If nothing is set explicitly but we find spark, it emits a warning.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuefuz&quot; class=&quot;user-hover&quot; rel=&quot;xuefuz&quot;&gt;xuefuz&lt;/a&gt; does it make sense?&lt;/p&gt;</comment>
                            <comment id="15113455" author="xuefuz" created="Sat, 23 Jan 2016 01:51:52 +0000"  >&lt;p&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt;, thanks for working on this. Since the jar coming from a Spark default installation doesn&apos;t work for Hive, I think the script should not bother finding and adding it to the classpath. The alternative way is to copy (or link) the right jar to Hive&apos;s /lib directory, which can be done by part of packaging. Therefore, I think a better way is to undo the original JIRA that introduced the logic. &lt;/p&gt;</comment>
                            <comment id="15114564" author="hiveqa" created="Sun, 24 Jan 2016 22:05:44 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12783967/HIVE-12880.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12783967/HIVE-12880.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 21 failed/errored test(s), 10027 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestHWISessionManager - did not produce a TEST-*.xml file
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.org.apache.hadoop.hive.cli.TestMiniTezCliDriver
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_acid_globallimit
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_alter_merge_orc
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_scriptfile1
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_tez_fsstat
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_tez_multi_union
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_tez_union_dynamic_partition
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_transform_ppr1
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_union2
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_grouping_sets
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_interval_mapjoin
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_join_filters
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_mapjoin_reduce
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_reduce1
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vectorized_bucketmapjoin1
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vectorized_string_funcs
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import
org.apache.hadoop.hive.ql.TestTxnCommands2.testInitiatorWithMultipleFailedCompactions
org.apache.hive.jdbc.TestJdbcWithMiniHS2.testAddJarDataNucleusUnCaching
org.apache.hive.jdbc.TestSSL.testSSLVersion
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6725/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6725/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6725/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6725/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-6725/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-6725/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 21 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12783967 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="15120536" author="sershe" created="Thu, 28 Jan 2016 00:55:23 +0000"  >&lt;p&gt;The patch that reverts the original change (&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-9608&quot; title=&quot;Define SPARK_HOME if not defined automagically&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-9608&quot;&gt;&lt;del&gt;HIVE-9608&lt;/del&gt;&lt;/a&gt;). I am not sure it&apos;s necessary, but that would also work.&lt;/p&gt;</comment>
                            <comment id="15120594" author="xuefuz" created="Thu, 28 Jan 2016 01:57:56 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt;, maybe I wasn&apos;t clear enough, but I meant we need to get rid of the part of code that adds spark-assembly.jar in the classpath. Your patch #01 seems reverting the code that auto detects $SPARK_HOME.&lt;/p&gt;</comment>
                            <comment id="15124458" author="sershe" created="Fri, 29 Jan 2016 23:53:02 +0000"  >&lt;p&gt;Ok, that would be &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-9861&quot; title=&quot;Add spark-assembly on Hive&amp;#39;s classpath [Spark Branch]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-9861&quot;&gt;&lt;del&gt;HIVE-9861&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15124529" author="xuefuz" created="Sat, 30 Jan 2016 00:44:21 +0000"  >&lt;p&gt;+1. Let&apos;s see if it has any impact on tests.&lt;/p&gt;</comment>
                            <comment id="15125546" author="hiveqa" created="Sun, 31 Jan 2016 22:27:28 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12785296/HIVE-12880.02.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12785296/HIVE-12880.02.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 4 failed/errored test(s), 10046 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_ivyDownload
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import
org.apache.hive.jdbc.TestSSL.testSSLVersion
org.apache.hive.service.cli.TestEmbeddedThriftBinaryCLIService.testExecuteStatementAsync
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6817/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6817/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6817/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6817/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-6817/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-6817/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 4 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12785296 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="15155796" author="ashutoshc" created="Sat, 20 Feb 2016 22:58:29 +0000"  >&lt;p&gt;Pushed to master.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12904991">HIVE-12179</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12773248">HIVE-9608</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12784790" name="HIVE-12880.01.patch" size="492" author="sershe" created="Thu, 28 Jan 2016 00:55:23 +0000"/>
                            <attachment id="12785296" name="HIVE-12880.02.patch" size="555" author="sershe" created="Fri, 29 Jan 2016 23:53:02 +0000"/>
                            <attachment id="12783967" name="HIVE-12880.patch" size="1550" author="sershe" created="Sat, 23 Jan 2016 01:23:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 39 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2rjhj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>