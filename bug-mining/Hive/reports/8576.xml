<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:24:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-27772] UNIX_TIMESTAMP should return NULL when date fields are out of bounds</title>
                <link>https://issues.apache.org/jira/browse/HIVE-27772</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;For invalid dates such as 2001-02-31, 2023-04-31 etc, UNIX_TIMESTAMP() is giving out the timestamp value as the last valid date, rather than NULL. (e.g. UNIX_TIMESTAMP(&apos;2001-02-31&apos;, &apos;yyyy-MM-dd&apos;) gives 983354400, which converts to &apos;2001-02-28&apos;. However, for calendar days larger than 31, e.g. 2001-02-32, or 2023-04-32, UNIX_TIMESTAMP() would give NULL as a result.&lt;/p&gt;

&lt;p&gt;In Spark and mysql, UNIX_TIMESTMAP for these invalid dates are all NULL (or 0).&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;6: jdbc:hive2://localhost:10001/&amp;gt; select month, datetimestamp, unix_timestamp(datetimestamp, &apos;yyyy-MM-dd&apos;) as timestampCol from datetimetable;
INFO &#160;: Compiling command(queryId=root_20231005104216_8520e3e9-d03b-4e34-93ec-ddc280845c62): select month, datetimestamp, unix_timestamp(datetimestamp, &apos;yyyy-MM-dd&apos;) as timestampCol from datetimetable
INFO &#160;: No Stats for default@datetimetable, Columns: month, datetimestamp
INFO &#160;: Semantic Analysis Completed (retrial = false)
INFO &#160;: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:month, type:string, comment:null), FieldSchema(name:datetimestamp, type:string, comment:null), FieldSchema(name:timestampcol, type:bigint, comment:null)], properties:null)
INFO &#160;: Completed compiling command(queryId=root_20231005104216_8520e3e9-d03b-4e34-93ec-ddc280845c62); Time taken: 0.102 seconds
INFO &#160;: Operation QUERY obtained 0 locks
INFO &#160;: Executing command(queryId=root_20231005104216_8520e3e9-d03b-4e34-93ec-ddc280845c62): select month, datetimestamp, unix_timestamp(datetimestamp, &apos;yyyy-MM-dd&apos;) as timestampCol from datetimetable
INFO &#160;: Completed executing command(queryId=root_20231005104216_8520e3e9-d03b-4e34-93ec-ddc280845c62); Time taken: 0.0 seconds
+--------+----------------+---------------+
| month &#160;| datetimestamp &#160;| timestampcol &#160;|
+--------+----------------+---------------+
| Feb &#160; &#160;| 2001-02-28 &#160; &#160; | 983318400 &#160; &#160; |
| Feb &#160; &#160;| 2001-02-29 &#160; &#160; | 983318400 &#160; &#160; |
| Feb &#160; &#160;| 2001-02-30 &#160; &#160; | 983318400 &#160; &#160; |
| Feb &#160; &#160;| 2001-02-31 &#160; &#160; | 983318400 &#160; &#160; |
| Feb &#160; &#160;| 2001-02-32 &#160; &#160; | NULL &#160; &#160; &#160; &#160; &#160;|
+--------+----------------+---------------+
5 rows selected (0.131 seconds)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;According to java jdk :&#160;&lt;br/&gt;
&lt;a href=&quot;https://github.com/frohoff/jdk8u-dev-jdk/blob/master/src/share/classes/java/time/format/ResolverStyle.java#L103&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/frohoff/jdk8u-dev-jdk/blob/master/src/share/classes/java/time/format/ResolverStyle.java#L103&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&#160; /**
&#160; &#160; &#160;* Style to resolve dates and times strictly.
&#160; &#160; &#160;* &amp;lt;p&amp;gt;
&#160; &#160; &#160;* Using strict resolution will ensure that all parsed values are within
&#160; &#160; &#160;* the outer range of valid values for the field. Individual fields may
&#160; &#160; &#160;* be further processed for strictness.
&#160; &#160; &#160;* &amp;lt;p&amp;gt;
&#160; &#160; &#160;* For example, resolving year-month and day-of-month in the ISO calendar
&#160; &#160; &#160;* system using strict mode will ensure that the day-of-month is valid
&#160; &#160; &#160;* for the year-month, rejecting invalid values.
&#160; &#160; &#160;*/
&#160; &#160; STRICT,
&#160; &#160; /**
&#160; &#160; &#160;* Style to resolve dates and times in a smart, or intelligent, manner.
&#160; &#160; &#160;* &amp;lt;p&amp;gt;
&#160; &#160; &#160;* Using smart resolution will perform the sensible default for each
&#160; &#160; &#160;* field, which may be the same as strict, the same as lenient, or a third
&#160; &#160; &#160;* behavior. Individual fields will interpret this differently.
&#160; &#160; &#160;* &amp;lt;p&amp;gt;
&#160; &#160; &#160;* For example, resolving year-month and day-of-month in the ISO calendar
&#160; &#160; &#160;* system using smart mode will ensure that the day-of-month is from
&#160; &#160; &#160;* 1 to 31, converting any value beyond the last valid day-of-month to be
&#160; &#160; &#160;* the last valid day-of-month.
&#160; &#160; &#160;*/
&#160; &#160; SMART,&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;By default, the DATETIME formatter uses the SMART resolution style and the SIMPLE formatter the LENIENT. Both of these styles are able to resolve &quot;invalid&quot; bounds to valid dates. In order to prevent seemingly &quot;invalid&quot; dates to be parsed correctly we have to use the STRICT resolution style. However, we cannot simply switch the formatters to always use the STRICT resolution cause that would break existing applications relying on the existing resolution rules. To address the problem reported here and retain the previous behaviour we opted to make the resolution style configurable by adding a new property. The new property only affects the DATETIME formatter; the SIMPLE formatter is almost deprecated so we don&apos;t add new features to it.&lt;/p&gt;





&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13552992">HIVE-27772</key>
            <summary>UNIX_TIMESTAMP should return NULL when date fields are out of bounds</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="simhadri-g">Simhadri Govindappa</assignee>
                                    <reporter username="simhadri-g">Simhadri Govindappa</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 5 Oct 2023 10:41:24 +0000</created>
                <updated>Fri, 29 Mar 2024 17:49:58 +0000</updated>
                            <resolved>Mon, 16 Oct 2023 13:44:21 +0000</resolved>
                                                    <fixVersion>4.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17775764" author="zabetak" created="Mon, 16 Oct 2023 13:44:21 +0000"  >&lt;p&gt;Fixed in &lt;a href=&quot;https://github.com/apache/hive/commit/1c126d947448ffc9784a1465306e018ba183a014&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/commit/1c126d947448ffc9784a1465306e018ba183a014&lt;/a&gt;. Thanks for the PR &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=simhadri-g&quot; class=&quot;user-hover&quot; rel=&quot;simhadri-g&quot;&gt;simhadri-g&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=simhadri-g&quot; class=&quot;user-hover&quot; rel=&quot;simhadri-g&quot;&gt;simhadri-g&lt;/a&gt; If you need to update the description here based on the last changes that were merged please do so. &lt;/p&gt;

&lt;p&gt;Please update the &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-Datetime&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Hive wiki&lt;/a&gt; with the new configuration property introduced here.&lt;/p&gt;</comment>
                            <comment id="17775767" author="simhadri-g" created="Mon, 16 Oct 2023 13:57:48 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zabetak&quot; class=&quot;user-hover&quot; rel=&quot;zabetak&quot;&gt;zabetak&lt;/a&gt; for the review. &lt;/p&gt;

&lt;p&gt;I will update the wiki and the Jira description.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 4 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1kr6w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>