<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:48:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-14992] Relocate several common libraries in hive jdbc uber jar</title>
                <link>https://issues.apache.org/jira/browse/HIVE-14992</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="13013016">HIVE-14992</key>
            <summary>Relocate several common libraries in hive jdbc uber jar</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="taoli-hwx">Tao Li</assignee>
                                    <reporter username="taoli-hwx">Tao Li</reporter>
                        <labels>
                    </labels>
                <created>Mon, 17 Oct 2016 22:29:14 +0000</created>
                <updated>Wed, 26 Jul 2017 00:02:51 +0000</updated>
                            <resolved>Tue, 8 Nov 2016 23:45:23 +0000</resolved>
                                                    <fixVersion>2.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15583711" author="taoli-hwx" created="Mon, 17 Oct 2016 22:32:49 +0000"  >&lt;p&gt;This is to avoid dependency version conflicts when users are using some common libs along with the JDBC standalone jar.&lt;br/&gt;
cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gopalv&quot; class=&quot;user-hover&quot; rel=&quot;gopalv&quot;&gt;gopalv&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;thejas&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15587346" author="hiveqa" created="Wed, 19 Oct 2016 01:44:43 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12833827/HIVE-14992.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12833827/HIVE-14992.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 8 failed/errored test(s), 10592 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestBeelineWithHS2ConnectionFile - did not produce a TEST-*.xml file (likely timed out) (batchId=197)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[acid_globallimit] (batchId=27)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[order_null] (batchId=18)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[union_fast_stats] (batchId=46)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[orc_ppd_schema_evol_3a] (batchId=133)
org.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJarWithoutAddDriverClazz[0] (batchId=155)
org.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJar[0] (batchId=155)
org.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJar[1] (batchId=155)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/1640/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/1640/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/1640/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/1640/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-1640/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-1640/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 8 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12833827 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15603359" author="taoli-hwx" created="Mon, 24 Oct 2016 22:01:48 +0000"  >&lt;p&gt;Test failures are not related.&lt;/p&gt;</comment>
                            <comment id="15606722" author="thejas" created="Tue, 25 Oct 2016 22:55:51 +0000"  >&lt;p&gt;Now that hadoop classes are also part of jdbc jar, I think we should relocate them as well. That will help to ensure that this doesn&apos;t cause issues with applications that might be using different versions of hadoop than what is packaged in jdbc standalone jar.&lt;/p&gt;

&lt;p&gt;Looks like few more of them are candidates for relocation - &lt;br/&gt;
com.facebook&lt;br/&gt;
org.apache.hadoop.&amp;lt;the hadoop parts&amp;gt;&lt;br/&gt;
org.apache.logging.log4j&lt;/p&gt;

&lt;p&gt;I was surprised to see that we don&apos;t package zookeeper and curator. It seems like standalone jar isn&apos;t standalone even now, if you are using zookeerp service discovery. I haven&apos;t verified that by testing it yet. Adding those can be part of a different jira.&lt;/p&gt;

&lt;p&gt;It seems like we are packaging some jars we should not need -&lt;br/&gt;
org.apache.slider&lt;br/&gt;
org.apache.hadoop.hive.metastore&lt;/p&gt;


&lt;p&gt;Can you make a call on the following as well and say why the should be excluded/included/relocated/not relocated ?&lt;br/&gt;
 com/beust/jcommander&lt;br/&gt;
 com/lmax/disruptor/&lt;br/&gt;
org/jamon/&lt;br/&gt;
javolution&lt;br/&gt;
 com/google/common/cache/&lt;/p&gt;</comment>
                            <comment id="15610626" author="taoli-hwx" created="Thu, 27 Oct 2016 04:27:53 +0000"  >&lt;p&gt;I have relocated the below ones. Please see 2.patch.&lt;/p&gt;

&lt;p&gt;com.facebook&lt;br/&gt;
org.apache.hadoop&lt;br/&gt;
org.apache.logging.log4j&lt;/p&gt;


&lt;p&gt;&#8220;com/google/common/cache&#8221; has been relocated already with the first patch. Regarding the below ones, I am not sure how likely they will be used, so I would defer relocating those for now.&lt;/p&gt;

&lt;p&gt;com.beust.jcommander&lt;br/&gt;
com.lmax.disruptor&lt;br/&gt;
org.jamon&lt;br/&gt;
javolution&lt;/p&gt;

&lt;p&gt;Regarding removing the unnecessary artifacts, I created another JIRA: &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-15080&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-15080&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15610640" author="taoli-hwx" created="Thu, 27 Oct 2016 04:37:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;thejas&lt;/a&gt; &quot;org.apache.hadoop.hive.metastore&quot; is a dependency of JDBC client so cannot be removed. We can probably remove &quot;org.apache.slider&quot;.&lt;/p&gt;</comment>
                            <comment id="15610775" author="hiveqa" created="Thu, 27 Oct 2016 05:49:51 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12835468/HIVE-14992.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12835468/HIVE-14992.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 10623 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/1839/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/1839/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/1839/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/1839/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-1839/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-1839/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12835468 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15616286" author="thejas" created="Fri, 28 Oct 2016 19:21:40 +0000"  >&lt;blockquote&gt;&lt;p&gt;Regarding the below ones, I am not sure how likely they will be used, so I would defer relocating those for now.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Do you know if we need them in the jar ?  (A best guess depending on their functionality would be OK)&lt;br/&gt;
What is the cost of relocating them ? Are you concerned about additional build time ? (I don&apos;t have a good sense of additional time this is adding).&lt;/p&gt;</comment>
                            <comment id="15616317" author="taoli-hwx" created="Fri, 28 Oct 2016 19:35:29 +0000"  >&lt;p&gt;We can revisit if these artifacts are really needed in a separate JIRA: &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-15080&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-15080&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Regarding the relocation, I am actually not concerned about extra build time from relocation (I guess that should not cause any obvious difference). My hunch if that we can relocate the artifacts in a lazy way, and I think the jars such as from &quot;com.lmax.disruptor&quot; are unlikely to be used along with the jdbc. But I am also fine with relocating all of them in one shot.&lt;/p&gt;</comment>
                            <comment id="15616485" author="taoli-hwx" created="Fri, 28 Oct 2016 20:38:22 +0000"  >&lt;p&gt;Added another iteration to add the below ones to relocation:&lt;/p&gt;

&lt;p&gt;com.beust.jcommander&lt;br/&gt;
com.lmax.disruptor&lt;br/&gt;
org.jamon&lt;br/&gt;
javolution&lt;/p&gt;</comment>
                            <comment id="15638084" author="taoli-hwx" created="Fri, 4 Nov 2016 23:46:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;thejas&lt;/a&gt; Can you take a look at this change?&lt;/p&gt;</comment>
                            <comment id="15638220" author="thejas" created="Sat, 5 Nov 2016 00:50:38 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="15648657" author="taoli-hwx" created="Tue, 8 Nov 2016 20:07:45 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;thejas&lt;/a&gt; Would you be able to commit it?&lt;/p&gt;</comment>
                            <comment id="15648750" author="thejas" created="Tue, 8 Nov 2016 20:51:39 +0000"  >&lt;p&gt;Trying to get a unit test on the updated patch. Just kicked off build #14992&lt;/p&gt;</comment>
                            <comment id="15649188" author="hiveqa" created="Tue, 8 Nov 2016 23:30:54 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12835883/HIVE-14992.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12835883/HIVE-14992.3.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 2 failed/errored test(s), 10632 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[join_acid_non_acid] (batchId=150)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[union_fast_stats] (batchId=145)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/2037/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/2037/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/2037/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/2037/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-2037/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-2037/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12835883 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15649213" author="thejas" created="Tue, 8 Nov 2016 23:43:48 +0000"  >&lt;p&gt;The two test failures are unrelated - &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-15058&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-15058&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15649217" author="thejas" created="Tue, 8 Nov 2016 23:45:26 +0000"  >&lt;p&gt;Patch committed to master.&lt;br/&gt;
Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=taoli-hwx&quot; class=&quot;user-hover&quot; rel=&quot;taoli-hwx&quot;&gt;taoli-hwx&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12989314">HIVE-14235</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13049863">HIVE-16170</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12833827" name="HIVE-14992.1.patch" size="1558" author="taoli-hwx" created="Mon, 17 Oct 2016 22:35:23 +0000"/>
                            <attachment id="12835468" name="HIVE-14992.2.patch" size="2153" author="taoli-hwx" created="Thu, 27 Oct 2016 04:23:27 +0000"/>
                            <attachment id="12835883" name="HIVE-14992.3.patch" size="2893" author="taoli-hwx" created="Fri, 28 Oct 2016 20:37:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 2 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i350an:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>