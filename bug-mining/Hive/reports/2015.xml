<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:17:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-6707] Lazy maps are broken (LazyMap and LazyBinaryMap)</title>
                <link>https://issues.apache.org/jira/browse/HIVE-6707</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;LazyPrimitive and LazyBinaryPrimitive overrides hashcode method in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-949&quot; title=&quot;Object deepCopy in GroupBy Operator&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-949&quot;&gt;&lt;del&gt;HIVE-949&lt;/del&gt;&lt;/a&gt;. But it failed to override equals() method. As a result, LazyMap and LazyBinaryMap will end up having multiple values for the same key. Both LazyMap and LazyBinaryMap uses LinkedHashMap, so the expected behaviour is to have a single value per unique key.&lt;/p&gt;

&lt;p&gt;In the following code from LazyMap (LazyBinaryMap also has same code segment)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;LazyPrimitive&amp;lt;?, ?&amp;gt; lazyKey = uncheckedGetKey(i);
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (lazyKey == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
  &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;
}
&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; key = lazyKey.getObject();
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (key != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !cachedMap.containsKey(key)) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;lazyKey.hashcode() returns the writable object&apos;s hashcode. The containsKeys() method of hash map (&lt;a href=&quot;http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/HashMap.java#366&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/HashMap.java#366&lt;/a&gt;) checks if the hashcode are same, if so then it uses equals() method to verify if the key already exists. Since LazyPrimitive does not override equals() method it falls back to use Object equals(). Object equals() will return true only if both object are exactly the same (this == obj).&lt;br/&gt;
So in the above code segment, even if the key already exists, the new value will be inserted with hash collision resulting in more number of map entries.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12702570">HIVE-6707</key>
            <summary>Lazy maps are broken (LazyMap and LazyBinaryMap)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="prasanth_j">Prasanth Jayachandran</assignee>
                                    <reporter username="prasanth_j">Prasanth Jayachandran</reporter>
                        <labels>
                            <label>serde</label>
                    </labels>
                <created>Thu, 20 Mar 2014 07:24:23 +0000</created>
                <updated>Thu, 13 Nov 2014 19:40:46 +0000</updated>
                            <resolved>Mon, 24 Mar 2014 00:20:06 +0000</resolved>
                                    <version>0.5.0</version>
                    <version>0.6.0</version>
                    <version>0.7.0</version>
                    <version>0.8.0</version>
                    <version>0.9.0</version>
                    <version>0.10.0</version>
                    <version>0.11.0</version>
                    <version>0.12.0</version>
                    <version>0.13.0</version>
                                    <fixVersion>0.13.0</fixVersion>
                    <fixVersion>0.14.0</fixVersion>
                                    <component>Serializers/Deserializers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                                                            <comments>
                            <comment id="13942069" author="prasanth_j" created="Thu, 20 Mar 2014 18:04:17 +0000"  >&lt;p&gt;getMapSize() api is broken as well. It does not reported the number of distinct keys. I will fix that as well and will upload a new patch.&lt;/p&gt;</comment>
                            <comment id="13942085" author="hagleitn" created="Thu, 20 Mar 2014 18:21:05 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13942109" author="prasanth_j" created="Thu, 20 Mar 2014 18:42:33 +0000"  >&lt;p&gt;Making it patch available for precommit tests.&lt;/p&gt;</comment>
                            <comment id="13944559" author="hiveqa" created="Sun, 23 Mar 2014 20:17:20 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12635736/HIVE-6707.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12635736/HIVE-6707.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 5443 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hive.service.cli.thrift.TestThriftBinaryCLIService.testExecuteStatementAsync
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1926/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1926/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1926/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1926/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12635736&lt;/p&gt;</comment>
                            <comment id="13944607" author="prasanth_j" created="Sun, 23 Mar 2014 22:19:18 +0000"  >&lt;p&gt;Test failure is not related.&lt;/p&gt;</comment>
                            <comment id="13944662" author="vikram.dixit" created="Mon, 24 Mar 2014 00:20:06 +0000"  >&lt;p&gt;Committed to trunk. Thanks Prasanth!&lt;/p&gt;</comment>
                            <comment id="13944725" author="rhbutani" created="Mon, 24 Mar 2014 04:06:03 +0000"  >&lt;p&gt;+1 for 0.13&lt;/p&gt;</comment>
                            <comment id="13944878" author="vikram.dixit" created="Mon, 24 Mar 2014 09:58:51 +0000"  >&lt;p&gt;Committed to branch-0.13.&lt;/p&gt;</comment>
                            <comment id="14210421" author="thejas" created="Thu, 13 Nov 2014 19:40:46 +0000"  >&lt;p&gt;This has been fixed in 0.14 release. Please open new jira if you see any issues.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12702723">HIVE-6714</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12635736" name="HIVE-6707.1.patch" size="6323" author="prasanth_j" created="Thu, 20 Mar 2014 07:25:15 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12702723">HIVE-6714</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>380909</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1tmnb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>381188</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>