<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:26:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-28409] Column lineage when creating view is missing if atlas HiveHook is set</title>
                <link>https://issues.apache.org/jira/browse/HIVE-28409</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Column lineage info is collected by &lt;tt&gt;org.apache.hadoop.hive.ql.optimizer.lineage.Generator&lt;/tt&gt;. This is called during Hive optimizations and view creation if one of these conditions is met:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
hiveConf.getBoolVar(HiveConf.ConfVars.HIVE_LINEAGE_INFO)
        || postExecHooks.contains(&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hive.ql.hooks.PostExecutePrinter&quot;&lt;/span&gt;)
        || postExecHooks.contains(&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hive.ql.hooks.LineageLogger&quot;&lt;/span&gt;)
        || postExecHooks.contains(&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.atlas.hive.hook.HiveHook&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/apache/hive/blob/09553fca66ff69ff870c8a181750b70d81a8640e/ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java#L78-L81&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/blob/09553fca66ff69ff870c8a181750b70d81a8640e/ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java#L78-L81&lt;/a&gt;&lt;br/&gt;
and &lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/hive/blob/09553fca66ff69ff870c8a181750b70d81a8640e/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java#L13226-L13228&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/blob/09553fca66ff69ff870c8a181750b70d81a8640e/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java#L13226-L13228&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;However &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-17125&quot; title=&quot;Lineage: Generate lineage information on need basis when atlas hook is enabled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-17125&quot;&gt;&lt;del&gt;HIVE-17125&lt;/del&gt;&lt;/a&gt; introduced more conditions which affects only the &lt;tt&gt;org.apache.atlas.hive.hook.HiveHook&lt;/tt&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/hive/blob/09553fca66ff69ff870c8a181750b70d81a8640e/ql/src/java/org/apache/hadoop/hive/ql/optimizer/lineage/Generator.java#L75-L86&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/blob/09553fca66ff69ff870c8a181750b70d81a8640e/ql/src/java/org/apache/hadoop/hive/ql/optimizer/lineage/Generator.java#L75-L86&lt;/a&gt;&lt;br/&gt;
&#160;&lt;/p&gt;

&lt;p&gt;Later &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-23244&quot; title=&quot;Extract Create View analyzer from SemanticAnalyzer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-23244&quot;&gt;&lt;del&gt;HIVE-23244&lt;/del&gt;&lt;/a&gt; changed the code handles view creation. Since there are no tests for testing view creation when &lt;tt&gt;org.apache.atlas.hive.hook.HiveHook&lt;/tt&gt; is specified at all the new code skips column lineage info collection.&lt;br/&gt;
The tests we have for testing column lineage info collection are using &lt;a href=&quot;https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/hooks/LineageLogger.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;LineageLogger.java&lt;/a&gt; which doesn&apos;t have any restriction in the Generator so column lineage info is always collected when LineageLogger is set.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13587026">HIVE-28409</key>
            <summary>Column lineage when creating view is missing if atlas HiveHook is set</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kkasa">Krisztian Kasa</assignee>
                                    <reporter username="kkasa">Krisztian Kasa</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 26 Jul 2024 12:17:24 +0000</created>
                <updated>Tue, 29 Jul 2025 14:51:47 +0000</updated>
                            <resolved>Mon, 26 Aug 2024 07:52:50 +0000</resolved>
                                                    <fixVersion>4.1.0</fixVersion>
                                    <component>lineage</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17868934" author="kkasa" created="Fri, 26 Jul 2024 12:20:55 +0000"  >&lt;p&gt;The goal of this jira is to&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;decouple Hive and &lt;tt&gt;org.apache.atlas.hive.hook.HiveHook&lt;/tt&gt; by removing the hardcoded constant and introduce general setting to specify which statements should collect column lineage info.&lt;/li&gt;
	&lt;li&gt;restore column lineage info collection at create view.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17876615" author="kkasa" created="Mon, 26 Aug 2024 07:52:37 +0000"  >&lt;p&gt;Merged to master. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=InvisibleProgrammer&quot; class=&quot;user-hover&quot; rel=&quot;InvisibleProgrammer&quot;&gt;InvisibleProgrammer&lt;/a&gt;&#160;and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dkuzmenko&quot; class=&quot;user-hover&quot; rel=&quot;dkuzmenko&quot;&gt;dkuzmenko&lt;/a&gt; for the review.&lt;/p&gt;</comment>
                            <comment id="17927788" author="JIRAUSER295901" created="Mon, 17 Feb 2025 14:52:46 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kkasa&quot; class=&quot;user-hover&quot; rel=&quot;kkasa&quot;&gt;kkasa&lt;/a&gt;, I have 2 questions, hoping you can help me here:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Marking HIVE_LINEAGE_INFO as deprecated: I have a use case where I want to write my custom hook which uses lineage information but lineage information won&#8217;t be populated until I add the new class name &lt;a href=&quot;https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java#L78-L81&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;. The similar is mentioned in the description of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-24051&quot; title=&quot;Hive lineage information exposed in ExecuteWithHookContext&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-24051&quot;&gt;&lt;del&gt;HIVE-24051&lt;/del&gt;&lt;/a&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
postExecHooks.contains(&#8220;custom.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;name&#8221;) &lt;span class=&quot;code-comment&quot;&gt;// custom hook &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;name &lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;ol&gt;
	&lt;li&gt;In &lt;a href=&quot;https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java#L13270-L13272&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;SemanticAnalyzer&lt;/a&gt; this HIVE_LINEAGE_INFO config based check is not present. I think it should be same as &lt;a href=&quot;https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java#L78-L81&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Optimizer&lt;/a&gt; , as it might not capture views related lineage information for custom hooks!&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Let me know if changes are required, I can create a follow-up PR on this?&lt;/p&gt;</comment>
                            <comment id="17928081" author="kkasa" created="Tue, 18 Feb 2025 13:11:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Aggarwal_Raghav&quot; class=&quot;user-hover&quot; rel=&quot;Aggarwal_Raghav&quot;&gt;Aggarwal_Raghav&lt;/a&gt;&#160;&lt;br/&gt;
We marked HIVE_LINEAGE_INFO as deprecated because we need finer-grained control over lineage generation. The new property that should control this is &lt;a href=&quot;https://github.com/apache/hive/blob/523f7b7f0ae2951eccdf1eb08a426d0984d36e41/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java#L3883C5-L3888&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;HIVE_LINEAGE_STATEMENT_FILTER&lt;/a&gt;. HIVE_LINEAGE_INFO is set to false by default, but HIVE_LINEAGE_STATEMENT_FILTER enables lineage generation for all types of SQL statements.&lt;/p&gt;

&lt;p&gt;Hardcoding any hook class name is considered bad practice, which we would like to avoid in the future. I believe we should replace the existing checks for hardcoded class names with checks for the values of HIVE_LINEAGE_STATEMENT_FILTER and HIVE_LINEAGE_INFO.&lt;/p&gt;

&lt;p&gt;Please feel free to submit a PR.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13299475">HIVE-23244</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13088331">HIVE-17125</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13609193">HIVE-28768</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            38 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1qjs8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12353994">4.1.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>