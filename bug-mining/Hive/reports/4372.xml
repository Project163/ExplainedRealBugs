<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:42:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-13201] Compaction shouldn&apos;t be allowed on non-ACID table</title>
                <link>https://issues.apache.org/jira/browse/HIVE-13201</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Looks like compaction is allowed on non-ACID table, although that&apos;s of no sense and does nothing. Moreover the compaction request will be enqueued into COMPACTION_QUEUE metastore table, which brings unnecessary overhead.&lt;br/&gt;
We should prevent compaction commands being allowed on non-ACID tables.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12946650">HIVE-13201</key>
            <summary>Compaction shouldn&apos;t be allowed on non-ACID table</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="wzheng">Wei Zheng</assignee>
                                    <reporter username="wzheng">Wei Zheng</reporter>
                        <labels>
                    </labels>
                <created>Thu, 3 Mar 2016 19:22:15 +0000</created>
                <updated>Tue, 1 Oct 2019 22:07:54 +0000</updated>
                            <resolved>Mon, 14 Mar 2016 21:47:53 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>2.1.0</fixVersion>
                                    <component>Transactions</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15178435" author="wzheng" created="Thu, 3 Mar 2016 19:28:02 +0000"  >&lt;p&gt;Create a non-ACID table&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; create table nonacid (a &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;);
OK
Time taken: 0.939 seconds
hive&amp;gt; desc formatted nonacid;
OK
# col_name            	data_type           	comment

a                   	&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;

# Detailed Table Information
Database:           	&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;
Owner:              	hive
CreateTime:         	Thu Mar 03 19:22:56 UTC 2016
LastAccessTime:     	UNKNOWN
Protect Mode:       	None
Retention:          	0
Location:           	hdfs:&lt;span class=&quot;code-comment&quot;&gt;//jvaria-hive-1-4.novalocal:8020/apps/hive/warehouse/nonacid
&lt;/span&gt;Table Type:         	MANAGED_TABLE
Table Parameters:
	transient_lastDdlTime	1457032976

# Storage Information
SerDe Library:      	org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
InputFormat:        	org.apache.hadoop.mapred.TextInputFormat
OutputFormat:       	org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
Compressed:         	No
Num Buckets:        	-1
Bucket Columns:     	[]
Sort Columns:       	[]
Storage Desc Params:
	serialization.format	1
Time taken: 0.26 seconds, Fetched: 26 row(s)
hive&amp;gt; alter table nonacid compact &lt;span class=&quot;code-quote&quot;&gt;&apos;major&apos;&lt;/span&gt;;
Compaction enqueued.
OK
Time taken: 0.098 seconds
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On the metastore side, the compaction request is enqueued&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;mysql&amp;gt; select * from COMPACTION_QUEUE;
+-------+-------------+----------+--------------+----------+---------+--------------+---------------+-----------+-------------------+--------------+------------------+
| CQ_ID | CQ_DATABASE | CQ_TABLE | CQ_PARTITION | CQ_STATE | CQ_TYPE | CQ_WORKER_ID | CQ_START      | CQ_RUN_AS | CQ_HIGHEST_TXN_ID | CQ_META_INFO | CQ_HADOOP_JOB_ID |
+-------+-------------+----------+--------------+----------+---------+--------------+---------------+-----------+-------------------+--------------+------------------+
|     5 | &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;     | nonacid  | NULL         | r        | a       | NULL         | 1457033021000 | hive      |              NULL | NULL         | NULL             |
+-------+-------------+----------+--------------+----------+---------+--------------+---------------+-----------+-------------------+--------------+------------------+
1 row in set (0.00 sec)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15181981" author="hiveqa" created="Sun, 6 Mar 2016 03:51:09 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12791364/HIVE-13201.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12791364/HIVE-13201.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 10 failed/errored test(s), 9767 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestSparkCliDriver-groupby3_map.q-sample2.q-auto_join14.q-and-12-more - did not produce a TEST-*.xml file
TestSparkCliDriver-groupby_map_ppr_multi_distinct.q-table_access_keys_stats.q-groupby4_noskew.q-and-12-more - did not produce a TEST-*.xml file
TestSparkCliDriver-join_rc.q-insert1.q-vectorized_rcfile_columnar.q-and-12-more - did not produce a TEST-*.xml file
TestSparkCliDriver-ppd_join4.q-join9.q-ppd_join3.q-and-12-more - did not produce a TEST-*.xml file
TestSparkCliDriver-timestamp_lazy.q-bucketsortoptimize_insert_4.q-date_udf.q-and-12-more - did not produce a TEST-*.xml file
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_dbtxnmgr_compact1
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_dbtxnmgr_compact2
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_dbtxnmgr_compact3
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import
org.apache.hive.jdbc.TestSSL.testSSLVersion
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/7173/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/7173/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/7173/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/7173/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-7173/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-7173/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 10 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12791364 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="15182617" author="wzheng" created="Mon, 7 Mar 2016 05:46:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gates&quot; class=&quot;user-hover&quot; rel=&quot;gates&quot;&gt;gates&lt;/a&gt; Can you take a look? As you can see, dbtxnmgr_compact&lt;span class=&quot;error&quot;&gt;&amp;#91;1-3&amp;#93;&lt;/span&gt;.q failed. I&apos;m a little confused as to whether we should allow compaction to &quot;pass thru&quot; for non-ACID table. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ekoifman&quot; class=&quot;user-hover&quot; rel=&quot;ekoifman&quot;&gt;ekoifman&lt;/a&gt; FYI&lt;/p&gt;</comment>
                            <comment id="15183336" author="ekoifman" created="Mon, 7 Mar 2016 17:43:28 +0000"  >&lt;p&gt;Seems to me like a test bug...  &lt;/p&gt;</comment>
                            <comment id="15187624" author="wzheng" created="Wed, 9 Mar 2016 18:42:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gates&quot; class=&quot;user-hover&quot; rel=&quot;gates&quot;&gt;gates&lt;/a&gt; Can you confirm? I&apos;m planning to remove those 3 tests.&lt;/p&gt;</comment>
                            <comment id="15189735" author="alangates" created="Thu, 10 Mar 2016 18:56:50 +0000"  >&lt;p&gt;The tests shouldn&apos;t be dropped, they should instead be changed so that they are properly transactional tables.  The point of the tests is to cover that &apos;alter table compact&apos; works from the command line.  If you feel this is tested elsewhere in a better way then we can remove these tests.&lt;/p&gt;

&lt;p&gt;Other than that, +1 on the patch.&lt;/p&gt;</comment>
                            <comment id="15194176" author="wzheng" created="Mon, 14 Mar 2016 21:29:27 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gates&quot; class=&quot;user-hover&quot; rel=&quot;gates&quot;&gt;gates&lt;/a&gt;. I&apos;ve updated those 3 tests to make the tables ACID.&lt;/p&gt;</comment>
                            <comment id="15194214" author="wzheng" created="Mon, 14 Mar 2016 21:47:53 +0000"  >&lt;p&gt;Committed to master and branch-1&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12791364" name="HIVE-13201.1.patch" size="2991" author="wzheng" created="Fri, 4 Mar 2016 00:32:43 +0000"/>
                            <attachment id="12793401" name="HIVE-13201.2.patch" size="7888" author="wzheng" created="Mon, 14 Mar 2016 21:29:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 36 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2u473:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>