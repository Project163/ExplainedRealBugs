<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:25:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-27801] Exists subquery rewrite results in a wrong plan</title>
                <link>https://issues.apache.org/jira/browse/HIVE-27801</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;reproduce (no rows should be returned):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
set hive.explain.user=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
set hive.support.concurrency=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
set hive.stats.autogather=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
set hive.exec.dynamic.partition.mode=nonstrict;

drop table &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists store_sales;

create table store_sales (ss_promo_sk &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, ss_sales_price &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, ss_list_price &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) stored as orc tblproperties(&lt;span class=&quot;code-quote&quot;&gt;&apos;transactional&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;&lt;/span&gt;);
insert into store_sales values (1, 20, 15), (1, 15, 20), (1, 10, 15);

explain cbo 
select * from store_sales A where exists ( 
select 1 from store_sales B 
    where a.ss_promo_sk=b.ss_promo_sk and A.ss_sales_price&amp;gt;B.ss_list_price and A.ss_sales_price&amp;lt;B.ss_sales_price);
    
select * from store_sales A where exists( 
select 1 from store_sales B 
    where A.ss_promo_sk=B.ss_promo_sk and A.ss_sales_price&amp;gt;B.ss_list_price and A.ss_sales_price&amp;lt;B.ss_sales_price);  
    
explain cbo    
select * from store_sales A 
LEFT SEMI JOIN store_sales B 
ON a.ss_promo_sk=b.ss_promo_sk and A.ss_sales_price&amp;gt;B.ss_list_price and A.ss_sales_price&amp;lt;B.ss_sales_price;     

select * from store_sales A 
LEFT SEMI JOIN store_sales B 
ON a.ss_promo_sk=b.ss_promo_sk and A.ss_sales_price&amp;gt;B.ss_list_price and A.ss_sales_price&amp;lt;B.ss_sales_price;    
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;plan diff:&lt;br/&gt;
&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13063570/13063570_Screenshot+2023-10-10+at+20.14.03.png&quot; title=&quot;Screenshot 2023-10-10 at 20.14.03.png attached to HIVE-27801&quot;&gt;Screenshot 2023-10-10 at 20.14.03.png&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;expectation: query should return 0 rows &lt;/p&gt;</description>
                <environment></environment>
        <key id="13554193">HIVE-27801</key>
            <summary>Exists subquery rewrite results in a wrong plan</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkuzmenko">Denys Kuzmenko</assignee>
                                    <reporter username="dkuzmenko">Denys Kuzmenko</reporter>
                        <labels>
                            <label>Regression</label>
                            <label>hive-4.0.0-must</label>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 16 Oct 2023 08:21:27 +0000</created>
                <updated>Fri, 29 Mar 2024 17:49:58 +0000</updated>
                            <resolved>Wed, 13 Dec 2023 09:16:33 +0000</resolved>
                                    <version>4.0.0</version>
                    <version>4.0.0-beta-1</version>
                                    <fixVersion>4.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17792989" author="dkuzmenko" created="Mon, 4 Dec 2023 18:01:50 +0000"  >&lt;p&gt;it&apos;s a regression, not reproducible in 3.1.3&lt;/p&gt;</comment>
                            <comment id="17796099" author="dkuzmenko" created="Wed, 13 Dec 2023 09:17:15 +0000"  >&lt;p&gt;Merged. to master.&lt;br/&gt;
Thanks for the review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ayushsaxena&quot; class=&quot;user-hover&quot; rel=&quot;ayushsaxena&quot;&gt;ayushsaxena&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="13560101">HIVE-27921</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13063570" name="Screenshot 2023-10-10 at 20.14.03.png" size="177272" author="dkuzmenko" created="Mon, 16 Oct 2023 08:23:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 48 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1kylk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>