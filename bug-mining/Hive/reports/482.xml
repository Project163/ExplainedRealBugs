<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 17:57:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-1570] referencing an added file by it&apos;s name in a transform script does not work in hive local mode</title>
                <link>https://issues.apache.org/jira/browse/HIVE-1570</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Yongqiang tried this and it fails in local mode:&lt;/p&gt;

&lt;p&gt;add file ../data/scripts/dumpdata_script.py;&lt;/p&gt;

&lt;p&gt;select count(distinct subq.key) from&lt;br/&gt;
(FROM src MAP src.key USING &apos;python dumpdata_script.py&apos; AS key WHERE src.key = 10) subq;&lt;/p&gt;


&lt;p&gt;this needs to be fixed because it means we cannot choose local mode automatically in case of transform scripts (since different paths need to be used for cluster vs. local mode execution)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12472043">HIVE-1570</key>
            <summary>referencing an added file by it&apos;s name in a transform script does not work in hive local mode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jsensarma">Joydeep Sen Sarma</assignee>
                                    <reporter username="jsensarma">Joydeep Sen Sarma</reporter>
                        <labels>
                    </labels>
                <created>Thu, 19 Aug 2010 22:23:11 +0000</created>
                <updated>Fri, 16 Dec 2011 23:59:15 +0000</updated>
                            <resolved>Fri, 8 Oct 2010 04:40:42 +0000</resolved>
                                                    <fixVersion>0.7.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12900501" author="jsensarma" created="Thu, 19 Aug 2010 22:29:36 +0000"  >&lt;p&gt;hmmm - how come scriptfile1.q works then?&lt;/p&gt;


&lt;p&gt;CREATE TABLE dest1(key INT, value STRING);&lt;/p&gt;

&lt;p&gt;ADD FILE src/test/scripts/testgrep;&lt;/p&gt;

&lt;p&gt;FROM (&lt;br/&gt;
  FROM src&lt;br/&gt;
  SELECT TRANSFORM(src.key, src.value)&lt;br/&gt;
         USING &apos;testgrep&apos; AS (tkey, tvalue) &lt;br/&gt;
  CLUSTER BY tkey &lt;br/&gt;
) tmap&lt;br/&gt;
INSERT OVERWRITE TABLE dest1 SELECT tmap.tkey, tmap.tvalue;&lt;/p&gt;</comment>
                            <comment id="12909943" author="nzhang" created="Wed, 15 Sep 2010 23:18:19 +0000"  >&lt;p&gt;Joy, scriptfile1.q actually failed on TestMinimrCliDriver with the command &lt;/p&gt;

&lt;p&gt;ant test -Dhadoop.version=0.20.0 -Dtestcase=TestMinimrCliDriver -Dminimr.query.files=scriptfile1.q&lt;/p&gt;

&lt;p&gt;It gives NPE on ExecDriver.java:625. This NPE is a different issue and it can be solved by changing &apos;conf&apos; to &apos;job&apos;. But even after this change the NPE is gone and the test still failed. Should we move this test outside minimr.query.files for now before this JIRA is fixed?&lt;/p&gt;</comment>
                            <comment id="12909950" author="jsensarma" created="Wed, 15 Sep 2010 23:54:29 +0000"  >&lt;p&gt;sure. confused - because the tests were all passing earlier when i added the minimr tests.&lt;/p&gt;</comment>
                            <comment id="12917803" author="jsensarma" created="Mon, 4 Oct 2010 22:20:28 +0000"  >&lt;p&gt;before running a map-reduce job in local mode we:&lt;br/&gt;
1. set a new working directory&lt;br/&gt;
2. symlink all added files from that working directory&lt;/p&gt;

&lt;p&gt;this is pretty much identical to how hadoop sets up task execution environment. all references to scripts and add files using their names only now resolve correctly in local mode.&lt;/p&gt;

&lt;p&gt;there was some hacky code in SemanticAnalyzer.java to deal with this that doesn&apos;t work in all cases (when referenced file is not the first item in command line or in automatic local mode). i have deleted it.&lt;/p&gt;

&lt;p&gt;duplicated one of the tests so that we get coverage against a real cluster (scriptfile1.q executed against minimr) and local mode (scriptfile2.q).&lt;/p&gt;

&lt;p&gt;still running tests.&lt;/p&gt;</comment>
                            <comment id="12917833" author="jsensarma" created="Tue, 5 Oct 2010 00:34:43 +0000"  >&lt;p&gt;working patch. no need for new test. had to modify some other tests to use &apos;add file&apos;.&lt;/p&gt;</comment>
                            <comment id="12918375" author="jsensarma" created="Wed, 6 Oct 2010 01:31:21 +0000"  >&lt;p&gt;added a console output for local mapred jobs containing location of execution log for debugging.&lt;/p&gt;</comment>
                            <comment id="12918732" author="jsensarma" created="Wed, 6 Oct 2010 23:29:58 +0000"  >&lt;p&gt;added fix for hive-1520 - don&apos;t reset HADOOP_HEAPSIZE unless the child jvm is being launched for local mode execution.&lt;/p&gt;

&lt;p&gt;it&apos;s a one liner - simpler to get it all in in one shot.&lt;/p&gt;</comment>
                            <comment id="12918736" author="jsensarma" created="Wed, 6 Oct 2010 23:46:38 +0000"  >&lt;p&gt;also adding trivial patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1473&quot; title=&quot;plan file should have a high replication factor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1473&quot;&gt;&lt;del&gt;HIVE-1473&lt;/del&gt;&lt;/a&gt;. filed separate patches for 1473 and 1520 as well - but folded in everything here.&lt;/p&gt;</comment>
                            <comment id="12919150" author="namit" created="Fri, 8 Oct 2010 04:40:42 +0000"  >&lt;p&gt;Committed. Thanks Joy&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12475642">HIVE-1685</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12456333" name="1570.1.patch" size="7673" author="jsensarma" created="Mon, 4 Oct 2010 22:20:28 +0000"/>
                            <attachment id="12456350" name="1570.2.patch" size="20538" author="jsensarma" created="Tue, 5 Oct 2010 00:34:43 +0000"/>
                            <attachment id="12456461" name="1570.3.patch" size="21907" author="jsensarma" created="Wed, 6 Oct 2010 01:31:21 +0000"/>
                            <attachment id="12456554" name="1570.4.patch" size="23479" author="jsensarma" created="Wed, 6 Oct 2010 23:29:58 +0000"/>
                            <attachment id="12456557" name="1570.5.patch" size="24526" author="jsensarma" created="Wed, 6 Oct 2010 23:46:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72834</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 7 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lfrj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123204</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>