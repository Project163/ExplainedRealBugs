<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 17:51:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-232] metastore.warehouse configuration should use inherited hadoop configuration</title>
                <link>https://issues.apache.org/jira/browse/HIVE-232</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;the hive.metastore.warehouse.dir configuration property in hive-*.xml needs to use the protocol, host, and port when it is inherited from the fs.name property in hadoop-site.xml.&lt;/p&gt;

&lt;p&gt;When it doesn&apos;t and no protocol is found then a broad range of &quot;Move&quot; operations when the source and target are both in the DFS will fail.&lt;/p&gt;

&lt;p&gt;Currently this can be worked around by prepending the protocol, host and port of the hadoop nameserver into the value of the hive.metastore.warehouse.dir property.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12412397">HIVE-232</key>
            <summary>metastore.warehouse configuration should use inherited hadoop configuration</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="prasadc">Prasad Chakka</assignee>
                                    <reporter username="besquared">Josh Ferguson</reporter>
                        <labels>
                    </labels>
                <created>Wed, 14 Jan 2009 18:19:39 +0000</created>
                <updated>Sat, 17 Dec 2011 00:08:34 +0000</updated>
                            <resolved>Fri, 16 Jan 2009 22:46:51 +0000</resolved>
                                                    <fixVersion>0.3.0</fixVersion>
                                    <component>Configuration</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12663990" author="jsensarma" created="Thu, 15 Jan 2009 03:16:42 +0000"  >&lt;p&gt;ok with the change in the metastore. DB.java also has a reference to METASTOREWAREHOUSEDIR - but not clear that it&apos;s being used at all.&lt;/p&gt;

&lt;p&gt;the change in LoadSemanticAnalyzer is probably not necessary (a test case might have made this clear). if i am reading this right - the net effect being desired is that the the from path should use fs.default.name for scheme/authority - right?&lt;/p&gt;

&lt;p&gt;but this was already happening, a little twined but reading the (current) code:&lt;/p&gt;

&lt;p&gt;    fs = FileSystem.get(fromURI, conf);&lt;br/&gt;
    String fromAuthority = null;&lt;/p&gt;

&lt;p&gt;    // fall back to configuration based scheme if necessary&lt;br/&gt;
    if(StringUtils.isEmpty(fromScheme)) &lt;/p&gt;
{
      fromScheme = fs.getUri().getScheme();
      fromAuthority = fs.getUri().getAuthority();
    }

&lt;p&gt;    if(fromScheme.equals(&quot;hdfs&quot;)) &lt;/p&gt;
{
      fromAuthority = StringUtils.isEmpty(fromURI.getAuthority()) ?
        fs.getUri().getAuthority() : fromURI.getAuthority();
    }

&lt;p&gt;the fs initialization will get the scheme and authority from fs.default.name if the fromURI does not supply them. Then we test one by one if scheme and authority are already supplied - if not - we use the one supplied by fs (so use fs.default.name for both of these as a default).&lt;/p&gt;

&lt;p&gt;unless i am missing something - we are just trying to do the same thing in a slightly different way?&lt;/p&gt;

</comment>
                            <comment id="12663999" author="prasadc" created="Thu, 15 Jan 2009 05:09:47 +0000"  >&lt;p&gt;The reference in DB.java will go away after removing old metastore code.&lt;/p&gt;

&lt;p&gt;when input path is just simply &apos;/user/hive/warehouse/dir1&apos; then the FileSystem.get() call doesn&apos;t know which the scheme/auth to use. It doesn&apos;t use the config  param fs.default.name value. That is the reason why Josh/Jeremy were getting errors when &apos;hdfs://localhost:9000&apos; wasn&apos;t in the load inpath file name.&lt;/p&gt;

&lt;p&gt;May be I could just set fromAuthority in local mode to be null and if the scheme is hdfs then it to be what ever is given in the input URI or the fs.default.name&apos;s authority instead of determining it from fs.getURI().getAuthority().&lt;/p&gt;
</comment>
                            <comment id="12664000" author="jsensarma" created="Thu, 15 Jan 2009 05:23:16 +0000"  >&lt;p&gt;hmm - i don&apos;t understand this. maybe we need to ping dhruba. fs object has to have scheme auth - otherwise how does it know what file system to talk to (and the fs object has already been instantiated - it&apos;s either a DistributedFileSystem object or a LocalFileSystem based object). &lt;/p&gt;

&lt;p&gt;Is this reproducible (with a populated fs.default.name)?&lt;/p&gt;</comment>
                            <comment id="12664001" author="prasadc" created="Thu, 15 Jan 2009 05:27:16 +0000"  >&lt;p&gt;yeah, it is reproducible on our production cluster. i think it becomes null which is local file system i think. we can confirm it with dhruba/code tomorrow.&lt;/p&gt;</comment>
                            <comment id="12664002" author="jsensarma" created="Thu, 15 Jan 2009 05:34:46 +0000"  >&lt;p&gt;it can&apos;t default to local file system (that&apos;s the whole point of fs.default.name). but perhaps the uri/scheme are populated later on on demand ..&lt;/p&gt;

&lt;p&gt;if that is the case (and the current code is not working) - i am ok with the changes.&lt;/p&gt;

&lt;p&gt;man - we would be able to regression test this kind of stuff if we had the minimr/dfs stuff setup ..&lt;/p&gt;</comment>
                            <comment id="12664219" author="prasadc" created="Thu, 15 Jan 2009 18:53:50 +0000"  >&lt;p&gt;I think FileSystem.get() does return the configured default scheme and authority. Here is the updated patch with just the change to make hdfs relative paths to work and the metastore.warehouse param to work properly.&lt;/p&gt;</comment>
                            <comment id="12664298" author="jsensarma" created="Thu, 15 Jan 2009 22:35:17 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;do we have a good explanation for what was happening in Josh&apos;s case then?&lt;/p&gt;</comment>
                            <comment id="12664669" author="prasadc" created="Fri, 16 Jan 2009 20:37:32 +0000"  >&lt;p&gt;fusion mount truncated my previous patch. reattaching the file.&lt;/p&gt;</comment>
                            <comment id="12664725" author="dhruba" created="Fri, 16 Jan 2009 22:46:51 +0000"  >&lt;p&gt;I just committed this. Thanks Prasad!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12398106" name="hive-232.2.patch" size="2778" author="prasadc" created="Fri, 16 Jan 2009 20:37:31 +0000"/>
                            <attachment id="12397995" name="hive-232.2.patch" size="2533" author="prasadc" created="Thu, 15 Jan 2009 18:53:50 +0000"/>
                            <attachment id="12397910" name="hive-232.patch" size="3590" author="prasadc" created="Wed, 14 Jan 2009 20:15:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73688</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 45 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l8nb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122051</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>