<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:23:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-26643] HiveUnionPullUpConstantsRule produces an invalid plan when pulling up constants for nullable fields</title>
                <link>https://issues.apache.org/jira/browse/HIVE-26643</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The rule pulls up constants without checking/adjusting nullability to match that of the field type.&lt;/p&gt;

&lt;p&gt;Here is the stack-trace when a nullable type is involved:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.AssertionError: Cannot add expression of different type to set:
set type is RecordType(JavaType(&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;) f1, JavaType(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) NOT NULL f2) NOT NULL
expression type is RecordType(JavaType(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) NOT NULL f1, JavaType(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) NOT NULL f2) NOT NULL
set is rel#38:HiveUnion.(input#0=HepRelVertex#35,input#1=HepRelVertex#35,all=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)
expression is HiveProject(f1=[1], f2=[$0])
  HiveUnion(all=[&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;])
    HiveProject(f2=[$1])
      HiveProject(f1=[$0], f2=[$1])
        HiveFilter(condition=[=($0, 1)])
          LogicalTableScan(table=[[]])
    HiveProject(f2=[$1])
      HiveProject(f1=[$0], f2=[$1])
        HiveFilter(condition=[=($0, 1)])
          LogicalTableScan(table=[[]])
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The solution is to check nullability and add a cast when the field is nullable, since the constant&apos;s type is not.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13486633">HIVE-26643</key>
            <summary>HiveUnionPullUpConstantsRule produces an invalid plan when pulling up constants for nullable fields</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="asolimando">Alessandro Solimando</assignee>
                                    <reporter username="asolimando">Alessandro Solimando</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 17 Oct 2022 13:48:21 +0000</created>
                <updated>Wed, 16 Nov 2022 13:50:35 +0000</updated>
                            <resolved>Wed, 19 Oct 2022 11:55:15 +0000</resolved>
                                    <version>4.0.0-alpha-2</version>
                                    <fixVersion>4.0.0-alpha-2</fixVersion>
                                    <component>CBO</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="2400">40m</timespent>
                                <comments>
                            <comment id="17618914" author="asolimando" created="Mon, 17 Oct 2022 13:51:57 +0000"  >&lt;p&gt;A similar issue was fixed for &lt;em&gt;AggregateProjectPullUpConstantsRule&lt;/em&gt; in &lt;a href=&quot;https://issues.apache.org/jira/browse/CALCITE-2179&quot; title=&quot;General improvements for materialized view rewriting rule&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CALCITE-2179&quot;&gt;&lt;del&gt;CALCITE-2179&lt;/del&gt;&lt;/a&gt;, see&#160;&lt;a href=&quot;https://github.com/apache/calcite/commit/aa25dcbe565196fb6b78149042ee817427ed4f68#diff-ff4ebbdcaabdec1969e88cbeb4fa7519f5f867d9abdce2a333e1ebc8fc549a47R172-R176&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/calcite/commit/aa25dcbe565196fb6b78149042ee817427ed4f68#diff-ff4ebbdcaabdec1969e88cbeb4fa7519f5f867d9abdce2a333e1ebc8fc549a47R172-R176&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17620282" author="zabetak" created="Wed, 19 Oct 2022 11:55:15 +0000"  >&lt;p&gt;Fixed in &lt;a href=&quot;https://github.com/apache/hive/commit/6b05d64ce8c7161415d97a7896ea50025322e30a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/commit/6b05d64ce8c7161415d97a7896ea50025322e30a&lt;/a&gt;. Thanks for the PR &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=asolimando&quot; class=&quot;user-hover&quot; rel=&quot;asolimando&quot;&gt;asolimando&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13486813">CALCITE-5337</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13487105">HIVE-26652</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13138621">CALCITE-2179</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z19fcg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>