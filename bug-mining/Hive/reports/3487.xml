<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:33:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-10727] Import throws error message &quot;org.apache.thrift.protocol.TProtocolException: Required field &apos;filesAdded&apos; is unset!&quot;</title>
                <link>https://issues.apache.org/jira/browse/HIVE-10727</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Here are the steps to reproduce. Please setup two hive warehouses with hive.metastore.event.listeners set to org.apache.hive.hcatalog.listener.DbNotificationListener. On warehouse 1, please do the following as user hive.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;## create table
CREATE TABLE page_view4(viewTime INT, userid BIGINT,
     page_url STRING, referrer_url STRING,
     ip STRING COMMENT &lt;span class=&quot;code-quote&quot;&gt;&apos;IP Address of the User&apos;&lt;/span&gt;)
 COMMENT &lt;span class=&quot;code-quote&quot;&gt;&apos;This is the page view table&apos;&lt;/span&gt;
 PARTITIONED BY(dt STRING, country STRING)
 STORED AS SEQUENCEFILE;

## Add partitions
alter table page_view4 add partition (dt=&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;, country=&lt;span class=&quot;code-quote&quot;&gt;&quot;usa&quot;&lt;/span&gt;);
alter table page_view4 add partition (dt=&lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;, country=&lt;span class=&quot;code-quote&quot;&gt;&quot;india&quot;&lt;/span&gt;);
insert into table page_view4 PARTITION (dt=&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;, country=&lt;span class=&quot;code-quote&quot;&gt;&quot;usa&quot;&lt;/span&gt;) VALUES (1, 1, &lt;span class=&quot;code-quote&quot;&gt;&quot;url1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;referurl1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;ip1&quot;&lt;/span&gt;);

## Export table
export table page_view4 to &lt;span class=&quot;code-quote&quot;&gt;&apos;/tmp/export4&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; replication(&lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&apos;/tmp/export4&apos; is created with owner as hive and group hdfs. The &lt;br/&gt;
&apos;/apps/hive/warehouse/page_view4/&apos; is created with owner hive and group users. &lt;/p&gt;

&lt;p&gt;Copy the exported data in  &apos;/tmp/export4&apos; to hdfs in warehouse 2. The data is still owned by hive and belongs to group hdfs. Please change the group for dir &apos;/tmp/export4&apos; to users. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;bash# su - hdfs
hdfs : bash# hadoop fs -chown -R hive:users /tmp/export4
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As user hive, do the following&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; table page_view4 from &lt;span class=&quot;code-quote&quot;&gt;&apos;/tmp/export4&apos;&lt;/span&gt; ;
Copying data from hdfs:&lt;span class=&quot;code-comment&quot;&gt;//node-4.example.com:8020/tmp/export4/dt=1/country=usa
&lt;/span&gt;....
Loading data to table &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;.page_view4 partition (country=usa, dt=1)
Failed with exception org.apache.hadoop.hive.ql.metadata.HiveException: org.apache.thrift.protocol.TProtocolException: Required field &lt;span class=&quot;code-quote&quot;&gt;&apos;filesAdded&apos;&lt;/span&gt; is unset! Struct:InsertEventRequestData(filesAdded:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
FAILED: Execution Error, &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; code 1 from org.apache.hadoop.hive.ql.exec.MoveTask
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The import failed. Attaching the logs from /tmp/hive/hive.log for further debugging. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12830304">HIVE-10727</key>
            <summary>Import throws error message &quot;org.apache.thrift.protocol.TProtocolException: Required field &apos;filesAdded&apos; is unset!&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sushanth">Sushanth Sowmyan</assignee>
                                    <reporter username="bvellanki">Balu Vellanki</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 May 2015 20:47:41 +0000</created>
                <updated>Tue, 1 Oct 2019 22:06:40 +0000</updated>
                            <resolved>Tue, 19 May 2015 21:15:53 +0000</resolved>
                                    <version>1.2.0</version>
                                    <fixVersion>1.2.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14549372" author="sushanth" created="Mon, 18 May 2015 22:20:26 +0000"  >&lt;p&gt;Relevant stacktrace:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2015-05-12 15:50:25,729 WARN  [main]: metastore.RetryingMetaStoreClient (RetryingMetaStoreClient.java:invoke(184)) - MetaStoreClient lost connection. Attempting to reconnect.
org.apache.thrift.protocol.TProtocolException: Required field &apos;filesAdded&apos; is unset! Struct:InsertEventRequestData(filesAdded:null)
	at org.apache.hadoop.hive.metastore.api.InsertEventRequestData.validate(InsertEventRequestData.java:310)
	at org.apache.hadoop.hive.metastore.api.InsertEventRequestData$InsertEventRequestDataStandardScheme.write(InsertEventRequestData.java:378)
	at org.apache.hadoop.hive.metastore.api.InsertEventRequestData$InsertEventRequestDataStandardScheme.write(InsertEventRequestData.java:338)
	at org.apache.hadoop.hive.metastore.api.InsertEventRequestData.write(InsertEventRequestData.java:288)
	at org.apache.hadoop.hive.metastore.api.FireEventRequestData.standardSchemeWriteValue(FireEventRequestData.java:168)
	at org.apache.thrift.TUnion$TUnionStandardScheme.write(TUnion.java:244)
	at org.apache.thrift.TUnion$TUnionStandardScheme.write(TUnion.java:213)
	at org.apache.thrift.TUnion.write(TUnion.java:152)
	at org.apache.hadoop.hive.metastore.api.FireEventRequest$FireEventRequestStandardScheme.write(FireEventRequest.java:748)
	at org.apache.hadoop.hive.metastore.api.FireEventRequest$FireEventRequestStandardScheme.write(FireEventRequest.java:667)
	at org.apache.hadoop.hive.metastore.api.FireEventRequest.write(FireEventRequest.java:577)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$fire_listener_event_args$fire_listener_event_argsStandardScheme.write(ThriftHiveMetastore.java)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$fire_listener_event_args$fire_listener_event_argsStandardScheme.write(ThriftHiveMetastore.java)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$fire_listener_event_args.write(ThriftHiveMetastore.java)
	at org.apache.thrift.TServiceClient.sendBase(TServiceClient.java:63)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.send_fire_listener_event(ThriftHiveMetastore.java:4176)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.fire_listener_event(ThriftHiveMetastore.java:4168)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.fireListenerEvent(HiveMetaStoreClient.java:1954)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:156)
	at com.sun.proxy.$Proxy5.fireListenerEvent(Unknown Source)
	at org.apache.hadoop.hive.ql.metadata.Hive.fireInsertEvent(Hive.java:1945)
	at org.apache.hadoop.hive.ql.metadata.Hive.getPartition(Hive.java:1876)
	at org.apache.hadoop.hive.ql.metadata.Hive.loadPartition(Hive.java:1407)
	at org.apache.hadoop.hive.ql.metadata.Hive.loadPartition(Hive.java:1324)
	at org.apache.hadoop.hive.ql.exec.MoveTask.execute(MoveTask.java:438)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:160)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:88)
	at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1650)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1409)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1192)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1059)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1049)
	at org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:213)
	at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:165)
	at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:376)
	at org.apache.hadoop.hive.cli.CliDriver.executeDriver(CliDriver.java:736)
	at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:681)
	at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:621)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.hadoop.util.RunJar.run(RunJar.java:221)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:136)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14549376" author="sushanth" created="Mon, 18 May 2015 22:23:35 +0000"  >&lt;p&gt;Attaching fix. I thought we fixed this in an earlier patch for fireInsertEvent, but seemingly missed it. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gates&quot; class=&quot;user-hover&quot; rel=&quot;gates&quot;&gt;gates&lt;/a&gt;, could you please review?&lt;/p&gt;</comment>
                            <comment id="14549751" author="hiveqa" created="Tue, 19 May 2015 04:11:36 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12733649/HIVE-10727.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12733649/HIVE-10727.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 3 failed/errored test(s), 8946 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_udaf_context_ngrams
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_udaf_percentile_approx_23
org.apache.hadoop.hive.cli.TestEncryptedHDFSCliDriver.testCliDriver_encryption_insert_partition_static
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3936/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3936/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3936/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3936/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-3936/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-3936/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12733649 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14550871" author="alangates" created="Tue, 19 May 2015 17:51:30 +0000"  >&lt;p&gt;+1, I thought we&apos;d already fixed this too.&lt;/p&gt;</comment>
                            <comment id="14551247" author="sushanth" created="Tue, 19 May 2015 21:15:53 +0000"  >&lt;p&gt;Committed to master and branch-1.2.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12733649" name="HIVE-10727.patch" size="677" author="sushanth" created="Mon, 18 May 2015 22:23:35 +0000"/>
                            <attachment id="12733629" name="hive.log" size="422109" author="bvellanki" created="Mon, 18 May 2015 21:18:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 27 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2et1r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>