<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:09:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-5265] Direct SQL fallback broken on Postgres</title>
                <link>https://issues.apache.org/jira/browse/HIVE-5265</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5264&quot; title=&quot;SQL generated by MetaStoreDirectSql.java not compliant with Postgres.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5264&quot;&gt;&lt;del&gt;HIVE-5264&lt;/del&gt;&lt;/a&gt;. Postgres aborts transaction on any failed query, so the fallback doesn&apos;t work.&lt;br/&gt;
Original code used to do rollback/restart tx on SQL failure, but then it was removed to allow usage in cases like dropTable/etc., where there&apos;s external tx present and we cannot partially rollback.&lt;br/&gt;
Looks like the solution for now is to reinstate the rollback/reopen, and prohibit the usage inside external transactions.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12667968">HIVE-5265</key>
            <summary>Direct SQL fallback broken on Postgres</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sershe">Sergey Shelukhin</assignee>
                                    <reporter username="sershe">Sergey Shelukhin</reporter>
                        <labels>
                    </labels>
                <created>Wed, 11 Sep 2013 02:24:03 +0000</created>
                <updated>Tue, 15 Oct 2013 23:31:09 +0000</updated>
                            <resolved>Thu, 12 Sep 2013 12:11:37 +0000</resolved>
                                    <version>0.12.0</version>
                                    <fixVersion>0.12.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13763878" author="phabricator@reviews.facebook.net" created="Wed, 11 Sep 2013 02:33:54 +0000"  >&lt;p&gt;sershe requested code review of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5265&quot; title=&quot;Direct SQL fallback broken on Postgres&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5265&quot;&gt;&lt;del&gt;HIVE-5265&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Direct SQL fallback broken on Postgres&quot;.&lt;/p&gt;

&lt;p&gt;Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;Preliminary patch. I think this needs to go in as part of 0.12.&lt;br/&gt;
I am running tests now, it will take a while.&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  EMPTY&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D12861&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D12861&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java&lt;/p&gt;

&lt;p&gt;MANAGE HERALD RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/30819/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/herald/transcript/30819/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, sershe&lt;/p&gt;</comment>
                            <comment id="13764432" author="sershe" created="Wed, 11 Sep 2013 15:59:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt; can you take a look? Thanks&lt;/p&gt;</comment>
                            <comment id="13764467" author="ashutoshc" created="Wed, 11 Sep 2013 16:41:31 +0000"  >&lt;p&gt;We need bit more testing here. Will it be easy for you to setup postgres and run all the unit tests with metastore pointing to postgres instead of derby. Just modifying data/conf/hive-site.xml to point to postgres should do the trick.&lt;/p&gt;</comment>
                            <comment id="13765057" author="sershe" created="Thu, 12 Sep 2013 01:21:02 +0000"  >&lt;p&gt;I verified manually it works against postgres manually. The tests fail due to verifyingstore by default, if it is removed the fallback now works correctly (as it used to before rollback/open was removed). Let me run normal tests to make sure it doesn&apos;t break anything else.&lt;/p&gt;</comment>
                            <comment id="13765331" author="hiveqa" created="Thu, 12 Sep 2013 10:58:47 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12602496/HIVE-5265.D12861.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12602496/HIVE-5265.D12861.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 3091 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/708/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/708/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/708/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/708/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13765366" author="phabricator@reviews.facebook.net" created="Thu, 12 Sep 2013 12:01:53 +0000"  >&lt;p&gt;ashutoshc has accepted the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5265&quot; title=&quot;Direct SQL fallback broken on Postgres&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5265&quot;&gt;&lt;del&gt;HIVE-5265&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Direct SQL fallback broken on Postgres&quot;.&lt;/p&gt;

&lt;p&gt;  +1&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D12861&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D12861&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5265&quot; title=&quot;Direct SQL fallback broken on Postgres&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5265&quot;&gt;&lt;del&gt;HIVE-5265&lt;/del&gt;&lt;/a&gt;-trunk&lt;/p&gt;

&lt;p&gt;ARCANIST PROJECT&lt;br/&gt;
  hive&lt;/p&gt;

&lt;p&gt;To: JIRA, ashutoshc, sershe&lt;/p&gt;</comment>
                            <comment id="13765372" author="ashutoshc" created="Thu, 12 Sep 2013 12:11:37 +0000"  >&lt;p&gt;Committed to trunk. Thanks, Sergey!&lt;/p&gt;</comment>
                            <comment id="13765609" author="sershe" created="Thu, 12 Sep 2013 16:48:47 +0000"  >&lt;p&gt;Can you put it in 12? without it, Postgres metastore is broken by default in 12, the setting for Direct SQL needs to be disabled manually.&lt;/p&gt;</comment>
                            <comment id="13765612" author="ashutoshc" created="Thu, 12 Sep 2013 16:51:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;thejas&lt;/a&gt; is release manager for 0.12 So, I will request him for inclusion.&lt;br/&gt;
Thejas, I recommend putting this in 0.12. &lt;/p&gt;</comment>
                            <comment id="13765641" author="hudson" created="Thu, 12 Sep 2013 17:21:13 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-hadoop2-ptest #96 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2-ptest/96/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2-ptest/96/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5265&quot; title=&quot;Direct SQL fallback broken on Postgres&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5265&quot;&gt;&lt;del&gt;HIVE-5265&lt;/del&gt;&lt;/a&gt; : Direct SQL fallback broken on Postgres (Sergey Shelukhin via Ashutosh Chauhan) (hashutosh: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1522542&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1522542&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13765658" author="hudson" created="Thu, 12 Sep 2013 17:30:05 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-hadoop1-ptest #163 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop1-ptest/163/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop1-ptest/163/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5265&quot; title=&quot;Direct SQL fallback broken on Postgres&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5265&quot;&gt;&lt;del&gt;HIVE-5265&lt;/del&gt;&lt;/a&gt; : Direct SQL fallback broken on Postgres (Sergey Shelukhin via Ashutosh Chauhan) (hashutosh: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1522542&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1522542&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13765690" author="hudson" created="Thu, 12 Sep 2013 17:48:41 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-hadoop2 #424 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/424/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/424/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5265&quot; title=&quot;Direct SQL fallback broken on Postgres&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5265&quot;&gt;&lt;del&gt;HIVE-5265&lt;/del&gt;&lt;/a&gt; : Direct SQL fallback broken on Postgres (Sergey Shelukhin via Ashutosh Chauhan) (hashutosh: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1522542&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1522542&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13765893" author="thejas" created="Thu, 12 Sep 2013 21:06:53 +0000"  >&lt;p&gt;Committed to 0.12 branch.&lt;/p&gt;</comment>
                            <comment id="13766033" author="hudson" created="Thu, 12 Sep 2013 23:48:37 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-h0.21 #2327 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/2327/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/2327/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5265&quot; title=&quot;Direct SQL fallback broken on Postgres&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5265&quot;&gt;&lt;del&gt;HIVE-5265&lt;/del&gt;&lt;/a&gt; : Direct SQL fallback broken on Postgres (Sergey Shelukhin via Ashutosh Chauhan) (hashutosh: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1522542&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1522542&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13796127" author="ashutoshc" created="Tue, 15 Oct 2013 23:31:09 +0000"  >&lt;p&gt;This issue has been fixed and released as part of 0.12 release. If you find further issues, please create a new jira and link it to this one.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12602496" name="HIVE-5265.D12861.1.patch" size="3145" author="phabricator@reviews.facebook.net" created="Wed, 11 Sep 2013 02:33:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>347903</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 6 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1nznr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>348200</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>