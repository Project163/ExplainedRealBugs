<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:04:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-4096] problem in hive.map.groupby.sorted with distincts</title>
                <link>https://issues.apache.org/jira/browse/HIVE-4096</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;set hive.enforce.bucketing = true;&lt;br/&gt;
set hive.enforce.sorting = true;&lt;br/&gt;
set hive.exec.reducers.max = 10;&lt;br/&gt;
set hive.map.groupby.sorted=true;&lt;/p&gt;

&lt;p&gt;CREATE TABLE T1(key STRING, val STRING) PARTITIONED BY (ds string)&lt;br/&gt;
CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE;&lt;/p&gt;

&lt;p&gt;LOAD DATA LOCAL INPATH &apos;../data/files/T1.txt&apos; INTO TABLE T1 PARTITION (ds=&apos;1&apos;);&lt;/p&gt;

&lt;p&gt;&amp;#8211; perform an insert to make sure there are 2 files&lt;br/&gt;
INSERT OVERWRITE TABLE T1 PARTITION (ds=&apos;1&apos;) select key, val from T1 where ds = &apos;1&apos;;&lt;/p&gt;

&lt;p&gt;CREATE TABLE outputTbl1(cnt INT);&lt;/p&gt;

&lt;p&gt;&amp;#8211; The plan should be converted to a map-side group by, since the&lt;br/&gt;
&amp;#8211; sorting columns and grouping columns match, and all the bucketing columns&lt;br/&gt;
&amp;#8211; are part of sorting columns&lt;br/&gt;
EXPLAIN&lt;br/&gt;
select count(distinct key) from T1;&lt;/p&gt;

&lt;p&gt;select count(distinct key) from T1;&lt;/p&gt;

&lt;p&gt;explain&lt;br/&gt;
INSERT OVERWRITE TABLE outputTbl1&lt;br/&gt;
select count(distinct key) from T1;&lt;/p&gt;

&lt;p&gt;INSERT OVERWRITE TABLE outputTbl1&lt;br/&gt;
select count(distinct key) from T1;&lt;/p&gt;

&lt;p&gt;SELECT * FROM outputTbl1;&lt;/p&gt;

&lt;p&gt;DROP TABLE T1;&lt;/p&gt;


&lt;p&gt;The above query gives wrong results&lt;/p&gt;</description>
                <environment></environment>
        <key id="12634796">HIVE-4096</key>
            <summary>problem in hive.map.groupby.sorted with distincts</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="namit">Namit Jain</assignee>
                                    <reporter username="namit">Namit Jain</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Mar 2013 12:09:11 +0000</created>
                <updated>Thu, 16 May 2013 21:10:50 +0000</updated>
                            <resolved>Tue, 12 Mar 2013 17:52:49 +0000</resolved>
                                                    <fixVersion>0.11.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13597823" author="namit" created="Sat, 9 Mar 2013 02:50:24 +0000"  >&lt;p&gt;Ideally, the group by can be much simpler and use that.&lt;br/&gt;
But, minimally it should not give wrong results.&lt;/p&gt;</comment>
                            <comment id="13597869" author="namit" created="Sat, 9 Mar 2013 06:46:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://reviews.facebook.net/D9255&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D9255&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13597952" author="namit" created="Sat, 9 Mar 2013 14:11:37 +0000"  >&lt;p&gt;Tests passed&lt;/p&gt;</comment>
                            <comment id="13599089" author="kevinwilfong" created="Mon, 11 Mar 2013 18:22:55 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13600245" author="kevinwilfong" created="Tue, 12 Mar 2013 17:52:49 +0000"  >&lt;p&gt;Committed, thanks Namit.&lt;/p&gt;</comment>
                            <comment id="13601264" author="hudson" created="Wed, 13 Mar 2013 15:46:43 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #2013 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/2013/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/2013/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4096&quot; title=&quot;problem in hive.map.groupby.sorted with distincts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4096&quot;&gt;&lt;del&gt;HIVE-4096&lt;/del&gt;&lt;/a&gt;. problem in hive.map.groupby.sorted with distincts. (njain via kevinwilfong) (Revision 1455650)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
kevinwilfong : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1455650&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1455650&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GroupByOptimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/GroupByDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_8.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_sort_8.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13623066" author="hudson" created="Thu, 4 Apr 2013 23:39:59 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #138 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/138/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/138/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4096&quot; title=&quot;problem in hive.map.groupby.sorted with distincts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4096&quot;&gt;&lt;del&gt;HIVE-4096&lt;/del&gt;&lt;/a&gt;. problem in hive.map.groupby.sorted with distincts. (njain via kevinwilfong) (Revision 1455650)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
kevinwilfong : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1455650&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1455650&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GroupByOptimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/GroupByDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_8.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_sort_8.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12572897" name="hive.4096.1.patch" size="14284" author="namit" created="Sat, 9 Mar 2013 06:46:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>315289</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 33 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ienj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>315633</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>