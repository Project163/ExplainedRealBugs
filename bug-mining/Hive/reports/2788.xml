<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:26:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-8576] Guaranteed NPE in StatsRulesProcFactory</title>
                <link>https://issues.apache.org/jira/browse/HIVE-8576</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Code looks like this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt; getPrimaryKeyCandidates(List&amp;lt;Operator&amp;lt;? &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; OperatorDesc&amp;gt;&amp;gt; ops) {
      List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt; result = Lists.newArrayList();
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (ops != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || !ops.isEmpty()) {
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; ops.size(); i++) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;tt&gt;||&lt;/tt&gt; should be &lt;tt&gt;&amp;amp;&amp;amp;&lt;/tt&gt; as the current &lt;tt&gt;if&lt;/tt&gt; statement can be rewritten as &lt;tt&gt;!(ops == null &amp;amp;&amp;amp; ops.isEmpty())&lt;/tt&gt; which doesn&apos;t make sense.&lt;/p&gt;

&lt;p&gt;Or am I missing something?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12750145">HIVE-8576</key>
            <summary>Guaranteed NPE in StatsRulesProcFactory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="larsfrancke">Lars Francke</assignee>
                                    <reporter username="larsfrancke">Lars Francke</reporter>
                        <labels>
                    </labels>
                <created>Thu, 23 Oct 2014 18:12:49 +0000</created>
                <updated>Thu, 12 Feb 2015 23:40:47 +0000</updated>
                            <resolved>Thu, 23 Oct 2014 23:07:39 +0000</resolved>
                                                    <fixVersion>1.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14181697" author="xuefuz" created="Thu, 23 Oct 2014 18:16:13 +0000"  >&lt;p&gt;I think the observation is correct, but I think it would be nice to create a test case for this if it&apos;s easy.&lt;/p&gt;</comment>
                            <comment id="14181731" author="lars_francke" created="Thu, 23 Oct 2014 18:32:24 +0000"  >&lt;p&gt;I&apos;d love to but I have no idea how. It&apos;s at least three levels deep in the call stack and I have no idea what the code does.&lt;/p&gt;

&lt;p&gt;Apparently there are no unit tests to cover this to begin with. One should have been added with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-8168&quot; title=&quot;With dynamic partition enabled fact table selectivity is not taken into account when generating the physical plan (Use CBO cardinality using physical plan generation)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-8168&quot;&gt;&lt;del&gt;HIVE-8168&lt;/del&gt;&lt;/a&gt; I guess.&lt;/p&gt;

&lt;p&gt;Any ideas?&lt;/p&gt;</comment>
                            <comment id="14181732" author="lars_francke" created="Thu, 23 Oct 2014 18:33:03 +0000"  >&lt;p&gt;Oh, and thanks for the confirmation &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14181749" author="prasanth_j" created="Thu, 23 Oct 2014 18:44:06 +0000"  >&lt;p&gt;My bad. Thats my mistake. There are q file tests for stats annotation but even with that its hard to exactly reproduce many cases. This recently happened with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-8549&quot; title=&quot;NPE in PK-FK inference when one side of join is complex tree&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-8549&quot;&gt;&lt;del&gt;HIVE-8549&lt;/del&gt;&lt;/a&gt; as well. These issues crops up when running TPCDS queries and with higher scale factors (200,1000, 3000). Since operator tree will be different when stats are different (ex: mapjoin vs shuffle join) its hard to replicate these test cases with small datasets we have. I have a TPCDS scale 1 factor on my localbox but even with that many issues weren&apos;t reproducible. But yeah this if condition is my mistake.&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14182056" author="hiveqa" created="Thu, 23 Oct 2014 21:55:41 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12676654/HIVE-8576.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12676654/HIVE-8576.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 2 failed/errored test(s), 6578 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_annotate_stats_join_pkfk
org.apache.hive.minikdc.TestJdbcWithMiniKdc.testNegativeTokenAuth
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1418/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1418/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1418/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1418/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1418/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1418/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12676654 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14182068" author="lars_francke" created="Thu, 23 Oct 2014 22:13:32 +0000"  >&lt;p&gt;I don&apos;t think the test failures are related to the patch.&lt;/p&gt;</comment>
                            <comment id="14182116" author="prasanth_j" created="Thu, 23 Oct 2014 22:54:06 +0000"  >&lt;p&gt;Since its a trivial patch which doesn&apos;t affect other tests. I will get this committed soon. Yes. The test failure is not related. Its fixed in latest trunk.&lt;/p&gt;</comment>
                            <comment id="14182120" author="prasanth_j" created="Thu, 23 Oct 2014 22:55:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vikram.dixit&quot; class=&quot;user-hover&quot; rel=&quot;vikram.dixit&quot;&gt;vikram.dixit&lt;/a&gt; Can we get this in 0.14?&lt;/p&gt;</comment>
                            <comment id="14182136" author="vikram.dixit" created="Thu, 23 Oct 2014 23:03:24 +0000"  >&lt;p&gt;+1 for 0.14&lt;/p&gt;</comment>
                            <comment id="14182141" author="prasanth_j" created="Thu, 23 Oct 2014 23:07:39 +0000"  >&lt;p&gt;Committed to trunk and branch-0.14. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lars_francke&quot; class=&quot;user-hover&quot; rel=&quot;lars_francke&quot;&gt;lars_francke&lt;/a&gt; for the patch!&lt;/p&gt;</comment>
                            <comment id="14210808" author="thejas" created="Thu, 13 Nov 2014 19:42:42 +0000"  >&lt;p&gt;This has been fixed in 0.14 release. Please open new jira if you see any issues.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12676654" name="HIVE-8576.1.patch" size="924" author="larsfrancke" created="Thu, 23 Oct 2014 18:14:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i21idb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>