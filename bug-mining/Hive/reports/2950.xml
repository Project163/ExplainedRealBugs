<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:28:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-8359] Map containing null values are not correctly written in Parquet files</title>
                <link>https://issues.apache.org/jira/browse/HIVE-8359</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Tried write a map&amp;lt;string,string&amp;gt; column in a Parquet file. The table should contain :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{&lt;span class=&quot;code-quote&quot;&gt;&quot;key3&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;val3&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;key4&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}
{&lt;span class=&quot;code-quote&quot;&gt;&quot;key3&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;val3&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;key4&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}
{&lt;span class=&quot;code-quote&quot;&gt;&quot;key1&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;key2&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;val2&quot;&lt;/span&gt;}
{&lt;span class=&quot;code-quote&quot;&gt;&quot;key3&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;val3&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;key4&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}
{&lt;span class=&quot;code-quote&quot;&gt;&quot;key3&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;val3&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;key4&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;... and when you do a query like &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;SELECT * from mytable&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We can see that the table is corrupted :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{&lt;span class=&quot;code-quote&quot;&gt;&quot;key3&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;val3&quot;&lt;/span&gt;}
{&lt;span class=&quot;code-quote&quot;&gt;&quot;key4&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;val3&quot;&lt;/span&gt;}
{&lt;span class=&quot;code-quote&quot;&gt;&quot;key3&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;val2&quot;&lt;/span&gt;}
{&lt;span class=&quot;code-quote&quot;&gt;&quot;key4&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;val3&quot;&lt;/span&gt;}
{&lt;span class=&quot;code-quote&quot;&gt;&quot;key1&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;val3&quot;&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ve not been able to read the Parquet file in our software afterwards, and consequently I suspect it to be corrupted. &lt;/p&gt;

&lt;p&gt;For those who are interested, I generated this Parquet table from an Avro file. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12746196">HIVE-8359</key>
            <summary>Map containing null values are not correctly written in Parquet files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="spena">Sergio Pe&#241;a</assignee>
                                    <reporter username="Akryus">Fr&#233;d&#233;ric TERRAZZONI</reporter>
                        <labels>
                    </labels>
                <created>Mon, 6 Oct 2014 17:17:18 +0000</created>
                <updated>Thu, 12 Feb 2015 23:40:33 +0000</updated>
                            <resolved>Wed, 19 Nov 2014 19:06:46 +0000</resolved>
                                    <version>0.13.1</version>
                                    <fixVersion>1.1.0</fixVersion>
                                    <component>File Formats</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14160535" author="akryus" created="Mon, 6 Oct 2014 17:25:24 +0000"  >&lt;p&gt;Avro file containing the sample data. To reproduce the issue, just create a Hive table from this file and issue a &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CREATE TABLE broken_parquet_table STORED AS PARQUET
AS SELECT * FROM the_avro_table;

SELECT * FROM broken_parquet_table;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14180558" author="spena" created="Wed, 22 Oct 2014 21:22:20 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Akryus&quot; class=&quot;user-hover&quot; rel=&quot;Akryus&quot;&gt;Akryus&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;What is the command you used to create the avro table from the file you attached?&lt;/p&gt;</comment>
                            <comment id="14181138" author="akryus" created="Thu, 23 Oct 2014 08:46:15 +0000"  >&lt;p&gt;Here is how you can create the sample Avro table:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CREATE EXTERNAL TABLE my_test_table(`avreau_col_1` map&amp;lt;string,string&amp;gt;) 
ROW FORMAT SERDE &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.hadoop.hive.serde2.avro.AvroSerDe&apos;&lt;/span&gt; STORED AS  
INPUTFORMAT &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.hadoop.hive.ql.io.avro.AvroContainerInputFormat&apos;&lt;/span&gt;   
OUTPUTFORMAT &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.hadoop.hive.ql.io.avro.AvroContainerOutputFormat&apos;&lt;/span&gt; 
LOCATION &lt;span class=&quot;code-quote&quot;&gt;&apos;/user/fterrazzoni/my_test_table&apos;&lt;/span&gt; 
TBLPROPERTIES(&lt;span class=&quot;code-quote&quot;&gt;&quot;avro.schema.url&quot;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&quot;hdfs:&lt;span class=&quot;code-comment&quot;&gt;//localhost:9000/user/fterrazzoni/path/to/avro.schema&quot;&lt;/span&gt;) ;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Where : &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;/user/fterrazzoni/my_test_table/ is a directory containing the file I provided (map_null_val.avro).&lt;/li&gt;
	&lt;li&gt;/user/fterrazzoni/path/to/avro.schema is a text file containing the Avro schema corresponding to the data, which is:
  &lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  {&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;record&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;dku_record_0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;namespace&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;com.dataiku.dss&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;doc&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;,&quot;&lt;/span&gt;fields&lt;span class=&quot;code-quote&quot;&gt;&quot;:[{&quot;&lt;/span&gt;name&lt;span class=&quot;code-quote&quot;&gt;&quot;:&quot;&lt;/span&gt;avreau_col_1&lt;span class=&quot;code-quote&quot;&gt;&quot;,&quot;&lt;/span&gt;type&lt;span class=&quot;code-quote&quot;&gt;&quot;:[&quot;&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;,{&quot;&lt;/span&gt;type&lt;span class=&quot;code-quote&quot;&gt;&quot;:&quot;&lt;/span&gt;map&lt;span class=&quot;code-quote&quot;&gt;&quot;,&quot;&lt;/span&gt;values&lt;span class=&quot;code-quote&quot;&gt;&quot;:[&quot;&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;,&quot;&lt;/span&gt;string&lt;span class=&quot;code-quote&quot;&gt;&quot;]}],&quot;&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;&quot;:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}]}
  &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Now, you can simply try :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; SELECT * from my_test_table; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;... and observe that the result is correct.&lt;/p&gt;

&lt;p&gt;However, if you copy that into a Parquet table:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; 
CREATE TABLE test_parquet STORED AS PARQUET AS SELECT * FROM my_test_table;
SELECT * FROM test_parquet;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;... the output is corrupted.&lt;/p&gt;</comment>
                            <comment id="14181735" author="spena" created="Thu, 23 Oct 2014 18:35:39 +0000"  >&lt;p&gt;I cannot deserialize the avro schema on the current hive version 0.14.&lt;/p&gt;</comment>
                            <comment id="14190348" author="spena" created="Thu, 30 Oct 2014 16:44:11 +0000"  >&lt;p&gt;Attach patch that supports map null values on parquet.&lt;/p&gt;</comment>
                            <comment id="14191038" author="hiveqa" created="Thu, 30 Oct 2014 23:33:29 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12678229/HIVE-8359.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12678229/HIVE-8359.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 2 failed/errored test(s), 6609 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_transform_acid
org.apache.hive.minikdc.TestJdbcWithMiniKdc.testNegativeTokenAuth
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1561/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1561/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1561/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1561/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1561/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1561/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12678229 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14191049" author="spena" created="Thu, 30 Oct 2014 23:44:09 +0000"  >&lt;p&gt;I submitted the patch to code review.&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/27404/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/27404/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14209586" author="mickaellcr" created="Thu, 13 Nov 2014 11:07:20 +0000"  >&lt;p&gt;This is the same issue as &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6994&quot; title=&quot;parquet-hive createArray strips null elements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6994&quot;&gt;HIVE-6994&lt;/a&gt;. I made a fix also to handle map and array. We can also write nested complex type.&lt;/p&gt;</comment>
                            <comment id="14211423" author="brocknoland" created="Thu, 13 Nov 2014 23:00:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mickaellcr&quot; class=&quot;user-hover&quot; rel=&quot;mickaellcr&quot;&gt;mickaellcr&lt;/a&gt; - &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=spena&quot; class=&quot;user-hover&quot; rel=&quot;spena&quot;&gt;spena&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rdblue&quot; class=&quot;user-hover&quot; rel=&quot;rdblue&quot;&gt;rdblue&lt;/a&gt; have done a ton of review work on this issue. Thus I am inclined to commit this one. If we do, will there be any work in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6994&quot; title=&quot;parquet-hive createArray strips null elements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6994&quot;&gt;HIVE-6994&lt;/a&gt; or are they complete duplicates?&lt;/p&gt;</comment>
                            <comment id="14211431" author="rdblue" created="Thu, 13 Nov 2014 23:07:04 +0000"  >&lt;p&gt;Thanks, Brock. De-duplicating this and &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6994&quot; title=&quot;parquet-hive createArray strips null elements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6994&quot;&gt;HIVE-6994&lt;/a&gt; is on my list of to-do items for today. I really like the tests that Sergio has put together for this, but I still need to see what Mickael has done that isn&apos;t done by Sergio&apos;s patch. I think it would be good if we all looked over both and then discussed what is needed for both of them.&lt;/p&gt;</comment>
                            <comment id="14211466" author="spena" created="Thu, 13 Nov 2014 23:27:00 +0000"  >&lt;p&gt;I&apos;ll take a look at the code. &lt;/p&gt;</comment>
                            <comment id="14212048" author="mickaellcr" created="Fri, 14 Nov 2014 09:29:39 +0000"  >&lt;p&gt;Yes, I will take a look too and it&apos;s totally fine for me to take this patch !&lt;/p&gt;</comment>
                            <comment id="14212071" author="mickaellcr" created="Fri, 14 Nov 2014 09:54:16 +0000"  >&lt;p&gt;+1 for me.&lt;/p&gt;

&lt;p&gt;The patch works fine for map containing null values, but it doesn&apos;t solve the &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6994&quot; title=&quot;parquet-hive createArray strips null elements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6994&quot;&gt;HIVE-6994&lt;/a&gt;. So it&apos;s not duplicate. Can I remove the duplicate link ?&lt;/p&gt;</comment>
                            <comment id="14212632" author="rdblue" created="Fri, 14 Nov 2014 18:57:53 +0000"  >&lt;p&gt;Linking to the review, which I think has a newer patch.&lt;/p&gt;</comment>
                            <comment id="14212639" author="rdblue" created="Fri, 14 Nov 2014 19:01:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mickaellcr&quot; class=&quot;user-hover&quot; rel=&quot;mickaellcr&quot;&gt;mickaellcr&lt;/a&gt;, it looks &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6994&quot; title=&quot;parquet-hive createArray strips null elements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6994&quot;&gt;HIVE-6994&lt;/a&gt; fixes the read and write handling of Arrays to ensure that null values are written and read correctly. Is that a good summary?&lt;/p&gt;

&lt;p&gt;This issue fixes writing null values in maps and arrays. So I think there is still some duplication between the two where arrays are written. Given that &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=spena&quot; class=&quot;user-hover&quot; rel=&quot;spena&quot;&gt;spena&lt;/a&gt;&apos;s work includes unit tests for the write side, would you mind solving the duplication by working on the write side on this issue?&lt;/p&gt;</comment>
                            <comment id="14214470" author="mickaellcr" created="Mon, 17 Nov 2014 09:55:33 +0000"  >&lt;p&gt;Ok , I will work on this patch.&lt;/p&gt;</comment>
                            <comment id="14214915" author="mickaellcr" created="Mon, 17 Nov 2014 18:04:18 +0000"  >&lt;p&gt;I only did two minor changes on :&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;ql/src/java/org/apache/hadoop/hive/ql/io/parquet/convert/ArrayWritableGroupConverter.java&lt;/li&gt;
	&lt;li&gt;ql/src/java/org/apache/hadoop/hive/ql/io/parquet/serde/ParquetHiveSerDe.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;And added a qtest (same as &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6994&quot; title=&quot;parquet-hive createArray strips null elements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6994&quot;&gt;HIVE-6994&lt;/a&gt;). I used the patch available on the review link.&lt;/p&gt;</comment>
                            <comment id="14214974" author="brocknoland" created="Mon, 17 Nov 2014 18:48:35 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mickaellcr&quot; class=&quot;user-hover&quot; rel=&quot;mickaellcr&quot;&gt;mickaellcr&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;I believe that &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=spena&quot; class=&quot;user-hover&quot; rel=&quot;spena&quot;&gt;spena&lt;/a&gt; is still working this one based on the Review Board discussion here: &lt;a href=&quot;https://reviews.apache.org/r/27404/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/27404/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Sorry for the crossed wires!&lt;/p&gt;

&lt;p&gt;Brock&lt;/p&gt;</comment>
                            <comment id="14215220" author="hiveqa" created="Mon, 17 Nov 2014 21:37:29 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 no tests executed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12681943/HIVE-8359.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12681943/HIVE-8359.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1822/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1822/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1822/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1822/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1822/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1822/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Tests exited with: NonZeroExitCodeException
Command &apos;bash /data/hive-ptest/working/scratch/source-prep.sh&apos; failed with exit status 1 and output &apos;+ [[ -n /usr/java/jdk1.7.0_45-cloudera ]]
+ export JAVA_HOME=/usr/java/jdk1.7.0_45-cloudera
+ JAVA_HOME=/usr/java/jdk1.7.0_45-cloudera
+ export PATH=/usr/java/jdk1.7.0_45-cloudera/bin/:/usr/local/apache-maven-3.0.5/bin:/usr/java/jdk1.7.0_45-cloudera/bin:/usr/local/apache-ant-1.9.1/bin:/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/home/hiveptest/bin
+ PATH=/usr/java/jdk1.7.0_45-cloudera/bin/:/usr/local/apache-maven-3.0.5/bin:/usr/java/jdk1.7.0_45-cloudera/bin:/usr/local/apache-ant-1.9.1/bin:/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/home/hiveptest/bin
+ export &apos;ANT_OPTS=-Xmx1g -XX:MaxPermSize=256m &apos;
+ ANT_OPTS=&apos;-Xmx1g -XX:MaxPermSize=256m &apos;
+ export &apos;M2_OPTS=-Xmx1g -XX:MaxPermSize=256m -Dhttp.proxyHost=localhost -Dhttp.proxyPort=3128&apos;
+ M2_OPTS=&apos;-Xmx1g -XX:MaxPermSize=256m -Dhttp.proxyHost=localhost -Dhttp.proxyPort=3128&apos;
+ cd /data/hive-ptest/working/
+ tee /data/hive-ptest/logs/PreCommit-HIVE-TRUNK-Build-1822/source-prep.txt
+ [[ false == \t\r\u\e ]]
+ mkdir -p maven ivy
+ [[ svn = \s\v\n ]]
+ [[ -n &apos;&apos; ]]
+ [[ -d apache-svn-trunk-source ]]
+ [[ ! -d apache-svn-trunk-source/.svn ]]
+ [[ ! -d apache-svn-trunk-source ]]
+ cd apache-svn-trunk-source
+ svn revert -R .
++ egrep -v &apos;^X|^Performing status on external&apos;
++ awk &apos;{print $2}&apos;
++ svn status --no-ignore
+ rm -rf target datanucleus.log ant/target shims/target shims/0.20/target shims/0.20S/target shims/0.23/target shims/aggregator/target shims/common/target shims/common-secure/target shims/scheduler/target packaging/target hbase-handler/target testutils/target jdbc/target metastore/target itests/target itests/hcatalog-unit/target itests/test-serde/target itests/qtest/target itests/hive-unit/target itests/custom-serde/target itests/util/target hcatalog/target hcatalog/core/target hcatalog/streaming/target hcatalog/server-extensions/target hcatalog/hcatalog-pig-adapter/target hcatalog/webhcat/svr/target hcatalog/webhcat/java-client/target accumulo-handler/target hwi/target common/target common/src/gen contrib/target service/target serde/target beeline/target odbc/target cli/target ql/dependency-reduced-pom.xml ql/target
+ svn update
U    ql/src/test/results/clientnegative/udf_assert_true.q.out
U    ql/src/test/results/clientnegative/udf_assert_true2.q.out
U    ql/src/test/results/clientpositive/lateral_view_noalias.q.out
U    ql/src/test/results/clientpositive/lateral_view.q.out
U    ql/src/test/results/clientpositive/udtf_stack.q.out
U    ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcCtx.java
U    ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java

Fetching external item into &apos;hcatalog/src/test/e2e/harness&apos;
Updated external to revision 1640231.

Updated to revision 1640231.
+ patchCommandPath=/data/hive-ptest/working/scratch/smart-apply-patch.sh
+ patchFilePath=/data/hive-ptest/working/scratch/build.patch
+ [[ -f /data/hive-ptest/working/scratch/build.patch ]]
+ chmod +x /data/hive-ptest/working/scratch/smart-apply-patch.sh
+ /data/hive-ptest/working/scratch/smart-apply-patch.sh /data/hive-ptest/working/scratch/build.patch
The patch does not appear to apply with p0, p1, or p2
+ exit 1
&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12681943 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14215464" author="hiveqa" created="Tue, 18 Nov 2014 00:15:00 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12681988/HIVE-8359.4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12681988/HIVE-8359.4.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 6657 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_optimize_nullscan
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1824/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1824/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1824/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1824/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1824/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1824/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12681988 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14215481" author="brocknoland" created="Tue, 18 Nov 2014 00:29:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mickaellcr&quot; class=&quot;user-hover&quot; rel=&quot;mickaellcr&quot;&gt;mickaellcr&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;I was confused earlier... my mistake! The patch you attached to this JIRA is actually for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6994&quot; title=&quot;parquet-hive createArray strips null elements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6994&quot;&gt;HIVE-6994&lt;/a&gt;. Can you upload it there?&lt;/p&gt;</comment>
                            <comment id="14215985" author="mickaellcr" created="Tue, 18 Nov 2014 09:36:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brocknoland&quot; class=&quot;user-hover&quot; rel=&quot;brocknoland&quot;&gt;brocknoland&lt;/a&gt;, normally I picked the patch that &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rdblue&quot; class=&quot;user-hover&quot; rel=&quot;rdblue&quot;&gt;rdblue&lt;/a&gt; told me about (the review on the Review Board), but maybe not the last version.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rdblue&quot; class=&quot;user-hover&quot; rel=&quot;rdblue&quot;&gt;rdblue&lt;/a&gt; wanted me to update this patch to handle the &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6994&quot; title=&quot;parquet-hive createArray strips null elements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6994&quot;&gt;HIVE-6994&lt;/a&gt; instead of having two patches that will have the same behavior/code. And I like the way &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=spena&quot; class=&quot;user-hover&quot; rel=&quot;spena&quot;&gt;spena&lt;/a&gt; wrote the solution (better than mine in my opinion).&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=spena&quot; class=&quot;user-hover&quot; rel=&quot;spena&quot;&gt;spena&lt;/a&gt;, basically I modified the WritableGroupConverter to clean the &apos;current value&apos;. If you don&apos;t do that, you will never have a null value inside an array, but the previous one.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;diff --git ql/src/java/org/apache/hadoop/hive/ql/io/parquet/convert/ArrayWritableGroupConverter.java ql/src/java/org/apache/hadoop/hive/ql/io/parquet/convert/ArrayWritableGroupConverter.java
index 582a5df..052b36d 100644
--- ql/src/java/org/apache/hadoop/hive/ql/io/parquet/convert/ArrayWritableGroupConverter.java
+++ ql/src/java/org/apache/hadoop/hive/ql/io/parquet/convert/ArrayWritableGroupConverter.java
@@ -54,6 +54,7 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void start() {
     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (isMap) {
       mapPairContainer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Writable[2];
     }
+    currentValue = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
   }
 
   @Override
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And the second part was to add &quot;Null&quot; values from the ParquetHiveSerDe (values that I was skipping before for no valid reason).&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;diff --git ql/src/java/org/apache/hadoop/hive/ql/io/parquet/serde/ParquetHiveSerDe.java ql/src/java/org/apache/hadoop/hive/ql/io/parquet/serde/ParquetHiveSerDe.java
index b689336..4b36767 100644
--- ql/src/java/org/apache/hadoop/hive/ql/io/parquet/serde/ParquetHiveSerDe.java
+++ ql/src/java/org/apache/hadoop/hive/ql/io/parquet/serde/ParquetHiveSerDe.java
@@ -202,13 +202,11 @@ &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; ArrayWritable createArray(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; obj, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ListObjectInspector in
     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (sourceArray != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
       &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; curObj : sourceArray) {
-        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Writable newObj = createObject(curObj, subInspector);
-        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (newObj != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
-          array.add(newObj);
-        }
+        array.add(createObject(curObj, subInspector));
       }
     }
     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (array.size() &amp;gt; 0) {
-      &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ArrayWritable subArray = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayWritable(array.get(0).getClass(),
+      &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ArrayWritable subArray = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayWritable(Writable.class,
           array.toArray(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Writable[array.size()]));
       &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayWritable(Writable.class, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Writable[] {subArray});
     } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And the qtest was just to be sure to handle empty array, null array, array with null, and the same for map.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+++ data/files/parquet_array_null_element.txt
@@ -0,0 +1,3 @@
+1|,7|CARRELAGE,MOQUETTE|key11:value11,key12:value12,key13:value13
+2|,|CAILLEBOTIS,|
+3|,42,||key11:value11,key12:,key13:
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;If you want to integrate them into your patch, feel free to do it, else I might want to duplicate your patch (&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/tongue.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;) and add this fix.&lt;/p&gt;</comment>
                            <comment id="14216336" author="spena" created="Tue, 18 Nov 2014 15:53:52 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mickaellcr&quot; class=&quot;user-hover&quot; rel=&quot;mickaellcr&quot;&gt;mickaellcr&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Sorry for the confusion. I did not see you uploaded another patch here. &lt;br/&gt;
I just added two extra lines to the patch you uploaded. I will integrate your fixes there, and upload the patch again.&lt;/p&gt;</comment>
                            <comment id="14216357" author="spena" created="Tue, 18 Nov 2014 16:08:12 +0000"  >&lt;p&gt;Attach new patch that integrates Mickael Lacour &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6994&quot; title=&quot;parquet-hive createArray strips null elements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6994&quot;&gt;HIVE-6994&lt;/a&gt; fix.&lt;/p&gt;</comment>
                            <comment id="14216562" author="hiveqa" created="Tue, 18 Nov 2014 18:36:21 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12682178/HIVE-8359.5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12682178/HIVE-8359.5.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 2 failed/errored test(s), 6659 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_optimize_nullscan
org.apache.hive.hcatalog.streaming.TestStreaming.testTransactionBatchCommit_Json
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1835/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1835/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1835/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1835/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1835/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1835/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12682178 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14216579" author="rdblue" created="Tue, 18 Nov 2014 18:45:31 +0000"  >&lt;p&gt;I think with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mickaellcr&quot; class=&quot;user-hover&quot; rel=&quot;mickaellcr&quot;&gt;mickaellcr&lt;/a&gt;&apos;s addition, this is ready to go in.&lt;/p&gt;

&lt;p&gt;Good catch in the SerDe code, I didn&apos;t realize that the nulls were stripped at that point as well. I&apos;m a little confused about why we&apos;re translating the ArrayWritable again though: isn&apos;t this properly constructed by the Converter code? Why can&apos;t we just pass the ArrayWritable that was created already? It seems like we&apos;re doing a lot of unnecessary work here that we might be able to remove (in future patches). Ideally, we would detect that the structure matches what is expected by the following Hive code and pass it along.&lt;/p&gt;</comment>
                            <comment id="14217192" author="brocknoland" created="Wed, 19 Nov 2014 01:11:31 +0000"  >&lt;blockquote&gt;&lt;p&gt;this is ready to go in.....It seems like we&apos;re doing a lot of unnecessary work here that we might be able to remove (in future patches). &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It sounds like this change can be done in a future patch and you are +1 on committing this change?&lt;/p&gt;</comment>
                            <comment id="14217203" author="rdblue" created="Wed, 19 Nov 2014 01:16:56 +0000"  >&lt;p&gt;Yes. +1 on this change and we&apos;ll clean up the rest in a future patch and after I confirm what I think is happening.&lt;/p&gt;</comment>
                            <comment id="14217211" author="brocknoland" created="Wed, 19 Nov 2014 01:22:56 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14218321" author="brocknoland" created="Wed, 19 Nov 2014 19:06:46 +0000"  >&lt;p&gt;Thank you so much Sergio, Ryan and Mickael!! I have committed this contribution to trunk!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12750155">HIVE-8577</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12711521">HIVE-6994</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12708602">HIVE-6914</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12678229" name="HIVE-8359.1.patch" size="8594" author="spena" created="Thu, 30 Oct 2014 16:43:34 +0000"/>
                            <attachment id="12681943" name="HIVE-8359.2.patch" size="40162" author="mickaellcr" created="Mon, 17 Nov 2014 18:04:17 +0000"/>
                            <attachment id="12681988" name="HIVE-8359.4.patch" size="29898" author="spena" created="Mon, 17 Nov 2014 20:34:38 +0000"/>
                            <attachment id="12682178" name="HIVE-8359.5.patch" size="41365" author="spena" created="Tue, 18 Nov 2014 16:08:12 +0000"/>
                            <attachment id="12673130" name="map_null_val.avro" size="341" author="Akryus" created="Mon, 6 Oct 2014 17:25:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i20ujz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>