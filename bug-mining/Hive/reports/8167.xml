<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:21:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-21074] Hive bucketed table query pruning does not work for IS NOT NULL condition</title>
                <link>https://issues.apache.org/jira/browse/HIVE-21074</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The current version of bucket pruning skips all the predicates when it detects that one of the predicates is a compound type (e.g. NOT(IS_NULL) ) when evaluating AND logical operators.&lt;/p&gt;

&lt;p&gt;This logic is faulty since as long as one of the AND operators is a bucketed column (&lt;em&gt;col&lt;/em&gt; = &lt;b&gt;literal&lt;/b&gt;), the &lt;b&gt;literal&lt;/b&gt; value of that &lt;em&gt;col&lt;/em&gt; should be considered in the&#160;bucket pruning optimization no matter what. For example:&lt;/p&gt;

&lt;p&gt;SELECT * FROM tbl WHERE bucketed_col = 1 AND (some_compound_expr)&lt;/p&gt;

&lt;p&gt;Then the the value&#160;&apos;&lt;b&gt;1&apos;&lt;/b&gt;&#160;should be considered for pruning in the query plan. This limitation has manifested into a simpler case where a table that I am trying to optimized using bucketing technique is not effective when IS NOT NULL is used. Since IS NOT NULL is parsed into NOT(IS_NULL) (a compound expression), the pruning phase is completed skipped causing unnecessary tasks to be spawned. For instance:&lt;/p&gt;

&lt;p&gt;SELECT * FROM tbl WHERE bucketed_col = 1 AND some_other_col IS NOT NULL&lt;/p&gt;

&lt;p&gt;Will not trigger bucket pruning logic and perform a full table scan.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13206780">HIVE-21074</key>
            <summary>Hive bucketed table query pruning does not work for IS NOT NULL condition</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="szita">&#193;d&#225;m Szita</assignee>
                                    <reporter username="thaibui">Thai Bui</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 28 Dec 2018 08:23:45 +0000</created>
                <updated>Thu, 17 Nov 2022 08:55:17 +0000</updated>
                            <resolved>Thu, 13 Jan 2022 08:31:05 +0000</resolved>
                                    <version>3.1.0</version>
                    <version>3.0.0</version>
                    <version>3.1.1</version>
                                    <fixVersion>4.0.0-alpha-1</fixVersion>
                                    <component>Logical Optimizer</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16730463" author="thaibui" created="Fri, 28 Dec 2018 20:28:20 +0000"  >&lt;p&gt;This is fixed in&#160;&lt;a href=&quot;https://jira.apache.org/jira/browse/HIVE-19097&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://jira.apache.org/jira/browse/HIVE-19097&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16730573" author="thaibui" created="Sat, 29 Dec 2018 05:32:56 +0000"  >&lt;p&gt;I&apos;m attaching the patch for this work anyway in case anyone want to backport a simpler fix to older branches.&#160;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12953286/12953286_HIVE-21074.patch&quot; title=&quot;HIVE-21074.patch attached to HIVE-21074&quot;&gt;HIVE-21074.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17469926" author="szita" created="Thu, 6 Jan 2022 13:55:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thaibui&quot; class=&quot;user-hover&quot; rel=&quot;thaibui&quot;&gt;thaibui&lt;/a&gt; - I don&apos;t think this is solved by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-19097&quot; title=&quot;related equals and in operators may cause inaccurate stats estimations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-19097&quot;&gt;&lt;del&gt;HIVE-19097&lt;/del&gt;&lt;/a&gt; and I don&apos;t even see how that would help this issue. I can take this over unless you have cycles to work on this of course.&lt;/p&gt;</comment>
                            <comment id="17475173" author="szita" created="Thu, 13 Jan 2022 08:31:05 +0000"  >&lt;p&gt;This is now committed to master. Thanks to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thaibui&quot; class=&quot;user-hover&quot; rel=&quot;thaibui&quot;&gt;thaibui&lt;/a&gt; as the original contributor, and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pvary&quot; class=&quot;user-hover&quot; rel=&quot;pvary&quot;&gt;pvary&lt;/a&gt; for reviewing.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13149726">HIVE-19097</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12953286" name="HIVE-21074.patch" size="6228" author="thaibui" created="Sat, 29 Dec 2018 05:32:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 43 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|u00d5k:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>