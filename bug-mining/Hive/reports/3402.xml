<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:32:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-10514] Fix MiniCliDriver tests failure</title>
                <link>https://issues.apache.org/jira/browse/HIVE-10514</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The MinimrCliDriver tests always fail to run.&lt;/p&gt;

&lt;p&gt;This can be reproduced by the following, run the command:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;mvn -B test -Phadoop-2 -Dtest=TestMinimrCliDriver -Dminimr.query.files=infer_bucket_sort_map_operators.q,join1.q,bucketmapjoin7.q,udf_using.q
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And the following exception comes:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.1:testCompile (default-testCompile) on project hive-it-qfile: Compilation failure
[ERROR] /Users/szehon/repos/apache-hive-git/hive/itests/qtest/target/generated-test-sources/java/org/apache/hadoop/hive/cli/TestCliDriver.java:[100,22] code too large
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12825345">HIVE-10514</key>
            <summary>Fix MiniCliDriver tests failure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hsubramaniyan">Hari Sankar Sivarama Subramaniyan</assignee>
                                    <reporter username="szehon">Szehon Ho</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Apr 2015 01:24:26 +0000</created>
                <updated>Mon, 18 May 2015 19:54:26 +0000</updated>
                            <resolved>Fri, 1 May 2015 08:48:12 +0000</resolved>
                                                    <fixVersion>1.2.0</fixVersion>
                                    <component>Testing Infrastructure</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14516175" author="ferd" created="Tue, 28 Apr 2015 01:55:42 +0000"  >&lt;p&gt;Only a rough idea, how about separating the code into several parts?&lt;/p&gt;</comment>
                            <comment id="14516520" author="hsubramaniyan" created="Tue, 28 Apr 2015 06:37:22 +0000"  >&lt;p&gt;Tested with this patch locally and it seems to work. I can upload an improved version of the patch if someone can verify this patch and the approach.&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Hari&lt;/p&gt;</comment>
                            <comment id="14516633" author="sushanth" created="Tue, 28 Apr 2015 08:18:09 +0000"  >&lt;p&gt;Good work, Hari. From looking at the diff between ./itests/qtest/target/generated-test-sources/java/org/apache/hadoop/hive/cli/ before and after your patch, I see what it&apos;s doing, and it makes sense. We&apos;ll wait on the test run to see if it succeeds properly, and whether or not this gets us around the 64kb method problem.&lt;/p&gt;

&lt;p&gt;Also, on my local box, the command specified in the bug description works after your patch:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;thunderfall:itests sush$ mvn -B test -Phadoop-2 -Dtest=TestMinimrCliDriver -Dminimr.query.files=infer_bucket_sort_map_operators.q,join1.q,bucketmapjoin7.q,udf_using.q
[INFO] Scanning for projects...
...
[INFO] Executed tasks
[INFO] 
[INFO] --- maven-compiler-plugin:3.1:testCompile (default-testCompile) @ hive-it-qfile ---
[INFO] Compiling 14 source files to /Users/sush/dev/hive.git/itests/qtest/target/test-classes
[INFO] 
[INFO] --- maven-surefire-plugin:2.16:test (default-test) @ hive-it-qfile ---
[INFO] Surefire report directory: /Users/sush/dev/hive.git/itests/qtest/target/surefire-reports

-------------------------------------------------------
 T E S T S
-------------------------------------------------------

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running org.apache.hadoop.hive.cli.TestMinimrCliDriver
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 706.564 sec - in org.apache.hadoop.hive.cli.TestMinimrCliDriver

Results :

Tests run: 5, Failures: 0, Errors: 0, Skipped: 0
...
[INFO] Reactor Summary:
[INFO] 
[INFO] Hive Integration - Parent ......................... SUCCESS [  1.036 s]
[INFO] Hive Integration - Custom Serde ................... SUCCESS [  1.845 s]
[INFO] Hive Integration - HCatalog Unit Tests ............ SUCCESS [  1.919 s]
[INFO] Hive Integration - Testing Utilities .............. SUCCESS [  1.636 s]
[INFO] Hive Integration - Unit Tests ..................... SUCCESS [  3.606 s]
[INFO] Hive Integration - Test Serde ..................... SUCCESS [  0.316 s]
[INFO] Hive Integration - QFile Tests .................... SUCCESS [11:49 min]
[INFO] JMH benchmark: Hive ............................... SUCCESS [  0.789 s]
[INFO] Hive Integration - Unit Tests - Hadoop 2 .......... SUCCESS [  0.791 s]
[INFO] Hive Integration - Unit Tests with miniKdc ........ SUCCESS [  1.120 s]
[INFO] Hive Integration - QFile Spark Tests .............. SUCCESS [  3.514 s]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 12:07 min
[INFO] Finished at: 2015-04-28T01:17:25-08:00
[INFO] Final Memory: 90M/466M
[INFO] ------------------------------------------------------------------------
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;+1 on intent and change, waiting on test results.&lt;/p&gt;</comment>
                            <comment id="14516677" author="hsubramaniyan" created="Tue, 28 Apr 2015 08:58:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sushanth&quot; class=&quot;user-hover&quot; rel=&quot;sushanth&quot;&gt;sushanth&lt;/a&gt; Thanks for the review. In patch #2&lt;br/&gt;
1. Made minor modification to the previous patch to generate txt file&lt;br/&gt;
2. Identified several places where we might run into similar issues in future. I have made changes in all such places which might be an &quot;overkill&quot; for now given the fact that we currently do not run into any issues for tests other than MiniMrCliDriver; however, in the long run, I believe this is a safer approach than getting blocked on unit tests.&lt;/p&gt;

&lt;p&gt;Please review and let me know which one of the patches is good to go.&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Hari&lt;/p&gt;</comment>
                            <comment id="14518158" author="hiveqa" created="Tue, 28 Apr 2015 21:49:00 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12728744/HIVE-10514.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12728744/HIVE-10514.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 2 failed/errored test(s), 8872 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestCustomAuthentication - did not produce a TEST-*.xml file
org.apache.hive.jdbc.TestSSL.testSSLConnectionWithProperty
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3631/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3631/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3631/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3631/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-3631/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-3631/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12728744 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14518161" author="hsubramaniyan" created="Tue, 28 Apr 2015 21:51:39 +0000"  >&lt;p&gt;The above test failures are unrelated to the change. On the positive side, no more TestMiniMrCliDriver failures.&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Hari&lt;/p&gt;</comment>
                            <comment id="14518170" author="szehon" created="Tue, 28 Apr 2015 21:58:20 +0000"  >&lt;p&gt;Thanks a lot for looking at this!  I&apos;m just curious, is writing the qfile names out to a temporary file necessary, what is the difference with #foreach ($qf in $qfiles)?&lt;/p&gt;</comment>
                            <comment id="14518192" author="hsubramaniyan" created="Tue, 28 Apr 2015 22:08:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=szehon&quot; class=&quot;user-hover&quot; rel=&quot;szehon&quot;&gt;szehon&lt;/a&gt; The difference is that without the patch, the suite() in TestCliDriver.java would be huge enough to cause code size limit issues. i.e, the following line would be present in suite for each and every qfile executed under the test suite.&lt;/p&gt;
  {source}&lt;br/&gt;
    if(qFilesToExecute.isEmpty() || qFilesToExecute.contains(&quot;$fname&quot;)) {&lt;br/&gt;
      suite.addTest(new $className(&quot;testCliDriver_$tname&quot;, setup));&lt;br/&gt;
  {source}

&lt;p&gt;i.e, close to 5000+ LOC inside suite() as of today.&lt;/p&gt;

&lt;p&gt;I didnt see a direct way of avoid writing the qfile names to a temporary file or storing it somewhere so that they can be iterated at test suite runtime. Please let me know if there is an easier approach I missed.&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Hari&lt;/p&gt;</comment>
                            <comment id="14518244" author="szehon" created="Tue, 28 Apr 2015 22:32:09 +0000"  >&lt;p&gt;OK, got it.  I think last patch looks great, wondering if we can have a central method in QtestUtil for these methods (for writing the file, and reading)?&lt;/p&gt;</comment>
                            <comment id="14518567" author="hsubramaniyan" created="Wed, 29 Apr 2015 02:03:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=szehon&quot; class=&quot;user-hover&quot; rel=&quot;szehon&quot;&gt;szehon&lt;/a&gt; Good point, I have refactored the code to avoid redundancy. Please take a look at patch#3.&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Hari&lt;/p&gt;</comment>
                            <comment id="14518731" author="szehon" created="Wed, 29 Apr 2015 04:57:08 +0000"  >&lt;p&gt;+1 looks good to me, thanks for taking care of this.&lt;/p&gt;</comment>
                            <comment id="14522711" author="hiveqa" created="Fri, 1 May 2015 03:16:30 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12729026/HIVE-10514.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12729026/HIVE-10514.3.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 8881 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.ql.security.TestStorageBasedMetastoreAuthorizationDrops.testDropTable
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3673/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3673/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3673/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3673/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-3673/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-3673/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12729026 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14522949" author="sushanth" created="Fri, 1 May 2015 08:43:35 +0000"  >&lt;p&gt;+1, will go ahead and commit to master and branch-1.2&lt;/p&gt;</comment>
                            <comment id="14522954" author="sushanth" created="Fri, 1 May 2015 08:48:12 +0000"  >&lt;p&gt;Committed to master and branch-1.2.&lt;/p&gt;

&lt;p&gt;Thanks Hari &amp;amp; Szehon!&lt;/p&gt;</comment>
                            <comment id="14548974" author="sushanth" created="Mon, 18 May 2015 19:54:26 +0000"  >&lt;p&gt;This issue has been fixed and released as part of the 1.2.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12728743" name="HIVE-10514.1.patch" size="3526" author="hsubramaniyan" created="Tue, 28 Apr 2015 09:07:41 +0000"/>
                            <attachment id="12728744" name="HIVE-10514.2.patch" size="13799" author="hsubramaniyan" created="Tue, 28 Apr 2015 09:07:54 +0000"/>
                            <attachment id="12729026" name="HIVE-10514.3.patch" size="15269" author="hsubramaniyan" created="Wed, 29 Apr 2015 02:03:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 27 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2dzaf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>