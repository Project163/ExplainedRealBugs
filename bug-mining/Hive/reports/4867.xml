<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:47:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-14566] LLAP IO reads timestamp wrongly</title>
                <link>https://issues.apache.org/jira/browse/HIVE-14566</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-10127&quot; title=&quot;LLAP: Port changes to timestamp stream reader after timezone fix in trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-10127&quot;&gt;&lt;del&gt;HIVE-10127&lt;/del&gt;&lt;/a&gt; is causing incorrect results when orc_merge12.q is run in llap.&lt;br/&gt;
It reads timestamp wrongly.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;LLAP IO Enabled&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; select atimestamp1 from alltypesorc3xcols limit 10;
OK
1969-12-31 15:59:46.674
NULL
1969-12-31 15:59:55.787
1969-12-31 15:59:44.187
1969-12-31 15:59:50.434
1969-12-31 16:00:15.007
1969-12-31 16:00:07.021
1969-12-31 16:00:04.963
1969-12-31 15:59:52.176
1969-12-31 15:59:44.569
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;LLAP IO Disabled&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; select atimestamp1 from alltypesorc3xcols limit 10;
OK
1969-12-31 15:59:46.674
NULL
1969-12-31 15:59:55.787
1969-12-31 15:59:44.187
1969-12-31 15:59:50.434
1969-12-31 16:00:14.007
1969-12-31 16:00:06.021
1969-12-31 16:00:03.963
1969-12-31 15:59:52.176
1969-12-31 15:59:44.569
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12998083">HIVE-14566</key>
            <summary>LLAP IO reads timestamp wrongly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="prasanth_j">Prasanth Jayachandran</assignee>
                                    <reporter username="prasanth_j">Prasanth Jayachandran</reporter>
                        <labels>
                    </labels>
                <created>Thu, 18 Aug 2016 01:35:12 +0000</created>
                <updated>Thu, 8 Dec 2016 14:10:13 +0000</updated>
                            <resolved>Fri, 19 Aug 2016 07:13:28 +0000</resolved>
                                    <version>2.0.1</version>
                    <version>2.1.0</version>
                    <version>2.2.0</version>
                                    <fixVersion>2.1.1</fixVersion>
                    <fixVersion>2.2.0</fixVersion>
                                    <component>llap</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15425810" author="prasanth_j" created="Thu, 18 Aug 2016 02:18:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt;/&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gopalv&quot; class=&quot;user-hover&quot; rel=&quot;gopalv&quot;&gt;gopalv&lt;/a&gt; Can someone please review this patch?&lt;/p&gt;</comment>
                            <comment id="15426910" author="sershe" created="Thu, 18 Aug 2016 17:56:13 +0000"  >&lt;p&gt;One comment on RB&lt;/p&gt;</comment>
                            <comment id="15426977" author="thejas" created="Thu, 18 Aug 2016 18:49:10 +0000"  >&lt;p&gt;What is causing the issue ? I see you are fixing by passing the timezone, but I assume this 1 sec difference is not caused by difference in timezone across machines or so.&lt;/p&gt;</comment>
                            <comment id="15427129" author="prasanth_j" created="Thu, 18 Aug 2016 20:53:21 +0000"  >&lt;p&gt;The issue is actually not 1 second difference. It happened to be the case in the test case (data/files/alltypesorc3xcols file was written with different timezone). The actual issue is, llap reader was not making timezone adjustments when reading timestamp columns causing difference in results. The non-llap reader used to make the timezone adjustments during start of stripe. This was missing for llap &lt;a href=&quot;https://github.com/apache/hive/blob/master/orc/src/java/org/apache/orc/impl/TreeReaderFactory.java#L870&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/blob/master/orc/src/java/org/apache/orc/impl/TreeReaderFactory.java#L870&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Each stripe in orc maintains the timezone that was used by the writer. The reader reads the timestamp values using reader&apos;s timezone and by knowing the writer&apos;s timezone information from the stripe footer, the reader will make offset adjustments to read timestamp correctly. &lt;/p&gt;</comment>
                            <comment id="15427203" author="prasanth_j" created="Thu, 18 Aug 2016 21:35:56 +0000"  >&lt;p&gt;Addressed &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt;&apos;s review comments.&lt;/p&gt;</comment>
                            <comment id="15427294" author="owen.omalley" created="Thu, 18 Aug 2016 22:35:16 +0000"  >&lt;p&gt;I really think that we need to make a context object for passing information down to the tree reader. Otherwise, we are going to get killed by adding parameters to this, especially when ORC makes it out of Hive.&lt;/p&gt;

&lt;p&gt;How about something like:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; Context {
  SchemaEvolution getEvolution();
  &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; skipCorrupt();
  &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; writerTimezone();
}

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; TreeReader createTreeReader(TypeDescription readerType,
                                                                      Context context) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then we can add new information without making sure a huge change that touches all of the methods.&lt;/p&gt;</comment>
                            <comment id="15427401" author="prasanth_j" created="Fri, 19 Aug 2016 00:24:44 +0000"  >&lt;p&gt;Added a junit test.&lt;/p&gt;</comment>
                            <comment id="15427415" author="sershe" created="Fri, 19 Aug 2016 00:43:22 +0000"  >&lt;p&gt;+1 pending tests&lt;/p&gt;</comment>
                            <comment id="15427635" author="hiveqa" created="Fri, 19 Aug 2016 05:09:03 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12824472/HIVE-14566.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12824472/HIVE-14566.3.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 8 failed/errored test(s), 10443 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainuser_1]
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainuser_2]
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[load_dyn_part1]
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[load_dyn_part2]
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[transform_ppr1]
org.apache.hive.beeline.TestBeeLineWithArgs.testEmbeddedBeelineOutputs
org.apache.hive.jdbc.TestJdbcWithMiniHS2.testSelectThriftSerializeInTasks
org.apache.hive.service.cli.operation.TestOperationLoggingLayout.testSwitchLogLayout
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/934/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/934/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/934/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/934/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-934/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-934/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 8 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12824472 - PreCommit-HIVE-MASTER-Build&lt;/p&gt;</comment>
                            <comment id="15427736" author="prasanth_j" created="Fri, 19 Aug 2016 07:13:29 +0000"  >&lt;p&gt;Will address Owen&apos;s comments in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-14584&quot; title=&quot;Pass Context to Orc tree readers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-14584&quot;&gt;HIVE-14584&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;Committed patch to master and branch-2.1&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12824273" name="HIVE-14566.1.patch" size="72509" author="prasanth_j" created="Thu, 18 Aug 2016 02:18:05 +0000"/>
                            <attachment id="12824446" name="HIVE-14566.2.patch" size="65800" author="prasanth_j" created="Thu, 18 Aug 2016 21:35:56 +0000"/>
                            <attachment id="12824472" name="HIVE-14566.3.patch" size="70318" author="prasanth_j" created="Fri, 19 Aug 2016 00:24:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 13 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i32gdb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12334255">2.1.0</customfieldvalue>
    <customfieldvalue id="12335837">2.2.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>