<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:24:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-8261] CBO : Predicate pushdown is removed by Optiq </title>
                <link>https://issues.apache.org/jira/browse/HIVE-8261</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Plan for TPC-DS Q64 wasn&apos;t optimal upon looking at the logical plan I realized that predicate pushdown is not applied on date_dim d1.&lt;/p&gt;

&lt;p&gt;Interestingly before optiq we have the predicate pushed :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;HiveFilterRel(condition=[&amp;lt;=($5, $1)])
    HiveJoinRel(condition=[=($3, $6)], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;])
      HiveProjectRel(_o__col0=[$0], _o__col1=[$2], _o__col2=[$3], _o__col3=[$1])
        HiveFilterRel(condition=[=($0, 2000)])
          HiveAggregateRel(group=[{0, 1}], agg#0=[count()], agg#1=[sum($2)])
            HiveProjectRel($f0=[$4], $f1=[$5], $f2=[$2])
              HiveJoinRel(condition=[=($1, $8)], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;])
                HiveJoinRel(condition=[=($1, $5)], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;])
                  HiveJoinRel(condition=[=($0, $3)], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;])
                    HiveProjectRel(ss_sold_date_sk=[$0], ss_item_sk=[$2], ss_wholesale_cost=[$11])
                      HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.store_sales]])
                    HiveProjectRel(d_date_sk=[$0], d_year=[$6])
                      HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.date_dim]])
                  HiveFilterRel(condition=[AND(in($2, &lt;span class=&quot;code-quote&quot;&gt;&apos;maroon&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;burnished&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;dim&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;steel&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;navajo&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;chocolate&apos;&lt;/span&gt;), between(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, $1, 35, +(35, 10)), between(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, $1, +(35, 1), +(35, 15)))])
                    HiveProjectRel(i_item_sk=[$0], i_current_price=[$5], i_color=[$17])
                      HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.item]])
                HiveProjectRel(_o__col0=[$0])
                  HiveAggregateRel(group=[{0}])
                    HiveProjectRel($f0=[$0])
                      HiveJoinRel(condition=[AND(=($0, $2), =($1, $3))], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;])
                        HiveProjectRel(cs_item_sk=[$15], cs_order_number=[$17])
                          HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.catalog_sales]])
                        HiveProjectRel(cr_item_sk=[$2], cr_order_number=[$16])
                          HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.catalog_returns]])
      HiveProjectRel(_o__col0=[$0], _o__col1=[$2], _o__col3=[$1])
        HiveFilterRel(condition=[=($0, +(2000, 1))])
          HiveAggregateRel(group=[{0, 1}], agg#0=[count()])
            HiveProjectRel($f0=[$4], $f1=[$5], $f2=[$2])
              HiveJoinRel(condition=[=($1, $8)], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;])
                HiveJoinRel(condition=[=($1, $5)], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;])
                  HiveJoinRel(condition=[=($0, $3)], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;])
                    HiveProjectRel(ss_sold_date_sk=[$0], ss_item_sk=[$2], ss_wholesale_cost=[$11])
                      HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.store_sales]])
                    HiveProjectRel(d_date_sk=[$0], d_year=[$6])
                      HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.date_dim]])
                  HiveFilterRel(condition=[AND(in($2, &lt;span class=&quot;code-quote&quot;&gt;&apos;maroon&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;burnished&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;dim&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;steel&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;navajo&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;chocolate&apos;&lt;/span&gt;), between(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, $1, 35, +(35, 10)), between(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, $1, +(35, 1), +(35, 15)))])
                    HiveProjectRel(i_item_sk=[$0], i_current_price=[$5], i_color=[$17])
                      HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.item]])
                HiveProjectRel(_o__col0=[$0])
                  HiveAggregateRel(group=[{0}])
                    HiveProjectRel($f0=[$0])
                      HiveJoinRel(condition=[AND(=($0, $2), =($1, $3))], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;])
                        HiveProjectRel(cs_item_sk=[$15], cs_order_number=[$17])
                          HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.catalog_sales]])
                        HiveProjectRel(cr_item_sk=[$2], cr_order_number=[$16])
                          HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.catalog_returns]])
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;While after Optiq the filter on date_dim gets pulled up the plan &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  HiveFilterRel(condition=[&amp;lt;=($5, $1)]): rowcount = 1.0, cumulative cost = {5.50188454E8 rows, 0.0 cpu, 0.0 io}, id = 6895
    HiveProjectRel(_o__col0=[$0], _o__col1=[$1], _o__col2=[$2], _o__col3=[$3], _o__col00=[$4], _o__col10=[$5], _o__col30=[$6]): rowcount = 1.0, cumulative cost = {5.50188454E8 rows, 0.0 cpu, 0.0 io}, id = 7046
      HiveJoinRel(condition=[=($3, $6)], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;]): rowcount = 1.0, cumulative cost = {5.50188454E8 rows, 0.0 cpu, 0.0 io}, id = 7041
        HiveProjectRel(_o__col0=[$0], _o__col1=[$2], _o__col2=[$3], _o__col3=[$1]): rowcount = 1.0, cumulative cost = {5.50188452E8 rows, 0.0 cpu, 0.0 io}, id = 6857
          HiveFilterRel(condition=[=($0, 2000)]): rowcount = 1.0, cumulative cost = {5.50188452E8 rows, 0.0 cpu, 0.0 io}, id = 6855
            HiveAggregateRel(group=[{0, 1}], agg#0=[count()], agg#1=[sum($2)]): rowcount = 1.0, cumulative cost = {5.50188452E8 rows, 0.0 cpu, 0.0 io}, id = 6853
              HiveProjectRel($f0=[$4], $f1=[$5], $f2=[$2]): rowcount = 1.0, cumulative cost = {5.50188452E8 rows, 0.0 cpu, 0.0 io}, id = 6851
                HiveProjectRel(ss_sold_date_sk=[$3], ss_item_sk=[$4], ss_wholesale_cost=[$5], d_date_sk=[$0], d_year=[$1], i_item_sk=[$6], i_current_price=[$7], i_color=[$8], _o__col0=[$2]): rowcount = 1.0, cumulative cost = {5.50188452E8 rows, 0.0 cpu, 0.0 io}, id = 7039
                  HiveJoinRel(condition=[=($3, $0)], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;]): rowcount = 1.0, cumulative cost = {5.50188452E8 rows, 0.0 cpu, 0.0 io}, id = 7037
                    HiveProjectRel(d_date_sk=[$0], d_year=[$6]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 6861
                      HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 6537
                    HiveJoinRel(condition=[=($2, $0)], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;]): rowcount = 1.0, cumulative cost = {5.50115402E8 rows, 0.0 cpu, 0.0 io}, id = 7035
                      HiveProjectRel(_o__col0=[$0]): rowcount = 38846.0, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 6847
                        HiveAggregateRel(group=[{0}]): rowcount = 38846.0, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 6845
                          HiveProjectRel($f0=[$0]): rowcount = 6.692553251460564E8, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 6843
                            HiveProjectRel(cs_item_sk=[$0], cs_order_number=[$1], cr_item_sk=[$2], cr_order_number=[$3]): rowcount = 6.692553251460564E8, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 6945
                              HiveJoinRel(condition=[AND(=($0, $2), =($1, $3))], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;]): rowcount = 6.692553251460564E8, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 6940
                                HiveProjectRel(cs_item_sk=[$15], cs_order_number=[$17]): rowcount = 2.86549727E8, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 6871
                                  HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.catalog_sales]]): rowcount = 2.86549727E8, cumulative cost = {0}, id = 6531
                                HiveProjectRel(cr_item_sk=[$2], cr_order_number=[$16]): rowcount = 2.8798881E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 6873
                                  HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.catalog_returns]]): rowcount = 2.8798881E7, cumulative cost = {0}, id = 6532
                      HiveJoinRel(condition=[=($1, $3)], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;]): rowcount = 1.0, cumulative cost = {5.50076555E8 rows, 0.0 cpu, 0.0 io}, id = 6996
                        HiveProjectRel(ss_sold_date_sk=[$0], ss_item_sk=[$2], ss_wholesale_cost=[$11]): rowcount = 5.50076554E8, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 6859
                          HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.store_sales]]): rowcount = 5.50076554E8, cumulative cost = {0}, id = 6538
                        HiveFilterRel(condition=[AND(in($2, &lt;span class=&quot;code-quote&quot;&gt;&apos;maroon&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;burnished&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;dim&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;steel&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;navajo&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;chocolate&apos;&lt;/span&gt;), between(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, $1, 35, +(35, 10)), between(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, $1, +(35, 1), +(35, 15)))]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 6833
                          HiveProjectRel(i_item_sk=[$0], i_current_price=[$5], i_color=[$17]): rowcount = 48000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 6831
                            HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.item]]): rowcount = 48000.0, cumulative cost = {0}, id = 6539
        HiveProjectRel(_o__col0=[$0], _o__col1=[$2], _o__col3=[$1]): rowcount = 1.0, cumulative cost = {5.50188452E8 rows, 0.0 cpu, 0.0 io}, id = 6891
          HiveFilterRel(condition=[=($0, +(2000, 1))]): rowcount = 1.0, cumulative cost = {5.50188452E8 rows, 0.0 cpu, 0.0 io}, id = 6889
            HiveAggregateRel(group=[{0, 1}], agg#0=[count()]): rowcount = 1.0, cumulative cost = {5.50188452E8 rows, 0.0 cpu, 0.0 io}, id = 6887
              HiveProjectRel($f0=[$4], $f1=[$5], $f2=[$2]): rowcount = 1.0, cumulative cost = {5.50188452E8 rows, 0.0 cpu, 0.0 io}, id = 6885
                HiveProjectRel(ss_sold_date_sk=[$3], ss_item_sk=[$4], ss_wholesale_cost=[$5], d_date_sk=[$0], d_year=[$1], i_item_sk=[$6], i_current_price=[$7], i_color=[$8], _o__col0=[$2]): rowcount = 1.0, cumulative cost = {5.50188452E8 rows, 0.0 cpu, 0.0 io}, id = 6992
                  HiveJoinRel(condition=[=($3, $0)], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;]): rowcount = 1.0, cumulative cost = {5.50188452E8 rows, 0.0 cpu, 0.0 io}, id = 6990
                    HiveProjectRel(d_date_sk=[$0], d_year=[$6]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 6861
                      HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 6537
                    HiveJoinRel(condition=[=($2, $0)], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;]): rowcount = 1.0, cumulative cost = {5.50115402E8 rows, 0.0 cpu, 0.0 io}, id = 6988
                      HiveProjectRel(_o__col0=[$0]): rowcount = 38846.0, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 6881
                        HiveAggregateRel(group=[{0}]): rowcount = 38846.0, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 6879
                          HiveProjectRel($f0=[$0]): rowcount = 6.692553251460564E8, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 6877
                            HiveProjectRel(cs_item_sk=[$0], cs_order_number=[$1], cr_item_sk=[$2], cr_order_number=[$3]): rowcount = 6.692553251460564E8, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 6938
                              HiveJoinRel(condition=[AND(=($0, $2), =($1, $3))], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;]): rowcount = 6.692553251460564E8, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 6933
                                HiveProjectRel(cs_item_sk=[$15], cs_order_number=[$17]): rowcount = 2.86549727E8, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 6871
                                  HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.catalog_sales]]): rowcount = 2.86549727E8, cumulative cost = {0}, id = 6531
                                HiveProjectRel(cr_item_sk=[$2], cr_order_number=[$16]): rowcount = 2.8798881E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 6873
                                  HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.catalog_returns]]): rowcount = 2.8798881E7, cumulative cost = {0}, id = 6532
                      HiveJoinRel(condition=[=($1, $3)], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;]): rowcount = 1.0, cumulative cost = {5.50076555E8 rows, 0.0 cpu, 0.0 io}, id = 6949
                        HiveProjectRel(ss_sold_date_sk=[$0], ss_item_sk=[$2], ss_wholesale_cost=[$11]): rowcount = 5.50076554E8, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 6859
                          HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.store_sales]]): rowcount = 5.50076554E8, cumulative cost = {0}, id = 6538
                        HiveFilterRel(condition=[AND(in($2, &lt;span class=&quot;code-quote&quot;&gt;&apos;maroon&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;burnished&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;dim&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;steel&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;navajo&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;chocolate&apos;&lt;/span&gt;), between(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, $1, 35, +(35, 10)), between(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, $1, +(35, 1), +(35, 15)))]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 6867
                          HiveProjectRel(i_item_sk=[$0], i_current_price=[$5], i_color=[$17]): rowcount = 48000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 6865
                            HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200.item]]): rowcount = 48000.0, cumulative cost = {0}, id = 6539
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I simplified the query a little bit while still maintaining the query structure &lt;/p&gt;

&lt;p&gt;The query : &lt;br/&gt;
Note that the final join between cs1 and cs2 has a predicates  &quot;cs1.syear = 2000 and cs2.syear = 2000 + 1&quot;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;select cs1.syear ,cs1.cnt
     ,cs1.s1 ,cs2.syear ,cs2.cnt
from
(select d1.d_year as syear ,count(*) as cnt,sum(ss_wholesale_cost) as s1 ,i_item_sk as item_sk
  FROM   store_sales
        JOIN date_dim d1 ON store_sales.ss_sold_date_sk = d1.d_date_sk
        JOIN item ON store_sales.ss_item_sk = item.i_item_sk
        JOIN
 (select cs_item_sk
  from catalog_sales JOIN catalog_returns
  ON catalog_sales.cs_item_sk = catalog_returns.cr_item_sk
    and catalog_sales.cs_order_number = catalog_returns.cr_order_number
  group by cs_item_sk) cs_ui
ON store_sales.ss_item_sk = cs_ui.cs_item_sk
  WHERE  
         i_color in (&lt;span class=&quot;code-quote&quot;&gt;&apos;maroon&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;burnished&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;dim&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;steel&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;navajo&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;chocolate&apos;&lt;/span&gt;) and
         i_current_price between 35 and 35 + 10 and
         i_current_price between 35 + 1 and 35 + 15
group by d1.d_year,i_item_sk
) cs1
JOIN
(select d1.d_year as syear ,count(*) as cnt,sum(ss_wholesale_cost) as s1 , i_item_sk as item_sk
  FROM   store_sales
        JOIN date_dim d1 ON store_sales.ss_sold_date_sk = d1.d_date_sk
        JOIN item ON store_sales.ss_item_sk = item.i_item_sk
        JOIN
 (select cs_item_sk
  from catalog_sales JOIN catalog_returns
  ON catalog_sales.cs_item_sk = catalog_returns.cr_item_sk
    and catalog_sales.cs_order_number = catalog_returns.cr_order_number
  group by cs_item_sk) cs_ui
ON store_sales.ss_item_sk = cs_ui.cs_item_sk
  WHERE  
         i_color in (&lt;span class=&quot;code-quote&quot;&gt;&apos;maroon&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;burnished&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;dim&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;steel&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;navajo&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;chocolate&apos;&lt;/span&gt;) and
         i_current_price between 35 and 35 + 10 and
         i_current_price between 35 + 1 and 35 + 15
group by d1.d_year,i_item_sk
) cs2
ON cs1.item_sk=cs2.item_sk
where 
     cs1.syear = 2000 and
     cs2.syear = 2000 + 1 and
     cs2.cnt &amp;lt;= cs1.cnt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12744155">HIVE-8261</key>
            <summary>CBO : Predicate pushdown is removed by Optiq </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rhbutani">Harish Butani</assignee>
                                    <reporter username="mmokhtar">Mostafa Mokhtar</reporter>
                        <labels>
                    </labels>
                <created>Thu, 25 Sep 2014 22:41:41 +0000</created>
                <updated>Thu, 13 Nov 2014 19:44:00 +0000</updated>
                            <resolved>Tue, 30 Sep 2014 17:52:17 +0000</resolved>
                                    <version>0.13.1</version>
                    <version>0.14.0</version>
                                    <fixVersion>0.14.0</fixVersion>
                                    <component>CBO</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14148439" author="mmokhtar" created="Thu, 25 Sep 2014 22:51:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=julianhyde&quot; class=&quot;user-hover&quot; rel=&quot;julianhyde&quot;&gt;julianhyde&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14148448" author="mmokhtar" created="Thu, 25 Sep 2014 22:56:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jpullokkaran&quot; class=&quot;user-hover&quot; rel=&quot;jpullokkaran&quot;&gt;jpullokkaran&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14149868" author="rhbutani" created="Fri, 26 Sep 2014 19:41:16 +0000"  >&lt;p&gt;This is because there is no PushFilterPastAgg rule. Just uploaded a patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/CALCITE-425&quot; title=&quot;Add FilterAggregateTransposeRule, that pushes a filter through an aggregate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CALCITE-425&quot;&gt;&lt;del&gt;OPTIQ-425&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
btw here is a simple query to reproduce this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;select syear, cnt
 from
 (select d1.d_year as syear ,count(*) as cnt
    FROM   store_sales
          JOIN date_dim d1 ON store_sales.ss_sold_date_sk = d1.d_date_sk
 group by d1.d_year
  ) cs
 where cs.syear = 2000
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14152413" author="hiveqa" created="Mon, 29 Sep 2014 22:17:43 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12671835/HIVE-8261.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12671835/HIVE-8261.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 6371 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hive.hcatalog.streaming.TestStreaming.testInterleavedTransactionBatchCommits
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1041/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1041/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1041/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1041/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1041/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1041/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12671835&lt;/p&gt;</comment>
                            <comment id="14152448" author="rhbutani" created="Mon, 29 Sep 2014 22:42:10 +0000"  >&lt;p&gt;Failed test &apos;testInterleavedTransactionBatchCommits&apos; doesn&apos;t seem related to this patch.&lt;/p&gt;</comment>
                            <comment id="14152710" author="hagleitn" created="Tue, 30 Sep 2014 01:58:41 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14153455" author="rhbutani" created="Tue, 30 Sep 2014 17:52:17 +0000"  >&lt;p&gt;Committed to trunk.&lt;/p&gt;</comment>
                            <comment id="14160999" author="rhbutani" created="Mon, 6 Oct 2014 21:32:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vikram.dixit&quot; class=&quot;user-hover&quot; rel=&quot;vikram.dixit&quot;&gt;vikram.dixit&lt;/a&gt;  can be add this to 0.14 branch&lt;/p&gt;</comment>
                            <comment id="14162172" author="vikram.dixit" created="Tue, 7 Oct 2014 17:40:06 +0000"  >&lt;p&gt;+1 for 0.14&lt;/p&gt;</comment>
                            <comment id="14162194" author="rhbutani" created="Tue, 7 Oct 2014 17:54:56 +0000"  >&lt;p&gt;thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vikram.dixit&quot; class=&quot;user-hover&quot; rel=&quot;vikram.dixit&quot;&gt;vikram.dixit&lt;/a&gt; committed to 0.14&lt;/p&gt;</comment>
                            <comment id="14211076" author="thejas" created="Thu, 13 Nov 2014 19:44:00 +0000"  >&lt;p&gt;This has been fixed in 0.14 release. Please open new jira if you see any issues.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="12744161">HIVE-8263</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12671835" name="HIVE-8261.1.patch" size="1845" author="rhbutani" created="Mon, 29 Sep 2014 18:18:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i20i0v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>