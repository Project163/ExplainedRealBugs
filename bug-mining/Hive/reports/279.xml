<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 17:54:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-902] cli.sh can not correctly identify Hadoop minor version numbers less than 20</title>
                <link>https://issues.apache.org/jira/browse/HIVE-902</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;cli.sh uses the following logic to detect the version of hadoop:&lt;/p&gt;

&lt;p&gt;  version=$($HADOOP version | awk &apos;&lt;/p&gt;
{print $2;}&apos;);&lt;br/&gt;
&lt;br/&gt;
  if [[ $version =~ &quot;^0\.17&quot; ]] || [[ $version =~ &quot;^0\.18&quot; ]] || [[ $version =~ &quot;^0.19&quot; ]]; then&lt;br/&gt;
      exec $HADOOP jar $AUX_JARS_CMD_LINE ${HIVE_LIB}/hive_cli.jar $CLASS $HIVE_OPTS &quot;$@&quot;&lt;br/&gt;
  else&lt;br/&gt;
      # hadoop 20 or newer - skip the aux_jars option. picked up from hiveconf&lt;br/&gt;
      exec $HADOOP jar ${HIVE_LIB}/hive_cli.jar $CLASS $HIVE_OPTS &quot;$@&quot; &lt;br/&gt;
  fi&lt;br/&gt;
&lt;br/&gt;
Apparently bash doesn&apos;t expect you to quote the regex:&lt;br/&gt;
&lt;br/&gt;
% ./bash -version&lt;br/&gt;
GNU bash, version 4.0.0(1)-release (i386-apple-darwin9.8.0)&lt;br/&gt;
&lt;br/&gt;
% hadoop version&lt;br/&gt;
Hadoop 0.19.0&lt;br/&gt;
Subversion &lt;a href=&quot;https://svn.apache.org/repos/asf/hadoop/core/branches/branch-0.19&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/asf/hadoop/core/branches/branch-0.19&lt;/a&gt; -r 713890&lt;br/&gt;
Compiled by ndaley on Fri Nov 14 03:12:29 UTC 2008&lt;br/&gt;
&lt;br/&gt;
% version=$(hadoop version | awk &apos;{print $2;}
&lt;p&gt;&apos;)&lt;/p&gt;

&lt;p&gt;% echo $version&lt;br/&gt;
0.19.0 &lt;a href=&quot;https://svn.apache.org/repos/asf/hadoop/core/branches/branch-0.19&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/asf/hadoop/core/branches/branch-0.19&lt;/a&gt; by&lt;/p&gt;

&lt;p&gt;% [[ $version =~ &quot;^0\.19&quot; ]] &amp;amp;&amp;amp; echo &quot;Yes&quot; || echo &quot;No&quot;&lt;br/&gt;
No&lt;/p&gt;

&lt;p&gt;% [[ $version =~ &quot;^0.19&quot; ]] &amp;amp;&amp;amp; echo &quot;Yes&quot; || echo &quot;No&quot;&lt;br/&gt;
No&lt;/p&gt;

&lt;p&gt;% [[ $version =~ ^0.19 ]] &amp;amp;&amp;amp; echo &quot;Yes&quot; || echo &quot;No&quot;&lt;br/&gt;
Yes&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12439045">HIVE-902</key>
            <summary>cli.sh can not correctly identify Hadoop minor version numbers less than 20</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cwsteinbach">Carl Steinbach</assignee>
                                    <reporter username="cwsteinbach">Carl Steinbach</reporter>
                        <labels>
                    </labels>
                <created>Mon, 26 Oct 2009 02:14:00 +0000</created>
                <updated>Sat, 17 Dec 2011 00:06:02 +0000</updated>
                            <resolved>Mon, 2 Nov 2009 07:20:42 +0000</resolved>
                                                    <fixVersion>0.4.1</fixVersion>
                    <fixVersion>0.5.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12772391" author="zshao" created="Mon, 2 Nov 2009 00:19:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-902&quot; title=&quot;cli.sh can not correctly identify Hadoop minor version numbers less than 20&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-902&quot;&gt;&lt;del&gt;HIVE-902&lt;/del&gt;&lt;/a&gt;.1.patch:&lt;/p&gt;

&lt;p&gt;I remember there is a hadoop version 0.17.2.1. It seems the patch does not handle this case.&lt;br/&gt;
Can you change the regex to work for that?&lt;br/&gt;
Also, please print out the hadoop version in the error message in case we cannot detect hadoop version, to make it easier to debug.&lt;/p&gt;

&lt;p&gt;Can you also help try it out on earlier versions of bash (bash 3.00 for example)?&lt;/p&gt;</comment>
                            <comment id="12772422" author="cwsteinbach" created="Mon, 2 Nov 2009 05:08:01 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Adjusted regex to handle version numbers like &quot;0.17.2.1&quot;&lt;/li&gt;
	&lt;li&gt;On error, now prints out string returned by &apos;hadoop version&apos;.&lt;/li&gt;
	&lt;li&gt;Verified that this works on Bash 3.2.17&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12772437" author="zshao" created="Mon, 2 Nov 2009 06:50:48 +0000"  >&lt;p&gt;+1. Will commit after test passes.&lt;/p&gt;</comment>
                            <comment id="12772442" author="zshao" created="Mon, 2 Nov 2009 07:20:42 +0000"  >&lt;p&gt;Committed. Thanks Carl!&lt;/p&gt;</comment>
                            <comment id="12772639" author="zshao" created="Mon, 2 Nov 2009 20:12:32 +0000"  >&lt;p&gt;Carl, it turns out bash 3.00 is complaining:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive/bin/ext/cli.sh: line 19: syntax error in conditional expression: unexpected token `(&apos;
hive/bin/ext/cli.sh: line 19: syntax error near `^([&apos;
hive/bin/ext/cli.sh: line 19: `  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; [[ $version =~ ^([[:digit:]]+)\.([[:digit:]]+)\.([[:digit:]]+).*$ ]]; then&apos;
hive/bin/hive: line 173: cli: command not found
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I tried both:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; [[ $version =~ &lt;span class=&quot;code-quote&quot;&gt;&quot;^([0-9]+)\.([[:digit:]]+)\.([[:digit:]]+).*$&quot;&lt;/span&gt; ]]; then
  major_ver=${BASH_REMATCH[1]};
  minor_ver=${BASH_REMATCH[2]};
  patch_ver=${BASH_REMATCH[3]};
  echo $major_ver $minor_ver $patch_ver;
fi
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; [[ &lt;span class=&quot;code-quote&quot;&gt;&quot;$version&quot;&lt;/span&gt; =~ ^&lt;span class=&quot;code-quote&quot;&gt;&quot;([0-9]+)\.([[:digit:]]+)\.([[:digit:]]+).*&quot;&lt;/span&gt;$ ]]; then
  major_ver=${BASH_REMATCH[1]};
  minor_ver=${BASH_REMATCH[2]};
  patch_ver=${BASH_REMATCH[3]};
  echo $major_ver $minor_ver $patch_ver;
fi
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Both of these worked on bash 3.00.&lt;/p&gt;

&lt;p&gt;Can you try these out on bash 4.00? Once it works, can you post another patch on top of the first one (since the first one is already committed..&lt;/p&gt;</comment>
                            <comment id="12772641" author="zshao" created="Mon, 2 Nov 2009 20:13:43 +0000"  >&lt;p&gt;Please replace &lt;span class=&quot;error&quot;&gt;&amp;#91;0-9&amp;#93;&lt;/span&gt;+ with [&lt;span class=&quot;error&quot;&gt;&amp;#91;:digit:&amp;#93;&lt;/span&gt;]+ in the previous comment - that was for debugging.&lt;/p&gt;</comment>
                            <comment id="12772643" author="zshao" created="Mon, 2 Nov 2009 20:15:58 +0000"  >&lt;p&gt;By the way, we also want to make it compatible with internal versions like &quot;0.20&quot;. Can you make the third argument (patch var) optional in the regex?&lt;/p&gt;</comment>
                            <comment id="12772647" author="zshao" created="Mon, 2 Nov 2009 20:24:10 +0000"  >&lt;p&gt;Carl, can you help test &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-902&quot; title=&quot;cli.sh can not correctly identify Hadoop minor version numbers less than 20&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-902&quot;&gt;&lt;del&gt;HIVE-902&lt;/del&gt;&lt;/a&gt;.repair.patch on bash 4.00?&lt;/p&gt;</comment>
                            <comment id="12772693" author="cwsteinbach" created="Mon, 2 Nov 2009 21:09:39 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-902&quot; title=&quot;cli.sh can not correctly identify Hadoop minor version numbers less than 20&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-902&quot;&gt;&lt;del&gt;HIVE-902&lt;/del&gt;&lt;/a&gt;.repair.patch does not work on Bash 4.0.33&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Underlying issue is described here: &lt;a href=&quot;http://stackoverflow.com/questions/218156/bash-regex-with-quotes&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/218156/bash-regex-with-quotes&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Tested &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-902&quot; title=&quot;cli.sh can not correctly identify Hadoop minor version numbers less than 20&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-902&quot;&gt;&lt;del&gt;HIVE-902&lt;/del&gt;&lt;/a&gt;.repair.2.patch on Bash 4.0.33 and 3.2.17&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12772695" author="cwsteinbach" created="Mon, 2 Nov 2009 21:10:55 +0000"  >&lt;p&gt;Zheng, can you test the updated patch on Bash 3.1? I can&apos;t get 3.1 to build because of readline problems. Thanks.&lt;/p&gt;</comment>
                            <comment id="12772705" author="cwsteinbach" created="Mon, 2 Nov 2009 21:40:53 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Fix version comparison logic.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12423160" name="HIVE-902.1.patch" size="931" author="cwsteinbach" created="Mon, 26 Oct 2009 02:15:37 +0000"/>
                            <attachment id="12423792" name="HIVE-902.2.patch" size="1009" author="cwsteinbach" created="Mon, 2 Nov 2009 05:08:01 +0000"/>
                            <attachment id="12423851" name="HIVE-902.repair.2.patch" size="802" author="cwsteinbach" created="Mon, 2 Nov 2009 21:09:39 +0000"/>
                            <attachment id="12423853" name="HIVE-902.repair.3.patch" size="1089" author="cwsteinbach" created="Mon, 2 Nov 2009 21:40:53 +0000"/>
                            <attachment id="12423849" name="HIVE-902.repair.patch" size="673" author="zshao" created="Mon, 2 Nov 2009 20:24:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73229</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 4 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lccn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122651</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-902&quot; title=&quot;cli.sh can not correctly identify Hadoop minor version numbers less than 20&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-902&quot;&gt;&lt;strike&gt;HIVE-902&lt;/strike&gt;&lt;/a&gt;. Fix cli.sh to work with hadoop versions less than 20. (Carl Steinbach via zshao)</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>