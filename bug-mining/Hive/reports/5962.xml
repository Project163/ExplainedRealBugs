<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:58:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-17973] Fix small bug in multi_insert_union_src.q</title>
                <link>https://issues.apache.org/jira/browse/HIVE-17973</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;in ql\src\test\queries\clientpositive\multi_insert_union_src.q, &lt;br/&gt;
There are two problems in the query file&lt;br/&gt;
 1.  It is strange to drop src_multi1 twice &lt;br/&gt;
 2. &lt;tt&gt;src1&lt;/tt&gt; is not created but used src1(Maybe we create src1 in other qfile)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
set hive.mapred.mode=nonstrict;
drop table &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists src2;
drop table &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists src_multi1;
drop table &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists src_multi1;
set hive.stats.dbclass=fs;
CREATE TABLE src2 as SELECT * FROM src;

create table src_multi1 like src;
create table src_multi2 like src;

explain
from (select * from src1 where key &amp;lt; 10 union all select * from src2 where key &amp;gt; 100) s
insert overwrite table src_multi1 select key, value where key &amp;lt; 150 order by key
insert overwrite table src_multi2 select key, value where key &amp;gt; 400 order by value;

from (select * from src1 where key &amp;lt; 10 union all select * from src2 where key &amp;gt; 100) s
insert overwrite table src_multi1 select key, value where key &amp;lt; 150 order by key
insert overwrite table src_multi2 select key, value where key &amp;gt; 400 order by value;

select * from src_multi1;
select * from src_multi2;


&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13115840">HIVE-17973</key>
            <summary>Fix small bug in multi_insert_union_src.q</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kellyzly">liyunzhang</assignee>
                                    <reporter username="kellyzly">liyunzhang</reporter>
                        <labels>
                    </labels>
                <created>Fri, 3 Nov 2017 07:13:06 +0000</created>
                <updated>Tue, 22 May 2018 23:13:05 +0000</updated>
                            <resolved>Thu, 9 Nov 2017 02:10:12 +0000</resolved>
                                                    <fixVersion>3.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16237188" author="kellyzly" created="Fri, 3 Nov 2017 07:17:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuefuz&quot; class=&quot;user-hover&quot; rel=&quot;xuefuz&quot;&gt;xuefuz&lt;/a&gt;: can you help review? thanks!&lt;/p&gt;</comment>
                            <comment id="16237212" author="lirui" created="Fri, 3 Nov 2017 07:38:05 +0000"  >&lt;p&gt;+1 pending test&lt;br/&gt;
Seems src1 is created in &lt;tt&gt;q_test_init.sql&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="16238774" author="hiveqa" created="Sat, 4 Nov 2017 04:48:05 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12895579/HIVE-17973.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12895579/HIVE-17973.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 20 failed/errored test(s), 11354 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[input_dynamicserde] (batchId=85)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[insert_values_orig_table_use_metadata] (batchId=62)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[multi_insert_union_src] (batchId=58)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[sysdb] (batchId=156)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=102)
org.apache.hadoop.hive.cli.TestNegativeMinimrCliDriver.testCliDriver[ct_noperm_loc] (batchId=94)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[subquery_multi] (batchId=111)
org.apache.hadoop.hive.cli.control.TestDanglingQOuts.checkDanglingQOut (batchId=206)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testAmPoolInteractions (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testApplyPlanQpChanges (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testApplyPlanUserMapping (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testAsyncSessionInitFailures (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testClusterFractions (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testDestroyAndReturn (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testQueueing (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testReopen (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testReuse (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testReuseWithDifferentPool (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testReuseWithQueueing (batchId=281)
org.apache.hadoop.hive.ql.parse.TestReplicationScenarios.testConstraints (batchId=223)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/7625/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/7625/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/7625/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/7625/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-7625/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-7625/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 20 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12895579 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="16239845" author="kellyzly" created="Mon, 6 Nov 2017 03:10:49 +0000"  >&lt;p&gt;update the patch, need also modify $HIVE_SOURCE/ql/src/test/results/clientpositive/multi_insert_union_src.q.out&lt;/p&gt;</comment>
                            <comment id="16239927" author="hiveqa" created="Mon, 6 Nov 2017 05:24:03 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12896143/HIVE-17973.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12896143/HIVE-17973.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 19 failed/errored test(s), 11357 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[insert_values_orig_table_use_metadata] (batchId=62)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[unionDistinct_1] (batchId=146)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[sysdb] (batchId=156)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=102)
org.apache.hadoop.hive.cli.TestNegativeMinimrCliDriver.testCliDriver[ct_noperm_loc] (batchId=94)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[subquery_multi] (batchId=111)
org.apache.hadoop.hive.cli.control.TestDanglingQOuts.checkDanglingQOut (batchId=206)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testAmPoolInteractions (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testApplyPlanQpChanges (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testApplyPlanUserMapping (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testAsyncSessionInitFailures (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testClusterFractions (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testDestroyAndReturn (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testQueueing (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testReopen (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testReuse (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testReuseWithDifferentPool (batchId=281)
org.apache.hadoop.hive.ql.exec.tez.TestWorkloadManager.testReuseWithQueueing (batchId=281)
org.apache.hadoop.hive.ql.parse.TestReplicationScenarios.testConstraints (batchId=223)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/7656/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/7656/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/7656/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/7656/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-7656/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-7656/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 19 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12896143 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="16241674" author="kellyzly" created="Tue, 7 Nov 2017 08:32:42 +0000"  >&lt;p&gt;very confused why the fix will cause other unit test failures. trigger another round of test.&lt;/p&gt;</comment>
                            <comment id="16241681" author="lirui" created="Tue, 7 Nov 2017 08:44:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kellyzly&quot; class=&quot;user-hover&quot; rel=&quot;kellyzly&quot;&gt;kellyzly&lt;/a&gt;, the failures may not be related. Have you tried them locally?&lt;/p&gt;</comment>
                            <comment id="16242241" author="hiveqa" created="Tue, 7 Nov 2017 15:54:38 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12896360/HIVE-17973.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12896360/HIVE-17973.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 12 failed/errored test(s), 11362 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestServiceDiscoveryWithMiniHS2 - did not produce a TEST-*.xml file (likely timed out) (batchId=234)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[insert_values_orig_table_use_metadata] (batchId=62)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[sysdb] (batchId=156)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=102)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[tez_union_with_udf] (batchId=102)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[vectorization_div0] (batchId=102)
org.apache.hadoop.hive.cli.TestNegativeMinimrCliDriver.testCliDriver[ct_noperm_loc] (batchId=94)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[subquery_multi] (batchId=111)
org.apache.hadoop.hive.cli.TestTezPerfCliDriver.testCliDriver[query14] (batchId=243)
org.apache.hadoop.hive.cli.TestTezPerfCliDriver.testCliDriver[query23] (batchId=243)
org.apache.hadoop.hive.cli.control.TestDanglingQOuts.checkDanglingQOut (batchId=206)
org.apache.hadoop.hive.ql.parse.TestReplicationScenarios.testConstraints (batchId=223)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/7683/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/7683/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/7683/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/7683/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-7683/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-7683/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 12 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12896360 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="16243494" author="kellyzly" created="Wed, 8 Nov 2017 07:49:44 +0000"  >&lt;p&gt;less unit test failures in 3rd,but see following unit test failures occurred  both in 2nd and 3rd round of test&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[insert_values_orig_table_use_metadata] (batchId=62)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[sysdb] (batchId=156)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=102)
org.apache.hadoop.hive.cli.TestNegativeMinimrCliDriver.testCliDriver[ct_noperm_loc] (batchId=94)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[subquery_multi] (batchId=111)
org.apache.hadoop.hive.cli.control.TestDanglingQOuts.checkDanglingQOut (batchId=206)
org.apache.hadoop.hive.ql.parse.TestReplicationScenarios.testConstraints (batchId=223)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;running them in my local env. some indeed failed as Hive-QA. So update new patch.&lt;/p&gt;</comment>
                            <comment id="16243500" author="kellyzly" created="Wed, 8 Nov 2017 08:03:52 +0000"  >&lt;p&gt;for sysdb.q.out, the modification is like following, &lt;tt&gt;CREATE TABLE IF NOT EXISTS `WM_TRIGGERS`&lt;/tt&gt; should exist in sysdb.q.out because &lt;tt&gt;hive-schema-3.0.0.hive.sql&lt;/tt&gt; is sourced in &lt;a href=&quot;https://github.com/apache/hive/blob/master/ql/src/test/queries/clientpositive/sysdb.q#L27&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;sysdb.q&lt;/a&gt; and &lt;a href=&quot;https://github.com/apache/hive/blob/master/metastore/scripts/upgrade/hive/hive-schema-3.0.0.hive.sql#L967&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;hive-schema-3.0.0.hive.sql&lt;/a&gt; create table &lt;tt&gt;WM_TRIGGERS&lt;/tt&gt; . Very confused why before HiveQA did not throw error.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
--- a/ql/src/test/results/clientpositive/llap/sysdb.q.out
+++ b/ql/src/test/results/clientpositive/llap/sysdb.q.out
@@ -2225,6 +2225,56 @@ FROM
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: SYS@WM_RESOURCEPLANS
 POSTHOOK: Output: database:sys
+PREHOOK: query: CREATE TABLE IF NOT EXISTS `WM_TRIGGERS` (
+  `RP_NAME` string,
+  `NAME` string,
+  `TRIGGER_EXPRESSION` string,
+  `ACTION_EXPRESSION` string
+)
+STORED BY &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.hive.storage.jdbc.JdbcStorageHandler&apos;&lt;/span&gt;
+TBLPROPERTIES (
+&lt;span class=&quot;code-quote&quot;&gt;&quot;hive.sql.database.type&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;METASTORE&quot;&lt;/span&gt;,
+&lt;span class=&quot;code-quote&quot;&gt;&quot;hive.sql.query&quot;&lt;/span&gt; =
+&quot;SELECT
+  r.NAME RP_NAME,
+  t.NAME NAME,
+  TRIGGER_EXPRESSION,
+  ACTION_EXPRESSION
+FROM
+  WM_TRIGGER t
+JOIN
+  WM_RESOURCEPLAN r
+ON
                                    
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16243582" author="kellyzly" created="Wed, 8 Nov 2017 09:25:13 +0000"  >&lt;p&gt;for &lt;tt&gt;ct_noperm_loc.q.out&lt;/tt&gt;, &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
set hive.test.authz.sstd.hs2.mode=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
set hive.security.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdHiveAuthorizerFactoryForTest;
set hive.security.authenticator.manager=org.apache.hadoop.hive.ql.security.SessionStateConfigUserAuthenticator;
set hive.security.authorization.enabled=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;

dfs ${system:test.dfs.mkdir} hdfs:&lt;span class=&quot;code-comment&quot;&gt;///tmp/ct_noperm_loc;
&lt;/span&gt;
set user.name=user1;

create table foo0(id &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) location &lt;span class=&quot;code-quote&quot;&gt;&apos;hdfs:&lt;span class=&quot;code-comment&quot;&gt;///tmp/ct_noperm_loc_foo0&apos;&lt;/span&gt;;
&lt;/span&gt;create table foo1 location &lt;span class=&quot;code-quote&quot;&gt;&apos;hdfs:&lt;span class=&quot;code-comment&quot;&gt;///tmp/ct_noperm_loc/foo1&apos;&lt;/span&gt;;
&lt;/span&gt;

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the output in my local env&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
#### A masked pattern was here ####
PREHOOK: type: CREATETABLE
#### A masked pattern was here ####
PREHOOK: Output: database:&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;
PREHOOK: Output: &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@foo0
#### A masked pattern was here ####
POSTHOOK: type: CREATETABLE
#### A masked pattern was here ####
POSTHOOK: Output: database:&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;
POSTHOOK: Output: &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@foo0
FAILED: SemanticException [Error 10043]: Either list of columns or a custom serializer should be specified
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the original ct_noperm_loc.q.out is empty.  Very confused why there is not any output for &lt;tt&gt;ct_noperm_loc.q&lt;/tt&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kgyrtkirk&quot; class=&quot;user-hover&quot; rel=&quot;kgyrtkirk&quot;&gt;kgyrtkirk&lt;/a&gt;, do you know the reason why &lt;a href=&quot;https://github.com/apache/hive/blob/master/ql/src/test/results/clientnegative/ct_noperm_loc.q.out&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ct_noperm_loc.q.out&lt;/a&gt; is empty?&lt;/p&gt;</comment>
                            <comment id="16243612" author="kgyrtkirk" created="Wed, 8 Nov 2017 09:44:21 +0000"  >&lt;p&gt;the goal of the test is to check that hive doesn&apos;t let user1 to create a table with a location under an unowned path.&lt;br/&gt;
earlier; it thrown some exception which was not present in the output - because it contains the hdfs url...so the &quot;masker&quot; filters it out.&lt;br/&gt;
this semanticexception is unrelated to that goal; and shouldn&apos;t be accepted...&lt;br/&gt;
Earlier I&apos;ve bisected this test to be broken by 5250ef450430fcdeed0a2cb7a770f48647987cd3 (&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-12408&quot; title=&quot;SQLStdAuthorizer should not require external table creator to be owner of directory, in addition to rw permissions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-12408&quot;&gt;&lt;del&gt;HIVE-12408&lt;/del&gt;&lt;/a&gt;); but until now, I haven&apos;t checked it thorough - I&apos;ve just checked it and its true &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
the original exception was (which have been that sole masked line):&lt;br/&gt;
FAILED: HiveAccessControlException Permission denied: Principal &lt;span class=&quot;error&quot;&gt;&amp;#91;name=user1, type=USER&amp;#93;&lt;/span&gt; does not have following privileges for operation CREATETABLE [&lt;span class=&quot;error&quot;&gt;&amp;#91;OBJECT OWNERSHIP&amp;#93;&lt;/span&gt; on Object &lt;span class=&quot;error&quot;&gt;&amp;#91;type=DFS_URI, name=hdfs://localhost:35753/tmp/ct_noperm_loc_foo0&amp;#93;&lt;/span&gt;]&lt;/p&gt;

&lt;p&gt;I&apos;m still not sure how that commit broke it...&lt;/p&gt;

&lt;p&gt;Thanks for pinging me to check it! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
I&apos;ll open a jira with these infos; (opened: &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-18012&quot; title=&quot;fix ct_noperm_loc test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-18012&quot;&gt;&lt;del&gt;HIVE-18012&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="16243624" author="kellyzly" created="Wed, 8 Nov 2017 09:50:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kgyrtkirk&quot; class=&quot;user-hover&quot; rel=&quot;kgyrtkirk&quot;&gt;kgyrtkirk&lt;/a&gt;: &lt;blockquote&gt;
&lt;p&gt;it thrown some exception which was not present in the output - because it contains the hdfs url...so the &quot;masker&quot; filters it out.&lt;/p&gt;&lt;/blockquote&gt;&lt;/p&gt;

&lt;p&gt;this lets me surprise that &quot;master&quot; will filters the content containing hdfs url. Can you point out the detail code if have time, thanks!&lt;/p&gt;</comment>
                            <comment id="16243632" author="kgyrtkirk" created="Wed, 8 Nov 2017 09:56:52 +0000"  >&lt;p&gt;sure...&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/hive/blob/4992beb5e0e904a525daaa6f6f56edd76848fa61/itests/util/src/main/java/org/apache/hadoop/hive/ql/QTestUtil.java#L1615&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/blob/4992beb5e0e904a525daaa6f6f56edd76848fa61/itests/util/src/main/java/org/apache/hadoop/hive/ql/QTestUtil.java#L1615&lt;/a&gt;&lt;br/&gt;
I don&apos;t like it either very much...probably replacing only &lt;a href=&quot;https://github.com/apache/hive/blob/4992beb5e0e904a525daaa6f6f56edd76848fa61/itests/util/src/main/java/org/apache/hadoop/hive/ql/QTestUtil.java#L501&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;HIVE_ROOT&lt;/a&gt; to some verbatim string would be better... &lt;/p&gt;</comment>
                            <comment id="16243677" author="kgyrtkirk" created="Wed, 8 Nov 2017 10:35:15 +0000"  >&lt;p&gt;sysdb failure is unrelated...however; its present in #3&lt;br/&gt;
unfortunately there are a few problematic tests...&lt;br/&gt;
I would recommend to check the failing tests in a before/after manner if you would like to be absolutely sure that you haven&apos;t broke a new test &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
</comment>
                            <comment id="16244746" author="hiveqa" created="Wed, 8 Nov 2017 21:18:21 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12896590/HVIE-17973.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12896590/HVIE-17973.3.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 7 failed/errored test(s), 11363 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestJdbcWithDBTokenStoreNoDoAs - did not produce a TEST-*.xml file (likely timed out) (batchId=244)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[insert_values_orig_table_use_metadata] (batchId=62)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[unionDistinct_1] (batchId=146)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=102)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[subquery_multi] (batchId=111)
org.apache.hadoop.hive.cli.control.TestDanglingQOuts.checkDanglingQOut (batchId=206)
org.apache.hadoop.hive.ql.parse.TestReplicationScenarios.testConstraints (batchId=223)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/7713/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/7713/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/7713/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/7713/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-7713/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-7713/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 7 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12896590 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="16245083" author="kellyzly" created="Thu, 9 Nov 2017 01:40:24 +0000"  >&lt;p&gt;the fix for  &lt;tt&gt;ct_noperm_loc.q&lt;/tt&gt;  is tracked by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-18012&quot; title=&quot;fix ct_noperm_loc test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-18012&quot;&gt;&lt;del&gt;HIVE-18012&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="16245096" author="kellyzly" created="Thu, 9 Nov 2017 01:51:10 +0000"  >&lt;p&gt;guess these unit test failures are not related to current jira. see in the &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/7712/#showFailuresLink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;test&lt;/a&gt; of other jiras, following tests still failed&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[insert_values_orig_table_use_metadata] (batchId=62)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[sysdb] (batchId=156)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=102)
org.apache.hadoop.hive.cli.TestNegativeMinimrCliDriver.testCliDriver[ct_noperm_loc] (batchId=94)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[subquery_multi] (batchId=111)
org.apache.hadoop.hive.cli.control.TestDanglingQOuts.checkDanglingQOut (batchId=206)
org.apache.hadoop.hive.ql.parse.TestReplicationScenarios.testConstraints (batchId=223)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt;: can you help review &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12896360/HIVE-17973.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;HIVE-17973.2.patch&lt;/a&gt;? thanks!&lt;/p&gt;</comment>
                            <comment id="16245101" author="lirui" created="Thu, 9 Nov 2017 01:56:36 +0000"  >&lt;p&gt;+1 to the 2nd patch&lt;/p&gt;</comment>
                            <comment id="16245109" author="lirui" created="Thu, 9 Nov 2017 02:10:12 +0000"  >&lt;p&gt;Pushed to master. Thanks Liyun for the contribution.&lt;/p&gt;</comment>
                            <comment id="16245189" author="kellyzly" created="Thu, 9 Nov 2017 04:32:08 +0000"  >&lt;p&gt;thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kgyrtkirk&quot; class=&quot;user-hover&quot; rel=&quot;kgyrtkirk&quot;&gt;kgyrtkirk&lt;/a&gt; review.&lt;/p&gt;</comment>
                            <comment id="16484846" author="ashutoshc" created="Tue, 22 May 2018 23:13:05 +0000"  >&lt;p&gt;This jira is resolved and released with Hive 3.0 If you find an issue with it, please create a new jira.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12896360" name="HIVE-17973.2.patch" size="1372" author="kellyzly" created="Tue, 7 Nov 2017 08:33:34 +0000"/>
                            <attachment id="12896143" name="HIVE-17973.2.patch" size="1372" author="kellyzly" created="Mon, 6 Nov 2017 03:10:08 +0000"/>
                            <attachment id="12895579" name="HIVE-17973.patch" size="547" author="kellyzly" created="Fri, 3 Nov 2017 07:16:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 26 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3mckf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>