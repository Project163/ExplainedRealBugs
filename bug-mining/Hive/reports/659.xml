<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 17:58:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-2315] DatabaseMetadata.getColumns() does not return partition column names for a table</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2315</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;getColumns() method of DatabaseMetadata for HIVE JDBC Driver does not return the partition column names. Where as from HIVE CLI, if you do a &apos;describe tablename&apos; you get all columns including the partition columns. It would be nice if getColumns() method returns all columns.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12515548">HIVE-2315</key>
            <summary>DatabaseMetadata.getColumns() does not return partition column names for a table</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="phunt">Patrick D. Hunt</assignee>
                                    <reporter username="mgk.424@gmail.com">Mythili Gopalakrishnan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 27 Jul 2011 16:46:38 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:28 +0000</updated>
                            <resolved>Thu, 18 Aug 2011 21:39:27 +0000</resolved>
                                    <version>0.7.1</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13080127" author="phunt" created="Fri, 5 Aug 2011 18:27:22 +0000"  >&lt;p&gt;use get_schema rather than get_fields. Verified via unit test as well as via squirrel.&lt;/p&gt;</comment>
                            <comment id="13080900" author="mgk.424@gmail.com" created="Mon, 8 Aug 2011 11:17:53 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I applied this patch and confirm that it fixes this issue &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2315&quot; title=&quot;DatabaseMetadata.getColumns() does not return partition column names for a table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2315&quot;&gt;&lt;del&gt;HIVE-2315&lt;/del&gt;&lt;/a&gt;.&lt;/li&gt;
	&lt;li&gt;However it does NOT fix issue &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1573&quot; title=&quot;select * from partitioned table via JDBC does not return partition columns&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1573&quot;&gt;&lt;del&gt;HIVE-1573&lt;/del&gt;&lt;/a&gt;. When I do a select * from a partitioned column, I don&apos;t see the partition columns as part of the resultset.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13081056" author="phunt" created="Mon, 8 Aug 2011 16:57:23 +0000"  >&lt;p&gt;Hi Mythili can you give an example of the query you are running? i.e. steps how to reproduce.&lt;/p&gt;

&lt;p&gt;When I run the following from hive:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;create table foo2 (a string, b string, c string) partitioned by (dt string) row format delimited fields terminated by &apos;\t&apos;;
load data local inpath &apos;./data.txt&apos; overwrite into table foo2 partition (dt=&apos;8&apos;);
load data local inpath &apos;./data.txt&apos; overwrite into table foo2 partition (dt=&apos;9&apos;);
select * from foo2;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I see dt in the output (hive cli). &lt;/p&gt;

&lt;p&gt;When I run &quot;select * from foo2&quot; from Squirrel I also see dt in the output after applying this patch (I also see dt in the metadata reported by Squirrel for the table).&lt;/p&gt;</comment>
                            <comment id="13081063" author="phunt" created="Mon, 8 Aug 2011 17:15:57 +0000"  >&lt;p&gt;waiting for feedback from Mythili.&lt;/p&gt;</comment>
                            <comment id="13081067" author="mgk.424@gmail.com" created="Mon, 8 Aug 2011 17:17:38 +0000"  >&lt;p&gt;Patrick&lt;/p&gt;

&lt;p&gt;This is exactly what I have done as well. I use a tool called DBVizualizer, very similar to Squirrel. When I click on foo2, I see the partition columns, but when I do a select *, I don&apos;t see the partition columns.&lt;/p&gt;

&lt;p&gt;One thing I noticed (please pardon my ignorance as I have not had a chance to look deep into the HIVE JDBC driver source code) is that the patch listed only 2 files to patch, HiveDatabaseMetaData.java and TestJdbcDriver.java. Is it missing some other file that would have included the changes for the query part?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Mythili &lt;/p&gt;</comment>
                            <comment id="13081115" author="phunt" created="Mon, 8 Aug 2011 18:34:56 +0000"  >&lt;p&gt;Updated test to explicitly verify that JDBC result set contains the partition column on a &quot;select * from t&quot;. Otw the code is unchanged.&lt;/p&gt;</comment>
                            <comment id="13081117" author="phunt" created="Mon, 8 Aug 2011 18:41:50 +0000"  >&lt;p&gt;Mythili, please take a look at the &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2315&quot; title=&quot;DatabaseMetadata.getColumns() does not return partition column names for a table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2315&quot;&gt;&lt;del&gt;HIVE-2315&lt;/del&gt;&lt;/a&gt;_part2.patch file I just attached to this jira. The existing tests were not strongly verifying that &quot;select * from table&quot; was returning the partition column as part of the result set. I updated the test to do so. However subsequently the test is still passing (I verified in the debugger that this code is being executed).&lt;/p&gt;

&lt;p&gt;Please take a look at this test:&lt;br/&gt;
org.apache.hadoop.hive.jdbc.TestJdbcDriver.doTestSelectAll(String, int, int)&lt;br/&gt;
called from here:&lt;br/&gt;
org.apache.hadoop.hive.jdbc.TestJdbcDriver.testSelectAllPartioned()&lt;/p&gt;

&lt;p&gt;So, afaict, we are returning the partition column as part of the result set. (I&apos;m also seeing this in squirrel as I mentioned).&lt;/p&gt;

&lt;p&gt;Can you take a look at your setup again? Perhaps there is another issue somewhere in the Hive JDBC driver that&apos;s causing DBVizualizer to display this problem while Squirrel is fine?&lt;/p&gt;
</comment>
                            <comment id="13082973" author="mgk.424@gmail.com" created="Thu, 11 Aug 2011 07:08:38 +0000"  >&lt;p&gt;Patrick, it is my fault, I forgot to update the jars on the server side. Once I did that, I see the partition columns when I do a select * from foo2. This issue is fixed.&lt;/p&gt;</comment>
                            <comment id="13083250" author="phunt" created="Thu, 11 Aug 2011 17:28:41 +0000"  >&lt;p&gt;Updated to a single patch with fix and both sets of tests.&lt;/p&gt;</comment>
                            <comment id="13083257" author="jiraposter@reviews.apache.org" created="Thu, 11 Aug 2011 17:32:26 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1468/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/1468/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive and Carl Steinbach.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;This patch fixes the problem and adds a couple of tests.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2315&quot; title=&quot;DatabaseMetadata.getColumns() does not return partition column names for a table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2315&quot;&gt;&lt;del&gt;HIVE-2315&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2315&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2315&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  jdbc/src/java/org/apache/hadoop/hive/jdbc/HiveDatabaseMetaData.java d570fca &lt;br/&gt;
  jdbc/src/test/org/apache/hadoop/hive/jdbc/TestJdbcDriver.java d72cf43 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1468/diff&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/1468/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;units pass, a user also verified it fixed the issue they were seeing.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Patrick&lt;/p&gt;
</comment>
                            <comment id="13086019" author="cwsteinbach" created="Tue, 16 Aug 2011 22:17:06 +0000"  >&lt;p&gt;+1. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13087316" author="cwsteinbach" created="Thu, 18 Aug 2011 21:39:27 +0000"  >&lt;p&gt;Committed to trunk. Thanks Patrick!&lt;/p&gt;</comment>
                            <comment id="13087473" author="hudson" created="Fri, 19 Aug 2011 03:01:53 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #903 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/903/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/903/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2315&quot; title=&quot;DatabaseMetadata.getColumns() does not return partition column names for a table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2315&quot;&gt;&lt;del&gt;HIVE-2315&lt;/del&gt;&lt;/a&gt;. DatabaseMetadata.getColumns() does not return partition column names for a table (Patrick Hunt via cws)&lt;/p&gt;

&lt;p&gt;cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1159423&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1159423&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/jdbc/src/java/org/apache/hadoop/hive/jdbc/HiveDatabaseMetaData.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/jdbc/src/test/org/apache/hadoop/hive/jdbc/TestJdbcDriver.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13149933" author="dougsedlak" created="Mon, 14 Nov 2011 21:23:40 +0000"  >&lt;p&gt;For an &apos;int&apos; partition column, the &apos;getColumnTypeName&apos; metadata call is returning type &apos;string&apos;.  However, a DESCRIBE correctly returns type &apos;int&apos;.  Seems like a bug if it replicates for others?  I have the patched code in place on both client and server.  Thanks!&lt;/p&gt;

&lt;p&gt;Sample table is:&lt;br/&gt;
create EXTERNAL table partition_by_int (str_val string) PARTITIONED BY (int_col INT) ROW FORMAT delimited fields terminated by &apos;,&apos; STORED AS TEXTFILE;&lt;/p&gt;

&lt;p&gt;And (shortened) JDBC code is:&lt;br/&gt;
  res = stmt.executeQuery(&quot;select * from partition_by_int&quot;);&lt;br/&gt;
  ResultSetMetaData metaData = res.getMetaData();&lt;br/&gt;
  for (int i = 0; i &amp;lt; metaData.getColumnCount(); i++) &lt;/p&gt;
{
     System.out.print(metaData.getColumnName(i + 1) + &quot;  \t&quot;);
     System.out.print(metaData.getColumnDisplaySize(i + 1) + &quot;\t&quot;);
     System.out.println(metaData.getColumnTypeName(i + 1));
  }
&lt;p&gt;With output:&lt;br/&gt;
str_val         2147483647      string&lt;br/&gt;
int_col         2147483647      string&lt;/p&gt;

&lt;p&gt;In contrast, DESCRIBE partition_by_int generates:&lt;br/&gt;
str_val string&lt;br/&gt;
int_col int&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12472052">HIVE-1573</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12472052">HIVE-1573</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12472052">HIVE-1573</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12490134" name="HIVE-2315.patch" size="4499" author="phunt" created="Thu, 11 Aug 2011 17:28:41 +0000"/>
                            <attachment id="12489509" name="HIVE-2315.patch" size="3026" author="phunt" created="Fri, 5 Aug 2011 18:27:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37472</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 2 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05ikn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30106</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>