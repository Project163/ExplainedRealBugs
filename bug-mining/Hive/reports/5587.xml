<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:54:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-16788] ODBC call SQLForeignKeys leads to NPE if you use PK arguments rather than FK arguments</title>
                <link>https://issues.apache.org/jira/browse/HIVE-16788</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;This ODBC call is meant to allow you to determine FK relationships either from the PK side or from the FK side.&lt;/p&gt;

&lt;p&gt;Hive only allows you to traverse from the FK side, trying it from the PK side leads to an NPE.&lt;/p&gt;

&lt;p&gt;Example using the table &quot;customer&quot; from TPC-H with FKs defined in Hive:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;=== Foreign Keys ===
Using table as foreign source
(u&lt;span class=&quot;code-quote&quot;&gt;&apos;HIVE&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;tpch_bin_flat_orc_2&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;nation&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;n_nationkey&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;HIVE&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;tpch_bin_flat_orc_2&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;customer&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;c_nationkey&apos;&lt;/span&gt;, 1, 0, 0, u&apos;custome
r_c2&lt;span class=&quot;code-quote&quot;&gt;&apos;, u&apos;&lt;/span&gt;nation_c1&apos;, 0)
Not using table as foreign source
Got an error from the server &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; customer!
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Compare: Postgres&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;=== Foreign Keys ===
Using table as foreign source
(u&lt;span class=&quot;code-quote&quot;&gt;&apos;vagrant&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt;&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;nation&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;n_nationkey&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;vagrant&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt;&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;customer&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;c_nationkey&apos;&lt;/span&gt;, 1, 3, 3, u&lt;span class=&quot;code-quote&quot;&gt;&apos;customer_c_nationkey_fkey&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;nation_pkey&apos;&lt;/span&gt;, 7)
Not using table as foreign source
(u&lt;span class=&quot;code-quote&quot;&gt;&apos;vagrant&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt;&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;customer&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;c_custkey&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;vagrant&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt;&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;orders&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;o_custkey&apos;&lt;/span&gt;, 1, 3, 3, u&lt;span class=&quot;code-quote&quot;&gt;&apos;orders_o_custkey_fkey&apos;&lt;/span&gt;, u&lt;span class=&quot;code-quote&quot;&gt;&apos;customer_pkey&apos;&lt;/span&gt;, 7)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note that Postgres allows traversal from either way. The traceback you get in the HS2 logs is this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2016-12-04T21:08:55,398 ERROR [8998ca98-9940-49f8-8833-7c6ebd8c96a2 HiveServer2-Handler-Pool: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-53] metastore.RetryingHMSHandler: MetaEx
ception(message:java.lang.NullPointerException)
        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newMetaException(HiveMetaStore.java:5785)
        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.get_foreign_keys(HiveMetaStore.java:6474)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:140)
        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:99)
        at com.sun.proxy.$Proxy25.get_foreign_keys(Unknown Source)
        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.getForeignKeys(HiveMetaStoreClient.java:1596)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:154)
        at com.sun.proxy.$Proxy26.getForeignKeys(Unknown Source)
        at org.apache.hive.service.cli.operation.GetCrossReferenceOperation.runInternal(GetCrossReferenceOperation.java:128)
        at org.apache.hive.service.cli.operation.Operation.run(Operation.java:324)
        at org.apache.hive.service.cli.session.HiveSessionImpl.getCrossReference(HiveSessionImpl.java:933)
        at org.apache.hive.service.cli.CLIService.getCrossReference(CLIService.java:411)
        at org.apache.hive.service.cli.thrift.ThriftCLIService.GetCrossReference(ThriftCLIService.java:738)
        at org.apache.hive.service.rpc.thrift.TCLIService$Processor$GetCrossReference.getResult(TCLIService.java:1617)
        at org.apache.hive.service.rpc.thrift.TCLIService$Processor$GetCrossReference.getResult(TCLIService.java:1602)
        at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:39)
        at org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:39)
        at org.apache.hive.service.auth.TSetIpAddressProcessor.process(TSetIpAddressProcessor.java:56)
        at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:286)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.NullPointerException
        at org.apache.hive.common.util.HiveStringUtils.normalizeIdentifier(HiveStringUtils.java:919)
        at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.&amp;lt;init&amp;gt;(ObjectStore.java:2722)
        at org.apache.hadoop.hive.metastore.ObjectStore$GetListHelper.&amp;lt;init&amp;gt;(ObjectStore.java:2863)
        at org.apache.hadoop.hive.metastore.ObjectStore$11.&amp;lt;init&amp;gt;(ObjectStore.java:8455)
        at org.apache.hadoop.hive.metastore.ObjectStore.getForeignKeysInternal(ObjectStore.java:8455)
        at org.apache.hadoop.hive.metastore.ObjectStore.getForeignKeys(ObjectStore.java:8445)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:101)
        at com.sun.proxy.$Proxy24.getForeignKeys(Unknown Source)
        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.get_foreign_keys(HiveMetaStore.java:6465)
        ... 28 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13075906">HIVE-16788</key>
            <summary>ODBC call SQLForeignKeys leads to NPE if you use PK arguments rather than FK arguments</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jcamacho">Jes&#250;s Camacho Rodr&#237;guez</assignee>
                                    <reporter username="cartershanklin">Carter Shanklin</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 May 2017 17:54:07 +0000</created>
                <updated>Tue, 27 Feb 2024 22:24:01 +0000</updated>
                            <resolved>Wed, 31 May 2017 07:54:47 +0000</resolved>
                                                    <fixVersion>3.0.0</fixVersion>
                                    <component>ODBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16029955" author="hiveqa" created="Tue, 30 May 2017 19:05:35 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12870413/HIVE-16788.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12870413/HIVE-16788.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 4 failed/errored test(s), 10790 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestBeeLineDriver.testCliDriver[create_merge_compressed] (batchId=237)
org.apache.hadoop.hive.cli.TestBeeLineDriver.testCliDriver[materialized_view_create_rewrite] (batchId=237)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[subquery_scalar] (batchId=152)
org.apache.hadoop.hive.ql.security.TestMultiAuthorizationPreEventListener.org.apache.hadoop.hive.ql.security.TestMultiAuthorizationPreEventListener (batchId=219)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/5476/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/5476/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/5476/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/5476/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-5476/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-5476/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 4 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12870413 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="16029976" author="jcamacho" created="Tue, 30 May 2017 19:19:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt;, this is a small fix, could you take a look? Thanks&lt;/p&gt;</comment>
                            <comment id="16030168" author="ashutoshc" created="Tue, 30 May 2017 21:30:06 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="16030800" author="jcamacho" created="Wed, 31 May 2017 07:54:47 +0000"  >&lt;p&gt;Pushed to master, thanks for reviewing &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="16485824" author="vgarg" created="Tue, 22 May 2018 23:57:48 +0000"  >&lt;p&gt;Hive 3.0.0 has been released so closing this jira.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12870413" name="HIVE-16788.patch" size="5469" author="jcamachorodriguez" created="Tue, 30 May 2017 17:55:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 26 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3fnav:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12340268">3.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>