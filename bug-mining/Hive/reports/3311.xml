<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:31:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-7351] ANALYZE TABLE statement fails on postgres metastore</title>
                <link>https://issues.apache.org/jira/browse/HIVE-7351</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Metastore code use method &lt;tt&gt;PreparedStatement.setQueryTimeout(int)&lt;/tt&gt; of JDBC Driver :&lt;/p&gt;

&lt;p&gt;Current JDBC driver doesn&apos;t implements this method.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2014-07-07 17:52:38,239 ERROR org.apache.hadoop.hive.ql.stats.jdbc.JDBCStatsPublisher: Error during JDBC connection to jdbc:postgresql://nc-h04:5432/metastore?user=hiveuser&amp;amp;password=mvsmt4521. 
org.postgresql.util.PSQLException: Method org.postgresql.jdbc4.Jdbc4PreparedStatement.setQueryTimeout(int) is not yet implemented.
	at org.postgresql.Driver.notImplemented(Driver.java:753)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.setQueryTimeout(AbstractJdbc2Statement.java:666)
	at org.apache.hadoop.hive.ql.stats.jdbc.JDBCStatsPublisher$1.run(JDBCStatsPublisher.java:80)
	at org.apache.hadoop.hive.ql.stats.jdbc.JDBCStatsPublisher$1.run(JDBCStatsPublisher.java:77)
	at org.apache.hadoop.hive.ql.exec.Utilities.executeWithRetry(Utilities.java:2637)
	at org.apache.hadoop.hive.ql.stats.jdbc.JDBCStatsPublisher.connect(JDBCStatsPublisher.java:96)
	at org.apache.hadoop.hive.ql.exec.TableScanOperator.publishStats(TableScanOperator.java:280)
	at org.apache.hadoop.hive.ql.exec.TableScanOperator.closeOp(TableScanOperator.java:226)
	at org.apache.hadoop.hive.ql.exec.Operator.close(Operator.java:583)
	at org.apache.hadoop.hive.ql.exec.Operator.close(Operator.java:595)
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapper.close(ExecMapper.java:227)
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:57)
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:430)
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:366)
	at org.apache.hadoop.mapred.Child$4.run(Child.java:255)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1190)
	at org.apache.hadoop.mapred.Child.main(Child.java:249)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;postgresSQL&lt;/p&gt;</environment>
        <key id="12725771">HIVE-7351</key>
            <summary>ANALYZE TABLE statement fails on postgres metastore</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="navis">Navis Ryu</assignee>
                                    <reporter username="damien.carol">Damien Carol</reporter>
                        <labels>
                            <label>metastore</label>
                            <label>postgres</label>
                    </labels>
                <created>Mon, 7 Jul 2014 16:00:53 +0000</created>
                <updated>Mon, 18 May 2015 19:51:00 +0000</updated>
                            <resolved>Fri, 10 Apr 2015 16:15:10 +0000</resolved>
                                    <version>0.13.0</version>
                    <version>0.13.1</version>
                                    <fixVersion>1.2.0</fixVersion>
                                    <component>Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14053796" author="damien.carol" created="Mon, 7 Jul 2014 16:08:24 +0000"  >&lt;p&gt;A quick fix should be to call this method with value 0. This doesn&apos;t throw exception in this case.&lt;/p&gt;</comment>
                            <comment id="14053803" author="damien.carol" created="Mon, 7 Jul 2014 16:11:45 +0000"  >&lt;p&gt;Using this property seems to solve the problem.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;property&amp;gt;
  &amp;lt;name&amp;gt;hive.stats.jdbc.timeout&amp;lt;/name&amp;gt;
  &amp;lt;value&amp;gt;0&amp;lt;/value&amp;gt;
&amp;lt;/property&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;More a hack than a solution IMHO.&lt;/p&gt;</comment>
                            <comment id="14053818" author="ashutoshc" created="Mon, 7 Jul 2014 16:22:41 +0000"  >&lt;p&gt;You can also try &lt;tt&gt;set hive.stats.dbclass=fs&lt;/tt&gt; This skips database altogether and instead uses filesystems for gathering stats.&lt;/p&gt;</comment>
                            <comment id="14059655" author="navis" created="Sat, 12 Jul 2014 05:21:02 +0000"  >&lt;p&gt;It&apos;s the problem of JDBC implementaion. By spec, SQLException should not be thrown in this case. We can catch SQLFeatureNotSupportedException and ignored it, which is introduced in JDK6, but PSQLException is not a SQLFeatureNotSupportedException, so it will not fix this problem.&lt;/p&gt;</comment>
                            <comment id="14060063" author="damien.carol" created="Sun, 13 Jul 2014 09:49:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;navis&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt;&lt;br/&gt;
A more simple way to fix this one is to change behavior for &lt;tt&gt;hive.stats.jdbc.timeout&lt;/tt&gt; property.&lt;br/&gt;
If the value of &lt;tt&gt;hive.stats.jdbc.timeout&lt;/tt&gt; is &lt;tt&gt;-1&lt;/tt&gt;, HIVE does not try to set query timeout.&lt;br/&gt;
Like this :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (timeout != -1) {
  stmt.setQueryTimeout(timeout);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14061508" author="navis" created="Tue, 15 Jul 2014 01:13:36 +0000"  >&lt;p&gt;Patch attached is doing exactly the same except it leaves a log message, complaining it&apos;s negative. But we have various walk-around for this issue and it seemed not necessary for any patch.&lt;/p&gt;</comment>
                            <comment id="14061830" author="damien.carol" created="Tue, 15 Jul 2014 08:25:39 +0000"  >&lt;p&gt;I agree&lt;/p&gt;</comment>
                            <comment id="14066178" author="damien.carol" created="Fri, 18 Jul 2014 09:01:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;navis&lt;/a&gt;, could you fix this this issue with your patch ?&lt;br/&gt;
You patch fix &lt;tt&gt;SQLFeatureNotSupportedException&lt;/tt&gt; and add logs.&lt;/p&gt;</comment>
                            <comment id="14243854" author="navis" created="Fri, 12 Dec 2014 08:06:31 +0000"  >&lt;p&gt;Rerun test&lt;/p&gt;</comment>
                            <comment id="14245065" author="hiveqa" created="Sat, 13 Dec 2014 00:49:27 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12686795/HIVE-7351.2.patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12686795/HIVE-7351.2.patch.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 6701 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2062/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2062/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2062/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2062/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-2062/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-2062/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12686795 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14489837" author="alangates" created="Fri, 10 Apr 2015 15:51:09 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14489870" author="alangates" created="Fri, 10 Apr 2015 16:15:10 +0000"  >&lt;p&gt;Patch 2 checked in.&lt;/p&gt;</comment>
                            <comment id="14548764" author="sushanth" created="Mon, 18 May 2015 19:51:00 +0000"  >&lt;p&gt;This issue has been fixed and released as part of the 1.2.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12655363" name="HIVE-7351.1.patch.txt" size="3244" author="navis" created="Sat, 12 Jul 2014 05:35:51 +0000"/>
                            <attachment id="12686795" name="HIVE-7351.2.patch.txt" size="3244" author="navis" created="Fri, 12 Dec 2014 08:06:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>403929</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 27 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1xipb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>403972</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Users who use Postgres as the RDBMS for their metastore and who wish to collect stats must set hive.stats.jdbc.timeout -1.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>