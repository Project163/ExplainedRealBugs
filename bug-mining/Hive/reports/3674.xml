<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:35:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-11221] In Tez mode, alter table concatenate orc files can intermittently fail with NPE</title>
                <link>https://issues.apache.org/jira/browse/HIVE-11221</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;We are not waiting for input ready events which can trigger occasional NPE if input is not actually ready.&lt;/p&gt;

&lt;p&gt;Stacktrace:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.NullPointerException
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:186)
	at org.apache.hadoop.hive.ql.exec.tez.MergeFileTezProcessor.run(MergeFileTezProcessor.java:42)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:324)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:176)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:168)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.call(TezTaskRunner.java:168)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.call(TezTaskRunner.java:163)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.NullPointerException
	at org.apache.hadoop.hive.ql.io.HiveInputFormat.init(HiveInputFormat.java:265)
	at org.apache.hadoop.hive.ql.io.HiveInputFormat.pushProjectionsAndFilters(HiveInputFormat.java:478)
	at org.apache.hadoop.hive.ql.io.HiveInputFormat.pushProjectionsAndFilters(HiveInputFormat.java:471)
	at org.apache.hadoop.hive.ql.io.CombineHiveInputFormat.getRecordReader(CombineHiveInputFormat.java:648)
	at org.apache.tez.mapreduce.lib.MRReaderMapred.setupOldRecordReader(MRReaderMapred.java:146)
	at org.apache.tez.mapreduce.lib.MRReaderMapred.&amp;lt;init&amp;gt;(MRReaderMapred.java:73)
	at org.apache.tez.mapreduce.input.MRInput.initializeInternal(MRInput.java:483)
	at org.apache.tez.mapreduce.input.MRInputLegacy.init(MRInputLegacy.java:108)
	at org.apache.hadoop.hive.ql.exec.tez.MergeFileRecordProcessor.getMRInput(MergeFileRecordProcessor.java:220)
	at org.apache.hadoop.hive.ql.exec.tez.MergeFileRecordProcessor.init(MergeFileRecordProcessor.java:72)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:162)
	... 13 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12843969">HIVE-11221</key>
            <summary>In Tez mode, alter table concatenate orc files can intermittently fail with NPE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="prasanth_j">Prasanth Jayachandran</assignee>
                                    <reporter username="prasanth_j">Prasanth Jayachandran</reporter>
                        <labels>
                    </labels>
                <created>Thu, 9 Jul 2015 21:10:45 +0000</created>
                <updated>Tue, 22 Mar 2016 21:53:09 +0000</updated>
                            <resolved>Fri, 10 Jul 2015 07:20:22 +0000</resolved>
                                    <version>1.3.0</version>
                    <version>2.0.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14621307" author="vikram.dixit" created="Thu, 9 Jul 2015 21:33:19 +0000"  >&lt;p&gt;+1 LGTM,&lt;/p&gt;</comment>
                            <comment id="14621614" author="hiveqa" created="Fri, 10 Jul 2015 02:19:13 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12744571/HIVE-11221.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12744571/HIVE-11221.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 9148 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4560/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4560/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4560/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4560/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4560/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4560/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12744571 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14621880" author="prasanth_j" created="Fri, 10 Jul 2015 07:20:22 +0000"  >&lt;p&gt;Committed to master and branch-1.&lt;/p&gt;</comment>
                            <comment id="14992094" author="dossett@gmail.com" created="Thu, 5 Nov 2015 17:50:03 +0000"  >&lt;p&gt;I am seeing a different NPE when I concatenate a partition with TEZ, but trying the same command in MR works fine.  This was the closest JIRA I could to this issue.  Does anyone this this a new issue?&lt;/p&gt;

&lt;p&gt;alter table mytable partition (partition_date=&apos;2015-10-30&apos;) concatenate;&lt;/p&gt;

&lt;p&gt;Status: Failed&lt;br/&gt;
Vertex failed, vertexName=File Merge, vertexId=vertex_1446684298977_0879_1_00, diagnostics=[Vertex vertex_1446684298977_0879_1_00 &lt;span class=&quot;error&quot;&gt;&amp;#91;File Merge&amp;#93;&lt;/span&gt; killed/failed due to:ROOT_INPUT_INIT_FAILURE, Vertex Input: &lt;span class=&quot;error&quot;&gt;&amp;#91;hdfs://namenode/apps/hive/warehouse/mydb.db/estore/partition_date=2015-10-30&amp;#93;&lt;/span&gt; initializer failed, vertex=vertex_1446684298977_0879_1_00 &lt;span class=&quot;error&quot;&gt;&amp;#91;File Merge&amp;#93;&lt;/span&gt;, java.lang.NullPointerException&lt;br/&gt;
	at org.apache.hadoop.hive.ql.io.HiveInputFormat.init(HiveInputFormat.java:265)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.io.CombineHiveInputFormat.getSplits(CombineHiveInputFormat.java:452)&lt;br/&gt;
	at org.apache.tez.mapreduce.hadoop.MRInputHelpers.generateOldSplits(MRInputHelpers.java:441)&lt;br/&gt;
	at org.apache.tez.mapreduce.hadoop.MRInputHelpers.generateInputSplitsToMem(MRInputHelpers.java:295)&lt;br/&gt;
	at org.apache.tez.mapreduce.common.MRInputAMSplitGenerator.initialize(MRInputAMSplitGenerator.java:124)&lt;br/&gt;
	at org.apache.tez.dag.app.dag.RootInputInitializerManager$InputInitializerCallable$1.run(RootInputInitializerManager.java:245)&lt;br/&gt;
	at org.apache.tez.dag.app.dag.RootInputInitializerManager$InputInitializerCallable$1.run(RootInputInitializerManager.java:239)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
	at javax.security.auth.Subject.doAs(Subject.java:415)&lt;br/&gt;
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)&lt;br/&gt;
	at org.apache.tez.dag.app.dag.RootInputInitializerManager$InputInitializerCallable.call(RootInputInitializerManager.java:239)&lt;br/&gt;
	at org.apache.tez.dag.app.dag.RootInputInitializerManager$InputInitializerCallable.call(RootInputInitializerManager.java:226)&lt;br/&gt;
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:744)&lt;/p&gt;</comment>
                            <comment id="14992203" author="prasanth_j" created="Thu, 5 Nov 2015 18:36:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dossett&quot; class=&quot;user-hover&quot; rel=&quot;dossett&quot;&gt;dossett&lt;/a&gt; What version of hive are you seeing this issue?&lt;/p&gt;</comment>
                            <comment id="14992628" author="dossett@gmail.com" created="Thu, 5 Nov 2015 22:40:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=prasanth_j&quot; class=&quot;user-hover&quot; rel=&quot;prasanth_j&quot;&gt;prasanth_j&lt;/a&gt; Hive 0.14 on HDP 2.2.4&lt;/p&gt;</comment>
                            <comment id="14992662" author="prasanth_j" created="Thu, 5 Nov 2015 23:00:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dossett&quot; class=&quot;user-hover&quot; rel=&quot;dossett&quot;&gt;dossett&lt;/a&gt; 0.14 will still have this problem. The fix landed only in 1.3.0.&lt;/p&gt;</comment>
                            <comment id="14992691" author="dossett@gmail.com" created="Thu, 5 Nov 2015 23:17:58 +0000"  >&lt;p&gt;Just to confirm &amp;#8211; you think my error is a duplicate?  The stack traces were a little different.&lt;/p&gt;</comment>
                            <comment id="14992781" author="prasanth_j" created="Fri, 6 Nov 2015 00:33:11 +0000"  >&lt;p&gt;Yes. Its duplicate.  The stack trace that you had posted recently is result of input initialization failures. The fix for it is addressed in this patch. &lt;/p&gt;</comment>
                            <comment id="14992869" author="dossett@gmail.com" created="Fri, 6 Nov 2015 01:19:55 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=prasanth_j&quot; class=&quot;user-hover&quot; rel=&quot;prasanth_j&quot;&gt;prasanth_j&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="15206833" author="ashishenoyp@gmail.com" created="Tue, 22 Mar 2016 17:27:57 +0000"  >&lt;p&gt;I hit this issue consistently as well; here&apos;s the stack trace when I use the Tez execution engine:&lt;br/&gt;
--------------------------------------------------------------------------------&lt;br/&gt;
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED&lt;br/&gt;
--------------------------------------------------------------------------------&lt;br/&gt;
File Merge            FAILED     -1          0        0       -1       0       0&lt;br/&gt;
--------------------------------------------------------------------------------&lt;br/&gt;
VERTICES: 00/01  &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;gt;&amp;gt;--------------------------&amp;#93;&lt;/span&gt; 0%    ELAPSED TIME: 1458666880.00 s&lt;br/&gt;
--------------------------------------------------------------------------------&lt;br/&gt;
Status: Failed&lt;br/&gt;
Vertex failed, vertexName=File Merge, vertexId=vertex_1455906569416_0009_1_00, diagnostics=[Vertex vertex_1455906569416_0009_1_00 &lt;span class=&quot;error&quot;&gt;&amp;#91;File Merge&amp;#93;&lt;/span&gt; killed/failed due to:ROOT_INPUT_INIT_FAILURE, Vertex Input: &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;lt;HDFS file location&amp;gt;&amp;#93;&lt;/span&gt; initializer failed, vertex=vertex_1455906569416_0009_1_00 &lt;span class=&quot;error&quot;&gt;&amp;#91;File Merge&amp;#93;&lt;/span&gt;, java.lang.NullPointerException&lt;br/&gt;
	at org.apache.hadoop.hive.ql.io.HiveInputFormat.init(HiveInputFormat.java:265)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.io.CombineHiveInputFormat.getSplits(CombineHiveInputFormat.java:452)&lt;br/&gt;
	at org.apache.tez.mapreduce.hadoop.MRInputHelpers.generateOldSplits(MRInputHelpers.java:441)&lt;br/&gt;
	at org.apache.tez.mapreduce.hadoop.MRInputHelpers.generateInputSplitsToMem(MRInputHelpers.java:295)&lt;br/&gt;
	at org.apache.tez.mapreduce.common.MRInputAMSplitGenerator.initialize(MRInputAMSplitGenerator.java:124)&lt;br/&gt;
	at org.apache.tez.dag.app.dag.RootInputInitializerManager$InputInitializerCallable$1.run(RootInputInitializerManager.java:245)&lt;br/&gt;
	at org.apache.tez.dag.app.dag.RootInputInitializerManager$InputInitializerCallable$1.run(RootInputInitializerManager.java:239)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
	at javax.security.auth.Subject.doAs(Subject.java:422)&lt;br/&gt;
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)&lt;br/&gt;
	at org.apache.tez.dag.app.dag.RootInputInitializerManager$InputInitializerCallable.call(RootInputInitializerManager.java:239)&lt;br/&gt;
	at org.apache.tez.dag.app.dag.RootInputInitializerManager$InputInitializerCallable.call(RootInputInitializerManager.java:226)&lt;br/&gt;
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:745)&lt;br/&gt;
]&lt;br/&gt;
DAG failed due to vertex failure. failedVertices:1 killedVertices:0&lt;br/&gt;
FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.DDLTask&lt;/p&gt;

&lt;p&gt;We are still on Hive 0.14, and are planning to move to HDP 2.4 since we have observed hive to be very unstable, unpredictable and hence unreliable for merging ORC files as well as many other basic sql queries that presto successfully completes. Since 1.3.0 is not in HDP 2.4, is installing a custom hive jar the only option at this point to mitigate this issue ? How will ambari behave with a custom installation of hive ?&lt;/p&gt;</comment>
                            <comment id="15207384" author="dossett@gmail.com" created="Tue, 22 Mar 2016 21:53:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashishenoyp%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;ashishenoyp@gmail.com&quot;&gt;ashishenoyp@gmail.com&lt;/a&gt; HDP 2.3.4 does include this fix backported to 1.2.1 (&lt;a href=&quot;https://docs.hortonworks.com/HDPDocuments/HDP2/HDP-2.3.4/bk_HDP_RelNotes/content/patch_hive.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.hortonworks.com/HDPDocuments/HDP2/HDP-2.3.4/bk_HDP_RelNotes/content/patch_hive.html&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;We recently upgraded to 2.3.4 and concatenation is working fine so far.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12744571" name="HIVE-11221.1.patch" size="12586" author="prasanth_j" created="Thu, 9 Jul 2015 21:12:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 35 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2h2j3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>