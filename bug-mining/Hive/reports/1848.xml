<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:15:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-6083] User provided table properties are not assigned to the TableDesc of the FileSinkDesc in a CTAS query</title>
                <link>https://issues.apache.org/jira/browse/HIVE-6083</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;I was trying to use a CTAS query to create a table stored with ORC and orc.compress was set to SNAPPY. However, the table was still compressed as ZLIB (although the result of DESCRIBE still shows that this table is compressed by SNAPPY). For a CTAS query, SemanticAnalyzer.genFileSinkPlan uses CreateTableDesc to generate the TableDesc for the FileSinkDesc by calling PlanUtils.getTableDesc. However, in PlanUtils.getTableDesc, I do not see user provided table properties are assigned to the returned TableDesc (CreateTableDesc.getTblProps was not called in this method ).  &lt;/p&gt;

&lt;p&gt;btw, I only checked the code of 0.12 and trunk.&lt;/p&gt;

&lt;p&gt;Two examples:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Snappy compression
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;create table web_sales_wrong_orc_snappy
stored as orc tblproperties (&lt;span class=&quot;code-quote&quot;&gt;&quot;orc.compress&quot;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&quot;SNAPPY&quot;&lt;/span&gt;)
as select * from web_sales;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;describe formatted web_sales_wrong_orc_snappy;
....
Location:           	hdfs:&lt;span class=&quot;code-comment&quot;&gt;//localhost:54310/user/hive/warehouse/web_sales_wrong_orc_snappy	 
&lt;/span&gt;Table Type:         	MANAGED_TABLE       	 
Table Parameters:	 	 
	COLUMN_STATS_ACCURATE	&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;                
	numFiles            	1                   
	numRows             	719384              
	orc.compress        	SNAPPY              
	rawDataSize         	97815412            
	totalSize           	40625243            
	transient_lastDdlTime	1387566015       
....   
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;bin/hive --orcfiledump /user/hive/warehouse/web_sales_wrong_orc_snappy/000000_0
Rows: 719384
Compression: ZLIB
Compression size: 262144
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;No compression
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;create table web_sales_wrong_orc_none
stored as orc tblproperties (&lt;span class=&quot;code-quote&quot;&gt;&quot;orc.compress&quot;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&quot;NONE&quot;&lt;/span&gt;)
as select * from web_sales;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;describe formatted web_sales_wrong_orc_none;
....
Location:           	hdfs:&lt;span class=&quot;code-comment&quot;&gt;//localhost:54310/user/hive/warehouse/web_sales_wrong_orc_none	 
&lt;/span&gt;Table Type:         	MANAGED_TABLE       	 
Table Parameters:	 	 
	COLUMN_STATS_ACCURATE	&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;                
	numFiles            	1                   
	numRows             	719384              
	orc.compress        	NONE                
	rawDataSize         	97815412            
	totalSize           	40625243            
	transient_lastDdlTime	1387566064       
....   
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;bin/hive --orcfiledump /user/hive/warehouse/web_sales_wrong_orc_none/000000_0
Rows: 719384
Compression: ZLIB
Compression size: 262144
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12685850">HIVE-6083</key>
            <summary>User provided table properties are not assigned to the TableDesc of the FileSinkDesc in a CTAS query</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yhuai">Yin Huai</assignee>
                                    <reporter username="yhuai">Yin Huai</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 Dec 2013 16:50:43 +0000</created>
                <updated>Wed, 22 Jan 2014 05:09:19 +0000</updated>
                            <resolved>Wed, 22 Jan 2014 05:09:19 +0000</resolved>
                                    <version>0.12.0</version>
                    <version>0.13.0</version>
                                    <fixVersion>0.13.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13854303" author="yhuai" created="Fri, 20 Dec 2013 17:48:28 +0000"  >&lt;p&gt;an initial patch. Let me trigger hive qa to see if any test case is affected. I am also thinking about how to test it...&lt;/p&gt;</comment>
                            <comment id="13854449" author="yhuai" created="Fri, 20 Dec 2013 19:16:01 +0000"  >&lt;p&gt;With .1 patch ...&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Snappy compression
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;create table web_sales_correct_orc_snappy
stored as orc tblproperties (&lt;span class=&quot;code-quote&quot;&gt;&quot;orc.compress&quot;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&quot;SNAPPY&quot;&lt;/span&gt;)
as select * from web_sales;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;describe formatted web_sales_correct_orc_snappy;
....
Location:           	hdfs:&lt;span class=&quot;code-comment&quot;&gt;//localhost:54310/user/hive/warehouse/web_sales_correct_orc_snappy	 
&lt;/span&gt;Table Type:         	MANAGED_TABLE       	 
Table Parameters:	 	 
	COLUMN_STATS_ACCURATE	&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;                
	numFiles            	1                   
	numRows             	719384              
	orc.compress        	SNAPPY              
	rawDataSize         	97815412            
	totalSize           	51042245            
	transient_lastDdlTime	1387566737          
....   
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;bin/hive --orcfiledump /user/hive/warehouse/web_sales_correct_orc_snappy/000000_0
Rows: 719384
Compression: SNAPPY
Compression size: 262144
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;No compression
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;create table web_sales_correct_orc_none
stored as orc tblproperties (&lt;span class=&quot;code-quote&quot;&gt;&quot;orc.compress&quot;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&quot;NONE&quot;&lt;/span&gt;)
as select * from web_sales;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;describe formatted web_sales_correct_orc_none;
....
Location:           	hdfs:&lt;span class=&quot;code-comment&quot;&gt;//localhost:54310/user/hive/warehouse/web_sales_correct_orc_none	 
&lt;/span&gt;Table Type:         	MANAGED_TABLE       	 
Table Parameters:	 	 
	COLUMN_STATS_ACCURATE	&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;                
	numFiles            	1                   
	numRows             	719384              
	orc.compress        	NONE                
	rawDataSize         	97815412            
	totalSize           	53968823            
	transient_lastDdlTime	1387566788     
....   
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;bin/hive --orcfiledump /user/hive/warehouse/web_sales_correct_orc_none/000000_0
Rows: 719384
Compression: NONE
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13854849" author="hiveqa" created="Sat, 21 Dec 2013 11:51:26 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12619866/HIVE-6083.1.patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12619866/HIVE-6083.1.patch.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 4811 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_smb_mapjoin_8
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/723/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/723/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/723/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/723/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12619866&lt;/p&gt;</comment>
                            <comment id="13859252" author="yhuai" created="Tue, 31 Dec 2013 01:56:50 +0000"  >&lt;p&gt;Let me trigger HiveQA again.&lt;/p&gt;</comment>
                            <comment id="13859340" author="hiveqa" created="Tue, 31 Dec 2013 05:16:57 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12620896/HIVE-6083.2.patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12620896/HIVE-6083.2.patch.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 4818 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/775/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/775/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/775/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/775/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12620896&lt;/p&gt;</comment>
                            <comment id="13877094" author="navis" created="Tue, 21 Jan 2014 02:12:41 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13878262" author="navis" created="Wed, 22 Jan 2014 05:09:19 +0000"  >&lt;p&gt;Committed to trunk. Thanks Yin!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12619866" name="HIVE-6083.1.patch.txt" size="3819" author="yhuai" created="Fri, 20 Dec 2013 17:48:28 +0000"/>
                            <attachment id="12620896" name="HIVE-6083.2.patch.txt" size="3813" author="yhuai" created="Tue, 31 Dec 2013 01:56:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>364909</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 44 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1qwbb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>365209</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>