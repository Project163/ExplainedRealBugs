<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:36:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-10175] DynamicPartitionPruning lacks a fast-path exit for large IN() queries</title>
                <link>https://issues.apache.org/jira/browse/HIVE-10175</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;TezCompiler::runDynamicPartitionPruning() &amp;amp; ppr.PartitionPruner() calls the graph walker even if all tables provided to the optimizer are unpartitioned (or temporary) tables.&lt;/p&gt;

&lt;p&gt;This makes it extremely slow as it will walk &amp;amp; inspect a large/complex FilterOperator later in the pipeline.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12787242">HIVE-10175</key>
            <summary>DynamicPartitionPruning lacks a fast-path exit for large IN() queries</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="4" iconUrl="https://issues.apache.org/jira/images/icons/statuses/reopened.png" description="This issue was once resolved, but the resolution was deemed incorrect. From here issues are either marked assigned or resolved.">Reopened</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="gopalv">Gopal Vijayaraghavan</assignee>
                                    <reporter username="gopalv">Gopal Vijayaraghavan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 1 Apr 2015 04:17:45 +0000</created>
                <updated>Tue, 27 Feb 2024 22:23:53 +0000</updated>
                                            <version>1.2.0</version>
                                                    <component>Physical Optimizer</component>
                    <component>Tez</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14389994" author="gopalv" created="Wed, 1 Apr 2015 05:00:46 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;METHOD                         DURATION(ms) 
parse                                  462
semanticAnalyze                      9,312
TezBuildDag                            569
TezSubmitToRunningDag                    5
TotalPrepTime                       11,343
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Save 2 seconds by doing&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;set hive.tez.dynamic.partition.pruning=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;

METHOD                         DURATION(ms) 
parse                                  449
semanticAnalyze                      7,254
TezBuildDag                            527
TezSubmitToRunningDag                   16
TotalPrepTime                        9,190
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;save 9 seconds off default planning with&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;set hive.optimize.ppd=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
set hive.tez.dynamic.partition.pruning=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;

METHOD                         DURATION(ms) 
parse                                  446
semanticAnalyze                      2,089
TezBuildDag                            578
TezSubmitToRunningDag                    4
TotalPrepTime                        4,249
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14393571" author="hagleitn" created="Thu, 2 Apr 2015 22:14:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gopalv&quot; class=&quot;user-hover&quot; rel=&quot;gopalv&quot;&gt;gopalv&lt;/a&gt; do you have more info about where the time is spent and what the query is? I&apos;m looking at the dynamic pruner and what you ask isn&apos;t easy to do. The reason is that the synthetic predicate gets inserted by a logical opt early on. The dynamic pruner has to find these and nuke them, because the synthetic ones can&apos;t be executed. So now I&apos;m looking for alternatives to speed this up.&lt;/p&gt;

&lt;p&gt;I don&apos;t understand for instance how it can take 2 seconds to scan an expression tree. Maybe something else bust?&lt;/p&gt;</comment>
                            <comment id="14393580" author="hagleitn" created="Thu, 2 Apr 2015 22:19:07 +0000"  >&lt;p&gt;Checking the PartitionPruner - it seems we already have a fast path for &quot;prune().&quot; If you have more details about where the time is spent this would help.&lt;/p&gt;</comment>
                            <comment id="14716123" author="gopalv" created="Thu, 27 Aug 2015 05:48:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hagleitn&quot; class=&quot;user-hover&quot; rel=&quot;hagleitn&quot;&gt;hagleitn&lt;/a&gt;: Review please?&lt;/p&gt;</comment>
                            <comment id="14716263" author="jcamacho" created="Thu, 27 Aug 2015 08:19:32 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14718211" author="gopalv" created="Fri, 28 Aug 2015 08:31:24 +0000"  >&lt;p&gt;Pushed to master and branch-1, thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jcamachorodriguez&quot; class=&quot;user-hover&quot; rel=&quot;jcamachorodriguez&quot;&gt;jcamachorodriguez&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="14718284" author="gopalv" created="Fri, 28 Aug 2015 09:41:28 +0000"  >&lt;p&gt;Reverting this patch as this needs to cycle-break &amp;amp; fold out the SyntheticJoin predicates even if the target table is unpartitioned.&lt;/p&gt;</comment>
                            <comment id="14718285" author="gopalv" created="Fri, 28 Aug 2015 09:43:37 +0000"  >&lt;p&gt;The issue is only visible in TPC-H q21, which hit the following error in the nightly runs.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Caused by: java.lang.RuntimeException: Cannot find ExprNodeEvaluator &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the exprNodeDesc = RS[4]
        at org.apache.hadoop.hive.ql.exec.ExprNodeEvaluatorFactory.get(ExprNodeEvaluatorFactory.java:57)
        at org.apache.hadoop.hive.ql.exec.ExprNodeGenericFuncEvaluator.&amp;lt;init&amp;gt;(ExprNodeGenericFuncEvaluator.java:100)
        at org.apache.hadoop.hive.ql.exec.ExprNodeEvaluatorFactory.get(ExprNodeEvaluatorFactory.java:51)
        at org.apache.hadoop.hive.ql.exec.ExprNodeGenericFuncEvaluator.&amp;lt;init&amp;gt;(ExprNodeGenericFuncEvaluator.java:100)
        at org.apache.hadoop.hive.ql.exec.ExprNodeEvaluatorFactory.get(ExprNodeEvaluatorFactory.java:51)
        at org.apache.hadoop.hive.ql.exec.FilterOperator.initializeOp(FilterOperator.java:59)
        ... 21 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12846334">HIVE-11315</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12752664" name="HIVE-10175.1.patch" size="1051" author="gopalv" created="Thu, 27 Aug 2015 05:48:14 +0000"/>
                            <attachment id="12709105" name="HIVE-10175.profile.html" size="949864" author="gopalv" created="Thu, 2 Apr 2015 23:07:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 12 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i27mlr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>