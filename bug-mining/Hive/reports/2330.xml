<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:20:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-7257] UDF format_number() does not work on FLOAT types</title>
                <link>https://issues.apache.org/jira/browse/HIVE-7257</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;#1 Show the table:&lt;br/&gt;
hive&amp;gt; describe ssga3; &lt;br/&gt;
OK&lt;br/&gt;
source	string	&lt;br/&gt;
test	float	&lt;br/&gt;
dt	timestamp	&lt;br/&gt;
Time taken: 0.243 seconds&lt;/p&gt;

&lt;p&gt;#2 Run format_number on double and it works:&lt;br/&gt;
hive&amp;gt; select format_number(cast(test as double),2) from ssga3;&lt;br/&gt;
Total MapReduce jobs = 1&lt;br/&gt;
Launching Job 1 out of 1&lt;br/&gt;
Number of reduce tasks is set to 0 since there&apos;s no reduce operator&lt;br/&gt;
Starting Job = job_201403131616_0009, Tracking URL = &lt;a href=&quot;http://cdh5-1:50030/jobdetails.jsp?jobid=job_201403131616_0009&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cdh5-1:50030/jobdetails.jsp?jobid=job_201403131616_0009&lt;/a&gt;&lt;br/&gt;
Kill Command = /opt/cloudera/parcels/CDH-4.6.0-1.cdh4.6.0.p0.26/lib/hadoop/bin/hadoop job -kill job_201403131616_0009&lt;br/&gt;
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0&lt;br/&gt;
2014-03-13 17:14:53,992 Stage-1 map = 0%, reduce = 0%&lt;br/&gt;
2014-03-13 17:14:59,032 Stage-1 map = 100%, reduce = 0%, Cumulative CPU 1.47 sec&lt;br/&gt;
2014-03-13 17:15:00,046 Stage-1 map = 100%, reduce = 0%, Cumulative CPU 1.47 sec&lt;br/&gt;
2014-03-13 17:15:01,056 Stage-1 map = 100%, reduce = 0%, Cumulative CPU 1.47 sec&lt;br/&gt;
2014-03-13 17:15:02,067 Stage-1 map = 100%, reduce = 100%, Cumulative CPU 1.47 sec&lt;br/&gt;
MapReduce Total cumulative CPU time: 1 seconds 470 msec&lt;br/&gt;
Ended Job = job_201403131616_0009&lt;br/&gt;
MapReduce Jobs Launched: &lt;br/&gt;
Job 0: Map: 1 Cumulative CPU: 1.47 sec HDFS Read: 299 HDFS Write: 10 SUCCESS&lt;br/&gt;
Total MapReduce CPU Time Spent: 1 seconds 470 msec&lt;br/&gt;
OK&lt;br/&gt;
1.00&lt;br/&gt;
2.00&lt;br/&gt;
Time taken: 16.563 seconds&lt;/p&gt;

&lt;p&gt;#3 Run format_number on float and it does not work&lt;br/&gt;
hive&amp;gt; select format_number(test,2) from ssga3; &lt;br/&gt;
Total MapReduce jobs = 1&lt;br/&gt;
Launching Job 1 out of 1&lt;br/&gt;
Number of reduce tasks is set to 0 since there&apos;s no reduce operator&lt;br/&gt;
Starting Job = job_201403131616_0010, Tracking URL = &lt;a href=&quot;http://cdh5-1:50030/jobdetails.jsp?jobid=job_201403131616_0010&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cdh5-1:50030/jobdetails.jsp?jobid=job_201403131616_0010&lt;/a&gt;&lt;br/&gt;
Kill Command = /opt/cloudera/parcels/CDH-4.6.0-1.cdh4.6.0.p0.26/lib/hadoop/bin/hadoop job -kill job_201403131616_0010&lt;br/&gt;
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0&lt;br/&gt;
2014-03-13 17:20:21,158 Stage-1 map = 0%, reduce = 0%&lt;br/&gt;
2014-03-13 17:21:00,453 Stage-1 map = 100%, reduce = 100%&lt;br/&gt;
Ended Job = job_201403131616_0010 with errors&lt;br/&gt;
Error during job, obtaining debugging information...&lt;br/&gt;
Job Tracking URL: &lt;a href=&quot;http://cdh5-1:50030/jobdetails.jsp?jobid=job_201403131616_0010&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cdh5-1:50030/jobdetails.jsp?jobid=job_201403131616_0010&lt;/a&gt;&lt;br/&gt;
Examining task ID: task_201403131616_0010_m_000002 (and more) from job job_201403131616_0010&lt;br/&gt;
Unable to retrieve URL for Hadoop Task logs. Does not contain a valid host:port authority: logicaljt&lt;br/&gt;
Task with the most failures(4):&lt;br/&gt;
Task ID:&lt;br/&gt;
task_201403131616_0010_m_000000&lt;br/&gt;
Diagnostic Messages for this Task:&lt;br/&gt;
java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row &lt;/p&gt;
{&quot;source&quot;:null,&quot;test&quot;:1.0,&quot;dt&quot;:null}
&lt;p&gt;at org.apache.hadoop.hive.ql.exec.ExecMapper.map(ExecMapper.java:159)&lt;br/&gt;
at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:50)&lt;br/&gt;
at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:417)&lt;br/&gt;
at org.apache.hadoop.mapred.MapTask.run(MapTask.java:332)&lt;br/&gt;
at org.apache.hadoop.mapred.Child$4.run(Child.java:268)&lt;br/&gt;
at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
at javax.security.auth.Subject.doAs(Subject.java:415)&lt;br/&gt;
at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1438)&lt;br/&gt;
at org.apache.hadoop.mapred.Child.main(Child.java:262)&lt;br/&gt;
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row &lt;/p&gt;
{&quot;source&quot;:null,&quot;test&quot;:1.0,&quot;dt&quot;:null}
&lt;p&gt;at org.apache.hadoop.hive.ql.exec.MapOperator.process(MapOperator.java:675)&lt;br/&gt;
at org.apache.hadoop.hive.ql.exec.ExecMapper.map(ExecMapper.java:141)&lt;br/&gt;
..&lt;br/&gt;
FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.MapRedTask&lt;br/&gt;
MapReduce Jobs Launched: &lt;br/&gt;
Job 0: Map: 1 HDFS Read: 0 HDFS Write: 0 FAIL&lt;br/&gt;
Total MapReduce CPU Time Spent: 0 msec&lt;/p&gt;</description>
                <environment></environment>
        <key id="12722546">HIVE-7257</key>
            <summary>UDF format_number() does not work on FLOAT types</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="wilbur.yang">Wilbur Yang</assignee>
                                    <reporter username="wilbur.yang">Wilbur Yang</reporter>
                        <labels>
                    </labels>
                <created>Thu, 19 Jun 2014 17:40:55 +0000</created>
                <updated>Thu, 13 Nov 2014 19:44:02 +0000</updated>
                            <resolved>Thu, 3 Jul 2014 18:11:28 +0000</resolved>
                                                    <fixVersion>0.14.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14039741" author="hiveqa" created="Sat, 21 Jun 2014 09:08:11 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12651501/HIVE-7257.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12651501/HIVE-7257.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 6 failed/errored test(s), 5668 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_partition_date2
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_dynpart_sort_optimization
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_root_dir_external_table
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_ctas
org.apache.hive.hcatalog.pig.TestHCatLoader.testReadDataPrimitiveTypes
org.apache.hive.jdbc.miniHS2.TestHiveServer2.testConnection
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/538/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/538/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/538/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/538/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-538/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-538/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 6 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12651501&lt;/p&gt;</comment>
                            <comment id="14041525" author="szehon" created="Tue, 24 Jun 2014 00:35:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=wilbur.yang&quot; class=&quot;user-hover&quot; rel=&quot;wilbur.yang&quot;&gt;wilbur.yang&lt;/a&gt;.  Thanks for this patch, I do have one concern. the query&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;SELECT format_number(CAST(12332.123456 AS FLOAT), 4),&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;shows a result like :&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;12,332.1230&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It doesn&apos;t look correct, unless I&apos;m missing something?  I would expect 12332.1235, like it shows in decimal.&lt;/p&gt;</comment>
                            <comment id="14041533" author="wilbur.yang" created="Tue, 24 Jun 2014 00:46:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=szehon&quot; class=&quot;user-hover&quot; rel=&quot;szehon&quot;&gt;szehon&lt;/a&gt;, thanks for the review. That particular case seems to be a quirk with floats &amp;#8211; I &lt;a href=&quot;http://ideone.com/oP4NDJ&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;tested System.out.println((float)12332.123456);&lt;/a&gt; and it prints 12332.123. I suppose the question now is whether or not we want it to behave like this.&lt;/p&gt;</comment>
                            <comment id="14041576" author="szehon" created="Tue, 24 Jun 2014 01:34:36 +0000"  >&lt;p&gt;Ah, I guess that is most bits that fit into that float.  I&apos;m ok with the change then, +1.&lt;/p&gt;</comment>
                            <comment id="14051774" author="szehon" created="Thu, 3 Jul 2014 18:11:06 +0000"  >&lt;p&gt;Committed to trunk.  Thanks Wilbur for the contribution!&lt;/p&gt;</comment>
                            <comment id="14052216" author="lefty@hortonworks.com" created="Fri, 4 Jul 2014 07:02:42 +0000"  >&lt;p&gt;I mentioned this bug fix in the wiki here:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF#LanguageManualUDF-StringFunctions&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;UDFs &amp;#8211; String Functions &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14132304" author="apivovarov" created="Fri, 12 Sep 2014 23:32:49 +0000"  >&lt;p&gt;Does format_number work for decimal(n,m)?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;SELECT format_number(CAST(12332.123456 AS decimal(32,12)), 4),
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;hive 0.13.1 (hdp-2.1.3) gives me&lt;br/&gt;
FAILED: SemanticException &lt;span class=&quot;error&quot;&gt;&amp;#91;Error 10016&amp;#93;&lt;/span&gt;: Line 4:28 Argument type mismatch &apos;amount&apos;: Argument 1 of function FORMAT_NUMBER must be &quot;tinyint&quot; or &quot;smallint&quot; or &quot;int&quot; or &quot;bigint&quot; or &quot;double&quot; or &quot;float&quot;, but &quot;decimal(32,12)&quot; was found.&lt;/p&gt;</comment>
                            <comment id="14132335" author="wilbur.yang" created="Fri, 12 Sep 2014 23:58:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apivovarov&quot; class=&quot;user-hover&quot; rel=&quot;apivovarov&quot;&gt;apivovarov&lt;/a&gt;, please see &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-7279&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;HIVE-7279&lt;/a&gt;. Thanks&lt;/p&gt;</comment>
                            <comment id="14211082" author="thejas" created="Thu, 13 Nov 2014 19:44:02 +0000"  >&lt;p&gt;This has been fixed in 0.14 release. Please open new jira if you see any issues.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12651501" name="HIVE-7257.1.patch" size="4595" author="wilbur.yang" created="Thu, 19 Jun 2014 21:37:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>400737</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1wzdr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>400831</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>