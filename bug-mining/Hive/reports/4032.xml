<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:39:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-11726] Pushed IN predicates to the metastore</title>
                <link>https://issues.apache.org/jira/browse/HIVE-11726</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The PointLookupOptimizer can turn off some of the optimizations due to its use of tuple IN() clauses.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11573&quot; title=&quot;PointLookupOptimizer can be pessimistic at a low nDV&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11573&quot;&gt;&lt;del&gt;HIVE-11573&lt;/del&gt;&lt;/a&gt; introduced the extraction of sub-clauses that could be pushed down till the TableScan operators, though they wouldn&apos;t be pushed down to the metastore.&lt;/p&gt;

&lt;p&gt;In this issue, we tackle this problem by extending the filter parser of the metastore to support IN clauses, including multiple columns. This allows to push those additional predicates down throw directSQL to the metastore.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12861618">HIVE-11726</key>
            <summary>Pushed IN predicates to the metastore</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jcamacho">Jes&#250;s Camacho Rodr&#237;guez</assignee>
                                    <reporter username="jcamacho">Jes&#250;s Camacho Rodr&#237;guez</reporter>
                        <labels>
                    </labels>
                <created>Thu, 3 Sep 2015 16:50:40 +0000</created>
                <updated>Tue, 24 Sep 2024 10:09:58 +0000</updated>
                            <resolved>Fri, 6 Nov 2015 17:05:17 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14729631" author="hiveqa" created="Thu, 3 Sep 2015 19:26:01 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12754031/HIVE-11726.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12754031/HIVE-11726.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 9393 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hive.hcatalog.api.TestHCatClient.testTableSchemaPropagation
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5166/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5166/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5166/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5166/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5166/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5166/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12754031 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14730350" author="jcamacho" created="Fri, 4 Sep 2015 05:46:34 +0000"  >&lt;p&gt;Test fail is unrelated. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jpullokkaran&quot; class=&quot;user-hover&quot; rel=&quot;jpullokkaran&quot;&gt;jpullokkaran&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hsubramaniyan&quot; class=&quot;user-hover&quot; rel=&quot;hsubramaniyan&quot;&gt;hsubramaniyan&lt;/a&gt;, could anyone take a look? Thanks&lt;/p&gt;</comment>
                            <comment id="14803343" author="jcamacho" created="Thu, 17 Sep 2015 18:19:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jpullokkaran&quot; class=&quot;user-hover&quot; rel=&quot;jpullokkaran&quot;&gt;jpullokkaran&lt;/a&gt;, it seems there is duplicated logic between &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11684&quot; title=&quot;Implement limit pushdown through outer join in CBO&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11684&quot;&gt;&lt;del&gt;HIVE-11684&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11726&quot; title=&quot;Pushed IN predicates to the metastore&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11726&quot;&gt;&lt;del&gt;HIVE-11726&lt;/del&gt;&lt;/a&gt; to extract the partition columns from the IN clause; it is something we expected.&lt;/p&gt;

&lt;p&gt;However, after talking to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hsubramaniyan&quot; class=&quot;user-hover&quot; rel=&quot;hsubramaniyan&quot;&gt;hsubramaniyan&lt;/a&gt; and thinking on both patches, it doesn&apos;t seem logical to keep this logic in both places, as we will not be able to bail out quickly in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11684&quot; title=&quot;Implement limit pushdown through outer join in CBO&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11684&quot;&gt;&lt;del&gt;HIVE-11684&lt;/del&gt;&lt;/a&gt;; in fact, we will end up reapplying the same logic to add additional operands to the predicate.&lt;/p&gt;

&lt;p&gt;I suggest to go ahead with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11684&quot; title=&quot;Implement limit pushdown through outer join in CBO&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11684&quot;&gt;&lt;del&gt;HIVE-11684&lt;/del&gt;&lt;/a&gt;, and that &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11726&quot; title=&quot;Pushed IN predicates to the metastore&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11726&quot;&gt;&lt;del&gt;HIVE-11726&lt;/del&gt;&lt;/a&gt; only contains the logic to push predicates comprising IN/STRUCT to the metastore filter. Thus, PointLookupOptimizer will only contain the logic to transform OR/AND predicates into IN predicates.&lt;/p&gt;

&lt;p&gt;What do you think? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hsubramaniyan&quot; class=&quot;user-hover&quot; rel=&quot;hsubramaniyan&quot;&gt;hsubramaniyan&lt;/a&gt;, what&apos;s your take on this?&lt;/p&gt;</comment>
                            <comment id="14804324" author="hsubramaniyan" created="Thu, 17 Sep 2015 19:31:03 +0000"  >&lt;p&gt;Agree with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jcamachorodriguez&quot; class=&quot;user-hover&quot; rel=&quot;jcamachorodriguez&quot;&gt;jcamachorodriguez&lt;/a&gt; on this. I think PointLookUpOptimizer should have logic to only transform OR/AND predicates to IN. &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11634&quot; title=&quot;Support partition pruning for IN(STRUCT(partcol, nonpartcol..)...)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11634&quot;&gt;&lt;del&gt;HIVE-11634&lt;/del&gt;&lt;/a&gt; should support separating the partition columns (which should take place even for an user input IN(STRUCT(..) query). &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11726&quot; title=&quot;Pushed IN predicates to the metastore&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11726&quot;&gt;&lt;del&gt;HIVE-11726&lt;/del&gt;&lt;/a&gt; should have the logic to push predicates to the metastore filter. We should make sure that these transformations work independently as well, i.e all possible combinations of enable/disable of point lookup/partition column separation.&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Hari&lt;/p&gt;</comment>
                            <comment id="14987632" author="jcamacho" created="Tue, 3 Nov 2015 17:10:26 +0000"  >&lt;p&gt;Rebased patch and removed part concerning OR/AND predicates transformation into IN (which is already covered by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11634&quot; title=&quot;Support partition pruning for IN(STRUCT(partcol, nonpartcol..)...)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11634&quot;&gt;&lt;del&gt;HIVE-11634&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;Updated patch description to reflect that.&lt;/p&gt;</comment>
                            <comment id="14988197" author="hiveqa" created="Tue, 3 Nov 2015 21:45:51 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12770355/HIVE-11726.01.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12770355/HIVE-11726.01.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 4 failed/errored test(s), 9767 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestHBaseCliDriver.testCliDriver_hbase_queries
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import
org.apache.hadoop.hive.hwi.TestHWISessionManager.testHiveDriver
org.apache.hive.jdbc.TestSSL.testSSLVersion
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5905/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5905/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5905/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5905/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5905/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5905/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 4 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12770355 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14989121" author="jcamacho" created="Wed, 4 Nov 2015 08:37:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hsubramaniyan&quot; class=&quot;user-hover&quot; rel=&quot;hsubramaniyan&quot;&gt;hsubramaniyan&lt;/a&gt;, last version of the patch removed part concerning OR/AND predicates transformation into IN (which you already covered in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11634&quot; title=&quot;Support partition pruning for IN(STRUCT(partcol, nonpartcol..)...)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11634&quot;&gt;&lt;del&gt;HIVE-11634&lt;/del&gt;&lt;/a&gt;). Thus, this patch will enable pushing the IN predicates directly to the metastore.&lt;/p&gt;

&lt;p&gt;Could you take a look? Thanks&lt;/p&gt;</comment>
                            <comment id="14989122" author="jcamacho" created="Wed, 4 Nov 2015 08:38:26 +0000"  >&lt;p&gt;QA test fails are unrelated.&lt;/p&gt;</comment>
                            <comment id="14992607" author="hsubramaniyan" created="Thu, 5 Nov 2015 22:26:36 +0000"  >&lt;p&gt;ltgm +1&lt;/p&gt;</comment>
                            <comment id="14993985" author="jcamacho" created="Fri, 6 Nov 2015 17:05:17 +0000"  >&lt;p&gt;Pushed to master. Thanks for the review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hsubramaniyan&quot; class=&quot;user-hover&quot; rel=&quot;hsubramaniyan&quot;&gt;hsubramaniyan&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="17884206" author="katty0924" created="Tue, 24 Sep 2024 10:09:58 +0000"  >&lt;p&gt;this patch can be merged into hive 1.1? when i use this patch, it seems doesn&apos;t work&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12858466">HIVE-11634</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13339880">SPARK-33416</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12856339">HIVE-11573</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12770355" name="HIVE-11726.01.patch" size="31501" author="jcamachorodriguez" created="Tue, 3 Nov 2015 17:10:26 +0000"/>
                            <attachment id="12754031" name="HIVE-11726.patch" size="43212" author="jcamachorodriguez" created="Thu, 3 Sep 2015 16:59:42 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 7 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2jr6v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>