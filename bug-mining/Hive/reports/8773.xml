<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:26:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-28700] MRCompactor may cause data loss when performing the major compaction</title>
                <link>https://issues.apache.org/jira/browse/HIVE-28700</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Steps to repro:&lt;/p&gt;

&lt;p&gt;set mapreduce.job.reduces=7;&lt;br/&gt;
create table ext(a int);&lt;br/&gt;
insert into table ext values(1),(2),(3),(3),(3),(3),(4),(5),(6),(7);&lt;br/&gt;
create table full_acid(a int) stored as orc tblproperties(&quot;transactional&quot;=&quot;true&quot;);&lt;br/&gt;
insert overwrite table full_acid select * from ext where a &#160;= 3;&lt;br/&gt;
insert into table full_acid select * from ext where a != 3 group by a;&lt;/p&gt;

&lt;p&gt;select * from full_acid;&lt;br/&gt;
alter table full_acid compact &apos;major&apos; and wait;&lt;br/&gt;
select * from full_acid;&lt;/p&gt;

&lt;p&gt;After the major compaction, the full_acid table misses records &quot;a = 3&quot;;&lt;/p&gt;

&lt;p&gt;This issue might happen on overwrite then insert into or merge the ACID table, followed by a major compaction. During the major compaction, due to the accidental bucket on the base file and no the same bucket found across all the delta files, the compactor will miss this base file, making all records in this file loss.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13604322">HIVE-28700</key>
            <summary>MRCompactor may cause data loss when performing the major compaction</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dengzh">Zhihua Deng</assignee>
                                    <reporter username="dengzh">Zhihua Deng</reporter>
                        <labels>
                            <label>hive-4.1.0-must</label>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 9 Jan 2025 04:30:52 +0000</created>
                <updated>Wed, 5 Nov 2025 23:31:45 +0000</updated>
                            <resolved>Wed, 15 Jan 2025 03:36:29 +0000</resolved>
                                    <version>4.0.0</version>
                    <version>4.0.1</version>
                                    <fixVersion>4.1.0</fixVersion>
                                    <component>Hive</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17913151" author="dengzh" created="Wed, 15 Jan 2025 03:36:29 +0000"  >&lt;p&gt;Fix has been merged. Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dkuzmenko&quot; class=&quot;user-hover&quot; rel=&quot;dkuzmenko&quot;&gt;dkuzmenko&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kuczoram&quot; class=&quot;user-hover&quot; rel=&quot;kuczoram&quot;&gt;kuczoram&lt;/a&gt; for the review!&lt;/p&gt;</comment>
                            <comment id="18012152" author="zabetak" created="Tue, 5 Aug 2025 14:51:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dengzh&quot; class=&quot;user-hover&quot; rel=&quot;dengzh&quot;&gt;dengzh&lt;/a&gt; Can you please add a few extra details in the ticket to explain what the problem is and why the patch fixes the problem? Having the exact repro steps is very useful but in order for someone to understand if they are hitting this problem or not it would help to elaborate a bit more about the bug/solution. &lt;/p&gt;</comment>
                            <comment id="18012514" author="zabetak" created="Thu, 7 Aug 2025 08:29:33 +0000"  >&lt;p&gt;Thanks for the extra details &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dengzh&quot; class=&quot;user-hover&quot; rel=&quot;dengzh&quot;&gt;dengzh&lt;/a&gt;. In other words we could possibly confirm if we are hitting this issue by obtaining a full listing of the table in the file-system (HDFS). If there are buckets that exist in the base directory and don&apos;t exist in the delta directory then this may result in data loss after compaction. Am I right?&lt;/p&gt;</comment>
                            <comment id="18035686" author="dengzh" created="Wed, 5 Nov 2025 23:31:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zabetak&quot; class=&quot;user-hover&quot; rel=&quot;zabetak&quot;&gt;zabetak&lt;/a&gt; you are right, this is the exact case&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1ti34:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>