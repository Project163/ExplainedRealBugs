<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:02:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-3265] HiveHistory.printRowCount() throws NPE</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3265</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12599193">HIVE-3265</key>
            <summary>HiveHistory.printRowCount() throws NPE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shreepadma">Shreepadma Venugopalan</assignee>
                                    <reporter username="cwsteinbach">Carl Steinbach</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Jul 2012 23:22:12 +0000</created>
                <updated>Thu, 10 Jan 2013 19:53:20 +0000</updated>
                            <resolved>Wed, 29 Aug 2012 08:07:38 +0000</resolved>
                                    <version>0.8.1</version>
                                    <fixVersion>0.10.0</fixVersion>
                                    <component>Diagnosability</component>
                    <component>Logging</component>
                    <component>Server Infrastructure</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13416714" author="cwsteinbach" created="Tue, 17 Jul 2012 23:29:53 +0000"  >&lt;p&gt;The following NPE appeared in the log after running LOAD DATA commands:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2012-07-17 13:34:20,653 ERROR ql.Driver (SessionState.java:printError(380)) - FAILED: Hive Internal Error: java.lang.NullPointerException(null) 
java.lang.NullPointerException 
at org.apache.hadoop.hive.ql.history.HiveHistory.printRowCount(HiveHistory.java:411) 
at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1241) 
at org.apache.hadoop.hive.ql.Driver.run(Driver.java:931) 
at org.apache.hadoop.hive.service.HiveServer$HiveServerHandler.execute(HiveServer.java:191) 
at org.apache.hadoop.hive.service.ThriftHive$Processor$execute.getResult(ThriftHive.java:629) 
at org.apache.hadoop.hive.service.ThriftHive$Processor$execute.getResult(ThriftHive.java:617) 
at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:32) 
at org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:34) 
at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:176) 
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) 
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) 
at java.lang.Thread.run(Thread.java:662)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Here&apos;s the relevant code from the HiveHistory class. Line 411 corresponds to the for loop condition:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void printRowCount(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; queryId) {
    QueryInfo ji = queryInfoMap.get(queryId);
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; tab : ji.rowCountMap.keySet()) {
      console.printInfo(ji.rowCountMap.get(tab) + &lt;span class=&quot;code-quote&quot;&gt;&quot; Rows loaded to &quot;&lt;/span&gt; + tab);
    }
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So it looks like queryInfoMap doesn&apos;t have a QueryInfo object for the request queryId.&lt;/p&gt;

&lt;p&gt;It&apos;s worth noting that most of the other references to queryInfoMap in HiveHistory do a null check on the returned object before dereferencing.&lt;/p&gt;

&lt;p&gt;And then there&apos;s this pattern, which I see repeated in most of the HiveHistory setters:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setQueryProperty(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; queryId, Keys propName, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; propValue) {
    QueryInfo ji = queryInfoMap.get(queryId);
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (ji == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
    }
    ji.hm.put(propName.name(), propValue);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In other words, setQueryProperty() will pretend that it set the request property even if it can&apos;t find the QueryInfo object. How polite!&lt;/p&gt;</comment>
                            <comment id="13442269" author="shreepadma" created="Mon, 27 Aug 2012 04:30:39 +0000"  >&lt;p&gt;Reviewboard request URL: &lt;a href=&quot;https://reviews.apache.org/r/6779/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/6779/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13442310" author="cwsteinbach" created="Mon, 27 Aug 2012 07:13:00 +0000"  >&lt;p&gt;+1. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13443892" author="cwsteinbach" created="Wed, 29 Aug 2012 08:07:38 +0000"  >&lt;p&gt;Committed to trunk. Thanks Shreepadma.&lt;/p&gt;</comment>
                            <comment id="13444226" author="hudson" created="Wed, 29 Aug 2012 17:23:39 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1635 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1635/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1635/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3265&quot; title=&quot;HiveHistory.printRowCount() throws NPE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3265&quot;&gt;&lt;del&gt;HIVE-3265&lt;/del&gt;&lt;/a&gt;. HiveHistory.printRowCount() throws NPE (Shreepadma Venugopalan via cws) (Revision 1378472)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1378472&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1378472&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/history/HiveHistory.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13444614" author="shreepadma" created="Thu, 30 Aug 2012 02:15:21 +0000"  >&lt;p&gt;Thanks Carl!&lt;/p&gt;</comment>
                            <comment id="13548083" author="hudson" created="Wed, 9 Jan 2013 10:24:19 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #54 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3265&quot; title=&quot;HiveHistory.printRowCount() throws NPE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3265&quot;&gt;&lt;del&gt;HIVE-3265&lt;/del&gt;&lt;/a&gt;. HiveHistory.printRowCount() throws NPE (Shreepadma Venugopalan via cws) (Revision 1378472)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1378472&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1378472&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/history/HiveHistory.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13550089" author="ashutoshc" created="Thu, 10 Jan 2013 19:53:20 +0000"  >&lt;p&gt;This issue is fixed and released as part of 0.10.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12542574" name="HIVE-3265.1.patch.txt" size="828" author="shreepadma" created="Mon, 27 Aug 2012 04:27:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>242364</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 45 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02u4f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>14481</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>