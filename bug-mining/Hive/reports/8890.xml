<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:27:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-29066] PARTITION_NAME_WHITELIST_PATTERN is not honouring session level configuration</title>
                <link>https://issues.apache.org/jira/browse/HIVE-29066</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Steps to repro (ensure &lt;em&gt;metastore.partition.name.whitelist.pattern&lt;/em&gt; or &lt;em&gt;hive.metastore.partition.name.whitelist.pattern&lt;/em&gt; is not present in hive-site.xml):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
set metaconf:metastore.partition.name.whitelist.pattern=[^9]*;

create table t1 (id &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) partitioned by (pcol string);
alter table t1 add partition (pCol=&lt;span class=&quot;code-quote&quot;&gt;&apos;2025-06-09&apos;&lt;/span&gt;);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;b&gt;What is happening:&lt;/b&gt; &lt;b&gt;Query is passing.&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;The expect outcome should be&lt;/b&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Error: Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; compiling statement: FAILED: Execution Error, &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; code 40000 from org. apache.hadoop.hive.ql.ddl.DDLTask. MetaException(message:Partition value &lt;span class=&quot;code-quote&quot;&gt;&apos; 2025-06-09&apos;&lt;/span&gt; contains a character not matched by whitelist pattern &lt;span class=&quot;code-quote&quot;&gt;&apos;[^9]*&apos;&lt;/span&gt;. (configure with metastore.partition.name.whitelist.pattern)); Query ID: raghav_20250703214
146_1fcab256-2425-4e9e-8ac0-ec2d53e2d1b0 (state=08S01, code=40000) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13622487">HIVE-29066</key>
            <summary>PARTITION_NAME_WHITELIST_PATTERN is not honouring session level configuration</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="Aggarwal_Raghav">Raghav Aggarwal</assignee>
                                    <reporter username="Aggarwal_Raghav">Raghav Aggarwal</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 3 Jul 2025 19:08:56 +0000</created>
                <updated>Sat, 2 Aug 2025 08:22:06 +0000</updated>
                            <resolved>Sat, 2 Aug 2025 08:22:06 +0000</resolved>
                                                    <fixVersion>4.2.0</fixVersion>
                                    <component>Standalone Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17993151" author="JIRAUSER295901" created="Thu, 3 Jul 2025 19:20:00 +0000"  >&lt;p&gt;Based on the initial debugging:&lt;br/&gt;
PARTITION_NAME_WHITELIST_PATTERN is part of metaConfVars i.e part of config list that can be updated in a beeline session using&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
set metaconf:metastore.partition.name.whitelist.pattern=value;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;HMSHandler.partitionValidationPattern&lt;/em&gt; field is initialized in init() method and there is no way to update it, if user set the config in session level.&lt;/p&gt;</comment>
                            <comment id="17995796" author="JIRAUSER295901" created="Fri, 4 Jul 2025 17:40:20 +0000"  >&lt;p&gt;Attaching the repro case and a possible patch here.&lt;/p&gt;</comment>
                            <comment id="17995799" author="JIRAUSER295901" created="Fri, 4 Jul 2025 18:00:40 +0000"  >&lt;p&gt;CC &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dengzh&quot; class=&quot;user-hover&quot; rel=&quot;dengzh&quot;&gt;dengzh&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dkuzmenko&quot; class=&quot;user-hover&quot; rel=&quot;dkuzmenko&quot;&gt;dkuzmenko&lt;/a&gt; , can you please take a look? I also have a follow up question. I believe there is another issue as well related to metaConfVars in general:&lt;/p&gt;

&lt;p&gt;The value of metaconf is getting reset post running any meta-operation. Attaching screenshot in attachments for the same. &lt;b&gt;The modified value of config should persist in the same beeline session?&lt;/b&gt;&#160;I believe the&#160;&lt;br/&gt;
&lt;em&gt;HMSHandler#notifyMetaListenersOnShutDown&lt;/em&gt; is why this behaviour is because of ThreadLocal. Is it the expected behaviour in hive4 because the same is not happening in hive3.&lt;/p&gt;</comment>
                            <comment id="18011566" author="dkuzmenko" created="Sat, 2 Aug 2025 08:21:58 +0000"  >&lt;p&gt;Merged to master&lt;/p&gt;

&lt;p&gt;Thanks for the fix, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Aggarwal_Raghav&quot; class=&quot;user-hover&quot; rel=&quot;Aggarwal_Raghav&quot;&gt;Aggarwal_Raghav&lt;/a&gt; !&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310760">
                    <name>Testing</name>
                                            <outwardlinks description="Testing discovered">
                                        <issuelink>
            <issuekey id="13622732">HIVE-29073</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13077311" name="HIVE-29066_1.patch" size="4663" author="Aggarwal_Raghav" created="Fri, 4 Jul 2025 17:42:14 +0000"/>
                            <attachment id="13077312" name="MetaConf_Reset.png" size="396616" author="Aggarwal_Raghav" created="Fri, 4 Jul 2025 17:56:52 +0000"/>
                            <attachment id="13077310" name="repro.q" size="297" author="Aggarwal_Raghav" created="Fri, 4 Jul 2025 17:40:28 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1wlns:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>