<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:04:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-3915] Union with map-only query on one side and two MR job query on the other produces wrong results</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3915</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;When a query contains a union with a map only subquery on one side and a subquery involving two sequential map reduce jobs on the other, it can produce wrong results.  It appears that if the map only queries table scan operator is processed first the task involving a union is made a root task.  Then when the other subquery is processed, the second map reduce job gains the task involving the union as a child and it is made a root task.  This means that both the first and second map reduce jobs are root tasks, so the dependency between the two is ignored.  If they are run in parallel (i.e. the cluster has more than one node) no results will be produced for the side of the union with the two map reduce jobs and only the results of the other side of the union will be returned.&lt;/p&gt;

&lt;p&gt;The order TableScan operators are processed is crucial to reproducing this bug, and it is determined by the order values are retrieved from a map, and hence hard to predict, so it doesn&apos;t always reproduce.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12628158">HIVE-3915</key>
            <summary>Union with map-only query on one side and two MR job query on the other produces wrong results</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kevinwilfong">Kevin Wilfong</assignee>
                                    <reporter username="kevinwilfong">Kevin Wilfong</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 Jan 2013 06:17:51 +0000</created>
                <updated>Thu, 16 May 2013 21:10:37 +0000</updated>
                            <resolved>Fri, 18 Jan 2013 15:53:45 +0000</resolved>
                                    <version>0.11.0</version>
                                    <fixVersion>0.11.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13556994" author="kevinwilfong" created="Fri, 18 Jan 2013 06:25:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://reviews.facebook.net/D8019&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D8019&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13556995" author="namit" created="Fri, 18 Jan 2013 06:28:03 +0000"  >&lt;p&gt;Great catch Kevin, this seems to have been around for a long time.&lt;/p&gt;</comment>
                            <comment id="13557094" author="namit" created="Fri, 18 Jan 2013 09:52:47 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13557302" author="namit" created="Fri, 18 Jan 2013 15:53:45 +0000"  >&lt;p&gt;Committed. Thanks Kevin&lt;/p&gt;</comment>
                            <comment id="13557310" author="hudson" created="Fri, 18 Jan 2013 16:08:19 +0000"  >&lt;p&gt;Integrated in hive-trunk-hadoop1 #24 (See &lt;a href=&quot;https://builds.apache.org/job/hive-trunk-hadoop1/24/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/hive-trunk-hadoop1/24/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3915&quot; title=&quot;Union with map-only query on one side and two MR job query on the other produces wrong results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3915&quot;&gt;&lt;del&gt;HIVE-3915&lt;/del&gt;&lt;/a&gt; Union with map-only query on one side and two MR job query on the other&lt;br/&gt;
produces wrong results (Kevin Wilfong via namit) (Revision 1435203)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1435203&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1435203&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRUnion1.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/union33.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/union33.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13557311" author="hudson" created="Fri, 18 Jan 2013 16:08:19 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1921 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1921/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1921/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3915&quot; title=&quot;Union with map-only query on one side and two MR job query on the other produces wrong results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3915&quot;&gt;&lt;del&gt;HIVE-3915&lt;/del&gt;&lt;/a&gt; Union with map-only query on one side and two MR job query on the other&lt;br/&gt;
produces wrong results (Kevin Wilfong via namit) (Revision 1435203)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1435203&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1435203&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRUnion1.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/union33.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/union33.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13557789" author="hudson" created="Sat, 19 Jan 2013 00:12:43 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #72 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/72/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/72/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3915&quot; title=&quot;Union with map-only query on one side and two MR job query on the other produces wrong results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3915&quot;&gt;&lt;del&gt;HIVE-3915&lt;/del&gt;&lt;/a&gt; Union with map-only query on one side and two MR job query on the other&lt;br/&gt;
produces wrong results (Kevin Wilfong via namit) (Revision 1435203)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1435203&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1435203&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRUnion1.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/union33.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/union33.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12565439" name="HIVE-3915.1.patch.txt" size="25087" author="kevinwilfong" created="Fri, 18 Jan 2013 06:26:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>305013</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 44 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1830v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>255292</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>