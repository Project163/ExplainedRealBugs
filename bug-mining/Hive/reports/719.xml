<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 17:59:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-2466] mapjoin_subquery  dump small table (mapjoin table) to the same file</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2466</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;in mapjoin_subquery.q  there is a query&#65306;&lt;br/&gt;
SELECT /*+ MAPJOIN(z) */ subq.key1, z.value&lt;br/&gt;
FROM&lt;br/&gt;
(SELECT /*+ MAPJOIN&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; */ x.key as key1, x.value as value1, y.key as key2, y.value as value2 &lt;br/&gt;
 FROM src1 x JOIN src y ON (x.key = y.key)) subq&lt;br/&gt;
 JOIN srcpart z ON (subq.key1 = z.key and z.ds=&apos;2008-04-08&apos; and z.hr=11);&lt;br/&gt;
when dump x and z to a local file,there all dump to the same file, so we lost the data of x&lt;/p&gt;</description>
                <environment></environment>
        <key id="12524434">HIVE-2466</key>
            <summary>mapjoin_subquery  dump small table (mapjoin table) to the same file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="binlijin">Lijin Bin</assignee>
                                    <reporter username="binlijin">Lijin Bin</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Sep 2011 16:39:01 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:10 +0000</updated>
                            <resolved>Tue, 8 Nov 2011 05:53:22 +0000</resolved>
                                    <version>0.7.1</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13133815" author="he yongqiang" created="Mon, 24 Oct 2011 03:15:45 +0000"  >&lt;p&gt;can you add a testcase?&lt;/p&gt;</comment>
                            <comment id="13134041" author="aoxiang" created="Mon, 24 Oct 2011 13:02:42 +0000"  >&lt;p&gt;Add a testcase in hive-2466.2.patch&lt;/p&gt;</comment>
                            <comment id="13134321" author="namit" created="Mon, 24 Oct 2011 18:22:31 +0000"  >&lt;p&gt;reviewing now&lt;/p&gt;</comment>
                            <comment id="13134440" author="namit" created="Mon, 24 Oct 2011 20:19:00 +0000"  >&lt;p&gt;A few high level comments:&lt;/p&gt;

&lt;p&gt;Instead of making the dump prefix optional - why dont you always have it in hashtablesinkdesc and&lt;br/&gt;
mapjoindesc. &lt;/p&gt;

&lt;p&gt;This way, you can get rid of all the checks : if dumpdescriptor is not null.&lt;br/&gt;
The logic will be simpler - the names of map files will be :&lt;/p&gt;

&lt;p&gt;mapfile1&lt;br/&gt;
mapfile2&lt;br/&gt;
..&lt;br/&gt;
etc&lt;/p&gt;

&lt;p&gt;Also, it might be nicer to add the static function in PlanUtils.java instead of QBJoinTree.java.&lt;/p&gt;</comment>
                            <comment id="13134767" author="aoxiang" created="Tue, 25 Oct 2011 05:46:53 +0000"  >&lt;p&gt;@Namit Jain,&lt;br/&gt;
Thank you very much! I make some changes in hive-2466.3.patch.&lt;/p&gt;</comment>
                            <comment id="13145213" author="phabricator@reviews.facebook.net" created="Mon, 7 Nov 2011 04:12:51 +0000"  >&lt;p&gt;njain requested code review of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2466&quot; title=&quot;mapjoin_subquery  dump small table (mapjoin table) to the same file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2466&quot;&gt;&lt;del&gt;HIVE-2466&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; mapjoin_subquery  dump small table (mapjoin table) to the same file&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2466&quot; title=&quot;mapjoin_subquery  dump small table (mapjoin table) to the same file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2466&quot;&gt;&lt;del&gt;HIVE-2466&lt;/del&gt;&lt;/a&gt; diff for review&lt;/p&gt;

&lt;p&gt;  in mapjoin_subquery.q  there is a query&#65306;&lt;br/&gt;
  SELECT /*+ MAPJOIN(z) */ subq.key1, z.value&lt;br/&gt;
  FROM&lt;br/&gt;
  (SELECT /*+ MAPJOIN&amp;lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&amp;gt; */ x.key as key1, x.value as value1, y.key as key2, y.value as value2&lt;br/&gt;
  FROM src1 x JOIN src y ON (x.key = y.key)) subq&lt;br/&gt;
  JOIN srcpart z ON (subq.key1 = z.key and z.ds=&apos;2008-04-08&apos; and z.hr=11);&lt;br/&gt;
  when dump x and z to a local file,there all dump to the same file, so we lost the data of x&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  EMPTY&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D285&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D285&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  data/files/x.txt&lt;br/&gt;
  data/files/y.txt&lt;br/&gt;
  data/files/z.txt&lt;br/&gt;
  ql/src/test/results/clientpositive/mapjoin_subquery2.q.out&lt;br/&gt;
  ql/src/test/queries/clientpositive/mapjoin_subquery2.q&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/GenMRSkewJoinProcessor.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinProcessor.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableSinkOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/MapredLocalTask.java.orig&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/MapredLocalTask.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableSinkOperator.java.orig&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/HashTableSinkDesc.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/MapJoinDesc.java&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/591/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/herald/transcript/591/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Tip: use the X-Herald-Rules header to filter Herald messages in your client.&lt;/p&gt;</comment>
                            <comment id="13145214" author="namit" created="Mon, 7 Nov 2011 04:14:51 +0000"  >&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 680 source files to /data/users/njain/hive_commit2/build/ql/classes&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; /data/users/njain/hive_commit2/ql/src/java/org/apache/hadoop/hive/ql/exec/MapJoinOperator.java:191: cannot find symbol&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; symbol  : method generatePath(java.lang.String,java.lang.Byte,java.lang.String)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; location: class org.apache.hadoop.hive.ql.exec.Utilities&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;         String filePath = Utilities.generatePath(baseDir, pos, currentFileName);&lt;/p&gt;


&lt;p&gt;Can you refresh ?&lt;/p&gt;

&lt;p&gt;I am getting the above error in compiling.&lt;br/&gt;
Also, create a arc diff entry for helping reviewing.&lt;/p&gt;</comment>
                            <comment id="13145263" author="aoxiang" created="Mon, 7 Nov 2011 07:22:51 +0000"  >&lt;p&gt;hive-2466.4.patch is based on the trunk, &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk&lt;/a&gt;, I don&apos;t have the compile problem.&lt;br/&gt;
how to create a arc diff entry? I use the command &quot;svn diff &amp;gt; hive-2466.4.patch&quot; to get the patch.&lt;/p&gt;</comment>
                            <comment id="13145663" author="phabricator@reviews.facebook.net" created="Mon, 7 Nov 2011 18:10:51 +0000"  >&lt;p&gt;njain updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2466&quot; title=&quot;mapjoin_subquery  dump small table (mapjoin table) to the same file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2466&quot;&gt;&lt;del&gt;HIVE-2466&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; mapjoin_subquery  dump small table (mapjoin table) to the same file&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2466&quot; title=&quot;mapjoin_subquery  dump small table (mapjoin table) to the same file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2466&quot;&gt;&lt;del&gt;HIVE-2466&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D285&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D285&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  data/files/x.txt&lt;br/&gt;
  data/files/y.txt&lt;br/&gt;
  data/files/z.txt&lt;br/&gt;
  ql/src/test/results/clientpositive/mapjoin_subquery2.q.out&lt;br/&gt;
  ql/src/test/queries/clientpositive/mapjoin_subquery2.q&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/GenMRSkewJoinProcessor.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinProcessor.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableSinkOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/MapredLocalTask.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/MapJoinOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/HashTableSinkDesc.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/MapJoinDesc.java&lt;/p&gt;</comment>
                            <comment id="13145670" author="namit" created="Mon, 7 Nov 2011 18:19:21 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13146093" author="namit" created="Tue, 8 Nov 2011 05:53:22 +0000"  >&lt;p&gt;Committed. Thanks binlijin&lt;/p&gt;</comment>
                            <comment id="13146227" author="hudson" created="Tue, 8 Nov 2011 11:40:29 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1067 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1067/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1067/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2466&quot; title=&quot;mapjoin_subquery  dump small table (mapjoin table) to the same file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2466&quot;&gt;&lt;del&gt;HIVE-2466&lt;/del&gt;&lt;/a&gt; mapjoin_subquery dump small table (mapjoin table) to the same file&lt;br/&gt;
(binlijin via namit)&lt;/p&gt;

&lt;p&gt;namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1199117&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1199117&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/data/files/x.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/y.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/z.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableSinkOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/MapJoinOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/MapredLocalTask.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinProcessor.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/GenMRSkewJoinProcessor.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/HashTableSinkDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/MapJoinDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/mapjoin_subquery2.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/mapjoin_subquery2.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12502717" name="ASF.LICENSE.NOT.GRANTED--D285.1.patch" size="58498" author="phabricator@reviews.facebook.net" created="Mon, 7 Nov 2011 04:12:52 +0000"/>
                            <attachment id="12502778" name="ASF.LICENSE.NOT.GRANTED--D285.2.patch" size="25272" author="phabricator@reviews.facebook.net" created="Mon, 7 Nov 2011 18:10:52 +0000"/>
                            <attachment id="12498726" name="hive-2466.1.patch" size="9263" author="binlijin" created="Wed, 12 Oct 2011 10:08:14 +0000"/>
                            <attachment id="12500435" name="hive-2466.2.patch" size="22705" author="binlijin" created="Mon, 24 Oct 2011 13:02:16 +0000"/>
                            <attachment id="12500620" name="hive-2466.3.patch" size="25129" author="binlijin" created="Tue, 25 Oct 2011 05:44:06 +0000"/>
                            <attachment id="12502730" name="hive-2466.4.patch" size="25851" author="binlijin" created="Mon, 7 Nov 2011 06:43:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35768</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 3 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lk4n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123911</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>