<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:33:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-10569] Hive CLI gets stuck when hive.exec.parallel=true; and some exception happens during SessionState.start</title>
                <link>https://issues.apache.org/jira/browse/HIVE-10569</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;_&#24378;&#35843;&#25991;&#26412;_The CLI gets stuck in the loop in &lt;a href=&quot;https://github.com/apache/hive/blob/release-1.1.0/ql/src/java/org/apache/hadoop/hive/ql/DriverContext.java#L108&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;DriverContext.pollFinished &lt;/a&gt; when some &lt;tt&gt;TaskRunner&lt;/tt&gt; which has completed has not been marked as non-running.&lt;br/&gt;
This can happen when there is exception in &lt;a href=&quot;https://github.com/apache/hive/blob/release-1.1.0/ql/src/java/org/apache/hadoop/hive/ql/exec/TaskRunner.java#L74&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;SessionState.start &lt;/a&gt; which is called from &lt;tt&gt;TaskRunner.run&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;This happened with us when we were running with &lt;tt&gt;hive.exec.parallel=true&lt;/tt&gt;, &lt;tt&gt;hive.execution.engine=tez&lt;/tt&gt; and Tez wasn&apos;t correctly setup.&lt;br/&gt;
In this case the CLI printed the exception and then got hung (No prompt.)&lt;/p&gt;

&lt;p&gt;A simple fix is to call &lt;tt&gt;result.setRunning(false);&lt;/tt&gt; in the &lt;tt&gt;finally&lt;/tt&gt; block of &lt;tt&gt;TaskRunner.run&lt;/tt&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12826485">HIVE-10569</key>
            <summary>Hive CLI gets stuck when hive.exec.parallel=true; and some exception happens during SessionState.start</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ragarwal">Rohit Agarwal</assignee>
                                    <reporter username="ragarwal">Rohit Agarwal</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 May 2015 01:42:32 +0000</created>
                <updated>Tue, 3 Aug 2021 14:13:22 +0000</updated>
                            <resolved>Wed, 20 May 2015 04:46:09 +0000</resolved>
                                    <version>0.13.1</version>
                    <version>1.1.0</version>
                    <version>1.2.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14523614" author="ragarwal" created="Fri, 1 May 2015 18:33:46 +0000"  >&lt;p&gt;To reproduce this hang, you can follow these steps:&lt;br/&gt;
1. Run hadoop in distributed or pseudodistributed mode. (We were running hadoop-2.6.0 on our clusters when I first saw this. I was able to reproduce this in the pseudodistributed mode but not in the local mode.)&lt;br/&gt;
2. Install hive. (I was able to reproduce it on 0.13.1 and 1.1.0)&lt;br/&gt;
3. Install tez jars in the hadoop classpath (but don&apos;t setup tez.lib.uris - because we want SessionState.start to throw an exception.)&lt;br/&gt;
4. Run hive&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;set hive.exec.parallel=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
set hive.execution.engine=tez;
create table sometable(somecol INT);
select count(*) from sometable;  --&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; query will hang after printing an exception. With the attached patch, we will get the prompt back.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14527298" author="ragarwal" created="Mon, 4 May 2015 21:04:42 +0000"  >&lt;p&gt;Can someone review this?&lt;/p&gt;</comment>
                            <comment id="14544729" author="apivovarov" created="Fri, 15 May 2015 01:23:30 +0000"  >&lt;p&gt;I tried this with hive-0.13.1. The query works fine for me&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; set hive.exec.parallel=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
hive&amp;gt; set hive.execution.engine=tez;
hive&amp;gt; create table sometable(somecol INT);
OK
Time taken: 3.363 seconds

hive&amp;gt; select count(*) from sometable;
Query ID = myapp_20150514182020_ac958b79-4939-4092-a1b7-4bf58036dca5
Total jobs = 1
Launching Job 1 out of 1


Status: Running (application id: application_1431616132488_3229)

Map 1: -/-	Reducer 2: 0/1	
Map 1: -/-	Reducer 2: 0/1	
Map 1: -/-	Reducer 2: 0/1	
Map 1: -/-	Reducer 2: 1/1	
Status: Finished successfully
OK
0
Time taken: 14.551 seconds, Fetched: 1 row(s)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14544737" author="ragarwal" created="Fri, 15 May 2015 01:26:28 +0000"  >&lt;p&gt;It will work fine if tez is configured properly - if tez is not configured properly, instead of printing an exception and showing the prompt (so that I can run another query) - it prints an exception and gets stuck (no prompt.)&lt;/p&gt;</comment>
                            <comment id="14551266" author="ashutoshc" created="Tue, 19 May 2015 21:31:02 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14551805" author="ashutoshc" created="Wed, 20 May 2015 04:46:09 +0000"  >&lt;p&gt;Pushed to master. Thanks, Rohit!&lt;/p&gt;</comment>
                            <comment id="14551806" author="ashutoshc" created="Wed, 20 May 2015 04:50:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ragarwal&quot; class=&quot;user-hover&quot; rel=&quot;ragarwal&quot;&gt;ragarwal&lt;/a&gt; If you are enabling exec.parallel in your environment you might also get hit by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-10404&quot; title=&quot;hive.exec.parallel=true causes &amp;quot;out of sequence response&amp;quot; and SocketTimeoutException: Read timed out&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-10404&quot;&gt;HIVE-10404&lt;/a&gt; so you may want to tackle that one too.&lt;/p&gt;</comment>
                            <comment id="14551829" author="ragarwal" created="Wed, 20 May 2015 05:19:24 +0000"  >&lt;p&gt;Thank you for committing this &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;We have done some work around cleaning up non-threadsafe code in Hive, will ask around to see if &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-10404&quot; title=&quot;hive.exec.parallel=true causes &amp;quot;out of sequence response&amp;quot; and SocketTimeoutException: Read timed out&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-10404&quot;&gt;HIVE-10404&lt;/a&gt; can be a problem for us. Thanks for the heads up!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12729694" name="HIVE-10569.patch" size="433" author="ragarwal" created="Fri, 1 May 2015 01:43:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 27 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2e65z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>