<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 17:55:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-1124] CREATE VIEW should expand the query text consistently</title>
                <link>https://issues.apache.org/jira/browse/HIVE-1124</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;We should expand the omitted alias in the same way in &quot;select&quot; and in &quot;group by&quot;.&lt;/p&gt;

&lt;p&gt;Hive &quot;Group By&quot; recognize &quot;group by&quot; expressions by comparing the literal string.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; create view zshao_view as select d, count(1) as cnt from zshao_tt group by d;
OK
Time taken: 0.286 seconds
hive&amp;gt; select * from zshao_view;
FAILED: Error in semantic analysis: line 1:7 Expression Not In Group By Key d in definition of VIEW zshao_view [
select d, count(1) as `cnt` from `zshao_tt` group by `zshao_tt`.`d`
] used as zshao_view at line 1:14
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


</description>
                <environment></environment>
        <key id="12455022">HIVE-1124</key>
            <summary>CREATE VIEW should expand the query text consistently</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jvs">John Sichi</assignee>
                                    <reporter username="zshao">Zheng Shao</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 Feb 2010 08:26:37 +0000</created>
                <updated>Sat, 17 Dec 2011 00:03:25 +0000</updated>
                            <resolved>Thu, 4 Feb 2010 19:43:54 +0000</resolved>
                                    <version>0.6.0</version>
                                    <fixVersion>0.6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12829312" author="jvs" created="Wed, 3 Feb 2010 23:03:18 +0000"  >&lt;p&gt;The problem turned out to be with the way we resolve common subexpressions for matching expressions in the SELECT list and GROUP BY.  As soon as we saw the match, we were skipping over the SELECT item subtree without performing any translations, leading to the inconsistency later on when the view was referenced.&lt;/p&gt;

&lt;p&gt;The fix in this patch is a bit involved, since I had to make the UnparseTranslator capable of copying the translations for the common subexpressions.&lt;/p&gt;

&lt;p&gt;I have not yet run through all tests yet, but the patch is available for review now.&lt;/p&gt;</comment>
                            <comment id="12829367" author="jvs" created="Thu, 4 Feb 2010 01:24:04 +0000"  >&lt;p&gt;Ran through all tests successfully.&lt;/p&gt;</comment>
                            <comment id="12829369" author="zshao" created="Thu, 4 Feb 2010 01:26:34 +0000"  >&lt;p&gt;Patch line 993:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;-        ColumnInfo paraExprInfo = groupByInputRowResolver.get(&quot;&quot;, text);
+        ColumnInfo paraExprInfo = groupByInputRowResolver.get(&quot;&quot;, entry.getKey());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Shall we use getExpression?&lt;/p&gt;

&lt;p&gt;Otherwise it looks good.&lt;/p&gt;</comment>
                            <comment id="12829386" author="jvs" created="Thu, 4 Feb 2010 01:56:29 +0000"  >&lt;p&gt;Updated patch with Zheng&apos;s suggestion.  (I had left two calls to get(&quot;&quot;) unchanged because I wasn&apos;t sure how the key/value pairs in the aggregation map were being constucted, but it looks like the text and ASTNode are already 1-to-1 there.)&lt;/p&gt;</comment>
                            <comment id="12829395" author="zshao" created="Thu, 4 Feb 2010 02:23:00 +0000"  >&lt;p&gt;+1. Will test and commit.&lt;/p&gt;</comment>
                            <comment id="12829471" author="zshao" created="Thu, 4 Feb 2010 06:18:50 +0000"  >&lt;p&gt;Can you make the query result deterministic by adding an &quot;order by&quot; at the end? Otherwise the tests might fail.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    [junit] diff -a -I file: -I /tmp/ -I invalidscheme: -I lastUpdateTime -I lastAccessTime -I owner -I transient_lastDdlTime /data/users/zshao/hadoop_hive_trunk/.ptest_0/build/ql/test/logs\
/clientpositive/create_view.q.out /data/users/zshao/hadoop_hive_trunk/.ptest_0/ql/src/test/results/clientpositive/create_view.q.out
    [junit] 869d868
    [junit] &amp;lt; 401       5
    [junit] 871,873c870
    [junit] &amp;lt; 489       4
    [junit] &amp;lt; 169       4
    [junit] &amp;lt; 277       4
    [junit] ---
    [junit] &amp;gt; 401       5
    [junit] 875a873,875
    [junit] &amp;gt; 277       4
    [junit] &amp;gt; 489       4
    [junit] &amp;gt; 169       4
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12829706" author="jvs" created="Thu, 4 Feb 2010 19:05:43 +0000"  >&lt;p&gt;Whoops, I had an ORDER BY, but only a subset of the full key.&lt;/p&gt;</comment>
                            <comment id="12829707" author="jvs" created="Thu, 4 Feb 2010 19:06:08 +0000"  >&lt;p&gt;.3.patch fixes the ORDER BY.&lt;/p&gt;</comment>
                            <comment id="12829734" author="zshao" created="Thu, 4 Feb 2010 19:43:54 +0000"  >&lt;p&gt;Committed. Thanks John!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12442500">HIVE-972</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12434724" name="HIVE-1124.1.patch" size="77764" author="jvs" created="Wed, 3 Feb 2010 23:03:18 +0000"/>
                            <attachment id="12434771" name="HIVE-1124.2.patch" size="78340" author="jvs" created="Thu, 4 Feb 2010 01:56:29 +0000"/>
                            <attachment id="12434859" name="HIVE-1124.3.patch" size="78345" author="jvs" created="Thu, 4 Feb 2010 19:05:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73086</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ldiv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122841</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>