<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 17:53:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-734] problem in dealing with null</title>
                <link>https://issues.apache.org/jira/browse/HIVE-734</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;This command fails with the following error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive/bin/hive -e &lt;span class=&quot;code-quote&quot;&gt;&quot;INSERT OVERWRITE LOCAL DIRECTORY &lt;span class=&quot;code-quote&quot;&gt;&apos;abc&apos;&lt;/span&gt; select &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; from zshao_tt&quot;&lt;/span&gt;
FAILED: Error in semantic analysis:
java.lang.RuntimeException: Internal error: Cannot find ObjectInspector &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; VOID
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When &apos;null&apos; is replaced by &apos;&apos; it works.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12432443">HIVE-734</key>
            <summary>problem in dealing with null</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nzhang">Ning Zhang</assignee>
                                    <reporter username="zshao">Zheng Shao</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Aug 2009 21:00:56 +0000</created>
                <updated>Sat, 17 Dec 2011 00:07:23 +0000</updated>
                            <resolved>Tue, 11 Aug 2009 23:48:44 +0000</resolved>
                                                    <fixVersion>0.4.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12740257" author="athusoo" created="Thu, 6 Aug 2009 21:36:18 +0000"  >&lt;p&gt;select null from null from zshao_tt ?? or is it select null from zshao_tt.&lt;/p&gt;
</comment>
                            <comment id="12740258" author="zshao" created="Thu, 6 Aug 2009 21:38:34 +0000"  >&lt;p&gt;corrected. it&apos;s &quot;select null from zshao_tt&quot;&lt;/p&gt;</comment>
                            <comment id="12740277" author="nzhang" created="Thu, 6 Aug 2009 22:10:10 +0000"  >&lt;p&gt;Thanks guys! I figured that out too. Debugging now.&lt;/p&gt;</comment>
                            <comment id="12740353" author="nzhang" created="Fri, 7 Aug 2009 01:35:35 +0000"  >&lt;p&gt;The error is threw during semantic analysis where the parser try to instantiate an ObjectInspector for type &quot;void&quot; (corresponding to null). &lt;/p&gt;

&lt;p&gt;The following similar query succeeded:&lt;/p&gt;

&lt;p&gt;select 2 from zshao_tt;&lt;/p&gt;

&lt;p&gt;since the semantic analyzer is able to deduct type (int) from the constant 2. &lt;/p&gt;

&lt;p&gt;Since null can also be treated as a constant, I think we need to write an ObjectInspector for its type (void) too. And the object inspector will always return null for each row. &lt;/p&gt;</comment>
                            <comment id="12740358" author="zshao" created="Fri, 7 Aug 2009 01:41:42 +0000"  >&lt;p&gt;+1 on the idea. We have WritableVoidObjectInspector, JavaVoidObjectInspector etc but none are actually implemented or used.&lt;br/&gt;
Can we use JavaVoidObjectInspector for null constant? We probably need to modify ObjectInspectorConverters to allow conversion from void type to any type as well.&lt;/p&gt;</comment>
                            <comment id="12740388" author="nzhang" created="Fri, 7 Aug 2009 03:54:39 +0000"  >&lt;p&gt;Thanks for the pointer Zheng. We certainly can use JavaVoidObjecInspector for NULL. However it turns out NULL is more complicated than what it sounds like (see &lt;a href=&quot;http://en.wikipedia.org/wiki/Null_(SQL&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://en.wikipedia.org/wiki/Null_(SQL&lt;/a&gt;) ). NULL has to be handled not only in this simple select cause, but also in much more complex cases in the where-clause and joins. Let&apos;s have a talk.&lt;/p&gt;
</comment>
                            <comment id="12740392" author="zshao" created="Fri, 7 Aug 2009 04:11:51 +0000"  >&lt;p&gt;We do handle NULL in the WHERE clause and &quot;AND&quot;, &quot;OR&quot; functions using the 3-value booleans.  I am not sure whether we ignore NULL in join/group-by but that seems easy enough to do.&lt;br/&gt;
Do you have a specific example that the current Hive code breaks?&lt;/p&gt;</comment>
                            <comment id="12740406" author="nzhang" created="Fri, 7 Aug 2009 05:16:55 +0000"  >&lt;p&gt;I wasn&apos;t able to get an example in HIVE. I tried to insert NULL to a table by modifying the test query input4_cb_delim.q (actually by only modifying the input data to be &lt;/p&gt;

&lt;p&gt;&amp;lt;value1&amp;gt;\002\012&lt;br/&gt;
\002&amp;lt;value2&amp;gt;\012&lt;/p&gt;

&lt;p&gt;and run the query&lt;/p&gt;

&lt;p&gt;select * from input4_cb where key is not null;&lt;/p&gt;

&lt;p&gt;and both rows are returned. So either the NULL values are not inserted correctly, or the evaluation is not correct about NULL.&lt;/p&gt;</comment>
                            <comment id="12740446" author="zshao" created="Fri, 7 Aug 2009 08:14:34 +0000"  >&lt;p&gt;With LazySimpleSerDe (the default), we represent NULL by two bytes: &quot;\&quot; and &quot;N&quot;. This is in sync with MySQL export format.&lt;br/&gt;
Can you try again with that?&lt;/p&gt;</comment>
                            <comment id="12740544" author="nzhang" created="Fri, 7 Aug 2009 13:29:40 +0000"  >&lt;p&gt;That&apos;s great! It works (and my test queries on NULL also works too). In this case I guess it is much simpler since what we need here is just the VOID type ObjectInspector. I&apos;ll working on it.&lt;/p&gt;</comment>
                            <comment id="12740650" author="nzhang" created="Fri, 7 Aug 2009 17:46:37 +0000"  >&lt;p&gt;BTW, I tried joins and it doesn&apos;t handle NULL semantics correctly. Here&apos;s the data and results:&lt;/p&gt;

&lt;p&gt;Table:&lt;/p&gt;

&lt;p&gt;Key       Value&lt;br/&gt;
-------     -------&lt;br/&gt;
NULL    325&lt;br/&gt;
18         NULL&lt;/p&gt;

&lt;p&gt;Query:&lt;/p&gt;

&lt;p&gt;select * from input4_cb a join input4_cb b on a.key = b.value;&lt;/p&gt;

&lt;p&gt;Result:&lt;/p&gt;

&lt;p&gt;NULL  325   18   NULL&lt;/p&gt;

&lt;p&gt;The correct result should be empty set.&lt;/p&gt;

&lt;p&gt;I guess the NULL vs. NULL comparison is incorrectly evaluated. &lt;/p&gt;</comment>
                            <comment id="12740773" author="nzhang" created="Fri, 7 Aug 2009 22:53:20 +0000"  >&lt;p&gt;added the JavaVoidObjectInspector support for LazySimpleSerDe. Will add the same support to other serdes. &lt;/p&gt;</comment>
                            <comment id="12740782" author="zshao" created="Fri, 7 Aug 2009 23:22:24 +0000"  >&lt;p&gt;Good finding! Let&apos;s fix the join bug on a separate JIRA. Can you open a jira on that?&lt;br/&gt;
I am not sure about why we need to add JavaVoidObjectInspector support to LazySimpleSerDe - data from SerDe already have types (from columns).  We only need to handle NULL that user specified in the query. Thoughts?&lt;/p&gt;</comment>
                            <comment id="12740834" author="nzhang" created="Sat, 8 Aug 2009 03:58:08 +0000"  >&lt;p&gt;In the failing query, there is no column corresponding to null (select null from tt), so the semantic analyzer doesn&apos;t know the type of the NULL, therefore it is VOID type. That&apos;s why JavaVoidObjectInspector needs to be created. It is the similar that in (select 2 from tt), An JavaIntegerObjectInspector is needed for the constant 2. &lt;/p&gt;</comment>
                            <comment id="12741582" author="zshao" created="Mon, 10 Aug 2009 21:59:58 +0000"  >&lt;p&gt;Discussed with Ning offline. SemanticAnalyzer.genFileSinkPlan() will be the place for the change - in case the target is a local/remote directory (instead of a table), when we create table column names and types, we should use string type if the input is a void type.  Later in the same function, we are using genConversionSelectOperator() to convert the column types.&lt;/p&gt;

&lt;p&gt;So ODBC/JDBC will see this column as string type. Raghu confirmed that MySQL is creating a table with a column typed &quot;BINARY(0)&quot; when running &quot;CREATE TABLE AS SELECT NULL, ...&quot; &lt;/p&gt;</comment>
                            <comment id="12741667" author="namit" created="Tue, 11 Aug 2009 02:16:40 +0000"  >&lt;p&gt;hive&amp;gt; select * from (select NULL from zshao_tt union all select 1 from zshao_tt)x;&lt;br/&gt;
select * from (select NULL from zshao_tt union all select 1 from zshao_tt)x;&lt;br/&gt;
FAILED: Error in semantic analysis: Schema of both sides of union should match: Column _c0 is of type void on first table and type int on second table&lt;/p&gt;



&lt;p&gt;Do you want to handle this also in this patch, or file a new jira for above ?&lt;/p&gt;</comment>
                            <comment id="12741956" author="nzhang" created="Tue, 11 Aug 2009 16:49:42 +0000"  >&lt;p&gt;Namit, thanks for the comments! I have started a new JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-747&quot; title=&quot;void type (null column) cannot be UNIONed with other type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-747&quot;&gt;HIVE-747&lt;/a&gt; for that. I&apos;ll look at this one soon. &lt;/p&gt;</comment>
                            <comment id="12742114" author="nzhang" created="Tue, 11 Aug 2009 22:59:23 +0000"  >&lt;p&gt;fix attached.&lt;/p&gt;</comment>
                            <comment id="12742115" author="namit" created="Tue, 11 Aug 2009 23:11:07 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;looks good - will commit if the tests pass&lt;/p&gt;</comment>
                            <comment id="12742122" author="namit" created="Tue, 11 Aug 2009 23:48:44 +0000"  >&lt;p&gt;Committed. Thanks Ning&lt;/p&gt;</comment>
                            <comment id="12742129" author="nzhang" created="Wed, 12 Aug 2009 00:09:17 +0000"  >&lt;p&gt;Cool!&lt;/p&gt;

&lt;p&gt;Thank you very much!&lt;/p&gt;

&lt;p&gt;Ning&lt;/p&gt;

</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="12432589">HIVE-741</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12416262" name="734.patch" size="4382" author="nzhang" created="Tue, 11 Aug 2009 22:59:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73335</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 16 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lbgv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122508</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>