<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 17:58:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-2260] ExecDriver::addInputPaths should pass the table properties to the record writer</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2260</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Currently when ExecDriver encounters a non-existent partition, it creates an empty file so that the query will be valid (and return 0 results).  However, when it does this and calls &lt;tt&gt;getHiveRecordWriter()&lt;/tt&gt;, it creates a new instance of Properties, rather than providing the Properties associated with the table.&lt;/p&gt;

&lt;p&gt;This causes RecordWriters that pull information from the table through the Properties to fail (such as &lt;a href=&quot;http://bit.ly/iwEQzJ&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Haivvreo&lt;/a&gt;).  The RecordWriter should be provided the table&apos;s Properties, as it is in all other cases where it&apos;s called.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12512906">HIVE-2260</key>
            <summary>ExecDriver::addInputPaths should pass the table properties to the record writer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jghoman">Jakob Homan</assignee>
                                    <reporter username="jghoman">Jakob Homan</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Jul 2011 22:42:17 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:33 +0000</updated>
                            <resolved>Sat, 16 Jul 2011 15:28:56 +0000</resolved>
                                    <version>0.7.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13060179" author="jghoman" created="Tue, 5 Jul 2011 22:44:06 +0000"  >&lt;p&gt;Patch takes the Properties from the table/partition and passes it to the RecordWriter.  This fixes the issue Haivvreo runs into.  &lt;/p&gt;

&lt;p&gt;The patch doesn&apos;t include a unit test, since this is pretty far into the guts of ExecDriver.  I&apos;d be happy to write one up and introduce Mockito, which I think is the only reasonable way of getting to this code path, if others think it&apos;s worthwhile.&lt;/p&gt;</comment>
                            <comment id="13060222" author="jiraposter@reviews.apache.org" created="Wed, 6 Jul 2011 00:46:16 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1014/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/1014/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Currently when ExecDriver encounters a non-existent partition, it creates an empty file so that the query will be valid (and return 0 results). However, when it does this and calls getHiveRecordWriter(), it creates a new instance of Properties, rather than providing the Properties associated with the table.&lt;/p&gt;

&lt;p&gt;This causes RecordWriters that pull information from the table through the Properties to fail (such as Haivvreo). The RecordWriter should be provided the table&apos;s Properties, as it is in all other cases where it&apos;s called.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2260&quot; title=&quot;ExecDriver::addInputPaths should pass the table properties to the record writer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2260&quot;&gt;&lt;del&gt;HIVE-2260&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2260&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2260&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1014/diff&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/1014/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jakob&lt;/p&gt;
</comment>
                            <comment id="13060756" author="jghoman" created="Wed, 6 Jul 2011 18:46:46 +0000"  >&lt;p&gt;Tests pass except filter_join_breaktask, which failed once during the full test run, but I&apos;ve not been able to re-produce it again.  This is ready for review.&lt;/p&gt;</comment>
                            <comment id="13063740" author="jiraposter@reviews.apache.org" created="Tue, 12 Jul 2011 06:18:00 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1014/#review1036&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/1014/#review1036&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;Changes look good. &lt;br/&gt;
Is it possible to add a testcase? If not, can you update the jira how it is tested?&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Amareshwari&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-07-06 00:45:12, Jakob Homan wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/1014/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/1014/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-07-06 00:45:12)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Currently when ExecDriver encounters a non-existent partition, it creates an empty file so that the query will be valid (and return 0 results). However, when it does this and calls getHiveRecordWriter(), it creates a new instance of Properties, rather than providing the Properties associated with the table.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This causes RecordWriters that pull information from the table through the Properties to fail (such as Haivvreo). The RecordWriter should be provided the table&apos;s Properties, as it is in all other cases where it&apos;s called.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2260&quot; title=&quot;ExecDriver::addInputPaths should pass the table properties to the record writer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2260&quot;&gt;&lt;del&gt;HIVE-2260&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2260&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2260&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1014/diff&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/1014/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Jakob&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13064916" author="jghoman" created="Wed, 13 Jul 2011 22:29:08 +0000"  >&lt;p&gt;resonding to RB comment.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Is it possible to add a testcase? If not, can you update the jira how it is tested?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Adding a testcase isn&apos;t possible without something like Mockito, since this is buried deep within the guts of a private method that calls many methods and creates new instances of classes from calls to getClass().  Even then it would take about a dozen mocks and be amazingly fragile.  This code is certainly ripe for refactoring to ease testing.&lt;/p&gt;

&lt;p&gt;This was manually tested (and deployed to our cluster).  The manual test is to prune on a non-existent partition while using an input format like Haivvreo&apos;s, which makes use of the Properties instance.  Without the patch, the call fails.  With the patch, it succeeds with the behavior as described in &lt;tt&gt;ExecDriver.java&lt;/tt&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;ExecDriver&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;// If the query references non-existent partitions
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// We need to add a empty file, it is not acceptable to change the
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; tree
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// Consider the query:
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// select * from (select count(1) from T union all select count(1) from
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// T2) x;
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// If T is empty and T2 contains 100 rows, the user expects: 0, 100 (2
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// rows)&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="13065758" author="jghoman" created="Fri, 15 Jul 2011 08:19:35 +0000"  >&lt;p&gt;Is there anything else that needs to be done to get a code review or commit on this patch?&lt;/p&gt;</comment>
                            <comment id="13066113" author="nzhang" created="Fri, 15 Jul 2011 18:27:21 +0000"  >&lt;p&gt;+1. Looks good to me. Will commit if tests pass. &lt;/p&gt;</comment>
                            <comment id="13066444" author="nzhang" created="Sat, 16 Jul 2011 15:28:56 +0000"  >&lt;p&gt;Committed. Thanks Jakob!&lt;/p&gt;</comment>
                            <comment id="13066511" author="hudson" created="Sat, 16 Jul 2011 19:26:48 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #830 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/830/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/830/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2260&quot; title=&quot;ExecDriver::addInputPaths should pass the table properties to the record writer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2260&quot;&gt;&lt;del&gt;HIVE-2260&lt;/del&gt;&lt;/a&gt;. ExecDriver::addInputPaths should pass the table properties to the record writer (Jakob Homan via Ning Zhang)&lt;/p&gt;

&lt;p&gt;nzhang : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1147436&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1147436&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12485344" name="HIVE-2260.patch" size="1518" author="jghoman" created="Tue, 5 Jul 2011 22:44:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37471</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 19 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05ikf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30105</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>