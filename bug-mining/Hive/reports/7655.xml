<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:17:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-23593] Schemainit fails with NoSuchFieldError </title>
                <link>https://issues.apache.org/jira/browse/HIVE-23593</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;the issue comes from a calcite related class ; it&apos;s very interesting because ql already has a shaded calcite....&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: java.lang.NoSuchFieldError: operands
        at org.apache.hadoop.hive.ql.optimizer.calcite.translator.ExprNodeConverter.visitCall(ExprNodeConverter.java:192) ~[hive-exec-4.0.0-SNAPSHOT.jar:4.0.0-SNAPSHOT]
        at org.apache.hadoop.hive.ql.optimizer.calcite.translator.ExprNodeConverter.visitCall(ExprNodeConverter.java:98) ~[hive-exec-4.0.0-SNAPSHOT.jar:4.0.0-SNAPSHOT]
        at org.apache.calcite.rex.RexCall.accept(RexCall.java:191) ~[calcite-core-1.21.0.jar:1.21.0]
        at org.apache.hadoop.hive.ql.optimizer.calcite.HiveRexExecutorImpl.reduce(HiveRexExecutorImpl.java:56) ~[hive-exec-4.0.0-SNAPSHOT.jar:4.0.0-SNAPSHOT]
        at org.apache.hadoop.hive.ql.parse.type.HiveFunctionHelper.foldExpression(HiveFunctionHelper.java:544) ~[hive-exec-4.0.0-SNAPSHOT.jar:4.0.0-SNAPSHOT]
        at org.apache.hadoop.hive.ql.parse.type.HiveFunctionHelper.createConstantObjectInspector(HiveFunctionHelper.java:452) ~[hive-exec-4.0.0-SNAPSHOT.jar:4.0.0-SNAPSHOT]
        at org.apache.hadoop.hive.ql.parse.type.HiveFunctionHelper.createObjectInspector(HiveFunctionHelper.java:435) ~[hive-exec-4.0.0-SNAPSHOT.jar:4.0.0-SNAPSHOT]
        at org.apache.hadoop.hive.ql.parse.type.HiveFunctionHelper.getReturnType(HiveFunctionHelper.java:124) ~[hive-exec-4.0.0-SNAPSHOT.jar:4.0.0-SNAPSHOT]
        at org.apache.hadoop.hive.ql.parse.type.RexNodeExprFactory.createFuncCallExpr(RexNodeExprFactory.java:647) ~[hive-exec-4.0.0-SNAPSHOT.jar:4.0.0-SNAPSHOT]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13308997">HIVE-23593</key>
            <summary>Schemainit fails with NoSuchFieldError </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kgyrtkirk">Zoltan Haindrich</assignee>
                                    <reporter username="kgyrtkirk">Zoltan Haindrich</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 2 Jun 2020 17:03:35 +0000</created>
                <updated>Thu, 17 Nov 2022 08:48:17 +0000</updated>
                            <resolved>Fri, 19 Jun 2020 10:30:55 +0000</resolved>
                                                    <fixVersion>4.0.0-alpha-1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="2400">40m</timespent>
                                <comments>
                            <comment id="17124061" author="kgyrtkirk" created="Tue, 2 Jun 2020 17:04:02 +0000"  >&lt;p&gt;the dist package also contains a calcite-core-1.21.0.jar - removing that makes things work better...&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
rm packaging/target/apache-hive-4.0.0-SNAPSHOT-bin/apache-hive-4.0.0-SNAPSHOT-bin/lib/calcite-core-1.21.0.jar
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17140323" author="kgyrtkirk" created="Fri, 19 Jun 2020 08:06:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pvary&quot; class=&quot;user-hover&quot; rel=&quot;pvary&quot;&gt;pvary&lt;/a&gt; could you please take a look?&lt;/p&gt;</comment>
                            <comment id="17140417" author="kgyrtkirk" created="Fri, 19 Jun 2020 10:30:55 +0000"  >&lt;p&gt;pushed to master. Thank you Peter for reviewing the changes!&lt;/p&gt;</comment>
                            <comment id="17147597" author="ayushtkn" created="Mon, 29 Jun 2020 07:40:46 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kgyrtkirk&quot; class=&quot;user-hover&quot; rel=&quot;kgyrtkirk&quot;&gt;kgyrtkirk&lt;/a&gt;, we too faced the same issue, while verifying &lt;tt&gt;Hadoop-3.3.0&lt;/tt&gt; release on &lt;tt&gt;ARM&lt;/tt&gt;.&lt;br/&gt;
This happens due to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-22126&quot; title=&quot;hive-exec packaging should shade guava&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-22126&quot;&gt;&lt;del&gt;HIVE-22126&lt;/del&gt;&lt;/a&gt;, When &lt;tt&gt;calcite-core&lt;/tt&gt; got shaded as well along with &lt;tt&gt;guava&lt;/tt&gt;, but there guava was reallocated, but not &lt;tt&gt;calcite-core&lt;/tt&gt; which was included later. As you said removing &lt;tt&gt;calcite-core&lt;/tt&gt; from &lt;tt&gt;lib&lt;/tt&gt; works since the only class that is able to load is from &lt;tt&gt;hive-exec&lt;/tt&gt; jar, This makes things work here.&lt;br/&gt;
But if some one(client plugins/applications) is having &lt;tt&gt;calcite-core&lt;/tt&gt; in its classpath  for other reasons, or it tends to be used later even somewhere other than where shaded. This issue will surface again.&lt;br/&gt;
A probable addition is we reallocate the &lt;tt&gt;calcite-core&lt;/tt&gt; classes as well, which is done for gauva and others in Hive. This is something we follow in Hadoop too. So, as presence of &lt;tt&gt;calcite-core&lt;/tt&gt; or addition later doesn&apos;t bother.&lt;br/&gt;
We tried reallocating in the pom.xml the &lt;tt&gt;calcite-core&lt;/tt&gt; and that seems to work for us. That is just 2-3 lines change.&lt;/p&gt;

&lt;p&gt;Let me know, your thoughts on this, if you don&apos;t have any issues, will raise a follow up JIRA to reallocate as well. Thanx &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vinayakumarb&quot; class=&quot;user-hover&quot; rel=&quot;vinayakumarb&quot;&gt;vinayakumarb&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chinnaraol&quot; class=&quot;user-hover&quot; rel=&quot;chinnaraol&quot;&gt;chinnaraol&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17147603" author="kgyrtkirk" created="Mon, 29 Jun 2020 07:59:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ayushtkn&quot; class=&quot;user-hover&quot; rel=&quot;ayushtkn&quot;&gt;ayushtkn&lt;/a&gt; thank you for the details; I&apos;ve also tried to relocate calcite-core as well in ql/pom.xml but it didn&apos;t worked for me - some issues kept surfacing.&lt;br/&gt;
maybe I&apos;ve made some typo (or missed something) ?&lt;br/&gt;
this ticket also added things to make sure that we at least don&apos;t package a release which out-of-the-box fails with this kind of excpetion.&lt;br/&gt;
I guess you had a better approach fixing the shading stuff - could you open a jira and submit your patch?&lt;/p&gt;</comment>
                            <comment id="17147615" author="ayushtkn" created="Mon, 29 Jun 2020 08:29:24 +0000"  >&lt;p&gt;Thanx &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kgyrtkirk&quot; class=&quot;user-hover&quot; rel=&quot;kgyrtkirk&quot;&gt;kgyrtkirk&lt;/a&gt; for the response. Have raised &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-23772&quot; title=&quot;Relocate calcite-core to prevent NoSuchFiledError&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-23772&quot;&gt;HIVE-23772&lt;/a&gt; with the changes.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310060">
                    <name>Container</name>
                                            <outwardlinks description="contains">
                                        <issuelink>
            <issuekey id="13311933">HIVE-23713</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13345116">HIVE-24512</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 20 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ffko:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>