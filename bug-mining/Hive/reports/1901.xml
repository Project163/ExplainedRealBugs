<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:16:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-6382] PATCHED_BLOB encoding in ORC will corrupt data in some cases</title>
                <link>https://issues.apache.org/jira/browse/HIVE-6382</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;In PATCHED_BLOB encoding (added in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4123&quot; title=&quot;The RLE encoding for ORC can be improved&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4123&quot;&gt;&lt;del&gt;HIVE-4123&lt;/del&gt;&lt;/a&gt;), gapVsPatchList is an array of long that stores gap (g) between the values that are patched and the patch value (p). The maximum distance of gap can be 511 that require 8 bits to encode. And patch values can take more than 56 bits. When patch values take more than 56 bits, p + g will become &amp;gt; 64 bits which cannot be packed to a long. This will result in data corruption under the case where patch values are &amp;gt; 56 bits. &lt;/p&gt;

&lt;p&gt;Stack trace will look like:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Caused by: java.lang.ArrayIndexOutOfBoundsException: 3
at org.apache.hadoop.hive.ql.io.orc.RunLengthIntegerWriterV2.preparePatchedBlob(RunLengthIntegerWriterV2.java:593)
at org.apache.hadoop.hive.ql.io.orc.RunLengthIntegerWriterV2.determineEncoding(RunLengthIntegerWriterV2.java:541)
at org.apache.hadoop.hive.ql.io.orc.RunLengthIntegerWriterV2.write(RunLengthIntegerWriterV2.java:746)
at org.apache.hadoop.hive.ql.io.orc.WriterImpl$IntegerTreeWriter.write(WriterImpl.java:744)
at org.apache.hadoop.hive.ql.io.orc.WriterImpl$StructTreeWriter.write(WriterImpl.java:1320)
at org.apache.hadoop.hive.ql.io.orc.WriterImpl.addRow(WriterImpl.java:1849)
at org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat$OrcRecordWriter.write(OrcOutputFormat.java:75)
at org.apache.hadoop.hive.ql.exec.FileSinkOperator.processOp(FileSinkOperator.java:638)
at org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:501)
at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:842)
at org.apache.hadoop.hive.ql.exec.SelectOperator.processOp(SelectOperator.java:88)
at org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:501)
at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:842)
at org.apache.hadoop.hive.ql.exec.ExtractOperator.processOp(ExtractOperator.java:45)
at org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:501)
at org.apache.hadoop.hive.ql.exec.mr.ExecReducer.reduce(ExecReducer.java:249)
... 7 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12693495">HIVE-6382</key>
            <summary>PATCHED_BLOB encoding in ORC will corrupt data in some cases</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="prasanth_j">Prasanth Jayachandran</assignee>
                                    <reporter username="prasanth_j">Prasanth Jayachandran</reporter>
                        <labels>
                            <label>orcfile</label>
                    </labels>
                <created>Thu, 6 Feb 2014 04:19:55 +0000</created>
                <updated>Thu, 31 Jul 2014 18:44:25 +0000</updated>
                            <resolved>Fri, 21 Feb 2014 02:48:36 +0000</resolved>
                                    <version>0.13.0</version>
                                    <fixVersion>0.13.0</fixVersion>
                                    <component>Serializers/Deserializers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13893015" author="prasanth_j" created="Thu, 6 Feb 2014 04:22:39 +0000"  >&lt;p&gt;Initial version of patch.&lt;/p&gt;</comment>
                            <comment id="13893016" author="prasanth_j" created="Thu, 6 Feb 2014 04:24:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6347&quot; title=&quot;ZeroCopy read path for ORC RecordReader&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6347&quot;&gt;&lt;del&gt;HIVE-6347&lt;/del&gt;&lt;/a&gt; adds hive configuration to ORC reader interface. It is required for this patch to determine whether to skip corrupt data or throw exception.&lt;/p&gt;</comment>
                            <comment id="13893017" author="prasanth_j" created="Thu, 6 Feb 2014 04:25:32 +0000"  >&lt;p&gt;Still have to verify if this patch fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6369&quot; title=&quot;ORC Writer (int RLE v2) fails with ArrayIndexOutOfBounds&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6369&quot;&gt;&lt;del&gt;HIVE-6369&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13893019" author="prasanth_j" created="Thu, 6 Feb 2014 04:27:59 +0000"  >&lt;p&gt;Making it patch available for HIVE QA to run precommit tests.&lt;/p&gt;</comment>
                            <comment id="13893582" author="hiveqa" created="Thu, 6 Feb 2014 17:51:58 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12627290/HIVE-6382.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12627290/HIVE-6382.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 5039 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1220/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1220/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1220/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1220/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12627290&lt;/p&gt;</comment>
                            <comment id="13893785" author="prasanth_j" created="Thu, 6 Feb 2014 20:44:19 +0000"  >&lt;p&gt;In this patch, added a safeguard length of 1 to gap and patch list array to avoid off-by-one errors or throwing exception.&lt;/p&gt;</comment>
                            <comment id="13894006" author="hiveqa" created="Thu, 6 Feb 2014 23:56:57 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12627461/HIVE-6382.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12627461/HIVE-6382.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 5039 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1226/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1226/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1226/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1226/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12627461&lt;/p&gt;</comment>
                            <comment id="13906061" author="prasanth_j" created="Wed, 19 Feb 2014 20:52:42 +0000"  >&lt;p&gt;Added configuration to orc readers to support skipping of corrupted data.&lt;/p&gt;</comment>
                            <comment id="13906314" author="prasanth_j" created="Wed, 19 Feb 2014 23:55:13 +0000"  >&lt;p&gt;Addressed &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt;&apos;s review comments.&lt;/p&gt;</comment>
                            <comment id="13906359" author="sershe" created="Thu, 20 Feb 2014 00:24:14 +0000"  >&lt;p&gt;wrt 64 bits that&apos;s what I meant by relying on internals of that func... maybe it can check and throw assertion error if it is &amp;gt;56 but not 64... anyway that&apos;s nit.&lt;br/&gt;
Otherwise +1&lt;/p&gt;</comment>
                            <comment id="13906364" author="prasanth_j" created="Thu, 20 Feb 2014 00:29:44 +0000"  >&lt;p&gt;Gotcha! Fixed it in this patch.&lt;/p&gt;</comment>
                            <comment id="13906465" author="prasanth_j" created="Thu, 20 Feb 2014 01:45:20 +0000"  >&lt;p&gt;Earlier patch was not compiling clean as conf object of some orc reader interface was missing. Fixed it in this patch.&lt;/p&gt;</comment>
                            <comment id="13907067" author="hiveqa" created="Thu, 20 Feb 2014 15:35:07 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12629962/HIVE-6382.6.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12629962/HIVE-6382.6.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 5172 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_infer_bucket_sort_map_operators
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1425/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1425/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1425/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1425/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12629962&lt;/p&gt;</comment>
                            <comment id="13907252" author="prasanth_j" created="Thu, 20 Feb 2014 18:02:09 +0000"  >&lt;p&gt;The test failure does not seem to be related to this patch. &lt;/p&gt;</comment>
                            <comment id="13907895" author="hagleitn" created="Fri, 21 Feb 2014 02:48:36 +0000"  >&lt;p&gt;Committed to trunk. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=prasanth_j&quot; class=&quot;user-hover&quot; rel=&quot;prasanth_j&quot;&gt;prasanth_j&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="13965247" author="lefty@hortonworks.com" created="Thu, 10 Apr 2014 11:39:50 +0000"  >&lt;p&gt;For the record:  this adds the configuration parameter &lt;b&gt;hive.exec.orc.skip.corrupt.data&lt;/b&gt; to HiveConf.java and hive-default.xml.template.&lt;/p&gt;</comment>
                            <comment id="14049710" author="lefty@hortonworks.com" created="Wed, 2 Jul 2014 07:50:50 +0000"  >&lt;p&gt;&lt;b&gt;hive.exec.orc.skip.corrupt.data&lt;/b&gt; is documented in the wiki:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.exec.orc.skip.corrupt.data&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Configuration Properties &amp;#8211; hive.exec.orc.skip.corrupt.data &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12692598">HIVE-6347</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12683013">HIVE-5970</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12693195">HIVE-6369</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12627290" name="HIVE-6382.1.patch" size="12424" author="prasanth_j" created="Thu, 6 Feb 2014 04:22:39 +0000"/>
                            <attachment id="12627461" name="HIVE-6382.2.patch" size="12907" author="prasanth_j" created="Thu, 6 Feb 2014 20:44:19 +0000"/>
                            <attachment id="12629886" name="HIVE-6382.3.patch" size="33728" author="prasanth_j" created="Wed, 19 Feb 2014 20:52:42 +0000"/>
                            <attachment id="12629934" name="HIVE-6382.4.patch" size="33587" author="prasanth_j" created="Wed, 19 Feb 2014 23:55:13 +0000"/>
                            <attachment id="12629940" name="HIVE-6382.5.patch" size="33587" author="prasanth_j" created="Thu, 20 Feb 2014 00:29:44 +0000"/>
                            <attachment id="12629962" name="HIVE-6382.6.patch" size="62872" author="prasanth_j" created="Thu, 20 Feb 2014 01:45:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>372080</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 21 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1s4hb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>372385</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>