<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:27:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-29122] Vectorization - Support IGNORE NULLS for FIRST_VALUE and LAST_VALUE</title>
                <link>https://issues.apache.org/jira/browse/HIVE-29122</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Currently we get wrong results for FIRST_VALUE and LAST_VALUE functions with IGNORE NULLS when vectorization is enabled.&lt;/p&gt;

&lt;p&gt;Consider this table:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;CREATE TABLE window_double_test (
  id INT,
  double_col DOUBLE
);

INSERT INTO window_double_test VALUES
  (1, NULL),
  (2, NULL),
  (1, NULL),
  (1, NULL),
  (2, 25.5),
  (3, NULL),
  (6, 65.5),
  (2, NULL),
  (3, 32.5),
  (4, NULL),
  (3, 30.5),
  (5, 50.5),
  (4, 42.3),
  (5, NULL),
  (6, 65.2),
  (7, NULL),
  (NULL, 80.5),
  (NULL, NULL);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Non-vectorized:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;set hive.vectorized.execution.enabled=false;
SELECT id, double_col,
  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS first_double,
  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS last_double
FROM window_double_test;


id  double_col first_double last_double
1 NULL NULL NULL
1 NULL NULL NULL
1 NULL NULL NULL
2 NULL 25.5 25.5
2 25.5 25.5 25.5
2 NULL 25.5 25.5
3 NULL 25.5 32.5
3 30.5 25.5 32.5
3 32.5 25.5 32.5
4 NULL 25.5 42.3
4 42.3 25.5 42.3
5 50.5 25.5 50.5
5 NULL 25.5 50.5
6 65.2 25.5 65.5
6 65.5 25.5 65.5
7 NULL 25.5 65.5
NULL  NULL 25.5 80.5
NULL  80.5 25.5 80.5&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Vectorized:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;set hive.vectorized.execution.enabled=true;
SELECT id, double_col,
  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS first_double,
  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS last_double
FROM window_double_test;


id  double_col first_double last_double
1 NULL NULL NULL
1 NULL NULL NULL
1 NULL NULL NULL
2 NULL NULL NULL
2 25.5 NULL NULL
2 NULL NULL NULL
3 NULL NULL 32.5
3 30.5 NULL 32.5
3 32.5 NULL 32.5
4 NULL NULL 42.3
4 42.3 NULL 42.3
5 50.5 NULL NULL
5 NULL NULL NULL
6 65.2 NULL 65.5
6 65.5 NULL 65.5
7 NULL NULL NULL
NULL  NULL NULL 80.5
NULL  80.5 NULL 80.5&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We can see the differences for id = 2, for example. Similar results can also be seen for int and decimal columns too. We don&apos;t see the same for a String column as only LONG, DECIMAL, and DOUBLE are supported, as can be seen in Vectorizer#validatePTFOperator.&lt;/p&gt;

&lt;p&gt;There are other scenarios where it bypasses the Vectorizer, for example, if we explicitly use ROWS instead of the default RANGE, etc. Anything that skips vectorization produces correct results.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13625588">HIVE-29122</key>
            <summary>Vectorization - Support IGNORE NULLS for FIRST_VALUE and LAST_VALUE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="soumyakanti.das">Soumyakanti Das</assignee>
                                    <reporter username="soumyakanti.das">Soumyakanti Das</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 5 Aug 2025 23:59:21 +0000</created>
                <updated>Tue, 26 Aug 2025 06:03:08 +0000</updated>
                            <resolved>Mon, 11 Aug 2025 12:37:50 +0000</resolved>
                                    <version>4.2.0</version>
                                    <fixVersion>4.2.0</fixVersion>
                                    <component>Vectorization</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="18013214" author="krisztiankasa" created="Mon, 11 Aug 2025 12:37:50 +0000"  >&lt;p&gt;Merged to master. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=soumyakanti.das&quot; class=&quot;user-hover&quot; rel=&quot;soumyakanti.das&quot;&gt;soumyakanti.das&lt;/a&gt; for the patch and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dkuzmenko&quot; class=&quot;user-hover&quot; rel=&quot;dkuzmenko&quot;&gt;dkuzmenko&lt;/a&gt; for the review.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1x4dc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>