<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:36:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-11123] Fix how to confirm the RDBMS product name at Metastore.</title>
                <link>https://issues.apache.org/jira/browse/HIVE-11123</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;I use PostgreSQL to Hive Metastore. And I saw the following message at PostgreSQL log.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt; 2015-06-26 10:58:15.488 JST &amp;gt;ERROR:  syntax error at or near &lt;span class=&quot;code-quote&quot;&gt;&quot;@@&quot;&lt;/span&gt; at character 5
&amp;lt; 2015-06-26 10:58:15.488 JST &amp;gt;STATEMENT:  SET @@session.sql_mode=ANSI_QUOTES
&amp;lt; 2015-06-26 10:58:15.489 JST &amp;gt;ERROR:  relation &lt;span class=&quot;code-quote&quot;&gt;&quot;v$instance&quot;&lt;/span&gt; does not exist at character 21
&amp;lt; 2015-06-26 10:58:15.489 JST &amp;gt;STATEMENT:  SELECT version FROM v$instance
&amp;lt; 2015-06-26 10:58:15.490 JST &amp;gt;ERROR:  column &lt;span class=&quot;code-quote&quot;&gt;&quot;version&quot;&lt;/span&gt; does not exist at character 10
&amp;lt; 2015-06-26 10:58:15.490 JST &amp;gt;STATEMENT:  SELECT @@version
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When Hive CLI and Beeline embedded mode are carried out, this message is output to PostgreSQL log.&lt;br/&gt;
These queries are called from MetaStoreDirectSql#determineDbType. And if we use MetaStoreDirectSql#getProductName, we need not to call these queries.&lt;/p&gt;</description>
                <environment>&lt;p&gt;PostgreSQL&lt;/p&gt;</environment>
        <key id="12840734">HIVE-11123</key>
            <summary>Fix how to confirm the RDBMS product name at Metastore.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sinchii">Shinichi Yamashita</assignee>
                                    <reporter username="sinchii">Shinichi Yamashita</reporter>
                        <labels>
                    </labels>
                <created>Fri, 26 Jun 2015 04:14:34 +0000</created>
                <updated>Tue, 16 Feb 2016 23:49:56 +0000</updated>
                            <resolved>Thu, 27 Aug 2015 18:16:26 +0000</resolved>
                                    <version>1.2.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14603932" author="sinchii" created="Sat, 27 Jun 2015 03:20:02 +0000"  >&lt;p&gt;I attach a patch file.&lt;/p&gt;</comment>
                            <comment id="14604124" author="hiveqa" created="Sat, 27 Jun 2015 11:13:48 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12742290/HIVE-11123.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12742290/HIVE-11123.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 9030 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4408/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4408/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4408/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4408/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4408/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4408/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12742290 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14604380" author="ashutoshc" created="Sat, 27 Jun 2015 21:34:11 +0000"  >&lt;p&gt;Have you tested this with other DBs like mysql, MS sql server and oracle?&lt;/p&gt;</comment>
                            <comment id="14605790" author="sinchii" created="Mon, 29 Jun 2015 15:49:54 +0000"  >&lt;p&gt;Hi, thank you for your comment.&lt;br/&gt;
I confirmed the value of DatabaseMetaData#getDatabaseProductName(in MetaStoreDirectSql#getProductName) in my environment.&lt;br/&gt;
And I got the values as follows.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;PostgreSQL&lt;/li&gt;
	&lt;li&gt;MySQL&lt;/li&gt;
	&lt;li&gt;Oracle&lt;/li&gt;
	&lt;li&gt;Microsoft SQL Server&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Based on this information, I fix the patch file and attach it.&lt;/p&gt;</comment>
                            <comment id="14606018" author="hiveqa" created="Mon, 29 Jun 2015 18:05:09 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12742520/HIVE-11123.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12742520/HIVE-11123.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 9034 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4431/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4431/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4431/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4431/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4431/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4431/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12742520 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14606544" author="sershe" created="Mon, 29 Jun 2015 22:26:11 +0000"  >&lt;p&gt;+1. Small nit: null check can be done once&lt;/p&gt;</comment>
                            <comment id="14608265" author="sinchii" created="Tue, 30 Jun 2015 13:21:09 +0000"  >&lt;p&gt;Thank you for comments. I attach the modified patch file.&lt;/p&gt;</comment>
                            <comment id="14608967" author="hiveqa" created="Tue, 30 Jun 2015 19:59:57 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12742828/HIVE-11123.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12742828/HIVE-11123.3.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 9034 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestMarkPartition - did not produce a TEST-*.xml file
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4446/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4446/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4446/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4446/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4446/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4446/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12742828 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14613793" author="sinchii" created="Sat, 4 Jul 2015 13:01:10 +0000"  >&lt;p&gt;I attach a patch file again.&lt;/p&gt;</comment>
                            <comment id="14710109" author="deepesh" created="Mon, 24 Aug 2015 21:36:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sinchii&quot; class=&quot;user-hover&quot; rel=&quot;sinchii&quot;&gt;sinchii&lt;/a&gt; thanks for the patch! What version of Oracle did you use for testing this? We saw some issues with existing code (without your patch) on Oracle 12 whereas it worked fine on Oracle 11. Just want to make sure that it works as expected between different Oracle versions.&lt;/p&gt;</comment>
                            <comment id="14710538" author="sinchii" created="Tue, 25 Aug 2015 04:00:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=deepesh&quot; class=&quot;user-hover&quot; rel=&quot;deepesh&quot;&gt;deepesh&lt;/a&gt; Thank you for your comment. I confirmed version Oracle 11g R2 and 12c. And I could get the same value &quot;Oracle&quot; by both versions.&lt;/p&gt;</comment>
                            <comment id="14717128" author="sershe" created="Thu, 27 Aug 2015 17:35:39 +0000"  >&lt;p&gt;This has been around for a while... I will commit today if there are no objections.&lt;/p&gt;</comment>
                            <comment id="14717193" author="ashutoshc" created="Thu, 27 Aug 2015 18:05:38 +0000"  >&lt;p&gt;I am not sure if this will work for mysql. Earlier, determineDbType() was overloaded which also executed actual logic alongwith db detection which will no longer be the case. e.g, &lt;tt&gt;SET @@session.sql_mode=ANSI_QUOTES&lt;/tt&gt; will not execute any longer for mysql, which may cause problems.&lt;/p&gt;</comment>
                            <comment id="14717225" author="sershe" created="Thu, 27 Aug 2015 18:23:16 +0000"  >&lt;p&gt;Hmm.. it&apos;s a good point. It was only called during init before, though, I wonder how it ever worked. Luck? Magic? I will make a fix on top&lt;/p&gt;</comment>
                            <comment id="14717226" author="sershe" created="Thu, 27 Aug 2015 18:23:45 +0000"  >&lt;p&gt;btw, the patch needed to be rebased. Here&apos;s what I committed&lt;/p&gt;</comment>
                            <comment id="14717268" author="sershe" created="Thu, 27 Aug 2015 18:44:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11668&quot; title=&quot;make sure directsql calls pre-query init when needed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11668&quot;&gt;&lt;del&gt;HIVE-11668&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14720402" author="sushanth" created="Fri, 28 Aug 2015 18:54:06 +0000"  >&lt;p&gt;Also, this patch broke hive working against mysql and potentially other dbs - I will follow up with comments on &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11668&quot; title=&quot;make sure directsql calls pre-query init when needed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11668&quot;&gt;&lt;del&gt;HIVE-11668&lt;/del&gt;&lt;/a&gt;. Testing with derby alone in unit test mode is problematic. Sorry I didn&apos;t catch this before it was committed.&lt;/p&gt;</comment>
                            <comment id="14726217" author="xuefuz" created="Tue, 1 Sep 2015 21:22:06 +0000"  >&lt;p&gt;Thanks, guys. Should we revert this commit though?&lt;/p&gt;</comment>
                            <comment id="14726411" author="sushanth" created="Tue, 1 Sep 2015 23:24:48 +0000"  >&lt;p&gt;I think &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11668&quot; title=&quot;make sure directsql calls pre-query init when needed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11668&quot;&gt;&lt;del&gt;HIVE-11668&lt;/del&gt;&lt;/a&gt; is close to committing (after I verify), so I think we can hold off on reverting this, since it is actually still useful. Otherwise, I&apos;d agree that this was a revert-candidate.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12873171">HIVE-11859</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12742290" name="HIVE-11123.1.patch" size="2581" author="sinchii" created="Sat, 27 Jun 2015 03:20:02 +0000"/>
                            <attachment id="12742520" name="HIVE-11123.2.patch" size="2592" author="sinchii" created="Mon, 29 Jun 2015 15:49:54 +0000"/>
                            <attachment id="12742828" name="HIVE-11123.3.patch" size="2547" author="sinchii" created="Tue, 30 Jun 2015 13:21:09 +0000"/>
                            <attachment id="12743582" name="HIVE-11123.4.patch" size="2547" author="sinchii" created="Sat, 4 Jul 2015 13:01:10 +0000"/>
                            <attachment id="12752819" name="HIVE-11123.4a.patch" size="2553" author="sershe" created="Thu, 27 Aug 2015 18:23:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 12 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2givr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>