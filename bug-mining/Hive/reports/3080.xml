<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:29:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-9382] Query got rerun with Global Limit optimization on and Fetch optimization off</title>
                <link>https://issues.apache.org/jira/browse/HIVE-9382</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;When Global Limit optimization is enabled, and Fetch Optimization for Simple Queries is off or not applicable, some queries with LIMIT clause will run twice.&lt;br/&gt;
set hive.limit.optimize.enable=true;&lt;br/&gt;
set hive.fetch.task.conversion=none;&lt;/p&gt;

&lt;p&gt;For example,&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;hive&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;select&lt;/span&gt; * &lt;span class=&quot;code-keyword&quot;&gt;from&lt;/span&gt; t1 &lt;span class=&quot;code-keyword&quot;&gt;limit&lt;/span&gt; 10;
Query ID = wzheng_20150107185252_4a6d0e65-9e58-464b-9ed3-9177740c30a9
Total jobs = 1
Launching Job 1 &lt;span class=&quot;code-keyword&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;of&lt;/span&gt; 1


&lt;span class=&quot;code-keyword&quot;&gt;Status&lt;/span&gt;: Running (Executing &lt;span class=&quot;code-keyword&quot;&gt;on&lt;/span&gt; YARN &lt;span class=&quot;code-keyword&quot;&gt;cluster&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;with&lt;/span&gt; App id application_1420567249453_0039)

&lt;span class=&quot;code-comment&quot;&gt;--------------------------------------------------------------------------------
&lt;/span&gt;        VERTICES      &lt;span class=&quot;code-keyword&quot;&gt;STATUS&lt;/span&gt;  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
&lt;span class=&quot;code-comment&quot;&gt;--------------------------------------------------------------------------------
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;Map&lt;/span&gt; 1 ..........   SUCCEEDED      1          1        0        0       0       0
&lt;span class=&quot;code-comment&quot;&gt;--------------------------------------------------------------------------------
&lt;/span&gt;VERTICES: 01/01  [==========================&amp;gt;&amp;gt;] 100%  ELAPSED &lt;span class=&quot;code-keyword&quot;&gt;TIME&lt;/span&gt;: 0.41 s
&lt;span class=&quot;code-comment&quot;&gt;--------------------------------------------------------------------------------
&lt;/span&gt;OK
201208	99848	119820	32627	982976	509206	0.000100898
201208	99745	119820	32627	982976	509206	0.000100898
201208	99739	119820	32627	982976	509206	0.000100898
201208	99847	119820	32627	982976	509206	0.000100898
201208	613588	119820	32627	982976	509206	0.000100898
201208	99809	119820	32627	982976	509206	0.000100898
201208	99725	119820	32627	982976	509206	0.000100898
201208	99666	119820	32627	982976	509206	0.000100898
201208	99743	119820	32627	982976	509206	0.000100898
201208	99801	119820	32627	982976	509206	0.000100898
Retry query &lt;span class=&quot;code-keyword&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;a&lt;/span&gt; different approach...
Query ID = wzheng_20150107185252_8a77f793-cad7-4c6b-b64a-07d8310970b9
Total jobs = 1
Launching Job 1 &lt;span class=&quot;code-keyword&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;of&lt;/span&gt; 1


&lt;span class=&quot;code-keyword&quot;&gt;Status&lt;/span&gt;: Running (Executing &lt;span class=&quot;code-keyword&quot;&gt;on&lt;/span&gt; YARN &lt;span class=&quot;code-keyword&quot;&gt;cluster&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;with&lt;/span&gt; App id application_1420567249453_0039)

&lt;span class=&quot;code-comment&quot;&gt;--------------------------------------------------------------------------------
&lt;/span&gt;        VERTICES      &lt;span class=&quot;code-keyword&quot;&gt;STATUS&lt;/span&gt;  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
&lt;span class=&quot;code-comment&quot;&gt;--------------------------------------------------------------------------------
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;Map&lt;/span&gt; 1 ..........   SUCCEEDED    309        309        0        0       0       0
&lt;span class=&quot;code-comment&quot;&gt;--------------------------------------------------------------------------------
&lt;/span&gt;VERTICES: 01/01  [==========================&amp;gt;&amp;gt;] 100%  ELAPSED &lt;span class=&quot;code-keyword&quot;&gt;TIME&lt;/span&gt;: 2.04 s
&lt;span class=&quot;code-comment&quot;&gt;--------------------------------------------------------------------------------
&lt;/span&gt;OK
201208	99848	119820	32627	982976	509206	0.000100898
201208	99745	119820	32627	982976	509206	0.000100898
201208	99739	119820	32627	982976	509206	0.000100898
201208	99847	119820	32627	982976	509206	0.000100898
201208	613588	119820	32627	982976	509206	0.000100898
201208	99809	119820	32627	982976	509206	0.000100898
201208	99725	119820	32627	982976	509206	0.000100898
201208	99666	119820	32627	982976	509206	0.000100898
201208	99743	119820	32627	982976	509206	0.000100898
201208	99801	119820	32627	982976	509206	0.000100898
&lt;span class=&quot;code-keyword&quot;&gt;Time&lt;/span&gt; taken: 2.748 seconds, Fetched: 10 &lt;span class=&quot;code-keyword&quot;&gt;row&lt;/span&gt;(s)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12767616">HIVE-9382</key>
            <summary>Query got rerun with Global Limit optimization on and Fetch optimization off</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="wzheng">Wei Zheng</assignee>
                                    <reporter username="wzheng">Wei Zheng</reporter>
                        <labels>
                    </labels>
                <created>Thu, 15 Jan 2015 01:12:31 +0000</created>
                <updated>Thu, 12 Feb 2015 23:41:06 +0000</updated>
                            <resolved>Thu, 22 Jan 2015 09:39:24 +0000</resolved>
                                    <version>0.14.0</version>
                                    <fixVersion>1.1.0</fixVersion>
                                    <component>Physical Optimizer</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14278043" author="wzheng" created="Thu, 15 Jan 2015 01:20:07 +0000"  >&lt;p&gt;The second run for the query in fact turns off Global Limit optimization. That&apos;s why it doesn&apos;t continue on and on.&lt;/p&gt;</comment>
                            <comment id="14278044" author="wzheng" created="Thu, 15 Jan 2015 01:21:28 +0000"  >&lt;p&gt;The problem happens when there are already 10 rows fetched and output (in this example), and the FetchTask still tries to retrieve more rows since the least number of rows for each task is greater than 0. That is wrong, because we do not need any more rows. FetchTask.fetch should just return without doing anything.&lt;/p&gt;</comment>
                            <comment id="14278078" author="wzheng" created="Thu, 15 Jan 2015 01:49:47 +0000"  >&lt;p&gt;Uploaded 1st patch.&lt;/p&gt;</comment>
                            <comment id="14278323" author="wzheng" created="Thu, 15 Jan 2015 06:25:49 +0000"  >&lt;p&gt;Here&apos;s how to reproduce the problem:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;set&lt;/span&gt; hive.&lt;span class=&quot;code-keyword&quot;&gt;limit&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;optimize&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;enable&lt;/span&gt;=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
&lt;span class=&quot;code-keyword&quot;&gt;set&lt;/span&gt; hive.&lt;span class=&quot;code-keyword&quot;&gt;limit&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;optimize&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;limit&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;file&lt;/span&gt;=2;
&lt;span class=&quot;code-keyword&quot;&gt;set&lt;/span&gt; hive.&lt;span class=&quot;code-keyword&quot;&gt;limit&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;row&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;max&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;size&lt;/span&gt;=100;
&lt;span class=&quot;code-keyword&quot;&gt;set&lt;/span&gt; hive.&lt;span class=&quot;code-keyword&quot;&gt;fetch&lt;/span&gt;.task.&lt;span class=&quot;code-keyword&quot;&gt;conversion&lt;/span&gt;=&lt;span class=&quot;code-keyword&quot;&gt;none&lt;/span&gt;;

&lt;span class=&quot;code-keyword&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt; t1 (&lt;span class=&quot;code-keyword&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;string&lt;/span&gt;) stored &lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; textfile;
&lt;span class=&quot;code-keyword&quot;&gt;load&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;local&lt;/span&gt; inpath &lt;span class=&quot;code-quote&quot;&gt;&apos;../../&lt;span class=&quot;code-keyword&quot;&gt;data&lt;/span&gt;/files/srcbucket20.txt&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TABLE&lt;/span&gt; t1;
&lt;span class=&quot;code-keyword&quot;&gt;load&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;local&lt;/span&gt; inpath &lt;span class=&quot;code-quote&quot;&gt;&apos;../../&lt;span class=&quot;code-keyword&quot;&gt;data&lt;/span&gt;/files/srcbucket20.txt&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TABLE&lt;/span&gt; t1;
&lt;span class=&quot;code-keyword&quot;&gt;load&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;local&lt;/span&gt; inpath &lt;span class=&quot;code-quote&quot;&gt;&apos;../../&lt;span class=&quot;code-keyword&quot;&gt;data&lt;/span&gt;/files/srcbucket20.txt&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TABLE&lt;/span&gt; t1;

&lt;span class=&quot;code-keyword&quot;&gt;select&lt;/span&gt; * &lt;span class=&quot;code-keyword&quot;&gt;from&lt;/span&gt; t1 &lt;span class=&quot;code-keyword&quot;&gt;limit&lt;/span&gt; 1;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14279987" author="hiveqa" created="Fri, 16 Jan 2015 08:48:53 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12692410/HIVE-9382.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12692410/HIVE-9382.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 7315 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.ql.TestMTQueries.testMTQueries1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2389/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2389/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2389/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2389/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-2389/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-2389/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12692410 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14280676" author="wzheng" created="Fri, 16 Jan 2015 19:11:45 +0000"  >&lt;p&gt;The test failure is irrelevant.&lt;/p&gt;</comment>
                            <comment id="14280714" author="gopalv" created="Fri, 16 Jan 2015 19:38:32 +0000"  >&lt;p&gt;+1 LGTM.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12692410" name="HIVE-9382.1.patch" size="1985" author="wzheng" created="Thu, 15 Jan 2015 01:45:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 44 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i24e3j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-9382&quot; title=&quot;Query got rerun with Global Limit optimization on and Fetch optimization off&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-9382&quot;&gt;&lt;strike&gt;HIVE-9382&lt;/strike&gt;&lt;/a&gt;: Fix Global Limit optimization when Fetch optimizations are off (Wei Zheng, reviewed by Gopal V)</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>