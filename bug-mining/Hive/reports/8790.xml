<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:26:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-28124] Do not allow non-numeric values in Hive table stats during an alter table</title>
                <link>https://issues.apache.org/jira/browse/HIVE-28124</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Hive table properties are string in their nature, however some of them have special meaning and should have numeric values, like the &quot;totalSize&quot;, &quot;numRows&quot;, &quot;rawDataSize&quot;. &lt;br/&gt;
During an &quot;ALTER TABLE&quot; statement Hive currently validates only the &quot;numRows&quot; and &quot;rawDataSize&quot; table properties, the other table properties can be set to non-numeric values (including an empty string).&lt;br/&gt;
From certain applications (like from Spark) we get quite obscure &quot;NumberFormatException&quot; errors while trying to access such broken tables. (see &lt;a href=&quot;https://issues.apache.org/jira/browse/SPARK-47444&quot; title=&quot;Validate alter table statements and check the numeric table stats&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPARK-47444&quot;&gt;SPARK-47444&lt;/a&gt;)&lt;br/&gt;
For example such a query (after which that table can&apos;t be read from Spark)::&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//hs2host&amp;gt; alter table t1p set tblproperties(&lt;span class=&quot;code-quote&quot;&gt;&apos;totalSize&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;&apos;, &apos;&lt;/span&gt;STATS_GENERATED_VIA_STATS_TASK&lt;span class=&quot;code-quote&quot;&gt;&apos;=&apos;&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;);&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In the AbstractAlterTablePropertiesAnalyzer.java besides the &quot;numRows&quot; and &quot;rawDataSize&quot; we should validate the other table stats related properties too, currently the missing ones are:&lt;br/&gt;
numFiles, numPartitions, totalSize, runTimeNumRows, numFilesErasureCoded.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13572274">HIVE-28124</key>
            <summary>Do not allow non-numeric values in Hive table stats during an alter table</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mszurap">Miklos Szurap</assignee>
                                    <reporter username="mszurap">Miklos Szurap</reporter>
                        <labels>
                            <label>alter</label>
                            <label>alter-table</label>
                            <label>pull-request-available</label>
                            <label>statistics</label>
                            <label>stats</label>
                            <label>validation</label>
                    </labels>
                <created>Mon, 18 Mar 2024 16:46:45 +0000</created>
                <updated>Tue, 29 Jul 2025 14:52:03 +0000</updated>
                            <resolved>Wed, 5 Mar 2025 13:14:36 +0000</resolved>
                                    <version>3.1.3</version>
                    <version>4.0.0</version>
                                    <fixVersion>4.1.0</fixVersion>
                                    <component>Statistics</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17932618" author="okumin" created="Wed, 5 Mar 2025 13:14:36 +0000"  >&lt;p&gt;Merged. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mszurap&quot; class=&quot;user-hover&quot; rel=&quot;mszurap&quot;&gt;mszurap&lt;/a&gt; Thanks for finding the issue and submitting the patch!&lt;/p&gt;</comment>
                            <comment id="17933228" author="mszurap" created="Fri, 7 Mar 2025 08:26:43 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=okumin&quot; class=&quot;user-hover&quot; rel=&quot;okumin&quot;&gt;okumin&lt;/a&gt; for the help on this.&lt;br/&gt;
For the visibility posting it here too, after this change queries like &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
alter table stat_test set TBLPROPERTIES(&lt;span class=&quot;code-quote&quot;&gt;&apos;rawDataSize&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;NaN&apos;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;will fail with&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SemanticException AlterTable rawDataSize failed with value NaN
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            35 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1o1c8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>