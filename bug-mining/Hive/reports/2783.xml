<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:26:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-7985] With CBO enabled cross product is generated when a subquery is present</title>
                <link>https://issues.apache.org/jira/browse/HIVE-7985</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;This is a regression introduced in the latest build of the CBO branch.&lt;br/&gt;
Removing the subquery for item will remove the cross products&lt;/p&gt;

&lt;p&gt;Query&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;select i_item_id,sum(ss_ext_sales_price) total_sales from store_sales, date_dim, item where item.i_item_id in (select i.i_item_id from item i where i_color in (&lt;span class=&quot;code-quote&quot;&gt;&apos;purple&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;burlywood&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;indian&apos;&lt;/span&gt;)) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 1 group by i_item_id;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Warning: Map Join MAPJOIN[38][bigTable=?] in task &lt;span class=&quot;code-quote&quot;&gt;&apos;Map 1&apos;&lt;/span&gt; is a cross product
Warning: Map Join MAPJOIN[39][bigTable=store_sales] in task &lt;span class=&quot;code-quote&quot;&gt;&apos;Map 4&apos;&lt;/span&gt; is a cross product
OK
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      Edges:
        Map 1 &amp;lt;- Map 3 (BROADCAST_EDGE)
        Map 4 &amp;lt;- Map 1 (BROADCAST_EDGE), Map 2 (BROADCAST_EDGE)
        Reducer 5 &amp;lt;- Map 4 (SIMPLE_EDGE)
      DagName: mmokhtar_20140904141313_9c253f7e-aad1-4ca4-9be1-ea45e3d34496:1
      Vertices:
        Map 1
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: (&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; and i_item_id is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 462000 Data size: 663862160 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: i_item_id is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 231000 Data size: 331931080 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      condition expressions:
                        0 {i_item_sk} {i_item_id}
                        1 {d_date_sk}
                      keys:
                        0
                        1
                      outputColumnNames: _col0, _col1, _col25
                      input vertices:
                        1 Map 3
                      Statistics: Num rows: 254100 Data size: 365124192 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col1 (type: string), _col25 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        outputColumnNames: _col0, _col1, _col25
                        Statistics: Num rows: 254100 Data size: 365124192 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order:
                          Statistics: Num rows: 254100 Data size: 365124192 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col1 (type: string), _col25 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
            Execution mode: vectorized
        Map 2
            Map Operator Tree:
                TableScan
                  alias: i
                  filterExpr: ((i_color) IN (&lt;span class=&quot;code-quote&quot;&gt;&apos;purple&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;burlywood&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;indian&apos;&lt;/span&gt;) and i_item_id is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 462000 Data size: 663862160 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ((i_color) IN (&lt;span class=&quot;code-quote&quot;&gt;&apos;purple&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;burlywood&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;indian&apos;&lt;/span&gt;) and i_item_id is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 115500 Data size: 165965540 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: i_item_id (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 115500 Data size: 165965540 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        keys: _col0 (type: string)
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 115500 Data size: 165965540 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          Statistics: Num rows: 115500 Data size: 165965540 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized
        Map 3
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 2001) and (d_moy = 1)) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ((d_year = 2001) and (d_moy = 1)) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      sort order:
                      Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                      value expressions: d_date_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
            Execution mode: vectorized
        Map 4
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  Statistics: Num rows: 82510879939 Data size: 7203833257964 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    condition expressions:
                      0 {ss_sold_date_sk} {ss_item_sk} {ss_ext_sales_price}
                      1 {_col0} {_col1} {_col25}
                    keys:
                      0
                      1
                    outputColumnNames: _col0, _col2, _col15, _col27, _col28, _col52
                    input vertices:
                      1 Map 1
                    Statistics: Num rows: 90761969664 Data size: 7924217282560 Basic stats: COMPLETE Column stats: NONE
                    Filter Operator
                      predicate: ((_col2 = _col27) and (_col0 = _col52)) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                      Statistics: Num rows: 22690492416 Data size: 1981054320640 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col15 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), _col28 (type: string)
                        outputColumnNames: _col15, _col59
                        Statistics: Num rows: 22690492416 Data size: 1981054320640 Basic stats: COMPLETE Column stats: NONE
                        Map Join Operator
                          condition map:
                               Left Semi Join 0 to 1
                          condition expressions:
                            0 {_col15} {_col59}
                            1
                          keys:
                            0 _col59 (type: string)
                            1 _col0 (type: string)
                          outputColumnNames: _col15, _col59
                          input vertices:
                            1 Map 2
                          Statistics: Num rows: 24959541248 Data size: 2179159818240 Basic stats: COMPLETE Column stats: NONE
                          Select Operator
                            expressions: _col59 (type: string), _col15 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;)
                            outputColumnNames: _col0, _col1
                            Statistics: Num rows: 24959541248 Data size: 2179159818240 Basic stats: COMPLETE Column stats: NONE
                            Group By Operator
                              aggregations: sum(_col1)
                              keys: _col0 (type: string)
                              mode: hash
                              outputColumnNames: _col0, _col1
                              Statistics: Num rows: 24959541248 Data size: 2179159818240 Basic stats: COMPLETE Column stats: NONE
                              Reduce Output Operator
                                key expressions: _col0 (type: string)
                                sort order: +
                                Map-reduce partition columns: _col0 (type: string)
                                Statistics: Num rows: 24959541248 Data size: 2179159818240 Basic stats: COMPLETE Column stats: NONE
                                value expressions: _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
            Execution mode: vectorized
        Reducer 5
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 12479770624 Data size: 1089579909120 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 12479770624 Data size: 1089579909120 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
                    Statistics: Num rows: 12479770624 Data size: 1089579909120 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.TextInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;No cross product generated for this query&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; select i_item_id,sum(ss_ext_sales_price) total_sales
 from
        store_sales,
        date_dim,
         item
where i_color in (&lt;span class=&quot;code-quote&quot;&gt;&apos;purple&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;burlywood&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;indian&apos;&lt;/span&gt;)
 and     ss_item_sk              = i_item_sk
 and     ss_sold_date_sk         = d_date_sk
 and     d_year                  = 2001
 and     d_moy                   = 1
 group by i_item_id;

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12739190">HIVE-7985</key>
            <summary>With CBO enabled cross product is generated when a subquery is present</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jpullokkaran">Laljo John Pullokkaran</assignee>
                                    <reporter username="mmokhtar">Mostafa Mokhtar</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 Sep 2014 18:12:46 +0000</created>
                <updated>Thu, 13 Nov 2014 19:42:39 +0000</updated>
                            <resolved>Thu, 23 Oct 2014 02:23:07 +0000</resolved>
                                    <version>0.14.0</version>
                                    <fixVersion>0.14.0</fixVersion>
                                    <component>CBO</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14137768" author="mmokhtar" created="Wed, 17 Sep 2014 19:13:25 +0000"  >&lt;p&gt;Q56 also has the same issues &lt;br/&gt;
Query &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;with ss as (
 select i_item_id,sum(ss_ext_sales_price) total_sales
 from
        store_sales,
        date_dim,
         customer_address,
         item
 where item.i_item_id in (select
     i.i_item_id
from item i
where i_color in (&lt;span class=&quot;code-quote&quot;&gt;&apos;purple&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;burlywood&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;indian&apos;&lt;/span&gt;))
 and     ss_item_sk              = i_item_sk
 and     ss_sold_date_sk         = d_date_sk
 and     d_year                  = 2001
 and     d_moy                   = 1
 and     ss_addr_sk              = ca_address_sk
 and     ca_gmt_offset           = -6 
 group by i_item_id),
 cs as (
 select i_item_id,sum(cs_ext_sales_price) total_sales
 from
        catalog_sales,
        date_dim,
         customer_address,
         item
 where
         item.i_item_id               in (select
  i.i_item_id
from item i
where i_color in (&lt;span class=&quot;code-quote&quot;&gt;&apos;purple&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;burlywood&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;indian&apos;&lt;/span&gt;))
 and     cs_item_sk              = i_item_sk
 and     cs_sold_date_sk         = d_date_sk
 and     d_year                  = 2001
 and     d_moy                   = 1
 and     cs_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -6 
 group by i_item_id),
 ws as (
 select i_item_id,sum(ws_ext_sales_price) total_sales
 from
        web_sales,
        date_dim,
         customer_address,
         item
 where
         item.i_item_id               in (select
  i.i_item_id
from item i
where i_color in (&lt;span class=&quot;code-quote&quot;&gt;&apos;purple&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;burlywood&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;indian&apos;&lt;/span&gt;))
 and     ws_item_sk              = i_item_sk
 and     ws_sold_date_sk         = d_date_sk
 and     d_year                  = 2001
 and     d_moy                   = 1
 and     ws_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -6
 group by i_item_id)
  select  i_item_id ,sum(total_sales) total_sales
 from  (select * from ss 
        union all
        select * from cs 
        union all
        select * from ws) tmp1
 group by i_item_id
 order by total_sales
 limit 100
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Plan &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Warning: Map Join MAPJOIN[177][bigTable=?] in task &lt;span class=&quot;code-quote&quot;&gt;&apos;Map 8&apos;&lt;/span&gt; is a cross product
Warning: Map Join MAPJOIN[178][bigTable=?] in task &lt;span class=&quot;code-quote&quot;&gt;&apos;Map 21&apos;&lt;/span&gt; is a cross product
Warning: Map Join MAPJOIN[179][bigTable=web_sales] in task &lt;span class=&quot;code-quote&quot;&gt;&apos;Map 14&apos;&lt;/span&gt; is a cross product
Warning: Map Join MAPJOIN[180][bigTable=?] in task &lt;span class=&quot;code-quote&quot;&gt;&apos;Map 20&apos;&lt;/span&gt; is a cross product
Warning: Map Join MAPJOIN[181][bigTable=?] in task &lt;span class=&quot;code-quote&quot;&gt;&apos;Map 22&apos;&lt;/span&gt; is a cross product
Warning: Map Join MAPJOIN[182][bigTable=store_sales] in task &lt;span class=&quot;code-quote&quot;&gt;&apos;Map 17&apos;&lt;/span&gt; is a cross product
Warning: Map Join MAPJOIN[174][bigTable=?] in task &lt;span class=&quot;code-quote&quot;&gt;&apos;Map 13&apos;&lt;/span&gt; is a cross product
Warning: Map Join MAPJOIN[175][bigTable=?] in task &lt;span class=&quot;code-quote&quot;&gt;&apos;Map 10&apos;&lt;/span&gt; is a cross product
Warning: Map Join MAPJOIN[176][bigTable=catalog_sales] in task &lt;span class=&quot;code-quote&quot;&gt;&apos;Map 2&apos;&lt;/span&gt; is a cross product
OK
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      Edges:
        Map 10 &amp;lt;- Map 13 (BROADCAST_EDGE)
        Map 13 &amp;lt;- Map 16 (BROADCAST_EDGE)
        Map 14 &amp;lt;- Map 11 (BROADCAST_EDGE), Map 21 (BROADCAST_EDGE)
        Map 17 &amp;lt;- Map 12 (BROADCAST_EDGE), Map 22 (BROADCAST_EDGE)
        Map 2 &amp;lt;- Map 1 (BROADCAST_EDGE), Map 10 (BROADCAST_EDGE)
        Map 20 &amp;lt;- Map 9 (BROADCAST_EDGE)
        Map 21 &amp;lt;- Map 8 (BROADCAST_EDGE)
        Map 22 &amp;lt;- Map 20 (BROADCAST_EDGE)
        Map 8 &amp;lt;- Map 19 (BROADCAST_EDGE)
        Reducer 15 &amp;lt;- Map 14 (SIMPLE_EDGE), Union 4 (CONTAINS)
        Reducer 18 &amp;lt;- Map 17 (SIMPLE_EDGE), Union 4 (CONTAINS)
        Reducer 3 &amp;lt;- Map 2 (SIMPLE_EDGE), Union 4 (CONTAINS)
        Reducer 5 &amp;lt;- Union 4 (SIMPLE_EDGE)
        Reducer 6 &amp;lt;- Reducer 5 (SIMPLE_EDGE)
        Reducer 7 &amp;lt;- Reducer 6 (SIMPLE_EDGE)
      DagName: mmokhtar_20140916234444_107f445a-d48f-4a42-89a1-8c53eaa8dec0:1
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: i
                  filterExpr: ((i_color) IN (&lt;span class=&quot;code-quote&quot;&gt;&apos;purple&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;burlywood&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;indian&apos;&lt;/span&gt;) and i_item_id is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 48000 Data size: 68732712 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ((i_color) IN (&lt;span class=&quot;code-quote&quot;&gt;&apos;purple&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;burlywood&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;indian&apos;&lt;/span&gt;) and i_item_id is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 12000 Data size: 17183178 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: i_item_id (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 12000 Data size: 17183178 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        keys: _col0 (type: string)
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 12000 Data size: 17183178 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          Statistics: Num rows: 12000 Data size: 17183178 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  filterExpr: (ca_gmt_offset = UDFToFloat((- 6))) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 800000 Data size: 811903688 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (ca_gmt_offset = UDFToFloat((- 6))) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 400000 Data size: 405951844 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      condition expressions:
                        0 {_col0} {_col31} {_col32}
                        1 {ca_address_sk}
                      keys:
                        0 
                        1 
                      outputColumnNames: _col0, _col31, _col32, _col56
                      input vertices:
                        0 Map 13
                      Statistics: Num rows: 440000 Data size: 446547040 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        sort order: 
                        Statistics: Num rows: 440000 Data size: 446547040 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col31 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col32 (type: string), _col56 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
            Execution mode: vectorized
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: i
                  filterExpr: ((i_color) IN (&lt;span class=&quot;code-quote&quot;&gt;&apos;purple&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;burlywood&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;indian&apos;&lt;/span&gt;) and i_item_id is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 48000 Data size: 68732712 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ((i_color) IN (&lt;span class=&quot;code-quote&quot;&gt;&apos;purple&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;burlywood&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;indian&apos;&lt;/span&gt;) and i_item_id is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 12000 Data size: 17183178 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: i_item_id (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 12000 Data size: 17183178 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        keys: _col0 (type: string)
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 12000 Data size: 17183178 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          Statistics: Num rows: 12000 Data size: 17183178 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: i
                  filterExpr: ((i_color) IN (&lt;span class=&quot;code-quote&quot;&gt;&apos;purple&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;burlywood&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;indian&apos;&lt;/span&gt;) and i_item_id is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 48000 Data size: 68732712 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ((i_color) IN (&lt;span class=&quot;code-quote&quot;&gt;&apos;purple&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;burlywood&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;indian&apos;&lt;/span&gt;) and i_item_id is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 12000 Data size: 17183178 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: i_item_id (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 12000 Data size: 17183178 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        keys: _col0 (type: string)
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 12000 Data size: 17183178 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          Statistics: Num rows: 12000 Data size: 17183178 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: i_item_id is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 48000 Data size: 68732712 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: i_item_id is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 24000 Data size: 34366356 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      condition expressions:
                        0 {d_date_sk}
                        1 {i_item_sk} {i_item_id}
                      keys:
                        0 
                        1 
                      outputColumnNames: _col0, _col31, _col32
                      input vertices:
                        0 Map 16
                      Statistics: Num rows: 26400 Data size: 37802992 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        sort order: 
                        Statistics: Num rows: 26400 Data size: 37802992 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col31 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col32 (type: string)
            Execution mode: vectorized
        Map 14 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  Statistics: Num rows: 143966864 Data size: 19001610332 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    condition expressions:
                      0 {_col0} {_col31} {_col32} {_col56}
                      1 {ws_item_sk} {ws_bill_addr_sk} {ws_ext_sales_price} {ws_sold_date_sk}
                    keys:
                      0 
                      1 
                    outputColumnNames: _col0, _col31, _col32, _col56, _col74, _col78, _col94, _col105
                    input vertices:
                      0 Map 21
                    Statistics: Num rows: 158363552 Data size: 20901771264 Basic stats: COMPLETE Column stats: NONE
                    Filter Operator
                      predicate: (((_col74 = _col31) and (_col105 = _col0)) and (_col78 = _col56)) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                      Statistics: Num rows: 19795444 Data size: 2612721408 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col94 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), _col32 (type: string)
                        outputColumnNames: _col22, _col85
                        Statistics: Num rows: 19795444 Data size: 2612721408 Basic stats: COMPLETE Column stats: NONE
                        Map Join Operator
                          condition map:
                               Left Semi Join 0 to 1
                          condition expressions:
                            0 {_col22} {_col85}
                            1 
                          keys:
                            0 _col85 (type: string)
                            1 _col0 (type: string)
                          outputColumnNames: _col22, _col85
                          input vertices:
                            1 Map 11
                          Statistics: Num rows: 21774988 Data size: 2873993728 Basic stats: COMPLETE Column stats: NONE
                          Select Operator
                            expressions: _col85 (type: string), _col22 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;)
                            outputColumnNames: _col0, _col1
                            Statistics: Num rows: 21774988 Data size: 2873993728 Basic stats: COMPLETE Column stats: NONE
                            Group By Operator
                              aggregations: sum(_col1)
                              keys: _col0 (type: string)
                              mode: hash
                              outputColumnNames: _col0, _col1
                              Statistics: Num rows: 21774988 Data size: 2873993728 Basic stats: COMPLETE Column stats: NONE
                              Reduce Output Operator
                                key expressions: _col0 (type: string)
                                sort order: +
                                Map-reduce partition columns: _col0 (type: string)
                                Statistics: Num rows: 21774988 Data size: 2873993728 Basic stats: COMPLETE Column stats: NONE
                                value expressions: _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
            Execution mode: vectorized
        Map 16 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 2001) and (d_moy = 1)) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ((d_year = 2001) and (d_moy = 1)) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      sort order: 
                      Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                      value expressions: d_date_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
            Execution mode: vectorized
        Map 17 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  Statistics: Num rows: 550076554 Data size: 47370018896 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    condition expressions:
                      0 {_col0} {_col31} {_col32} {_col56}
                      1 {ss_item_sk} {ss_addr_sk} {ss_ext_sales_price} {ss_sold_date_sk}
                    keys:
                      0 
                      1 
                    outputColumnNames: _col0, _col31, _col32, _col56, _col73, _col77, _col86, _col94
                    input vertices:
                      0 Map 22
                    Statistics: Num rows: 605084224 Data size: 52107022336 Basic stats: COMPLETE Column stats: NONE
                    Filter Operator
                      predicate: (((_col73 = _col31) and (_col94 = _col0)) and (_col77 = _col56)) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                      Statistics: Num rows: 75635528 Data size: 6513377792 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col86 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), _col32 (type: string)
                        outputColumnNames: _col14, _col74
                        Statistics: Num rows: 75635528 Data size: 6513377792 Basic stats: COMPLETE Column stats: NONE
                        Map Join Operator
                          condition map:
                               Left Semi Join 0 to 1
                          condition expressions:
                            0 {_col14} {_col74}
                            1 
                          keys:
                            0 _col74 (type: string)
                            1 _col0 (type: string)
                          outputColumnNames: _col14, _col74
                          input vertices:
                            1 Map 12
                          Statistics: Num rows: 83199080 Data size: 7164715520 Basic stats: COMPLETE Column stats: NONE
                          Select Operator
                            expressions: _col74 (type: string), _col14 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;)
                            outputColumnNames: _col0, _col1
                            Statistics: Num rows: 83199080 Data size: 7164715520 Basic stats: COMPLETE Column stats: NONE
                            Group By Operator
                              aggregations: sum(_col1)
                              keys: _col0 (type: string)
                              mode: hash
                              outputColumnNames: _col0, _col1
                              Statistics: Num rows: 83199080 Data size: 7164715520 Basic stats: COMPLETE Column stats: NONE
                              Reduce Output Operator
                                key expressions: _col0 (type: string)
                                sort order: +
                                Map-reduce partition columns: _col0 (type: string)
                                Statistics: Num rows: 83199080 Data size: 7164715520 Basic stats: COMPLETE Column stats: NONE
                                value expressions: _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
            Execution mode: vectorized
        Map 19 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 2001) and (d_moy = 1)) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ((d_year = 2001) and (d_moy = 1)) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      sort order: 
                      Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                      value expressions: d_date_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
            Execution mode: vectorized
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  Statistics: Num rows: 286549727 Data size: 37743959324 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    condition expressions:
                      0 {_col0} {_col31} {_col32} {_col56}
                      1 {cs_bill_addr_sk} {cs_item_sk} {cs_ext_sales_price} {cs_sold_date_sk}
                    keys:
                      0 
                      1 
                    outputColumnNames: _col0, _col31, _col32, _col56, _col77, _col86, _col94, _col105
                    input vertices:
                      0 Map 10
                    Statistics: Num rows: 315204704 Data size: 41518358528 Basic stats: COMPLETE Column stats: NONE
                    Filter Operator
                      predicate: (((_col86 = _col31) and (_col105 = _col0)) and (_col77 = _col56)) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                      Statistics: Num rows: 39400588 Data size: 5189794816 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col94 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), _col32 (type: string)
                        outputColumnNames: _col22, _col85
                        Statistics: Num rows: 39400588 Data size: 5189794816 Basic stats: COMPLETE Column stats: NONE
                        Map Join Operator
                          condition map:
                               Left Semi Join 0 to 1
                          condition expressions:
                            0 {_col22} {_col85}
                            1 
                          keys:
                            0 _col85 (type: string)
                            1 _col0 (type: string)
                          outputColumnNames: _col22, _col85
                          input vertices:
                            1 Map 1
                          Statistics: Num rows: 43340648 Data size: 5708774400 Basic stats: COMPLETE Column stats: NONE
                          Select Operator
                            expressions: _col85 (type: string), _col22 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;)
                            outputColumnNames: _col0, _col1
                            Statistics: Num rows: 43340648 Data size: 5708774400 Basic stats: COMPLETE Column stats: NONE
                            Group By Operator
                              aggregations: sum(_col1)
                              keys: _col0 (type: string)
                              mode: hash
                              outputColumnNames: _col0, _col1
                              Statistics: Num rows: 43340648 Data size: 5708774400 Basic stats: COMPLETE Column stats: NONE
                              Reduce Output Operator
                                key expressions: _col0 (type: string)
                                sort order: +
                                Map-reduce partition columns: _col0 (type: string)
                                Statistics: Num rows: 43340648 Data size: 5708774400 Basic stats: COMPLETE Column stats: NONE
                                value expressions: _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
            Execution mode: vectorized
        Map 20 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: i_item_id is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 48000 Data size: 68732712 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: i_item_id is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 24000 Data size: 34366356 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      condition expressions:
                        0 {d_date_sk}
                        1 {i_item_sk} {i_item_id}
                      keys:
                        0 
                        1 
                      outputColumnNames: _col0, _col31, _col32
                      input vertices:
                        0 Map 9
                      Statistics: Num rows: 26400 Data size: 37802992 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        sort order: 
                        Statistics: Num rows: 26400 Data size: 37802992 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col31 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col32 (type: string)
            Execution mode: vectorized
        Map 21 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  filterExpr: (ca_gmt_offset = UDFToFloat((- 6))) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 800000 Data size: 811903688 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (ca_gmt_offset = UDFToFloat((- 6))) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 400000 Data size: 405951844 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      condition expressions:
                        0 {_col0} {_col31} {_col32}
                        1 {ca_address_sk}
                      keys:
                        0 
                        1 
                      outputColumnNames: _col0, _col31, _col32, _col56
                      input vertices:
                        0 Map 8
                      Statistics: Num rows: 440000 Data size: 446547040 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        sort order: 
                        Statistics: Num rows: 440000 Data size: 446547040 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col31 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col32 (type: string), _col56 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
            Execution mode: vectorized
        Map 22 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  filterExpr: (ca_gmt_offset = UDFToFloat((- 6))) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 800000 Data size: 811903688 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (ca_gmt_offset = UDFToFloat((- 6))) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 400000 Data size: 405951844 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      condition expressions:
                        0 {_col0} {_col31} {_col32}
                        1 {ca_address_sk}
                      keys:
                        0 
                        1 
                      outputColumnNames: _col0, _col31, _col32, _col56
                      input vertices:
                        0 Map 20
                      Statistics: Num rows: 440000 Data size: 446547040 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        sort order: 
                        Statistics: Num rows: 440000 Data size: 446547040 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col31 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col32 (type: string), _col56 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
            Execution mode: vectorized
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: i_item_id is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 48000 Data size: 68732712 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: i_item_id is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 24000 Data size: 34366356 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      condition expressions:
                        0 {d_date_sk}
                        1 {i_item_sk} {i_item_id}
                      keys:
                        0 
                        1 
                      outputColumnNames: _col0, _col31, _col32
                      input vertices:
                        0 Map 19
                      Statistics: Num rows: 26400 Data size: 37802992 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        sort order: 
                        Statistics: Num rows: 26400 Data size: 37802992 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col31 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col32 (type: string)
            Execution mode: vectorized
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 2001) and (d_moy = 1)) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ((d_year = 2001) and (d_moy = 1)) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      sort order: 
                      Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                      value expressions: d_date_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
            Execution mode: vectorized
        Reducer 15 
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                  outputColumnNames: _col0, _col1
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                    outputColumnNames: _col0, _col1
                    Group By Operator
                      aggregations: sum(_col1)
                      keys: _col0 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Reduce Output Operator
                        key expressions: _col0 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: string)
                        value expressions: _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
        Reducer 18 
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                  outputColumnNames: _col0, _col1
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                    outputColumnNames: _col0, _col1
                    Select Operator
                      expressions: _col0 (type: string), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                      outputColumnNames: _col0, _col1
                      Group By Operator
                        aggregations: sum(_col1)
                        keys: _col0 (type: string)
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          value expressions: _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
        Reducer 3 
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                  outputColumnNames: _col0, _col1
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                    outputColumnNames: _col0, _col1
                    Select Operator
                      expressions: _col0 (type: string), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                      outputColumnNames: _col0, _col1
                      Group By Operator
                        aggregations: sum(_col1)
                        keys: _col0 (type: string)
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          value expressions: _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
        Reducer 5 
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 37078679 Data size: 3936870912 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 37078679 Data size: 3936870912 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                    sort order: +
                    Statistics: Num rows: 37078679 Data size: 3936870912 Basic stats: COMPLETE Column stats: NONE
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col0 (type: string)
            Execution mode: vectorized
        Reducer 6 
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), KEY.reducesinkkey0 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 37078679 Data size: 3936870912 Basic stats: COMPLETE Column stats: NONE
                Limit
                  &lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; of rows: 100
                  Statistics: Num rows: 100 Data size: 10600 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    sort order: 
                    Statistics: Num rows: 100 Data size: 10600 Basic stats: COMPLETE Column stats: NONE
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col0 (type: string), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
            Execution mode: vectorized
        Reducer 7 
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), VALUE._col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 100 Data size: 10600 Basic stats: COMPLETE Column stats: NONE
                Limit
                  &lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; of rows: 100
                  Statistics: Num rows: 100 Data size: 10600 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 100 Data size: 10600 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
                      Statistics: Num rows: 100 Data size: 10600 Basic stats: COMPLETE Column stats: NONE
                      table:
                          input format: org.apache.hadoop.mapred.TextInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
            Execution mode: vectorized
        Union 4 
            Vertex: Union 4

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14167938" author="jpullokkaran" created="Sat, 11 Oct 2014 01:54:57 +0000"  >&lt;p&gt;Need to wait for &lt;a href=&quot;https://issues.apache.org/jira/browse/CALCITE-438&quot; title=&quot;Push predicates through SemiJoinRel&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CALCITE-438&quot;&gt;&lt;del&gt;OPTIQ-438&lt;/del&gt;&lt;/a&gt; to get checked in.&lt;/p&gt;</comment>
                            <comment id="14177727" author="jpullokkaran" created="Tue, 21 Oct 2014 00:45:08 +0000"  >&lt;p&gt;Hive Side patch for PPD through SemiJoinRel.&lt;/p&gt;</comment>
                            <comment id="14177740" author="jpullokkaran" created="Tue, 21 Oct 2014 00:51:54 +0000"  >&lt;p&gt;Need to wait for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-8522&quot; title=&quot;CBO: Update Calcite Version to 0.9.2-incubating-SNAPSHOT&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-8522&quot;&gt;&lt;del&gt;HIVE-8522&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14180424" author="ashutoshc" created="Wed, 22 Oct 2014 19:52:19 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14180568" author="hagleitn" created="Wed, 22 Oct 2014 21:33:16 +0000"  >&lt;p&gt;reuploading patch. seems test run was aborted.&lt;/p&gt;</comment>
                            <comment id="14180608" author="hiveqa" created="Wed, 22 Oct 2014 22:00:01 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12675995/HIVE-7985.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12675995/HIVE-7985.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 3 failed/errored test(s), 6575 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_annotate_stats_join_pkfk
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_schemeAuthority
org.apache.hive.minikdc.TestJdbcWithMiniKdc.testNegativeTokenAuth
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1397/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1397/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1397/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1397/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1397/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1397/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12675995 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14180829" author="jpullokkaran" created="Thu, 23 Oct 2014 00:47:07 +0000"  >&lt;p&gt;These failures are not related to CBO.&lt;/p&gt;</comment>
                            <comment id="14180888" author="vikram.dixit" created="Thu, 23 Oct 2014 01:40:24 +0000"  >&lt;p&gt;+1 for 0.14&lt;/p&gt;</comment>
                            <comment id="14180893" author="hiveqa" created="Thu, 23 Oct 2014 01:48:36 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12676432/HIVE-7985.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12676432/HIVE-7985.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 3 failed/errored test(s), 6576 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_annotate_stats_join_pkfk
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_udaf_histogram_numeric
org.apache.hive.minikdc.TestJdbcWithMiniKdc.testNegativeTokenAuth
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1402/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1402/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1402/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1402/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1402/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1402/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12676432 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14180929" author="hagleitn" created="Thu, 23 Oct 2014 02:23:08 +0000"  >&lt;p&gt;Committed to branch .14 and trunk. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jpullokkaran&quot; class=&quot;user-hover&quot; rel=&quot;jpullokkaran&quot;&gt;jpullokkaran&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="14210798" author="thejas" created="Thu, 13 Nov 2014 19:42:39 +0000"  >&lt;p&gt;This has been fixed in 0.14 release. Please open new jira if you see any issues.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12675995" name="HIVE-7985.1.patch" size="44685" author="jpullokkaran" created="Tue, 21 Oct 2014 00:51:13 +0000"/>
                            <attachment id="12676432" name="HIVE-7985.2.patch" size="44685" author="hagleitn" created="Wed, 22 Oct 2014 21:33:16 +0000"/>
                            <attachment id="12674326" name="HIVE-7985.patch" size="45243" author="jpullokkaran" created="Sat, 11 Oct 2014 01:54:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1zozr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>