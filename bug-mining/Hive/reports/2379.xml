<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:21:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-7266] Optimized HashTable with vectorized map-joins results in String columns extending</title>
                <link>https://issues.apache.org/jira/browse/HIVE-7266</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The following query returns different results when both vectorized mapjoin and the new optimized hashtable are enabled.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; set hive.vectorized.execution.enabled=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
hive&amp;gt; select s_suppkey, n_name from supplier, nation where s_nationkey = n_nationkey limit 25;
...
316869  JAPAN
1636869 RUSSIA
1096869 IRAN
7236869 RUSSIA
2276869 INDIA
8516869 ARGENTINA
2636869 MOZAMBIQUE
3836869 ROMANIA
2616869 FRANCE
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But when vectorization is enabled, the results are &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;316869  JAPAN
1636869 RUSSIA
1096869 IRANIA
7236869 RUSSIA
2276869 INDIAA
8516869 ARGENTINA
2636869 MOZAMBIQUE
3836869 ROMANIAQUE
2616869 FRANCEAQUE
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;it works correctly with vectorization when the new optimized map-join hashtable is disabled &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; set hive.vectorized.execution.enabled=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;                                             
hive&amp;gt; set hive.mapjoin.optimized.hashtable=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;                                             
hive&amp;gt; select s_suppkey, n_name from supplier, nation where s_nationkey = n_nationkey limit 25;

316869  JAPAN
1636869 RUSSIA
1096869 IRAN
7236869 RUSSIA
2276869 INDIA
8516869 ARGENTINA
2636869 MOZAMBIQUE
3836869 ROMANIA
2616869 FRANCE
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12722836">HIVE-7266</key>
            <summary>Optimized HashTable with vectorized map-joins results in String columns extending</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sershe">Sergey Shelukhin</assignee>
                                    <reporter username="gopalv">Gopal Vijayaraghavan</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 Jun 2014 17:49:27 +0000</created>
                <updated>Wed, 30 Sep 2015 21:31:22 +0000</updated>
                            <resolved>Thu, 24 Jul 2014 22:50:49 +0000</resolved>
                                    <version>0.14.0</version>
                                    <fixVersion>0.14.0</fixVersion>
                                    <component>Tez</component>
                    <component>Vectorization</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14039509" author="ehans" created="Fri, 20 Jun 2014 23:06:37 +0000"  >&lt;p&gt;This looks like it might be related to using setRef() in BytesColumnVector whe setVal() should be used. That is something to look into.&lt;/p&gt;</comment>
                            <comment id="14042330" author="ehans" created="Tue, 24 Jun 2014 16:35:25 +0000"  >&lt;p&gt;Also, I recall in a past an error that looked similar to this, which I think was related to incorrect column re-use within batches. The code for that was in VectorizationContext.&lt;/p&gt;</comment>
                            <comment id="14072397" author="sershe" created="Wed, 23 Jul 2014 21:43:32 +0000"  >&lt;p&gt;Assigner doesn&apos;t take into account length, so when the object is reused it gets the maximum length previously set. &lt;/p&gt;</comment>
                            <comment id="14072399" author="sershe" created="Wed, 23 Jul 2014 21:44:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mmccline&quot; class=&quot;user-hover&quot; rel=&quot;mmccline&quot;&gt;mmccline&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jnp&quot; class=&quot;user-hover&quot; rel=&quot;jnp&quot;&gt;jnp&lt;/a&gt; can you take a look?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gopalv&quot; class=&quot;user-hover&quot; rel=&quot;gopalv&quot;&gt;gopalv&lt;/a&gt; fyi&lt;/p&gt;</comment>
                            <comment id="14072457" author="mmccline" created="Wed, 23 Jul 2014 22:15:09 +0000"  >&lt;p&gt;Fix looks good.  Thanks for finding the problem!&lt;/p&gt;

&lt;p&gt;(contributor) +1&lt;/p&gt;</comment>
                            <comment id="14072478" author="jnp" created="Wed, 23 Jul 2014 22:38:40 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14072879" author="hiveqa" created="Thu, 24 Jul 2014 06:21:31 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12657445/HIVE-7266.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12657445/HIVE-7266.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 4 failed/errored test(s), 5756 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_dynpart_sort_optimization
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_ql_rewrite_gbtoidx
org.apache.hive.hcatalog.pig.TestOrcHCatLoader.testReadDataPrimitiveTypes
org.apache.hive.jdbc.miniHS2.TestHiveServer2.testConnection
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/30/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/30/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/30/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/30/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-30/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-30/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 4 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12657445&lt;/p&gt;</comment>
                            <comment id="14073611" author="sershe" created="Thu, 24 Jul 2014 20:32:15 +0000"  >&lt;p&gt;I don&apos;t think test failures are related. Will commit soon.&lt;/p&gt;</comment>
                            <comment id="14073786" author="sershe" created="Thu, 24 Jul 2014 22:50:49 +0000"  >&lt;p&gt;committed to trunk&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12657445" name="HIVE-7266.patch" size="1225" author="sershe" created="Wed, 23 Jul 2014 21:43:32 +0000"/>
                            <attachment id="12651700" name="hive-7266-small-test.tgz" size="6691" author="gopalv" created="Fri, 20 Jun 2014 18:01:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>401023</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 17 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1x13b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>401108</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>