<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:27:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-8784] Querying partition does not work with JDO enabled against PostgreSQL</title>
                <link>https://issues.apache.org/jira/browse/HIVE-8784</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Querying a partition in PostgreSQL fails when using JDO (with hive.metastore.try.direct.sql=false) . Following is the reproduce example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;create table partition_test_multilevel (key string, value string) partitioned by (level1 string, level2 string, level3 string);

insert overwrite table partition_test_multilevel partition(level1=&lt;span class=&quot;code-quote&quot;&gt;&apos;1111&apos;&lt;/span&gt;, level2=&lt;span class=&quot;code-quote&quot;&gt;&apos;111&apos;&lt;/span&gt;, level3=&lt;span class=&quot;code-quote&quot;&gt;&apos;11&apos;&lt;/span&gt;) select key, value from srcpart tablesample (11 rows);
insert overwrite table partition_test_multilevel partition(level1=&lt;span class=&quot;code-quote&quot;&gt;&apos;1111&apos;&lt;/span&gt;, level2=&lt;span class=&quot;code-quote&quot;&gt;&apos;222&apos;&lt;/span&gt;, level3=&lt;span class=&quot;code-quote&quot;&gt;&apos;11&apos;&lt;/span&gt;) select key, value from srcpart tablesample (15 rows);
insert overwrite table partition_test_multilevel partition(level1=&lt;span class=&quot;code-quote&quot;&gt;&apos;1111&apos;&lt;/span&gt;, level2=&lt;span class=&quot;code-quote&quot;&gt;&apos;333&apos;&lt;/span&gt;, level3=&lt;span class=&quot;code-quote&quot;&gt;&apos;11&apos;&lt;/span&gt;) select key, value from srcpart tablesample (20 rows);

select level1, level2, level3, count(*) from partition_test_multilevel where level2 &amp;lt;= &lt;span class=&quot;code-quote&quot;&gt;&apos;222&apos;&lt;/span&gt; group by level1, level2, level3;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The query fails with following error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;      Caused by: org.apache.hadoop.hive.ql.parse.SemanticException: MetaException(message:Invocation of method &lt;span class=&quot;code-quote&quot;&gt;&quot;substring&quot;&lt;/span&gt; on &lt;span class=&quot;code-quote&quot;&gt;&quot;StringExpression&quot;&lt;/span&gt; requires argument 1 of type &lt;span class=&quot;code-quote&quot;&gt;&quot;NumericExpression&quot;&lt;/span&gt;)
	at org.apache.hadoop.hive.ql.optimizer.ppr.PartitionPruner.getPartitionsFromServer(PartitionPruner.java:392)
	at org.apache.hadoop.hive.ql.optimizer.ppr.PartitionPruner.prune(PartitionPruner.java:215)
	at org.apache.hadoop.hive.ql.optimizer.ppr.PartitionPruner.prune(PartitionPruner.java:139)
	at org.apache.hadoop.hive.ql.parse.ParseContext.getPrunedPartitions(ParseContext.java:619)
	at org.apache.hadoop.hive.ql.optimizer.pcr.PcrOpProcFactory$FilterPCR.process(PcrOpProcFactory.java:110)
	... 21 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It is because the JDO pushdown filter generated for a query having inequality/between partition predicate uses DN indexOf function which is not working properly with postgresql (see &lt;a href=&quot;http://www.datanucleus.org/servlet/jira/browse/NUCRDBMS-840&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.datanucleus.org/servlet/jira/browse/NUCRDBMS-840&lt;/a&gt;) &lt;/p&gt;</description>
                <environment></environment>
        <key id="12753763">HIVE-8784</key>
            <summary>Querying partition does not work with JDO enabled against PostgreSQL</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ctang">Chaoyu Tang</assignee>
                                    <reporter username="ctang">Chaoyu Tang</reporter>
                        <labels>
                    </labels>
                <created>Fri, 7 Nov 2014 18:43:10 +0000</created>
                <updated>Thu, 19 Feb 2015 18:21:57 +0000</updated>
                            <resolved>Tue, 11 Nov 2014 23:47:48 +0000</resolved>
                                    <version>0.14.1</version>
                                    <fixVersion>1.0.0</fixVersion>
                                    <component>Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14202443" author="ctang.ma" created="Fri, 7 Nov 2014 18:53:00 +0000"  >&lt;p&gt;Hive (see generateJDOFilterOverPartitions in org.apache.hadoop.hive.metastore.parser.ExpressTree) is currently using some DN string functions (substring, indexOf) to get the value for a partitionKey. Actually there is a straightforward way (as implemented in this patch) to get it which in addition avoids the DN indexOf issue with postgresql.&lt;/p&gt;

&lt;p&gt;The test cases provided in this patch have been tested against various DB including Derby, Mysql and PostgreSQL etc.&lt;/p&gt;</comment>
                            <comment id="14202466" author="ctang.ma" created="Fri, 7 Nov 2014 19:04:07 +0000"  >&lt;p&gt;Patch is posted on RB and requesting for the review, see &lt;a href=&quot;https://reviews.apache.org/r/27737/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/27737/&lt;/a&gt; , thanks.&lt;/p&gt;</comment>
                            <comment id="14202683" author="hiveqa" created="Fri, 7 Nov 2014 21:10:44 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12680221/HIVE-8784.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12680221/HIVE-8784.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 6670 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1690/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1690/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1690/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1690/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1690/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1690/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12680221 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14204984" author="ctang.ma" created="Mon, 10 Nov 2014 16:57:27 +0000"  >&lt;p&gt;Add more test cases using orm and directsql.&lt;/p&gt;</comment>
                            <comment id="14205179" author="szehon" created="Mon, 10 Nov 2014 19:12:50 +0000"  >&lt;p&gt;+1 looks good to me.  Wonder if &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt; has any comment on this?&lt;/p&gt;</comment>
                            <comment id="14205191" author="ctang.ma" created="Mon, 10 Nov 2014 19:27:59 +0000"  >&lt;p&gt;Rename &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-8784&quot; title=&quot;Querying partition does not work with JDO enabled against PostgreSQL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-8784&quot;&gt;&lt;del&gt;HIVE-8784&lt;/del&gt;&lt;/a&gt;_1.patch to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-8784&quot; title=&quot;Querying partition does not work with JDO enabled against PostgreSQL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-8784&quot;&gt;&lt;del&gt;HIVE-8784&lt;/del&gt;&lt;/a&gt;.1.patch to enable pre-commit test.&lt;/p&gt;</comment>
                            <comment id="14205195" author="sershe" created="Mon, 10 Nov 2014 19:32:10 +0000"  >&lt;p&gt;+1, using values.get was mentioned in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4888&quot; title=&quot;listPartitionsByFilter doesn&amp;#39;t support lt/gt/lte/gte&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4888&quot;&gt;&lt;del&gt;HIVE-4888&lt;/del&gt;&lt;/a&gt;, back then the DN version was too old. We should be good now I hope &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14206986" author="szehon" created="Tue, 11 Nov 2014 20:16:29 +0000"  >&lt;p&gt;Reattaching same patch to trigger another build.  Build machine was down.&lt;/p&gt;</comment>
                            <comment id="14207332" author="hiveqa" created="Tue, 11 Nov 2014 23:35:29 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12680867/HIVE-8784.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12680867/HIVE-8784.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 6687 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1740/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1740/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1740/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1740/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1740/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1740/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12680867 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14207355" author="szehon" created="Tue, 11 Nov 2014 23:47:48 +0000"  >&lt;p&gt;Lucky patch to get +1 from HiveQA.&lt;/p&gt;

&lt;p&gt;Committed to trunk.  Thanks Chaoyu for contribution and Sergey for additional review!&lt;/p&gt;</comment>
                            <comment id="14221743" author="hagleitn" created="Sat, 22 Nov 2014 02:05:02 +0000"  >&lt;p&gt;Should we/can we commit this to branch-14 for 14.1? Seems like this would affect 0.14.0 too.&lt;/p&gt;</comment>
                            <comment id="14221749" author="szehon" created="Sat, 22 Nov 2014 02:13:54 +0000"  >&lt;p&gt;Sure, I will do that.&lt;/p&gt;</comment>
                            <comment id="14223801" author="szehon" created="Tue, 25 Nov 2014 00:09:57 +0000"  >&lt;p&gt;Committed to 0.14 branch&lt;/p&gt;</comment>
                            <comment id="14327571" author="thejas" created="Thu, 19 Feb 2015 14:45:05 +0000"  >&lt;p&gt;Updating release version for jiras resolved in 1.0.0 .&lt;/p&gt;</comment>
                            <comment id="14327869" author="thejas" created="Thu, 19 Feb 2015 18:21:57 +0000"  >&lt;p&gt;This issue has been fixed in Apache Hive 1.0.0. If there is any issue with the fix, please open a new jira to address it.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12680867" name="HIVE-8784.1.patch" size="117625" author="szehon" created="Tue, 11 Nov 2014 20:16:29 +0000"/>
                            <attachment id="12680631" name="HIVE-8784.1.patch" size="117625" author="ctang" created="Mon, 10 Nov 2014 19:27:59 +0000"/>
                            <attachment id="12680221" name="HIVE-8784.patch" size="79002" author="ctang" created="Fri, 7 Nov 2014 18:53:00 +0000"/>
                            <attachment id="12680602" name="HIVE-8784_1.patch" size="117625" author="ctang" created="Mon, 10 Nov 2014 16:57:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 39 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i22493:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>