<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:26:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-28958] Tez job failed with: NoClassDefFoundError: org/locationtech/jts/geom/Geometry</title>
                <link>https://issues.apache.org/jira/browse/HIVE-28958</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Tested with Hadoop3.3.6 &amp;amp; Tez0.10.4 &amp;amp; latest Hive master branch:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
create table test1(id &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) stored as orc;

insert into test1 values(11);
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Tez job failed with &lt;font color=&quot;#FF0000&quot;&gt;java.lang.NoClassDefFoundError: org/locationtech/jts/geom/Geometry&lt;/font&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
----------------------------------------------------------------------------------------------
&#160; &#160; &#160; &#160; VERTICES &#160; &#160; &#160;MODE &#160; &#160; &#160; &#160;STATUS &#160;TOTAL &#160;COMPLETED &#160;RUNNING &#160;PENDING &#160;FAILED &#160;KILLED
----------------------------------------------------------------------------------------------
Map 1 &#160; &#160; &#160; &#160; &#160; &#160;container &#160; &#160; &#160; RUNNING &#160; &#160; &#160;1 &#160; &#160; &#160; &#160; &#160;0 &#160; &#160; &#160; &#160;0 &#160; &#160; &#160; &#160;1 &#160; &#160; &#160; 4 &#160; &#160; &#160; 0
Reducer 2 &#160; &#160; &#160; &#160;container &#160; &#160; &#160; &#160;INITED &#160; &#160; &#160;1 &#160; &#160; &#160; &#160; &#160;0 &#160; &#160; &#160; &#160;0 &#160; &#160; &#160; &#160;1 &#160; &#160; &#160; 0 &#160; &#160; &#160; 0
----------------------------------------------------------------------------------------------
VERTICES: 00/02 &#160;[&amp;gt;&amp;gt;--------------------------] 0% &#160; &#160;ELAPSED TIME: 736.43 s
----------------------------------------------------------------------------------------------
ERROR : Status: Failed
ERROR : Vertex failed, vertexName=Map 1, vertexId=vertex_1747277688249_0002_1_00, diagnostics=[Task failed, taskId=task_1747277688249_0002_1_00_000000, diagnostics=[TaskAttempt 0 failed, info=[Error: Node: olap-9-13/100.71.9.13 : Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running task ( failure ) : attempt_1747277688249_0002_1_00_000000_0:java.lang.RuntimeException: java.lang.RuntimeException: Map &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; initialization failed
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:348)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:276)
&#160; &#160; &#160; &#160; at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:381)
&#160; &#160; &#160; &#160; at org.apache.tez.runtime.task.TaskRunner2Callable$1.run(TaskRunner2Callable.java:86)
&#160; &#160; &#160; &#160; at org.apache.tez.runtime.task.TaskRunner2Callable$1.run(TaskRunner2Callable.java:72)
&#160; &#160; &#160; &#160; at java.security.AccessController.doPrivileged(Native Method)
&#160; &#160; &#160; &#160; at javax.security.auth.Subject.doAs(Subject.java:422)
&#160; &#160; &#160; &#160; at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899)
&#160; &#160; &#160; &#160; at org.apache.tez.runtime.task.TaskRunner2Callable.callInternal(TaskRunner2Callable.java:72)
&#160; &#160; &#160; &#160; at org.apache.tez.runtime.task.TaskRunner2Callable.callInternal(TaskRunner2Callable.java:42)
&#160; &#160; &#160; &#160; at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
&#160; &#160; &#160; &#160; at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:125)
&#160; &#160; &#160; &#160; at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:57)
&#160; &#160; &#160; &#160; at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:78)
&#160; &#160; &#160; &#160; at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
&#160; &#160; &#160; &#160; at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
&#160; &#160; &#160; &#160; at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
Caused by: java.lang.RuntimeException: Map &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; initialization failed
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.tez.MapRecordProcessor.init(MapRecordProcessor.java:351)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:292)
&#160; &#160; &#160; &#160; ... 16 more
Caused by: java.lang.NoClassDefFoundError: org/locationtech/jts/geom/Geometry
&#160; &#160; &#160; &#160; at org.apache.calcite.sql.type.JavaToSqlTypeConversionRules.&amp;lt;init&amp;gt;(JavaToSqlTypeConversionRules.java:74)
&#160; &#160; &#160; &#160; at org.apache.calcite.sql.type.JavaToSqlTypeConversionRules.&amp;lt;clinit&amp;gt;(JavaToSqlTypeConversionRules.java:41)
&#160; &#160; &#160; &#160; at org.apache.calcite.jdbc.JavaTypeFactoryImpl.createType(JavaTypeFactoryImpl.java:153)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.DataSketchesFunctions$SketchFunctionDescriptor.getReturnRelDataType(DataSketchesFunctions.java:245)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.DataSketchesFunctions.registerAsHiveFunction(DataSketchesFunctions.java:168)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.DataSketchesFunctions.buildCalciteFns(DataSketchesFunctions.java:130)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.DataSketchesFunctions.&amp;lt;init&amp;gt;(DataSketchesFunctions.java:99)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.DataSketchesFunctions.&amp;lt;clinit&amp;gt;(DataSketchesFunctions.java:56)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.FunctionRegistry.&amp;lt;clinit&amp;gt;(FunctionRegistry.java:580)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.ExprNodeGenericFuncEvaluator.isDeterministic(ExprNodeGenericFuncEvaluator.java:188)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.ExprNodeEvaluator.isConsistentWithinQuery(ExprNodeEvaluator.java:117)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.ExprNodeEvaluatorFactory.iterate(ExprNodeEvaluatorFactory.java:102)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.ExprNodeEvaluatorFactory.toCachedEvals(ExprNodeEvaluatorFactory.java:76)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.SelectOperator.initializeOp(SelectOperator.java:70)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:360)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:549)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.Operator.initializeChildren(Operator.java:503)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:369)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.MapOperator.initializeMapOperator(MapOperator.java:511)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.exec.tez.MapRecordProcessor.init(MapRecordProcessor.java:314)
&#160; &#160; &#160; &#160; ... 17 more
Caused by: java.lang.ClassNotFoundException: org.locationtech.jts.geom.Geometry
&#160; &#160; &#160; &#160; at java.net.URLClassLoader.findClass(URLClassLoader.java:382)
&#160; &#160; &#160; &#160; at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.loadClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:424)
&#160; &#160; &#160; &#160; at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:349)
&#160; &#160; &#160; &#160; at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.loadClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:357)
&#160; &#160; &#160; &#160; ... 37 more
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13618158">HIVE-28958</key>
            <summary>Tez job failed with: NoClassDefFoundError: org/locationtech/jts/geom/Geometry</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zhangbutao">Butao Zhang</assignee>
                                    <reporter username="zhangbutao">Butao Zhang</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 15 May 2025 03:16:43 +0000</created>
                <updated>Tue, 29 Jul 2025 14:52:08 +0000</updated>
                            <resolved>Sun, 25 May 2025 06:29:44 +0000</resolved>
                                                    <fixVersion>4.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17951612" author="zhangbutao" created="Thu, 15 May 2025 06:25:15 +0000"  >&lt;p&gt;I just found&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-27102&quot; title=&quot;Upgrade Calcite to 1.33.0 and Avatica to 1.23.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-27102&quot;&gt;&lt;del&gt;HIVE-27102&lt;/del&gt;&lt;/a&gt; introduced the dependency jts-core, which may releate to this issue.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/hive/blob/88cc6fddab918ecb188082ca30b6bada517d0d92/pom.xml#L354-#L359&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/blob/88cc6fddab918ecb188082ca30b6bada517d0d92/pom.xml#L354-#L359&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160; &#160; &#160; &amp;lt;dependency&amp;gt;
&#160; &#160; &#160; &#160; &amp;lt;groupId&amp;gt;org.locationtech.jts&amp;lt;/groupId&amp;gt;
&#160; &#160; &#160; &#160; &amp;lt;artifactId&amp;gt;jts-core&amp;lt;/artifactId&amp;gt;
&#160; &#160; &#160; &#160; &amp;lt;version&amp;gt;${jts.version}&amp;lt;/version&amp;gt;
&#160; &#160; &#160; &#160; &amp;lt;scope&amp;gt;runtime&amp;lt;/scope&amp;gt;
&#160; &#160; &#160; &amp;lt;/dependency&amp;gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Do you think this dependency jts-core is related to this tez job issue? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zabetak&quot; class=&quot;user-hover&quot; rel=&quot;zabetak&quot;&gt;zabetak&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17951630" author="zabetak" created="Thu, 15 May 2025 07:40:18 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zhangbutao&quot; class=&quot;user-hover&quot; rel=&quot;zhangbutao&quot;&gt;zhangbutao&lt;/a&gt; , yes the problem seems related to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-27102&quot; title=&quot;Upgrade Calcite to 1.33.0 and Avatica to 1.23.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-27102&quot;&gt;&lt;del&gt;HIVE-27102&lt;/del&gt;&lt;/a&gt;. However, since the dependency of jts-core is declared the jar should be in the classpath. I checked for the Geometry class and seems to be present in the jar.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; jar tf jts-core-1.19.0.jar | grep Geometry\.class
org/locationtech/jts/algorithm/locate/IndexedPointInAreaLocator$IntervalIndexedGeometry.class
org/locationtech/jts/geom/Geometry.class
org/locationtech/jts/geom/prep/BasicPreparedGeometry.class
org/locationtech/jts/geom/prep/PreparedGeometry.class
org/locationtech/jts/operation/overlayng/InputGeometry.class
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;What may be happening is that the jts-core jar is not present in the classpath of the Tez job so we may need to shade it inside the hive-exec jar similar to what we do for other deps.&lt;/p&gt;</comment>
                            <comment id="17951631" author="zabetak" created="Thu, 15 May 2025 07:42:49 +0000"  >&lt;p&gt;In order to see how to fix this we probably need more details on the steps that you did to create the Hive binaries.&lt;/p&gt;</comment>
                            <comment id="17951643" author="ayushtkn" created="Thu, 15 May 2025 08:46:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zhangbutao&quot; class=&quot;user-hover&quot; rel=&quot;zhangbutao&quot;&gt;zhangbutao&lt;/a&gt; I deployed hive-4.1.0-SNAPSHOT with hadoop-3.4.1 &amp;amp; tez-0.10.5 via docker &amp;amp; I didn&apos;t get any such error.&lt;/p&gt;</comment>
                            <comment id="17951647" author="zhangbutao" created="Thu, 15 May 2025 09:04:37 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
In order to see how to fix &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; we probably need more details on the steps that you did to create the Hive binaries.&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zabetak&quot; class=&quot;user-hover&quot; rel=&quot;zabetak&quot;&gt;zabetak&lt;/a&gt; I built Hive binaries using cmd: &lt;b&gt;mvn clean install -DskipTests -Pdist ,&lt;/b&gt; and then deploy hive using the tar &lt;b&gt;hive/packaging/target/apache-hive-4.1.0-SNAPSHOT-bin.tar.gz&lt;/b&gt;&lt;/p&gt;</comment>
                            <comment id="17951648" author="zhangbutao" created="Thu, 15 May 2025 09:05:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ayushtkn&quot; class=&quot;user-hover&quot; rel=&quot;ayushtkn&quot;&gt;ayushtkn&lt;/a&gt; I&apos;m not using Docker. I&apos;m deploying it locally on my physical machine. I&apos;ve tried several times but still have this problem.&lt;/p&gt;</comment>
                            <comment id="17951670" author="ayushtkn" created="Thu, 15 May 2025 09:53:41 +0000"  >&lt;p&gt;I built the binary locally using mvn clean install -DskipTests -Pdist, Deployed Hadoop-3.4.1 locally using the release tar on hadoop website.&lt;br/&gt;
Deployed the Hadoop nodes locally on my Mac &amp;amp; then HiveServer2 with Derby&lt;br/&gt;
&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13076512/13076512_HS2-Software_attr.png&quot; height=&quot;115&quot; width=&quot;555&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&amp;amp; it still worked for me. &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13076513/13076513_hive-4-non-docker.rtf&quot; title=&quot;hive-4-non-docker.rtf attached to HIVE-28958&quot;&gt;hive-4-non-docker.rtf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zhangbutao&quot; class=&quot;user-hover&quot; rel=&quot;zhangbutao&quot;&gt;zhangbutao&lt;/a&gt; can you check if I did something different/wrong here&lt;/p&gt;</comment>
                            <comment id="17951674" author="ayushtkn" created="Thu, 15 May 2025 10:12:09 +0000"  >&lt;p&gt;Finally I am able to reproduce this&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Status: Failed
Vertex failed, vertexName=Map 1, vertexId=vertex_1747302879105_0005_1_00, diagnostics=[Task failed, taskId=task_1747302879105_0005_1_00_000000, diagnostics=[TaskAttempt 0 failed, info=[Error: Node: ayushsaxena/127.0.0.1 : Error while running task ( failure ) : attempt_1747302879105_0005_1_00_000000_0:java.lang.RuntimeException: java.lang.RuntimeException: Map operator initialization failed
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:348)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:276)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:381)
	at org.apache.tez.runtime.task.TaskRunner2Callable$1.run(TaskRunner2Callable.java:86)
	at org.apache.tez.runtime.task.TaskRunner2Callable$1.run(TaskRunner2Callable.java:72)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.tez.runtime.task.TaskRunner2Callable.callInternal(TaskRunner2Callable.java:72)
	at org.apache.tez.runtime.task.TaskRunner2Callable.callInternal(TaskRunner2Callable.java:42)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:131)
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:75)
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:82)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.RuntimeException: Map operator initialization failed
	at org.apache.hadoop.hive.ql.exec.tez.MapRecordProcessor.init(MapRecordProcessor.java:351)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:292)
	... 16 more
Caused by: java.lang.NoClassDefFoundError: org/locationtech/jts/geom/Geometry
	at org.apache.calcite.sql.type.JavaToSqlTypeConversionRules.&amp;lt;init&amp;gt;(JavaToSqlTypeConversionRules.java:74)
	at org.apache.calcite.sql.type.JavaToSqlTypeConversionRules.&amp;lt;clinit&amp;gt;(JavaToSqlTypeConversionRules.java:41)
	at org.apache.calcite.jdbc.JavaTypeFactoryImpl.createType(JavaTypeFactoryImpl.java:153)
	at org.apache.hadoop.hive.ql.exec.DataSketchesFunctions$SketchFunctionDescriptor.getReturnRelDataType(DataSketchesFunctions.java:245)
	at org.apache.hadoop.hive.ql.exec.DataSketchesFunctions.registerAsHiveFunction(DataSketchesFunctions.java:168)
	at org.apache.hadoop.hive.ql.exec.DataSketchesFunctions.buildCalciteFns(DataSketchesFunctions.java:130)
	at org.apache.hadoop.hive.ql.exec.DataSketchesFunctions.&amp;lt;init&amp;gt;(DataSketchesFunctions.java:99)
	at org.apache.hadoop.hive.ql.exec.DataSketchesFunctions.&amp;lt;clinit&amp;gt;(DataSketchesFunctions.java:56)
	at org.apache.hadoop.hive.ql.exec.FunctionRegistry.&amp;lt;clinit&amp;gt;(FunctionRegistry.java:580)
	at org.apache.hadoop.hive.ql.exec.ExprNodeGenericFuncEvaluator.isDeterministic(ExprNodeGenericFuncEvaluator.java:188)
	at org.apache.hadoop.hive.ql.exec.ExprNodeEvaluator.isConsistentWithinQuery(ExprNodeEvaluator.java:117)
	at org.apache.hadoop.hive.ql.exec.ExprNodeEvaluatorFactory.iterate(ExprNodeEvaluatorFactory.java:102)
	at org.apache.hadoop.hive.ql.exec.ExprNodeEvaluatorFactory.toCachedEvals(ExprNodeEvaluatorFactory.java:76)
	at org.apache.hadoop.hive.ql.exec.SelectOperator.initializeOp(SelectOperator.java:70)
	at org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:360)
	at org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:549)
	at org.apache.hadoop.hive.ql.exec.Operator.initializeChildren(Operator.java:503)
	at org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:369)
	at org.apache.hadoop.hive.ql.exec.MapOperator.initializeMapOperator(MapOperator.java:511)
	at org.apache.hadoop.hive.ql.exec.tez.MapRecordProcessor.init(MapRecordProcessor.java:314)
	... 17 more
Caused by: java.lang.ClassNotFoundException: org.locationtech.jts.geom.Geometry
	at java.net.URLClassLoader.findClass(URLClassLoader.java:387)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:419)
	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:352)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:352)
	... 37 more&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zabetak&quot; class=&quot;user-hover&quot; rel=&quot;zabetak&quot;&gt;zabetak&lt;/a&gt; This is reproducible on hive master, mvn clean install -DskipTests -Pdist. on my local Mac with Tez.&lt;/p&gt;

&lt;p&gt;The only config that I had to set was&#160;set tez.local.mode=false; On Tez local mode it didn&apos;t repro.&lt;/p&gt;</comment>
                            <comment id="17951721" author="ayushtkn" created="Thu, 15 May 2025 12:17:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zhangbutao&quot; class=&quot;user-hover&quot; rel=&quot;zhangbutao&quot;&gt;zhangbutao&lt;/a&gt; I tried to fix locally. I think this dependency is required by Tez at runtime. Something like this fixes this for me&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;diff --git a/pom.xml b/pom.xml
index f7f5a80fe0..e35b324e92 100644
--- a/pom.xml
+++ b/pom.xml
@@ -355,7 +355,6 @@
&#160; &#160; &#160; &#160; &#160;&amp;lt;groupId&amp;gt;org.locationtech.jts&amp;lt;/groupId&amp;gt;
&#160; &#160; &#160; &#160; &#160;&amp;lt;artifactId&amp;gt;jts-core&amp;lt;/artifactId&amp;gt;
&#160; &#160; &#160; &#160; &#160;&amp;lt;version&amp;gt;${jts.version}&amp;lt;/version&amp;gt;
- &#160; &#160; &#160; &#160;&amp;lt;scope&amp;gt;runtime&amp;lt;/scope&amp;gt;
&#160; &#160; &#160; &#160;&amp;lt;/dependency&amp;gt;
&#160; &#160; &#160; &#160;&amp;lt;dependency&amp;gt;
&#160; &#160; &#160; &#160; &#160;&amp;lt;groupId&amp;gt;com.sun.jersey&amp;lt;/groupId&amp;gt;
diff --git a/ql/pom.xml b/ql/pom.xml
index ab72ea4ba8..a3ca875d5f 100644
--- a/ql/pom.xml
+++ b/ql/pom.xml
@@ -1109,6 +1109,7 @@
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;include&amp;gt;com.esri.geometry:esri-geometry-api&amp;lt;/include&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;include&amp;gt;org.roaringbitmap:RoaringBitmap&amp;lt;/include&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;include&amp;gt;com.github.luben:zstd-jni&amp;lt;/include&amp;gt;
+ &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;include&amp;gt;org.locationtech.jts:jts-core&amp;lt;/include&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;/includes&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;/artifactSet&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;filters&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If it fixes for you as well, can create a PR, I am +1 for it&lt;/p&gt;</comment>
                            <comment id="17951729" author="zabetak" created="Thu, 15 May 2025 12:50:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ayushtkn&quot; class=&quot;user-hover&quot; rel=&quot;ayushtkn&quot;&gt;ayushtkn&lt;/a&gt; Your proposed solution is inline with what I had in mind when I suggested including jts-core in the shaded hive-exec jar. If fact, it may be feasible to drop the explicitly added jts-core dependency from the ql module and just keep the inclusion directive (since jts-core is a transitive dep coming from Calcite).&lt;/p&gt;</comment>
                            <comment id="17952012" author="zhangbutao" created="Fri, 16 May 2025 05:44:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ayushtkn&quot; class=&quot;user-hover&quot; rel=&quot;ayushtkn&quot;&gt;ayushtkn&lt;/a&gt; Fix worked for me. I&apos;m wondering how to remove this dependency jts-core-1.19.0.jar from the lib directory, because at present, hive doesn&apos;t require this dependency, only Tez job needs the jts dependency.&lt;/p&gt;</comment>
                            <comment id="17953889" author="zhangbutao" created="Sun, 25 May 2025 06:29:44 +0000"  >&lt;p&gt;Fix has been merged into master branch! Thanks all!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13525912">HIVE-27102</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13076512" name="HS2-Software_attr.png" size="102054" author="ayushtkn" created="Thu, 15 May 2025 09:49:06 +0000"/>
                            <attachment id="13076513" name="hive-4-non-docker.rtf" size="9728" author="ayushtkn" created="Thu, 15 May 2025 09:49:22 +0000"/>
                            <attachment id="13076509" name="hive-4-tez0.10.5.rtf" size="11279" author="ayushtkn" created="Thu, 15 May 2025 08:45:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            24 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1vuy0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>