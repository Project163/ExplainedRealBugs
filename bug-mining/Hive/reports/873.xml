<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:01:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-3206] FileUtils.tar assumes wrong directory in some cases</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3206</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Bucket mapjoin throws exception archiving stored hashtables. &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hive&amp;gt; set hive.optimize.bucketmapjoin = true;
hive&amp;gt; select /*+mapjoin(a)*/ a.key, a.value, b.value 
    &amp;gt; from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b 
    &amp;gt; on a.key=b.key;
Total MapReduce jobs = 1
12/06/28 12:36:18 WARN conf.HiveConf: DEPRECATED: Ignoring hive-default.xml found on the CLASSPATH at /home/navis/hive/conf/hive-default.xml
Execution log at: /tmp/navis/navis_20120628123636_5298a863-605c-4b98-bbb3-0a132c85c5a3.log
2012-06-28 12:36:18	Starting to launch local task to process map join;	maximum memory = 932118528
2012-06-28 12:36:18	Processing rows:	153	Hashtable size:	153	Memory usage:	1771376	rate:	0.002
2012-06-28 12:36:18	Dump the hashtable into file: file:/tmp/navis/hive_2012-06-28_12-36-17_003_3016196240171705142/-local-10002/HashTable-Stage-1/MapJoin-a-00-srcbucket22.txt.hashtable
2012-06-28 12:36:18	Upload 1 File to: file:/tmp/navis/hive_2012-06-28_12-36-17_003_3016196240171705142/-local-10002/HashTable-Stage-1/MapJoin-a-00-srcbucket22.txt.hashtable File size: 9644
2012-06-28 12:36:19	Processing rows:	309	Hashtable size:	156	Memory usage:	1844568	rate:	0.002
2012-06-28 12:36:19	Dump the hashtable into file: file:/tmp/navis/hive_2012-06-28_12-36-17_003_3016196240171705142/-local-10002/HashTable-Stage-1/MapJoin-a-00-srcbucket23.txt.hashtable
2012-06-28 12:36:19	Upload 1 File to: file:/tmp/navis/hive_2012-06-28_12-36-17_003_3016196240171705142/-local-10002/HashTable-Stage-1/MapJoin-a-00-srcbucket23.txt.hashtable File size: 10023
2012-06-28 12:36:19	End of local task; Time Taken: 0.773 sec.
Execution completed successfully
Mapred Local Task Succeeded . Convert the Join into MapJoin
Mapred Local Task Succeeded . Convert the Join into MapJoin
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there&apos;s no reduce operator
java.io.IOException: This archives contains unclosed entries.
	at org.apache.commons.compress.archivers.tar.TarArchiveOutputStream.finish(TarArchiveOutputStream.java:214)
	at org.apache.hadoop.hive.common.FileUtils.tar(FileUtils.java:276)
	at org.apache.hadoop.hive.ql.exec.ExecDriver.execute(ExecDriver.java:391)
	at org.apache.hadoop.hive.ql.exec.MapRedTask.execute(MapRedTask.java:137)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:134)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:57)
	at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1324)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1110)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:944)
	at org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:258)
	at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:215)
	at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:406)
	at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:744)
	at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:607)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:186)
Job Submission failed with exception &apos;java.io.IOException(This archives contains unclosed entries.)&apos;
java.lang.IllegalArgumentException: Can not create a Path from an empty string
	at org.apache.hadoop.fs.Path.checkPathArg(Path.java:82)
	at org.apache.hadoop.fs.Path.&amp;lt;init&amp;gt;(Path.java:90)
	at org.apache.hadoop.hive.ql.exec.Utilities.getHiveJobID(Utilities.java:380)
	at org.apache.hadoop.hive.ql.exec.Utilities.clearMapRedWork(Utilities.java:193)
	at org.apache.hadoop.hive.ql.exec.ExecDriver.execute(ExecDriver.java:460)
	at org.apache.hadoop.hive.ql.exec.MapRedTask.execute(MapRedTask.java:137)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:134)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:57)
	at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1324)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1110)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:944)
	at org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:258)
	at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:215)
	at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:406)
	at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:744)
	at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:607)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:186)
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MapRedTask
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Seemed to be regression from &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3128&quot; title=&quot;use commons-compress instead of forking tar process&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3128&quot;&gt;&lt;del&gt;HIVE-3128&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12596205">HIVE-3206</key>
            <summary>FileUtils.tar assumes wrong directory in some cases</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="navis">Navis Ryu</assignee>
                                    <reporter username="navis">Navis Ryu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 28 Jun 2012 03:40:13 +0000</created>
                <updated>Thu, 10 Jan 2013 19:53:35 +0000</updated>
                            <resolved>Tue, 3 Jul 2012 00:00:38 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.10.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                                                            <comments>
                            <comment id="13402823" author="navis" created="Thu, 28 Jun 2012 04:00:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://reviews.facebook.net/D3861&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D3861&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Working directory could be different from temp directory for MapredLocalWork (intentional?), so just prepended the temp directory as a parent of stored files with some error handling.&lt;/p&gt;</comment>
                            <comment id="13402835" author="appodictic" created="Thu, 28 Jun 2012 04:26:38 +0000"  >&lt;p&gt;Did you very-clean? The tests look ok.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;edward@tablitha trunk&amp;#93;&lt;/span&gt;$ ant test -Dtestcase=TestCliDriver -Dqfile=bucketmapjoin1.q&lt;br/&gt;
BUILD SUCCESSFUL&lt;br/&gt;
Total time: 4 minutes 18 seconds&lt;/p&gt;</comment>
                            <comment id="13402840" author="appodictic" created="Thu, 28 Jun 2012 04:41:20 +0000"  >&lt;p&gt;@Navis is there any way we can unit test here. This slipped through the unit testing.&lt;/p&gt;</comment>
                            <comment id="13402843" author="appodictic" created="Thu, 28 Jun 2012 04:47:31 +0000"  >&lt;p&gt;Please ignore here. There is not much that can be done about this one unit test wise. +1&lt;/p&gt;</comment>
                            <comment id="13402847" author="appodictic" created="Thu, 28 Jun 2012 05:00:38 +0000"  >&lt;p&gt;Resolved. Thanks Navis.&lt;/p&gt;</comment>
                            <comment id="13402853" author="navis" created="Thu, 28 Jun 2012 05:11:44 +0000"  >&lt;p&gt;Committed this fast? o.o &lt;br/&gt;
I missed to close input files. Could you change the fetch if not yet committed?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;IOUtils.copy(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileInputStream(f), tOut); &lt;span class=&quot;code-comment&quot;&gt;// copy with 8K buffer, not close
&lt;/span&gt;--&amp;gt;
FileInputStream input = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileInputStream(f);
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
  IOUtils.copy(input, tOut); &lt;span class=&quot;code-comment&quot;&gt;// copy with 8K buffer, not close
&lt;/span&gt;} &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
  input.close();
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13402859" author="kannakar@microsoft.com" created="Thu, 28 Jun 2012 05:24:49 +0000"  >&lt;p&gt;@Navis - Would it be possible to update/add aunit test? it looks like some settings are missing in the .q file.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13402861" author="appodictic" created="Thu, 28 Jun 2012 05:30:18 +0000"  >&lt;p&gt;@Navis please supply a patch to place on top of this one. Or we can revert the change and supply a fully patch.&lt;/p&gt;</comment>
                            <comment id="13402878" author="navis" created="Thu, 28 Jun 2012 05:55:27 +0000"  >&lt;p&gt;@Kanna Karanam - Some problems are not shown by hive test framework. I don&apos;t know why.&lt;br/&gt;
@Edward Capriolo - Added &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3207&quot; title=&quot;FileUtils.tar does not close input files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3207&quot;&gt;&lt;del&gt;HIVE-3207&lt;/del&gt;&lt;/a&gt;. Sorry for your inconvenience.&lt;/p&gt;</comment>
                            <comment id="13403020" author="hudson" created="Thu, 28 Jun 2012 11:41:12 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1518 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1518/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1518/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3206&quot; title=&quot;FileUtils.tar assumes wrong directory in some cases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3206&quot;&gt;&lt;del&gt;HIVE-3206&lt;/del&gt;&lt;/a&gt; FileUtils.tar assumes wrong directory in some cases. Navis Ryu (via egc) (Revision 1354816)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
ecapriolo : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1354816&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1354816&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/common/FileUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13548019" author="hudson" created="Wed, 9 Jan 2013 10:23:59 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #54 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3206&quot; title=&quot;FileUtils.tar assumes wrong directory in some cases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3206&quot;&gt;&lt;del&gt;HIVE-3206&lt;/del&gt;&lt;/a&gt; FileUtils.tar assumes wrong directory in some cases. Navis Ryu (via egc) (Revision 1354816)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
ecapriolo : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1354816&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1354816&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/common/FileUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13550154" author="ashutoshc" created="Thu, 10 Jan 2013 19:53:35 +0000"  >&lt;p&gt;This issue is fixed and released as part of 0.10.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12533778" name="hive-3206.1.patch.txt" size="1754" author="appodictic" created="Thu, 28 Jun 2012 04:49:51 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12596211">HIVE-3207</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>242380</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 45 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02u8n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>14500</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>