<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:20:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-25306] Change Date/Timestamp parser from LENIENT to STRICT</title>
                <link>https://issues.apache.org/jira/browse/HIVE-25306</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Description - &lt;/p&gt;

&lt;p&gt;Currently Date.java and Timestamp.java use DateTimeFormatter for parsing to convert the date/timpstamp from int,string,char etc to Date or Timestamp. &lt;/p&gt;

&lt;p&gt;Default DateTimeFormatter which use ResolverStyle.LENIENT which mean date like &quot;1992-13-12&quot; is converted to &quot;2000-01-12&quot;, &lt;/p&gt;

&lt;p&gt;Moving DateTimeFormatter which use ResolverStyle.STRICT which mean date like &quot;1992-13-12&quot; is not be converted instead NULL is return.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.google.com/document/d/1YTTPlNq3qyzlKfYVkSl3EFhVQ6-wa9WFRdkdIeCoc1Y/edit?usp=sharing&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.google.com/document/d/1YTTPlNq3qyzlKfYVkSl3EFhVQ6-wa9WFRdkdIeCoc1Y/edit?usp=sharing&lt;/a&gt; &lt;/p&gt;</description>
                <environment></environment>
        <key id="13387727">HIVE-25306</key>
            <summary>Change Date/Timestamp parser from LENIENT to STRICT</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ashish-kumar-sharma">Ashish Sharma</assignee>
                                    <reporter username="ashish-kumar-sharma">Ashish Sharma</reporter>
                        <labels>
                            <label>backwards-compatibility</label>
                            <label>datetime</label>
                            <label>pull-request-available</label>
                            <label>timestamp</label>
                    </labels>
                <created>Mon, 5 Jul 2021 12:35:08 +0000</created>
                <updated>Wed, 2 Aug 2023 13:08:27 +0000</updated>
                            <resolved>Fri, 23 Jul 2021 12:37:45 +0000</resolved>
                                                    <fixVersion>4.0.0-alpha-1</fixVersion>
                                    <component>Query Planning</component>
                    <component>UDF</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="10800">3h</timespent>
                                <comments>
                            <comment id="17378042" author="zabetak" created="Fri, 9 Jul 2021 12:49:11 +0000"  >&lt;p&gt;Thanks for working on this &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashish-kumar-sharma&quot; class=&quot;user-hover&quot; rel=&quot;ashish-kumar-sharma&quot;&gt;ashish-kumar-sharma&lt;/a&gt;! First can you clarify what will be the new behavior when an invalid date is used? Return NULL, throw exception, or something else? &lt;/p&gt;

&lt;p&gt;Since Hive 1 the parser used for dates and timestamps has been LENIENT.  With &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-20007&quot; title=&quot;Hive should carry out timestamp computations in UTC&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-20007&quot;&gt;&lt;del&gt;HIVE-20007&lt;/del&gt;&lt;/a&gt;, the parser has changed although it remained LENIENT. It is true that parsing invalid dates and getting back a valid date has been a source of confusion for quite some time now, which can be seen also from the multiple JIRAS around this topic, but I am not sure if after such a long time it is a good idea to change the behavior. Users who are relying on this LENIENT parser will consider the change as breaking and probably raise more issues to bring back the old behavior.&lt;/p&gt;

&lt;p&gt;I think the decision should not be taken lightly so I would suggest to send an email in the dev list and ask for more feedback before merging this back. &lt;/p&gt;

&lt;p&gt;Moreover, if we decide to change the behavior maybe we should check what other DBMS are doing in the case of invalid dates/timestamps in order to provide the less surprising result.&lt;/p&gt;

&lt;p&gt;Last if the change is merged we should not forget to update the respective section in the wiki:&lt;br/&gt;
&lt;a href=&quot;https://cwiki.apache.org/confluence/display/hive/languagemanual+types#LanguageManualTypes-CastingDates&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/hive/languagemanual+types#LanguageManualTypes-CastingDates&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17378049" author="ashish-kumar-sharma" created="Fri, 9 Jul 2021 13:01:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zabetak&quot; class=&quot;user-hover&quot; rel=&quot;zabetak&quot;&gt;zabetak&lt;/a&gt; thank you for providing historical context. You are right I will create a proposal doc for the same and put on the dev channel to understand communities view on it.&lt;/p&gt;</comment>
                            <comment id="17383902" author="ashish-kumar-sharma" created="Tue, 20 Jul 2021 08:50:55 +0000"  >&lt;p&gt; &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13030870/13030870_DB_compare.JPG&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; &lt;/p&gt;

&lt;p&gt;From the comparison it is quite clear that date and timestamp formatting was much tighter in older versions of HIVE. For most of the wrong date input NULL was the standard response instead of Exception. &lt;/p&gt;

&lt;p&gt;Also when I went through the code I found that. While doing the Vector implementation of some of the date related UDF like datediff etc. MySql was taken as the &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-15338?focusedCommentId=15727553&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-15727553&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;gold standard&lt;/a&gt;. So it make more sense that  we should comply with MySql as we already refer MySql as gold standard and returning NULL as result for wrong dates in cast is also &lt;a href=&quot;https://cwiki.apache.org/confluence/display/hive/languagemanual+types#LanguageManualTypes-CastingDates&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;documented &lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So I propose to make NULL as the standard response for all parsing errors.&lt;/p&gt;</comment>
                            <comment id="17384936" author="zabetak" created="Wed, 21 Jul 2021 14:54:38 +0000"  >&lt;p&gt;Thanks for the comparison &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashish-kumar-sharma&quot; class=&quot;user-hover&quot; rel=&quot;ashish-kumar-sharma&quot;&gt;ashish-kumar-sharma&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;I am adding below some observations from a few quick tests in MySQL. It seems that MySQL in some cases also returns an ERROR for invalid dates in the absence of explicit casts.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TABLE&lt;/span&gt; person (id &lt;span class=&quot;code-keyword&quot;&gt;integer&lt;/span&gt;, birth &lt;span class=&quot;code-keyword&quot;&gt;date&lt;/span&gt;);
&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; * &lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; person &lt;span class=&quot;code-keyword&quot;&gt;where&lt;/span&gt; birth &amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;1970-02-29&apos;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ERROR 1525 (HY000): Incorrect DATE value: &apos;1970-02-29&apos;
Warning (Code 1292): Incorrect date value: &apos;1970-02-29&apos; for column &apos;birth&apos; at row 1
Error (Code 1525): Incorrect DATE value: &apos;1970-02-29&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Without the explicit cast the query fails with an error due to the incorrect date.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; * &lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; person &lt;span class=&quot;code-keyword&quot;&gt;where&lt;/span&gt; birth &amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;CAST&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&apos;1970-02-29&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;DATE&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Empty set, 1 warning (0.00 sec)

Warning (Code 1292): Incorrect datetime value: &apos;1970-02-29&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;With the explicit cast the query does not fail but prints a warning and returns an empty result as expected.&lt;/p&gt;</comment>
                            <comment id="17386209" author="zabetak" created="Fri, 23 Jul 2021 12:37:45 +0000"  >&lt;p&gt;Fixed in &lt;a href=&quot;https://github.com/apache/hive/commit/ba96607e31c6ee6dcf2a7a60ac3f954d960d95ba&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ba96607e31c6ee6dcf2a7a60ac3f954d960d95ba&lt;/a&gt;. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashish-kumar-sharma&quot; class=&quot;user-hover&quot; rel=&quot;ashish-kumar-sharma&quot;&gt;ashish-kumar-sharma&lt;/a&gt; Thanks for the PR and pushing this issue past the finish line.&lt;/p&gt;</comment>
                            <comment id="17386211" author="zabetak" created="Fri, 23 Jul 2021 12:40:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashish-kumar-sharma&quot; class=&quot;user-hover&quot; rel=&quot;ashish-kumar-sharma&quot;&gt;ashish-kumar-sharma&lt;/a&gt; If you can please go over the related issues and mark as resolved those fixed by this PR.&lt;/p&gt;</comment>
                            <comment id="17387038" author="ashish-kumar-sharma" created="Mon, 26 Jul 2021 04:36:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zabetak&quot; class=&quot;user-hover&quot; rel=&quot;zabetak&quot;&gt;zabetak&lt;/a&gt; Updated the linked items. Thank you for the review and merging the code !&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13084817">HIVE-17038</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13295694">HIVE-23129</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13313116">HIVE-23752</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12530660">HIVE-2557</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12649037">HIVE-4594</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13375008">HIVE-25056</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13404061">HIVE-25576</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13030870" name="DB_compare.JPG" size="98525" author="ashish-kumar-sharma" created="Tue, 20 Jul 2021 08:49:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 16 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0smbc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Breaking change</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>