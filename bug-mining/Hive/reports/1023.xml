<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:03:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-3647] map-side groupby wrongly due to HIVE-3432</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3647</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;There seems to be a bug due to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3432&quot; title=&quot;perform a map-only group by if grouping key matches the sorting properties of the table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3432&quot;&gt;&lt;del&gt;HIVE-3432&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;We are converting the group by to a map side group by after only looking at&lt;br/&gt;
sorting columns. This can give wrong results if the data is sorted and&lt;br/&gt;
bucketed by different columns.&lt;/p&gt;

&lt;p&gt;Add some tests for that scenario, verify and fix any issues.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12614314">HIVE-3647</key>
            <summary>map-side groupby wrongly due to HIVE-3432</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="namit">Namit Jain</assignee>
                                    <reporter username="namit">Namit Jain</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Nov 2012 05:03:23 +0000</created>
                <updated>Fri, 11 Jan 2013 06:34:45 +0000</updated>
                            <resolved>Mon, 19 Nov 2012 18:48:04 +0000</resolved>
                                                    <fixVersion>0.10.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13488510" author="namit" created="Thu, 1 Nov 2012 06:51:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://reviews.facebook.net/D6369&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D6369&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13489545" author="kevinwilfong" created="Fri, 2 Nov 2012 17:08:43 +0000"  >&lt;p&gt;comment on the diff&lt;/p&gt;</comment>
                            <comment id="13489935" author="namit" created="Sat, 3 Nov 2012 05:35:31 +0000"  >&lt;p&gt;Agree with you completely, Kevin.&lt;/p&gt;

&lt;p&gt;Had not done a submit patch, since I wanted to run all the tests first.&lt;/p&gt;</comment>
                            <comment id="13490245" author="mgrover" created="Sun, 4 Nov 2012 18:30:09 +0000"  >&lt;p&gt;Are we being overly conservative by asserting the bucketing columns to be the exactly the same as sorting columns?&lt;/p&gt;

&lt;p&gt;For example, for&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CREATE TABLE T2(key STRING, val STRING)
CLUSTERED BY key SORTED BY (key, val) INTO 2 BUCKETS STORED AS TEXTFILE;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;we should still be able to optimize (as &quot;complete match&quot;) the Group by on &lt;tt&gt;key&lt;/tt&gt; alone.&lt;/p&gt;

&lt;p&gt;P.S: I don&apos;t have a phabricator account and it wouldn&apos;t let me login via my GitHub account. Not sure who to talk to.&lt;/p&gt;</comment>
                            <comment id="13492164" author="kevinwilfong" created="Wed, 7 Nov 2012 06:51:03 +0000"  >&lt;p&gt;Agreed with Mark, Namit, can you make that change as well?&lt;/p&gt;</comment>
                            <comment id="13492979" author="namit" created="Thu, 8 Nov 2012 05:58:28 +0000"  >&lt;p&gt;Thanks Mark, I will make the change&lt;/p&gt;</comment>
                            <comment id="13493411" author="kevinwilfong" created="Thu, 8 Nov 2012 19:18:03 +0000"  >&lt;p&gt;Comments on Phabricator.&lt;/p&gt;</comment>
                            <comment id="13493769" author="namit" created="Fri, 9 Nov 2012 06:42:39 +0000"  >&lt;p&gt;addressed comments + added new tests&lt;/p&gt;</comment>
                            <comment id="13493787" author="mgrover" created="Fri, 9 Nov 2012 07:06:28 +0000"  >&lt;p&gt;Made a comment on Phabricator. I didn&apos;t go through the whole review but I will do that once I hear your thoughts on the comment.&lt;/p&gt;</comment>
                            <comment id="13493818" author="namit" created="Fri, 9 Nov 2012 08:20:18 +0000"  >&lt;p&gt;Agreed, it can be incorporated, although it should not be a common case.&lt;/p&gt;

&lt;p&gt;I can add the following rule:&lt;br/&gt;
if (grouping cols == sorting Cols)&lt;br/&gt;
 if all bucketing columns are part of sorting cols (any order) &lt;br/&gt;
   complete match&lt;/p&gt;</comment>
                            <comment id="13493842" author="namit" created="Fri, 9 Nov 2012 09:19:04 +0000"  >&lt;p&gt;addressed comments from Mark.&lt;/p&gt;</comment>
                            <comment id="13494100" author="mgrover" created="Fri, 9 Nov 2012 16:35:01 +0000"  >&lt;p&gt;More comments!&lt;/p&gt;</comment>
                            <comment id="13497774" author="namit" created="Thu, 15 Nov 2012 05:32:06 +0000"  >&lt;p&gt;addressed comments&lt;/p&gt;</comment>
                            <comment id="13499038" author="kevinwilfong" created="Fri, 16 Nov 2012 19:28:13 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13500497" author="kevinwilfong" created="Mon, 19 Nov 2012 18:48:04 +0000"  >&lt;p&gt;Committed, thanks Namit.&lt;/p&gt;</comment>
                            <comment id="13500798" author="hudson" created="Tue, 20 Nov 2012 02:09:17 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1806 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1806/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1806/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3647&quot; title=&quot;map-side groupby wrongly due to HIVE-3432&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3647&quot;&gt;&lt;del&gt;HIVE-3647&lt;/del&gt;&lt;/a&gt;. map-side groupby wrongly due to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3432&quot; title=&quot;perform a map-only group by if grouping key matches the sorting properties of the table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3432&quot;&gt;&lt;del&gt;HIVE-3432&lt;/del&gt;&lt;/a&gt;. (njain via kevinwilfong) (Revision 1411349)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
kevinwilfong : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1411349&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1411349&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GroupByOptimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_2.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_3.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_4.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_5.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_skew_1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_sort_1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_sort_2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_sort_3.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_sort_4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_sort_5.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_sort_skew_1.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13548313" author="hudson" created="Wed, 9 Jan 2013 10:25:15 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #54 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3647&quot; title=&quot;map-side groupby wrongly due to HIVE-3432&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3647&quot;&gt;&lt;del&gt;HIVE-3647&lt;/del&gt;&lt;/a&gt;. map-side groupby wrongly due to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3432&quot; title=&quot;perform a map-only group by if grouping key matches the sorting properties of the table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3432&quot;&gt;&lt;del&gt;HIVE-3432&lt;/del&gt;&lt;/a&gt;. (njain via kevinwilfong) (Revision 1411349)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
kevinwilfong : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1411349&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1411349&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GroupByOptimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_2.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_3.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_4.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_5.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_skew_1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_sort_1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_sort_2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_sort_3.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_sort_4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_sort_5.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_sort_skew_1.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13550026" author="ashutoshc" created="Thu, 10 Jan 2013 19:53:06 +0000"  >&lt;p&gt;This issue is fixed and released as part of 0.10.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12627133">HIVE-3888</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12606234">HIVE-3432</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12551678" name="hive.3647.1.patch" size="24252" author="namit" created="Thu, 1 Nov 2012 06:51:56 +0000"/>
                            <attachment id="12551899" name="hive.3647.2.patch" size="24846" author="namit" created="Fri, 2 Nov 2012 18:18:41 +0000"/>
                            <attachment id="12551971" name="hive.3647.3.patch" size="28353" author="namit" created="Sat, 3 Nov 2012 05:34:44 +0000"/>
                            <attachment id="12552641" name="hive.3647.4.patch" size="51393" author="namit" created="Thu, 8 Nov 2012 10:04:44 +0000"/>
                            <attachment id="12552779" name="hive.3647.5.patch" size="67658" author="namit" created="Fri, 9 Nov 2012 06:41:45 +0000"/>
                            <attachment id="12552797" name="hive.3647.6.patch" size="103861" author="namit" created="Fri, 9 Nov 2012 09:09:56 +0000"/>
                            <attachment id="12552802" name="hive.3647.7.patch" size="103861" author="namit" created="Fri, 9 Nov 2012 09:18:42 +0000"/>
                            <attachment id="12553623" name="hive.3647.8.patch" size="103693" author="namit" created="Thu, 15 Nov 2012 05:31:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>253557</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 45 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0dv9j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>78994</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>