<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:38:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-11892] UDTF run in local fetch task does not return rows forwarded during GenericUDTF.close()</title>
                <link>https://issues.apache.org/jira/browse/HIVE-11892</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Using the example UDTF GenericUDTFCount2, which is part of hive-contrib:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;create temporary function udtfCount2 as &apos;org.apache.hadoop.hive.contrib.udtf.example.GenericUDTFCount2&apos;;

set hive.fetch.task.conversion=minimal;
-- Task created, correct output (2 rows)
select udtfCount2() from src;

set hive.fetch.task.conversion=more;
-- Runs in local task, incorrect output (0 rows)
select udtfCount2() from src;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

</description>
                <environment></environment>
        <key id="12888707">HIVE-11892</key>
            <summary>UDTF run in local fetch task does not return rows forwarded during GenericUDTF.close()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdere">Jason Dere</assignee>
                                    <reporter username="jdere">Jason Dere</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 Sep 2015 23:28:12 +0000</created>
                <updated>Thu, 28 Apr 2016 17:17:47 +0000</updated>
                            <resolved>Thu, 15 Oct 2015 18:12:13 +0000</resolved>
                                    <version>1.1.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>UDF</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14876712" author="jdere" created="Fri, 18 Sep 2015 23:50:18 +0000"  >&lt;p&gt;As far as I can tell, it looks like GenericUDTF.close() isn&apos;t called until after CliDriver.processLocalCmd() has already finished going through the query results, so any rows added to the result at this point are never iterated over and printed.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ListSinkOperator.process(Object, int) line: 94	
UDTFOperator(Operator&amp;lt;T&amp;gt;).forward(Object, ObjectInspector) line: 813	
UDTFOperator.forwardUDTFOutput(Object) line: 126	
UDTFCollector.collect(Object) line: 45	
GenericUDTFCount2(GenericUDTF).forward(Object) line: 107	
GenericUDTFCount2.close() line: 48	
UDTFOperator.closeOp(boolean) line: 145	
UDTFOperator(Operator&amp;lt;T&amp;gt;).close(boolean) line: 617	
SelectOperator(Operator&amp;lt;T&amp;gt;).close(boolean) line: 631	
TableScanOperator(Operator&amp;lt;T&amp;gt;).close(boolean) line: 631	
FetchOperator.clearFetchContext() line: 523	
FetchTask.clearFetch() line: 181	
Driver.close() line: 1842	
CliDriver.processLocalCmd(String, CommandProcessor, CliSessionState) line: 250	
CliDriver.processCmd(String) line: 165	
CliDriver.processLine(String, boolean) line: 376	
CliDriver.executeDriver(CliSessionState, HiveConf, OptionsProcessor) line: 736	
CliDriver.run(String[]) line: 681	
CliDriver.main(String[]) line: 621	
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14945710" author="jdere" created="Tue, 6 Oct 2015 20:28:40 +0000"  >&lt;p&gt;Attaching a workaround patch, to disable fetch task conversion if the query uses UDTFs. Also required a new qfile mask pattern, since it looks like non-native UDTFs get some random text added to the end of the classname during explain plans.&lt;/p&gt;</comment>
                            <comment id="14947235" author="hiveqa" created="Wed, 7 Oct 2015 17:19:41 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12765242/HIVE-11892.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12765242/HIVE-11892.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 2 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 12 failed/errored test(s), 9653 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_lateral_view_noalias
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_nonmr_fetch
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_select_dummy_source
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_udf_explode
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_udf_inline
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_udtf_explode
org.apache.hadoop.hive.cli.TestContribCliDriver.testCliDriver_udtf_output_on_close
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_explainuser_1
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_explainuser_3
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_select_dummy_source
org.apache.hive.hcatalog.api.TestHCatClient.testTableSchemaPropagation
org.apache.hive.jdbc.TestSSL.testSSLVersion
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5559/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5559/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5559/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5559/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5559/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5559/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 12 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12765242 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14947291" author="jdere" created="Wed, 7 Oct 2015 18:07:52 +0000"  >&lt;p&gt;Test failures are due to explain plan differences now that UDTFs will not use fetch task conversion. Will regenerate the golden files for these tests.&lt;/p&gt;</comment>
                            <comment id="14947355" author="jdere" created="Wed, 7 Oct 2015 18:46:39 +0000"  >&lt;p&gt;Updated golden files.&lt;br/&gt;
Also removed the special case pattern mask for GenericUDTFCount2, I removed the query explain from udtf_nofetchtask.q&lt;/p&gt;</comment>
                            <comment id="14948939" author="hiveqa" created="Thu, 8 Oct 2015 16:25:08 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12765433/HIVE-11892.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12765433/HIVE-11892.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 2 failed/errored test(s), 9656 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hive.hcatalog.api.TestHCatClient.testTableSchemaPropagation
org.apache.hive.jdbc.TestSSL.testSSLVersion
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5570/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5570/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5570/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5570/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5570/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5570/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12765433 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14955983" author="jdere" created="Wed, 14 Oct 2015 00:02:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt;, can you review?&lt;/p&gt;</comment>
                            <comment id="14955995" author="ashutoshc" created="Wed, 14 Oct 2015 00:15:25 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14957517" author="xuefuz" created="Wed, 14 Oct 2015 18:54:02 +0000"  >&lt;p&gt;Can we get &quot;affected version&quot; filled? Thanks.&lt;/p&gt;</comment>
                            <comment id="14957667" author="jdere" created="Wed, 14 Oct 2015 20:15:54 +0000"  >&lt;p&gt;I&apos;m guessing this was added in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5718&quot; title=&quot;Support direct fetch for lateral views, sub queries, etc.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5718&quot;&gt;&lt;del&gt;HIVE-5718&lt;/del&gt;&lt;/a&gt;, so 1.1.0?&lt;/p&gt;</comment>
                            <comment id="14959323" author="jdere" created="Thu, 15 Oct 2015 18:11:14 +0000"  >&lt;p&gt;Attaching patch for branch-1, some golden file changes didn&apos;t apply cleanly&lt;/p&gt;</comment>
                            <comment id="14959326" author="jdere" created="Thu, 15 Oct 2015 18:12:13 +0000"  >&lt;p&gt;Committed to branch-1/master&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12962454">HIVE-13609</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12961470">HIVE-13586</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12765242" name="HIVE-11892.1.patch" size="6475" author="jdere" created="Tue, 6 Oct 2015 20:28:40 +0000"/>
                            <attachment id="12765433" name="HIVE-11892.2.patch" size="49631" author="jdere" created="Wed, 7 Oct 2015 18:46:39 +0000"/>
                            <attachment id="12766834" name="HIVE-11892.2.patch.branch-1" size="45745" author="jdere" created="Thu, 15 Oct 2015 18:11:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 5 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2l587:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>