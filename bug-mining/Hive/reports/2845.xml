<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:26:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-8646] Hive class loading  failure when executing Hive action via oozie workflows</title>
                <link>https://issues.apache.org/jira/browse/HIVE-8646</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;When running Hive actions with Oozie we hit this issue sometimes.    What is interesting is that we have all the necessary jars in the classpath (or atleast are expected to be localized).&lt;/p&gt;

&lt;p&gt;This static initialization block is introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3925&quot; title=&quot;dependencies of fetch task are not shown by explain&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3925&quot;&gt;&lt;del&gt;HIVE-3925&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;==&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;main&quot; java.lang.ExceptionInInitializerError&lt;br/&gt;
	at java.lang.Class.forName0(Native Method)&lt;br/&gt;
	at java.lang.Class.forName(Class.java:270)&lt;br/&gt;
	at org.apache.hadoop.util.RunJar.run(RunJar.java:214)&lt;br/&gt;
	at org.apache.hadoop.util.RunJar.main(RunJar.java:136)&lt;br/&gt;
Caused by: java.lang.TypeNotPresentException: Type org.apache.hadoop.hive.metastore.api.FieldSchema not present&lt;br/&gt;
	at sun.reflect.generics.factory.CoreReflectionFactory.makeNamedType(CoreReflectionFactory.java:117)&lt;br/&gt;
	at sun.reflect.generics.visitor.Reifier.visitClassTypeSignature(Reifier.java:125)&lt;br/&gt;
	at sun.reflect.generics.tree.ClassTypeSignature.accept(ClassTypeSignature.java:49)&lt;br/&gt;
	at sun.reflect.generics.visitor.Reifier.reifyTypeArguments(Reifier.java:68)&lt;br/&gt;
	at sun.reflect.generics.visitor.Reifier.visitClassTypeSignature(Reifier.java:138)&lt;br/&gt;
	at sun.reflect.generics.tree.ClassTypeSignature.accept(ClassTypeSignature.java:49)&lt;br/&gt;
	at sun.reflect.generics.repository.MethodRepository.getReturnType(MethodRepository.java:68)&lt;br/&gt;
	at java.lang.reflect.Method.getGenericReturnType(Method.java:245)&lt;br/&gt;
	at java.beans.FeatureDescriptor.getReturnType(FeatureDescriptor.java:370)&lt;br/&gt;
	at java.beans.Introspector.getTargetEventInfo(Introspector.java:996)&lt;br/&gt;
	at java.beans.Introspector.getBeanInfo(Introspector.java:417)&lt;br/&gt;
	at java.beans.Introspector.getBeanInfo(Introspector.java:163)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.exec.PTFUtils.makeTransient(PTFUtils.java:267)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.exec.Task.&amp;lt;clinit&amp;gt;(Task.java:53)&lt;br/&gt;
	... 4 more&lt;br/&gt;
Caused by: java.lang.ClassNotFoundException: org.apache.hadoop.hive.metastore.api.FieldSchema&lt;br/&gt;
	at java.net.URLClassLoader$1.run(URLClassLoader.java:366)&lt;br/&gt;
	at java.net.URLClassLoader$1.run(URLClassLoader.java:355)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
	at java.net.URLClassLoader.findClass(URLClassLoader.java:354)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(ClassLoader.java:425)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(ClassLoader.java:358)&lt;br/&gt;
	at java.lang.Class.forName0(Native Method)&lt;br/&gt;
	at java.lang.Class.forName(Class.java:270)&lt;br/&gt;
	at sun.reflect.generics.factory.CoreReflectionFactory.makeNamedType(CoreReflectionFactory.java:114)&lt;br/&gt;
	... 17 more&lt;/p&gt;</description>
                <environment>&lt;p&gt;Hadoop 2.6.0 + Hive 0.14 + Oozie 4.1&lt;/p&gt;</environment>
        <key id="12751440">HIVE-8646</key>
            <summary>Hive class loading  failure when executing Hive action via oozie workflows</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="navis">Navis Ryu</assignee>
                                    <reporter username="venkatnrangan">Venkat Ranganathan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 29 Oct 2014 17:54:34 +0000</created>
                <updated>Thu, 13 Nov 2014 19:40:50 +0000</updated>
                            <resolved>Fri, 31 Oct 2014 18:25:17 +0000</resolved>
                                    <version>0.14.0</version>
                                    <fixVersion>0.14.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14188913" author="sushanth" created="Wed, 29 Oct 2014 20:10:14 +0000"  >&lt;p&gt;This seems to be coming from a static block in Task that calls PTFUtils.makeTransient &amp;#8211; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt;/&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhbutani&quot; class=&quot;user-hover&quot; rel=&quot;rhbutani&quot;&gt;rhbutani&lt;/a&gt;, could you please look to see if this is necessary?&lt;/p&gt;</comment>
                            <comment id="14188917" author="sushanth" created="Wed, 29 Oct 2014 20:12:02 +0000"  >&lt;p&gt;(Also tagging &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vikram.dixit&quot; class=&quot;user-hover&quot; rel=&quot;vikram.dixit&quot;&gt;vikram.dixit&lt;/a&gt; because this is a bug introduced in 0.14, so should ideally be fixed in 0.14)&lt;/p&gt;</comment>
                            <comment id="14189538" author="hagleitn" created="Thu, 30 Oct 2014 02:50:29 +0000"  >&lt;p&gt;How come this class isn&apos;t present? Are you not adding hive-metastore to the required jars?&lt;/p&gt;</comment>
                            <comment id="14189603" author="venkatnrangan" created="Thu, 30 Oct 2014 04:01:16 +0000"  >&lt;blockquote&gt;&lt;p&gt;How come this class isn&apos;t present? Are you not adding hive-metastore to the required jars?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Hive-metastore is always packaged as part of the oozie hive sharelib.   This issue is seen intermittently.   This could be related to localization of jars, the claaspath jar or some thing within hive that triggers an indeterminate class loading order.   That said, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhbutani&quot; class=&quot;user-hover&quot; rel=&quot;rhbutani&quot;&gt;rhbutani&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt; also looked into this and think that this exception block is not needed and can/need to be removed since the introduction of the new serialization facility used.&lt;/p&gt;</comment>
                            <comment id="14189843" author="navis" created="Thu, 30 Oct 2014 09:25:29 +0000"  >&lt;p&gt;I couldn&apos;t make a environment to test but runtime class like Task should not have reference to classes in metastore. Attached patch is just for it (not intended for a fix).&lt;/p&gt;</comment>
                            <comment id="14190656" author="ashutoshc" created="Thu, 30 Oct 2014 19:18:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;navis&lt;/a&gt; Your patch is useful, as you noted we dont want to have metastore classes being referenced in Task classes. So, we should get this in regardless of oozie problem. &lt;br/&gt;
But, I also wonder whats the need for that static block, anyway. Field is already marked transient, which Kryo will already respect. For javaXML, even if its get serialized, it should not be a problem, its just a boolean. Shall we get rid of static block too?&lt;/p&gt;</comment>
                            <comment id="14190657" author="ashutoshc" created="Thu, 30 Oct 2014 19:19:10 +0000"  >&lt;p&gt;In the meanwhile, running HiveQA to check for any failures.&lt;/p&gt;</comment>
                            <comment id="14191282" author="hiveqa" created="Fri, 31 Oct 2014 03:39:49 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12678152/HIVE-8646.1.patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12678152/HIVE-8646.1.patch.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 3 failed/errored test(s), 6608 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_transform_acid
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_optimize_nullscan
org.apache.hive.minikdc.TestJdbcWithMiniKdc.testNegativeTokenAuth
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1564/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1564/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1564/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1564/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1564/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1564/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12678152 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14191487" author="hagleitn" created="Fri, 31 Oct 2014 06:45:53 +0000"  >&lt;p&gt;I think we should just go with Navis&apos; patch for now. Since he removed the FieldSchema reference there&apos;s a good chance this resolves the oozie issue. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=venkatnrangan&quot; class=&quot;user-hover&quot; rel=&quot;venkatnrangan&quot;&gt;venkatnrangan&lt;/a&gt; can test once it&apos;s in. The problem with &quot;it&apos;s just a boolean&quot; is that we clone tasks a lot and there might be weird side effects of removing the block. +1 for trunk and branch.&lt;/p&gt;</comment>
                            <comment id="14191515" author="hagleitn" created="Fri, 31 Oct 2014 07:04:00 +0000"  >&lt;p&gt;Test failures are unrelated. (ran acid test locally - passed, the other two I&apos;ve seen failing in the past).&lt;/p&gt;</comment>
                            <comment id="14192196" author="hagleitn" created="Fri, 31 Oct 2014 18:25:18 +0000"  >&lt;p&gt;Committed to trunk and branch. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=venkatnrangan&quot; class=&quot;user-hover&quot; rel=&quot;venkatnrangan&quot;&gt;venkatnrangan&lt;/a&gt; please verify. If this is still an issue we need a repro to move forward.&lt;/p&gt;</comment>
                            <comment id="14210435" author="thejas" created="Thu, 13 Nov 2014 19:40:50 +0000"  >&lt;p&gt;This has been fixed in 0.14 release. Please open new jira if you see any issues.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12678152" name="HIVE-8646.1.patch.txt" size="3795" author="navis" created="Thu, 30 Oct 2014 09:25:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i21q8n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>