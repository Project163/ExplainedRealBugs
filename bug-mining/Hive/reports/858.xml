<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:01:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-3092] Hive tests should load Hive classes from build directory, not Ivy cache</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3092</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;As discussed in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-895&quot; title=&quot;Add SerDe for Avro serialized data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-895&quot;&gt;&lt;del&gt;HIVE-895&lt;/del&gt;&lt;/a&gt;, currently the tests pull in jars for other components rather from Ivy rather than using the built classes and jars in the build directory (bit.ly/LzndQU).  This means that absent a very-clean, one is testing against a previous version of the code and cross-component tests are invalid.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12559511">HIVE-3092</key>
            <summary>Hive tests should load Hive classes from build directory, not Ivy cache</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kevinwilfong">Kevin Wilfong</assignee>
                                    <reporter username="jghoman">Jakob Homan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 6 Jun 2012 10:38:22 +0000</created>
                <updated>Thu, 10 Jan 2013 19:53:14 +0000</updated>
                            <resolved>Fri, 15 Jun 2012 06:02:02 +0000</resolved>
                                                    <fixVersion>0.10.0</fixVersion>
                                    <component>Testing Infrastructure</component>
                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="13294715" author="kevinwilfong" created="Wed, 13 Jun 2012 23:24:56 +0000"  >&lt;p&gt;The attached patch attempts to solve the problem by adding the jars from build/dist/lib into the test classpath before the Ivy jars.&lt;/p&gt;</comment>
                            <comment id="13294755" author="namit" created="Thu, 14 Jun 2012 00:56:03 +0000"  >&lt;p&gt;This was a very serious bug introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2646&quot; title=&quot;Hive Ivy dependencies on Hadoop should depend on jars directly, not tarballs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2646&quot;&gt;&lt;del&gt;HIVE-2646&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;


&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;If anyone has any issues, please comment - I will start to run tests.&lt;/p&gt;</comment>
                            <comment id="13294880" author="cwsteinbach" created="Thu, 14 Jun 2012 08:02:32 +0000"  >&lt;p&gt;This patch will fix the problem in cases where new classes are added, or where the definition of a class has changed. However, it won&apos;t fix the situation where a class is removed but continues to show up on the classpath because Ivy is pulling an old copy out of the local cache.&lt;/p&gt;

&lt;p&gt;I think &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3116&quot; title=&quot;Make very-clean Ant target more selective&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3116&quot;&gt;&lt;del&gt;HIVE-3116&lt;/del&gt;&lt;/a&gt; is a better way to fix the problem since it addresses all three of the cases I described above.&lt;/p&gt;</comment>
                            <comment id="13294888" author="cwsteinbach" created="Thu, 14 Jun 2012 08:10:58 +0000"  >&lt;p&gt;I also don&apos;t think this fix will stay in place for very long unless someone adds a comment explaining why the dist/lib directory has to go first on the classpath.&lt;/p&gt;</comment>
                            <comment id="13294894" author="kevinwilfong" created="Thu, 14 Jun 2012 08:23:24 +0000"  >&lt;p&gt;Carl, do you happen to know why these Hive artifacts are going into Ivy&apos;s cache in the first place? If we could remove them from there, or at least find some other way to ignore them, that would solve the problems as well.&lt;/p&gt;

&lt;p&gt;Having multiple checkouts of Hive store these jars in a common location and then use them makes it very difficult to work in multiple checkouts at the same time.  It also complicates testing multiple checkouts at the same time.&lt;/p&gt;

&lt;p&gt;Given that there isn&apos;t a patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3116&quot; title=&quot;Make very-clean Ant target more selective&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3116&quot;&gt;&lt;del&gt;HIVE-3116&lt;/del&gt;&lt;/a&gt; yet, I&apos;d like to get this in, to help speed up development.  Having to run ant very-clean package which takes ~20 mins. every time you make a change is a real time sink.&lt;/p&gt;</comment>
                            <comment id="13295163" author="kevinwilfong" created="Thu, 14 Jun 2012 17:04:01 +0000"  >&lt;p&gt;Carl did have a good point, this patch did not fix the case where a class is removed.&lt;/p&gt;

&lt;p&gt;In my newly uploaded patch, when the test class path is constructed it adds the jars from build/dist/lib before the Ivy jars, and excludes all hive jars from Ivy.&lt;/p&gt;

&lt;p&gt;So now, for the 3 cases Carl mentioned, this patch fixes them for ant test.  It also means that we can run the tests after running the much faster ant clean rather than ant very-clean.  Finally, it means that different checkouts won&apos;t read their Hive jars from the common Ivy repo resulting in potentially picking up the changes in another checkout.  Given that, I would argue that for the case of running the command ant test, this patch is better than the fix proposed in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3116&quot; title=&quot;Make very-clean Ant target more selective&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3116&quot;&gt;&lt;del&gt;HIVE-3116&lt;/del&gt;&lt;/a&gt;, although that has value for other cases.&lt;/p&gt;</comment>
                            <comment id="13295164" author="kevinwilfong" created="Thu, 14 Jun 2012 17:04:42 +0000"  >&lt;p&gt;Also added a comment.&lt;/p&gt;</comment>
                            <comment id="13295223" author="cwsteinbach" created="Thu, 14 Jun 2012 18:41:20 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13295469" author="namit" created="Fri, 15 Jun 2012 06:02:02 +0000"  >&lt;p&gt;Committed. Thanks Kevin&lt;/p&gt;</comment>
                            <comment id="13295623" author="hudson" created="Fri, 15 Jun 2012 12:28:15 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1488 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1488/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1488/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3092&quot; title=&quot;Hive tests should load Hive classes from build directory, not Ivy cache&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3092&quot;&gt;&lt;del&gt;HIVE-3092&lt;/del&gt;&lt;/a&gt; Hive tests should load Hive classes from build directory, not Ivy cache&lt;br/&gt;
(Kevin Wilfong via namit) (Revision 1350467)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1350467&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1350467&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/build-common.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13296054" author="kannakar@microsoft.com" created="Sat, 16 Jun 2012 00:51:09 +0000"  >&lt;p&gt;I am getting the following error on windows when I run the unit tests with these changes. Do you have any suggestions to make it work on windows?&lt;/p&gt;

&lt;p&gt;compile-test:&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;echo&amp;#93;&lt;/span&gt; Project: ql&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 57 source files to D:\OSS\hive\build\ql\test\classes&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; error: error reading D:\OSS\hive\build\dist\lib\libfb303.jar; error in opening zip file&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; error: error reading D:\OSS\hive\build\dist\lib\libthrift.jar; error in opening zip file&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; 2 errors&lt;/p&gt;</comment>
                            <comment id="13296057" author="kevinwilfong" created="Sat, 16 Jun 2012 01:08:57 +0000"  >&lt;p&gt;Have you tried running ant clean?&lt;/p&gt;

&lt;p&gt;If that doesn&apos;t work have you tried ant very-clean?&lt;/p&gt;</comment>
                            <comment id="13296058" author="cwsteinbach" created="Sat, 16 Jun 2012 01:28:59 +0000"  >&lt;p&gt;libfb303.jar and libthrift.jar are symlinks which were added in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1962&quot; title=&quot;make a libthrift.jar and libfb303.jar in dist package for backward compatibility&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1962&quot;&gt;&lt;del&gt;HIVE-1962&lt;/del&gt;&lt;/a&gt;. Maybe we can remove them?&lt;/p&gt;

&lt;p&gt;@Kevin: Can you check with Ning and see if Facebook still has an internal dependency on these old JAR names?&lt;/p&gt;
</comment>
                            <comment id="13296073" author="kannakar@microsoft.com" created="Sat, 16 Jun 2012 02:52:47 +0000"  >&lt;p&gt;I am not sure with the implications of excluding lib*.jar from dist folder but this workaround is working on windows.&lt;/p&gt;</comment>
                            <comment id="13296107" author="cwsteinbach" created="Sat, 16 Jun 2012 05:02:17 +0000"  >&lt;p&gt;@Kanna: You can&apos;t exclude libfb303-0.7.0.jar or libthrift-0.7.0.jar from the dist/lib directory since these are required by different components of Hive. However, it&apos;s perfectly acceptable to remove the symlinks libfb303.jar and libthrift.jar. In fact, we should just remove the code in build.xml which creates these symlinks. The relevant code that needs to be removed starts on line 536 of build.xml.&lt;/p&gt;</comment>
                            <comment id="13296113" author="kannakar@microsoft.com" created="Sat, 16 Jun 2012 05:27:03 +0000"  >&lt;p&gt;Thanks Carl -  Sorry I think my original message was a bit ambiguous, I did the following under &#8220;test-classpath&#8221; in build-common.xml to unblock myself for now.&lt;br/&gt;
Original:&lt;br/&gt;
&amp;lt;fileset dir=&quot;${build.dir.hive}/dist/lib&quot; includes=&quot;&lt;b&gt;.jar&quot; erroronmissingdir=&quot;false&quot; excludes=&quot;&lt;/b&gt;&lt;b&gt;/hive_contrib&lt;/b&gt;.jar,*&lt;b&gt;/hive-contrib&lt;/b&gt;.jar &quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;Modife:&lt;br/&gt;
&amp;lt;fileset dir=&quot;${build.dir.hive}/dist/lib&quot; includes=&quot;&lt;b&gt;.jar&quot; erroronmissingdir=&quot;false&quot; excludes=&quot;&lt;/b&gt;&lt;b&gt;/hive_contrib&lt;/b&gt;.jar,*&lt;b&gt;/hive-contrib&lt;/b&gt;.jar,*&lt;b&gt;/lib&lt;/b&gt;.jar&quot;/&amp;gt;&lt;/p&gt;


&lt;p&gt;I will try your suggestion tomorrow.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13396108" author="kannakar@microsoft.com" created="Mon, 18 Jun 2012 18:25:35 +0000"  >&lt;p&gt;@Carl - It is working after removing the symlinks from build.xml. Once Kevin confirm that they are no more required then we can remove them from build.xml&lt;/p&gt;</comment>
                            <comment id="13396110" author="kevinwilfong" created="Mon, 18 Jun 2012 18:26:56 +0000"  >&lt;p&gt;I&apos;ve attempted to contact Ning, still waiting on a reply.&lt;/p&gt;</comment>
                            <comment id="13399766" author="kannakar@microsoft.com" created="Sat, 23 Jun 2012 00:55:37 +0000"  >&lt;p&gt;Hi Kevin - Any update on this. Thanks&lt;/p&gt;</comment>
                            <comment id="13399789" author="kevinwilfong" created="Sat, 23 Jun 2012 01:37:35 +0000"  >&lt;p&gt;No, he never got back to me.&lt;/p&gt;

&lt;p&gt;I spoke with Namit Jain who worked with Ning, he didn&apos;t think it was needed anymore.&lt;/p&gt;

&lt;p&gt;If you can remove it and the tests still pass, it&apos;s probably ok, otherwise, we&apos;ll find a deficiency in our tests that should be fixed.&lt;/p&gt;</comment>
                            <comment id="13400191" author="kannakar@microsoft.com" created="Sun, 24 Jun 2012 18:06:15 +0000"  >&lt;p&gt;Thanks Kevin. All Unit Tests passed without lib*.jar symlinks. so I addressed it as part of overall windows build patch(&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3126&quot; title=&quot;Generate &amp;amp; build the velocity based Hive tests on windows by fixing the path issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3126&quot;&gt;&lt;del&gt;HIVE-3126&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="13536061" author="kannakar@microsoft.com" created="Wed, 19 Dec 2012 15:55:12 +0000"  >&lt;p&gt;Hello, I am out of office on vacation and will return on Wed, Jan 2nd.&lt;/p&gt;

&lt;p&gt;For any urgent issues, please contact my manager.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Kanna&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="13548116" author="hudson" created="Wed, 9 Jan 2013 10:24:27 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #54 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3092&quot; title=&quot;Hive tests should load Hive classes from build directory, not Ivy cache&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3092&quot;&gt;&lt;del&gt;HIVE-3092&lt;/del&gt;&lt;/a&gt; Hive tests should load Hive classes from build directory, not Ivy cache&lt;br/&gt;
(Kevin Wilfong via namit) (Revision 1350467)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1350467&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1350467&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/build-common.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13550063" author="ashutoshc" created="Thu, 10 Jan 2013 19:53:14 +0000"  >&lt;p&gt;This issue is fixed and released as part of 0.10.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12560267">HIVE-3117</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12560265">HIVE-3116</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12534814">HIVE-2646</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12532024" name="HIVE-3092.1.patch.txt" size="836" author="kevinwilfong" created="Wed, 13 Jun 2012 23:23:51 +0000"/>
                            <attachment id="12532117" name="HIVE-3092.2.patch.txt" size="1411" author="kevinwilfong" created="Thu, 14 Jun 2012 17:00:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>259063</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 45 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lml3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>124309</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>