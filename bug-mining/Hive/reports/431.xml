<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 17:56:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-1492] FileSinkOperator should remove duplicated files from the same task based on file sizes</title>
                <link>https://issues.apache.org/jira/browse/HIVE-1492</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;FileSinkOperator.jobClose() calls Utilities.removeTempOrDuplicateFiles() to retain only one file for each task. A task could produce multiple files due to failed attempts or speculative runs. The largest file should be retained rather than the first file for each task. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12470397">HIVE-1492</key>
            <summary>FileSinkOperator should remove duplicated files from the same task based on file sizes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nzhang">Ning Zhang</assignee>
                                    <reporter username="nzhang">Ning Zhang</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Jul 2010 00:48:12 +0000</created>
                <updated>Sat, 17 Dec 2011 00:03:59 +0000</updated>
                            <resolved>Mon, 16 Aug 2010 23:03:35 +0000</resolved>
                                                    <fixVersion>0.6.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12893460" author="he yongqiang" created="Thu, 29 Jul 2010 00:59:30 +0000"  >&lt;p&gt;+1, looks good. will commit after tests pass.&lt;/p&gt;</comment>
                            <comment id="12893704" author="he yongqiang" created="Thu, 29 Jul 2010 17:11:25 +0000"  >&lt;p&gt;I just committed. Thanks  Ning!&lt;/p&gt;</comment>
                            <comment id="12893761" author="nzhang" created="Thu, 29 Jul 2010 18:40:17 +0000"  >&lt;p&gt;Uploading a patch for branch-0.6.&lt;/p&gt;</comment>
                            <comment id="12893772" author="appodictic" created="Thu, 29 Jul 2010 18:59:48 +0000"  >&lt;p&gt;&quot;the largest file is the correct file&quot; &lt;br/&gt;
Is that generally true or an absolute fact?&lt;/p&gt;</comment>
                            <comment id="12893782" author="he yongqiang" created="Thu, 29 Jul 2010 19:11:38 +0000"  >&lt;p&gt;The assumption of Map-reduce is &lt;br/&gt;
if we give same input and same m/r function, the output should be always the same.&lt;/p&gt;

&lt;p&gt;Otherwise the map-reduce fault tolerance mechanism is wrong.&lt;/p&gt;</comment>
                            <comment id="12893786" author="he yongqiang" created="Thu, 29 Jul 2010 19:24:00 +0000"  >&lt;p&gt;running test on branch-0.6&lt;/p&gt;</comment>
                            <comment id="12893788" author="nzhang" created="Thu, 29 Jul 2010 19:26:23 +0000"  >&lt;p&gt;@Edward, this is a heuristics that should be generally true. The good news is that we are not aware of any exceptions that violate the rule (assuming multiple attempts of the same task give deterministic results). &lt;/p&gt;

&lt;p&gt;The reason that we are relying on heuristics here is that the old Hadoop API doesn&apos;t not support exception handling outside Mapper&apos;s map() function. The bug presents if an exception was thrown by Hadoop&apos;s RecordReader layer and it does not pass the message to the Mapper. When the mapper.close() is called there is not way the mapper know whether there is an exception happened in the Hadoop code path. A better way to handle this is to use the new Hadoop API that gives more control to the application layer. This heuristics is a workaround based on the old Hadoop API. &lt;/p&gt;</comment>
                            <comment id="12893907" author="he yongqiang" created="Fri, 30 Jul 2010 01:56:24 +0000"  >&lt;p&gt;committed to branch-0.6 as well. Thanks John!&lt;/p&gt;</comment>
                            <comment id="12899048" author="namit" created="Mon, 16 Aug 2010 19:45:28 +0000"  >&lt;p&gt;A better fix would be to catch next() in HiveRecordReader/CombineHiveRecordReader etc. and set the abort flag in ExecMapper in case of an exception.&lt;br/&gt;
There will be exactly 1 successful mapper in that case.&lt;/p&gt;</comment>
                            <comment id="12899152" author="nzhang" created="Mon, 16 Aug 2010 22:43:08 +0000"  >&lt;p&gt;Agree that we should catch the exception in (Combine)HiveRecordReader, but they are only used in map side. In the reducer, RecordReader was not called and there could also be exceptions outside of reducer(). This fix catches that case as well.&lt;/p&gt;

&lt;p&gt;I&apos;ve filed another JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1543&quot; title=&quot;set abort in ExecMapper when Hive&amp;#39;s record reader got an IOException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1543&quot;&gt;&lt;del&gt;HIVE-1543&lt;/del&gt;&lt;/a&gt; for catching exceptions in RecrodReaders. &lt;/p&gt;
</comment>
                            <comment id="12899167" author="namit" created="Mon, 16 Aug 2010 23:03:35 +0000"  >&lt;p&gt;Let us fix it in the follow-up &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12450782" name="HIVE-1492.patch" size="2639" author="nzhang" created="Thu, 29 Jul 2010 00:55:03 +0000"/>
                            <attachment id="12450854" name="HIVE-1492_branch-0.6.patch" size="1871" author="nzhang" created="Thu, 29 Jul 2010 18:40:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72874</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 15 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lfef:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123145</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>