<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:13:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-5825] Case statement type checking too restrictive for parameterized types</title>
                <link>https://issues.apache.org/jira/browse/HIVE-5825</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;explain select&lt;br/&gt;
  case when (key = &apos;0&apos;) then 123.456BD else 0.0BD end&lt;br/&gt;
from src limit 2&lt;/p&gt;

&lt;p&gt;FAILED: SemanticException &lt;span class=&quot;error&quot;&gt;&amp;#91;Error 10016&amp;#93;&lt;/span&gt;: Line 3:44 Argument type mismatch &apos;0.0BD&apos;: The expression after ELSE should have the same type as those after THEN: &quot;decimal(6,3)&quot; is expected but &quot;decimal(1,0)&quot; is found&lt;/p&gt;

&lt;p&gt;The return type checking is too strict and won&apos;t allow different decimal types to be returned if they are not the exact same type (precision/scale).  There are similar issues with char/varchar length, but even in the general case it seems odd that you wouldn&apos;t be able to specify 1 and 0.0 in the same case statement.&lt;/p&gt;

&lt;p&gt;I would propose setting returnOIResolver so that it is able to convert the return values to common type.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12679283">HIVE-5825</key>
            <summary>Case statement type checking too restrictive for parameterized types</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdere">Jason Dere</assignee>
                                    <reporter username="jdere">Jason Dere</reporter>
                        <labels>
                    </labels>
                <created>Thu, 14 Nov 2013 20:03:33 +0000</created>
                <updated>Sat, 29 Mar 2014 08:09:25 +0000</updated>
                            <resolved>Sun, 17 Nov 2013 04:53:36 +0000</resolved>
                                                    <fixVersion>0.13.0</fixVersion>
                                    <component>UDF</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13823222" author="jdere" created="Fri, 15 Nov 2013 02:27:20 +0000"  >&lt;p&gt;Patch attached. case/when UDFs now allow differing types and will determine a common type to use if the types are different.&lt;/p&gt;</comment>
                            <comment id="13824267" author="hiveqa" created="Sat, 16 Nov 2013 00:20:09 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12614000/HIVE-5825.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12614000/HIVE-5825.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 4608 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/320/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/320/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/320/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/320/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12614000&lt;/p&gt;</comment>
                            <comment id="13824357" author="xuefuz" created="Sat, 16 Nov 2013 03:19:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdere&quot; class=&quot;user-hover&quot; rel=&quot;jdere&quot;&gt;jdere&lt;/a&gt; Thanks for working on this. Please provide RB link when the patch is ready to be reviewed.&lt;/p&gt;</comment>
                            <comment id="13824364" author="jdere" created="Sat, 16 Nov 2013 03:30:54 +0000"  >&lt;p&gt;RB at &lt;a href=&quot;https://reviews.apache.org/r/15607/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/15607/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13824369" author="xuefuz" created="Sat, 16 Nov 2013 03:44:17 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13824738" author="xuefuz" created="Sun, 17 Nov 2013 04:53:36 +0000"  >&lt;p&gt;Patch committed to trunk. Thank Jason for the contribution.&lt;/p&gt;</comment>
                            <comment id="13945667" author="dougsedlak" created="Mon, 24 Mar 2014 20:46:02 +0000"  >&lt;p&gt;Here is a possible instance of this issue, can you run this case to see it is addressed by this JIRA in Hive 13?  Thanks!&lt;/p&gt;

&lt;p&gt;Create a standard  textual linefeed delimited HDFS file with 1 row and  1 column, with contents like:&lt;br/&gt;
FEBï¿½&lt;/p&gt;

&lt;p&gt;Issue the following DDL against the above data, filling in location &lt;span class=&quot;error&quot;&gt;&amp;#91;hdfs_path&amp;#93;&lt;/span&gt; appropriately:&lt;br/&gt;
CREATE EXTERNAL TABLE `HIVE_5825` ( month VARCHAR(3) ) STORED AS TEXTFILE LOCATION &lt;span class=&quot;error&quot;&gt;&amp;#91;hdfs_path&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Issue the following SQL, which fails in Hive 12:&lt;br/&gt;
select case  when COUNT&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &amp;gt; COUNT(`month`) then &apos; &apos; else MIN(`month`) end from HIVE_5825&lt;/p&gt;

&lt;p&gt;The Hive 12 failure message generated is:&lt;br/&gt;
java.sql.SQLException: Error while processing statement: FAILED: SemanticException &lt;span class=&quot;error&quot;&gt;&amp;#91;Error 10016&amp;#93;&lt;/span&gt;: Line 1:57 Argument type mismatch &apos;`month`&apos;: The expression after ELSE should have the same type as those after THEN: &quot;string&quot; is expected but &quot;varchar(3)&quot; is found&lt;/p&gt;</comment>
                            <comment id="13951801" author="jdere" created="Sat, 29 Mar 2014 08:09:25 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dougsedlak&quot; class=&quot;user-hover&quot; rel=&quot;dougsedlak&quot;&gt;dougsedlak&lt;/a&gt;, yes that query looks like it compiles/runs without error&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12614000" name="HIVE-5825.1.patch" size="12805" author="jdere" created="Fri, 15 Nov 2013 02:27:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>358645</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 34 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ptq7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>358935</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>