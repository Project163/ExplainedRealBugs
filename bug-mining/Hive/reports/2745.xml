<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:25:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-8102] Partitions of type &apos;date&apos; behave incorrectly with daylight saving time.</title>
                <link>https://issues.apache.org/jira/browse/HIVE-8102</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;On 2AM on March 28th 2014, Israel went from standard time (GMT+2) to daylight saving time (GMT+3).&lt;br/&gt;
The server&apos;s timezone is Asia/Jerusalem. When creating a partition whose key is 2014-03-28, Hive creates a partition for 2013-03-27 instead:&lt;/p&gt;

&lt;p&gt;hive (default)&amp;gt; create table test (a int) partitioned by (`b_prt` date);&lt;br/&gt;
OK&lt;br/&gt;
Time taken: 0.092 seconds&lt;br/&gt;
hive (default)&amp;gt; alter table test add partition (b_prt=&apos;2014-03-28&apos;);&lt;br/&gt;
OK&lt;br/&gt;
Time taken: 0.187 seconds&lt;br/&gt;
hive (default)&amp;gt; show partitions test;                                   &lt;br/&gt;
OK&lt;br/&gt;
partition&lt;br/&gt;
b_prt=2014-03-27&lt;br/&gt;
Time taken: 0.134 seconds, Fetched: 1 row(s)&lt;/p&gt;

&lt;p&gt;It seems that the root cause is the behavior of DateWritable.daysToMillis/dateToDays.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12741496">HIVE-8102</key>
            <summary>Partitions of type &apos;date&apos; behave incorrectly with daylight saving time.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdere">Jason Dere</assignee>
                                    <reporter username="eliac">Eli Acherkan</reporter>
                        <labels>
                    </labels>
                <created>Mon, 15 Sep 2014 14:45:04 +0000</created>
                <updated>Thu, 13 Nov 2014 19:41:16 +0000</updated>
                            <resolved>Wed, 15 Oct 2014 02:21:03 +0000</resolved>
                                    <version>0.13.0</version>
                                    <fixVersion>0.14.0</fixVersion>
                                    <component>Database/Schema</component>
                    <component>Serializers/Deserializers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14133985" author="eliac" created="Mon, 15 Sep 2014 15:04:23 +0000"  >&lt;p&gt;The following test fails when running in Asia/Jerusalem timezone:&lt;br/&gt;
	Date originalDate = new Date(114, 2, 28); // March 28th 2014 - DST begins on this day at 02:00.&lt;br/&gt;
	DateWritable dateWritable = new DateWritable(originalDate);&lt;br/&gt;
	assertEquals(originalDate, dateWritable.get()); // Assertion fails because dateWritable.get() returns 2014-03-27 23:00:00 IST.&lt;/p&gt;

&lt;p&gt;In order to be able to run this unit test in any timezone, we explicitly set the timezone and run it in a separate thread, so that the thread local member DataWritable.LOCAL_TIMEZONE is initialized with the correct one:&lt;br/&gt;
	public void testDaylightSavingsTime() throws InterruptedException, ExecutionException {&lt;br/&gt;
		TimeZone previousDefault = TimeZone.getDefault();&lt;br/&gt;
		TimeZone.setDefault(TimeZone.getTimeZone(&quot;Asia/Jerusalem&quot;));&lt;br/&gt;
		ExecutorService threadPool = Executors.newFixedThreadPool(1);&lt;br/&gt;
		try {&lt;br/&gt;
			Future&amp;lt;Boolean&amp;gt; future = threadPool.submit(new Callable&amp;lt;Boolean&amp;gt;() {&lt;/p&gt;

&lt;p&gt;				@Override&lt;br/&gt;
				public Boolean call() throws Exception &lt;/p&gt;
{
					Date originalDate = new Date(114, 2, 28); // March 28th 2014 - DST begins on this day at 02:00.
					DateWritable dateWritable = new DateWritable(originalDate);
					return originalDate.equals(dateWritable.get());
				}
&lt;p&gt;			});&lt;br/&gt;
			assertTrue(future.get());&lt;br/&gt;
		} finally &lt;/p&gt;
{
			threadPool.shutdown();
			TimeZone.setDefault(previousDefault);
		}
&lt;p&gt;	}&lt;/p&gt;</comment>
                            <comment id="14134944" author="jdere" created="Tue, 16 Sep 2014 04:42:40 +0000"  >&lt;p&gt;Thanks for the example test &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eliac&quot; class=&quot;user-hover&quot; rel=&quot;eliac&quot;&gt;eliac&lt;/a&gt;. I think it was because DateWritable.daysToMillis() looking up the time offset at the time of midnight UTC. If by then DST had already started, then the offset was wrong. I think this patch may work. &lt;/p&gt;</comment>
                            <comment id="14135083" author="eliac" created="Tue, 16 Sep 2014 07:23:13 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdere&quot; class=&quot;user-hover&quot; rel=&quot;jdere&quot;&gt;jdere&lt;/a&gt;! The patch appears to work well for us. (Haven&apos;t tested on other timezones.)&lt;/p&gt;</comment>
                            <comment id="14136035" author="jdere" created="Tue, 16 Sep 2014 19:23:11 +0000"  >&lt;p&gt;Just tried with a timezone with half-hour offsets that is ahead of UTC (Asia/Tehran) and this does not work, cancelling patch.&lt;/p&gt;</comment>
                            <comment id="14136158" author="jdere" created="Tue, 16 Sep 2014 20:41:21 +0000"  >&lt;p&gt;Actually, looks like the test was at fault here - for 2014-03-23 (day after DST in Tehran), the original date that was being compared to the writable was 1AM on 2014-03-23, whereas the writable was correctly giving back midnight  on 2014-03-23. Changed the test so that the original date will be set to the beginning of the day.&lt;/p&gt;</comment>
                            <comment id="14136369" author="hiveqa" created="Tue, 16 Sep 2014 22:21:12 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12669189/HIVE-8102.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12669189/HIVE-8102.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 6279 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/827/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/827/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/827/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/827/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-827/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-827/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12669189&lt;/p&gt;</comment>
                            <comment id="14166118" author="thejas" created="Fri, 10 Oct 2014 01:10:38 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14171869" author="jdere" created="Wed, 15 Oct 2014 01:48:23 +0000"  >&lt;p&gt;Patch v3 - rebase with trunk as TestDateWritable was created in a different Jira&lt;/p&gt;</comment>
                            <comment id="14171879" author="thejas" created="Wed, 15 Oct 2014 02:00:16 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14171883" author="thejas" created="Wed, 15 Oct 2014 02:01:25 +0000"  >&lt;p&gt;Since this just a test update in the patch, I think you can commit if you have verified that the test passes.&lt;/p&gt;</comment>
                            <comment id="14171897" author="jdere" created="Wed, 15 Oct 2014 02:21:03 +0000"  >&lt;p&gt;Committed to trunk/branch-0.14&lt;/p&gt;</comment>
                            <comment id="14171917" author="lefty@hortonworks.com" created="Wed, 15 Oct 2014 02:51:48 +0000"  >&lt;p&gt;No doc needed?&lt;/p&gt;</comment>
                            <comment id="14171923" author="jdere" created="Wed, 15 Oct 2014 02:57:50 +0000"  >&lt;p&gt;nope, just a bad bug&lt;/p&gt;</comment>
                            <comment id="14210525" author="thejas" created="Thu, 13 Nov 2014 19:41:16 +0000"  >&lt;p&gt;This has been fixed in 0.14 release. Please open new jira if you see any issues.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12668973" name="HIVE-8102.1.patch" size="3452" author="jdere" created="Tue, 16 Sep 2014 04:42:40 +0000"/>
                            <attachment id="12669189" name="HIVE-8102.2.patch" size="3756" author="jdere" created="Tue, 16 Sep 2014 20:41:21 +0000"/>
                            <attachment id="12674901" name="HIVE-8102.3.patch" size="3880" author="jdere" created="Wed, 15 Oct 2014 01:48:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i201t3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>