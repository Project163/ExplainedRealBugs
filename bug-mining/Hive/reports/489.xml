<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 17:57:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-1707] bug when different partitions are present in different dfs</title>
                <link>https://issues.apache.org/jira/browse/HIVE-1707</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The following does not work:&lt;/p&gt;

&lt;p&gt;create table T -&amp;gt; default location dfs1&lt;br/&gt;
insert overwrite T partition (ds=&apos;1&apos;) select * from src;&lt;/p&gt;

&lt;p&gt;alter table T location &apos;dfs2&apos;;&lt;br/&gt;
insert overwrite T partition (ds=&apos;1&apos;) select * from src;&lt;/p&gt;


&lt;p&gt;It tries to insert back in dfs1 - due to which the move task fails.&lt;br/&gt;
It would be cleaner to keep the same semantics as fileformat - whenever a partition is being inserted into, it&lt;br/&gt;
inherits the properties from the table. So, after the insert, the partition should belong to dfs1.&lt;br/&gt;
It does not matter whether the partition exists before or not,.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12477245">HIVE-1707</key>
            <summary>bug when different partitions are present in different dfs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="he yongqiang">He Yongqiang</assignee>
                                    <reporter username="namit">Namit Jain</reporter>
                        <labels>
                    </labels>
                <created>Wed, 13 Oct 2010 15:54:21 +0000</created>
                <updated>Fri, 16 Dec 2011 23:59:23 +0000</updated>
                            <resolved>Sat, 16 Oct 2010 05:02:57 +0000</resolved>
                                                    <fixVersion>0.7.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12920683" author="namit" created="Wed, 13 Oct 2010 17:42:10 +0000"  >&lt;p&gt;Also, can you make sure that the old location gets deleted ?&lt;br/&gt;
(it can be different from the new location).&lt;/p&gt;

&lt;p&gt;This can lead to a problem if another table (external) pointed to the old location,&lt;br/&gt;
but I guess we can live with it.&lt;/p&gt;</comment>
                            <comment id="12920696" author="he yongqiang" created="Wed, 13 Oct 2010 18:03:08 +0000"  >&lt;p&gt;Yes. We should delete the old data. Even today, if two tables/partitions share the same location, one delete will delete the data. &lt;/p&gt;

&lt;p&gt;Will upload a patch soon. The main problem here is to add testcases. (I can do tests on internal clusters.)&lt;/p&gt;</comment>
                            <comment id="12920697" author="namit" created="Wed, 13 Oct 2010 18:08:49 +0000"  >&lt;p&gt;Thats fine - I agree it will be difficult to add a unit test for this&lt;/p&gt;</comment>
                            <comment id="12921546" author="namit" created="Fri, 15 Oct 2010 20:59:02 +0000"  >&lt;p&gt;1. I dont think we should add a new varaible &quot;hive.exec.partition.usetable.dfs&quot; -&lt;br/&gt;
we should always use table dfs.&lt;br/&gt;
2. I think there is a bug when the table&apos;s location does not contain the fs (in SemanticAnalyzer).&lt;/p&gt;

&lt;p&gt;      Path tabPath = dest_tab.getPath();	&lt;br/&gt;
      Path partPath = dest_part.getPartitionPath(); &lt;br/&gt;
      if (conf.getBoolVar(HiveConf.ConfVars.HIVEPARTITIONUSETBLDFS)) &lt;/p&gt;
{
        // if the table is in a different dfs than the partition,
        // replace the partition&apos;s dfs with the table&apos;s dfs.
        dest_path = new Path(tabPath.toUri().getScheme(), tabPath.toUri()
            .getAuthority(), partPath.toUri().getPath());
      }
&lt;p&gt; else {&lt;/p&gt;

&lt;p&gt;We should pick the default fs then.&lt;/p&gt;

&lt;p&gt;3. Path newPartPath = new Path(loadPath.toUri().getScheme(), loadPath&lt;br/&gt;
          .toUri().getAuthority(), oldPartPath.toUri().getPath());&lt;/p&gt;

&lt;p&gt;same as above in Hive.java&lt;/p&gt;

&lt;p&gt;4.           if (partPath != null	&lt;br/&gt;
              &amp;amp;&amp;amp; !partPath.equalsIgnoreCase(tpart.getSd().getLocation())) &lt;/p&gt;
{
            tpart.getSd().setLocation(partPath);
          }


&lt;p&gt;Cant we always set the location ?&lt;/p&gt;
</comment>
                            <comment id="12921577" author="namit" created="Fri, 15 Oct 2010 22:30:46 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Will commit if the tests pass&lt;/p&gt;</comment>
                            <comment id="12921582" author="namit" created="Fri, 15 Oct 2010 22:38:36 +0000"  >&lt;p&gt;All the tests are failing&lt;/p&gt;</comment>
                            <comment id="12921605" author="he yongqiang" created="Sat, 16 Oct 2010 00:35:49 +0000"  >&lt;p&gt;made the change and running tests on my local.&lt;/p&gt;</comment>
                            <comment id="12921633" author="namit" created="Sat, 16 Oct 2010 05:02:57 +0000"  >&lt;p&gt;Committed. Thanks Yongqiang&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12504577">HIVE-2117</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12457292" name="hive-1707.1.patch" size="9832" author="he yongqiang" created="Fri, 15 Oct 2010 20:15:15 +0000"/>
                            <attachment id="12457307" name="hive-1707.2.patch" size="8369" author="he yongqiang" created="Fri, 15 Oct 2010 22:27:42 +0000"/>
                            <attachment id="12457315" name="hive-1707.3.patch" size="8306" author="he yongqiang" created="Sat, 16 Oct 2010 00:35:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72757</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 6 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lghr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123322</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>