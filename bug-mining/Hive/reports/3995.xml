<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:38:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-11988] [hive] security issue with hive &amp; ranger for import table command</title>
                <link>https://issues.apache.org/jira/browse/HIVE-11988</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;if a user does not have permission to create table in hive , then if the same user import data for a table using following command then , it will have to create table also and that is working successfully , ideally it should not work&lt;br/&gt;
STR:&lt;br/&gt;
====&lt;br/&gt;
1. put some raw data in hdfs path /user/user1/tempdata&lt;br/&gt;
2. in ranger check policy , user1 should not have any permission on any table&lt;br/&gt;
3. login through user1 into beeline ( obviously it will fail since user doesnt have permission to create table)&lt;br/&gt;
create table tt1(id INT,ff String);&lt;br/&gt;
FAILED: HiveAccessControlException Permission denied: user user1 does not have CREATE privilege on default/tt1 (state=42000,code=40000)&lt;br/&gt;
4. now try following command to import data into a table ( table should not exist already)&lt;br/&gt;
import table tt1 from &apos;/user/user1/tempdata&apos;;&lt;br/&gt;
ER:&lt;br/&gt;
since user1 doesnt have permission to create table so this operation should fail&lt;br/&gt;
AR:&lt;br/&gt;
table is created successfully and data is also imported !!&lt;/p&gt;</description>
                <environment></environment>
        <key id="12901364">HIVE-11988</key>
            <summary>[hive] security issue with hive &amp; ranger for import table command</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sushanth">Sushanth Sowmyan</assignee>
                                    <reporter username="deepakhuawei">Deepak Sharma</reporter>
                        <labels>
                    </labels>
                <created>Tue, 29 Sep 2015 16:53:24 +0000</created>
                <updated>Tue, 16 Feb 2016 23:51:08 +0000</updated>
                            <resolved>Thu, 29 Oct 2015 18:36:01 +0000</resolved>
                                    <version>0.14.0</version>
                    <version>1.2.1</version>
                                    <fixVersion>1.2.2</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Hive</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14975613" author="sushanth" created="Tue, 27 Oct 2015 03:31:04 +0000"  >&lt;p&gt;Patch attached.&lt;/p&gt;</comment>
                            <comment id="14975615" author="sushanth" created="Tue, 27 Oct 2015 03:31:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;thejas&lt;/a&gt;, could you please have a look?&lt;/p&gt;</comment>
                            <comment id="14975685" author="thejas" created="Tue, 27 Oct 2015 03:59:17 +0000"  >&lt;p&gt;+1&lt;br/&gt;
Thats a neat extension to the SQLStdHiveAuthorizationValidatorForTest class!&lt;br/&gt;
I also learned about some new guava library tricks! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14975711" author="thejas" created="Tue, 27 Oct 2015 04:29:32 +0000"  >&lt;p&gt;I suspect few additional import .q tests might need update for their q.out files as this adds the db writeentity.&lt;/p&gt;</comment>
                            <comment id="14975717" author="sushanth" created="Tue, 27 Oct 2015 04:41:10 +0000"  >&lt;p&gt;Oh! True. I remember thinking that I needed to update that, but somehow thought it was part of my previous plan for how I wanted to have a separate *ForTest class. I&apos;ll update it.&lt;/p&gt;</comment>
                            <comment id="14976102" author="sushanth" created="Tue, 27 Oct 2015 09:41:53 +0000"  >&lt;p&gt;Updated patch with the remainder of the .q.out files.&lt;/p&gt;</comment>
                            <comment id="14977043" author="sushanth" created="Tue, 27 Oct 2015 19:53:58 +0000"  >&lt;p&gt;One more patch update, I realized that we accidentally increased the scope of permissions required on the db for the old non-sqlstdauth cases, restoring that behaviour.&lt;/p&gt;</comment>
                            <comment id="14977351" author="thejas" created="Tue, 27 Oct 2015 23:23:38 +0000"  >&lt;p&gt;Update also looks good.&lt;/p&gt;</comment>
                            <comment id="14977443" author="hiveqa" created="Wed, 28 Oct 2015 00:15:56 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12769087/HIVE-11988.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12769087/HIVE-11988.3.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 2 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 7 failed/errored test(s), 9712 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_authorization_reset
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_import_exported_table
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_import_exported_table
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import
org.apache.hadoop.hive.hwi.TestHWISessionManager.testHiveDriver
org.apache.hadoop.hive.ql.io.orc.TestJsonFileDump.testJsonDump
org.apache.hive.jdbc.TestSSL.testSSLVersion
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5818/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5818/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5818/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5818/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5818/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5818/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 7 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12769087 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14977645" author="sushanth" created="Wed, 28 Oct 2015 03:21:39 +0000"  >&lt;p&gt;Ugh, looks like I missed updating 3 tests:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;TestMinimrCliDriver.testCliDriver_import_exported_table&lt;/li&gt;
	&lt;li&gt;TestMiniSparkOnYarnCliDriver.testCliDriver_import_exported_table&lt;/li&gt;
	&lt;li&gt;TestCliDriver.testCliDriver_authorization_reset&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;And a fourth test, which I thought I had updated is failing, but not for the extra PREHOOK/POSTHOOK : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I&apos;ll look into these and post an update tonight.&lt;/p&gt;</comment>
                            <comment id="14979320" author="sushanth" created="Wed, 28 Oct 2015 22:00:01 +0000"  >&lt;p&gt;Updated patch to cover the previous failures.&lt;/p&gt;</comment>
                            <comment id="14980293" author="hiveqa" created="Thu, 29 Oct 2015 11:29:15 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12769416/HIVE-11988.4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12769416/HIVE-11988.4.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 2 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 4 failed/errored test(s), 9733 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestHBaseCliDriver.testCliDriver_hbase_queries
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import
org.apache.hadoop.hive.hwi.TestHWISessionManager.testHiveDriver
org.apache.hive.jdbc.TestSSL.testSSLVersion
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5846/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5846/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5846/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5846/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5846/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5846/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 4 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12769416 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14980742" author="thejas" created="Thu, 29 Oct 2015 16:41:42 +0000"  >&lt;p&gt;Is there still an issue with authorization_uri_import  test?&lt;/p&gt;</comment>
                            <comment id="14980934" author="sushanth" created="Thu, 29 Oct 2015 18:10:30 +0000"  >&lt;p&gt;Looks like I applied my patch twice to the authorization_uri_import.q.out file. New patch uploaded.&lt;/p&gt;

&lt;p&gt;Thejas, does your +1 still hold for this update? i.e. since it is only a single minor .q.out update, can we commit without rerunning the entire gamut of tests again?&lt;/p&gt;

&lt;p&gt;I&apos;m uploading my singular test run output for authorization_uri_import.q and the hive.log file associated&lt;/p&gt;
</comment>
                            <comment id="14980949" author="thejas" created="Thu, 29 Oct 2015 18:15:16 +0000"  >&lt;p&gt;As this is just a single .q.out file update and you have verified it locally, I think it is good to go. Not worth running full test suite for that.&lt;/p&gt;</comment>
                            <comment id="14981008" author="sushanth" created="Thu, 29 Oct 2015 18:36:01 +0000"  >&lt;p&gt;Committed to master.&lt;/p&gt;</comment>
                            <comment id="14981036" author="sushanth" created="Thu, 29 Oct 2015 18:54:08 +0000"  >&lt;p&gt;Committed to branch-1 and branch-1.2 as well. Thanks, Thejas!&lt;/p&gt;</comment>
                            <comment id="15047157" author="aloklal99" created="Tue, 8 Dec 2015 17:57:37 +0000"  >&lt;p&gt;While testing &lt;a href=&quot;https://reviews.apache.org/r/41067/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;the Ranger patch&lt;/a&gt; I submitted to mimic these changes (&lt;a href=&quot;https://issues.apache.org/jira/browse/RANGER-772&quot; title=&quot;Hive plugin: Update Ranger authorizer to mimic changes made by Hive standard authorizer for the case when IMPORT can end up creating a table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RANGER-772&quot;&gt;&lt;del&gt;RANGER-772&lt;/del&gt;&lt;/a&gt;), I see that the &lt;tt&gt;checkPrivilages&lt;/tt&gt; call for IMPORT when import would create a table does not include the table name in it.  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=madhan.neethiraj&quot; class=&quot;user-hover&quot; rel=&quot;madhan.neethiraj&quot;&gt;madhan.neethiraj&lt;/a&gt;, one of the reviewers of that patch observed that this could lead to following two potential usability issues:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;In Ranger a user&apos;s access privileges can be specified using wildcards. Say, a user in finance department has been given create privileges at the database level for any table that starts with fin, i.e. &lt;tt&gt;fin*&lt;/tt&gt;. If such a user attempts to import a table named, say, &lt;tt&gt;fintemp&lt;/tt&gt; then that operation would fail since we currently require database level privilege.&lt;/li&gt;
	&lt;li&gt;Ranger audits various user actions. Since table name isn&apos;t specified we can&apos;t record which table was got created. In some cases this could be inferred from the command string passed that is into the &lt;tt&gt;checkPrivilages&lt;/tt&gt; (which we store off in our audit). However, when &lt;tt&gt;IMPORT&lt;/tt&gt; does not specify the table name then in that case that information may not be readily available to user.&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="15049092" author="sushanth" created="Wed, 9 Dec 2015 18:04:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aloklal99&quot; class=&quot;user-hover&quot; rel=&quot;aloklal99&quot;&gt;aloklal99&lt;/a&gt;, that&apos;s a good point. I will create a new bug to track this issue. It does look like on a plain CREATE-TABLE, the new table being created also is created as a WriteEntity. I will create a new bug to do so.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12920502">HIVE-12630</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12768944" name="HIVE-11988.2.patch" size="31737" author="sushanth" created="Tue, 27 Oct 2015 09:41:53 +0000"/>
                            <attachment id="12769087" name="HIVE-11988.3.patch" size="31419" author="sushanth" created="Tue, 27 Oct 2015 19:53:58 +0000"/>
                            <attachment id="12769416" name="HIVE-11988.4.patch" size="34050" author="sushanth" created="Wed, 28 Oct 2015 22:00:01 +0000"/>
                            <attachment id="12769583" name="HIVE-11988.5.patch" size="32906" author="sushanth" created="Thu, 29 Oct 2015 18:10:48 +0000"/>
                            <attachment id="12768887" name="HIVE-11988.patch" size="10558" author="sushanth" created="Tue, 27 Oct 2015 03:31:04 +0000"/>
                            <attachment id="12769586" name="authorization_uri_import_q_hive.log" size="4141915" author="sushanth" created="Thu, 29 Oct 2015 18:14:45 +0000"/>
                            <attachment id="12769587" name="authorization_uri_import_q_output.txt" size="150046" author="sushanth" created="Thu, 29 Oct 2015 18:14:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 50 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2meyn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>