<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:27:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-8740] Sorted dynamic partition does not work correctly with constant folding</title>
                <link>https://issues.apache.org/jira/browse/HIVE-8740</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Sorted dynamic partition optimization looks for partition columns from the operator above FileSinkOperator. As per hive convention it expects partition columns at the last. But with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-8585&quot; title=&quot;Constant folding should happen before ppd&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-8585&quot;&gt;&lt;del&gt;HIVE-8585&lt;/del&gt;&lt;/a&gt; equality filters on partition columns gets folded to constant. The column pruner then prunes the constant expression as they don&apos;t reference any columns. This in some cases will yield unexpected results (throw ArrayIndexOutOfBounds exception) with sorted dynamic partition insert optimization. In such cases we don&apos;t really need sorted dynamic partition optimization.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12752978">HIVE-8740</key>
            <summary>Sorted dynamic partition does not work correctly with constant folding</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="prasanth_j">Prasanth Jayachandran</assignee>
                                    <reporter username="prasanth_j">Prasanth Jayachandran</reporter>
                        <labels>
                    </labels>
                <created>Wed, 5 Nov 2014 07:05:29 +0000</created>
                <updated>Tue, 1 Oct 2019 22:07:01 +0000</updated>
                            <resolved>Thu, 6 Nov 2014 00:38:48 +0000</resolved>
                                    <version>0.14.0</version>
                                    <fixVersion>0.14.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14197718" author="prasanth_j" created="Wed, 5 Nov 2014 07:09:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gates&quot; class=&quot;user-hover&quot; rel=&quot;gates&quot;&gt;gates&lt;/a&gt; Can you look at the test case that I added in this patch? Its related to ACID DELETE operation. After deleting a newly added row, the select count&amp;#40;*&amp;#41; query return 0 rows instead of actual 1000 rows. Is this a bug/known issue or am I doing something wrong?&lt;/p&gt;</comment>
                            <comment id="14198322" author="hiveqa" created="Wed, 5 Nov 2014 12:26:08 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12679485/HIVE-8740.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12679485/HIVE-8740.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 6673 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hive.hcatalog.streaming.TestStreaming.testEndpointConnection
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1644/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1644/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1644/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1644/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1644/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1644/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12679485 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14198913" author="alangates" created="Wed, 5 Nov 2014 19:24:13 +0000"  >&lt;p&gt;Is this the set of queries you&apos;re referring to?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+insert into table acid partition(ds)  select key,value,ds from srcpart;
+select count(*) from acid where ds=&lt;span class=&quot;code-quote&quot;&gt;&apos;2008-04-08&apos;&lt;/span&gt;;
+
+insert into table acid partition(ds=&lt;span class=&quot;code-quote&quot;&gt;&apos;2008-04-08&apos;&lt;/span&gt;) values(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;);
+select count(*) from acid where ds=&lt;span class=&quot;code-quote&quot;&gt;&apos;2008-04-08&apos;&lt;/span&gt;;
+
+update acid set key = &lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt; where ds=&lt;span class=&quot;code-quote&quot;&gt;&apos;2008-04-08&apos;&lt;/span&gt;;
+select count(*) from acid where ds=&lt;span class=&quot;code-quote&quot;&gt;&apos;2008-04-08&apos;&lt;/span&gt;;
+
+update acid set key = &lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt; where ds in (&lt;span class=&quot;code-quote&quot;&gt;&apos;2008-04-08&apos;&lt;/span&gt;);
+select count(*) from acid where ds in (&lt;span class=&quot;code-quote&quot;&gt;&apos;2008-04-08&apos;&lt;/span&gt;);
+
+delete from acid where key = &lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt; and ds=&lt;span class=&quot;code-quote&quot;&gt;&apos;2008-04-08&apos;&lt;/span&gt;;
+select count(*) from acid where ds=&lt;span class=&quot;code-quote&quot;&gt;&apos;2008-04-08&apos;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I don&apos;t see an issue here.  You&apos;re setting every row in 2008-04-08 to have a key of foo, and then deleting all records with a key of foo, so that partition will be empty.&lt;/p&gt;</comment>
                            <comment id="14198987" author="prasanth_j" created="Wed, 5 Nov 2014 20:13:25 +0000"  >&lt;p&gt;Ah ok!. With hive convention of &quot;INSERT INTO&quot; I was thinking new rows will be appended to the existing partition and not replacing it.&lt;/p&gt;</comment>
                            <comment id="14199116" author="alangates" created="Wed, 5 Nov 2014 21:26:20 +0000"  >&lt;p&gt;insert into should never replace rows.  You are changing the key of all rows to foo in the statement &quot;update acid set key = &apos;foo&apos;&quot;  Then you say &quot;delete from acid where key = &apos;foo&apos;&quot;, so all rows get deleted.&lt;/p&gt;</comment>
                            <comment id="14199157" author="prasanth_j" created="Wed, 5 Nov 2014 21:42:48 +0000"  >&lt;p&gt;Thanks for the clarification &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gates&quot; class=&quot;user-hover&quot; rel=&quot;gates&quot;&gt;gates&lt;/a&gt;. That was my mistake.. I should have added &quot;where value = &apos;bar&apos;&quot; to the predicate to get the result that I was expecting. Updated the queries in this new patch.&lt;/p&gt;</comment>
                            <comment id="14199237" author="hagleitn" created="Wed, 5 Nov 2014 22:24:16 +0000"  >&lt;p&gt;LGTM +1 (also for .14. fixes major issue and the change is small/safe).&lt;/p&gt;</comment>
                            <comment id="14199263" author="prasanth_j" created="Wed, 5 Nov 2014 22:40:06 +0000"  >&lt;p&gt;Added more tests to cover cases where sorted dynamic partition is enabled and constant propagation is disabled to make sure the generated plan and results are correct.&lt;/p&gt;</comment>
                            <comment id="14199371" author="hiveqa" created="Wed, 5 Nov 2014 23:37:12 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12679639/HIVE-8740.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12679639/HIVE-8740.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 6673 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hive.hcatalog.streaming.TestStreaming.testTransactionBatchCommit_Json
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1648/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1648/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1648/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1648/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1648/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1648/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12679639 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14199430" author="prasanth_j" created="Thu, 6 Nov 2014 00:12:57 +0000"  >&lt;p&gt;Rebased patch after &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-8716&quot; title=&quot;Partition filters are not pushed down with lateral view&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-8716&quot;&gt;&lt;del&gt;HIVE-8716&lt;/del&gt;&lt;/a&gt; commit.&lt;/p&gt;</comment>
                            <comment id="14199471" author="prasanth_j" created="Thu, 6 Nov 2014 00:38:48 +0000"  >&lt;p&gt;Committed to trunk and branch-0.14&lt;/p&gt;</comment>
                            <comment id="14199472" author="hiveqa" created="Thu, 6 Nov 2014 00:38:48 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12679663/HIVE-8740.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12679663/HIVE-8740.3.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 2 failed/errored test(s), 6674 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_optimize_nullscan
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_mapjoin_reduce
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1649/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1649/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1649/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1649/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1649/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1649/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12679663 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14210869" author="thejas" created="Thu, 13 Nov 2014 19:43:00 +0000"  >&lt;p&gt;This has been fixed in 0.14 release. Please open new jira if you see any issues.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12679485" name="HIVE-8740.1.patch" size="55106" author="prasanth_j" created="Wed, 5 Nov 2014 07:07:40 +0000"/>
                            <attachment id="12679639" name="HIVE-8740.2.patch" size="55435" author="prasanth_j" created="Wed, 5 Nov 2014 21:42:48 +0000"/>
                            <attachment id="12679663" name="HIVE-8740.3.patch" size="71215" author="prasanth_j" created="Wed, 5 Nov 2014 22:40:06 +0000"/>
                            <attachment id="12679702" name="HIVE-8740.4.patch" size="70227" author="prasanth_j" created="Thu, 6 Nov 2014 00:12:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i21zjz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>