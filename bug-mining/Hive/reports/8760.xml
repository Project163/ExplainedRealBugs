<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:26:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-28632] Fix issues in JSON SerDe implementations related to Boolean, Binary data types</title>
                <link>https://issues.apache.org/jira/browse/HIVE-28632</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;&lt;b&gt;Boolean Handling:&lt;/b&gt; Prior to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-21240&quot; title=&quot;JSON SerDe Re-Write&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-21240&quot;&gt;&lt;del&gt;HIVE-21240&lt;/del&gt;&lt;/a&gt;, the JSON deserializer converted boolean strings without considering case sensitivity, resulting in&#160;&lt;tt&gt;false&lt;/tt&gt;&#160;for any non-standard strings. Now, this behavior is case-sensitive, resulting in&#160;&lt;tt&gt;false&lt;/tt&gt;&#160;for all non-conforming strings. To follow SQL standards, any string other than &quot;false&quot; (case-insensitive) should be treated as&#160;&lt;tt&gt;true&lt;/tt&gt;. There are also inconsistencies between outputs when using an INSERT statement (which follows SQL standards) and loading a JSON value directly. These inconsistencies need to be fixed to ensure uniform output.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Binary Handling:&lt;/b&gt; Previously, Hive parsed JSON nodes as raw strings, allowing users to directly load JSON text to achieve desired results. Post &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-21240&quot; title=&quot;JSON SerDe Re-Write&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-21240&quot;&gt;&lt;del&gt;HIVE-21240&lt;/del&gt;&lt;/a&gt;, Hive now mandates base64-encoded JSON texts, throwing errors for any other format. It&apos;s important to note that INSERT statements work seamlessly as the values are serialized to base64 and then deserialized. Hive should be capable of detecting if a JSON node is base64-encoded or not; if not, it should default to deserializing as a raw string.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;&lt;ins&gt;To enhance user experience and maintain SQL standard compliance, we need to address the following:&lt;/ins&gt;&lt;/b&gt;&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Ensure case-sensitive handling of boolean strings in JSON deserialization and resolve inconsistencies between INSERT statements and direct JSON loading.&lt;/li&gt;
	&lt;li&gt;Implement automatic detection and appropriate deserialization of JSON nodes, distinguishing between base64-encoded and raw strings.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&lt;b&gt;&lt;ins&gt;Steps to replicate boolean handling issue:&lt;/ins&gt;&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// values &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; json: &lt;span class=&quot;code-quote&quot;&gt;&quot;booleancaseinsensitive&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;TrUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;booleanstring&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;booleanboolean&quot;&lt;/span&gt; : &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;stringfalse&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;FaLSE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;somestring&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;somestringhere&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;booleannull&quot;&lt;/span&gt; : &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;booleannumfalse&quot;&lt;/span&gt; : 0, &lt;span class=&quot;code-quote&quot;&gt;&quot;booleannumtrue&quot;&lt;/span&gt; : -1
&lt;/span&gt;
create table json_serde_bool_table (
&#160; &#160; booleancaseinsensitive &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;,
&#160; &#160; booleanstring &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;,
&#160; &#160; booleanboolean &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;,
&#160; &#160; stringfalse &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;,
&#160; &#160; somestring &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;,
&#160; &#160; booleannull &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;,
&#160; &#160; booleannumfalse &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;,
&#160; &#160; booleannumtrue &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
&#160; row format serde &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.hadoop.hive.serde2.JsonSerDe&apos;&lt;/span&gt;;


LOAD DATA INPATH &lt;span class=&quot;code-quote&quot;&gt;&apos;/warehouse/files/jsonserde.txt&apos;&lt;/span&gt; INTO TABLE json_serde_bool_table;

select * from json_serde_bool_table;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;ins&gt;&lt;em&gt;Output for the above:&lt;/em&gt;&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+-------------------------+----------------+-----------------+--------------+-------------+--------------+------------------+-----------------+
| booleancaseinsensitive &#160;| booleanstring &#160;| booleanboolean &#160;| stringfalse &#160;| somestring &#160;| booleannull &#160;| booleannumfalse &#160;| booleannumtrue &#160;|
+-------------------------+----------------+-----------------+--------------+-------------+--------------+------------------+-----------------+
| false &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; | true &#160; &#160; &#160; &#160; &#160; | true &#160; &#160; &#160; &#160; &#160; &#160;| false &#160; &#160; &#160; &#160;| false &#160; &#160; &#160; | NULL &#160; &#160; &#160; &#160; | false &#160; &#160; &#160; &#160; &#160; &#160;| true &#160; &#160; &#160; &#160; &#160; &#160;|
+-------------------------+----------------+-----------------+--------------+-------------+--------------+------------------+-----------------+&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
truncate table json_serde_bool_table;

INSERT INTO TABLE json_serde_bool_table VALUES (&lt;span class=&quot;code-quote&quot;&gt;&quot;TrUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;FaLSE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;somestringhere&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, 0, -1);

select * from json_serde_bool_table;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;ins&gt;&lt;em&gt;Output for the above:&lt;/em&gt;&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+-------------------------+----------------+-----------------+--------------+-------------+--------------+------------------+-----------------+
| booleancaseinsensitive &#160;| booleanstring &#160;| booleanboolean &#160;| stringfalse &#160;| somestring &#160;| booleannull &#160;| booleannumfalse &#160;| booleannumtrue &#160;|
+-------------------------+----------------+-----------------+--------------+-------------+--------------+------------------+-----------------+
| true &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;| true &#160; &#160; &#160; &#160; &#160; | true &#160; &#160; &#160; &#160; &#160; &#160;| false &#160; &#160; &#160; &#160;| true &#160; &#160; &#160; &#160;| NULL &#160; &#160; &#160; &#160; | false &#160; &#160; &#160; &#160; &#160; &#160;| true &#160; &#160; &#160; &#160; &#160; &#160;|
+-------------------------+----------------+-----------------+--------------+-------------+--------------+------------------+-----------------+&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;b&gt;&lt;ins&gt;Steps to replicate binary handling issue:&lt;/ins&gt;&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
create table json_serde_table (
&#160; binarycolumn1 binary,
&#160; binarycolumn2 binary,
&#160; binarycolumn3 binary,
&#160; binarycolumn4 binary,
&#160; binarycolumn5 binary,
&#160; binarycolumn6 binary
)
row format serde &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.hadoop.hive.serde2.JsonSerDe&apos;&lt;/span&gt;;

LOAD DATA INPATH &lt;span class=&quot;code-quote&quot;&gt;&apos;/path/to/jsonserde.txt&apos;&lt;/span&gt; INTO TABLE json_serde_table; &lt;span class=&quot;code-comment&quot;&gt;// the concerned json text show be normal text(not base64)
&lt;/span&gt;
select * from json_serde_table; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;&lt;ins&gt;Error stack trace:&lt;/ins&gt;&lt;/em&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Failed with exception java.io.IOException:org.apache.hadoop.hive.serde2.SerDeException:
org.apache.hadoop.hive.serde2.SerDeException: Error generating JSON binary type
from record.
java.io.IOException:
org.apache.hadoop.hive.serde2.SerDeException:
org.apache.hadoop.hive.serde2.SerDeException: Error generating JSON binary type
from record.
at
org.apache.hadoop.hive.ql.exec.FetchOperator.getNextRow(FetchOperator.java:628)
at
org.apache.hadoop.hive.ql.exec.FetchOperator.pushRow(FetchOperator.java:535)
at
org.apache.hadoop.hive.ql.exec.FetchTask.executeInner(FetchTask.java:194)
at
org.apache.hadoop.hive.ql.exec.FetchTask.execute(FetchTask.java:95)
at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:212)
at org.apache.hadoop.hive.ql.Driver.run(Driver.java:154)
at org.apache.hadoop.hive.ql.Driver.run(Driver.java:149)
at
org.apache.hadoop.hive.ql.reexec.ReExecDriver.run(ReExecDriver.java:185)
at
org.apache.hive.service.cli.operation.SQLOperation.runQuery(SQLOperation.java:236)
at
org.apache.hive.service.cli.operation.SQLOperation$BackgroundWork$1.run(SQLOperation.java:336)
at
java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
at
org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899)
at
org.apache.hive.service.cli.operation.SQLOperation$BackgroundWork.run(SQLOperation.java:356)
at
java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
at
java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
at
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
at
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:840)
Caused
by: org.apache.hadoop.hive.serde2.SerDeException:
org.apache.hadoop.hive.serde2.SerDeException: Error generating JSON binary type
from record.
at
org.apache.hadoop.hive.serde2.JsonSerDe.deserialize(JsonSerDe.java:191)
at
org.apache.hadoop.hive.ql.exec.FetchOperator.getNextRow(FetchOperator.java:609)
... 18 more
Caused
by: org.apache.hadoop.hive.serde2.SerDeException: Error generating JSON binary
type from record.
at
org.apache.hadoop.hive.serde2.json.HiveJsonReader.getByteValue(HiveJsonReader.java:464)
at
org.apache.hadoop.hive.serde2.json.HiveJsonReader.visitLeafNode(HiveJsonReader.java:418)
at
org.apache.hadoop.hive.serde2.json.HiveJsonReader.visitNode(HiveJsonReader.java:224)
at
org.apache.hadoop.hive.serde2.json.HiveJsonReader.visitStructNode(HiveJsonReader.java:335)
at
org.apache.hadoop.hive.serde2.json.HiveJsonReader.visitNode(HiveJsonReader.java:229)
at
org.apache.hadoop.hive.serde2.json.HiveJsonReader.parseStruct(HiveJsonReader.java:206)
at
org.apache.hadoop.hive.serde2.JsonSerDe.deserialize(JsonSerDe.java:187)
... 19 more
Caused
by: org.apache.hive.com.fasterxml.jackson.databind.exc.InvalidFormatException:
Cannot access contents of TextNode as binary due to broken Base64 encoding:
Unexpected end of base64-encoded &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;: base64 variant &lt;span class=&quot;code-quote&quot;&gt;&apos;MIME-NO-LINEFEEDS&apos;&lt;/span&gt;
expects padding (one or more &lt;span class=&quot;code-quote&quot;&gt;&apos;=&apos;&lt;/span&gt; characters) at the end. This Base64Variant
might have been incorrectly configured
at
org.apache.hive.com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:67)
at
org.apache.hive.com.fasterxml.jackson.databind.node.TextNode.getBinaryValue(TextNode.java:78)
at
org.apache.hive.com.fasterxml.jackson.databind.node.TextNode.binaryValue(TextNode.java:89)
at
org.apache.hadoop.hive.serde2.json.HiveJsonReader.getByteValue(HiveJsonReader.java:458)
... 25 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13599099">HIVE-28632</key>
            <summary>Fix issues in JSON SerDe implementations related to Boolean, Binary data types</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="araika">Araika Singh</assignee>
                                    <reporter username="araika">Araika Singh</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 18 Nov 2024 09:14:20 +0000</created>
                <updated>Tue, 29 Jul 2025 14:51:57 +0000</updated>
                            <resolved>Thu, 28 Nov 2024 13:21:07 +0000</resolved>
                                                    <fixVersion>4.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17901720" author="dkuzmenko" created="Thu, 28 Nov 2024 13:20:56 +0000"  >&lt;p&gt;Merged to master&lt;br/&gt;
Thanks for the patch &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=araika&quot; class=&quot;user-hover&quot; rel=&quot;araika&quot;&gt;araika&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            49 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1sm4g:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>