<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:27:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-29003] DatePartitionedLogger from Tez is always needed for hive logging hook</title>
                <link>https://issues.apache.org/jira/browse/HIVE-29003</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-28028&quot; title=&quot;Remove duplicated proto reader/writer classes introduced in HIVE-19288&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-28028&quot;&gt;&lt;del&gt;HIVE-28028&lt;/del&gt;&lt;/a&gt; removed some Tez class sources from the Hive repository. However, the corresponding artifacts are still required by certain Hive components (e.g., metastore schema initialization), where the tez-protobuf-history-plugin JAR is not intended to be on the classpath.&lt;/p&gt;

&lt;p&gt;The user should not be responsible for including this JAR manually&#8212;especially since the hive-exec fat JAR is expected to include everything necessary, properly shaded (though not necessarily relocalized).&lt;/p&gt;

&lt;p&gt;The absence of these classes caused something like below:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.hive.service.cli.HiveSQLException: Error running query: java.lang.NoClassDefFoundError: org/apache/tez/dag/history/logging/proto/DatePartitionedLogger
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;full context:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2025-06-09 12:49:13,217 INFO  org.apache.hadoop.hive.ql.Driver: [HiveServer2-Background-Pool: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-69]: Executing command(queryId=hive_20250609124913_b5efd16f-35b0-424a-b839-b298358b8395): CREATE DATABASE IF NOT EXISTS SYS
2025-06-09 12:49:13,222 INFO  org.apache.hadoop.hive.ql.hooks.HiveProtoLoggingHook: [HiveServer2-Background-Pool: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-69]: Event per file enabled: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
2025-06-09 12:49:13,223 INFO  org.apache.hadoop.hive.ql.reexec.ReOptimizePlugin: [HiveServer2-Background-Pool: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-69]: ReOptimization: retryPossible: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
2025-06-09 12:49:13,223 INFO  org.apache.hadoop.hive.ql.reexec.ReExecuteLostAMQueryPlugin: [HiveServer2-Background-Pool: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-69]: Exception is not a TezRuntimeException, no need to check further with ReExecuteLostAMQueryPlugin
2025-06-09 12:49:13,223 INFO  org.apache.hadoop.hive.ql.reexec.ReExecutionDagSubmitPlugin: [HiveServer2-Background-Pool: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-69]: Got exception message: org/apache/tez/dag/history/logging/proto/DatePartitionedLogger retryPossible: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
2025-06-09 12:49:13,224 INFO  org.apache.hadoop.hive.ql.reexec.ReExecuteOnWriteConflictPlugin: [HiveServer2-Background-Pool: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-69]: Got exception message: org/apache/tez/dag/history/logging/proto/DatePartitionedLogger retryPossible: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
2025-06-09 12:49:13,224 INFO  org.apache.hadoop.hive.ql.hooks.HiveProtoLoggingHook: [HiveServer2-Background-Pool: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-69]: Event per file enabled: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
2025-06-09 12:49:13,225 INFO  hive.ql.metadata.Hive: [HiveServer2-Background-Pool: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-69]: Dumping metastore api call timing information &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; : execution phase
2025-06-09 12:49:13,225 INFO  hive.ql.metadata.Hive: [HiveServer2-Background-Pool: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-69]: Total time spent in each metastore function (ms): {}
2025-06-09 12:49:13,225 INFO  org.apache.hadoop.hive.ql.Driver: [HiveServer2-Background-Pool: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-69]: Completed executing command(queryId=hive_20250609124913_b5efd16f-35b0-424a-b839-b298358b8395); Time taken: 0.008 seconds
2025-06-09 12:49:13,225 INFO  org.apache.hadoop.hive.ql.Driver: [HiveServer2-Background-Pool: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-69]: OK
2025-06-09 12:49:13,230 ERROR org.apache.hive.service.cli.operation.Operation: [HiveServer2-Background-Pool: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-69]: Error running hive query: 
org.apache.hive.service.cli.HiveSQLException: Error running query: java.lang.NoClassDefFoundError: org/apache/tez/dag/history/logging/proto/DatePartitionedLogger
	at org.apache.hive.service.cli.operation.SQLOperation.runQuery(SQLOperation.java:256) ~[hive-service-3.1.3000.7.3.1.400-92.jar:3.1.3000.7.3.1.400-92]
	at org.apache.hive.service.cli.operation.SQLOperation.access$700(SQLOperation.java:92) ~[hive-service-3.1.3000.7.3.1.400-92.jar:3.1.3000.7.3.1.400-92]
	at org.apache.hive.service.cli.operation.SQLOperation$BackgroundWork$1.run(SQLOperation.java:341) ~[hive-service-3.1.3000.7.3.1.400-92.jar:3.1.3000.7.3.1.400-92]
	at java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_232]
	at javax.security.auth.Subject.doAs(Subject.java:422) ~[?:1.8.0_232]
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1910) ~[hadoop-common-3.1.1.7.3.1.400-92.jar:?]
	at org.apache.hive.service.cli.operation.SQLOperation$BackgroundWork.run(SQLOperation.java:361) ~[hive-service-3.1.3000.7.3.1.400-92.jar:3.1.3000.7.3.1.400-92]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[?:1.8.0_232]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[?:1.8.0_232]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[?:1.8.0_232]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[?:1.8.0_232]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_232]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_232]
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748) ~[?:1.8.0_232]
Caused by: java.lang.NoClassDefFoundError: org/apache/tez/dag/history/logging/proto/DatePartitionedLogger
	at org.apache.hadoop.hive.ql.hooks.HiveProtoLoggingHook$EventLogger.&amp;lt;init&amp;gt;(HiveProtoLoggingHook.java:206) ~[hive-exec-3.1.3000.7.3.1.400-92.jar:3.1.3000.7.3.1.400-92]
	at org.apache.hadoop.hive.ql.hooks.HiveProtoLoggingHook$EventLogger.getInstance(HiveProtoLoggingHook.java:559) ~[hive-exec-3.1.3000.7.3.1.400-92.jar:3.1.3000.7.3.1.400-92]
	at org.apache.hadoop.hive.ql.hooks.HiveProtoLoggingHook.run(HiveProtoLoggingHook.java:571) ~[hive-exec-3.1.3000.7.3.1.400-92.jar:3.1.3000.7.3.1.400-92]
	at org.apache.hadoop.hive.ql.HookRunner.invokeGeneralHook(HookRunner.java:307) ~[hive-exec-3.1.3000.7.3.1.400-92.jar:3.1.3000.7.3.1.400-92]
	at org.apache.hadoop.hive.ql.HookRunner.runFailureHooks(HookRunner.java:294) ~[hive-exec-3.1.3000.7.3.1.400-92.jar:3.1.3000.7.3.1.400-92]
	at org.apache.hadoop.hive.ql.DriverUtils.invokeFailureHooks(DriverUtils.java:158) ~[hive-exec-3.1.3000.7.3.1.400-92.jar:3.1.3000.7.3.1.400-92]
	at org.apache.hadoop.hive.ql.Executor.handleException(Executor.java:514) ~[hive-exec-3.1.3000.7.3.1.400-92.jar:3.1.3000.7.3.1.400-92]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:118) ~[hive-exec-3.1.3000.7.3.1.400-92.jar:3.1.3000.7.3.1.400-92]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:812) ~[hive-exec-3.1.3000.7.3.1.400-92.jar:3.1.3000.7.3.1.400-92]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:547) ~[hive-exec-3.1.3000.7.3.1.400-92.jar:3.1.3000.7.3.1.400-92]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:541) ~[hive-exec-3.1.3000.7.3.1.400-92.jar:3.1.3000.7.3.1.400-92]
	at org.apache.hadoop.hive.ql.reexec.ReExecDriver.run(ReExecDriver.java:190) ~[hive-exec-3.1.3000.7.3.1.400-92.jar:3.1.3000.7.3.1.400-92]
	at org.apache.hive.service.cli.operation.SQLOperation.runQuery(SQLOperation.java:236) ~[hive-service-3.1.3000.7.3.1.400-92.jar:3.1.3000.7.3.1.400-92]
	... 13 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13620662">HIVE-29003</key>
            <summary>DatePartitionedLogger from Tez is always needed for hive logging hook</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="abstractdog">L&#225;szl&#243; Bodor</assignee>
                                    <reporter username="abstractdog">L&#225;szl&#243; Bodor</reporter>
                        <labels>
                            <label>hive-4.1.0-must</label>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 11 Jun 2025 12:07:28 +0000</created>
                <updated>Tue, 29 Jul 2025 14:51:42 +0000</updated>
                            <resolved>Sat, 21 Jun 2025 07:10:09 +0000</resolved>
                                                    <fixVersion>4.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17985067" author="abstractdog" created="Sat, 21 Jun 2025 07:10:02 +0000"  >&lt;p&gt;merged to master, thanks for the reviews and discussion &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Aggarwal_Raghav&quot; class=&quot;user-hover&quot; rel=&quot;Aggarwal_Raghav&quot;&gt;Aggarwal_Raghav&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ayushtkn&quot; class=&quot;user-hover&quot; rel=&quot;ayushtkn&quot;&gt;ayushtkn&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dkuzmenko&quot; class=&quot;user-hover&quot; rel=&quot;dkuzmenko&quot;&gt;dkuzmenko&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13565989">HIVE-28028</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1waeg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>