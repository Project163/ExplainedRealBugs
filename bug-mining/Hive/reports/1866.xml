<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:15:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-6268] Network resource leak with HiveClientCache when using HCatInputFormat</title>
                <link>https://issues.apache.org/jira/browse/HIVE-6268</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;HCatInputFormat has a cache feature that allows HCat to cache hive client connections to the metastore, so as to not keep reinstantiating a new hive server every single time. This uses a guava cache of hive clients, which only evicts entries from cache on the next write, or by manually managing the cache.&lt;/p&gt;

&lt;p&gt;So, in a single threaded case, where we reuse the hive client, the cache works well, but in a massively multithreaded case, where each thread might perform one action, and then is never used, there are no more writes to the cache, and all the clients stay alive, thus keeping ports open.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12690534">HIVE-6268</key>
            <summary>Network resource leak with HiveClientCache when using HCatInputFormat</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sushanth">Sushanth Sowmyan</assignee>
                                    <reporter username="sushanth">Sushanth Sowmyan</reporter>
                        <labels>
                    </labels>
                <created>Thu, 23 Jan 2014 02:52:42 +0000</created>
                <updated>Wed, 12 Nov 2014 01:44:23 +0000</updated>
                            <resolved>Fri, 31 Jan 2014 03:08:05 +0000</resolved>
                                    <version>0.12.0</version>
                                    <fixVersion>0.13.0</fixVersion>
                                    <component>HCatalog</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13880136" author="sushanth" created="Thu, 23 Jan 2014 17:55:22 +0000"  >&lt;p&gt;To fix this, we can do two things :&lt;/p&gt;

&lt;p&gt;a) Provide a jobconf parameter that allows users to disable usage of the cache altogether. Useful for massively multithreaded cases.&lt;br/&gt;
b) In the cases that use a cache, we should spawn a separate maintenance thread that will prune and expire from time to time.&lt;/p&gt;

&lt;p&gt;Attaching a patch which does both of the above.&lt;/p&gt;</comment>
                            <comment id="13880168" author="sushanth" created="Thu, 23 Jan 2014 18:15:38 +0000"  >&lt;p&gt;Note also, that the default behaviour is to continue to have the cache enabled, so as to not surprise any users. The new parameter is called &quot;hcatalog.hive.client.cache.disabled&quot;, and would need to be set to &quot;true&quot; by the HCat user to disable the cache.&lt;/p&gt;</comment>
                            <comment id="13880530" author="sushanth" created="Fri, 24 Jan 2014 00:07:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;thejas&lt;/a&gt;/&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;daijy&lt;/a&gt;, could I bother either of you for a review?&lt;/p&gt;</comment>
                            <comment id="13880643" author="thejas" created="Fri, 24 Jan 2014 02:21:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sushanth&quot; class=&quot;user-hover&quot; rel=&quot;sushanth&quot;&gt;sushanth&lt;/a&gt; Can you please create a reviewboard link and also document the configuration in release notes of jira?&lt;/p&gt;</comment>
                            <comment id="13880645" author="sushanth" created="Fri, 24 Jan 2014 02:22:55 +0000"  >&lt;p&gt;Reviewboard link : &lt;a href=&quot;https://reviews.apache.org/r/17297/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/17297/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13880842" author="lefty@hortonworks.com" created="Fri, 24 Jan 2014 09:12:17 +0000"  >&lt;p&gt;Where should &lt;b&gt;hcatalog.hive.client.cache.disabled&lt;/b&gt; be documented, besides the release notes?&lt;/p&gt;

&lt;p&gt;AFAIK, none of the configuration properties in HCatConstants.java are mentioned in the wiki.  HCatConstants itself is only mentioned a couple of times in &quot;Notification for a New Partition&quot;:  &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/HCatalog+Notification#HCatalogNotification-NotificationforaNewPartition&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/Hive/HCatalog+Notification#HCatalogNotification-NotificationforaNewPartition&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13882005" author="hiveqa" created="Sat, 25 Jan 2014 19:32:17 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12624843/HIVE-6268.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12624843/HIVE-6268.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 5 failed/errored test(s), 4958 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_bucketizedhiveinputformat
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_bucketmapjoin6
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_import_exported_table
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_load_hdfs_file_with_space_in_the_name
org.apache.hadoop.hive.cli.TestNegativeMinimrCliDriver.testNegativeCliDriver_file_with_header_footer_negative
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1022/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1022/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1022/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1022/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 5 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12624843&lt;/p&gt;</comment>
                            <comment id="13885670" author="sushanth" created="Wed, 29 Jan 2014 19:14:16 +0000"  >&lt;p&gt;(Attaching updated patch)&lt;/p&gt;</comment>
                            <comment id="13885817" author="sushanth" created="Wed, 29 Jan 2014 21:11:37 +0000"  >&lt;p&gt;One more modification to try and have the first interval where it checks whether to expire from cache or not be early if the user has set a short timeout.&lt;/p&gt;</comment>
                            <comment id="13885823" author="sushanth" created="Wed, 29 Jan 2014 21:15:05 +0000"  >&lt;p&gt;@Lefty : The parameters documentation for HCat, I&apos;m afraid is lacking. I will take that on as a todo. I&apos;ve created another hive jira and  assigned it to myself : &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6332&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-6332&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13886350" author="thejas" created="Thu, 30 Jan 2014 07:22:27 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13886504" author="hiveqa" created="Thu, 30 Jan 2014 11:18:32 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12625972/HIVE-6268.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12625972/HIVE-6268.3.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 4972 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_bucket_num_reducers
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1110/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1110/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1110/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1110/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12625972&lt;/p&gt;</comment>
                            <comment id="13887417" author="thejas" created="Fri, 31 Jan 2014 03:08:05 +0000"  >&lt;p&gt;Patch committed to trunk. Thanks for the contribution Sushanth!&lt;/p&gt;</comment>
                            <comment id="13887576" author="lefty@hortonworks.com" created="Fri, 31 Jan 2014 09:08:00 +0000"  >&lt;p&gt;&lt;b&gt;hcatalog.hive.client.cache.disabled&lt;/b&gt; will be documented with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6332&quot; title=&quot;HCatConstants Documentation needed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6332&quot;&gt;&lt;del&gt;HIVE-6332&lt;/del&gt;&lt;/a&gt;:  HCatConstants Documentation needed.&lt;/p&gt;

&lt;p&gt;Should it also be documented here in a release note?  (I&apos;d say yes, because &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6332&quot; title=&quot;HCatConstants Documentation needed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6332&quot;&gt;&lt;del&gt;HIVE-6332&lt;/del&gt;&lt;/a&gt; might not get done in time for release 0.13.0.)&lt;/p&gt;</comment>
                            <comment id="13889741" author="sushanth" created="Mon, 3 Feb 2014 18:50:41 +0000"  >&lt;p&gt;Hi Lefty, Yes, I think we should document it in a release note. I&apos;m planning on finishing &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6332&quot; title=&quot;HCatConstants Documentation needed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6332&quot;&gt;&lt;del&gt;HIVE-6332&lt;/del&gt;&lt;/a&gt; in a week but it&apos;s good to have it in a release note as well.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12692141">HIVE-6332</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12754647">HIVE-8830</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12625934" name="HIVE-6268.2.patch" size="8598" author="sushanth" created="Wed, 29 Jan 2014 19:19:34 +0000"/>
                            <attachment id="12625972" name="HIVE-6268.3.patch" size="8621" author="sushanth" created="Wed, 29 Jan 2014 21:11:37 +0000"/>
                            <attachment id="12624843" name="HIVE-6268.patch" size="7013" author="sushanth" created="Thu, 23 Jan 2014 17:56:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>369570</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 42 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1rp53:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>369875</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>