<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:50:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-15387] NPE in HiveServer2 webUI Historical SQL Operations section</title>
                <link>https://issues.apache.org/jira/browse/HIVE-15387</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The runtime value on a SQLOperationDisplay may be null, which may lead to NPEs on the web UI.&lt;/p&gt;

&lt;p&gt;Stack trace:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.NullPointerException
	at org.apache.hive.generated.hiveserver2.hiveserver2_jsp._jspService(hiveserver2_jsp.java:145)
	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:98)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:565)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:479)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:521)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:227)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1031)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:406)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:965)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117)
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:250)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:111)
	at org.eclipse.jetty.server.Server.handle(Server.java:349)
	at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:449)
	at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.headerComplete(AbstractHttpConnection.java:910)
	at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:634)
	at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:230)
	at org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:76)
	at org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:609)
	at org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:45)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:599)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:534)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Compiled jsp segment:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; 124        out.print( conf.get(ConfVars.HIVE_SERVER2_WEBUI_MAX_HISTORIC_QUERIES.varname) );
   125        out.write(&lt;span class=&quot;code-quote&quot;&gt;&quot; Closed Queries&amp;lt;/h2&amp;gt;\n&amp;lt;table id=\&quot;&lt;/span&gt;attributes_table\&lt;span class=&quot;code-quote&quot;&gt;&quot; class=\&quot;&lt;/span&gt;table table-striped\&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;gt;\n    &amp;lt;tr&amp;gt;\n        &amp;lt;th&amp;gt;User Name&amp;lt;/th&amp;gt;\n        &amp;lt;th&amp;gt;Query&amp;lt;/th&amp;gt;\n        &amp;lt;th&amp;gt;Execution Engine&amp;lt;/th&amp;gt;\n        &amp;lt;th&amp;gt;State&amp;lt;/th&amp;gt;\n        &amp;lt;th&amp;gt;Opened (s)&amp;lt;/th&amp;gt;\n        &amp;lt;th&amp;gt;Closed Timestamp&amp;lt;/th&amp;gt;\n        &amp;lt;th&amp;gt;Latency (s)&amp;lt;/th&amp;gt;\n        &amp;lt;th&amp;gt;Drilldown Link&amp;lt;/th&amp;gt;\n    &amp;lt;/tr&amp;gt;\n    &quot;&lt;/span&gt;);
   126  
   127        queries = 0;
   128        operations = sessionManager.getOperationManager().getHistoricalSQLOperations();
   129        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (SQLOperationDisplay operation : operations) {
   130            queries++;
   131      
   132        out.write(&lt;span class=&quot;code-quote&quot;&gt;&quot;\n    &amp;lt;tr&amp;gt;\n        &amp;lt;td&amp;gt;&quot;&lt;/span&gt;);
   133        out.print( operation.getUserName() );
   134        out.write(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;/td&amp;gt;\n        &amp;lt;td&amp;gt;&quot;&lt;/span&gt;);
   135        out.print( operation.getQueryDisplay() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; ? &lt;span class=&quot;code-quote&quot;&gt;&quot;Unknown&quot;&lt;/span&gt; : operation.getQueryDisplay().getQueryString() );
   136        out.write(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;/td&amp;gt;\n        &amp;lt;td&amp;gt;&quot;&lt;/span&gt;);
   137        out.print( operation.getExecutionEngine() );
   138        out.write(&lt;span class=&quot;code-quote&quot;&gt;&quot;\n        &amp;lt;td&amp;gt;&quot;&lt;/span&gt;);
   139        out.print( operation.getState() );
   140        out.write(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;/td&amp;gt;\n        &amp;lt;td&amp;gt;&quot;&lt;/span&gt;);
   141        out.print( operation.getElapsedTime()/1000 );
   142        out.write(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;/td&amp;gt;\n        &amp;lt;td&amp;gt;&quot;&lt;/span&gt;);
   143        out.print( operation.getEndTime() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; ? &lt;span class=&quot;code-quote&quot;&gt;&quot;In Progress&quot;&lt;/span&gt; : &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Date(operation.getEndTime()) );
   144        out.write(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;/td&amp;gt;\n        &amp;lt;td&amp;gt;&quot;&lt;/span&gt;);
   145        out.print( operation.getRuntime()/1000 );
   146        out.write(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;/td&amp;gt;\n        &quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Still trying to find a way to easily reproduce the issue.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13026619">HIVE-15387</key>
            <summary>NPE in HiveServer2 webUI Historical SQL Operations section</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zsombor.klara">Barna Zsombor Klara</assignee>
                                    <reporter username="zsombor.klara">Barna Zsombor Klara</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 Dec 2016 09:59:17 +0000</created>
                <updated>Tue, 28 Aug 2018 04:21:21 +0000</updated>
                            <resolved>Mon, 30 Jan 2017 16:36:53 +0000</resolved>
                                                    <fixVersion>2.3.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15837867" author="zsombor.klara" created="Wed, 25 Jan 2017 15:01:57 +0000"  >&lt;p&gt;There is a race condition in the handling of the SQLOperationDisplay classes. Once an operation is complete/cancelled/timed out we move the SQLOperationDisplay from the live stack to the historical one. But the runtime is only updated once the state is set, after the SQLOperationDisplay is already among the historical queries.&lt;/p&gt;</comment>
                            <comment id="15838218" author="hiveqa" created="Wed, 25 Jan 2017 17:37:06 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12849303/HIVE-15387.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12849303/HIVE-15387.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 9 failed/errored test(s), 10998 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestDerbyConnector - did not produce a TEST-*.xml file (likely timed out) (batchId=235)
org.apache.hadoop.hive.cli.TestEncryptedHDFSCliDriver.testCliDriver[encryption_join_with_different_encryption_keys] (batchId=159)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[offset_limit_ppd_optimizer] (batchId=151)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_vec_part] (batchId=149)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_char_simple] (batchId=147)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_varchar_simple] (batchId=153)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainuser_3] (batchId=93)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query23] (batchId=223)
org.apache.hive.jdbc.TestJdbcDriver2.testSelectExecAsync2 (batchId=215)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/3177/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/3177/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/3177/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/3177/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-3177/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-3177/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 9 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12849303 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15839671" author="zsombor.klara" created="Thu, 26 Jan 2017 13:35:00 +0000"  >&lt;p&gt;New test failures are coming from qtests, should not be caused by a change only to the HS2 jsp page.&lt;/p&gt;</comment>
                            <comment id="15845411" author="ctang.ma" created="Mon, 30 Jan 2017 16:32:58 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="15845416" author="ctang.ma" created="Mon, 30 Jan 2017 16:36:53 +0000"  >&lt;p&gt;Committed to 2.2.0. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zsombor.klara&quot; class=&quot;user-hover&quot; rel=&quot;zsombor.klara&quot;&gt;zsombor.klara&lt;/a&gt; for the patch.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13181450">HIVE-20470</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12849303" name="HIVE-15387.1.patch" size="877" author="zsombor.klara" created="Wed, 25 Jan 2017 15:01:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 42 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i37c7r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>