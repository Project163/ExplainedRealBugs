<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:21:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-25686] UDFSpace result length calculation is incorrect after HADOOP-17901&#160;and&#160;HADOOP-17905</title>
                <link>https://issues.apache.org/jira/browse/HIVE-25686</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The changes added in &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-17901&quot; title=&quot;Performance degradation in Text.append() after HADOOP-16951&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-17901&quot;&gt;&lt;del&gt;HADOOP-17901&lt;/del&gt;&lt;/a&gt;&#160;and&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-17905&quot; title=&quot;Modify Text.ensureCapacity() to efficiently max out the backing array size&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-17905&quot;&gt;&lt;del&gt;HADOOP-17905&lt;/del&gt;&lt;/a&gt; introduced some issues in Hive side. UDFSpace is generating false output because the result length is not determined correctly. It is causing unexpected characters in the result.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Repro steps:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
create table t(i &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
insert into t values (5),(6),(7),(8),(9),(10),(11),(12),(13),(14);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
select i, SPACE(i) from t;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;br/&gt;
Faulty output:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+-----+-----------------+
|&#160; i&#160; | &#160; &#160; &#160; _c1 &#160; &#160; &#160; |
+-----+-----------------+
| 5 &#160; | &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| 6 &#160; | &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| 7 &#160; |&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| 8 &#160; | &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| 9 &#160; |&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| 10&#160; | &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| 11&#160; | &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| 12&#160; |&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| 13&#160; | &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| 14&#160; |&#160; &#160; &#160; &#160; &#160; &#160; &#160; |
+-----+-----------------+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Also by using &lt;font color=&quot;#ff0000&quot;&gt;--outputformat=csv&lt;/font&gt; the generated file contains 0 ascii characters(&#8220;EOF&#8221;) instead of spaces.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13411017">HIVE-25686</key>
            <summary>UDFSpace result length calculation is incorrect after HADOOP-17901&#160;and&#160;HADOOP-17905</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mbathori">Mark Bathori</assignee>
                                    <reporter username="mbathori">Mark Bathori</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 10 Nov 2021 09:00:55 +0000</created>
                <updated>Thu, 17 Nov 2022 08:48:05 +0000</updated>
                            <resolved>Tue, 16 Nov 2021 09:51:23 +0000</resolved>
                                                    <fixVersion>4.0.0-alpha-1</fixVersion>
                                    <component>Hive</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="17443872" author="zabetak" created="Mon, 15 Nov 2021 15:00:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbathori&quot; class=&quot;user-hover&quot; rel=&quot;mbathori&quot;&gt;mbathori&lt;/a&gt;&#160; If I understand well this change will have an impact on Hive only after the upgrade of hadoop.version to 3.4.0. Currently we are using 3.1.0 so is it correct to assume that the problem does not appear at the current master?&lt;/p&gt;</comment>
                            <comment id="17443887" author="mbathori" created="Mon, 15 Nov 2021 15:09:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zabetak&quot; class=&quot;user-hover&quot; rel=&quot;zabetak&quot;&gt;zabetak&lt;/a&gt; yes, the problem does not occur in the current version. Currently both the old and the new method call returns with the same correct value.&lt;/p&gt;</comment>
                            <comment id="17444409" author="zabetak" created="Tue, 16 Nov 2021 09:51:23 +0000"  >&lt;p&gt;Fixed in &lt;a href=&quot;https://github.com/apache/hive/commit/6e02f6164385a370ee8014c795bee1fa423d7937&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;6e02f6164385a370ee8014c795bee1fa423d7937&lt;/a&gt;. Thanks for the PR &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbathori&quot; class=&quot;user-hover&quot; rel=&quot;mbathori&quot;&gt;mbathori&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13399976">HADOOP-17901</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13400214">HADOOP-17905</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0wlso:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>