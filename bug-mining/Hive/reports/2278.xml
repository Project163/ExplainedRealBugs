<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:19:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-7155] WebHCat controller job exceeds container memory limit</title>
                <link>https://issues.apache.org/jira/browse/HIVE-7155</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Submit a Hive query on a large table via WebHCat results in failure because the WebHCat controller job is killed by Yarn since it exceeds the memory limit (set by mapreduce.map.memory.mb, defaults to 1GB):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; INSERT OVERWRITE TABLE Temp_InjusticeEvents_2014_03_01_00_00 SELECT * from Stage_InjusticeEvents where LogTimestamp &amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;2014-03-01 00:00:00&apos;&lt;/span&gt; and LogTimestamp &amp;lt;= &lt;span class=&quot;code-quote&quot;&gt;&apos;2014-03-01 01:00:00&apos;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We could increase mapreduce.map.memory.mb to solve this problem, but this way we are changing this setting system wise.&lt;/p&gt;

&lt;p&gt;We need to provide a WebHCat configuration to overwrite mapreduce.map.memory.mb when submitting the controller job.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12717704">HIVE-7155</key>
            <summary>WebHCat controller job exceeds container memory limit</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shanyu">shanyu zhao</assignee>
                                    <reporter username="shanyu">shanyu zhao</reporter>
                        <labels>
                    </labels>
                <created>Sat, 31 May 2014 01:28:50 +0000</created>
                <updated>Thu, 9 Apr 2015 05:26:24 +0000</updated>
                            <resolved>Mon, 9 Jun 2014 20:35:34 +0000</resolved>
                                    <version>0.13.0</version>
                                    <fixVersion>0.14.0</fixVersion>
                                    <component>WebHCat</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14014454" author="shanyu" created="Sat, 31 May 2014 01:32:58 +0000"  >&lt;p&gt;Patch attached. a new configuration &quot;templeton.mapper.memory.mb&quot; is introduced so that users can set this property in webhcat-site.xml to overwrite mapreduce.map.memory.mb for the webhcat controller job.&lt;/p&gt;</comment>
                            <comment id="14015820" author="thejas" created="Mon, 2 Jun 2014 20:06:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shanyu&quot; class=&quot;user-hover&quot; rel=&quot;shanyu&quot;&gt;shanyu&lt;/a&gt;&lt;br/&gt;
One concern I have with the default value of templeton.mapper.memory.mb being set to 1GB is that the cluster might be having a larger mapreduce.map.memory.mb value, but webhcat would end up having a smaller limit for it.&lt;br/&gt;
I think we should take into consideration the current setting for mapreduce.map.memory.mb in the cluster. If the default value of mapreduce.map.memory.mb is greater than the value of templeton.mapper.memory.mb, I think we should use that. ie, templeton.mapper.memory.mb should be used for setting a higher value if necessary.&lt;/p&gt;

&lt;p&gt;What has been a good value for templeton.mapper.memory.mb in your experience ?&lt;/p&gt;</comment>
                            <comment id="14015878" author="shanyu" created="Mon, 2 Jun 2014 20:44:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;thejas&lt;/a&gt;, Thank you for your feedback! I think it could be a legitimate case when a cluster have larger mapreduce.map.memory.mb but smaller templeton.mapper.memory.mb, for example, when the users are only use templeton to submit jars. I think it is useful to separate the mapper&apos;s memory limit for general mapreduce jobs and templeton&apos;s launch mapper.&lt;/p&gt;

&lt;p&gt;In practice, the default 1GB memory limit for templeton&apos;s launch mapper is sufficient for majority of job submission. But when we try to do hive query on huge tables we&apos;ll hit memory limit for the templeton&apos;s launch mapper, because hive tries to do quite a bit local processing. In that case, we want to increase memory limit (to 2GB) for templeton&apos;s launch mapper, but not for user&apos;s mapreduce jobs.&lt;/p&gt;</comment>
                            <comment id="14015929" author="thejas" created="Mon, 2 Jun 2014 21:36:10 +0000"  >&lt;p&gt;I am thinking of this in terms of number of config parameters a user has to think about when getting started (the fewer that needs tweaking the better). &lt;br/&gt;
Also, many recommendations that I have seen suggest setting the yarn.scheduler.minimum-allocation-mb to be equal to mapreduce.map.memory.mb. Using a smaller value for templeton tasks is not going to help.&lt;/p&gt;

&lt;p&gt;I think an alternative to enable this (minimal configuration for most users), is to not set a default value for templeton.mapper.memory.mb. If the value of templeton.mapper.memory.mb is empty, then use mapreduce.map.memory.mb. Users can set templeton.mapper.memory.mb to get a higher or lower value of mapreduce.map.memory.mb for the launcher task.&lt;/p&gt;</comment>
                            <comment id="14015954" author="shanyu" created="Mon, 2 Jun 2014 22:06:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;thejas&lt;/a&gt; Yes, it&apos;s a good idea to make templeton.mapper.memory.mb defaults to empty, in which case we don&apos;t set mapreduce.map.memory.mb when submitting the controller job. This is safer for users that are not aware of this option yet flexible for people with the needs to change this configuration. I will modify the patch accordingly. Thanks for the suggestion!&lt;/p&gt;</comment>
                            <comment id="14015977" author="thejas" created="Mon, 2 Jun 2014 22:26:44 +0000"  >&lt;p&gt;Can you also please update the review board link ? Its easier to see the changes that way.&lt;/p&gt;
</comment>
                            <comment id="14018171" author="shanyu" created="Wed, 4 Jun 2014 21:00:58 +0000"  >&lt;p&gt;Review board updated.&lt;/p&gt;</comment>
                            <comment id="14018909" author="ekoifman" created="Thu, 5 Jun 2014 16:17:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shanyu&quot; class=&quot;user-hover&quot; rel=&quot;shanyu&quot;&gt;shanyu&lt;/a&gt; I can&apos;t comment on RB.  Did you perhaps not &quot;publish&quot; it?&lt;/p&gt;</comment>
                            <comment id="14019089" author="shanyu" created="Thu, 5 Jun 2014 18:47:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ekoifman&quot; class=&quot;user-hover&quot; rel=&quot;ekoifman&quot;&gt;ekoifman&lt;/a&gt; I did publish it. I can add comments to it. Can you please double check? Thx.&lt;/p&gt;</comment>
                            <comment id="14020636" author="ekoifman" created="Sat, 7 Jun 2014 01:42:55 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14021500" author="thejas" created="Mon, 9 Jun 2014 00:56:10 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14021510" author="lefty@hortonworks.com" created="Mon, 9 Jun 2014 01:25:40 +0000"  >&lt;p&gt;Although the parameter name &lt;b&gt;templeton.mapper.memory.mb&lt;/b&gt; implies the units, you should make it explicit in the description:  &quot;Templeton controller job&apos;s Launch mapper&apos;s memory limit, in megabytes.  (etc.)&quot;&lt;/p&gt;</comment>
                            <comment id="14021571" author="shanyu" created="Mon, 9 Jun 2014 04:48:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=leftylev&quot; class=&quot;user-hover&quot; rel=&quot;leftylev&quot;&gt;leftylev&lt;/a&gt; Thanks for your feedback. I&apos;ve attached a new version calling out megabytes in the description.&lt;/p&gt;</comment>
                            <comment id="14021666" author="lefty@hortonworks.com" created="Mon, 9 Jun 2014 06:33:12 +0000"  >&lt;p&gt;+1  Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shanyu&quot; class=&quot;user-hover&quot; rel=&quot;shanyu&quot;&gt;shanyu&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14025366" author="hiveqa" created="Mon, 9 Jun 2014 17:05:41 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12648911/HIVE-7155.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12648911/HIVE-7155.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 7 failed/errored test(s), 5530 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_reduce_deduplicate_extended
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_root_dir_external_table
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_ctas
org.apache.hive.hcatalog.pig.TestOrcHCatPigStorer.testWriteDecimal
org.apache.hive.hcatalog.pig.TestOrcHCatPigStorer.testWriteDecimalX
org.apache.hive.hcatalog.pig.TestOrcHCatPigStorer.testWriteDecimalXY
org.apache.hive.hcatalog.templeton.tool.TestTempletonUtils.testPropertiesParsing
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/413/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/413/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/413/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/413/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-413/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-413/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 7 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12648911&lt;/p&gt;</comment>
                            <comment id="14025701" author="thejas" created="Mon, 9 Jun 2014 20:35:34 +0000"  >&lt;p&gt;Patch committed to trunk. Thanks for the contribution Shanyu!&lt;/p&gt;</comment>
                            <comment id="14030413" author="lefty@hortonworks.com" created="Fri, 13 Jun 2014 09:17:02 +0000"  >&lt;p&gt;Need to document &lt;b&gt;templeton.mapper.memory.mb&lt;/b&gt; in the wiki with version information (0.14.0):&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/WebHCat+Configure#WebHCatConfigure-ConfigurationVariables&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;WebHCat Configuration:  Configuration Variables &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14211091" author="thejas" created="Thu, 13 Nov 2014 19:44:04 +0000"  >&lt;p&gt;This has been fixed in 0.14 release. Please open new jira if you see any issues.&lt;/p&gt;</comment>
                            <comment id="14486727" author="lefty@hortonworks.com" created="Thu, 9 Apr 2015 05:22:38 +0000"  >&lt;p&gt;Doc note:  &lt;b&gt;templeton.mapper.memory.mb&lt;/b&gt; is documented in the WebHCat Configuration wiki, at the end of the table of configuration variables.  (Better late than never.)  I took the liberty of changing &quot;Templeton&quot; to &quot;WebHCat&quot; in the description &amp;#8211; should have thought of that before the commit.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/WebHCat+Configure#WebHCatConfigure-ConfigurationVariables&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;WebHCat Configuration &amp;#8211; Configuration Variables &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12738654">HIVE-7948</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12648018" name="HIVE-7155.1.patch" size="5088" author="shanyu" created="Mon, 2 Jun 2014 22:09:24 +0000"/>
                            <attachment id="12648911" name="HIVE-7155.2.patch" size="5097" author="shanyu" created="Mon, 9 Jun 2014 04:47:13 +0000"/>
                            <attachment id="12647744" name="HIVE-7155.patch" size="4823" author="shanyu" created="Sat, 31 May 2014 01:32:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>395908</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 32 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1w5vz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>396034</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>