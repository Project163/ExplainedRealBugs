<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:54:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-16573] In-place update for HoS can&apos;t be disabled</title>
                <link>https://issues.apache.org/jira/browse/HIVE-16573</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;&lt;tt&gt;hive.spark.exec.inplace.progress&lt;/tt&gt; has no effect&lt;/p&gt;</description>
                <environment></environment>
        <key id="13068667">HIVE-16573</key>
            <summary>In-place update for HoS can&apos;t be disabled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="libing">Bing Li</assignee>
                                    <reporter username="lirui">Rui Li</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 May 2017 07:22:08 +0000</created>
                <updated>Wed, 23 May 2018 00:00:32 +0000</updated>
                            <resolved>Wed, 7 Jun 2017 05:43:53 +0000</resolved>
                                                    <fixVersion>3.0.0</fixVersion>
                                    <component>Spark</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15994393" author="lirui" created="Wed, 3 May 2017 07:27:59 +0000"  >&lt;p&gt;In &lt;tt&gt;InPlaceUpdate.canRenderInPlace&lt;/tt&gt;, we don&apos;t check the config for spark. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anishek&quot; class=&quot;user-hover&quot; rel=&quot;anishek&quot;&gt;anishek&lt;/a&gt;, I noted you made the change in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-15473&quot; title=&quot;Progress Bar on Beeline client&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-15473&quot;&gt;&lt;del&gt;HIVE-15473&lt;/del&gt;&lt;/a&gt;. Any reason why the check for spark has to be removed?&lt;/p&gt;</comment>
                            <comment id="15994432" author="anishek" created="Wed, 3 May 2017 07:51:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt; The ability to show progress bar on beeline client side lead to changes that i was not sure how it would be done on spark side as i had very little insight into spark as an engine for hive, hence i worked with the tez engine first and planed to do final modification for spark towards the end.Now that i look back into it, i think i missed that condition for spark, i think that condition has to be slightly modified as &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (SessionState.get().getConf()
          .getBoolVar(HiveConf.ConfVars.HIVE_SERVER2_INPLACE_PROGRESS) &amp;amp;&amp;amp; engine.equals(&lt;span class=&quot;code-quote&quot;&gt;&quot;spark&quot;&lt;/span&gt;))
        inPlaceUpdates = HiveConf.getBoolVar(conf, HiveConf.ConfVars.SPARK_EXEC_INPLACE_PROGRESS);
    }

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15994484" author="lirui" created="Wed, 3 May 2017 08:47:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anishek&quot; class=&quot;user-hover&quot; rel=&quot;anishek&quot;&gt;anishek&lt;/a&gt;, thanks for the explanations. However, I &apos;m not sure why we have to check &lt;tt&gt;HIVE_SERVER2_INPLACE_PROGRESS&lt;/tt&gt; for spark. Especially that &lt;tt&gt;HIVE_SERVER2_INPLACE_PROGRESS&lt;/tt&gt; indicates it only works for tez at the moment. My understanding is &lt;tt&gt;InPlaceUpdate.canRenderInPlace&lt;/tt&gt; should only check &lt;tt&gt;TEZ_EXEC_INPLACE_PROGRESS&lt;/tt&gt; and &lt;tt&gt;SPARK_EXEC_INPLACE_PROGRESS&lt;/tt&gt; for tez and spark respectively. &lt;tt&gt;HIVE_SERVER2_INPLACE_PROGRESS&lt;/tt&gt; can be checked on top of this when deciding whether progress bar is enabled for beeline. So I think we can revert to the code before &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-15473&quot; title=&quot;Progress Bar on Beeline client&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-15473&quot;&gt;&lt;del&gt;HIVE-15473&lt;/del&gt;&lt;/a&gt;. Thoughts?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;	    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; engine = HiveConf.getVar(conf, HiveConf.ConfVars.HIVE_EXECUTION_ENGINE);		
	    &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; inPlaceUpdates = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;		
	    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (engine.equals(&lt;span class=&quot;code-quote&quot;&gt;&quot;tez&quot;&lt;/span&gt;)) {		
	      inPlaceUpdates = HiveConf.getBoolVar(conf, HiveConf.ConfVars.TEZ_EXEC_INPLACE_PROGRESS);		
	    }		
	    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (engine.equals(&lt;span class=&quot;code-quote&quot;&gt;&quot;spark&quot;&lt;/span&gt;)) {		
	      inPlaceUpdates = HiveConf.getBoolVar(conf, HiveConf.ConfVars.SPARK_EXEC_INPLACE_PROGRESS);		
	    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15994630" author="anishek" created="Wed, 3 May 2017 10:22:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ruili&quot; class=&quot;user-hover&quot; rel=&quot;ruili&quot;&gt;ruili&lt;/a&gt; The reason we need the additional check is because when using beeline, it will always request the progress bar and since spark code flow does not have any implementation to serialize the progress information it might result in errors. For spark progress bar is only available on hive-cli mode not hiveserver2 + beeline mode. the method is currently common for both tez/spark code flows and hence all variations have to be taken care of independently &lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;enable server side progress bar info    X  for both tez /  spark&lt;/li&gt;
	&lt;li&gt;enable hive cli side progress bar info    X  for both tez / spark&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Hope this makes makes.&lt;/p&gt;</comment>
                            <comment id="15994683" author="lirui" created="Wed, 3 May 2017 11:22:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anishek&quot; class=&quot;user-hover&quot; rel=&quot;anishek&quot;&gt;anishek&lt;/a&gt;, in that case, how about having separate methods checking for server side and cli side? Cli side can use the check in my previous comment, and server side can use &lt;tt&gt;HIVE_SERVER2_INPLACE_PROGRESS + cli side check + non-spark&lt;/tt&gt;. Otherwise, the progress bar will be disabled for spark in cli mode when &lt;tt&gt;HIVE_SERVER2_INPLACE_PROGRESS&lt;/tt&gt; is false, which is unexpected according to the description of the config.&lt;/p&gt;</comment>
                            <comment id="15996297" author="anishek" created="Thu, 4 May 2017 07:32:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ruili&quot; class=&quot;user-hover&quot; rel=&quot;ruili&quot;&gt;ruili&lt;/a&gt; i think i see where i confused you with my comments. please have a look at code below :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!SessionState.get().isHiveServerQuery() &amp;amp;&amp;amp; engine.equals(&lt;span class=&quot;code-quote&quot;&gt;&quot;spark&quot;&lt;/span&gt;)) {
      inPlaceUpdates = HiveConf.getBoolVar(conf, HiveConf.ConfVars.SPARK_EXEC_INPLACE_PROGRESS);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I hope the above solves the case for hive-cli + spark to have progress bar enabled ?&lt;/p&gt;</comment>
                            <comment id="16012349" author="libing" created="Tue, 16 May 2017 13:16:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ruili&quot; class=&quot;user-hover&quot; rel=&quot;ruili&quot;&gt;ruili&lt;/a&gt; I&apos;m interesting on this, could I take over it? Thank you.&lt;/p&gt;</comment>
                            <comment id="16012461" author="lirui" created="Tue, 16 May 2017 14:16:00 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=libing&quot; class=&quot;user-hover&quot; rel=&quot;libing&quot;&gt;libing&lt;/a&gt; for the help. Just feel free to take it. And you can follow &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anishek&quot; class=&quot;user-hover&quot; rel=&quot;anishek&quot;&gt;anishek&lt;/a&gt;&apos;s suggestions.&lt;/p&gt;</comment>
                            <comment id="16036565" author="libing" created="Mon, 5 Jun 2017 05:47:35 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ruili&quot; class=&quot;user-hover&quot; rel=&quot;ruili&quot;&gt;ruili&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anishek&quot; class=&quot;user-hover&quot; rel=&quot;anishek&quot;&gt;anishek&lt;/a&gt;&lt;br/&gt;
Seems that we can&apos;t import class SessionState into InPlaceUpdate.java, it will cause module cycles error during compiling, which is hive-common-&amp;gt;hive-exec-&amp;gt;hive-common.&lt;/p&gt;

&lt;p&gt;I changed it as below:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;    String engine = HiveConf.getVar(conf, HiveConf.ConfVars.HIVE_EXECUTION_ENGINE);&lt;br/&gt;
    boolean inPlaceUpdates = false;&lt;/p&gt;

&lt;p&gt;    if (engine.equals(&quot;tez&quot;))&lt;br/&gt;
      inPlaceUpdates = HiveConf.getBoolVar(conf, HiveConf.ConfVars.TEZ_EXEC_INPLACE_PROGRESS);&lt;/p&gt;

&lt;p&gt;    if (engine.equals(&quot;spark&quot;))&lt;br/&gt;
      inPlaceUpdates = HiveConf.getBoolVar(conf, HiveConf.ConfVars.SPARK_EXEC_INPLACE_PROGRESS);&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Do you think is ok?&lt;/p&gt;</comment>
                            <comment id="16036627" author="libing" created="Mon, 5 Jun 2017 07:16:32 +0000"  >&lt;p&gt;Generate the patch file based on master branch&lt;/p&gt;</comment>
                            <comment id="16036697" author="lirui" created="Mon, 5 Jun 2017 09:09:13 +0000"  >&lt;p&gt;+1. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anishek&quot; class=&quot;user-hover&quot; rel=&quot;anishek&quot;&gt;anishek&lt;/a&gt; would you mind also have a look? Thanks&lt;/p&gt;</comment>
                            <comment id="16036736" author="anishek" created="Mon, 5 Jun 2017 09:45:08 +0000"  >&lt;p&gt;+1 looks good, I think this bug to manage the in place update progress on hive-cli side, this still does not take care of showing the progress on beeline side ?&lt;/p&gt;</comment>
                            <comment id="16036805" author="lirui" created="Mon, 5 Jun 2017 11:03:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anishek&quot; class=&quot;user-hover&quot; rel=&quot;anishek&quot;&gt;anishek&lt;/a&gt;, yeah spark only supports in-place update in CLI. In the current method we don&apos;t check &lt;tt&gt;isHiveServerQuery&lt;/tt&gt; for tez either (actually as Bing mentioned we can&apos;t access SessionState here), so I suppose the change is OK, right?&lt;/p&gt;</comment>
                            <comment id="16036829" author="anishek" created="Mon, 5 Jun 2017 11:28:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lirui&quot; class=&quot;user-hover&quot; rel=&quot;lirui&quot;&gt;lirui&lt;/a&gt; yes change is fine, I was just confirming that we were on the same page: that this is only for cli. &lt;/p&gt;</comment>
                            <comment id="16037923" author="libing" created="Tue, 6 Jun 2017 00:56:31 +0000"  >&lt;p&gt;I verified this patch, it could work for spark engine on HiveCLI.&lt;/p&gt;</comment>
                            <comment id="16037924" author="libing" created="Tue, 6 Jun 2017 00:57:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ruili&quot; class=&quot;user-hover&quot; rel=&quot;ruili&quot;&gt;ruili&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anishek&quot; class=&quot;user-hover&quot; rel=&quot;anishek&quot;&gt;anishek&lt;/a&gt;, thank you for your review.&lt;br/&gt;
I just submitted the patch.&lt;/p&gt;</comment>
                            <comment id="16038031" author="hiveqa" created="Tue, 6 Jun 2017 03:02:59 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12871188/HIVE-16573.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12871188/HIVE-16573.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 7 failed/errored test(s), 10820 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestBeeLineDriver.testCliDriver[insert_overwrite_local_directory_1] (batchId=237)
org.apache.hadoop.hive.cli.TestBlobstoreCliDriver.testCliDriver[insert_into_dynamic_partitions] (batchId=240)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[orc_ppd_basic] (batchId=140)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[columnstats_part_coltype] (batchId=157)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_if_expr] (batchId=145)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=232)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query78] (batchId=232)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/5539/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/5539/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/5539/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/5539/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-5539/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-5539/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 7 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12871188 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="16040227" author="lirui" created="Wed, 7 Jun 2017 05:43:53 +0000"  >&lt;p&gt;Pushed to master. Thanks Bing for the contribution and Anishek for the review.&lt;/p&gt;</comment>
                            <comment id="16486408" author="vgarg" created="Wed, 23 May 2018 00:00:32 +0000"  >&lt;p&gt;Hive 3.0.0 has been released so closing this jira.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12871188" name="HIVE-16573.1.patch" size="1156" author="libing" created="Mon, 5 Jun 2017 07:16:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 26 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3eeov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>