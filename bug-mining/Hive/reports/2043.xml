<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:17:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-6546] WebHCat job submission for pig with -useHCatalog argument fails on Windows</title>
                <link>https://issues.apache.org/jira/browse/HIVE-6546</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;On a one-box windows setup, do the following from a powershell prompt:&lt;/p&gt;

&lt;p&gt;cmd /c curl.exe -s `&lt;br/&gt;
  -d user.name=hadoop `&lt;br/&gt;
  -d arg=-useHCatalog `&lt;br/&gt;
  -d execute=&quot;emp = load &apos;/data/emp/emp_0.dat&apos;; dump emp;&quot; `&lt;br/&gt;
  -d statusdir=&quot;/tmp/webhcat.output01&quot; `&lt;br/&gt;
  &apos;http://localhost:50111/templeton/v1/pig&apos; -v&lt;/p&gt;

&lt;p&gt;The job fails with error code 7, but it should run. &lt;/p&gt;

&lt;p&gt;I traced this down to the following. In the job configuration for the TempletonJobController, we have templeton.args set to&lt;/p&gt;

&lt;p&gt;cmd,/c,call,C:\\hadoop\\\\pig-0.11.0.1.3.0.0-0846/bin/pig.cmd,-D_&lt;em&gt;WEBHCAT_TOKEN_FILE_LOCATION&lt;/em&gt;_=&quot;-useHCatalog&quot;,-execute,&quot;emp = load &apos;/data/emp/emp_0.dat&apos;; dump emp;&quot;&lt;/p&gt;

&lt;p&gt;Notice the = sign before &quot;-useHCatalog&quot;. I think this should be a comma.&lt;/p&gt;

&lt;p&gt;The bad string D_&lt;em&gt;WEBHCAT_TOKEN_FILE_LOCATION&lt;/em&gt;_=&quot;-useHCatalog&quot; gets created in  org.apache.hadoop.util.GenericOptionsParser.preProcessForWindows().&lt;/p&gt;

&lt;p&gt;It happens at line 434:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;      } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (i &amp;lt; args.length - 1) {
            prop += &lt;span class=&quot;code-quote&quot;&gt;&quot;=&quot;&lt;/span&gt; + args[++i];   &lt;span class=&quot;code-comment&quot;&gt;// RIGHT HERE! at iterations i = 37, 38
&lt;/span&gt;          }
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Bug is here:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (prop != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (prop.contains(&lt;span class=&quot;code-quote&quot;&gt;&quot;=&quot;&lt;/span&gt;)) {  &lt;span class=&quot;code-comment&quot;&gt;// -D__WEBHCAT_TOKEN_FILE_LOCATION__ does not contain equal, so &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; branch is run and appends =&lt;span class=&quot;code-quote&quot;&gt;&quot;-useHCatalog&quot;&lt;/span&gt;,
&lt;/span&gt;          &lt;span class=&quot;code-comment&quot;&gt;// everything good
&lt;/span&gt;        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (i &amp;lt; args.length - 1) {
            prop += &lt;span class=&quot;code-quote&quot;&gt;&quot;=&quot;&lt;/span&gt; + args[++i];
          }
        }
        newArgs.add(prop);
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;One possible fix is to change the string constant org.apache.hcatalog.templeton.tool.TempletonControllerJob.TOKEN_FILE_ARG_PLACEHOLDER to have an &quot;=&quot; sign in it. Or, preProcessForWindows() itself could be changed.&lt;/p&gt;</description>
                <environment>&lt;p&gt;HDInsight deploying HDP 1.3:  c:\apps\dist\pig-0.11.0.1.3.2.0-05&lt;br/&gt;
Also on Windows HDP 1.3 one-box configuration.&lt;/p&gt;</environment>
        <key id="12698715">HIVE-6546</key>
            <summary>WebHCat job submission for pig with -useHCatalog argument fails on Windows</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ehans">Eric N. Hanson</assignee>
                                    <reporter username="ehans">Eric N. Hanson</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Mar 2014 20:05:05 +0000</created>
                <updated>Thu, 27 Mar 2014 20:49:54 +0000</updated>
                            <resolved>Thu, 27 Mar 2014 19:13:45 +0000</resolved>
                                    <version>0.11.0</version>
                    <version>0.12.0</version>
                    <version>0.13.0</version>
                    <version>0.14.0</version>
                                    <fixVersion>0.13.0</fixVersion>
                                    <component>WebHCat</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13921521" author="ehans" created="Wed, 5 Mar 2014 22:25:12 +0000"  >&lt;p&gt;Changed constant placeholder to include = sign&lt;/p&gt;</comment>
                            <comment id="13921549" author="ehans" created="Wed, 5 Mar 2014 22:42:48 +0000"  >&lt;p&gt;removed trailing white space&lt;/p&gt;</comment>
                            <comment id="13921553" author="ehans" created="Wed, 5 Mar 2014 22:46:37 +0000"  >&lt;p&gt;Code review at &lt;a href=&quot;https://reviews.apache.org/r/18816/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/18816/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13921562" author="ehans" created="Wed, 5 Mar 2014 22:55:32 +0000"  >&lt;p&gt;fix typo&lt;/p&gt;</comment>
                            <comment id="13931119" author="ehans" created="Tue, 11 Mar 2014 23:12:57 +0000"  >&lt;p&gt;Upload again to try to kick off pre-commit tests&lt;/p&gt;</comment>
                            <comment id="13938583" author="ekoifman" created="Tue, 18 Mar 2014 00:04:15 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13945778" author="ehans" created="Mon, 24 Mar 2014 22:19:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;thejas&lt;/a&gt; Can you take a look?&lt;/p&gt;</comment>
                            <comment id="13946907" author="thejas" created="Tue, 25 Mar 2014 18:29:31 +0000"  >&lt;p&gt;The code here is supposed to remove this argument if token file argument is not set, do you know why it is not kicking in this case ? &lt;a href=&quot;https://github.com/apache/hive/blob/trunk/hcatalog/webhcat/svr/src/main/java/org/apache/hive/hcatalog/templeton/tool/LaunchMapper.java#L127&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/blob/trunk/hcatalog/webhcat/svr/src/main/java/org/apache/hive/hcatalog/templeton/tool/LaunchMapper.java#L127&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13946948" author="thejas" created="Tue, 25 Mar 2014 18:48:06 +0000"  >&lt;p&gt;I think the right fix is to not add this param to add this placeholder to command line arguments, it has not been replaced with a real value.&lt;/p&gt;</comment>
                            <comment id="13948523" author="ehans" created="Wed, 26 Mar 2014 21:44:51 +0000"  >&lt;p&gt;I&apos;m not sure I understand what you mean. Can you elaborate? The placeholder is getting substituted or eliminated by the templeton controller job. &lt;/p&gt;

&lt;p&gt;If I run this simple Pig script from WebHCat:&lt;/p&gt;

&lt;p&gt;emp = load &apos;wasbs://ehans1@ehans7.blob.core.windows.net/data/emp_0.dat&apos;; dump emp;&lt;/p&gt;

&lt;p&gt;Then I see this in the templeton controller job configuration:&lt;/p&gt;

&lt;p&gt;templeton.args   cmd,/c,call,C:\\apps\\dist&lt;br class=&quot;atl-forced-newline&quot; /&gt;pig-0.12.0.2.0.7.0-1551/bin/pig.cmd,-D_&lt;em&gt;WEBHCAT_TOKEN_FILE_LOCATION&lt;/em&gt;_=-execute,&quot;emp = load &apos;wasbs://ehans1@ehans7.blob.core.windows.net/data/emp_0.dat&apos;; dump emp;&quot; &lt;/p&gt;

&lt;p&gt;And I see this in the Pig job configuration for the job spawned by the templeton controller job:&lt;/p&gt;

&lt;p&gt;pig.cmd.args    -Dmapreduce.job.credentials.binary=/c:/hdfs/nm-local-dir/usercache/ehans/appcache/application_1395867453549_0007/container_1395867453549_0007_01_000002/container_tokens -execute emp = load &apos;wasbs://ehans1@ehans7.blob.core.windows.net/data/emp_0.dat&apos;; dump emp; &lt;/p&gt;

</comment>
                            <comment id="13948542" author="thejas" created="Wed, 26 Mar 2014 22:07:59 +0000"  >&lt;p&gt;Thanks for the clarification Eric. I thought that the problem was with parsing the command launched from the map task, but looks like this is happening before that. I was worried that having &quot;=&quot; sign could cause problems in other systems, but since the shell never sees this arguement, it is fine.&lt;/p&gt;

&lt;p&gt;+1 .&lt;/p&gt;</comment>
                            <comment id="13948547" author="ehans" created="Wed, 26 Mar 2014 22:10:06 +0000"  >&lt;p&gt;Uploading patch yet again to try to kick off pre-commit tests.&lt;/p&gt;</comment>
                            <comment id="13949670" author="hiveqa" created="Thu, 27 Mar 2014 17:36:16 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12637024/HIVE-6546.03.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12637024/HIVE-6546.03.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 5491 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1985/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1985/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1985/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1985/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12637024&lt;/p&gt;</comment>
                            <comment id="13949702" author="thejas" created="Thu, 27 Mar 2014 17:50:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhbutani&quot; class=&quot;user-hover&quot; rel=&quot;rhbutani&quot;&gt;rhbutani&lt;/a&gt; This is a small change, but it will be very useful to have it in 0.13, as it affects the working on windows.&lt;/p&gt;</comment>
                            <comment id="13949787" author="rhbutani" created="Thu, 27 Mar 2014 18:53:00 +0000"  >&lt;p&gt;+1 for 0.13&lt;/p&gt;</comment>
                            <comment id="13949812" author="ehans" created="Thu, 27 Mar 2014 19:13:45 +0000"  >&lt;p&gt;Committed to trunk&lt;/p&gt;</comment>
                            <comment id="13949911" author="thejas" created="Thu, 27 Mar 2014 20:49:54 +0000"  >&lt;p&gt;Patch committed to 0.13 branch .&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12632932" name="HIVE-6546.01.patch" size="1227" author="ehans" created="Wed, 5 Mar 2014 22:25:12 +0000"/>
                            <attachment id="12632934" name="HIVE-6546.02.patch" size="1223" author="ehans" created="Wed, 5 Mar 2014 22:42:48 +0000"/>
                            <attachment id="12637024" name="HIVE-6546.03.patch" size="1224" author="ehans" created="Wed, 26 Mar 2014 22:10:06 +0000"/>
                            <attachment id="12634041" name="HIVE-6546.03.patch" size="1224" author="ehans" created="Tue, 11 Mar 2014 23:12:57 +0000"/>
                            <attachment id="12632935" name="HIVE-6546.03.patch" size="1224" author="ehans" created="Wed, 5 Mar 2014 22:55:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>377073</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 34 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1sz5j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>377368</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>