<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:04:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-19310] Metastore: MetaStoreDirectSql.ensureDbInit has some slow DN calls which might need to be run only in test env</title>
                <link>https://issues.apache.org/jira/browse/HIVE-19310</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;MetaStoreDirectSql.ensureDbInit has the following 2 calls which we have observed taking a long time in our testing:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
initQueries.add(pm.newQuery(MNotificationLog.class, &lt;span class=&quot;code-quote&quot;&gt;&quot;dbName == &apos;&apos;&quot;&lt;/span&gt;));
initQueries.add(pm.newQuery(MNotificationNextId.class, &lt;span class=&quot;code-quote&quot;&gt;&quot;nextEventId &amp;lt; -1&quot;&lt;/span&gt;));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In a production environment, these tables should be initialized using schematool, however in a test environment, these calls might be needed. &lt;/p&gt;</description>
                <environment></environment>
        <key id="13155238">HIVE-19310</key>
            <summary>Metastore: MetaStoreDirectSql.ensureDbInit has some slow DN calls which might need to be run only in test env</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sershe">Sergey Shelukhin</assignee>
                                    <reporter username="vgumashta">Vaibhav Gumashta</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Apr 2018 20:03:42 +0000</created>
                <updated>Tue, 22 May 2018 23:16:24 +0000</updated>
                            <resolved>Mon, 7 May 2018 20:42:00 +0000</resolved>
                                    <version>3.0.0</version>
                                    <fixVersion>3.0.0</fixVersion>
                                    <component>Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="16453088" author="thejas" created="Wed, 25 Apr 2018 21:06:40 +0000"  >&lt;p&gt;I think we we are skipping the init, we should skip all the initQueries, as I see all of them serving the same purpose.&lt;/p&gt;
</comment>
                            <comment id="16453091" author="thejas" created="Wed, 25 Apr 2018 21:07:28 +0000"  >&lt;p&gt;The whole initialization done via ObjectStore.setConf also needs to be re-examined. But that can be a follow up jira.&lt;/p&gt;</comment>
                            <comment id="16453325" author="sershe" created="Thu, 26 Apr 2018 01:16:21 +0000"  >&lt;p&gt;It makes sense to make all these init calls in test only.&lt;/p&gt;</comment>
                            <comment id="16461506" author="sershe" created="Wed, 2 May 2018 19:08:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=t3rmin4t0r&quot; class=&quot;user-hover&quot; rel=&quot;t3rmin4t0r&quot;&gt;t3rmin4t0r&lt;/a&gt; can you take a look?&lt;/p&gt;</comment>
                            <comment id="16461520" author="gopalv" created="Wed, 2 May 2018 19:20:17 +0000"  >&lt;p&gt;LGTM - +1&lt;/p&gt;</comment>
                            <comment id="16461525" author="gopalv" created="Wed, 2 May 2018 19:21:40 +0000"  >&lt;p&gt;The init query regressed when the BTree on PART_COL_STATS went from (DB_NAME ...) -&amp;gt; (CAT_NAME, DB_NAME)&lt;/p&gt;

&lt;p&gt;The test query went from 3ms -&amp;gt; 4.5 seconds. After this fix, it has improved to 0ms &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
</comment>
                            <comment id="16462955" author="sershe" created="Thu, 3 May 2018 19:23:25 +0000"  >&lt;p&gt;Again because HiveQA is dumb.&lt;/p&gt;</comment>
                            <comment id="16466335" author="sershe" created="Mon, 7 May 2018 19:10:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vihangk1&quot; class=&quot;user-hover&quot; rel=&quot;vihangk1&quot;&gt;vihangk1&lt;/a&gt; I&apos;d like to commit this to 3.0 since this is otherwise a major regression. Does this make sense?&lt;/p&gt;</comment>
                            <comment id="16466359" author="gopalv" created="Mon, 7 May 2018 19:34:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vgarg&quot; class=&quot;user-hover&quot; rel=&quot;vgarg&quot;&gt;vgarg&lt;/a&gt;: trivial patch to include for 3.x &lt;/p&gt;</comment>
                            <comment id="16466395" author="vgarg" created="Mon, 7 May 2018 19:59:56 +0000"  >&lt;p&gt;+1 for branch-3&lt;/p&gt;</comment>
                            <comment id="16466402" author="sershe" created="Mon, 7 May 2018 20:02:06 +0000"  >&lt;p&gt;Committed to master for now&lt;/p&gt;</comment>
                            <comment id="16466446" author="sershe" created="Mon, 7 May 2018 20:42:00 +0000"  >&lt;p&gt;Committed also to branch-3. Thanks!&lt;/p&gt;</comment>
                            <comment id="16466453" author="vihangk1" created="Mon, 7 May 2018 20:47:48 +0000"  >&lt;p&gt;guess you meant Vineet &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;</comment>
                            <comment id="16466457" author="sershe" created="Mon, 7 May 2018 20:50:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vihangk1&quot; class=&quot;user-hover&quot; rel=&quot;vihangk1&quot;&gt;vihangk1&lt;/a&gt; I saw your name on top of the 3.0 thread on dev@ and assumed you are the RM &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16468067" author="vgarg" created="Tue, 8 May 2018 22:41:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt; this patch has failed the following tests in branch-3:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;org.apache.hadoop.hive.metastore.TestStats.partitionedTableInHiveCatalog&lt;/li&gt;
	&lt;li&gt;org.apache.hadoop.hive.metastore.TestStats.partitionedTableDeprecatedCalls&lt;/li&gt;
	&lt;li&gt;org.apache.hadoop.hive.metastore.TestOldSchema.testPartitionOps&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I am reverting this commit from branch-3 for now. Please fix theses tests for branch-3 to get this patch in.&lt;/p&gt;


&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16468069" author="vgarg" created="Tue, 8 May 2018 22:42:06 +0000"  >&lt;p&gt;You can findi TestReport at &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/10766/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/10766/testReport/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16468151" author="sershe" created="Wed, 9 May 2018 00:21:49 +0000"  >&lt;p&gt;Fixed the tests and reverted the revert. Generally if any tests fail like that they should be fixable by adding the flag. &lt;br/&gt;
I cannot run TestStats locally (not sure why, maven just doesn&apos;t run it), but I can repro TestOldSchema issue and then verify the fix.&lt;/p&gt;</comment>
                            <comment id="16468152" author="sershe" created="Wed, 9 May 2018 00:22:36 +0000"  >&lt;p&gt;Instead of reverting can you open a separate bug to fix? This is a blocker and if you just remove the version it&apos;s no longer tracked as blocker for 3.0&lt;/p&gt;</comment>
                            <comment id="16485506" author="ashutoshc" created="Tue, 22 May 2018 23:16:24 +0000"  >&lt;p&gt;This jira is resolved and released with Hive 3.0 If you find an issue with it, please create a new jira.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13160402">HIVE-19605</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12921621" name="HIVE-19310.02.patch" size="1004" author="sershe" created="Wed, 2 May 2018 19:07:13 +0000"/>
                            <attachment id="12921821" name="HIVE-19310.03.patch" size="1004" author="sershe" created="Thu, 3 May 2018 19:23:20 +0000"/>
                            <attachment id="12920674" name="HIVE-19310.1.patch" size="2038" author="vgumashta" created="Wed, 25 Apr 2018 20:06:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 26 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3t11b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>