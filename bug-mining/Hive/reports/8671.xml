<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:25:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-28225] Iceberg: Delete on entire table fails on COW mode</title>
                <link>https://issues.apache.org/jira/browse/HIVE-28225</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;If truncate is disabled, the delete on the entire table fails with NPE&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; java.lang.NullPointerException
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.parse.rewrite.CopyOnWriteDeleteRewriter.rewrite(CopyOnWriteDeleteRewriter.java:47)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.parse.rewrite.CopyOnWriteDeleteRewriter.rewrite(CopyOnWriteDeleteRewriter.java:31)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.rewriteAndAnalyze(RewriteSemanticAnalyzer.java:93)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.parse.DeleteSemanticAnalyzer.analyze(DeleteSemanticAnalyzer.java:78)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyze(RewriteSemanticAnalyzer.java:84)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:327)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:224)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:107)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:519)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:471)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.Driver.compileAndRespond(Driver.java:436)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.Driver.compileAndRespond(Driver.java:430)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.reexec.ReExecDriver.compileAndRespond(ReExecDriver.java:121)
&#160; &#160; &#160; &#160; at org.apache.hadoop.hive.ql.reexec.ReExecDriver.run(ReExecDriver.java:229)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13577425">HIVE-28225</key>
            <summary>Iceberg: Delete on entire table fails on COW mode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ayushtkn">Ayush Saxena</assignee>
                                    <reporter username="ayushtkn">Ayush Saxena</reporter>
                        <labels>
                            <label>hive-4.0.1-merged</label>
                            <label>hive-4.0.1-must</label>
                            <label>pull-request-available</label>
                    </labels>
                <created>Sat, 27 Apr 2024 11:50:00 +0000</created>
                <updated>Tue, 29 Jul 2025 14:52:01 +0000</updated>
                            <resolved>Wed, 1 May 2024 07:27:20 +0000</resolved>
                                                    <fixVersion>4.1.0</fixVersion>
                    <fixVersion>4.0.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17842566" author="ayushtkn" created="Wed, 1 May 2024 07:27:11 +0000"  >&lt;p&gt;Committed to master.&lt;br/&gt;
Thanx &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zabetak&quot; class=&quot;user-hover&quot; rel=&quot;zabetak&quot;&gt;zabetak&lt;/a&gt; for the review!!!&lt;/p&gt;</comment>
                            <comment id="17842594" author="dkuzmenko" created="Wed, 1 May 2024 09:42:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ayushtkn&quot; class=&quot;user-hover&quot; rel=&quot;ayushtkn&quot;&gt;ayushtkn&lt;/a&gt;, we should always go with truncate if delete the entire table. instead of this, we should have removed the deprecated config (btw, it&apos;s on by default). &lt;br/&gt;
cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sbadhya&quot; class=&quot;user-hover&quot; rel=&quot;sbadhya&quot;&gt;sbadhya&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17842596" author="ayushtkn" created="Wed, 1 May 2024 10:02:14 +0000"  >&lt;p&gt;We can explore a removal in the next release for sure, but we can&apos;t in 4.0.1, irrespective of default I believe the code shouldn&apos;t throw NPE, I will discuss with Sourabh tmrw on the removal.&lt;br/&gt;
Though I feel &lt;tt&gt;CopyOnWriteDeleteRewriter&lt;/tt&gt; by code in its own should handle the case of empty where clause, rather than relying everyone will pass a where clause, if there is such an assumption &amp;amp; we plan to remove the check. in 4.1.0, maybe we can let that stay from code point of view or at worst can add a PreConditions check for where clause to avoid anything as such in future.&lt;/p&gt;

&lt;p&gt;I need to explore if this config effect iceberg only or for ACID also or other storage handler? if even others as well, need to see if truncate everywhere is cheap or not&lt;/p&gt;</comment>
                            <comment id="17842608" author="ayushtkn" created="Wed, 1 May 2024 11:31:27 +0000"  >&lt;p&gt;Discussed with Denys, and figured out we didn&apos;t deprecate in 4.0.0 but in 4.1.0(current), so removal needs to go for 4.2.0, I will create a ticket for it as a placeholder.&lt;/p&gt;

&lt;p&gt;In Hive-4, it isn&apos;t deprecated and the default is false, so I have put the label for 4.0.1, so it has NPE in default conditions as well&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/hive/blob/rel/release-4.0.0/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java#L2695&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/blob/rel/release-4.0.0/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java#L2695&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 28 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1ownc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>