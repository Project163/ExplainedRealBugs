<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:25:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-28285] Exception when querying JDBC tables with Hive/DB column types mismatch</title>
                <link>https://issues.apache.org/jira/browse/HIVE-28285</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Queries over JDBC tables fail at runtime when the following conditions hold:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;there is a mismatch between the Hive type and the database type for some columns&lt;/li&gt;
	&lt;li&gt;CBO is not used&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;CBO may not be used when compiling the query for various reasons:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;CBO is explicitly disabled (via hive.cbo.enable property)&lt;/li&gt;
	&lt;li&gt;Query explicitly not supported in CBO (e.g., contains DISTRIBUTE BY clause)&lt;/li&gt;
	&lt;li&gt;Problem/bug in compilation that will skip CBO execution&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The examples below demonstrate the problem with Postgres but the problem itself is not database specific (although different errors may pop up depending on the underlying database). Different type mappings may also lead to different errors.&lt;/p&gt;
&lt;h3&gt;&lt;a name=&quot;MapPostgresDATEtoHiveTIMESTAMP&quot;&gt;&lt;/a&gt;Map Postgres DATE to Hive TIMESTAMP&lt;/h3&gt;

&lt;p&gt;&lt;ins&gt;Postgres&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt; date_table (cdate &lt;span class=&quot;code-keyword&quot;&gt;date&lt;/span&gt;);
&lt;span class=&quot;code-keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;into&lt;/span&gt; date_table &lt;span class=&quot;code-keyword&quot;&gt;values&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&apos;2024-05-29&apos;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;ins&gt;Hive&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TABLE&lt;/span&gt; h_type_table (cdate &lt;span class=&quot;code-keyword&quot;&gt;timestamp&lt;/span&gt;)
STORED &lt;span class=&quot;code-keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.hive.&lt;span class=&quot;code-keyword&quot;&gt;storage&lt;/span&gt;.jdbc.JdbcStorageHandler&apos;&lt;/span&gt;
TBLPROPERTIES (
    &lt;span class=&quot;code-quote&quot;&gt;&quot;hive.&lt;span class=&quot;code-keyword&quot;&gt;sql&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;database&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;type&lt;/span&gt;&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;POSTGRES&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;hive.&lt;span class=&quot;code-keyword&quot;&gt;sql&lt;/span&gt;.jdbc.driver&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;org.postgresql.Driver&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;hive.&lt;span class=&quot;code-keyword&quot;&gt;sql&lt;/span&gt;.jdbc.url&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;jdbc:postgresql://...&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;hive.&lt;span class=&quot;code-keyword&quot;&gt;sql&lt;/span&gt;.dbcp.username&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;user&lt;/span&gt;&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;hive.&lt;span class=&quot;code-keyword&quot;&gt;sql&lt;/span&gt;.dbcp.&lt;span class=&quot;code-keyword&quot;&gt;password&lt;/span&gt;&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;pwd&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;hive.&lt;span class=&quot;code-keyword&quot;&gt;sql&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt;&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;date_table&quot;&lt;/span&gt;
);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;ins&gt;Hive Result (CBO on)&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2024-05-29 00:00:00&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&lt;ins&gt;Error (CBO off)&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; java.lang.RuntimeException: java.io.IOException: java.lang.IllegalArgumentException: Cannot create timestamp, parsing error 2024-05-29
	at org.apache.hadoop.hive.ql.exec.FetchTask.executeInner(FetchTask.java:210)
	at org.apache.hadoop.hive.ql.exec.FetchTask.execute(FetchTask.java:95)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:212)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:154)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:149)
	at org.apache.hadoop.hive.ql.reexec.ReExecDriver.run(ReExecDriver.java:185)
	at org.apache.hadoop.hive.ql.reexec.ReExecDriver.run(ReExecDriver.java:230)
	at org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:257)
	at org.apache.hadoop.hive.cli.CliDriver.processCmd1(CliDriver.java:201)
	at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:127)
	at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:425)
	at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:356)
	at org.apache.hadoop.hive.ql.QTestUtil.executeClientInternal(QTestUtil.java:732)
	at org.apache.hadoop.hive.ql.QTestUtil.executeClient(QTestUtil.java:702)
	at org.apache.hadoop.hive.cli.control.CoreCliDriver.runTest(CoreCliDriver.java:116)
	at org.apache.hadoop.hive.cli.control.CliAdapter.runTest(CliAdapter.java:157)
	at org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver(TestMiniLlapLocalCliDriver.java:62)
Caused by: java.io.IOException: java.lang.IllegalArgumentException: Cannot create timestamp, parsing error 2024-05-29
	at org.apache.hadoop.hive.ql.exec.FetchOperator.getNextRow(FetchOperator.java:628)
	at org.apache.hadoop.hive.ql.exec.FetchOperator.pushRow(FetchOperator.java:535)
	at org.apache.hadoop.hive.ql.exec.FetchTask.executeInner(FetchTask.java:194)
	... 55 more
Caused by: java.lang.IllegalArgumentException: Cannot create timestamp, parsing error 2024-05-29
	at org.apache.hadoop.hive.common.type.Timestamp.valueOf(Timestamp.java:194)
	at org.apache.hive.storage.jdbc.JdbcSerDe.deserialize(JdbcSerDe.java:314)
	at org.apache.hadoop.hive.ql.exec.FetchOperator.getNextRow(FetchOperator.java:609)
	... 57 more
Caused by: java.time.format.DateTimeParseException: Text &apos;2024-05-29&apos; could not be parsed: Unable to obtain LocalDateTime from TemporalAccessor: {},ISO resolved to 2024-05-29 of type java.time.format.Parsed
	at java.time.format.DateTimeFormatter.createError(DateTimeFormatter.java:1920)
	at java.time.format.DateTimeFormatter.parse(DateTimeFormatter.java:1855)
	at java.time.LocalDateTime.parse(LocalDateTime.java:492)
	at org.apache.hadoop.hive.common.type.Timestamp.valueOf(Timestamp.java:188)
	... 59 more
Caused by: java.time.DateTimeException: Unable to obtain LocalDateTime from TemporalAccessor: {},ISO resolved to 2024-05-29 of type java.time.format.Parsed
	at java.time.LocalDateTime.from(LocalDateTime.java:461)
	at java.time.format.Parsed.query(Parsed.java:226)
	at java.time.format.DateTimeFormatter.parse(DateTimeFormatter.java:1851)
	... 61 more
Caused by: java.time.DateTimeException: Unable to obtain LocalTime from TemporalAccessor: {},ISO resolved to 2024-05-29 of type java.time.format.Parsed
	at java.time.LocalTime.from(LocalTime.java:409)
	at java.time.LocalDateTime.from(LocalDateTime.java:457)
	... 63 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;h3&gt;&lt;a name=&quot;MapPostgresNUMERICtoHiveBIGINT&quot;&gt;&lt;/a&gt;Map Postgres NUMERIC to Hive BIGINT&lt;/h3&gt;

&lt;p&gt;&lt;ins&gt;Postgres&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt; numeric_table (cnumeric &lt;span class=&quot;code-keyword&quot;&gt;numeric&lt;/span&gt;);
&lt;span class=&quot;code-keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;into&lt;/span&gt; numeric_table &lt;span class=&quot;code-keyword&quot;&gt;values&lt;/span&gt; (60.242);
&lt;span class=&quot;code-keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;into&lt;/span&gt; numeric_table &lt;span class=&quot;code-keyword&quot;&gt;values&lt;/span&gt; (90);
&lt;span class=&quot;code-keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;into&lt;/span&gt; numeric_table &lt;span class=&quot;code-keyword&quot;&gt;values&lt;/span&gt; (50.1);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;ins&gt;Hive&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TABLE&lt;/span&gt; h_type_table (cnumeric &lt;span class=&quot;code-keyword&quot;&gt;bigint&lt;/span&gt;)
STORED &lt;span class=&quot;code-keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.hive.&lt;span class=&quot;code-keyword&quot;&gt;storage&lt;/span&gt;.jdbc.JdbcStorageHandler&apos;&lt;/span&gt;
TBLPROPERTIES ( ...,    &lt;span class=&quot;code-quote&quot;&gt;&quot;hive.&lt;span class=&quot;code-keyword&quot;&gt;sql&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt;&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;numeric_table&quot;&lt;/span&gt;);
&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; * &lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; h_type_table;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;ins&gt;Hive Results (CBO on)&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;60&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;90&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;50&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&lt;ins&gt;Error (CBO off)&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.RuntimeException: java.io.IOException: java.io.IOException: org.apache.hive.storage.jdbc.exception.HiveJdbcDatabaseAccessException: Caught exception while trying to execute query: Error while trying to get column names: Decimal precision out of allowed range [1,38]
	at org.apache.hadoop.hive.ql.exec.FetchTask.executeInner(FetchTask.java:210)
	at org.apache.hadoop.hive.ql.exec.FetchTask.execute(FetchTask.java:95)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:212)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:154)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:149)
	at org.apache.hadoop.hive.ql.reexec.ReExecDriver.run(ReExecDriver.java:185)
	at org.apache.hadoop.hive.ql.reexec.ReExecDriver.run(ReExecDriver.java:230)
	at org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:257)
	at org.apache.hadoop.hive.cli.CliDriver.processCmd1(CliDriver.java:201)
	at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:127)
	at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:425)
	at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:356)
	at org.apache.hadoop.hive.ql.QTestUtil.executeClientInternal(QTestUtil.java:732)
	at org.apache.hadoop.hive.ql.QTestUtil.executeClient(QTestUtil.java:702)
	at org.apache.hadoop.hive.cli.control.CoreCliDriver.runTest(CoreCliDriver.java:116)
	at org.apache.hadoop.hive.cli.control.CliAdapter.runTest(CliAdapter.java:157)
	at org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver(TestMiniLlapLocalCliDriver.java:62)
Caused by: java.io.IOException: java.io.IOException: org.apache.hive.storage.jdbc.exception.HiveJdbcDatabaseAccessException: Caught exception while trying to execute query: Error while trying to get column names: Decimal precision out of allowed range [1,38]
	at org.apache.hadoop.hive.ql.exec.FetchOperator.getNextRow(FetchOperator.java:628)
	at org.apache.hadoop.hive.ql.exec.FetchOperator.pushRow(FetchOperator.java:535)
	at org.apache.hadoop.hive.ql.exec.FetchTask.executeInner(FetchTask.java:194)
	... 55 more
Caused by: java.io.IOException: org.apache.hive.storage.jdbc.exception.HiveJdbcDatabaseAccessException: Caught exception while trying to execute query: Error while trying to get column names: Decimal precision out of allowed range [1,38]
	at org.apache.hive.storage.jdbc.JdbcRecordReader.next(JdbcRecordReader.java:85)
	at org.apache.hive.storage.jdbc.JdbcRecordReader.next(JdbcRecordReader.java:35)
	at org.apache.hadoop.hive.ql.exec.FetchOperator.getNextRow(FetchOperator.java:595)
	... 57 more
Caused by: org.apache.hive.storage.jdbc.exception.HiveJdbcDatabaseAccessException: Caught exception while trying to execute query: Error while trying to get column names: Decimal precision out of allowed range [1,38]
	at org.apache.hive.storage.jdbc.dao.GenericJdbcDatabaseAccessor.getRecordIterator(GenericJdbcDatabaseAccessor.java:254)
	at org.apache.hive.storage.jdbc.JdbcRecordReader.next(JdbcRecordReader.java:58)
	... 59 more
Caused by: org.apache.hive.storage.jdbc.exception.HiveJdbcDatabaseAccessException: Error while trying to get column names: Decimal precision out of allowed range [1,38]
	at org.apache.hive.storage.jdbc.dao.JdbcRecordIterator.&amp;lt;init&amp;gt;(JdbcRecordIterator.java:85)
	at org.apache.hive.storage.jdbc.dao.GenericJdbcDatabaseAccessor.getRecordIterator(GenericJdbcDatabaseAccessor.java:249)
	... 60 more
Caused by: java.lang.IllegalArgumentException: Decimal precision out of allowed range [1,38]
	at org.apache.hadoop.hive.serde2.typeinfo.HiveDecimalUtils.validateParameter(HiveDecimalUtils.java:44)
	at org.apache.hadoop.hive.serde2.typeinfo.DecimalTypeInfo.&amp;lt;init&amp;gt;(DecimalTypeInfo.java:36)
	at org.apache.hadoop.hive.serde2.typeinfo.TypeInfoFactory.createPrimitiveTypeInfo(TypeInfoFactory.java:165)
	at org.apache.hadoop.hive.serde2.typeinfo.TypeInfoFactory.getPrimitiveTypeInfo(TypeInfoFactory.java:117)
	at org.apache.hadoop.hive.serde2.typeinfo.TypeInfoFactory.getDecimalTypeInfo(TypeInfoFactory.java:186)
	at org.apache.hive.storage.jdbc.dao.GenericJdbcDatabaseAccessor.lambda$static$0(GenericJdbcDatabaseAccessor.java:102)
	at org.apache.hive.storage.jdbc.dao.GenericJdbcDatabaseAccessor.getColumnMetadata(GenericJdbcDatabaseAccessor.java:154)
	at org.apache.hive.storage.jdbc.dao.GenericJdbcDatabaseAccessor.getColTypesFromRS(GenericJdbcDatabaseAccessor.java:174)
	at org.apache.hive.storage.jdbc.dao.JdbcRecordIterator.&amp;lt;init&amp;gt;(JdbcRecordIterator.java:72)
	... 61 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;h3&gt;&lt;a name=&quot;MapPostgresVARCHARtoHiveINT&quot;&gt;&lt;/a&gt;Map Postgres VARCHAR to Hive INT&lt;/h3&gt;

&lt;p&gt;&lt;ins&gt;Postgres&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt; varchar_table (cvarchar &lt;span class=&quot;code-keyword&quot;&gt;varchar&lt;/span&gt;(20));
&lt;span class=&quot;code-keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;into&lt;/span&gt; varchar_table &lt;span class=&quot;code-keyword&quot;&gt;values&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&apos;10&apos;&lt;/span&gt;);
&lt;span class=&quot;code-keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;into&lt;/span&gt; varchar_table &lt;span class=&quot;code-keyword&quot;&gt;values&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&apos;20&apos;&lt;/span&gt;);
&lt;span class=&quot;code-keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;into&lt;/span&gt; varchar_table &lt;span class=&quot;code-keyword&quot;&gt;values&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&apos;30.05&apos;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;ins&gt;Hive&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TABLE&lt;/span&gt; h_type_table (cvarchar &lt;span class=&quot;code-keyword&quot;&gt;bigint&lt;/span&gt;)
STORED &lt;span class=&quot;code-keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.hive.&lt;span class=&quot;code-keyword&quot;&gt;storage&lt;/span&gt;.jdbc.JdbcStorageHandler&apos;&lt;/span&gt;
TBLPROPERTIES ( ...,    &lt;span class=&quot;code-quote&quot;&gt;&quot;hive.&lt;span class=&quot;code-keyword&quot;&gt;sql&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt;&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;varchar_table&quot;&lt;/span&gt;);
&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; * &lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; h_type_table;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;ins&gt;Hive Results (CBO on)&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;10&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&lt;ins&gt;Error (CBO off)&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.RuntimeException: java.io.IOException: java.lang.NumberFormatException: For input string: &quot;30.05&quot;
	at org.apache.hadoop.hive.ql.exec.FetchTask.executeInner(FetchTask.java:210)
	at org.apache.hadoop.hive.ql.exec.FetchTask.execute(FetchTask.java:95)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:212)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:154)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:149)
	at org.apache.hadoop.hive.ql.reexec.ReExecDriver.run(ReExecDriver.java:185)
	at org.apache.hadoop.hive.ql.reexec.ReExecDriver.run(ReExecDriver.java:230)
	at org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:257)
	at org.apache.hadoop.hive.cli.CliDriver.processCmd1(CliDriver.java:201)
	at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:127)
	at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:425)
	at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:356)
	at org.apache.hadoop.hive.ql.QTestUtil.executeClientInternal(QTestUtil.java:732)
	at org.apache.hadoop.hive.ql.QTestUtil.executeClient(QTestUtil.java:702)
	at org.apache.hadoop.hive.cli.control.CoreCliDriver.runTest(CoreCliDriver.java:116)
	at org.apache.hadoop.hive.cli.control.CliAdapter.runTest(CliAdapter.java:157)
	at org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver(TestMiniLlapLocalCliDriver.java:62)
Caused by: java.io.IOException: java.lang.NumberFormatException: For input string: &quot;30.05&quot;
	at org.apache.hadoop.hive.ql.exec.FetchOperator.getNextRow(FetchOperator.java:628)
	at org.apache.hadoop.hive.ql.exec.FetchOperator.pushRow(FetchOperator.java:535)
	at org.apache.hadoop.hive.ql.exec.FetchTask.executeInner(FetchTask.java:194)
	... 55 more
Caused by: java.lang.NumberFormatException: For input string: &quot;30.05&quot;
	at java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)
	at java.lang.Integer.parseInt(Integer.java:580)
	at java.lang.Integer.valueOf(Integer.java:766)
	at org.apache.hive.storage.jdbc.JdbcSerDe.deserialize(JdbcSerDe.java:242)
	at org.apache.hadoop.hive.ql.exec.FetchOperator.getNextRow(FetchOperator.java:609)
	... 57 more

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13580890">HIVE-28285</key>
            <summary>Exception when querying JDBC tables with Hive/DB column types mismatch</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zabetak">Stamatis Zampetakis</assignee>
                                    <reporter username="zabetak">Stamatis Zampetakis</reporter>
                        <labels>
                            <label>hive-4.0.1-merged</label>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 29 May 2024 15:38:16 +0000</created>
                <updated>Tue, 29 Jul 2025 14:51:56 +0000</updated>
                            <resolved>Mon, 3 Jun 2024 08:24:03 +0000</resolved>
                                    <version>4.0.0</version>
                                    <fixVersion>4.1.0</fixVersion>
                    <fixVersion>4.0.1</fixVersion>
                                    <component>HiveServer2</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17850412" author="zabetak" created="Wed, 29 May 2024 15:39:46 +0000"  >&lt;p&gt;This is a regression caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-27487&quot; title=&quot;NPE in Hive JDBC storage handler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-27487&quot;&gt;&lt;del&gt;HIVE-27487&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17851552" author="zabetak" created="Mon, 3 Jun 2024 08:24:03 +0000"  >&lt;p&gt;Fixed in &lt;a href=&quot;https://github.com/apache/hive/commit/07cc9c3faebf790284ed0b3b2811f83394575ff5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/commit/07cc9c3faebf790284ed0b3b2811f83394575ff5&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks for the review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dengzh&quot; class=&quot;user-hover&quot; rel=&quot;dengzh&quot;&gt;dengzh&lt;/a&gt; !&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13542922">HIVE-27487</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 23 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1phyw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>