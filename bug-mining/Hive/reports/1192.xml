<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:05:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-3308] Mixing avro and snappy gives null values</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3308</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;On default hive uses LazySimpleSerDe for output.&lt;br/&gt;
When I now enable compression and &quot;select count&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; from avrotable&quot; the output is a file with the .avro extension but this then will display null values since the file is in reality not an avro file but a file created by LazySimpleSerDe using compression so should be a .snappy file.&lt;br/&gt;
This causes any job (exception select * from avrotable is that not truly a job) to show null values.&lt;br/&gt;
If you use any serde other then avro you can temporarily fix this by setting &quot;set hive.output.file.extension=.snappy&quot; and it will correctly work again but this won&apos;t work on avro since it overwrites the hive.output.file.extension during initializing.&lt;/p&gt;

&lt;p&gt;When you dump the query result into a table with &quot;create table bla as&quot; you can rename the .avro file into .snappy and the &quot;select from bla&quot; will also magiacally work again.&lt;/p&gt;

&lt;p&gt;Input and Ouput serdes don&apos;t always match so when I use avro as an input format it should not set the hive.output.file.extension.&lt;br/&gt;
Onces it&apos;s set all queries will use it and fail making the connection useless to reuse.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12600465">HIVE-3308</key>
            <summary>Mixing avro and snappy gives null values</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bennies">Bennie Schut</assignee>
                                    <reporter username="bennies">Bennie Schut</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Jul 2012 13:52:27 +0000</created>
                <updated>Thu, 16 May 2013 21:10:35 +0000</updated>
                            <resolved>Tue, 9 Apr 2013 00:45:09 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.11.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="13423879" author="bennies" created="Fri, 27 Jul 2012 13:54:59 +0000"  >&lt;p&gt;Added a test to show the problem.&lt;br/&gt;
Result of the test will show:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;
			&lt;ol&gt;
				&lt;li&gt;A masked pattern was here ####&lt;br/&gt;
POSTHOOK: query: select count&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; from src&lt;br/&gt;
POSTHOOK: type: QUERY&lt;br/&gt;
POSTHOOK: Input: default@src&lt;/li&gt;
				&lt;li&gt;A masked pattern was here ####&lt;br/&gt;
NULL&lt;/li&gt;
			&lt;/ol&gt;
			&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;But should show something like:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;
			&lt;ol&gt;
				&lt;li&gt;A masked pattern was here ####&lt;br/&gt;
POSTHOOK: query: select count&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; from src&lt;br/&gt;
POSTHOOK: type: QUERY&lt;br/&gt;
POSTHOOK: Input: default@src&lt;/li&gt;
				&lt;li&gt;A masked pattern was here ####&lt;br/&gt;
500&lt;/li&gt;
			&lt;/ol&gt;
			&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="13569871" author="ashutoshc" created="Sun, 3 Feb 2013 19:32:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jakobhoman&quot; class=&quot;user-hover&quot; rel=&quot;jakobhoman&quot;&gt;jakobhoman&lt;/a&gt; Would you like to review this patch?&lt;/p&gt;</comment>
                            <comment id="13569879" author="jghoman" created="Sun, 3 Feb 2013 19:49:23 +0000"  >&lt;p&gt;Will do.&lt;/p&gt;</comment>
                            <comment id="13612502" author="bennies" created="Mon, 25 Mar 2013 09:05:54 +0000"  >&lt;p&gt;I would really appreciate someone committing this. It has tests showing the issue with correct results after the patch. It makes the serde more consistent with other serdes. Basically anyone using compression combined with avro will hit this bug like we see with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4195&quot; title=&quot;Avro SerDe causes incorrect behavior in unrelated tables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4195&quot;&gt;&lt;del&gt;HIVE-4195&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13626035" author="navis" created="Tue, 9 Apr 2013 00:44:55 +0000"  >&lt;p&gt;Committed to trunk. Thanks, Bennie.&lt;/p&gt;</comment>
                            <comment id="13626939" author="hudson" created="Tue, 9 Apr 2013 18:44:29 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #2053 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/2053/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/2053/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3308&quot; title=&quot;Mixing avro and snappy gives null values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3308&quot;&gt;&lt;del&gt;HIVE-3308&lt;/del&gt;&lt;/a&gt; Mixing avro and snappy gives null values (Bennie Schut via Navis) (Revision 1465849)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
navis : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1465849&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1465849&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/avro_compression_enabled.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/avro_compression_enabled.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/avro/AvroSerDe.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13627034" author="hudson" created="Tue, 9 Apr 2013 20:15:34 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #148 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/148/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/148/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3308&quot; title=&quot;Mixing avro and snappy gives null values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3308&quot;&gt;&lt;del&gt;HIVE-3308&lt;/del&gt;&lt;/a&gt; Mixing avro and snappy gives null values (Bennie Schut via Navis) (Revision 1465849)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
navis : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1465849&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1465849&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/avro_compression_enabled.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/avro_compression_enabled.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/avro/AvroSerDe.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12637342">HIVE-4195</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12538157" name="HIVE-3308.patch1.txt" size="1428" author="bennies" created="Fri, 27 Jul 2012 13:54:59 +0000"/>
                            <attachment id="12566516" name="HIVE-3308.patch2.txt" size="5058" author="bennies" created="Fri, 25 Jan 2013 15:07:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>259179</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 33 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lnbb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>124427</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>