<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:10:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-4487] Hive does not set explicit permissions on hive.exec.scratchdir</title>
                <link>https://issues.apache.org/jira/browse/HIVE-4487</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The hive.exec.scratchdir defaults to /tmp/hive-${user.name}, but when Hive creates this directory it doesn&apos;t set any explicit permission on it. This means if you have the default HDFS umask setting of 022, then these directories end up being world readable. These permissions also get applied to the staging directories and their files, thus leaving inter-stage data world readable.&lt;/p&gt;

&lt;p&gt;This can cause a potential leak of data especially when operating on a Kerberos enabled cluster. Hive should probably default these directories to only be readable by the owner.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12645967">HIVE-4487</key>
            <summary>Hive does not set explicit permissions on hive.exec.scratchdir</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ctang">Chaoyu Tang</assignee>
                                    <reporter username="fwiffo">Joey Echeverria</reporter>
                        <labels>
                            <label>TODOC12</label>
                    </labels>
                <created>Fri, 3 May 2013 14:05:01 +0000</created>
                <updated>Tue, 24 Feb 2015 11:09:55 +0000</updated>
                            <resolved>Wed, 18 Sep 2013 18:07:25 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.12.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="13648435" author="fwiffo" created="Fri, 3 May 2013 14:12:59 +0000"  >&lt;p&gt;The current workaround is to set the umask in hive-site.xml:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;property&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;name&amp;gt;&lt;/span&gt;fs.permissions.umask-mode&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;value&amp;gt;&lt;/span&gt;077&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/property&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13659087" author="ctang.ma" created="Thu, 16 May 2013 00:40:30 +0000"  >&lt;p&gt;How about the hive.exec.local.scratchdir (/tmp/${user.name} in local system) if it is applicable, should not it be 700 as well?&lt;/p&gt;</comment>
                            <comment id="13691208" author="ctang.ma" created="Sat, 22 Jun 2013 18:38:43 +0000"  >&lt;p&gt;Please review the changes in &lt;a href=&quot;https://reviews.apache.org/r/12049/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/12049/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13769116" author="hiveqa" created="Tue, 17 Sep 2013 02:40:43 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12589262/HIVE-4487.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12589262/HIVE-4487.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 3125 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/770/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/770/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/770/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/770/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13769126" author="brocknoland" created="Tue, 17 Sep 2013 02:52:09 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13771025" author="brocknoland" created="Wed, 18 Sep 2013 18:07:25 +0000"  >&lt;p&gt;Thanks Chaoyu! I have committed this to trunk. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;thejas&lt;/a&gt; you mind consider this one for 0.12 as well.&lt;/p&gt;</comment>
                            <comment id="13771045" author="thejas" created="Wed, 18 Sep 2013 18:22:19 +0000"  >&lt;p&gt;Yes, I will commit it to 0.12 branch.&lt;/p&gt;</comment>
                            <comment id="13771092" author="hudson" created="Wed, 18 Sep 2013 18:49:11 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-hadoop1-ptest #172 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop1-ptest/172/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop1-ptest/172/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4487&quot; title=&quot;Hive does not set explicit permissions on hive.exec.scratchdir&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4487&quot;&gt;&lt;del&gt;HIVE-4487&lt;/del&gt;&lt;/a&gt; - Hive does not set explicit permissions on hive.exec.scratchdir (Chaoyu Tang via Brock Noland) (brock: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1524509&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1524509&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/Context.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13771106" author="hudson" created="Wed, 18 Sep 2013 18:55:03 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-hadoop2 #438 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/438/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/438/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4487&quot; title=&quot;Hive does not set explicit permissions on hive.exec.scratchdir&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4487&quot;&gt;&lt;del&gt;HIVE-4487&lt;/del&gt;&lt;/a&gt; - Hive does not set explicit permissions on hive.exec.scratchdir (Chaoyu Tang via Brock Noland) (brock: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1524509&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1524509&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/Context.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13771160" author="yhuai" created="Wed, 18 Sep 2013 19:55:12 +0000"  >&lt;p&gt;FsPermission(String mode) was not in hadoop 0.20.2.&lt;/p&gt;</comment>
                            <comment id="13771162" author="yhuai" created="Wed, 18 Sep 2013 19:56:37 +0000"  >&lt;p&gt;If we use &quot;ant clean package eclipse-files&quot;, we cannot build hive inside eclipse.&lt;/p&gt;</comment>
                            <comment id="13771165" author="brocknoland" created="Wed, 18 Sep 2013 20:00:44 +0000"  >&lt;p&gt;I created &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5313&quot; title=&quot;HIVE-4487 breaks build because 0.20.2 is missing FSPermission(string)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5313&quot;&gt;&lt;del&gt;HIVE-5313&lt;/del&gt;&lt;/a&gt; to fix this.&lt;/p&gt;</comment>
                            <comment id="13771336" author="hudson" created="Wed, 18 Sep 2013 22:38:33 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-hadoop2 #439 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/439/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/439/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5313&quot; title=&quot;HIVE-4487 breaks build because 0.20.2 is missing FSPermission(string)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5313&quot;&gt;&lt;del&gt;HIVE-5313&lt;/del&gt;&lt;/a&gt; - &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4487&quot; title=&quot;Hive does not set explicit permissions on hive.exec.scratchdir&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4487&quot;&gt;&lt;del&gt;HIVE-4487&lt;/del&gt;&lt;/a&gt; breaks build because 0.20.2 is missing FSPermission(string) (brock: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1524578&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1524578&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/Context.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13771535" author="thejas" created="Thu, 19 Sep 2013 02:29:31 +0000"  >&lt;p&gt;Patch committed to 0.12 branch&lt;/p&gt;</comment>
                            <comment id="13771678" author="thejas" created="Thu, 19 Sep 2013 07:55:06 +0000"  >&lt;p&gt;I am seeing several precommit intermittent test failures in last few builds, which seem to be caused by permission errors. I am wondering if it might be related to this change. I also saw this on my linux machine, but not in another run on my mac.&lt;/p&gt;

&lt;p&gt;The tests have errors like this -&lt;br/&gt;
Copying data from &lt;a href=&quot;file:/home/hiveptest/ip-10-74-50-170-hiveptest-2/apache-svn-trunk-source/data/files/kv1.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/home/hiveptest/ip-10-74-50-170-hiveptest-2/apache-svn-trunk-source/data/files/kv1.txt&lt;/a&gt;&lt;br/&gt;
Failed with exception Failed to set permissions of path: /home/hiveptest/ip-10-74-50-170-hiveptest-2/apache-svn-trunk-source/build/ql/scratchdir/hive_2013-09-18_19-22-30_852_799993877859563099-1/-ext-10000 to 0777&lt;/p&gt;

&lt;p&gt;For example in - &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/813/testReport/org.apache.hadoop.hive.ql.parse/TestParseNegative/testParseNegative_ambiguous_join_col/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/813/testReport/org.apache.hadoop.hive.ql.parse/TestParseNegative/testParseNegative_ambiguous_join_col/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13771713" author="hudson" created="Thu, 19 Sep 2013 09:02:43 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-h0.21 #2341 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/2341/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/2341/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5313&quot; title=&quot;HIVE-4487 breaks build because 0.20.2 is missing FSPermission(string)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5313&quot;&gt;&lt;del&gt;HIVE-5313&lt;/del&gt;&lt;/a&gt; - &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4487&quot; title=&quot;Hive does not set explicit permissions on hive.exec.scratchdir&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4487&quot;&gt;&lt;del&gt;HIVE-4487&lt;/del&gt;&lt;/a&gt; breaks build because 0.20.2 is missing FSPermission(string) (brock: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1524578&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1524578&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/Context.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4487&quot; title=&quot;Hive does not set explicit permissions on hive.exec.scratchdir&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4487&quot;&gt;&lt;del&gt;HIVE-4487&lt;/del&gt;&lt;/a&gt; - Hive does not set explicit permissions on hive.exec.scratchdir (Chaoyu Tang via Brock Noland) (brock: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1524509&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1524509&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/Context.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13771952" author="brocknoland" created="Thu, 19 Sep 2013 14:58:37 +0000"  >&lt;p&gt;Very strange. I don&apos;t see why this would be occurring since the hiveptest owns everything in /home/hiveptest/. It&apos;s not a privileged user so cannot it cannot change ownership. The only way I can see that is if &quot;hive_2013-09-18_19-22-30_852_799993877859563099-1&quot; somehow got created with 000 (or anything but 700).&lt;/p&gt;</comment>
                            <comment id="13771954" author="brocknoland" created="Thu, 19 Sep 2013 15:00:09 +0000"  >&lt;p&gt;Full error message from: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-813/failed/TestParseNegative/hive.log&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-813/failed/TestParseNegative/hive.log&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;20_510_7475863120290716577-1/-ext-10000 to 0777
java.io.IOException: Failed to set permissions of path: /home/hiveptest/ip-10-74-50-170-hiveptest-2/apache-svn-trunk-source/build/ql/scratchdir/hive_2013-09-18_19-22-20_510_7475863120290716577-1/-ext-10000 to 0777
	at org.apache.hadoop.fs.FileUtil.checkReturnValue(FileUtil.java:689)
	at org.apache.hadoop.fs.FileUtil.setPermission(FileUtil.java:662)
	at org.apache.hadoop.fs.RawLocalFileSystem.setPermission(RawLocalFileSystem.java:509)
	at org.apache.hadoop.fs.RawLocalFileSystem.mkdirs(RawLocalFileSystem.java:344)
	at org.apache.hadoop.fs.FilterFileSystem.mkdirs(FilterFileSystem.java:189)
	at org.apache.hadoop.fs.FilterFileSystem.mkdirs(FilterFileSystem.java:189)
	at org.apache.hadoop.fs.ProxyFileSystem.mkdirs(ProxyFileSystem.java:217)
	at org.apache.hadoop.fs.FilterFileSystem.mkdirs(FilterFileSystem.java:189)
	at org.apache.hadoop.fs.FileSystem.mkdirs(FileSystem.java:1126)
	at org.apache.hadoop.hive.ql.exec.CopyTask.execute(CopyTask.java:74)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:151)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:65)
	at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1415)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1193)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1021)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:889)
	at org.apache.hadoop.hive.ql.QTestUtil.runLoadCmd(QTestUtil.java:539)
	at org.apache.hadoop.hive.ql.QTestUtil.createSources(QTestUtil.java:586)
	at org.apache.hadoop.hive.ql.QTestUtil.init(QTestUtil.java:678)
	at org.apache.hadoop.hive.ql.parse.TestParseNegative.runTest(TestParseNegative.java:248)
	at org.apache.hadoop.hive.ql.parse.TestParseNegative.testParseNegative_ambiguous_join_col(TestParseNegative.java:117)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13772066" author="hudson" created="Thu, 19 Sep 2013 17:24:23 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-hadoop2-ptest #106 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2-ptest/106/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2-ptest/106/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5313&quot; title=&quot;HIVE-4487 breaks build because 0.20.2 is missing FSPermission(string)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5313&quot;&gt;&lt;del&gt;HIVE-5313&lt;/del&gt;&lt;/a&gt; - &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4487&quot; title=&quot;Hive does not set explicit permissions on hive.exec.scratchdir&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4487&quot;&gt;&lt;del&gt;HIVE-4487&lt;/del&gt;&lt;/a&gt; breaks build because 0.20.2 is missing FSPermission(string) (brock: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1524578&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1524578&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/Context.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4487&quot; title=&quot;Hive does not set explicit permissions on hive.exec.scratchdir&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4487&quot;&gt;&lt;del&gt;HIVE-4487&lt;/del&gt;&lt;/a&gt; - Hive does not set explicit permissions on hive.exec.scratchdir (Chaoyu Tang via Brock Noland) (brock: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1524509&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1524509&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/Context.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13772093" author="yhuai" created="Thu, 19 Sep 2013 17:44:00 +0000"  >&lt;p&gt;Here is my error log when I am launching hive cli through eclipse.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Caused by: java.io.FileNotFoundException: /tmp/yhuai/hive_2013-09-19_13-43-12_206_2528583202954923226-1/-local-10000 (Permission denied)
	at java.io.FileOutputStream.open(Native Method)
	at java.io.FileOutputStream.&amp;lt;init&amp;gt;(FileOutputStream.java:209)
	at org.apache.hadoop.fs.RawLocalFileSystem$LocalFSFileOutputStream.&amp;lt;init&amp;gt;(RawLocalFileSystem.java:180)
	at org.apache.hadoop.fs.RawLocalFileSystem$LocalFSFileOutputStream.&amp;lt;init&amp;gt;(RawLocalFileSystem.java:176)
	at org.apache.hadoop.fs.RawLocalFileSystem.create(RawLocalFileSystem.java:234)
	at org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.&amp;lt;init&amp;gt;(ChecksumFileSystem.java:335)
	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:368)
	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:484)
	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:465)
	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:372)
	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:364)
	at org.apache.hadoop.hive.ql.exec.DDLTask.showTables(DDLTask.java:2252)
	... 13 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13772101" author="brocknoland" created="Thu, 19 Sep 2013 17:50:12 +0000"  >&lt;p&gt;Can you share the file permissions on each directory in the tree?&lt;/p&gt;</comment>
                            <comment id="13772103" author="yhuai" created="Thu, 19 Sep 2013 17:50:45 +0000"  >&lt;p&gt;i meant when I did &quot;show tables&quot; in hive cli launched in eclipse.&lt;/p&gt;</comment>
                            <comment id="13772106" author="yhuai" created="Thu, 19 Sep 2013 17:52:24 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;drwxrwxrwt  22 root     root      56K Sep 19 13:36 tmp
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;drwxrwxrwx 2 yhuai   yhuai   4.0K Sep 19 13:50 yhuai
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13772184" author="hudson" created="Thu, 19 Sep 2013 19:15:20 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-hadoop1-ptest #173 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop1-ptest/173/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop1-ptest/173/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5313&quot; title=&quot;HIVE-4487 breaks build because 0.20.2 is missing FSPermission(string)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5313&quot;&gt;&lt;del&gt;HIVE-5313&lt;/del&gt;&lt;/a&gt; - &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4487&quot; title=&quot;Hive does not set explicit permissions on hive.exec.scratchdir&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4487&quot;&gt;&lt;del&gt;HIVE-4487&lt;/del&gt;&lt;/a&gt; breaks build because 0.20.2 is missing FSPermission(string) (brock: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1524578&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1524578&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/Context.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13772186" author="ctang.ma" created="Thu, 19 Sep 2013 19:16:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yhuai&quot; class=&quot;user-hover&quot; rel=&quot;yhuai&quot;&gt;yhuai&lt;/a&gt; It works in my eclipse. The log tells that it failed in line outStream = fs.create(resFile) of DDLTask.&lt;br/&gt;
Could you debug and check before this line is executed, what permission and owner of the dir (e.g. /tmp/yhuai/hive_2013-09-19_xxxx/, one level up -local-10000) are? What Hadoop version you are using?&lt;/p&gt;</comment>
                            <comment id="13772258" author="thejas" created="Thu, 19 Sep 2013 20:25:42 +0000"  >&lt;p&gt;I think the problem might have to do with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5313&quot; title=&quot;HIVE-4487 breaks build because 0.20.2 is missing FSPermission(string)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5313&quot;&gt;&lt;del&gt;HIVE-5313&lt;/del&gt;&lt;/a&gt; change. It converts the octal string into short using Short.parseShort(scratchDirPermission) but that function expects decimal. So &quot;700&quot; gets converted to 700 instead of 448.&lt;/p&gt;</comment>
                            <comment id="13772278" author="thejas" created="Thu, 19 Sep 2013 20:35:35 +0000"  >&lt;p&gt;I have created &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5322&quot; title=&quot;FsPermission is initialized incorrectly in HIVE 5513&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5322&quot;&gt;&lt;del&gt;HIVE-5322&lt;/del&gt;&lt;/a&gt; to track the permission issue.&lt;/p&gt;</comment>
                            <comment id="13772351" author="ctang.ma" created="Thu, 19 Sep 2013 21:35:14 +0000"  >&lt;p&gt;Synced to the head of trunk and was able to reproduce the issue as Yin Huai saw. &lt;br/&gt;
The cause is, as Thejas said, in the conversion of octal permission to short. Changed the line 209 in Context.java to:&lt;br/&gt;
FsPermission fsPermission = new FsPermission(Short.parseShort(scratchDirPermission.trim(), 8)) &lt;br/&gt;
will solve the problem.&lt;/p&gt;</comment>
                            <comment id="13772355" author="ctang.ma" created="Thu, 19 Sep 2013 21:39:15 +0000"  >&lt;p&gt;Noticed that Mark has already provided a patch with the same changes in Hive-5322. Thanks, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mwagner&quot; class=&quot;user-hover&quot; rel=&quot;mwagner&quot;&gt;mwagner&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13796132" author="ashutoshc" created="Tue, 15 Oct 2013 23:31:13 +0000"  >&lt;p&gt;This issue has been fixed and released as part of 0.12 release. If you find further issues, please create a new jira and link it to this one.&lt;/p&gt;</comment>
                            <comment id="14334688" author="lefty@hortonworks.com" created="Tue, 24 Feb 2015 08:59:45 +0000"  >&lt;p&gt;Doc note:  This adds configuration parameter &lt;b&gt;hive.scratch.dir.permission&lt;/b&gt; to HiveConf.java, so it needs to be documented in the wiki (in two places):&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/AdminManual+Configuration#AdminManualConfiguration-ConfigurationVariables&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;AdminManual Configuration &amp;#8211; Configuration Variables &lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.exec.scratchdir&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Configuration Properties &amp;#8211; put it after hive.exec.scratchdir &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6847&quot; title=&quot;Improve / fix bugs in Hive scratch dir setup&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6847&quot;&gt;&lt;del&gt;HIVE-6847&lt;/del&gt;&lt;/a&gt; adds a parameter description in release 0.14.0.&lt;/p&gt;</comment>
                            <comment id="14334776" author="lefty@hortonworks.com" created="Tue, 24 Feb 2015 11:09:55 +0000"  >&lt;p&gt;Doc done (please review):  &lt;b&gt;hive.scratch.dir.permission&lt;/b&gt; is documented in the wiki now.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/AdminManual+Configuration#AdminManualConfiguration-ConfigurationVariables&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;AdminManual Configuration &amp;#8211; Configuration Variables &lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.scratch.dir.permission&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Configuration Properties &amp;#8211; hive.scratch.dir.permission &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;By the way, the parameter name omits &quot;.exec.&quot; so it doesn&apos;t match similar parameters.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12669541">HIVE-5322</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12706743">HIVE-6847</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12669321">HIVE-5313</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12589262" name="HIVE-4487.patch" size="2659" author="ctang" created="Sat, 22 Jun 2013 19:27:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>326326</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 39 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1kaqf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>326671</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>