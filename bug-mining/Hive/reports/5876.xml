<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:57:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-17576] Improve progress-reporting in TezProcessor</title>
                <link>https://issues.apache.org/jira/browse/HIVE-17576</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Another one on behalf of &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=selinazh&quot; class=&quot;user-hover&quot; rel=&quot;selinazh&quot;&gt;selinazh&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cdrome&quot; class=&quot;user-hover&quot; rel=&quot;cdrome&quot;&gt;cdrome&lt;/a&gt;. Following the example in &lt;a href=&quot;https://github.com/apache/tez/blob/247719d7314232f680f028f4e1a19370ffb7b1bb/tez-mapreduce/src/main/java/org/apache/tez/mapreduce/processor/map/MapProcessor.java#L88&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Apache Tez&apos;s &lt;tt&gt;MapProcessor&lt;/tt&gt;&lt;/a&gt;, &lt;tt&gt;TezProcessor&lt;/tt&gt; ought to use &lt;tt&gt;ProgressHelper&lt;/tt&gt; to report progress for a Tez task. As per &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kshukla&quot; class=&quot;user-hover&quot; rel=&quot;kshukla&quot;&gt;kshukla&lt;/a&gt;&apos;s advice,&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Tez... provides &lt;tt&gt;getProgress()&lt;/tt&gt; API for &lt;tt&gt;AbstractLogicalInput(s)&lt;/tt&gt; which will give the correct progress value for a given Input. The TezProcessor(s) in Hive should use this to do something similar to what MapProcessor in Tez does today, which is use/override ProgressHelper to get the input progress and then set the progress on the processorContext.&lt;br/&gt;
...&lt;br/&gt;
The default behavior of the ProgressHelper class sets the processor progress to be the average of progress values from all inputs.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This code is &lt;del&gt;whacked from&lt;/del&gt; &lt;b&gt;inspired by&lt;/b&gt; &lt;tt&gt;MapProcessor&lt;/tt&gt;&apos;s use of &lt;tt&gt;ProgressHelper&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;(For my reference, YHIVE-978.)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13104124">HIVE-17576</key>
            <summary>Improve progress-reporting in TezProcessor</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mithun">Mithun Radhakrishnan</assignee>
                                    <reporter username="mithun">Mithun Radhakrishnan</reporter>
                        <labels>
                    </labels>
                <created>Fri, 22 Sep 2017 00:07:53 +0000</created>
                <updated>Tue, 22 May 2018 23:15:02 +0000</updated>
                            <resolved>Mon, 9 Oct 2017 18:20:47 +0000</resolved>
                                    <version>2.2.0</version>
                    <version>2.4.0</version>
                    <version>3.0.0</version>
                                    <fixVersion>2.2.1</fixVersion>
                    <fixVersion>2.4.0</fixVersion>
                    <fixVersion>3.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16175702" author="mithun" created="Fri, 22 Sep 2017 00:19:23 +0000"  >&lt;p&gt;Hmm... Looks like the &lt;tt&gt;ProgressHelper&lt;/tt&gt; is only available in Tez 0.9. This might need to go only to &lt;tt&gt;master&lt;/tt&gt;. :/&lt;/p&gt;</comment>
                            <comment id="16175705" author="mithun" created="Fri, 22 Sep 2017 00:20:43 +0000"  >&lt;p&gt;Patch for &lt;tt&gt;master&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="16175706" author="mithun" created="Fri, 22 Sep 2017 00:21:02 +0000"  >&lt;p&gt;Submitting for tests.&lt;/p&gt;</comment>
                            <comment id="16176131" author="hiveqa" created="Fri, 22 Sep 2017 08:53:20 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12888406/HIVE-17576.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12888406/HIVE-17576.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 6 failed/errored test(s), 11051 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestAccumuloCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=231)
TestDummy - did not produce a TEST-*.xml file (likely timed out) (batchId=231)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[union_fast_stats] (batchId=156)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[spark_explainuser_1] (batchId=170)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=235)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query23] (batchId=235)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/6938/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/6938/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/6938/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/6938/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-6938/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-6938/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 6 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12888406 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="16176957" author="kshukla" created="Fri, 22 Sep 2017 19:14:09 +0000"  >&lt;blockquote&gt;&lt;p&gt;Looks like the ProgressHelper is only available in Tez 0.9.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;If this helps, the change was checked in all the way from 0.7.2 to 0.9 release.&lt;/p&gt;</comment>
                            <comment id="16177150" author="mithun" created="Fri, 22 Sep 2017 21:24:45 +0000"  >&lt;blockquote&gt;&lt;p&gt;the change was checked in all the way from 0.7.2 to 0.9 release.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Hmm... That&apos;s odd. Hive &lt;tt&gt;branch-2&lt;/tt&gt; depends on Tez 0.8.4, and didn&apos;t seemed to break compile on references to &lt;tt&gt;ProgressHelper&lt;/tt&gt;. I&apos;ll try again.&lt;/p&gt;</comment>
                            <comment id="16177454" author="mithun" created="Sat, 23 Sep 2017 03:04:08 +0000"  >&lt;p&gt;Perhaps we should be using this API via reflection. That way, the code in &lt;tt&gt;branch-2&lt;/tt&gt; will be identical to &lt;tt&gt;master&lt;/tt&gt;, and will work when Tez is bumped. I just tested this version.&lt;/p&gt;</comment>
                            <comment id="16177907" author="hiveqa" created="Sat, 23 Sep 2017 17:41:55 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12888631/HIVE-17576.2-branch-2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12888631/HIVE-17576.2-branch-2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 12 failed/errored test(s), 10612 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[comments] (batchId=35)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[explaindenpendencydiffengs] (batchId=38)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[llap_smb] (batchId=142)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[orc_ppd_basic] (batchId=139)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[columnstats_part_coltype] (batchId=156)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[join_acid_non_acid] (batchId=158)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[union_fast_stats] (batchId=153)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_if_expr] (batchId=144)
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[merge_negative_5] (batchId=88)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[explaindenpendencydiffengs] (batchId=115)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[vectorized_ptf] (batchId=125)
org.apache.hive.hcatalog.api.TestHCatClient.testTransportFailure (batchId=176)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/6962/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/6962/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/6962/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/6962/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-6962/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-6962/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 12 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12888631 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="16179481" author="mithun" created="Mon, 25 Sep 2017 18:12:57 +0000"  >&lt;p&gt;The test failures are unrelated. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=owen.omalley&quot; class=&quot;user-hover&quot; rel=&quot;owen.omalley&quot;&gt;owen.omalley&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;thejas&lt;/a&gt;, what might be the best version of this patch to go in? With or without reflection? (It is foreseeable that there might be deploys with outdated Tez versions that don&apos;t include the &lt;tt&gt;ProgressHelper&lt;/tt&gt; API.)&lt;/p&gt;</comment>
                            <comment id="16190054" author="owen.omalley" created="Tue, 3 Oct 2017 17:56:23 +0000"  >&lt;p&gt;It should look like the HadoopShims and use reflection to find out if the class is there. You probably should put the test in HadoopShims to be consistent with the rest of the features.&lt;/p&gt;</comment>
                            <comment id="16193858" author="mithun" created="Thu, 5 Oct 2017 22:40:22 +0000"  >&lt;p&gt;Hey, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=owen.omalley&quot; class=&quot;user-hover&quot; rel=&quot;owen.omalley&quot;&gt;owen.omalley&lt;/a&gt;. I&apos;m trying to move the &lt;tt&gt;ReflectiveProgressHelper&lt;/tt&gt; to the shims layer, as per your suggestion. It looks like I&apos;ll have to add a &lt;tt&gt;ProgressHelper&lt;/tt&gt; interface to &lt;tt&gt;HadoopShims&lt;/tt&gt;, and a &lt;tt&gt;ReflectiveProgressHelperImpl&lt;/tt&gt; in &lt;tt&gt;HadoopShimsSecure&lt;/tt&gt;. It&apos;s beginning to look a little convoluted, to go through a Shim, and then reflection, for this one call. Add to this the fact that we&apos;re mixing concerns by putting Tez stuff in &lt;tt&gt;HadoopShims&lt;/tt&gt;. &lt;/p&gt;

&lt;p&gt;Edit: We should also consider that the reflection will likely be changed to a direct call, once Hive &lt;tt&gt;branch-2x&lt;/tt&gt; is switched to a more current Tez version.&lt;/p&gt;

&lt;p&gt;I can post a patch to illustrate, but I&apos;m beginning to wonder if this is overkill. :/ &lt;/p&gt;</comment>
                            <comment id="16197381" author="mithun" created="Mon, 9 Oct 2017 17:47:39 +0000"  >&lt;p&gt;As per discussion with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=owen.omalley&quot; class=&quot;user-hover&quot; rel=&quot;owen.omalley&quot;&gt;owen.omalley&lt;/a&gt;, we&apos;ll leave the reflection-based solution in place for the moment. We&apos;ll revisit moving this utility to Shims if another Tez abstraction is required in the future.&lt;/p&gt;

&lt;p&gt;I&apos;ll commit this shortly.&lt;/p&gt;</comment>
                            <comment id="16197388" author="mithun" created="Mon, 9 Oct 2017 17:50:01 +0000"  >&lt;p&gt;Committed to &lt;tt&gt;master&lt;/tt&gt;, &lt;tt&gt;branch-2&lt;/tt&gt;, and &lt;tt&gt;branch-2.2&lt;/tt&gt;. Thanks for the reviews and advice, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=owen.omalley&quot; class=&quot;user-hover&quot; rel=&quot;owen.omalley&quot;&gt;owen.omalley&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="16485232" author="ashutoshc" created="Tue, 22 May 2018 23:15:02 +0000"  >&lt;p&gt;This jira is resolved and released with Hive 3.0 If you find an issue with it, please create a new jira.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12888406" name="HIVE-17576.1.patch" size="2471" author="mithun" created="Fri, 22 Sep 2017 00:20:36 +0000"/>
                            <attachment id="12888631" name="HIVE-17576.2-branch-2.patch" size="4282" author="mithun" created="Sat, 23 Sep 2017 03:24:34 +0000"/>
                            <attachment id="12888630" name="HIVE-17576.2.patch" size="4572" author="mithun" created="Sat, 23 Sep 2017 03:01:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 26 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3kdy7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>