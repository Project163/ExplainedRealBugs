<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:51:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-15626] beeline should not exit after canceling the query on ctrl-c</title>
                <link>https://issues.apache.org/jira/browse/HIVE-15626</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;I am seeing this in 1.2&lt;/p&gt;</description>
                <environment></environment>
        <key id="13034848">HIVE-15626</key>
            <summary>beeline should not exit after canceling the query on ctrl-c</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vihangk1">Vihang Karajgaonkar</assignee>
                                    <reporter username="sershe">Sergey Shelukhin</reporter>
                        <labels>
                    </labels>
                <created>Fri, 13 Jan 2017 23:19:44 +0000</created>
                <updated>Fri, 21 Jul 2017 18:36:06 +0000</updated>
                            <resolved>Wed, 8 Feb 2017 15:00:59 +0000</resolved>
                                    <version>1.2.1</version>
                                    <fixVersion>2.3.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15822562" author="vihangk1" created="Sat, 14 Jan 2017 00:26:03 +0000"  >&lt;p&gt;I can take a look at this &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15824557" author="sershe" created="Mon, 16 Jan 2017 20:26:42 +0000"  >&lt;p&gt;Assigned to you. Thanks for looking at it!&lt;/p&gt;</comment>
                            <comment id="15827218" author="vihangk1" created="Wed, 18 Jan 2017 01:38:27 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt; .. Can you give an example? I am seeing it happening in the master branch as well. Is this issue specific to 1.2.1 or master too? Do you know a branch where this is not happening?&lt;/p&gt;</comment>
                            <comment id="15854628" author="sershe" created="Mon, 6 Feb 2017 19:55:36 +0000"  >&lt;p&gt;Looks good to me. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuefuz&quot; class=&quot;user-hover&quot; rel=&quot;xuefuz&quot;&gt;xuefuz&lt;/a&gt; would you be the expert on beeline? Do you also want to take a look?&lt;/p&gt;</comment>
                            <comment id="15854648" author="vihangk1" created="Mon, 6 Feb 2017 20:03:59 +0000"  >&lt;p&gt;Adding &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ctang.ma&quot; class=&quot;user-hover&quot; rel=&quot;ctang.ma&quot;&gt;ctang.ma&lt;/a&gt; for the review as well since he recently worked on query cancelation on the Driver side.&lt;/p&gt;</comment>
                            <comment id="15854721" author="hiveqa" created="Mon, 6 Feb 2017 20:53:20 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12851228/HIVE-15626.01.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12851228/HIVE-15626.01.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 4 failed/errored test(s), 10227 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestDerbyConnector - did not produce a TEST-*.xml file (likely timed out) (batchId=235)
org.apache.hadoop.hive.cli.TestEncryptedHDFSCliDriver.testCliDriver[encryption_join_with_different_encryption_keys] (batchId=159)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_varchar_simple] (batchId=153)
org.apache.hadoop.hive.llap.daemon.impl.TestTaskExecutorService.testWaitQueuePreemption (batchId=277)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/3398/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/3398/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/3398/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/3398/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-3398/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-3398/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 4 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12851228 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15854745" author="ctang.ma" created="Mon, 6 Feb 2017 21:14:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vihangk1&quot; class=&quot;user-hover&quot; rel=&quot;vihangk1&quot;&gt;vihangk1&lt;/a&gt; When I worked on &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-14799&quot; title=&quot;Query operation are not thread safe during its cancellation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-14799&quot;&gt;&lt;del&gt;HIVE-14799&lt;/del&gt;&lt;/a&gt; and did manual beeline ctrl-c tests on Linux, I never had the problem in canceling a query running in HS2. The Beeline shutdown in response to Ctrl-C closes the socket, which could trigger the event handler of HS2 ThriftServer to close the session, therefore canceling/closing all queries run on this session when hive.server2.close.session.on.disconnect is enabled.&lt;br/&gt;
The stmt.cancel() in the patch can ensure that the query is cancelled under some circumstances, though the query might have already been or anyway will be cancelled through the session closing. Have you been able to reproduce the issue reported here? &lt;/p&gt;</comment>
                            <comment id="15854755" author="sershe" created="Mon, 6 Feb 2017 21:18:17 +0000"  >&lt;p&gt;The CLI behavior used to be to cancel the query and NOT exit the CLI until the 2nd ctrl-c. I was wondering if as part of making beeline CLI-compatible before removing CLI, we could preserve this useful behavior. Esp. since connecting with beeline after it exits often involves extra steps compared to CLI, so it&apos;s a pain.&lt;/p&gt;</comment>
                            <comment id="15854810" author="ctang.ma" created="Mon, 6 Feb 2017 21:45:05 +0000"  >&lt;p&gt;I see, thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt; for the clarification.&lt;/p&gt;</comment>
                            <comment id="15854831" author="vihangk1" created="Mon, 6 Feb 2017 22:04:49 +0000"  >&lt;p&gt;I think the addition to beeline behavior with the patch is it doesn&apos;t exit the shell only since it was already cancelling the query as an effect of closing of the socket. &lt;/p&gt;

&lt;p&gt;I did this manual test before and after the patch&lt;/p&gt;

&lt;p&gt;Before: Ctrl+c exits the shell (it also cancels the query if you look into the HS2 logs)&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;0: jdbc:hive2://vihang-mbp.local:10000/defaul&amp;gt; select * from likes join names on likes.id = names.id;
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
vihang-MBP:bin vihang$
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;0: jdbc:hive2://vihang-mbp.local:10000/defaul&amp;gt; select * from likes join names on likes.id = names.id;
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Interrupting... Please be patient this may take some time.
Error: Query was cancelled (state=01000,code=0)
0: jdbc:hive2://vihang-mbp.local:10000/defaul&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15854890" author="ctang.ma" created="Mon, 6 Feb 2017 22:44:20 +0000"  >&lt;p&gt;Patch looks good, +1.&lt;/p&gt;</comment>
                            <comment id="15854957" author="vihangk1" created="Mon, 6 Feb 2017 23:27:30 +0000"  >&lt;p&gt;Thanks for the review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ctang.ma&quot; class=&quot;user-hover&quot; rel=&quot;ctang.ma&quot;&gt;ctang.ma&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15858087" author="ctang.ma" created="Wed, 8 Feb 2017 14:54:08 +0000"  >&lt;p&gt;Updated the subject.&lt;/p&gt;</comment>
                            <comment id="15858095" author="ctang.ma" created="Wed, 8 Feb 2017 15:00:59 +0000"  >&lt;p&gt;Committed to 2.2.0. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vihangk1&quot; class=&quot;user-hover&quot; rel=&quot;vihangk1&quot;&gt;vihangk1&lt;/a&gt; for the patch.&lt;/p&gt;</comment>
                            <comment id="15858301" author="vihangk1" created="Wed, 8 Feb 2017 17:47:32 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ctang.ma&quot; class=&quot;user-hover&quot; rel=&quot;ctang.ma&quot;&gt;ctang.ma&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt; for the review. Does this need to be committed in 1.2 branch as well?&lt;/p&gt;</comment>
                            <comment id="15859187" author="lefty@hortonworks.com" created="Thu, 9 Feb 2017 08:06:26 +0000"  >&lt;p&gt;Should this change of behavior be documented in the wiki?&lt;/p&gt;</comment>
                            <comment id="15859755" author="vihangk1" created="Thu, 9 Feb 2017 16:33:19 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=leftylev&quot; class=&quot;user-hover&quot; rel=&quot;leftylev&quot;&gt;leftylev&lt;/a&gt; for reminding. Yes, I think this should be documented. I will update the wiki and post a comment here once done so that you can review.&lt;/p&gt;</comment>
                            <comment id="15860796" author="thejas" created="Fri, 10 Feb 2017 06:08:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vihangk1&quot; class=&quot;user-hover&quot; rel=&quot;vihangk1&quot;&gt;vihangk1&lt;/a&gt; Branch 1.2 is for maintenance releases of 1.2.x release, so it should be used only for critical bug fixes. Branch-1 is where improvements/features like this one would go, so that it can be part of a 1.3.0 release.&lt;br/&gt;
However, the state of unit tests in branch-1 seemed quite bad last I saw. I think that would need a cleanup before we can add patches there. Without that, its hard to say if new patches are breaking something.&lt;/p&gt;
</comment>
                            <comment id="15861635" author="vihangk1" created="Fri, 10 Feb 2017 18:24:48 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;thejas&lt;/a&gt; for the information. I am okay with this patch not being committed to branch-1. Sergey mentioned 1.2 when the JIRA was created and hence I thought of including this patch in branch-1. I agree, lets stabilize branch-1 first before adding new patches.&lt;/p&gt;</comment>
                            <comment id="15877166" author="vihangk1" created="Wed, 22 Feb 2017 01:00:09 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=leftylev&quot; class=&quot;user-hover&quot; rel=&quot;leftylev&quot;&gt;leftylev&lt;/a&gt; I updated the BeeLine wiki which documents this behavior &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/HiveServer2+Clients#HiveServer2Clients-Cancellingthequery&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/Hive/HiveServer2+Clients#HiveServer2Clients-Cancellingthequery&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Please let me know if you need any changes in the text. THanks!&lt;/p&gt;</comment>
                            <comment id="15944681" author="lefty@hortonworks.com" created="Tue, 28 Mar 2017 07:25:04 +0000"  >&lt;p&gt;Thanks for the doc, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vihangk1&quot; class=&quot;user-hover&quot; rel=&quot;vihangk1&quot;&gt;vihangk1&lt;/a&gt;.  I made a few minor edits, including changing the capitalization which breaks your link above.  Here&apos;s the new link:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/HiveServer2+Clients#HiveServer2Clients-CancellingtheQuery&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;HiveServer2 Clients &amp;#8211; Cancelling the Query &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12851228" name="HIVE-15626.01.patch" size="3821" author="vihangk1" created="Mon, 6 Feb 2017 19:27:25 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 34 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i38p6n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>