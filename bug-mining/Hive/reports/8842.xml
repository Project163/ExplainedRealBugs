<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:26:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-29009] Intermittent CI timeouts while running tests</title>
                <link>https://issues.apache.org/jira/browse/HIVE-29009</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Recently various CI runs in master and PRs are timing out while executing tests. The problem is intermittent but rather frequent. The first and last (at the time of logging this ticket) timeout failure in master are outlined below:&lt;/p&gt;

&lt;p&gt;First: &lt;a href=&quot;https://ci.hive.apache.org/job/hive-precommit/job/master/2532/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci.hive.apache.org/job/hive-precommit/job/master/2532/&lt;/a&gt;&lt;br/&gt;
Last: &lt;a href=&quot;https://ci.hive.apache.org/job/hive-precommit/job/master/2546/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci.hive.apache.org/job/hive-precommit/job/master/2546/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Unfortunately due to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-29008&quot; title=&quot;CI logs do not display information about test execution&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-29008&quot;&gt;&lt;del&gt;HIVE-29008&lt;/del&gt;&lt;/a&gt; the CI logs do not contain enough information to easily determine which test is hanging and if it is the same everytime.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13620778">HIVE-29009</key>
            <summary>Intermittent CI timeouts while running tests</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zabetak">Stamatis Zampetakis</assignee>
                                    <reporter username="zabetak">Stamatis Zampetakis</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 12 Jun 2025 15:07:08 +0000</created>
                <updated>Tue, 15 Jul 2025 07:07:08 +0000</updated>
                            <resolved>Tue, 15 Jul 2025 07:07:08 +0000</resolved>
                                                    <fixVersion>4.2.0</fixVersion>
                                    <component>Build Infrastructure</component>
                    <component>Testing Infrastructure</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17966265" author="zabetak" created="Thu, 12 Jun 2025 15:12:56 +0000"  >&lt;p&gt; The first occurrence of the problem coincides with a change that affects CI&#160;(&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-28968&quot; title=&quot;In CI use dedicated project-local .m2 directory for storing maven artifacts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-28968&quot;&gt;&lt;del&gt;HIVE-28968&lt;/del&gt;&lt;/a&gt;). However, I don&apos;t see how the particular commit could have caused the problem and I believe it is an unlucky coincidence.&#160;&lt;/p&gt;</comment>
                            <comment id="17966266" author="zabetak" created="Thu, 12 Jun 2025 15:17:38 +0000"  >&lt;p&gt;I downloaded the build artifacts from the first occurrence of the problem (&lt;a href=&quot;https://ci.hive.apache.org/job/hive-precommit/job/master/2532/artifact/test-results.tgz&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci.hive.apache.org/job/hive-precommit/job/master/2532/artifact/test-results.tgz&lt;/a&gt;) and checked the surefire-reports for split-20, which is the spit that hang. Tests are definitely running but as explained under &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-29008&quot; title=&quot;CI logs do not display information about test execution&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-29008&quot;&gt;&lt;del&gt;HIVE-29008&lt;/del&gt;&lt;/a&gt; we don&apos;t see this information in the CI console.&lt;/p&gt;</comment>
                            <comment id="17966268" author="zabetak" created="Thu, 12 Jun 2025 15:41:31 +0000"  >&lt;p&gt;The JVM dump file that is generated by Surefire for split-20 has some interesting information.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ head ./split-20/itests/hive-unit/target/surefire-reports/2025-05-27T12-13-51_509-jvmRun1.dump
# Created at 2025-05-27T17:05:56.345
Exiting self fork JVM. Received SHUTDOWN command from Maven shutdown hook.
Thread dump before exiting the process (154044@hive-precommit-master-2532-s662z-wcvmv-rj1tn):
&quot;shutdown-hook-0&quot; 
   java.lang.Thread.State: TIMED_WAITING
        at java.lang.Thread.sleep(Native Method)
        at org.apache.hive.service.server.HiveServer2.graceful_stop(HiveServer2.java:1045)
        at org.apache.hive.service.server.HiveServer2.lambda$init$2(HiveServer2.java:459)
        at org.apache.hive.service.server.HiveServer2$$Lambda$288/1106392217.run(Unknown Source)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Basically, we can see that when the JVM was stopped the split was running the TestHS2SessionHive.testSessionHive test case.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ grep &apos;&quot;main&quot;&apos; -A 20  ./split-20/itests/hive-unit/target/surefire-reports/2025-05-27T12-13-51_509-jvmRun1.dump
&quot;main&quot; 
   java.lang.Thread.State: WAITING
        at java.lang.Object.wait(Native Method)
        at java.lang.Object.wait(Object.java:502)
        at org.apache.hive.service.server.TestHS2SessionHive.testSessionHive(TestHS2SessionHive.java:102)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
        at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In 2546, the test that was running in split-13 before the timeout was TestHttpSamlAuthentication.testGroupNameFiltering2 so it is not necessarily a specific test causing the failure but possibly something else. We may need to collect more datapoints and stacktraces from other failing CI runs.&lt;/p&gt;</comment>
                            <comment id="17966273" author="abstractdog" created="Thu, 12 Jun 2025 16:20:06 +0000"  >&lt;p&gt;thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zratkai&quot; class=&quot;user-hover&quot; rel=&quot;zratkai&quot;&gt;zratkai&lt;/a&gt; for the headsup and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zabetak&quot; class=&quot;user-hover&quot; rel=&quot;zabetak&quot;&gt;zabetak&lt;/a&gt; for the jira!&lt;/p&gt;

&lt;p&gt;I created 2 consecutive jstacks of a surefire process for later reference (I checked a hanging PR)&lt;br/&gt;
 &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13076974/13076974_jstack.txt&quot; title=&quot;jstack.txt attached to HIVE-29009&quot;&gt;jstack.txt&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;   &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13076975/13076975_jstack2.txt&quot; title=&quot;jstack2.txt attached to HIVE-29009&quot;&gt;jstack2.txt&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;/p&gt;

&lt;p&gt;analyzing soon&lt;/p&gt;

&lt;p&gt;found the same stack in another hanging POD&lt;br/&gt;
definitely this is the one that hangs while creating a container:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
	at org.apache.hive.service.auth.saml.TestHttpSamlAuthentication.setupIDP(TestHttpSamlAuthentication.java:178)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; #1 prio=5 os_prio=0 cpu=10515.69ms elapsed=14800.79s tid=0x00007e17fc026fe0 nid=0x2452 waiting on condition  [0x00007e180171e000]
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: WAITING (parking)
	at jdk.internal.misc.Unsafe.park(java.base@17.0.9/Native Method)
	- parking to wait &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;  &amp;lt;0x0000000088200000&amp;gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync)
	at java.util.concurrent.locks.LockSupport.park(java.base@17.0.9/LockSupport.java:211)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(java.base@17.0.9/AbstractQueuedSynchronizer.java:715)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(java.base@17.0.9/AbstractQueuedSynchronizer.java:938)
	at java.util.concurrent.locks.ReentrantLock$Sync.lock(java.base@17.0.9/ReentrantLock.java:153)
	at java.util.concurrent.locks.ReentrantLock.lock(java.base@17.0.9/ReentrantLock.java:322)
	at sun.security.ssl.SSLSocketImpl$AppInputStream.read(java.base@17.0.9/SSLSocketImpl.java:1042)
	at org.testcontainers.shaded.okio.Okio$2.read(Okio.java:140)
	at org.testcontainers.shaded.okio.AsyncTimeout$2.read(AsyncTimeout.java:237)
	at org.testcontainers.shaded.okio.RealBufferedSource.indexOf(RealBufferedSource.java:358)
	at org.testcontainers.shaded.okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.java:230)
	at org.testcontainers.shaded.okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.java:224)
	at org.testcontainers.shaded.okhttp3.internal.http1.Http1ExchangeCodec$ChunkedSource.readChunkSize(Http1ExchangeCodec.java:489)
	at org.testcontainers.shaded.okhttp3.internal.http1.Http1ExchangeCodec$ChunkedSource.read(Http1ExchangeCodec.java:471)
	at org.testcontainers.shaded.okhttp3.internal.Util.skipAll(Util.java:204)
	at org.testcontainers.shaded.okhttp3.internal.Util.discard(Util.java:186)
	at org.testcontainers.shaded.okhttp3.internal.http1.Http1ExchangeCodec$ChunkedSource.close(Http1ExchangeCodec.java:511)
	at org.testcontainers.shaded.okio.ForwardingSource.close(ForwardingSource.java:43)
	at org.testcontainers.shaded.okhttp3.internal.connection.Exchange$ResponseBodySource.close(Exchange.java:313)
	at org.testcontainers.shaded.okio.RealBufferedSource.close(RealBufferedSource.java:476)
	at org.testcontainers.shaded.okhttp3.internal.Util.closeQuietly(Util.java:139)
	at org.testcontainers.shaded.okhttp3.ResponseBody.close(ResponseBody.java:192)
	at org.testcontainers.shaded.okhttp3.Response.close(Response.java:290)
	at org.testcontainers.shaded.com.github.dockerjava.okhttp.OkDockerHttpClient$OkResponse.close(OkDockerHttpClient.java:285)
	at org.testcontainers.shaded.com.github.dockerjava.core.DefaultInvocationBuilder.lambda$&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;$0(DefaultInvocationBuilder.java:272)
	at org.testcontainers.shaded.com.github.dockerjava.core.DefaultInvocationBuilder$$Lambda$508/0x0000000100c15750.close(Unknown Source)
	at com.github.dockerjava.api.async.ResultCallbackTemplate.close(ResultCallbackTemplate.java:77)
	at org.testcontainers.utility.ResourceReaper.start(ResourceReaper.java:205)
	at org.testcontainers.DockerClientFactory.client(DockerClientFactory.java:205)
	- locked &amp;lt;0x0000000088202cf8&amp;gt; (a [Ljava.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;)
	at org.testcontainers.LazyDockerClient.getDockerClient(LazyDockerClient.java:14)
	at org.testcontainers.LazyDockerClient.authConfig(LazyDockerClient.java:12)
	at org.testcontainers.containers.GenericContainer.start(GenericContainer.java:310)
	at org.apache.hive.service.auth.saml.TestHttpSamlAuthentication.setupIDP(TestHttpSamlAuthentication.java:178)
	at org.apache.hive.service.auth.saml.TestHttpSamlAuthentication.testGroupNameFiltering2(TestHttpSamlAuthentication.java:490)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;pulling the image from the test container is successful:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
jenkins@hive-precommit-pr-5846-8-7kcn4-kk8j8-09sbl:~$ docker pull vihangk1/docker-test-saml-idp
Using &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; tag: latest
latest: Pulling from vihangk1/docker-test-saml-idp
000eee12ec04: Pull complete
8ae4f9fcfeea: Pull complete
60f22fbbd07a: Pull complete
ccc7a63ad75f: Pull complete
a2427b8dd6e7: Pull complete
91cac3b30184: Pull complete
d6e40015fc10: Pull complete
54695fdb10a7: Pull complete
500ca11be45f: Pull complete
86b2805859cf: Pull complete
c61685fa4f4f: Pull complete
0bf989f9dbbb: Pull complete
01848ea209b5: Pull complete
39c7bca1ade4: Pull complete
86b21261d0f9: Pull complete
c7c15aaefb4f: Pull complete
97bb9720c19d: Pull complete
4167b21c4b10: Pull complete
72c3c76084bc: Pull complete
5cb6a996b51f: Pull complete
369cd8a9d59b: Pull complete
2a0b5c2345a5: Pull complete
105aeb2326c3: Pull complete
67b31997154f: Pull complete
6b4de3e17eff: Pull complete
1758f12ba411: Pull complete
Digest: sha256:25309538648518dce92b423944a02b60254baf313880a192063cedfd23a7a668
Status: Downloaded newer image &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; vihangk1/docker-test-saml-idp:latest
docker.io/vihangk1/docker-test-saml-idp:latest
jenkins@hive-precommit-pr-5846-8-7kcn4-kk8j8-09sbl:~$
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;java version for reference:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
jenkins@hive-precommit-pr-5846-8-7kcn4-kk8j8-09sbl:~$ java --version
openjdk 17.0.9 2023-10-17 LTS
OpenJDK &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Environment Zulu17.46+19-CA (build 17.0.9+8-LTS)
OpenJDK 64-Bit Server VM Zulu17.46+19-CA (build 17.0.9+8-LTS, mixed mode, sharing)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17966282" author="zabetak" created="Thu, 12 Jun 2025 17:29:58 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abstractdog&quot; class=&quot;user-hover&quot; rel=&quot;abstractdog&quot;&gt;abstractdog&lt;/a&gt; for taking a look and the stack traces. I guess when the run finishes we will find the same stack trace in Surefire&apos;s jvmRun1.dump file. I&apos;ve seen the same stacktrace from TestHttpSamlAuthentication.testGroupNameFiltering2 in the jvmRun1.dump of &lt;a href=&quot;https://ci.hive.apache.org/job/hive-precommit/job/master/2546/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci.hive.apache.org/job/hive-precommit/job/master/2546/&lt;/a&gt; run.&lt;/p&gt;

&lt;p&gt;Judging from the stacktrace it may affect every test that is relying on testcontainers (org.testcontainers.containers.GenericContainer).&lt;/p&gt;</comment>
                            <comment id="17966283" author="zabetak" created="Thu, 12 Jun 2025 17:40:24 +0000"  >&lt;p&gt;There are various reports in testcontainers library about hangs due to various reasons. For instance: &lt;a href=&quot;https://github.com/testcontainers/testcontainers-java/issues/3531&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/testcontainers/testcontainers-java/issues/3531&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We could try also upgrading testcontainers to the latest available version to see if issues are resolved.&lt;/p&gt;</comment>
                            <comment id="17969147" author="zabetak" created="Fri, 13 Jun 2025 07:52:58 +0000"  >&lt;p&gt;I downloaded the test-results.tgz from all recent hive-precommit runs on master that hang:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ ls -1
master2532
master2537
master2538
master2546
master2549
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I was analyzing the stack trace from the &quot;main&quot; thread, which is showing the test under execution, and in 4 out of 5 hangs the reason is TestHttpSamlAuthentication. &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;for f in `find . -name &quot;*jvmRun*dump&quot;`; do echo $f; grep &quot;TestHttp&quot; $f; done | grep -B 1 &quot;Test&quot; 
./master2549/split-05/itests/hive-unit/target/surefire-reports/2025-06-12T08-57-48_325-jvmRun1.dump
        at app//org.apache.hive.service.auth.saml.TestHttpSamlAuthentication.setupIDP(TestHttpSamlAuthentication.java:178)
        at app//org.apache.hive.service.auth.saml.TestHttpSamlAuthentication.testGroupNameFiltering2(TestHttpSamlAuthentication.java:490)
--
./master2546/split-13/itests/hive-unit/target/surefire-reports/2025-06-08T09-11-48_480-jvmRun1.dump
        at app//org.apache.hive.service.auth.saml.TestHttpSamlAuthentication.setupIDP(TestHttpSamlAuthentication.java:178)
        at app//org.apache.hive.service.auth.saml.TestHttpSamlAuthentication.testGroupNameFiltering2(TestHttpSamlAuthentication.java:490)
--
./master2537/split-10/itests/hive-unit/target/surefire-reports/2025-05-30T20-03-11_523-jvmRun1.dump
        at app//org.apache.hive.service.auth.saml.TestHttpSamlAuthentication.setupIDP(TestHttpSamlAuthentication.java:178)
        at app//org.apache.hive.service.auth.saml.TestHttpSamlAuthentication.testGroupNameFiltering2(TestHttpSamlAuthentication.java:490)
--
./master2538/split-10/itests/hive-unit/target/surefire-reports/2025-06-01T06-01-31_167-jvmRun1.dump
        at app//org.apache.hive.service.auth.saml.TestHttpSamlAuthentication.setupIDP(TestHttpSamlAuthentication.java:178)
        at app//org.apache.hive.service.auth.saml.TestHttpSamlAuthentication.testGroupNameFiltering2(TestHttpSamlAuthentication.java:490)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Given that TestHttpSamlAuthentication is the main culprit that is causing the hang at the moment I will approve the PR-5861 that is disabling the test.&lt;/p&gt;</comment>
                            <comment id="18003525" author="zabetak" created="Mon, 7 Jul 2025 13:21:23 +0000"  >&lt;p&gt;I was able to reproduce the JVM hang completely outside Hive by using testcontainers 1.15.2, Docker-in-Docker setup with TLS enabled, and Oracle JDK 17.0.4.1. It turns out that we have been hitting a JDK bug, namely &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8315422&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JDK-8315422&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Full instructions to reproduce the problem and detailed root cause analysis can be found in the following links:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/testcontainers/testcontainers-java/issues/10454&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/testcontainers/testcontainers-java/issues/10454&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/zabetak/testcontainers-tls-hang-issue-10454&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/zabetak/testcontainers-tls-hang-issue-10454&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Since it is mainly a JDK bug it seems that issue was triggered by the upgrade to JDK 17 (&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-26473&quot; title=&quot;Upgrade to Java17&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-26473&quot;&gt;&lt;del&gt;HIVE-26473&lt;/del&gt;&lt;/a&gt;). However, very recently the project and the CI have moved to JDK 21 (&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-29027&quot; title=&quot;Move to JDK-21&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-29027&quot;&gt;&lt;del&gt;HIVE-29027&lt;/del&gt;&lt;/a&gt;). The docker image that is used to run the tests in CI (&lt;a href=&quot;https://hub.docker.com/r/ayushtkn/hive-dev-box&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hub.docker.com/r/ayushtkn/hive-dev-box&lt;/a&gt;) is using  JDK 21.0.7+6-LTS.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;openjdk version &quot;21.0.7&quot; 2025-04-15 LTS
OpenJDK Runtime Environment Zulu21.42+19-CA (build 21.0.7+6-LTS)
OpenJDK 64-Bit Server VM Zulu21.42+19-CA (build 21.0.7+6-LTS, mixed mode, sharing)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;JDK-8315422 is fixed in JDK 21.0.5 so we can safely re-enable the TestHttpSamlAuthentication since the hang in SSLSocketImpl is resolved. &lt;/p&gt;

&lt;p&gt;I downloaded Zulu21.42+19-CA and confirmed that the repro scenario in &lt;a href=&quot;https://github.com/zabetak/testcontainers-tls-hang-issue-10454&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/zabetak/testcontainers-tls-hang-issue-10454&lt;/a&gt; always passes using this JDK.&lt;/p&gt;</comment>
                            <comment id="18003526" author="zhangbutao" created="Mon, 7 Jul 2025 13:32:22 +0000"  >&lt;p&gt;Good job &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zabetak&quot; class=&quot;user-hover&quot; rel=&quot;zabetak&quot;&gt;zabetak&lt;/a&gt;!&lt;br/&gt;
It seems that JDK 21 will bring many benefits.&lt;/p&gt;

&lt;p&gt;BTW, if users use jdk17 to submit hive job in branch-4.1, will they encounter the same issues that occurred in the CI?&lt;/p&gt;</comment>
                            <comment id="18003531" author="zabetak" created="Mon, 7 Jul 2025 13:43:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zhangbutao&quot; class=&quot;user-hover&quot; rel=&quot;zhangbutao&quot;&gt;zhangbutao&lt;/a&gt; TLS is not widely used in tests and we are not using testcontainers that often either so the chances of hitting the bug are rather small assuming that TestHttpSamlAuthentication remains disabled in branch-4.1. &lt;/p&gt;

&lt;p&gt;JDK-8315422 is also fixed in JDK 17.0.13 so if it ever happens that we hit the bug in branch-4.1 we could also bump the CI to a more recent JDK 17 version as well.&lt;/p&gt;</comment>
                            <comment id="18003542" author="zhangbutao" created="Mon, 7 Jul 2025 14:20:49 +0000"  >&lt;p&gt;JDK 17.0.13 is good! We can also encourage hive users to use latest jdk 17 version in branch-4.1 to avoid similar issues.&lt;/p&gt;</comment>
                            <comment id="18005517" author="zabetak" created="Tue, 15 Jul 2025 07:07:08 +0000"  >&lt;p&gt;Fixed in &lt;a href=&quot;https://github.com/apache/hive/commit/a77ada1eed1c5362450ccfc1c2215249af74541a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/commit/a77ada1eed1c5362450ccfc1c2215249af74541a&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13476917">HIVE-26473</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13618988">HIVE-28968</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13620776">HIVE-29008</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                            <outwardlinks description="requires">
                                        <issuelink>
            <issuekey id="13621227">HIVE-29027</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13076974" name="jstack.txt" size="53909" author="abstractdog" created="Thu, 12 Jun 2025 16:18:57 +0000"/>
                            <attachment id="13076975" name="jstack2.txt" size="53910" author="abstractdog" created="Thu, 12 Jun 2025 16:20:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1wb48:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>