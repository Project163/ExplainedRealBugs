<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:26:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-28962] Prevent committing outputs if an exception was thrown in the Tez processor</title>
                <link>https://issues.apache.org/jira/browse/HIVE-28962</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Communication failure between coordinator and executor led to a task kill (06:04:18.328Z)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
app=query-coordinator-0/2025-05-16-06-00_query-coordinator_query-coordinator-0-7_638e93f4-c948-4fc0-ad05-1451fc4b7c53_0.log:&amp;lt;14&amp;gt;1 2025-05-16T06:04:18.328Z query-coordinator-0-7 query-coordinator 1 638e93f4-c948-4fc0-ad05-1451fc4b7c53 [mdc@38374 class=&lt;span class=&quot;code-quote&quot;&gt;&quot;HistoryEventHandler.criticalEvents&quot;&lt;/span&gt; level=&lt;span class=&quot;code-quote&quot;&gt;&quot;INFO&quot;&lt;/span&gt; thread=&lt;span class=&quot;code-quote&quot;&gt;&quot;Dispatcher thread {Central}&quot;&lt;/span&gt;] [HISTORY][DAG:dag_1746256596566_0014_1634][Event:TASK_ATTEMPT_FINISHED]: vertexName=Reducer 3, taskAttemptId=attempt_1746256596566_0014_1634_07_000070_13, creationTime=1747375458134, allocationTime=1747375458277, startTime=1747375458294, finishTime=1747375458328, timeTaken=34, status=KILLED, errorEnum=NODE_FAILED, diagnostics=Node with same host and port but with &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; unique ID pinged, nodeHttpAddress=&amp;lt;&amp;gt;, counters=Counters: 1, org.apache.tez.common.counters.TaskCounter, TASK_DURATION_MILLIS=34
{code:java}
&#160;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;then, an InterruptedException was thrown by `ReduceRecordProcessor.init()` because of task attempt kill (06:04:27.442Z)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;11&amp;gt;1 2025-05-16T06:04:27.442Z query-executor-0-16 query-executor 1 71c82503-aeaa-4ca8-ad1c-c01db6df4f9d [mdc@38374 class=&lt;span class=&quot;code-quote&quot;&gt;&quot;tez.TezProcessor&quot;&lt;/span&gt; dagId=&lt;span class=&quot;code-quote&quot;&gt;&quot;dag_1746256596566_0014_1634&quot;&lt;/span&gt; fragmentId=&lt;span class=&quot;code-quote&quot;&gt;&quot;1746256596566_0014_1634_07_000070_13&quot;&lt;/span&gt; level=&lt;span class=&quot;code-quote&quot;&gt;&quot;ERROR&quot;&lt;/span&gt; queryId=&lt;span class=&quot;code-quote&quot;&gt;&quot;hive_20250516055906_b7f7cff1-fc84-44d2-a7c5-30bd9aa428c5&quot;&lt;/span&gt; thread=&lt;span class=&quot;code-quote&quot;&gt;&quot;TezTR-596566_14_1634_7_70_13&quot;&lt;/span&gt;] java.lang.InterruptedException\r at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2056)\r at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2090)\r at org.apache.tez.runtime.InputReadyTracker$InputReadyMonitor.awaitCondition(InputReadyTracker.java:147)\r at org.apache.tez.runtime.InputReadyTracker.waitForAllInputsReady(InputReadyTracker.java:107)\r at org.apache.tez.runtime.api.impl.TezProcessorContextImpl.waitForAllInputsReady(TezProcessorContextImpl.java:138)\r at org.apache.tez.runtime.api.impl.TezProcessorContextImpl.waitForAllInputsReady(TezProcessorContextImpl.java:133)\r at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.init(ReduceRecordProcessor.java:122)\r at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:296)\r at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:280)\r at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:374)\r at org.apache.tez.runtime.task.TaskRunner2Callable$1.run(TaskRunner2Callable.java:86)\r at org.apache.tez.runtime.task.TaskRunner2Callable$1.run(TaskRunner2Callable.java:72)\r at java.base/java.security.AccessController.doPrivileged(Native Method)\r at java.base/javax.security.auth.Subject.doAs(Subject.java:423)\r at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899)\r at org.apache.tez.runtime.task.TaskRunner2Callable.callInternal(TaskRunner2Callable.java:72)\r at org.apache.tez.runtime.task.TaskRunner2Callable.callInternal(TaskRunner2Callable.java:42)\r at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)\r at org.apache.hadoop.hive.llap.daemon.impl.StatsRecordingThreadPool$WrappedCallable.call(StatsRecordingThreadPool.java:118)\r at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\r at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:829)\r

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;however, it still allowed task to commit and created a commit manifest (06:04:27.442Z)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;
&amp;lt;14&amp;gt;1 2025-05-16T06:04:27.442Z query-executor-0-16 query-executor 1 71c82503-aeaa-4ca8-ad1c-c01db6df4f9d [mdc@38374 class=&lt;span class=&quot;code-quote&quot;&gt;&quot;hive.HiveIcebergOutputCommitter&quot;&lt;/span&gt; dagId=&lt;span class=&quot;code-quote&quot;&gt;&quot;dag_1746256596566_0014_1634&quot;&lt;/span&gt; fragmentId=&lt;span class=&quot;code-quote&quot;&gt;&quot;1746256596566_0014_1634_07_000070_13&quot;&lt;/span&gt; level=&lt;span class=&quot;code-quote&quot;&gt;&quot;INFO&quot;&lt;/span&gt; queryId=&lt;span class=&quot;code-quote&quot;&gt;&quot;hive_20250516055906_b7f7cff1-fc84-44d2-a7c5-30bd9aa428c5&quot;&lt;/span&gt; thread=&lt;span class=&quot;code-quote&quot;&gt;&quot;TezTR-596566_14_1634_7_70_13&quot;&lt;/span&gt;] Created Iceberg commitTask manifest file: [s3a:&lt;span class=&quot;code-comment&quot;&gt;//temp/hive_20250516055906_b7f7cff1-fc84-44d2-a7c5-30bd9aa428c5-job_17462565965667_0014/task-70.forCommit]\rFilesForCommit\{dataFiles=[], deleteFiles=[], replacedDataFiles=[], referencedDataFiles=[]}&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;that is a regression introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-24857&quot; title=&quot;Trigger Tez output commit after close operation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-24857&quot;&gt;&lt;del&gt;HIVE-24857&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13618809">HIVE-28962</key>
            <summary>Prevent committing outputs if an exception was thrown in the Tez processor</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkuzmenko">Denys Kuzmenko</assignee>
                                    <reporter username="dkuzmenko">Denys Kuzmenko</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 21 May 2025 17:12:51 +0000</created>
                <updated>Tue, 29 Jul 2025 14:51:47 +0000</updated>
                            <resolved>Tue, 27 May 2025 19:06:09 +0000</resolved>
                                                    <fixVersion>4.1.0</fixVersion>
                                    <component>Iceberg integration</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17954394" author="dkuzmenko" created="Tue, 27 May 2025 19:05:59 +0000"  >&lt;p&gt;Merged to master&lt;br/&gt;
Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=simhadri-g&quot; class=&quot;user-hover&quot; rel=&quot;simhadri-g&quot;&gt;simhadri-g&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abstractdog&quot; class=&quot;user-hover&quot; rel=&quot;abstractdog&quot;&gt;abstractdog&lt;/a&gt; for the review!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13362988">HIVE-24857</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            24 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1vyyw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>