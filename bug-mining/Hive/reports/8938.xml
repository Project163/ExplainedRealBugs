<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:27:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-29290] Wrong results when n-way join contains both anti and outer join</title>
                <link>https://issues.apache.org/jira/browse/HIVE-29290</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Enabling CBO and &quot;nway.joins&quot; returns wrong results.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;set hive.merge.nway.joins=true;&lt;br/&gt;
set hive.cbo.enable=true;&lt;/p&gt;

&lt;p&gt;create table taba(id string);&lt;br/&gt;
INSERT INTO TABLE taba VALUES (&apos;1&apos;),(&apos;2&apos;);&lt;br/&gt;
create table tabb(id string);&lt;br/&gt;
INSERT INTO TABLE tabb VALUES (&apos;1&apos;);&lt;br/&gt;
create table tabc(id string);&lt;br/&gt;
INSERT INTO TABLE tabc VALUES (&apos;1&apos;),(&apos;2&apos;),(&apos;2&apos;);&lt;/p&gt;

&lt;p&gt;//Full data&lt;br/&gt;
select * from taba A left outer join tabb B on (A.id = B.id) left outer join tabc C on (C.id = A.id);&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+-----+-------+-------+
| id &#160;| id_1 &#160;| id_2 &#160;|
+-----+-------+-------+
| 1 &#160; | 1 &#160; &#160; | 1 &#160; &#160; |
| 2 &#160; | NULL &#160;| 2 &#160; &#160; |
| 2 &#160; | NULL &#160;| 2 &#160; &#160; |
+-----+-------+-------+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;//ID is not null&lt;br/&gt;
select * from taba A left outer join chinna.tabb B on (A.id = B.id) left outer join chinna.tabc C on (C.id = A.id) where B.id is not null;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+-----+-------+-------+
| id &#160;| id_1 &#160;| id_2 &#160;|
+-----+-------+-------+
| 1 &#160; | 1 &#160; &#160; | 1 &#160; &#160; |
+-----+-------+-------+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;//ID is null&lt;br/&gt;
select * from taba A left outer join tabb B on (A.id = B.id) left outer join tabc C on (C.id = A.id) where B.id is null;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+-----+-------+-------+
| id &#160;| id_1 &#160;| id_2 &#160;|
+-----+-------+-------+
| 1 &#160; | NULL &#160;| 1 &#160; &#160; |
| 2 &#160; | NULL &#160;| 2 &#160; &#160; |
| 2 &#160; | NULL &#160;| 2 &#160; &#160; |
+-----+-------+-------+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In this case B.id is not null for id=1, Correct output is&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+-----+-------+-------+
| id &#160;| id_1 &#160;| id_2 &#160;|
+-----+-------+-------+
| 2 &#160; | NULL &#160;| 2 &#160; &#160; |
| 2 &#160; | NULL &#160;| 2 &#160; &#160; |
+-----+-------+-------+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13632540">HIVE-29290</key>
            <summary>Wrong results when n-way join contains both anti and outer join</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="krisztiankasa">Krisztian Kasa</assignee>
                                    <reporter username="chinnalalam">Chinna Rao Lalam</reporter>
                        <labels>
                            <label>correctness</label>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 27 Oct 2025 08:58:26 +0000</created>
                <updated>Wed, 12 Nov 2025 07:40:53 +0000</updated>
                            <resolved>Wed, 12 Nov 2025 05:44:23 +0000</resolved>
                                    <version>4.1.0</version>
                    <version>4.0.1</version>
                                    <fixVersion>4.3.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="18033344" author="dkuzmenko" created="Mon, 27 Oct 2025 22:12:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chinnalalam&quot; class=&quot;user-hover&quot; rel=&quot;chinnalalam&quot;&gt;chinnalalam&lt;/a&gt; please set the affected version&lt;/p&gt;</comment>
                            <comment id="18033772" author="JIRAUSER295901" created="Wed, 29 Oct 2025 09:02:51 +0000"  >&lt;p&gt;Haven&apos;t investigated enough but disabling anti-join is yielding expected result with the following set.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
set hive.merge.nway.joins=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;; 
set hive.auto.convert.anti.join=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="18033893" author="dkuzmenko" created="Wed, 29 Oct 2025 16:40:28 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thomas.rebele&quot; class=&quot;user-hover&quot; rel=&quot;thomas.rebele&quot;&gt;thomas.rebele&lt;/a&gt; , &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kkasa&quot; class=&quot;user-hover&quot; rel=&quot;kkasa&quot;&gt;kkasa&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="18034366" author="thomas.rebele" created="Fri, 31 Oct 2025 09:44:17 +0000"  >&lt;p&gt;I checked with the PR of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-29176&quot; title=&quot;Wrong result when HiveAntiJoin is replacing an IS NULL filter on a nullable column&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-29176&quot;&gt;HIVE-29176&lt;/a&gt;. I could reproduce it there as well, so it&apos;s a different problem.&lt;/p&gt;</comment>
                            <comment id="18036224" author="krisztiankasa" created="Fri, 7 Nov 2025 12:33:12 +0000"  >&lt;p&gt;CommonJoinOperator.java doesn&apos;t handle well Anti join in case of n way joins&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/hive/blob/d186aba1923477949d4cede508566f4c3fb5cceb/ql/src/java/org/apache/hadoop/hive/ql/exec/CommonJoinOperator.java#L975-L1010&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/blob/d186aba1923477949d4cede508566f4c3fb5cceb/ql/src/java/org/apache/hadoop/hive/ql/exec/CommonJoinOperator.java#L975-L1010&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In case of n way join the flag &lt;tt&gt;noOuterJoin&lt;/tt&gt; is &lt;tt&gt;false&lt;/tt&gt;. See the else branch of the if statement: it doesn&apos;t depend on the flag &lt;tt&gt;isRightOfAntiJoin&lt;/tt&gt; which indicates whether the current join input is a right side of an anti join.&lt;/p&gt;

&lt;p&gt;I submitted a draft patch to try to improve the operator.&lt;/p&gt;</comment>
                            <comment id="18037632" author="krisztiankasa" created="Wed, 12 Nov 2025 05:44:23 +0000"  >&lt;p&gt;Merged to master. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ngsg&quot; class=&quot;user-hover&quot; rel=&quot;ngsg&quot;&gt;ngsg&lt;/a&gt; for the review.&lt;/p&gt;</comment>
                            <comment id="18037654" author="dkuzmenko" created="Wed, 12 Nov 2025 07:34:44 +0000"  >&lt;p&gt;hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=krisztiankasa&quot; class=&quot;user-hover&quot; rel=&quot;krisztiankasa&quot;&gt;krisztiankasa&lt;/a&gt;, please cherry-pick to branch-4.2 or update the fixed version. thanks!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13627978">HIVE-29176</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 hours ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1ybcg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>