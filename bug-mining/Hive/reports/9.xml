<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 17:50:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-69] genMapRedTasks does not use the tree walker and uses implicit state which makes it difficult to enhance</title>
                <link>https://issues.apache.org/jira/browse/HIVE-69</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;In SemanticAnalyzer, genmapredtasks() does not use a tree walker. For map-side joins, the taskplan needs to be enhanced to be possibly&lt;br/&gt;
broken at MapSink also. Basically, the code is very difficult to enhance since there are implicit assumptions that reduce sink is the only&lt;br/&gt;
operator where the plan breaks.&lt;/p&gt;

&lt;p&gt;This should be enhanced so that the user can implement their own task generation logic which is independent of the tree walking.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12408753">HIVE-69</key>
            <summary>genMapRedTasks does not use the tree walker and uses implicit state which makes it difficult to enhance</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="namit">Namit Jain</assignee>
                                    <reporter username="namit">Namit Jain</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 Nov 2008 18:38:49 +0000</created>
                <updated>Sat, 17 Dec 2011 00:08:27 +0000</updated>
                            <resolved>Wed, 3 Dec 2008 02:43:56 +0000</resolved>
                                                    <fixVersion>0.3.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12648792" author="athusoo" created="Tue, 18 Nov 2008 22:59:34 +0000"  >&lt;p&gt;General comment - need a lot of javadocs and documentation of how the state machine works. I think it works correctly but lets document as I have indicated below.&lt;/p&gt;

&lt;p&gt;Also the state should not be maintained in the plan but should be in the treewalker. The state is never really used in the execution time and we should only try to put things that are used in the execution time in the plan.&lt;/p&gt;

&lt;p&gt;Otherwise, this looks much cleaner than the pervious monolithic blob that we had. Thanks...&lt;br/&gt;
Inline Comments&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/exec/TableScanOperator.java:32	Is this just a place holder right now?&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/exec/Task.java:112	Lets add proper javadocs!!&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/exec/Task.java:132	javadocs. What is this used for?&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/parse/GenMapRedTaskProcessor.java:57	Move the new into the constructor?&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/parse/GenMapRedTaskProcessor.java:1	javadocs needed.&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/parse/GenMapRedTaskProcessor.java:117	Please put a comment on how this state machine works. What are the transitions, how the transitions are made and what are the actions taken by each transition.&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/plan/mapredWork.java:28	This is purely compile time information that is used to generate the plan (cut the plan into multiple map reduce plans), so we should not be storing this in the plan. This seems to be specific to the GenMapRedPlanWalker, so I think we should be maintaining this state there in a hashmap.&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java:2986	Looks much cleaner with the walker stuff... This is cool...&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/parse/GenMapRedWalker.java:44	I thought we were going to move this logic into the dispatcher? no?&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/parse/GenMapRedTaskProcessor.java:116	Also a description of the call stack that leads to there transitions would be very helpful.&lt;/p&gt;</comment>
                            <comment id="12648800" author="rsm" created="Tue, 18 Nov 2008 23:11:09 +0000"  >&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/parse/GenMapRedTaskProcessor.java:128 As we discussed, this switch statement can be replaced with a more scalable framework for rules. You would then have a tree pattern matcher (actually just a path matcher initially) and a lookup for the associated transformer. With this switch statement code structure, adding a new rule would either mean writing a new visitor (duplicated code) or adding more cases to this switch statement (resulting in huge functions).&lt;/p&gt;</comment>
                            <comment id="12652181" author="namit" created="Mon, 1 Dec 2008 22:10:46 +0000"  >
&lt;p&gt;The following query will not work:&lt;/p&gt;

&lt;p&gt;select count(1) FROM ( select a.x as x from x  UNION  ALL  select b.x as x from b ) out;&lt;/p&gt;

&lt;p&gt;Union followed by reduce sink will not work  - since we have already made the child of reduce sink null.&lt;/p&gt;

&lt;p&gt;It can be easily fixed in the new framework since tree walking/splitting etc. are independent&lt;/p&gt;



</comment>
                            <comment id="12652248" author="athusoo" created="Tue, 2 Dec 2008 02:54:57 +0000"  >&lt;p&gt;Namit,&lt;/p&gt;

&lt;p&gt;Can you upload the patch here. The following are my comments on the latest patch &lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;some minor issues are indicated below. Lets create separate JIRAs to address those...&lt;/p&gt;

&lt;p&gt;mostly minor comments.&lt;br/&gt;
Inline Comments&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java:169	should add @Override here.&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/exec/TableScanOperator.java:51	nitpick - start with a capital letter.&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/exec/Task.java:112	nitpick - please fix the comment here.&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/parse/DefaultDispatcher.java:26	imported twice?&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/parse/DefaultOpGraphWalker.java:69	should stack be parametrized here?&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/parse/RuleRegExp.java:34	javadocs for all of these...&lt;br/&gt;
hadoop/hive/ql/parse/SemanticAnalyzer.java:2999	These can be packaged into ParseContext.&lt;br/&gt;
hadoop/hive/ql/parse/OperatorProcessor.java:52	Since all the process calls are being made using reflection, we can get rid of all the process functions.&lt;br/&gt;
hadoop/hive/ql/parse/OperatorProcessor.java:40	This can be made an interface instead of a class.&lt;br/&gt;
hadoop/hive/ql/parse/SemanticAnalyzer.java:3035	Ideally this could also be done through a second pass walker, or it could be done in the same walker as above?&lt;br/&gt;
hadoop/hive/ql/parse/RuleRegExp.java:39	Some description would help.&lt;br/&gt;
hadoop/hive/ql/parse/DefaultDispatcher.java:26	double inclusion!!&lt;br/&gt;
hadoop/hive/ql/parse/DefaultDispatcher.java:63	probably this can just be OperatorProcessorContext.class instead of taking the class name and then getting the class out of it.&lt;br/&gt;
hadoop/hive/ql/parse/DefaultRuleDispatcher.java:40	javadocs for each of these variables.&lt;br/&gt;
hadoop/hive/ql/optimizer/GenMRFileSink1.java:37	javadocs&lt;br/&gt;
hadoop/hive/ql/optimizer/GenMRFileSink1.java:68	Why is there a mapping from null to currTask.&lt;br/&gt;
hadoop/hive/ql/optimizer/GenMRFileSink1.java:62	Can you explain what is being done here. In the original SemanticAnalyzer, we were just setting up the dependency from the MR task to move task when we saw the FileSinkOperator. What is the rest of the logic for?&lt;/p&gt;</comment>
                            <comment id="12652644" author="namit" created="Wed, 3 Dec 2008 01:27:08 +0000"  >
&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; compare to    =234  firstString^AsecondString firstKey^D1^AsecondKey^D2&amp;gt;&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; o class = class java.util.ArrayList&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; o size = 3&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; o&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; class = class java.lang.Integer&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; o&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; class = class java.util.ArrayList&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; o&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; class = class java.util.HashMap&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; o = [234, &lt;span class=&quot;error&quot;&gt;&amp;#91;firstString, secondString&amp;#93;&lt;/span&gt;, &lt;/p&gt;
{firstKey=1, secondKey=2}]&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; bytes in text =234  firstString^AsecondString firstKey^D1^AsecondKey^D2&amp;gt;&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; compare to    =234  firstString^AsecondString firstKey^D1^AsecondKey^D2&amp;gt;&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; o class = class java.util.ArrayList&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; o size = 3&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; o = [234, null, {firstKey=1, secondKey=2}
&lt;p&gt;]&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Tests run: 9, Failures: 0, Errors: 0, Time elapsed: 0.498 sec&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Running org.apache.hadoop.hive.serde2.objectinspector.TestObjectInspectorUtils&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.191 sec&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Running org.apache.hadoop.hive.serde2.objectinspector.TestReflectionObjectInspectors&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.172 sec&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Running org.apache.hadoop.hive.serde2.objectinspector.TestStandardObjectInspectors&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Tests run: 4, Failures: 0, Errors: 0, Time elapsed: 0.175 sec&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Running org.apache.hadoop.hive.serde2.objectinspector.TestThriftObjectInspectors&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.181 sec&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Running org.apache.hadoop.hive.serde2.objectinspector.TestUnionStructObjectInspector&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.165 sec&lt;/p&gt;

&lt;p&gt;BUILD SUCCESSFUL&lt;br/&gt;
Total time: 15 minutes 27 seconds&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;njain@dev119 trunk&amp;#93;&lt;/span&gt;$ pwd&lt;br/&gt;
/home/njain/workspace/hadoophive/trunk&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;njain@dev119 trunk&amp;#93;&lt;/span&gt;$ svn diff &amp;gt; /tmp/patch.txt&lt;/p&gt;


&lt;p&gt;The tests ran successfully&lt;/p&gt;</comment>
                            <comment id="12652656" author="zshao" created="Wed, 3 Dec 2008 02:43:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-69&quot; title=&quot;genMapRedTasks does not use the tree walker and uses implicit state which makes it difficult to enhance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-69&quot;&gt;&lt;del&gt;HIVE-69&lt;/del&gt;&lt;/a&gt;. genMapRedTasks uses tree walker. (Namit through zshao)&lt;/p&gt;</comment>
                            <comment id="12652657" author="zshao" created="Wed, 3 Dec 2008 02:44:15 +0000"  >&lt;p&gt;Committed revision 722723. Thanks Namit. &lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12395152" name="patch.txt" size="410369" author="namit" created="Wed, 3 Dec 2008 01:26:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73805</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l7nr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>121891</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>