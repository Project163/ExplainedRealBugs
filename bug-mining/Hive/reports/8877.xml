<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:27:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-29069] Query Failure while computing Range Partition Column stats on Numeric partition column types</title>
                <link>https://issues.apache.org/jira/browse/HIVE-29069</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Steps to reproduce:&lt;/p&gt;

&lt;p&gt;&#160;&lt;br/&gt;
drop table if exists store_sales;&lt;br/&gt;
create external table store_sales(ss_quantity int, ss_sales_price decimal(7,2)) partitioned by (ss_sold_date_sk bigint) stored as orc;&lt;br/&gt;
INSERT INTO store_sales VALUES ( 14, 46.16, 2451865),(14, 46.16,null);&lt;br/&gt;
&#160;&lt;br/&gt;
drop table if exists date_dim;&lt;br/&gt;
create external table date_dim(d_date_sk bigint,d_date date,d_year int) stored as orc;&lt;br/&gt;
INSERT INTO date_dim VALUES(2451865,&apos;2000-11-16&apos;,2000),(2451865, &apos;2000-11-16&apos;,2000),(2451865,&apos;2000-11-16&apos;,2000);&lt;/p&gt;

&lt;p&gt;&amp;#8211; reset hive.exec.default.partition.name&#160;&lt;br/&gt;
&lt;b&gt;set hive.exec.default.partition.name=abc;&lt;/b&gt;&lt;br/&gt;
&#160;&lt;br/&gt;
select d_date from store_sales,date_dim where ss_sold_date_sk = d_date_sk and d_year=2000 group by d_date;&lt;br/&gt;
&#160;&lt;br/&gt;
Issue:&lt;br/&gt;
1. In some cases, the testcase will fail&lt;br/&gt;
2. In some cases, it will fallback to NON-CBO Mode&lt;br/&gt;
&#160;&lt;br/&gt;
Exception stacktrace:&lt;br/&gt;
```&lt;br/&gt;
&#160;java.lang.NumberFormatException: For input string: &quot;&lt;em&gt;{&lt;/em&gt;}HIVE_DEFAULT_PARTITION{&lt;em&gt;}&lt;/em&gt;&quot;&lt;br/&gt;
at java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:67)&lt;br/&gt;
at java.base/java.lang.Long.parseLong(Long.java:711)&lt;br/&gt;
at java.base/java.lang.Long.parseLong(Long.java:836)&lt;br/&gt;
at org.apache.hadoop.hive.ql.stats.StatsUtils.getRangePartitionColumn(StatsUtils.java:638)&lt;br/&gt;
at org.apache.hadoop.hive.ql.stats.StatsUtils.getColStatsForPartCol(StatsUtils.java:608)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.RelOptHiveTable.updateColStats(RelOptHiveTable.java:644)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.RelOptHiveTable.getColStat(RelOptHiveTable.java:697)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveRelFieldTrimmer.fetchColStats(HiveRelFieldTrimmer.java:801)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveRelFieldTrimmer.trimFields(HiveRelFieldTrimmer.java:772)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveReflectUtil$VarArgsFunc4.apply(HiveReflectUtil.java:322)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveReflectUtil$HiveMethodDispatcher.invoke(HiveReflectUtil.java:221)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.RelFieldTrimmer.dispatchTrimFields(RelFieldTrimmer.java:286)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveRelFieldTrimmer.trimChild(HiveRelFieldTrimmer.java:203)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.RelFieldTrimmer.trimFields(RelFieldTrimmer.java:562)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveReflectUtil$VarArgsFunc4.apply(HiveReflectUtil.java:322)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveReflectUtil$HiveMethodDispatcher.invoke(HiveReflectUtil.java:221)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.RelFieldTrimmer.dispatchTrimFields(RelFieldTrimmer.java:286)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveRelFieldTrimmer.trimChild(HiveRelFieldTrimmer.java:203)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.RelFieldTrimmer.trimFields(RelFieldTrimmer.java:447)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveRelFieldTrimmer.trimFields(HiveRelFieldTrimmer.java:747)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveReflectUtil$VarArgsFunc4.apply(HiveReflectUtil.java:322)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveReflectUtil$HiveMethodDispatcher.invoke(HiveReflectUtil.java:221)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.RelFieldTrimmer.dispatchTrimFields(RelFieldTrimmer.java:286)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveRelFieldTrimmer.trimChild(HiveRelFieldTrimmer.java:203)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.RelFieldTrimmer.trimFields(RelFieldTrimmer.java:736)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveReflectUtil$VarArgsFunc4.apply(HiveReflectUtil.java:322)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveReflectUtil$HiveMethodDispatcher.invoke(HiveReflectUtil.java:221)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.RelFieldTrimmer.dispatchTrimFields(RelFieldTrimmer.java:286)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveRelFieldTrimmer.trimChild(HiveRelFieldTrimmer.java:203)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.RelFieldTrimmer.trimFields(RelFieldTrimmer.java:447)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveRelFieldTrimmer.trimFields(HiveRelFieldTrimmer.java:747)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveReflectUtil$VarArgsFunc4.apply(HiveReflectUtil.java:322)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveReflectUtil$HiveMethodDispatcher.invoke(HiveReflectUtil.java:221)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.RelFieldTrimmer.dispatchTrimFields(RelFieldTrimmer.java:286)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveRelFieldTrimmer.trimChild(HiveRelFieldTrimmer.java:203)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveRelFieldTrimmer.trimFields(HiveRelFieldTrimmer.java:624)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveReflectUtil$VarArgsFunc4.apply(HiveReflectUtil.java:322)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveReflectUtil$HiveMethodDispatcher.invoke(HiveReflectUtil.java:221)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.RelFieldTrimmer.dispatchTrimFields(RelFieldTrimmer.java:286)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveRelFieldTrimmer.trimChild(HiveRelFieldTrimmer.java:203)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.RelFieldTrimmer.trimFields(RelFieldTrimmer.java:447)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveRelFieldTrimmer.trimFields(HiveRelFieldTrimmer.java:747)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveReflectUtil$VarArgsFunc4.apply(HiveReflectUtil.java:322)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveReflectUtil$HiveMethodDispatcher.invoke(HiveReflectUtil.java:221)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.RelFieldTrimmer.dispatchTrimFields(RelFieldTrimmer.java:286)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.RelFieldTrimmer.trim(RelFieldTrimmer.java:170)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveRelFieldTrimmer.trim(HiveRelFieldTrimmer.java:164)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveRelFieldTrimmer.trim(HiveRelFieldTrimmer.java:154)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveFieldTrimmerRule.trim(HiveFieldTrimmerRule.java:66)&lt;br/&gt;
at org.apache.hadoop.hive.ql.optimizer.calcite.rules.HiveFieldTrimmerRule.onMatch(HiveFieldTrimmerRule.java:61)&lt;br/&gt;
at org.apache.calcite.plan.AbstractRelOptPlanner.fireRule(AbstractRelOptPlanner.java:337)&lt;br/&gt;
at org.apache.calcite.plan.hep.HepPlanner.applyRule(HepPlanner.java:556)&lt;br/&gt;
at org.apache.calcite.plan.hep.HepPlanner.applyRules(HepPlanner.java:420)&lt;br/&gt;
at org.apache.calcite.plan.hep.HepPlanner.executeRuleInstance(HepPlanner.java:243)&lt;br/&gt;
at org.apache.calcite.plan.hep.HepInstruction$RuleInstance$State.execute(HepInstruction.java:178)&lt;br/&gt;
at org.apache.calcite.plan.hep.HepPlanner.lambda$executeProgram$0(HepPlanner.java:211)&lt;br/&gt;
at org.apache.hive.com.google.common.collect.ImmutableList.forEach(ImmutableList.java:422)&lt;br/&gt;
at org.apache.calcite.plan.hep.HepPlanner.executeProgram(HepPlanner.java:210)&lt;br/&gt;
at org.apache.calcite.plan.hep.HepProgram$State.execute(HepProgram.java:118)&lt;br/&gt;
at org.apache.calcite.plan.hep.HepPlanner.executeProgram(HepPlanner.java:205)&lt;br/&gt;
at org.apache.calcite.plan.hep.HepPlanner.findBestExp(HepPlanner.java:191)&lt;br/&gt;
at org.apache.hadoop.hive.ql.parse.CalcitePlanner$CalcitePlannerAction.executeProgram(CalcitePlanner.java:2587)&lt;br/&gt;
at org.apache.hadoop.hive.ql.parse.CalcitePlanner$CalcitePlannerAction.executeProgram(CalcitePlanner.java:2547)&lt;br/&gt;
at org.apache.hadoop.hive.ql.parse.CalcitePlanner$CalcitePlannerAction.executeProgram(CalcitePlanner.java:2541)&lt;br/&gt;
at org.apache.hadoop.hive.ql.parse.CalcitePlanner$CalcitePlannerAction.applyPreJoinOrderingTransforms(CalcitePlanner.java:1995)&lt;br/&gt;
```&lt;/p&gt;</description>
                <environment></environment>
        <key id="13622589">HIVE-29069</key>
            <summary>Query Failure while computing Range Partition Column stats on Numeric partition column types</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="Indhumathi27">Indhumathi Muthumurugesh</assignee>
                                    <reporter username="Indhumathi27">Indhumathi Muthumurugesh</reporter>
                        <labels>
                            <label>hive-4.1.0-must</label>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 4 Jul 2025 18:14:26 +0000</created>
                <updated>Tue, 29 Jul 2025 14:51:58 +0000</updated>
                            <resolved>Sat, 12 Jul 2025 12:18:39 +0000</resolved>
                                    <version>4.0.1</version>
                                    <fixVersion>4.1.0</fixVersion>
                    <fixVersion>4.2.0</fixVersion>
                                    <component>Statistics</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="18004625" author="dkuzmenko" created="Fri, 11 Jul 2025 07:50:44 +0000"  >&lt;p&gt;Merged to master&lt;/p&gt;

&lt;p&gt;Thanks for the fix, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Indhumathi27&quot; class=&quot;user-hover&quot; rel=&quot;Indhumathi27&quot;&gt;Indhumathi27&lt;/a&gt; ! Could you please cherry-pick to branch-4.1&lt;/p&gt;</comment>
                            <comment id="18004859" author="zhangbutao" created="Sat, 12 Jul 2025 12:18:39 +0000"  >&lt;p&gt;Merged into master branch&amp;amp; branch-4.1.&lt;/p&gt;

&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Indhumathi27&quot; class=&quot;user-hover&quot; rel=&quot;Indhumathi27&quot;&gt;Indhumathi27&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dkuzmenko&quot; class=&quot;user-hover&quot; rel=&quot;dkuzmenko&quot;&gt;dkuzmenko&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1wmag:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>