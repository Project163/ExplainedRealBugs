<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:51:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-664] optimize UDF split</title>
                <link>https://issues.apache.org/jira/browse/HIVE-664</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Min Zhou added a comment - 21/Jul/09 07:34 AM&lt;br/&gt;
It&apos;s very useful for us .&lt;br/&gt;
some comments:&lt;/p&gt;

&lt;p&gt;   1. Can you implement it directly with Text ? Avoiding string decoding and encoding would be faster. Of course that trick may lead to another problem, as String.split uses a regular expression for splitting.&lt;br/&gt;
   2. getDisplayString() always return a string in lowercase.&lt;/p&gt;

&lt;p&gt;[ Show &#187; ]&lt;br/&gt;
Min Zhou added a comment - 21/Jul/09 07:34 AM It&apos;s very useful for us . some comments:&lt;/p&gt;

&lt;p&gt;   1. Can you implement it directly with Text ? Avoiding string decoding and encoding would be faster. Of course that trick may lead to another problem, as String.split uses a regular expression for splitting.&lt;br/&gt;
   2. getDisplayString() always return a string in lowercase.&lt;/p&gt;


&lt;p&gt;[ Permlink | &#171; Hide ]&lt;br/&gt;
Namit Jain added a comment - 21/Jul/09 09:22 AM&lt;br/&gt;
Committed. Thanks Emil&lt;br/&gt;
[ Show &#187; ]&lt;br/&gt;
Namit Jain added a comment - 21/Jul/09 09:22 AM Committed. Thanks Emil&lt;/p&gt;

&lt;p&gt;[ Permlink | &#171; Hide ]&lt;br/&gt;
Emil Ibrishimov added a comment - 21/Jul/09 10:48 AM&lt;br/&gt;
There are some easy (compromise) ways to optimize split:&lt;/p&gt;

&lt;p&gt;1. Check if the regex argument actually contains some &quot;regex specific characters&quot; and if it doesn&apos;t, do a straightforward split without converting to strings.&lt;br/&gt;
2. Assume some default value for the second argument (for example - split(str) to be equivalent to split(str, &apos; &apos;) and optimize for this value&lt;br/&gt;
3. Have two separate split functions - one that does regex and one that splits around plain text.&lt;/p&gt;

&lt;p&gt;I think that 1 is a good choice and can be done rather quickly.&lt;br/&gt;
[ Show &#187; ]&lt;br/&gt;
Emil Ibrishimov added a comment - 21/Jul/09 10:48 AM There are some easy (compromise) ways to optimize split: 1. Check if the regex argument actually contains some &quot;regex specific characters&quot; and if it doesn&apos;t, do a straightforward split without converting to strings. 2. Assume some default value for the second argument (for example - split(str) to be equivalent to split(str, &apos; &apos;) and optimize for this value 3. Have two separate split functions - one that does regex and one that splits around plain text. I think that 1 is a good choice and can be done rather quickly.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12431055">HIVE-664</key>
            <summary>optimize UDF split</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="teddy.choi">Teddy Choi</assignee>
                                    <reporter username="namit">Namit Jain</reporter>
                        <labels>
                            <label>optimization</label>
                    </labels>
                <created>Tue, 21 Jul 2009 17:55:25 +0000</created>
                <updated>Fri, 21 Jul 2017 18:46:00 +0000</updated>
                            <resolved>Mon, 6 Feb 2017 04:54:39 +0000</resolved>
                                                    <fixVersion>2.3.0</fixVersion>
                                    <component>UDF</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13745842" author="teddy.choi" created="Wed, 21 Aug 2013 07:21:51 +0000"  >&lt;p&gt;I implemented 1 and 3. Additionally, it caches a compiled Pattern object to reuse.&lt;/p&gt;</comment>
                            <comment id="13745844" author="teddy.choi" created="Wed, 21 Aug 2013 07:24:58 +0000"  >&lt;p&gt;Review request on &lt;a href=&quot;https://reviews.apache.org/r/13702/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/13702/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13774126" author="ashutoshc" created="Sun, 22 Sep 2013 23:49:42 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13774230" author="ashutoshc" created="Mon, 23 Sep 2013 01:12:14 +0000"  >&lt;p&gt;Test &lt;tt&gt;global_limit.q&lt;/tt&gt; failed.&lt;/p&gt;</comment>
                            <comment id="13792324" author="teddy.choi" created="Fri, 11 Oct 2013 04:30:15 +0000"  >&lt;p&gt;I wrote 2nd patch while assuming Text#getBytes returns entire valid bytes, but it was wrong. Text#getBytes returns valid bytes up to Text#getLength length. Following bytes are invalid. I fixed code to use Text#getLength to ensure data validity. This patch passes global_limit.q and udf_split.q tests.&lt;/p&gt;</comment>
                            <comment id="13792492" author="hiveqa" created="Fri, 11 Oct 2013 09:47:24 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12607946/HIVE-664.3.patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12607946/HIVE-664.3.patch.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 4392 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestNegativeMinimrCliDriver.testNegativeCliDriver_mapreduce_stack_trace_hadoop20
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/1105/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/1105/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/1105/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/1105/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests failed with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13793399" author="teddy.choi" created="Sat, 12 Oct 2013 16:26:37 +0000"  >&lt;p&gt;mapreduce_stack_trace_hadoop20.q passed on my computer. The test doesn&apos;t call split(), so it is not related with this patch.&lt;/p&gt;</comment>
                            <comment id="13877185" author="navis" created="Tue, 21 Jan 2014 04:42:31 +0000"  >&lt;p&gt;Ran a simple micro test on splitting only and found it&apos;s not faster significantly (max 15%?) than current implementation (even slower for sometimes). But reusing previous pattern string seemed good idea. Furthermore, if OI for regex is constant type, comparing itself can be ignored. Could you do that too?&lt;/p&gt;</comment>
                            <comment id="15853238" author="teddy.choi" created="Sun, 5 Feb 2017 14:32:00 +0000"  >&lt;p&gt;I applied &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;navis&lt;/a&gt;&apos;s feedback. Most of SPLIT calls would use a constant value for its regular expression. So I optimized SPLIT for this use case.&lt;/p&gt;</comment>
                            <comment id="15853254" author="hiveqa" created="Sun, 5 Feb 2017 15:41:06 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12851083/HIVE-664.4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12851083/HIVE-664.4.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 6 failed/errored test(s), 10226 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestDerbyConnector - did not produce a TEST-*.xml file (likely timed out) (batchId=235)
org.apache.hadoop.hive.cli.TestEncryptedHDFSCliDriver.testCliDriver[encryption_join_with_different_encryption_keys] (batchId=159)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_char_simple] (batchId=147)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_varchar_simple] (batchId=153)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=223)
org.apache.hadoop.hive.llap.daemon.impl.TestTaskExecutorService.testWaitQueuePreemption (batchId=277)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/3387/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/3387/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/3387/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/3387/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-3387/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-3387/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 6 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12851083 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15853313" author="ashutoshc" created="Sun, 5 Feb 2017 18:47:47 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="15853502" author="ashutoshc" created="Mon, 6 Feb 2017 04:54:39 +0000"  >&lt;p&gt;Pushed to master. Thanks Teddy!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12430613">HIVE-642</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12599134" name="HIVE-664.1.patch.txt" size="6576" author="teddy.choi" created="Wed, 21 Aug 2013 07:18:28 +0000"/>
                            <attachment id="12599136" name="HIVE-664.2.patch.txt" size="6580" author="teddy.choi" created="Wed, 21 Aug 2013 07:21:51 +0000"/>
                            <attachment id="12607946" name="HIVE-664.3.patch.txt" size="6550" author="teddy.choi" created="Fri, 11 Oct 2013 04:30:15 +0000"/>
                            <attachment id="12851083" name="HIVE-664.4.patch" size="2696" author="teddy.choi" created="Sun, 5 Feb 2017 14:32:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42770</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 41 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lb33:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122446</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>