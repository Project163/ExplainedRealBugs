<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 17:59:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-2532] Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2532</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Even if constant oi is returned, these may have stateful/side-effect behavior and hence need to be called each cycle.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12529282">HIVE-2532</key>
            <summary>Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jonchang">Jonathan Chang</assignee>
                                    <reporter username="jonchang">Jonathan Chang</reporter>
                        <labels>
                    </labels>
                <created>Fri, 28 Oct 2011 16:46:36 +0000</created>
                <updated>Thu, 2 Aug 2012 11:43:48 +0000</updated>
                            <resolved>Fri, 11 Nov 2011 19:49:19 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13138595" author="jonchang" created="Fri, 28 Oct 2011 18:01:02 +0000"  >&lt;p&gt;I have a patch but don&apos;t have a good testcase yet.  This might be a good time to add a side-effecting UDF.  Any suggestions?&lt;/p&gt;</comment>
                            <comment id="13138599" author="jonchang" created="Fri, 28 Oct 2011 18:03:34 +0000"  >&lt;p&gt;Ooo, how about a counter diff?&lt;/p&gt;</comment>
                            <comment id="13138628" author="jvs" created="Fri, 28 Oct 2011 18:43:36 +0000"  >&lt;p&gt;contrib/src/java/org/apache/hadoop/hive/contrib/udf/UDFRowSequence.java&lt;/p&gt;

&lt;p&gt;(I used this for the existing stateful test cases.)&lt;/p&gt;</comment>
                            <comment id="13139367" author="ikabiljo" created="Sat, 29 Oct 2011 17:06:12 +0000"  >&lt;p&gt;@John: UDFRowSequence should already work, problem is when UDF returns ConstantOI, but has side-effects.&lt;/p&gt;

&lt;p&gt;One (not very useful) pair of UDFs for this could be FB_LOCAL_PROPERTY_SET(key, value) and FB_LOCAL_PROPERTY_GET(key), where FB_LOCAL_PROPERTY_SET returns ConstVoidOI, but has side-effects&lt;/p&gt;</comment>
                            <comment id="13144874" author="phabricator@reviews.facebook.net" created="Sat, 5 Nov 2011 23:54:51 +0000"  >&lt;p&gt;jonchang requested code review of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2532&quot; title=&quot;Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2532&quot;&gt;&lt;del&gt;HIVE-2532&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2532&quot; title=&quot;Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2532&quot;&gt;&lt;del&gt;HIVE-2532&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Even if constant oi is returned, these may have stateful/side-effect behavior and hence need to be called each cycle.&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  EMPTY&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D273&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFAssertTrue.java&lt;br/&gt;
  ql/src/test/queries/clientnegative/udf_assert_true.q&lt;br/&gt;
  ql/src/test/results/clientnegative/udf_assert_true.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/show_functions.q.out&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/519/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/herald/transcript/519/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Tip: use the X-Herald-Rules header to filter Herald messages in your client.&lt;/p&gt;</comment>
                            <comment id="13144875" author="phabricator@reviews.facebook.net" created="Sun, 6 Nov 2011 00:10:51 +0000"  >&lt;p&gt;ikabiljo has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2532&quot; title=&quot;Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2532&quot;&gt;&lt;del&gt;HIVE-2532&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot;.&lt;/p&gt;

&lt;p&gt;  Java code looks good, not sure what are .q and .q.out files, so will leave to others to accept &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
  Just a small inline comment.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFAssertTrue.java:60-61 why don&apos;t convert to javaBooleanObjectInspector, usage is easier?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D273&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13144883" author="phabricator@reviews.facebook.net" created="Sun, 6 Nov 2011 01:34:51 +0000"  >&lt;p&gt;jonchang has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2532&quot; title=&quot;Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2532&quot;&gt;&lt;del&gt;HIVE-2532&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFAssertTrue.java:60-61 Boolean is not really much less difficult and someone once told me that the Writables are more efficient.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D273&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13146526" author="phabricator@reviews.facebook.net" created="Tue, 8 Nov 2011 20:13:51 +0000"  >&lt;p&gt;jsichi has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2532&quot; title=&quot;Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2532&quot;&gt;&lt;del&gt;HIVE-2532&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot;.&lt;/p&gt;

&lt;p&gt;  Try this:&lt;/p&gt;

&lt;p&gt;  SELECT 1+ASSERT_TRUE(x &amp;lt; 2) FROM src LATERAL VIEW EXPLODE(ARRAY(1, 2)) a AS x LIMIT 2;&lt;/p&gt;

&lt;p&gt;  I assume it should hit an exception, but it actually passes.  Guess why?&lt;/p&gt;



&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java:144 FunctionRegistry.isDeterministic always returns false for a stateful UDF, so you don&apos;t need to double-check here.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D273&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13146562" author="phabricator@reviews.facebook.net" created="Tue, 8 Nov 2011 20:55:51 +0000"  >&lt;p&gt;jonchang has planned changes to the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2532&quot; title=&quot;Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2532&quot;&gt;&lt;del&gt;HIVE-2532&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot;.&lt;/p&gt;

&lt;p&gt;  Ugh.  Will fix and add new unittest&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D273&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13147519" author="phabricator@reviews.facebook.net" created="Thu, 10 Nov 2011 06:51:51 +0000"  >&lt;p&gt;jonchang updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2532&quot; title=&quot;Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2532&quot;&gt;&lt;del&gt;HIVE-2532&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot;.&lt;br/&gt;
Reviewers: JIRA, jsichi&lt;/p&gt;

&lt;p&gt;  Make deterministic check recursive.  Add unittest to test for this case.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D273&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeEvaluator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFAssertTrue.java&lt;br/&gt;
  ql/src/test/queries/clientnegative/udf_assert_true.q&lt;br/&gt;
  ql/src/test/queries/clientnegative/udf_assert_true2.q&lt;br/&gt;
  ql/src/test/results/clientnegative/udf_assert_true.q.out&lt;br/&gt;
  ql/src/test/results/clientnegative/udf_assert_true2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/show_functions.q.out&lt;/p&gt;</comment>
                            <comment id="13147988" author="phabricator@reviews.facebook.net" created="Thu, 10 Nov 2011 20:33:51 +0000"  >&lt;p&gt;jsichi has requested changes to the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2532&quot; title=&quot;Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2532&quot;&gt;&lt;del&gt;HIVE-2532&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java:144 Note that Java does not short-circuit the &amp;amp;= assignment.&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;http://stackoverflow.com/questions/3152208/do-and-short-circuit-in-java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/3152208/do-and-short-circuit-in-java&lt;/a&gt;&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeEvaluator.java:43 Need Javadoc here.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D273&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13148063" author="phabricator@reviews.facebook.net" created="Thu, 10 Nov 2011 22:35:51 +0000"  >&lt;p&gt;jonchang updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2532&quot; title=&quot;Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2532&quot;&gt;&lt;del&gt;HIVE-2532&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot;.&lt;br/&gt;
Reviewers: JIRA, jsichi&lt;/p&gt;

&lt;p&gt;  jvs&apos; comments.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D273&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeEvaluator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFAssertTrue.java&lt;br/&gt;
  ql/src/test/queries/clientnegative/udf_assert_true.q&lt;br/&gt;
  ql/src/test/queries/clientnegative/udf_assert_true2.q&lt;br/&gt;
  ql/src/test/results/clientnegative/udf_assert_true.q.out&lt;br/&gt;
  ql/src/test/results/clientnegative/udf_assert_true2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/show_functions.q.out&lt;/p&gt;</comment>
                            <comment id="13148073" author="phabricator@reviews.facebook.net" created="Thu, 10 Nov 2011 22:41:51 +0000"  >&lt;p&gt;jonchang has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2532&quot; title=&quot;Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2532&quot;&gt;&lt;del&gt;HIVE-2532&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java:144 Really?  Jeebus.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D273&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13148074" author="phabricator@reviews.facebook.net" created="Thu, 10 Nov 2011 22:41:52 +0000"  >&lt;p&gt;jsichi has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2532&quot; title=&quot;Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2532&quot;&gt;&lt;del&gt;HIVE-2532&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java:144 &amp;amp; is eager; &amp;amp;&amp;amp; short-circuits&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D273&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13148077" author="phabricator@reviews.facebook.net" created="Thu, 10 Nov 2011 22:43:51 +0000"  >&lt;p&gt;jonchang updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2532&quot; title=&quot;Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2532&quot;&gt;&lt;del&gt;HIVE-2532&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot;.&lt;br/&gt;
Reviewers: JIRA, jsichi&lt;/p&gt;

&lt;p&gt;  &amp;amp; -&amp;gt; &amp;amp;&amp;amp;&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D273&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeEvaluator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFAssertTrue.java&lt;br/&gt;
  ql/src/test/queries/clientnegative/udf_assert_true.q&lt;br/&gt;
  ql/src/test/queries/clientnegative/udf_assert_true2.q&lt;br/&gt;
  ql/src/test/results/clientnegative/udf_assert_true.q.out&lt;br/&gt;
  ql/src/test/results/clientnegative/udf_assert_true2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/show_functions.q.out&lt;/p&gt;</comment>
                            <comment id="13148096" author="phabricator@reviews.facebook.net" created="Thu, 10 Nov 2011 23:13:51 +0000"  >&lt;p&gt;jsichi has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2532&quot; title=&quot;Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2532&quot;&gt;&lt;del&gt;HIVE-2532&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot;.&lt;/p&gt;

&lt;p&gt;  OK I&apos;ll kick off tests.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D273&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13148686" author="jvs" created="Fri, 11 Nov 2011 19:36:08 +0000"  >&lt;p&gt;+1, tests passed.  Can you grant ASF rights?&lt;/p&gt;</comment>
                            <comment id="13148687" author="phabricator@reviews.facebook.net" created="Fri, 11 Nov 2011 19:36:51 +0000"  >&lt;p&gt;jsichi has accepted the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2532&quot; title=&quot;Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2532&quot;&gt;&lt;del&gt;HIVE-2532&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot;.&lt;/p&gt;

&lt;p&gt;  spockwin&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D273&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13148699" author="phabricator@reviews.facebook.net" created="Fri, 11 Nov 2011 19:48:52 +0000"  >&lt;p&gt;jonchang has committed the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2532&quot; title=&quot;Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2532&quot;&gt;&lt;del&gt;HIVE-2532&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot;.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D273&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;COMMIT&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/rHIVE1201035&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/rHIVE1201035&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13148702" author="jvs" created="Fri, 11 Nov 2011 19:49:19 +0000"  >&lt;p&gt;Committed to trunk, thanks Jonathan!  Also don&apos;t forget to update the wiki.&lt;/p&gt;</comment>
                            <comment id="13148861" author="hudson" created="Fri, 11 Nov 2011 23:53:32 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1078 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1078/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1078/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2532&quot; title=&quot;Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2532&quot;&gt;&lt;del&gt;HIVE-2532&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Evaluation of non-deterministic/stateful UDFs should not be&lt;br/&gt;
skipped even if constant oi is returned.&lt;br/&gt;
(Jonathan Chang via jvs)&lt;/p&gt;

&lt;p&gt;Summary:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2532&quot; title=&quot;Evaluation of non-deterministic/stateful UDFs should not be skipped even if constant oi is returned.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2532&quot;&gt;&lt;del&gt;HIVE-2532&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Even if constant oi is returned, these may have stateful/side-effect behavior&lt;br/&gt;
and hence need to be called each cycle.&lt;/p&gt;

&lt;p&gt;Test Plan: EMPTY&lt;/p&gt;

&lt;p&gt;Reviewers: JIRA, jsichi&lt;/p&gt;

&lt;p&gt;Reviewed By: jsichi&lt;/p&gt;

&lt;p&gt;CC: ikabiljo, jonchang, jsichi&lt;/p&gt;

&lt;p&gt;Differential Revision: 273&lt;/p&gt;

&lt;p&gt;jvs : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1201035&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1201035&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeEvaluator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFAssertTrue.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientnegative/udf_assert_true.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientnegative/udf_assert_true2.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/udf_assert_true.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/udf_assert_true2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/show_functions.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13427133" author="rohithsharma" created="Thu, 2 Aug 2012 06:18:39 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
I have one doubt on ASSERT_TRUE() funtion. Currently ASSERT_TRUE() is returning NULL.Its PrimitiveType is VOID.Once query is executed in CLI mode, output of query prints NULL in console where as in JDBC client throw an exception(&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3200&quot; title=&quot;Results of the assert_true UDF are not retrieving through ResultSet&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3200&quot;&gt;&lt;del&gt;HIVE-3200&lt;/del&gt;&lt;/a&gt;).The serde implimentation for PrimitiveType VOID throw exception.&lt;/p&gt;

&lt;p&gt;Correct me if I am wrong,&lt;br/&gt;
From the user perspective I feel its better to return boolean value i.e TRUE instead of returning NULL. Please give your opinion..&lt;/p&gt;</comment>
                            <comment id="13427197" author="jonchang" created="Thu, 2 Aug 2012 09:27:57 +0000"  >&lt;p&gt;It&apos;s ok by me if you want to return a bool instead.  That being said, things should not crash if things are NULL (I think this was a recent regression and there&apos;s a JIRA open for it).&lt;/p&gt;</comment>
                            <comment id="13427249" author="rohithsharma" created="Thu, 2 Aug 2012 11:43:48 +0000"  >&lt;p&gt;I tested with changing implementation to boolean.All the positive scenario works fine. Whereas , &quot;SELECT 1 + assert_true FROM src&quot;  fails.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2012-08-02 16:34:31,173 ERROR ql.Driver (SessionState.java:printError(400)) - FAILED: Error in semantic analysis: Line 1:7 Wrong arguments &apos;0&apos;: Unable to find a common class betweentypes int and boolean
org.apache.hadoop.hive.ql.parse.SemanticException: Line 1:7 Wrong arguments &apos;0&apos;: Unable to find a common class betweentypes int and boolean
	at org.apache.hadoop.hive.ql.parse.TypeCheckProcFactory$DefaultExprProcessor.process(TypeCheckProcFactory.java:896)
	at org.apache.hadoop.hive.ql.lib.DefaultRuleDispatcher.dispatch(DefaultRuleDispatcher.java:89)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With string return type, &quot;SELECT 1 + assert_true FROM src&quot; query execution is successfull.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12502631" name="ASF.LICENSE.NOT.GRANTED--D273.1.patch" size="13719" author="phabricator@reviews.facebook.net" created="Sat, 5 Nov 2011 23:54:52 +0000"/>
                            <attachment id="12503172" name="ASF.LICENSE.NOT.GRANTED--D273.2.patch" size="19003" author="phabricator@reviews.facebook.net" created="Thu, 10 Nov 2011 06:51:52 +0000"/>
                            <attachment id="12503293" name="ASF.LICENSE.NOT.GRANTED--D273.3.patch" size="19101" author="phabricator@reviews.facebook.net" created="Thu, 10 Nov 2011 22:35:52 +0000"/>
                            <attachment id="12503299" name="ASF.LICENSE.NOT.GRANTED--D273.4.patch" size="19102" author="phabricator@reviews.facebook.net" created="Thu, 10 Nov 2011 22:43:52 +0000"/>
                            <attachment id="12503410" name="D273.4.patch" size="19102" author="jonchang" created="Fri, 11 Nov 2011 19:45:03 +0000"/>
                            <attachment id="12503409" name="D273.4.patch" size="19102" author="jonchang" created="Fri, 11 Nov 2011 19:44:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>215142</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 16 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lkfj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123960</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>