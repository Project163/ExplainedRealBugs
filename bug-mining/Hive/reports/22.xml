<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 17:50:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-47] [Hive] CLI not supporting multiline queries from an input file</title>
                <link>https://issues.apache.org/jira/browse/HIVE-47</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;calling &quot;hive -f filename&quot; allows to pass HQL queries from a file.&lt;br/&gt;
but the queries can&apos;t be on multiple lines as we would expect by reading Hive documentation.&lt;/p&gt;

&lt;p&gt;a proposed fix is to modify CliDriver.processReader.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12407048">HIVE-47</key>
            <summary>[Hive] CLI not supporting multiline queries from an input file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="athusoo">Ashish Thusoo</assignee>
                                    <reporter username="mimizone">Jeremy Huylebroeck</reporter>
                        <labels>
                    </labels>
                <created>Thu, 23 Oct 2008 00:31:18 +0000</created>
                <updated>Sat, 17 Dec 2011 00:08:27 +0000</updated>
                            <resolved>Wed, 10 Dec 2008 22:58:26 +0000</resolved>
                                                    <fixVersion>0.3.0</fixVersion>
                                    <component>Clients</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12642023" author="mimizone" created="Thu, 23 Oct 2008 00:43:38 +0000"  >&lt;p&gt;uploaded patch against 0.17 hive code&lt;br/&gt;
(hive code available at &lt;a href=&quot;http://mirror.facebook.com/facebook/hive/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mirror.facebook.com/facebook/hive/&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="12642030" author="mimizone" created="Thu, 23 Oct 2008 01:06:35 +0000"  >&lt;p&gt;uploaded a patch for CliDriver for hadoop trunk&lt;/p&gt;</comment>
                            <comment id="12642207" author="athusoo" created="Thu, 23 Oct 2008 17:26:28 +0000"  >&lt;p&gt;Hi Jeremy,&lt;/p&gt;

&lt;p&gt;Thanks a bunch for the patch. &lt;/p&gt;

&lt;p&gt;One comment though - it would be great if the patch is able to pass all the empty lines around to the parser for debuggability purposes. Otherwise, it will be impossible for the users to figure out where the error happened in a statement. &lt;/p&gt;

&lt;p&gt;you bring up a good point about processLine calling the trim function. We should move that to the checks in processCmd and not trim the line in processLine and we should pass the command as is to qp.run(cmd) call in processCmd.&lt;/p&gt;

&lt;p&gt;What do think?&lt;/p&gt;</comment>
                            <comment id="12642211" author="prasadc" created="Thu, 23 Oct 2008 17:39:21 +0000"  >&lt;p&gt;The patch looks good except for trimming that Ashish pointed out. there is some code in CliDriver.main() which does similar thing but little differently. Could you make the two uniform so that multi-line query behaves the same both from a file and from command line?&lt;/p&gt;</comment>
                            <comment id="12642212" author="prasadc" created="Thu, 23 Oct 2008 17:47:36 +0000"  >&lt;p&gt;also, mysql client assume that a newline is a word break. so &apos;select\n* from tabA;&apos; is a valid query in mysql but not in the code above or in main() function. I think we do want to make it as similar to mysql client as possible.&lt;/p&gt;</comment>
                            <comment id="12644447" author="mimizone" created="Fri, 31 Oct 2008 22:32:57 +0000"  >&lt;p&gt;proposed new patch for 0.17:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;supports comments properly (lines started with &quot;--&quot;)&lt;/li&gt;
	&lt;li&gt;keeps empty lines etc... so error position is closer to reality, easier to debug.&lt;/li&gt;
	&lt;li&gt;shows the number of line offset in the INFO log to ease debugging of the error position (not very pretty implementation but it helps)&lt;/li&gt;
	&lt;li&gt;some cleanup&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12644449" author="mimizone" created="Fri, 31 Oct 2008 22:36:43 +0000"  >&lt;p&gt;Prasad, I don&apos;t observe the issue with something like &apos;select\n* tabl;&apos;&lt;br/&gt;
I do all the time this in my hql files without problems.&lt;br/&gt;
do you have an actual example?&lt;/p&gt;</comment>
                            <comment id="12644451" author="prasadc" created="Fri, 31 Oct 2008 22:40:59 +0000"  >&lt;p&gt;oh the problem i mentioned only if you are using interactive shell. so first line enter select and on second prompt enter a.* from tabA a;&lt;/p&gt;</comment>
                            <comment id="12644452" author="mimizone" created="Fri, 31 Oct 2008 22:52:00 +0000"  >&lt;p&gt;your example is actually working for me in 0.17.3, at least with the patched version.&lt;br/&gt;
I remember observing something similar when using 0.19, but only for some time. But I was changing the code and playing with multiple combinaisons of hive/hadoop versions at the time. can you try the new patch?&lt;/p&gt;</comment>
                            <comment id="12644818" author="prasadc" created="Mon, 3 Nov 2008 21:50:09 +0000"  >&lt;p&gt;Hi Jeremy,&lt;/p&gt;

&lt;p&gt;Couple of issues&lt;br/&gt;
1) Should line 166 be in inside the if (m.matches()) condition?&lt;br/&gt;
2) line 185: i think if loop gets executed even if the last line doesn&apos;t end with a &apos;;&apos;&lt;br/&gt;
3) I think processLine should be used instead of processCmd. Otherwise the code can&apos;t handle cmds like &apos;select a.* from tabA a; select \nb.* from tabB b&apos;&lt;br/&gt;
4) also, could you update the patch with new code available for 0.17. There have been some changes that make the commands case insensitive.&lt;/p&gt;

&lt;p&gt;It will be good if you can make similar changes to code that handles interactive commands (in main()). If not we can do that in a separate JIRA as well. &lt;/p&gt;</comment>
                            <comment id="12644820" author="athusoo" created="Mon, 3 Nov 2008 21:55:06 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Jeremy, the patch looks good to me. Thanks for the contribution.&lt;/p&gt;

&lt;p&gt;One thing though.&lt;/p&gt;

&lt;p&gt;1. The latest patch is generated from the directory that contains CliDriver.java so I think the hadoop QA will fail as it expects the patch to be generated from the root of the source tree.&lt;/p&gt;

&lt;p&gt;Prasad,&lt;/p&gt;

&lt;p&gt;is your issue resolved?&lt;/p&gt;</comment>
                            <comment id="12644826" author="prasadc" created="Mon, 3 Nov 2008 22:11:11 +0000"  >&lt;p&gt;yeah, my issue is resolved but see the comments above.&lt;/p&gt;</comment>
                            <comment id="12654814" author="athusoo" created="Tue, 9 Dec 2008 15:04:45 +0000"  >&lt;p&gt;Simplified the fix for this in order to address prasad&apos;s concerns.&lt;/p&gt;

&lt;p&gt;I have tested this to a limited extent inside fb. However, without getting the test harness in place for cli tests, I am not able to add unit tests for this at this time. (I think we should get the test harness for the cli in place as soon as possible - I tried to do it in QTestUtil but the changes there are more involved than what I would have liked to put in this transaction)&lt;/p&gt;

&lt;p&gt;Incidentally, the fix here mimics what QTestUtils.java does for calling the internal cli driver for its test (The issue is that there is no test harness for bin/hive scripts).&lt;/p&gt;

&lt;p&gt;Please review and provide any feedback.&lt;/p&gt;</comment>
                            <comment id="12654858" author="jsensarma" created="Tue, 9 Dec 2008 17:26:17 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12655045" author="zshao" created="Wed, 10 Dec 2008 00:45:33 +0000"  >&lt;p&gt;The patch didn&apos;t pass unit tests.&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 08/12/09 16:42:57 ERROR ql.Driver: FAILED: Parse Error: line 0:-1 cannot recognize input &apos;&amp;lt;EOF&amp;gt;&apos;&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; org.apache.hadoop.hive.ql.parse.ParseException: line 0:-1 cannot recognize input &apos;&amp;lt;EOF&amp;gt;&apos;&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:258)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.hive.ql.Driver.run(Driver.java:163)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:174)&lt;/p&gt;</comment>
                            <comment id="12655051" author="athusoo" created="Wed, 10 Dec 2008 01:01:34 +0000"  >&lt;p&gt;I am checking into this.&lt;/p&gt;</comment>
                            <comment id="12655053" author="athusoo" created="Wed, 10 Dec 2008 01:03:12 +0000"  >&lt;p&gt;Just want to confirm that you are not seeing this in the negative tests. The negative tests do generate this on the ant output though they finally report that the tests passed. Which particular test is failing?&lt;/p&gt;</comment>
                            <comment id="12655328" author="athusoo" created="Wed, 10 Dec 2008 19:25:40 +0000"  >&lt;p&gt;Resubmitting after fixing the test run and capturing new logs.&lt;/p&gt;</comment>
                            <comment id="12655391" author="jsensarma" created="Wed, 10 Dec 2008 22:36:26 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12655400" author="zshao" created="Wed, 10 Dec 2008 22:57:57 +0000"  >&lt;p&gt;Committed revision 725472.&lt;/p&gt;</comment>
                            <comment id="12655401" author="zshao" created="Wed, 10 Dec 2008 22:58:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-47&quot; title=&quot;[Hive] CLI not supporting multiline queries from an input file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-47&quot;&gt;&lt;del&gt;HIVE-47&lt;/del&gt;&lt;/a&gt;. CLI to support multiline queries from an input file.&lt;br/&gt;
(Ashish through zshao)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12392689" name="patch-0.17.txt" size="2569" author="mimizone" created="Thu, 23 Oct 2008 00:43:38 +0000"/>
                            <attachment id="12395650" name="patch-47_4.txt" size="2064" author="athusoo" created="Tue, 9 Dec 2008 15:04:45 +0000"/>
                            <attachment id="12395753" name="patch-47_5.txt" size="4269" author="athusoo" created="Wed, 10 Dec 2008 19:25:40 +0000"/>
                            <attachment id="12392691" name="patch-trunk.txt" size="1759" author="mimizone" created="Thu, 23 Oct 2008 01:06:35 +0000"/>
                            <attachment id="12393179" name="patch2-0.17.txt" size="4606" author="mimizone" created="Fri, 31 Oct 2008 22:32:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73816</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 50 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0iv2f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>108127</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>