<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:17:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-6635] Heartbeats are not being sent when DbLockMgr is used and an operation holds locks</title>
                <link>https://issues.apache.org/jira/browse/HIVE-6635</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The new DbLockManager depends on heartbeats from the client in order to determine that a lock has not timed out.  The client is not currently sending those heartbeats.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12701036">HIVE-6635</key>
            <summary>Heartbeats are not being sent when DbLockMgr is used and an operation holds locks</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gates">Alan Gates</assignee>
                                    <reporter username="gates">Alan Gates</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Mar 2014 17:47:45 +0000</created>
                <updated>Mon, 9 Nov 2015 18:52:16 +0000</updated>
                            <resolved>Mon, 24 Mar 2014 17:57:17 +0000</resolved>
                                    <version>0.13.0</version>
                                    <fixVersion>0.13.0</fixVersion>
                                    <component>Locking</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13932626" author="alangates" created="Wed, 12 Mar 2014 23:12:20 +0000"  >&lt;p&gt;Added a thread to Driver to send heartbeats.  This thread only runs during the main loop in Driver.execute.  I added this in a separate thread because otherwise I would have needed to add threads in every task to see if heartbeats needed to be sent.  This would be very invasive, and also it&apos;s not clear it would be possible to cover all cases as there are actions that may simply take a long time (like certain metastore operations).  The downside is that a query will keep running even after it&apos;s found out it&apos;s locks were aborted and only be terminated at the end.&lt;/p&gt;</comment>
                            <comment id="13932632" author="alangates" created="Wed, 12 Mar 2014 23:14:59 +0000"  >&lt;p&gt;Review board: &lt;a href=&quot;https://reviews.apache.org/r/19161/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/19161/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13932685" author="alangates" created="Thu, 13 Mar 2014 00:09:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhbutani&quot; class=&quot;user-hover&quot; rel=&quot;rhbutani&quot;&gt;rhbutani&lt;/a&gt; This patch should go into the 0.13 branch as well.&lt;/p&gt;</comment>
                            <comment id="13932695" author="ashutoshc" created="Thu, 13 Mar 2014 00:30:17 +0000"  >&lt;p&gt;This will double # of threads for HS2 and worse these threads are not coming from shared threadpool of HS2. How about putting heartbeat while we are waiting for MR job to finish. There is a while loop waiting polling for MR job status. I think we can put heartbeating there. This is in HadoopJobExecHelper::progress()&lt;/p&gt;</comment>
                            <comment id="13932839" author="alangates" created="Thu, 13 Mar 2014 03:29:23 +0000"  >&lt;p&gt;Have we solved all the places that DDL operations can take an hour plus?  And is this same job helper used by Tez or do we need to do it separately in that case?&lt;/p&gt;</comment>
                            <comment id="13933412" author="ashutoshc" created="Thu, 13 Mar 2014 15:33:03 +0000"  >&lt;p&gt;I don&apos;t remember about any DDL operation taking that long. I don&apos;t think this job helper is used by Tez. For, Tez we need to put this somewhere else, need to dig into to find where.&lt;/p&gt;</comment>
                            <comment id="13934602" author="alangates" created="Fri, 14 Mar 2014 04:51:02 +0000"  >&lt;p&gt;New version of the patch reworked according the approach indicated by Ashutosh.&lt;/p&gt;</comment>
                            <comment id="13935119" author="ashutoshc" created="Fri, 14 Mar 2014 15:01:57 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13936066" author="hiveqa" created="Sat, 15 Mar 2014 07:39:08 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 no tests executed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12634643/HIVE-6635.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12634643/HIVE-6635.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1799/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1799/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1799/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1799/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Tests exited with: NonZeroExitCodeException
Command &apos;bash /data/hive-ptest/working/scratch/source-prep.sh&apos; failed with exit status 1 and output &apos;+ [[ -n &apos;&apos; ]]
+ export &apos;ANT_OPTS=-Xmx1g -XX:MaxPermSize=256m &apos;
+ ANT_OPTS=&apos;-Xmx1g -XX:MaxPermSize=256m &apos;
+ export &apos;M2_OPTS=-Xmx1g -XX:MaxPermSize=256m -Dhttp.proxyHost=localhost -Dhttp.proxyPort=3128&apos;
+ M2_OPTS=&apos;-Xmx1g -XX:MaxPermSize=256m -Dhttp.proxyHost=localhost -Dhttp.proxyPort=3128&apos;
+ cd /data/hive-ptest/working/
+ tee /data/hive-ptest/logs/PreCommit-HIVE-Build-1799/source-prep.txt
+ [[ false == \t\r\u\e ]]
+ mkdir -p maven ivy
+ [[ svn = \s\v\n ]]
+ [[ -n &apos;&apos; ]]
+ [[ -d apache-svn-trunk-source ]]
+ [[ ! -d apache-svn-trunk-source/.svn ]]
+ [[ ! -d apache-svn-trunk-source ]]
+ cd apache-svn-trunk-source
+ svn revert -R .
Reverted &apos;conf/hive-default.xml.template&apos;
Reverted &apos;itests/qtest/pom.xml&apos;
Reverted &apos;common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRTableScan1.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/parse/ProcessAnalyzeTable.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/exec/TaskFactory.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/io/orc/OrcInputFormat.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/io/orc/ReaderImpl.java&apos;
++ awk &apos;{print $2}&apos;
++ egrep -v &apos;^X|^Performing status on external&apos;
++ svn status --no-ignore
+ rm -rf target datanucleus.log ant/target shims/target shims/0.20/target shims/0.20S/target shims/0.23/target shims/aggregator/target shims/common/target shims/common-secure/target hbase-handler/target testutils/target jdbc/target metastore/target hcatalog/target hcatalog/server-extensions/target hcatalog/core/target hcatalog/webhcat/svr/target hcatalog/webhcat/java-client/target hcatalog/hcatalog-pig-adapter/target hwi/target common/target common/src/gen common/src/java/org/apache/hadoop/hive/conf/HiveConf.java.orig contrib/target service/target serde/target beeline/target odbc/target cli/target ql/dependency-reduced-pom.xml ql/target ql/src/test/results/clientpositive/orc_analyze.q.out ql/src/test/results/clientpositive/tez/orc_analyze.q.out ql/src/test/queries/clientpositive/orc_analyze.q ql/src/java/org/apache/hadoop/hive/ql/plan/StatsNoJobWork.java ql/src/java/org/apache/hadoop/hive/ql/exec/StatsNoJobTask.java ql/src/java/org/apache/hadoop/hive/ql/io/StatsProvidingRecordReader.java
+ svn update

Fetching external item into &apos;hcatalog/src/test/e2e/harness&apos;
External at revision 1577797.

At revision 1577797.
+ patchCommandPath=/data/hive-ptest/working/scratch/smart-apply-patch.sh
+ patchFilePath=/data/hive-ptest/working/scratch/build.patch
+ [[ -f /data/hive-ptest/working/scratch/build.patch ]]
+ chmod +x /data/hive-ptest/working/scratch/smart-apply-patch.sh
+ /data/hive-ptest/working/scratch/smart-apply-patch.sh /data/hive-ptest/working/scratch/build.patch
The patch does not appear to apply with p0, p1, or p2
+ exit 1
&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12634643&lt;/p&gt;</comment>
                            <comment id="13936326" author="alangates" created="Sat, 15 Mar 2014 22:29:36 +0000"  >&lt;p&gt;Resubmitting patch after build break to get tests run.&lt;/p&gt;</comment>
                            <comment id="13944166" author="alangates" created="Sat, 22 Mar 2014 18:05:53 +0000"  >&lt;p&gt;Patch no longer applies.  I&apos;ll upload a new version.&lt;/p&gt;</comment>
                            <comment id="13945341" author="hiveqa" created="Mon, 24 Mar 2014 16:54:48 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12636208/HIVE-6635.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12636208/HIVE-6635.3.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 5443 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hive.service.cli.thrift.TestThriftHttpCLIService.testExecuteStatementAsync
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1950/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1950/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1950/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1950/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12636208&lt;/p&gt;</comment>
                            <comment id="13945422" author="ashutoshc" created="Mon, 24 Mar 2014 17:57:17 +0000"  >&lt;p&gt;Committed to trunk &amp;amp; 0.13. Thanks, Alan!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12911397">HIVE-12366</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12634643" name="HIVE-6635.2.patch" size="12157" author="gates" created="Fri, 14 Mar 2014 04:51:02 +0000"/>
                            <attachment id="12636208" name="HIVE-6635.3.patch" size="12110" author="gates" created="Sat, 22 Mar 2014 18:06:09 +0000"/>
                            <attachment id="12634298" name="HIVE-6635.patch" size="13498" author="gates" created="Wed, 12 Mar 2014 23:12:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>379382</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 35 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1tdbz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>379673</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>