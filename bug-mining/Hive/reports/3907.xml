<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:37:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-11786] Deprecate the use of redundant column in colunm stats related tables</title>
                <link>https://issues.apache.org/jira/browse/HIVE-11786</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The stats tables such as TAB_COL_STATS, PART_COL_STATS have redundant columns such as DB_NAME, TABLE_NAME, PARTITION_NAME since these tables already have foreign key like TBL_ID, or PART_ID referencing to TBLS or PARTITIONS. &lt;br/&gt;
These redundant columns violate database normalization rules and cause a lot of inconvenience (sometimes difficult) in column stats related feature implementation. For example, when renaming a table, we have to update TABLE_NAME column in these tables as well which is unnecessary.&lt;/p&gt;

&lt;p&gt;This JIRA is first to deprecate the use of these columns at HMS code level. A followed JIRA is to be opened to focus on DB schema change and upgrade.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12863060">HIVE-11786</key>
            <summary>Deprecate the use of redundant column in colunm stats related tables</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ctang">Chaoyu Tang</assignee>
                                    <reporter username="ctang">Chaoyu Tang</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Sep 2015 14:07:03 +0000</created>
                <updated>Tue, 1 Oct 2019 22:06:52 +0000</updated>
                            <resolved>Tue, 6 Oct 2015 14:44:43 +0000</resolved>
                                                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14739130" author="pxiong" created="Thu, 10 Sep 2015 17:04:34 +0000"  >&lt;p&gt;I totally agree that these redundant columns violate database normalization rules and cause a lot of inconvenience. I also suffered a lot before. It seems to be a big change? also cc&apos;ing &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gates&quot; class=&quot;user-hover&quot; rel=&quot;gates&quot;&gt;gates&lt;/a&gt; to watch if it will affect HBase based metastore? Thanks.&lt;/p&gt;</comment>
                            <comment id="14739276" author="sershe" created="Thu, 10 Sep 2015 18:19:21 +0000"  >&lt;p&gt;Have you considered the perf impact on fetching column stats? In theory it should be small but I don&apos;t know what datanucleus would do&lt;/p&gt;</comment>
                            <comment id="14739725" author="ctang.ma" created="Thu, 10 Sep 2015 22:19:29 +0000"  >&lt;p&gt;In ORM, DataNucleus will generate a SQL query with joined tables (TAB_COL_STATS/PART_COL_STATS, DBS, TBLS, PARTITIONS) instead of only one table TAB_COL_STATS/PART_COL_STATS. In DirectSQL, we need also modify the queries accordingly. &lt;br/&gt;
Though query to only one table might run faster than that to multiple joined tables in the DBs that HMS supports, the performance impact should be very small given that the tables are joined via their keys. &lt;/p&gt;</comment>
                            <comment id="14741531" author="sershe" created="Fri, 11 Sep 2015 21:04:39 +0000"  >&lt;p&gt;Makes sense&lt;/p&gt;</comment>
                            <comment id="14746832" author="ctang.ma" created="Wed, 16 Sep 2015 04:29:15 +0000"  >&lt;p&gt;Submit patch for pre-commit test&lt;/p&gt;</comment>
                            <comment id="14768865" author="ctang.ma" created="Wed, 16 Sep 2015 12:40:24 +0000"  >&lt;p&gt;Patch has been uploaded to &lt;a href=&quot;https://reviews.apache.org/r/38429/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/38429/&lt;/a&gt;. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuefuz&quot; class=&quot;user-hover&quot; rel=&quot;xuefuz&quot;&gt;xuefuz&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt;, could you help review it? Thanks.&lt;/p&gt;</comment>
                            <comment id="14791032" author="hiveqa" created="Wed, 16 Sep 2015 19:58:31 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12756158/HIVE-11786.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12756158/HIVE-11786.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 6 failed/errored test(s), 9445 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_index_bitmap3
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_stats_counter_partitioned
org.apache.hadoop.hive.ql.txn.compactor.TestCompactor.testStatsAfterCompactionPartTbl
org.apache.hive.hcatalog.api.TestHCatClient.testTableSchemaPropagation
org.apache.hive.hcatalog.streaming.TestStreaming.testInterleavedTransactionBatchCommits
org.apache.hive.hcatalog.streaming.TestStreaming.testTransactionBatchEmptyCommit
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5301/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5301/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5301/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5301/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5301/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5301/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 6 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12756158 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14791143" author="sershe" created="Wed, 16 Sep 2015 21:26:55 +0000"  >&lt;p&gt;Left some comments on RB. The test failures (except HCat and streaming) may be related.&lt;/p&gt;</comment>
                            <comment id="14803273" author="ctang.ma" created="Thu, 17 Sep 2015 17:32:29 +0000"  >&lt;p&gt;Updated the patch based on &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt; review (Thanks! Sergey) and also fixed the failed test (TestCompactor#testStatsAfterCompactionPartTbl). But I was not able to reproduce the failures for MiniMR tests index_bitmap3.q, stats_counter_partitioned.q in my local machine. I wonder if they are the flaky tests and submit patch to see if they could be reproduced in precommit build.&lt;/p&gt;</comment>
                            <comment id="14803282" author="ctang.ma" created="Thu, 17 Sep 2015 17:39:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt; I uploaded a new patch to RB for review. Thanks&lt;/p&gt;</comment>
                            <comment id="14803301" author="ctang.ma" created="Thu, 17 Sep 2015 17:53:33 +0000"  >&lt;p&gt;Looks like that the pre-commit test has not been queued. Reattached the patch.&lt;/p&gt;</comment>
                            <comment id="14876615" author="hiveqa" created="Fri, 18 Sep 2015 22:41:28 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12757121/HIVE-11786.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12757121/HIVE-11786.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 41 failed/errored test(s), 9450 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_bucket4
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_bucket5
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_bucket6
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_bucketizedhiveinputformat
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_bucketmapjoin6
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_bucketmapjoin7
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_constprog_partitioner
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_empty_dir_in_table
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_external_table_with_space_in_location_path
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_index_bitmap3
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_index_bitmap_auto
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_infer_bucket_sort_bucketed_table
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_infer_bucket_sort_map_operators
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_infer_bucket_sort_merge
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_infer_bucket_sort_num_buckets
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_infer_bucket_sort_reducers_power_two
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_leftsemijoin_mr
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_list_bucket_dml_10
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_parallel_orderby
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_ql_rewrite_gbtoidx
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_ql_rewrite_gbtoidx_cbo_1
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_quotedid_smb
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_reduce_deduplicate
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_remote_script
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_root_dir_external_table
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_schemeAuthority
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_schemeAuthority2
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_scriptfile1
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_smb_mapjoin_8
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_stats_counter
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_stats_counter_partitioned
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_truncate_column_buckets
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_uber_reduce
org.apache.hive.hcatalog.api.TestHCatClient.testTableSchemaPropagation
org.apache.hive.spark.client.TestSparkClient.testAddJarsAndFiles
org.apache.hive.spark.client.TestSparkClient.testCounters
org.apache.hive.spark.client.TestSparkClient.testErrorJob
org.apache.hive.spark.client.TestSparkClient.testJobSubmission
org.apache.hive.spark.client.TestSparkClient.testMetricsCollection
org.apache.hive.spark.client.TestSparkClient.testSimpleSparkJob
org.apache.hive.spark.client.TestSparkClient.testSyncRpc
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5329/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5329/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5329/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5329/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5329/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5329/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 41 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12757121 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14876798" author="ctang.ma" created="Sat, 19 Sep 2015 01:29:45 +0000"  >&lt;p&gt;Reattached the patch to kick off another round of precommit tests since the test failures look to me not related to the patch.&lt;br/&gt;
These failed tests are most TestMiniSparkOnYarnCliDriver tests and has a common cause like:&lt;br/&gt;
==&lt;br/&gt;
2015-09-18 15:21:07,237 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;stdout-redir-1&amp;#93;&lt;/span&gt; client.SparkClientImpl (SparkClientImpl.java:run(588)) - java.io.IOException: Failed to create local dir in /tmp/spark-01dba71e-0baf-473a-9fec-977803eac958/blockmgr-b5ff096e-b567-497d-94ee-a78bdf96cf31/32.&lt;br/&gt;
2015-09-18 15:21:07,237 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;stdout-redir-1&amp;#93;&lt;/span&gt; client.SparkClientImpl (SparkClientImpl.java:run(588)) - 	at org.apache.spark.storage.DiskBlockManager.getFile(DiskBlockManager.scala:73)&lt;br/&gt;
==&lt;br/&gt;
In addition, I was not able to reproduce the tests in my local machine.&lt;/p&gt;

&lt;p&gt;The tests (MiniMR tests index_bitmap3.q, stats_counter_partitioned.q) initially failed in 1st round of precommit tests did not fail in this round.&lt;/p&gt;</comment>
                            <comment id="14877373" author="hiveqa" created="Sun, 20 Sep 2015 01:30:53 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12761244/HIVE-11786.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12761244/HIVE-11786.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 3 failed/errored test(s), 9452 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hive.hcatalog.api.TestHCatClient.testTableSchemaPropagation
org.apache.hive.hcatalog.streaming.TestStreaming.testRemainingTransactions
org.apache.hive.hcatalog.streaming.TestStreaming.testTransactionBatchEmptyCommit
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5348/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5348/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5348/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5348/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5348/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5348/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12761244 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14899923" author="ctang.ma" created="Sun, 20 Sep 2015 13:16:18 +0000"  >&lt;p&gt;The three failed tests seem not related to this patch.&lt;/p&gt;</comment>
                            <comment id="14902901" author="ctang.ma" created="Tue, 22 Sep 2015 16:24:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuefuz&quot; class=&quot;user-hover&quot; rel=&quot;xuefuz&quot;&gt;xuefuz&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt; Could you review the patch on &lt;a href=&quot;https://reviews.apache.org/r/38429/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/38429/&lt;/a&gt; to see if the change makes sense? Thanks&lt;/p&gt;</comment>
                            <comment id="14938241" author="ctang.ma" created="Wed, 30 Sep 2015 18:36:16 +0000"  >&lt;p&gt;attached a new rebased patch. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt;,  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt;, and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuefuz&quot; class=&quot;user-hover&quot; rel=&quot;xuefuz&quot;&gt;xuefuz&lt;/a&gt;, could you review the patch and let me know if there is any issue to remove these columns from TAB_COL_STATS/PART_COL_STATS? Using a join via K/FKey instead a direct query to these tables I think should not be a big concern to the performance.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11788&quot; title=&quot;Column stats should be preserved after db/table/partition rename&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11788&quot;&gt;&lt;del&gt;HIVE-11788&lt;/del&gt;&lt;/a&gt; is depending on this JIRA. Otherwise, I need look for other ways to fix &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11788&quot; title=&quot;Column stats should be preserved after db/table/partition rename&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11788&quot;&gt;&lt;del&gt;HIVE-11788&lt;/del&gt;&lt;/a&gt;. Thanks&lt;/p&gt;</comment>
                            <comment id="14940534" author="szehon" created="Thu, 1 Oct 2015 22:26:02 +0000"  >&lt;p&gt;Posting on behalf of HiveQA which was locked out:&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12764455/HIVE-11786.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12764455/HIVE-11786.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 9640 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hive.hcatalog.api.TestHCatClient.testTableSchemaPropagation
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5487/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5487/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5487/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5487/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5487/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5487/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14940698" author="ctang.ma" created="Fri, 2 Oct 2015 01:54:09 +0000"  >&lt;p&gt;The test failure is not related to the patch.&lt;/p&gt;</comment>
                            <comment id="14941867" author="szehon" created="Fri, 2 Oct 2015 22:15:23 +0000"  >&lt;p&gt;Chatted with Chaoyu offline, this change actually looks good to me, +1.  &lt;/p&gt;

&lt;p&gt;It is a big change, but Chaoyu gave a good explanation of performance impact of the join, and there stands to be more gain for cases like changing the part/table names.  And there seems to be good coverage via the qtests.&lt;/p&gt;</comment>
                            <comment id="14945129" author="ctang.ma" created="Tue, 6 Oct 2015 14:44:43 +0000"  >&lt;p&gt;Committed to Hive 2.0.0 and 1.3.0. Thank &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=szehon&quot; class=&quot;user-hover&quot; rel=&quot;szehon&quot;&gt;szehon&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt; for reviewing the patch.&lt;/p&gt;</comment>
                            <comment id="14945892" author="sseth" created="Tue, 6 Oct 2015 21:47:56 +0000"  >&lt;p&gt;This patch seems to have caused a pretty big performance regression on the client.&lt;/p&gt;

&lt;p&gt;With the patch&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2015-10-06T17:25:01,133 INFO  [main([])]: log.PerfLogger (PerfLogger.java:PerfLogBegin(117)) - &amp;lt;PERFLOG method=get_aggr_stats_for from=org.apache.hadoop.hive.metastore.RetryingHMSHandler&amp;gt;
2015-10-06T17:25:21,237 INFO  [main([])]: log.PerfLogger (PerfLogger.java:PerfLogEnd(157)) - &amp;lt;/PERFLOG method=get_aggr_stats_for start=1444166701133 end=1444166721237 duration=20104 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;gt;
2015-10-06T17:25:21,248 INFO  [main([])]: log.PerfLogger (PerfLogger.java:PerfLogBegin(117)) - &amp;lt;PERFLOG method=get_aggr_stats_for from=org.apache.hadoop.hive.metastore.RetryingHMSHandler&amp;gt;
2015-10-06T17:25:41,074 INFO  [main([])]: log.PerfLogger (PerfLogger.java:PerfLogEnd(157)) - &amp;lt;/PERFLOG method=get_aggr_stats_for start=1444166721248 end=1444166741074 duration=19826 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;gt;
2015-10-06T17:25:41,170 INFO  [main([])]: log.PerfLogger (PerfLogger.java:PerfLogBegin(117)) - &amp;lt;PERFLOG method=get_aggr_stats_for from=org.apache.hadoop.hive.metastore.RetryingHMSHandler&amp;gt;
2015-10-06T17:26:59,585 INFO  [main([])]: log.PerfLogger (PerfLogger.java:PerfLogEnd(157)) - &amp;lt;/PERFLOG method=get_aggr_stats_for start=1444166741170 end=1444166819585 duration=78415 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;gt;
2015-10-06T17:27:01,439 INFO  [main([])]: log.PerfLogger (PerfLogger.java:PerfLogBegin(117)) - &amp;lt;PERFLOG method=get_aggr_stats_for from=org.apache.hadoop.hive.metastore.RetryingHMSHandler&amp;gt;
2015-10-06T17:27:01,662 INFO  [main([])]: log.PerfLogger (PerfLogger.java:PerfLogEnd(157)) - &amp;lt;/PERFLOG method=get_aggr_stats_for start=1444166821439 end=1444166821662 duration=223 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Without the patch.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2015-10-06T17:04:51,205 INFO  [main([])]: log.PerfLogger (PerfLogger.java:PerfLogBegin(117)) - &amp;lt;PERFLOG method=get_aggr_stats_for from=org.apache.hadoop.hive.metastore.RetryingHMSHandler&amp;gt;
2015-10-06T17:04:51,440 INFO  [main([])]: log.PerfLogger (PerfLogger.java:PerfLogEnd(157)) - &amp;lt;/PERFLOG method=get_aggr_stats_for start=1444165491205 end=1444165491439 duration=234 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;gt;
2015-10-06T17:04:51,450 INFO  [main([])]: log.PerfLogger (PerfLogger.java:PerfLogBegin(117)) - &amp;lt;PERFLOG method=get_aggr_stats_for from=org.apache.hadoop.hive.metastore.RetryingHMSHandler&amp;gt;
2015-10-06T17:04:51,655 INFO  [main([])]: log.PerfLogger (PerfLogger.java:PerfLogEnd(157)) - &amp;lt;/PERFLOG method=get_aggr_stats_for start=1444165491450 end=1444165491655 duration=205 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;gt;
2015-10-06T17:04:51,751 INFO  [main([])]: log.PerfLogger (PerfLogger.java:PerfLogBegin(117)) - &amp;lt;PERFLOG method=get_aggr_stats_for from=org.apache.hadoop.hive.metastore.RetryingHMSHandler&amp;gt;
2015-10-06T17:04:52,355 INFO  [main([])]: log.PerfLogger (PerfLogger.java:PerfLogEnd(157)) - &amp;lt;/PERFLOG method=get_aggr_stats_for start=1444165491751 end=1444165492355 duration=604 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;gt;
2015-10-06T17:04:54,224 INFO  [main([])]: log.PerfLogger (PerfLogger.java:PerfLogBegin(117)) - &amp;lt;PERFLOG method=get_aggr_stats_for from=org.apache.hadoop.hive.metastore.RetryingHMSHandler&amp;gt;
2015-10-06T17:04:54,624 INFO  [main([])]: log.PerfLogger (PerfLogger.java:PerfLogEnd(157)) - &amp;lt;/PERFLOG method=get_aggr_stats_for start=1444165494224 end=1444165494624 duration=400 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is running against a MySQL database with a client-embedded metastore.&lt;/p&gt;

&lt;p&gt;Are there specific log lines which would help to debug this ? I have logs with debug logging for org.apache.hadoop.hive.metastore&lt;/p&gt;</comment>
                            <comment id="14945895" author="sseth" created="Tue, 6 Oct 2015 21:48:54 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt;, and thanks for pointing me to this jira for the perf regression. Reverting just this patch fixes things.&lt;/p&gt;</comment>
                            <comment id="14945908" author="sseth" created="Tue, 6 Oct 2015 21:57:38 +0000"  >&lt;p&gt;The expensive queries.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2015-10-06T17:25:20,120 DEBUG [main([])]: metastore.MetaStoreDirectSql (MetaStoreDirectSql.java:timingTrace(819)) - Direct SQL query in 18756.556801ms + 0.055911ms, the query is [select &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_TYPE&quot;&lt;/span&gt;, min(&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;), min(&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;), min(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt; as decimal)), max(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt; as decimal)), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_NULLS&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;AVG_COL_LEN&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;MAX_COL_LEN&quot;&lt;/span&gt;), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_TRUES&quot;&lt;/span&gt;), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_FALSES&quot;&lt;/span&gt;), avg((&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;-&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;)/&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt; as decimal)),avg((&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;-&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;)/&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;),avg((&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt; as decimal)-&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt; as decimal))/&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;),sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;) from (SELECT &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;DB_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;TABLE_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_TYPE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_NULLS&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;AVG_COL_LEN&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;MAX_COL_LEN&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_TRUES&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_FALSES&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LAST_ANALYZED&quot;&lt;/span&gt; FROM &lt;span class=&quot;code-quote&quot;&gt;&quot;PART_COL_STATS&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt; JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt;) JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_ID&quot;&lt;/span&gt;) JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DB_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DB_ID&quot;&lt;/span&gt;)) VW  where &lt;span class=&quot;code-quote&quot;&gt;&quot;DB_NAME&quot;&lt;/span&gt; = ? and &lt;span class=&quot;code-quote&quot;&gt;&quot;TABLE_NAME&quot;&lt;/span&gt; = ?  and &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt; in (?) and &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_NAME&quot;&lt;/span&gt; in (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?) group by &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_TYPE&quot;&lt;/span&gt;]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2015-10-06T17:25:39,938 DEBUG [main([])]: metastore.MetaStoreDirectSql (MetaStoreDirectSql.java:timingTrace(819)) - Direct SQL query in 18442.878558ms + 0.050024ms, the query is [select &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_TYPE&quot;&lt;/span&gt;, min(&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;), min(&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;), min(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt; as decimal)), max(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt; as decimal)), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_NULLS&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;AVG_COL_LEN&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;MAX_COL_LEN&quot;&lt;/span&gt;), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_TRUES&quot;&lt;/span&gt;), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_FALSES&quot;&lt;/span&gt;), avg((&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;-&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;)/&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt; as decimal)),avg((&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;-&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;)/&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;),avg((&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt; as decimal)-&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt; as decimal))/&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;),sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;) from (SELECT &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;DB_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;TABLE_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_TYPE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_NULLS&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;AVG_COL_LEN&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;MAX_COL_LEN&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_TRUES&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_FALSES&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LAST_ANALYZED&quot;&lt;/span&gt; FROM &lt;span class=&quot;code-quote&quot;&gt;&quot;PART_COL_STATS&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt; JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt;) JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_ID&quot;&lt;/span&gt;) JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DB_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DB_ID&quot;&lt;/span&gt;)) VW  where &lt;span class=&quot;code-quote&quot;&gt;&quot;DB_NAME&quot;&lt;/span&gt; = ? and &lt;span class=&quot;code-quote&quot;&gt;&quot;TABLE_NAME&quot;&lt;/span&gt; = ?  and &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt; in (?) and &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_NAME&quot;&lt;/span&gt; in (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?, ....
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2015-10-06T17:25:59,859 DEBUG [main([])]: metastore.MetaStoreDirectSql (MetaStoreDirectSql.java:timingTrace(819)) - Direct SQL query in 18496.68169ms + 0.050946ms, the query is [select &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_TYPE&quot;&lt;/span&gt;, min(&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;), min(&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;), min(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt; as decimal)), max(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt; as decimal)), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_NULLS&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;AVG_COL_LEN&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;MAX_COL_LEN&quot;&lt;/span&gt;), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_TRUES&quot;&lt;/span&gt;), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_FALSES&quot;&lt;/span&gt;), avg((&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;-&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;)/&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt; as decimal)),avg((&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;-&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;)/&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;),avg((&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt; as decimal)-&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt; as decimal))/&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;),sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;) from (SELECT &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;DB_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;TABLE_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_TYPE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_NULLS&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;AVG_COL_LEN&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;MAX_COL_LEN&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_TRUES&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_FALSES&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LAST_ANALYZED&quot;&lt;/span&gt; FROM &lt;span class=&quot;code-quote&quot;&gt;&quot;PART_COL_STATS&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt; JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt;) JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_ID&quot;&lt;/span&gt;) JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DB_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DB_ID&quot;&lt;/span&gt;)) VW  where &lt;span class=&quot;code-quote&quot;&gt;&quot;DB_NAME&quot;&lt;/span&gt; = ? and &lt;span class=&quot;code-quote&quot;&gt;&quot;TABLE_NAME&quot;&lt;/span&gt; = ?  and &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt; in (?) and &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_NAME&quot;&lt;/span&gt; in (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,? ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;015-10-06T17:26:00,994 DEBUG [main([])]: metastore.MetaStoreDirectSql (MetaStoreDirectSql.java:timingTrace(819)) - Direct SQL query in 1133.352123ms + 0.065074ms, the query is [SET @@session.sql_mode=ANSI_QUOTES]
2015-10-06T17:26:19,519 DEBUG [main([])]: metastore.MetaStoreDirectSql (MetaStoreDirectSql.java:timingTrace(819)) - Direct SQL query in 18522.793353ms + 0.049948ms, the query is [select &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_TYPE&quot;&lt;/span&gt;, min(&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;), min(&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;), min(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt; as decimal)), max(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt; as decimal)), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_NULLS&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;AVG_COL_LEN&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;MAX_COL_LEN&quot;&lt;/span&gt;), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_TRUES&quot;&lt;/span&gt;), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_FALSES&quot;&lt;/span&gt;), avg((&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;-&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;)/&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt; as decimal)),avg((&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;-&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;)/&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;),avg((&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt; as decimal)-&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt; as decimal))/&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;),sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;) from (SELECT &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;DB_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;TABLE_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_TYPE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_NULLS&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;AVG_COL_LEN&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;MAX_COL_LEN&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_TRUES&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_FALSES&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LAST_ANALYZED&quot;&lt;/span&gt; FROM &lt;span class=&quot;code-quote&quot;&gt;&quot;PART_COL_STATS&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt; JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt;) JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_ID&quot;&lt;/span&gt;) JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DB_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DB_ID&quot;&lt;/span&gt;)) VW  where &lt;span class=&quot;code-quote&quot;&gt;&quot;DB_NAME&quot;&lt;/span&gt; = ? and &lt;span class=&quot;code-quote&quot;&gt;&quot;TABLE_NAME&quot;&lt;/span&gt; = ?  and &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt; in (?) and &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_NAME&quot;&lt;/span&gt; in (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2015-10-06T17:26:20,651 DEBUG [main([])]: metastore.MetaStoreDirectSql (MetaStoreDirectSql.java:timingTrace(819)) - Direct SQL query in 1131.35695ms + 0.054133ms, the query is [SET @@session.sql_mode=ANSI_QUOTES]
2015-10-06T17:26:39,111 DEBUG [main([])]: metastore.MetaStoreDirectSql (MetaStoreDirectSql.java:timingTrace(819)) - Direct SQL query in 18457.449922ms + 0.049541ms, the query is [select &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_TYPE&quot;&lt;/span&gt;, min(&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;), min(&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;), min(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt; as decimal)), max(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt; as decimal)), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_NULLS&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;AVG_COL_LEN&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;MAX_COL_LEN&quot;&lt;/span&gt;), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_TRUES&quot;&lt;/span&gt;), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_FALSES&quot;&lt;/span&gt;), avg((&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;-&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;)/&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt; as decimal)),avg((&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;-&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;)/&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;),avg((&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt; as decimal)-&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt; as decimal))/&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;),sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;) from (SELECT &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;DB_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;TABLE_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_TYPE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_NULLS&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;AVG_COL_LEN&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;MAX_COL_LEN&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_TRUES&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_FALSES&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LAST_ANALYZED&quot;&lt;/span&gt; FROM &lt;span class=&quot;code-quote&quot;&gt;&quot;PART_COL_STATS&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt; JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt;) JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_ID&quot;&lt;/span&gt;) JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DB_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DB_ID&quot;&lt;/span&gt;)) VW  where &lt;span class=&quot;code-quote&quot;&gt;&quot;DB_NAME&quot;&lt;/span&gt; = ? and &lt;span class=&quot;code-quote&quot;&gt;&quot;TABLE_NAME&quot;&lt;/span&gt; = ?  and &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt; in (?) and &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_NAME&quot;&lt;/span&gt; in (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2015-10-06T17:26:40,220 DEBUG [main([])]: metastore.MetaStoreDirectSql (MetaStoreDirectSql.java:timingTrace(819)) - Direct SQL query in 1107.582286ms + 0.086248ms, the query is [SET @@session.sql_mode=ANSI_QUOTES]
2015-10-06T17:26:58,459 DEBUG [main([])]: metastore.MetaStoreDirectSql (MetaStoreDirectSql.java:timingTrace(819)) - Direct SQL query in 18237.480371ms + 0.054382ms, the query is [select &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_TYPE&quot;&lt;/span&gt;, min(&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;), min(&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;), min(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt; as decimal)), max(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt; as decimal)), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_NULLS&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;AVG_COL_LEN&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;MAX_COL_LEN&quot;&lt;/span&gt;), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_TRUES&quot;&lt;/span&gt;), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_FALSES&quot;&lt;/span&gt;), avg((&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;-&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;)/&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt; as decimal)),avg((&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;-&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;)/&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;),avg((&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt; as decimal)-&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt; as decimal))/&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;),sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;) from (SELECT &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;DB_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;TABLE_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_TYPE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_NULLS&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;AVG_COL_LEN&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;MAX_COL_LEN&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_TRUES&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_FALSES&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LAST_ANALYZED&quot;&lt;/span&gt; FROM &lt;span class=&quot;code-quote&quot;&gt;&quot;PART_COL_STATS&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt; JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt;) JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_ID&quot;&lt;/span&gt;) JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DB_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DB_ID&quot;&lt;/span&gt;)) VW  where &lt;span class=&quot;code-quote&quot;&gt;&quot;DB_NAME&quot;&lt;/span&gt; = ? and &lt;span class=&quot;code-quote&quot;&gt;&quot;TABLE_NAME&quot;&lt;/span&gt; = ?  and &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt; in (?) and &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_NAME&quot;&lt;/span&gt; in (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="14945923" author="szehon" created="Tue, 6 Oct 2015 22:08:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ctang.ma&quot; class=&quot;user-hover&quot; rel=&quot;ctang.ma&quot;&gt;ctang.ma&lt;/a&gt; can you take a look at those queries and see if there are faster ways to do it?  (Maybe need to check mysql to see why its slow).  The assumption was that these are joining on indexed columns.&lt;/p&gt;</comment>
                            <comment id="14945935" author="sershe" created="Tue, 6 Oct 2015 22:25:57 +0000"  >&lt;p&gt;See partition getting and how its separated into two queries with a big comment. That might help.&lt;br/&gt;
Or maybe index in name is needed.&lt;/p&gt;</comment>
                            <comment id="14946194" author="ctang.ma" created="Wed, 7 Oct 2015 04:04:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=szehon&quot; class=&quot;user-hover&quot; rel=&quot;szehon&quot;&gt;szehon&lt;/a&gt; Yes, all joins occur on primary keys and indexed foreign keys. But some columns (like column_name etc) have not been indexed but they are used in the query filters, which I wonder if is the main cause.&lt;br/&gt;
Before trying splitting a big query to two small ones, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sseth&quot; class=&quot;user-hover&quot; rel=&quot;sseth&quot;&gt;sseth&lt;/a&gt;, could you help to run the queries again with following indexes created in MySQL test bed?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CREATE INDEX COLNAME_TBLID_IDX ON TAB_COL_STATS (COLUMN_NAME, TBL_ID);
CREATE INDEX COLNAME_IDX ON TAB_COL_STATS (COLUMN_NAME);
CREATE INDEX COLNAME_PARTID_IDX ON PART_COL_STATS (COLUMN_NAME, PART_ID);
CREATE INDEX COLNAME_IDX ON PART_COL_STATS (COLUMN_NAME);
CREATE INDEX PARTNAME_IDX ON PARTITIONS (PART_NAME);
CREATE INDEX TBLNAME_IDX ON TBLS (TBL_NAME);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;if it works, I can create a patch for all RDBMS. Thanks&lt;/p&gt;</comment>
                            <comment id="14947562" author="sseth" created="Wed, 7 Oct 2015 20:57:03 +0000"  >&lt;p&gt;Quick note. &lt;br/&gt;
I created the following indexes.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CREATE INDEX COLNAME_TBLID_IDX ON TAB_COL_STATS (COLUMN_NAME, TBL_ID);
CREATE INDEX COLNAME_PARTID_IDX ON PART_COL_STATS (COLUMN_NAME, PART_ID);
CREATE INDEX PARTNAME_IDX ON PARTITIONS (PART_NAME);
CREATE INDEX TBLNAME_IDX ON TBLS (TBL_NAME);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This did not improve performance.&lt;/p&gt;

&lt;p&gt;I&apos;m creating the remaining 2 indexes (even though I don&apos;t think they&apos;re required given they&apos;re part of a multi column index) right now. Will post an update once the index creation is done.&lt;/p&gt;</comment>
                            <comment id="14947594" author="ctang.ma" created="Wed, 7 Oct 2015 21:08:47 +0000"  >&lt;p&gt;Thank &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sseth&quot; class=&quot;user-hover&quot; rel=&quot;sseth&quot;&gt;sseth&lt;/a&gt; very much for the help. yes, the remaining two have been covered by the composite index. But anyway, please give it a try and let me know. If that does not help, I will rewrite the query as &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt; suggested, which is also being used in directsql for getPartition.&lt;/p&gt;</comment>
                            <comment id="14947732" author="sseth" created="Wed, 7 Oct 2015 22:43:39 +0000"  >&lt;p&gt;No difference with the remaining indexes.&lt;br/&gt;
(The index creation takes a long time btw - and may impact stat generation ?)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2015-10-07T18:38:09,444 DEBUG [main([])]: metastore.MetaStoreDirectSql (MetaStoreDirectSql.java:timingTrace(819)) - Direct SQL query in 16195.018669ms + 0.058186ms, the query is [select &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_TYPE&quot;&lt;/span&gt;, min(&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;), min(&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;), min(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt; as decimal)), max(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt; as decimal)), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_NULLS&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;AVG_COL_LEN&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;MAX_COL_LEN&quot;&lt;/span&gt;), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_TRUES&quot;&lt;/span&gt;), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_FALSES&quot;&lt;/span&gt;), avg((&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;-&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;)/&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt; as decimal)),avg((&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;-&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;)/&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;),avg((&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt; as decimal)-&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt; as decimal))/&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;),sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;) from (SELECT &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;DB_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;TABLE_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_TYPE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_NULLS&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;AVG_COL_LEN&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;MAX_COL_LEN&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_TRUES&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_FALSES&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LAST_ANALYZED&quot;&lt;/span&gt; FROM &lt;span class=&quot;code-quote&quot;&gt;&quot;PART_COL_STATS&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt; JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt;) JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_ID&quot;&lt;/span&gt;) JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DB_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DB_ID&quot;&lt;/span&gt;)) VW  where &lt;span class=&quot;code-quote&quot;&gt;&quot;DB_NAME&quot;&lt;/span&gt; = ? and &lt;span class=&quot;code-quote&quot;&gt;&quot;TABLE_NAME&quot;&lt;/span&gt; = ?  and &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt; in (?) and &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_NAME&quot;&lt;/span&gt; in (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2015-10-07T18:38:29,309 DEBUG [main([])]: metastore.MetaStoreDirectSql (MetaStoreDirectSql.java:timingTrace(819)) - Direct SQL query in 18651.1996ms + 0.050665ms, the query is [select &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_TYPE&quot;&lt;/span&gt;, min(&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;), min(&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;), min(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt; as decimal)), max(&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt; as decimal)), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_NULLS&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;AVG_COL_LEN&quot;&lt;/span&gt;), max(&lt;span class=&quot;code-quote&quot;&gt;&quot;MAX_COL_LEN&quot;&lt;/span&gt;), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_TRUES&quot;&lt;/span&gt;), sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_FALSES&quot;&lt;/span&gt;), avg((&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;-&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;)/&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt; as decimal)),avg((&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;-&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;)/&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;),avg((&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt; as decimal)-&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt; as decimal))/&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;),sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;) from (SELECT &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;DB_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;TABLE_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_NAME&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_TYPE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LONG_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DOUBLE_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_LOW_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;BIG_DECIMAL_HIGH_VALUE&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_NULLS&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_DISTINCTS&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;AVG_COL_LEN&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;MAX_COL_LEN&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_TRUES&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;NUM_FALSES&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;LAST_ANALYZED&quot;&lt;/span&gt; FROM &lt;span class=&quot;code-quote&quot;&gt;&quot;PART_COL_STATS&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt; JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;PCS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;PART_ID&quot;&lt;/span&gt;) JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITIONS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;TBL_ID&quot;&lt;/span&gt;) JOIN &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt; ON (&lt;span class=&quot;code-quote&quot;&gt;&quot;TBLS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DB_ID&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;DBS&quot;&lt;/span&gt;.&lt;span class=&quot;code-quote&quot;&gt;&quot;DB_ID&quot;&lt;/span&gt;)) VW  where &lt;span class=&quot;code-quote&quot;&gt;&quot;DB_NAME&quot;&lt;/span&gt; = ? and &lt;span class=&quot;code-quote&quot;&gt;&quot;TABLE_NAME&quot;&lt;/span&gt; = ?  and &lt;span class=&quot;code-quote&quot;&gt;&quot;COLUMN_NAME&quot;&lt;/span&gt; in (?) and &lt;span class=&quot;code-quote&quot;&gt;&quot;PARTITION_NAME&quot;&lt;/span&gt; in (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14947760" author="ctang.ma" created="Wed, 7 Oct 2015 22:58:19 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sseth&quot; class=&quot;user-hover&quot; rel=&quot;sseth&quot;&gt;sseth&lt;/a&gt;. Maybe there are a large number of rows in TAB_COL_STATS/PART_COL_STATS, so it took a long time to create the index on their column &quot;COLUMN_NAME&quot;. I am going to change the query to see if it is helpful. BTW, I have created a JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-12053&quot; title=&quot;Stats performance regression caused by HIVE-11786&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-12053&quot;&gt;&lt;del&gt;HIVE-12053&lt;/del&gt;&lt;/a&gt; for the performance regression you found.&lt;/p&gt;</comment>
                            <comment id="14947807" author="sseth" created="Wed, 7 Oct 2015 23:38:19 +0000"  >&lt;p&gt;Yes.  There&apos;s a large number of entries - 2million+ in PART_COL_STATS. The number of new entries there is what I was worried about - how many new entries per table / partition, and whether that can have a significant impact. IAC, if the query is being re-written - maybe the indexes will not be required.&lt;/p&gt;</comment>
                            <comment id="14947848" author="ctang.ma" created="Thu, 8 Oct 2015 00:12:35 +0000"  >&lt;p&gt;If the query is rewritten to get PART_ID first and then use PART_ID and COLUMN_NAME to query PART_COL_STATS table, probably a new index on COLUMN_NAME, PART_ID  (CREATE INDEX COLNAME_PARTID_IDX ON PART_COL_STATS (COLUMN_NAME, PART_ID)) is still needed. I am going to work on the new queries.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12902987">HIVE-12053</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12863062">HIVE-11787</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12863069">HIVE-11788</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12761244" name="HIVE-11786.1.patch" size="30532" author="ctang" created="Sat, 19 Sep 2015 01:29:45 +0000"/>
                            <attachment id="12757121" name="HIVE-11786.1.patch" size="30532" author="ctang" created="Thu, 17 Sep 2015 17:53:33 +0000"/>
                            <attachment id="12764455" name="HIVE-11786.2.patch" size="28286" author="ctang" created="Wed, 30 Sep 2015 18:36:16 +0000"/>
                            <attachment id="12756158" name="HIVE-11786.patch" size="24337" author="ctang" created="Wed, 16 Sep 2015 04:28:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 6 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2jzxz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>