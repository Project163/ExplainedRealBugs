<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:56:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-16908] Failures in TestHcatClient due to HIVE-16844</title>
                <link>https://issues.apache.org/jira/browse/HIVE-16908</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Some of the tests in TestHCatClient.java, for ex:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hive.hcatalog.api.TestHCatClient.testPartitionRegistrationWithCustomSchema (batchId=177)
org.apache.hive.hcatalog.api.TestHCatClient.testPartitionSpecRegistrationWithCustomSchema (batchId=177)
org.apache.hive.hcatalog.api.TestHCatClient.testTableSchemaPropagation (batchId=177)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;are failing due to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-16844&quot; title=&quot;Fix Connection leak in ObjectStore when new Conf object is used&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-16844&quot;&gt;&lt;del&gt;HIVE-16844&lt;/del&gt;&lt;/a&gt;. &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-16844&quot; title=&quot;Fix Connection leak in ObjectStore when new Conf object is used&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-16844&quot;&gt;&lt;del&gt;HIVE-16844&lt;/del&gt;&lt;/a&gt; fixes a connection leak when a new configuration object is set on the ObjectStore. TestHCatClient fires up a second instance of metastore thread with a different conf object that results in the PersistenceMangaerFactory closure and hence tests fail. &lt;/p&gt;</description>
                <environment></environment>
        <key id="13080080">HIVE-16908</key>
            <summary>Failures in TestHcatClient due to HIVE-16844</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mithun">Mithun Radhakrishnan</assignee>
                                    <reporter username="sbeeram">Sunitha Beeram</reporter>
                        <labels>
                    </labels>
                <created>Thu, 15 Jun 2017 13:00:55 +0000</created>
                <updated>Tue, 22 May 2018 23:59:23 +0000</updated>
                            <resolved>Thu, 24 Aug 2017 15:34:05 +0000</resolved>
                                                    <fixVersion>3.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                                                                <comments>
                            <comment id="16050440" author="sbeeram" created="Thu, 15 Jun 2017 13:01:36 +0000"  >&lt;p&gt;+Watchers&lt;/p&gt;</comment>
                            <comment id="16058336" author="sbeeram" created="Wed, 21 Jun 2017 22:07:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sankarh&quot; class=&quot;user-hover&quot; rel=&quot;sankarh&quot;&gt;sankarh&lt;/a&gt; would be great if you reviewed the patch or recommended someone else more familiar with the code/original changes to also review the changes. &lt;br/&gt;
Hopefully I haven&apos;t oversimplified or relied on other/incorrect assumptions that make the tests pass currently.&lt;/p&gt;

&lt;p&gt;I am including the description from the RB here for quick reference:&lt;br/&gt;
&quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-16844&quot; title=&quot;Fix Connection leak in ObjectStore when new Conf object is used&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-16844&quot;&gt;&lt;del&gt;HIVE-16844&lt;/del&gt;&lt;/a&gt; fixed a connection leak issue which subsequently exposed failures in TestHCatClient. The connection leak gets triggered if a metastore instance is updated with a different JDO configuration. TestHCatClient uses 2 metastore instances to test replication related methods. Unfortunately, it does so by providing a different derby db name for the second instance. Since the 2 metastores run in the same JVM, the path fixed in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-16844&quot; title=&quot;Fix Connection leak in ObjectStore when new Conf object is used&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-16844&quot;&gt;&lt;del&gt;HIVE-16844&lt;/del&gt;&lt;/a&gt; gets triggered, resulting in &quot;sourceMetastore&quot;&apos;s connection being closed and thus resulting in failures.&lt;/p&gt;

&lt;p&gt;It appears to me that running 2 metastore instances within the same JVM is error prone as there could be unintentional side-effects due to statics in the code (as was exposed by fixing &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-16844&quot; title=&quot;Fix Connection leak in ObjectStore when new Conf object is used&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-16844&quot;&gt;&lt;del&gt;HIVE-16844&lt;/del&gt;&lt;/a&gt;). This patch provides a way to test the replication related methods without involving a second instance. The changes mainly validate the serialize/deserialize methods. One of the tests, testPartitionRegistrationWithCustomSchema, uses addPartitions method to verify propogation of changes and it appeared that addPartitions wasn&apos;t covered by other tests in TestHCatClient and there wasn&apos;t a better way to verify the intended path, so I used an approach where the original database and table are dropped and recreated using the serialized-string and captured partition spec.&quot;&lt;/p&gt;</comment>
                            <comment id="16058561" author="hiveqa" created="Thu, 22 Jun 2017 01:12:26 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12873958/HIVE-16908.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12873958/HIVE-16908.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 8 failed/errored test(s), 10841 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[tez_smb_main] (batchId=149)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=232)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query16] (batchId=232)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query23] (batchId=232)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query94] (batchId=232)
org.apache.hadoop.hive.ql.parse.TestReplicationScenariosAcrossInstances.testBootstrapFunctionReplication (batchId=216)
org.apache.hadoop.hive.ql.parse.TestReplicationScenariosAcrossInstances.testCreateFunctionIncrementalReplication (batchId=216)
org.apache.hadoop.hive.ql.parse.TestReplicationScenariosAcrossInstances.testCreateFunctionWithFunctionBinaryJarsOnHDFS (batchId=216)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/5722/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/5722/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/5722/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/5722/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-5722/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-5722/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 8 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12873958 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="16058797" author="hiveqa" created="Thu, 22 Jun 2017 05:43:48 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12873983/HIVE-16908.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12873983/HIVE-16908.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 9 failed/errored test(s), 10827 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[tez_smb_main] (batchId=149)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_if_expr] (batchId=145)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=232)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query16] (batchId=232)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query94] (batchId=232)
org.apache.hadoop.hive.cli.TestSparkCliDriver.org.apache.hadoop.hive.cli.TestSparkCliDriver (batchId=103)
org.apache.hadoop.hive.ql.parse.TestReplicationScenariosAcrossInstances.testBootstrapFunctionReplication (batchId=216)
org.apache.hadoop.hive.ql.parse.TestReplicationScenariosAcrossInstances.testCreateFunctionIncrementalReplication (batchId=216)
org.apache.hadoop.hive.ql.parse.TestReplicationScenariosAcrossInstances.testCreateFunctionWithFunctionBinaryJarsOnHDFS (batchId=216)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/5727/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/5727/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/5727/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/5727/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-5727/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-5727/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 9 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12873983 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="16059651" author="rdsr" created="Thu, 22 Jun 2017 16:37:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sbeeram&quot; class=&quot;user-hover&quot; rel=&quot;sbeeram&quot;&gt;sbeeram&lt;/a&gt; . The tests look OK to me.&lt;/p&gt;</comment>
                            <comment id="16067525" author="thejas" created="Thu, 29 Jun 2017 00:44:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mithun&quot; class=&quot;user-hover&quot; rel=&quot;mithun&quot;&gt;mithun&lt;/a&gt; Can you please review this change ?&lt;br/&gt;
cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sushanth&quot; class=&quot;user-hover&quot; rel=&quot;sushanth&quot;&gt;sushanth&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16075241" author="mithun" created="Wed, 5 Jul 2017 18:52:46 +0000"  >&lt;p&gt;I&apos;ll need a little time to review. On the face of it, this change is disconcerting, since it looks like this changes the intention of the tests added in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-7341&quot; title=&quot;Support for Table replication across HCatalog instances&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-7341&quot;&gt;&lt;del&gt;HIVE-7341&lt;/del&gt;&lt;/a&gt;. :/ Let me take a closer look.&lt;/p&gt;</comment>
                            <comment id="16075593" author="mithun" created="Wed, 5 Jul 2017 23:09:10 +0000"  >&lt;p&gt;Yes, this is what I was afraid of. The intention of &lt;tt&gt;testTableSchemaPropagation()&lt;/tt&gt; was to simulate table-propagation across different clusters/HCat instances, as Apache Falcon (or similar projects) do. I wonder if this change dilutes that intention. :/ I do recognize that the static state in &lt;tt&gt;ObjectStore&lt;/tt&gt; makes this problematic. I&apos;m trying to figure out an alternative.&lt;/p&gt;

&lt;p&gt;Question: If the target metastore instance were accessed through a different classloader, their states would be isolated, right? Would that be an acceptable solution?&lt;/p&gt;</comment>
                            <comment id="16078973" author="sbeeram" created="Sat, 8 Jul 2017 06:00:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mithun&quot; class=&quot;user-hover&quot; rel=&quot;mithun&quot;&gt;mithun&lt;/a&gt; thanks for the review! Since we still have unresolved questions in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-16844&quot; title=&quot;Fix Connection leak in ObjectStore when new Conf object is used&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-16844&quot;&gt;&lt;del&gt;HIVE-16844&lt;/del&gt;&lt;/a&gt;, I will focus on that first and return to failing tests if/when the solution in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-16844&quot; title=&quot;Fix Connection leak in ObjectStore when new Conf object is used&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-16844&quot;&gt;&lt;del&gt;HIVE-16844&lt;/del&gt;&lt;/a&gt; gets updated. &lt;/p&gt;</comment>
                            <comment id="16105373" author="mithun" created="Fri, 28 Jul 2017 17:55:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sbeeram&quot; class=&quot;user-hover&quot; rel=&quot;sbeeram&quot;&gt;sbeeram&lt;/a&gt;: I have raised &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-17201&quot; title=&quot;(Temporarily) Disable failing tests in TestHCatClient&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-17201&quot;&gt;&lt;del&gt;HIVE-17201&lt;/del&gt;&lt;/a&gt; to temporarily disable these three tests, to clean up the tests for others. This is only temporary, until we fix the tests properly.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;If the target metastore instance were accessed through a different classloader...&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I made an initial pass at doing this. I don&apos;t have a proper solution yet. Will update.&lt;/p&gt;</comment>
                            <comment id="16105880" author="mithun" created="Sat, 29 Jul 2017 00:01:31 +0000"  >&lt;p&gt;I&apos;m taking a crack at this failure. Assigning this to myself, for the moment, for the sake of uploading a patch.&lt;/p&gt;</comment>
                            <comment id="16105882" author="mithun" created="Sat, 29 Jul 2017 00:02:38 +0000"  >&lt;p&gt;Not my finest moment, but the following is the least obtrusive change to fix the problem, methinks. &lt;/p&gt;</comment>
                            <comment id="16105883" author="mithun" created="Sat, 29 Jul 2017 00:03:01 +0000"  >&lt;p&gt;Resubmitting, to run tests.&lt;/p&gt;</comment>
                            <comment id="16106123" author="hiveqa" created="Sat, 29 Jul 2017 13:32:17 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12879456/HIVE-16908.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12879456/HIVE-16908.3.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 5 failed/errored test(s), 11017 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestPerfCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=235)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[columnstats_part_coltype] (batchId=158)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[spark_vectorized_dynamic_partition_pruning] (batchId=168)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=100)
org.apache.hadoop.hive.metastore.TestHiveMetaStoreStatsMerge.testStatsMerge (batchId=206)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/6187/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/6187/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/6187/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/6187/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-6187/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-6187/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 5 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12879456 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="16107621" author="mithun" created="Mon, 31 Jul 2017 17:17:26 +0000"  >&lt;p&gt;After co-opting this JIRA so that I could provide an alternative fix, I&apos;ve reset ownership back to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sbeeram&quot; class=&quot;user-hover&quot; rel=&quot;sbeeram&quot;&gt;sbeeram&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Rather than rewrite the test to launch the target metastore in a separate process, I have reworded the failing tests without changing their intention. In the places where calls to the source and target metastores are interleaved, I fetch a new HMS client.&lt;/p&gt;

&lt;p&gt;Fixing the static-state in the metastore is a larger problem that should be addressed separately.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sbeeram&quot; class=&quot;user-hover&quot; rel=&quot;sbeeram&quot;&gt;sbeeram&lt;/a&gt;, I wonder if you might find this satisfactory.&lt;/p&gt;</comment>
                            <comment id="16107778" author="sbeeram" created="Mon, 31 Jul 2017 18:54:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mithun&quot; class=&quot;user-hover&quot; rel=&quot;mithun&quot;&gt;mithun&lt;/a&gt; thanks - will take a look at the earliest.&lt;/p&gt;</comment>
                            <comment id="16110809" author="sbeeram" created="Wed, 2 Aug 2017 12:40:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mithun&quot; class=&quot;user-hover&quot; rel=&quot;mithun&quot;&gt;mithun&lt;/a&gt; sorry about being so anal about this, but with 2 metastores running in the same JVM we are always vulnerable to tests passing or failing due to weird reasons. I don&apos;t think fixing static-state is as much a priority (as we don&apos;t really have a use case to support running multiple metastores in the same JVM) - so if you think the tests have to use 2 metastores, then lets launch them in a way they would be launched? &lt;/p&gt;

&lt;p&gt;I am looking into the option of launching metastore in a different process.&lt;/p&gt;</comment>
                            <comment id="16111334" author="mithun" created="Wed, 2 Aug 2017 17:11:35 +0000"  >&lt;blockquote&gt;&lt;p&gt;I am looking into the option of launching metastore in a different process.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Thank you for holding out for the proper solution to this, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sbeeram&quot; class=&quot;user-hover&quot; rel=&quot;sbeeram&quot;&gt;sbeeram&lt;/a&gt;. A couple of challenges come to mind:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;The test will need to communicate which port the remote metastore was started at. We might consider pre-setting the port, but I wonder if this might make the test&apos;s start-up brittle.&lt;/li&gt;
	&lt;li&gt;Cleanup for the remote metastore&apos;s state, after the test.&lt;/li&gt;
&lt;/ol&gt;


&lt;blockquote&gt;&lt;p&gt;sorry about being so anal about this...&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I fear that label fits my stand more than yours. :/&lt;/p&gt;

&lt;p&gt;In the spirit of detente, I&apos;d be happy to revisit your first proposal, if the multi-process solution proves cumbersome.&lt;/p&gt;</comment>
                            <comment id="16136855" author="pvary" created="Tue, 22 Aug 2017 14:23:08 +0000"  >&lt;p&gt;I propose to disable the tests until this is solved. See: &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-17369&quot; title=&quot;We should turn off the TestHcatClient tests until HIVE-16908 is solved&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-17369&quot;&gt;&lt;del&gt;HIVE-17369&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;What do you think?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Peter&lt;/p&gt;</comment>
                            <comment id="16137364" author="sbeeram" created="Tue, 22 Aug 2017 20:37:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pvary&quot; class=&quot;user-hover&quot; rel=&quot;pvary&quot;&gt;pvary&lt;/a&gt; sorry about the delay on this. Its going to take a bit more time from my end to get these fixed correctly, but in the meantime we can commit &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mithun&quot; class=&quot;user-hover&quot; rel=&quot;mithun&quot;&gt;mithun&lt;/a&gt;&apos;s patch - he is the original author of the tests and I am comfortable taking in his fixes for it. On a more fundamental level though, we need to fix the tests that launch multiple metastores in the same JVM (and there are more tests than these that do that) - so we can tackle that sepearately.&lt;/p&gt;</comment>
                            <comment id="16137390" author="pvary" created="Tue, 22 Aug 2017 20:52:28 +0000"  >&lt;p&gt;I think then the &quot;proper&quot; way to do this to assign this jira to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mithun&quot; class=&quot;user-hover&quot; rel=&quot;mithun&quot;&gt;mithun&lt;/a&gt;, resubmit his patch, and create a followup jira to tackle the remaining problems later.&lt;br/&gt;
Do we agree here?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Peter&lt;/p&gt;</comment>
                            <comment id="16138136" author="pvary" created="Wed, 23 Aug 2017 09:27:02 +0000"  >&lt;p&gt;Resubmitting &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mithun&quot; class=&quot;user-hover&quot; rel=&quot;mithun&quot;&gt;mithun&lt;/a&gt;&apos;s patch to run the tests&lt;/p&gt;</comment>
                            <comment id="16138225" author="hiveqa" created="Wed, 23 Aug 2017 11:04:24 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12883297/HIVE-16908.4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12883297/HIVE-16908.4.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 6 failed/errored test(s), 10994 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestBeeLineDriver.testCliDriver[create_merge_compressed] (batchId=240)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[spark_vectorized_dynamic_partition_pruning] (batchId=169)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=100)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=235)
org.apache.hadoop.hive.common.TestFileUtils.testCopyWithDistCpAs (batchId=250)
org.apache.hadoop.hive.common.TestFileUtils.testCopyWithDistcp (batchId=250)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/6500/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/6500/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/6500/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/6500/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-6500/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-6500/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 6 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12883297 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="16138358" author="pvary" created="Wed, 23 Aug 2017 13:42:23 +0000"  >&lt;p&gt;The failing tests are not related:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;TestBeeLineDriver.testCliDriver create_merge_compressed is caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-17370&quot; title=&quot;Some tests are failing with java.io.FileNotFoundException: File file:/tmp/hadoop/mapred/...&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-17370&quot;&gt;&lt;del&gt;HIVE-17370&lt;/del&gt;&lt;/a&gt;: Some tests are failing with java.io.FileNotFoundException: File &lt;a href=&quot;file:/tmp/hadoop/mapred/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/tmp/hadoop/mapred/&lt;/a&gt;...&lt;/li&gt;
	&lt;li&gt;TestMiniSparkOnYarnCliDriver.testCliDriver spark_vectorized_dynamic_partition_pruning - &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-17122&quot; title=&quot;spark_vectorized_dynamic_partition_pruning.q is continuously failing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-17122&quot;&gt;&lt;del&gt;HIVE-17122&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
spark_vectorized_dynamic_partition_pruning.q is continuously failing&lt;/li&gt;
	&lt;li&gt;TestFileUtils are caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-17327&quot; title=&quot;LLAP IO: restrict native file ID usage to default FS to avoid hypothetical collisions when HDFS federation is used&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-17327&quot;&gt;&lt;del&gt;HIVE-17327&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
LLAP IO: restrict native file ID usage to default FS to avoid hypothetical collisions when HDFS federation is used&lt;/li&gt;
	&lt;li&gt;The other two are known flaky&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16140181" author="pvary" created="Thu, 24 Aug 2017 15:34:05 +0000"  >&lt;p&gt;Pushed &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mithun&quot; class=&quot;user-hover&quot; rel=&quot;mithun&quot;&gt;mithun&lt;/a&gt;&apos;s patch to master.&lt;br/&gt;
Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mithun&quot; class=&quot;user-hover&quot; rel=&quot;mithun&quot;&gt;mithun&lt;/a&gt; for the patch!&lt;/p&gt;

&lt;p&gt;And thanks for &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sbeeram&quot; class=&quot;user-hover&quot; rel=&quot;sbeeram&quot;&gt;sbeeram&lt;/a&gt; to not accepting &quot;it runs&quot; solution as a final one. Created the followup Jira for you - &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-17384&quot; title=&quot;Launching metastore in a different process for tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-17384&quot;&gt;HIVE-17384&lt;/a&gt;&lt;br/&gt;
Launching metastore in a different process for tests&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Peter&lt;/p&gt;</comment>
                            <comment id="16143309" author="mithun" created="Mon, 28 Aug 2017 02:33:18 +0000"  >&lt;p&gt;Thanks for checking this patch in in my absence, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pvary&quot; class=&quot;user-hover&quot; rel=&quot;pvary&quot;&gt;pvary&lt;/a&gt;. We are agreed that this solution is not ideal. I look forward to reviewing &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-17384&quot; title=&quot;Launching metastore in a different process for tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-17384&quot;&gt;HIVE-17384&lt;/a&gt;, or contributing to it, if time permits.&lt;/p&gt;</comment>
                            <comment id="16486159" author="vgarg" created="Tue, 22 May 2018 23:59:23 +0000"  >&lt;p&gt;Hive 3.0.0 has been released so closing this jira.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="13085305">HIVE-17057</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13096769">HIVE-17369</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13078040">HIVE-16844</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13096769">HIVE-17369</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13078040">HIVE-16844</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12873958" name="HIVE-16908.1.patch" size="33098" author="sbeeram" created="Wed, 21 Jun 2017 22:04:44 +0000"/>
                            <attachment id="12873983" name="HIVE-16908.2.patch" size="34814" author="sbeeram" created="Thu, 22 Jun 2017 00:59:37 +0000"/>
                            <attachment id="12879456" name="HIVE-16908.3.patch" size="19193" author="mithun" created="Sat, 29 Jul 2017 00:02:01 +0000"/>
                            <attachment id="12883297" name="HIVE-16908.4.patch" size="19193" author="pvary" created="Wed, 23 Aug 2017 09:26:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 26 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3gbev:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>