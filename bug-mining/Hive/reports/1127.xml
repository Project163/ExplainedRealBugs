<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:04:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-3428] Fix log4j configuration errors when running hive on hadoop23</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3428</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;There are log4j configuration errors when running hive on hadoop23, some of them may fail testcases, since the following log4j error message could printed to console, or to output file, which diffs from the expected output:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; &amp;lt; log4j:ERROR Could not find value for key log4j.appender.NullAppender&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; &amp;lt; log4j:ERROR Could not instantiate appender named &quot;NullAppender&quot;.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; &amp;lt; 12/09/04 11:34:42 WARN conf.HiveConf: hive-site.xml not found on CLASSPATH&lt;/p&gt;</description>
                <environment></environment>
        <key id="12606175">HIVE-3428</key>
            <summary>Fix log4j configuration errors when running hive on hadoop23</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hagleitn">Gunther Hagleitner</assignee>
                                    <reporter username="zhenxiao">Zhenxiao Luo</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Sep 2012 22:55:54 +0000</created>
                <updated>Thu, 16 May 2013 21:10:21 +0000</updated>
                            <resolved>Wed, 27 Feb 2013 07:22:16 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.11.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="13448158" author="zhenxiao" created="Tue, 4 Sep 2012 23:05:30 +0000"  >&lt;p&gt;Problems in the current log4j configuration:&lt;/p&gt;

&lt;p&gt;1. When hive is running MapReduce job using hadoop(which locates in testutils/hadoop), hadoop is configured using HADOOP_CONF_DIR. While, currently, HADOOP_CONF_DIR is not set properly(not set at all except for pdk scripts).&lt;/p&gt;

&lt;p&gt;2. hadoop is by default doing log4j initialization by reading log4j.properties in its HADOOP_CONF_DIR. We do have a hive-log4j.properties, which is used to initialize hive log4j, but no such log4j.properties exited for hadoop.&lt;/p&gt;

&lt;p&gt;3. In the current hive-log4j.properties file, there is no log4j.appender.NullAppender defined, which could produce the following log4j error message:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; &amp;lt; log4j:ERROR Could not find value for key log4j.appender.NullAppender&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; &amp;lt; log4j:ERROR Could not instantiate appender named &quot;NullAppender&quot;.&lt;/p&gt;

&lt;p&gt;4. The current log4j Event Counter Appender is initialized with an deprecated value, which would produce the following warning message:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; &amp;lt; WARNING: org.apache.hadoop.metrics.jvm.EventCounter is deprecated. Please use org.apache.hadoop.log.metrics.EventCounter in all the log4j.properties files.&lt;/p&gt;</comment>
                            <comment id="13448187" author="zhenxiao" created="Tue, 4 Sep 2012 23:22:51 +0000"  >&lt;p&gt;Review Request submitted at:&lt;br/&gt;
&lt;a href=&quot;https://reviews.facebook.net/D5133&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D5133&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13451692" author="cwsteinbach" created="Sun, 9 Sep 2012 22:49:52 +0000"  >&lt;p&gt;+1. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13451694" author="cwsteinbach" created="Sun, 9 Sep 2012 22:57:21 +0000"  >&lt;p&gt;This patch seems to break lots of stuff on 0.21.&lt;/p&gt;

&lt;p&gt;@Zhenxiao: Did you try running any tests on trunk with the standard configuration (i.e. using Hadoop 0.21)?&lt;/p&gt;</comment>
                            <comment id="13452456" author="zhenxiao" created="Mon, 10 Sep 2012 21:15:18 +0000"  >&lt;p&gt;Updated patch submitted for review at:&lt;br/&gt;
&lt;a href=&quot;https://reviews.facebook.net/D5133&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D5133&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13452577" author="cwsteinbach" created="Mon, 10 Sep 2012 23:39:09 +0000"  >&lt;p&gt;More comments on phabricator.&lt;/p&gt;</comment>
                            <comment id="13453659" author="zhenxiao" created="Wed, 12 Sep 2012 02:52:11 +0000"  >&lt;p&gt;Updated patch, review request submitted at:&lt;br/&gt;
&lt;a href=&quot;https://reviews.facebook.net/D5133&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D5133&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13455342" author="zhenxiao" created="Thu, 13 Sep 2012 21:43:21 +0000"  >&lt;p&gt;Updated patch. comments addressed. review request submitted at:&lt;br/&gt;
&lt;a href=&quot;https://reviews.facebook.net/D5133&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D5133&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13458309" author="cwsteinbach" created="Tue, 18 Sep 2012 23:58:52 +0000"  >&lt;p&gt;@Zhenxiao: please see my comments on phabricator.&lt;/p&gt;</comment>
                            <comment id="13458344" author="zhenxiao" created="Wed, 19 Sep 2012 01:26:59 +0000"  >&lt;p&gt;@Carl:&lt;br/&gt;
Thanks for the comments. I updated my patch at:&lt;br/&gt;
&lt;a href=&quot;https://reviews.facebook.net/D5133&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D5133&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13498550" author="ashutoshc" created="Fri, 16 Nov 2012 02:31:09 +0000"  >&lt;p&gt;Patch doesn&apos;t apply cleanly. Zhenxiao, can you please refresh the patch?&lt;/p&gt;</comment>
                            <comment id="13542594" author="hagleitn" created="Thu, 3 Jan 2013 00:25:02 +0000"  >&lt;p&gt;Patch doesn&apos;t seem to provide configuration for hadoop.mr.rev=20S (hadoop 1-line). More importantly, if the only difference between the files is the Hadoop&apos;s deprecated EventCounter, it seems better to create a shim class for that. This way there&apos;s only one conf file and hive will pick the right file from the classpath at runtime.&lt;/p&gt;</comment>
                            <comment id="13542598" author="hagleitn" created="Thu, 3 Jan 2013 00:28:22 +0000"  >&lt;p&gt;Proposed shim for EventCounter class. Does not contain NullAppender or HADOOP_CONF variable.&lt;/p&gt;</comment>
                            <comment id="13553395" author="zhenxiao" created="Tue, 15 Jan 2013 01:45:43 +0000"  >&lt;p&gt;Hi Gunther, would you please add a review request at:&lt;br/&gt;
&lt;a href=&quot;https://reviews.facebook.net/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/&lt;/a&gt;&lt;br/&gt;
It is easy to review there.&lt;/p&gt;</comment>
                            <comment id="13584033" author="hagleitn" created="Fri, 22 Feb 2013 07:04:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zhenxiao&quot; class=&quot;user-hover&quot; rel=&quot;zhenxiao&quot;&gt;zhenxiao&lt;/a&gt;: Sorry for the delay: &lt;a href=&quot;https://reviews.facebook.net/D8805&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.facebook.net/D8805&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13587425" author="ashutoshc" created="Tue, 26 Feb 2013 19:25:43 +0000"  >&lt;p&gt;+1 Running tests.&lt;/p&gt;</comment>
                            <comment id="13588080" author="ashutoshc" created="Wed, 27 Feb 2013 07:22:16 +0000"  >&lt;p&gt;Committed to trunk. Thanks, Gunther!&lt;/p&gt;</comment>
                            <comment id="13588405" author="hudson" created="Wed, 27 Feb 2013 15:01:27 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1989 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1989/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1989/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3428&quot; title=&quot;Fix log4j configuration errors when running hive on hadoop23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3428&quot;&gt;&lt;del&gt;HIVE-3428&lt;/del&gt;&lt;/a&gt; : Fix log4j configuration errors when running hive on hadoop23 (Gunther Hagleitner via Ashutosh Chauhan) (Revision 1450645)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
hashutosh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1450645&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1450645&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/conf/hive-log4j.properties&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/conf/hive-log4j.properties&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/scripts/conf/log4j.properties&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/conf/hive-exec-log4j.properties&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/common/java/org/apache/hadoop/hive/shims/HiveEventCounter.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/common/java/org/apache/hadoop/hive/shims/ShimLoader.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13623029" author="hudson" created="Thu, 4 Apr 2013 23:39:53 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #138 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/138/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/138/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3428&quot; title=&quot;Fix log4j configuration errors when running hive on hadoop23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3428&quot;&gt;&lt;del&gt;HIVE-3428&lt;/del&gt;&lt;/a&gt; : Fix log4j configuration errors when running hive on hadoop23 (Gunther Hagleitner via Ashutosh Chauhan) (Revision 1450645)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
hashutosh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1450645&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1450645&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/conf/hive-log4j.properties&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/conf/hive-log4j.properties&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/scripts/conf/log4j.properties&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/conf/hive-exec-log4j.properties&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/common/java/org/apache/hadoop/hive/shims/HiveEventCounter.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/common/java/org/apache/hadoop/hive/shims/ShimLoader.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12633478">HIVE-4049</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12627108">HIVE-3886</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12570947" name="HIVE-3428.1.D8805.patch" size="6715" author="hagleitn" created="Tue, 26 Feb 2013 08:25:39 +0000"/>
                            <attachment id="12543771" name="HIVE-3428.1.patch.txt" size="5184" author="zhenxiao" created="Tue, 4 Sep 2012 23:23:08 +0000"/>
                            <attachment id="12544531" name="HIVE-3428.2.patch.txt" size="9406" author="zhenxiao" created="Mon, 10 Sep 2012 21:16:53 +0000"/>
                            <attachment id="12544757" name="HIVE-3428.3.patch.txt" size="36283" author="zhenxiao" created="Wed, 12 Sep 2012 02:51:31 +0000"/>
                            <attachment id="12545060" name="HIVE-3428.4.patch.txt" size="36323" author="zhenxiao" created="Thu, 13 Sep 2012 21:43:41 +0000"/>
                            <attachment id="12545649" name="HIVE-3428.5.patch.txt" size="36906" author="zhenxiao" created="Wed, 19 Sep 2012 01:27:15 +0000"/>
                            <attachment id="12545656" name="HIVE-3428.6.patch.txt" size="37284" author="zhenxiao" created="Wed, 19 Sep 2012 03:01:02 +0000"/>
                            <attachment id="12563003" name="HIVE-3428_SHIM_EVENT_COUNTER.patch" size="7139" author="hagleitn" created="Thu, 3 Jan 2013 00:28:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>258114</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 33 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0kmyv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>118538</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>