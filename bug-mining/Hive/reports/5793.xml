<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:56:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-17429] Hive JDBC doesn&apos;t return rows when querying Impala</title>
                <link>https://issues.apache.org/jira/browse/HIVE-17429</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The Hive JDBC driver used to return a result set when querying Impala.  Now, instead, it gets data back but interprets the data as query logs instead of a resultSet.  This causes many issues (we see complaints about beeline as well as test failures).&lt;/p&gt;

&lt;p&gt;This appears to be a regression introduced with asynchronous operation against Hive.&lt;/p&gt;

&lt;p&gt;Ideally, we could make both behaviors work.  I have a simple patch that should fix the problem.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13099317">HIVE-17429</key>
            <summary>Hive JDBC doesn&apos;t return rows when querying Impala</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zamsden">Zach Amsden</assignee>
                                    <reporter username="zamsden">Zach Amsden</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Sep 2017 21:19:45 +0000</created>
                <updated>Mon, 24 Jun 2019 19:31:52 +0000</updated>
                            <resolved>Fri, 8 Sep 2017 00:34:43 +0000</resolved>
                                    <version>2.1.0</version>
                    <version>2.2.0</version>
                    <version>2.3.0</version>
                    <version>2.3.1</version>
                    <version>2.3.2</version>
                                    <fixVersion>2.1.0</fixVersion>
                    <fixVersion>2.1.1</fixVersion>
                    <fixVersion>2.2.1</fixVersion>
                    <fixVersion>2.3.4</fixVersion>
                    <fixVersion>2.4.0</fixVersion>
                    <fixVersion>3.0.0</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="16151312" author="aihuaxu" created="Fri, 1 Sep 2017 23:53:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zamsden&quot; class=&quot;user-hover&quot; rel=&quot;zamsden&quot;&gt;zamsden&lt;/a&gt; Thanks for the patch. Can you rename the patch name to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-17429&quot; title=&quot;Hive JDBC doesn&amp;#39;t return rows when querying Impala&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-17429&quot;&gt;&lt;del&gt;HIVE-17429&lt;/del&gt;&lt;/a&gt;.1.patch to trigger the pre-commit build? &lt;/p&gt;</comment>
                            <comment id="16154524" author="zamsden" created="Tue, 5 Sep 2017 23:02:28 +0000"  >&lt;p&gt;That doesn&apos;t seem to have triggered the pre-commit build and it&apos;s taken far too long.  Any way to kick that build off manually?&lt;/p&gt;</comment>
                            <comment id="16154553" author="vihangk1" created="Tue, 5 Sep 2017 23:22:33 +0000"  >&lt;p&gt;I see your patch next in the line in the queue. &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16154650" author="hiveqa" created="Wed, 6 Sep 2017 00:51:40 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12885449/HIVE-17429.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12885449/HIVE-17429.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 5 failed/errored test(s), 11026 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestAccumuloCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=230)
TestDummy - did not produce a TEST-*.xml file (likely timed out) (batchId=230)
TestTxnCommandsBase - did not produce a TEST-*.xml file (likely timed out) (batchId=280)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[insert_values_orig_table_use_metadata] (batchId=61)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=234)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/6680/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/6680/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/6680/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/6680/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-6680/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-6680/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 5 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12885449 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="16154651" author="vihangk1" created="Wed, 6 Sep 2017 00:52:36 +0000"  >&lt;p&gt;Oh, now that I looked at this again it was running it for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-17428&quot; title=&quot;REPL LOAD of ALTER_PARTITION event doesn&amp;#39;t create import tasks if the partition doesn&amp;#39;t exist during analyze phase.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-17428&quot;&gt;&lt;del&gt;HIVE-17428&lt;/del&gt;&lt;/a&gt; not this one. My bad. I don&apos;t know whats going on with this patch. I see it is running &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-17426&quot; title=&quot;Execution framework in hive to run tasks in parallel&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-17426&quot;&gt;&lt;del&gt;HIVE-17426&lt;/del&gt;&lt;/a&gt; and I see it picks up &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-17428&quot; title=&quot;REPL LOAD of ALTER_PARTITION event doesn&amp;#39;t create import tasks if the partition doesn&amp;#39;t exist during analyze phase.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-17428&quot;&gt;&lt;del&gt;HIVE-17428&lt;/del&gt;&lt;/a&gt; but not this one.&lt;/p&gt;</comment>
                            <comment id="16154657" author="vihangk1" created="Wed, 6 Sep 2017 00:56:37 +0000"  >&lt;p&gt;I was about to attach the patch again but looks like it posted the results just in time.&lt;/p&gt;</comment>
                            <comment id="16155693" author="zamsden" created="Wed, 6 Sep 2017 17:04:10 +0000"  >&lt;p&gt;Hmm, these test failures seem to indicate possible timeouts, but missing .xml files could also indicate that metadata wasn&apos;t picked up.  Can someone from Hive take a quick look and see if these might be expected failures?&lt;/p&gt;</comment>
                            <comment id="16156030" author="zamsden" created="Wed, 6 Sep 2017 21:02:58 +0000"  >&lt;p&gt;org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver&lt;span class=&quot;error&quot;&gt;&amp;#91;query14&amp;#93;&lt;/span&gt; looks like a difference in test output caused by a WARNING line output in different order.&lt;/p&gt;

&lt;p&gt;Running org.apache.hadoop.hive.cli.TestAccumuloCliDriver definitely looks like a timeout, this is the last output from Maven:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[INFO] 
[INFO] --- maven-surefire-plugin:2.18.1:test (default-test) @ hive-it-qfile-accumulo ---
[INFO] Surefire report directory: /home/hiveptest/35.193.110.99-hiveptest-0/apache-github-source-source/itests/qtest-accumulo/target/surefire-reports

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running org.apache.hadoop.hive.cli.TestAccumuloCliDriver
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16156404" author="aihuaxu" created="Thu, 7 Sep 2017 03:59:06 +0000"  >&lt;p&gt;The tests don&apos;t look related to the change. +1. &lt;/p&gt;</comment>
                            <comment id="16157926" author="aihuaxu" created="Fri, 8 Sep 2017 00:34:43 +0000"  >&lt;p&gt;Pushed to master (3.0). Thanks Zach for the work.&lt;/p&gt;</comment>
                            <comment id="16429084" author="markmsmith" created="Fri, 6 Apr 2018 22:23:17 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aihuaxu&quot; class=&quot;user-hover&quot; rel=&quot;aihuaxu&quot;&gt;aihuaxu&lt;/a&gt;, just a heads-up that while this fix is in the 2.1.x branch and master, it&apos;s not in the 2.2.x or 2.3.x branches.&#160; Since 2.3.x is the latest&#160;release&#160;available on maven central just now, it&apos;ll probably bite quite a few people trying to&#160;use it with Impala.&lt;/p&gt;

&lt;p&gt;I&apos;ve added the relevant releases to the &apos;Affects Versions&apos; field, but you may want to consider porting&#160;the fix to 2.3 if you&apos;re planning to do any more releases before 3.0, since it&apos;s not really usable with Impala without it.&lt;/p&gt;</comment>
                            <comment id="16436440" author="aihuaxu" created="Thu, 12 Apr 2018 22:57:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markmsmith&quot; class=&quot;user-hover&quot; rel=&quot;markmsmith&quot;&gt;markmsmith&lt;/a&gt; The change has been backported to 2.2 and 2.3 branches.&lt;/p&gt;</comment>
                            <comment id="16449955" author="markmsmith" created="Tue, 24 Apr 2018 14:29:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aihuaxu&quot; class=&quot;user-hover&quot; rel=&quot;aihuaxu&quot;&gt;aihuaxu&lt;/a&gt; thank you very much for backporting it, I&apos;m sorry it&apos;s taken me some time to circle back and try upgrading again.&#160;&lt;/p&gt;

&lt;p&gt;Unfortunately, I&apos;m still seeing the same problem with 2.2.1 and 2.3.3 with an exception being thrown from here:&#160;&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/hive/blob/rel/release-2.3.3/jdbc/src/java/org/apache/hive/jdbc/HiveStatement.java#L477&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/blob/rel/release-2.3.3/jdbc/src/java/org/apache/hive/jdbc/HiveStatement.java#L477&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;so I think there must be some other issue with how GetOperationStatus() is being built in the underlying TCLIService.Iface&#160;client:&#160;&#160;&lt;/p&gt;

&lt;p&gt;[https://github.com/apache/hive/blob/rel/release-2.3.3/jdbc/src/java/org/apache/hive/jdbc/HiveStatement.java#L254&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/hive/blob/rel/release-2.3.3/jdbc/src/java/org/apache/hive/jdbc/HiveStatement.java#L367&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/blob/rel/release-2.3.3/jdbc/src/java/org/apache/hive/jdbc/HiveStatement.java#L367&lt;/a&gt;|https://github.com/apache/hive/blob/rel/release-2.3.3/jdbc/src/java/org/apache/hive/jdbc/HiveStatement.java#L367]&#160;&#160;&lt;/p&gt;

&lt;p&gt;Unless the underlying client&apos;s response is fixed, I think the 2.2.x and 2.3.x branches will need to do the same workaround/fix as master, also checking the `stmtHandle` for a resultSet:&#160;&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/hive/blob/master/jdbc/src/java/org/apache/hive/jdbc/HiveStatement.java#L269&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/blob/master/jdbc/src/java/org/apache/hive/jdbc/HiveStatement.java#L269&lt;/a&gt;&#160;&#160;&lt;/p&gt;

&lt;p&gt;In case you want to test the same queries as I&apos;m running against Impala via JDBC, I&apos;m doing the following:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&quot;SHOW TABLE STATS foo.oldTable&quot;&lt;/li&gt;
	&lt;li&gt;&quot;CREATE EXTERNAL TABLE&#160;foo.newTable LIKE&#160;foo.oldTable&#160;STORED AS PARQUET LOCATION &apos;hdfs://MyNameServer/location/newFooDir&apos;&quot;&lt;/li&gt;
	&lt;li&gt;&quot;SHOW CREATE TABLE foo.TEMP_newTable&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I admit that the two &quot;SHOW&quot; ones are a little unusual as &apos;queries&apos;, but they seem to work fine&#160;with the&#160;2.1.1 driver.&lt;/p&gt;</comment>
                            <comment id="16451260" author="aihuaxu" created="Tue, 24 Apr 2018 21:37:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markmsmith&quot; class=&quot;user-hover&quot; rel=&quot;markmsmith&quot;&gt;markmsmith&lt;/a&gt; I guess I may have marked the wrong version since 2.3.3 is already released. It will be in the next 2.3.x. 2.2.1 is not releases so should have such change. How did you test out against 2.2.1? Did you sync and build against the latest branch-2.2 branch?&lt;/p&gt;</comment>
                            <comment id="16485171" author="ashutoshc" created="Tue, 22 May 2018 23:14:44 +0000"  >&lt;p&gt;This jira is resolved and released with Hive 3.0 If you find an issue with it, please create a new jira.&lt;/p&gt;</comment>
                            <comment id="16871728" author="alangates" created="Mon, 24 Jun 2019 19:31:52 +0000"  >&lt;p&gt;Patch committed to branch-2&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12885426" name="HIVE-17429.1.patch" size="1358" author="zamsden" created="Tue, 5 Sep 2017 18:09:51 +0000"/>
                            <attachment id="12885449" name="HIVE-17429.2.patch" size="1358" author="zamsden" created="Tue, 5 Sep 2017 20:19:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 21 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3jkfb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Check for resultSet returned by TExecuteRequest in Hive JDBC.  This preserves compatibility when fetching data from Impala.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>