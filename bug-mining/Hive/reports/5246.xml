<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:51:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-15688] LlapServiceDriver - an option to start the cluster immediately</title>
                <link>https://issues.apache.org/jira/browse/HIVE-15688</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;run.sh is very slow because it&apos;s 4 calls to slider, which means 4 JVMs, 4 connections to RM and other crap, for   2-5sec. of overhead per call, depending on the machine/cluster.&lt;br/&gt;
What we need is a mode for llapservicedriver that would not generate run.sh, but would rather run the cluster immediately by calling the corresponding 4 slider APIs. &lt;del&gt;Should probably be the default, too&lt;/del&gt;. For compat with scripts we might generate &lt;del&gt;blank&lt;/del&gt; run.sh for now.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13036771">HIVE-15688</key>
            <summary>LlapServiceDriver - an option to start the cluster immediately</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sershe">Sergey Shelukhin</assignee>
                                    <reporter username="sershe">Sergey Shelukhin</reporter>
                        <labels>
                    </labels>
                <created>Sat, 21 Jan 2017 03:31:16 +0000</created>
                <updated>Fri, 21 Jul 2017 18:36:10 +0000</updated>
                            <resolved>Fri, 10 Feb 2017 01:32:39 +0000</resolved>
                                                    <fixVersion>2.3.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15832779" author="sershe" created="Sat, 21 Jan 2017 03:32:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gopalv&quot; class=&quot;user-hover&quot; rel=&quot;gopalv&quot;&gt;gopalv&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hagleitn&quot; class=&quot;user-hover&quot; rel=&quot;hagleitn&quot;&gt;hagleitn&lt;/a&gt; fyi&lt;/p&gt;</comment>
                            <comment id="15845920" author="sershe" created="Mon, 30 Jan 2017 21:06:29 +0000"  >&lt;p&gt;WIP patch. Currently stuck on the error where agent tarball is not found during create. Seems like there&apos;s no good way to find it from Hive; the API just assumes it&apos;s in the lib directory&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Caused by: java.io.FileNotFoundException: File /grid/5/sershe/tez-autobuild/dist/hive/lib/slider-agent.tar.gz does not exist
   at org.apache.hadoop.fs.RawLocalFileSystem.deprecatedGetFileStatus(RawLocalFileSystem.java:606)
   at org.apache.hadoop.fs.RawLocalFileSystem.getFileLinkStatusInternal(RawLocalFileSystem.java:819)
   at org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:596)
   at org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:421)
   at org.apache.hadoop.fs.FileUtil.copy(FileUtil.java:337)
   at org.apache.hadoop.fs.FileSystem.copyFromLocalFile(FileSystem.java:1965)
   at org.apache.slider.providers.ProviderUtils.addAgentTar(ProviderUtils.java:128)
   at org.apache.slider.providers.agent.AgentClientProvider.prepareAMAndConfigForLaunch(AgentClientProvider.java:270)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15845990" author="sershe" created="Mon, 30 Jan 2017 21:42:06 +0000"  >&lt;p&gt;I think for now client will have to specify slider home. Or we may include a workaround like the one used to find spark speculatively in bin/hive&lt;/p&gt;</comment>
                            <comment id="15846296" author="sershe" created="Tue, 31 Jan 2017 02:17:41 +0000"  >&lt;p&gt;This changes LlapServiceDriver to have 2 modes - one (not default, triggered by --doNotStart argument) is the old one, the other starts LLAP cluster immediately after package generation using slider APIs (SLIDER_HOME may need to be supplied, see the patch).&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gopalv&quot; class=&quot;user-hover&quot; rel=&quot;gopalv&quot;&gt;gopalv&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sseth&quot; class=&quot;user-hover&quot; rel=&quot;sseth&quot;&gt;sseth&lt;/a&gt; can you take a look?&lt;/p&gt;

&lt;p&gt;RB at &lt;a href=&quot;https://reviews.apache.org/r/56108/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/56108/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15849355" author="sseth" created="Thu, 2 Feb 2017 03:48:33 +0000"  >&lt;p&gt;I don&apos;t think start should be the default. That breaks existing behaviour which a lot of people are likely used to.&lt;br/&gt;
Thought we&apos;d be doing this by continuing to generate a run.sh - which invokes a single java binary (instead of the 4 slider commands), accepting parameters for whether a destroy is required etc. That still saves most of the time, and retains compatibility. Having a package sit around which can be invoked multiple times is really useful while debugging. Also serves as a history for what was started (think this may still be the case - except without the run.sh). Most of the code would remain unchanged - except for the run.sh generation which points to the slider command or the new Java launch.&lt;/p&gt;</comment>
                            <comment id="15850372" author="sershe" created="Thu, 2 Feb 2017 19:43:01 +0000"  >&lt;p&gt;run.sh is still generated, and could be used to restart the cluster. I can change the default behavior though. Having an extra JVM still has a lot of overhead given how big Hive classpath, configs, etc. is, and most of the time people want to start the cluster immediately after generating the package.&lt;/p&gt;</comment>
                            <comment id="15850754" author="sershe" created="Thu, 2 Feb 2017 23:48:54 +0000"  >&lt;p&gt;Changed the default&lt;/p&gt;</comment>
                            <comment id="15852497" author="sseth" created="Sat, 4 Feb 2017 02:19:32 +0000"  >&lt;p&gt;If I&apos;m reading this correctly, when the &quot;startImmediately&quot; option is specified, the following happens&lt;br/&gt;
1) Normal processing in the JavaServiceDriver&lt;br/&gt;
2) This then invokes package.py with a specific OUTPU_DIR, and invokes the start.&lt;br/&gt;
3) The java processing falls off, and we run package.py again - which generates the same contents as what we do today.&lt;/p&gt;

&lt;p&gt;Is that correct?&lt;/p&gt;

&lt;p&gt;On the patch itself&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;scriptArgs.add(OUTPUT_DIR_PREFIX + version);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Should this be to a temporary directory?&lt;/p&gt;

&lt;p&gt;Move startCluster into SliderUtils?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (rc == 0) {
          startCluster(options.getName(), version,
              HiveConf.getVar(conf, ConfVars.LLAP_DAEMON_QUEUE_NAME));
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Some error checking  / message returned from calling python would be useful in case this fails.&lt;/p&gt;


&lt;p&gt;Even if we run via this, was hoping we&apos;d generate a run.sh which could invoke java instead of the command line slider tools. Re-strating with the same settings happens quite often while testing.&lt;/p&gt;

&lt;p&gt;Unrelated to this jira: Any idea why package.py is in python. Is this something that can be moved to Java later, so that we don&apos;t have logic split in 2 places?&lt;/p&gt;</comment>
                            <comment id="15852518" author="sershe" created="Sat, 4 Feb 2017 03:01:33 +0000"  >&lt;p&gt;package.py exits immediately when invoked with the new arg and not from the java process. The one invoked from the java process generates everything still.&lt;/p&gt;</comment>
                            <comment id="15854591" author="sseth" created="Mon, 6 Feb 2017 19:29:09 +0000"  >&lt;p&gt;Right. Missed that.&lt;br/&gt;
Are we ignoring the OUTPUT_DIR specified by the user in that case?&lt;/p&gt;</comment>
                            <comment id="15854972" author="sershe" created="Mon, 6 Feb 2017 23:38:36 +0000"  >&lt;p&gt;fixed that&lt;/p&gt;</comment>
                            <comment id="15857044" author="sseth" created="Tue, 7 Feb 2017 23:43:21 +0000"  >&lt;p&gt;+1 for the latest patch.&lt;/p&gt;</comment>
                            <comment id="15859615" author="hiveqa" created="Thu, 9 Feb 2017 14:56:55 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12851465/HIVE-15688.04.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12851465/HIVE-15688.04.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 3 failed/errored test(s), 10242 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestDerbyConnector - did not produce a TEST-*.xml file (likely timed out) (batchId=235)
org.apache.hadoop.hive.cli.TestEncryptedHDFSCliDriver.testCliDriver[encryption_join_with_different_encryption_keys] (batchId=159)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=223)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/3462/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/3462/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/3462/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/3462/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://104.198.109.242/logs/PreCommit-HIVE-Build-3462/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://104.198.109.242/logs/PreCommit-HIVE-Build-3462/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12851465 - PreCommit-HIVE-Build&lt;/p&gt;</comment>
                            <comment id="15860514" author="sershe" created="Fri, 10 Feb 2017 01:32:39 +0000"  >&lt;p&gt;Committed to master. Thanks for the review&lt;/p&gt;</comment>
                            <comment id="15860887" author="lefty@hortonworks.com" created="Fri, 10 Feb 2017 07:57:20 +0000"  >&lt;p&gt;Should this be documented in the wiki?&lt;/p&gt;

&lt;p&gt;So far, all we have for LLAP is the design doc:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/LLAP&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Design Docs &amp;#8211; Completed &amp;#8211; LLAP &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16013506" author="lefty@hortonworks.com" created="Wed, 17 May 2017 04:38:34 +0000"  >&lt;p&gt;Again, does this need to be documented?&lt;/p&gt;</comment>
                            <comment id="16014515" author="sershe" created="Wed, 17 May 2017 17:56:15 +0000"  >&lt;p&gt;Looks like the original is not documented... maybe? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                            <outwardlinks description="requires">
                                        <issuelink>
            <issuekey id="13039008">SLIDER-1192</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12850718" name="HIVE-15688.01.patch" size="31282" author="sershe" created="Thu, 2 Feb 2017 23:48:54 +0000"/>
                            <attachment id="12851259" name="HIVE-15688.02.patch" size="31760" author="sershe" created="Mon, 6 Feb 2017 23:38:36 +0000"/>
                            <attachment id="12851284" name="HIVE-15688.03.patch" size="31782" author="sershe" created="Tue, 7 Feb 2017 02:11:26 +0000"/>
                            <attachment id="12851465" name="HIVE-15688.04.patch" size="32220" author="sershe" created="Tue, 7 Feb 2017 20:15:24 +0000"/>
                            <attachment id="12850108" name="HIVE-15688.patch" size="31310" author="sershe" created="Tue, 31 Jan 2017 02:17:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 27 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3911b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>