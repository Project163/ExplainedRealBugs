<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 17:57:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-307] &quot;LOAD DATA LOCAL INPATH&quot; fails when the table already contains a file of the same name</title>
                <link>https://issues.apache.org/jira/browse/HIVE-307</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Failed with exception checkPaths: /user/zshao/warehouse/tmp_user_msg_history/test_user_msg_history already exists&lt;br/&gt;
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MoveTask&lt;/p&gt;</description>
                <environment></environment>
        <key id="12415618">HIVE-307</key>
            <summary>&quot;LOAD DATA LOCAL INPATH&quot; fails when the table already contains a file of the same name</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kirktrue">Kirk True</assignee>
                                    <reporter username="zshao">Zheng Shao</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Feb 2009 21:46:57 +0000</created>
                <updated>Fri, 16 Dec 2011 23:59:35 +0000</updated>
                            <resolved>Fri, 15 Oct 2010 04:25:12 +0000</resolved>
                                    <version>0.5.0</version>
                    <version>0.6.0</version>
                                    <fixVersion>0.7.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12681130" author="jsensarma" created="Thu, 12 Mar 2009 01:18:09 +0000"  >&lt;p&gt;hey - i think this is worth fixing even though the workaround is clear. just looks kind of silly and is trivial to fix.&lt;/p&gt;</comment>
                            <comment id="12681132" author="jsensarma" created="Thu, 12 Mar 2009 01:24:09 +0000"  >&lt;p&gt;trying to avoid the wrath of the Ashish&lt;/p&gt;</comment>
                            <comment id="12681133" author="athusoo" created="Thu, 12 Mar 2009 01:28:05 +0000"  >&lt;p&gt;Thanks soooooooooo much!!&lt;/p&gt;</comment>
                            <comment id="12751233" author="lramos85" created="Fri, 4 Sep 2009 00:12:12 +0000"  >&lt;p&gt;what is the work around exactly? OVERWRITE?&lt;/p&gt;</comment>
                            <comment id="12754366" author="prasadc" created="Fri, 11 Sep 2009 21:44:11 +0000"  >&lt;p&gt;correct solution for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-718&quot; title=&quot;Load data inpath into a new partition without overwrite does not move the file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-718&quot;&gt;&lt;del&gt;HIVE-718&lt;/del&gt;&lt;/a&gt; should fix this issue as well or make it unsupported.&lt;/p&gt;</comment>
                            <comment id="12907815" author="kirktrue" created="Thu, 9 Sep 2010 23:00:45 +0000"  >&lt;p&gt;Including a patch that renames the staging files if it&apos;s noticed that they&apos;re in conflict with pre-existing files.&lt;/p&gt;</comment>
                            <comment id="12910799" author="athusoo" created="Fri, 17 Sep 2010 21:42:03 +0000"  >&lt;p&gt;Hi Kirk,&lt;/p&gt;

&lt;p&gt;Thanks for the contribution. Can you add a simple test case with your patch?&lt;/p&gt;

&lt;p&gt;Ashish&lt;/p&gt;</comment>
                            <comment id="12910802" author="athusoo" created="Fri, 17 Sep 2010 21:44:21 +0000"  >&lt;p&gt;Cancelling the patch because of a missing test case. Krik, would be great if you can resubmit with the test case. Otherwise the code looks fine to me.&lt;/p&gt;

&lt;p&gt;Ashish&lt;/p&gt;</comment>
                            <comment id="12916955" author="kirktrue" created="Fri, 1 Oct 2010 17:08:49 +0000"  >&lt;p&gt;Here is a resubmission of the patch with a CLI-based unit test.&lt;/p&gt;

&lt;p&gt;Let me know what else needs to be addressed.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="12917017" author="kirktrue" created="Fri, 1 Oct 2010 20:07:20 +0000"  >&lt;p&gt;Patch attached.&lt;/p&gt;</comment>
                            <comment id="12919410" author="namit" created="Fri, 8 Oct 2010 23:10:59 +0000"  >&lt;p&gt;Looks good - I will start the tests&lt;/p&gt;</comment>
                            <comment id="12919417" author="he yongqiang" created="Fri, 8 Oct 2010 23:18:08 +0000"  >&lt;p&gt;svn patch&lt;/p&gt;</comment>
                            <comment id="12919420" author="namit" created="Fri, 8 Oct 2010 23:22:47 +0000"  >&lt;p&gt;The code changes looked good, but the patch does not compile - mostly simple errors due to the new trunk code.&lt;/p&gt;

&lt;p&gt;Also, it would be better to have a test like this:&lt;/p&gt;


&lt;p&gt;drop table tst_src1;&lt;br/&gt;
create table tst_src1 like src1;&lt;br/&gt;
load data local inpath &apos;../data/files/kv1.txt&apos; into table tst_src1 ;&lt;br/&gt;
select count(1) from tst_src1;&lt;br/&gt;
load data local inpath &apos;../data/files/kv1.txt&apos; into table tst_src1 ;&lt;br/&gt;
select count(1) from tst_src1;&lt;br/&gt;
drop table tst_src1;&lt;/p&gt;



&lt;p&gt;We should not change src1&lt;/p&gt;</comment>
                            <comment id="12919424" author="kirktrue" created="Fri, 8 Oct 2010 23:32:04 +0000"  >&lt;p&gt;Namit - is there a DDL command to list the files inside the location? It would be great to see the renamed file show up in a describe extended tst_src1 or something.&lt;/p&gt;

&lt;p&gt;Also - do you want &lt;b&gt;me&lt;/b&gt; to make the changes or someone else?&lt;/p&gt;</comment>
                            <comment id="12919443" author="he yongqiang" created="Sat, 9 Oct 2010 00:44:42 +0000"  >&lt;p&gt;Please go ahead make the change. &lt;br/&gt;
And it will be perfect if you can upload a svn compatible patch (can be applied cleanly with &quot;patch -p0 &amp;lt;&quot; in a svn checkout).&lt;/p&gt;</comment>
                            <comment id="12919873" author="namit" created="Mon, 11 Oct 2010 15:41:56 +0000"  >&lt;p&gt;@Kirk, please go ahead and make the change.&lt;/p&gt;

&lt;p&gt;Yongqiang was just trying to get an svn compatible patch from your patch&lt;/p&gt;</comment>
                            <comment id="12920862" author="kirktrue" created="Thu, 14 Oct 2010 06:54:01 +0000"  >&lt;p&gt;Patch based against latest trunk from SVN.&lt;/p&gt;</comment>
                            <comment id="12920863" author="kirktrue" created="Thu, 14 Oct 2010 06:54:50 +0000"  >&lt;p&gt;v3 of patch includes Namit&apos;s suggested test case and rebased against SVN trunk.&lt;/p&gt;</comment>
                            <comment id="12921109" author="namit" created="Thu, 14 Oct 2010 20:31:41 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12921219" author="namit" created="Fri, 15 Oct 2010 04:25:12 +0000"  >&lt;p&gt;Committed. Thanks Kirk&lt;/p&gt;</comment>
                            <comment id="12991955" author="mosikri" created="Tue, 8 Feb 2011 12:44:03 +0000"  >&lt;p&gt;Hello Namit/Kirk/He Yongqiang,&lt;/p&gt;

&lt;p&gt;I was evaluating this defect, but it seems it is incomplete(falling short) of its cause.&lt;br/&gt;
It should also work fine for queries like&lt;/p&gt;

&lt;p&gt;LOAD DATA INPATH &apos;./kv2.txt&apos; INTO TABLE tst_src1;&lt;/p&gt;

&lt;p&gt;But unfortunately &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; it is failing, giving null pointer exception in copyFiles() method &lt;span class=&quot;error&quot;&gt;&amp;#91;Hive.java&amp;#93;&lt;/span&gt;. I tested it against Hive0.7 snapshot of the latest build.&lt;/p&gt;

&lt;p&gt;The difference between the query present in the test case and the one I mentioned   is the Path from which kv2.txt is fetched, the source path in former is a hdfs temp directory(say /tmp/hive-root/2097947077/10000 under which kv2.txt is present) whereas in the later it is a hdfs file which is being actually referred. &lt;/p&gt;

&lt;p&gt;So the changes i.e. renaming done by checkPaths() method to avoid conflict is not visible outside it&apos;s scope ;i.e. not detected by fs.listStatus() where in actual the renamed file(say /user/root/kv2.txt_copy_1) is moved to tst_src1 warehouse (say /user/hive/warehouse/tst_src1).&lt;/p&gt;

&lt;p&gt;Kindly confirm, so that I can raise a new bug or re-open the existing one.&lt;/p&gt;</comment>
                            <comment id="12992979" author="cwsteinbach" created="Thu, 10 Feb 2011 10:20:28 +0000"  >&lt;p&gt;@Mohit: Please open a new ticket for this issue. Thanks.&lt;/p&gt;</comment>
                            <comment id="12995500" author="kirktrue" created="Wed, 16 Feb 2011 20:25:02 +0000"  >&lt;p&gt;This is very closely related to, but not the same as, &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1996&quot; title=&quot;&amp;quot;LOAD DATA INPATH&amp;quot; fails when the table already contains a file of the same name&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1996&quot;&gt;&lt;del&gt;HIVE-1996&lt;/del&gt;&lt;/a&gt;. This bug specifically pertains to &lt;tt&gt;LOCAL&lt;/tt&gt; files while &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1996&quot; title=&quot;&amp;quot;LOAD DATA INPATH&amp;quot; fails when the table already contains a file of the same name&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1996&quot;&gt;&lt;del&gt;HIVE-1996&lt;/del&gt;&lt;/a&gt; is for non-&lt;tt&gt;LOCAL&lt;/tt&gt; files.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12432077">HIVE-718</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12456137" name="HIVE-307.patch" size="4061" author="kirktrue" created="Fri, 1 Oct 2010 17:08:49 +0000"/>
                            <attachment id="12454251" name="HIVE-307.patch" size="2966" author="kirktrue" created="Thu, 9 Sep 2010 23:01:00 +0000"/>
                            <attachment id="12457124" name="HIVE-307.v3.patch" size="5665" author="kirktrue" created="Thu, 14 Oct 2010 06:54:50 +0000"/>
                            <attachment id="12456749" name="hive-307.1.svn.patch" size="27547" author="he yongqiang" created="Fri, 8 Oct 2010 23:18:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73629</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 40 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l92n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122120</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>