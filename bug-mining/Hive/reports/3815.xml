<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:36:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-10980] Merge of dynamic partitions loads all data to default partition</title>
                <link>https://issues.apache.org/jira/browse/HIVE-10980</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Conditions that lead to the issue:&lt;br/&gt;
1. Execution engine set to MapReduce&lt;br/&gt;
2. Partition columns have different types&lt;br/&gt;
3. Both static and dynamic partitions are used in the query&lt;br/&gt;
4. Dynamically generated partitions require merge&lt;/p&gt;

&lt;p&gt;Result: Final data is loaded to &quot;_&lt;em&gt;HIVE_DEFAULT_PARTITION&lt;/em&gt;_&quot;.&lt;/p&gt;

&lt;p&gt;Steps to reproduce:&lt;br/&gt;
set hive.exec.dynamic.partition=true;&lt;br/&gt;
set hive.exec.dynamic.partition.mode=strict;&lt;br/&gt;
set hive.optimize.sort.dynamic.partition=false;&lt;br/&gt;
set hive.merge.mapfiles=true;&lt;br/&gt;
set hive.merge.mapredfiles=true;&lt;br/&gt;
set hive.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;&lt;br/&gt;
set hive.execution.engine=mr;&lt;/p&gt;

&lt;p&gt;create external table sdp (&lt;br/&gt;
  dataint bigint,&lt;br/&gt;
  hour int,&lt;br/&gt;
  req string,&lt;br/&gt;
  cid string,&lt;br/&gt;
  caid string&lt;br/&gt;
)&lt;br/&gt;
row format delimited&lt;br/&gt;
fields terminated by &apos;,&apos;;&lt;/p&gt;

&lt;p&gt;load data local inpath &apos;../../data/files/dynpartdata1.txt&apos; into table sdp;&lt;br/&gt;
load data local inpath &apos;../../data/files/dynpartdata2.txt&apos; into table sdp;&lt;br/&gt;
...&lt;br/&gt;
load data local inpath &apos;../../data/files/dynpartdataN.txt&apos; into table sdp;&lt;/p&gt;

&lt;p&gt;create table tdp (cid string, caid string)&lt;br/&gt;
partitioned by (dataint bigint, hour int, req string);&lt;/p&gt;

&lt;p&gt;insert overwrite table tdp partition (dataint=20150316, hour=16, req)&lt;br/&gt;
select cid, caid, req from sdp where dataint=20150316 and hour=16;&lt;/p&gt;

&lt;p&gt;select * from tdp order by caid;&lt;br/&gt;
show partitions tdp;&lt;/p&gt;

&lt;p&gt;Example of the input file:&lt;br/&gt;
20150316,16,reqA,clusterIdA,cacheId1            &lt;br/&gt;
20150316,16,reqB,clusterIdB,cacheId2         &lt;br/&gt;
20150316,16,reqA,clusterIdC,cacheId3          &lt;br/&gt;
20150316,16,reqD,clusterIdD,cacheId4        &lt;br/&gt;
20150316,16,reqA,clusterIdA,cacheId5      &lt;/p&gt;

&lt;p&gt;Actual result:&lt;br/&gt;
clusterIdA      cacheId1        20150316        16      _&lt;em&gt;HIVE_DEFAULT_PARTITION&lt;/em&gt;_ &lt;br/&gt;
clusterIdA      cacheId1        20150316        16      _&lt;em&gt;HIVE_DEFAULT_PARTITION&lt;/em&gt;_&lt;br/&gt;
clusterIdB      cacheId2        20150316        16      _&lt;em&gt;HIVE_DEFAULT_PARTITION&lt;/em&gt;_&lt;br/&gt;
clusterIdC      cacheId3        20150316        16      _&lt;em&gt;HIVE_DEFAULT_PARTITION&lt;/em&gt;_&lt;br/&gt;
clusterIdD      cacheId4        20150316        16      _&lt;em&gt;HIVE_DEFAULT_PARTITION&lt;/em&gt;_&lt;br/&gt;
clusterIdA      cacheId5        20150316        16      _&lt;em&gt;HIVE_DEFAULT_PARTITION&lt;/em&gt;_&lt;br/&gt;
clusterIdD      cacheId8        20150316        16      _&lt;em&gt;HIVE_DEFAULT_PARTITION&lt;/em&gt;_&lt;br/&gt;
clusterIdB      cacheId9        20150316        16      _&lt;em&gt;HIVE_DEFAULT_PARTITION&lt;/em&gt;_                                                                                        &lt;br/&gt;
dataint=20150316/hour=16/req=_&lt;em&gt;HIVE_DEFAULT_PARTITION&lt;/em&gt;_          &lt;/p&gt;</description>
                <environment>&lt;p&gt;HDP 2.2.4 (also reproduced on apache hive built from trunk) &lt;/p&gt;</environment>
        <key id="12837034">HIVE-10980</key>
            <summary>Merge of dynamic partitions loads all data to default partition</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yalovyyi">Illya Yalovyy</assignee>
                                    <reporter username="yalovyyi">Illya Yalovyy</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Jun 2015 05:19:51 +0000</created>
                <updated>Tue, 16 Feb 2016 23:53:25 +0000</updated>
                            <resolved>Sun, 13 Sep 2015 02:53:51 +0000</resolved>
                                    <version>0.14.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>Hive</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14581540" author="gopalv" created="Thu, 11 Jun 2015 06:44:22 +0000"  >&lt;p&gt;Are you using MapReduce or Tez?&lt;/p&gt;</comment>
                            <comment id="14582092" author="yalovyyi" created="Thu, 11 Jun 2015 15:33:56 +0000"  >&lt;p&gt;Good point. I observed this behavior on MapReduce. I&apos;ll update the ticket.&lt;/p&gt;</comment>
                            <comment id="14583655" author="yalovyyi" created="Fri, 12 Jun 2015 16:34:18 +0000"  >&lt;p&gt;I have a patch for this. Will upload it soon.&lt;/p&gt;</comment>
                            <comment id="14739561" author="yalovyyi" created="Thu, 10 Sep 2015 20:46:32 +0000"  >&lt;p&gt;Patch is submitted for review:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/38268/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/38268/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14740210" author="hiveqa" created="Fri, 11 Sep 2015 05:23:36 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12755080/HIVE-10980.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12755080/HIVE-10980.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 2 failed/errored test(s), 9437 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_index_auto_mult_tables_compact
org.apache.hive.hcatalog.api.TestHCatClient.testTableSchemaPropagation
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5232/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5232/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5232/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5232/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5232/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5232/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12755080 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14741476" author="yalovyyi" created="Fri, 11 Sep 2015 20:17:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gopalv&quot; class=&quot;user-hover&quot; rel=&quot;gopalv&quot;&gt;gopalv&lt;/a&gt;, I have reviewed failed tests:&lt;br/&gt;
org.apache.hive.hcatalog.api.TestHCatClient.testTableSchemaPropagation - was failing for many build before my patch&lt;br/&gt;
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_index_auto_mult_tables_compact - is failing for other patches as well, and I wasn&apos;t able to reproduce this failure locally. &lt;/p&gt;

&lt;p&gt;What is the best way to re-run tests?&lt;/p&gt;
</comment>
                            <comment id="14741524" author="lefty@hortonworks.com" created="Fri, 11 Sep 2015 20:55:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yalovyyi&quot; class=&quot;user-hover&quot; rel=&quot;yalovyyi&quot;&gt;yalovyyi&lt;/a&gt;, you can re-run tests by cancelling the patch (using a button on the top line) and then resubmitting it (using the Submit Patch button that will appear in the same place as the Cancel Patch button).&lt;/p&gt;</comment>
                            <comment id="14741553" author="yalovyyi" created="Fri, 11 Sep 2015 21:20:08 +0000"  >&lt;p&gt;Thank you!&lt;br/&gt;
The patch is re-submitted.&lt;/p&gt;</comment>
                            <comment id="14742145" author="ashutoshc" created="Sat, 12 Sep 2015 17:33:33 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14742306" author="ashutoshc" created="Sun, 13 Sep 2015 02:53:51 +0000"  >&lt;p&gt;Pushed to master. Thanks, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yalovyyi&quot; class=&quot;user-hover&quot; rel=&quot;yalovyyi&quot;&gt;yalovyyi&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12755080" name="HIVE-10980.patch" size="28424" author="yalovyyi" created="Thu, 10 Sep 2015 07:17:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 10 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2fwvb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>