<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:30:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-9874] Partition storage descriptors being set from table sd without copying [hbase-metastore branch]</title>
                <link>https://issues.apache.org/jira/browse/HIVE-9874</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;There are a number of places in the code where something like the following is done:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;partition.setSd(table.getSd());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This causes problems in the HBase metastore case because of the way it shares storage descriptors when they are identical.  This means when using a storage descriptor as a template for another we need to actually create a new one.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12779850">HIVE-9874</key>
            <summary>Partition storage descriptors being set from table sd without copying [hbase-metastore branch]</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gates">Alan Gates</assignee>
                                    <reporter username="gates">Alan Gates</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 Mar 2015 17:59:47 +0000</created>
                <updated>Thu, 18 Feb 2016 04:19:17 +0000</updated>
                            <resolved>Thu, 12 Mar 2015 20:01:47 +0000</resolved>
                                    <version>hbase-metastore-branch</version>
                                    <fixVersion>hbase-metastore-branch</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14355394" author="alangates" created="Tue, 10 Mar 2015 18:22:17 +0000"  >&lt;p&gt;Actually, the above causes problems not just because of the shared storage descriptors, but also because the hbase metastore is caching tables.  The above works with ObjectStore because each call to ms.getTable() returns a new table object.  HBaseStore returns the cached object again and again, so doing&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; ... {
  t = ms.getTable();
  p.setSd(t.getSd());
  p.getSd().setLocation(...);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;causes problems.&lt;/p&gt;

&lt;p&gt;This patch actually needs to fix three issues:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;This re-use of table storage descriptors in partitions without copying;&lt;/li&gt;
	&lt;li&gt;HBaseStore is currently attaching the storage descriptor from HBase directly to the table and partitions, which is wrong.  It should instead be attaching a SharedStorageDescriptor with a unique location and a reference to the storage descriptor from HBase.&lt;/li&gt;
	&lt;li&gt;The SharedStorageDescriptor needs copy-on-write semantics so that when a user does &lt;tt&gt;table.getSd().setInputFormat(&quot;something different&quot;)&lt;/tt&gt; it only changes the storage descriptor for that table rather than for everything that shares a storage descriptor with that table (eg all its partitions).&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="14355400" author="alangates" created="Tue, 10 Mar 2015 18:23:02 +0000"  >&lt;p&gt;This patch depends on &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-9885&quot; title=&quot;HBase metastore protobufs need to check hasX() functions for values that are not auto set in serialization [hbase-metastore branch]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-9885&quot;&gt;&lt;del&gt;HIVE-9885&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14359251" author="alangates" created="Thu, 12 Mar 2015 19:49:01 +0000"  >&lt;p&gt;New version of the patch that doesn&apos;t include code from &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-9885&quot; title=&quot;HBase metastore protobufs need to check hasX() functions for values that are not auto set in serialization [hbase-metastore branch]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-9885&quot;&gt;&lt;del&gt;HIVE-9885&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14359274" author="alangates" created="Thu, 12 Mar 2015 20:01:47 +0000"  >&lt;p&gt;Patch 2 committed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12704236" name="HIVE-9874-2.patch" size="30106" author="gates" created="Thu, 12 Mar 2015 19:49:01 +0000"/>
                            <attachment id="12703705" name="HIVE-9874.patch" size="55124" author="gates" created="Tue, 10 Mar 2015 18:23:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 36 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i26eun:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>