<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:04:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-4104] Hive localtask does not buffer disk-writes or reads</title>
                <link>https://issues.apache.org/jira/browse/HIVE-4104</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Hive&apos;s HashMapWrapper does not use any buffering in its File I/O, but operates sequentially for writes &amp;amp; reads.&lt;/p&gt;

&lt;p&gt;The strace logs show clearly that&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;9495  write(222, &lt;span class=&quot;code-quote&quot;&gt;&quot;x&quot;&lt;/span&gt;, 1)                = 1
9495  write(222, &lt;span class=&quot;code-quote&quot;&gt;&quot;sq\0~\0\5&quot;&lt;/span&gt;, 6)        = 6
9495  write(222, &lt;span class=&quot;code-quote&quot;&gt;&quot;w\25&quot;&lt;/span&gt;, 2)             = 2
9495  write(222, &lt;span class=&quot;code-quote&quot;&gt;&quot;\0\0\0\1\0\0\0\1\0\0\0\2\0\0\0\5\3\1M\1S&quot;&lt;/span&gt;, 21) = 21
9495  write(222, &lt;span class=&quot;code-quote&quot;&gt;&quot;x&quot;&lt;/span&gt;, 1)                = 1
9495  write(222, &lt;span class=&quot;code-quote&quot;&gt;&quot;sq\0~\0\2&quot;&lt;/span&gt;, 6)        = 6
9495  write(222, &lt;span class=&quot;code-quote&quot;&gt;&quot;w\t&quot;&lt;/span&gt;, 2)              = 2
9495  write(222, &lt;span class=&quot;code-quote&quot;&gt;&quot;\0\0\0\5\1\215\r\325v&quot;&lt;/span&gt;, 9) = 9
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12634917">HIVE-4104</key>
            <summary>Hive localtask does not buffer disk-writes or reads</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gopalv">Gopal Vijayaraghavan</assignee>
                                    <reporter username="gopalv">Gopal Vijayaraghavan</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Mar 2013 22:12:06 +0000</created>
                <updated>Thu, 16 May 2013 21:10:29 +0000</updated>
                            <resolved>Sun, 3 Mar 2013 19:29:05 +0000</resolved>
                                                    <fixVersion>0.11.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13591008" author="gopalv" created="Fri, 1 Mar 2013 22:19:05 +0000"  >&lt;p&gt;Before&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2013-03-01 05:15:13	Dump the hashtable into file: file:/tmp/root/hive_2013-03-01_17-14-59_468_442960319525994949/-local-10002/HashTable-Stage-1/MapJoin-customer_demographics-01--.hashtable
2013-03-01 05:15:27	Upload 1 File to: file:/tmp/root/hive_2013-03-01_17-14-59_468_442960319525994949/-local-10002/HashTable-Stage-1/MapJoin-customer_demographics-01--.hashtable File size: 18426794
2013-03-01 05:15:27	End of local task; Time Taken: 22.314 sec.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2013-03-01 05:15:53	Dump the hashtable into file: file:/tmp/root/hive_2013-03-01_17-15-39_668_1531738824783900468/-local-10002/HashTable-Stage-1/MapJoin-demographics-01--.hashtable
2013-03-01 05:15:54	Upload 1 File to: file:/tmp/root/hive_2013-03-01_17-15-39_668_1531738824783900468/-local-10002/HashTable-Stage-1/MapJoin-demographics-01--.hashtable File size: 18426794
2013-03-01 05:15:54	End of local task; Time Taken: 9.601 sec.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Savings are found on the map-side read as well.&lt;/p&gt;

&lt;p&gt;Before&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Job 0: Map: 4   Cumulative CPU: 64.79 sec   HDFS Read: 300156 HDFS Write: 1682 SUCCESS
Total MapReduce CPU Time Spent: 1 minutes 4 seconds 790 msec

Time taken: 56.385 seconds, Fetched: 100 row(s)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Job 0: Map: 4   Cumulative CPU: 26.95 sec   HDFS Read: 300156 HDFS Write: 1682 SUCCESS
Total MapReduce CPU Time Spent: 26 seconds 950 msec

Time taken: 38.173 seconds, Fetched: 100 row(s)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13591010" author="brocknoland" created="Fri, 1 Mar 2013 22:20:32 +0000"  >&lt;p&gt;Nice find!&lt;/p&gt;</comment>
                            <comment id="13591011" author="gopalv" created="Fri, 1 Mar 2013 22:20:43 +0000"  >&lt;p&gt;Buffer I/O for HashMapWrapper&lt;/p&gt;</comment>
                            <comment id="13591628" author="ashutoshc" created="Sun, 3 Mar 2013 03:54:58 +0000"  >&lt;p&gt;+1&lt;br/&gt;
Nice catch Gopal. Any guidance on size of buffer. Wondering higher value (8K?, 64K?) will result in higher saving.&lt;/p&gt;</comment>
                            <comment id="13591668" author="gopalv" created="Sun, 3 Mar 2013 07:35:57 +0000"  >&lt;p&gt;Increasing the size up from 4kb to 64kb did not seem to make any appreciable difference.&lt;/p&gt;

&lt;p&gt;I would assume that 4kb works because it is the disk write block-size.&lt;/p&gt;</comment>
                            <comment id="13591841" author="ashutoshc" created="Sun, 3 Mar 2013 19:29:05 +0000"  >&lt;p&gt;Committed to trunk. Thanks, Gopal!&lt;/p&gt;</comment>
                            <comment id="13591946" author="hudson" created="Mon, 4 Mar 2013 02:49:01 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1998 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1998/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1998/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4104&quot; title=&quot;Hive localtask does not buffer disk-writes or reads&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4104&quot;&gt;&lt;del&gt;HIVE-4104&lt;/del&gt;&lt;/a&gt; : Hive localtask does not buffer disk-writes or reads (Gopal V via Ashutosh Chauhan) (Revision 1452104)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
hashutosh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1452104&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1452104&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/persistence/HashMapWrapper.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13623005" author="hudson" created="Thu, 4 Apr 2013 23:39:48 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #138 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/138/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/138/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4104&quot; title=&quot;Hive localtask does not buffer disk-writes or reads&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4104&quot;&gt;&lt;del&gt;HIVE-4104&lt;/del&gt;&lt;/a&gt; : Hive localtask does not buffer disk-writes or reads (Gopal V via Ashutosh Chauhan) (Revision 1452104)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
hashutosh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1452104&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1452104&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/persistence/HashMapWrapper.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12571666" name="HIVE-4104.patch" size="1488" author="gopalv" created="Fri, 1 Mar 2013 22:20:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>315410</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 33 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ifef:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>315754</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Buffer I/O on HashMapWrapper to speed up write/read ops</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>