<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:37:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-11849] NPE in HiveHBaseTableShapshotInputFormat in query with just count(*)</title>
                <link>https://issues.apache.org/jira/browse/HIVE-11849</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Adding the following example as a qfile test in hbase-handler fails. Looks like this may have been introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5277&quot; title=&quot;HBase handler skips rows with null valued first cells when only row key is selected&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5277&quot;&gt;&lt;del&gt;HIVE-5277&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;SET hive.hbase.snapshot.name=src_hbase_snapshot;
SET hive.hbase.snapshot.restoredir=/tmp;

select count(*) from src_hbase;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12873073">HIVE-11849</key>
            <summary>NPE in HiveHBaseTableShapshotInputFormat in query with just count(*)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="enis">Enis Soztutar</assignee>
                                    <reporter username="jdere">Jason Dere</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Sep 2015 18:43:42 +0000</created>
                <updated>Tue, 16 Feb 2016 23:53:03 +0000</updated>
                            <resolved>Mon, 21 Sep 2015 18:12:07 +0000</resolved>
                                    <version>1.3.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>HBase Handler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14790908" author="jdere" created="Wed, 16 Sep 2015 18:47:18 +0000"  >&lt;p&gt;Stack trace showing the issue (not from the qfile test):&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.NullPointerException
at org.apache.hadoop.hive.hbase.HiveHBaseTableSnapshotInputFormat.setColumns(HiveHBaseTableSnapshotInputFormat.java:48)
at org.apache.hadoop.hive.hbase.HiveHBaseTableSnapshotInputFormat.getSplits(HiveHBaseTableSnapshotInputFormat.java:57)
at org.apache.hadoop.hive.ql.io.HiveInputFormat.addSplitsForGroup(HiveInputFormat.java:305)
at org.apache.hadoop.hive.ql.io.HiveInputFormat.getSplits(HiveInputFormat.java:407)
at org.apache.hadoop.hive.ql.io.CombineHiveInputFormat.getCombineSplits(CombineHiveInputFormat.java:361)
at org.apache.hadoop.hive.ql.io.CombineHiveInputFormat.getSplits(CombineHiveInputFormat.java:571)
at org.apache.hadoop.mapreduce.JobSubmitter.writeOldSplits(JobSubmitter.java:328)
at org.apache.hadoop.mapreduce.JobSubmitter.writeSplits(JobSubmitter.java:320)
at org.apache.hadoop.mapreduce.JobSubmitter.submitJobInternal(JobSubmitter.java:196)
at org.apache.hadoop.mapreduce.Job$10.run(Job.java:1290)
at org.apache.hadoop.mapreduce.Job$10.run(Job.java:1287)
at java.security.AccessController.doPrivileged(Native Method)
at javax.security.auth.Subject.doAs(Subject.java:415)
at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1657)
at org.apache.hadoop.mapreduce.Job.submit(Job.java:1287)
at org.apache.hadoop.mapred.JobClient$1.run(JobClient.java:575)
at org.apache.hadoop.mapred.JobClient$1.run(JobClient.java:570)
at java.security.AccessController.doPrivileged(Native Method)
at javax.security.auth.Subject.doAs(Subject.java:415)
at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1657)
at org.apache.hadoop.mapred.JobClient.submitJobInternal(JobClient.java:570)
at org.apache.hadoop.mapred.JobClient.submitJob(JobClient.java:561)
at org.apache.hadoop.hive.ql.exec.mr.ExecDriver.execute(ExecDriver.java:431)
at org.apache.hadoop.hive.ql.exec.mr.MapRedTask.execute(MapRedTask.java:137)
at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:160)
at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:89)
at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1655)
at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1414)
at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1195)
at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1059)
at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1049)
at org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:213)
at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:165)
at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:376)
at org.apache.hadoop.hive.cli.CliDriver.executeDriver(CliDriver.java:736)
at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:681)
at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:621)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:606)
at org.apache.hadoop.util.RunJar.run(RunJar.java:221)
at org.apache.hadoop.util.RunJar.main(RunJar.java:136)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14791221" author="enis" created="Wed, 16 Sep 2015 22:16:35 +0000"  >&lt;p&gt;Offline conversation with Jason, we have noted a couple of things: &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;HiveHBaseTableSnapshotInputFormat.java uses the mapred API while HiveHBaseTableInputFormat uses the mapreduce API. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ndimiduk&quot; class=&quot;user-hover&quot; rel=&quot;ndimiduk&quot;&gt;ndimiduk&lt;/a&gt; I remember you were talking about specifically that all Hive IFs use mapred. Is that changed?&lt;/li&gt;
	&lt;li&gt;mapred version of the HBase&apos;s TableMapreduceUtil does not have the utility methods to pass the Scan serialized inside the job configuration. The only supported way is to set the Scan through now-deprecated &lt;tt&gt;TableInputFormat.COLUMN_LIST&lt;/tt&gt;.&lt;/li&gt;
	&lt;li&gt;Although the &lt;tt&gt;mapred.TableMapreduceUtil&lt;/tt&gt; does not support setting the serialized scan, we can still manually set it and have the TSIF work correctly since the mapred and mapreduce versions use the same underlying implementation (&lt;tt&gt;TableSnapshotInputFormatImpl&lt;/tt&gt;).&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="14791247" author="ndimiduk" created="Wed, 16 Sep 2015 22:38:59 +0000"  >&lt;p&gt;Yeah, IIRC, this stuff is a big mess of the two different mapred API&apos;s across the two projects. Have a look at some of the linked issues from &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6584&quot; title=&quot;Add HiveHBaseTableSnapshotInputFormat&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6584&quot;&gt;&lt;del&gt;HIVE-6584&lt;/del&gt;&lt;/a&gt;. Notable TODO items were &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11179&quot; title=&quot;API parity between mapred and mapreduce&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11179&quot;&gt;&lt;del&gt;HBASE-11179&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11163&quot; title=&quot;Support providing a Scan instance in mapred.TableMapReduceUtil&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11163&quot;&gt;&lt;del&gt;HBASE-11163&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-7534&quot; title=&quot;remove reflection from HBaseSplit&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-7534&quot;&gt;HIVE-7534&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14804295" author="jdere" created="Thu, 17 Sep 2015 19:04:39 +0000"  >&lt;p&gt;Attaching patch from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;enis&lt;/a&gt; which appears to fix the test case added. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ndimiduk&quot; class=&quot;user-hover&quot; rel=&quot;ndimiduk&quot;&gt;ndimiduk&lt;/a&gt; or any other folks that work on HBase handler, does this look like the right thing to do?&lt;/p&gt;</comment>
                            <comment id="14804730" author="ndimiduk" created="Fri, 18 Sep 2015 00:14:53 +0000"  >&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+  // Copied from HBase&apos;s TableMapreduceUtil since it is not public API
+  // mapred does not support it unlike mapreduce.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Would be good if this were tied to a TODO and an HBASE ticket. Otherwise, +1.&lt;/p&gt;</comment>
                            <comment id="14804751" author="enis" created="Fri, 18 Sep 2015 00:37:16 +0000"  >&lt;p&gt;Thanks Nick for the review. v2 patch expands the comment with the TODO and &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11163&quot; title=&quot;Support providing a Scan instance in mapred.TableMapReduceUtil&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11163&quot;&gt;&lt;del&gt;HBASE-11163&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;</comment>
                            <comment id="14876050" author="jdere" created="Fri, 18 Sep 2015 17:55:03 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14876546" author="jdere" created="Fri, 18 Sep 2015 22:06:51 +0000"  >&lt;p&gt;re-uploading patch v2 to conform to precommit naming scheme&lt;/p&gt;</comment>
                            <comment id="14876752" author="hiveqa" created="Sat, 19 Sep 2015 00:45:45 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12761205/HIVE-11849.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12761205/HIVE-11849.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 6 failed/errored test(s), 9452 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_index_auto_mult_tables_compact
org.apache.hive.hcatalog.api.TestHCatClient.testTableSchemaPropagation
org.apache.hive.hcatalog.streaming.TestStreaming.testInterleavedTransactionBatchCommits
org.apache.hive.hcatalog.streaming.TestStreaming.testTransactionBatchEmptyCommit
org.apache.hive.spark.client.TestSparkClient.testJobSubmission
org.apache.hive.spark.client.TestSparkClient.testSyncRpc
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5330/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5330/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5330/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5330/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5330/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5330/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 6 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12761205 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14876831" author="jdere" created="Sat, 19 Sep 2015 02:10:43 +0000"  >&lt;p&gt;The TestHCatClient/TestSparkClient tests have been failing the last few precommit tests, so are existing conditions.&lt;/p&gt;

&lt;p&gt;The TestCliDriver/TestStreaming tests do not fail when I run locally. Is TestStreaming a flaky test? I saw other failings on another patch I had submitted.&lt;/p&gt;</comment>
                            <comment id="14901115" author="jdere" created="Mon, 21 Sep 2015 18:12:07 +0000"  >&lt;p&gt;Committed to master/branch-1&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12668191">HIVE-5277</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12757134" name="HIVE-11849.1.patch" size="3516" author="jdere" created="Thu, 17 Sep 2015 19:04:39 +0000"/>
                            <attachment id="12761205" name="HIVE-11849.2.patch" size="3573" author="jdere" created="Fri, 18 Sep 2015 22:06:51 +0000"/>
                            <attachment id="12757183" name="hive-11849_v2.patch" size="3573" author="enis" created="Fri, 18 Sep 2015 00:37:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 9 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2k9kv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>