<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:26:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-28972] HMS performace degradation post HIVE-28909 for alter query</title>
                <link>https://issues.apache.org/jira/browse/HIVE-28972</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;ENV: Hive master branch (26e6880c9053717c17e5e6416451750e832d46c9) + JAVA 8 + Datanucleus 5.x, HMS mem: 8GB&lt;/p&gt;

&lt;p&gt;Decription: I have a table with 800 columns and 5000 partitions. I ran&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
alter table test_tbl add columns (col801 string) cascade; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and without &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-28909&quot; title=&quot;After DataNucleus upgrade to 6.0.8 for JDK17 compatibility, there are unnecessary update queries executing by DN&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-28909&quot;&gt;&lt;del&gt;HIVE-28909&lt;/del&gt;&lt;/a&gt;&#160;it took 117.42 sec but with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-28909&quot; title=&quot;After DataNucleus upgrade to 6.0.8 for JDK17 compatibility, there are unnecessary update queries executing by DN&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-28909&quot;&gt;&lt;del&gt;HIVE-28909&lt;/del&gt;&lt;/a&gt;&#160;it is taking &lt;b&gt;986.065 sec&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Steps to reproduce:&lt;/b&gt;&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Create partitioned table with 800 columns (attaching the create table sql)&lt;/li&gt;
	&lt;li&gt;Create 5000 or so empty partitions in hdfs (I used &lt;a href=&quot;https://github.com/Aggarwal-Raghav/Concurrent-Partition-Gen&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/Aggarwal-Raghav/Concurrent-Partition-Gen&lt;/a&gt; )&lt;/li&gt;
	&lt;li&gt;Run msck repair table test_tbl to load the partitions to HMS&lt;/li&gt;
	&lt;li&gt;alter table test_tbl add columns (col801 string) cascade;&#160;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Attaching all the captured info i.e. HMS logs, HMS2, beeline screenshots with and without &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-28909&quot; title=&quot;After DataNucleus upgrade to 6.0.8 for JDK17 compatibility, there are unnecessary update queries executing by DN&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-28909&quot;&gt;&lt;del&gt;HIVE-28909&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The following log is coming: &lt;b&gt;4006601 times&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2025-05-27T23:08:02,690 &#160;INFO [Metastore-Handler-Pool: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-64] DataNucleus.Persistence: &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hive.metastore.model.MColumnDescriptor@68097e71&quot;&lt;/span&gt; has a collection &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hive.metastore.model.MColumnDescriptor.fields&quot;&lt;/span&gt; yet element &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hive.metastore.model.MColumn@43adb9db&quot;&lt;/span&gt; doesnt have the owner set. Managing the relation and setting the owner.
2025-05-27T23:08:02,690 &#160;INFO [Metastore-Handler-Pool: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-64] DataNucleus.Persistence: &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hive.metastore.model.MColumnDescriptor@68097e71&quot;&lt;/span&gt; has a collection &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hive.metastore.model.MColumnDescriptor.fields&quot;&lt;/span&gt; yet element &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hive.metastore.model.MColumn@29276cc5&quot;&lt;/span&gt; doesnt have the owner set. Managing the relation and setting the owner.
2025-05-27T23:08:02,690 &#160;INFO [Metastore-Handler-Pool: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-64] DataNucleus.Persistence: &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hive.metastore.model.MColumnDescriptor@68097e71&quot;&lt;/span&gt; has a collection &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hive.metastore.model.MColumnDescriptor.fields&quot;&lt;/span&gt; yet element &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hive.metastore.model.MColumn@109992db&quot;&lt;/span&gt; doesnt have the owner set. Managing the relation and setting the owner.
2025-05-27T23:08:02,691 &#160;INFO [Metastore-Handler-Pool: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-64] DataNucleus.Persistence: &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hive.metastore.model.MColumnDescriptor@68097e71&quot;&lt;/span&gt; has a collection &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hive.metastore.model.MColumnDescriptor.fields&quot;&lt;/span&gt; yet element &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hive.metastore.model.MColumn@69748f31&quot;&lt;/span&gt; doesnt have the owner set. Managing the relation and setting the owner.
2025-05-27T23:08:02,691 &#160;INFO [Metastore-Handler-Pool: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-64] DataNucleus.Persistence: &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hive.metastore.model.MColumnDescriptor@68097e71&quot;&lt;/span&gt; has a collection &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hive.metastore.model.MColumnDescriptor.fields&quot;&lt;/span&gt; yet element &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hive.metastore.model.MColumn@6ae74875&quot;&lt;/span&gt; doesnt have the owner set. Managing the relation and setting the owner. &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13619345">HIVE-28972</key>
            <summary>HMS performace degradation post HIVE-28909 for alter query</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dengzh">Zhihua Deng</assignee>
                                    <reporter username="Aggarwal_Raghav">Raghav Aggarwal</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 27 May 2025 18:02:52 +0000</created>
                <updated>Tue, 29 Jul 2025 14:51:17 +0000</updated>
                            <resolved>Tue, 3 Jun 2025 03:09:48 +0000</resolved>
                                                    <fixVersion>4.1.0</fixVersion>
                                    <component>Standalone Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17954387" author="JIRAUSER295901" created="Tue, 27 May 2025 18:12:23 +0000"  >&lt;p&gt;Have enabled DataNucelus INFO logs in log4j2.properties then captured hms logs, attached above.&lt;/p&gt;</comment>
                            <comment id="17954389" author="hemanth619" created="Tue, 27 May 2025 18:24:27 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dengzh&quot; class=&quot;user-hover&quot; rel=&quot;dengzh&quot;&gt;dengzh&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17954403" author="JIRAUSER295901" created="Tue, 27 May 2025 19:37:01 +0000"  >&lt;p&gt;More Info (WITH &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-28909&quot; title=&quot;After DataNucleus upgrade to 6.0.8 for JDK17 compatibility, there are unnecessary update queries executing by DN&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-28909&quot;&gt;&lt;del&gt;HIVE-28909&lt;/del&gt;&lt;/a&gt;): Attaching the VisualVM Heap graph (which show &lt;del&gt;memory leak&lt;/del&gt;&#160; increased heap usage)&lt;/p&gt;</comment>
                            <comment id="17955806" author="dengzh" created="Tue, 3 Jun 2025 03:09:48 +0000"  >&lt;p&gt;Fix has been pushed to master. Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Aggarwal_Raghav&quot; class=&quot;user-hover&quot; rel=&quot;Aggarwal_Raghav&quot;&gt;Aggarwal_Raghav&lt;/a&gt; for reporting the issue and testing the PR, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dkuzmenko&quot; class=&quot;user-hover&quot; rel=&quot;dkuzmenko&quot;&gt;dkuzmenko&lt;/a&gt; for the review!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13615535">HIVE-28909</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13076715" name="Beeline_Output_with_HIVE-28909.png" size="1879420" author="Aggarwal_Raghav" created="Tue, 27 May 2025 18:14:22 +0000"/>
                            <attachment id="13076716" name="Beeline_Output_without_HIVE-28909.png" size="1612444" author="Aggarwal_Raghav" created="Tue, 27 May 2025 18:14:22 +0000"/>
                            <attachment id="13076719" name="HMS_Heap_Graph.png" size="756984" author="Aggarwal_Raghav" created="Tue, 27 May 2025 19:37:08 +0000"/>
                            <attachment id="13076718" name="VisualVM_Graphs.png" size="785582" author="Aggarwal_Raghav" created="Tue, 27 May 2025 19:37:04 +0000"/>
                            <attachment id="13076710" name="create_tbl.sql" size="12245" author="Aggarwal_Raghav" created="Tue, 27 May 2025 18:03:47 +0000"/>
                            <attachment id="13076714" name="hivemetastore_with_HIVE-28909.log.tar.gz" size="41085703" author="Aggarwal_Raghav" created="Tue, 27 May 2025 18:04:19 +0000"/>
                            <attachment id="13076711" name="hivemetastore_without_HIVE-28909.log" size="3736139" author="Aggarwal_Raghav" created="Tue, 27 May 2025 18:03:57 +0000"/>
                            <attachment id="13076713" name="hiveserver2_with_HIVE-28909.log" size="482513" author="Aggarwal_Raghav" created="Tue, 27 May 2025 18:04:07 +0000"/>
                            <attachment id="13076712" name="hiveserver2_without_HIVE-28909.log" size="488637" author="Aggarwal_Raghav" created="Tue, 27 May 2025 18:04:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1w2a0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>