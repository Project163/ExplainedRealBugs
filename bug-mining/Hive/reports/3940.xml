<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:38:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-12053] Stats performance regression caused by HIVE-11786</title>
                <link>https://issues.apache.org/jira/browse/HIVE-12053</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11786&quot; title=&quot;Deprecate the use of redundant column in colunm stats related tables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11786&quot;&gt;&lt;del&gt;HIVE-11786&lt;/del&gt;&lt;/a&gt; tried to normalize table TAB_COL_STATS/PART_COL_STATS but caused performance regression.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12902987">HIVE-12053</key>
            <summary>Stats performance regression caused by HIVE-11786</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ctang">Chaoyu Tang</assignee>
                                    <reporter username="ctang">Chaoyu Tang</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Oct 2015 13:22:12 +0000</created>
                <updated>Tue, 16 Feb 2016 23:50:15 +0000</updated>
                            <resolved>Thu, 15 Oct 2015 21:02:05 +0000</resolved>
                                                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14947764" author="ctang.ma" created="Wed, 7 Oct 2015 23:01:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sseth&quot; class=&quot;user-hover&quot; rel=&quot;sseth&quot;&gt;sseth&lt;/a&gt; have found that creating following indexes would not help to improve the stats performance either&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CREATE INDEX COLNAME_TBLID_IDX ON TAB_COL_STATS (COLUMN_NAME, TBL_ID);
CREATE INDEX COLNAME_IDX ON TAB_COL_STATS (COLUMN_NAME);
CREATE INDEX COLNAME_PARTID_IDX ON PART_COL_STATS (COLUMN_NAME, PART_ID);
CREATE INDEX COLNAME_IDX ON PART_COL_STATS (COLUMN_NAME);
CREATE INDEX PARTNAME_IDX ON PARTITIONS (PART_NAME);
CREATE INDEX TBLNAME_IDX ON TBLS (TBL_NAME);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14956326" author="sseth" created="Wed, 14 Oct 2015 05:59:31 +0000"  >&lt;p&gt;Should &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11786&quot; title=&quot;Deprecate the use of redundant column in colunm stats related tables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11786&quot;&gt;&lt;del&gt;HIVE-11786&lt;/del&gt;&lt;/a&gt; be reverted while this is fixed ? The performance degradation is very noticeable. &lt;/p&gt;</comment>
                            <comment id="14956907" author="ctang.ma" created="Wed, 14 Oct 2015 13:11:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sseth&quot; class=&quot;user-hover&quot; rel=&quot;sseth&quot;&gt;sseth&lt;/a&gt; I provided a patch reverting &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11786&quot; title=&quot;Deprecate the use of redundant column in colunm stats related tables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11786&quot;&gt;&lt;del&gt;HIVE-11786&lt;/del&gt;&lt;/a&gt; here, please review it. &lt;br/&gt;
Though separating the big query to two parts like that done in getPartition in MetaStoreDirect may help to mitigate the performance impact in this case, we might have other performance issues with JDO. So probably we can leave these column stats tables unnormalized at this moment as a trade-off to the better performance. Thank you for the help.&lt;/p&gt;</comment>
                            <comment id="14957690" author="sseth" created="Wed, 14 Oct 2015 20:30:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ctang.ma&quot; class=&quot;user-hover&quot; rel=&quot;ctang.ma&quot;&gt;ctang.ma&lt;/a&gt; - the patch looks good to me. It&apos;s a direct revert of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11786&quot; title=&quot;Deprecate the use of redundant column in colunm stats related tables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11786&quot;&gt;&lt;del&gt;HIVE-11786&lt;/del&gt;&lt;/a&gt;. Does another jira need to be created to capture the intent of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11786&quot; title=&quot;Deprecate the use of redundant column in colunm stats related tables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11786&quot;&gt;&lt;del&gt;HIVE-11786&lt;/del&gt;&lt;/a&gt;, without the normalization ?&lt;/p&gt;</comment>
                            <comment id="14957740" author="hiveqa" created="Wed, 14 Oct 2015 20:55:03 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12766539/HIVE-12053.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12766539/HIVE-12053.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to no test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 17 failed/errored test(s), 9683 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_join16
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_join40
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_join_cond_pushdown_4
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_join_cond_pushdown_unqual3
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_merge1
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_outer_join_ppr
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_parallel_join0
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_sample1
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_smb_mapjoin_21
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_smb_mapjoin_6
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_stats_counter_partitioned
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_stats_only_null
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_union13
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_union_remove_9
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_vectorization_decimal_date
org.apache.hive.hcatalog.api.TestHCatClient.testTableSchemaPropagation
org.apache.hive.jdbc.TestSSL.testSSLVersion
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5650/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5650/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5650/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5650/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5650/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5650/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 17 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12766539 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14957922" author="ctang.ma" created="Wed, 14 Oct 2015 22:11:35 +0000"  >&lt;p&gt;I was not able to reproduce TestSparkCliDriver test failures in my local machine and they seem not related to this patch. The failures from testTableSchemaPropagation and testSSLVersion are also not related.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sseth&quot; class=&quot;user-hover&quot; rel=&quot;sseth&quot;&gt;sseth&lt;/a&gt; AFAIK, there has not been other implementations on top of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11786&quot; title=&quot;Deprecate the use of redundant column in colunm stats related tables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11786&quot;&gt;&lt;del&gt;HIVE-11786&lt;/del&gt;&lt;/a&gt; by now. As for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11788&quot; title=&quot;Column stats should be preserved after db/table/partition rename&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11788&quot;&gt;&lt;del&gt;HIVE-11788&lt;/del&gt;&lt;/a&gt; which depends on the schema normalization in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11786&quot; title=&quot;Deprecate the use of redundant column in colunm stats related tables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11786&quot;&gt;&lt;del&gt;HIVE-11786&lt;/del&gt;&lt;/a&gt;, it looks like that we have to update the stats tables as well in db/table/partition rename &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14959609" author="sershe" created="Thu, 15 Oct 2015 21:01:24 +0000"  >&lt;p&gt;binding +1 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14959612" author="sershe" created="Thu, 15 Oct 2015 21:02:05 +0000"  >&lt;p&gt;committed to master&lt;/p&gt;</comment>
                            <comment id="14959618" author="sershe" created="Thu, 15 Oct 2015 21:05:57 +0000"  >&lt;p&gt;Committed to branch-1.&lt;/p&gt;</comment>
                            <comment id="14959623" author="ctang.ma" created="Thu, 15 Oct 2015 21:11:35 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12863060">HIVE-11786</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12766539" name="HIVE-12053.patch" size="28295" author="ctang" created="Wed, 14 Oct 2015 13:11:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 5 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2mosf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>