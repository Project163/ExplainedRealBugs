<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:38:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-12012] select query on json table with map containing numeric values fails</title>
                <link>https://issues.apache.org/jira/browse/HIVE-12012</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;select query on json table throws this error if table contains map type column:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Failed with exception java.io.IOException:org.apache.hadoop.hive.serde2.SerDeException: org.codehaus.jackson.JsonParseException: Current token (FIELD_NAME) not numeric, can not use numeric value accessors
 at [Source: java.io.ByteArrayInputStream@295f79b; line: 1, column: 26]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;steps to reproduce the issue:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hive&amp;gt; create table c_complex(a array&amp;lt;string&amp;gt;,b map&amp;lt;string,int&amp;gt;) row format serde &apos;org.apache.hive.hcatalog.data.JsonSerDe&apos;;
OK
Time taken: 0.319 seconds
hive&amp;gt; insert into table c_complex select array(&apos;aaa&apos;),map(&apos;aaa&apos;,1) from studenttab10k limit 2;
Query ID = hrt_qa_20150826183232_47deb33a-19c0-4d2b-a92f-726659eb9413
Total jobs = 1
Launching Job 1 out of 1


Status: Running (Executing on YARN cluster with App id application_1440603993714_0010)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1 ..........   SUCCEEDED      1          1        0        0       0       0
Reducer 2 ......   SUCCEEDED      1          1        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 02/02  [==========================&amp;gt;&amp;gt;] 100%  ELAPSED TIME: 11.75 s    
--------------------------------------------------------------------------------
Loading data to table default.c_complex
Table default.c_complex stats: [numFiles=1, numRows=2, totalSize=56, rawDataSize=0]
OK
Time taken: 13.706 seconds
hive&amp;gt; select * from c_complex;
OK
Failed with exception java.io.IOException:org.apache.hadoop.hive.serde2.SerDeException: org.codehaus.jackson.JsonParseException: Current token (FIELD_NAME) not numeric, can not use numeric value accessors
 at [Source: java.io.ByteArrayInputStream@295f79b; line: 1, column: 26]
Time taken: 0.115 seconds
hive&amp;gt; select count(*) from c_complex;
OK
2
Time taken: 0.205 seconds, Fetched: 1 row(s)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12902023">HIVE-12012</key>
            <summary>select query on json table with map containing numeric values fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdere">Jason Dere</assignee>
                                    <reporter username="jvaria">Jagruti Varia</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Oct 2015 23:15:22 +0000</created>
                <updated>Tue, 16 Feb 2016 23:50:36 +0000</updated>
                            <resolved>Fri, 9 Oct 2015 17:24:02 +0000</resolved>
                                                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Serializers/Deserializers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14940585" author="jdere" created="Thu, 1 Oct 2015 23:20:22 +0000"  >&lt;p&gt;JsonSerDe seems to only support map values of type string. Attaching patch and test cases.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sushanth&quot; class=&quot;user-hover&quot; rel=&quot;sushanth&quot;&gt;sushanth&lt;/a&gt;, can you take a look? There do not seem to many tests for JsonSerDe and I want to make sure I&apos;m not breaking any behavior here.&lt;/p&gt;</comment>
                            <comment id="14940586" author="jdere" created="Thu, 1 Oct 2015 23:21:34 +0000"  >&lt;p&gt;Looks like the same problem reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/HCATALOG-630&quot; title=&quot;org.apache.hcatalog.data.JsonSerDe cannot handle maps with numeric values &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HCATALOG-630&quot;&gt;HCATALOG-630&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14941874" author="sushanth" created="Fri, 2 Oct 2015 22:17:51 +0000"  >&lt;p&gt;Thanks for the report, Jason. Sure, I can look further into this. I had looked at &lt;a href=&quot;https://issues.apache.org/jira/browse/HCATALOG-630&quot; title=&quot;org.apache.hcatalog.data.JsonSerDe cannot handle maps with numeric values &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HCATALOG-630&quot;&gt;HCATALOG-630&lt;/a&gt; a long time back but I seem to remember that I could not reproduce that at the time. If we have a more recent reproduction, it definitely is worth investigating.&lt;/p&gt;

&lt;p&gt;Tests for JsonSerDe are mostly in TestJsonSerDe, instead of in .q files, since it descends from HCatalog - that seems to test map&amp;lt;short,string&amp;gt; and map&amp;lt;string,struct&amp;lt;i:int&amp;gt;&amp;gt; as the basic cases, which work.&lt;/p&gt;

&lt;p&gt;I&apos;ll try to reproduce and dig further.&lt;/p&gt;</comment>
                            <comment id="14942489" author="hiveqa" created="Sat, 3 Oct 2015 22:37:02 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12764707/HIVE-12012.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12764707/HIVE-12012.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 2 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 2 failed/errored test(s), 9642 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.ql.TestMTQueries.testMTQueries1
org.apache.hive.hcatalog.api.TestHCatClient.testTableSchemaPropagation
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5517/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5517/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5517/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5517/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5517/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5517/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12764707 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14944293" author="jdere" created="Tue, 6 Oct 2015 00:08:00 +0000"  >&lt;p&gt;TestMTQueries seems to pass for me locally&lt;/p&gt;</comment>
                            <comment id="14945911" author="sushanth" created="Tue, 6 Oct 2015 21:58:55 +0000"  >&lt;p&gt;Ah, sorry - when you pinged me last, I did not see you&apos;d attached a patch for this - but yes, that patch fixes this issue. +1.&lt;/p&gt;</comment>
                            <comment id="14950812" author="jdere" created="Fri, 9 Oct 2015 17:24:02 +0000"  >&lt;p&gt;I&apos;ve committed this to master/branch-1&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12636833">HCATALOG-630</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12764707" name="HIVE-12012.1.patch" size="9406" author="jdere" created="Thu, 1 Oct 2015 23:20:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 6 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2miuf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>