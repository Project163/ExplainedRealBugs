<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:27:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-29084] Wrong results for LATERAL VIEW queries due to incorrect WHERE filter removal</title>
                <link>https://issues.apache.org/jira/browse/HIVE-29084</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;When CBO is enabled, queries with multiple LATERAL VIEW explode operations and WHERE clause filtering return incorrect results. WHERE clause conditions could be dropped during post-Calcite PPD processing, causing the query to return rows that should be filtered out.&lt;/p&gt;

&lt;p&gt;I can reliably reproduce the bug with 2+ occurrences of &quot;LATERAL VIEW explode()&quot; &lt;b&gt;and&lt;/b&gt; a WHERE clause; it does not seem to happen with only one &quot;LATERAL VIEW explode()&quot; or without a WHERE clause.&lt;/p&gt;

&lt;p&gt;Originally reproduced with published 4.0.1 container, then verified with locally built current master branch.&lt;/p&gt;

&lt;p&gt;I was &lt;b&gt;not&lt;/b&gt; able to reproduce it with unit tests.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&lt;b&gt;Minimal Reproduction Case:&lt;/b&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; DROP TABLE IF EXISTS cbo_lateral_view_where_bug;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; CREATE TABLE cbo_lateral_view_where_bug (values array&amp;lt;string&amp;gt;);&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; INSERT INTO cbo_lateral_view_where_bug SELECT array(&apos;a&apos;, &apos;b&apos;);&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; ANALYZE TABLE cbo_lateral_view_where_bug COMPUTE STATISTICS;&lt;/tt&gt;{{&#160; **&#160; }}&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&#160; &lt;b&gt;-- Correct result (CBO OFF)&lt;/b&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; SET hive.cbo.enable=false;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; SELECT first_val, second_val&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; FROM cbo_lateral_view_where_bug&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; LATERAL VIEW explode(values) lv1 AS first_val&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; LATERAL VIEW explode(values) lv2 AS second_val&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; WHERE first_val != second_val;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&#160; &lt;b&gt;-- Incorrect result (CBO ON)&lt;/b&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; SET hive.cbo.enable=true;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; SELECT first_val, second_val&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; FROM cbo_lateral_view_where_bug&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; LATERAL VIEW explode(values) lv1 AS first_val&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; LATERAL VIEW explode(values) lv2 AS second_val&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; WHERE first_val != second_val;&lt;/tt&gt;{{&#160; **&#160; }}&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&#160; &lt;b&gt;&#8211;- Expected vs Actual Results:&lt;/b&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; - CBO OFF (correct): 2 rows: (&apos;a&apos;,&apos;b&apos;) and (&apos;b&apos;,&apos;a&apos;)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; - CBO ON (incorrect): 4 rows: (&apos;a&apos;,&apos;b&apos;), (&apos;b&apos;,&apos;a&apos;), (&apos;a&apos;,&apos;a&apos;), (&apos;b&apos;,&apos;b&apos;)&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160; &lt;b&gt;Root Cause:&lt;/b&gt;&lt;br/&gt;
&#160; ASTConverter&apos;s LV processing assigns the same tableAlias value to all columns of the query, even ones generated as LATERAL VIEW. This causes certain conditions (OR, &quot;!=&quot;) between columns of different LV clauses (and even the LV clause and the base table) to be &quot;incorrectly pushable&quot; during PPD processing&lt;/p&gt;

&lt;p&gt;&#160; &lt;b&gt;Impact:&lt;/b&gt;&lt;br/&gt;
&#160; - Data Correctness: Queries return wrong results, not just performance issues&lt;br/&gt;
&#160; - Scope: Requires 2+ LATERAL VIEW explode operations with WHERE filtering&lt;br/&gt;
&#160; - Severity: Silent data corruption - users may not notice incorrect results&lt;/p&gt;

&lt;p&gt;&#160; &lt;b&gt;Workaround&lt;/b&gt;:&lt;br/&gt;
Set &lt;b&gt;hive.cbo.enable&lt;/b&gt;=false for queries with multiple lateral view cross-products and WHERE clause filtering. Disabling PPD also seems to bypass the problem.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Attachments:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13077437/13077437_hive_cbo_lateral_view_where_bug.sql&quot; title=&quot;hive_cbo_lateral_view_where_bug.sql attached to HIVE-29084&quot;&gt;hive_cbo_lateral_view_where_bug.sql&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; - SQL to reproduce&lt;/li&gt;
	&lt;li&gt;Hive log: &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13077436/13077436_hive_cbo_lateral_view_where_bug.log&quot; title=&quot;hive_cbo_lateral_view_where_bug.log attached to HIVE-29084&quot;&gt;hive_cbo_lateral_view_where_bug.log&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment>&lt;p&gt;&#160; - Affected Versions: Hive 4.0.1, 4.2.0-SNAPSHOT (likely all CBO+lateral view versions)&lt;br/&gt;
&#160; - Execution Engine: MapReduce (local mode)&lt;br/&gt;
&#160; - Metastore: Derby embedded&lt;/p&gt;</environment>
        <key id="13623194">HIVE-29084</key>
            <summary>Wrong results for LATERAL VIEW queries due to incorrect WHERE filter removal</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="konstantinb">Konstantin Bereznyakov</assignee>
                                    <reporter username="konstantinb">Konstantin Bereznyakov</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 11 Jul 2025 20:51:39 +0000</created>
                <updated>Tue, 16 Sep 2025 12:46:36 +0000</updated>
                            <resolved>Mon, 15 Sep 2025 11:37:16 +0000</resolved>
                                    <version>4.1.0</version>
                    <version>4.0.1</version>
                    <version>4.2.0</version>
                                    <fixVersion>4.2.0</fixVersion>
                                    <component>CBO</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="18004786" author="JIRAUSER308328" created="Fri, 11 Jul 2025 21:16:57 +0000"  >&lt;p&gt;&lt;tt&gt;I was also able to reproduce this with a simpler inline query without needing to create a table:&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;SELECT first_val, second_val&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;FROM (SELECT array(&apos;a&apos;, &apos;b&apos;) as val_array) inline_data&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;LATERAL VIEW explode(val_array) lv1 AS first_val&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;LATERAL VIEW explode(val_array) lv2 AS second_val&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;WHERE first_val != second_val;&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="18005518" author="zabetak" created="Tue, 15 Jul 2025 07:13:51 +0000"  >&lt;p&gt;Thanks for reporting this &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=konstantinb&quot; class=&quot;user-hover&quot; rel=&quot;konstantinb&quot;&gt;konstantinb&lt;/a&gt;! &lt;/p&gt;

&lt;p&gt;Is the problem specific to the MR execution engine or it is also reproducible with Tez? Note that MR is deprecated and the community is not actively fixing/improving code around this area.&lt;/p&gt;

&lt;p&gt;If the problem is due to CBO then most likely the query plan is incorrect. Can you share the result of EXPLAIN CBO for the query that returns wrong results?&lt;/p&gt;</comment>
                            <comment id="18005523" author="glapark" created="Tue, 15 Jul 2025 07:32:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zabetak&quot; class=&quot;user-hover&quot; rel=&quot;zabetak&quot;&gt;zabetak&lt;/a&gt; I tested with Hive 4.0.1 on Tez 0.10.4, and the problem is reproduced. I tested with other builds and it has the same problem.&lt;/p&gt;</comment>
                            <comment id="18007256" author="JIRAUSER308328" created="Tue, 15 Jul 2025 14:58:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zabetak&quot; class=&quot;user-hover&quot; rel=&quot;zabetak&quot;&gt;zabetak&lt;/a&gt; the problem was originally discovered with a custom Tez/custom Hive setup; I will try to provide explain results asap.&lt;/p&gt;</comment>
                            <comment id="18007274" author="JIRAUSER308328" created="Tue, 15 Jul 2025 15:53:35 +0000"  >&lt;p&gt;It looks like the WHERE clause is being dropped during the CBO step:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;SELECT first_val, second_val&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;FROM (SELECT array(&apos;a&apos;, &apos;b&apos;) as val_array) inline_data&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;LATERAL VIEW explode(val_array) lv1 AS first_val&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;LATERAL VIEW explode(val_array) lv2 AS second_val&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;WHERE first_val = second_val;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Also returns 4 records with CBO on&lt;/p&gt;</comment>
                            <comment id="18007311" author="JIRAUSER308328" created="Tue, 15 Jul 2025 19:06:54 +0000"  >&lt;p&gt;EXPLAIN with MR, CBO ON:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Connecting to jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000
&lt;/span&gt;Connected to: Apache Hive (version 4.2.0-SNAPSHOT)
Driver: Hive JDBC (version 4.2.0-SNAPSHOT)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Beeline version 4.2.0-SNAPSHOT by Apache Hive
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; SET hive.cbo.enable;
&lt;/span&gt;+-----------------------+
| &#160; &#160; &#160; &#160; &#160;set &#160; &#160; &#160; &#160; &#160;|
+-----------------------+
| hive.cbo.enable=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; &#160;|
+-----------------------+
1 row selected (0.112 seconds)
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; EXPLAIN SELECT first_val, second_val
&lt;/span&gt;. . . . . . . . . . . . . . . .&amp;gt; FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv1 AS first_val
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv2 AS second_val
. . . . . . . . . . . . . . . .&amp;gt; WHERE first_val != second_val;
INFO &#160;: Compiling command(queryId=root_20250715190418_ee80e784-5938-45a0-842b-6da8f9b74def): EXPLAIN SELECT first_val, second_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
LATERAL VIEW explode(val_array) lv2 AS second_val
WHERE first_val != second_val
INFO &#160;: Semantic Analysis Completed (retrial = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
INFO &#160;: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)], properties:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
INFO &#160;: Completed compiling command(queryId=root_20250715190418_ee80e784-5938-45a0-842b-6da8f9b74def); Time taken: 1.853 seconds
INFO &#160;: Concurrency mode is disabled, not creating a lock manager
INFO &#160;: Executing command(queryId=root_20250715190418_ee80e784-5938-45a0-842b-6da8f9b74def): EXPLAIN SELECT first_val, second_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
LATERAL VIEW explode(val_array) lv2 AS second_val
WHERE first_val != second_val
INFO &#160;: Starting task [Stage-1:EXPLAIN] in serial mode
INFO &#160;: Completed executing command(queryId=root_20250715190418_ee80e784-5938-45a0-842b-6da8f9b74def); Time taken: 0.044 seconds
+----------------------------------------------------+
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Explain &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
+----------------------------------------------------+
| Plan optimized by CBO. &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| Stage-0 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; Fetch Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; limit:-1 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; Select Operator [SEL_14] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Lateral View Join Operator [LVJ_12] &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col2&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; Select Operator [SEL_9] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; Lateral View Forward [LVF_8] &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator [LVJ_6] &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_3] &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward [LVF_2] &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_1] &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TableScan [TS_0] &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; Select Operator [SEL_14] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Lateral View Join Operator [LVJ_12] &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col2&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; UDTF Operator [UDTF_11] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; function name:explode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_10] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160;Please refer to the previous Lateral View Forward [LVF_8] |
| &#160; &#160; Select Operator [SEL_14] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Lateral View Join Operator [LVJ_12] &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col2&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; Select Operator [SEL_9] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; Lateral View Forward [LVF_8] &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator [LVJ_6] &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; UDTF Operator [UDTF_5] &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; function name:explode &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_4] &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Please refer to the previous Lateral View Forward [LVF_2] |
| &#160; &#160; Select Operator [SEL_14] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Lateral View Join Operator [LVJ_12] &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col2&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; UDTF Operator [UDTF_11] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; function name:explode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_10] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160;Please refer to the previous Lateral View Forward [LVF_8] |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
+----------------------------------------------------+
53 rows selected (2.015 seconds) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;EXPLAIN with MR, CBO off:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; SET hive.cbo.enable=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
&lt;/span&gt;No rows affected (0.01 seconds)
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; SET hive.cbo.enable;
&lt;/span&gt;+------------------------+
| &#160; &#160; &#160; &#160; &#160;set &#160; &#160; &#160; &#160; &#160; |
+------------------------+
| hive.cbo.enable=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &#160;|
+------------------------+
1 row selected (0.016 seconds)
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; EXPLAIN SELECT first_val, second_val
&lt;/span&gt;. . . . . . . . . . . . . . . .&amp;gt; FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv1 AS first_val
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv2 AS second_val
. . . . . . . . . . . . . . . .&amp;gt; WHERE first_val != second_val;
INFO &#160;: Compiling command(queryId=root_20250715190604_bbd458cc-e02c-4a25-b0b7-501dd3f1ff18): EXPLAIN SELECT first_val, second_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
LATERAL VIEW explode(val_array) lv2 AS second_val
WHERE first_val != second_val
INFO &#160;: Semantic Analysis Completed (retrial = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
INFO &#160;: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)], properties:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
INFO &#160;: Completed compiling command(queryId=root_20250715190604_bbd458cc-e02c-4a25-b0b7-501dd3f1ff18); Time taken: 0.104 seconds
INFO &#160;: Concurrency mode is disabled, not creating a lock manager
INFO &#160;: Executing command(queryId=root_20250715190604_bbd458cc-e02c-4a25-b0b7-501dd3f1ff18): EXPLAIN SELECT first_val, second_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
LATERAL VIEW explode(val_array) lv2 AS second_val
WHERE first_val != second_val
INFO &#160;: Starting task [Stage-1:EXPLAIN] in serial mode
INFO &#160;: Completed executing command(queryId=root_20250715190604_bbd458cc-e02c-4a25-b0b7-501dd3f1ff18); Time taken: 0.035 seconds
+----------------------------------------------------+
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Explain &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
+----------------------------------------------------+
| Stage-0 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; Fetch Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; limit:-1 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; Select Operator [SEL_13] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Filter Operator [FIL_15] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; predicate:(_col1 &amp;lt;&amp;gt; _col2) &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; Lateral View Join Operator [LVJ_11] &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col2&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_8] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward [LVF_7] &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator [LVJ_6] &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_3] &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward [LVF_2] &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_1] &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TableScan [TS_0] &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; Select Operator [SEL_13] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Filter Operator [FIL_15] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; predicate:(_col1 &amp;lt;&amp;gt; _col2) &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; Lateral View Join Operator [LVJ_11] &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col2&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; UDTF Operator [UDTF_10] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; function name:explode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_9] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Please refer to the previous Lateral View Forward [LVF_7] |
| &#160; &#160; Select Operator [SEL_13] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Filter Operator [FIL_15] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; predicate:(_col1 &amp;lt;&amp;gt; _col2) &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; Lateral View Join Operator [LVJ_11] &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col2&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_8] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward [LVF_7] &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator [LVJ_6] &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; UDTF Operator [UDTF_5] &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; function name:explode &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_4] &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Please refer to the previous Lateral View Forward [LVF_2] |
| &#160; &#160; Select Operator [SEL_13] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Filter Operator [FIL_15] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; predicate:(_col1 &amp;lt;&amp;gt; _col2) &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; Lateral View Join Operator [LVJ_11] &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col2&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; UDTF Operator [UDTF_10] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; function name:explode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_9] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Please refer to the previous Lateral View Forward [LVF_7] |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
+----------------------------------------------------+
59 rows selected (0.156 seconds) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="18007313" author="JIRAUSER308328" created="Tue, 15 Jul 2025 19:12:11 +0000"  >&lt;p&gt;EXPLAIN EXTENDED with MR, CBO ON:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SET hive.cbo.enable=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
No rows affected (0.016 seconds)
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; SET hive.cbo.enable;
&lt;/span&gt;+-----------------------+
| &#160; &#160; &#160; &#160; &#160;set &#160; &#160; &#160; &#160; &#160;|
+-----------------------+
| hive.cbo.enable=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; &#160;|
+-----------------------+
1 row selected (0.01 seconds)
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; EXPLAIN EXTENDED SELECT first_val, second_val
&lt;/span&gt;. . . . . . . . . . . . . . . .&amp;gt; FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv1 AS first_val
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv2 AS second_val
. . . . . . . . . . . . . . . .&amp;gt; WHERE first_val != second_val;
INFO &#160;: Compiling command(queryId=root_20250715190945_ae126f57-d8e6-4cac-86ef-e6429d6be0a6): EXPLAIN EXTENDED SELECT first_val, second_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
LATERAL VIEW explode(val_array) lv2 AS second_val
WHERE first_val != second_val
INFO &#160;: Semantic Analysis Completed (retrial = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
INFO &#160;: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)], properties:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
INFO &#160;: Completed compiling command(queryId=root_20250715190945_ae126f57-d8e6-4cac-86ef-e6429d6be0a6); Time taken: 0.21 seconds
INFO &#160;: Concurrency mode is disabled, not creating a lock manager
INFO &#160;: Executing command(queryId=root_20250715190945_ae126f57-d8e6-4cac-86ef-e6429d6be0a6): EXPLAIN EXTENDED SELECT first_val, second_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
LATERAL VIEW explode(val_array) lv2 AS second_val
WHERE first_val != second_val
INFO &#160;: Starting task [Stage-1:EXPLAIN] in serial mode
INFO &#160;: Completed executing command(queryId=root_20250715190945_ae126f57-d8e6-4cac-86ef-e6429d6be0a6); Time taken: 0.041 seconds
+----------------------------------------------------+
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Explain &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
+----------------------------------------------------+
| STAGE DEPENDENCIES: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; Stage-0 is a root stage &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| STAGE PLANS: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; Stage: Stage-0 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; Fetch Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; limit: -1 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; Processor Tree: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; TableScan &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; alias: _dummy_table &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Row Limit Per Split: 1 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; GatherStats: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; expressions: array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col0 (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1 &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1, _col2 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string), _col2 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ListSink &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col0 (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; UDTF Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; function name: explode &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1, _col2 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string), _col2 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ListSink &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: Const array&amp;lt;string&amp;gt; [a, b] (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; UDTF Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; function name: explode &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1 &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1, _col2 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string), _col2 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ListSink &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col0 (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; UDTF Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; function name: explode &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1, _col2 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string), _col2 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ListSink &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
+----------------------------------------------------+
71 rows selected (0.273 seconds) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;EXPLAIN EXTENDED with MR, CBO off&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SET hive.cbo.enable=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
No rows affected (0.006 seconds)
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; SET hive.cbo.enable;
&lt;/span&gt;+------------------------+
| &#160; &#160; &#160; &#160; &#160;set &#160; &#160; &#160; &#160; &#160; |
+------------------------+
| hive.cbo.enable=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &#160;|
+------------------------+
1 row selected (0.009 seconds)
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; EXPLAIN EXTENDED SELECT first_val, second_val
&lt;/span&gt;. . . . . . . . . . . . . . . .&amp;gt; FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv1 AS first_val
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv2 AS second_val
. . . . . . . . . . . . . . . .&amp;gt; WHERE first_val != second_val;
INFO &#160;: Compiling command(queryId=root_20250715191149_61301196-bb0d-4706-94a5-b131a19691aa): EXPLAIN EXTENDED SELECT first_val, second_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
LATERAL VIEW explode(val_array) lv2 AS second_val
WHERE first_val != second_val
INFO &#160;: Semantic Analysis Completed (retrial = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
INFO &#160;: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)], properties:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
INFO &#160;: Completed compiling command(queryId=root_20250715191149_61301196-bb0d-4706-94a5-b131a19691aa); Time taken: 0.1 seconds
INFO &#160;: Concurrency mode is disabled, not creating a lock manager
INFO &#160;: Executing command(queryId=root_20250715191149_61301196-bb0d-4706-94a5-b131a19691aa): EXPLAIN EXTENDED SELECT first_val, second_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
LATERAL VIEW explode(val_array) lv2 AS second_val
WHERE first_val != second_val
INFO &#160;: Starting task [Stage-1:EXPLAIN] in serial mode
INFO &#160;: Completed executing command(queryId=root_20250715191149_61301196-bb0d-4706-94a5-b131a19691aa); Time taken: 0.035 seconds
+----------------------------------------------------+
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Explain &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
+----------------------------------------------------+
| STAGE DEPENDENCIES: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; Stage-0 is a root stage &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| STAGE PLANS: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; Stage: Stage-0 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; Fetch Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; limit: -1 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; Processor Tree: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; TableScan &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; alias: _dummy_table &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Row Limit Per Split: 1 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; GatherStats: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; expressions: array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col0 (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1 &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1, _col2 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Filter Operator &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; isSamplingPred: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; predicate: (_col1 &amp;lt;&amp;gt; _col2) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string), _col2 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ListSink &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col0 (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; UDTF Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; function name: explode &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1, _col2 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Filter Operator &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; isSamplingPred: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; predicate: (_col1 &amp;lt;&amp;gt; _col2) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string), _col2 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ListSink &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: Const array&amp;lt;string&amp;gt; [a, b] (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; UDTF Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; function name: explode &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1 &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1, _col2 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Filter Operator &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; isSamplingPred: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; predicate: (_col1 &amp;lt;&amp;gt; _col2) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string), _col2 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ListSink &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col0 (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; UDTF Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; function name: explode &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1, _col2 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Filter Operator &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; isSamplingPred: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; predicate: (_col1 &amp;lt;&amp;gt; _col2) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string), _col2 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ListSink &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
+----------------------------------------------------+
83 rows selected (0.149 seconds) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="18007316" author="JIRAUSER308328" created="Tue, 15 Jul 2025 19:19:12 +0000"  >&lt;p&gt;from what I can tell, the plans with CBO ON drop all&#160;&lt;br/&gt;
Filter Operator&lt;br/&gt;
i.e. this &lt;em&gt;seems&lt;/em&gt; to be execution engine agnostic&lt;/p&gt;</comment>
                            <comment id="18007342" author="JIRAUSER308328" created="Tue, 15 Jul 2025 22:01:04 +0000"  >&lt;p&gt;uzing Tez, EXPLAN with CBO ON/OFF:&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Connecting to jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000
&lt;/span&gt;Connected to: Apache Hive (version 4.2.0-SNAPSHOT)
Driver: Hive JDBC (version 4.2.0-SNAPSHOT)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Beeline version 4.2.0-SNAPSHOT by Apache Hive
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; set hive.execution.engine;
&lt;/span&gt;+----------------------------+
| &#160; &#160; &#160; &#160; &#160; &#160;set &#160; &#160; &#160; &#160; &#160; &#160; |
+----------------------------+
| hive.execution.engine=tez &#160;|
+----------------------------+
1 row selected (0.055 seconds)
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; SET hive.cbo.enable;
&lt;/span&gt;+-----------------------+
| &#160; &#160; &#160; &#160; &#160;set &#160; &#160; &#160; &#160; &#160;|
+-----------------------+
| hive.cbo.enable=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; &#160;|
+-----------------------+
1 row selected (0.009 seconds)
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; EXPLAIN SELECT first_val, second_val
&lt;/span&gt;. . . . . . . . . . . . . . . .&amp;gt; FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv1 AS first_val
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv2 AS second_val
. . . . . . . . . . . . . . . .&amp;gt; WHERE first_val != second_val;
INFO &#160;: Compiling command(queryId=root_20250715215842_dfc474bd-e678-4c33-817d-5f795e61c64b): EXPLAIN SELECT first_val, second_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
LATERAL VIEW explode(val_array) lv2 AS second_val
WHERE first_val != second_val
INFO &#160;: Semantic Analysis Completed (retrial = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
INFO &#160;: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)], properties:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
INFO &#160;: Completed compiling command(queryId=root_20250715215842_dfc474bd-e678-4c33-817d-5f795e61c64b); Time taken: 0.195 seconds
INFO &#160;: Concurrency mode is disabled, not creating a lock manager
INFO &#160;: Executing command(queryId=root_20250715215842_dfc474bd-e678-4c33-817d-5f795e61c64b): EXPLAIN SELECT first_val, second_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
LATERAL VIEW explode(val_array) lv2 AS second_val
WHERE first_val != second_val
INFO &#160;: Starting task [Stage-1:EXPLAIN] in serial mode
INFO &#160;: Completed executing command(queryId=root_20250715215842_dfc474bd-e678-4c33-817d-5f795e61c64b); Time taken: 0.042 seconds
+----------------------------------------------------+
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Explain &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
+----------------------------------------------------+
| Plan optimized by CBO. &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| Stage-0 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; Fetch Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; limit:-1 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; Select Operator [SEL_14] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Lateral View Join Operator [LVJ_12] &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col2&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; Select Operator [SEL_9] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; Lateral View Forward [LVF_8] &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator [LVJ_6] &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_3] &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward [LVF_2] &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_1] &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TableScan [TS_0] &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; Select Operator [SEL_14] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Lateral View Join Operator [LVJ_12] &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col2&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; UDTF Operator [UDTF_11] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; function name:explode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_10] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160;Please refer to the previous Lateral View Forward [LVF_8] |
| &#160; &#160; Select Operator [SEL_14] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Lateral View Join Operator [LVJ_12] &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col2&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; Select Operator [SEL_9] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; Lateral View Forward [LVF_8] &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator [LVJ_6] &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; UDTF Operator [UDTF_5] &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; function name:explode &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_4] &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Please refer to the previous Lateral View Forward [LVF_2] |
| &#160; &#160; Select Operator [SEL_14] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Lateral View Join Operator [LVJ_12] &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col2&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; UDTF Operator [UDTF_11] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; function name:explode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_10] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160;Please refer to the previous Lateral View Forward [LVF_8] |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
+----------------------------------------------------+
53 rows selected (0.259 seconds)
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; &#160; SET hive.cbo.enable=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
&lt;/span&gt;No rows affected (0.013 seconds)
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; &#160; SET hive.cbo.enable;
&lt;/span&gt;+------------------------+
| &#160; &#160; &#160; &#160; &#160;set &#160; &#160; &#160; &#160; &#160; |
+------------------------+
| hive.cbo.enable=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &#160;|
+------------------------+
1 row selected (0.009 seconds)
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; EXPLAIN SELECT first_val, second_val
&lt;/span&gt;. . . . . . . . . . . . . . . .&amp;gt; FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv1 AS first_val
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv2 AS second_val
. . . . . . . . . . . . . . . .&amp;gt; WHERE first_val != second_val;
INFO &#160;: Compiling command(queryId=root_20250715215924_64920040-2823-4c01-b3ea-f5099d4edb82): EXPLAIN SELECT first_val, second_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
LATERAL VIEW explode(val_array) lv2 AS second_val
WHERE first_val != second_val
INFO &#160;: Semantic Analysis Completed (retrial = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
INFO &#160;: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)], properties:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
INFO &#160;: Completed compiling command(queryId=root_20250715215924_64920040-2823-4c01-b3ea-f5099d4edb82); Time taken: 0.109 seconds
INFO &#160;: Concurrency mode is disabled, not creating a lock manager
INFO &#160;: Executing command(queryId=root_20250715215924_64920040-2823-4c01-b3ea-f5099d4edb82): EXPLAIN SELECT first_val, second_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
LATERAL VIEW explode(val_array) lv2 AS second_val
WHERE first_val != second_val
INFO &#160;: Starting task [Stage-1:EXPLAIN] in serial mode
INFO &#160;: Completed executing command(queryId=root_20250715215924_64920040-2823-4c01-b3ea-f5099d4edb82); Time taken: 0.036 seconds
+----------------------------------------------------+
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Explain &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
+----------------------------------------------------+
| Stage-0 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; Fetch Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; limit:-1 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; Select Operator [SEL_13] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Filter Operator [FIL_15] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; predicate:(_col1 &amp;lt;&amp;gt; _col2) &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; Lateral View Join Operator [LVJ_11] &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col2&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_8] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward [LVF_7] &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator [LVJ_6] &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_3] &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward [LVF_2] &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_1] &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TableScan [TS_0] &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; Select Operator [SEL_13] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Filter Operator [FIL_15] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; predicate:(_col1 &amp;lt;&amp;gt; _col2) &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; Lateral View Join Operator [LVJ_11] &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col2&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; UDTF Operator [UDTF_10] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; function name:explode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_9] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Please refer to the previous Lateral View Forward [LVF_7] |
| &#160; &#160; Select Operator [SEL_13] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Filter Operator [FIL_15] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; predicate:(_col1 &amp;lt;&amp;gt; _col2) &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; Lateral View Join Operator [LVJ_11] &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col2&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_8] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward [LVF_7] &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator [LVJ_6] &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; UDTF Operator [UDTF_5] &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; function name:explode &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_4] &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Please refer to the previous Lateral View Forward [LVF_2] |
| &#160; &#160; Select Operator [SEL_13] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; Filter Operator [FIL_15] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; predicate:(_col1 &amp;lt;&amp;gt; _col2) &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; Lateral View Join Operator [LVJ_11] &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;_col2&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; UDTF Operator [UDTF_10] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; function name:explode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; Select Operator [SEL_9] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Output:[&lt;span class=&quot;code-quote&quot;&gt;&quot;_col0&quot;&lt;/span&gt;] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Please refer to the previous Lateral View Forward [LVF_7] |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
+----------------------------------------------------+
59 rows selected (0.159 seconds)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="18007343" author="JIRAUSER308328" created="Tue, 15 Jul 2025 22:02:55 +0000"  >&lt;p&gt;uzing Tez, EXPLAN EXTENDED with CBO ON/OFF:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SET hive.cbo.enable=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
No rows affected (0.007 seconds)
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; &#160; SET hive.cbo.enable;
&lt;/span&gt;+-----------------------+
| &#160; &#160; &#160; &#160; &#160;set &#160; &#160; &#160; &#160; &#160;|
+-----------------------+
| hive.cbo.enable=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; &#160;|
+-----------------------+
1 row selected (0.01 seconds)
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; EXPLAIN EXTENDED SELECT first_val, second_val
&lt;/span&gt;. . . . . . . . . . . . . . . .&amp;gt; FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv1 AS first_val
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv2 AS second_val
. . . . . . . . . . . . . . . .&amp;gt; WHERE first_val != second_val;
INFO &#160;: Compiling command(queryId=root_20250715220200_00940b48-adba-4296-ae50-75b5e92a0c7b): EXPLAIN EXTENDED SELECT first_val, second_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
LATERAL VIEW explode(val_array) lv2 AS second_val
WHERE first_val != second_val
INFO &#160;: Semantic Analysis Completed (retrial = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
INFO &#160;: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)], properties:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
INFO &#160;: Completed compiling command(queryId=root_20250715220200_00940b48-adba-4296-ae50-75b5e92a0c7b); Time taken: 0.216 seconds
INFO &#160;: Concurrency mode is disabled, not creating a lock manager
INFO &#160;: Executing command(queryId=root_20250715220200_00940b48-adba-4296-ae50-75b5e92a0c7b): EXPLAIN EXTENDED SELECT first_val, second_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
LATERAL VIEW explode(val_array) lv2 AS second_val
WHERE first_val != second_val
INFO &#160;: Starting task [Stage-1:EXPLAIN] in serial mode
INFO &#160;: Completed executing command(queryId=root_20250715220200_00940b48-adba-4296-ae50-75b5e92a0c7b); Time taken: 0.031 seconds
+----------------------------------------------------+
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Explain &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
+----------------------------------------------------+
| STAGE DEPENDENCIES: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; Stage-0 is a root stage &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| STAGE PLANS: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; Stage: Stage-0 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; Fetch Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; limit: -1 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; Processor Tree: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; TableScan &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; alias: _dummy_table &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Row Limit Per Split: 1 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; GatherStats: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; expressions: array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col0 (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1 &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1, _col2 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string), _col2 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ListSink &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col0 (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; UDTF Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; function name: explode &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1, _col2 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string), _col2 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ListSink &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: Const array&amp;lt;string&amp;gt; [a, b] (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; UDTF Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; function name: explode &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1 &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1, _col2 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string), _col2 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ListSink &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col0 (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; UDTF Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; function name: explode &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1, _col2 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string), _col2 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ListSink &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
+----------------------------------------------------+
71 rows selected (0.265 seconds)
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; &#160; SET hive.cbo.enable=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
&lt;/span&gt;No rows affected (0.005 seconds)
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; &#160; SET hive.cbo.enable;
&lt;/span&gt;+------------------------+
| &#160; &#160; &#160; &#160; &#160;set &#160; &#160; &#160; &#160; &#160; |
+------------------------+
| hive.cbo.enable=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &#160;|
+------------------------+
1 row selected (0.007 seconds)
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; EXPLAIN EXTENDED SELECT first_val, second_val
&lt;/span&gt;. . . . . . . . . . . . . . . .&amp;gt; FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv1 AS first_val
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv2 AS second_val
. . . . . . . . . . . . . . . .&amp;gt; WHERE first_val != second_val;
INFO &#160;: Compiling command(queryId=root_20250715220220_a4c8999e-6aa2-4546-8aa0-d5c5128a5d80): EXPLAIN EXTENDED SELECT first_val, second_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
LATERAL VIEW explode(val_array) lv2 AS second_val
WHERE first_val != second_val
INFO &#160;: Semantic Analysis Completed (retrial = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
INFO &#160;: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)], properties:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
INFO &#160;: Completed compiling command(queryId=root_20250715220220_a4c8999e-6aa2-4546-8aa0-d5c5128a5d80); Time taken: 0.095 seconds
INFO &#160;: Concurrency mode is disabled, not creating a lock manager
INFO &#160;: Executing command(queryId=root_20250715220220_a4c8999e-6aa2-4546-8aa0-d5c5128a5d80): EXPLAIN EXTENDED SELECT first_val, second_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
LATERAL VIEW explode(val_array) lv2 AS second_val
WHERE first_val != second_val
INFO &#160;: Starting task [Stage-1:EXPLAIN] in serial mode
INFO &#160;: Completed executing command(queryId=root_20250715220220_a4c8999e-6aa2-4546-8aa0-d5c5128a5d80); Time taken: 0.034 seconds
+----------------------------------------------------+
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Explain &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
+----------------------------------------------------+
| STAGE DEPENDENCIES: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; Stage-0 is a root stage &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| STAGE PLANS: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; Stage: Stage-0 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; Fetch Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; limit: -1 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; Processor Tree: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; TableScan &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; alias: _dummy_table &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; Row Limit Per Split: 1 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; GatherStats: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; expressions: array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col0 (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1 &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1, _col2 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Filter Operator &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; isSamplingPred: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; predicate: (_col1 &amp;lt;&amp;gt; _col2) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string), _col2 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ListSink &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col0 (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; UDTF Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; function name: explode &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1, _col2 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Filter Operator &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; isSamplingPred: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; predicate: (_col1 &amp;lt;&amp;gt; _col2) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string), _col2 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ListSink &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: Const array&amp;lt;string&amp;gt; [a, b] (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; UDTF Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; function name: explode &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Forward &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1 &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1, _col2 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Filter Operator &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; isSamplingPred: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; predicate: (_col1 &amp;lt;&amp;gt; _col2) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string), _col2 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ListSink &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col0 (type: array&amp;lt;string&amp;gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0 &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; UDTF Operator &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; function name: explode &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Lateral View Join Operator |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col1, _col2 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Filter Operator &#160; &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; isSamplingPred: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; predicate: (_col1 &amp;lt;&amp;gt; _col2) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Select Operator &#160; &#160; &#160;|
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; expressions: _col1 (type: string), _col2 (type: string) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; outputColumnNames: _col0, _col1 |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ListSink &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
+----------------------------------------------------+
83 rows selected (0.145 seconds)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="18007344" author="JIRAUSER308328" created="Tue, 15 Jul 2025 22:04:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zabetak&quot; class=&quot;user-hover&quot; rel=&quot;zabetak&quot;&gt;zabetak&lt;/a&gt; the explain results appear the same for MR or Tez&lt;/p&gt;</comment>
                            <comment id="18007345" author="JIRAUSER308328" created="Tue, 15 Jul 2025 22:15:31 +0000"  >&lt;p&gt;reproduced via test files:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13077506/13077506_hive_29084.q&quot; title=&quot;hive_29084.q attached to HIVE-29084&quot;&gt;hive_29084.q&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;
	&lt;li&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13077507/13077507_hive_29084.q.out&quot; title=&quot;hive_29084.q.out attached to HIVE-29084&quot;&gt;hive_29084.q.out&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="18007400" author="zabetak" created="Wed, 16 Jul 2025 06:46:07 +0000"  >&lt;p&gt;Thanks for the analysis Konstantin. The reason that I asked about the output from the &lt;tt&gt;EXPLAIN CBO&lt;/tt&gt;  statement is to confirm exactly if it is a pure CBO issue or something deeper. Since you have a repro I suppose you are working on a fix so let me know once you have the PR ready and I will take a look. &lt;/p&gt;

&lt;p&gt;The fact that the filter disappears from the plan means that at some point the optimizer deems (incorrectly) that the filter is always true and takes it out. There are some useful loggers that can help pinpoint where the filter is removed. Take a loot at &lt;a href=&quot;https://youtu.be/_phzRNCWJfw?si=Z9CP0fTWha7YyhqR&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://youtu.be/_phzRNCWJfw?si=Z9CP0fTWha7YyhqR&lt;/a&gt; to see how you can use them to your advantage.&lt;/p&gt;</comment>
                            <comment id="18007629" author="JIRAUSER308328" created="Wed, 16 Jul 2025 16:53:56 +0000"  >&lt;p&gt;Hi Stamatis, I apologize for overlooking &quot;CBO&quot; in your comment; I am still learning Hive. Here is a sample output of &quot;EXPLAIN CBO&quot;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Connecting to jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000
&lt;/span&gt;Connected to: Apache Hive (version 4.2.0-SNAPSHOT)
Driver: Hive JDBC (version 4.2.0-SNAPSHOT)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Beeline version 4.2.0-SNAPSHOT by Apache Hive
0: jdbc:hive2:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10000&amp;gt; EXPLAIN CBO SELECT first_val, second_val
&lt;/span&gt;. . . . . . . . . . . . . . . .&amp;gt; FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv1 AS first_val
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv2 AS second_val
. . . . . . . . . . . . . . . .&amp;gt; WHERE first_val != second_val;
INFO &#160;: Compiling command(queryId=root_20250716163641_81bf2a03-71e1-4a1d-b3e9-3919a3e6f12c): EXPLAIN CBO SELECT first_val, second_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
LATERAL VIEW explode(val_array) lv2 AS second_val
WHERE first_val != second_val
INFO &#160;: Semantic Analysis Completed (retrial = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
INFO &#160;: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)], properties:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
INFO &#160;: Completed compiling command(queryId=root_20250716163641_81bf2a03-71e1-4a1d-b3e9-3919a3e6f12c); Time taken: 1.976 seconds
INFO &#160;: Concurrency mode is disabled, not creating a lock manager
INFO &#160;: Executing command(queryId=root_20250716163641_81bf2a03-71e1-4a1d-b3e9-3919a3e6f12c): EXPLAIN CBO SELECT first_val, second_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
LATERAL VIEW explode(val_array) lv2 AS second_val
WHERE first_val != second_val
INFO &#160;: Starting task [Stage-1:EXPLAIN] in serial mode
INFO &#160;: Completed executing command(queryId=root_20250716163641_81bf2a03-71e1-4a1d-b3e9-3919a3e6f12c); Time taken: 0.036 seconds
+----------------------------------------------------+
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Explain &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
+----------------------------------------------------+
| CBO PLAN: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| HiveProject(first_val=[$1], second_val=[$2]) &#160; &#160; &#160; |
| &#160; HiveFilter(condition=[&amp;lt;&amp;gt;($1, $2)]) &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
| &#160; &#160; HiveTableFunctionScan(invocation=[LATERAL(explode($0), $0, $1)], rowType=[RecordType(VARCHAR(2147483647) ARRAY val_array, VARCHAR(2147483647) lv1.first_val, VARCHAR(2147483647) lv2.second_val)]) |
| &#160; &#160; &#160; HiveProject(val_array=[$0], lv1.first_val=[$1]) |
| &#160; &#160; &#160; &#160; HiveTableFunctionScan(invocation=[LATERAL(explode($0), $0)], rowType=[RecordType(VARCHAR(2147483647) ARRAY val_array, VARCHAR(2147483647) lv1.first_val)]) |
| &#160; &#160; &#160; &#160; &#160; HiveProject(val_array=[ARRAY(_UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-16LE&quot;&lt;/span&gt;, _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-16LE&quot;&lt;/span&gt;)]) |
| &#160; &#160; &#160; &#160; &#160; &#160; HiveTableScan(table=[[_dummy_database, _dummy_table]], table:alias=[_dummy_table]) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
+----------------------------------------------------+
9 rows selected (2.217 seconds) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I thought I will also add an &quot;EXPLAIN CBO&quot; output for an unaffected query for comparison:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;EXPLAIN CBO SELECT first_val
. . . . . . . . . . . . . . . .&amp;gt; FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
. . . . . . . . . . . . . . . .&amp;gt; LATERAL VIEW explode(val_array) lv1 AS first_val
. . . . . . . . . . . . . . . .&amp;gt; WHERE first_val != &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;;
INFO &#160;: Compiling command(queryId=root_20250716164955_916bcfc7-7080-45a4-bdbc-b0c3d4921781): EXPLAIN CBO SELECT first_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
WHERE first_val != &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;
INFO &#160;: Semantic Analysis Completed (retrial = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
INFO &#160;: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)], properties:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
INFO &#160;: Completed compiling command(queryId=root_20250716164955_916bcfc7-7080-45a4-bdbc-b0c3d4921781); Time taken: 0.134 seconds
INFO &#160;: Concurrency mode is disabled, not creating a lock manager
INFO &#160;: Executing command(queryId=root_20250716164955_916bcfc7-7080-45a4-bdbc-b0c3d4921781): EXPLAIN CBO SELECT first_val
FROM (SELECT array(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;) as val_array) inline_data
LATERAL VIEW explode(val_array) lv1 AS first_val
WHERE first_val != &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;
INFO &#160;: Starting task [Stage-1:EXPLAIN] in serial mode
INFO &#160;: Completed executing command(queryId=root_20250716164955_916bcfc7-7080-45a4-bdbc-b0c3d4921781); Time taken: 0.03 seconds
+----------------------------------------------------+
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Explain &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; |
+----------------------------------------------------+
| CBO PLAN: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| HiveProject(first_val=[$1]) &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
| &#160; HiveFilter(condition=[&amp;lt;&amp;gt;($1, _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;)]) &#160; &#160; |
| &#160; &#160; HiveTableFunctionScan(invocation=[LATERAL(explode($0), $0)], rowType=[RecordType(VARCHAR(2147483647) ARRAY val_array, VARCHAR(2147483647) lv1.first_val)]) |
| &#160; &#160; &#160; HiveProject(val_array=[ARRAY(_UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-16LE&quot;&lt;/span&gt;, _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-16LE&quot;&lt;/span&gt;)]) |
| &#160; &#160; &#160; &#160; HiveTableScan(table=[[_dummy_database, _dummy_table]], table:alias=[_dummy_table]) |
| &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|
+----------------------------------------------------+
7 rows selected (0.185 seconds) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="18008184" author="JIRAUSER308328" created="Sat, 19 Jul 2025 00:35:57 +0000"  >&lt;p&gt;This is a preliminary proof-of-concept patch that confirms that the WHERE filter is being removed during FilterPPD.process()&lt;/p&gt;

&lt;p&gt;The code change is likely naive; its intention is to confirm that if a FilterOperator under a lateralView node is &lt;b&gt;not&lt;/b&gt; deleted from the tree, the query in question (per the previously attached test .q file) returns the same results with CBO ON vs. OFF.&lt;/p&gt;

&lt;p&gt;I need to work more to understand the filter simplification logic a bit better in order to determine if there is a better solution. I would appreciate feedback on whether my understanding of the problem is accurate.&lt;/p&gt;</comment>
                            <comment id="18009066" author="JIRAUSER308328" created="Tue, 22 Jul 2025 18:44:05 +0000"  >&lt;p&gt;The patch is &quot;too naive and crude&quot;; working on a better fix for LV predicates&apos; pushdown&lt;/p&gt;</comment>
                            <comment id="18009409" author="JIRAUSER308328" created="Wed, 23 Jul 2025 23:47:20 +0000"  >&lt;p&gt;I now believe that this is a side effect of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-28259&quot; title=&quot;Common table expression detection and rewrites using CBO&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-28259&quot;&gt;&lt;del&gt;HIVE-28259&lt;/del&gt;&lt;/a&gt; because I see that PPD incorrectly classifies cross-table WHERE clauses as same-table clauses, leading to their elimination for trees having multiple lateral view join elements.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The call &lt;a href=&quot;https://github.com/apache/hive/blob/ff8e710013b941aaebfebc326e3930c80a62268e/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/ASTConverter.java#L1269&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/blob/ff8e710013b941aaebfebc326e3930c80a62268e/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/ASTConverter.java#L1269&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ASTConverter.nextAlias() creates identical aliases because the execution flow creates multiple instances of ASTConverter, all starting with derivedTableCount of 0, and I have traced the source calls to the commit of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-28259&quot; title=&quot;Common table expression detection and rewrites using CBO&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-28259&quot;&gt;&lt;del&gt;HIVE-28259&lt;/del&gt;&lt;/a&gt;. This could turn out to be not 100% accurate, but I wanted to record the info for future reference&lt;/p&gt;</comment>
                            <comment id="18010325" author="zabetak" created="Mon, 28 Jul 2025 09:33:56 +0000"  >&lt;p&gt;If the CBO plan does not have a TableSpool operator then I can&apos;t see why/how &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-28259&quot; title=&quot;Common table expression detection and rewrites using CBO&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-28259&quot;&gt;&lt;del&gt;HIVE-28259&lt;/del&gt;&lt;/a&gt; could have caused this. Anyways the investigation is very promising so I am waiting for the next batch of updates.&lt;/p&gt;</comment>
                            <comment id="18010482" author="JIRAUSER308328" created="Mon, 28 Jul 2025 18:42:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zabetak&quot; class=&quot;user-hover&quot; rel=&quot;zabetak&quot;&gt;zabetak&lt;/a&gt;, my previous diagnostics and linking to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-28259&quot; title=&quot;Common table expression detection and rewrites using CBO&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-28259&quot;&gt;&lt;del&gt;HIVE-28259&lt;/del&gt;&lt;/a&gt; turned out to be inaccurate. I believe I understand the problem much better now.&lt;/p&gt;

&lt;p&gt;I have identified that filter operators over different lateral views are being removed during the PPD stage (confirmed that disabling PPD &quot;fixes&quot; such queries). These operators are considered &quot;pushable&quot; because all their operands share the same table alias. What happens then is&#160;&lt;br/&gt;
LateralViewJoinerPPD.process() calls JoinerPPD.process(), which adds such a filter operator to the list of candidates, but lacks the knowledge of how to push it. After that,&#160;&lt;br/&gt;
LateralViewJoinerPPD.removeAllCandidates() removes this filter.&lt;br/&gt;
&#160;&lt;br/&gt;
If you take a look at the following lines: &lt;a href=&quot;https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/ASTConverter.java#L601-L609&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/ASTConverter.java#L601-L609,&lt;/a&gt; you can see that all schema columns of an LV query are being initialized with the same tableAlias, which, I believe, is the root cause of the problem due to the implicit join nature of Lateral Views.&lt;br/&gt;
&#160;&lt;br/&gt;
The attached patch &lt;em&gt;appears&lt;/em&gt; to fix the bug. I believe that this fix is very well isolated to lateral views only and should have little to no impact on performance. I would not be surprised if there is a better place or approach to fix this; I am open to all kinds of feedback.&lt;/p&gt;</comment>
                            <comment id="18010484" author="JIRAUSER308328" created="Mon, 28 Jul 2025 18:46:41 +0000"  >&lt;p&gt;See the filter&apos;s fields&apos; tableAlias values before and after the patch:&lt;br/&gt;
&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13077757/13077757_HIVE-29084-before-fix-filter-schema-different-table-aliases.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13077758/13077758_HIVE-29084-after-fix-filter-schema-different-table-aliases.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="18010637" author="zabetak" created="Tue, 29 Jul 2025 11:08:32 +0000"  >&lt;p&gt;Thanks for the detailed analysis &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=konstantinb&quot; class=&quot;user-hover&quot; rel=&quot;konstantinb&quot;&gt;konstantinb&lt;/a&gt; ! Indeed having the same alias can create problems in various cases. One recent example that comes to mind is &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-28222&quot; title=&quot;Ambiguous table alias exception for queries with self joins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-28222&quot;&gt;&lt;del&gt;HIVE-28222&lt;/del&gt;&lt;/a&gt; although not related to lateral views.&lt;/p&gt;

&lt;p&gt;The attempt to address the problem in ASTConverter (&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13077754/13077754_HIVE-29084-ASTConverter.patch&quot; title=&quot;HIVE-29084-ASTConverter.patch attached to HIVE-29084&quot;&gt;HIVE-29084-ASTConverter.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;) &#160;seems reasonable. Please create a pull request on GitHub so that we get a full test run and if all tests pass without problems I will do a more thorough review of the patch.&lt;/p&gt;</comment>
                            <comment id="18013311" author="JIRAUSER308328" created="Mon, 11 Aug 2025 22:34:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zabetak&quot; class=&quot;user-hover&quot; rel=&quot;zabetak&quot;&gt;zabetak&lt;/a&gt;&#160; my rebuild from today shows all green checkmarks. I do have more .q tests to add within the next couple of days; if you have any feedback, it would be greatly appreciated&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/hive/pull/6014&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/pull/6014&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="18013488" author="zabetak" created="Tue, 12 Aug 2025 17:30:33 +0000"  >&lt;p&gt;Great, I will try to review the PR tomorrow!&lt;/p&gt;</comment>
                            <comment id="18013945" author="JIRAUSER308328" created="Thu, 14 Aug 2025 16:08:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zabetak&quot; class=&quot;user-hover&quot; rel=&quot;zabetak&quot;&gt;zabetak&lt;/a&gt;&#160;&lt;br/&gt;
Thank you very much for the thorough review. I believe I have addressed all your comments and provided detailed reasoning of the changes. I just wanted to let you know that I was also able to reproduce the problem with a &lt;b&gt;single&lt;/b&gt; LV clause - reflected in the newly proposed targeted set of tests.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I am hoping you can re-review the PR when you have a chance, please.&lt;/p&gt;</comment>
                            <comment id="18017670" author="zabetak" created="Tue, 2 Sep 2025 13:20:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=konstantinb&quot; class=&quot;user-hover&quot; rel=&quot;konstantinb&quot;&gt;konstantinb&lt;/a&gt; I just did another pass over the PR and left some small comments. Hopefully, we can converge and merge this soon.&lt;/p&gt;

&lt;p&gt;For the summary, I would suggest a minor rephrase to make the problem easier to grasp by non-tech/dev users: &quot;Wrong results for LATERAL VIEW queries due to incorrect WHERE filter removal&quot;&lt;/p&gt;</comment>
                            <comment id="18020319" author="zabetak" created="Mon, 15 Sep 2025 11:37:16 +0000"  >&lt;p&gt;Fixed in &lt;a href=&quot;https://github.com/apache/hive/commit/3b3c1cf42b281568eacf86b1b96fd96400dfdf8c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hive/commit/3b3c1cf42b281568eacf86b1b96fd96400dfdf8c&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13538439">HIVE-27399</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13077754" name="HIVE-29084-ASTConverter.patch" size="1828" author="konstantinb" created="Mon, 28 Jul 2025 18:37:53 +0000"/>
                            <attachment id="13077758" name="HIVE-29084-after-fix-filter-schema-different-table-aliases.png" size="279153" author="konstantinb" created="Mon, 28 Jul 2025 18:48:55 +0000"/>
                            <attachment id="13077757" name="HIVE-29084-before-fix-filter-schema-different-table-aliases.png" size="311074" author="konstantinb" created="Mon, 28 Jul 2025 18:48:55 +0000"/>
                            <attachment id="13077566" name="hive-29084.POC.patch" size="3888" author="konstantinb" created="Sat, 19 Jul 2025 00:25:37 +0000"/>
                            <attachment id="13077506" name="hive_29084.q" size="481" author="konstantinb" created="Tue, 15 Jul 2025 22:15:09 +0000"/>
                            <attachment id="13077507" name="hive_29084.q.out" size="1354" author="konstantinb" created="Tue, 15 Jul 2025 22:15:15 +0000"/>
                            <attachment id="13077436" name="hive_cbo_lateral_view_where_bug.log" size="11638" author="konstantinb" created="Fri, 11 Jul 2025 20:51:34 +0000"/>
                            <attachment id="13077437" name="hive_cbo_lateral_view_where_bug.sql" size="1927" author="konstantinb" created="Fri, 11 Jul 2025 20:46:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1wq0g:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>