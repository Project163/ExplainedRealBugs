<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:21:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-3392] Hive unnecessarily validates table SerDes when dropping a table</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3392</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;natty@hadoop1:~$ hive&lt;br/&gt;
hive&amp;gt; add jar /home/natty/source/sample-code/custom-serdes/target/custom-serdes-1.0-SNAPSHOT.jar;&lt;br/&gt;
Added /home/natty/source/sample-code/custom-serdes/target/custom-serdes-1.0-SNAPSHOT.jar to class path&lt;br/&gt;
Added resource: /home/natty/source/sample-code/custom-serdes/target/custom-serdes-1.0-SNAPSHOT.jar&lt;br/&gt;
hive&amp;gt; create table test (a int) row format serde &apos;hive.serde.JSONSerDe&apos;;            &lt;br/&gt;
OK&lt;br/&gt;
Time taken: 2.399 seconds&lt;/p&gt;


&lt;p&gt;natty@hadoop1:~$ hive&lt;br/&gt;
hive&amp;gt; drop table test;                                                               &lt;br/&gt;
FAILED: Hive Internal Error: java.lang.RuntimeException(MetaException(message:org.apache.hadoop.hive.serde2.SerDeException SerDe hive.serde.JSONSerDe does not exist))&lt;br/&gt;
java.lang.RuntimeException: MetaException(message:org.apache.hadoop.hive.serde2.SerDeException SerDe hive.serde.JSONSerDe does not exist)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.metadata.Table.getDeserializerFromMetaStore(Table.java:262)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.metadata.Table.getDeserializer(Table.java:253)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.metadata.Table.getCols(Table.java:490)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.metadata.Table.checkValidity(Table.java:162)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.metadata.Hive.getTable(Hive.java:943)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.parse.DDLSemanticAnalyzer.analyzeDropTable(DDLSemanticAnalyzer.java:700)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.parse.DDLSemanticAnalyzer.analyzeInternal(DDLSemanticAnalyzer.java:210)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:243)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:430)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:337)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:889)&lt;br/&gt;
	at org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:255)&lt;br/&gt;
	at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:212)&lt;br/&gt;
	at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:403)&lt;br/&gt;
	at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:671)&lt;br/&gt;
	at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:554)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
	at org.apache.hadoop.util.RunJar.main(RunJar.java:208)&lt;br/&gt;
Caused by: MetaException(message:org.apache.hadoop.hive.serde2.SerDeException SerDe com.cloudera.hive.serde.JSONSerDe does not exist)&lt;br/&gt;
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.getDeserializer(MetaStoreUtils.java:211)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.metadata.Table.getDeserializerFromMetaStore(Table.java:260)&lt;br/&gt;
	... 20 more&lt;/p&gt;

&lt;p&gt;hive&amp;gt; add jar /home/natty/source/sample-code/custom-serdes/target/custom-serdes-1.0-SNAPSHOT.jar;&lt;br/&gt;
Added /home/natty/source/sample-code/custom-serdes/target/custom-serdes-1.0-SNAPSHOT.jar to class path&lt;br/&gt;
Added resource: /home/natty/source/sample-code/custom-serdes/target/custom-serdes-1.0-SNAPSHOT.jar&lt;br/&gt;
hive&amp;gt; drop table test;&lt;br/&gt;
OK&lt;br/&gt;
Time taken: 0.658 seconds&lt;br/&gt;
hive&amp;gt; &lt;/p&gt;</description>
                <environment></environment>
        <key id="12603792">HIVE-3392</key>
            <summary>Hive unnecessarily validates table SerDes when dropping a table</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="navis">Navis Ryu</assignee>
                                    <reporter username="natty">Jonathan Natkins</reporter>
                        <labels>
                            <label>patch</label>
                    </labels>
                <created>Thu, 16 Aug 2012 22:22:11 +0000</created>
                <updated>Thu, 13 Nov 2014 19:40:35 +0000</updated>
                            <resolved>Fri, 11 Jul 2014 02:16:10 +0000</resolved>
                                    <version>0.9.0</version>
                                    <fixVersion>0.14.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="13451895" author="ajeshpg" created="Mon, 10 Sep 2012 11:30:53 +0000"  >&lt;p&gt;All DDL statement are calling Hive.getTable() method which internally invoke checkValidity() method.&lt;br/&gt;
checkValidity() method internally tries to fetch all the columns using Hive.getFieldsFromDeserializer(getTableName(), getDeserializer()) method.&lt;br/&gt;
So while trying to drop the table, it tries to get the Deserializer and causes the exception.&lt;/p&gt;

&lt;p&gt;As a resolution we should bypass the checkValidity() method for drop command.&lt;/p&gt;

&lt;p&gt;I have tested in local and is working fine.  Let me know your comments so that I can work on the patch.&lt;/p&gt;</comment>
                            <comment id="13452716" author="ajeshpg" created="Tue, 11 Sep 2012 04:59:12 +0000"  >&lt;p&gt;Added logic to skip the table schema validation if the command is a drop command. Attached patch file &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3392&quot; title=&quot;Hive unnecessarily validates table SerDes when dropping a table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3392&quot;&gt;&lt;del&gt;HIVE-3392&lt;/del&gt;&lt;/a&gt;.1.patch. &lt;br/&gt;
Please do a review.&lt;/p&gt;</comment>
                            <comment id="13452722" author="ajeshpg" created="Tue, 11 Sep 2012 05:11:58 +0000"  >&lt;p&gt;Review request added at &lt;a href=&quot;https://reviews.apache.org/r/7004/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/7004/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13452744" author="namit" created="Tue, 11 Sep 2012 05:56:42 +0000"  >&lt;p&gt;comments on review board&lt;/p&gt;</comment>
                            <comment id="13452747" author="namit" created="Tue, 11 Sep 2012 05:59:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ajeshpg&quot; class=&quot;user-hover&quot; rel=&quot;ajeshpg&quot;&gt;ajeshpg&lt;/a&gt;, I have added you as a contributor. You can assign jiras you are working on to yourself&lt;/p&gt;</comment>
                            <comment id="13453714" author="namit" created="Wed, 12 Sep 2012 05:04:58 +0000"  >&lt;p&gt;comments&lt;/p&gt;


&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ajeshpg&quot; class=&quot;user-hover&quot; rel=&quot;ajeshpg&quot;&gt;ajeshpg&lt;/a&gt;, please mark &apos;submit patch&apos; when you are done with the changes and want others to review&lt;/p&gt;</comment>
                            <comment id="13453715" author="appodictic" created="Wed, 12 Sep 2012 05:05:13 +0000"  >&lt;p&gt;I have an issue with this. Serde&apos;s and storage handlers could have custom drop logic. If we allow a drop without the class how do we know the right think was done?&lt;/p&gt;</comment>
                            <comment id="13453724" author="ajeshpg" created="Wed, 12 Sep 2012 05:31:45 +0000"  >&lt;p&gt;New Review request added at &lt;a href=&quot;https://reviews.apache.org/r/7004/diff/3/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/7004/diff/3/&lt;/a&gt;.&lt;br/&gt;
As we can not use Junit/.q file for this scenario, I have added testcase in a step by step format.&lt;br/&gt;
Please review code and Testcases.&lt;/p&gt;</comment>
                            <comment id="13454625" author="ajeshpg" created="Thu, 13 Sep 2012 04:15:19 +0000"  >&lt;p&gt;Hi Edward Capriolo, when we are dropping a table, why we need to validate the class. We just need to drop the table even if the particular class (which was used while creating the table) is not available.&lt;br/&gt;
let me know your comments.&lt;/p&gt;</comment>
                            <comment id="13454626" author="ajeshpg" created="Thu, 13 Sep 2012 04:17:45 +0000"  >&lt;p&gt;Testcases are attached.  &lt;br/&gt;
1) &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3392&quot; title=&quot;Hive unnecessarily validates table SerDes when dropping a table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3392&quot;&gt;&lt;del&gt;HIVE-3392&lt;/del&gt;&lt;/a&gt;.Test Case - Before Patch.txt&lt;br/&gt;
2) &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3392&quot; title=&quot;Hive unnecessarily validates table SerDes when dropping a table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3392&quot;&gt;&lt;del&gt;HIVE-3392&lt;/del&gt;&lt;/a&gt;.Test Case - After Patch.txt&lt;/p&gt;</comment>
                            <comment id="13463858" author="ajeshpg" created="Wed, 26 Sep 2012 14:39:10 +0000"  >&lt;p&gt;Hi Namit,&lt;br/&gt;
Do I need to change Assignee to get this patch reviewed.&lt;/p&gt;</comment>
                            <comment id="13464739" author="appodictic" created="Thu, 27 Sep 2012 13:51:03 +0000"  >&lt;p&gt;Ajesh. Please address my comments&lt;/p&gt;

&lt;p&gt;1 why do we need this?Not having the correct jars is a setup problem.&lt;/p&gt;

&lt;p&gt;2 how does this work with storage handlers? When you drop an hbase table you need to have the serde because custom work needs to be done.&lt;/p&gt;</comment>
                            <comment id="13464804" author="ajeshpg" created="Thu, 27 Sep 2012 15:08:09 +0000"  >&lt;p&gt;Hi Edward Capriolo, &lt;br/&gt;
when we are dropping a table, why we need to validate the class. We just need to drop the table even if the particular class (which was used while creating the table) is not available.&lt;br/&gt;
let me know your comments.&lt;/p&gt;</comment>
                            <comment id="13464926" author="appodictic" created="Thu, 27 Sep 2012 17:58:25 +0000"  >&lt;p&gt;Because some Serde&apos;s NEED to do custom things when dropping a table. An example is the hbase handler &lt;a href=&quot;https://cwiki.apache.org/Hive/storagehandlers.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/Hive/storagehandlers.html&lt;/a&gt;. So sometimes the check is necessary. &lt;/p&gt;

&lt;p&gt;Also as I was asserting up above. When your missing a JAR file you have a deployment problem. I do not think we want to try to solve/avoid deployment problems with more code.&lt;/p&gt;

&lt;p&gt;How about this? Why not make hive check for the existence of the serde, and if the class is not found produce a nice clean exception with a nice error message.&lt;/p&gt;</comment>
                            <comment id="13473103" author="ajeshpg" created="Wed, 10 Oct 2012 08:50:22 +0000"  >&lt;p&gt;Hi Edward Capriolo,&lt;br/&gt;
So can we conclude this as not an issue. &lt;br/&gt;
or I can make a change to display a message like below when the class is not found.&lt;/p&gt;

&lt;p&gt;hive&amp;gt; drop table temptbl;&lt;br/&gt;
FAILED: Hive Internal Error: java.lang.RuntimeException(MetaException(message:org.apache.hadoop.hive.serde2.SerDeException SerDe org.apache.hadoop.hive.serde2.TestDelimitedJSONSerDe does not exist))&lt;br/&gt;
hive&amp;gt;&lt;/p&gt;</comment>
                            <comment id="13473612" author="appodictic" created="Wed, 10 Oct 2012 22:12:40 +0000"  >&lt;p&gt;Yes. I think a nice clean exception / error message is the way to go. &lt;/p&gt;</comment>
                            <comment id="13489253" author="ajeshpg" created="Fri, 2 Nov 2012 04:31:53 +0000"  >&lt;p&gt;Hi Edward Capriolo,&lt;/p&gt;

&lt;p&gt;I checked the latest version of Driver.java in trunk.(org/apache/hadoop/hive/ql/Driver.java)&lt;br/&gt;
A lot of patches has been already applied  on this file as part of other issue&apos;s fixes. &lt;br/&gt;
The change we have discussed to display a clean error message will be taken care by those changes.So we do not need any more code change for this issue.&lt;/p&gt;

&lt;p&gt;Attaching a test case for the same.&quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3392&quot; title=&quot;Hive unnecessarily validates table SerDes when dropping a table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3392&quot;&gt;&lt;del&gt;HIVE-3392&lt;/del&gt;&lt;/a&gt;.Test Case - with_trunk_version.txt&quot;.&lt;/p&gt;</comment>
                            <comment id="13492219" author="ajeshpg" created="Wed, 7 Nov 2012 09:34:10 +0000"  >&lt;p&gt;Hi Edward Capriolo/Namit&lt;br/&gt;
As per my previous comment, can you suggest if we need to work more on this or we can consider this issue as resolved?&lt;/p&gt;</comment>
                            <comment id="13492861" author="appodictic" created="Thu, 8 Nov 2012 00:52:53 +0000"  >&lt;p&gt;Sorry I have not had a chance to to a full review. I will try to tackle this before the weekend.&lt;/p&gt;</comment>
                            <comment id="13498660" author="ajeshpg" created="Fri, 16 Nov 2012 07:46:24 +0000"  >&lt;p&gt;Hi Edward Capriolo&lt;br/&gt;
As per my previous comment, can you suggest if we need to work more on this or we can consider this issue as resolved?&lt;/p&gt;</comment>
                            <comment id="13552100" author="ashutoshc" created="Sat, 12 Jan 2013 23:35:12 +0000"  >&lt;p&gt;As Ed noted, custom storage handlers will require jars to be present in classpath, so we cannot ignore missing jars. Also, trunk now throws a nice error message. No more work required on the ticket. Closing.&lt;/p&gt;</comment>
                            <comment id="14027293" author="navis" created="Wed, 11 Jun 2014 01:10:03 +0000"  >&lt;p&gt;If it&apos;s non-native table with custom storage handler, it&apos;s right to throw exception. But if it&apos;s native table with custom serde, we need not to verify serde of the table. Furthermore, in checkValidity() method,&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (0 == getCols().size()) &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HiveException();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Is not needed except creating a table or partition. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt;, can I reopen this issue?&lt;/p&gt;</comment>
                            <comment id="14031705" author="hiveqa" created="Sat, 14 Jun 2014 21:30:45 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12650218/HIVE-3392.3.patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12650218/HIVE-3392.3.patch.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 5 failed/errored test(s), 5536 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_parquet_columnar
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_root_dir_external_table
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_altern1
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_ctas
org.apache.hive.hcatalog.pig.TestHCatLoader.testReadDataPrimitiveTypes
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/464/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/464/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/464/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/464/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-464/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-464/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 5 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12650218&lt;/p&gt;</comment>
                            <comment id="14040579" author="ashutoshc" created="Mon, 23 Jun 2014 09:47:32 +0000"  >&lt;p&gt;I am fine with reopening this. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=appodictic&quot; class=&quot;user-hover&quot; rel=&quot;appodictic&quot;&gt;appodictic&lt;/a&gt; What do you think ?&lt;/p&gt;</comment>
                            <comment id="14040802" author="appodictic" created="Mon, 23 Jun 2014 14:36:06 +0000"  >&lt;p&gt;Please feel free to take over the review. I will not have any time at the moment. Thanks!&lt;/p&gt;</comment>
                            <comment id="14056017" author="hiveqa" created="Wed, 9 Jul 2014 09:02:49 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12654765/HIVE-3392.4.patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12654765/HIVE-3392.4.patch.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 3 failed/errored test(s), 5701 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_altern1
org.apache.hive.hcatalog.pig.TestHCatLoader.testReadDataPrimitiveTypes
org.apache.hive.jdbc.miniHS2.TestHiveServer2.testConnection
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/720/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/720/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/720/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/720/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-720/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-720/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12654765&lt;/p&gt;</comment>
                            <comment id="14057083" author="jdere" created="Thu, 10 Jul 2014 03:15:56 +0000"  >&lt;p&gt;So this moves the validity check from getTable(), over to alterTable/alterPartition.&lt;br/&gt;
What kind of error will we get now if we try to do a SELECT on this table when the SerDe cannot be resolved? Do we need to add the validity check somewhere in that code path, or is the current error sufficient?&lt;/p&gt;</comment>
                            <comment id="14057148" author="navis" created="Thu, 10 Jul 2014 05:28:06 +0000"  >&lt;p&gt;Basically get the same exception(CNE) but with different stacktrace.&lt;/p&gt;

&lt;p&gt;Before the patch (select)&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.ClassNotFoundException: Class org.apache.hadoop.hive.serde2.lazy.TestSerDe not found
	at org.apache.hadoop.conf.Configuration.getClassByName(Configuration.java:1801)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.getDeserializer(MetaStoreUtils.java:342)
	at org.apache.hadoop.hive.ql.metadata.Table.getDeserializerFromMetaStore(Table.java:288)
	at org.apache.hadoop.hive.ql.metadata.Table.getDeserializer(Table.java:281)
	at org.apache.hadoop.hive.ql.metadata.Table.getCols(Table.java:631)
	at org.apache.hadoop.hive.ql.metadata.Table.checkValidity(Table.java:189)
	at org.apache.hadoop.hive.ql.metadata.Hive.getTable(Hive.java:1019)
	at org.apache.hadoop.hive.ql.metadata.Hive.getTable(Hive.java:933)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getMetaData(SemanticAnalyzer.java:1227)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getMetaData(SemanticAnalyzer.java:1198)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:9442)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:328)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After the patch (select)&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.ClassNotFoundException: Class org.apache.hadoop.hive.serde2.lazy.TestSerDe not found
	at org.apache.hadoop.conf.Configuration.getClassByName(Configuration.java:1801)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.getDeserializer(MetaStoreUtils.java:342)
	at org.apache.hadoop.hive.ql.metadata.Table.getDeserializerFromMetaStore(Table.java:263)
	at org.apache.hadoop.hive.ql.metadata.Table.getDeserializer(Table.java:256)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genTablePlan(SemanticAnalyzer.java:8802)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:9110)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:9449)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:328)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think it would be sufficient to check validity right before updating table or partition metadata. &lt;/p&gt;</comment>
                            <comment id="14057194" author="jdere" created="Thu, 10 Jul 2014 06:34:20 +0000"  >&lt;p&gt;Left comment on RB, which I think is causing the failure in TestNegativeCliDriver.testNegativeCliDriver_altern1.&lt;/p&gt;</comment>
                            <comment id="14057211" author="navis" created="Thu, 10 Jul 2014 06:51:34 +0000"  >&lt;p&gt;Rebased to trunk and fixed that. Thanks.&lt;/p&gt;</comment>
                            <comment id="14057275" author="jdere" created="Thu, 10 Jul 2014 08:42:08 +0000"  >&lt;p&gt;+1 if tests pass ok.&lt;/p&gt;</comment>
                            <comment id="14057330" author="hiveqa" created="Thu, 10 Jul 2014 10:04:17 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12654951/HIVE-3392.5.patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12654951/HIVE-3392.5.patch.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 3 failed/errored test(s), 5703 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hive.hcatalog.pig.TestHCatLoader.testReadDataPrimitiveTypes
org.apache.hive.hcatalog.pig.TestOrcHCatLoader.testReadDataPrimitiveTypes
org.apache.hive.jdbc.miniHS2.TestHiveServer2.testConnection
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/733/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/733/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/733/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/733/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-733/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-733/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12654951&lt;/p&gt;</comment>
                            <comment id="14058235" author="navis" created="Fri, 11 Jul 2014 02:16:10 +0000"  >&lt;p&gt;Committed to trunk. Thanks Jason, for the review.&lt;/p&gt;</comment>
                            <comment id="14210384" author="thejas" created="Thu, 13 Nov 2014 19:40:35 +0000"  >&lt;p&gt;This has been fixed in 0.14 release. Please open new jira if you see any issues.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12655226">HIVE-4795</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12544768" name="HIVE-3392.2.patch.txt" size="1781" author="ajeshpg" created="Wed, 12 Sep 2012 05:22:00 +0000"/>
                            <attachment id="12650218" name="HIVE-3392.3.patch.txt" size="11769" author="navis" created="Fri, 13 Jun 2014 02:33:05 +0000"/>
                            <attachment id="12654765" name="HIVE-3392.4.patch.txt" size="11368" author="navis" created="Wed, 9 Jul 2014 07:54:49 +0000"/>
                            <attachment id="12654951" name="HIVE-3392.5.patch.txt" size="11521" author="navis" created="Thu, 10 Jul 2014 06:50:55 +0000"/>
                            <attachment id="12551820" name="HIVE-3392.Test Case - with_trunk_version.txt" size="949" author="ajeshpg" created="Fri, 2 Nov 2012 04:31:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>246934</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i07wtb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>44083</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>