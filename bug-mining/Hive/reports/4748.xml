<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:46:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-11402] HS2 - add an option to disallow parallel query execution within a single Session</title>
                <link>https://issues.apache.org/jira/browse/HIVE-11402</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;HiveServer2 currently allows concurrent queries to be run in a single session. However, every HS2 session has  an associated SessionState object, and the use of SessionState in many places assumes that only one thread is using it, ie it is not thread safe.&lt;br/&gt;
There are many places where SesssionState thread safety needs to be addressed, and until then we should serialize all query execution for a single HS2 session. &lt;del&gt;This problem can become more visible with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4239&quot; title=&quot;Remove lock on compilation stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4239&quot;&gt;&lt;del&gt;HIVE-4239&lt;/del&gt;&lt;/a&gt; now allowing parallel query compilation.&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;Note that running queries in parallel for single session is not straightforward  with jdbc, you need to spawn another thread as the Statement.execute calls are blocking. I believe ODBC has non blocking query execution API, and Hue is another well known application that shares sessions for all queries that a user runs.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12850056">HIVE-11402</key>
            <summary>HS2 - add an option to disallow parallel query execution within a single Session</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sershe">Sergey Shelukhin</assignee>
                                    <reporter username="thejas">Thejas Nair</reporter>
                        <labels>
                            <label>TODOC2.1.1</label>
                            <label>TODOC2.2</label>
                    </labels>
                <created>Wed, 29 Jul 2015 20:13:32 +0000</created>
                <updated>Wed, 22 Oct 2025 11:11:12 +0000</updated>
                            <resolved>Fri, 15 Jul 2016 02:39:11 +0000</resolved>
                                                    <fixVersion>2.1.1</fixVersion>
                    <fixVersion>2.2.0</fixVersion>
                                    <component>HiveServer2</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>24</watches>
                                                                                                                <comments>
                            <comment id="14646693" author="thejas" created="Wed, 29 Jul 2015 20:22:07 +0000"  >&lt;p&gt;Comment from earlier discussion with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vgumashta&quot; class=&quot;user-hover&quot; rel=&quot;vgumashta&quot;&gt;vgumashta&lt;/a&gt; and  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdere&quot; class=&quot;user-hover&quot; rel=&quot;jdere&quot;&gt;jdere&lt;/a&gt; - In Hive SessionState since there are several fields that are associated with the currently executing query, such as commandType, lastCommand. Also SessionState has a Conf object and this also gets set with query-specific information.&lt;/p&gt;</comment>
                            <comment id="14646695" author="thejas" created="Wed, 29 Jul 2015 20:23:11 +0000"  >&lt;p&gt;From &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ekoifman&quot; class=&quot;user-hover&quot; rel=&quot;ekoifman&quot;&gt;ekoifman&lt;/a&gt; - Each SessionState has 1 instance of HiveTxnManager which can only handle 1 txn at a time. &lt;br/&gt;
While JDBC spec doesn&apos;t make concurrency guarantees explicit, most info on the web says it&apos;s a bad idea to allow this.&lt;br/&gt;
For example, suppose you setAutoCommit(false) and then run to statements concurrently on this Connection, would you expect 1 transaction for each statement or 1 txn for both.&lt;/p&gt;</comment>
                            <comment id="14646865" author="sershe" created="Wed, 29 Jul 2015 22:33:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4239&quot; title=&quot;Remove lock on compilation stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4239&quot;&gt;&lt;del&gt;HIVE-4239&lt;/del&gt;&lt;/a&gt; only allows parallel compilation between sessions&lt;/p&gt;</comment>
                            <comment id="14646875" author="thejas" created="Wed, 29 Jul 2015 22:46:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt; Thanks for clarifying, I had forgotten about the SessionState.get().getCompileLock()  that you added. I will update the description.&lt;br/&gt;
Looks like we can still have issues outside of compilation, during parallel query execution within session.&lt;/p&gt;</comment>
                            <comment id="14646917" author="cwsteinbach" created="Wed, 29 Jul 2015 23:40:16 +0000"  >&lt;blockquote&gt;&lt;p&gt;Note that running queries in parallel for single session is not straightforward with jdbc, you need to spawn another thread as the Statement.execute calls are blocking. I believe ODBC has non blocking query execution API ...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I made a couple mistakes when I designed the HS2 API (the use of Thrift Enums and Unions comes to mind), but by far the biggest mistake was allowing a 1:many relationship between Sessions and Operations. At the time I thought there was a chance that the ODBC spec required this, but now think this is something best handled on the client side. Providing support for the 1:many Session:Operation mapping results in a lot of additional complexity on the server-side, only to yield a feature with a very high potential for misuse.&lt;/p&gt;

&lt;p&gt;Rather than temporarily serializing operations against a given session, I propose instead that we enforce a 1:1 mapping between HS2 sessions and active operations. This is a backward incompatible change, but one which I think will yield far better results in the long term.&lt;/p&gt;</comment>
                            <comment id="15352048" author="sershe" created="Mon, 27 Jun 2016 23:29:42 +0000"  >&lt;p&gt;Simple patch that adds a semaphore to acquire/release methods, configurable and on by default (parallel operations are off, rather). &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;thejas&lt;/a&gt; can you take a look? Esp. wrt what is an operation and what isn&apos;t, e.g. should fetching results be allowed to run in parallel with other things?&lt;/p&gt;

&lt;p&gt;I will post an RB shortly&lt;/p&gt;</comment>
                            <comment id="15352488" author="cwsteinbach" created="Tue, 28 Jun 2016 06:59:24 +0000"  >&lt;p&gt;HiveSessionImpl is starting to look a lot like SessionState. I suppose that was inevitable &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15352677" author="hiveqa" created="Tue, 28 Jun 2016 09:39:40 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12813993/HIVE-11402.01.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12813993/HIVE-11402.01.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 7 failed/errored test(s), 10285 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_12
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_13
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_schema_evol_orc_nonvec_mapwork_part
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_stats_list_bucket
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver_vector_complex_all
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver_vector_complex_join
org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService.testDelayedLocalityNodeCommErrorImmediateAllocation
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/285/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/285/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/285/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/285/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-50-18-27-0.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-285/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-50-18-27-0.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-285/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 7 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12813993 - PreCommit-HIVE-MASTER-Build&lt;/p&gt;</comment>
                            <comment id="15356245" author="sershe" created="Thu, 30 Jun 2016 00:27:41 +0000"  >&lt;p&gt;Test failures are unrelated&lt;/p&gt;</comment>
                            <comment id="15357330" author="mohitsabharwal" created="Thu, 30 Jun 2016 15:57:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt;, we should keep the default for hive.server2.parallel.ops.in.session as true, otherwise this is a backward incompatible change for Hue and any other client code where queries currently share sessions.&lt;/p&gt;</comment>
                            <comment id="15357574" author="sershe" created="Thu, 30 Jun 2016 18:00:29 +0000"  >&lt;p&gt;Fixed.&lt;/p&gt;</comment>
                            <comment id="15359004" author="hiveqa" created="Fri, 1 Jul 2016 13:59:56 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12815513/HIVE-11402.02.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12815513/HIVE-11402.02.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 7 failed/errored test(s), 10287 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_12
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_stats_list_bucket
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_subquery_multiinsert
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver_vector_complex_all
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver_vector_complex_join
org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService.testDelayedLocalityNodeCommErrorImmediateAllocation
org.apache.hive.spark.client.TestSparkClient.testJobSubmission
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/335/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/335/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/335/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/335/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-50-18-27-0.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-335/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-50-18-27-0.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-335/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 7 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12815513 - PreCommit-HIVE-MASTER-Build&lt;/p&gt;</comment>
                            <comment id="15362523" author="aihuaxu" created="Tue, 5 Jul 2016 14:01:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt; Do you still observe parallel operation issues in the single session? I have separated QueryState out of SessionState in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-13424&quot; title=&quot;Refactoring the code to pass a QueryState object rather than HiveConf object&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-13424&quot;&gt;&lt;del&gt;HIVE-13424&lt;/del&gt;&lt;/a&gt;. From previous comments, seems it&apos;s also common to share operations in the same session like in HUE. Should we continue to fix parallel issue if we have any rather than disallowing parallel execution?&lt;/p&gt;</comment>
                            <comment id="15362941" author="sershe" created="Tue, 5 Jul 2016 18:24:49 +0000"  >&lt;p&gt;This patch has been changed to allow it by default. This is just a safety flag if someone sees issues.&lt;br/&gt;
Last time I checked, the runtime parallel operations in the same session work purely by magic (I think I left a comment somewhere).&lt;br/&gt;
I.e. I believe they may work but there&apos;s no good reason why they do, because non-thread-safe objects appear to be used without synchronization; there may be some bugs.&lt;/p&gt;

&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;thejas&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15363011" author="aihuaxu" created="Tue, 5 Jul 2016 18:55:13 +0000"  >&lt;p&gt;hmm. Yeah. Saw your comments in HiveSessionImpl and we do have issues  that some variables in SessionState are not protected for multiple threads.&lt;/p&gt;

&lt;p&gt;Seems to make sense to have such option and continue fixing the thread-safe issue. Just wondering if the option is set to false, what kind of effect to the new operation in the same session? will it just get blocked to get the previous one finished?  &lt;/p&gt;
</comment>
                            <comment id="15363028" author="sershe" created="Tue, 5 Jul 2016 19:01:33 +0000"  >&lt;p&gt;Yeah, there&apos;s a single-entry semaphore that controls the execution of most operations (not e.g. fetchresults, or cancel operation &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;)&lt;/p&gt;</comment>
                            <comment id="15365551" author="sershe" created="Thu, 7 Jul 2016 03:37:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aihuaxu&quot; class=&quot;user-hover&quot; rel=&quot;aihuaxu&quot;&gt;aihuaxu&lt;/a&gt; do you have more input on the patch? &lt;/p&gt;</comment>
                            <comment id="15368188" author="aihuaxu" created="Fri, 8 Jul 2016 18:54:12 +0000"  >&lt;p&gt;Just worried how useful that configuration will be since mostly the users will use mixed HUE, beeline, etc, I guess. So we may have to keep the default. But seems this is safe to add.&lt;/p&gt;

&lt;p&gt;+1.&lt;/p&gt;</comment>
                            <comment id="15368895" author="thejas" created="Sat, 9 Jul 2016 02:41:43 +0000"  >&lt;p&gt;Sorry about the delay in reviewing.&lt;br/&gt;
This will however not disallow query execution in parallel when the query execution is done asynchronously (the default mode with our jdbc driver).&lt;/p&gt;</comment>
                            <comment id="15368906" author="thejas" created="Sat, 9 Jul 2016 03:08:13 +0000"  >&lt;p&gt;Maybe pass the lock object to operation async execution and have it release it when its done ?&lt;br/&gt;
ie, send it all way to SQLOperation.runInternal ..&lt;/p&gt;</comment>
                            <comment id="15371520" author="sershe" created="Mon, 11 Jul 2016 20:11:52 +0000"  >&lt;p&gt;The handling for async ops, as well as some refactoring. Thanks for the pointer!&lt;/p&gt;</comment>
                            <comment id="15373097" author="hiveqa" created="Tue, 12 Jul 2016 15:41:37 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12817230/HIVE-11402.03.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12817230/HIVE-11402.03.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 9 failed/errored test(s), 10294 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestMiniTezCliDriver-tez_joins_explain.q-vector_data_types.q-tez_dynpart_hashjoin_1.q-and-12-more - did not produce a TEST-*.xml file
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_acid_globallimit
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_13
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_stats_list_bucket
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_subquery_multiinsert
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver_vector_complex_all
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver_vector_complex_join
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_acid_globallimit
org.apache.hadoop.hive.cli.TestMinimrCliDriver.org.apache.hadoop.hive.cli.TestMinimrCliDriver
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/482/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/482/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/482/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/482/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-482/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-482/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 9 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12817230 - PreCommit-HIVE-MASTER-Build&lt;/p&gt;</comment>
                            <comment id="15375250" author="thejas" created="Wed, 13 Jul 2016 15:57:10 +0000"  >&lt;p&gt;+1 Changes look good. Please verify the UT failures are not related.&lt;/p&gt;</comment>
                            <comment id="15375303" author="thejas" created="Wed, 13 Jul 2016 16:30:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt; Can you also add a simple test to ensure that the queries get serialized ? (So we know this feature works &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/tongue.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; )&lt;/p&gt;

&lt;p&gt;Something like - &lt;br/&gt;
HiveStatement stmt1 = (HiveStatement)  con.createStatement();&lt;br/&gt;
HiveStatement stmt2 = (HiveStatement) con.createStatement();&lt;br/&gt;
stmt1.executeAsync(create table t(i int));&lt;br/&gt;
stmt1.executeAsync(insert into t select sleepUDF(1))&lt;br/&gt;
stmt2.executeAsync(select * from t ) &lt;br/&gt;
verify above statement returned 1 row&lt;/p&gt;


</comment>
                            <comment id="15375306" author="thejas" created="Wed, 13 Jul 2016 16:32:54 +0000"  >&lt;p&gt;See TestJdbcDriver2 for example. We would ofcourse need the config to be set to prevent parallel query in the test suite.&lt;/p&gt;</comment>
                            <comment id="15375744" author="sershe" created="Wed, 13 Jul 2016 20:57:10 +0000"  >&lt;p&gt;Added the test as suggested. I am not familiar with the setup of this test so I wouldn&apos;t vouch for its relevance &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15375745" author="sershe" created="Wed, 13 Jul 2016 20:57:39 +0000"  >&lt;p&gt;Also rebased the patch.&lt;/p&gt;</comment>
                            <comment id="15375829" author="thejas" created="Wed, 13 Jul 2016 21:51:14 +0000"  >&lt;p&gt;Test case looks good. (though i would have preferred the use of a sleepUDF to guarantee how long the first query would take).&lt;br/&gt;
Just some minor comments about comments in reviewboard.&lt;br/&gt;
+1 with the review comments addressed.&lt;/p&gt;</comment>
                            <comment id="15375939" author="sershe" created="Wed, 13 Jul 2016 22:45:15 +0000"  >&lt;p&gt;Changed the test to use sleep UDF, and sleep for half a second&lt;/p&gt;</comment>
                            <comment id="15376090" author="sershe" created="Thu, 14 Jul 2016 00:46:55 +0000"  >&lt;p&gt;Will commit after HiveQA&lt;/p&gt;</comment>
                            <comment id="15376800" author="hiveqa" created="Thu, 14 Jul 2016 11:51:03 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12817855/HIVE-11402.06.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12817855/HIVE-11402.06.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 2 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 9 failed/errored test(s), 10319 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_acid_globallimit
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_12
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_stats_list_bucket
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_subquery_multiinsert
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_acid_globallimit
org.apache.hadoop.hive.cli.TestMinimrCliDriver.org.apache.hadoop.hive.cli.TestMinimrCliDriver
org.apache.hadoop.hive.llap.daemon.impl.TestLlapTokenChecker.testCheckPermissions
org.apache.hadoop.hive.llap.daemon.impl.TestLlapTokenChecker.testGetToken
org.apache.hadoop.hive.llap.security.TestLlapSignerImpl.testSigning
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/508/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/508/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/508/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/508/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-508/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-508/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 9 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12817855 - PreCommit-HIVE-MASTER-Build&lt;/p&gt;</comment>
                            <comment id="15378765" author="thejas" created="Fri, 15 Jul 2016 02:40:10 +0000"  >&lt;p&gt;Committed the patch. Verified that the failures are not related.&lt;/p&gt;</comment>
                            <comment id="15378772" author="lefty@hortonworks.com" created="Fri, 15 Jul 2016 02:50:46 +0000"  >&lt;p&gt;Doc note:  This adds &lt;b&gt;hive.server2.parallel.ops.in.session&lt;/b&gt; to HiveConf.java, so it will need to be documented in the wiki for releases 2.1.1 and 2.2.0.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-HiveServer2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Configuration Properties &amp;#8211; HiveServer2 &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Added TODOC2.1.1 and TODOC2.2 labels.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12639490">HIVE-4239</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12989701">HIVE-14247</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13632190">HIVE-29286</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12912944">HIVE-12409</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13574098">HIVE-28168</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12813993" name="HIVE-11402.01.patch" size="15655" author="sershe" created="Tue, 28 Jun 2016 00:42:14 +0000"/>
                            <attachment id="12815513" name="HIVE-11402.02.patch" size="15654" author="sershe" created="Thu, 30 Jun 2016 18:00:29 +0000"/>
                            <attachment id="12817230" name="HIVE-11402.03.patch" size="30272" author="sershe" created="Mon, 11 Jul 2016 20:11:52 +0000"/>
                            <attachment id="12817796" name="HIVE-11402.04.patch" size="31433" author="sershe" created="Wed, 13 Jul 2016 20:57:10 +0000"/>
                            <attachment id="12817825" name="HIVE-11402.05.patch" size="32109" author="sershe" created="Wed, 13 Jul 2016 22:45:15 +0000"/>
                            <attachment id="12817855" name="HIVE-11402.06.patch" size="31970" author="sershe" created="Thu, 14 Jul 2016 00:47:40 +0000"/>
                            <attachment id="12813980" name="HIVE-11402.patch" size="13995" author="sershe" created="Mon, 27 Jun 2016 23:29:42 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 18 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2i38v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>