<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:07:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-4883] TestHadoop20SAuthBridge tests fail sometimes because of race condition</title>
                <link>https://issues.apache.org/jira/browse/HIVE-4883</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;TestHadoop20SAuthBridge tests testSaslWithHiveMetaStore and testMetastoreProxyUser sometimes fail. I have seen this more often on mac and windows, but this can happen on linux as well.&lt;/p&gt;

&lt;p&gt;The problem is that metastore is started in a different thread and these unit tests actually rely on the metastore having initialized DelegationTokenSecretManager in HadoopThriftAuthBridge20S as part of the metastore startup (HiveMetaStore.startMetaStore )&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12658625">HIVE-4883</key>
            <summary>TestHadoop20SAuthBridge tests fail sometimes because of race condition</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thejas">Thejas Nair</assignee>
                                    <reporter username="thejas">Thejas Nair</reporter>
                        <labels>
                    </labels>
                <created>Thu, 18 Jul 2013 20:21:44 +0000</created>
                <updated>Tue, 15 Oct 2013 23:30:06 +0000</updated>
                            <resolved>Wed, 24 Jul 2013 13:59:55 +0000</resolved>
                                    <version>0.11.0</version>
                                    <fixVersion>0.12.0</fixVersion>
                                    <component>Metastore</component>
                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13712764" author="thejas" created="Thu, 18 Jul 2013 20:23:46 +0000"  >
&lt;p&gt;The stack trace for the both the tests that error our is like this -&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;testcase classname=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hive.thrift.TestHadoop20SAuthBridge&quot;&lt;/span&gt; name=&lt;span class=&quot;code-quote&quot;&gt;&quot;testSaslWithHiveMetaStore&quot;&lt;/span&gt; time=&lt;span class=&quot;code-quote&quot;&gt;&quot;0.908&quot;&lt;/span&gt;&amp;gt;
    &amp;lt;error type=&lt;span class=&quot;code-quote&quot;&gt;&quot;java.lang.NullPointerException&quot;&lt;/span&gt;&amp;gt;java.lang.NullPointerException
        at org.apache.hadoop.hive.thrift.HadoopThriftAuthBridge20S$Server$1.run(HadoopThriftAuthBridge20S.java:382)
        at org.apache.hadoop.hive.thrift.HadoopThriftAuthBridge20S$Server$1.run(HadoopThriftAuthBridge20S.java:380)
        at java.security.AccessController.doPrivileged(Native Method)
        at javax.security.auth.Subject.doAs(Subject.java:396)
        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1135)
        at org.apache.hadoop.hive.thrift.HadoopThriftAuthBridge20S$Server.getDelegationToken(HadoopThriftAuthBridge20S.java:380)
        at org.apache.hadoop.hive.metastore.HiveMetaStore.getDelegationToken(HiveMetaStore.java:4137)
        at org.apache.hadoop.hive.thrift.TestHadoop20SAuthBridge.getDelegationTokenStr(TestHadoop20SAuthBridge.java:298)
        at org.apache.hadoop.hive.thrift.TestHadoop20SAuthBridge.obtainTokenAndAddIntoUGI(TestHadoop20SAuthBridge.java:305)
        at org.apache.hadoop.hive.thrift.TestHadoop20SAuthBridge.testSaslWithHiveMetaStore(TestHadoop20SAuthBridge.java:214)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at junit.framework.TestCase.runTest(TestCase.java:154)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13712789" author="thejas" created="Thu, 18 Jul 2013 20:36:20 +0000"  >&lt;p&gt;To reproduce this issue consistently, this patch can be applied - &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4883&quot; title=&quot;TestHadoop20SAuthBridge tests fail sometimes because of race condition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4883&quot;&gt;&lt;del&gt;HIVE-4883&lt;/del&gt;&lt;/a&gt;-reproduce.patch . It adds a sleep in HiveMetaStore.startMetaStore call.&lt;/p&gt;</comment>
                            <comment id="13712811" author="thejas" created="Thu, 18 Jul 2013 20:46:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4883&quot; title=&quot;TestHadoop20SAuthBridge tests fail sometimes because of race condition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4883&quot;&gt;&lt;del&gt;HIVE-4883&lt;/del&gt;&lt;/a&gt;.01.patch - works on trunk.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4883&quot; title=&quot;TestHadoop20SAuthBridge tests fail sometimes because of race condition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4883&quot;&gt;&lt;del&gt;HIVE-4883&lt;/del&gt;&lt;/a&gt;.patch.dependson-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3255&quot; title=&quot;Add DBTokenStore to store Delegation Tokens in DB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3255&quot;&gt;&lt;del&gt;HIVE-3255&lt;/del&gt;&lt;/a&gt; - works on trunk with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3255&quot; title=&quot;Add DBTokenStore to store Delegation Tokens in DB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3255&quot;&gt;&lt;del&gt;HIVE-3255&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13712897" author="thejas" created="Thu, 18 Jul 2013 21:37:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4883&quot; title=&quot;TestHadoop20SAuthBridge tests fail sometimes because of race condition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4883&quot;&gt;&lt;del&gt;HIVE-4883&lt;/del&gt;&lt;/a&gt;.02.patch - &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4883&quot; title=&quot;TestHadoop20SAuthBridge tests fail sometimes because of race condition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4883&quot;&gt;&lt;del&gt;HIVE-4883&lt;/del&gt;&lt;/a&gt;.01.patch regenerated with &apos;git diff --no-prefix&apos; (as I assume the pre-commit test might work otherwise)&lt;/p&gt;</comment>
                            <comment id="13712964" author="brocknoland" created="Thu, 18 Jul 2013 22:13:59 +0000"  >&lt;p&gt;I just updated the wiki, git diff, git diff --no-prefix, and svn diff are all supported.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Hive+PreCommit+Patch+Testing&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/Hive/Hive+PreCommit+Patch+Testing&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13712980" author="thejas" created="Thu, 18 Jul 2013 22:21:58 +0000"  >&lt;blockquote&gt;&lt;p&gt;I just updated the wiki, git diff, git diff --no-prefix, and svn diff are all supported.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Awesome! thanks again for all this work!&lt;/p&gt;</comment>
                            <comment id="13712996" author="thejas" created="Thu, 18 Jul 2013 22:27:52 +0000"  >&lt;p&gt;reviewboard link - &lt;a href=&quot;https://reviews.apache.org/r/12748/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/12748/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13713085" author="hiveqa" created="Thu, 18 Jul 2013 23:31:08 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 build exited with an error&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12593068/HIVE-4883.02.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12593068/HIVE-4883.02.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s)&lt;br/&gt;
Failed tests:&lt;br/&gt;
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_bucketizedhiveinputformat&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/82/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/82/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/82/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/82/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;br/&gt;
Executing org.apache.hive.ptest.execution.CleanupPhase&lt;br/&gt;
Executing org.apache.hive.ptest.execution.PrepPhase&lt;br/&gt;
Executing org.apache.hive.ptest.execution.ExecutionPhase&lt;br/&gt;
Executing org.apache.hive.ptest.execution.ReportingPhase&lt;br/&gt;
Tests failed with: TestsFailedException: 1 tests failed&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13713106" author="brocknoland" created="Thu, 18 Jul 2013 23:41:43 +0000"  >&lt;p&gt;I&apos;ve see that test fail a number of times. I added it to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4851&quot; title=&quot;Fix flaky tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4851&quot;&gt;&lt;del&gt;HIVE-4851&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13713237" author="hiveqa" created="Fri, 19 Jul 2013 01:34:04 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12593068/HIVE-4883.02.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12593068/HIVE-4883.02.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 all tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/84/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/84/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/84/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/84/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;br/&gt;
Executing org.apache.hive.ptest.execution.CleanupPhase&lt;br/&gt;
Executing org.apache.hive.ptest.execution.PrepPhase&lt;br/&gt;
Executing org.apache.hive.ptest.execution.ExecutionPhase&lt;br/&gt;
Executing org.apache.hive.ptest.execution.ReportingPhase&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13715418" author="brocknoland" created="Mon, 22 Jul 2013 17:34:33 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13718383" author="brocknoland" created="Wed, 24 Jul 2013 13:59:55 +0000"  >&lt;p&gt;Thank you for your contribution! I committed this to trunk.&lt;/p&gt;</comment>
                            <comment id="13795970" author="ashutoshc" created="Tue, 15 Oct 2013 23:30:06 +0000"  >&lt;p&gt;This issue has been fixed and released as part of 0.12 release. If you find further issues, please create a new jira and link it to this one.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12593048" name="HIVE-4883-reproduce.patch" size="690" author="thejas" created="Thu, 18 Jul 2013 20:36:20 +0000"/>
                            <attachment id="12593053" name="HIVE-4883.01.patch" size="3611" author="thejas" created="Thu, 18 Jul 2013 20:46:45 +0000"/>
                            <attachment id="12593068" name="HIVE-4883.02.patch" size="3603" author="thejas" created="Thu, 18 Jul 2013 21:37:45 +0000"/>
                            <attachment id="12593052" name="HIVE-4883.patch.dependson-HIVE-3255" size="3628" author="thejas" created="Thu, 18 Jul 2013 20:43:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>338819</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 6 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1mftz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>339139</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>