<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:25:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-7167] Hive Metastore fails to start with SQLServerException</title>
                <link>https://issues.apache.org/jira/browse/HIVE-7167</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;In the case that hiveserver2 uses embedded metastore and hiveserver uses remote metastore, this exception comes up when hiveserver2 and hiveserver are started simultaneously.&lt;/p&gt;

&lt;p&gt;metastore service status is running but when I launch hive cli, I get following metastore connection error:&lt;/p&gt;

&lt;p&gt;C:\apps\dist\hive-0.13.0.2.1.2.0-1660\bin&amp;gt;hive.cmd&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;14/05/09 17:40:03 WARN conf.HiveConf: DEPRECATED: hive.metastore.ds.retry.* no l
onger has any effect.  Use hive.hmshandler.retry.* instead

Logging initialized using configuration in file:/C:/apps/dist/hive-0.13.0.2.1.2.
0-1660/conf/hive-log4j.properties
Exception in thread &quot;main&quot; java.lang.RuntimeException: java.lang.RuntimeExceptio
n: Unable to instantiate org.apache.hadoop.hive.metastore.HiveMetaStoreClient
        at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.jav
a:347)
        at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:681)
        at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:625)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.
java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
sorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at org.apache.hadoop.util.RunJar.main(RunJar.java:212)
Caused by: java.lang.RuntimeException: Unable to instantiate org.apache.hadoop.h
ive.metastore.HiveMetaStoreClient
        at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStore
Utils.java:1413)
        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.&amp;lt;init&amp;gt;(Retry
ingMetaStoreClient.java:62)
        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(Ret
ryingMetaStoreClient.java:72)
        at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.ja
va:2444)
        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:2456)
        at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.jav
a:341)
        ... 7 more
Caused by: java.lang.reflect.InvocationTargetException
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)

        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstruct
orAccessorImpl.java:57)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingC
onstructorAccessorImpl.java:45)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
        at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStore
Utils.java:1411)
        ... 12 more
Caused by: MetaException(message:Could not connect to meta store using any of th
e URIs provided. Most recent failure: org.apache.thrift.transport.TTransportExce
ption: java.net.ConnectException: Connection refused: connect
        at org.apache.thrift.transport.TSocket.open(TSocket.java:185)
        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.open(HiveMetaSto
reClient.java:336)
        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.&amp;lt;init&amp;gt;(HiveMetaS
toreClient.java:214)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)

        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstruct
orAccessorImpl.java:57)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingC
onstructorAccessorImpl.java:45)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
        at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStore
Utils.java:1411)
        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.&amp;lt;init&amp;gt;(Retry
ingMetaStoreClient.java:62)
        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(Ret
ryingMetaStoreClient.java:72)
        at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.ja
va:2444)
        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:2456)
        at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.jav
a:341)
        at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:681)
        at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:625)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.
java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
sorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at org.apache.hadoop.util.RunJar.main(RunJar.java:212)
Caused by: java.net.ConnectException: Connection refused: connect
        at java.net.TwoStacksPlainSocketImpl.socketConnect(Native Method)
        at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.ja
va:339)
        at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocket
Impl.java:200)
        at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java
:182)
        at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:157)
        at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:391)
        at java.net.Socket.connect(Socket.java:579)
        at org.apache.thrift.transport.TSocket.open(TSocket.java:180)
        ... 19 more
)
        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.open(HiveMetaSto
reClient.java:382)
        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.&amp;lt;init&amp;gt;(HiveMetaS
toreClient.java:214)
        ... 17 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Because of this issue, we are seeing many failures in hive related system tests.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12717952">HIVE-7167</key>
            <summary>Hive Metastore fails to start with SQLServerException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xiaobingo">Xiaobing Zhou</assignee>
                                    <reporter username="xiaobingo">Xiaobing Zhou</reporter>
                        <labels>
                            <label>patch,</label>
                            <label>test</label>
                    </labels>
                <created>Mon, 2 Jun 2014 18:13:36 +0000</created>
                <updated>Thu, 13 Nov 2014 19:43:32 +0000</updated>
                            <resolved>Tue, 7 Oct 2014 21:52:20 +0000</resolved>
                                    <version>0.14.0</version>
                                    <fixVersion>0.14.0</fixVersion>
                                    <component>Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14016253" author="xiaobingo" created="Tue, 3 Jun 2014 06:09:24 +0000"  >&lt;p&gt;The patch is available now. I setup a review for submission, see the link:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/22191/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://reviews.apache.org/r/22191/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14017507" author="hiveqa" created="Wed, 4 Jun 2014 08:44:07 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 no tests executed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12648081/HIVE-7167.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12648081/HIVE-7167.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/384/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/384/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/384/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/384/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-384/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-384/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Tests exited with: NonZeroExitCodeException
Command &apos;bash /data/hive-ptest/working/scratch/source-prep.sh&apos; failed with exit status 1 and output &apos;+ [[ -n /usr/java/jdk1.7.0_45-cloudera ]]
+ export JAVA_HOME=/usr/java/jdk1.7.0_45-cloudera
+ JAVA_HOME=/usr/java/jdk1.7.0_45-cloudera
+ export PATH=/usr/java/jdk1.7.0_45-cloudera/bin/:/usr/java/jdk1.6.0_34/bin:/usr/local/apache-maven-3.0.5/bin:/usr/local/apache-maven-3.0.5/bin:/usr/java/jdk1.6.0_34/bin:/usr/local/apache-ant-1.9.1/bin:/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/home/hiveptest/bin
+ PATH=/usr/java/jdk1.7.0_45-cloudera/bin/:/usr/java/jdk1.6.0_34/bin:/usr/local/apache-maven-3.0.5/bin:/usr/local/apache-maven-3.0.5/bin:/usr/java/jdk1.6.0_34/bin:/usr/local/apache-ant-1.9.1/bin:/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/home/hiveptest/bin
+ export &apos;ANT_OPTS=-Xmx1g -XX:MaxPermSize=256m &apos;
+ ANT_OPTS=&apos;-Xmx1g -XX:MaxPermSize=256m &apos;
+ export &apos;M2_OPTS=-Xmx1g -XX:MaxPermSize=256m -Dhttp.proxyHost=localhost -Dhttp.proxyPort=3128&apos;
+ M2_OPTS=&apos;-Xmx1g -XX:MaxPermSize=256m -Dhttp.proxyHost=localhost -Dhttp.proxyPort=3128&apos;
+ cd /data/hive-ptest/working/
+ tee /data/hive-ptest/logs/PreCommit-HIVE-Build-384/source-prep.txt
+ [[ false == \t\r\u\e ]]
+ mkdir -p maven ivy
+ [[ svn = \s\v\n ]]
+ [[ -n &apos;&apos; ]]
+ [[ -d apache-svn-trunk-source ]]
+ [[ ! -d apache-svn-trunk-source/.svn ]]
+ [[ ! -d apache-svn-trunk-source ]]
+ cd apache-svn-trunk-source
+ svn revert -R .
Reverted &apos;ql/src/test/results/clientpositive/tez/having.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/transform_ppr1.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/join0.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/tez_joins_explain.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/count.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/bucket_map_join_tez2.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/mrr.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/tez_join_tests.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/subquery_in.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/union2.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/mapjoin_mapjoin.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/mapjoin_decimal.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/union8.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/bucket2.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/bucket4.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/cross_product_check_1.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/cross_join.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/tez_union.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/subquery_exists.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/metadata_only_queries.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/transform_ppr2.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/disable_merge_for_bucketing.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/filter_join_breaktask.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/bucket_map_join_tez1.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/transform1.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/limit_pushdown.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/auto_join0.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/union3.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/union5.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/union7.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/union9.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/script_pipe.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/bucket3.q.out&apos;
Reverted &apos;ql/src/test/results/clientpositive/tez/cross_product_check_2.q.out&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/parse/MapReduceCompiler.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/parse/TaskCompiler.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/parse/GenTezUtils.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/exec/FetchTask.java&apos;
++ egrep -v &apos;^X|^Performing status on external&apos;
++ awk &apos;{print $2}&apos;
++ svn status --no-ignore
+ rm -rf target datanucleus.log ant/target shims/target shims/0.20/target shims/0.20S/target shims/0.23/target shims/aggregator/target shims/common/target shims/common-secure/target packaging/target hbase-handler/target testutils/target jdbc/target metastore/target itests/target itests/hcatalog-unit/target itests/test-serde/target itests/qtest/target itests/hive-minikdc/target itests/hive-unit/target itests/custom-serde/target itests/util/target hcatalog/target hcatalog/core/target hcatalog/streaming/target hcatalog/server-extensions/target hcatalog/webhcat/svr/target hcatalog/webhcat/java-client/target hcatalog/hcatalog-pig-adapter/target hwi/target common/target common/src/gen contrib/target service/target serde/target beeline/target odbc/target cli/target ql/dependency-reduced-pom.xml ql/target
+ svn update
U    metastore/src/java/org/apache/hadoop/hive/metastore/StatObjectConverter.java
U    ql/src/test/results/clientpositive/display_colstats_tbllvl.q.out

Fetching external item into &apos;hcatalog/src/test/e2e/harness&apos;
Updated external to revision 1600009.

Updated to revision 1600009.
+ patchCommandPath=/data/hive-ptest/working/scratch/smart-apply-patch.sh
+ patchFilePath=/data/hive-ptest/working/scratch/build.patch
+ [[ -f /data/hive-ptest/working/scratch/build.patch ]]
+ chmod +x /data/hive-ptest/working/scratch/smart-apply-patch.sh
+ /data/hive-ptest/working/scratch/smart-apply-patch.sh /data/hive-ptest/working/scratch/build.patch
The patch does not appear to apply with p0, p1, or p2
+ exit 1
&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12648081&lt;/p&gt;</comment>
                            <comment id="14020409" author="sershe" created="Fri, 6 Jun 2014 21:35:47 +0000"  >&lt;p&gt;1) Can you post SQLServerException you are getting?&lt;br/&gt;
2) Why these 3 methods of all methods?&lt;br/&gt;
3) It seems like and a hacky way to solve the problem. It can still fail again, right?&lt;/p&gt;</comment>
                            <comment id="14020747" author="sushanth" created="Sat, 7 Jun 2014 07:30:42 +0000"  >&lt;p&gt;(Removing fix version tag of 0.13.0 - 0.13.0 is a released version that won&apos;t be changing, this patch will likely go into 0.14)&lt;/p&gt;</comment>
                            <comment id="14039334" author="xiaobingo" created="Fri, 20 Jun 2014 20:49:27 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt;, &lt;br/&gt;
1) Here&apos;s the exception.&lt;br/&gt;
2) it&apos;s because these three methods are potential places that causes contention when two metastores both try to initialize DB in the same time.&lt;br/&gt;
3) I don&apos;t think so. If one tried and failed in the first time, JDOException is caught for one more time try, if failed again, simply ignored, means another metastore succeeds.&lt;/p&gt;

&lt;p&gt;2014-05-15 21:06:01,659 WARN  server.HiveServer2 (HiveServer2.java:startHiveServer2(112)) - Error starting HiveServer2 on attempt 1, will retry in 60 seconds&lt;br/&gt;
java.lang.RuntimeException: java.lang.RuntimeException: Unable to instantiate org.apache.hadoop.hive.metastore.HiveMetaStoreClient&lt;br/&gt;
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:347)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:292)&lt;br/&gt;
	at org.apache.hive.service.cli.session.SessionManager.applyAuthorizationConfigPolicy(SessionManager.java:88)&lt;br/&gt;
	at org.apache.hive.service.cli.session.SessionManager.init(SessionManager.java:63)&lt;br/&gt;
	at org.apache.hive.service.CompositeService.init(CompositeService.java:59)&lt;br/&gt;
	at org.apache.hive.service.cli.CLIService.init(CLIService.java:110)&lt;br/&gt;
	at org.apache.hive.service.CompositeService.init(CompositeService.java:59)&lt;br/&gt;
	at org.apache.hive.service.server.HiveServer2.init(HiveServer2.java:68)&lt;br/&gt;
	at org.apache.hive.service.server.HiveServer2.startHiveServer2(HiveServer2.java:100)&lt;br/&gt;
	at org.apache.hive.service.server.HiveServer2.main(HiveServer2.java:149)&lt;br/&gt;
Caused by: java.lang.RuntimeException: Unable to instantiate org.apache.hadoop.hive.metastore.HiveMetaStoreClient&lt;br/&gt;
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1413)&lt;br/&gt;
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.&amp;lt;init&amp;gt;(RetryingMetaStoreClient.java:62)&lt;br/&gt;
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:72)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:2453)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:2465)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:341)&lt;br/&gt;
	... 9 more&lt;br/&gt;
Caused by: java.lang.reflect.InvocationTargetException&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)&lt;br/&gt;
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)&lt;br/&gt;
	at java.lang.reflect.Constructor.newInstance(Constructor.java:525)&lt;br/&gt;
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1411)&lt;br/&gt;
	... 14 more&lt;br/&gt;
Caused by: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore&lt;br/&gt;
NestedThrowables:&lt;br/&gt;
java.sql.BatchUpdateException: Violation of UNIQUE KEY constraint &apos;GLOBALPRIVILEGEINDEX&apos;. Cannot insert duplicate key in object &apos;dbo.GLOBAL_PRIVS&apos;. The duplicate key value is (admin, ROLE, All, admin, ROLE).&lt;br/&gt;
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:451)&lt;br/&gt;
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:165)&lt;br/&gt;
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:406)&lt;br/&gt;
	at org.apache.hadoop.hive.metastore.ObjectStore.grantPrivileges(ObjectStore.java:3877)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:601)&lt;br/&gt;
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:108)&lt;br/&gt;
	at $Proxy10.grantPrivileges(Unknown Source)&lt;br/&gt;
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultRoles(HiveMetaStore.java:567)&lt;br/&gt;
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:398)&lt;br/&gt;
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.&amp;lt;init&amp;gt;(HiveMetaStore.java:356)&lt;br/&gt;
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.&amp;lt;init&amp;gt;(RetryingHMSHandler.java:54)&lt;br/&gt;
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:59)&lt;br/&gt;
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newHMSHandler(HiveMetaStore.java:4944)&lt;br/&gt;
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.&amp;lt;init&amp;gt;(HiveMetaStoreClient.java:171)&lt;br/&gt;
	... 19 more&lt;br/&gt;
Caused by: java.sql.BatchUpdateException: Violation of UNIQUE KEY constraint &apos;GLOBALPRIVILEGEINDEX&apos;. Cannot insert duplicate key in object &apos;dbo.GLOBAL_PRIVS&apos;. The duplicate key value is (admin, ROLE, All, admin, ROLE).&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.executeBatch(SQLServerPreparedStatement.java:1160)&lt;br/&gt;
	at com.jolbox.bonecp.StatementHandle.executeBatch(StatementHandle.java:424)&lt;br/&gt;
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:372)&lt;br/&gt;
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:628)&lt;br/&gt;
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:596)&lt;br/&gt;
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:683)&lt;br/&gt;
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:86)&lt;br/&gt;
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:454)&lt;br/&gt;
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:203)&lt;br/&gt;
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:267)&lt;br/&gt;
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:98)&lt;br/&gt;
	... 34 more&lt;br/&gt;
2014-05-15 21:06:01,667 INFO  server.HiveServer2 (HiveServer2.java:startHiveServer2(120)) - Exception caught when calling stop of HiveServer2 before retrying start&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
	at org.apache.hive.service.server.HiveServer2.stop(HiveServer2.java:82)&lt;br/&gt;
	at org.apache.hive.service.server.HiveServer2.startHiveServer2(HiveServer2.java:116)&lt;br/&gt;
	at org.apache.hive.service.server.HiveServer2.main(HiveServer2.java:149)&lt;/p&gt;</comment>
                            <comment id="14039341" author="xiaobingo" created="Fri, 20 Jun 2014 20:52:08 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sushanth&quot; class=&quot;user-hover&quot; rel=&quot;sushanth&quot;&gt;sushanth&lt;/a&gt; for pointing-out, new patch &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-7167&quot; title=&quot;Hive Metastore fails to start with SQLServerException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-7167&quot;&gt;&lt;del&gt;HIVE-7167&lt;/del&gt;&lt;/a&gt;.2.patch is made on trunk and attached.&lt;/p&gt;</comment>
                            <comment id="14039383" author="xiaobingo" created="Fri, 20 Jun 2014 21:29:46 +0000"  >&lt;p&gt;closed by mistake, reopen it.&lt;/p&gt;</comment>
                            <comment id="14039389" author="xiaobingo" created="Fri, 20 Jun 2014 21:32:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-7167&quot; title=&quot;Hive Metastore fails to start with SQLServerException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-7167&quot;&gt;&lt;del&gt;HIVE-7167&lt;/del&gt;&lt;/a&gt;.2.patch is available.&lt;/p&gt;</comment>
                            <comment id="14040002" author="hiveqa" created="Sun, 22 Jun 2014 00:53:16 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12651723/HIVE-7167.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12651723/HIVE-7167.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 5 failed/errored test(s), 5668 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_bucketmapjoin13
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_root_dir_external_table
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_ctas
org.apache.hive.hcatalog.pig.TestHCatLoader.testReadDataPrimitiveTypes
org.apache.hive.jdbc.miniHS2.TestHiveServer2.testConnection
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/545/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/545/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/545/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/545/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-545/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-545/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 5 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12651723&lt;/p&gt;</comment>
                            <comment id="14052995" author="sushanth" created="Sun, 6 Jul 2014 00:23:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt;, could you please verify Xiaobing&apos;s replies and review the patch?&lt;/p&gt;</comment>
                            <comment id="14066963" author="sershe" created="Fri, 18 Jul 2014 22:13:15 +0000"  >&lt;p&gt;Hmm, sure, +1. Sorry for long time taken, I was on vacation&lt;/p&gt;</comment>
                            <comment id="14066966" author="sershe" created="Fri, 18 Jul 2014 22:14:01 +0000"  >&lt;p&gt;Perhaps justification comment can be added about why the retries are done (or log message modified to mention that we assume we have metastore conflict)&lt;/p&gt;</comment>
                            <comment id="14068719" author="xiaobingo" created="Mon, 21 Jul 2014 16:23:04 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt;, I will do that to make next patch.&lt;/p&gt;</comment>
                            <comment id="14101438" author="sushanth" created="Mon, 18 Aug 2014 22:34:56 +0000"  >&lt;p&gt;Canceling patch because it has an outstanding issue:&lt;/p&gt;

&lt;p&gt;createDefaultDB() has a catch MetaException removed that should not be removed, since it winds up being caught by the generic catch Exception, which causes the Metastore to fail as it attempts to cast the MetaException to a RuntimeException.&lt;/p&gt;</comment>
                            <comment id="14102929" author="sushanth" created="Tue, 19 Aug 2014 22:01:25 +0000"  >&lt;p&gt;Marking as patch-available again and withdrawing my objections, apologies for canceling it. I was looking at code in an older branch, and there, the catch Exception below this would cause an issue. However, &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6338&quot; title=&quot;Improve exception handling in createDefaultDb() in Metastore&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6338&quot;&gt;&lt;del&gt;HIVE-6338&lt;/del&gt;&lt;/a&gt; invalidates that concern of mine, and this patch should be good to go.&lt;/p&gt;</comment>
                            <comment id="14152129" author="vikram.dixit" created="Mon, 29 Sep 2014 19:28:15 +0000"  >&lt;p&gt;Can this be rebased please. I am marking this for 0.14. &lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Vikram.&lt;/p&gt;</comment>
                            <comment id="14161103" author="xiaobingo" created="Mon, 6 Oct 2014 22:12:49 +0000"  >&lt;p&gt;Made the 3rd patch to be reviewed. &lt;/p&gt;</comment>
                            <comment id="14161113" author="xiaobingo" created="Mon, 6 Oct 2014 22:17:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt; can you review and check it in if possible? Thanks!&lt;/p&gt;</comment>
                            <comment id="14162217" author="hiveqa" created="Tue, 7 Oct 2014 18:07:48 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12673219/HIVE-7167.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12673219/HIVE-7167.3.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 6526 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_schemeAuthority
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1144/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1144/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1144/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1144/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1144/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1144/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12673219&lt;/p&gt;</comment>
                            <comment id="14162575" author="sershe" created="Tue, 7 Oct 2014 21:31:44 +0000"  >&lt;p&gt;Will commit shortly&lt;/p&gt;</comment>
                            <comment id="14162621" author="sershe" created="Tue, 7 Oct 2014 21:52:20 +0000"  >&lt;p&gt;committed to trunk and branch-0.14&lt;/p&gt;</comment>
                            <comment id="14162748" author="xiaobingo" created="Tue, 7 Oct 2014 23:04:06 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;sershe&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="14210989" author="thejas" created="Thu, 13 Nov 2014 19:43:31 +0000"  >&lt;p&gt;This has been fixed in 0.14 release. Please open new jira if you see any issues.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12648081" name="HIVE-7167.1.patch" size="3191" author="xiaobingo" created="Tue, 3 Jun 2014 06:09:24 +0000"/>
                            <attachment id="12651723" name="HIVE-7167.2.patch" size="2405" author="xiaobingo" created="Fri, 20 Jun 2014 20:38:35 +0000"/>
                            <attachment id="12673219" name="HIVE-7167.3.patch" size="3568" author="xiaobingo" created="Mon, 6 Oct 2014 22:12:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>396154</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1w7e7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>396279</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>