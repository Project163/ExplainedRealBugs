<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:40:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-12738] subquery with NOT IN failing due to ClassCastException</title>
                <link>https://issues.apache.org/jira/browse/HIVE-12738</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;create table student(
            name string,
            age &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,
            gpa &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)

create table voter(
            name string,
            age &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,
            registration string,
            contributions &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;)

select * 
from student 
where not student.age in
(select age from voter) 
order by age;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Fails in Tez &amp;#8211; Vectorized Reduce.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12923923">HIVE-12738</key>
            <summary>subquery with NOT IN failing due to ClassCastException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mmccline">Matt McCline</assignee>
                                    <reporter username="mmccline">Matt McCline</reporter>
                        <labels>
                    </labels>
                <created>Wed, 23 Dec 2015 05:50:24 +0000</created>
                <updated>Tue, 16 Feb 2016 23:52:47 +0000</updated>
                            <resolved>Thu, 24 Dec 2015 22:39:39 +0000</resolved>
                                                    <fixVersion>2.0.0</fixVersion>
                                    <component>Hive</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15070074" author="hagleitn" created="Wed, 23 Dec 2015 19:28:27 +0000"  >&lt;p&gt;This should be reproducible w/o adding large new tables to the ut framework. The query shape is pretty simple.&lt;/p&gt;</comment>
                            <comment id="15070080" author="hagleitn" created="Wed, 23 Dec 2015 19:34:19 +0000"  >&lt;p&gt;The fix assumes that there are two parents... This could be an n-way join. In general, isn&apos;t there a more robust way to fix this? There are other ways of having multi parents. &lt;/p&gt;

&lt;p&gt;I see two fixes: One where the function just searches all branches, probably depth first. The other where we avoid backtracking and just terminate the walk when we find a vectorized reduce that produces rows. That should be sufficient no?&lt;/p&gt;</comment>
                            <comment id="15070273" author="mmccline" created="Wed, 23 Dec 2015 22:41:15 +0000"  >&lt;p&gt;I tried to reduce the size of the query files before submitting patch and the query plan changed and it stop repro&apos;ing.  I&apos;ll try again.&lt;/p&gt;</comment>
                            <comment id="15070276" author="mmccline" created="Wed, 23 Dec 2015 22:43:09 +0000"  >&lt;p&gt;Some vectorized classes are marked as having new VectorizationContext but not all vectorized classes are currently marked.  So, it isn&apos;t easy to determine if a class is generating rows.&lt;/p&gt;</comment>
                            <comment id="15070278" author="mmccline" created="Wed, 23 Dec 2015 22:46:02 +0000"  >&lt;p&gt;Vectorized vertices (Map and Reduce) can by mixed &amp;#8211; that is the root and some number of children are vectorized but if there is a GroupBy with AVG that generated STRUCT output (count,sum) then by the old design we have VectorGroupBy generate rows and all down stream operators are non-vectorized...&lt;/p&gt;</comment>
                            <comment id="15070297" author="hagleitn" created="Wed, 23 Dec 2015 23:06:25 +0000"  >&lt;p&gt;If I understand correctly:&lt;/p&gt;

&lt;p&gt;When you&apos;re looking at a reduce vertex, at some point you might transition from vector to row based processing. However, there&apos;s no way to come back from row to vector, right?&lt;/p&gt;

&lt;p&gt;So, when converting reduce work you just need to bail when the transition happens, don&apos;t you?&lt;/p&gt;</comment>
                            <comment id="15070311" author="mmccline" created="Wed, 23 Dec 2015 23:27:25 +0000"  >&lt;p&gt;Yes, it can happen for Map or Reduce.  We could detect when we have transitioned and just stop trying to vectorized below...&lt;/p&gt;</comment>
                            <comment id="15070318" author="hagleitn" created="Wed, 23 Dec 2015 23:33:19 +0000"  >&lt;p&gt;.2 doesn&apos;t actually have a fix, but it does contain the same test case based on &quot;src&quot; (i.e.: existing tables). I can reproduce the same issue with this query.&lt;/p&gt;</comment>
                            <comment id="15070320" author="hagleitn" created="Wed, 23 Dec 2015 23:34:06 +0000"  >&lt;p&gt;(in case you&apos;re wondering - if produced the golden files with the original patch, without any patch the query will fail on tez)&lt;/p&gt;</comment>
                            <comment id="15070338" author="mmccline" created="Thu, 24 Dec 2015 00:09:00 +0000"  >&lt;p&gt;Thanks for producing a better test case.&lt;/p&gt;

&lt;p&gt;In a few minutes I&apos;ll post a new patch that stops validating or vectorizing after a vectorized GROUP BY that outputs rows.  It does make the major assumption we don&apos;t have multiple table scans in vectorization and that we are validating / vectorizing a single GROUP BY operator.&lt;/p&gt;</comment>
                            <comment id="15070653" author="mmccline" created="Thu, 24 Dec 2015 06:46:47 +0000"  >&lt;p&gt;Used a set to avoid making any assumptions about multiple table scans, operators with multiple children, etc.&lt;/p&gt;</comment>
                            <comment id="15070853" author="hiveqa" created="Thu, 24 Dec 2015 10:31:56 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12779394/HIVE-12738.4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12779394/HIVE-12738.4.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 35 failed/errored test(s), 9981 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestHWISessionManager - did not produce a TEST-*.xml file
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_order2
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_vector_groupby_mapjoin
org.apache.hadoop.hive.cli.TestEncryptedHDFSCliDriver.testCliDriver_encryption_insert_partition_dynamic
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.org.apache.hadoop.hive.cli.TestMiniTezCliDriver
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_auto_sortmerge_join_2
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_bucket2
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_cbo_gby_empty
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_count
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_delete_all_non_partitioned
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_insert_values_non_partitioned
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_mapjoin_decimal
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_ptf
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_ptf_streaming
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_schema_evol_text_nonvec_fetchwork_part
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_script_pipe
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_subquery_in
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_transform_ppr2
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_between_in
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_char_4
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_groupby_mapjoin
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_columnstats_partlvl_multiple_part_clause
org.apache.hadoop.hive.ql.exec.spark.session.TestSparkSessionManagerImpl.testMultiSessionMultipleUse
org.apache.hadoop.hive.ql.exec.spark.session.TestSparkSessionManagerImpl.testSingleSessionMultipleUse
org.apache.hadoop.hive.ql.security.authorization.plugin.TestHiveOperationType.checkHiveOperationTypeMatch
org.apache.hive.jdbc.TestSSL.testSSLVersion
org.apache.hive.spark.client.TestSparkClient.testAddJarsAndFiles
org.apache.hive.spark.client.TestSparkClient.testCounters
org.apache.hive.spark.client.TestSparkClient.testErrorJob
org.apache.hive.spark.client.TestSparkClient.testJobSubmission
org.apache.hive.spark.client.TestSparkClient.testMetricsCollection
org.apache.hive.spark.client.TestSparkClient.testRemoteClient
org.apache.hive.spark.client.TestSparkClient.testSimpleSparkJob
org.apache.hive.spark.client.TestSparkClient.testSyncRpc
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6467/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6467/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6467/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6467/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-6467/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-6467/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 35 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12779394 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="15071250" author="hiveqa" created="Thu, 24 Dec 2015 21:16:00 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12779438/HIVE-12738.5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12779438/HIVE-12738.5.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 17 failed/errored test(s), 9991 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestHWISessionManager - did not produce a TEST-*.xml file
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_order2
org.apache.hadoop.hive.cli.TestEncryptedHDFSCliDriver.testCliDriver_encryption_insert_partition_dynamic
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_columnstats_partlvl_multiple_part_clause
org.apache.hadoop.hive.ql.exec.spark.session.TestSparkSessionManagerImpl.testMultiSessionMultipleUse
org.apache.hadoop.hive.ql.exec.spark.session.TestSparkSessionManagerImpl.testSingleSessionMultipleUse
org.apache.hadoop.hive.ql.security.authorization.plugin.TestHiveOperationType.checkHiveOperationTypeMatch
org.apache.hive.jdbc.TestSSL.testSSLVersion
org.apache.hive.spark.client.TestSparkClient.testAddJarsAndFiles
org.apache.hive.spark.client.TestSparkClient.testCounters
org.apache.hive.spark.client.TestSparkClient.testErrorJob
org.apache.hive.spark.client.TestSparkClient.testJobSubmission
org.apache.hive.spark.client.TestSparkClient.testMetricsCollection
org.apache.hive.spark.client.TestSparkClient.testRemoteClient
org.apache.hive.spark.client.TestSparkClient.testSimpleSparkJob
org.apache.hive.spark.client.TestSparkClient.testSyncRpc
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6472/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6472/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6472/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6472/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-6472/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-6472/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 17 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12779438 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="15071254" author="mmccline" created="Thu, 24 Dec 2015 21:22:57 +0000"  >&lt;p&gt;Test failures are unrelated to changes.&lt;/p&gt;</comment>
                            <comment id="15071265" author="hagleitn" created="Thu, 24 Dec 2015 21:58:06 +0000"  >&lt;p&gt;+1 LGTM. Only nit is in the comments, I believe plural of vector batch is vector batches. I&apos;ll change on commit.&lt;/p&gt;</comment>
                            <comment id="15071266" author="hagleitn" created="Thu, 24 Dec 2015 21:58:37 +0000"  >&lt;p&gt;I also ran order2.q manually without any issues (test report had changes).&lt;/p&gt;</comment>
                            <comment id="15071276" author="hagleitn" created="Thu, 24 Dec 2015 22:39:40 +0000"  >&lt;p&gt;Committed to branch-2.0 and master&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12779207" name="HIVE-12738.01.patch" size="589904" author="mmccline" created="Wed, 23 Dec 2015 06:27:54 +0000"/>
                            <attachment id="12779340" name="HIVE-12738.2.patch" size="16029" author="hagleitn" created="Wed, 23 Dec 2015 23:33:19 +0000"/>
                            <attachment id="12779344" name="HIVE-12738.3.patch" size="23186" author="mmccline" created="Thu, 24 Dec 2015 00:15:39 +0000"/>
                            <attachment id="12779394" name="HIVE-12738.4.patch" size="25943" author="mmccline" created="Thu, 24 Dec 2015 06:44:17 +0000"/>
                            <attachment id="12779438" name="HIVE-12738.5.patch" size="25915" author="mmccline" created="Thu, 24 Dec 2015 12:41:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 47 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2q8sv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>