<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:34:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-10972] DummyTxnManager always locks the current database in shared mode, which is incorrect.</title>
                <link>https://issues.apache.org/jira/browse/HIVE-10972</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;In DummyTxnManager &lt;a href=&quot;http://grepcode.com/file/repo1.maven.org/maven2/co.cask.cdap/hive-exec/0.13.0/org/apache/hadoop/hive/ql/lockmgr/DummyTxnManager.java#163&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;line 163 &lt;/a&gt;, it always locks the current database. &lt;/p&gt;

&lt;p&gt;That is not correct since the current database can be &quot;db1&quot;, and the query can be &quot;select * from db2.tb1&quot;, which will lock db1 unnecessarily.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12836646">HIVE-10972</key>
            <summary>DummyTxnManager always locks the current database in shared mode, which is incorrect.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aihuaxu">Aihua Xu</assignee>
                                    <reporter username="aihuaxu">Aihua Xu</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Jun 2015 20:37:49 +0000</created>
                <updated>Tue, 1 Oct 2019 22:07:23 +0000</updated>
                            <resolved>Sat, 20 Jun 2015 20:34:30 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Locking</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14581049" author="damien.carol" created="Wed, 10 Jun 2015 20:44:32 +0000"  >&lt;p&gt;Made some comments in RB.&lt;/p&gt;</comment>
                            <comment id="14581088" author="aihuaxu" created="Wed, 10 Jun 2015 21:08:54 +0000"  >&lt;p&gt;Thanks for reviewing. I addressed the comments. &lt;/p&gt;</comment>
                            <comment id="14581173" author="hiveqa" created="Wed, 10 Jun 2015 22:37:49 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12738910/HIVE-10972.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12738910/HIVE-10972.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 5 failed/errored test(s), 9008 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_lockneg_try_lock_db_in_use
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_join28
org.apache.hive.beeline.TestSchemaTool.testSchemaInit
org.apache.hive.beeline.TestSchemaTool.testSchemaUpgrade
org.apache.hive.hcatalog.streaming.TestStreaming.testTransactionBatchEmptyCommit
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4239/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4239/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4239/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4239/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4239/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4239/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 5 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12738910 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14581257" author="aihuaxu" created="Wed, 10 Jun 2015 23:53:53 +0000"  >&lt;p&gt;The first one looks related but I verified locally and it passed with no problem. &lt;/p&gt;</comment>
                            <comment id="14581331" author="hiveqa" created="Thu, 11 Jun 2015 01:45:03 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12738918/HIVE-10972.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12738918/HIVE-10972.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 3 failed/errored test(s), 9008 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_lockneg_try_lock_db_in_use
org.apache.hive.beeline.TestSchemaTool.testSchemaInit
org.apache.hive.beeline.TestSchemaTool.testSchemaUpgrade
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4241/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4241/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4241/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4241/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4241/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4241/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12738918 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14581930" author="aihuaxu" created="Thu, 11 Jun 2015 13:41:37 +0000"  >&lt;p&gt;I&apos;m investigating lockneg_try_lock_db_in_use test case failure. Seems related.&lt;/p&gt;</comment>
                            <comment id="14582041" author="aihuaxu" created="Thu, 11 Jun 2015 15:11:19 +0000"  >&lt;p&gt;I think we have another issue in ZooKeeperHiveLockManager.java, in which when locking exclusively on an object we should also check if the children are locked.&lt;/p&gt;

&lt;p&gt;The test passed before, is because we always locked the current database before. If we do &lt;tt&gt;use default; lock table lockneg2.tstsrcpart shared; lock database lockneg2 exclusive;&lt;/tt&gt;, it will allow to do so which is not correct. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-10984&quot; title=&quot;After &amp;quot;lock table shared&amp;quot; explicit lock, &amp;quot;lock database exclusive&amp;quot; should fail.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-10984&quot;&gt;HIVE-10984&lt;/a&gt; has been filed to get it fixed. I will leave the test failure as it is. &lt;/p&gt;</comment>
                            <comment id="14582053" author="aihuaxu" created="Thu, 11 Jun 2015 15:16:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=damien.carol&quot; class=&quot;user-hover&quot; rel=&quot;damien.carol&quot;&gt;damien.carol&lt;/a&gt; Can you take a look again and see my following comments?&lt;/p&gt;</comment>
                            <comment id="14582615" author="ctang.ma" created="Thu, 11 Jun 2015 22:28:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aihuaxu&quot; class=&quot;user-hover&quot; rel=&quot;aihuaxu&quot;&gt;aihuaxu&lt;/a&gt; I left some comments and questions on the RB.&lt;/p&gt;</comment>
                            <comment id="14583458" author="aihuaxu" created="Fri, 12 Jun 2015 14:27:10 +0000"  >&lt;p&gt;I updated the patch to address the comment. &lt;/p&gt;</comment>
                            <comment id="14583792" author="hiveqa" created="Fri, 12 Jun 2015 18:01:41 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12739244/HIVE-10972.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12739244/HIVE-10972.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 3 failed/errored test(s), 9008 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_lockneg_try_lock_db_in_use
org.apache.hive.beeline.TestSchemaTool.testSchemaInit
org.apache.hive.beeline.TestSchemaTool.testSchemaUpgrade
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4256/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4256/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4256/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4256/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4256/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4256/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12739244 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14583921" author="ctang.ma" created="Fri, 12 Jun 2015 19:15:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aihuaxu&quot; class=&quot;user-hover&quot; rel=&quot;aihuaxu&quot;&gt;aihuaxu&lt;/a&gt; Could you have a look at and take care of the failed test lockneg_try_lock_db_in_use? I think the test is valid.&lt;/p&gt;</comment>
                            <comment id="14583928" author="aihuaxu" created="Fri, 12 Jun 2015 19:18:24 +0000"  >&lt;p&gt;Yeah. Please see my comments above. &lt;/p&gt;

&lt;p&gt;I think we have another issue in ZooKeeperHiveLockManager.java, in which when locking exclusively on an object we should also check if the children are locked.&lt;br/&gt;
The test passed before, is because we always locked the current database before. If we do use default; lock table lockneg2.tstsrcpart shared; lock database lockneg2 exclusive;, it will allow to do so which is not correct.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-10984&quot; title=&quot;After &amp;quot;lock table shared&amp;quot; explicit lock, &amp;quot;lock database exclusive&amp;quot; should fail.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-10984&quot;&gt;HIVE-10984&lt;/a&gt; has been filed to get it fixed. I will leave the test failure as it is.&lt;/p&gt;</comment>
                            <comment id="14583971" author="aihuaxu" created="Fri, 12 Jun 2015 19:50:52 +0000"  >&lt;p&gt;Or I can update the test case temporarily to get it passed since &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-10984&quot; title=&quot;After &amp;quot;lock table shared&amp;quot; explicit lock, &amp;quot;lock database exclusive&amp;quot; should fail.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-10984&quot;&gt;HIVE-10984&lt;/a&gt; may not be a quick fix. Then I will re-fix the test with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-10984&quot; title=&quot;After &amp;quot;lock table shared&amp;quot; explicit lock, &amp;quot;lock database exclusive&amp;quot; should fail.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-10984&quot;&gt;HIVE-10984&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14583976" author="aihuaxu" created="Fri, 12 Jun 2015 19:55:58 +0000"  >&lt;p&gt;Test case updated.&lt;/p&gt;</comment>
                            <comment id="14584176" author="hiveqa" created="Fri, 12 Jun 2015 22:12:27 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12739314/HIVE-10972.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12739314/HIVE-10972.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 3 failed/errored test(s), 9009 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_join28
org.apache.hive.beeline.TestSchemaTool.testSchemaInit
org.apache.hive.beeline.TestSchemaTool.testSchemaUpgrade
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4259/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4259/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4259/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4259/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4259/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4259/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12739314 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14586157" author="aihuaxu" created="Mon, 15 Jun 2015 15:04:56 +0000"  >&lt;p&gt;The tests are not related.&lt;/p&gt;</comment>
                            <comment id="14586162" author="aihuaxu" created="Mon, 15 Jun 2015 15:09:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gates&quot; class=&quot;user-hover&quot; rel=&quot;gates&quot;&gt;gates&lt;/a&gt;  Seems you worked on the initial version? Can you also take a look at the change to see if it will cause any issue?&lt;/p&gt;</comment>
                            <comment id="14586753" author="alangates" created="Mon, 15 Jun 2015 21:32:29 +0000"  >&lt;p&gt;Yes, I&apos;ll take a look.&lt;/p&gt;</comment>
                            <comment id="14590300" author="alangates" created="Wed, 17 Jun 2015 18:41:13 +0000"  >&lt;p&gt;I don&apos;t think this change is right.  I agree that always locking the current database is a bug.  But the way the ZK lock manager works you do need to put a lock on the database if your are locking a table in that db.  (DbTxnManager does not work this way).  So it&apos;s fine to take out the code that locks the current db.  But you need to replace it with code that locks the appropriate db.  I don&apos;t see that code in the patch.&lt;/p&gt;</comment>
                            <comment id="14590709" author="aihuaxu" created="Wed, 17 Jun 2015 22:06:20 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gates&quot; class=&quot;user-hover&quot; rel=&quot;gates&quot;&gt;gates&lt;/a&gt; Actually current code already locks the appropriate db (more accurate: all the parents of the lock object) which is done in getLockObjects() call in DummyTxtManager.java. &lt;/p&gt;</comment>
                            <comment id="14593401" author="aihuaxu" created="Fri, 19 Jun 2015 13:09:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gates&quot; class=&quot;user-hover&quot; rel=&quot;gates&quot;&gt;gates&lt;/a&gt; Ping. +&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt; as well since seems you also have knowledge on that front.&lt;/p&gt;</comment>
                            <comment id="14593685" author="alangates" created="Fri, 19 Jun 2015 17:42:49 +0000"  >&lt;p&gt;Yes, you&apos;re right.  I see where it&apos;s getting the parent locks.&lt;/p&gt;

&lt;p&gt;+1 to committing this patch.&lt;/p&gt;</comment>
                            <comment id="14594784" author="ctang.ma" created="Sat, 20 Jun 2015 20:34:30 +0000"  >&lt;p&gt;Committed to Hive 2.0.0 and 1.3.0. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aihuaxu&quot; class=&quot;user-hover&quot; rel=&quot;aihuaxu&quot;&gt;aihuaxu&lt;/a&gt; for the patch and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gates&quot; class=&quot;user-hover&quot; rel=&quot;gates&quot;&gt;gates&lt;/a&gt; for review.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12739314" name="HIVE-10972.2.patch" size="10441" author="aihuaxu" created="Fri, 12 Jun 2015 19:54:54 +0000"/>
                            <attachment id="12739244" name="HIVE-10972.patch" size="8459" author="aihuaxu" created="Fri, 12 Jun 2015 14:25:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 22 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2fujz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>