<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:33:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-10244] Vectorization : TPC-DS Q80 fails with java.lang.ClassCastException when hive.vectorized.execution.reduce.enabled is enabled</title>
                <link>https://issues.apache.org/jira/browse/HIVE-10244</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Query &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;set hive.vectorized.execution.reduce.enabled=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
with ssr as
 (select  s_store_id as store_id,
          sum(ss_ext_sales_price) as sales,
          sum(coalesce(sr_return_amt, 0)) as returns,
          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit
  from store_sales left &lt;span class=&quot;code-keyword&quot;&gt;outer&lt;/span&gt; join store_returns on
         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),
     date_dim,
     store,
     item,
     promotion
 where ss_sold_date_sk = d_date_sk
       and d_date between &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&apos;1998-08-04&apos;&lt;/span&gt; as date) 
                  and (&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&apos;1998-09-04&apos;&lt;/span&gt; as date))
       and ss_store_sk = s_store_sk
       and ss_item_sk = i_item_sk
       and i_current_price &amp;gt; 50
       and ss_promo_sk = p_promo_sk
       and p_channel_tv = &lt;span class=&quot;code-quote&quot;&gt;&apos;N&apos;&lt;/span&gt;
 group by s_store_id)
 ,
 csr as
 (select  cp_catalog_page_id as catalog_page_id,
          sum(cs_ext_sales_price) as sales,
          sum(coalesce(cr_return_amount, 0)) as returns,
          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit
  from catalog_sales left &lt;span class=&quot;code-keyword&quot;&gt;outer&lt;/span&gt; join catalog_returns on
         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),
     date_dim,
     catalog_page,
     item,
     promotion
 where cs_sold_date_sk = d_date_sk
       and d_date between &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&apos;1998-08-04&apos;&lt;/span&gt; as date)
                  and (&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&apos;1998-09-04&apos;&lt;/span&gt; as date))
        and cs_catalog_page_sk = cp_catalog_page_sk
       and cs_item_sk = i_item_sk
       and i_current_price &amp;gt; 50
       and cs_promo_sk = p_promo_sk
       and p_channel_tv = &lt;span class=&quot;code-quote&quot;&gt;&apos;N&apos;&lt;/span&gt;
group by cp_catalog_page_id)
 ,
 wsr as
 (select  web_site_id,
          sum(ws_ext_sales_price) as sales,
          sum(coalesce(wr_return_amt, 0)) as returns,
          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit
  from web_sales left &lt;span class=&quot;code-keyword&quot;&gt;outer&lt;/span&gt; join web_returns on
         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),
     date_dim,
     web_site,
     item,
     promotion
 where ws_sold_date_sk = d_date_sk
       and d_date between &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&apos;1998-08-04&apos;&lt;/span&gt; as date)
                  and (&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&apos;1998-09-04&apos;&lt;/span&gt; as date))
        and ws_web_site_sk = web_site_sk
       and ws_item_sk = i_item_sk
       and i_current_price &amp;gt; 50
       and ws_promo_sk = p_promo_sk
       and p_channel_tv = &lt;span class=&quot;code-quote&quot;&gt;&apos;N&apos;&lt;/span&gt;
group by web_site_id)
  select  channel
        , id
        , sum(sales) as sales
        , sum(returns) as returns
        , sum(profit) as profit
 from 
 (select &lt;span class=&quot;code-quote&quot;&gt;&apos;store channel&apos;&lt;/span&gt; as channel
        , concat(&lt;span class=&quot;code-quote&quot;&gt;&apos;store&apos;&lt;/span&gt;, store_id) as id
        , sales
        , returns
        , profit
 from   ssr
 union all
 select &lt;span class=&quot;code-quote&quot;&gt;&apos;catalog channel&apos;&lt;/span&gt; as channel
        , concat(&lt;span class=&quot;code-quote&quot;&gt;&apos;catalog_page&apos;&lt;/span&gt;, catalog_page_id) as id
        , sales
        , returns
        , profit
 from  csr
 union all
 select &lt;span class=&quot;code-quote&quot;&gt;&apos;web channel&apos;&lt;/span&gt; as channel
        , concat(&lt;span class=&quot;code-quote&quot;&gt;&apos;web_site&apos;&lt;/span&gt;, web_site_id) as id
        , sales
        , returns
        , profit
 from   wsr
 ) x
 group by channel, id with rollup
 order by channel
         ,id
 limit 100
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Exception &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Vertex failed, vertexName=Reducer 5, vertexId=vertex_1426707664723_1377_1_22, diagnostics=[Task failed, taskId=task_1426707664723_1377_1_22_000000, diagnostics=[TaskAttempt 0 failed, info=[Error: Failure &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running task:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:171)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:137)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:330)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:179)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:171)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:171)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:167)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:267)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:248)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:148)
	... 14 more
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:394)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:252)
	... 16 more
Caused by: java.lang.ClassCastException: org.apache.hadoop.hive.ql.exec.vector.DoubleColumnVector cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.hadoop.hive.ql.exec.vector.BytesColumnVector
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupKeyHelper.copyGroupKey(VectorGroupKeyHelper.java:94)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator$ProcessingModeGroupBatches.processBatch(VectorGroupByOperator.java:729)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator.process(VectorGroupByOperator.java:878)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:378)
	... 17 more
], TaskAttempt 1 failed, info=[Error: Failure &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running task:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:171)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:137)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:330)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:179)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:171)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:171)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:167)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:267)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:248)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:148)
	... 14 more
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:394)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:252)
	... 16 more
Caused by: java.lang.ClassCastException: org.apache.hadoop.hive.ql.exec.vector.DoubleColumnVector cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.hadoop.hive.ql.exec.vector.BytesColumnVector
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupKeyHelper.copyGroupKey(VectorGroupKeyHelper.java:94)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator$ProcessingModeGroupBatches.processBatch(VectorGroupByOperator.java:729)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator.process(VectorGroupByOperator.java:878)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:378)
	... 17 more
], TaskAttempt 2 failed, info=[Error: Failure &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running task:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:171)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:137)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:330)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:179)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:171)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:171)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:167)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:267)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:248)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:148)
	... 14 more
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:394)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:252)
	... 16 more
Caused by: java.lang.ClassCastException: org.apache.hadoop.hive.ql.exec.vector.DoubleColumnVector cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.hadoop.hive.ql.exec.vector.BytesColumnVector
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupKeyHelper.copyGroupKey(VectorGroupKeyHelper.java:94)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator$ProcessingModeGroupBatches.processBatch(VectorGroupByOperator.java:729)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator.process(VectorGroupByOperator.java:878)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:378)
	... 17 more
], TaskAttempt 3 failed, info=[Error: Failure &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running task:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:171)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:137)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:330)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:179)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:171)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:171)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:167)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:267)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:248)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:148)
	... 14 more
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:394)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:252)
	... 16 more
Caused by: java.lang.ClassCastException: org.apache.hadoop.hive.ql.exec.vector.DoubleColumnVector cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.hadoop.hive.ql.exec.vector.BytesColumnVector
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupKeyHelper.copyGroupKey(VectorGroupKeyHelper.java:94)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator$ProcessingModeGroupBatches.processBatch(VectorGroupByOperator.java:729)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator.process(VectorGroupByOperator.java:878)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:378)
	... 17 more
]], Vertex failed as one or more tasks failed. failedTasks:1, Vertex vertex_1426707664723_1377_1_22 [Reducer 5] killed/failed due to:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;]
15/04/07 05:14:52 [main]: ERROR SessionState: Vertex failed, vertexName=Reducer 5, vertexId=vertex_1426707664723_1377_1_22, diagnostics=[Task failed, taskId=task_1426707664723_1377_1_22_000000, diagnostics=[TaskAttempt 0 failed, info=[Error: Failure &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running task:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:171)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:137)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:330)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:179)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:171)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:171)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:167)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:267)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:248)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:148)
	... 14 more
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:394)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:252)
	... 16 more
Caused by: java.lang.ClassCastException: org.apache.hadoop.hive.ql.exec.vector.DoubleColumnVector cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.hadoop.hive.ql.exec.vector.BytesColumnVector
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupKeyHelper.copyGroupKey(VectorGroupKeyHelper.java:94)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator$ProcessingModeGroupBatches.processBatch(VectorGroupByOperator.java:729)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator.process(VectorGroupByOperator.java:878)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:378)
	... 17 more
], TaskAttempt 1 failed, info=[Error: Failure &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running task:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:171)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:137)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:330)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:179)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:171)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:171)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:167)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:267)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:248)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:148)
	... 14 more
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:394)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:252)
	... 16 more
Caused by: java.lang.ClassCastException: org.apache.hadoop.hive.ql.exec.vector.DoubleColumnVector cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.hadoop.hive.ql.exec.vector.BytesColumnVector
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupKeyHelper.copyGroupKey(VectorGroupKeyHelper.java:94)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator$ProcessingModeGroupBatches.processBatch(VectorGroupByOperator.java:729)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator.process(VectorGroupByOperator.java:878)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:378)
	... 17 more
], TaskAttempt 2 failed, info=[Error: Failure &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running task:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:171)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:137)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:330)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:179)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:171)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:171)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:167)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:267)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:248)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:148)
	... 14 more
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:394)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:252)
	... 16 more
Caused by: java.lang.ClassCastException: org.apache.hadoop.hive.ql.exec.vector.DoubleColumnVector cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.hadoop.hive.ql.exec.vector.BytesColumnVector
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupKeyHelper.copyGroupKey(VectorGroupKeyHelper.java:94)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator$ProcessingModeGroupBatches.processBatch(VectorGroupByOperator.java:729)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator.process(VectorGroupByOperator.java:878)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:378)
	... 17 more
], TaskAttempt 3 failed, info=[Error: Failure &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running task:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:171)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:137)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:330)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:179)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:171)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:171)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:167)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:267)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:248)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:148)
	... 14 more
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:394)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:252)
	... 16 more
Caused by: java.lang.ClassCastException: org.apache.hadoop.hive.ql.exec.vector.DoubleColumnVector cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.hadoop.hive.ql.exec.vector.BytesColumnVector
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupKeyHelper.copyGroupKey(VectorGroupKeyHelper.java:94)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator$ProcessingModeGroupBatches.processBatch(VectorGroupByOperator.java:729)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator.process(VectorGroupByOperator.java:878)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:378)
	... 17 more
]], Vertex failed as one or more tasks failed. failedTasks:1, Vertex vertex_1426707664723_1377_1_22 [Reducer 5] killed/failed due to:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;]
Vertex killed, vertexName=Reducer 6, vertexId=vertex_1426707664723_1377_1_23, diagnostics=[Vertex received Kill &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; in RUNNING state., Vertex killed as other vertex failed. failedTasks:0, Vertex vertex_1426707664723_1377_1_23 [Reducer 6] killed/failed due to:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;]
15/04/07 05:14:52 [main]: ERROR SessionState: Vertex killed, vertexName=Reducer 6, vertexId=vertex_1426707664723_1377_1_23, diagnostics=[Vertex received Kill &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; in RUNNING state., Vertex killed as other vertex failed. failedTasks:0, Vertex vertex_1426707664723_1377_1_23 [Reducer 6] killed/failed due to:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;]
DAG failed due to vertex failure. failedVertices:1 killedVertices:1
15/04/07 05:14:52 [main]: ERROR SessionState: DAG failed due to vertex failure. failedVertices:1 killedVertices:1
FAILED: Execution Error, &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; code 2 from org.apache.hadoop.hive.ql.exec.tez.TezTask. Vertex failed, vertexName=Reducer 5, vertexId=vertex_1426707664723_1377_1_22, diagnostics=[Task failed, taskId=task_1426707664723_1377_1_22_000000, diagnostics=[TaskAttempt 0 failed, info=[Error: Failure &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running task:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:171)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:137)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:330)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:179)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:171)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:171)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:167)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:267)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:248)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:148)
	... 14 more
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:394)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:252)
	... 16 more
Caused by: java.lang.ClassCastException: org.apache.hadoop.hive.ql.exec.vector.DoubleColumnVector cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.hadoop.hive.ql.exec.vector.BytesColumnVector
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupKeyHelper.copyGroupKey(VectorGroupKeyHelper.java:94)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator$ProcessingModeGroupBatches.processBatch(VectorGroupByOperator.java:729)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator.process(VectorGroupByOperator.java:878)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:378)
	... 17 more
], TaskAttempt 1 failed, info=[Error: Failure &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running task:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:171)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:137)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:330)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:179)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:171)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:171)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:167)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0&#9731;00011.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:267)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:248)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:148)
	... 14 more
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:394)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:252)
	... 16 more
Caused by: java.lang.ClassCastException: org.apache.hadoop.hive.ql.exec.vector.DoubleColumnVector cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.hadoop.hive.ql.exec.vector.BytesColumnVector
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupKeyHelper.copyGroupKey(VectorGroupKeyHelper.java:94)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator$ProcessingModeGroupBatches.processBatch(VectorGroupByOperator.java:729)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator.process(VectorGroupByOperator.java:878)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:378)
	... 17 more
], TaskAttempt 2 failed, info=[Error: Failure &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running task:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:171)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:137)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:330)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:179)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:171)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:171)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:167)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:267)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:248)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:148)
	... 14 more
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:394)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:252)
	... 16 more
Caused by: java.lang.ClassCastException: org.apache.hadoop.hive.ql.exec.vector.DoubleColumnVector cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.hadoop.hive.ql.exec.vector.BytesColumnVector
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupKeyHelper.copyGroupKey(VectorGroupKeyHelper.java:94)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator$ProcessingModeGroupBatches.processBatch(VectorGroupByOperator.java:729)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator.process(VectorGroupByOperator.java:878)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:378)
	... 17 more
], TaskAttempt 3 failed, info=[Error: Failure &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running task:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:171)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:137)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:330)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:179)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:171)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:171)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:167)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:267)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:248)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:148)
	... 14 more
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:394)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:252)
	... 16 more
Caused by: java.lang.ClassCastException: org.apache.hadoop.hive.ql.exec.vector.DoubleColumnVector cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.hadoop.hive.ql.exec.vector.BytesColumnVector
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupKeyHelper.copyGroupKey(VectorGroupKeyHelper.java:94)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator$ProcessingModeGroupBatches.processBatch(VectorGroupByOperator.java:729)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator.process(VectorGroupByOperator.java:878)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:378)
	... 17 more
]], Vertex failed as one or more tasks failed. failedTasks:1, Vertex vertex_1426707664723_1377_1_22 [Reducer 5] killed/failed due to:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;]Vertex killed, vertexName=Reducer 6, vertexId=vertex_1426707664723_1377_1_23, diagnostics=[Vertex received Kill &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; in RUNNING state., Vertex killed as other vertex failed. failedTasks:0, Vertex vertex_1426707664723_1377_1_23 [Reducer 6] killed/failed due to:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;]DAG failed due to vertex failure. failedVertices:1 killedVertices:1
15/04/07 05:14:52 [main]: ERROR ql.Driver: FAILED: Execution Error, &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; code 2 from org.apache.hadoop.hive.ql.exec.tez.TezTask. Vertex failed, vertexName=Reducer 5, vertexId=vertex_1426707664723_1377_1_22, diagnostics=[Task failed, taskId=task_1426707664723_1377_1_22_000000, diagnostics=[TaskAttempt 0 failed, info=[Error: Failure &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running task:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:171)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:137)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:330)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:179)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:171)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:171)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:167)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:267)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:248)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:148)
	... 14 more
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:394)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:252)
	... 16 more
Caused by: java.lang.ClassCastException: org.apache.hadoop.hive.ql.exec.vector.DoubleColumnVector cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.hadoop.hive.ql.exec.vector.BytesColumnVector
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupKeyHelper.copyGroupKey(VectorGroupKeyHelper.java:94)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator$ProcessingModeGroupBatches.processBatch(VectorGroupByOperator.java:729)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator.process(VectorGroupByOperator.java:878)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:378)
	... 17 more
], TaskAttempt 1 failed, info=[Error: Failure &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running task:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:171)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:137)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:330)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:179)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:171)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:171)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:167)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:267)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:248)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:148)
	... 14 more
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:394)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:252)
	... 16 more
Caused by: java.lang.ClassCastException: org.apache.hadoop.hive.ql.exec.vector.DoubleColumnVector cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.hadoop.hive.ql.exec.vector.BytesColumnVector
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupKeyHelper.copyGroupKey(VectorGroupKeyHelper.java:94)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator$ProcessingModeGroupBatches.processBatch(VectorGroupByOperator.java:729)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator.process(VectorGroupByOperator.java:878)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:378)
	... 17 more
], TaskAttempt 2 failed, info=[Error: Failure &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running task:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:171)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:137)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:330)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:179)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:171)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:171)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:167)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8&#9731;00012.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:267)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:248)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:148)
	... 14 more
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:394)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:252)
	... 16 more
Caused by: java.lang.ClassCastException: org.apache.hadoop.hive.ql.exec.vector.DoubleColumnVector cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.hadoop.hive.ql.exec.vector.BytesColumnVector
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupKeyHelper.copyGroupKey(VectorGroupKeyHelper.java:94)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator$ProcessingModeGroupBatches.processBatch(VectorGroupByOperator.java:729)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator.process(VectorGroupByOperator.java:878)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:378)
	... 17 more
], TaskAttempt 3 failed, info=[Error: Failure &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running task:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:171)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:137)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:330)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:179)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:171)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:171)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:167)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:267)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:248)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:148)
	... 14 more
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing vector batch (tag=0) \N�\N�0�9.285817653506076E8�4.639990363237801E7�-1.1814318134887291E8
\N�\N�0�4.682909323885761E8�2.2415242712669864E7�-5.966176123188091E7
\N�\N�0�1.2847032699693155E9�6.300096113768728E7�-5.94963316209578E8
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:394)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:252)
	... 16 more
Caused by: java.lang.ClassCastException: org.apache.hadoop.hive.ql.exec.vector.DoubleColumnVector cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.hadoop.hive.ql.exec.vector.BytesColumnVector
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupKeyHelper.copyGroupKey(VectorGroupKeyHelper.java:94)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator$ProcessingModeGroupBatches.processBatch(VectorGroupByOperator.java:729)
	at org.apache.hadoop.hive.ql.exec.vector.VectorGroupByOperator.process(VectorGroupByOperator.java:878)
	at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.processVectors(ReduceRecordSource.java:378)
	... 17 more
]], Vertex failed as one or more tasks failed. failedTasks:1, Vertex vertex_1426707664723_1377_1_22 [Reducer 5] killed/failed due to:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;]Vertex killed, vertexName=Reducer 6, vertexId=vertex_1426707664723_1377_1_23, diagnostics=[Vertex received Kill &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; in RUNNING state., Vertex killed as other vertex failed. failedTasks:0, Vertex vertex_1426707664723_1377_1_23 [Reducer 6] killed/failed due to:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;]DAG failed due to vertex failure. failedVertices:1 killedVertices:1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Plan &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      Edges:
        Map 12 &amp;lt;- Map 14 (BROADCAST_EDGE), Map 15 (BROADCAST_EDGE), Map 16 (BROADCAST_EDGE), Map 17 (BROADCAST_EDGE), Map 18 (BROADCAST_EDGE)
        Map 19 &amp;lt;- Map 21 (BROADCAST_EDGE), Map 22 (BROADCAST_EDGE), Map 23 (BROADCAST_EDGE), Map 24 (BROADCAST_EDGE), Map 25 (BROADCAST_EDGE)
        Reducer 13 &amp;lt;- Map 12 (SIMPLE_EDGE), Union 4 (CONTAINS)
        Reducer 2 &amp;lt;- Map 1 (SIMPLE_EDGE), Map 10 (BROADCAST_EDGE), Map 11 (BROADCAST_EDGE), Map 7 (SIMPLE_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Reducer 20 &amp;lt;- Map 19 (SIMPLE_EDGE), Union 4 (CONTAINS)
        Reducer 3 &amp;lt;- Reducer 2 (SIMPLE_EDGE), Union 4 (CONTAINS)
        Reducer 5 &amp;lt;- Union 4 (SIMPLE_EDGE)
        Reducer 6 &amp;lt;- Reducer 5 (SIMPLE_EDGE)
      DagName: mmokhtar_20150407051226_eb6d232e-cb00-4174-8b2f-d70aa2b3fb15:1
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ((ss_item_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; and ss_promo_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) and ss_store_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 550076554 Data size: 47370018896 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((ss_item_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; and ss_promo_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) and ss_store_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 524469260 Data size: 14487496336 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), ss_store_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), ss_promo_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), ss_ticket_number (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), ss_ext_sales_price (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), ss_net_profit (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), ss_sold_date_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 524469260 Data size: 14487496336 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col3 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col3 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        Statistics: Num rows: 524469260 Data size: 14487496336 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col2 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col4 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), _col5 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), _col6 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
            Execution mode: vectorized
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: promotion
                  filterExpr: ((p_channel_tv = &lt;span class=&quot;code-quote&quot;&gt;&apos;N&apos;&lt;/span&gt;) and p_promo_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 450 Data size: 530848 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((p_channel_tv = &lt;span class=&quot;code-quote&quot;&gt;&apos;N&apos;&lt;/span&gt;) and p_promo_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 225 Data size: 20025 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: p_promo_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                      outputColumnNames: _col0
                      Statistics: Num rows: 225 Data size: 900 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        Statistics: Num rows: 225 Data size: 900 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: s_store_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 212 Data size: 405680 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: s_store_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 212 Data size: 22048 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), s_store_id (type: string)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 212 Data size: 22048 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        Statistics: Num rows: 212 Data size: 22048 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: string)
            Execution mode: vectorized
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: ((cs_item_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; and cs_promo_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) and cs_catalog_page_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 286549727 Data size: 37743959324 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((cs_item_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; and cs_promo_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) and cs_catalog_page_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 285112475 Data size: 7974560516 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_catalog_page_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), cs_item_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), cs_promo_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), cs_order_number (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), cs_ext_sales_price (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), cs_net_profit (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), cs_sold_date_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 285112475 Data size: 7974560516 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Left Outer Join0 to 1
                        keys:
                          0 _col1 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col3 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                          1 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col9, _col10
                        input vertices:
                          1 Map 14
                        Statistics: Num rows: 3412616 Data size: 109203712 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col6 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                            1 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                          outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col9, _col10
                          input vertices:
                            1 Map 15
                          Statistics: Num rows: 3815661 Data size: 106838508 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                              1 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                            outputColumnNames: _col0, _col2, _col4, _col5, _col9, _col10
                            input vertices:
                              1 Map 16
                            Statistics: Num rows: 1271887 Data size: 30525288 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col2 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                                1 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                              outputColumnNames: _col0, _col4, _col5, _col9, _col10
                              input vertices:
                                1 Map 17
                              Statistics: Num rows: 635944 Data size: 12718880 Basic stats: COMPLETE Column stats: COMPLETE
                              Map Join Operator
                                condition map:
                                     Inner Join 0 to 1
                                keys:
                                  0 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                                  1 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                                outputColumnNames: _col4, _col5, _col9, _col10, _col18
                                input vertices:
                                  1 Map 18
                                Statistics: Num rows: 635944 Data size: 73769504 Basic stats: COMPLETE Column stats: COMPLETE
                                Select Operator
                                  expressions: _col18 (type: string), _col4 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), COALESCE(_col9,0) (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), (_col5 - COALESCE(_col10,0)) (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;)
                                  outputColumnNames: _col0, _col1, _col2, _col3
                                  Statistics: Num rows: 635944 Data size: 73769504 Basic stats: COMPLETE Column stats: COMPLETE
                                  Group By Operator
                                    aggregations: sum(_col1), sum(_col2), sum(_col3)
                                    keys: _col0 (type: string)
                                    mode: hash
                                    outputColumnNames: _col0, _col1, _col2, _col3
                                    Statistics: Num rows: 10590 Data size: 1313160 Basic stats: COMPLETE Column stats: COMPLETE
                                    Reduce Output Operator
                                      key expressions: _col0 (type: string)
                                      sort order: +
                                      Map-reduce partition columns: _col0 (type: string)
                                      Statistics: Num rows: 10590 Data size: 1313160 Basic stats: COMPLETE Column stats: COMPLETE
                                      value expressions: _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col2 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col3 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
            Execution mode: vectorized
        Map 14 
            Map Operator Tree:
                TableScan
                  alias: catalog_returns
                  filterExpr: cr_item_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 28798881 Data size: 2942039156 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cr_item_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 28798881 Data size: 456171072 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cr_item_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), cr_order_number (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), cr_return_amount (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), cr_net_loss (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 28798881 Data size: 456171072 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        Statistics: Num rows: 28798881 Data size: 456171072 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), _col3 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;)
            Execution mode: vectorized
        Map 15 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_date BETWEEN 1998-08-04 AND 1998-09-04 and d_date_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_date BETWEEN 1998-08-04 AND 1998-09-04 and d_date_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 36524 Data size: 3579352 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                      outputColumnNames: _col0
                      Statistics: Num rows: 36524 Data size: 146096 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        Statistics: Num rows: 36524 Data size: 146096 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        outputColumnNames: _col0
                        Statistics: Num rows: 36524 Data size: 146096 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 18262 Data size: 73048 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 18262 Data size: 73048 Basic stats: COMPLETE Column stats: COMPLETE
                            Target column: cs_sold_date_sk
                            Target Vertex: Map 12
            Execution mode: vectorized
        Map 16 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: ((i_current_price &amp;gt; 50.0) and i_item_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 48000 Data size: 68732712 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((i_current_price &amp;gt; 50.0) and i_item_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 16000 Data size: 127832 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                      outputColumnNames: _col0
                      Statistics: Num rows: 16000 Data size: 64000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        Statistics: Num rows: 16000 Data size: 64000 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized
        Map 17 
            Map Operator Tree:
                TableScan
                  alias: promotion
                  filterExpr: ((p_channel_tv = &lt;span class=&quot;code-quote&quot;&gt;&apos;N&apos;&lt;/span&gt;) and p_promo_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 450 Data size: 530848 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((p_channel_tv = &lt;span class=&quot;code-quote&quot;&gt;&apos;N&apos;&lt;/span&gt;) and p_promo_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 225 Data size: 20025 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: p_promo_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                      outputColumnNames: _col0
                      Statistics: Num rows: 225 Data size: 900 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        Statistics: Num rows: 225 Data size: 900 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized
        Map 18 
            Map Operator Tree:
                TableScan
                  alias: catalog_page
                  filterExpr: cp_catalog_page_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 11718 Data size: 5400282 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cp_catalog_page_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 11718 Data size: 1218672 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cp_catalog_page_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), cp_catalog_page_id (type: string)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 11718 Data size: 1218672 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        Statistics: Num rows: 11718 Data size: 1218672 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: string)
            Execution mode: vectorized
        Map 19 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ((ws_item_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; and ws_promo_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) and ws_web_site_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 143966864 Data size: 19001610332 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((ws_item_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; and ws_promo_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) and ws_web_site_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 143930635 Data size: 4029840544 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_item_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), ws_web_site_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), ws_promo_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), ws_order_number (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), ws_ext_sales_price (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), ws_net_profit (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), ws_sold_date_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 143930635 Data size: 4029840544 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Left Outer Join0 to 1
                        keys:
                          0 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col3 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                          1 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col9, _col10
                        input vertices:
                          1 Map 21
                        Statistics: Num rows: 2406359 Data size: 77003488 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col6 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                            1 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                          outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col9, _col10
                          input vertices:
                            1 Map 22
                          Statistics: Num rows: 2690560 Data size: 75335680 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                              1 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                            outputColumnNames: _col1, _col2, _col4, _col5, _col9, _col10
                            input vertices:
                              1 Map 23
                            Statistics: Num rows: 896854 Data size: 21524496 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col2 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                                1 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                              outputColumnNames: _col1, _col4, _col5, _col9, _col10
                              input vertices:
                                1 Map 24
                              Statistics: Num rows: 448427 Data size: 8968540 Basic stats: COMPLETE Column stats: COMPLETE
                              Map Join Operator
                                condition map:
                                     Inner Join 0 to 1
                                keys:
                                  0 _col1 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                                  1 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                                outputColumnNames: _col4, _col5, _col9, _col10, _col18
                                input vertices:
                                  1 Map 25
                                Statistics: Num rows: 448427 Data size: 52017532 Basic stats: COMPLETE Column stats: COMPLETE
                                Select Operator
                                  expressions: _col18 (type: string), _col4 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), COALESCE(_col9,0) (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), (_col5 - COALESCE(_col10,0)) (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;)
                                  outputColumnNames: _col0, _col1, _col2, _col3
                                  Statistics: Num rows: 448427 Data size: 52017532 Basic stats: COMPLETE Column stats: COMPLETE
                                  Group By Operator
                                    aggregations: sum(_col1), sum(_col2), sum(_col3)
                                    keys: _col0 (type: string)
                                    mode: hash
                                    outputColumnNames: _col0, _col1, _col2, _col3
                                    Statistics: Num rows: 17 Data size: 2108 Basic stats: COMPLETE Column stats: COMPLETE
                                    Reduce Output Operator
                                      key expressions: _col0 (type: string)
                                      sort order: +
                                      Map-reduce partition columns: _col0 (type: string)
                                      Statistics: Num rows: 17 Data size: 2108 Basic stats: COMPLETE Column stats: COMPLETE
                                      value expressions: _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col2 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col3 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
            Execution mode: vectorized
        Map 21 
            Map Operator Tree:
                TableScan
                  alias: web_returns
                  filterExpr: wr_item_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 13749816 Data size: 1237758344 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: wr_item_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 13749816 Data size: 217404672 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: wr_item_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), wr_order_number (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), wr_return_amt (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), wr_net_loss (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 13749816 Data size: 217404672 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        Statistics: Num rows: 13749816 Data size: 217404672 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), _col3 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;)
            Execution mode: vectorized
        Map 22 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_date BETWEEN 1998-08-04 AND 1998-09-04 and d_date_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_date BETWEEN 1998-08-04 AND 1998-09-04 and d_date_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 36524 Data size: 3579352 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                      outputColumnNames: _col0
                      Statistics: Num rows: 36524 Data size: 146096 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        Statistics: Num rows: 36524 Data size: 146096 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        outputColumnNames: _col0
                        Statistics: Num rows: 36524 Data size: 146096 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 18262 Data size: 73048 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 18262 Data size: 73048 Basic stats: COMPLETE Column stats: COMPLETE
                            Target column: ws_sold_date_sk
                            Target Vertex: Map 19
            Execution mode: vectorized
        Map 23 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: ((i_current_price &amp;gt; 50.0) and i_item_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 48000 Data size: 68732712 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((i_current_price &amp;gt; 50.0) and i_item_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 16000 Data size: 127832 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                      outputColumnNames: _col0
                      Statistics: Num rows: 16000 Data size: 64000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        Statistics: Num rows: 16000 Data size: 64000 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized
        Map 24 
            Map Operator Tree:
                TableScan
                  alias: promotion
                  filterExpr: ((p_channel_tv = &lt;span class=&quot;code-quote&quot;&gt;&apos;N&apos;&lt;/span&gt;) and p_promo_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 450 Data size: 530848 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((p_channel_tv = &lt;span class=&quot;code-quote&quot;&gt;&apos;N&apos;&lt;/span&gt;) and p_promo_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 225 Data size: 20025 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: p_promo_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                      outputColumnNames: _col0
                      Statistics: Num rows: 225 Data size: 900 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        Statistics: Num rows: 225 Data size: 900 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized
        Map 25 
            Map Operator Tree:
                TableScan
                  alias: web_site
                  filterExpr: web_site_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 38 Data size: 70614 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: web_site_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 38 Data size: 3952 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: web_site_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), web_site_id (type: string)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 38 Data size: 3952 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        Statistics: Num rows: 38 Data size: 3952 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: string)
            Execution mode: vectorized
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  filterExpr: sr_item_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 55578005 Data size: 4155315616 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: sr_item_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 55578005 Data size: 881176504 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: sr_item_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), sr_ticket_number (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), sr_return_amt (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), sr_net_loss (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 55578005 Data size: 881176504 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        Statistics: Num rows: 55578005 Data size: 881176504 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), _col3 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;)
            Execution mode: vectorized
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_date BETWEEN 1998-08-04 AND 1998-09-04 and d_date_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_date BETWEEN 1998-08-04 AND 1998-09-04 and d_date_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 36524 Data size: 3579352 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                      outputColumnNames: _col0
                      Statistics: Num rows: 36524 Data size: 146096 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        Statistics: Num rows: 36524 Data size: 146096 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        outputColumnNames: _col0
                        Statistics: Num rows: 36524 Data size: 146096 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 18262 Data size: 73048 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 18262 Data size: 73048 Basic stats: COMPLETE Column stats: COMPLETE
                            Target column: ss_sold_date_sk
                            Target Vertex: Map 1
            Execution mode: vectorized
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: ((i_current_price &amp;gt; 50.0) and i_item_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                  Statistics: Num rows: 48000 Data size: 68732712 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((i_current_price &amp;gt; 50.0) and i_item_sk is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)
                    Statistics: Num rows: 16000 Data size: 127832 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                      outputColumnNames: _col0
                      Statistics: Num rows: 16000 Data size: 64000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        Statistics: Num rows: 16000 Data size: 64000 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized
        Reducer 13 
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Select Operator
                  expressions: &lt;span class=&quot;code-quote&quot;&gt;&apos;catalog channel&apos;&lt;/span&gt; (type: string), concat(&lt;span class=&quot;code-quote&quot;&gt;&apos;catalog_page&apos;&lt;/span&gt;, _col0) (type: string), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col2 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col3 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Group By Operator
                    aggregations: sum(_col2), sum(_col3), sum(_col4)
                    keys: _col0 (type: string), _col1 (type: string), &lt;span class=&quot;code-quote&quot;&gt;&apos;0&apos;&lt;/span&gt; (type: string)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Reduce Output Operator
                      key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
                      sort order: +++
                      Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
                      value expressions: _col3 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col4 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col5 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
        Reducer 2 
            Reduce Operator Tree:
              Merge Join Operator
                condition map:
                     Left Outer Join0 to 1
                keys:
                  0 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col3 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                  1 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col9, _col10
                Statistics: Num rows: 7811006 Data size: 249952192 Basic stats: COMPLETE Column stats: COMPLETE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col6 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                    1 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                  outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col9, _col10
                  input vertices:
                    1 Map 8
                  Statistics: Num rows: 8733520 Data size: 244538560 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                      1 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                    outputColumnNames: _col1, _col2, _col4, _col5, _col9, _col10
                    input vertices:
                      1 Map 9
                    Statistics: Num rows: 2911174 Data size: 69868176 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        1 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                      outputColumnNames: _col1, _col4, _col5, _col9, _col10
                      input vertices:
                        1 Map 10
                      Statistics: Num rows: 1455587 Data size: 29111740 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                          1 _col0 (type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
                        outputColumnNames: _col4, _col5, _col9, _col10, _col18
                        input vertices:
                          1 Map 11
                        Statistics: Num rows: 1455587 Data size: 168848092 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col18 (type: string), _col4 (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), COALESCE(_col9,0) (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;), (_col5 - COALESCE(_col10,0)) (type: &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;)
                          outputColumnNames: _col0, _col1, _col2, _col3
                          Statistics: Num rows: 1455587 Data size: 168848092 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col1), sum(_col2), sum(_col3)
                            keys: _col0 (type: string)
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3
                            Statistics: Num rows: 234 Data size: 29016 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: string)
                              sort order: +
                              Map-reduce partition columns: _col0 (type: string)
                              Statistics: Num rows: 234 Data size: 29016 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col2 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col3 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
        Reducer 20 
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Select Operator
                  expressions: &lt;span class=&quot;code-quote&quot;&gt;&apos;web channel&apos;&lt;/span&gt; (type: string), concat(&lt;span class=&quot;code-quote&quot;&gt;&apos;web_site&apos;&lt;/span&gt;, _col0) (type: string), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col2 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col3 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Group By Operator
                    aggregations: sum(_col2), sum(_col3), sum(_col4)
                    keys: _col0 (type: string), _col1 (type: string), &lt;span class=&quot;code-quote&quot;&gt;&apos;0&apos;&lt;/span&gt; (type: string)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Reduce Output Operator
                      key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
                      sort order: +++
                      Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
                      value expressions: _col3 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col4 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col5 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
        Reducer 3 
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Select Operator
                  expressions: &lt;span class=&quot;code-quote&quot;&gt;&apos;store channel&apos;&lt;/span&gt; (type: string), concat(&lt;span class=&quot;code-quote&quot;&gt;&apos;store&apos;&lt;/span&gt;, _col0) (type: string), _col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col2 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col3 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Group By Operator
                    aggregations: sum(_col2), sum(_col3), sum(_col4)
                    keys: _col0 (type: string), _col1 (type: string), &lt;span class=&quot;code-quote&quot;&gt;&apos;0&apos;&lt;/span&gt; (type: string)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Reduce Output Operator
                      key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
                      sort order: +++
                      Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
                      value expressions: _col3 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col4 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col5 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
        Reducer 5 
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col3, _col4, _col5
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                pruneGroupingSetId: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: string), _col3 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col4 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col5 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: string)
                    sort order: ++
                    Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col2 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col3 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), _col4 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
            Execution mode: vectorized
        Reducer 6 
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), VALUE._col1 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;), VALUE._col2 (type: &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  &lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; of rows: 100
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
                    Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.TextInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
            Execution mode: vectorized
        Union 4 
            Vertex: Union 4

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12819081">HIVE-10244</key>
            <summary>Vectorization : TPC-DS Q80 fails with java.lang.ClassCastException when hive.vectorized.execution.reduce.enabled is enabled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mmccline">Matt McCline</assignee>
                                    <reporter username="mmokhtar">Mostafa Mokhtar</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Apr 2015 21:25:05 +0000</created>
                <updated>Tue, 27 Feb 2024 22:23:51 +0000</updated>
                            <resolved>Thu, 28 May 2015 23:19:50 +0000</resolved>
                                    <version>0.14.0</version>
                                    <fixVersion>1.2.1</fixVersion>
                                    <component>Vectorization</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14537525" author="mmccline" created="Mon, 11 May 2015 03:47:10 +0000"  >
&lt;p&gt;This information is from TPC-DS 67, but I think it is probably the same problem:&lt;/p&gt;

&lt;p&gt;The exception occurs in (vectorized) Reducer 3 fed from Map 2.&lt;/p&gt;

&lt;p&gt;The type shown in the Explain plan for Map 2 shows _col8 as type string.&lt;br/&gt;
And, Reducer 3 shows _col8 as type string.  Yet, we seem to create the Vectorized Row Batch in the Tez Reduce code as Decimal?&lt;/p&gt;

&lt;p&gt;The COALESCE in the last column of Select Operator expressions shows type decimal(18,2).&lt;br/&gt;
Yet, the following Group By operator shows the last column with a funny name &quot;0&quot; and type string.&lt;br/&gt;
Something is not right here.&lt;/p&gt;

&lt;p&gt;Partial explain output from the end of Map 2:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;                              Select Operator
                                expressions: _col3 (type: string), _col2 (type: string), _col1 (type: string), _col4 (type: string), _col12 (type: int), _col14 (type: int), _col13 (type: int), _col16 (type: string), COALESCE((_col8 * CAST( _col7 AS decimal(10,0))),0) (type: decimal(18,2))
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                                Statistics: Num rows: 915185 Data size: 1236889305 Basic stats: COMPLETE Column stats: NONE
                                Group By Operator
                                  aggregations: sum(_col8)
                                  keys: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), &apos;0&apos; (type: string)
                                  mode: hash
                                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                                  Statistics: Num rows: 8236665 Data size: 11132003745 Basic stats: COMPLETE Column stats: NONE
                                  Reduce Output Operator
                                    key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), _col8 (type: string)
                                    sort order: +++++++++
                                    Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), _col8 (type: string)
                                    Statistics: Num rows: 8236665 Data size: 11132003745 Basic stats: COMPLETE Column stats: NONE
                                    value expressions: _col9 (type: decimal(28,2))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Full explain output:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      Edges:
        Map 2 &amp;lt;- Map 1 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Reducer 3 &amp;lt;- Map 2 (SIMPLE_EDGE)
        Reducer 4 &amp;lt;- Reducer 3 (SIMPLE_EDGE)
        Reducer 5 &amp;lt;- Reducer 4 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 18000 Data size: 29671008 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: i_item_sk is not null (type: boolean)
                    Statistics: Num rows: 9000 Data size: 14835504 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: i_item_sk (type: int), i_brand (type: string), i_class (type: string), i_category (type: string), i_product_name (type: string)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 9000 Data size: 14835504 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: int)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: int)
                        Statistics: Num rows: 9000 Data size: 14835504 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  Statistics: Num rows: 2750370 Data size: 3717170032 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (ss_sold_date_sk is not null and ss_item_sk is not null) (type: boolean)
                    Statistics: Num rows: 687593 Data size: 929293183 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_quantity (type: int), ss_sales_price (type: decimal(7,2)), ss_store_sk (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 687593 Data size: 929293183 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: int)
                          1 _col0 (type: int)
                        outputColumnNames: _col1, _col2, _col3, _col4, _col7, _col8, _col9
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 756352 Data size: 1022222523 Basic stats: COMPLETE Column stats: NONE
                        HybridGraceHashJoin: true
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col4 (type: int)
                            1 _col0 (type: int)
                          outputColumnNames: _col1, _col2, _col3, _col7, _col8, _col9, _col11
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 831987 Data size: 1124444799 Basic stats: COMPLETE Column stats: NONE
                          HybridGraceHashJoin: true
                          Select Operator
                            expressions: _col1 (type: int), _col11 (type: string), _col2 (type: int), _col3 (type: decimal(7,2)), _col7 (type: int), _col8 (type: int), _col9 (type: int)
                            outputColumnNames: _col1, _col11, _col2, _col3, _col7, _col8, _col9
                            Statistics: Num rows: 831987 Data size: 1124444799 Basic stats: COMPLETE Column stats: NONE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col0 (type: int)
                                1 _col1 (type: int)
                              outputColumnNames: _col1, _col2, _col3, _col4, _col7, _col8, _col12, _col13, _col14, _col16
                              input vertices:
                                0 Map 1
                              Statistics: Num rows: 915185 Data size: 1236889305 Basic stats: COMPLETE Column stats: NONE
                              HybridGraceHashJoin: true
                              Select Operator
                                expressions: _col3 (type: string), _col2 (type: string), _col1 (type: string), _col4 (type: string), _col12 (type: int), _col14 (type: int), _col13 (type: int), _col16 (type: string), COALESCE((_col8 * CAST( _col7 AS decimal(10,0))),0) (type: decimal(18,2))
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                                Statistics: Num rows: 915185 Data size: 1236889305 Basic stats: COMPLETE Column stats: NONE
                                Group By Operator
                                  aggregations: sum(_col8)
                                  keys: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), &apos;0&apos; (type: string)
                                  mode: hash
                                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                                  Statistics: Num rows: 8236665 Data size: 11132003745 Basic stats: COMPLETE Column stats: NONE
                                  Reduce Output Operator
                                    key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), _col8 (type: string)
                                    sort order: +++++++++
                                    Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), _col8 (type: string)
                                    Statistics: Num rows: 8236665 Data size: 11132003745 Basic stats: COMPLETE Column stats: NONE
                                    value expressions: _col9 (type: decimal(28,2))
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (d_month_seq BETWEEN 1176 AND 1187 and d_date_sk is not null) (type: boolean)
                    Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: d_date_sk (type: int), d_year (type: int), d_moy (type: int), d_qoy (type: int)
                      outputColumnNames: _col0, _col2, _col3, _col4
                      Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: int)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: int)
                        Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col2 (type: int), _col3 (type: int), _col4 (type: int)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: store
                  Statistics: Num rows: 12 Data size: 25632 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: s_store_sk is not null (type: boolean)
                    Statistics: Num rows: 6 Data size: 12816 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: s_store_sk (type: int), s_store_id (type: string)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 6 Data size: 12816 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: int)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: int)
                        Statistics: Num rows: 6 Data size: 12816 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col1 (type: string)
                      Select Operator
                        expressions: _col0 (type: int)
                        outputColumnNames: _col0
                        Statistics: Num rows: 6 Data size: 12816 Basic stats: COMPLETE Column stats: NONE
                        Group By Operator
                          keys: _col0 (type: int)
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 6 Data size: 12816 Basic stats: COMPLETE Column stats: NONE
                          Dynamic Partitioning Event Operator
                            Target Input: store_sales
                            Partition key expr: ss_store_sk
                            Statistics: Num rows: 6 Data size: 12816 Basic stats: COMPLETE Column stats: NONE
                            Target column: ss_store_sk
                            Target Vertex: Map 2
        Reducer 3 
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: int), KEY._col5 (type: int), KEY._col6 (type: int), KEY._col7 (type: string), KEY._col8 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col9
                Statistics: Num rows: 4118332 Data size: 5566001196 Basic stats: COMPLETE Column stats: NONE
                pruneGroupingSetId: true
                Reduce Output Operator
                  key expressions: _col0 (type: string), _col9 (type: decimal(28,2))
                  sort order: +-
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 4118332 Data size: 5566001196 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), _col9 (type: decimal(28,2))
        Reducer 4 
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), VALUE._col3 (type: int), VALUE._col4 (type: int), VALUE._col5 (type: int), VALUE._col6 (type: string), VALUE._col8 (type: decimal(28,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col9
                Statistics: Num rows: 4118332 Data size: 5566001196 Basic stats: COMPLETE Column stats: NONE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: string, _col3: string, _col4: int, _col5: int, _col6: int, _col7: string, _col9: decimal(28,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col9(DESC)
                        partition by: _col0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_0
                              arguments: _col9
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 4118332 Data size: 5566001196 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (rank_window_0 &amp;lt;= 100) (type: boolean)
                    Statistics: Num rows: 1372777 Data size: 1855333281 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), _col9 (type: decimal(28,2)), rank_window_0 (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                      Statistics: Num rows: 1372777 Data size: 1855333281 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), _col8 (type: decimal(28,2)), _col9 (type: int)
                        sort order: ++++++++++
                        Statistics: Num rows: 1372777 Data size: 1855333281 Basic stats: COMPLETE Column stats: NONE
        Reducer 5 
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), KEY.reducesinkkey4 (type: int), KEY.reducesinkkey5 (type: int), KEY.reducesinkkey6 (type: int), KEY.reducesinkkey7 (type: string), KEY.reducesinkkey8 (type: decimal(28,2)), KEY.reducesinkkey9 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                Statistics: Num rows: 1372777 Data size: 1855333281 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 135100 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 135100 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.TextInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14537537" author="mmokhtar" created="Mon, 11 May 2015 04:03:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jpullokkaran&quot; class=&quot;user-hover&quot; rel=&quot;jpullokkaran&quot;&gt;jpullokkaran&lt;/a&gt;&lt;br/&gt;
Can you please take a look?&lt;/p&gt;</comment>
                            <comment id="14538297" author="jpullokkaran" created="Mon, 11 May 2015 18:00:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jcamachorodriguez&quot; class=&quot;user-hover&quot; rel=&quot;jcamachorodriguez&quot;&gt;jcamachorodriguez&lt;/a&gt; Could you take a look?&lt;br/&gt;
May be we screwed the types going in/out.&lt;/p&gt;</comment>
                            <comment id="14541724" author="jcamacho" created="Wed, 13 May 2015 11:02:36 +0000"  >&lt;p&gt;I cannot reproduce this one in my environment with &lt;tt&gt;hive.vectorized.execution.enabled&lt;/tt&gt; and &lt;tt&gt;hive.vectorized.execution.reduce.enabled&lt;/tt&gt;, is it still an issue?&lt;/p&gt;</comment>
                            <comment id="14546223" author="mmccline" created="Fri, 15 May 2015 21:47:01 +0000"  >&lt;p&gt;I struggled with the environment variables necessary for a repro.&lt;/p&gt;

&lt;p&gt;The default for is hive.vectorized.execution.mapjoin.native.enabled is true, but for the repro it needs to be set to false.&lt;/p&gt;

&lt;p&gt;(Here is the whole list of variables I used in my Q &lt;a href=&quot;file:&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:&lt;/a&gt;)&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;SET hive.vectorized.execution.enabled=true;
set hive.mapjoin.hybridgrace.hashtable=true;
SET hive.vectorized.execution.mapjoin.native.enabled=false;
set hive.cbo.enable=true;
set hive.fetch.task.conversion=none;
SET hive.auto.convert.join=true;
SET hive.auto.convert.join.noconditionaltask=true;
SET hive.auto.convert.join.noconditionaltask.size=100000000;
set hive.exec.dynamic.partition.mode=nonstrict;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14551376" author="jcamacho" created="Tue, 19 May 2015 22:36:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mmccline&quot; class=&quot;user-hover&quot; rel=&quot;mmccline&quot;&gt;mmccline&lt;/a&gt;, the problem is not in CBO; in fact, with CBO disabled, the problem appears too. There seems to be a problem in the vectorization code when grouping sets are used (wrong indices? not taking into account grouping__id?). The following simplified query can be used to reproduce the error:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; select s_store_id
 from store
 group by s_store_id with rollup;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;while this query does not show the error &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; select s_store_id, GROUPING__ID
 from store
 group by s_store_id with rollup;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;What do you think?&lt;/p&gt;</comment>
                            <comment id="14555386" author="mmccline" created="Fri, 22 May 2015 00:49:51 +0000"  >&lt;p&gt;I think this is directly related to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-9347&quot; title=&quot;Bug with max() together with rank() and grouping sets&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-9347&quot;&gt;&lt;del&gt;HIVE-9347&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14555389" author="mmccline" created="Fri, 22 May 2015 00:51:30 +0000"  >&lt;p&gt;For 1.2.1, I would prefer to not vectorize if there is GroupByDesc.pruneGroupingSetId is true....&lt;/p&gt;</comment>
                            <comment id="14556342" author="hiveqa" created="Fri, 22 May 2015 15:43:27 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12734715/HIVE-10244.01.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12734715/HIVE-10244.01.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 8969 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestEncryptedHDFSCliDriver.testCliDriver_encryption_insert_partition_static
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4002/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4002/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4002/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4002/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4002/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4002/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12734715 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14556572" author="mmccline" created="Fri, 22 May 2015 18:31:48 +0000"  >&lt;p&gt;Test failure is unrelated to changes (has build age 6).&lt;/p&gt;</comment>
                            <comment id="14559797" author="jpullokkaran" created="Tue, 26 May 2015 20:23:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mmccline&quot; class=&quot;user-hover&quot; rel=&quot;mmccline&quot;&gt;mmccline&lt;/a&gt; How can you end up grouping id without grouping sets?&lt;br/&gt;
Language prevents referring to grouping id without grouping sets.&lt;/p&gt;

&lt;p&gt;If grouping sets are present then previous line should bail out right?&lt;/p&gt;

&lt;p&gt;if (desc.isGroupingSetsPresent()) &lt;/p&gt;
{
      LOG.info(&quot;Grouping sets not supported in vector mode&quot;);
      return false;
    }</comment>
                            <comment id="14559918" author="mmccline" created="Tue, 26 May 2015 21:35:22 +0000"  >&lt;p&gt;Ya, I know, that is what I thought.  But the new prune flag seems to be on in the Reducer even though isGroupingSetsPresent is false.  We should talk to the author and reviewer of the change.&lt;/p&gt;

&lt;p&gt;Jedi Master &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt;, can you explain to us Padawan Learners &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jpullokkaran&quot; class=&quot;user-hover&quot; rel=&quot;jpullokkaran&quot;&gt;jpullokkaran&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mmccline&quot; class=&quot;user-hover&quot; rel=&quot;mmccline&quot;&gt;mmccline&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jcamachorodriguez&quot; class=&quot;user-hover&quot; rel=&quot;jcamachorodriguez&quot;&gt;jcamachorodriguez&lt;/a&gt; all about the prune flag?&lt;/p&gt;</comment>
                            <comment id="14563741" author="jpullokkaran" created="Thu, 28 May 2015 21:45:40 +0000"  >&lt;p&gt;Ok i looked further.&lt;br/&gt;
Logical GB gets translated to different GB-RS-GB pipelines based on config (skew, no of grip sets..).&lt;br/&gt;
GrpID Col is always added only for the last operator; rest of the physical GB will not include it.&lt;/p&gt;

&lt;p&gt;So on an individual GB its legal to have groupingset set to false &amp;amp; prunegroupingid set to true.&lt;br/&gt;
Ex: MapSide GB + SkewInData where grouping__id is not in the projection list.&lt;/p&gt;</comment>
                            <comment id="14563743" author="jpullokkaran" created="Thu, 28 May 2015 21:47:46 +0000"  >&lt;p&gt;Example Query:&lt;br/&gt;
set hive.groupby.skewindata=true;&lt;br/&gt;
select key from t1 group by key,value grouping sets((key), (value));&lt;/p&gt;</comment>
                            <comment id="14563744" author="jpullokkaran" created="Thu, 28 May 2015 21:47:50 +0000"  >&lt;p&gt;Example Query:&lt;br/&gt;
set hive.groupby.skewindata=true;&lt;br/&gt;
select key from t1 group by key,value grouping sets((key), (value));&lt;/p&gt;</comment>
                            <comment id="14563745" author="jpullokkaran" created="Thu, 28 May 2015 21:47:56 +0000"  >&lt;p&gt;Example Query:&lt;br/&gt;
set hive.groupby.skewindata=true;&lt;br/&gt;
select key from t1 group by key,value grouping sets((key), (value));&lt;/p&gt;</comment>
                            <comment id="14563746" author="jpullokkaran" created="Thu, 28 May 2015 21:48:05 +0000"  >&lt;p&gt;Example Query:&lt;br/&gt;
set hive.groupby.skewindata=true;&lt;br/&gt;
select key from t1 group by key,value grouping sets((key), (value));&lt;/p&gt;</comment>
                            <comment id="14563747" author="jpullokkaran" created="Thu, 28 May 2015 21:48:10 +0000"  >&lt;p&gt;Example Query:&lt;br/&gt;
set hive.groupby.skewindata=true;&lt;br/&gt;
select key from t1 group by key,value grouping sets((key), (value));&lt;/p&gt;</comment>
                            <comment id="14563752" author="jpullokkaran" created="Thu, 28 May 2015 21:49:25 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14563756" author="mmccline" created="Thu, 28 May 2015 21:54:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jpullokkaran&quot; class=&quot;user-hover&quot; rel=&quot;jpullokkaran&quot;&gt;jpullokkaran&lt;/a&gt; thank you for digging into the GroupBy logical/physical pipeline and figuring it out!  And, your review +1.  And, and thank you and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;ashutoshc&lt;/a&gt; for discussing it.&lt;/p&gt;</comment>
                            <comment id="14563873" author="hagleitn" created="Thu, 28 May 2015 23:20:34 +0000"  >&lt;p&gt;Committed to master and branch-1.2.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12821392">HIVE-10356</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12734715" name="HIVE-10244.01.patch" size="27044" author="mmccline" created="Fri, 22 May 2015 01:35:49 +0000"/>
                            <attachment id="12723756" name="explain_q80_vectorized_reduce_on.txt" size="2197833" author="mmokhtar" created="Tue, 7 Apr 2015 22:21:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 25 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cxnj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>