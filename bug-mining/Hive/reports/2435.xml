<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:22:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-7658] Hive search order for hive-site.xml when using --config option</title>
                <link>https://issues.apache.org/jira/browse/HIVE-7658</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;When using the hive cli, the tool appears to favour a hive-site.xml file in the current working directory even if the --config option is used with a valid directory containing a hive-site.xml file.&lt;/p&gt;

&lt;p&gt;I would have expected the directory specified with --config to take precedence in the CLASSPATH search order.&lt;/p&gt;

&lt;p&gt;Here&apos;s an example -&lt;/p&gt;



&lt;p&gt;/home/spurija/hive-site.xml =&lt;/p&gt;

&lt;p&gt;&amp;lt;configuration&amp;gt;&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;hive.exec.local.scratchdir&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;/tmp/example1&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;/configuration&amp;gt;&lt;/p&gt;



&lt;p&gt;/tmp/hive/hive-site.xml =&lt;/p&gt;

&lt;p&gt;&amp;lt;configuration&amp;gt;&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;hive.exec.local.scratchdir&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;/tmp/example2&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;/configuration&amp;gt;&lt;/p&gt;



&lt;p&gt;-bash-4.1$ diff /home/spurija/hive-site.xml /tmp/hive/hive-site.xml&lt;br/&gt;
23c23&lt;br/&gt;
&amp;lt;     &amp;lt;value&amp;gt;/tmp/example1&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;#8212;&lt;br/&gt;
&amp;gt;     &amp;lt;value&amp;gt;/tmp/example2&amp;lt;/value&amp;gt;&lt;/p&gt;




{ check the value of scratchdir, should be example 1 }
&lt;p&gt;-bash-4.1$ pwd&lt;br/&gt;
/home/spurija&lt;br/&gt;
-bash-4.1$ hive&lt;/p&gt;

&lt;p&gt;Logging initialized using configuration in jar:&lt;a href=&quot;file:/opt/mapr/hive/hive-0.13/lib/hive-common-0.13.0-mapr-1405.jar!/hive-log4j.properties&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/opt/mapr/hive/hive-0.13/lib/hive-common-0.13.0-mapr-1405.jar!/hive-log4j.properties&lt;/a&gt;&lt;br/&gt;
hive&amp;gt; set hive.exec.local.scratchdir;&lt;br/&gt;
hive.exec.local.scratchdir=/tmp/example1&lt;/p&gt;




{ run with a specified config, check the value of scratchdir, should be example2 &#8230; still reported as example1 }

&lt;p&gt;-bash-4.1$ pwd&lt;br/&gt;
/home/spurija&lt;br/&gt;
-bash-4.1$ hive --config /tmp/hive&lt;/p&gt;

&lt;p&gt;Logging initialized using configuration in jar:&lt;a href=&quot;file:/opt/mapr/hive/hive-0.13/lib/hive-common-0.13.0-mapr-1405.jar!/hive-log4j.properties&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/opt/mapr/hive/hive-0.13/lib/hive-common-0.13.0-mapr-1405.jar!/hive-log4j.properties&lt;/a&gt;&lt;br/&gt;
hive&amp;gt; set hive.exec.local.scratchdir;&lt;br/&gt;
hive.exec.local.scratchdir=/tmp/example1&lt;/p&gt;




{ remove the local config, check the value of scratchdir, should be example2 &#8230; now correct }

&lt;p&gt;-bash-4.1$ pwd&lt;br/&gt;
/home/spurija&lt;br/&gt;
-bash-4.1$ rm hive-site.xml&lt;br/&gt;
-bash-4.1$ hive --config /tmp/hive&lt;/p&gt;

&lt;p&gt;Logging initialized using configuration in jar:&lt;a href=&quot;file:/opt/mapr/hive/hive-0.13/lib/hive-common-0.13.0-mapr-1405.jar!/hive-log4j.properties&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/opt/mapr/hive/hive-0.13/lib/hive-common-0.13.0-mapr-1405.jar!/hive-log4j.properties&lt;/a&gt;&lt;br/&gt;
hive&amp;gt; set hive.exec.local.scratchdir;&lt;br/&gt;
hive.exec.local.scratchdir=/tmp/example2&lt;/p&gt;


&lt;p&gt;Is this expected behavior or should it use the directory supplied with --config as the preferred configuration?&lt;/p&gt;</description>
                <environment>&lt;p&gt;Red Hat Enterprise Linux Server release 5.9 (Tikanga)&lt;/p&gt;

&lt;p&gt;Hive 0.13.0-mapr-1406&lt;br/&gt;
Subversion git://rhbuild/root/builds/opensource/node/ecosystem/dl/hive -r 4ff8f8b4a8fc4862727108204399710ef7ee7abc&lt;br/&gt;
Compiled by root on Tue Jul 1 14:18:09 PDT 2014&lt;br/&gt;
From source with checksum 208afc25260342b51aefd2e0edf4c9d6&lt;/p&gt;</environment>
        <key id="12732783">HIVE-7658</key>
            <summary>Hive search order for hive-site.xml when using --config option</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vkorukanti">Venki Korukanti</assignee>
                                    <reporter username="james.spurin">James Spurin</reporter>
                        <labels>
                    </labels>
                <created>Fri, 8 Aug 2014 08:26:42 +0000</created>
                <updated>Thu, 13 Nov 2014 19:41:38 +0000</updated>
                            <resolved>Wed, 13 Aug 2014 05:57:31 +0000</resolved>
                                    <version>0.13.0</version>
                                    <fixVersion>0.14.0</fixVersion>
                                    <component>CLI</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14093032" author="vkorukanti" created="Mon, 11 Aug 2014 17:38:30 +0000"  >&lt;p&gt;Hive uses ClassLoader.getResource(&quot;hive-site.xml&quot;) for finding the path to hive-site.xml file. ClassLoader is retrieved using Thread.currentThread().getContextClassLoader() which returns a chain of class loaders. One of the ClassLoaders in the chain is sun.misc.Launcher$AppClassLoader. This particular ClassLoader treats the empty entry in ClassPath (example: /path/to/jar1.jar::/path/to/jar2) as current working directory of the process (see &lt;a href=&quot;https://community.oracle.com/thread/2456122?start=0&amp;amp;tstart=0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;). If you look at the classpath of the Hive process, there is one such empty entry after the hadoop jars and before hive conf dir and hive jars. As the empty entry is before hive conf directory, ClassLoader picks up the first occurrence of hive-site.xml in current working directory.&lt;/p&gt;

&lt;p&gt;Looking at the Hive scripts, adding empty path is an issue in hive scripts it self. Following line in &lt;tt&gt;bin/hive&lt;/tt&gt; script causes an extra &quot;:&quot; before the hive constructed classpath when HADOOP_CLASSPATH is empty. &quot;hadoop&quot; scripts adds another &quot;:&quot; to its classpath and appends given hive classpath.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;export HADOOP_CLASSPATH=&lt;span class=&quot;code-quote&quot;&gt;&quot;${HADOOP_CLASSPATH}:${CLASSPATH}&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14093036" author="vkorukanti" created="Mon, 11 Aug 2014 17:40:41 +0000"  >&lt;p&gt;Attached patch resolves the issue by checking whether HADOOP_CLASSPATH is non-empty before using it.&lt;/p&gt;</comment>
                            <comment id="14093575" author="hiveqa" created="Tue, 12 Aug 2014 00:49:09 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12661021/HIVE-7658.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12661021/HIVE-7658.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 3 failed/errored test(s), 5874 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_udaf_histogram_numeric
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_dynpart_sort_opt_vectorization
org.apache.hive.hcatalog.pig.TestOrcHCatLoader.testReadDataPrimitiveTypes
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/258/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/258/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/258/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/258/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-258/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-258/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12661021&lt;/p&gt;</comment>
                            <comment id="14093636" author="navis" created="Tue, 12 Aug 2014 01:44:03 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14095187" author="navis" created="Wed, 13 Aug 2014 05:57:31 +0000"  >&lt;p&gt;Committed to trunk. Thanks for the contribution, Venki!&lt;/p&gt;</comment>
                            <comment id="14210601" author="thejas" created="Thu, 13 Nov 2014 19:41:38 +0000"  >&lt;p&gt;This has been fixed in 0.14 release. Please open new jira if you see any issues.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12661021" name="HIVE-7658.1.patch" size="469" author="vkorukanti" created="Mon, 11 Aug 2014 17:40:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>410811</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1yofz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>410804</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>