<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 18:30:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HIVE-9588] Reimplement HCatClientHMSImpl.dropPartitions() with HMSC.dropPartitions()</title>
                <link>https://issues.apache.org/jira/browse/HIVE-9588</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;&lt;tt&gt;HCatClientHMSImpl.dropPartitions()&lt;/tt&gt; currently has an embarrassingly inefficient implementation. The partial partition-spec is converted into a filter-string. The partitions are fetched from the server, and then dropped one by one.&lt;/p&gt;

&lt;p&gt;Here&apos;s a reimplementation that uses the &lt;tt&gt;ExprNode&lt;/tt&gt;-based &lt;tt&gt;HiveMetaStoreClient.dropPartitions()&lt;/tt&gt;. It cuts out the excessive back-and-forth between the HMS and the client-side. It also reduces the memory footprint (from loading all the partitions that are to be dropped). &lt;/p&gt;</description>
                <environment></environment>
        <key id="12772606">HIVE-9588</key>
            <summary>Reimplement HCatClientHMSImpl.dropPartitions() with HMSC.dropPartitions()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mithun">Mithun Radhakrishnan</assignee>
                                    <reporter username="mithun">Mithun Radhakrishnan</reporter>
                        <labels>
                            <label>TODOC1.2</label>
                    </labels>
                <created>Thu, 5 Feb 2015 06:39:39 +0000</created>
                <updated>Mon, 18 May 2015 19:52:34 +0000</updated>
                            <resolved>Mon, 9 Mar 2015 06:02:28 +0000</resolved>
                                    <version>0.14.0</version>
                                    <fixVersion>1.2.0</fixVersion>
                                    <component>HCatalog</component>
                    <component>Metastore</component>
                    <component>Thrift API</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14306752" author="mithun" created="Thu, 5 Feb 2015 06:48:22 +0000"  >&lt;p&gt;To help things along, I&apos;ve added an overload to &lt;tt&gt;HMSC.dropPartitions()&lt;/tt&gt; that allows us to skip returning the partition-list.&lt;/p&gt;</comment>
                            <comment id="14308452" author="hiveqa" created="Fri, 6 Feb 2015 02:02:10 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 no tests executed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12696683/HIVE-9588.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12696683/HIVE-9588.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2676/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2676/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2676/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2676/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-2676/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-2676/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Tests exited with: ExecutionException: java.util.concurrent.ExecutionException: org.apache.hive.ptest.execution.ssh.SSHExecutionException: RSyncResult [localFile=/data/hive-ptest/logs/PreCommit-HIVE-TRUNK-Build-2676/succeeded/TestParseNegative, remoteFile=/home/hiveptest/54.162.181.222-hiveptest-0/logs/, getExitCode()=12, getException()=null, getUser()=hiveptest, getHost()=54.162.181.222, getInstance()=0]: &apos;Address 54.162.181.222 maps to ec2-54-162-181-222.compute-1.amazonaws.com, but this does not map back to the address - POSSIBLE BREAK-IN ATTEMPT!
receiving incremental file list
./
TEST-TestParseNegative-TEST-org.apache.hadoop.hive.ql.parse.TestParseNegative.xml
           0   0%    0.00kB/s    0:00:00
        8387 100%    4.00MB/s    0:00:00 (xfer#1, to-check=3/5)
hive.log
           0   0%    0.00kB/s    0:00:00
    45350912  37%   43.16MB/s    0:00:01
    90996736  74%   43.35MB/s    0:00:00
rsync: write failed on &quot;/data/hive-ptest/logs/PreCommit-HIVE-TRUNK-Build-2676/succeeded/TestParseNegative/hive.log&quot;: No space left on device (28)
rsync error: error in file IO (code 11) at receiver.c(301) [receiver=3.0.6]
rsync: connection unexpectedly closed (204 bytes received so far) [generator]
rsync error: error in rsync protocol data stream (code 12) at io.c(600) [generator=3.0.6]
Address 54.162.181.222 maps to ec2-54-162-181-222.compute-1.amazonaws.com, but this does not map back to the address - POSSIBLE BREAK-IN ATTEMPT!
receiving incremental file list
hive.log
           0   0%    0.00kB/s    0:00:00
rsync: write failed on &quot;/data/hive-ptest/logs/PreCommit-HIVE-TRUNK-Build-2676/succeeded/TestParseNegative/hive.log&quot;: No space left on device (28)
rsync error: error in file IO (code 11) at receiver.c(301) [receiver=3.0.6]
rsync: connection unexpectedly closed (204 bytes received so far) [generator]
rsync error: error in rsync protocol data stream (code 12) at io.c(600) [generator=3.0.6]
Address 54.162.181.222 maps to ec2-54-162-181-222.compute-1.amazonaws.com, but this does not map back to the address - POSSIBLE BREAK-IN ATTEMPT!
receiving incremental file list
./
hive.log
           0   0%    0.00kB/s    0:00:00
rsync: write failed on &quot;/data/hive-ptest/logs/PreCommit-HIVE-TRUNK-Build-2676/succeeded/TestParseNegative/hive.log&quot;: No space left on device (28)
rsync error: error in file IO (code 11) at receiver.c(301) [receiver=3.0.6]
rsync: connection unexpectedly closed (204 bytes received so far) [generator]
rsync error: error in rsync protocol data stream (code 12) at io.c(600) [generator=3.0.6]
Address 54.162.181.222 maps to ec2-54-162-181-222.compute-1.amazonaws.com, but this does not map back to the address - POSSIBLE BREAK-IN ATTEMPT!
receiving incremental file list
./
hive.log
           0   0%    0.00kB/s    0:00:00
rsync: write failed on &quot;/data/hive-ptest/logs/PreCommit-HIVE-TRUNK-Build-2676/succeeded/TestParseNegative/hive.log&quot;: No space left on device (28)
rsync error: error in file IO (code 11) at receiver.c(301) [receiver=3.0.6]
rsync: connection unexpectedly closed (204 bytes received so far) [generator]
rsync error: error in rsync protocol data stream (code 12) at io.c(600) [generator=3.0.6]
Address 54.162.181.222 maps to ec2-54-162-181-222.compute-1.amazonaws.com, but this does not map back to the address - POSSIBLE BREAK-IN ATTEMPT!
receiving incremental file list
./
hive.log
           0   0%    0.00kB/s    0:00:00
rsync: write failed on &quot;/data/hive-ptest/logs/PreCommit-HIVE-TRUNK-Build-2676/succeeded/TestParseNegative/hive.log&quot;: No space left on device (28)
rsync error: error in file IO (code 11) at receiver.c(301) [receiver=3.0.6]
rsync: connection unexpectedly closed (204 bytes received so far) [generator]
rsync error: error in rsync protocol data stream (code 12) at io.c(600) [generator=3.0.6]
&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12696683 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14313223" author="mithun" created="Tue, 10 Feb 2015 00:12:23 +0000"  >&lt;p&gt;Refactored. Moved the new &lt;tt&gt;HiveMetaStoreClient.dropPartitions()&lt;/tt&gt; to a separate JIRA.&lt;/p&gt;</comment>
                            <comment id="14313261" author="mithun" created="Tue, 10 Feb 2015 00:35:08 +0000"  >&lt;p&gt;A minor update:&lt;/p&gt;

&lt;p&gt;1. Dropping 2K partitions using HCatClient.dropPartitions() used to take 204 seconds for a managed table on my test setup (with an Oracle backend, and remote metastore). This now takes 83 seconds.&lt;br/&gt;
2. Dropping 5K partitions used to take about 7 minutes. It now takes 4.&lt;/p&gt;</comment>
                            <comment id="14313282" author="mithun" created="Tue, 10 Feb 2015 00:49:10 +0000"  >&lt;p&gt;Another minor update: &lt;/p&gt;

&lt;p&gt;The numbers quoted above are slashed in half for EXTERNAL tables. Half the problem is the iterative deletion of partition directories.&lt;br/&gt;
1. In the short term, perhaps we could add an HCatClient.dropPartitions() overload that takes a deleteData argument, just as HiveMetaStoreClient.drop_partitions_req() does. This way, the caller can choose whether to delete the underlying data. (Should be beneficial for data-loading programs like GDM/Falcon.)&lt;br/&gt;
2. In the long term, we should consider classifying the directories so that we drop the common parent, rather than each partition-dir individually.&lt;/p&gt;</comment>
                            <comment id="14317000" author="mithun" created="Wed, 11 Feb 2015 21:19:14 +0000"  >&lt;p&gt;Hey, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sushanth&quot; class=&quot;user-hover&quot; rel=&quot;sushanth&quot;&gt;sushanth&lt;/a&gt;. Thanks for the initial review. I&apos;ve moved the chicken-switch constant into HiveConf, as you&apos;d suggested. Here&apos;s the updated patch.&lt;/p&gt;</comment>
                            <comment id="14349351" author="mithun" created="Thu, 5 Mar 2015 19:40:00 +0000"  >&lt;p&gt;Testing with rebase.&lt;/p&gt;</comment>
                            <comment id="14349539" author="hiveqa" created="Thu, 5 Mar 2015 22:33:01 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12698248/HIVE-9588.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12698248/HIVE-9588.3.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 7599 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_udaf_context_ngrams
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2961/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2961/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2961/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2961/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-2961/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-2961/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12698248 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="14351359" author="thejas" created="Sat, 7 Mar 2015 03:17:57 +0000"  >&lt;p&gt;+1 . &lt;br/&gt;
Mithun can you also add a comment explaining kind of expression  ExpressionBuilder generates (ie, expression with &quot;and&quot;  of all partitionspecs) .&lt;/p&gt;</comment>
                            <comment id="14352536" author="mithun" created="Mon, 9 Mar 2015 04:28:01 +0000"  >&lt;p&gt;Hey, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;thejas&lt;/a&gt;. Thanks for reviewing. I&apos;ve added the comment you suggested.&lt;/p&gt;</comment>
                            <comment id="14352590" author="thejas" created="Mon, 9 Mar 2015 06:02:28 +0000"  >&lt;p&gt;Patch committed to trunk.&lt;br/&gt;
Thanks for the patch &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mithun&quot; class=&quot;user-hover&quot; rel=&quot;mithun&quot;&gt;mithun&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="14352634" author="lefty@hortonworks.com" created="Mon, 9 Mar 2015 07:30:06 +0000"  >&lt;p&gt;Doc note:  This adds &lt;b&gt;hive.metastore.client.drop.partitions.using.expressions&lt;/b&gt; to HiveConf.java, so it needs to be documented for 1.2.0 in the Metastore section of Configuration Properties.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-MetaStore&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Configuration Properties &amp;#8211; Metastore &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14548858" author="sushanth" created="Mon, 18 May 2015 19:52:34 +0000"  >&lt;p&gt;This issue has been fixed and released as part of the 1.2.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12773615">HIVE-9628</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12773630">HIVE-9629</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12773687">HIVE-9633</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12696683" name="HIVE-9588.1.patch" size="11386" author="mithun" created="Thu, 5 Feb 2015 06:48:22 +0000"/>
                            <attachment id="12697607" name="HIVE-9588.2.patch" size="9569" author="mithun" created="Tue, 10 Feb 2015 00:12:23 +0000"/>
                            <attachment id="12698248" name="HIVE-9588.3.patch" size="10453" author="mithun" created="Thu, 12 Feb 2015 00:14:24 +0000"/>
                            <attachment id="12703357" name="HIVE-9588.4.patch" size="10857" author="mithun" created="Mon, 9 Mar 2015 04:28:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 27 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i25807:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>