diff --git a/CHANGES.txt b/CHANGES.txt
index e39986a7b0..2f0cc03901 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -761,6 +761,9 @@ Trunk -  Unreleased
     HIVE-1951 input16_cc.q is failing in testminimrclidriver
     (He Yongqiang via namit)
 
+    HIVE-1964 Add fully deterministic ORDER BY in test union22.q and input40.q
+    (John Sichi via namit)
+
   TESTS
 
     HIVE-1464. improve  test query performance
diff --git a/ql/src/test/queries/clientpositive/input40.q b/ql/src/test/queries/clientpositive/input40.q
index 2b64294028..4166cb5f94 100644
--- a/ql/src/test/queries/clientpositive/input40.q
+++ b/ql/src/test/queries/clientpositive/input40.q
@@ -9,12 +9,8 @@ create table tmp_insert_test_p (key string, value string) partitioned by (ds str
 
 load data local inpath '../data/files/kv1.txt' into table tmp_insert_test_p partition (ds = '2009-08-01');
 select * from tmp_insert_test_p where ds= '2009-08-01'
-order by key;
+order by key, value;
 
 load data local inpath '../data/files/kv2.txt' into table tmp_insert_test_p partition (ds = '2009-08-01');
 select * from tmp_insert_test_p where ds= '2009-08-01'
-order by key;
-
-
-
-
+order by key, value;
diff --git a/ql/src/test/queries/clientpositive/union22.q b/ql/src/test/queries/clientpositive/union22.q
index 46eb62d1d4..c3dcd9e652 100644
--- a/ql/src/test/queries/clientpositive/union22.q
+++ b/ql/src/test/queries/clientpositive/union22.q
@@ -38,7 +38,4 @@ where a.k1 > 20
 subq;
 
 
-select * from dst_union22 where ds = '2' order by k1;
-
-
-
+select * from dst_union22 where ds = '2' order by k1, k2, k3, k4;
diff --git a/ql/src/test/results/clientpositive/input40.q.out b/ql/src/test/results/clientpositive/input40.q.out
index aa06e83087..a5ae25a1c4 100644
--- a/ql/src/test/results/clientpositive/input40.q.out
+++ b/ql/src/test/results/clientpositive/input40.q.out
@@ -11,11 +11,11 @@ POSTHOOK: Output: default@tmp_insert_test
 PREHOOK: query: select * from tmp_insert_test
 PREHOOK: type: QUERY
 PREHOOK: Input: default@tmp_insert_test
-PREHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-25-57_203_5560167211316870946/-mr-10000
+PREHOOK: Output: file:/var/folders/7P/7PeC14kXFIWq0PIYyexGbmKuXUk/-Tmp-/jsichi/hive_2011-02-07_11-25-14_517_5753890205884969614/-mr-10000
 POSTHOOK: query: select * from tmp_insert_test
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@tmp_insert_test
-POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-25-57_203_5560167211316870946/-mr-10000
+POSTHOOK: Output: file:/var/folders/7P/7PeC14kXFIWq0PIYyexGbmKuXUk/-Tmp-/jsichi/hive_2011-02-07_11-25-14_517_5753890205884969614/-mr-10000
 238	val_238
 86	val_86
 311	val_311
@@ -527,15 +527,15 @@ POSTHOOK: query: load data local inpath '../data/files/kv1.txt' into table tmp_i
 POSTHOOK: type: LOAD
 POSTHOOK: Output: default@tmp_insert_test_p@ds=2009-08-01
 PREHOOK: query: select * from tmp_insert_test_p where ds= '2009-08-01'
-order by key
+order by key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@tmp_insert_test_p@ds=2009-08-01
-PREHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-25-58_152_6691784345192473342/-mr-10000
+PREHOOK: Output: file:/var/folders/7P/7PeC14kXFIWq0PIYyexGbmKuXUk/-Tmp-/jsichi/hive_2011-02-07_11-25-15_556_2431335421960788297/-mr-10000
 POSTHOOK: query: select * from tmp_insert_test_p where ds= '2009-08-01'
-order by key
+order by key, value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@tmp_insert_test_p@ds=2009-08-01
-POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-25-58_152_6691784345192473342/-mr-10000
+POSTHOOK: Output: file:/var/folders/7P/7PeC14kXFIWq0PIYyexGbmKuXUk/-Tmp-/jsichi/hive_2011-02-07_11-25-15_556_2431335421960788297/-mr-10000
 0	val_0	2009-08-01
 0	val_0	2009-08-01
 0	val_0	2009-08-01
@@ -1042,39 +1042,39 @@ POSTHOOK: query: load data local inpath '../data/files/kv2.txt' into table tmp_i
 POSTHOOK: type: LOAD
 POSTHOOK: Output: default@tmp_insert_test_p@ds=2009-08-01
 PREHOOK: query: select * from tmp_insert_test_p where ds= '2009-08-01'
-order by key
+order by key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@tmp_insert_test_p@ds=2009-08-01
-PREHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_199947475392615760/-mr-10000
+PREHOOK: Output: file:/var/folders/7P/7PeC14kXFIWq0PIYyexGbmKuXUk/-Tmp-/jsichi/hive_2011-02-07_11-25-23_616_7998548461186695899/-mr-10000
 POSTHOOK: query: select * from tmp_insert_test_p where ds= '2009-08-01'
-order by key
+order by key, value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@tmp_insert_test_p@ds=2009-08-01
-POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_199947475392615760/-mr-10000
+POSTHOOK: Output: file:/var/folders/7P/7PeC14kXFIWq0PIYyexGbmKuXUk/-Tmp-/jsichi/hive_2011-02-07_11-25-23_616_7998548461186695899/-mr-10000
 0	val_0	2009-08-01
 0	val_0	2009-08-01
-0	val_1	2009-08-01
 0	val_0	2009-08-01
 0	val_1	2009-08-01
+0	val_1	2009-08-01
 1	val_2	2009-08-01
 10	val_10	2009-08-01
 10	val_11	2009-08-01
-100	val_101	2009-08-01
-100	val_101	2009-08-01
 100	val_100	2009-08-01
 100	val_100	2009-08-01
+100	val_101	2009-08-01
+100	val_101	2009-08-01
 101	val_102	2009-08-01
 102	val_103	2009-08-01
 103	val_103	2009-08-01
 103	val_103	2009-08-01
-104	val_105	2009-08-01
 104	val_104	2009-08-01
-104	val_105	2009-08-01
 104	val_104	2009-08-01
 104	val_105	2009-08-01
-105	val_106	2009-08-01
+104	val_105	2009-08-01
+104	val_105	2009-08-01
 105	val_105	2009-08-01
 105	val_106	2009-08-01
+105	val_106	2009-08-01
 106	val_107	2009-08-01
 11	val_11	2009-08-01
 11	val_12	2009-08-01
@@ -1084,12 +1084,12 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 111	val_111	2009-08-01
 113	val_113	2009-08-01
 113	val_113	2009-08-01
+114	val_114	2009-08-01
 114	val_115	2009-08-01
 114	val_115	2009-08-01
 114	val_115	2009-08-01
-114	val_114	2009-08-01
-116	val_117	2009-08-01
 116	val_116	2009-08-01
+116	val_117	2009-08-01
 117	val_118	2009-08-01
 117	val_118	2009-08-01
 118	val_118	2009-08-01
@@ -1097,12 +1097,12 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 118	val_119	2009-08-01
 118	val_119	2009-08-01
 118	val_119	2009-08-01
-119	val_120	2009-08-01
-119	val_120	2009-08-01
 119	val_119	2009-08-01
-119	val_120	2009-08-01
 119	val_119	2009-08-01
 119	val_119	2009-08-01
+119	val_120	2009-08-01
+119	val_120	2009-08-01
+119	val_120	2009-08-01
 12	val_12	2009-08-01
 12	val_12	2009-08-01
 12	val_13	2009-08-01
@@ -1117,42 +1117,42 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 123	val_124	2009-08-01
 123	val_124	2009-08-01
 125	val_125	2009-08-01
-125	val_126	2009-08-01
 125	val_125	2009-08-01
+125	val_126	2009-08-01
+126	val_126	2009-08-01
 126	val_127	2009-08-01
 126	val_127	2009-08-01
-126	val_126	2009-08-01
 128	val_128	2009-08-01
 128	val_128	2009-08-01
 128	val_128	2009-08-01
 128	val_129	2009-08-01
 128	val_129	2009-08-01
 129	val_129	2009-08-01
-129	val_130	2009-08-01
 129	val_129	2009-08-01
 129	val_130	2009-08-01
+129	val_130	2009-08-01
 131	val_131	2009-08-01
 132	val_133	2009-08-01
 132	val_133	2009-08-01
 133	val_133	2009-08-01
 133	val_134	2009-08-01
 134	val_134	2009-08-01
-134	val_135	2009-08-01
 134	val_134	2009-08-01
+134	val_135	2009-08-01
 135	val_136	2009-08-01
 135	val_136	2009-08-01
 135	val_136	2009-08-01
-136	val_137	2009-08-01
 136	val_136	2009-08-01
+136	val_137	2009-08-01
 137	val_137	2009-08-01
 137	val_137	2009-08-01
 137	val_138	2009-08-01
 138	val_138	2009-08-01
-138	val_139	2009-08-01
-138	val_139	2009-08-01
 138	val_138	2009-08-01
 138	val_138	2009-08-01
 138	val_138	2009-08-01
+138	val_139	2009-08-01
+138	val_139	2009-08-01
 140	val_141	2009-08-01
 143	val_143	2009-08-01
 143	val_144	2009-08-01
@@ -1163,30 +1163,30 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 147	val_148	2009-08-01
 147	val_148	2009-08-01
 149	val_149	2009-08-01
-149	val_150	2009-08-01
 149	val_149	2009-08-01
+149	val_150	2009-08-01
+15	val_15	2009-08-01
 15	val_15	2009-08-01
 15	val_16	2009-08-01
 15	val_16	2009-08-01
-15	val_15	2009-08-01
 150	val_150	2009-08-01
 151	val_152	2009-08-01
 151	val_152	2009-08-01
+152	val_152	2009-08-01
+152	val_152	2009-08-01
 152	val_153	2009-08-01
 152	val_153	2009-08-01
-152	val_152	2009-08-01
 152	val_153	2009-08-01
-152	val_152	2009-08-01
-153	val_154	2009-08-01
 153	val_153	2009-08-01
 153	val_154	2009-08-01
+153	val_154	2009-08-01
 155	val_155	2009-08-01
-156	val_157	2009-08-01
 156	val_156	2009-08-01
 156	val_157	2009-08-01
-157	val_158	2009-08-01
+156	val_157	2009-08-01
 157	val_157	2009-08-01
 157	val_158	2009-08-01
+157	val_158	2009-08-01
 158	val_158	2009-08-01
 16	val_17	2009-08-01
 16	val_17	2009-08-01
@@ -1199,38 +1199,38 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 162	val_162	2009-08-01
 162	val_163	2009-08-01
 163	val_163	2009-08-01
-164	val_165	2009-08-01
-164	val_165	2009-08-01
 164	val_164	2009-08-01
 164	val_164	2009-08-01
+164	val_165	2009-08-01
+164	val_165	2009-08-01
 165	val_165	2009-08-01
 165	val_165	2009-08-01
 165	val_166	2009-08-01
 166	val_166	2009-08-01
 167	val_167	2009-08-01
 167	val_167	2009-08-01
-167	val_168	2009-08-01
 167	val_167	2009-08-01
-168	val_169	2009-08-01
+167	val_168	2009-08-01
 168	val_168	2009-08-01
+168	val_169	2009-08-01
 169	val_169	2009-08-01
 169	val_169	2009-08-01
 169	val_169	2009-08-01
 169	val_169	2009-08-01
 17	val_17	2009-08-01
-170	val_171	2009-08-01
 170	val_170	2009-08-01
-172	val_173	2009-08-01
+170	val_171	2009-08-01
 172	val_172	2009-08-01
 172	val_172	2009-08-01
-174	val_175	2009-08-01
-174	val_175	2009-08-01
+172	val_173	2009-08-01
 174	val_174	2009-08-01
 174	val_174	2009-08-01
+174	val_175	2009-08-01
+174	val_175	2009-08-01
+175	val_175	2009-08-01
 175	val_175	2009-08-01
 175	val_176	2009-08-01
 175	val_176	2009-08-01
-175	val_175	2009-08-01
 176	val_176	2009-08-01
 176	val_176	2009-08-01
 177	val_177	2009-08-01
@@ -1239,42 +1239,42 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 178	val_178	2009-08-01
 178	val_179	2009-08-01
 178	val_179	2009-08-01
-179	val_180	2009-08-01
 179	val_179	2009-08-01
 179	val_179	2009-08-01
+179	val_180	2009-08-01
 18	val_18	2009-08-01
 18	val_18	2009-08-01
 180	val_180	2009-08-01
 181	val_181	2009-08-01
 182	val_183	2009-08-01
-183	val_184	2009-08-01
 183	val_183	2009-08-01
+183	val_184	2009-08-01
 184	val_185	2009-08-01
 185	val_186	2009-08-01
 186	val_186	2009-08-01
 187	val_187	2009-08-01
 187	val_187	2009-08-01
 187	val_187	2009-08-01
-189	val_190	2009-08-01
 189	val_189	2009-08-01
-19	val_20	2009-08-01
+189	val_190	2009-08-01
 19	val_19	2009-08-01
+19	val_20	2009-08-01
 190	val_190	2009-08-01
-191	val_192	2009-08-01
 191	val_191	2009-08-01
 191	val_191	2009-08-01
-192	val_193	2009-08-01
+191	val_192	2009-08-01
 192	val_192	2009-08-01
+192	val_193	2009-08-01
 193	val_193	2009-08-01
 193	val_193	2009-08-01
 193	val_193	2009-08-01
 194	val_194	2009-08-01
 195	val_195	2009-08-01
 195	val_195	2009-08-01
-196	val_197	2009-08-01
 196	val_196	2009-08-01
 196	val_197	2009-08-01
 196	val_197	2009-08-01
+196	val_197	2009-08-01
 197	val_197	2009-08-01
 197	val_197	2009-08-01
 197	val_198	2009-08-01
@@ -1282,11 +1282,11 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 199	val_199	2009-08-01
 199	val_199	2009-08-01
 199	val_200	2009-08-01
-2	val_3	2009-08-01
 2	val_2	2009-08-01
+2	val_3	2009-08-01
+20	val_20	2009-08-01
 20	val_21	2009-08-01
 20	val_21	2009-08-01
-20	val_20	2009-08-01
 200	val_200	2009-08-01
 200	val_200	2009-08-01
 201	val_201	2009-08-01
@@ -1306,9 +1306,9 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 208	val_208	2009-08-01
 208	val_208	2009-08-01
 209	val_209	2009-08-01
-209	val_210	2009-08-01
 209	val_209	2009-08-01
 209	val_210	2009-08-01
+209	val_210	2009-08-01
 21	val_22	2009-08-01
 21	val_22	2009-08-01
 21	val_22	2009-08-01
@@ -1319,13 +1319,13 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 213	val_214	2009-08-01
 214	val_214	2009-08-01
 215	val_216	2009-08-01
-216	val_217	2009-08-01
 216	val_216	2009-08-01
 216	val_216	2009-08-01
-217	val_218	2009-08-01
+216	val_217	2009-08-01
 217	val_217	2009-08-01
 217	val_217	2009-08-01
 217	val_218	2009-08-01
+217	val_218	2009-08-01
 218	val_218	2009-08-01
 219	val_219	2009-08-01
 219	val_219	2009-08-01
@@ -1336,17 +1336,17 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 222	val_223	2009-08-01
 223	val_223	2009-08-01
 223	val_223	2009-08-01
-224	val_225	2009-08-01
 224	val_224	2009-08-01
 224	val_224	2009-08-01
-226	val_227	2009-08-01
+224	val_225	2009-08-01
 226	val_226	2009-08-01
 226	val_227	2009-08-01
 226	val_227	2009-08-01
 226	val_227	2009-08-01
+226	val_227	2009-08-01
 227	val_228	2009-08-01
-228	val_229	2009-08-01
 228	val_228	2009-08-01
+228	val_229	2009-08-01
 229	val_229	2009-08-01
 229	val_229	2009-08-01
 23	val_24	2009-08-01
@@ -1358,74 +1358,74 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 231	val_232	2009-08-01
 233	val_233	2009-08-01
 233	val_233	2009-08-01
-235	val_236	2009-08-01
 235	val_235	2009-08-01
+235	val_236	2009-08-01
 237	val_237	2009-08-01
 237	val_237	2009-08-01
 238	val_238	2009-08-01
-238	val_239	2009-08-01
 238	val_238	2009-08-01
-239	val_240	2009-08-01
+238	val_239	2009-08-01
 239	val_239	2009-08-01
 239	val_239	2009-08-01
 239	val_240	2009-08-01
+239	val_240	2009-08-01
 24	val_24	2009-08-01
 24	val_24	2009-08-01
 240	val_241	2009-08-01
+241	val_241	2009-08-01
 241	val_242	2009-08-01
 241	val_242	2009-08-01
 241	val_242	2009-08-01
-241	val_241	2009-08-01
 241	val_242	2009-08-01
 242	val_242	2009-08-01
 242	val_242	2009-08-01
 242	val_243	2009-08-01
 243	val_244	2009-08-01
 243	val_244	2009-08-01
-244	val_245	2009-08-01
 244	val_244	2009-08-01
 244	val_245	2009-08-01
 244	val_245	2009-08-01
+244	val_245	2009-08-01
 245	val_246	2009-08-01
 245	val_246	2009-08-01
 246	val_247	2009-08-01
 246	val_247	2009-08-01
 247	val_247	2009-08-01
-248	val_249	2009-08-01
 248	val_248	2009-08-01
-249	val_250	2009-08-01
+248	val_249	2009-08-01
 249	val_249	2009-08-01
 249	val_250	2009-08-01
+249	val_250	2009-08-01
 252	val_252	2009-08-01
 252	val_253	2009-08-01
 254	val_255	2009-08-01
 255	val_255	2009-08-01
 255	val_255	2009-08-01
 256	val_256	2009-08-01
-256	val_257	2009-08-01
 256	val_256	2009-08-01
-257	val_258	2009-08-01
+256	val_257	2009-08-01
 257	val_257	2009-08-01
 257	val_258	2009-08-01
-258	val_259	2009-08-01
+257	val_258	2009-08-01
 258	val_258	2009-08-01
+258	val_259	2009-08-01
 259	val_260	2009-08-01
 259	val_260	2009-08-01
 26	val_26	2009-08-01
 26	val_26	2009-08-01
+260	val_260	2009-08-01
 260	val_261	2009-08-01
 260	val_261	2009-08-01
-260	val_260	2009-08-01
 261	val_262	2009-08-01
+262	val_262	2009-08-01
 262	val_263	2009-08-01
 262	val_263	2009-08-01
-262	val_262	2009-08-01
 263	val_263	2009-08-01
 264	val_265	2009-08-01
 264	val_265	2009-08-01
 265	val_265	2009-08-01
-265	val_266	2009-08-01
 265	val_265	2009-08-01
+265	val_266	2009-08-01
 266	val_266	2009-08-01
 267	val_268	2009-08-01
 268	val_269	2009-08-01
@@ -1436,56 +1436,56 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 272	val_273	2009-08-01
 273	val_273	2009-08-01
 273	val_273	2009-08-01
-273	val_274	2009-08-01
 273	val_273	2009-08-01
-274	val_275	2009-08-01
+273	val_274	2009-08-01
 274	val_274	2009-08-01
-275	val_276	2009-08-01
+274	val_275	2009-08-01
 275	val_275	2009-08-01
 275	val_276	2009-08-01
+275	val_276	2009-08-01
 276	val_277	2009-08-01
 277	val_277	2009-08-01
-277	val_278	2009-08-01
 277	val_277	2009-08-01
 277	val_277	2009-08-01
-277	val_278	2009-08-01
 277	val_277	2009-08-01
+277	val_278	2009-08-01
+277	val_278	2009-08-01
 278	val_278	2009-08-01
-278	val_279	2009-08-01
 278	val_278	2009-08-01
+278	val_279	2009-08-01
 28	val_28	2009-08-01
 280	val_280	2009-08-01
 280	val_280	2009-08-01
+281	val_281	2009-08-01
+281	val_281	2009-08-01
 281	val_282	2009-08-01
 281	val_282	2009-08-01
 281	val_282	2009-08-01
-281	val_281	2009-08-01
-281	val_281	2009-08-01
 282	val_282	2009-08-01
 282	val_282	2009-08-01
 283	val_283	2009-08-01
-284	val_285	2009-08-01
 284	val_284	2009-08-01
 284	val_285	2009-08-01
-285	val_286	2009-08-01
+284	val_285	2009-08-01
 285	val_285	2009-08-01
+285	val_286	2009-08-01
 286	val_286	2009-08-01
 286	val_287	2009-08-01
+287	val_287	2009-08-01
 287	val_288	2009-08-01
 287	val_288	2009-08-01
-287	val_287	2009-08-01
 288	val_288	2009-08-01
 288	val_288	2009-08-01
 289	val_289	2009-08-01
 289	val_290	2009-08-01
 29	val_30	2009-08-01
 29	val_30	2009-08-01
+291	val_291	2009-08-01
 291	val_292	2009-08-01
 291	val_292	2009-08-01
-291	val_291	2009-08-01
-292	val_293	2009-08-01
 292	val_292	2009-08-01
 292	val_293	2009-08-01
+292	val_293	2009-08-01
 293	val_294	2009-08-01
 293	val_294	2009-08-01
 295	val_296	2009-08-01
@@ -1500,8 +1500,8 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 30	val_31	2009-08-01
 300	val_301	2009-08-01
 300	val_301	2009-08-01
-302	val_303	2009-08-01
 302	val_302	2009-08-01
+302	val_303	2009-08-01
 303	val_304	2009-08-01
 303	val_304	2009-08-01
 304	val_305	2009-08-01
@@ -1511,17 +1511,17 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 306	val_307	2009-08-01
 307	val_307	2009-08-01
 307	val_307	2009-08-01
+308	val_308	2009-08-01
 308	val_309	2009-08-01
 308	val_309	2009-08-01
-308	val_308	2009-08-01
-309	val_310	2009-08-01
 309	val_309	2009-08-01
 309	val_309	2009-08-01
+309	val_310	2009-08-01
 31	val_32	2009-08-01
+310	val_310	2009-08-01
 310	val_311	2009-08-01
 310	val_311	2009-08-01
 310	val_311	2009-08-01
-310	val_310	2009-08-01
 311	val_311	2009-08-01
 311	val_311	2009-08-01
 311	val_311	2009-08-01
@@ -1531,21 +1531,21 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 316	val_316	2009-08-01
 316	val_316	2009-08-01
 316	val_316	2009-08-01
-317	val_318	2009-08-01
 317	val_317	2009-08-01
 317	val_317	2009-08-01
+317	val_318	2009-08-01
 318	val_318	2009-08-01
-318	val_319	2009-08-01
 318	val_318	2009-08-01
 318	val_318	2009-08-01
+318	val_319	2009-08-01
 32	val_33	2009-08-01
 321	val_321	2009-08-01
 321	val_321	2009-08-01
 322	val_322	2009-08-01
 322	val_322	2009-08-01
 322	val_323	2009-08-01
-323	val_324	2009-08-01
 323	val_323	2009-08-01
+323	val_324	2009-08-01
 324	val_325	2009-08-01
 325	val_325	2009-08-01
 325	val_325	2009-08-01
@@ -1564,83 +1564,83 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 331	val_332	2009-08-01
 332	val_332	2009-08-01
 333	val_333	2009-08-01
-333	val_334	2009-08-01
 333	val_333	2009-08-01
+333	val_334	2009-08-01
 334	val_335	2009-08-01
-335	val_336	2009-08-01
 335	val_335	2009-08-01
 335	val_336	2009-08-01
-336	val_337	2009-08-01
+335	val_336	2009-08-01
 336	val_336	2009-08-01
+336	val_337	2009-08-01
 337	val_338	2009-08-01
 338	val_338	2009-08-01
 338	val_339	2009-08-01
 339	val_339	2009-08-01
 34	val_34	2009-08-01
 340	val_341	2009-08-01
+341	val_341	2009-08-01
 341	val_342	2009-08-01
 341	val_342	2009-08-01
 341	val_342	2009-08-01
-341	val_341	2009-08-01
 342	val_342	2009-08-01
 342	val_342	2009-08-01
 342	val_343	2009-08-01
 343	val_344	2009-08-01
 344	val_344	2009-08-01
-344	val_345	2009-08-01
 344	val_344	2009-08-01
+344	val_345	2009-08-01
 345	val_345	2009-08-01
 347	val_348	2009-08-01
 347	val_348	2009-08-01
 348	val_348	2009-08-01
 348	val_348	2009-08-01
-348	val_349	2009-08-01
 348	val_348	2009-08-01
 348	val_348	2009-08-01
 348	val_348	2009-08-01
+348	val_349	2009-08-01
 349	val_350	2009-08-01
 349	val_350	2009-08-01
 349	val_350	2009-08-01
 349	val_350	2009-08-01
-35	val_36	2009-08-01
 35	val_35	2009-08-01
 35	val_35	2009-08-01
-35	val_36	2009-08-01
 35	val_35	2009-08-01
 35	val_36	2009-08-01
-351	val_352	2009-08-01
+35	val_36	2009-08-01
+35	val_36	2009-08-01
 351	val_351	2009-08-01
 351	val_352	2009-08-01
+351	val_352	2009-08-01
 352	val_353	2009-08-01
 352	val_353	2009-08-01
-353	val_354	2009-08-01
 353	val_353	2009-08-01
 353	val_353	2009-08-01
+353	val_354	2009-08-01
 355	val_356	2009-08-01
 355	val_356	2009-08-01
 356	val_356	2009-08-01
 356	val_357	2009-08-01
 356	val_357	2009-08-01
 358	val_359	2009-08-01
-360	val_361	2009-08-01
 360	val_360	2009-08-01
+360	val_361	2009-08-01
 362	val_362	2009-08-01
 363	val_364	2009-08-01
 363	val_364	2009-08-01
 363	val_364	2009-08-01
-364	val_365	2009-08-01
 364	val_364	2009-08-01
+364	val_365	2009-08-01
 365	val_365	2009-08-01
 366	val_366	2009-08-01
 367	val_367	2009-08-01
+367	val_367	2009-08-01
 367	val_368	2009-08-01
 367	val_368	2009-08-01
-367	val_367	2009-08-01
 368	val_368	2009-08-01
-369	val_370	2009-08-01
 369	val_369	2009-08-01
 369	val_369	2009-08-01
 369	val_369	2009-08-01
+369	val_370	2009-08-01
 37	val_37	2009-08-01
 37	val_37	2009-08-01
 371	val_372	2009-08-01
@@ -1649,36 +1649,36 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 371	val_372	2009-08-01
 373	val_373	2009-08-01
 373	val_374	2009-08-01
-374	val_375	2009-08-01
 374	val_374	2009-08-01
-375	val_376	2009-08-01
+374	val_375	2009-08-01
 375	val_375	2009-08-01
 375	val_376	2009-08-01
 375	val_376	2009-08-01
 375	val_376	2009-08-01
 375	val_376	2009-08-01
+375	val_376	2009-08-01
 376	val_377	2009-08-01
 377	val_377	2009-08-01
-378	val_379	2009-08-01
 378	val_378	2009-08-01
+378	val_379	2009-08-01
 379	val_379	2009-08-01
 379	val_380	2009-08-01
 381	val_382	2009-08-01
-382	val_383	2009-08-01
 382	val_382	2009-08-01
 382	val_382	2009-08-01
 382	val_383	2009-08-01
-384	val_385	2009-08-01
+382	val_383	2009-08-01
 384	val_384	2009-08-01
-384	val_385	2009-08-01
-384	val_385	2009-08-01
 384	val_384	2009-08-01
 384	val_384	2009-08-01
+384	val_385	2009-08-01
+384	val_385	2009-08-01
+384	val_385	2009-08-01
 385	val_386	2009-08-01
 385	val_386	2009-08-01
+386	val_386	2009-08-01
 386	val_387	2009-08-01
 386	val_387	2009-08-01
-386	val_386	2009-08-01
 388	val_389	2009-08-01
 389	val_389	2009-08-01
 389	val_390	2009-08-01
@@ -1706,11 +1706,11 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 397	val_397	2009-08-01
 398	val_399	2009-08-01
 399	val_399	2009-08-01
-399	val_400	2009-08-01
 399	val_399	2009-08-01
 399	val_400	2009-08-01
-4	val_5	2009-08-01
+399	val_400	2009-08-01
 4	val_4	2009-08-01
+4	val_5	2009-08-01
 40	val_41	2009-08-01
 40	val_41	2009-08-01
 400	val_400	2009-08-01
@@ -1727,40 +1727,40 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 403	val_403	2009-08-01
 403	val_403	2009-08-01
 403	val_403	2009-08-01
-404	val_405	2009-08-01
 404	val_404	2009-08-01
 404	val_404	2009-08-01
 404	val_405	2009-08-01
 404	val_405	2009-08-01
+404	val_405	2009-08-01
 405	val_406	2009-08-01
 406	val_406	2009-08-01
-406	val_407	2009-08-01
 406	val_406	2009-08-01
 406	val_406	2009-08-01
 406	val_406	2009-08-01
-407	val_408	2009-08-01
+406	val_407	2009-08-01
 407	val_407	2009-08-01
 407	val_408	2009-08-01
 407	val_408	2009-08-01
+407	val_408	2009-08-01
 408	val_409	2009-08-01
 408	val_409	2009-08-01
 409	val_409	2009-08-01
 409	val_409	2009-08-01
+409	val_409	2009-08-01
 409	val_410	2009-08-01
 409	val_410	2009-08-01
-409	val_409	2009-08-01
 41	val_41	2009-08-01
 410	val_411	2009-08-01
-411	val_412	2009-08-01
 411	val_411	2009-08-01
+411	val_412	2009-08-01
 412	val_413	2009-08-01
 412	val_413	2009-08-01
 413	val_413	2009-08-01
 413	val_413	2009-08-01
 413	val_414	2009-08-01
 414	val_414	2009-08-01
-414	val_415	2009-08-01
 414	val_414	2009-08-01
+414	val_415	2009-08-01
 415	val_416	2009-08-01
 416	val_417	2009-08-01
 417	val_417	2009-08-01
@@ -1768,39 +1768,39 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 417	val_417	2009-08-01
 418	val_418	2009-08-01
 419	val_419	2009-08-01
+42	val_42	2009-08-01
+42	val_42	2009-08-01
 42	val_43	2009-08-01
 42	val_43	2009-08-01
 42	val_43	2009-08-01
-42	val_42	2009-08-01
-42	val_42	2009-08-01
 421	val_421	2009-08-01
 421	val_422	2009-08-01
 421	val_422	2009-08-01
 423	val_424	2009-08-01
 424	val_424	2009-08-01
-424	val_425	2009-08-01
 424	val_424	2009-08-01
+424	val_425	2009-08-01
 425	val_426	2009-08-01
 426	val_427	2009-08-01
-427	val_428	2009-08-01
 427	val_427	2009-08-01
 427	val_428	2009-08-01
+427	val_428	2009-08-01
 428	val_429	2009-08-01
-429	val_430	2009-08-01
-429	val_430	2009-08-01
 429	val_429	2009-08-01
 429	val_429	2009-08-01
+429	val_430	2009-08-01
+429	val_430	2009-08-01
 43	val_43	2009-08-01
-430	val_431	2009-08-01
 430	val_430	2009-08-01
 430	val_430	2009-08-01
 430	val_430	2009-08-01
+430	val_431	2009-08-01
 431	val_431	2009-08-01
-431	val_432	2009-08-01
 431	val_431	2009-08-01
 431	val_431	2009-08-01
-432	val_433	2009-08-01
+431	val_432	2009-08-01
 432	val_432	2009-08-01
+432	val_433	2009-08-01
 435	val_435	2009-08-01
 435	val_436	2009-08-01
 436	val_436	2009-08-01
@@ -1809,29 +1809,29 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 437	val_438	2009-08-01
 438	val_438	2009-08-01
 438	val_438	2009-08-01
+438	val_438	2009-08-01
 438	val_439	2009-08-01
 438	val_439	2009-08-01
-438	val_438	2009-08-01
-439	val_440	2009-08-01
 439	val_439	2009-08-01
 439	val_439	2009-08-01
 439	val_440	2009-08-01
+439	val_440	2009-08-01
 44	val_44	2009-08-01
 440	val_441	2009-08-01
 440	val_441	2009-08-01
 441	val_442	2009-08-01
 442	val_443	2009-08-01
+443	val_443	2009-08-01
 443	val_444	2009-08-01
 443	val_444	2009-08-01
 443	val_444	2009-08-01
-443	val_443	2009-08-01
 444	val_444	2009-08-01
+446	val_446	2009-08-01
 446	val_447	2009-08-01
 446	val_447	2009-08-01
-446	val_446	2009-08-01
 447	val_448	2009-08-01
-448	val_449	2009-08-01
 448	val_448	2009-08-01
+448	val_449	2009-08-01
 449	val_449	2009-08-01
 450	val_451	2009-08-01
 450	val_451	2009-08-01
@@ -1839,17 +1839,17 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 452	val_452	2009-08-01
 453	val_453	2009-08-01
 453	val_454	2009-08-01
-454	val_455	2009-08-01
-454	val_455	2009-08-01
 454	val_454	2009-08-01
 454	val_454	2009-08-01
 454	val_454	2009-08-01
-455	val_456	2009-08-01
+454	val_455	2009-08-01
+454	val_455	2009-08-01
 455	val_455	2009-08-01
 455	val_456	2009-08-01
-457	val_458	2009-08-01
+455	val_456	2009-08-01
 457	val_457	2009-08-01
 457	val_458	2009-08-01
+457	val_458	2009-08-01
 458	val_458	2009-08-01
 458	val_458	2009-08-01
 459	val_459	2009-08-01
@@ -1862,28 +1862,28 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 462	val_462	2009-08-01
 462	val_463	2009-08-01
 463	val_463	2009-08-01
-463	val_464	2009-08-01
 463	val_463	2009-08-01
+463	val_464	2009-08-01
 466	val_466	2009-08-01
 466	val_466	2009-08-01
 466	val_466	2009-08-01
 467	val_467	2009-08-01
 467	val_468	2009-08-01
-468	val_469	2009-08-01
 468	val_468	2009-08-01
-468	val_469	2009-08-01
-468	val_469	2009-08-01
 468	val_468	2009-08-01
 468	val_468	2009-08-01
 468	val_468	2009-08-01
+468	val_469	2009-08-01
+468	val_469	2009-08-01
+468	val_469	2009-08-01
 469	val_469	2009-08-01
 469	val_469	2009-08-01
 469	val_469	2009-08-01
-469	val_470	2009-08-01
 469	val_469	2009-08-01
 469	val_469	2009-08-01
-47	val_48	2009-08-01
+469	val_470	2009-08-01
 47	val_47	2009-08-01
+47	val_48	2009-08-01
 470	val_470	2009-08-01
 470	val_471	2009-08-01
 472	val_472	2009-08-01
@@ -1903,11 +1903,11 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 479	val_479	2009-08-01
 48	val_49	2009-08-01
 48	val_49	2009-08-01
-480	val_481	2009-08-01
-480	val_481	2009-08-01
 480	val_480	2009-08-01
 480	val_480	2009-08-01
 480	val_480	2009-08-01
+480	val_481	2009-08-01
+480	val_481	2009-08-01
 481	val_481	2009-08-01
 481	val_482	2009-08-01
 482	val_482	2009-08-01
@@ -1915,29 +1915,29 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 483	val_483	2009-08-01
 484	val_484	2009-08-01
 484	val_485	2009-08-01
+485	val_485	2009-08-01
 485	val_486	2009-08-01
 485	val_486	2009-08-01
-485	val_485	2009-08-01
 486	val_487	2009-08-01
-487	val_488	2009-08-01
 487	val_487	2009-08-01
+487	val_488	2009-08-01
 488	val_489	2009-08-01
-489	val_490	2009-08-01
 489	val_489	2009-08-01
 489	val_489	2009-08-01
 489	val_489	2009-08-01
 489	val_489	2009-08-01
+489	val_490	2009-08-01
 49	val_50	2009-08-01
 49	val_50	2009-08-01
 490	val_490	2009-08-01
 490	val_491	2009-08-01
-491	val_492	2009-08-01
 491	val_491	2009-08-01
 491	val_492	2009-08-01
-492	val_493	2009-08-01
+491	val_492	2009-08-01
 492	val_492	2009-08-01
-492	val_493	2009-08-01
 492	val_492	2009-08-01
+492	val_493	2009-08-01
+492	val_493	2009-08-01
 493	val_493	2009-08-01
 494	val_494	2009-08-01
 494	val_495	2009-08-01
@@ -1946,9 +1946,9 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 495	val_496	2009-08-01
 496	val_496	2009-08-01
 496	val_497	2009-08-01
-497	val_498	2009-08-01
 497	val_497	2009-08-01
 497	val_498	2009-08-01
+497	val_498	2009-08-01
 498	val_498	2009-08-01
 498	val_498	2009-08-01
 498	val_498	2009-08-01
@@ -1958,21 +1958,21 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 5	val_6	2009-08-01
 50	val_51	2009-08-01
 51	val_51	2009-08-01
-51	val_52	2009-08-01
 51	val_51	2009-08-01
+51	val_52	2009-08-01
 52	val_53	2009-08-01
 52	val_53	2009-08-01
 52	val_53	2009-08-01
 52	val_53	2009-08-01
-53	val_54	2009-08-01
 53	val_53	2009-08-01
+53	val_54	2009-08-01
 54	val_54	2009-08-01
 56	val_57	2009-08-01
 57	val_57	2009-08-01
 58	val_58	2009-08-01
-58	val_59	2009-08-01
 58	val_58	2009-08-01
 58	val_59	2009-08-01
+58	val_59	2009-08-01
 59	val_60	2009-08-01
 6	val_7	2009-08-01
 6	val_7	2009-08-01
@@ -1992,26 +1992,26 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 69	val_69	2009-08-01
 69	val_70	2009-08-01
 70	val_70	2009-08-01
-70	val_71	2009-08-01
 70	val_70	2009-08-01
 70	val_70	2009-08-01
+70	val_71	2009-08-01
 71	val_72	2009-08-01
 72	val_72	2009-08-01
 72	val_72	2009-08-01
 74	val_74	2009-08-01
 75	val_76	2009-08-01
-76	val_77	2009-08-01
+76	val_76	2009-08-01
 76	val_76	2009-08-01
 76	val_77	2009-08-01
 76	val_77	2009-08-01
-76	val_76	2009-08-01
-77	val_78	2009-08-01
+76	val_77	2009-08-01
 77	val_77	2009-08-01
 77	val_78	2009-08-01
+77	val_78	2009-08-01
 78	val_78	2009-08-01
 78	val_79	2009-08-01
-8	val_9	2009-08-01
 8	val_8	2009-08-01
+8	val_9	2009-08-01
 80	val_80	2009-08-01
 80	val_81	2009-08-01
 82	val_82	2009-08-01
@@ -2021,10 +2021,10 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 83	val_83	2009-08-01
 84	val_84	2009-08-01
 84	val_84	2009-08-01
-85	val_86	2009-08-01
 85	val_85	2009-08-01
-86	val_87	2009-08-01
+85	val_86	2009-08-01
 86	val_86	2009-08-01
+86	val_87	2009-08-01
 87	val_87	2009-08-01
 87	val_88	2009-08-01
 87	val_88	2009-08-01
@@ -2045,9 +2045,9 @@ POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-26-01_929_19994747539261576
 95	val_95	2009-08-01
 96	val_96	2009-08-01
 97	val_97	2009-08-01
-97	val_98	2009-08-01
 97	val_97	2009-08-01
 97	val_98	2009-08-01
+97	val_98	2009-08-01
 98	val_98	2009-08-01
 98	val_98	2009-08-01
 99	val_100	2009-08-01
diff --git a/ql/src/test/results/clientpositive/union22.q.out b/ql/src/test/results/clientpositive/union22.q.out
index f1fa758f98..47908732fb 100644
--- a/ql/src/test/results/clientpositive/union22.q.out
+++ b/ql/src/test/results/clientpositive/union22.q.out
@@ -162,7 +162,7 @@ STAGE PLANS:
                 File Output Operator
                   compressed: false
                   GlobalTableId: 0
-                  directory: file:/tmp/njain/hive_2011-02-01_22-31-21_856_7111197832719783346/-mr-10002
+                  directory: file:/var/folders/7P/7PeC14kXFIWq0PIYyexGbmKuXUk/-Tmp-/jsichi/hive_2011-02-07_10-46-08_466_7609771648760025606/-mr-10002
                   NumFilesPerFileSink: 1
                   table:
                       input format: org.apache.hadoop.mapred.SequenceFileInputFormat
@@ -178,9 +178,9 @@ STAGE PLANS:
         Map Reduce Local Work
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/njain/hive2/build/ql/test/data/warehouse/dst_union22/ds=1 [null-subquery2:subq-subquery2:a]
+        pfile:/Users/jsichi/open/hive-trunk/build/ql/test/data/warehouse/dst_union22/ds=1 [null-subquery2:subq-subquery2:a]
       Path -> Partition:
-        pfile:/data/users/njain/hive2/build/ql/test/data/warehouse/dst_union22/ds=1 
+        pfile:/Users/jsichi/open/hive-trunk/build/ql/test/data/warehouse/dst_union22/ds=1 
           Partition
             base file name: ds=1
             input format: org.apache.hadoop.mapred.TextInputFormat
@@ -193,7 +193,7 @@ STAGE PLANS:
               columns.types string:string:string:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/njain/hive2/build/ql/test/data/warehouse/dst_union22/ds=1
+              location pfile:/Users/jsichi/open/hive-trunk/build/ql/test/data/warehouse/dst_union22/ds=1
               name dst_union22
               numFiles 1
               numPartitions 1
@@ -203,7 +203,7 @@ STAGE PLANS:
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               totalSize 11624
-              transient_lastDdlTime 1296628277
+              transient_lastDdlTime 1297104359
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -214,7 +214,7 @@ STAGE PLANS:
                 columns.types string:string:string:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/njain/hive2/build/ql/test/data/warehouse/dst_union22
+                location pfile:/Users/jsichi/open/hive-trunk/build/ql/test/data/warehouse/dst_union22
                 name dst_union22
                 numFiles 1
                 numPartitions 1
@@ -224,7 +224,7 @@ STAGE PLANS:
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 totalSize 11624
-                transient_lastDdlTime 1296628277
+                transient_lastDdlTime 1297104359
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: dst_union22
             name: dst_union22
@@ -232,7 +232,7 @@ STAGE PLANS:
   Stage: Stage-3
     Map Reduce
       Alias -> Map Operator Tree:
-        file:/tmp/njain/hive_2011-02-01_22-31-21_856_7111197832719783346/-mr-10002 
+        file:/var/folders/7P/7PeC14kXFIWq0PIYyexGbmKuXUk/-Tmp-/jsichi/hive_2011-02-07_10-46-08_466_7609771648760025606/-mr-10002 
           Select Operator
             expressions:
                   expr: _col0
@@ -275,10 +275,10 @@ STAGE PLANS:
                     File Output Operator
                       compressed: false
                       GlobalTableId: 1
-                      directory: pfile:/data/users/njain/hive2/build/ql/scratchdir/hive_2011-02-01_22-31-21_856_7111197832719783346/-ext-10000
+                      directory: pfile:/Users/jsichi/open/hive-trunk/build/ql/scratchdir/hive_2011-02-07_10-46-08_466_7609771648760025606/-ext-10000
                       NumFilesPerFileSink: 1
                       Static Partition Specification: ds=2/
-                      Stats Publishing Key Prefix: pfile:/data/users/njain/hive2/build/ql/scratchdir/hive_2011-02-01_22-31-21_856_7111197832719783346/-ext-10000/
+                      Stats Publishing Key Prefix: pfile:/Users/jsichi/open/hive-trunk/build/ql/scratchdir/hive_2011-02-07_10-46-08_466_7609771648760025606/-ext-10000/
                       table:
                           input format: org.apache.hadoop.mapred.TextInputFormat
                           output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -288,7 +288,7 @@ STAGE PLANS:
                             columns.types string:string:string:string
                             file.inputformat org.apache.hadoop.mapred.TextInputFormat
                             file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            location pfile:/data/users/njain/hive2/build/ql/test/data/warehouse/dst_union22
+                            location pfile:/Users/jsichi/open/hive-trunk/build/ql/test/data/warehouse/dst_union22
                             name dst_union22
                             numFiles 1
                             numPartitions 1
@@ -298,7 +298,7 @@ STAGE PLANS:
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                             totalSize 11624
-                            transient_lastDdlTime 1296628277
+                            transient_lastDdlTime 1297104359
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           name: dst_union22
                       TotalFiles: 1
@@ -344,10 +344,10 @@ STAGE PLANS:
                       File Output Operator
                         compressed: false
                         GlobalTableId: 1
-                        directory: pfile:/data/users/njain/hive2/build/ql/scratchdir/hive_2011-02-01_22-31-21_856_7111197832719783346/-ext-10000
+                        directory: pfile:/Users/jsichi/open/hive-trunk/build/ql/scratchdir/hive_2011-02-07_10-46-08_466_7609771648760025606/-ext-10000
                         NumFilesPerFileSink: 1
                         Static Partition Specification: ds=2/
-                        Stats Publishing Key Prefix: pfile:/data/users/njain/hive2/build/ql/scratchdir/hive_2011-02-01_22-31-21_856_7111197832719783346/-ext-10000/
+                        Stats Publishing Key Prefix: pfile:/Users/jsichi/open/hive-trunk/build/ql/scratchdir/hive_2011-02-07_10-46-08_466_7609771648760025606/-ext-10000/
                         table:
                             input format: org.apache.hadoop.mapred.TextInputFormat
                             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -357,7 +357,7 @@ STAGE PLANS:
                               columns.types string:string:string:string
                               file.inputformat org.apache.hadoop.mapred.TextInputFormat
                               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                              location pfile:/data/users/njain/hive2/build/ql/test/data/warehouse/dst_union22
+                              location pfile:/Users/jsichi/open/hive-trunk/build/ql/test/data/warehouse/dst_union22
                               name dst_union22
                               numFiles 1
                               numPartitions 1
@@ -367,7 +367,7 @@ STAGE PLANS:
                               serialization.format 1
                               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                               totalSize 11624
-                              transient_lastDdlTime 1296628277
+                              transient_lastDdlTime 1297104359
                             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                             name: dst_union22
                         TotalFiles: 1
@@ -375,10 +375,10 @@ STAGE PLANS:
                         MultiFileSpray: false
       Needs Tagging: false
       Path -> Alias:
-        file:/tmp/njain/hive_2011-02-01_22-31-21_856_7111197832719783346/-mr-10002 [file:/tmp/njain/hive_2011-02-01_22-31-21_856_7111197832719783346/-mr-10002]
-        pfile:/data/users/njain/hive2/build/ql/test/data/warehouse/dst_union22_delta/ds=1 [null-subquery1:subq-subquery1:dst_union22_delta]
+        file:/var/folders/7P/7PeC14kXFIWq0PIYyexGbmKuXUk/-Tmp-/jsichi/hive_2011-02-07_10-46-08_466_7609771648760025606/-mr-10002 [file:/var/folders/7P/7PeC14kXFIWq0PIYyexGbmKuXUk/-Tmp-/jsichi/hive_2011-02-07_10-46-08_466_7609771648760025606/-mr-10002]
+        pfile:/Users/jsichi/open/hive-trunk/build/ql/test/data/warehouse/dst_union22_delta/ds=1 [null-subquery1:subq-subquery1:dst_union22_delta]
       Path -> Partition:
-        file:/tmp/njain/hive_2011-02-01_22-31-21_856_7111197832719783346/-mr-10002 
+        file:/var/folders/7P/7PeC14kXFIWq0PIYyexGbmKuXUk/-Tmp-/jsichi/hive_2011-02-07_10-46-08_466_7609771648760025606/-mr-10002 
           Partition
             base file name: -mr-10002
             input format: org.apache.hadoop.mapred.SequenceFileInputFormat
@@ -394,7 +394,7 @@ STAGE PLANS:
                 columns _col0,_col1,_col10,_col11
                 columns.types string,string,string,string
                 escape.delim \
-        pfile:/data/users/njain/hive2/build/ql/test/data/warehouse/dst_union22_delta/ds=1 
+        pfile:/Users/jsichi/open/hive-trunk/build/ql/test/data/warehouse/dst_union22_delta/ds=1 
           Partition
             base file name: ds=1
             input format: org.apache.hadoop.mapred.TextInputFormat
@@ -407,7 +407,7 @@ STAGE PLANS:
               columns.types string:string:string:string:string:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/njain/hive2/build/ql/test/data/warehouse/dst_union22_delta/ds=1
+              location pfile:/Users/jsichi/open/hive-trunk/build/ql/test/data/warehouse/dst_union22_delta/ds=1
               name dst_union22_delta
               numFiles 1
               numPartitions 1
@@ -417,7 +417,7 @@ STAGE PLANS:
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               totalSize 17436
-              transient_lastDdlTime 1296628281
+              transient_lastDdlTime 1297104368
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -428,7 +428,7 @@ STAGE PLANS:
                 columns.types string:string:string:string:string:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/njain/hive2/build/ql/test/data/warehouse/dst_union22_delta
+                location pfile:/Users/jsichi/open/hive-trunk/build/ql/test/data/warehouse/dst_union22_delta
                 name dst_union22_delta
                 numFiles 1
                 numPartitions 1
@@ -438,7 +438,7 @@ STAGE PLANS:
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 totalSize 17436
-                transient_lastDdlTime 1296628281
+                transient_lastDdlTime 1297104368
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: dst_union22_delta
             name: dst_union22_delta
@@ -449,7 +449,7 @@ STAGE PLANS:
           partition:
             ds 2
           replace: true
-          source: pfile:/data/users/njain/hive2/build/ql/scratchdir/hive_2011-02-01_22-31-21_856_7111197832719783346/-ext-10000
+          source: pfile:/Users/jsichi/open/hive-trunk/build/ql/scratchdir/hive_2011-02-07_10-46-08_466_7609771648760025606/-ext-10000
           table:
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -459,7 +459,7 @@ STAGE PLANS:
                 columns.types string:string:string:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/njain/hive2/build/ql/test/data/warehouse/dst_union22
+                location pfile:/Users/jsichi/open/hive-trunk/build/ql/test/data/warehouse/dst_union22
                 name dst_union22
                 numFiles 1
                 numPartitions 1
@@ -469,14 +469,14 @@ STAGE PLANS:
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 totalSize 11624
-                transient_lastDdlTime 1296628277
+                transient_lastDdlTime 1297104359
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: dst_union22
-          tmp directory: pfile:/data/users/njain/hive2/build/ql/scratchdir/hive_2011-02-01_22-31-21_856_7111197832719783346/-ext-10001
+          tmp directory: pfile:/Users/jsichi/open/hive-trunk/build/ql/scratchdir/hive_2011-02-07_10-46-08_466_7609771648760025606/-ext-10001
 
   Stage: Stage-4
     Stats-Aggr Operator
-      Stats Aggregation Key Prefix: pfile:/data/users/njain/hive2/build/ql/scratchdir/hive_2011-02-01_22-31-21_856_7111197832719783346/-ext-10000/
+      Stats Aggregation Key Prefix: pfile:/Users/jsichi/open/hive-trunk/build/ql/scratchdir/hive_2011-02-07_10-46-08_466_7609771648760025606/-ext-10000/
 
 PREHOOK: query: insert overwrite table dst_union22 partition (ds='2')
 select * from
@@ -522,14 +522,14 @@ POSTHOOK: Lineage: dst_union22_delta PARTITION(ds=1).k2 SIMPLE [(src)src.FieldSc
 POSTHOOK: Lineage: dst_union22_delta PARTITION(ds=1).k3 SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: dst_union22_delta PARTITION(ds=1).k4 SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: dst_union22_delta PARTITION(ds=1).k5 SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-PREHOOK: query: select * from dst_union22 where ds = '2' order by k1
+PREHOOK: query: select * from dst_union22 where ds = '2' order by k1, k2, k3, k4
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dst_union22@ds=2
-PREHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-31-31_092_8460885695793732904/-mr-10000
-POSTHOOK: query: select * from dst_union22 where ds = '2' order by k1
+PREHOOK: Output: file:/var/folders/7P/7PeC14kXFIWq0PIYyexGbmKuXUk/-Tmp-/jsichi/hive_2011-02-07_10-46-27_561_2189263148420397827/-mr-10000
+POSTHOOK: query: select * from dst_union22 where ds = '2' order by k1, k2, k3, k4
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dst_union22@ds=2
-POSTHOOK: Output: file:/tmp/njain/hive_2011-02-01_22-31-31_092_8460885695793732904/-mr-10000
+POSTHOOK: Output: file:/var/folders/7P/7PeC14kXFIWq0PIYyexGbmKuXUk/-Tmp-/jsichi/hive_2011-02-07_10-46-27_561_2189263148420397827/-mr-10000
 POSTHOOK: Lineage: dst_union22 PARTITION(ds=1).k1 SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: dst_union22 PARTITION(ds=1).k2 SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: dst_union22 PARTITION(ds=1).k3 SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -880,10 +880,10 @@ POSTHOOK: Lineage: dst_union22_delta PARTITION(ds=1).k5 SIMPLE [(src)src.FieldSc
 239	val_239	239	val_239	2
 239	val_239	239	val_239	2
 239	val_239	239	val_239	2
-24	val_24	24	val_24	2
-24	val_24	24	val_24	2
 24	val_24	NULL	NULL	2
 24	val_24	NULL	NULL	2
+24	val_24	24	val_24	2
+24	val_24	24	val_24	2
 241	val_241	241	val_241	2
 242	val_242	242	val_242	2
 242	val_242	242	val_242	2
@@ -916,8 +916,8 @@ POSTHOOK: Lineage: dst_union22_delta PARTITION(ds=1).k5 SIMPLE [(src)src.FieldSc
 265	val_265	265	val_265	2
 265	val_265	265	val_265	2
 266	val_266	266	val_266	2
-27	val_27	27	val_27	2
 27	val_27	NULL	NULL	2
+27	val_27	27	val_27	2
 272	val_272	272	val_272	2
 272	val_272	272	val_272	2
 272	val_272	272	val_272	2
@@ -989,8 +989,8 @@ POSTHOOK: Lineage: dst_union22_delta PARTITION(ds=1).k5 SIMPLE [(src)src.FieldSc
 298	val_298	298	val_298	2
 298	val_298	298	val_298	2
 298	val_298	298	val_298	2
-30	val_30	30	val_30	2
 30	val_30	NULL	NULL	2
+30	val_30	30	val_30	2
 302	val_302	302	val_302	2
 305	val_305	305	val_305	2
 306	val_306	306	val_306	2
@@ -1073,8 +1073,8 @@ POSTHOOK: Lineage: dst_union22_delta PARTITION(ds=1).k5 SIMPLE [(src)src.FieldSc
 336	val_336	336	val_336	2
 338	val_338	338	val_338	2
 339	val_339	339	val_339	2
-34	val_34	34	val_34	2
 34	val_34	NULL	NULL	2
+34	val_34	34	val_34	2
 341	val_341	341	val_341	2
 342	val_342	342	val_342	2
 342	val_342	342	val_342	2
@@ -1111,11 +1111,11 @@ POSTHOOK: Lineage: dst_union22_delta PARTITION(ds=1).k5 SIMPLE [(src)src.FieldSc
 348	val_348	348	val_348	2
 348	val_348	348	val_348	2
 35	val_35	NULL	NULL	2
+35	val_35	NULL	NULL	2
+35	val_35	NULL	NULL	2
 35	val_35	35	val_35	2
 35	val_35	35	val_35	2
-35	val_35	NULL	NULL	2
 35	val_35	35	val_35	2
-35	val_35	NULL	NULL	2
 351	val_351	351	val_351	2
 353	val_353	353	val_353	2
 353	val_353	353	val_353	2
@@ -1142,9 +1142,9 @@ POSTHOOK: Lineage: dst_union22_delta PARTITION(ds=1).k5 SIMPLE [(src)src.FieldSc
 369	val_369	369	val_369	2
 369	val_369	369	val_369	2
 37	val_37	NULL	NULL	2
+37	val_37	NULL	NULL	2
 37	val_37	37	val_37	2
 37	val_37	37	val_37	2
-37	val_37	NULL	NULL	2
 373	val_373	373	val_373	2
 374	val_374	374	val_374	2
 375	val_375	375	val_375	2
@@ -1280,9 +1280,9 @@ POSTHOOK: Lineage: dst_union22_delta PARTITION(ds=1).k5 SIMPLE [(src)src.FieldSc
 418	val_418	418	val_418	2
 419	val_419	419	val_419	2
 42	val_42	NULL	NULL	2
+42	val_42	NULL	NULL	2
 42	val_42	42	val_42	2
 42	val_42	42	val_42	2
-42	val_42	NULL	NULL	2
 421	val_421	421	val_421	2
 424	val_424	424	val_424	2
 424	val_424	424	val_424	2
@@ -1330,8 +1330,8 @@ POSTHOOK: Lineage: dst_union22_delta PARTITION(ds=1).k5 SIMPLE [(src)src.FieldSc
 439	val_439	439	val_439	2
 439	val_439	439	val_439	2
 439	val_439	439	val_439	2
-44	val_44	44	val_44	2
 44	val_44	NULL	NULL	2
+44	val_44	44	val_44	2
 443	val_443	443	val_443	2
 444	val_444	444	val_444	2
 446	val_446	446	val_446	2
