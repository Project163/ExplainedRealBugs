diff --git a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/SerializationUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/SerializationUtils.java
index 1cd84f9c99..20c8c6dce6 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/SerializationUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/SerializationUtils.java
@@ -200,7 +200,7 @@ enum FixedBitSizes {
    */
   static int findClosestNumBits(long value) {
     int count = 0;
-    while (value > 0) {
+    while (value != 0) {
       count++;
       value = value >>> 1;
     }
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestNewIntegerEncoding.java b/ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestNewIntegerEncoding.java
index 5919199d69..dbb7641300 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestNewIntegerEncoding.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestNewIntegerEncoding.java
@@ -948,6 +948,38 @@ public void testPatchedBaseTimestamp() throws Exception {
     }
   }
 
+  @Test
+  public void testDirectLargeNegatives() throws Exception {
+    ObjectInspector inspector;
+    synchronized (TestOrcFile.class) {
+      inspector = ObjectInspectorFactory.getReflectionObjectInspector(Long.class,
+          ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
+    }
+
+    Writer writer = OrcFile.createWriter(testFilePath,
+        OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000));
+
+    writer.addRow(-7486502418706614742L);
+    writer.addRow(0L);
+    writer.addRow(1L);
+    writer.addRow(1L);
+    writer.addRow(-5535739865598783616L);
+    writer.close();
+
+    Reader reader = OrcFile.createReader(fs, testFilePath);
+    RecordReader rows = reader.rows(null);
+    Object row = rows.next(null);
+    assertEquals(-7486502418706614742L, ((LongWritable) row).get());
+    row = rows.next(row);
+    assertEquals(0L, ((LongWritable) row).get());
+    row = rows.next(row);
+    assertEquals(1L, ((LongWritable) row).get());
+    row = rows.next(row);
+    assertEquals(1L, ((LongWritable) row).get());
+    row = rows.next(row);
+    assertEquals(-5535739865598783616L, ((LongWritable) row).get());
+  }
+
   @Test
   public void testSeek() throws Exception {
     ObjectInspector inspector;
