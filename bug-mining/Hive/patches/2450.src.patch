diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/spark/SparkPlanGenerator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/spark/SparkPlanGenerator.java
index 45f8075bcd..c1a86c2d2b 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/spark/SparkPlanGenerator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/spark/SparkPlanGenerator.java
@@ -158,7 +158,7 @@ private Class getInputFormat(MapWork mWork) throws HiveException {
     return inputFormatClass;
   }
 
-  private SparkTran generate(BaseWork bw) throws IOException, HiveException {
+  private SparkTran generate(BaseWork bw) throws Exception {
     // initialize stats publisher if necessary
     if (bw.isGatheringStats()) {
       StatsPublisher statsPublisher;
@@ -183,9 +183,14 @@ private SparkTran generate(BaseWork bw) throws IOException, HiveException {
     }
   }
 
-  private MapTran generate(MapWork mw) throws IOException {
+  private MapTran generate(MapWork mw) throws Exception {
     JobConf newJobConf = new JobConf(jobConf);
     MapTran result = new MapTran();
+
+    List<Path> inputPaths = Utilities.getInputPaths(newJobConf, mw,
+      scratchDir, context, false);
+    Utilities.setInputPaths(newJobConf, inputPaths);
+
     Utilities.setMapWork(newJobConf, mw, scratchDir, true);
     Utilities.createTmpDirs(newJobConf, mw);
     newJobConf.set("mapred.mapper.class", ExecMapper.class.getName());
