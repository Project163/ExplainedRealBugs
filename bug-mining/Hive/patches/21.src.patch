diff --git a/CHANGES.txt b/CHANGES.txt
index 8ed1d2da6f..ece2397326 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -36,6 +36,8 @@ Trunk (unreleased changes)
 
   BUG FIXES
 
+    HIVE-103. Disable inserts in sub queries. (Namit Jain through zshao)
+
     HIVE-92. Fixed union all for non-embedded query. (Namit Jain through zshao)
 
     HIVE-93. Dynamic serde to handle _-prefixed column names in DDL.
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java
index 0fb04cad9c..648e8461a3 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java
@@ -43,6 +43,7 @@ public enum ErrorMsg {
   DUPLICATE_GROUPBY_KEY("Repeated Key in Group By"),
   UNSUPPORTED_MULTIPLE_DISTINCTS("DISTINCT on Different Columns not Supported"),
   NO_SUBQUERY_ALIAS("No Alias For Subquery"),
+  NO_INSERT_INSUBQUERY("Cannot insert in a Subquery. Inserting to table "),
   NON_KEY_EXPR_IN_GROUPBY("Expression Not In Group By Key"),
   INVALID_XPATH("General . and [] Operators are Not Supported"),
   INVALID_PATH("Invalid Path"),
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index 4b0806168c..6281022f2a 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -343,6 +343,14 @@ public void doPhase1(CommonTree ast, QB qb, Phase1Ctx ctx_1)
         ctx_1.dest = "insclause-" + ctx_1.nextNum;
         ctx_1.nextNum++;
 
+        // is there a insert in the subquery
+        if (qbp.getIsSubQ()) {
+          CommonTree ch = (CommonTree)ast.getChild(0);
+          if ((ch.getToken().getType() != HiveParser.TOK_DIR) ||
+              (((CommonTree)ch.getChild(0)).getToken().getType() != HiveParser.TOK_TMP_FILE))
+            throw new SemanticException(ErrorMsg.NO_INSERT_INSUBQUERY.getMsg(ast));
+        }
+
         qbp.setDestForClause(ctx_1.dest, (CommonTree) ast.getChild(0));
       }
         break;
diff --git a/ql/src/test/queries/clientnegative/subq_insert.q b/ql/src/test/queries/clientnegative/subq_insert.q
new file mode 100644
index 0000000000..0bc9e24e48
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/subq_insert.q
@@ -0,0 +1,2 @@
+EXPLAIN
+SELECT * FROM (INSERT OVERWRITE TABLE src1 SELECT * FROM src ) y;
diff --git a/ql/src/test/results/clientnegative/subq_insert.q.out b/ql/src/test/results/clientnegative/subq_insert.q.out
new file mode 100644
index 0000000000..da8d18a7bc
--- /dev/null
+++ b/ql/src/test/results/clientnegative/subq_insert.q.out
@@ -0,0 +1 @@
+FAILED: Error in semantic analysis: line 2:38 Cannot insert in a Subquery. Inserting to table  src1
