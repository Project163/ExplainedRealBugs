diff --git a/CHANGES.txt b/CHANGES.txt
index d008ee1214..6b2b94a859 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -34,6 +34,9 @@ Trunk (unreleased changes)
     HIVE-334. Make union3 test output deterministic.
     (Joydeep Sen Sarma via athusoo)
 
+    HIVE-320. Fix intermittent nullpointer exception in count(DISTINCT).
+    (Namit Jain via athusoo)
+
 Release 0.2.0 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java
index 51ea0e40a3..30c45c2976 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java
@@ -384,7 +384,13 @@ protected void updateAggregations(UDAFEvaluator[] aggs, Object row, ObjectInspec
             differentParameters = true;
           else {
             for(int pi=0; pi<o.length; pi++) {
-              if (!o[pi].equals(lastInvoke[ai][pi])) {
+              if (o[pi] == null) {
+                if (lastInvoke[ai][pi] != null) {
+                  differentParameters = true;
+                  break;
+                }
+              }
+              else if (!o[pi].equals(lastInvoke[ai][pi])) {
                 differentParameters = true;
                 break;
               }
