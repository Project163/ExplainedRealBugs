diff --git a/llap-server/src/java/org/apache/hadoop/hive/llap/cli/LlapServiceDriver.java b/llap-server/src/java/org/apache/hadoop/hive/llap/cli/LlapServiceDriver.java
index 6239842616..c8fddb1da7 100644
--- a/llap-server/src/java/org/apache/hadoop/hive/llap/cli/LlapServiceDriver.java
+++ b/llap-server/src/java/org/apache/hadoop/hive/llap/cli/LlapServiceDriver.java
@@ -248,10 +248,11 @@ private void run(String[] args) throws Exception {
       // Needs more explanation here
       // Xmx is not the max heap value in JDK8. You need to subtract 50% of the survivor fraction
       // from this, to get actual usable  memory before it goes into GC
-      xmx = (long) (options.getXmx() / (1024 * 1024));
-      conf.setLong(ConfVars.LLAP_DAEMON_MEMORY_PER_INSTANCE_MB.varname, xmx);
+      xmx = options.getXmx();
+      long xmxMb = (long)(xmx / (1024 * 1024));
+      conf.setLong(ConfVars.LLAP_DAEMON_MEMORY_PER_INSTANCE_MB.varname, xmxMb);
       propsDirectOptions.setProperty(ConfVars.LLAP_DAEMON_MEMORY_PER_INSTANCE_MB.varname,
-          String.valueOf(xmx));
+          String.valueOf(xmxMb));
     }
 
     if (options.getLlapQueueName() != null && !options.getLlapQueueName().isEmpty()) {
diff --git a/llap-server/src/main/resources/package.py b/llap-server/src/main/resources/package.py
index 94c9d1ae96..83fe918ae4 100644
--- a/llap-server/src/main/resources/package.py
+++ b/llap-server/src/main/resources/package.py
@@ -103,7 +103,7 @@ def main(args):
 	java_home = config["java.home"]
 	max_direct_memory = config["max_direct_memory"]
 	daemon_args = args.args
-	if max_direct_memory > 0:
+	if long(max_direct_memory) > 0:
 		daemon_args = " -XX:MaxDirectMemorySize=%s %s" % (max_direct_memory, daemon_args)
 	resource = LlapResource(config)
 	# 5% container failure every monkey_interval seconds
