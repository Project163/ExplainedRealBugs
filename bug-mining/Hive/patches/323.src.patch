diff --git a/CHANGES.txt b/CHANGES.txt
index 19b317abbc..84b9cdc480 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -443,6 +443,9 @@ Release 0.5.0 -  Unreleased
     HIVE-1037 SerDe & ObjectInspector for RowContainer mismatch with the
     input data (Ning Zhang via namit)
 
+    HIVE-1042 incorrect error for function within transform
+    (Paul Yang via namit)
+
 Release 0.4.0 -  Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index a32bfd5daf..6bb2c31ce7 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -1526,9 +1526,11 @@ private Operator<?> genSelectPlan(ASTNode selExprList, QB qb,
       // child can be EXPR AS ALIAS, or EXPR.
       ASTNode child = (ASTNode) exprList.getChild(i);
       boolean hasAsClause = (!isInTransform) && (child.getChildCount() == 2);
-
+      
       // EXPR AS (ALIAS,...) parses, but is only allowed for UDTF's
-      if (!isUDTF && child.getChildCount() > 2) {
+      // This check is not needed and invalid when there is a transform b/c the 
+      // AST's are slightly different.
+      if (!isInTransform && !isUDTF && child.getChildCount() > 2) {
         throw new SemanticException(ErrorMsg.INVALID_AS.getMsg());
       }
 
diff --git a/ql/src/test/queries/clientpositive/transform2.q b/ql/src/test/queries/clientpositive/transform2.q
new file mode 100644
index 0000000000..ddbc567596
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/transform2.q
@@ -0,0 +1,2 @@
+-- Transform with a function that has many parameters
+SELECT TRANSFORM(substr(key, 1, 2)) USING 'cat' FROM src LIMIT 1;
diff --git a/ql/src/test/results/clientpositive/transform2.q.out b/ql/src/test/results/clientpositive/transform2.q.out
new file mode 100644
index 0000000000..37714f99a4
--- /dev/null
+++ b/ql/src/test/results/clientpositive/transform2.q.out
@@ -0,0 +1,11 @@
+PREHOOK: query: -- Transform with a function that has many parameters
+SELECT TRANSFORM(substr(key, 1, 2)) USING 'cat' FROM src LIMIT 1
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+PREHOOK: Output: file:/data/users/pyang/task/trunk/VENDOR.hive/trunk/build/ql/tmp/366195841/10000
+POSTHOOK: query: -- Transform with a function that has many parameters
+SELECT TRANSFORM(substr(key, 1, 2)) USING 'cat' FROM src LIMIT 1
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+POSTHOOK: Output: file:/data/users/pyang/task/trunk/VENDOR.hive/trunk/build/ql/tmp/366195841/10000
+23	NULL
