diff --git a/shims/0.23/src/main/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java b/shims/0.23/src/main/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java
index 3825434439..655798f57e 100644
--- a/shims/0.23/src/main/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java
+++ b/shims/0.23/src/main/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java
@@ -69,6 +69,7 @@
 import org.apache.hadoop.hdfs.protocol.ErasureCodingPolicy;
 import org.apache.hadoop.hdfs.protocol.ErasureCodingPolicyInfo;
 import org.apache.hadoop.hdfs.protocol.HdfsConstants;
+import org.apache.hadoop.hdfs.protocol.HdfsFileStatus;
 import org.apache.hadoop.hdfs.protocol.HdfsLocatedFileStatus;
 import org.apache.hadoop.io.LongWritable;
 import org.apache.hadoop.ipc.CallerContext;
@@ -1444,7 +1445,11 @@ public void addDelegationTokens(FileSystem fs, Credentials cred, String uname) t
 
   @Override
   public long getFileId(FileSystem fs, String path) throws IOException {
-    return ensureDfs(fs).getClient().getFileInfo(path).getFileId();
+    HdfsFileStatus fileInfo = ensureDfs(fs).getClient().getFileInfo(path);
+    if (fileInfo == null) {
+      throw new FileNotFoundException(path + " does not exist.");
+    }
+    return fileInfo.getFileId();
   }
 
 
diff --git a/shims/0.23/src/main/test/org/apache/hadoop/hive/shims/TestHadoop23Shims.java b/shims/0.23/src/main/test/org/apache/hadoop/hive/shims/TestHadoop23Shims.java
index efb0074271..e82895a1f2 100644
--- a/shims/0.23/src/main/test/org/apache/hadoop/hive/shims/TestHadoop23Shims.java
+++ b/shims/0.23/src/main/test/org/apache/hadoop/hive/shims/TestHadoop23Shims.java
@@ -20,13 +20,19 @@
 
 import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.fs.Path;
+import org.apache.hadoop.hdfs.DFSClient;
+import org.apache.hadoop.hdfs.DistributedFileSystem;
+
 import org.junit.Test;
 
+import java.io.FileNotFoundException;
 import java.util.Collections;
 import java.util.List;
 
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertTrue;
+import static org.mockito.Mockito.doAnswer;
+import static org.mockito.Mockito.mock;
 
 
 public class TestHadoop23Shims {
@@ -88,4 +94,17 @@ public void testConstructDistCpParams() {
 
   }
 
+  @Test(expected = FileNotFoundException.class)
+  public void testGetFileIdForNonexistingPath() throws Exception {
+    Hadoop23Shims shims = new Hadoop23Shims();
+
+    DistributedFileSystem fs = mock(DistributedFileSystem.class);
+    DFSClient dfsClient = mock(DFSClient.class);
+    doAnswer(invocationOnMock -> {
+      return dfsClient;
+    }).when(fs).getClient();
+
+    shims.getFileId(fs, "badpath");
+  }
+
 }
