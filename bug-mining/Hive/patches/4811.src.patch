diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/MapRecordProcessor.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/MapRecordProcessor.java
index e8ccbc418d..0886c0e61f 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/MapRecordProcessor.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/MapRecordProcessor.java
@@ -369,9 +369,10 @@ private KeyValueReader getKeyValueReader(Collection<KeyValueReader> keyValueRead
     // this sets up the map operator contexts correctly
     mapOp.initializeContexts();
     Deserializer deserializer = mapOp.getCurrentDeserializer();
+    // deserializer is null in case of VectorMapOperator
     KeyValueReader reader =
       new KeyValueInputMerger(kvReaderList, deserializer,
-          new ObjectInspector[] { deserializer.getObjectInspector() }, mapOp
+          new ObjectInspector[] { deserializer == null ? null : deserializer.getObjectInspector() }, mapOp
           .getConf()
           .getSortCols());
     return reader;
