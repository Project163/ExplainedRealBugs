diff --git a/pom.xml b/pom.xml
index 9a5b510180..5a2e4297d2 100644
--- a/pom.xml
+++ b/pom.xml
@@ -139,7 +139,7 @@
     <stax.version>1.0.1</stax.version>
     <slf4j.version>1.7.5</slf4j.version>
     <ST4.version>4.0.4</ST4.version>
-    <tez.version>0.3.0-incubating</tez.version>
+    <tez.version>0.4.0-incubating</tez.version>
     <tempus-fugit.version>1.1</tempus-fugit.version>
     <snappy.version>0.2</snappy.version>
     <wadl-resourcedoc-doclet.version>1.4</wadl-resourcedoc-doclet.version>
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DagUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DagUtils.java
index 1ab90ca276..62433d3b61 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DagUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DagUtils.java
@@ -116,6 +116,7 @@
 import org.apache.tez.runtime.library.input.ShuffledUnorderedKVInput;
 import org.apache.tez.runtime.library.output.OnFileSortedOutput;
 import org.apache.tez.runtime.library.output.OnFileUnorderedKVOutput;
+import org.apache.tez.runtime.library.output.OnFileUnorderedPartitionedKVOutput;
 
 /**
  * DagUtils. DagUtils is a collection of helper methods to convert
@@ -312,7 +313,7 @@ private EdgeProperty createEdgeProperty(TezEdgeProperty edgeProp) throws IOExcep
       case CUSTOM_EDGE:
         
         dataMovementType = DataMovementType.CUSTOM;
-        logicalOutputClass = OnFileSortedOutput.class;
+        logicalOutputClass = OnFileUnorderedPartitionedKVOutput.class;
         logicalInputClass = ShuffledUnorderedKVInput.class;
         EdgeManagerDescriptor edgeDesc = new EdgeManagerDescriptor(
             CustomPartitionEdge.class.getName());
@@ -332,7 +333,7 @@ private EdgeProperty createEdgeProperty(TezEdgeProperty edgeProp) throws IOExcep
 
       case CUSTOM_SIMPLE_EDGE:
         dataMovementType = DataMovementType.SCATTER_GATHER;
-        logicalOutputClass = OnFileSortedOutput.class;
+        logicalOutputClass = OnFileUnorderedPartitionedKVOutput.class;
         logicalInputClass = ShuffledUnorderedKVInput.class;
         break;
 
