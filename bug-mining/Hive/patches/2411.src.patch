diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/spark/HiveBaseFunctionResultList.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/spark/HiveBaseFunctionResultList.java
index 03500df49b..6568a7602b 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/spark/HiveBaseFunctionResultList.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/spark/HiveBaseFunctionResultList.java
@@ -107,6 +107,13 @@ public boolean hasNext(){
 
       // At this point we are done processing the input. Close the record processor
       closeRecordProcessor();
+
+      // It is possible that some operators add records after closing the processor, so make sure
+      // to check the lastRecordOutput
+      if (lastRecordOutput.hasNext()) {
+        return true;
+      }
+
       lastRecordOutput.clear();
       return false;
     }
