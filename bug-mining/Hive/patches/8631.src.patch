diff --git a/hplsql/src/main/java/org/apache/hive/hplsql/Stmt.java b/hplsql/src/main/java/org/apache/hive/hplsql/Stmt.java
index eac3a6d0d2..78a25a0f26 100644
--- a/hplsql/src/main/java/org/apache/hive/hplsql/Stmt.java
+++ b/hplsql/src/main/java/org/apache/hive/hplsql/Stmt.java
@@ -957,7 +957,11 @@ public Integer forCursor(HplsqlParser.For_cursor_stmtContext ctx) {
       int cols = query.columnCount();
       Row row = new Row();
       for (int i = 0; i < cols; i++) {
-        row.addColumnDefinition(query.metadata().columnName(i), query.metadata().columnTypeName(i));
+        String columnName = query.metadata().columnName(i);
+        if (columnName.contains(".")) {
+          columnName = columnName.substring(columnName.lastIndexOf('.') + 1);
+        }
+        row.addColumnDefinition(columnName, query.metadata().columnTypeName(i));
       }
       Var var = new Var(cursor, row);
       exec.addVariable(var);
diff --git a/itests/hive-unit/pom.xml b/itests/hive-unit/pom.xml
index 7c3b2333b9..fd64a78531 100644
--- a/itests/hive-unit/pom.xml
+++ b/itests/hive-unit/pom.xml
@@ -494,6 +494,12 @@
       <artifactId>postgresql</artifactId>
       <scope>test</scope>
     </dependency>
+    <dependency>
+      <groupId>net.sf.supercsv</groupId>
+      <artifactId>super-csv</artifactId>
+      <version>${super-csv.version}</version>
+      <scope>test</scope>
+    </dependency>
   </dependencies>
   <build>
     <plugins>
diff --git a/itests/hive-unit/src/test/java/org/apache/hive/beeline/TestHplSqlViaBeeLine.java b/itests/hive-unit/src/test/java/org/apache/hive/beeline/TestHplSqlViaBeeLine.java
index 4118013769..eb2285ba16 100644
--- a/itests/hive-unit/src/test/java/org/apache/hive/beeline/TestHplSqlViaBeeLine.java
+++ b/itests/hive-unit/src/test/java/org/apache/hive/beeline/TestHplSqlViaBeeLine.java
@@ -869,6 +869,25 @@ public void testUSERHplSQLFunction() throws Throwable {
     testScriptFile(SCRIPT_TEXT, args(), System.getProperty("user.name"));
   }
 
+  @Test
+  public void testTableAliasInColumnName() throws Throwable {
+    String SCRIPT_TEXT =
+        "DROP TABLE IF EXISTS input;\n" +
+            "DROP TABLE IF EXISTS result;\n" +
+            "CREATE TABLE input (col1 string, col2 int);\n" +
+            "CREATE TABLE result (res string);\n" +
+            "INSERT INTO input VALUES('Hive', 2023);\n" +
+            "CREATE PROCEDURE p1() AS\n" +
+            "  BEGIN\n" +
+            "    FOR rec IN (select tab.col1, tab.col2 num from input tab) LOOP\n" +
+            "      INSERT INTO result VALUES(rec.num || ' = ' || rec.col1);\n" +
+            "  END LOOP;\n" +
+            "END;\n" +
+            "p1();\n" +
+            "SELECT * FROM result;\n";
+    testScriptFile(SCRIPT_TEXT, args(), "2023 = Hive");
+  }
+
   private static List<String> args() {
     return Arrays.asList("-d", BeeLine.BEELINE_DEFAULT_JDBC_DRIVER,
             "-u", miniHS2.getBaseJdbcURL() + ";mode=hplsql", "-n", userName);
