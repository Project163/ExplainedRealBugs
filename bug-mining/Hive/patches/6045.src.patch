diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index 10fe6fc66c..5a88a96d72 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -12025,8 +12025,16 @@ public Map<ASTNode, ExprNodeDesc> genAllExprNodeDesc(ASTNode expr, RowResolver i
         TypeCheckProcFactory.genExprNode(expr, tcCtx);
     ExprNodeDesc desc = nodeOutputs.get(expr);
     if (desc == null) {
-      String errMsg = tcCtx.getError();
-      if (errMsg == null) {
+        String tableOrCol = BaseSemanticAnalyzer.unescapeIdentifier(expr
+            .getChild(0).getText());
+        ColumnInfo colInfo = input.get(null, tableOrCol);
+        String errMsg;
+        if (colInfo == null && input.getIsExprResolver()){
+            errMsg = ErrorMsg.NON_KEY_EXPR_IN_GROUPBY.getMsg(expr);
+        } else {
+            errMsg = tcCtx.getError();
+        }
+        if (errMsg == null) {
         errMsg = "Error in parsing ";
       }
       throw new SemanticException(errMsg);
diff --git a/ql/src/test/queries/clientnegative/groupby_struct.q b/ql/src/test/queries/clientnegative/groupby_struct.q
new file mode 100644
index 0000000000..99bbdaf0df
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/groupby_struct.q
@@ -0,0 +1,6 @@
+CREATE TABLE addresses (
+    name float,
+    address struct<intVals:int,strVals:string>
+ );
+
+SELECT address FROM addresses GROUP BY address.intVals;
diff --git a/ql/src/test/results/clientnegative/groupby_struct.q.out b/ql/src/test/results/clientnegative/groupby_struct.q.out
new file mode 100644
index 0000000000..f62dbfeac3
--- /dev/null
+++ b/ql/src/test/results/clientnegative/groupby_struct.q.out
@@ -0,0 +1,15 @@
+PREHOOK: query: CREATE TABLE addresses (
+    name float,
+    address struct<intVals:int,strVals:string>
+ )
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@addresses
+POSTHOOK: query: CREATE TABLE addresses (
+    name float,
+    address struct<intVals:int,strVals:string>
+ )
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@addresses
+FAILED: SemanticException [Error 10025]: Line 3:7 Expression not in GROUP BY key 'address'
diff --git a/ql/src/test/results/compiler/errors/nonkey_groupby.q.out b/ql/src/test/results/compiler/errors/nonkey_groupby.q.out
index 9dfbb97e2d..a13d45dc0b 100644
--- a/ql/src/test/results/compiler/errors/nonkey_groupby.q.out
+++ b/ql/src/test/results/compiler/errors/nonkey_groupby.q.out
@@ -1,2 +1,2 @@
 Semantic Exception: 
-Line 2:48 Invalid column reference 'value'
\ No newline at end of file
+Line 2:44 Expression not in GROUP BY key 'value'
\ No newline at end of file
