diff --git a/ql/src/test/queries/clientpositive/alter_varchar1.q b/ql/src/test/queries/clientpositive/alter_varchar1.q
index fa9d99ee55..781cbda735 100644
--- a/ql/src/test/queries/clientpositive/alter_varchar1.q
+++ b/ql/src/test/queries/clientpositive/alter_varchar1.q
@@ -2,31 +2,31 @@ drop table alter_varchar_1;
 
 create table alter_varchar_1 (key string, value string);
 insert overwrite table alter_varchar_1
-  select key, value from src limit 5;
+  select key, value from src order by key limit 5;
 
-select * from alter_varchar_1;
+select * from alter_varchar_1 order by key;
 
 -- change column to varchar
 alter table alter_varchar_1 change column value value varchar(20);
 -- contents should still look the same
-select * from alter_varchar_1;
+select * from alter_varchar_1 order by key;
 
 -- change column to smaller varchar
 alter table alter_varchar_1 change column value value varchar(3);
 -- value column should be truncated now
-select * from alter_varchar_1;
+select * from alter_varchar_1 order by key;
 
 -- change back to bigger varchar
 alter table alter_varchar_1 change column value value varchar(20);
 -- column values should be full size again
-select * from alter_varchar_1;
+select * from alter_varchar_1 order by key;
 
 -- add varchar column
 alter table alter_varchar_1 add columns (key2 int, value2 varchar(10));
-select * from alter_varchar_1;
+select * from alter_varchar_1 order by key;
 
 insert overwrite table alter_varchar_1
-  select key, value, key, value from src limit 5;
-select * from alter_varchar_1;
+  select key, value, key, value from src order by key limit 5;
+select * from alter_varchar_1 order by key;
 
 drop table alter_varchar_1;
diff --git a/ql/src/test/queries/clientpositive/varchar_1.q b/ql/src/test/queries/clientpositive/varchar_1.q
index bda12fe041..53273b3187 100644
--- a/ql/src/test/queries/clientpositive/varchar_1.q
+++ b/ql/src/test/queries/clientpositive/varchar_1.q
@@ -6,27 +6,27 @@ create table varchar1_1 (key string, value string);
 
 -- load from file
 load data local inpath '../data/files/srcbucket0.txt' overwrite into table varchar1;
-select * from varchar1 limit 2;
+select * from varchar1 order by key, value limit 2;
 
 -- insert overwrite, from same/different length varchar
 insert overwrite table varchar1
-  select cast(key as varchar(10)), cast(value as varchar(15)) from src limit 2;
-select key, value from varchar1;
+  select cast(key as varchar(10)), cast(value as varchar(15)) from src order by key, value limit 2;
+select key, value from varchar1 order by key, value;
 
 -- insert overwrite, from string
 insert overwrite table varchar1
-  select key, value from src limit 2;
-select key, value from varchar1;
+  select key, value from src order by key, value limit 2;
+select key, value from varchar1 order by key, value;
 
 -- insert string from varchar
 insert overwrite table varchar1_1
-  select key, value from varchar1 limit 2;
-select key, value from varchar1_1;
+  select key, value from varchar1 order by key, value limit 2;
+select key, value from varchar1_1 order by key, value;
 
 -- respect string length
 insert overwrite table varchar1 
-  select key, cast(value as varchar(3)) from src limit 2;
-select key, value from varchar1;
+  select key, cast(value as varchar(3)) from src order by key, value limit 2;
+select key, value from varchar1 order by key, value;
 
 drop table varchar1;
 drop table varchar1_1;
diff --git a/ql/src/test/queries/clientpositive/varchar_nested_types.q b/ql/src/test/queries/clientpositive/varchar_nested_types.q
index f3f89f6713..5c0989f7fc 100644
--- a/ql/src/test/queries/clientpositive/varchar_nested_types.q
+++ b/ql/src/test/queries/clientpositive/varchar_nested_types.q
@@ -7,7 +7,7 @@ drop table varchar_nested_view;
 
 create table varchar_nested_1 (key int, value varchar(20));
 insert overwrite table varchar_nested_1
-  select key, value from src limit 5;
+  select key, value from src order by key limit 1;
 
 -- arrays
 create table varchar_nested_array (c1 array<varchar(20)>);
diff --git a/ql/src/test/queries/clientpositive/varchar_udf1.q b/ql/src/test/queries/clientpositive/varchar_udf1.q
index df5b7bde0e..0a3012b5cd 100644
--- a/ql/src/test/queries/clientpositive/varchar_udf1.q
+++ b/ql/src/test/queries/clientpositive/varchar_udf1.q
@@ -2,7 +2,7 @@ drop table varchar_udf_1;
 
 create table varchar_udf_1 (c1 string, c2 string, c3 varchar(10), c4 varchar(20));
 insert overwrite table varchar_udf_1
-  select key, value, key, value from src limit 5;
+  select key, value, key, value from src where key = '238' limit 1;
 
 -- UDFs with varchar support
 select 
diff --git a/ql/src/test/results/clientpositive/alter_varchar1.q.out b/ql/src/test/results/clientpositive/alter_varchar1.q.out
index 20cdf99967..6194c3a9f8 100644
--- a/ql/src/test/results/clientpositive/alter_varchar1.q.out
+++ b/ql/src/test/results/clientpositive/alter_varchar1.q.out
@@ -8,32 +8,32 @@ POSTHOOK: query: create table alter_varchar_1 (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@alter_varchar_1
 PREHOOK: query: insert overwrite table alter_varchar_1
-  select key, value from src limit 5
+  select key, value from src order by key limit 5
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@alter_varchar_1
 POSTHOOK: query: insert overwrite table alter_varchar_1
-  select key, value from src limit 5
+  select key, value from src order by key limit 5
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@alter_varchar_1
 POSTHOOK: Lineage: alter_varchar_1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: alter_varchar_1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-PREHOOK: query: select * from alter_varchar_1
+PREHOOK: query: select * from alter_varchar_1 order by key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alter_varchar_1
 #### A masked pattern was here ####
-POSTHOOK: query: select * from alter_varchar_1
+POSTHOOK: query: select * from alter_varchar_1 order by key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alter_varchar_1
 #### A masked pattern was here ####
 POSTHOOK: Lineage: alter_varchar_1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: alter_varchar_1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-238	val_238
-86	val_86
-311	val_311
-27	val_27
-165	val_165
+0	val_0
+0	val_0
+0	val_0
+10	val_10
+100	val_100
 PREHOOK: query: -- change column to varchar
 alter table alter_varchar_1 change column value value varchar(20)
 PREHOOK: type: ALTERTABLE_RENAMECOL
@@ -47,22 +47,22 @@ POSTHOOK: Output: default@alter_varchar_1
 POSTHOOK: Lineage: alter_varchar_1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: alter_varchar_1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: -- contents should still look the same
-select * from alter_varchar_1
+select * from alter_varchar_1 order by key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alter_varchar_1
 #### A masked pattern was here ####
 POSTHOOK: query: -- contents should still look the same
-select * from alter_varchar_1
+select * from alter_varchar_1 order by key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alter_varchar_1
 #### A masked pattern was here ####
 POSTHOOK: Lineage: alter_varchar_1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: alter_varchar_1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-238	val_238
-86	val_86
-311	val_311
-27	val_27
-165	val_165
+0	val_0
+0	val_0
+0	val_0
+10	val_10
+100	val_100
 PREHOOK: query: -- change column to smaller varchar
 alter table alter_varchar_1 change column value value varchar(3)
 PREHOOK: type: ALTERTABLE_RENAMECOL
@@ -76,22 +76,22 @@ POSTHOOK: Output: default@alter_varchar_1
 POSTHOOK: Lineage: alter_varchar_1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: alter_varchar_1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: -- value column should be truncated now
-select * from alter_varchar_1
+select * from alter_varchar_1 order by key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alter_varchar_1
 #### A masked pattern was here ####
 POSTHOOK: query: -- value column should be truncated now
-select * from alter_varchar_1
+select * from alter_varchar_1 order by key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alter_varchar_1
 #### A masked pattern was here ####
 POSTHOOK: Lineage: alter_varchar_1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: alter_varchar_1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-238	val
-86	val
-311	val
-27	val
-165	val
+0	val
+0	val
+0	val
+10	val
+100	val
 PREHOOK: query: -- change back to bigger varchar
 alter table alter_varchar_1 change column value value varchar(20)
 PREHOOK: type: ALTERTABLE_RENAMECOL
@@ -105,22 +105,22 @@ POSTHOOK: Output: default@alter_varchar_1
 POSTHOOK: Lineage: alter_varchar_1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: alter_varchar_1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: -- column values should be full size again
-select * from alter_varchar_1
+select * from alter_varchar_1 order by key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alter_varchar_1
 #### A masked pattern was here ####
 POSTHOOK: query: -- column values should be full size again
-select * from alter_varchar_1
+select * from alter_varchar_1 order by key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alter_varchar_1
 #### A masked pattern was here ####
 POSTHOOK: Lineage: alter_varchar_1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: alter_varchar_1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-238	val_238
-86	val_86
-311	val_311
-27	val_27
-165	val_165
+0	val_0
+0	val_0
+0	val_0
+10	val_10
+100	val_100
 PREHOOK: query: -- add varchar column
 alter table alter_varchar_1 add columns (key2 int, value2 varchar(10))
 PREHOOK: type: ALTERTABLE_ADDCOLS
@@ -133,28 +133,28 @@ POSTHOOK: Input: default@alter_varchar_1
 POSTHOOK: Output: default@alter_varchar_1
 POSTHOOK: Lineage: alter_varchar_1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: alter_varchar_1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-PREHOOK: query: select * from alter_varchar_1
+PREHOOK: query: select * from alter_varchar_1 order by key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alter_varchar_1
 #### A masked pattern was here ####
-POSTHOOK: query: select * from alter_varchar_1
+POSTHOOK: query: select * from alter_varchar_1 order by key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alter_varchar_1
 #### A masked pattern was here ####
 POSTHOOK: Lineage: alter_varchar_1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: alter_varchar_1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-238	val_238	NULL	NULL
-86	val_86	NULL	NULL
-311	val_311	NULL	NULL
-27	val_27	NULL	NULL
-165	val_165	NULL	NULL
+0	val_0	NULL	NULL
+0	val_0	NULL	NULL
+0	val_0	NULL	NULL
+10	val_10	NULL	NULL
+100	val_100	NULL	NULL
 PREHOOK: query: insert overwrite table alter_varchar_1
-  select key, value, key, value from src limit 5
+  select key, value, key, value from src order by key limit 5
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@alter_varchar_1
 POSTHOOK: query: insert overwrite table alter_varchar_1
-  select key, value, key, value from src limit 5
+  select key, value, key, value from src order by key limit 5
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@alter_varchar_1
@@ -164,11 +164,11 @@ POSTHOOK: Lineage: alter_varchar_1.key2 EXPRESSION [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: alter_varchar_1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: alter_varchar_1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: alter_varchar_1.value2 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-PREHOOK: query: select * from alter_varchar_1
+PREHOOK: query: select * from alter_varchar_1 order by key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alter_varchar_1
 #### A masked pattern was here ####
-POSTHOOK: query: select * from alter_varchar_1
+POSTHOOK: query: select * from alter_varchar_1 order by key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alter_varchar_1
 #### A masked pattern was here ####
@@ -178,11 +178,11 @@ POSTHOOK: Lineage: alter_varchar_1.key2 EXPRESSION [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: alter_varchar_1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: alter_varchar_1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: alter_varchar_1.value2 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-238	val_238	238	val_238
-86	val_86	86	val_86
-311	val_311	311	val_311
-27	val_27	27	val_27
-165	val_165	165	val_165
+0	val_0	0	val_0
+0	val_0	0	val_0
+0	val_0	0	val_0
+10	val_10	10	val_10
+100	val_100	100	val_100
 PREHOOK: query: drop table alter_varchar_1
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@alter_varchar_1
diff --git a/ql/src/test/results/clientpositive/varchar_1.q.out b/ql/src/test/results/clientpositive/varchar_1.q.out
index 18d0b8fca0..6d5dc00b8a 100644
--- a/ql/src/test/results/clientpositive/varchar_1.q.out
+++ b/ql/src/test/results/clientpositive/varchar_1.q.out
@@ -24,51 +24,51 @@ POSTHOOK: query: -- load from file
 load data local inpath '../data/files/srcbucket0.txt' overwrite into table varchar1
 POSTHOOK: type: LOAD
 POSTHOOK: Output: default@varchar1
-PREHOOK: query: select * from varchar1 limit 2
+PREHOOK: query: select * from varchar1 order by key, value limit 2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@varchar1
 #### A masked pattern was here ####
-POSTHOOK: query: select * from varchar1 limit 2
+POSTHOOK: query: select * from varchar1 order by key, value limit 2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@varchar1
 #### A masked pattern was here ####
-474	val_475
-62	val_63
+0	val_0
+0	val_0
 PREHOOK: query: -- insert overwrite, from same/different length varchar
 insert overwrite table varchar1
-  select cast(key as varchar(10)), cast(value as varchar(15)) from src limit 2
+  select cast(key as varchar(10)), cast(value as varchar(15)) from src order by key, value limit 2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@varchar1
 POSTHOOK: query: -- insert overwrite, from same/different length varchar
 insert overwrite table varchar1
-  select cast(key as varchar(10)), cast(value as varchar(15)) from src limit 2
+  select cast(key as varchar(10)), cast(value as varchar(15)) from src order by key, value limit 2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@varchar1
 POSTHOOK: Lineage: varchar1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-PREHOOK: query: select key, value from varchar1
+PREHOOK: query: select key, value from varchar1 order by key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@varchar1
 #### A masked pattern was here ####
-POSTHOOK: query: select key, value from varchar1
+POSTHOOK: query: select key, value from varchar1 order by key, value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@varchar1
 #### A masked pattern was here ####
 POSTHOOK: Lineage: varchar1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-238	val_238
-86	val_86
+0	val_0
+0	val_0
 PREHOOK: query: -- insert overwrite, from string
 insert overwrite table varchar1
-  select key, value from src limit 2
+  select key, value from src order by key, value limit 2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@varchar1
 POSTHOOK: query: -- insert overwrite, from string
 insert overwrite table varchar1
-  select key, value from src limit 2
+  select key, value from src order by key, value limit 2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@varchar1
@@ -76,11 +76,11 @@ POSTHOOK: Lineage: varchar1.key EXPRESSION [(src)src.FieldSchema(name:key, type:
 POSTHOOK: Lineage: varchar1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-PREHOOK: query: select key, value from varchar1
+PREHOOK: query: select key, value from varchar1 order by key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@varchar1
 #### A masked pattern was here ####
-POSTHOOK: query: select key, value from varchar1
+POSTHOOK: query: select key, value from varchar1 order by key, value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@varchar1
 #### A masked pattern was here ####
@@ -88,17 +88,17 @@ POSTHOOK: Lineage: varchar1.key EXPRESSION [(src)src.FieldSchema(name:key, type:
 POSTHOOK: Lineage: varchar1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-238	val_238
-86	val_86
+0	val_0
+0	val_0
 PREHOOK: query: -- insert string from varchar
 insert overwrite table varchar1_1
-  select key, value from varchar1 limit 2
+  select key, value from varchar1 order by key, value limit 2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@varchar1
 PREHOOK: Output: default@varchar1_1
 POSTHOOK: query: -- insert string from varchar
 insert overwrite table varchar1_1
-  select key, value from varchar1 limit 2
+  select key, value from varchar1 order by key, value limit 2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@varchar1
 POSTHOOK: Output: default@varchar1_1
@@ -108,11 +108,11 @@ POSTHOOK: Lineage: varchar1.value EXPRESSION [(src)src.FieldSchema(name:value, t
 POSTHOOK: Lineage: varchar1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar1_1.key SIMPLE [(varchar1)varchar1.FieldSchema(name:key, type:varchar(10), comment:null), ]
 POSTHOOK: Lineage: varchar1_1.value SIMPLE [(varchar1)varchar1.FieldSchema(name:value, type:varchar(20), comment:null), ]
-PREHOOK: query: select key, value from varchar1_1
+PREHOOK: query: select key, value from varchar1_1 order by key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@varchar1_1
 #### A masked pattern was here ####
-POSTHOOK: query: select key, value from varchar1_1
+POSTHOOK: query: select key, value from varchar1_1 order by key, value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@varchar1_1
 #### A masked pattern was here ####
@@ -122,17 +122,17 @@ POSTHOOK: Lineage: varchar1.value EXPRESSION [(src)src.FieldSchema(name:value, t
 POSTHOOK: Lineage: varchar1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar1_1.key SIMPLE [(varchar1)varchar1.FieldSchema(name:key, type:varchar(10), comment:null), ]
 POSTHOOK: Lineage: varchar1_1.value SIMPLE [(varchar1)varchar1.FieldSchema(name:value, type:varchar(20), comment:null), ]
-238	val_238
-86	val_86
+0	val_0
+0	val_0
 PREHOOK: query: -- respect string length
 insert overwrite table varchar1 
-  select key, cast(value as varchar(3)) from src limit 2
+  select key, cast(value as varchar(3)) from src order by key, value limit 2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@varchar1
 POSTHOOK: query: -- respect string length
 insert overwrite table varchar1 
-  select key, cast(value as varchar(3)) from src limit 2
+  select key, cast(value as varchar(3)) from src order by key, value limit 2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@varchar1
@@ -144,11 +144,11 @@ POSTHOOK: Lineage: varchar1.value EXPRESSION [(src)src.FieldSchema(name:value, t
 POSTHOOK: Lineage: varchar1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar1_1.key SIMPLE [(varchar1)varchar1.FieldSchema(name:key, type:varchar(10), comment:null), ]
 POSTHOOK: Lineage: varchar1_1.value SIMPLE [(varchar1)varchar1.FieldSchema(name:value, type:varchar(20), comment:null), ]
-PREHOOK: query: select key, value from varchar1
+PREHOOK: query: select key, value from varchar1 order by key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@varchar1
 #### A masked pattern was here ####
-POSTHOOK: query: select key, value from varchar1
+POSTHOOK: query: select key, value from varchar1 order by key, value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@varchar1
 #### A masked pattern was here ####
@@ -160,8 +160,8 @@ POSTHOOK: Lineage: varchar1.value EXPRESSION [(src)src.FieldSchema(name:value, t
 POSTHOOK: Lineage: varchar1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar1_1.key SIMPLE [(varchar1)varchar1.FieldSchema(name:key, type:varchar(10), comment:null), ]
 POSTHOOK: Lineage: varchar1_1.value SIMPLE [(varchar1)varchar1.FieldSchema(name:value, type:varchar(20), comment:null), ]
-238	val
-86	val
+0	val
+0	val
 PREHOOK: query: drop table varchar1
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@varchar1
diff --git a/ql/src/test/results/clientpositive/varchar_nested_types.q.out b/ql/src/test/results/clientpositive/varchar_nested_types.q.out
index 19eb1182e6..16a6a7465d 100644
--- a/ql/src/test/results/clientpositive/varchar_nested_types.q.out
+++ b/ql/src/test/results/clientpositive/varchar_nested_types.q.out
@@ -28,12 +28,12 @@ POSTHOOK: query: create table varchar_nested_1 (key int, value varchar(20))
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@varchar_nested_1
 PREHOOK: query: insert overwrite table varchar_nested_1
-  select key, value from src limit 5
+  select key, value from src order by key limit 1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@varchar_nested_1
 POSTHOOK: query: insert overwrite table varchar_nested_1
-  select key, value from src limit 5
+  select key, value from src order by key limit 1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@varchar_nested_1
@@ -80,11 +80,7 @@ POSTHOOK: Input: default@varchar_nested_array
 POSTHOOK: Lineage: varchar_nested_1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_nested_1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_nested_array.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
-["val_238","val_238"]
-["val_86","val_86"]
-["val_311","val_311"]
-["val_27","val_27"]
-["val_165","val_165"]
+["val_0","val_0"]
 PREHOOK: query: -- maps
 create table varchar_nested_map (c1 map<int, varchar(20)>)
 PREHOOK: type: CREATETABLE
@@ -130,11 +126,7 @@ POSTHOOK: Lineage: varchar_nested_1.key EXPRESSION [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: varchar_nested_1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_nested_array.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
 POSTHOOK: Lineage: varchar_nested_map.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:key, type:int, comment:null), (varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
-{238:"val_238"}
-{86:"val_86"}
-{311:"val_311"}
-{27:"val_27"}
-{165:"val_165"}
+{0:"val_0"}
 PREHOOK: query: -- structs
 create table varchar_nested_struct (c1 struct<a:int, b:varchar(20), c:string>)
 PREHOOK: type: CREATETABLE
@@ -190,11 +182,7 @@ POSTHOOK: Lineage: varchar_nested_1.value EXPRESSION [(src)src.FieldSchema(name:
 POSTHOOK: Lineage: varchar_nested_array.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
 POSTHOOK: Lineage: varchar_nested_map.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:key, type:int, comment:null), (varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
 POSTHOOK: Lineage: varchar_nested_struct.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:key, type:int, comment:null), (varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
-{"a":238,"b":"val_238","c":"val_238"}
-{"a":86,"b":"val_86","c":"val_86"}
-{"a":311,"b":"val_311","c":"val_311"}
-{"a":27,"b":"val_27","c":"val_27"}
-{"a":165,"b":"val_165","c":"val_165"}
+{"a":0,"b":"val_0","c":"val_0"}
 PREHOOK: query: -- nested type with create table as
 create table varchar_nested_cta as 
   select * from varchar_nested_struct
@@ -234,11 +222,7 @@ POSTHOOK: Lineage: varchar_nested_1.value EXPRESSION [(src)src.FieldSchema(name:
 POSTHOOK: Lineage: varchar_nested_array.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
 POSTHOOK: Lineage: varchar_nested_map.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:key, type:int, comment:null), (varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
 POSTHOOK: Lineage: varchar_nested_struct.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:key, type:int, comment:null), (varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
-{"a":238,"b":"val_238","c":"val_238"}
-{"a":86,"b":"val_86","c":"val_86"}
-{"a":311,"b":"val_311","c":"val_311"}
-{"a":27,"b":"val_27","c":"val_27"}
-{"a":165,"b":"val_165","c":"val_165"}
+{"a":0,"b":"val_0","c":"val_0"}
 PREHOOK: query: -- nested type with view
 create table varchar_nested_view as 
   select * from varchar_nested_struct
@@ -278,11 +262,7 @@ POSTHOOK: Lineage: varchar_nested_1.value EXPRESSION [(src)src.FieldSchema(name:
 POSTHOOK: Lineage: varchar_nested_array.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
 POSTHOOK: Lineage: varchar_nested_map.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:key, type:int, comment:null), (varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
 POSTHOOK: Lineage: varchar_nested_struct.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:key, type:int, comment:null), (varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
-{"a":238,"b":"val_238","c":"val_238"}
-{"a":86,"b":"val_86","c":"val_86"}
-{"a":311,"b":"val_311","c":"val_311"}
-{"a":27,"b":"val_27","c":"val_27"}
-{"a":165,"b":"val_165","c":"val_165"}
+{"a":0,"b":"val_0","c":"val_0"}
 PREHOOK: query: drop table varchar_nested_1
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@varchar_nested_1
diff --git a/ql/src/test/results/clientpositive/varchar_udf1.q.out b/ql/src/test/results/clientpositive/varchar_udf1.q.out
index 03d2a96b5f..f4b936679f 100644
--- a/ql/src/test/results/clientpositive/varchar_udf1.q.out
+++ b/ql/src/test/results/clientpositive/varchar_udf1.q.out
@@ -8,12 +8,12 @@ POSTHOOK: query: create table varchar_udf_1 (c1 string, c2 string, c3 varchar(10
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@varchar_udf_1
 PREHOOK: query: insert overwrite table varchar_udf_1
-  select key, value, key, value from src limit 5
+  select key, value, key, value from src where key = '238' limit 1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@varchar_udf_1
 POSTHOOK: query: insert overwrite table varchar_udf_1
-  select key, value, key, value from src limit 5
+  select key, value, key, value from src where key = '238' limit 1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@varchar_udf_1
@@ -501,7 +501,7 @@ POSTHOOK: Lineage: varchar_udf_1.c1 SIMPLE [(src)src.FieldSchema(name:key, type:
 POSTHOOK: Lineage: varchar_udf_1.c2 SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_udf_1.c3 EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_udf_1.c4 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-{"columntype":"String","maxlength":7,"avglength":6.6,"countnulls":0,"numdistinctvalues":7}	{"columntype":"String","maxlength":7,"avglength":6.6,"countnulls":0,"numdistinctvalues":7}
+{"columntype":"String","maxlength":7,"avglength":7.0,"countnulls":0,"numdistinctvalues":1}	{"columntype":"String","maxlength":7,"avglength":7.0,"countnulls":0,"numdistinctvalues":1}
 PREHOOK: query: select
   min(c2),
   min(c4)
@@ -520,7 +520,7 @@ POSTHOOK: Lineage: varchar_udf_1.c1 SIMPLE [(src)src.FieldSchema(name:key, type:
 POSTHOOK: Lineage: varchar_udf_1.c2 SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_udf_1.c3 EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_udf_1.c4 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-val_165	val_165
+val_238	val_238
 PREHOOK: query: select
   max(c2),
   max(c4)
@@ -539,7 +539,7 @@ POSTHOOK: Lineage: varchar_udf_1.c1 SIMPLE [(src)src.FieldSchema(name:key, type:
 POSTHOOK: Lineage: varchar_udf_1.c2 SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_udf_1.c3 EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_udf_1.c4 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-val_86	val_86
+val_238	val_238
 PREHOOK: query: drop table varchar_udf_1
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@varchar_udf_1
