diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java
index b5ffcd9409..4313a6b440 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java
@@ -690,6 +690,7 @@ public void setQBJoinTreeProps(JoinDesc joinDesc) {
     aliasToOpInfo = joinDesc.aliasToOpInfo;
     leftInputJoin = joinDesc.leftInputJoin;
     streamAliases = joinDesc.streamAliases;
+    joinKeys = joinDesc.joinKeys;
   }
 
   public void setQBJoinTreeProps(QBJoinTree joinTree) {
@@ -716,6 +717,12 @@ public void cloneQBJoinTreeProps(JoinDesc joinDesc) {
     aliasToOpInfo = new HashMap<String, Operator<? extends OperatorDesc>>(joinDesc.aliasToOpInfo);
     leftInputJoin = joinDesc.leftInputJoin;
     streamAliases = joinDesc.streamAliases == null ? null : new ArrayList<String>(joinDesc.streamAliases);
+    if (joinDesc.joinKeys != null) {
+      joinKeys = new ExprNodeDesc[joinDesc.joinKeys.length][];
+      for(int i = 0; i < joinDesc.joinKeys.length; i++) {
+        joinKeys[i] = joinDesc.joinKeys[i].clone();
+      }
+    }
   }
 
   public MemoryMonitorInfo getMemoryMonitorInfo() {
diff --git a/ql/src/test/results/clientpositive/quotedid_skew.q.out b/ql/src/test/results/clientpositive/quotedid_skew.q.out
index 902be6b533..a682644577 100644
--- a/ql/src/test/results/clientpositive/quotedid_skew.q.out
+++ b/ql/src/test/results/clientpositive/quotedid_skew.q.out
@@ -163,6 +163,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/skewjoin_mapjoin2.q.out b/ql/src/test/results/clientpositive/skewjoin_mapjoin2.q.out
index 78f20cc96d..fa0f615144 100644
--- a/ql/src/test/results/clientpositive/skewjoin_mapjoin2.q.out
+++ b/ql/src/test/results/clientpositive/skewjoin_mapjoin2.q.out
@@ -300,6 +300,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Outer Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/skewjoin_union_remove_1.q.out b/ql/src/test/results/clientpositive/skewjoin_union_remove_1.q.out
index 6c1a3b92dd..68a59728cb 100644
--- a/ql/src/test/results/clientpositive/skewjoin_union_remove_1.q.out
+++ b/ql/src/test/results/clientpositive/skewjoin_union_remove_1.q.out
@@ -139,6 +139,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
@@ -276,6 +279,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Right Outer Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
@@ -438,6 +444,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
@@ -597,6 +606,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Right Outer Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/skewjoin_union_remove_2.q.out b/ql/src/test/results/clientpositive/skewjoin_union_remove_2.q.out
index 0d0e65e69d..31df384548 100644
--- a/ql/src/test/results/clientpositive/skewjoin_union_remove_2.q.out
+++ b/ql/src/test/results/clientpositive/skewjoin_union_remove_2.q.out
@@ -191,6 +191,10 @@ STAGE PLANS:
           condition map:
                Inner Join 0 to 1
                Inner Join 0 to 2
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
+            2 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
           Statistics: Num rows: 2 Data size: 660 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/skewjoinopt1.q.out b/ql/src/test/results/clientpositive/skewjoinopt1.q.out
index 618ca313fb..c948c785ae 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt1.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt1.q.out
@@ -163,6 +163,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
@@ -323,6 +326,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Right Outer Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
@@ -499,6 +505,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
             compressed: false
@@ -663,6 +672,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Right Outer Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
             compressed: false
diff --git a/ql/src/test/results/clientpositive/skewjoinopt10.q.out b/ql/src/test/results/clientpositive/skewjoinopt10.q.out
index 5f4fd6dc58..f8116d37bb 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt10.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt10.q.out
@@ -203,6 +203,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 key (type: string)
+            1 key (type: string)
           outputColumnNames: _col0, _col6
           Statistics: Num rows: 3 Data size: 13 Basic stats: COMPLETE Column stats: NONE
           Select Operator
diff --git a/ql/src/test/results/clientpositive/skewjoinopt11.q.out b/ql/src/test/results/clientpositive/skewjoinopt11.q.out
index d595a503ae..dd15712ac3 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt11.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt11.q.out
@@ -280,6 +280,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           Select Operator
@@ -332,6 +335,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           Select Operator
diff --git a/ql/src/test/results/clientpositive/skewjoinopt12.q.out b/ql/src/test/results/clientpositive/skewjoinopt12.q.out
index c13c46e071..56ea968632 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt12.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt12.q.out
@@ -159,6 +159,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string), _col1 (type: string)
+            1 _col0 (type: string), _col1 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/skewjoinopt14.q.out b/ql/src/test/results/clientpositive/skewjoinopt14.q.out
index 4dfce3483e..5c9ca0ca6c 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt14.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt14.q.out
@@ -216,6 +216,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/skewjoinopt16.q.out b/ql/src/test/results/clientpositive/skewjoinopt16.q.out
index 3f519baa21..b5350c1211 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt16.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt16.q.out
@@ -159,6 +159,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string), _col1 (type: string)
+            1 _col0 (type: string), _col1 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/skewjoinopt17.q.out b/ql/src/test/results/clientpositive/skewjoinopt17.q.out
index b00a6684ee..ecf1547871 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt17.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt17.q.out
@@ -163,6 +163,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
@@ -373,6 +376,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string), _col1 (type: string)
+            1 _col0 (type: string), _col1 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/skewjoinopt19.q.out b/ql/src/test/results/clientpositive/skewjoinopt19.q.out
index 6f4afd798c..59071e153b 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt19.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt19.q.out
@@ -163,6 +163,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/skewjoinopt2.q.out b/ql/src/test/results/clientpositive/skewjoinopt2.q.out
index 75eb8e3455..8343e1ba80 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt2.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt2.q.out
@@ -159,6 +159,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string), _col1 (type: string)
+            1 _col0 (type: string), _col1 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
@@ -312,6 +315,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Left Outer Join 0 to 1
+          keys:
+            0 _col0 (type: string), _col1 (type: string)
+            1 _col0 (type: string), _col1 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
@@ -495,6 +501,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string), _col1 (type: string)
+            1 _col0 (type: string), _col1 (type: string)
           outputColumnNames: _col0
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
@@ -669,6 +678,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Left Outer Join 0 to 1
+          keys:
+            0 _col0 (type: string), _col1 (type: string)
+            1 _col0 (type: string), _col1 (type: string)
           outputColumnNames: _col0
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/skewjoinopt20.q.out b/ql/src/test/results/clientpositive/skewjoinopt20.q.out
index 25d67cbfb7..3b69192c0c 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt20.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt20.q.out
@@ -163,6 +163,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/skewjoinopt21.q.out b/ql/src/test/results/clientpositive/skewjoinopt21.q.out
index 5a3d2e14af..58e7eb8fa7 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt21.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt21.q.out
@@ -173,6 +173,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/skewjoinopt3.q.out b/ql/src/test/results/clientpositive/skewjoinopt3.q.out
index ef8af9fde6..6de674cf38 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt3.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt3.q.out
@@ -163,6 +163,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
@@ -323,6 +326,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Outer Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/skewjoinopt4.q.out b/ql/src/test/results/clientpositive/skewjoinopt4.q.out
index 675cf0e9ce..4aadb5d83d 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt4.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt4.q.out
@@ -161,6 +161,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
@@ -323,6 +326,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/skewjoinopt5.q.out b/ql/src/test/results/clientpositive/skewjoinopt5.q.out
index 221aaf2041..d98b3639e7 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt5.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt5.q.out
@@ -163,6 +163,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/skewjoinopt6.q.out b/ql/src/test/results/clientpositive/skewjoinopt6.q.out
index 6684aa4a66..f5fcb78fb2 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt6.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt6.q.out
@@ -163,6 +163,9 @@ STAGE PLANS:
         Join Operator
           condition map:
                Inner Join 0 to 1
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 330 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/skewjoinopt7.q.out b/ql/src/test/results/clientpositive/skewjoinopt7.q.out
index da06be8f17..d6c2db40bb 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt7.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt7.q.out
@@ -215,6 +215,10 @@ STAGE PLANS:
           condition map:
                Inner Join 0 to 1
                Inner Join 0 to 2
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
+            2 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
           Statistics: Num rows: 2 Data size: 660 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/skewjoinopt8.q.out b/ql/src/test/results/clientpositive/skewjoinopt8.q.out
index df747466d2..a7426b695c 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt8.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt8.q.out
@@ -213,6 +213,10 @@ STAGE PLANS:
           condition map:
                Inner Join 0 to 1
                Inner Join 0 to 2
+          keys:
+            0 _col0 (type: string)
+            1 _col0 (type: string)
+            2 _col0 (type: string)
           outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
           Statistics: Num rows: 2 Data size: 660 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
