diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/TopNKeyOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/TopNKeyOperator.java
index b3ab7015b7..4e35922e5f 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/TopNKeyOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/TopNKeyOperator.java
@@ -30,8 +30,10 @@
 
 import java.io.Serializable;
 import java.util.Comparator;
+import java.util.List;
 
 import static org.apache.hadoop.hive.ql.plan.api.OperatorType.TOPNKEY;
+import static org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorUtils.NullValueOption;
 
 /**
  * TopNKeyOperator passes rows that contains top N keys only.
@@ -55,25 +57,22 @@ public TopNKeyOperator(CompilationOpContext ctx) {
 
   public static class KeyWrapperComparator implements Comparator<KeyWrapper> {
 
-    private final ObjectInspector[] keyObjectInspectors;
-    private final boolean[] columnSortOrderIsDesc;
-    private final ObjectInspectorUtils.NullValueOption[] nullSortOrder;
+    private final List<Comparator<Object>> comparatorList;
 
     KeyWrapperComparator(ObjectInspector[] keyObjectInspectors, String columnSortOrder, String nullSortOrder) {
-      this.keyObjectInspectors = keyObjectInspectors;
-      this.columnSortOrderIsDesc = new boolean[columnSortOrder.length()];
-      this.nullSortOrder = new ObjectInspectorUtils.NullValueOption[nullSortOrder.length()];
+      boolean[] columnSortOrderIsDesc = new boolean[columnSortOrder.length()];
+      NullValueOption[] nullSortOrderArray = new NullValueOption[nullSortOrder.length()];
       for (int i = 0; i < columnSortOrder.length(); ++i) {
-        this.columnSortOrderIsDesc[i] = columnSortOrder.charAt(i) == '-';
-        this.nullSortOrder[i] = NullOrdering.fromSign(nullSortOrder.charAt(i)).getNullValueOption();
+        columnSortOrderIsDesc[i] = columnSortOrder.charAt(i) == '-';
+        nullSortOrderArray[i] = NullOrdering.fromSign(nullSortOrder.charAt(i)).getNullValueOption();
       }
+      comparatorList = ObjectInspectorUtils.getComparator(
+              keyObjectInspectors, keyObjectInspectors, columnSortOrderIsDesc, nullSortOrderArray);
     }
 
     @Override
     public int compare(KeyWrapper key1, KeyWrapper key2) {
-      return ObjectInspectorUtils.compare(
-              key1.getKeyArray(), keyObjectInspectors, key2.getKeyArray(), keyObjectInspectors,
-              columnSortOrderIsDesc, nullSortOrder);
+      return ObjectInspectorUtils.compare(comparatorList, key1.getKeyArray(), key2.getKeyArray());
     }
   }
 
diff --git a/serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java b/serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java
index ab1cfdcdb5..1f3bbaf87d 100644
--- a/serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java
+++ b/serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java
@@ -948,14 +948,12 @@ public static int compare(Object[] o1, ObjectInspector[] oi1, Object[] o2,
     return 0;
   }
 
-  public static int compare(
-          Object[] objectArray1, ObjectInspector[] oi1, Object[] objectArray2, ObjectInspector[] oi2,
+  public static List<Comparator<Object>> getComparator(
+          ObjectInspector[] oi1, ObjectInspector[] oi2,
           boolean[] columnSortOrderIsDesc, NullValueOption[] nullSortOrder) {
-    assert (objectArray1.length == objectArray2.length);
-    assert (objectArray1.length == oi1.length);
-    assert (objectArray2.length == oi2.length);
-    assert (columnSortOrderIsDesc.length == objectArray1.length);
-    assert (nullSortOrder.length == objectArray1.length);
+    assert (oi1.length == oi2.length);
+    assert (columnSortOrderIsDesc.length == oi1.length);
+    assert (nullSortOrder.length == oi1.length);
 
     List<Comparator<Object>> comparators = new ArrayList<>(oi1.length);
     for (int i = 0; i < oi1.length; i++) {
@@ -975,7 +973,7 @@ public static int compare(
       }
     }
 
-    return compare(comparators, objectArray1, objectArray2);
+    return comparators;
   }
 
   public static <T> int compare(List<Comparator<T>> comparatorList, T[] o1, T[] o2) {
