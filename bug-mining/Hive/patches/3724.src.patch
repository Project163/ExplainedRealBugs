diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/ParseUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/ParseUtils.java
index bf1b5d40f6..5f13277570 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/ParseUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/ParseUtils.java
@@ -153,7 +153,7 @@ public static CharTypeInfo getCharTypeInfo(ASTNode node)
 
   static int getIndex(String[] list, String elem) {
     for(int i=0; i < list.length; i++) {
-      if (list[i].toLowerCase().equals(elem)) {
+      if (list[i] != null && list[i].toLowerCase().equals(elem)) {
         return i;
       }
     }
